(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{svzG:function(n,l,t){"use strict";t.r(l);var e=t("8Y7J");class a{}var u=t("pMnS"),o=t("Nb0/"),i=t("10Sg"),c=t("QQfA"),r=t("iInd"),s=t("SVse"),b=t("A7pE"),d=t("w2OH"),g=t("LvDl"),p=t("mrSG"),h=t("e1JD"),O=t("LRne"),m=t("itXk"),f=t("HDdC"),v=t("wO+i"),y=t("lJxs"),C=t("eIep"),M=t("w1tV"),P=t("AytR"),_=t("HLSH");let S=(()=>{class n{constructor(n,l){this.localDatabase=n,this.store=l,this.countObservableMap=new WeakMap,this.pathToImages=P.a.ccfAssetUrl+"/body"}getBodySourcePath(){return this.searchState.pipe(Object(v.a)("gender"),Object(y.a)(n=>void 0!==n?n:"both"),Object(y.a)(n=>n&&`${this.pathToImages}/${n}/`))}getMetadata(n){return this.patientFilterBuilder.pipe(Object(y.a)(l=>l.addIncludes("anatomicalLocations",n)),Object(y.a)(n=>n.toFilter()),Object(C.a)(n=>this.localDatabase.getPatients(n)),Object(y.a)(n=>Object(g.map)(n,"metadata")))}getBodyOverlays(){return Object(O.a)(["kidney","heart"].map(n=>({id:n,path:`${this.pathToImages}/overlays/${n}/${n}.svg`})))}getCounts(n){if(this.countObservableMap.has(n))return this.countObservableMap.get(n);const l=this.createCountsObservable(n.id);return this.countObservableMap.set(n,l),l}createCountsObservable(n){const l=this.getCountsFor("getPatients",_.a.patientFilterBuilder,"anatomicalLocations[0]",n),t=this.getCountsFor("getTissueSamples",_.a.tissueSampleFilterBuilder,"patient.anatomicalLocations[0]",n),e=this.getCountsFor("getTissueSlices",_.a.tissueSliceFilterBuilder,"sample.patient.anatomicalLocations[0]",n),a=this.getCountsFor("getTissueImages",_.a.tissueImageFilterBuilder,"slice.sample.patient.anatomicalLocations[0]",n);return Object(m.a)([l,t,e,a]).pipe(Object(y.a)(([n,l,t,e])=>({patientsCount:n,tissueSamplesCount:l,tissueSlicesCount:t,tissueImagesCount:e,cells:0})),Object(M.a)())}getCountsFor(n,l,t,e){const{localDatabase:a,store:u}=this,o=a[n].bind(a);return u.select(l).pipe(Object(y.a)(n=>n.addMatches(t,e)),Object(y.a)(n=>n.toFilter()),Object(C.a)(o),Object(y.a)(n=>n.length))}}return p.__decorate([Object(h.e)(_.a),p.__metadata("design:type",f.a)],n.prototype,"searchState",void 0),p.__decorate([Object(h.e)(_.a.patientFilterBuilder),p.__metadata("design:type",f.a)],n.prototype,"patientFilterBuilder",void 0),n})();var x=t("gZgn");class D{constructor(n,l){this.bodyService=n,this.navigator=l}ngOnInit(){this.bodyImagePath$=this.bodyService.getBodySourcePath(),this.bodyOverlays$=this.bodyService.getBodyOverlays()}ngOnDestroy(){this.metadataSubscription&&this.metadataSubscription.unsubscribe()}organHover(n){this.hoverOrganName=n,this.metadataSubscription=this.bodyService.getMetadata(n).subscribe(n=>{this.metadata=n})}clearOrganHover(){this.metadata=void 0,this.hoverOrganName=void 0,this.metadataSubscription.unsubscribe()}capitalize(n){return Object(g.capitalize)(n)}pluralizeSuffix(n,l){return`${l}${1!==n?"s":""}`}pluralize(n,l){return`${n} ${this.pluralizeSuffix(n,l)}`}}var w=e.rb({encapsulation:0,styles:[[".ccf-ui-body.wrapper[_ngcontent-%COMP%]{height:100%}.ccf-ui-body.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;height:100%}.ccf-ui-body.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body-details-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;text-align:center}.ccf-ui-body.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body-details-container[_ngcontent-%COMP%]   .organ[_ngcontent-%COMP%]{left:70%}.ccf-ui-body.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body-details-container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{width:76%;height:100%}.ccf-ui-body.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body-details-container[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{cursor:pointer}.ccf-ui-body.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body-details-container[_ngcontent-%COMP%]   .organ-metadata[_ngcontent-%COMP%]{width:24%}.ccf-ui-body.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .body-details-container[_ngcontent-%COMP%]   .organ-metadata[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:center}"]],data:{}});function I(n){return e.Ob(0,[(n()(),e.tb(0,0,null,null,13,":svg:g",[["ccf-callout",""],["class","callout"],["forcePosition","left"]],null,null,null,o.b,o.a)),e.sb(1,4898816,null,0,i.a,[e.l,c.c],{boundary:[0,"boundary"],centroid:[1,"centroid"],forcePosition:[2,"forcePosition"]},null),(n()(),e.tb(2,0,null,0,11,":xhtml:div",[],null,null,null,null,null)),(n()(),e.Mb(3,null,[" "," "])),(n()(),e.tb(4,0,null,null,1,":xhtml:strong",[],null,null,null,null,null)),(n()(),e.Mb(5,null,["",""])),(n()(),e.tb(6,0,null,null,0,":xhtml:br",[],null,null,null,null,null)),(n()(),e.Mb(7,null,[" "," "])),(n()(),e.tb(8,0,null,null,0,":xhtml:br",[],null,null,null,null,null)),(n()(),e.Mb(9,null,[" ",""])),(n()(),e.tb(10,0,null,null,0,":xhtml:br",[],null,null,null,null,null)),(n()(),e.Mb(11,null,[" ",""])),(n()(),e.tb(12,0,null,null,0,":xhtml:br",[],null,null,null,null,null)),(n()(),e.Mb(13,null,[" "," "]))],(function(n,l){n(l,1,0,e.Fb(l.parent.parent,4),e.Fb(l.parent,1),"left")}),(function(n,l){var t=l.component;n(l,3,0,l.context.ngIf.patientsCount),n(l,5,0,t.pluralizeSuffix(l.context.ngIf.patientsCount,"Patient")),n(l,7,0,t.pluralize(l.context.ngIf.tissueSamplesCount,"Tissue sample")),n(l,9,0,t.pluralize(l.context.ngIf.tissueSlicesCount,"Tissue slice")),n(l,11,0,t.pluralize(l.context.ngIf.tissueImagesCount,"Tissue image")),n(l,13,0,t.pluralize(l.context.ngIf.cells,"Cell"))}))}function F(n){return e.Ob(0,[(n()(),e.tb(0,0,null,null,5,null,null,null,null,null,null,null)),(n()(),e.tb(1,0,[["overlayElem",1]],null,1,":svg:use",[["class","overlay"]],[[1,"href",0]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"]],(function(n,l,t){var a=!0,u=n.component;return"click"===l&&(a=!1!==e.Fb(n,2).onClick()&&a),"mouseenter"===l&&(a=!1!==u.organHover(n.context.$implicit.id)&&a),"mouseleave"===l&&(a=!1!==u.clearOrganHover()&&a),a}),null,null)),e.sb(2,16384,null,0,r.p,[r.o,r.a,[8,null],e.D,e.l],{routerLink:[0,"routerLink"]},null),(n()(),e.ib(16777216,null,null,2,null,I)),e.sb(4,16384,null,0,s.l,[e.O,e.L],{ngIf:[0,"ngIf"]},null),e.Hb(131072,s.b,[e.i]),(n()(),e.ib(0,null,null,0))],(function(n,l){var t=l.component;n(l,2,0,t.navigator.createOrganPath(l.context.$implicit.id)),n(l,4,0,e.Nb(l,4,0,e.Fb(l,5).transform(t.bodyService.getCounts(l.context.$implicit))))}),(function(n,l){n(l,1,0,e.xb(1,"",l.context.$implicit.path,"#overlay"))}))}function j(n){return e.Ob(0,[(n()(),e.tb(0,0,null,null,8,"div",[["class","organ-metadata"]],null,null,null,null,null)),(n()(),e.tb(1,0,null,null,7,"div",[["class","body"]],null,null,null,null,null)),(n()(),e.tb(2,0,null,null,4,"div",[["class","header"]],null,null,null,null,null)),(n()(),e.tb(3,0,null,null,1,"div",[["class","heading"]],null,null,null,null,null)),(n()(),e.Mb(-1,null,["ORGAN:"])),(n()(),e.tb(5,0,null,null,1,"div",[["class","organ"]],null,null,null,null,null)),(n()(),e.Mb(6,null,["",""])),(n()(),e.tb(7,0,null,null,1,"ccf-metadata",[],null,null,null,b.b,b.a)),e.sb(8,49152,null,0,d.a,[],{metadata:[0,"metadata"]},null)],(function(n,l){n(l,8,0,l.component.metadata)}),(function(n,l){var t=l.component;n(l,6,0,t.capitalize(t.hoverOrganName))}))}function $(n){return e.Ob(0,[(n()(),e.tb(0,0,null,null,10,"div",[["class","ccf-ui-body wrapper"]],null,null,null,null,null)),(n()(),e.tb(1,0,null,null,9,"div",[["class","container"]],null,null,null,null,null)),(n()(),e.tb(2,0,null,null,8,"div",[["class","body-details-container"]],null,null,null,null,null)),(n()(),e.tb(3,0,null,null,5,":svg:svg",[["class","body"],["viewBox","0 0 500 1000"]],null,null,null,null,null)),(n()(),e.tb(4,0,[["image",1]],null,1,":svg:use",[],[[1,"href",0]],null,null,null,null)),e.Hb(131072,s.b,[e.i]),(n()(),e.ib(16777216,null,null,2,null,F)),e.sb(7,278528,null,0,s.k,[e.O,e.L,e.r],{ngForOf:[0,"ngForOf"]},null),e.Hb(131072,s.b,[e.i]),(n()(),e.ib(16777216,null,null,1,null,j)),e.sb(10,16384,null,0,s.l,[e.O,e.L],{ngIf:[0,"ngIf"]},null)],(function(n,l){var t=l.component;n(l,7,0,e.Nb(l,7,0,e.Fb(l,8).transform(t.bodyOverlays$))),n(l,10,0,t.metadata)}),(function(n,l){var t=l.component;n(l,4,0,e.xb(1,"",e.Nb(l,4,0,e.Fb(l,5).transform(t.bodyImagePath$)),"body.svg#body"))}))}function k(n){return e.Ob(0,[(n()(),e.tb(0,0,null,null,1,"ccf-body",[],null,null,null,$,w)),e.sb(1,245760,null,0,D,[S,x.a],null,null)],(function(n,l){n(l,1,0)}),null)}var z=e.pb("ccf-body",D,k,{},{},[]),B=t("IP0z"),L=t("e5of");class H{}var N=t("zMNK"),T=t("/HVE"),A=t("hOhj"),J=t("1mvM"),R=t("R7m8");t.d(l,"BodyModuleNgFactory",(function(){return E}));var E=e.qb(a,[],(function(n){return e.Cb([e.Db(512,e.k,e.bb,[[8,[u.a,z]],[3,e.k],e.w]),e.Db(4608,s.n,s.m,[e.t,[2,s.D]]),e.Db(4608,c.c,c.c,[c.i,c.e,e.k,c.h,c.f,e.q,e.y,s.d,B.b,[2,s.h]]),e.Db(5120,c.j,c.k,[c.c]),e.Db(4608,S,S,[L.a,h.i]),e.Db(1073742336,s.c,s.c,[]),e.Db(1073742336,r.s,r.s,[[2,r.y],[2,r.o]]),e.Db(1073742336,H,H,[]),e.Db(1073742336,B.a,B.a,[]),e.Db(1073742336,N.g,N.g,[]),e.Db(1073742336,T.b,T.b,[]),e.Db(1073742336,A.c,A.c,[]),e.Db(1073742336,c.g,c.g,[]),e.Db(1073742336,J.a,J.a,[]),e.Db(1073742336,R.a,R.a,[]),e.Db(1073742336,a,a,[]),e.Db(1024,r.l,(function(){return[[{path:"",pathMatch:"full",component:D},{path:"**",redirectTo:""}]]}),[])])}))}}]);