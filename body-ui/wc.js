(()=>{"use strict";var e,d={},v={};function a(e){var n=v[e];if(void 0!==n)return n.exports;var r=v[e]={id:e,loaded:!1,exports:{}};return d[e].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=d,e=[],a.O=(n,r,u,l)=>{if(!r){var c=1/0;for(t=0;t<e.length;t++){for(var[r,u,l]=e[t],i=!0,f=0;f<r.length;f++)(!1&l||c>=l)&&Object.keys(a.O).every(b=>a.O[b](r[f]))?r.splice(f--,1):(i=!1,l<c&&(c=l));if(i){e.splice(t--,1);var o=u();void 0!==o&&(n=o)}}return n}l=l||0;for(var t=e.length;t>0&&e[t-1][2]>l;t--)e[t]=e[t-1];e[t]=[r,u,l]},a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var r in n)a.o(n,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={666:0};a.O.j=u=>0===e[u];var n=(u,l)=>{var f,o,[t,c,i]=l,s=0;for(f in c)a.o(c,f)&&(a.m[f]=c[f]);if(i)var _=i(a);for(u&&u(l);s<t.length;s++)a.o(e,o=t[s])&&e[o]&&e[o][0](),e[t[s]]=0;return a.O(_)},r=self.webpackChunkccf_ui=self.webpackChunkccf_ui||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))})()})();
"use strict";(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[429],{277:()=>{!function(e){const n=e.performance;function i(I){n&&n.mark&&n.mark(I)}function r(I,p){n&&n.measure&&n.measure(I,p)}i("Zone");const c=e.__Zone_symbol_prefix||"__zone_symbol__";function u(I){return c+I}const f=!0===e[u("forceDuplicateZoneCheck")];if(e.Zone){if(f||"function"!=typeof e.Zone.__symbol__)throw new Error("Zone already loaded.");return e.Zone}let _=(()=>{class I{constructor(t,o){this._parent=t,this._name=o?o.name||"unnamed":"<root>",this._properties=o&&o.properties||{},this._zoneDelegate=new T(this,this._parent&&this._parent._zoneDelegate,o)}static assertZonePatched(){if(e.Promise!==J.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")}static get root(){let t=I.current;for(;t.parent;)t=t.parent;return t}static get current(){return G.zone}static get currentTask(){return te}static __load_patch(t,o,y=!1){if(J.hasOwnProperty(t)){if(!y&&f)throw Error("Already loaded patch: "+t)}else if(!e["__Zone_disable_"+t]){const P="Zone:"+t;i(P),J[t]=o(e,I,le),r(P,P)}}get parent(){return this._parent}get name(){return this._name}get(t){const o=this.getZoneWith(t);if(o)return o._properties[t]}getZoneWith(t){let o=this;for(;o;){if(o._properties.hasOwnProperty(t))return o;o=o._parent}return null}fork(t){if(!t)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,t)}wrap(t,o){if("function"!=typeof t)throw new Error("Expecting function got: "+t);const y=this._zoneDelegate.intercept(this,t,o),P=this;return function(){return P.runGuarded(y,this,arguments,o)}}run(t,o,y,P){G={parent:G,zone:this};try{return this._zoneDelegate.invoke(this,t,o,y,P)}finally{G=G.parent}}runGuarded(t,o=null,y,P){G={parent:G,zone:this};try{try{return this._zoneDelegate.invoke(this,t,o,y,P)}catch(K){if(this._zoneDelegate.handleError(this,K))throw K}}finally{G=G.parent}}runTask(t,o,y){if(t.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(t.zone||z).name+"; Execution: "+this.name+")");if(t.state===j&&(t.type===R||t.type===M))return;const P=t.state!=X;P&&t._transitionTo(X,O),t.runCount++;const K=te;te=t,G={parent:G,zone:this};try{t.type==M&&t.data&&!t.data.isPeriodic&&(t.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,t,o,y)}catch(l){if(this._zoneDelegate.handleError(this,l))throw l}}finally{t.state!==j&&t.state!==Y&&(t.type==R||t.data&&t.data.isPeriodic?P&&t._transitionTo(O,X):(t.runCount=0,this._updateTaskCount(t,-1),P&&t._transitionTo(j,X,j))),G=G.parent,te=K}}scheduleTask(t){if(t.zone&&t.zone!==this){let y=this;for(;y;){if(y===t.zone)throw Error(`can not reschedule task to ${this.name} which is descendants of the original zone ${t.zone.name}`);y=y.parent}}t._transitionTo(q,j);const o=[];t._zoneDelegates=o,t._zone=this;try{t=this._zoneDelegate.scheduleTask(this,t)}catch(y){throw t._transitionTo(Y,q,j),this._zoneDelegate.handleError(this,y),y}return t._zoneDelegates===o&&this._updateTaskCount(t,1),t.state==q&&t._transitionTo(O,q),t}scheduleMicroTask(t,o,y,P){return this.scheduleTask(new m(v,t,o,y,P,void 0))}scheduleMacroTask(t,o,y,P,K){return this.scheduleTask(new m(M,t,o,y,P,K))}scheduleEventTask(t,o,y,P,K){return this.scheduleTask(new m(R,t,o,y,P,K))}cancelTask(t){if(t.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(t.zone||z).name+"; Execution: "+this.name+")");t._transitionTo(A,O,X);try{this._zoneDelegate.cancelTask(this,t)}catch(o){throw t._transitionTo(Y,A),this._zoneDelegate.handleError(this,o),o}return this._updateTaskCount(t,-1),t._transitionTo(j,A),t.runCount=0,t}_updateTaskCount(t,o){const y=t._zoneDelegates;-1==o&&(t._zoneDelegates=null);for(let P=0;P<y.length;P++)y[P]._updateTaskCount(t.type,o)}}return I.__symbol__=u,I})();const g={name:"",onHasTask:(I,p,t,o)=>I.hasTask(t,o),onScheduleTask:(I,p,t,o)=>I.scheduleTask(t,o),onInvokeTask:(I,p,t,o,y,P)=>I.invokeTask(t,o,y,P),onCancelTask:(I,p,t,o)=>I.cancelTask(t,o)};class T{constructor(p,t,o){this._taskCounts={microTask:0,macroTask:0,eventTask:0},this.zone=p,this._parentDelegate=t,this._forkZS=o&&(o&&o.onFork?o:t._forkZS),this._forkDlgt=o&&(o.onFork?t:t._forkDlgt),this._forkCurrZone=o&&(o.onFork?this.zone:t._forkCurrZone),this._interceptZS=o&&(o.onIntercept?o:t._interceptZS),this._interceptDlgt=o&&(o.onIntercept?t:t._interceptDlgt),this._interceptCurrZone=o&&(o.onIntercept?this.zone:t._interceptCurrZone),this._invokeZS=o&&(o.onInvoke?o:t._invokeZS),this._invokeDlgt=o&&(o.onInvoke?t:t._invokeDlgt),this._invokeCurrZone=o&&(o.onInvoke?this.zone:t._invokeCurrZone),this._handleErrorZS=o&&(o.onHandleError?o:t._handleErrorZS),this._handleErrorDlgt=o&&(o.onHandleError?t:t._handleErrorDlgt),this._handleErrorCurrZone=o&&(o.onHandleError?this.zone:t._handleErrorCurrZone),this._scheduleTaskZS=o&&(o.onScheduleTask?o:t._scheduleTaskZS),this._scheduleTaskDlgt=o&&(o.onScheduleTask?t:t._scheduleTaskDlgt),this._scheduleTaskCurrZone=o&&(o.onScheduleTask?this.zone:t._scheduleTaskCurrZone),this._invokeTaskZS=o&&(o.onInvokeTask?o:t._invokeTaskZS),this._invokeTaskDlgt=o&&(o.onInvokeTask?t:t._invokeTaskDlgt),this._invokeTaskCurrZone=o&&(o.onInvokeTask?this.zone:t._invokeTaskCurrZone),this._cancelTaskZS=o&&(o.onCancelTask?o:t._cancelTaskZS),this._cancelTaskDlgt=o&&(o.onCancelTask?t:t._cancelTaskDlgt),this._cancelTaskCurrZone=o&&(o.onCancelTask?this.zone:t._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;const y=o&&o.onHasTask;(y||t&&t._hasTaskZS)&&(this._hasTaskZS=y?o:g,this._hasTaskDlgt=t,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=p,o.onScheduleTask||(this._scheduleTaskZS=g,this._scheduleTaskDlgt=t,this._scheduleTaskCurrZone=this.zone),o.onInvokeTask||(this._invokeTaskZS=g,this._invokeTaskDlgt=t,this._invokeTaskCurrZone=this.zone),o.onCancelTask||(this._cancelTaskZS=g,this._cancelTaskDlgt=t,this._cancelTaskCurrZone=this.zone))}fork(p,t){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,p,t):new _(p,t)}intercept(p,t,o){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,p,t,o):t}invoke(p,t,o,y,P){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,p,t,o,y,P):t.apply(o,y)}handleError(p,t){return!this._handleErrorZS||this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,p,t)}scheduleTask(p,t){let o=t;if(this._scheduleTaskZS)this._hasTaskZS&&o._zoneDelegates.push(this._hasTaskDlgtOwner),o=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,p,t),o||(o=t);else if(t.scheduleFn)t.scheduleFn(t);else{if(t.type!=v)throw new Error("Task is missing scheduleFn.");d(t)}return o}invokeTask(p,t,o,y){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,p,t,o,y):t.callback.apply(o,y)}cancelTask(p,t){let o;if(this._cancelTaskZS)o=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,p,t);else{if(!t.cancelFn)throw Error("Task is not cancelable");o=t.cancelFn(t)}return o}hasTask(p,t){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,p,t)}catch(o){this.handleError(p,o)}}_updateTaskCount(p,t){const o=this._taskCounts,y=o[p],P=o[p]=y+t;if(P<0)throw new Error("More tasks executed then were scheduled.");0!=y&&0!=P||this.hasTask(this.zone,{microTask:o.microTask>0,macroTask:o.macroTask>0,eventTask:o.eventTask>0,change:p})}}class m{constructor(p,t,o,y,P,K){if(this._zone=null,this.runCount=0,this._zoneDelegates=null,this._state="notScheduled",this.type=p,this.source=t,this.data=y,this.scheduleFn=P,this.cancelFn=K,!o)throw new Error("callback is not defined");this.callback=o;const l=this;this.invoke=p===R&&y&&y.useG?m.invokeTask:function(){return m.invokeTask.call(e,l,this,arguments)}}static invokeTask(p,t,o){p||(p=this),re++;try{return p.runCount++,p.zone.runTask(p,t,o)}finally{1==re&&L(),re--}}get zone(){return this._zone}get state(){return this._state}cancelScheduleRequest(){this._transitionTo(j,q)}_transitionTo(p,t,o){if(this._state!==t&&this._state!==o)throw new Error(`${this.type} '${this.source}': can not transition to '${p}', expecting state '${t}'${o?" or '"+o+"'":""}, was '${this._state}'.`);this._state=p,p==j&&(this._zoneDelegates=null)}toString(){return this.data&&void 0!==this.data.handleId?this.data.handleId.toString():Object.prototype.toString.call(this)}toJSON(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}}}const S=u("setTimeout"),D=u("Promise"),Z=u("then");let E,B=[],V=!1;function d(I){if(0===re&&0===B.length)if(E||e[D]&&(E=e[D].resolve(0)),E){let p=E[Z];p||(p=E.then),p.call(E,L)}else e[S](L,0);I&&B.push(I)}function L(){if(!V){for(V=!0;B.length;){const I=B;B=[];for(let p=0;p<I.length;p++){const t=I[p];try{t.zone.runTask(t,null,null)}catch(o){le.onUnhandledError(o)}}}le.microtaskDrainDone(),V=!1}}const z={name:"NO ZONE"},j="notScheduled",q="scheduling",O="scheduled",X="running",A="canceling",Y="unknown",v="microTask",M="macroTask",R="eventTask",J={},le={symbol:u,currentZoneFrame:()=>G,onUnhandledError:F,microtaskDrainDone:F,scheduleMicroTask:d,showUncaughtError:()=>!_[u("ignoreConsoleErrorUncaughtError")],patchEventTarget:()=>[],patchOnProperties:F,patchMethod:()=>F,bindArguments:()=>[],patchThen:()=>F,patchMacroTask:()=>F,patchEventPrototype:()=>F,isIEOrEdge:()=>!1,getGlobalObjects:()=>{},ObjectDefineProperty:()=>F,ObjectGetOwnPropertyDescriptor:()=>{},ObjectCreate:()=>{},ArraySlice:()=>[],patchClass:()=>F,wrapWithCurrentZone:()=>F,filterProperties:()=>[],attachOriginToPatched:()=>F,_redefineProperty:()=>F,patchCallbacks:()=>F};let G={parent:null,zone:new _(null,null)},te=null,re=0;function F(){}r("Zone","Zone"),e.Zone=_}("undefined"!=typeof window&&window||"undefined"!=typeof self&&self||global);const ue=Object.getOwnPropertyDescriptor,he=Object.defineProperty,de=Object.getPrototypeOf,Be=Object.create,ut=Array.prototype.slice,Se="addEventListener",Oe="removeEventListener",Ze=Zone.__symbol__(Se),Ie=Zone.__symbol__(Oe),se="true",ie="false",ke=Zone.__symbol__("");function Le(e,n){return Zone.current.wrap(e,n)}function Me(e,n,i,r,c){return Zone.current.scheduleMacroTask(e,n,i,r,c)}const x=Zone.__symbol__,Pe="undefined"!=typeof window,pe=Pe?window:void 0,$=Pe&&pe||"object"==typeof self&&self||global,ht=[null];function Ae(e,n){for(let i=e.length-1;i>=0;i--)"function"==typeof e[i]&&(e[i]=Le(e[i],n+"_"+i));return e}function Fe(e){return!e||!1!==e.writable&&!("function"==typeof e.get&&void 0===e.set)}const Ue="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,Re=!("nw"in $)&&void 0!==$.process&&"[object process]"==={}.toString.call($.process),je=!Re&&!Ue&&!(!Pe||!pe.HTMLElement),We=void 0!==$.process&&"[object process]"==={}.toString.call($.process)&&!Ue&&!(!Pe||!pe.HTMLElement),Ce={},qe=function(e){if(!(e=e||$.event))return;let n=Ce[e.type];n||(n=Ce[e.type]=x("ON_PROPERTY"+e.type));const i=this||e.target||$,r=i[n];let c;if(je&&i===pe&&"error"===e.type){const u=e;c=r&&r.call(this,u.message,u.filename,u.lineno,u.colno,u.error),!0===c&&e.preventDefault()}else c=r&&r.apply(this,arguments),null!=c&&!c&&e.preventDefault();return c};function Xe(e,n,i){let r=ue(e,n);if(!r&&i&&ue(i,n)&&(r={enumerable:!0,configurable:!0}),!r||!r.configurable)return;const c=x("on"+n+"patched");if(e.hasOwnProperty(c)&&e[c])return;delete r.writable,delete r.value;const u=r.get,f=r.set,_=n.substr(2);let g=Ce[_];g||(g=Ce[_]=x("ON_PROPERTY"+_)),r.set=function(T){let m=this;!m&&e===$&&(m=$),m&&(m[g]&&m.removeEventListener(_,qe),f&&f.apply(m,ht),"function"==typeof T?(m[g]=T,m.addEventListener(_,qe,!1)):m[g]=null)},r.get=function(){let T=this;if(!T&&e===$&&(T=$),!T)return null;const m=T[g];if(m)return m;if(u){let S=u&&u.call(this);if(S)return r.set.call(this,S),"function"==typeof T.removeAttribute&&T.removeAttribute(n),S}return null},he(e,n,r),e[c]=!0}function Ye(e,n,i){if(n)for(let r=0;r<n.length;r++)Xe(e,"on"+n[r],i);else{const r=[];for(const c in e)"on"==c.substr(0,2)&&r.push(c);for(let c=0;c<r.length;c++)Xe(e,r[c],i)}}const ne=x("originalInstance");function ve(e){const n=$[e];if(!n)return;$[x(e)]=n,$[e]=function(){const c=Ae(arguments,e);switch(c.length){case 0:this[ne]=new n;break;case 1:this[ne]=new n(c[0]);break;case 2:this[ne]=new n(c[0],c[1]);break;case 3:this[ne]=new n(c[0],c[1],c[2]);break;case 4:this[ne]=new n(c[0],c[1],c[2],c[3]);break;default:throw new Error("Arg list too long.")}},ae($[e],n);const i=new n(function(){});let r;for(r in i)"XMLHttpRequest"===e&&"responseBlob"===r||function(c){"function"==typeof i[c]?$[e].prototype[c]=function(){return this[ne][c].apply(this[ne],arguments)}:he($[e].prototype,c,{set:function(u){"function"==typeof u?(this[ne][c]=Le(u,e+"."+c),ae(this[ne][c],u)):this[ne][c]=u},get:function(){return this[ne][c]}})}(r);for(r in n)"prototype"!==r&&n.hasOwnProperty(r)&&($[e][r]=n[r])}function ce(e,n,i){let r=e;for(;r&&!r.hasOwnProperty(n);)r=de(r);!r&&e[n]&&(r=e);const c=x(n);let u=null;if(r&&(!(u=r[c])||!r.hasOwnProperty(c))&&(u=r[c]=r[n],Fe(r&&ue(r,n)))){const _=i(u,c,n);r[n]=function(){return _(this,arguments)},ae(r[n],u)}return u}function _t(e,n,i){let r=null;function c(u){const f=u.data;return f.args[f.cbIdx]=function(){u.invoke.apply(this,arguments)},r.apply(f.target,f.args),u}r=ce(e,n,u=>function(f,_){const g=i(f,_);return g.cbIdx>=0&&"function"==typeof _[g.cbIdx]?Me(g.name,_[g.cbIdx],g,c):u.apply(f,_)})}function ae(e,n){e[x("OriginalDelegate")]=n}let $e=!1,He=!1;function mt(){if($e)return He;$e=!0;try{const e=pe.navigator.userAgent;(-1!==e.indexOf("MSIE ")||-1!==e.indexOf("Trident/")||-1!==e.indexOf("Edge/"))&&(He=!0)}catch(e){}return He}Zone.__load_patch("ZoneAwarePromise",(e,n,i)=>{const r=Object.getOwnPropertyDescriptor,c=Object.defineProperty,f=i.symbol,_=[],g=!0===e[f("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")],T=f("Promise"),m=f("then");i.onUnhandledError=l=>{if(i.showUncaughtError()){const s=l&&l.rejection;s?console.error("Unhandled Promise rejection:",s instanceof Error?s.message:s,"; Zone:",l.zone.name,"; Task:",l.task&&l.task.source,"; Value:",s,s instanceof Error?s.stack:void 0):console.error(l)}},i.microtaskDrainDone=()=>{for(;_.length;){const l=_.shift();try{l.zone.runGuarded(()=>{throw l.throwOriginal?l.rejection:l})}catch(s){Z(s)}}};const D=f("unhandledPromiseRejectionHandler");function Z(l){i.onUnhandledError(l);try{const s=n[D];"function"==typeof s&&s.call(this,l)}catch(s){}}function B(l){return l&&l.then}function V(l){return l}function E(l){return t.reject(l)}const d=f("state"),L=f("value"),z=f("finally"),j=f("parentPromiseValue"),q=f("parentPromiseState"),X=null,A=!0,Y=!1;function M(l,s){return a=>{try{G(l,s,a)}catch(h){G(l,!1,h)}}}const le=f("currentTaskTrace");function G(l,s,a){const h=function(){let l=!1;return function(a){return function(){l||(l=!0,a.apply(null,arguments))}}}();if(l===a)throw new TypeError("Promise resolved with itself");if(l[d]===X){let w=null;try{("object"==typeof a||"function"==typeof a)&&(w=a&&a.then)}catch(C){return h(()=>{G(l,!1,C)})(),l}if(s!==Y&&a instanceof t&&a.hasOwnProperty(d)&&a.hasOwnProperty(L)&&a[d]!==X)re(a),G(l,a[d],a[L]);else if(s!==Y&&"function"==typeof w)try{w.call(a,h(M(l,s)),h(M(l,!1)))}catch(C){h(()=>{G(l,!1,C)})()}else{l[d]=s;const C=l[L];if(l[L]=a,l[z]===z&&s===A&&(l[d]=l[q],l[L]=l[j]),s===Y&&a instanceof Error){const k=n.currentTask&&n.currentTask.data&&n.currentTask.data.__creationTrace__;k&&c(a,le,{configurable:!0,enumerable:!1,writable:!0,value:k})}for(let k=0;k<C.length;)F(l,C[k++],C[k++],C[k++],C[k++]);if(0==C.length&&s==Y){l[d]=0;let k=a;try{throw new Error("Uncaught (in promise): "+function(l){return l&&l.toString===Object.prototype.toString?(l.constructor&&l.constructor.name||"")+": "+JSON.stringify(l):l?l.toString():Object.prototype.toString.call(l)}(a)+(a&&a.stack?"\n"+a.stack:""))}catch(b){k=b}g&&(k.throwOriginal=!0),k.rejection=a,k.promise=l,k.zone=n.current,k.task=n.currentTask,_.push(k),i.scheduleMicroTask()}}}return l}const te=f("rejectionHandledHandler");function re(l){if(0===l[d]){try{const s=n[te];s&&"function"==typeof s&&s.call(this,{rejection:l[L],promise:l})}catch(s){}l[d]=Y;for(let s=0;s<_.length;s++)l===_[s].promise&&_.splice(s,1)}}function F(l,s,a,h,w){re(l);const C=l[d],k=C?"function"==typeof h?h:V:"function"==typeof w?w:E;s.scheduleMicroTask("Promise.then",()=>{try{const b=l[L],N=!!a&&z===a[z];N&&(a[j]=b,a[q]=C);const H=s.run(k,void 0,N&&k!==E&&k!==V?[]:[b]);G(a,!0,H)}catch(b){G(a,!1,b)}},a)}const p=function(){};class t{static toString(){return"function ZoneAwarePromise() { [native code] }"}static resolve(s){return G(new this(null),A,s)}static reject(s){return G(new this(null),Y,s)}static race(s){let a,h,w=new this((b,N)=>{a=b,h=N});function C(b){a(b)}function k(b){h(b)}for(let b of s)B(b)||(b=this.resolve(b)),b.then(C,k);return w}static all(s){return t.allWithCallback(s)}static allSettled(s){return(this&&this.prototype instanceof t?this:t).allWithCallback(s,{thenCallback:h=>({status:"fulfilled",value:h}),errorCallback:h=>({status:"rejected",reason:h})})}static allWithCallback(s,a){let h,w,C=new this((H,U)=>{h=H,w=U}),k=2,b=0;const N=[];for(let H of s){B(H)||(H=this.resolve(H));const U=b;try{H.then(Q=>{N[U]=a?a.thenCallback(Q):Q,k--,0===k&&h(N)},Q=>{a?(N[U]=a.errorCallback(Q),k--,0===k&&h(N)):w(Q)})}catch(Q){w(Q)}k++,b++}return k-=2,0===k&&h(N),C}constructor(s){const a=this;if(!(a instanceof t))throw new Error("Must be an instanceof Promise.");a[d]=X,a[L]=[];try{s&&s(M(a,A),M(a,Y))}catch(h){G(a,!1,h)}}get[Symbol.toStringTag](){return"Promise"}get[Symbol.species](){return t}then(s,a){let h=this.constructor[Symbol.species];(!h||"function"!=typeof h)&&(h=this.constructor||t);const w=new h(p),C=n.current;return this[d]==X?this[L].push(C,w,s,a):F(this,C,w,s,a),w}catch(s){return this.then(null,s)}finally(s){let a=this.constructor[Symbol.species];(!a||"function"!=typeof a)&&(a=t);const h=new a(p);h[z]=z;const w=n.current;return this[d]==X?this[L].push(w,h,s,s):F(this,w,h,s,s),h}}t.resolve=t.resolve,t.reject=t.reject,t.race=t.race,t.all=t.all;const o=e[T]=e.Promise;e.Promise=t;const y=f("thenPatched");function P(l){const s=l.prototype,a=r(s,"then");if(a&&(!1===a.writable||!a.configurable))return;const h=s.then;s[m]=h,l.prototype.then=function(w,C){return new t((b,N)=>{h.call(this,b,N)}).then(w,C)},l[y]=!0}return i.patchThen=P,o&&(P(o),ce(e,"fetch",l=>function(l){return function(s,a){let h=l.apply(s,a);if(h instanceof t)return h;let w=h.constructor;return w[y]||P(w),h}}(l))),Promise[n.__symbol__("uncaughtPromiseErrors")]=_,t}),Zone.__load_patch("toString",e=>{const n=Function.prototype.toString,i=x("OriginalDelegate"),r=x("Promise"),c=x("Error"),u=function(){if("function"==typeof this){const T=this[i];if(T)return"function"==typeof T?n.call(T):Object.prototype.toString.call(T);if(this===Promise){const m=e[r];if(m)return n.call(m)}if(this===Error){const m=e[c];if(m)return n.call(m)}}return n.call(this)};u[i]=n,Function.prototype.toString=u;const f=Object.prototype.toString;Object.prototype.toString=function(){return"function"==typeof Promise&&this instanceof Promise?"[object Promise]":f.call(this)}});let me=!1;if("undefined"!=typeof window)try{const e=Object.defineProperty({},"passive",{get:function(){me=!0}});window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){me=!1}const Et={useG:!0},ee={},Ke={},Je=new RegExp("^"+ke+"(\\w+)(true|false)$"),xe=x("propagationStopped");function Qe(e,n){const i=(n?n(e):e)+ie,r=(n?n(e):e)+se,c=ke+i,u=ke+r;ee[e]={},ee[e][ie]=c,ee[e][se]=u}function Tt(e,n,i){const r=i&&i.add||Se,c=i&&i.rm||Oe,u=i&&i.listeners||"eventListeners",f=i&&i.rmAll||"removeAllListeners",_=x(r),g="."+r+":",S=function(E,d,L){if(E.isRemoved)return;const z=E.callback;"object"==typeof z&&z.handleEvent&&(E.callback=q=>z.handleEvent(q),E.originalDelegate=z),E.invoke(E,d,[L]);const j=E.options;j&&"object"==typeof j&&j.once&&d[c].call(d,L.type,E.originalDelegate?E.originalDelegate:E.callback,j)},D=function(E){if(!(E=E||e.event))return;const d=this||E.target||e,L=d[ee[E.type][ie]];if(L)if(1===L.length)S(L[0],d,E);else{const z=L.slice();for(let j=0;j<z.length&&(!E||!0!==E[xe]);j++)S(z[j],d,E)}},Z=function(E){if(!(E=E||e.event))return;const d=this||E.target||e,L=d[ee[E.type][se]];if(L)if(1===L.length)S(L[0],d,E);else{const z=L.slice();for(let j=0;j<z.length&&(!E||!0!==E[xe]);j++)S(z[j],d,E)}};function B(E,d){if(!E)return!1;let L=!0;d&&void 0!==d.useG&&(L=d.useG);const z=d&&d.vh;let j=!0;d&&void 0!==d.chkDup&&(j=d.chkDup);let q=!1;d&&void 0!==d.rt&&(q=d.rt);let O=E;for(;O&&!O.hasOwnProperty(r);)O=de(O);if(!O&&E[r]&&(O=E),!O||O[_])return!1;const X=d&&d.eventNameToString,A={},Y=O[_]=O[r],v=O[x(c)]=O[c],M=O[x(u)]=O[u],R=O[x(f)]=O[f];let J;function le(s,a){return!me&&"object"==typeof s&&s?!!s.capture:me&&a?"boolean"==typeof s?{capture:s,passive:!0}:s?"object"==typeof s&&!1!==s.passive?Object.assign(Object.assign({},s),{passive:!0}):s:{passive:!0}:s}d&&d.prepend&&(J=O[x(d.prepend)]=O[d.prepend]);const p=L?function(s){if(!A.isExisting)return Y.call(A.target,A.eventName,A.capture?Z:D,A.options)}:function(s){return Y.call(A.target,A.eventName,s.invoke,A.options)},t=L?function(s){if(!s.isRemoved){const a=ee[s.eventName];let h;a&&(h=a[s.capture?se:ie]);const w=h&&s.target[h];if(w)for(let C=0;C<w.length;C++)if(w[C]===s){w.splice(C,1),s.isRemoved=!0,0===w.length&&(s.allRemoved=!0,s.target[h]=null);break}}if(s.allRemoved)return v.call(s.target,s.eventName,s.capture?Z:D,s.options)}:function(s){return v.call(s.target,s.eventName,s.invoke,s.options)},y=d&&d.diff?d.diff:function(s,a){const h=typeof a;return"function"===h&&s.callback===a||"object"===h&&s.originalDelegate===a},P=Zone[x("UNPATCHED_EVENTS")],K=e[x("PASSIVE_EVENTS")],l=function(s,a,h,w,C=!1,k=!1){return function(){const b=this||e;let N=arguments[0];d&&d.transferEventName&&(N=d.transferEventName(N));let H=arguments[1];if(!H)return s.apply(this,arguments);if(Re&&"uncaughtException"===N)return s.apply(this,arguments);let U=!1;if("function"!=typeof H){if(!H.handleEvent)return s.apply(this,arguments);U=!0}if(z&&!z(s,H,b,arguments))return;const Q=me&&!!K&&-1!==K.indexOf(N),oe=le(arguments[2],Q);if(P)for(let _e=0;_e<P.length;_e++)if(N===P[_e])return Q?s.call(b,N,H,oe):s.apply(this,arguments);const Ge=!!oe&&("boolean"==typeof oe||oe.capture),st=!(!oe||"object"!=typeof oe)&&oe.once,At=Zone.current;let ze=ee[N];ze||(Qe(N,X),ze=ee[N]);const it=ze[Ge?se:ie];let De,ge=b[it],ct=!1;if(ge){if(ct=!0,j)for(let _e=0;_e<ge.length;_e++)if(y(ge[_e],H))return}else ge=b[it]=[];const at=b.constructor.name,lt=Ke[at];lt&&(De=lt[N]),De||(De=at+a+(X?X(N):N)),A.options=oe,st&&(A.options.once=!1),A.target=b,A.capture=Ge,A.eventName=N,A.isExisting=ct;const be=L?Et:void 0;be&&(be.taskData=A);const fe=At.scheduleEventTask(De,H,be,h,w);return A.target=null,be&&(be.taskData=null),st&&(oe.once=!0),!me&&"boolean"==typeof fe.options||(fe.options=oe),fe.target=b,fe.capture=Ge,fe.eventName=N,U&&(fe.originalDelegate=H),k?ge.unshift(fe):ge.push(fe),C?b:void 0}};return O[r]=l(Y,g,p,t,q),J&&(O.prependListener=l(J,".prependListener:",function(s){return J.call(A.target,A.eventName,s.invoke,A.options)},t,q,!0)),O[c]=function(){const s=this||e;let a=arguments[0];d&&d.transferEventName&&(a=d.transferEventName(a));const h=arguments[2],w=!!h&&("boolean"==typeof h||h.capture),C=arguments[1];if(!C)return v.apply(this,arguments);if(z&&!z(v,C,s,arguments))return;const k=ee[a];let b;k&&(b=k[w?se:ie]);const N=b&&s[b];if(N)for(let H=0;H<N.length;H++){const U=N[H];if(y(U,C))return N.splice(H,1),U.isRemoved=!0,0===N.length&&(U.allRemoved=!0,s[b]=null,"string"==typeof a)&&(s[ke+"ON_PROPERTY"+a]=null),U.zone.cancelTask(U),q?s:void 0}return v.apply(this,arguments)},O[u]=function(){const s=this||e;let a=arguments[0];d&&d.transferEventName&&(a=d.transferEventName(a));const h=[],w=et(s,X?X(a):a);for(let C=0;C<w.length;C++){const k=w[C];h.push(k.originalDelegate?k.originalDelegate:k.callback)}return h},O[f]=function(){const s=this||e;let a=arguments[0];if(a){d&&d.transferEventName&&(a=d.transferEventName(a));const h=ee[a];if(h){const k=s[h[ie]],b=s[h[se]];if(k){const N=k.slice();for(let H=0;H<N.length;H++){const U=N[H];this[c].call(this,a,U.originalDelegate?U.originalDelegate:U.callback,U.options)}}if(b){const N=b.slice();for(let H=0;H<N.length;H++){const U=N[H];this[c].call(this,a,U.originalDelegate?U.originalDelegate:U.callback,U.options)}}}}else{const h=Object.keys(s);for(let w=0;w<h.length;w++){const k=Je.exec(h[w]);let b=k&&k[1];b&&"removeListener"!==b&&this[f].call(this,b)}this[f].call(this,"removeListener")}if(q)return this},ae(O[r],Y),ae(O[c],v),R&&ae(O[f],R),M&&ae(O[u],M),!0}let V=[];for(let E=0;E<n.length;E++)V[E]=B(n[E],i);return V}function et(e,n){if(!n){const u=[];for(let f in e){const _=Je.exec(f);let g=_&&_[1];if(g&&(!n||g===n)){const T=e[f];if(T)for(let m=0;m<T.length;m++)u.push(T[m])}}return u}let i=ee[n];i||(Qe(n),i=ee[n]);const r=e[i[ie]],c=e[i[se]];return r?c?r.concat(c):r.slice():c?c.slice():[]}function yt(e,n){const i=e.Event;i&&i.prototype&&n.patchMethod(i.prototype,"stopImmediatePropagation",r=>function(c,u){c[xe]=!0,r&&r.apply(c,u)})}function gt(e,n,i,r,c){const u=Zone.__symbol__(r);if(n[u])return;const f=n[u]=n[r];n[r]=function(_,g,T){return g&&g.prototype&&c.forEach(function(m){const S=`${i}.${r}::`+m,D=g.prototype;if(D.hasOwnProperty(m)){const Z=e.ObjectGetOwnPropertyDescriptor(D,m);Z&&Z.value?(Z.value=e.wrapWithCurrentZone(Z.value,S),e._redefineProperty(g.prototype,m,Z)):D[m]&&(D[m]=e.wrapWithCurrentZone(D[m],S))}else D[m]&&(D[m]=e.wrapWithCurrentZone(D[m],S))}),f.call(n,_,g,T)},e.attachOriginToPatched(n[r],f)}const Ve=["absolutedeviceorientation","afterinput","afterprint","appinstalled","beforeinstallprompt","beforeprint","beforeunload","devicelight","devicemotion","deviceorientation","deviceorientationabsolute","deviceproximity","hashchange","languagechange","message","mozbeforepaint","offline","online","paint","pageshow","pagehide","popstate","rejectionhandled","storage","unhandledrejection","unload","userproximity","vrdisplayconnected","vrdisplaydisconnected","vrdisplaypresentchange"],wt=["encrypted","waitingforkey","msneedkey","mozinterruptbegin","mozinterruptend"],tt=["load"],nt=["blur","error","focus","load","resize","scroll","messageerror"],Dt=["bounce","finish","start"],rt=["loadstart","progress","abort","error","load","progress","timeout","loadend","readystatechange"],Ee=["upgradeneeded","complete","abort","success","error","blocked","versionchange","close"],St=["close","error","open","message"],Ot=["error","message"],Te=["abort","animationcancel","animationend","animationiteration","auxclick","beforeinput","blur","cancel","canplay","canplaythrough","change","compositionstart","compositionupdate","compositionend","cuechange","click","close","contextmenu","curechange","dblclick","drag","dragend","dragenter","dragexit","dragleave","dragover","drop","durationchange","emptied","ended","error","focus","focusin","focusout","gotpointercapture","input","invalid","keydown","keypress","keyup","load","loadstart","loadeddata","loadedmetadata","lostpointercapture","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","mousewheel","orientationchange","pause","play","playing","pointercancel","pointerdown","pointerenter","pointerleave","pointerlockchange","mozpointerlockchange","webkitpointerlockerchange","pointerlockerror","mozpointerlockerror","webkitpointerlockerror","pointermove","pointout","pointerover","pointerup","progress","ratechange","reset","resize","scroll","seeked","seeking","select","selectionchange","selectstart","show","sort","stalled","submit","suspend","timeupdate","volumechange","touchcancel","touchmove","touchstart","touchend","transitioncancel","transitionend","waiting","wheel"].concat(["webglcontextrestored","webglcontextlost","webglcontextcreationerror"],["autocomplete","autocompleteerror"],["toggle"],["afterscriptexecute","beforescriptexecute","DOMContentLoaded","freeze","fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange","fullscreenerror","mozfullscreenerror","webkitfullscreenerror","msfullscreenerror","readystatechange","visibilitychange","resume"],Ve,["beforecopy","beforecut","beforepaste","copy","cut","paste","dragstart","loadend","animationstart","search","transitionrun","transitionstart","webkitanimationend","webkitanimationiteration","webkitanimationstart","webkittransitionend"],["activate","afterupdate","ariarequest","beforeactivate","beforedeactivate","beforeeditfocus","beforeupdate","cellchange","controlselect","dataavailable","datasetchanged","datasetcomplete","errorupdate","filterchange","layoutcomplete","losecapture","move","moveend","movestart","propertychange","resizeend","resizestart","rowenter","rowexit","rowsdelete","rowsinserted","command","compassneedscalibration","deactivate","help","mscontentzoom","msmanipulationstatechanged","msgesturechange","msgesturedoubletap","msgestureend","msgesturehold","msgesturestart","msgesturetap","msgotpointercapture","msinertiastart","mslostpointercapture","mspointercancel","mspointerdown","mspointerenter","mspointerhover","mspointerleave","mspointermove","mspointerout","mspointerover","mspointerup","pointerout","mssitemodejumplistitemremoved","msthumbnailclick","stop","storagecommit"]);function ot(e,n,i){if(!i||0===i.length)return n;const r=i.filter(u=>u.target===e);if(!r||0===r.length)return n;const c=r[0].ignoreProperties;return n.filter(u=>-1===c.indexOf(u))}function W(e,n,i,r){e&&Ye(e,ot(e,n,i),r)}Zone.__load_patch("util",(e,n,i)=>{i.patchOnProperties=Ye,i.patchMethod=ce,i.bindArguments=Ae,i.patchMacroTask=_t;const r=n.__symbol__("BLACK_LISTED_EVENTS"),c=n.__symbol__("UNPATCHED_EVENTS");e[c]&&(e[r]=e[c]),e[r]&&(n[r]=n[c]=e[r]),i.patchEventPrototype=yt,i.patchEventTarget=Tt,i.isIEOrEdge=mt,i.ObjectDefineProperty=he,i.ObjectGetOwnPropertyDescriptor=ue,i.ObjectCreate=Be,i.ArraySlice=ut,i.patchClass=ve,i.wrapWithCurrentZone=Le,i.filterProperties=ot,i.attachOriginToPatched=ae,i._redefineProperty=Object.defineProperty,i.patchCallbacks=gt,i.getGlobalObjects=()=>({globalSources:Ke,zoneSymbolEventNames:ee,eventNames:Te,isBrowser:je,isMix:We,isNode:Re,TRUE_STR:se,FALSE_STR:ie,ZONE_SYMBOL_PREFIX:ke,ADD_EVENT_LISTENER_STR:Se,REMOVE_EVENT_LISTENER_STR:Oe})});const Ne=x("zoneTask");function ye(e,n,i,r){let c=null,u=null;i+=r;const f={};function _(T){const m=T.data;return m.args[0]=function(){return T.invoke.apply(this,arguments)},m.handleId=c.apply(e,m.args),T}function g(T){return u.call(e,T.data.handleId)}c=ce(e,n+=r,T=>function(m,S){if("function"==typeof S[0]){const D={isPeriodic:"Interval"===r,delay:"Timeout"===r||"Interval"===r?S[1]||0:void 0,args:S},Z=S[0];S[0]=function(){try{return Z.apply(this,arguments)}finally{D.isPeriodic||("number"==typeof D.handleId?delete f[D.handleId]:D.handleId&&(D.handleId[Ne]=null))}};const B=Me(n,S[0],D,_,g);if(!B)return B;const V=B.data.handleId;return"number"==typeof V?f[V]=B:V&&(V[Ne]=B),V&&V.ref&&V.unref&&"function"==typeof V.ref&&"function"==typeof V.unref&&(B.ref=V.ref.bind(V),B.unref=V.unref.bind(V)),"number"==typeof V||V?V:B}return T.apply(e,S)}),u=ce(e,i,T=>function(m,S){const D=S[0];let Z;"number"==typeof D?Z=f[D]:(Z=D&&D[Ne],Z||(Z=D)),Z&&"string"==typeof Z.type?"notScheduled"!==Z.state&&(Z.cancelFn&&Z.data.isPeriodic||0===Z.runCount)&&("number"==typeof D?delete f[D]:D&&(D[Ne]=null),Z.zone.cancelTask(Z)):T.apply(e,S)})}Zone.__load_patch("legacy",e=>{const n=e[Zone.__symbol__("legacyPatch")];n&&n()}),Zone.__load_patch("queueMicrotask",(e,n,i)=>{i.patchMethod(e,"queueMicrotask",r=>function(c,u){n.current.scheduleMicroTask("queueMicrotask",u[0])})}),Zone.__load_patch("timers",e=>{const n="set",i="clear";ye(e,n,i,"Timeout"),ye(e,n,i,"Interval"),ye(e,n,i,"Immediate")}),Zone.__load_patch("requestAnimationFrame",e=>{ye(e,"request","cancel","AnimationFrame"),ye(e,"mozRequest","mozCancel","AnimationFrame"),ye(e,"webkitRequest","webkitCancel","AnimationFrame")}),Zone.__load_patch("blocking",(e,n)=>{const i=["alert","prompt","confirm"];for(let r=0;r<i.length;r++)ce(e,i[r],(u,f,_)=>function(g,T){return n.current.run(u,e,T,_)})}),Zone.__load_patch("EventTarget",(e,n,i)=>{(function(e,n){n.patchEventPrototype(e,n)})(e,i),function(e,n){if(Zone[n.symbol("patchEventTarget")])return;const{eventNames:i,zoneSymbolEventNames:r,TRUE_STR:c,FALSE_STR:u,ZONE_SYMBOL_PREFIX:f}=n.getGlobalObjects();for(let g=0;g<i.length;g++){const T=i[g],D=f+(T+u),Z=f+(T+c);r[T]={},r[T][u]=D,r[T][c]=Z}const _=e.EventTarget;_&&_.prototype&&n.patchEventTarget(e,[_&&_.prototype])}(e,i);const r=e.XMLHttpRequestEventTarget;r&&r.prototype&&i.patchEventTarget(e,[r.prototype])}),Zone.__load_patch("MutationObserver",(e,n,i)=>{ve("MutationObserver"),ve("WebKitMutationObserver")}),Zone.__load_patch("IntersectionObserver",(e,n,i)=>{ve("IntersectionObserver")}),Zone.__load_patch("FileReader",(e,n,i)=>{ve("FileReader")}),Zone.__load_patch("on_property",(e,n,i)=>{!function(e,n){if(Re&&!We||Zone[e.symbol("patchEvents")])return;const i="undefined"!=typeof WebSocket,r=n.__Zone_ignore_on_properties;if(je){const f=window,_=function(){try{const e=pe.navigator.userAgent;if(-1!==e.indexOf("MSIE ")||-1!==e.indexOf("Trident/"))return!0}catch(e){}return!1}()?[{target:f,ignoreProperties:["error"]}]:[];W(f,Te.concat(["messageerror"]),r&&r.concat(_),de(f)),W(Document.prototype,Te,r),void 0!==f.SVGElement&&W(f.SVGElement.prototype,Te,r),W(Element.prototype,Te,r),W(HTMLElement.prototype,Te,r),W(HTMLMediaElement.prototype,wt,r),W(HTMLFrameSetElement.prototype,Ve.concat(nt),r),W(HTMLBodyElement.prototype,Ve.concat(nt),r),W(HTMLFrameElement.prototype,tt,r),W(HTMLIFrameElement.prototype,tt,r);const g=f.HTMLMarqueeElement;g&&W(g.prototype,Dt,r);const T=f.Worker;T&&W(T.prototype,Ot,r)}const c=n.XMLHttpRequest;c&&W(c.prototype,rt,r);const u=n.XMLHttpRequestEventTarget;u&&W(u&&u.prototype,rt,r),"undefined"!=typeof IDBIndex&&(W(IDBIndex.prototype,Ee,r),W(IDBRequest.prototype,Ee,r),W(IDBOpenDBRequest.prototype,Ee,r),W(IDBDatabase.prototype,Ee,r),W(IDBTransaction.prototype,Ee,r),W(IDBCursor.prototype,Ee,r)),i&&W(WebSocket.prototype,St,r)}(i,e)}),Zone.__load_patch("customElements",(e,n,i)=>{!function(e,n){const{isBrowser:i,isMix:r}=n.getGlobalObjects();(i||r)&&e.customElements&&"customElements"in e&&n.patchCallbacks(n,e.customElements,"customElements","define",["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback"])}(e,i)}),Zone.__load_patch("XHR",(e,n)=>{!function(T){const m=T.XMLHttpRequest;if(!m)return;const S=m.prototype;let Z=S[Ze],B=S[Ie];if(!Z){const v=T.XMLHttpRequestEventTarget;if(v){const M=v.prototype;Z=M[Ze],B=M[Ie]}}const V="readystatechange",E="scheduled";function d(v){const M=v.data,R=M.target;R[u]=!1,R[_]=!1;const J=R[c];Z||(Z=R[Ze],B=R[Ie]),J&&B.call(R,V,J);const le=R[c]=()=>{if(R.readyState===R.DONE)if(!M.aborted&&R[u]&&v.state===E){const te=R[n.__symbol__("loadfalse")];if(0!==R.status&&te&&te.length>0){const re=v.invoke;v.invoke=function(){const F=R[n.__symbol__("loadfalse")];for(let I=0;I<F.length;I++)F[I]===v&&F.splice(I,1);!M.aborted&&v.state===E&&re.call(v)},te.push(v)}else v.invoke()}else!M.aborted&&!1===R[u]&&(R[_]=!0)};return Z.call(R,V,le),R[i]||(R[i]=v),A.apply(R,M.args),R[u]=!0,v}function L(){}function z(v){const M=v.data;return M.aborted=!0,Y.apply(M.target,M.args)}const j=ce(S,"open",()=>function(v,M){return v[r]=0==M[2],v[f]=M[1],j.apply(v,M)}),O=x("fetchTaskAborting"),X=x("fetchTaskScheduling"),A=ce(S,"send",()=>function(v,M){if(!0===n.current[X]||v[r])return A.apply(v,M);{const R={target:v,url:v[f],isPeriodic:!1,args:M,aborted:!1},J=Me("XMLHttpRequest.send",L,R,d,z);v&&!0===v[_]&&!R.aborted&&J.state===E&&J.invoke()}}),Y=ce(S,"abort",()=>function(v,M){const R=function(v){return v[i]}(v);if(R&&"string"==typeof R.type){if(null==R.cancelFn||R.data&&R.data.aborted)return;R.zone.cancelTask(R)}else if(!0===n.current[O])return Y.apply(v,M)})}(e);const i=x("xhrTask"),r=x("xhrSync"),c=x("xhrListener"),u=x("xhrScheduled"),f=x("xhrURL"),_=x("xhrErrorBeforeScheduled")}),Zone.__load_patch("geolocation",e=>{e.navigator&&e.navigator.geolocation&&function(e,n){const i=e.constructor.name;for(let r=0;r<n.length;r++){const c=n[r],u=e[c];if(u){if(!Fe(ue(e,c)))continue;e[c]=(_=>{const g=function(){return _.apply(this,Ae(arguments,i+"."+c))};return ae(g,_),g})(u)}}}(e.navigator.geolocation,["getCurrentPosition","watchPosition"])}),Zone.__load_patch("PromiseRejectionEvent",(e,n)=>{function i(r){return function(c){et(e,r).forEach(f=>{const _=e.PromiseRejectionEvent;if(_){const g=new _(r,{promise:c.promise,reason:c.rejection});f.invoke(g)}})}}e.PromiseRejectionEvent&&(n[x("unhandledPromiseRejectionHandler")]=i("unhandledrejection"),n[x("rejectionHandledHandler")]=i("rejectionhandled"))})},416:(we,ue,he)=>{he(277)}},we=>{we(we.s=416)}]);
/*! (C) Andrea Giammarchi - @WebReflection - ISC Style License */
!function(e,t){"use strict";function n(){var e=C.splice(0,C.length);for(We=0;e.length;)e.shift().call(null,e.shift())}function r(e,t){for(var n=0,r=e.length;n<r;n++)p(e[n],t)}function o(e){return function(t){Re(t)&&(p(t,e),le.length&&r(t.querySelectorAll(le),e))}}function l(e){var t=Be.call(e,"is"),n=e.nodeName.toUpperCase(),r=ie.call(re,t?ee+t.toUpperCase():J+n);return t&&-1<r&&!a(n,t)?-1:r}function a(e,t){return-1<le.indexOf(e+'[is="'+t+'"]')}function i(e){var t=e.currentTarget,n=e.attrChange,r=e.attrName,o=e.target,l=e[X]||2,a=e[$]||3;!rt||o&&o!==t||!t[B]||"style"===r||e.prevValue===e.newValue&&(""!==e.newValue||n!==l&&n!==a)||t[B](r,n===l?null:e.prevValue,n===a?null:e.newValue)}function u(e){var t=o(e);return function(e){C.push(t,e.target),We&&clearTimeout(We),We=setTimeout(n,1)}}function c(e){nt&&(nt=!1,e.currentTarget.removeEventListener(W,c)),le.length&&r((e.target||g).querySelectorAll(le),e.detail===x?x:_),Ve&&function(){for(var e,t=0,n=Ue.length;t<n;t++)e=Ue[t],ae.contains(e)||(n--,Ue.splice(t--,1),p(e,x))}()}function s(e,t){var n=this;Ge.call(n,e,t),w.call(n,{target:n})}function m(e,t,n){var r=t.apply(e,n),o=l(r);return-1<o&&F(r,oe[o]),n.pop()&&le.length&&function(e){for(var t,n=0,r=e.length;n<r;n++)t=e[n],F(t,oe[l(t)])}(r.querySelectorAll(le)),r}function f(e,t){De(e,t),N?N.observe(e,$e):(tt&&(e.setAttribute=s,e[R]=O(e),e[U](Y,w)),e[U](Q,i)),e[z]&&rt&&(e.created=!0,e[z](),e.created=!1)}function d(e){throw new Error("A "+e+" type is already registered")}function p(e,t){var n,r,o=l(e);-1<o&&!xe.call(e,"TEMPLATE")&&(I(e,oe[o]),o=0,t!==_||e[_]?t!==x||e[x]||(e[_]=!1,e[x]=!0,r="disconnected",o=1):(e[x]=!1,e[_]=!0,r="connected",o=1,Ve&&ie.call(Ue,e)<0&&Ue.push(e)),o&&(n=e[t+k]||e[r+k])&&n.call(e))}function h(){}function T(e,t,n){var r=n&&n[q]||"",o=t.prototype,l=Ne(o),a=t.observedAttributes||fe,i={prototype:l};Pe(l,z,{value:function(){if(ye)ye=!1;else if(!this[Me]){this[Me]=!0,new t(this),o[z]&&o[z].call(this);var e=Ce[Ae.get(t)];(!ve||e.create.length>1)&&E(this)}}}),Pe(l,B,{value:function(e){-1<ie.call(a,e)&&o[B]&&o[B].apply(this,arguments)}}),o[j]&&Pe(l,Z,{value:o[j]}),o[G]&&Pe(l,K,{value:o[G]}),r&&(i[q]=r),e=e.toUpperCase(),Ce[e]={constructor:t,create:r?[r,Oe(e)]:[e]},Ae.set(t,e),g[V](e.toLowerCase(),i),v(e),we[e].r()}function L(e){var t=Ce[e.toUpperCase()];return t&&t.constructor}function M(e){return"string"==typeof e?e:e&&e.is||""}function E(e){for(var t,n=e[B],r=n?e.attributes:fe,o=r.length;o--;)t=r[o],n.call(e,t.name||t.nodeName,null,t.value||t.nodeValue)}function v(e){return(e=e.toUpperCase())in we||(we[e]={},we[e].p=new be(function(t){we[e].r=t})),we[e].p}function H(){Ee&&delete e.customElements,me(e,"customElements",{configurable:!0,value:new h}),me(e,"CustomElementRegistry",{configurable:!0,value:h});for(var t=y.get(/^HTML[A-Z]*[a-z]/),n=t.length;n--;function(t){var n=e[t];if(n){e[t]=function(e){var t,r;return e||(e=this),e[Me]||(ye=!0,t=Ce[Ae.get(e.constructor)],(e=(r=ve&&1===t.create.length)?Reflect.construct(n,fe,t.constructor):g.createElement.apply(g,t.create))[Me]=!0,ye=!1,r||E(e)),e},e[t].prototype=n.prototype;try{n.prototype.constructor=e[t]}catch(r){!0,me(n,Me,{value:e[t]})}}}(t[n]));g.createElement=function(e,t){var n=M(t);return n?Xe.call(this,e,Oe(n)):Xe.call(this,e)},Ye||(et=!0,g[V](""))}var g=e.document,b=e.Object,y=function(e){var t,n,r,o,l=/^[A-Z]+[a-z]/,a=function(e,t){(t=t.toLowerCase())in i||(i[e]=(i[e]||[]).concat(t),i[t]=i[t.toUpperCase()]=e)},i=(b.create||b)(null),u={};for(n in e)for(o in e[n])for(r=e[n][o],i[o]=r,t=0;t<r.length;t++)i[r[t].toLowerCase()]=i[r[t].toUpperCase()]=o;return u.get=function(e){return"string"==typeof e?i[e]||(l.test(e)?[]:""):function(e){var t,n=[];for(t in i)e.test(t)&&n.push(t);return n}(e)},u.set=function(e,t){return l.test(e)?a(e,t):a(t,e),u},u}({collections:{HTMLAllCollection:["all"],HTMLCollection:["forms"],HTMLFormControlsCollection:["elements"],HTMLOptionsCollection:["options"]},elements:{Element:["element"],HTMLAnchorElement:["a"],HTMLAppletElement:["applet"],HTMLAreaElement:["area"],HTMLAttachmentElement:["attachment"],HTMLAudioElement:["audio"],HTMLBRElement:["br"],HTMLBaseElement:["base"],HTMLBodyElement:["body"],HTMLButtonElement:["button"],HTMLCanvasElement:["canvas"],HTMLContentElement:["content"],HTMLDListElement:["dl"],HTMLDataElement:["data"],HTMLDataListElement:["datalist"],HTMLDetailsElement:["details"],HTMLDialogElement:["dialog"],HTMLDirectoryElement:["dir"],HTMLDivElement:["div"],HTMLDocument:["document"],HTMLElement:["element","abbr","address","article","aside","b","bdi","bdo","cite","code","command","dd","dfn","dt","em","figcaption","figure","footer","header","i","kbd","mark","nav","noscript","rp","rt","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr"],HTMLEmbedElement:["embed"],HTMLFieldSetElement:["fieldset"],HTMLFontElement:["font"],HTMLFormElement:["form"],HTMLFrameElement:["frame"],HTMLFrameSetElement:["frameset"],HTMLHRElement:["hr"],HTMLHeadElement:["head"],HTMLHeadingElement:["h1","h2","h3","h4","h5","h6"],HTMLHtmlElement:["html"],HTMLIFrameElement:["iframe"],HTMLImageElement:["img"],HTMLInputElement:["input"],HTMLKeygenElement:["keygen"],HTMLLIElement:["li"],HTMLLabelElement:["label"],HTMLLegendElement:["legend"],HTMLLinkElement:["link"],HTMLMapElement:["map"],HTMLMarqueeElement:["marquee"],HTMLMediaElement:["media"],HTMLMenuElement:["menu"],HTMLMenuItemElement:["menuitem"],HTMLMetaElement:["meta"],HTMLMeterElement:["meter"],HTMLModElement:["del","ins"],HTMLOListElement:["ol"],HTMLObjectElement:["object"],HTMLOptGroupElement:["optgroup"],HTMLOptionElement:["option"],HTMLOutputElement:["output"],HTMLParagraphElement:["p"],HTMLParamElement:["param"],HTMLPictureElement:["picture"],HTMLPreElement:["pre"],HTMLProgressElement:["progress"],HTMLQuoteElement:["blockquote","q","quote"],HTMLScriptElement:["script"],HTMLSelectElement:["select"],HTMLShadowElement:["shadow"],HTMLSlotElement:["slot"],HTMLSourceElement:["source"],HTMLSpanElement:["span"],HTMLStyleElement:["style"],HTMLTableCaptionElement:["caption"],HTMLTableCellElement:["td","th"],HTMLTableColElement:["col","colgroup"],HTMLTableElement:["table"],HTMLTableRowElement:["tr"],HTMLTableSectionElement:["thead","tbody","tfoot"],HTMLTemplateElement:["template"],HTMLTextAreaElement:["textarea"],HTMLTimeElement:["time"],HTMLTitleElement:["title"],HTMLTrackElement:["track"],HTMLUListElement:["ul"],HTMLUnknownElement:["unknown","vhgroupv","vkeygen"],HTMLVideoElement:["video"]},nodes:{Attr:["node"],Audio:["audio"],CDATASection:["node"],CharacterData:["node"],Comment:["#comment"],Document:["#document"],DocumentFragment:["#document-fragment"],DocumentType:["node"],HTMLDocument:["#document"],Image:["img"],Option:["option"],ProcessingInstruction:["node"],ShadowRoot:["#shadow-root"],Text:["#text"],XMLDocument:["xml"]}});"object"!=typeof t&&(t={type:t||"auto"});var C,w,A,O,N,D,I,F,S,V="registerElement",P=1e5*e.Math.random()>>0,R="__"+V+P,U="addEventListener",_="attached",k="Callback",x="detached",q="extends",B="attributeChanged"+k,Z=_+k,j="connected"+k,G="disconnected"+k,z="created"+k,K=x+k,X="ADDITION",$="REMOVAL",Q="DOMAttrModified",W="DOMContentLoaded",Y="DOMSubtreeModified",J="<",ee="=",te=/^[A-Z][._A-Z0-9]*-[-._A-Z0-9]*$/,ne=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],re=[],oe=[],le="",ae=g.documentElement,ie=re.indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},ue=b.prototype,ce=ue.hasOwnProperty,se=ue.isPrototypeOf,me=b.defineProperty,fe=[],de=b.getOwnPropertyDescriptor,pe=b.getOwnPropertyNames,he=b.getPrototypeOf,Te=b.setPrototypeOf,Le=!!b.__proto__,Me="__dreCEv1",Ee=e.customElements,ve=!/^force/.test(t.type)&&!!(Ee&&Ee.define&&Ee.get&&Ee.whenDefined),He=b.create||b,ge=e.Map||function(){var e,t=[],n=[];return{get:function(e){return n[ie.call(t,e)]},set:function(r,o){(e=ie.call(t,r))<0?n[t.push(r)-1]=o:n[e]=o}}},be=e.Promise||function(e){function t(e){for(r=!0;n.length;)n.shift()(e)}var n=[],r=!1,o={catch:function(){return o},then:function(e){return n.push(e),r&&setTimeout(t,1),o}};return e(t),o},ye=!1,Ce=He(null),we=He(null),Ae=new ge,Oe=function(e){return e.toLowerCase()},Ne=b.create||function e(t){return t?(e.prototype=t,new e):this},De=Te||(Le?function(e,t){return e.__proto__=t,e}:pe&&de?function(){function e(e,t){for(var n,r=pe(t),o=0,l=r.length;o<l;o++)n=r[o],ce.call(e,n)||me(e,n,de(t,n))}return function(t,n){do{e(t,n)}while((n=he(n))&&!se.call(n,t));return t}}():function(e,t){for(var n in t)e[n]=t[n];return e}),Ie=e.MutationObserver||e.WebKitMutationObserver,Fe=e.HTMLAnchorElement,Se=(e.HTMLElement||e.Element||e.Node).prototype,Ve=!se.call(Se,ae),Pe=Ve?function(e,t,n){return e[t]=n.value,e}:me,Re=Ve?function(e){return 1===e.nodeType}:function(e){return se.call(Se,e)},Ue=Ve&&[],_e=Se.attachShadow,ke=Se.cloneNode,xe=Se.closest||function(e){for(var t=this;t&&t.nodeName!==e;)t=t.parentNode;return t},qe=Se.dispatchEvent,Be=Se.getAttribute,Ze=Se.hasAttribute,je=Se.removeAttribute,Ge=Se.setAttribute,ze=g.createElement,Ke=g.importNode,Xe=ze,$e=Ie&&{attributes:!0,characterData:!0,attributeOldValue:!0},Qe=Ie||function(e){tt=!1,ae.removeEventListener(Q,Qe)},We=0,Ye=V in g&&!/^force-all/.test(t.type),Je=!0,et=!1,tt=!0,nt=!0,rt=!0;if(Ie&&((S=g.createElement("div")).innerHTML="<div><div></div></div>",new Ie(function(e,t){if(e[0]&&"childList"==e[0].type&&!e[0].removedNodes[0].childNodes.length){var n=(S=de(Se,"innerHTML"))&&S.set;n&&me(Se,"innerHTML",{set:function(e){for(;this.lastChild;)this.removeChild(this.lastChild);n.call(this,e)}})}t.disconnect(),S=null}).observe(S,{childList:!0,subtree:!0}),S.innerHTML=""),Ye||(Te||Le?(I=function(e,t){se.call(t,e)||f(e,t)},F=f):F=I=function(e,t){e[R]||(e[R]=b(!0),f(e,t))},Ve?(tt=!1,function(){var e=de(Se,U),t=e.value,n=function(e){var t=new CustomEvent(Q,{bubbles:!0});t.attrName=e,t.prevValue=Be.call(this,e),t.newValue=null,t[$]=t.attrChange=2,je.call(this,e),qe.call(this,t)},r=function(e,t){var n=Ze.call(this,e),r=n&&Be.call(this,e),o=new CustomEvent(Q,{bubbles:!0});Ge.call(this,e,t),o.attrName=e,o.prevValue=n?r:null,o.newValue=t,n?o.MODIFICATION=o.attrChange=1:o[X]=o.attrChange=0,qe.call(this,o)},o=function(e){var t,n=e.currentTarget,r=n[R],o=e.propertyName;r.hasOwnProperty(o)&&(r=r[o],(t=new CustomEvent(Q,{bubbles:!0})).attrName=r.name,t.prevValue=r.value||null,t.newValue=r.value=n[o]||null,null==t.prevValue?t[X]=t.attrChange=0:t.MODIFICATION=t.attrChange=1,qe.call(n,t))};e.value=function(e,l,a){e===Q&&this[B]&&this.setAttribute!==r&&(this[R]={className:{name:"class",value:this.className}},this.setAttribute=r,this.removeAttribute=n,t.call(this,"propertychange",o)),t.call(this,e,l,a)},me(Se,U,e)}()):Ie||(ae[U](Q,Qe),ae.setAttribute(R,1),ae.removeAttribute(R),tt&&(w=function(e){var t,n,r,o=this;if(o===e.target){for(r in t=o[R],o[R]=n=O(o),n){if(!(r in t))return A(0,o,r,t[r],n[r],X);if(n[r]!==t[r])return A(1,o,r,t[r],n[r],"MODIFICATION")}for(r in t)if(!(r in n))return A(2,o,r,t[r],n[r],$)}},A=function(e,t,n,r,o,l){var a={attrChange:e,currentTarget:t,attrName:n,prevValue:r,newValue:o};a[l]=e,i(a)},O=function(e){for(var t,n,r={},o=e.attributes,l=0,a=o.length;l<a;l++)"setAttribute"!==(n=(t=o[l]).name)&&(r[n]=t.value);return r})),g[V]=function(e,t){if(n=e.toUpperCase(),Je&&(Je=!1,Ie?(N=function(e,t){function n(e,t){for(var n=0,r=e.length;n<r;t(e[n++]));}return new Ie(function(r){for(var o,l,a,i=0,u=r.length;i<u;i++)"childList"===(o=r[i]).type?(n(o.addedNodes,e),n(o.removedNodes,t)):(l=o.target,rt&&l[B]&&"style"!==o.attributeName&&(a=Be.call(l,o.attributeName))!==o.oldValue&&l[B](o.attributeName,o.oldValue,a))})}(o(_),o(x)),(D=function(e){return N.observe(e,{childList:!0,subtree:!0}),e})(g),_e&&(Se.attachShadow=function(){return D(_e.apply(this,arguments))})):(C=[],g[U]("DOMNodeInserted",u(_)),g[U]("DOMNodeRemoved",u(x))),g[U](W,c),g[U]("readystatechange",c),g.importNode=function(e,t){switch(e.nodeType){case 1:return m(g,Ke,[e,!!t]);case 11:for(var n=g.createDocumentFragment(),r=e.childNodes,o=r.length,l=0;l<o;l++)n.appendChild(g.importNode(r[l],!!t));return n;default:return ke.call(e,!!t)}},Se.cloneNode=function(e){return m(this,ke,[!!e])}),et)return et=!1;if(-2<ie.call(re,ee+n)+ie.call(re,J+n)&&d(e),!te.test(n)||-1<ie.call(ne,n))throw new Error("The type "+e+" is invalid");var n,l,a=function(){return s?g.createElement(f,n):g.createElement(f)},i=t||ue,s=ce.call(i,q),f=s?t[q].toUpperCase():n;return s&&-1<ie.call(re,J+f)&&d(f),l=re.push((s?ee:J)+n)-1,le=le.concat(le.length?",":"",s?f+'[is="'+e.toLowerCase()+'"]':f),a.prototype=oe[l]=ce.call(i,"prototype")?i.prototype:Ne(Se),le.length&&r(g.querySelectorAll(le),_),a},g.createElement=Xe=function(e,t){var n=M(t),r=n?ze.call(g,e,Oe(n)):ze.call(g,e),o=""+e,l=ie.call(re,(n?ee:J)+(n||o).toUpperCase()),i=-1<l;return n&&(r.setAttribute("is",n=n.toLowerCase()),i&&(i=a(o.toUpperCase(),n))),rt=!g.createElement.innerHTMLHelper,i&&F(r,oe[l]),r}),addEventListener("beforeunload",function(){delete g.createElement,delete g.importNode,delete g[V]},!1),h.prototype={constructor:h,define:ve?function(e,t,n){if(n)T(e,t,n);else{var r=e.toUpperCase();Ce[r]={constructor:t,create:[r]},Ae.set(t,r),Ee.define(e,t)}}:T,get:ve?function(e){return Ee.get(e)||L(e)}:L,whenDefined:ve?function(e){return be.race([Ee.whenDefined(e),v(e)])}:v},!Ee||/^force/.test(t.type))H();else if(!t.noBuiltIn)try{!function(t,n,r){var o=new RegExp("^<a\\s+is=('|\")"+r+"\\1></a>$");if(n[q]="a",(t.prototype=Ne(Fe.prototype)).constructor=t,e.customElements.define(r,t,n),!o.test(g.createElement("a",{is:r}).outerHTML)||!o.test((new t).outerHTML))throw n}(function e(){return Reflect.construct(Fe,[],e)},{},"document-register-element-a"+P)}catch(e){H()}if(!t.noBuiltIn)try{if(ze.call(g,"a","a").outerHTML.indexOf("is")<0)throw{}}catch(e){Oe=function(e){return{is:e.toLowerCase()}}}}(window);
var HRe=Object.defineProperty,GRe=Object.defineProperties,$Re=Object.getOwnPropertyDescriptors,AC=Object.getOwnPropertySymbols,N7=Object.prototype.hasOwnProperty,P7=Object.prototype.propertyIsEnumerable,_r=Math.pow,F7=(kt,it,tt)=>it in kt?HRe(kt,it,{enumerable:!0,configurable:!0,writable:!0,value:tt}):kt[it]=tt,ht=(kt,it)=>{for(var tt in it||(it={}))N7.call(it,tt)&&F7(kt,tt,it[tt]);if(AC)for(var tt of AC(it))P7.call(it,tt)&&F7(kt,tt,it[tt]);return kt},Un=(kt,it)=>GRe(kt,$Re(it)),L7=(kt,it)=>{var tt={};for(var gt in kt)N7.call(kt,gt)&&it.indexOf(gt)<0&&(tt[gt]=kt[gt]);if(null!=kt&&AC)for(var gt of AC(kt))it.indexOf(gt)<0&&P7.call(kt,gt)&&(tt[gt]=kt[gt]);return tt};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:(kt,it,tt)=>{var gt=tt(52).default;kt.exports=function K(Ae,he,q){function V($,b){if(!he[$]){if(!Ae[$]){if(L)return L($,!0);var O=new Error("Cannot find module '"+$+"'");throw O.code="MODULE_NOT_FOUND",O}var T=he[$]={exports:{}};Ae[$][0].call(T.exports,function(v){return V(Ae[$][1][v]||v)},T,T.exports,K,Ae,he,q)}return he[$].exports}for(var L=void 0,re=0;re<q.length;re++)V(q[re]);return V}({1:[function(K,Ae,he){var q,V;q=this,V=function(q,V,L,re,$){"use strict";function D(Ee,Re,Ue,qe){return new(Ue||(Ue=Promise))(function(z,X){function be(wt){try{Pe(qe.next(wt))}catch(pt){X(pt)}}function ce(wt){try{Pe(qe.throw(wt))}catch(pt){X(pt)}}function Pe(wt){wt.done?z(wt.value):function(z){return z instanceof Ue?z:new Ue(function(X){X(z)})}(wt.value).then(be,ce)}Pe((qe=qe.apply(Ee,Re||[])).next())})}function j(Ee,Re){var qe,Be,z,X,Ue={label:0,sent:function(){if(1&z[0])throw z[1];return z[1]},trys:[],ops:[]};return X={next:be(0),throw:be(1),return:be(2)},"function"==typeof Symbol&&(X[Symbol.iterator]=function(){return this}),X;function be(Pe){return function(wt){return function(Pe){if(qe)throw new TypeError("Generator is already executing.");for(;Ue;)try{if(qe=1,Be&&(z=2&Pe[0]?Be.return:Pe[0]?Be.throw||((z=Be.return)&&z.call(Be),0):Be.next)&&!(z=z.call(Be,Pe[1])).done)return z;switch(Be=0,z&&(Pe=[2&Pe[0],z.value]),Pe[0]){case 0:case 1:z=Pe;break;case 4:return Ue.label++,{value:Pe[1],done:!1};case 5:Ue.label++,Be=Pe[1],Pe=[0];continue;case 7:Pe=Ue.ops.pop(),Ue.trys.pop();continue;default:if(!(z=(z=Ue.trys).length>0&&z[z.length-1])&&(6===Pe[0]||2===Pe[0])){Ue=0;continue}if(3===Pe[0]&&(!z||Pe[1]>z[0]&&Pe[1]<z[3])){Ue.label=Pe[1];break}if(6===Pe[0]&&Ue.label<z[1]){Ue.label=z[1],z=Pe;break}if(z&&Ue.label<z[2]){Ue.label=z[2],Ue.ops.push(Pe);break}z[2]&&Ue.ops.pop(),Ue.trys.pop();continue}Pe=Re.call(Ee,Ue)}catch(wt){Pe=[6,wt],Be=0}finally{qe=z=0}if(5&Pe[0])throw Pe[1];return{value:Pe[0]?Pe[1]:void 0,done:!0}}([Pe,wt])}}}function nt(Ee){var Re=Ee.length,Ue=0;return new $.Readable({objectMode:!0,read:function(){this.push(Ue<Re?Ee[Ue++]:null)}})}q.addJsonLdToStore=function(Ee,Re){return D(this,void 0,void 0,function(){var Ue,qe,Be;return j(this,function(z){switch(z.label){case 0:return"string"!=typeof Ee?[3,4]:[4,fetch(Ee,{redirect:"follow"})];case 1:return(qe=z.sent()).ok?[4,qe.json()]:[3,3];case 2:Ue=z.sent(),z.label=3;case 3:return[3,5];case 4:Ue=Ee,z.label=5;case 5:return Ue?[4,V.toRDF(Ue)]:[3,7];case 6:Be=z.sent(),Re.import(nt(Be)),z.label=7;case 7:return[2,Re]}})})},q.addN3ToStore=function(Ee,Re){return D(this,void 0,void 0,function(){var Ue,qe,Be;return j(this,function(z){switch(z.label){case 0:return"string"==typeof Ee&&(null==Ee?void 0:Ee.startsWith("http"))?[4,fetch(Ee,{redirect:"follow"})]:[3,4];case 1:return(qe=z.sent()).ok?[4,qe.text()]:[3,3];case 2:Ue=z.sent(),z.label=3;case 3:return[3,5];case 4:Ue=Ee,z.label=5;case 5:return Ue&&(Be=new L.Parser({format:"n3"}).parse(Ue),Re.import(nt(Be))),[2,Re]}})})},q.addRdfXmlToStore=function(Ee,Re){return D(this,void 0,void 0,function(){var Ue,qe,Be,z;return j(this,function(X){switch(X.label){case 0:return"string"==typeof Ee&&(null==Ee?void 0:Ee.startsWith("http"))?[4,fetch(Ee,{redirect:"follow"})]:[3,4];case 1:return(qe=X.sent()).ok?[4,qe.text()]:[3,3];case 2:Ue=X.sent(),X.label=3;case 3:return[3,5];case 4:Ue=Ee,X.label=5;case 5:return Ue?(Be=new re.RdfXmlParser({dataFactory:L.DataFactory,strict:!0}),z=new Promise(function(be){Be.once("end",function(){return be(Re)})}),Re.import(Be),Be.write(Ue),Be.end(),[2,z]):[2,Re]}})})},q.arrayToStream=nt,q.deserializeN3Store=function(Ee,Re){var Ue=JSON.parse(Ee),qe=new L.Store;return Object.assign(qe,Ue,{_factory:null!=Re?Re:L.DataFactory}),qe},q.serializeN3Store=function(Ee){var Re=Object.assign({},Ee);return delete Re._factory,JSON.stringify(Re)},q.streamToArray=function(Ee){return new Promise(function(Re,Ue){var qe=[];Ee.on("data",function(Be){qe.push(Be)}).once("end",function(){Re(qe)}).once("error",function(Be){Ue(Be)})})},Object.keys(L).forEach(function(Ee){"default"!==Ee&&!q.hasOwnProperty(Ee)&&Object.defineProperty(q,Ee,{enumerable:!0,get:function(){return L[Ee]}})}),Object.defineProperty(q,"__esModule",{value:!0})},"object"==typeof he&&void 0!==Ae?V(he,K("jsonld"),K("n3"),K("rdfxml-streaming-parser"),K("readable-stream")):V((q="undefined"!=typeof globalThis?globalThis:q||self).tripleStoreUtils={},q.jsonld,q.n3,q.rdfxmlStreamingParser,q.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(K,Ae,he){"use strict";he.byteLength=function(j){var I=S(j),Y=I[1];return 3*(I[0]+Y)/4-Y},he.toByteArray=function(j){var I,U,H=S(j),Y=H[0],M=H[1],F=new L(function(j,I,H){return 3*(I+H)/4-H}(0,Y,M)),Q=0,E=M>0?Y-4:Y;for(U=0;U<E;U+=4)I=V[j.charCodeAt(U)]<<18|V[j.charCodeAt(U+1)]<<12|V[j.charCodeAt(U+2)]<<6|V[j.charCodeAt(U+3)],F[Q++]=I>>16&255,F[Q++]=I>>8&255,F[Q++]=255&I;return 2===M&&(I=V[j.charCodeAt(U)]<<2|V[j.charCodeAt(U+1)]>>4,F[Q++]=255&I),1===M&&(I=V[j.charCodeAt(U)]<<10|V[j.charCodeAt(U+1)]<<4|V[j.charCodeAt(U+2)]>>2,F[Q++]=I>>8&255,F[Q++]=255&I),F},he.fromByteArray=function(j){for(var I,H=j.length,Y=H%3,M=[],F=16383,Q=0,E=H-Y;Q<E;Q+=F)M.push(w(j,Q,Q+F>E?E:Q+F));return 1===Y?M.push(q[(I=j[H-1])>>2]+q[I<<4&63]+"=="):2===Y&&M.push(q[(I=(j[H-2]<<8)+j[H-1])>>10]+q[I>>4&63]+q[I<<2&63]+"="),M.join("")};for(var q=[],V=[],L="undefined"!=typeof Uint8Array?Uint8Array:Array,re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$=0,b=re.length;$<b;++$)q[$]=re[$],V[re.charCodeAt($)]=$;function S(j){var I=j.length;if(I%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var H=j.indexOf("=");return-1===H&&(H=I),[H,H===I?0:4-H%4]}function y(j){return q[j>>18&63]+q[j>>12&63]+q[j>>6&63]+q[63&j]}function w(j,I,H){for(var M=[],F=I;F<H;F+=3)M.push(y((j[F]<<16&16711680)+(j[F+1]<<8&65280)+(255&j[F+2])));return M.join("")}V["-".charCodeAt(0)]=62,V["_".charCodeAt(0)]=63},{}],3:[function(K,Ae,he){},{}],4:[function(K,Ae,he){var q=K("buffer"),V=q.Buffer;function L($,b){for(var S in $)b[S]=$[S]}function re($,b,S){return V($,b,S)}V.from&&V.alloc&&V.allocUnsafe&&V.allocUnsafeSlow?Ae.exports=q:(L(q,he),he.Buffer=re),L(V,re),re.from=function($,b,S){if("number"==typeof $)throw new TypeError("Argument must not be a number");return V($,b,S)},re.alloc=function($,b,S){if("number"!=typeof $)throw new TypeError("Argument must be a number");var O=V($);return void 0!==b?"string"==typeof S?O.fill(b,S):O.fill(b):O.fill(0),O},re.allocUnsafe=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return V($)},re.allocUnsafeSlow=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return q.SlowBuffer($)}},{buffer:6}],5:[function(K,Ae,he){"use strict";var q=K("safe-buffer").Buffer,V=q.isEncoding||function(M){switch((M=""+M)&&M.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function $(M){var F;switch(this.encoding=function(M){var F=function(M){if(!M)return"utf8";for(var F;;)switch(M){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return M;default:if(F)return;M=(""+M).toLowerCase(),F=!0}}(M);if("string"!=typeof F&&(q.isEncoding===V||!V(M)))throw new Error("Unknown encoding: "+M);return F||M}(M),this.encoding){case"utf16le":this.text=w,this.end=D,F=4;break;case"utf8":this.fillLast=T,F=4;break;case"base64":this.text=j,this.end=I,F=3;break;default:return this.write=H,void(this.end=Y)}this.lastNeed=0,this.lastTotal=0,this.lastChar=q.allocUnsafe(F)}function b(M){return M<=127?0:M>>5==6?2:M>>4==14?3:M>>3==30?4:M>>6==2?-1:-2}function T(M){var F=this.lastTotal-this.lastNeed,Q=function(M,F,Q){if(128!=(192&F[0]))return M.lastNeed=0,"\ufffd";if(M.lastNeed>1&&F.length>1){if(128!=(192&F[1]))return M.lastNeed=1,"\ufffd";if(M.lastNeed>2&&F.length>2&&128!=(192&F[2]))return M.lastNeed=2,"\ufffd"}}(this,M);return void 0!==Q?Q:this.lastNeed<=M.length?(M.copy(this.lastChar,F,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(M.copy(this.lastChar,F,0,M.length),void(this.lastNeed-=M.length))}function w(M,F){if((M.length-F)%2==0){var Q=M.toString("utf16le",F);if(Q){var E=Q.charCodeAt(Q.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=M[M.length-2],this.lastChar[1]=M[M.length-1],Q.slice(0,-1)}return Q}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=M[M.length-1],M.toString("utf16le",F,M.length-1)}function D(M){var F=M&&M.length?this.write(M):"";return this.lastNeed?F+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):F}function j(M,F){var Q=(M.length-F)%3;return 0===Q?M.toString("base64",F):(this.lastNeed=3-Q,this.lastTotal=3,1===Q?this.lastChar[0]=M[M.length-1]:(this.lastChar[0]=M[M.length-2],this.lastChar[1]=M[M.length-1]),M.toString("base64",F,M.length-Q))}function I(M){var F=M&&M.length?this.write(M):"";return this.lastNeed?F+this.lastChar.toString("base64",0,3-this.lastNeed):F}function H(M){return M.toString(this.encoding)}function Y(M){return M&&M.length?this.write(M):""}he.StringDecoder=$,$.prototype.write=function(M){if(0===M.length)return"";var F,Q;if(this.lastNeed){if(void 0===(F=this.fillLast(M)))return"";Q=this.lastNeed,this.lastNeed=0}else Q=0;return Q<M.length?F?F+this.text(M,Q):this.text(M,Q):F||""},$.prototype.end=function(M){var F=M&&M.length?this.write(M):"";return this.lastNeed?F+"\ufffd":F},$.prototype.text=function(M,F){var Q=function(M,F,Q){var E=F.length-1;if(E<Q)return 0;var U=b(F[E]);return U>=0?(U>0&&(M.lastNeed=U-1),U):--E<Q||-2===U?0:(U=b(F[E]))>=0?(U>0&&(M.lastNeed=U-2),U):--E<Q||-2===U?0:(U=b(F[E]))>=0?(U>0&&(2===U?U=0:M.lastNeed=U-3),U):0}(this,M,F);if(!this.lastNeed)return M.toString("utf8",F);this.lastTotal=Q;var E=M.length-(Q-this.lastNeed);return M.copy(this.lastChar,0,E),M.toString("utf8",F,E)},$.prototype.fillLast=function(M){if(this.lastNeed<=M.length)return M.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);M.copy(this.lastChar,this.lastTotal-this.lastNeed,0,M.length),this.lastNeed-=M.length}},{"safe-buffer":4}],6:[function(K,Ae,he){(function(q){(function(){"use strict";var V=K("base64-js"),L=K("ieee754");he.Buffer=S,he.SlowBuffer=function(B){return+B!=B&&(B=0),S.alloc(+B)},he.INSPECT_MAX_BYTES=50;var re=2147483647;function b(B){if(B>re)throw new RangeError('The value "'+B+'" is invalid for option "size"');var R=new Uint8Array(B);return R.__proto__=S.prototype,R}function S(B,R,k){if("number"==typeof B){if("string"==typeof R)throw new TypeError('The "string" argument must be of type string. Received type number');return y(B)}return O(B,R,k)}function O(B,R,k){if("string"==typeof B)return function(B,R){if(("string"!=typeof R||""===R)&&(R="utf8"),!S.isEncoding(R))throw new TypeError("Unknown encoding: "+R);var k=0|M(B,R),Oe=b(k),Xe=Oe.write(B,R);return Xe!==k&&(Oe=Oe.slice(0,Xe)),Oe}(B,R);if(ArrayBuffer.isView(B))return D(B);if(null==B)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(pt(B,ArrayBuffer)||B&&pt(B.buffer,ArrayBuffer))return function(B,R,k){if(R<0||B.byteLength<R)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<R+(k||0))throw new RangeError('"length" is outside of buffer bounds');var Oe;return(Oe=void 0===R&&void 0===k?new Uint8Array(B):void 0===k?new Uint8Array(B,R):new Uint8Array(B,R,k)).__proto__=S.prototype,Oe}(B,R,k);if("number"==typeof B)throw new TypeError('The "value" argument must not be of type number. Received type number');var Oe=B.valueOf&&B.valueOf();if(null!=Oe&&Oe!==B)return S.from(Oe,R,k);var Xe=function(B){if(S.isBuffer(B)){var R=0|H(B.length),k=b(R);return 0===k.length||B.copy(k,0,0,R),k}return void 0!==B.length?"number"!=typeof B.length||fe(B.length)?b(0):D(B):"Buffer"===B.type&&Array.isArray(B.data)?D(B.data):void 0}(B);if(Xe)return Xe;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof B[Symbol.toPrimitive])return S.from(B[Symbol.toPrimitive]("string"),R,k);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function T(B){if("number"!=typeof B)throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function y(B){return T(B),b(B<0?0:0|H(B))}function D(B){for(var R=B.length<0?0:0|H(B.length),k=b(R),Oe=0;Oe<R;Oe+=1)k[Oe]=255&B[Oe];return k}function H(B){if(B>=re)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+re.toString(16)+" bytes");return 0|B}function M(B,R){if(S.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||pt(B,ArrayBuffer))return B.byteLength;if("string"!=typeof B)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var k=B.length,Oe=arguments.length>2&&!0===arguments[2];if(!Oe&&0===k)return 0;for(var Xe=!1;;)switch(R){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":return X(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*k;case"hex":return k>>>1;case"base64":return Pe(B).length;default:if(Xe)return Oe?-1:X(B).length;R=(""+R).toLowerCase(),Xe=!0}}function F(B,R,k){var Oe=!1;if((void 0===R||R<0)&&(R=0),R>this.length||((void 0===k||k>this.length)&&(k=this.length),k<=0)||(k>>>=0)<=(R>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return Je(this,R,k);case"utf8":case"utf-8":return ye(this,R,k);case"ascii":return nt(this,R,k);case"latin1":case"binary":return Ze(this,R,k);case"base64":return te(this,R,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ye(this,R,k);default:if(Oe)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),Oe=!0}}function Q(B,R,k){var Oe=B[R];B[R]=B[k],B[k]=Oe}function E(B,R,k,Oe,Xe){if(0===B.length)return-1;if("string"==typeof k?(Oe=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),fe(k=+k)&&(k=Xe?0:B.length-1),k<0&&(k=B.length+k),k>=B.length){if(Xe)return-1;k=B.length-1}else if(k<0){if(!Xe)return-1;k=0}if("string"==typeof R&&(R=S.from(R,Oe)),S.isBuffer(R))return 0===R.length?-1:U(B,R,k,Oe,Xe);if("number"==typeof R)return R&=255,"function"==typeof Uint8Array.prototype.indexOf?Xe?Uint8Array.prototype.indexOf.call(B,R,k):Uint8Array.prototype.lastIndexOf.call(B,R,k):U(B,[R],k,Oe,Xe);throw new TypeError("val must be string, number or Buffer")}function U(B,R,k,Oe,Xe){var $n,yt=1,It=B.length,Tn=R.length;if(void 0!==Oe&&("ucs2"===(Oe=String(Oe).toLowerCase())||"ucs-2"===Oe||"utf16le"===Oe||"utf-16le"===Oe)){if(B.length<2||R.length<2)return-1;yt=2,It/=2,Tn/=2,k/=2}function Pn(Ns,cs){return 1===yt?Ns[cs]:Ns.readUInt16BE(cs*yt)}if(Xe){var yi=-1;for($n=k;$n<It;$n++)if(Pn(B,$n)===Pn(R,-1===yi?0:$n-yi)){if(-1===yi&&(yi=$n),$n-yi+1===Tn)return yi*yt}else-1!==yi&&($n-=$n-yi),yi=-1}else for(k+Tn>It&&(k=It-Tn),$n=k;$n>=0;$n--){for(var hi=!0,Hr=0;Hr<Tn;Hr++)if(Pn(B,$n+Hr)!==Pn(R,Hr)){hi=!1;break}if(hi)return $n}return-1}function ie(B,R,k,Oe){k=Number(k)||0;var Xe=B.length-k;Oe?(Oe=Number(Oe))>Xe&&(Oe=Xe):Oe=Xe;var yt=R.length;Oe>yt/2&&(Oe=yt/2);for(var It=0;It<Oe;++It){var Tn=parseInt(R.substr(2*It,2),16);if(fe(Tn))return It;B[k+It]=Tn}return It}function ue(B,R,k,Oe){return wt(X(R,B.length-k),B,k,Oe)}function ee(B,R,k,Oe){return wt(function(B){for(var R=[],k=0;k<B.length;++k)R.push(255&B.charCodeAt(k));return R}(R),B,k,Oe)}function se(B,R,k,Oe){return ee(B,R,k,Oe)}function Te(B,R,k,Oe){return wt(Pe(R),B,k,Oe)}function me(B,R,k,Oe){return wt(function(B,R){for(var k,Oe,yt=[],It=0;It<B.length&&!((R-=2)<0);++It)Oe=(k=B.charCodeAt(It))>>8,yt.push(k%256),yt.push(Oe);return yt}(R,B.length-k),B,k,Oe)}function te(B,R,k){return V.fromByteArray(0===R&&k===B.length?B:B.slice(R,k))}function ye(B,R,k){k=Math.min(B.length,k);for(var Oe=[],Xe=R;Xe<k;){var Pn,$n,yi,hi,yt=B[Xe],It=null,Tn=yt>239?4:yt>223?3:yt>191?2:1;if(Xe+Tn<=k)switch(Tn){case 1:yt<128&&(It=yt);break;case 2:128==(192&(Pn=B[Xe+1]))&&(hi=(31&yt)<<6|63&Pn)>127&&(It=hi);break;case 3:$n=B[Xe+2],128==(192&(Pn=B[Xe+1]))&&128==(192&$n)&&(hi=(15&yt)<<12|(63&Pn)<<6|63&$n)>2047&&(hi<55296||hi>57343)&&(It=hi);break;case 4:$n=B[Xe+2],yi=B[Xe+3],128==(192&(Pn=B[Xe+1]))&&128==(192&$n)&&128==(192&yi)&&(hi=(15&yt)<<18|(63&Pn)<<12|(63&$n)<<6|63&yi)>65535&&hi<1114112&&(It=hi)}null===It?(It=65533,Tn=1):It>65535&&(Oe.push((It-=65536)>>>10&1023|55296),It=56320|1023&It),Oe.push(It),Xe+=Tn}return function(B){var R=B.length;if(R<=4096)return String.fromCharCode.apply(String,B);for(var k="",Oe=0;Oe<R;)k+=String.fromCharCode.apply(String,B.slice(Oe,Oe+=4096));return k}(Oe)}he.kMaxLength=re,!(S.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===B.foo()}catch(R){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(S.prototype,"parent",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.buffer}}),Object.defineProperty(S.prototype,"offset",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&S[Symbol.species]===S&&Object.defineProperty(S,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),S.poolSize=8192,S.from=function(B,R,k){return O(B,R,k)},S.prototype.__proto__=Uint8Array.prototype,S.__proto__=Uint8Array,S.alloc=function(B,R,k){return function(B,R,k){return T(B),B<=0?b(B):void 0!==R?"string"==typeof k?b(B).fill(R,k):b(B).fill(R):b(B)}(B,R,k)},S.allocUnsafe=function(B){return y(B)},S.allocUnsafeSlow=function(B){return y(B)},S.isBuffer=function(R){return null!=R&&!0===R._isBuffer&&R!==S.prototype},S.compare=function(R,k){if(pt(R,Uint8Array)&&(R=S.from(R,R.offset,R.byteLength)),pt(k,Uint8Array)&&(k=S.from(k,k.offset,k.byteLength)),!S.isBuffer(R)||!S.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(R===k)return 0;for(var Oe=R.length,Xe=k.length,yt=0,It=Math.min(Oe,Xe);yt<It;++yt)if(R[yt]!==k[yt]){Oe=R[yt],Xe=k[yt];break}return Oe<Xe?-1:Xe<Oe?1:0},S.isEncoding=function(R){switch(String(R).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},S.concat=function(R,k){if(!Array.isArray(R))throw new TypeError('"list" argument must be an Array of Buffers');if(0===R.length)return S.alloc(0);var Oe;if(void 0===k)for(k=0,Oe=0;Oe<R.length;++Oe)k+=R[Oe].length;var Xe=S.allocUnsafe(k),yt=0;for(Oe=0;Oe<R.length;++Oe){var It=R[Oe];if(pt(It,Uint8Array)&&(It=S.from(It)),!S.isBuffer(It))throw new TypeError('"list" argument must be an Array of Buffers');It.copy(Xe,yt),yt+=It.length}return Xe},S.byteLength=M,S.prototype._isBuffer=!0,S.prototype.swap16=function(){var R=this.length;if(R%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var k=0;k<R;k+=2)Q(this,k,k+1);return this},S.prototype.swap32=function(){var R=this.length;if(R%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var k=0;k<R;k+=4)Q(this,k,k+3),Q(this,k+1,k+2);return this},S.prototype.swap64=function(){var R=this.length;if(R%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var k=0;k<R;k+=8)Q(this,k,k+7),Q(this,k+1,k+6),Q(this,k+2,k+5),Q(this,k+3,k+4);return this},S.prototype.toLocaleString=S.prototype.toString=function(){var R=this.length;return 0===R?"":0===arguments.length?ye(this,0,R):F.apply(this,arguments)},S.prototype.equals=function(R){if(!S.isBuffer(R))throw new TypeError("Argument must be a Buffer");return this===R||0===S.compare(this,R)},S.prototype.inspect=function(){var R="",k=he.INSPECT_MAX_BYTES;return R=this.toString("hex",0,k).replace(/(.{2})/g,"$1 ").trim(),this.length>k&&(R+=" ... "),"<Buffer "+R+">"},S.prototype.compare=function(R,k,Oe,Xe,yt){if(pt(R,Uint8Array)&&(R=S.from(R,R.offset,R.byteLength)),!S.isBuffer(R))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof R);if(void 0===k&&(k=0),void 0===Oe&&(Oe=R?R.length:0),void 0===Xe&&(Xe=0),void 0===yt&&(yt=this.length),k<0||Oe>R.length||Xe<0||yt>this.length)throw new RangeError("out of range index");if(Xe>=yt&&k>=Oe)return 0;if(Xe>=yt)return-1;if(k>=Oe)return 1;if(this===R)return 0;for(var It=(yt>>>=0)-(Xe>>>=0),Tn=(Oe>>>=0)-(k>>>=0),Pn=Math.min(It,Tn),$n=this.slice(Xe,yt),yi=R.slice(k,Oe),hi=0;hi<Pn;++hi)if($n[hi]!==yi[hi]){It=$n[hi],Tn=yi[hi];break}return It<Tn?-1:Tn<It?1:0},S.prototype.includes=function(R,k,Oe){return-1!==this.indexOf(R,k,Oe)},S.prototype.indexOf=function(R,k,Oe){return E(this,R,k,Oe,!0)},S.prototype.lastIndexOf=function(R,k,Oe){return E(this,R,k,Oe,!1)},S.prototype.write=function(R,k,Oe,Xe){if(void 0===k)Xe="utf8",Oe=this.length,k=0;else if(void 0===Oe&&"string"==typeof k)Xe=k,Oe=this.length,k=0;else{if(!isFinite(k))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");k>>>=0,isFinite(Oe)?(Oe>>>=0,void 0===Xe&&(Xe="utf8")):(Xe=Oe,Oe=void 0)}var yt=this.length-k;if((void 0===Oe||Oe>yt)&&(Oe=yt),R.length>0&&(Oe<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");Xe||(Xe="utf8");for(var It=!1;;)switch(Xe){case"hex":return ie(this,R,k,Oe);case"utf8":case"utf-8":return ue(this,R,k,Oe);case"ascii":return ee(this,R,k,Oe);case"latin1":case"binary":return se(this,R,k,Oe);case"base64":return Te(this,R,k,Oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,R,k,Oe);default:if(It)throw new TypeError("Unknown encoding: "+Xe);Xe=(""+Xe).toLowerCase(),It=!0}},S.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function nt(B,R,k){var Oe="";k=Math.min(B.length,k);for(var Xe=R;Xe<k;++Xe)Oe+=String.fromCharCode(127&B[Xe]);return Oe}function Ze(B,R,k){var Oe="";k=Math.min(B.length,k);for(var Xe=R;Xe<k;++Xe)Oe+=String.fromCharCode(B[Xe]);return Oe}function Je(B,R,k){var Oe=B.length;(!R||R<0)&&(R=0),(!k||k<0||k>Oe)&&(k=Oe);for(var Xe="",yt=R;yt<k;++yt)Xe+=z(B[yt]);return Xe}function Ye(B,R,k){for(var Oe=B.slice(R,k),Xe="",yt=0;yt<Oe.length;yt+=2)Xe+=String.fromCharCode(Oe[yt]+256*Oe[yt+1]);return Xe}function je(B,R,k){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+R>k)throw new RangeError("Trying to access beyond buffer length")}function Le(B,R,k,Oe,Xe,yt){if(!S.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(R>Xe||R<yt)throw new RangeError('"value" argument is out of bounds');if(k+Oe>B.length)throw new RangeError("Index out of range")}function Ee(B,R,k,Oe,Xe,yt){if(k+Oe>B.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function Re(B,R,k,Oe,Xe){return R=+R,k>>>=0,Xe||Ee(B,0,k,4),L.write(B,R,k,Oe,23,4),k+4}function Ue(B,R,k,Oe,Xe){return R=+R,k>>>=0,Xe||Ee(B,0,k,8),L.write(B,R,k,Oe,52,8),k+8}S.prototype.slice=function(R,k){var Oe=this.length;(R=~~R)<0?(R+=Oe)<0&&(R=0):R>Oe&&(R=Oe),(k=void 0===k?Oe:~~k)<0?(k+=Oe)<0&&(k=0):k>Oe&&(k=Oe),k<R&&(k=R);var Xe=this.subarray(R,k);return Xe.__proto__=S.prototype,Xe},S.prototype.readUIntLE=function(R,k,Oe){R>>>=0,k>>>=0,Oe||je(R,k,this.length);for(var Xe=this[R],yt=1,It=0;++It<k&&(yt*=256);)Xe+=this[R+It]*yt;return Xe},S.prototype.readUIntBE=function(R,k,Oe){R>>>=0,k>>>=0,Oe||je(R,k,this.length);for(var Xe=this[R+--k],yt=1;k>0&&(yt*=256);)Xe+=this[R+--k]*yt;return Xe},S.prototype.readUInt8=function(R,k){return R>>>=0,k||je(R,1,this.length),this[R]},S.prototype.readUInt16LE=function(R,k){return R>>>=0,k||je(R,2,this.length),this[R]|this[R+1]<<8},S.prototype.readUInt16BE=function(R,k){return R>>>=0,k||je(R,2,this.length),this[R]<<8|this[R+1]},S.prototype.readUInt32LE=function(R,k){return R>>>=0,k||je(R,4,this.length),(this[R]|this[R+1]<<8|this[R+2]<<16)+16777216*this[R+3]},S.prototype.readUInt32BE=function(R,k){return R>>>=0,k||je(R,4,this.length),16777216*this[R]+(this[R+1]<<16|this[R+2]<<8|this[R+3])},S.prototype.readIntLE=function(R,k,Oe){R>>>=0,k>>>=0,Oe||je(R,k,this.length);for(var Xe=this[R],yt=1,It=0;++It<k&&(yt*=256);)Xe+=this[R+It]*yt;return Xe>=(yt*=128)&&(Xe-=Math.pow(2,8*k)),Xe},S.prototype.readIntBE=function(R,k,Oe){R>>>=0,k>>>=0,Oe||je(R,k,this.length);for(var Xe=k,yt=1,It=this[R+--Xe];Xe>0&&(yt*=256);)It+=this[R+--Xe]*yt;return It>=(yt*=128)&&(It-=Math.pow(2,8*k)),It},S.prototype.readInt8=function(R,k){return R>>>=0,k||je(R,1,this.length),128&this[R]?-1*(255-this[R]+1):this[R]},S.prototype.readInt16LE=function(R,k){R>>>=0,k||je(R,2,this.length);var Oe=this[R]|this[R+1]<<8;return 32768&Oe?4294901760|Oe:Oe},S.prototype.readInt16BE=function(R,k){R>>>=0,k||je(R,2,this.length);var Oe=this[R+1]|this[R]<<8;return 32768&Oe?4294901760|Oe:Oe},S.prototype.readInt32LE=function(R,k){return R>>>=0,k||je(R,4,this.length),this[R]|this[R+1]<<8|this[R+2]<<16|this[R+3]<<24},S.prototype.readInt32BE=function(R,k){return R>>>=0,k||je(R,4,this.length),this[R]<<24|this[R+1]<<16|this[R+2]<<8|this[R+3]},S.prototype.readFloatLE=function(R,k){return R>>>=0,k||je(R,4,this.length),L.read(this,R,!0,23,4)},S.prototype.readFloatBE=function(R,k){return R>>>=0,k||je(R,4,this.length),L.read(this,R,!1,23,4)},S.prototype.readDoubleLE=function(R,k){return R>>>=0,k||je(R,8,this.length),L.read(this,R,!0,52,8)},S.prototype.readDoubleBE=function(R,k){return R>>>=0,k||je(R,8,this.length),L.read(this,R,!1,52,8)},S.prototype.writeUIntLE=function(R,k,Oe,Xe){R=+R,k>>>=0,Oe>>>=0,Xe||Le(this,R,k,Oe,Math.pow(2,8*Oe)-1,0);var It=1,Tn=0;for(this[k]=255&R;++Tn<Oe&&(It*=256);)this[k+Tn]=R/It&255;return k+Oe},S.prototype.writeUIntBE=function(R,k,Oe,Xe){R=+R,k>>>=0,Oe>>>=0,Xe||Le(this,R,k,Oe,Math.pow(2,8*Oe)-1,0);var It=Oe-1,Tn=1;for(this[k+It]=255&R;--It>=0&&(Tn*=256);)this[k+It]=R/Tn&255;return k+Oe},S.prototype.writeUInt8=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,1,255,0),this[k]=255&R,k+1},S.prototype.writeUInt16LE=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,2,65535,0),this[k]=255&R,this[k+1]=R>>>8,k+2},S.prototype.writeUInt16BE=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,2,65535,0),this[k]=R>>>8,this[k+1]=255&R,k+2},S.prototype.writeUInt32LE=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,4,4294967295,0),this[k+3]=R>>>24,this[k+2]=R>>>16,this[k+1]=R>>>8,this[k]=255&R,k+4},S.prototype.writeUInt32BE=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,4,4294967295,0),this[k]=R>>>24,this[k+1]=R>>>16,this[k+2]=R>>>8,this[k+3]=255&R,k+4},S.prototype.writeIntLE=function(R,k,Oe,Xe){if(R=+R,k>>>=0,!Xe){var yt=Math.pow(2,8*Oe-1);Le(this,R,k,Oe,yt-1,-yt)}var It=0,Tn=1,Pn=0;for(this[k]=255&R;++It<Oe&&(Tn*=256);)R<0&&0===Pn&&0!==this[k+It-1]&&(Pn=1),this[k+It]=(R/Tn>>0)-Pn&255;return k+Oe},S.prototype.writeIntBE=function(R,k,Oe,Xe){if(R=+R,k>>>=0,!Xe){var yt=Math.pow(2,8*Oe-1);Le(this,R,k,Oe,yt-1,-yt)}var It=Oe-1,Tn=1,Pn=0;for(this[k+It]=255&R;--It>=0&&(Tn*=256);)R<0&&0===Pn&&0!==this[k+It+1]&&(Pn=1),this[k+It]=(R/Tn>>0)-Pn&255;return k+Oe},S.prototype.writeInt8=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,1,127,-128),R<0&&(R=255+R+1),this[k]=255&R,k+1},S.prototype.writeInt16LE=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,2,32767,-32768),this[k]=255&R,this[k+1]=R>>>8,k+2},S.prototype.writeInt16BE=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,2,32767,-32768),this[k]=R>>>8,this[k+1]=255&R,k+2},S.prototype.writeInt32LE=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,4,2147483647,-2147483648),this[k]=255&R,this[k+1]=R>>>8,this[k+2]=R>>>16,this[k+3]=R>>>24,k+4},S.prototype.writeInt32BE=function(R,k,Oe){return R=+R,k>>>=0,Oe||Le(this,R,k,4,2147483647,-2147483648),R<0&&(R=4294967295+R+1),this[k]=R>>>24,this[k+1]=R>>>16,this[k+2]=R>>>8,this[k+3]=255&R,k+4},S.prototype.writeFloatLE=function(R,k,Oe){return Re(this,R,k,!0,Oe)},S.prototype.writeFloatBE=function(R,k,Oe){return Re(this,R,k,!1,Oe)},S.prototype.writeDoubleLE=function(R,k,Oe){return Ue(this,R,k,!0,Oe)},S.prototype.writeDoubleBE=function(R,k,Oe){return Ue(this,R,k,!1,Oe)},S.prototype.copy=function(R,k,Oe,Xe){if(!S.isBuffer(R))throw new TypeError("argument should be a Buffer");if(Oe||(Oe=0),!Xe&&0!==Xe&&(Xe=this.length),k>=R.length&&(k=R.length),k||(k=0),Xe>0&&Xe<Oe&&(Xe=Oe),Xe===Oe||0===R.length||0===this.length)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(Oe<0||Oe>=this.length)throw new RangeError("Index out of range");if(Xe<0)throw new RangeError("sourceEnd out of bounds");Xe>this.length&&(Xe=this.length),R.length-k<Xe-Oe&&(Xe=R.length-k+Oe);var yt=Xe-Oe;if(this===R&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(k,Oe,Xe);else if(this===R&&Oe<k&&k<Xe)for(var It=yt-1;It>=0;--It)R[It+k]=this[It+Oe];else Uint8Array.prototype.set.call(R,this.subarray(Oe,Xe),k);return yt},S.prototype.fill=function(R,k,Oe,Xe){if("string"==typeof R){if("string"==typeof k?(Xe=k,k=0,Oe=this.length):"string"==typeof Oe&&(Xe=Oe,Oe=this.length),void 0!==Xe&&"string"!=typeof Xe)throw new TypeError("encoding must be a string");if("string"==typeof Xe&&!S.isEncoding(Xe))throw new TypeError("Unknown encoding: "+Xe);if(1===R.length){var yt=R.charCodeAt(0);("utf8"===Xe&&yt<128||"latin1"===Xe)&&(R=yt)}}else"number"==typeof R&&(R&=255);if(k<0||this.length<k||this.length<Oe)throw new RangeError("Out of range index");if(Oe<=k)return this;var It;if(k>>>=0,Oe=void 0===Oe?this.length:Oe>>>0,R||(R=0),"number"==typeof R)for(It=k;It<Oe;++It)this[It]=R;else{var Tn=S.isBuffer(R)?R:S.from(R,Xe),Pn=Tn.length;if(0===Pn)throw new TypeError('The value "'+R+'" is invalid for argument "value"');for(It=0;It<Oe-k;++It)this[It+k]=Tn[It%Pn]}return this};var qe=/[^+/0-9A-Za-z-_]/g;function z(B){return B<16?"0"+B.toString(16):B.toString(16)}function X(B,R){R=R||1/0;for(var k,Oe=B.length,Xe=null,yt=[],It=0;It<Oe;++It){if((k=B.charCodeAt(It))>55295&&k<57344){if(!Xe){if(k>56319){(R-=3)>-1&&yt.push(239,191,189);continue}if(It+1===Oe){(R-=3)>-1&&yt.push(239,191,189);continue}Xe=k;continue}if(k<56320){(R-=3)>-1&&yt.push(239,191,189),Xe=k;continue}k=65536+(Xe-55296<<10|k-56320)}else Xe&&(R-=3)>-1&&yt.push(239,191,189);if(Xe=null,k<128){if((R-=1)<0)break;yt.push(k)}else if(k<2048){if((R-=2)<0)break;yt.push(k>>6|192,63&k|128)}else if(k<65536){if((R-=3)<0)break;yt.push(k>>12|224,k>>6&63|128,63&k|128)}else{if(!(k<1114112))throw new Error("Invalid code point");if((R-=4)<0)break;yt.push(k>>18|240,k>>12&63|128,k>>6&63|128,63&k|128)}}return yt}function Pe(B){return V.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(qe,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(B))}function wt(B,R,k,Oe){for(var Xe=0;Xe<Oe&&!(Xe+k>=R.length||Xe>=B.length);++Xe)R[Xe+k]=B[Xe];return Xe}function pt(B,R){return B instanceof R||null!=B&&null!=B.constructor&&null!=B.constructor.name&&B.constructor.name===R.name}function fe(B){return B!=B}}).call(this)}).call(this,K("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(K,Ae,he){"use strict";Ae.exports=function q(V){return null===V||"object"!=typeof V||null!=V.toJSON?JSON.stringify(V):Array.isArray(V)?"["+V.reduce((L,re,$)=>L+(0===$?"":",")+q(void 0===re||"symbol"==typeof re?null:re),"")+"]":"{"+Object.keys(V).sort().reduce((L,re,$)=>void 0===V[re]||"symbol"==typeof V[re]?L:L+(0===L.length?"":",")+q(re)+":"+q(V[re]),"")+"}"}},{}],8:[function(K,Ae,he){"use strict";var L,q="object"==typeof Reflect?Reflect:null,V=q&&"function"==typeof q.apply?q.apply:function(U,ie,ue){return Function.prototype.apply.call(U,ie,ue)};L=q&&"function"==typeof q.ownKeys?q.ownKeys:Object.getOwnPropertySymbols?function(U){return Object.getOwnPropertyNames(U).concat(Object.getOwnPropertySymbols(U))}:function(U){return Object.getOwnPropertyNames(U)};var $=Number.isNaN||function(U){return U!=U};function b(){b.init.call(this)}Ae.exports=b,Ae.exports.once=function(E,U){return new Promise(function(ie,ue){function ee(Te){E.removeListener(U,se),ue(Te)}function se(){"function"==typeof E.removeListener&&E.removeListener("error",ee),ie([].slice.call(arguments))}Q(E,U,se,{once:!0}),"error"!==U&&function(E,U,ie){"function"==typeof E.on&&Q(E,"error",U,ie)}(E,ee,{once:!0})})},b.EventEmitter=b,b.prototype._events=void 0,b.prototype._eventsCount=0,b.prototype._maxListeners=void 0;var S=10;function O(E){if("function"!=typeof E)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}function T(E){return void 0===E._maxListeners?b.defaultMaxListeners:E._maxListeners}function v(E,U,ie,ue){var ee,se,Te;if(O(ie),void 0===(se=E._events)?(se=E._events=Object.create(null),E._eventsCount=0):(void 0!==se.newListener&&(E.emit("newListener",U,ie.listener?ie.listener:ie),se=E._events),Te=se[U]),void 0===Te)Te=se[U]=ie,++E._eventsCount;else if("function"==typeof Te?Te=se[U]=ue?[ie,Te]:[Te,ie]:ue?Te.unshift(ie):Te.push(ie),(ee=T(E))>0&&Te.length>ee&&!Te.warned){Te.warned=!0;var me=new Error("Possible EventEmitter memory leak detected. "+Te.length+" "+String(U)+" listeners added. Use emitter.setMaxListeners() to increase limit");me.name="MaxListenersExceededWarning",me.emitter=E,me.type=U,me.count=Te.length,function(E){console&&console.warn&&console.warn(E)}(me)}return E}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w(E,U,ie){var ue={fired:!1,wrapFn:void 0,target:E,type:U,listener:ie},ee=y.bind(ue);return ee.listener=ie,ue.wrapFn=ee,ee}function D(E,U,ie){var ue=E._events;if(void 0===ue)return[];var ee=ue[U];return void 0===ee?[]:"function"==typeof ee?ie?[ee.listener||ee]:[ee]:ie?function(E){for(var U=new Array(E.length),ie=0;ie<U.length;++ie)U[ie]=E[ie].listener||E[ie];return U}(ee):I(ee,ee.length)}function j(E){var U=this._events;if(void 0!==U){var ie=U[E];if("function"==typeof ie)return 1;if(void 0!==ie)return ie.length}return 0}function I(E,U){for(var ie=new Array(U),ue=0;ue<U;++ue)ie[ue]=E[ue];return ie}function Q(E,U,ie,ue){if("function"==typeof E.on)ue.once?E.once(U,ie):E.on(U,ie);else{if("function"!=typeof E.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E);E.addEventListener(U,function ee(se){ue.once&&E.removeEventListener(U,ee),ie(se)})}}Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return S},set:function(E){if("number"!=typeof E||E<0||$(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");S=E}}),b.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function(U){if("number"!=typeof U||U<0||$(U))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+U+".");return this._maxListeners=U,this},b.prototype.getMaxListeners=function(){return T(this)},b.prototype.emit=function(U){for(var ie=[],ue=1;ue<arguments.length;ue++)ie.push(arguments[ue]);var ee="error"===U,se=this._events;if(void 0!==se)ee=ee&&void 0===se.error;else if(!ee)return!1;if(ee){var Te;if(ie.length>0&&(Te=ie[0]),Te instanceof Error)throw Te;var me=new Error("Unhandled error."+(Te?" ("+Te.message+")":""));throw me.context=Te,me}var te=se[U];if(void 0===te)return!1;if("function"==typeof te)V(te,this,ie);else{var ye=te.length,Me=I(te,ye);for(ue=0;ue<ye;++ue)V(Me[ue],this,ie)}return!0},b.prototype.on=b.prototype.addListener=function(U,ie){return v(this,U,ie,!1)},b.prototype.prependListener=function(U,ie){return v(this,U,ie,!0)},b.prototype.once=function(U,ie){return O(ie),this.on(U,w(this,U,ie)),this},b.prototype.prependOnceListener=function(U,ie){return O(ie),this.prependListener(U,w(this,U,ie)),this},b.prototype.off=b.prototype.removeListener=function(U,ie){var ue,ee,se,Te,me;if(O(ie),void 0===(ee=this._events))return this;if(void 0===(ue=ee[U]))return this;if(ue===ie||ue.listener===ie)0==--this._eventsCount?this._events=Object.create(null):(delete ee[U],ee.removeListener&&this.emit("removeListener",U,ue.listener||ie));else if("function"!=typeof ue){for(se=-1,Te=ue.length-1;Te>=0;Te--)if(ue[Te]===ie||ue[Te].listener===ie){me=ue[Te].listener,se=Te;break}if(se<0)return this;0===se?ue.shift():function(E,U){for(;U+1<E.length;U++)E[U]=E[U+1];E.pop()}(ue,se),1===ue.length&&(ee[U]=ue[0]),void 0!==ee.removeListener&&this.emit("removeListener",U,me||ie)}return this},b.prototype.removeAllListeners=function(U){var ie,ue,ee;if(void 0===(ue=this._events))return this;if(void 0===ue.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ue[U]&&(0==--this._eventsCount?this._events=Object.create(null):delete ue[U]),this;if(0===arguments.length){var Te,se=Object.keys(ue);for(ee=0;ee<se.length;++ee)"removeListener"!==(Te=se[ee])&&this.removeAllListeners(Te);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(ie=ue[U]))this.removeListener(U,ie);else if(void 0!==ie)for(ee=ie.length-1;ee>=0;ee--)this.removeListener(U,ie[ee]);return this},b.prototype.listeners=function(U){return D(this,U,!0)},b.prototype.rawListeners=function(U){return D(this,U,!1)},b.listenerCount=function(E,U){return"function"==typeof E.listenerCount?E.listenerCount(U):j.call(E,U)},b.prototype.listenerCount=j,b.prototype.eventNames=function(){return this._eventsCount>0?L(this._events):[]}},{}],9:[function(K,Ae,he){he.read=function(q,V,L,re,$){var b,S,O=8*$-re-1,T=(1<<O)-1,v=T>>1,y=-7,w=L?$-1:0,D=L?-1:1,j=q[V+w];for(w+=D,b=j&(1<<-y)-1,j>>=-y,y+=O;y>0;b=256*b+q[V+w],w+=D,y-=8);for(S=b&(1<<-y)-1,b>>=-y,y+=re;y>0;S=256*S+q[V+w],w+=D,y-=8);if(0===b)b=1-v;else{if(b===T)return S?NaN:1/0*(j?-1:1);S+=Math.pow(2,re),b-=v}return(j?-1:1)*S*Math.pow(2,b-re)},he.write=function(q,V,L,re,$,b){var S,O,T,v=8*b-$-1,y=(1<<v)-1,w=y>>1,D=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,j=re?0:b-1,I=re?1:-1,H=V<0||0===V&&1/V<0?1:0;for(V=Math.abs(V),isNaN(V)||V===1/0?(O=isNaN(V)?1:0,S=y):(S=Math.floor(Math.log(V)/Math.LN2),V*(T=Math.pow(2,-S))<1&&(S--,T*=2),(V+=S+w>=1?D/T:D*Math.pow(2,1-w))*T>=2&&(S++,T/=2),S+w>=y?(O=0,S=y):S+w>=1?(O=(V*T-1)*Math.pow(2,$),S+=w):(O=V*Math.pow(2,w-1)*Math.pow(2,$),S=0));$>=8;q[L+j]=255&O,j+=I,O/=256,$-=8);for(S=S<<$|O,v+=$;v>0;q[L+j]=255&S,j+=I,S/=256,v-=8);q[L+j-I]|=128*H}},{}],10:[function(K,Ae,he){Ae.exports="function"==typeof Object.create?function(V,L){L&&(V.super_=L,V.prototype=Object.create(L.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}))}:function(V,L){if(L){V.super_=L;var re=function(){};re.prototype=L.prototype,V.prototype=new re,V.prototype.constructor=V}}},{}],11:[function(K,Ae,he){"use strict";const{isArray:q,isObject:V,isString:L}=K("./types"),{asArray:re}=K("./util"),{prependBase:$}=K("./url"),b=K("./JsonLdError"),S=K("./ResolvedContext");function T(y){throw new b("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function v({context:y,base:w}){if(!y)return;const D=y["@context"];if(L(D))y["@context"]=$(w,D);else if(q(D))for(let j=0;j<D.length;++j){const I=D[j];L(I)?D[j]=$(w,I):V(I)&&v({context:{"@context":I},base:w})}else if(V(D))for(const j in D)v({context:D[j],base:w})}Ae.exports=class{constructor({sharedCache:w}){this.perOpCache=new Map,this.sharedCache=w}resolve({activeCtx:w,context:D,documentLoader:j,base:I,cycles:H=new Set}){var Y=this;return gt(function*(){D&&V(D)&&D["@context"]&&(D=D["@context"]),D=re(D);const M=[];for(const F of D){if(L(F)){let U=Y._get(F);U||(U=yield Y._resolveRemoteContext({activeCtx:w,url:F,documentLoader:j,base:I,cycles:H})),q(U)?M.push(...U):M.push(U);continue}if(null===F){M.push(new S({document:null}));continue}V(F)||T(D);const Q=JSON.stringify(F);let E=Y._get(Q);E||(E=new S({document:F}),Y._cacheResolvedContext({key:Q,resolved:E,tag:"static"})),M.push(E)}return M})()}_get(w){let D=this.perOpCache.get(w);if(!D){const j=this.sharedCache.get(w);j&&(D=j.get("static"),D&&this.perOpCache.set(w,D))}return D}_cacheResolvedContext({key:w,resolved:D,tag:j}){if(this.perOpCache.set(w,D),void 0!==j){let I=this.sharedCache.get(w);I||(I=new Map,this.sharedCache.set(w,I)),I.set(j,D)}return D}_resolveRemoteContext({activeCtx:w,url:D,documentLoader:j,base:I,cycles:H}){var Y=this;return gt(function*(){D=$(I,D);const{context:M,remoteDoc:F}=yield Y._fetchContext({activeCtx:w,url:D,documentLoader:j,cycles:H});v({context:M,base:I=F.documentUrl||D});const Q=yield Y.resolve({activeCtx:w,context:M,documentLoader:j,base:I,cycles:H});return Y._cacheResolvedContext({key:D,resolved:Q,tag:F.tag}),Q})()}_fetchContext({activeCtx:w,url:D,documentLoader:j,cycles:I}){return gt(function*(){if(I.size>10)throw new b("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===w.processingMode?"loading remote context failed":"context overflow",max:10});if(I.has(D))throw new b("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===w.processingMode?"recursive context inclusion":"context overflow",url:D});let H,Y;I.add(D);try{Y=yield j(D),H=Y.document||null,L(H)&&(H=JSON.parse(H))}catch(M){throw new b("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:D,cause:M})}if(!V(H))throw new b("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:D});return H="@context"in H?{"@context":H["@context"]}:{"@context":{}},Y.contextUrl&&(q(H["@context"])||(H["@context"]=[H["@context"]]),H["@context"].push(Y.contextUrl)),{context:H,remoteDoc:Y}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(K,Ae,he){"use strict";Ae.exports=class extends Error{constructor(V="An unspecified JSON-LD error occurred.",L="jsonld.Error",re={}){super(V),this.name=L,this.message=V,this.details=re}}},{}],13:[function(K,Ae,he){"use strict";Ae.exports=q=>{class V{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(V,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(V.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:V}),V.compact=function(L,re){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):q.compact(L,re)},V.expand=function(L){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):q.expand(L)},V.flatten=function(L){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):q.flatten(L)},V}},{}],14:[function(K,Ae,he){"use strict";Ae.exports=K("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(K,Ae,he){"use strict";Ae.exports=class{constructor(){this._requests={}}wrapLoader(V){const L=this;return L._loader=V,function(){return L.add.apply(L,arguments)}}add(V){var L=this;return gt(function*(){let re=L._requests[V];if(re)return Promise.resolve(re);re=L._requests[V]=L._loader(V);try{return yield re}finally{delete L._requests[V]}})()}}},{}],16:[function(K,Ae,he){"use strict";const q=K("lru-cache");Ae.exports=class{constructor({document:re}){this.document=re,this.cache=new q({max:10})}getProcessed(re){return this.cache.get(re)}setProcessed(re,$){this.cache.set(re,$)}}},{"lru-cache":33}],17:[function(K,Ae,he){"use strict";const q=K("./JsonLdError"),{isArray:V,isObject:L,isString:re,isUndefined:$}=K("./types"),{isList:b,isValue:S,isGraph:O,isSimpleGraph:T,isSubjectReference:v}=K("./graphTypes"),{expandIri:y,getContextValue:w,isKeyword:D,process:j,processingMode:I}=K("./context"),{removeBase:H,prependBase:Y}=K("./url"),{addValue:M,asArray:F,compareShortestLeast:Q}=K("./util"),E={};function ie(ue,ee,se){if("@nest"!==y(ue,ee,{vocab:!0},se))throw new q("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}Ae.exports=E,E.compact=function(){var ue=gt(function*({activeCtx:ee,activeProperty:se=null,element:Te,options:me={},compactionMap:te=(()=>{})}){if(V(Te)){let Me=[];for(let Ve=0;Ve<Te.length;++Ve){let nt=yield E.compact({activeCtx:ee,activeProperty:se,element:Te[Ve],options:me,compactionMap:te});null===nt&&(nt=yield te({unmappedValue:Te[Ve],activeCtx:ee,activeProperty:se,parent:Te,index:Ve,options:me}),void 0===nt)||Me.push(nt)}return me.compactArrays&&1===Me.length&&0===(w(ee,se,"@container")||[]).length&&(Me=Me[0]),Me}const ye=w(ee,se,"@context");if($(ye)||(ee=yield j({activeCtx:ee,localCtx:ye,propagate:!0,overrideProtected:!0,options:me})),L(Te)){if(me.link&&"@id"in Te&&me.link.hasOwnProperty(Te["@id"])){const Le=me.link[Te["@id"]];for(let Ee=0;Ee<Le.length;++Ee)if(Le[Ee].expanded===Te)return Le[Ee].compacted}if(S(Te)||v(Te)){const Le=E.compactValue({activeCtx:ee,activeProperty:se,value:Te,options:me});return me.link&&v(Te)&&(me.link.hasOwnProperty(Te["@id"])||(me.link[Te["@id"]]=[]),me.link[Te["@id"]].push({expanded:Te,compacted:Le})),Le}if(b(Te)&&(w(ee,se,"@container")||[]).includes("@list"))return E.compact({activeCtx:ee,activeProperty:se,element:Te["@list"],options:me,compactionMap:te});const Me="@reverse"===se,Ve={},nt=ee;!S(Te)&&!v(Te)&&(ee=ee.revertToPreviousContext());const Ze=w(nt,se,"@context");$(Ze)||(ee=yield j({activeCtx:ee,localCtx:Ze,propagate:!0,overrideProtected:!0,options:me})),me.link&&"@id"in Te&&(me.link.hasOwnProperty(Te["@id"])||(me.link[Te["@id"]]=[]),me.link[Te["@id"]].push({expanded:Te,compacted:Ve}));let Je=Te["@type"]||[];Je.length>1&&(Je=Array.from(Je).sort());const Ye=ee;for(const Le of Je){const Ee=E.compactIri({activeCtx:Ye,iri:Le,relativeTo:{vocab:!0}}),Re=w(nt,Ee,"@context");$(Re)||(ee=yield j({activeCtx:ee,localCtx:Re,options:me,propagate:!1}))}const je=Object.keys(Te).sort();for(const Le of je){const Ee=Te[Le];if("@id"!==Le)if("@type"!==Le)if("@reverse"!==Le)if("@preserve"!==Le)if("@index"!==Le)if("@graph"!==Le&&"@list"!==Le&&"@included"!==Le&&D(Le)){const Re=E.compactIri({activeCtx:ee,iri:Le,relativeTo:{vocab:!0}});M(Ve,Re,Ee)}else{if(!V(Ee))throw new q("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Ee.length){const Re=E.compactIri({activeCtx:ee,iri:Le,value:Ee,relativeTo:{vocab:!0},reverse:Me}),Ue=ee.mappings.has(Re)?ee.mappings.get(Re)["@nest"]:null;let qe=Ve;Ue&&(ie(ee,Ue,me),L(Ve[Ue])||(Ve[Ue]={}),qe=Ve[Ue]),M(qe,Re,Ee,{propertyIsArray:!0})}for(const Re of Ee){const Ue=E.compactIri({activeCtx:ee,iri:Le,value:Re,relativeTo:{vocab:!0},reverse:Me}),qe=ee.mappings.has(Ue)?ee.mappings.get(Ue)["@nest"]:null;let Be=Ve;qe&&(ie(ee,qe,me),L(Ve[qe])||(Ve[qe]={}),Be=Ve[qe]);const z=w(ee,Ue,"@container")||[],X=O(Re),be=b(Re);let ce;be?ce=Re["@list"]:X&&(ce=Re["@graph"]);let Pe=yield E.compact({activeCtx:ee,activeProperty:Ue,element:be||X?ce:Re,options:me,compactionMap:te});if(be){if(V(Pe)||(Pe=[Pe]),z.includes("@list")){M(Be,Ue,Pe,{valueIsArray:!0,allowDuplicate:!0});continue}Pe={[E.compactIri({activeCtx:ee,iri:"@list",relativeTo:{vocab:!0}})]:Pe},"@index"in Re&&(Pe[E.compactIri({activeCtx:ee,iri:"@index",relativeTo:{vocab:!0}})]=Re["@index"])}if(X)if(z.includes("@graph")&&(z.includes("@id")||z.includes("@index")&&T(Re))){let wt;Be.hasOwnProperty(Ue)?wt=Be[Ue]:Be[Ue]=wt={};const pt=(z.includes("@id")?Re["@id"]:Re["@index"])||E.compactIri({activeCtx:ee,iri:"@none",relativeTo:{vocab:!0}});M(wt,pt,Pe,{propertyIsArray:!me.compactArrays||z.includes("@set")})}else z.includes("@graph")&&T(Re)?(V(Pe)&&Pe.length>1&&(Pe={"@included":Pe}),M(Be,Ue,Pe,{propertyIsArray:!me.compactArrays||z.includes("@set")})):(V(Pe)&&1===Pe.length&&me.compactArrays&&(Pe=Pe[0]),Pe={[E.compactIri({activeCtx:ee,iri:"@graph",relativeTo:{vocab:!0}})]:Pe},"@id"in Re&&(Pe[E.compactIri({activeCtx:ee,iri:"@id",relativeTo:{vocab:!0}})]=Re["@id"]),"@index"in Re&&(Pe[E.compactIri({activeCtx:ee,iri:"@index",relativeTo:{vocab:!0}})]=Re["@index"]),M(Be,Ue,Pe,{propertyIsArray:!me.compactArrays||z.includes("@set")}));else if(z.includes("@language")||z.includes("@index")||z.includes("@id")||z.includes("@type")){let wt,pt;if(Be.hasOwnProperty(Ue)?wt=Be[Ue]:Be[Ue]=wt={},z.includes("@language"))S(Pe)&&(Pe=Pe["@value"]),pt=Re["@language"];else if(z.includes("@index")){const fe=w(ee,Ue,"@index")||"@index",B=E.compactIri({activeCtx:ee,iri:fe,relativeTo:{vocab:!0}});if("@index"===fe)pt=Re["@index"],delete Pe[B];else{let R;if([pt,...R]=F(Pe[fe]||[]),re(pt))switch(R.length){case 0:delete Pe[fe];break;case 1:Pe[fe]=R[0];break;default:Pe[fe]=R}else pt=null}}else if(z.includes("@id")){const fe=E.compactIri({activeCtx:ee,iri:"@id",relativeTo:{vocab:!0}});pt=Pe[fe],delete Pe[fe]}else if(z.includes("@type")){const fe=E.compactIri({activeCtx:ee,iri:"@type",relativeTo:{vocab:!0}});let B;switch([pt,...B]=F(Pe[fe]||[]),B.length){case 0:delete Pe[fe];break;case 1:Pe[fe]=B[0];break;default:Pe[fe]=B}1===Object.keys(Pe).length&&"@id"in Re&&(Pe=yield E.compact({activeCtx:ee,activeProperty:Ue,element:{"@id":Re["@id"]},options:me,compactionMap:te}))}pt||(pt=E.compactIri({activeCtx:ee,iri:"@none",relativeTo:{vocab:!0}})),M(wt,pt,Pe,{propertyIsArray:z.includes("@set")})}else{const wt=!me.compactArrays||z.includes("@set")||z.includes("@list")||V(Pe)&&0===Pe.length||"@list"===Le||"@graph"===Le;M(Be,Ue,Pe,{propertyIsArray:wt})}}}else{if((w(ee,se,"@container")||[]).includes("@index"))continue;const Ue=E.compactIri({activeCtx:ee,iri:Le,relativeTo:{vocab:!0}});M(Ve,Ue,Ee)}else{const Re=yield E.compact({activeCtx:ee,activeProperty:se,element:Ee,options:me,compactionMap:te});V(Re)&&0===Re.length||M(Ve,Le,Re)}else{const Re=yield E.compact({activeCtx:ee,activeProperty:"@reverse",element:Ee,options:me,compactionMap:te});for(const Ue in Re)if(ee.mappings.has(Ue)&&ee.mappings.get(Ue).reverse){const qe=Re[Ue],z=(w(ee,Ue,"@container")||[]).includes("@set")||!me.compactArrays;M(Ve,Ue,qe,{propertyIsArray:z}),delete Re[Ue]}if(Object.keys(Re).length>0){const Ue=E.compactIri({activeCtx:ee,iri:Le,relativeTo:{vocab:!0}});M(Ve,Ue,Re)}}else{let Re=F(Ee).map(X=>E.compactIri({activeCtx:nt,iri:X,relativeTo:{vocab:!0}}));1===Re.length&&(Re=Re[0]);const Ue=E.compactIri({activeCtx:ee,iri:"@type",relativeTo:{vocab:!0}}),z=(w(ee,Ue,"@container")||[]).includes("@set")&&I(ee,1.1)||V(Re)&&0===Ee.length;M(Ve,Ue,Re,{propertyIsArray:z})}else{let Re=F(Ee).map(qe=>E.compactIri({activeCtx:ee,iri:qe,relativeTo:{vocab:!1},base:me.base}));1===Re.length&&(Re=Re[0]),Ve[E.compactIri({activeCtx:ee,iri:"@id",relativeTo:{vocab:!0}})]=Re}}return Ve}return Te});return function(ee){return ue.apply(this,arguments)}}(),E.compactIri=({activeCtx:ue,iri:ee,value:se=null,relativeTo:Te={vocab:!1},reverse:me=!1,base:te=null})=>{if(null===ee)return ee;ue.isPropertyTermScoped&&ue.previousContext&&(ue=ue.previousContext);const ye=ue.getInverse();if(D(ee)&&ee in ye&&"@none"in ye[ee]&&"@type"in ye[ee]["@none"]&&"@none"in ye[ee]["@none"]["@type"])return ye[ee]["@none"]["@type"]["@none"];if(Te.vocab&&ee in ye){const Je=ue["@language"]||"@none",Ye=[];L(se)&&"@index"in se&&!("@graph"in se)&&Ye.push("@index","@index@set"),L(se)&&"@preserve"in se&&(se=se["@preserve"][0]),O(se)?("@index"in se&&Ye.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in se&&Ye.push("@graph@id","@graph@id@set"),Ye.push("@graph","@graph@set","@set"),"@index"in se||Ye.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in se||Ye.push("@graph@id","@graph@id@set")):L(se)&&!S(se)&&Ye.push("@id","@id@set","@type","@set@type");let je="@language",Le="@null";if(me)je="@type",Le="@reverse",Ye.push("@set");else if(b(se)){"@index"in se||Ye.push("@list");const Re=se["@list"];if(0===Re.length)je="@any",Le="@none";else{let Ue=0===Re.length?Je:null,qe=null;for(let Be=0;Be<Re.length;++Be){const z=Re[Be];let X="@none",be="@none";if(S(z)?"@direction"in z?X=`${(z["@language"]||"").toLowerCase()}_${z["@direction"]}`:"@language"in z?X=z["@language"].toLowerCase():"@type"in z?be=z["@type"]:X="@null":be="@id",null===Ue?Ue=X:X!==Ue&&S(z)&&(Ue="@none"),null===qe?qe=be:be!==qe&&(qe="@none"),"@none"===Ue&&"@none"===qe)break}Ue=Ue||"@none",qe=qe||"@none","@none"!==qe?(je="@type",Le=qe):Le=Ue}}else{if(S(se))if("@language"in se&&!("@index"in se)){Ye.push("@language","@language@set"),Le=se["@language"];const Re=se["@direction"];Re&&(Le=`${Le}_${Re}`)}else"@direction"in se&&!("@index"in se)?Le=`_${se["@direction"]}`:"@type"in se&&(je="@type",Le=se["@type"]);else je="@type",Le="@id";Ye.push("@set")}Ye.push("@none"),L(se)&&!("@index"in se)&&Ye.push("@index","@index@set"),S(se)&&1===Object.keys(se).length&&Ye.push("@language","@language@set");const Ee=function(ue,ee,se,Te,me,te){null===te&&(te="@null");const ye=[];if(("@id"===te||"@reverse"===te)&&L(se)&&"@id"in se){"@reverse"===te&&ye.push("@reverse");const Ve=E.compactIri({activeCtx:ue,iri:se["@id"],relativeTo:{vocab:!0}});ue.mappings.has(Ve)&&ue.mappings.get(Ve)&&ue.mappings.get(Ve)["@id"]===se["@id"]?ye.push.apply(ye,["@vocab","@id"]):ye.push.apply(ye,["@id","@vocab"])}else{ye.push(te);const Ve=ye.find(nt=>nt.includes("_"));Ve&&ye.push(Ve.replace(/^[^_]+_/,"_"))}ye.push("@none");const Me=ue.inverse[ee];for(const Ve of Te){if(!(Ve in Me))continue;const nt=Me[Ve][me];for(const Ze of ye)if(Ze in nt)return nt[Ze]}return null}(ue,ee,se,Ye,je,Le);if(null!==Ee)return Ee}if(Te.vocab&&"@vocab"in ue){const Je=ue["@vocab"];if(0===ee.indexOf(Je)&&ee!==Je){const Ye=ee.substr(Je.length);if(!ue.mappings.has(Ye))return Ye}}let Me=null;const Ve=[];let nt=ue.fastCurieMap;const Ze=ee.length-1;for(let Je=0;Je<Ze&&ee[Je]in nt;++Je)nt=nt[ee[Je]],""in nt&&Ve.push(nt[""][0]);for(let Je=Ve.length-1;Je>=0;--Je){const Ye=Ve[Je],je=Ye.terms;for(const Le of je){const Ee=Le+":"+ee.substr(Ye.iri.length);ue.mappings.get(Le)._prefix&&(!ue.mappings.has(Ee)||null===se&&ue.mappings.get(Ee)["@id"]===ee)&&(null===Me||Q(Ee,Me)<0)&&(Me=Ee)}}if(null!==Me)return Me;for(const[Je,Ye]of ue.mappings)if(Ye&&Ye._prefix&&ee.startsWith(Je+":"))throw new q(`Absolute IRI "${ee}" confused with prefix "${Je}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:ue});return Te.vocab?ee:"@base"in ue?ue["@base"]?H(Y(te,ue["@base"]),ee):ee:H(te,ee)},E.compactValue=({activeCtx:ue,activeProperty:ee,value:se,options:Te})=>{if(S(se)){const Me=w(ue,ee,"@type"),Ve=w(ue,ee,"@language"),nt=w(ue,ee,"@direction"),Ze=w(ue,ee,"@container")||[],Je="@index"in se&&!Ze.includes("@index");if(!Je&&"@none"!==Me&&(se["@type"]===Me||"@language"in se&&se["@language"]===Ve&&"@direction"in se&&se["@direction"]===nt||"@language"in se&&se["@language"]===Ve||"@direction"in se&&se["@direction"]===nt))return se["@value"];const Ye=Object.keys(se).length,je=1===Ye||2===Ye&&"@index"in se&&!Je,Le="@language"in ue,Ee=re(se["@value"]),Re=ue.mappings.has(ee)&&null===ue.mappings.get(ee)["@language"];if(je&&"@none"!==Me&&(!Le||!Ee||Re))return se["@value"];const Ue={};return Je&&(Ue[E.compactIri({activeCtx:ue,iri:"@index",relativeTo:{vocab:!0}})]=se["@index"]),"@type"in se?Ue[E.compactIri({activeCtx:ue,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:ue,iri:se["@type"],relativeTo:{vocab:!0}}):"@language"in se&&(Ue[E.compactIri({activeCtx:ue,iri:"@language",relativeTo:{vocab:!0}})]=se["@language"]),"@direction"in se&&(Ue[E.compactIri({activeCtx:ue,iri:"@direction",relativeTo:{vocab:!0}})]=se["@direction"]),Ue[E.compactIri({activeCtx:ue,iri:"@value",relativeTo:{vocab:!0}})]=se["@value"],Ue}const me=y(ue,ee,{vocab:!0},Te),te=w(ue,ee,"@type"),ye=E.compactIri({activeCtx:ue,iri:se["@id"],relativeTo:{vocab:"@vocab"===te},base:Te.base});return"@id"===te||"@vocab"===te||"@graph"===me?ye:{[E.compactIri({activeCtx:ue,iri:"@id",relativeTo:{vocab:!0}})]:ye}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(K,Ae,he){"use strict";const q="http://www.w3.org/1999/02/22-rdf-syntax-ns#",V="http://www.w3.org/2001/XMLSchema#";Ae.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:q,RDF_LIST:q+"List",RDF_FIRST:q+"first",RDF_REST:q+"rest",RDF_NIL:q+"nil",RDF_TYPE:q+"type",RDF_PLAIN_LITERAL:q+"PlainLiteral",RDF_XML_LITERAL:q+"XMLLiteral",RDF_JSON_LITERAL:q+"JSON",RDF_OBJECT:q+"object",RDF_LANGSTRING:q+"langString",XSD:V,XSD_BOOLEAN:V+"boolean",XSD_DOUBLE:V+"double",XSD_INTEGER:V+"integer",XSD_STRING:V+"string"}},{}],19:[function(K,Ae,he){"use strict";const q=K("./util"),V=K("./JsonLdError"),{isArray:L,isObject:re,isString:$,isUndefined:b}=K("./types"),{isAbsolute:S,isRelative:O,prependBase:T}=K("./url"),{asArray:v,compareShortestLeast:y}=K("./util"),w=new Map,j=/^@[a-zA-Z]+$/,I={};function H(M,F,Q,E,U,ie){if(null===F||!$(F)||I.isKeyword(F))return F;if(F.match(j))return null;if(E&&E.hasOwnProperty(F)&&!0!==U.get(F)&&I.createTermDefinition({activeCtx:M,localCtx:E,term:F,defined:U,options:ie}),(Q=Q||{}).vocab){const ee=M.mappings.get(F);if(null===ee)return null;if(re(ee)&&"@id"in ee)return ee["@id"]}const ue=F.indexOf(":");if(ue>0){const ee=F.substr(0,ue),se=F.substr(ue+1);if("_"===ee||0===se.indexOf("//"))return F;E&&E.hasOwnProperty(ee)&&I.createTermDefinition({activeCtx:M,localCtx:E,term:ee,defined:U,options:ie});const Te=M.mappings.get(ee);if(Te&&Te._prefix)return Te["@id"]+se;if(S(F))return F}if(Q.vocab&&"@vocab"in M)return M["@vocab"]+F;if(Q.base&&"@base"in M){if(M["@base"])return T(T(ie.base,M["@base"]),F)}else if(Q.base)return T(ie.base,F);return F}function Y(M,F){if(!M||"object"!=typeof M||!F||"object"!=typeof F)return M===F;const Q=Array.isArray(M);if(Q!==Array.isArray(F))return!1;if(Q){if(M.length!==F.length)return!1;for(let ie=0;ie<M.length;++ie)if(!Y(M[ie],F[ie]))return!1;return!0}const E=Object.keys(M),U=Object.keys(F);if(E.length!==U.length)return!1;for(const ie in M){let ue=M[ie],ee=F[ie];if("@container"===ie&&Array.isArray(ue)&&Array.isArray(ee)&&(ue=ue.slice().sort(),ee=ee.slice().sort()),!Y(ue,ee))return!1}return!0}Ae.exports=I,I.process=function(){var M=gt(function*({activeCtx:F,localCtx:Q,options:E,propagate:U=!0,overrideProtected:ie=!1,cycles:ue=new Set}){if(re(Q)&&"@context"in Q&&L(Q["@context"])&&(Q=Q["@context"]),0===v(Q).length)return F;const se=yield E.contextResolver.resolve({activeCtx:F,context:Q,documentLoader:E.documentLoader,base:E.base});re(se[0].document)&&"boolean"==typeof se[0].document["@propagate"]&&(U=se[0].document["@propagate"]);let Te=F;!U&&!Te.previousContext&&(Te=Te.clone(),Te.previousContext=F);for(const me of se){let{document:te}=me;if(F=Te,null===te){if(!ie&&0!==Object.keys(F.protected).length){const Ve=E&&E.protectedMode||"error";if("error"===Ve)throw new V("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===Ve){console.warn("WARNING: invalid context nullification");const nt=me.getProcessed(F);if(nt){Te=F=nt;continue}const Ze=F;Te=F=I.getInitialContext(E).clone();for(const[Je,Ye]of Object.entries(Ze.protected))Ye&&(F.mappings[Je]=q.clone(Ze.mappings[Je]));F.protected=q.clone(Ze.protected),me.setProcessed(Ze,Te);continue}throw new V("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:Q,protectedMode:Ve})}Te=F=I.getInitialContext(E).clone();continue}const ye=me.getProcessed(F);if(ye){Te=F=ye;continue}if(re(te)&&"@context"in te&&(te=te["@context"]),!re(te))throw new V("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:te});Te=Te.clone();const Me=new Map;if("@version"in te){if(1.1!==te["@version"])throw new V("Unsupported JSON-LD version: "+te["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:te});if(F.processingMode&&"json-ld-1.0"===F.processingMode)throw new V("@version: "+te["@version"]+" not compatible with "+F.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:te});Te.processingMode="json-ld-1.1",Te["@version"]=te["@version"],Me.set("@version",!0)}if(Te.processingMode=Te.processingMode||F.processingMode,"@base"in te){let Ve=te["@base"];if(null!==Ve&&!S(Ve)){if(!O(Ve))throw new V('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:te});Ve=T(Te["@base"],Ve)}Te["@base"]=Ve,Me.set("@base",!0)}if("@vocab"in te){const Ve=te["@vocab"];if(null===Ve)delete Te["@vocab"];else{if(!$(Ve))throw new V('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});if(!S(Ve)&&I.processingMode(Te,1))throw new V('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});Te["@vocab"]=H(Te,Ve,{vocab:!0,base:!0},void 0,void 0,E)}Me.set("@vocab",!0)}if("@language"in te){const Ve=te["@language"];if(null===Ve)delete Te["@language"];else{if(!$(Ve))throw new V('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:te});Te["@language"]=Ve.toLowerCase()}Me.set("@language",!0)}if("@direction"in te){const Ve=te["@direction"];if("json-ld-1.0"===F.processingMode)throw new V("Invalid JSON-LD syntax; @direction not compatible with "+F.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:te});if(null===Ve)delete Te["@direction"];else{if("ltr"!==Ve&&"rtl"!==Ve)throw new V('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:te});Te["@direction"]=Ve}Me.set("@direction",!0)}if("@propagate"in te){const Ve=te["@propagate"];if("json-ld-1.0"===F.processingMode)throw new V("Invalid JSON-LD syntax; @propagate not compatible with "+F.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if("boolean"!=typeof Ve)throw new V("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:Q});Me.set("@propagate",!0)}if("@import"in te){const Ve=te["@import"];if("json-ld-1.0"===F.processingMode)throw new V("Invalid JSON-LD syntax; @import not compatible with "+F.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if(!$(Ve))throw new V("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:Q});const nt=yield E.contextResolver.resolve({activeCtx:F,context:Ve,documentLoader:E.documentLoader,base:E.base});if(1!==nt.length)throw new V("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:Q});const Ze=nt[0].getProcessed(F);if(Ze)te=Ze;else{const Je=nt[0].document;if("@import"in Je)throw new V("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:Q});for(const Ye in Je)te.hasOwnProperty(Ye)||(te[Ye]=Je[Ye]);nt[0].setProcessed(F,te)}Me.set("@import",!0)}Me.set("@protected",te["@protected"]||!1);for(const Ve in te)if(I.createTermDefinition({activeCtx:Te,localCtx:te,term:Ve,defined:Me,options:E,overrideProtected:ie}),re(te[Ve])&&"@context"in te[Ve]){const nt=te[Ve]["@context"];let Ze=!0;if($(nt)){const Je=T(E.base,nt);ue.has(Je)?Ze=!1:ue.add(Je)}if(Ze)try{yield I.process({activeCtx:Te.clone(),localCtx:te[Ve]["@context"],overrideProtected:!0,options:E,cycles:ue})}catch(Je){throw new V("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:te[Ve]["@context"],term:Ve})}}me.setProcessed(F,Te)}return Te});return function(F){return M.apply(this,arguments)}}(),I.createTermDefinition=({activeCtx:M,localCtx:F,term:Q,defined:E,options:U,overrideProtected:ie=!1})=>{if(E.has(Q)){if(E.get(Q))return;throw new V("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:F,term:Q})}let ue;if(E.set(Q,!1),F.hasOwnProperty(Q)&&(ue=F[Q]),"@type"===Q&&re(ue)&&"@set"===(ue["@container"]||"@set")&&I.processingMode(M,1.1)){const Me=["@container","@id","@protected"],Ve=Object.keys(ue);if(0===Ve.length||Ve.some(nt=>!Me.includes(nt)))throw new V("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:F,term:Q})}else{if(I.isKeyword(Q))throw new V("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:F,term:Q});if(Q.match(j))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:Q});if(""===Q)throw new V("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:F})}const ee=M.mappings.get(Q);M.mappings.has(Q)&&M.mappings.delete(Q);let se=!1;if(($(ue)||null===ue)&&(se=!0,ue={"@id":ue}),!re(ue))throw new V("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:F});const Te={};M.mappings.set(Q,Te),Te.reverse=!1;const me=["@container","@id","@language","@reverse","@type"];I.processingMode(M,1.1)&&me.push("@context","@direction","@index","@nest","@prefix","@protected");for(const Me in ue)if(!me.includes(Me))throw new V("Invalid JSON-LD syntax; a term definition must not contain "+Me,"jsonld.SyntaxError",{code:"invalid term definition",context:F});const te=Q.indexOf(":");if(Te._termHasColon=te>0,"@reverse"in ue){if("@id"in ue)throw new V("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:F});if("@nest"in ue)throw new V("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:F});const Me=ue["@reverse"];if(!$(Me))throw new V("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});if(!I.isKeyword(Me)&&Me.match(j))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:Me}),void(ee?M.mappings.set(Q,ee):M.mappings.delete(Q));const Ve=H(M,Me,{vocab:!0,base:!1},F,E,U);if(!S(Ve))throw new V("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});Te["@id"]=Ve,Te.reverse=!0}else if("@id"in ue){let Me=ue["@id"];if(Me&&!$(Me))throw new V("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});if(null===Me)Te["@id"]=null;else{if(!I.isKeyword(Me)&&Me.match(j))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:Me}),void(ee?M.mappings.set(Q,ee):M.mappings.delete(Q));if(Me!==Q){if(Me=H(M,Me,{vocab:!0,base:!1},F,E,U),!S(Me)&&!I.isKeyword(Me))throw new V("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});if(Q.match(/(?::[^:])|\//)&&H(M,Q,{vocab:!0,base:!1},F,new Map(E).set(Q,!0),U)!==Me)throw new V("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});Te["@id"]=Me,Te._prefix=se&&!Te._termHasColon&&Me.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in Te))if(Te._termHasColon){const Me=Q.substr(0,te);if(F.hasOwnProperty(Me)&&I.createTermDefinition({activeCtx:M,localCtx:F,term:Me,defined:E,options:U}),M.mappings.has(Me)){const Ve=Q.substr(te+1);Te["@id"]=M.mappings.get(Me)["@id"]+Ve}else Te["@id"]=Q}else if("@type"===Q)Te["@id"]=Q;else{if(!("@vocab"in M))throw new V("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F,term:Q});Te["@id"]=M["@vocab"]+Q}if((!0===ue["@protected"]||!0===E.get("@protected")&&!1!==ue["@protected"])&&(M.protected[Q]=!0,Te.protected=!0),E.set(Q,!0),"@type"in ue){let Me=ue["@type"];if(!$(Me))throw new V("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:F});if("@json"===Me||"@none"===Me){if(I.processingMode(M,1))throw new V(`Invalid JSON-LD syntax; an @context @type value must not be "${Me}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:F})}else if("@id"!==Me&&"@vocab"!==Me){if(Me=H(M,Me,{vocab:!0,base:!1},F,E,U),!S(Me))throw new V("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:F});if(0===Me.indexOf("_:"))throw new V("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:F})}Te["@type"]=Me}if("@container"in ue){const Me=$(ue["@container"])?[ue["@container"]]:ue["@container"]||[],Ve=["@list","@set","@index","@language"];let nt=!0;const Ze=Me.includes("@set");if(I.processingMode(M,1.1)){if(Ve.push("@graph","@id","@type"),Me.includes("@list")){if(1!==Me.length)throw new V("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:F})}else if(Me.includes("@graph")){if(Me.some(Je=>"@graph"!==Je&&"@id"!==Je&&"@index"!==Je&&"@set"!==Je))throw new V("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:F})}else nt&=Me.length<=(Ze?2:1);if(Me.includes("@type")&&(Te["@type"]=Te["@type"]||"@id",!["@id","@vocab"].includes(Te["@type"])))throw new V("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:F})}else nt&=!L(ue["@container"]),nt&=Me.length<=1;if(nt&=Me.every(Je=>Ve.includes(Je)),nt&=!(Ze&&Me.includes("@list")),!nt)throw new V("Invalid JSON-LD syntax; @context @container value must be one of the following: "+Ve.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:F});if(Te.reverse&&!Me.every(Je=>["@index","@set"].includes(Je)))throw new V("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:F});Te["@container"]=Me}if("@index"in ue){if(!("@container"in ue)||!Te["@container"].includes("@index"))throw new V(`Invalid JSON-LD syntax; @index without @index in @container: "${ue["@index"]}" on term "${Q}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:F});if(!$(ue["@index"])||0===ue["@index"].indexOf("@"))throw new V(`Invalid JSON-LD syntax; @index must expand to an IRI: "${ue["@index"]}" on term "${Q}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:F});Te["@index"]=ue["@index"]}if("@context"in ue&&(Te["@context"]=ue["@context"]),"@language"in ue&&!("@type"in ue)){let Me=ue["@language"];if(null!==Me&&!$(Me))throw new V("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:F});null!==Me&&(Me=Me.toLowerCase()),Te["@language"]=Me}if("@prefix"in ue){if(Q.match(/:|\//))throw new V("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:F});if(I.isKeyword(Te["@id"]))throw new V("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:F});if("boolean"!=typeof ue["@prefix"])throw new V("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:F});Te._prefix=!0===ue["@prefix"]}if("@direction"in ue){const Me=ue["@direction"];if(null!==Me&&"ltr"!==Me&&"rtl"!==Me)throw new V('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:F});Te["@direction"]=Me}if("@nest"in ue){const Me=ue["@nest"];if(!$(Me)||"@nest"!==Me&&0===Me.indexOf("@"))throw new V("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:F});Te["@nest"]=Me}const ye=Te["@id"];if("@context"===ye||"@preserve"===ye)throw new V("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:F});if(ee&&ee.protected&&!ie&&(M.protected[Q]=!0,Te.protected=!0,!Y(ee,Te))){const Me=U&&U.protectedMode||"error";if("error"===Me)throw new V(`Invalid JSON-LD syntax; tried to redefine "${Q}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:F,term:Q});if("warn"===Me)return void console.warn("WARNING: protected term redefinition",{term:Q});throw new V("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:F,term:Q,protectedMode:Me})}},I.expandIri=(M,F,Q,E)=>H(M,F,Q,void 0,void 0,E),I.getInitialContext=M=>{const F=JSON.stringify({processingMode:M.processingMode}),Q=w.get(F);if(Q)return Q;const E={processingMode:M.processingMode,mappings:new Map,inverse:null,getInverse:function(){const Te=this;if(Te.inverse)return Te.inverse;const me=Te.inverse={},te=Te.fastCurieMap={},ye={},Me=(Te["@language"]||"@none").toLowerCase(),Ve=Te["@direction"],nt=Te.mappings,Ze=[...nt.keys()].sort(y);for(const Je of Ze){const Ye=nt.get(Je);if(null===Ye)continue;let je=Ye["@container"]||"@none";if(je=[].concat(je).sort().join(""),null===Ye["@id"])continue;const Le=v(Ye["@id"]);for(const Ee of Le){let Re=me[Ee];const Ue=I.isKeyword(Ee);if(Re)!Ue&&!Ye._termHasColon&&ye[Ee].push(Je);else if(me[Ee]=Re={},!Ue&&!Ye._termHasColon){ye[Ee]=[Je];const qe={iri:Ee,terms:ye[Ee]};Ee[0]in te?te[Ee[0]].push(qe):te[Ee[0]]=[qe]}if(Re[je]||(Re[je]={"@language":{},"@type":{},"@any":{}}),Re=Re[je],ue(Je,Re["@any"],"@none"),Ye.reverse)ue(Je,Re["@type"],"@reverse");else if("@none"===Ye["@type"])ue(Je,Re["@any"],"@none"),ue(Je,Re["@language"],"@none"),ue(Je,Re["@type"],"@none");else if("@type"in Ye)ue(Je,Re["@type"],Ye["@type"]);else if("@language"in Ye&&"@direction"in Ye){const qe=Ye["@language"],Be=Ye["@direction"];ue(Je,Re["@language"],qe&&Be?`${qe}_${Be}`.toLowerCase():qe?qe.toLowerCase():Be?`_${Be}`:"@null")}else"@language"in Ye?ue(Je,Re["@language"],(Ye["@language"]||"@null").toLowerCase()):"@direction"in Ye?ue(Je,Re["@language"],Ye["@direction"]?`_${Ye["@direction"]}`:"@none"):Ve?(ue(Je,Re["@language"],`_${Ve}`),ue(Je,Re["@language"],"@none"),ue(Je,Re["@type"],"@none")):(ue(Je,Re["@language"],Me),ue(Je,Re["@language"],"@none"),ue(Je,Re["@type"],"@none"))}}for(const Je in te)ie(te,Je,1);return me},clone:function(){const Te={};return Te.mappings=q.clone(this.mappings),Te.clone=this.clone,Te.inverse=null,Te.getInverse=this.getInverse,Te.protected=q.clone(this.protected),this.previousContext&&(Te.previousContext=this.previousContext.clone()),Te.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(Te["@base"]=this["@base"]),"@language"in this&&(Te["@language"]=this["@language"]),"@vocab"in this&&(Te["@vocab"]=this["@vocab"]),Te},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===w.size&&w.clear(),w.set(F,E),E;function ie(Te,me,te){const ye=Te[me],Me=Te[me]={};let Ve,nt;for(const Ze of ye)Ve=Ze.iri,nt=te>=Ve.length?"":Ve[te],nt in Me?Me[nt].push(Ze):Me[nt]=[Ze];for(const Ze in Me)""!==Ze&&ie(Me,Ze,te+1)}function ue(Te,me,te){me.hasOwnProperty(te)||(me[te]=Te)}},I.getContextValue=(M,F,Q)=>{if(null===F)return"@context"===Q?void 0:null;if(M.mappings.has(F)){const E=M.mappings.get(F);if(b(Q))return E;if(E.hasOwnProperty(Q))return E[Q]}return"@language"===Q&&Q in M||"@direction"===Q&&Q in M?M[Q]:"@context"!==Q?null:void 0},I.processingMode=(M,F)=>F.toString()>="1.1"?!M.processingMode||M.processingMode>="json-ld-"+F.toString():"json-ld-1.0"===M.processingMode,I.isKeyword=M=>{if(!$(M)||"@"!==M[0])return!1;switch(M){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(K,Ae,he){"use strict";const{parseLinkHeader:q,buildHeaders:V}=K("../util"),{LINK_HEADER_CONTEXT:L}=K("../constants"),re=K("../JsonLdError"),$=K("../RequestQueue"),{prependBase:b}=K("../url"),S=/(^|(\r\n))link:/i;function O(T,v,y){const w=new(T=T||XMLHttpRequest);return new Promise((D,j)=>{w.onload=()=>D(w),w.onerror=I=>j(I),w.open("GET",v,!0);for(const I in y)w.setRequestHeader(I,y[I]);w.send()})}Ae.exports=({secure:T,headers:v={},xhr:y}={headers:{}})=>{return v=V(v),(new $).wrapLoader(D);function D(I){return j.apply(this,arguments)}function j(){return(j=gt(function*(I){if(0!==I.indexOf("http:")&&0!==I.indexOf("https:"))throw new re('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:I});if(T&&0!==I.indexOf("https"))throw new re('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:I});let H;try{H=yield O(y,I,v)}catch(E){throw new re("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:I,cause:E})}if(H.status>=400)throw new re("URL could not be dereferenced: "+H.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:I,httpStatusCode:H.status});let Y={contextUrl:null,documentUrl:I,document:H.response},M=null;const F=H.getResponseHeader("Content-Type");let Q;if(S.test(H.getAllResponseHeaders())&&(Q=H.getResponseHeader("Link")),Q&&"application/ld+json"!==F){const E=q(Q),U=E[L];if(Array.isArray(U))throw new re("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:I});U&&(Y.contextUrl=U.target),M=E.alternate,M&&"application/ld+json"==M.type&&!(F||"").match(/^application\/(\w*\+)?json$/)&&(Y=yield D(b(I,M.target)))}return Y})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(K,Ae,he){"use strict";const q=K("./JsonLdError"),{isArray:V,isObject:L,isEmptyObject:re,isString:$,isUndefined:b}=K("./types"),{isList:S,isValue:O,isGraph:T,isSubject:v}=K("./graphTypes"),{expandIri:y,getContextValue:w,isKeyword:D,process:j,processingMode:I}=K("./context"),{isAbsolute:H}=K("./url"),{addValue:Y,asArray:M,getValues:F,validateTypeValue:Q}=K("./util"),E={};Ae.exports=E;const U=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function ie(te){return ue.apply(this,arguments)}function ue(){return(ue=gt(function*({activeCtx:te,activeProperty:ye,expandedActiveProperty:Me,element:Ve,expandedParent:nt,options:Ze={},insideList:Je,typeKey:Ye,typeScopedContext:je,expansionMap:Le}){const Ee=Object.keys(Ve).sort(),Re=[];let Ue;const qe=Ve[Ye]&&"@json"===y(te,V(Ve[Ye])?Ve[Ye][0]:Ve[Ye],{vocab:!0},Ze);for(const Be of Ee){let X,z=Ve[Be];if("@context"===Be)continue;let be=y(te,Be,{vocab:!0},Ze);if((null===be||!H(be)&&!D(be))&&(be=Le({unmappedProperty:Be,activeCtx:te,activeProperty:ye,parent:Ve,options:Ze,insideList:Je,value:z,expandedParent:nt}),void 0===be))continue;if(D(be)){if("@reverse"===Me)throw new q("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:z});if(be in nt&&"@included"!==be&&"@type"!==be)throw new q("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:be})}if("@id"===be){if(!$(z)){if(!Ze.isFrame)throw new q('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:z});if(L(z)){if(!re(z))throw new q('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:z})}else{if(!V(z))throw new q('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:z});if(!z.every(pt=>$(pt)))throw new q('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:z})}}Y(nt,"@id",M(z).map(pt=>$(pt)?y(te,pt,{base:!0},Ze):pt),{propertyIsArray:Ze.isFrame});continue}if("@type"===be){L(z)&&(z=Object.fromEntries(Object.entries(z).map(([pt,fe])=>[y(je,pt,{vocab:!0}),M(fe).map(B=>y(je,B,{base:!0,vocab:!0}))]))),Q(z,Ze.isFrame),Y(nt,"@type",M(z).map(pt=>$(pt)?y(je,pt,{base:!0,vocab:!0},Ze):pt),{propertyIsArray:Ze.isFrame});continue}if("@included"===be&&I(te,1.1)){const pt=M(yield E.expand({activeCtx:te,activeProperty:ye,element:z,options:Ze,expansionMap:Le}));if(!pt.every(fe=>v(fe)))throw new q("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:z});Y(nt,"@included",pt,{propertyIsArray:!0});continue}if("@graph"===be&&!L(z)&&!V(z))throw new q('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:z});if("@value"===be){Ue=z,qe&&I(te,1.1)?nt["@value"]=z:Y(nt,"@value",z,{propertyIsArray:Ze.isFrame});continue}if("@language"===be){if(null===z)continue;if(!$(z)&&!Ze.isFrame)throw new q('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:z});z=M(z).map(pt=>$(pt)?pt.toLowerCase():pt);for(const pt of z)$(pt)&&!pt.match(U)&&console.warn(`@language must be valid BCP47: ${pt}`);Y(nt,"@language",z,{propertyIsArray:Ze.isFrame});continue}if("@direction"===be){if(!$(z)&&!Ze.isFrame)throw new q('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:z});z=M(z);for(const pt of z)if($(pt)&&"ltr"!==pt&&"rtl"!==pt)throw new q('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:z});Y(nt,"@direction",z,{propertyIsArray:Ze.isFrame});continue}if("@index"===be){if(!$(z))throw new q('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:z});Y(nt,"@index",z);continue}if("@reverse"===be){if(!L(z))throw new q('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:z});if(X=yield E.expand({activeCtx:te,activeProperty:"@reverse",element:z,options:Ze,expansionMap:Le}),"@reverse"in X)for(const fe in X["@reverse"])Y(nt,fe,X["@reverse"][fe],{propertyIsArray:!0});let pt=nt["@reverse"]||null;for(const fe in X){if("@reverse"===fe)continue;null===pt&&(pt=nt["@reverse"]={}),Y(pt,fe,[],{propertyIsArray:!0});const B=X[fe];for(let R=0;R<B.length;++R){const k=B[R];if(O(k)||S(k))throw new q('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:X});Y(pt,fe,k,{propertyIsArray:!0})}}continue}if("@nest"===be){Re.push(Be);continue}let ce=te;const Pe=w(te,Be,"@context");b(Pe)||(ce=yield j({activeCtx:te,localCtx:Pe,propagate:!0,overrideProtected:!0,options:Ze}));const wt=w(ce,Be,"@container")||[];if(wt.includes("@language")&&L(z))X=se(ce,z,w(ce,Be,"@direction"),Ze);else if(wt.includes("@index")&&L(z)){const pt=wt.includes("@graph"),fe=w(ce,Be,"@index")||"@index",B="@index"!==fe&&y(te,fe,{vocab:!0},Ze);X=yield Te({activeCtx:ce,options:Ze,activeProperty:Be,value:z,expansionMap:Le,asGraph:pt,indexKey:fe,propertyIndex:B})}else if(wt.includes("@id")&&L(z)){const pt=wt.includes("@graph");X=yield Te({activeCtx:ce,options:Ze,activeProperty:Be,value:z,expansionMap:Le,asGraph:pt,indexKey:"@id"})}else if(wt.includes("@type")&&L(z))X=yield Te({activeCtx:ce.revertToPreviousContext(),options:Ze,activeProperty:Be,value:z,expansionMap:Le,asGraph:!1,indexKey:"@type"});else{const pt="@list"===be;if(pt||"@set"===be){let fe=ye;pt&&"@graph"===Me&&(fe=null),X=yield E.expand({activeCtx:ce,activeProperty:fe,element:z,options:Ze,insideList:pt,expansionMap:Le})}else X="@json"===w(te,Be,"@type")?{"@type":"@json","@value":z}:yield E.expand({activeCtx:ce,activeProperty:Be,element:z,options:Ze,insideList:!1,expansionMap:Le})}if(null!==X||"@value"===be||(X=Le({unmappedValue:z,expandedProperty:be,activeCtx:ce,activeProperty:ye,parent:Ve,options:Ze,insideList:Je,key:Be,expandedParent:nt}),void 0!==X)){if("@list"!==be&&!S(X)&&wt.includes("@list")&&(X={"@list":M(X)}),wt.includes("@graph")&&!wt.some(pt=>"@id"===pt||"@index"===pt)&&(X=M(X).map(pt=>({"@graph":M(pt)}))),ce.mappings.has(Be)&&ce.mappings.get(Be).reverse){const pt=nt["@reverse"]=nt["@reverse"]||{};X=M(X);for(let fe=0;fe<X.length;++fe){const B=X[fe];if(O(B)||S(B))throw new q('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:X});Y(pt,be,B,{propertyIsArray:!0})}continue}Y(nt,be,X,{propertyIsArray:!0})}}if("@value"in nt&&("@json"!==nt["@type"]||!I(te,1.1))&&(L(Ue)||V(Ue))&&!Ze.isFrame)throw new q('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:Ue});for(const Be of Re){const z=V(Ve[Be])?Ve[Be]:[Ve[Be]];for(const X of z){if(!L(X)||Object.keys(X).some(be=>"@value"===y(te,be,{vocab:!0},Ze)))throw new q("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:X});yield ie({activeCtx:te,activeProperty:ye,expandedActiveProperty:Me,element:X,expandedParent:nt,options:Ze,insideList:Je,typeScopedContext:je,typeKey:Ye,expansionMap:Le})}}})).apply(this,arguments)}function ee({activeCtx:te,activeProperty:ye,value:Me,options:Ve}){if(null==Me)return null;const nt=y(te,ye,{vocab:!0},Ve);if("@id"===nt)return y(te,Me,{base:!0},Ve);if("@type"===nt)return y(te,Me,{vocab:!0,base:!0},Ve);const Ze=w(te,ye,"@type");if(("@id"===Ze||"@graph"===nt)&&$(Me))return{"@id":y(te,Me,{base:!0},Ve)};if("@vocab"===Ze&&$(Me))return{"@id":y(te,Me,{vocab:!0,base:!0},Ve)};if(D(nt))return Me;const Je={};if(Ze&&!["@id","@vocab","@none"].includes(Ze))Je["@type"]=Ze;else if($(Me)){const Ye=w(te,ye,"@language");null!==Ye&&(Je["@language"]=Ye);const je=w(te,ye,"@direction");null!==je&&(Je["@direction"]=je)}return["boolean","number","string"].includes(typeof Me)||(Me=Me.toString()),Je["@value"]=Me,Je}function se(te,ye,Me,Ve){const nt=[],Ze=Object.keys(ye).sort();for(const Je of Ze){const Ye=y(te,Je,{vocab:!0},Ve);let je=ye[Je];V(je)||(je=[je]);for(const Le of je){if(null===Le)continue;if(!$(Le))throw new q("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:ye});const Ee={"@value":Le};"@none"!==Ye&&(Ee["@language"]=Je.toLowerCase()),Me&&(Ee["@direction"]=Me),nt.push(Ee)}}return nt}function Te(te){return me.apply(this,arguments)}function me(){return(me=gt(function*({activeCtx:te,options:ye,activeProperty:Me,value:Ve,expansionMap:nt,asGraph:Ze,indexKey:Je,propertyIndex:Ye}){const je=[],Le=Object.keys(Ve).sort(),Ee="@type"===Je;for(let Re of Le){if(Ee){const Be=w(te,Re,"@context");b(Be)||(te=yield j({activeCtx:te,localCtx:Be,propagate:!1,options:ye}))}let qe,Ue=Ve[Re];V(Ue)||(Ue=[Ue]),Ue=yield E.expand({activeCtx:te,activeProperty:Me,element:Ue,options:ye,insideList:!1,insideIndex:!0,expansionMap:nt}),qe=Ye?"@none"===Re?"@none":ee({activeCtx:te,activeProperty:Je,value:Re,options:ye}):y(te,Re,{vocab:!0},ye),"@id"===Je?Re=y(te,Re,{base:!0},ye):Ee&&(Re=qe);for(let Be of Ue){if(Ze&&!T(Be)&&(Be={"@graph":[Be]}),"@type"===Je)"@none"===qe||(Be["@type"]=Be["@type"]?[Re].concat(Be["@type"]):[Re]);else{if(O(Be)&&!["@language","@type","@index"].includes(Je))throw new q(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${Je}".`,"jsonld.SyntaxError",{code:"invalid value object",value:Be});Ye?"@none"!==qe&&Y(Be,Ye,qe,{propertyIsArray:!0,prependValue:!0}):"@none"!==qe&&!(Je in Be)&&(Be[Je]=Re)}je.push(Be)}}return je})).apply(this,arguments)}E.expand=function(){var te=gt(function*({activeCtx:ye,activeProperty:Me=null,element:Ve,options:nt={},insideList:Ze=!1,insideIndex:Je=!1,typeScopedContext:Ye=null,expansionMap:je=(()=>{})}){if(null==Ve)return null;if("@default"===Me&&(nt=Object.assign({},nt,{isFrame:!1})),!V(Ve)&&!L(Ve)){if(!Ze&&(null===Me||"@graph"===y(ye,Me,{vocab:!0},nt))){const X=yield je({unmappedValue:Ve,activeCtx:ye,activeProperty:Me,options:nt,insideList:Ze});return void 0===X?null:X}return ee({activeCtx:ye,activeProperty:Me,value:Ve,options:nt})}if(V(Ve)){let X=[];const be=w(ye,Me,"@container")||[];Ze=Ze||be.includes("@list");for(let ce=0;ce<Ve.length;++ce){let Pe=yield E.expand({activeCtx:ye,activeProperty:Me,element:Ve[ce],options:nt,expansionMap:je,insideIndex:Je,typeScopedContext:Ye});Ze&&V(Pe)&&(Pe={"@list":Pe}),(null!==Pe||(Pe=yield je({unmappedValue:Ve[ce],activeCtx:ye,activeProperty:Me,parent:Ve,index:ce,options:nt,expandedParent:X,insideList:Ze}),void 0!==Pe))&&(V(Pe)?X=X.concat(Pe):X.push(Pe))}return X}const Le=y(ye,Me,{vocab:!0},nt),Ee=w(ye,Me,"@context");Ye=Ye||(ye.previousContext?ye:null);let Re=Object.keys(Ve).sort(),Ue=!Je;if(Ue&&Ye&&Re.length<=2&&!Re.includes("@context"))for(const X of Re){const be=y(Ye,X,{vocab:!0},nt);if("@value"===be){Ue=!1,ye=Ye;break}if("@id"===be&&1===Re.length){Ue=!1;break}}Ue&&(ye=ye.revertToPreviousContext()),b(Ee)||(ye=yield j({activeCtx:ye,localCtx:Ee,propagate:!0,overrideProtected:!0,options:nt})),"@context"in Ve&&(ye=yield j({activeCtx:ye,localCtx:Ve["@context"],options:nt})),Ye=ye;let qe=null;for(const X of Re)if("@type"===y(ye,X,{vocab:!0},nt)){qe=qe||X;const ce=Ve[X],Pe=Array.isArray(ce)?ce.length>1?ce.slice().sort():ce:[ce];for(const wt of Pe){const pt=w(Ye,wt,"@context");b(pt)||(ye=yield j({activeCtx:ye,localCtx:pt,options:nt,propagate:!1}))}}let Be={};yield ie({activeCtx:ye,activeProperty:Me,expandedActiveProperty:Le,element:Ve,expandedParent:Be,options:nt,insideList:Ze,typeKey:qe,typeScopedContext:Ye,expansionMap:je}),Re=Object.keys(Be);let z=Re.length;if("@value"in Be){if("@type"in Be&&("@language"in Be||"@direction"in Be))throw new q('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Be});let X=z-1;if("@type"in Be&&(X-=1),"@index"in Be&&(X-=1),"@language"in Be&&(X-=1),"@direction"in Be&&(X-=1),0!==X)throw new q('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Be});const be=null===Be["@value"]?[]:M(Be["@value"]),ce=F(Be,"@type");if(!I(ye,1.1)||!ce.includes("@json")||1!==ce.length)if(0===be.length){const Pe=yield je({unmappedValue:Be,activeCtx:ye,activeProperty:Me,element:Ve,options:nt,insideList:Ze});Be=void 0!==Pe?Pe:null}else{if(!be.every(Pe=>$(Pe)||re(Pe))&&"@language"in Be)throw new q("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:Be});if(!ce.every(Pe=>H(Pe)&&!($(Pe)&&0===Pe.indexOf("_:"))||re(Pe)))throw new q('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:Be})}}else if("@type"in Be&&!V(Be["@type"]))Be["@type"]=[Be["@type"]];else if("@set"in Be||"@list"in Be){if(z>1&&(2!==z||!("@index"in Be)))throw new q('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:Be});"@set"in Be&&(Be=Be["@set"],Re=Object.keys(Be),z=Re.length)}else if(1===z&&"@language"in Be){const X=yield je(Be,{unmappedValue:Be,activeCtx:ye,activeProperty:Me,element:Ve,options:nt,insideList:Ze});Be=void 0!==X?X:null}if(L(Be)&&!nt.keepFreeFloatingNodes&&!Ze&&(null===Me||"@graph"===Le)&&(0===z||"@value"in Be||"@list"in Be||1===z&&"@id"in Be)){const X=yield je({unmappedValue:Be,activeCtx:ye,activeProperty:Me,element:Ve,options:nt,insideList:Ze});Be=void 0!==X?X:null}return Be});return function(ye){return te.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(K,Ae,he){"use strict";const{isSubjectReference:q}=K("./graphTypes"),{createMergedNodeMap:V}=K("./nodeMap"),L={};Ae.exports=L,L.flatten=re=>{const $=V(re),b=[],S=Object.keys($).sort();for(let O=0;O<S.length;++O){const T=$[S[O]];q(T)||b.push(T)}return b}},{"./graphTypes":25,"./nodeMap":27}],23:[function(K,Ae,he){"use strict";const{isKeyword:q}=K("./context"),V=K("./graphTypes"),L=K("./types"),re=K("./util"),$=K("./url"),b=K("./JsonLdError"),{createNodeMap:S,mergeNodeMapGraphs:O}=K("./nodeMap"),T={};function v(E){const U={};for(const ie in E)void 0!==E[ie]&&(U["@"+ie]=[E[ie]]);return[U]}function y(E,U,ie){for(let ue=ie.length-1;ue>=0;--ue){const ee=ie[ue];if(ee.graph===U&&ee.subject["@id"]===E["@id"])return!0}return!1}function w(E,U,ie){const ue="@"+ie;let ee=ue in E?E[ue][0]:U[ie];if("embed"===ie)if(!0===ee)ee="@once";else if(!1===ee)ee="@never";else if("@always"!==ee&&"@never"!==ee&&"@link"!==ee&&"@first"!==ee&&"@last"!==ee&&"@once"!==ee)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:E});return ee}function D(E){if(!L.isArray(E)||1!==E.length||!L.isObject(E[0]))throw new b("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:E});if("@id"in E[0])for(const U of re.asArray(E[0]["@id"]))if(!L.isObject(U)&&!$.isAbsolute(U)||L.isString(U)&&0===U.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E});if("@type"in E[0])for(const U of re.asArray(E[0]["@type"]))if(!L.isObject(U)&&!$.isAbsolute(U)||L.isString(U)&&0===U.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E})}function I(E,U,ie,ue){let ee=!0,se=!1;for(const Te in ie){let me=!1;const te=re.getValues(U,Te),ye=0===re.getValues(ie,Te).length;if("@id"===Te){if(L.isEmptyObject(ie["@id"][0]||{})?me=!0:ie["@id"].length>=0&&(me=ie["@id"].includes(te[0])),!ue.requireAll)return me}else if("@type"===Te){if(ee=!1,ye){if(te.length>0)return!1;me=!0}else if(1===ie["@type"].length&&L.isEmptyObject(ie["@type"][0]))me=te.length>0;else for(const Me of ie["@type"])me=!(!L.isObject(Me)||!("@default"in Me))||me||te.some(Ve=>Ve===Me);if(!ue.requireAll)return me}else{if(q(Te))continue;{const Me=re.getValues(ie,Te)[0];let Ve=!1;if(Me&&(D([Me]),Ve="@default"in Me),ee=!1,0===te.length&&Ve)continue;if(te.length>0&&ye)return!1;if(void 0===Me){if(te.length>0)return!1;me=!0}else if(V.isList(Me)){const nt=Me["@list"][0];if(V.isList(te[0])){const Ze=te[0]["@list"];V.isValue(nt)?me=Ze.some(Je=>Q(nt,Je)):(V.isSubject(nt)||V.isSubjectReference(nt))&&(me=Ze.some(Je=>F(E,nt,Je,ue)))}}else me=V.isValue(Me)?te.some(nt=>Q(Me,nt)):V.isSubjectReference(Me)?te.some(nt=>F(E,Me,nt,ue)):!!L.isObject(Me)&&te.length>0}}if(!me&&ue.requireAll)return!1;se=se||me}return ee||se}function H(E,U){const ie=E.uniqueEmbeds[E.graph],ue=ie[U],ee=ue.parent,se=ue.property,Te={"@id":U};if(L.isArray(ee)){for(let te=0;te<ee.length;++te)if(re.compareValues(ee[te],Te)){ee[te]=Te;break}}else{const te=L.isArray(ee[se]);re.removeValue(ee,se,Te,{propertyIsArray:te}),re.addValue(ee,se,Te,{propertyIsArray:te})}const me=te=>{const ye=Object.keys(ie);for(const Me of ye)Me in ie&&L.isObject(ie[Me].parent)&&ie[Me].parent["@id"]===te&&(delete ie[Me],me(Me))};me(U)}function Y(E,U){if(L.isArray(E))return E.map(ie=>Y(ie,U));if(L.isObject(E)){if("@preserve"in E)return E["@preserve"][0];if(V.isValue(E))return E;if(V.isList(E))return E["@list"]=Y(E["@list"],U),E;if("@id"in E){const ie=E["@id"];if(U.link.hasOwnProperty(ie)){const ue=U.link[ie].indexOf(E);if(-1!==ue)return U.link[ie][ue];U.link[ie].push(E)}else U.link[ie]=[E]}for(const ie in E)"@id"===ie&&U.bnodesToClear.includes(E[ie])?delete E["@id"]:E[ie]=Y(E[ie],U)}return E}function M(E,U,ie){L.isObject(E)?re.addValue(E,U,ie,{propertyIsArray:!0}):E.push(ie)}function F(E,U,ie,ue){if(!("@id"in ie))return!1;const ee=E.subjects[ie["@id"]];return ee&&I(E,ee,U,ue)}function Q(E,U){const ie=U["@value"],ue=U["@type"],ee=U["@language"],se=E["@value"]?L.isArray(E["@value"])?E["@value"]:[E["@value"]]:[],Te=E["@type"]?L.isArray(E["@type"])?E["@type"]:[E["@type"]]:[],me=E["@language"]?L.isArray(E["@language"])?E["@language"]:[E["@language"]]:[];return 0===se.length&&0===Te.length&&0===me.length||!(!se.includes(ie)&&!L.isEmptyObject(se[0])||!(!ue&&0===Te.length||Te.includes(ue)||ue&&L.isEmptyObject(Te[0]))||!(!ee&&0===me.length||me.includes(ee)||ee&&L.isEmptyObject(me[0])))}Ae.exports=T,T.frameMergedOrDefault=(E,U,ie)=>{const ue={options:ie,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},ee=new re.IdentifierIssuer("_:b");S(E,ue.graphMap,"@default",ee),ie.merged&&(ue.graphMap["@merged"]=O(ue.graphMap),ue.graph="@merged"),ue.subjects=ue.graphMap[ue.graph];const se=[];return T.frame(ue,Object.keys(ue.subjects).sort(),U,se),ie.pruneBlankNodeIdentifiers&&(ie.bnodesToClear=Object.keys(ue.bnodeMap).filter(Te=>1===ue.bnodeMap[Te].length)),ie.link={},Y(se,ie)},T.frame=(E,U,ie,ue,ee=null)=>{D(ie);const se=E.options,Te={embed:w(ie=ie[0],se,"embed"),explicit:w(ie,se,"explicit"),requireAll:w(ie,se,"requireAll")};E.link.hasOwnProperty(E.graph)||(E.link[E.graph]={});const me=E.link[E.graph],te=function(E,U,ie,ue){const ee={};for(const se of U){const Te=E.graphMap[E.graph][se];I(E,Te,ie,ue)&&(ee[se]=Te)}return ee}(E,U,ie,Te),ye=Object.keys(te).sort();for(const Me of ye){const Ve=te[Me];if(null===ee?E.uniqueEmbeds={[E.graph]:{}}:E.uniqueEmbeds[E.graph]=E.uniqueEmbeds[E.graph]||{},"@link"===Te.embed&&Me in me){M(ue,ee,me[Me]);continue}const nt={"@id":Me};if(0===Me.indexOf("_:")&&re.addValue(E.bnodeMap,Me,nt,{propertyIsArray:!0}),me[Me]=nt,("@first"===Te.embed||"@last"===Te.embed)&&E.is11)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:ie});if(E.embedded||!E.uniqueEmbeds[E.graph].hasOwnProperty(Me)){if(E.embedded&&("@never"===Te.embed||y(Ve,E.graph,E.subjectStack))){M(ue,ee,nt);continue}if(E.embedded&&("@first"==Te.embed||"@once"==Te.embed)&&E.uniqueEmbeds[E.graph].hasOwnProperty(Me)){M(ue,ee,nt);continue}if("@last"===Te.embed&&Me in E.uniqueEmbeds[E.graph]&&H(E,Me),E.uniqueEmbeds[E.graph][Me]={parent:ue,property:ee},E.subjectStack.push({subject:Ve,graph:E.graph}),Me in E.graphMap){let Ze=!1,Je=null;"@graph"in ie?(Je=ie["@graph"][0],Ze=!("@merged"===Me||"@default"===Me),L.isObject(Je)||(Je={})):(Ze="@merged"!==E.graph,Je={}),Ze&&T.frame(Un(ht({},E),{graph:Me,embedded:!1}),Object.keys(E.graphMap[Me]).sort(),[Je],nt,"@graph")}"@included"in ie&&T.frame(Un(ht({},E),{embedded:!1}),U,ie["@included"],nt,"@included");for(const Ze of Object.keys(Ve).sort())if(q(Ze)){if(nt[Ze]=re.clone(Ve[Ze]),"@type"===Ze)for(const Je of Ve["@type"])0===Je.indexOf("_:")&&re.addValue(E.bnodeMap,Je,nt,{propertyIsArray:!0})}else if(!Te.explicit||Ze in ie)for(const Je of Ve[Ze]){const Ye=Ze in ie?ie[Ze]:v(Te);if(V.isList(Je)){const je=ie[Ze]&&ie[Ze][0]&&ie[Ze][0]["@list"]?ie[Ze][0]["@list"]:v(Te),Le={"@list":[]};M(nt,Ze,Le);const Ee=Je["@list"];for(const Re of Ee)V.isSubjectReference(Re)?T.frame(Un(ht({},E),{embedded:!0}),[Re["@id"]],je,Le,"@list"):M(Le,"@list",re.clone(Re))}else V.isSubjectReference(Je)?T.frame(Un(ht({},E),{embedded:!0}),[Je["@id"]],Ye,nt,Ze):Q(Ye[0],Je)&&M(nt,Ze,re.clone(Je))}for(const Ze of Object.keys(ie).sort()){if("@type"===Ze){if(!L.isObject(ie[Ze][0])||!("@default"in ie[Ze][0]))continue}else if(q(Ze))continue;const Je=ie[Ze][0]||{};if(!w(Je,se,"omitDefault")&&!(Ze in nt)){let je="@null";"@default"in Je&&(je=re.clone(Je["@default"])),L.isArray(je)||(je=[je]),nt[Ze]=[{"@preserve":je}]}}for(const Ze of Object.keys(ie["@reverse"]||{}).sort()){const Je=ie["@reverse"][Ze];for(const Ye of Object.keys(E.subjects))re.getValues(E.subjects[Ye],Ze).some(Le=>Le["@id"]===Me)&&(nt["@reverse"]=nt["@reverse"]||{},re.addValue(nt["@reverse"],Ze,[],{propertyIsArray:!0}),T.frame(Un(ht({},E),{embedded:!0}),[Ye],Je,nt["@reverse"][Ze],ee))}M(ue,ee,nt),E.subjectStack.pop()}}},T.cleanupNull=(E,U)=>{if(L.isArray(E))return E.map(ue=>T.cleanupNull(ue,U)).filter(ue=>ue);if("@null"===E)return null;if(L.isObject(E)){if("@id"in E){const ie=E["@id"];if(U.link.hasOwnProperty(ie)){const ue=U.link[ie].indexOf(E);if(-1!==ue)return U.link[ie][ue];U.link[ie].push(E)}else U.link[ie]=[E]}for(const ie in E)E[ie]=T.cleanupNull(E[ie],U)}return E}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(K,Ae,he){"use strict";const q=K("./JsonLdError"),V=K("./graphTypes"),L=K("./types"),re=K("./util"),{RDF_LIST:$,RDF_FIRST:b,RDF_REST:S,RDF_NIL:O,RDF_TYPE:T,RDF_JSON_LITERAL:v,XSD_BOOLEAN:y,XSD_DOUBLE:w,XSD_INTEGER:D,XSD_STRING:j}=K("./constants"),I=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,H={};function Y(M,F,Q){if(M.termType.endsWith("Node"))return{"@id":M.value};const E={"@value":M.value};if(M.language)E["@language"]=M.language;else{let U=M.datatype.value;if(U||(U=j),U===v){U="@json";try{E["@value"]=JSON.parse(E["@value"])}catch(ie){throw new q("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:E["@value"],cause:ie})}}if(F){if(U===y)"true"===E["@value"]?E["@value"]=!0:"false"===E["@value"]&&(E["@value"]=!1);else if(L.isNumeric(E["@value"]))if(U===D){const ie=parseInt(E["@value"],10);ie.toFixed(0)===E["@value"]&&(E["@value"]=ie)}else U===w&&(E["@value"]=parseFloat(E["@value"]));[y,D,w,j].includes(U)||(E["@type"]=U)}else if("i18n-datatype"===Q&&U.startsWith("https://www.w3.org/ns/i18n#")){const[,ie,ue]=U.split(/[#_]/);ie.length>0&&(E["@language"]=ie,ie.match(I)||console.warn(`@language must be valid BCP47: ${ie}`)),E["@direction"]=ue}else U!==j&&(E["@type"]=U)}return E}Ae.exports=H,H.fromRDF=function(){var M=gt(function*(F,{useRdfType:Q=!1,useNativeTypes:E=!1,rdfDirection:U=null}){const ie={},ue={"@default":ie},ee={};for(const me of F){const te="DefaultGraph"===me.graph.termType?"@default":me.graph.value;te in ue||(ue[te]={}),"@default"!==te&&!(te in ie)&&(ie[te]={"@id":te});const ye=ue[te],Me=me.subject.value,Ve=me.predicate.value,nt=me.object;Me in ye||(ye[Me]={"@id":Me});const Ze=ye[Me],Je=nt.termType.endsWith("Node");if(Je&&!(nt.value in ye)&&(ye[nt.value]={"@id":nt.value}),Ve===T&&!Q&&Je){re.addValue(Ze,"@type",nt.value,{propertyIsArray:!0});continue}const Ye=Y(nt,E,U);if(re.addValue(Ze,Ve,Ye,{propertyIsArray:!0}),Je)if(nt.value===O){const je=ye[nt.value];"usages"in je||(je.usages=[]),je.usages.push({node:Ze,property:Ve,value:Ye})}else ee[nt.value]=!(nt.value in ee)&&{node:Ze,property:Ve,value:Ye}}for(const me in ue){const te=ue[me];if(!(O in te))continue;const ye=te[O];if(ye.usages){for(let Me of ye.usages){let Ve=Me.node,nt=Me.property,Ze=Me.value;const Je=[],Ye=[];let je=Object.keys(Ve).length;for(;nt===S&&L.isObject(ee[Ve["@id"]])&&L.isArray(Ve[b])&&1===Ve[b].length&&L.isArray(Ve[S])&&1===Ve[S].length&&(3===je||4===je&&L.isArray(Ve["@type"])&&1===Ve["@type"].length&&Ve["@type"][0]===$)&&(Je.push(Ve[b][0]),Ye.push(Ve["@id"]),Me=ee[Ve["@id"]],Ve=Me.node,nt=Me.property,Ze=Me.value,je=Object.keys(Ve).length,V.isBlankNode(Ve)););delete Ze["@id"],Ze["@list"]=Je.reverse();for(const Le of Ye)delete te[Le]}delete ye.usages}}const se=[],Te=Object.keys(ie).sort();for(const me of Te){const te=ie[me];if(me in ue){const ye=te["@graph"]=[],Me=ue[me],Ve=Object.keys(Me).sort();for(const nt of Ve){const Ze=Me[nt];V.isSubjectReference(Ze)||ye.push(Ze)}}V.isSubjectReference(te)||se.push(te)}return se});return function(F,Q){return M.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(K,Ae,he){"use strict";const q=K("./types"),V={};Ae.exports=V,V.isSubject=L=>!(!q.isObject(L)||"@value"in L||"@set"in L||"@list"in L)&&(Object.keys(L).length>1||!("@id"in L)),V.isSubjectReference=L=>q.isObject(L)&&1===Object.keys(L).length&&"@id"in L,V.isValue=L=>q.isObject(L)&&"@value"in L,V.isList=L=>q.isObject(L)&&"@list"in L,V.isGraph=L=>q.isObject(L)&&"@graph"in L&&1===Object.keys(L).filter(re=>"@id"!==re&&"@index"!==re).length,V.isSimpleGraph=L=>V.isGraph(L)&&!("@id"in L),V.isBlankNode=L=>!!q.isObject(L)&&("@id"in L?0===L["@id"].indexOf("_:"):0===Object.keys(L).length||!("@value"in L||"@set"in L||"@list"in L))},{"./types":30}],26:[function(K,Ae,he){const q=K("rdf-canonize"),V=K("./platform"),L=K("./util"),re=K("./ContextResolver"),$=L.IdentifierIssuer,b=K("./JsonLdError"),S=K("lru-cache"),O=K("./NQuads"),{expand:T}=K("./expand"),{flatten:v}=K("./flatten"),{fromRDF:y}=K("./fromRdf"),{toRDF:w}=K("./toRdf"),{frameMergedOrDefault:D,cleanupNull:j}=K("./frame"),{isArray:I,isObject:H,isString:Y}=K("./types"),{isSubjectReference:M}=K("./graphTypes"),{expandIri:F,getInitialContext:Q,process:E,processingMode:U}=K("./context"),{compact:ie,compactIri:ue}=K("./compact"),{createNodeMap:ee,createMergedNodeMap:se,mergeNodeMaps:Te}=K("./nodeMap"),me=function(ye){const Me={},nt=new S({max:100});function Ze(Je,Le){var Ee=Le,{documentLoader:Ye=ye.documentLoader}=Ee,je=L7(Ee,["documentLoader"]);return Object.assign({},{documentLoader:Ye},je,Je)}return ye.compact=function(){var Je=gt(function*(Ye,je,Le){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===je)throw new b("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Ye)return null;let Ee;(Le=Ze(Le,{base:Y(Ye)?Ye:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new $("_:b"),contextResolver:new re({sharedCache:nt})})).link&&(Le.skipExpansion=!0),Le.compactToRelative||delete Le.base,Ee=Le.skipExpansion?Ye:yield ye.expand(Ye,Le);const Re=yield ye.processContext(Q(Le),je,Le);let Ue=yield ie({activeCtx:Re,element:Ee,options:Le,compactionMap:Le.compactionMap});Le.compactArrays&&!Le.graph&&I(Ue)?1===Ue.length?Ue=Ue[0]:0===Ue.length&&(Ue={}):Le.graph&&H(Ue)&&(Ue=[Ue]),H(je)&&"@context"in je&&(je=je["@context"]),je=L.clone(je),I(je)||(je=[je]);const qe=je;je=[];for(let z=0;z<qe.length;++z)(!H(qe[z])||Object.keys(qe[z]).length>0)&&je.push(qe[z]);const Be=je.length>0;if(1===je.length&&(je=je[0]),I(Ue)){const z=ue({activeCtx:Re,iri:"@graph",relativeTo:{vocab:!0}}),X=Ue;Ue={},Be&&(Ue["@context"]=je),Ue[z]=X}else if(H(Ue)&&Be){const z=Ue;Ue={"@context":je};for(const X in z)Ue[X]=z[X]}return Ue});return function(Ye,je,Le){return Je.apply(this,arguments)}}(),ye.expand=function(){var Je=gt(function*(Ye,je){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(je=Ze(je,{keepFreeFloatingNodes:!1,contextResolver:new re({sharedCache:nt})})).expansionMap&&(je.expansionMap=void 0);const Le={},Ee=[];if("expandContext"in je){const Be=L.clone(je.expandContext);Le.expandContext=H(Be)&&"@context"in Be?Be:{"@context":Be},Ee.push(Le.expandContext)}let Re;if(Y(Ye)){const Be=yield ye.get(Ye,je);Re=Be.documentUrl,Le.input=Be.document,Be.contextUrl&&(Le.remoteContext={"@context":Be.contextUrl},Ee.push(Le.remoteContext))}else Le.input=L.clone(Ye);"base"in je||(je.base=Re||"");let Ue=Q(je);for(const Be of Ee)Ue=yield E({activeCtx:Ue,localCtx:Be,options:je});let qe=yield T({activeCtx:Ue,element:Le.input,options:je,expansionMap:je.expansionMap});return H(qe)&&"@graph"in qe&&1===Object.keys(qe).length?qe=qe["@graph"]:null===qe&&(qe=[]),I(qe)||(qe=[qe]),qe});return function(Ye,je){return Je.apply(this,arguments)}}(),ye.flatten=function(){var Je=gt(function*(Ye,je,Le){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");je="function"==typeof je?null:je||null,Le=Ze(Le,{base:Y(Ye)?Ye:"",contextResolver:new re({sharedCache:nt})});const Ee=yield ye.expand(Ye,Le),Re=v(Ee);return null===je?Re:(Le.graph=!0,Le.skipExpansion=!0,yield ye.compact(Re,je,Le))});return function(Ye,je,Le){return Je.apply(this,arguments)}}(),ye.frame=function(){var Je=gt(function*(Ye,je,Le){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(Le=Ze(Le,{base:Y(Ye)?Ye:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new re({sharedCache:nt})}),Y(je)){const ce=yield ye.get(je,Le);if(je=ce.document,ce.contextUrl){let Pe=je["@context"];Pe?I(Pe)?Pe.push(ce.contextUrl):Pe=[Pe,ce.contextUrl]:Pe=ce.contextUrl,je["@context"]=Pe}}const Ee=je&&je["@context"]||{},Re=yield ye.processContext(Q(Le),Ee,Le);Le.hasOwnProperty("omitGraph")||(Le.omitGraph=U(Re,1.1)),Le.hasOwnProperty("pruneBlankNodeIdentifiers")||(Le.pruneBlankNodeIdentifiers=U(Re,1.1));const Ue=yield ye.expand(Ye,Le),qe=ht({},Le);qe.isFrame=!0,qe.keepFreeFloatingNodes=!0;const Be=yield ye.expand(je,qe),z=Object.keys(je).map(ce=>F(Re,ce,{vocab:!0}));qe.merged=!z.includes("@graph"),qe.is11=U(Re,1.1);const X=D(Ue,Be,qe);qe.graph=!Le.omitGraph,qe.skipExpansion=!0,qe.link={},qe.framing=!0;let be=yield ye.compact(X,Ee,qe);return qe.link={},be=j(be,qe),be});return function(Ye,je,Le){return Je.apply(this,arguments)}}(),ye.link=function(){var Je=gt(function*(Ye,je,Le){const Ee={};return je&&(Ee["@context"]=je),Ee["@embed"]="@link",ye.frame(Ye,Ee,Le)});return function(Ye,je,Le){return Je.apply(this,arguments)}}(),ye.normalize=ye.canonize=function(){var Je=gt(function*(Ye,je){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(je=Ze(je,{base:Y(Ye)?Ye:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new re({sharedCache:nt})}))){if("application/n-quads"!==je.inputFormat&&"application/nquads"!==je.inputFormat)throw new b("Unknown canonicalization input format.","jsonld.CanonizeError");const Re=O.parse(Ye);return q.canonize(Re,je)}const Le=ht({},je);delete Le.format,Le.produceGeneralizedRdf=!1;const Ee=yield ye.toRDF(Ye,Le);return q.canonize(Ee,je)});return function(Ye,je){return Je.apply(this,arguments)}}(),ye.fromRDF=function(){var Je=gt(function*(Ye,je){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");je=Ze(je,{format:Y(Ye)?"application/n-quads":void 0});const{format:Le}=je;let{rdfParser:Ee}=je;if(Le){if(Ee=Ee||Me[Le],!Ee)throw new b("Unknown input format.","jsonld.UnknownFormat",{format:Le})}else Ee=()=>Ye;const Re=yield Ee(Ye);return y(Re,je)});return function(Ye,je){return Je.apply(this,arguments)}}(),ye.toRDF=function(){var Je=gt(function*(Ye,je){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let Le;Le=(je=Ze(je,{base:Y(Ye)?Ye:"",skipExpansion:!1,contextResolver:new re({sharedCache:nt})})).skipExpansion?Ye:yield ye.expand(Ye,je);const Ee=w(Le,je);if(je.format){if("application/n-quads"===je.format||"application/nquads"===je.format)return O.serialize(Ee);throw new b("Unknown output format.","jsonld.UnknownFormat",{format:je.format})}return Ee});return function(Ye,je){return Je.apply(this,arguments)}}(),ye.createNodeMap=function(){var Je=gt(function*(Ye,je){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");je=Ze(je,{base:Y(Ye)?Ye:"",contextResolver:new re({sharedCache:nt})});const Le=yield ye.expand(Ye,je);return se(Le,je)});return function(Ye,je){return Je.apply(this,arguments)}}(),ye.merge=function(){var Je=gt(function*(Ye,je,Le){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!I(Ye))throw new TypeError('Could not merge, "docs" must be an array.');je="function"==typeof je?null:je||null,Le=Ze(Le,{contextResolver:new re({sharedCache:nt})});const Ee=yield Promise.all(Ye.map(ce=>{const Pe=ht({},Le);return ye.expand(ce,Pe)}));let Re=!0;"mergeNodes"in Le&&(Re=Le.mergeNodes);const Ue=Le.issuer||new $("_:b"),qe={"@default":{}};for(let ce=0;ce<Ee.length;++ce){const Pe=L.relabelBlankNodes(Ee[ce],{issuer:new $("_:b"+ce+"-")}),wt=Re||0===ce?qe:{"@default":{}};if(ee(Pe,wt,"@default",Ue),wt!==qe)for(const pt in wt){const fe=wt[pt];if(!(pt in qe)){qe[pt]=fe;continue}const B=qe[pt];for(const R in fe)R in B||(B[R]=fe[R])}}const Be=Te(qe),z=[],X=Object.keys(Be).sort();for(let ce=0;ce<X.length;++ce){const Pe=Be[X[ce]];M(Pe)||z.push(Pe)}return null===je?z:(Le.graph=!0,Le.skipExpansion=!0,yield ye.compact(z,je,Le))});return function(Ye,je,Le){return Je.apply(this,arguments)}}(),Object.defineProperty(ye,"documentLoader",{get:()=>ye._documentLoader,set:Je=>ye._documentLoader=Je}),ye.documentLoader=function(){var Je=gt(function*(Ye){throw new b("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Ye})});return function(Ye){return Je.apply(this,arguments)}}(),ye.get=function(){var Je=gt(function*(Ye,je){let Le;Le="function"==typeof je.documentLoader?je.documentLoader:ye.documentLoader;const Ee=yield Le(Ye);try{if(!Ee.document)throw new b("No remote document found at the given URL.","jsonld.NullRemoteDocument");Y(Ee.document)&&(Ee.document=JSON.parse(Ee.document))}catch(Re){throw new b("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:Re,remoteDoc:Ee})}return Ee});return function(Ye,je){return Je.apply(this,arguments)}}(),ye.processContext=function(){var Je=gt(function*(Ye,je,Le){return Le=Ze(Le,{base:"",contextResolver:new re({sharedCache:nt})}),null===je?Q(Le):(je=L.clone(je),H(je)&&"@context"in je||(je={"@context":je}),E({activeCtx:Ye,localCtx:je,options:Le}))});return function(Ye,je,Le){return Je.apply(this,arguments)}}(),ye.getContextValue=K("./context").getContextValue,ye.documentLoaders={},ye.useDocumentLoader=function(Je){if(!(Je in ye.documentLoaders))throw new b('Unknown document loader type: "'+Je+'"',"jsonld.UnknownDocumentLoader",{type:Je});ye.documentLoader=ye.documentLoaders[Je].apply(ye,Array.prototype.slice.call(arguments,1))},ye.registerRDFParser=function(Je,Ye){Me[Je]=Ye},ye.unregisterRDFParser=function(Je){delete Me[Je]},ye.registerRDFParser("application/n-quads",O.parse),ye.registerRDFParser("application/nquads",O.parse),ye.url=K("./url"),ye.util=L,Object.assign(ye,L),ye.promises=ye,ye.RequestQueue=K("./RequestQueue"),ye.JsonLdProcessor=K("./JsonLdProcessor")(ye),V.setupGlobals(ye),V.setupDocumentLoaders(ye),ye},te=function(){return me(function(){return te()})};me(te),Ae.exports=te},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(K,Ae,he){"use strict";const{isKeyword:q}=K("./context"),V=K("./graphTypes"),L=K("./types"),re=K("./util"),$=K("./JsonLdError"),b={};Ae.exports=b,b.createMergedNodeMap=(S,O)=>{const T=(O=O||{}).issuer||new re.IdentifierIssuer("_:b"),v={"@default":{}};return b.createNodeMap(S,v,"@default",T),b.mergeNodeMaps(v)},b.createNodeMap=(S,O,T,v,y,w)=>{if(L.isArray(S)){for(const H of S)b.createNodeMap(H,O,T,v,void 0,w);return}if(!L.isObject(S))return void(w&&w.push(S));if(V.isValue(S)){if("@type"in S){let H=S["@type"];0===H.indexOf("_:")&&(S["@type"]=H=v.getId(H))}return void(w&&w.push(S))}if(w&&V.isList(S)){const H=[];return b.createNodeMap(S["@list"],O,T,v,y,H),void w.push({"@list":H})}if("@type"in S){const H=S["@type"];for(const Y of H)0===Y.indexOf("_:")&&v.getId(Y)}L.isUndefined(y)&&(y=V.isBlankNode(S)?v.getId(S["@id"]):S["@id"]),w&&w.push({"@id":y});const D=O[T],j=D[y]=D[y]||{};j["@id"]=y;const I=Object.keys(S).sort();for(let H of I){if("@id"===H)continue;if("@reverse"===H){const M={"@id":y},F=S["@reverse"];for(const Q in F){const E=F[Q];for(const U of E){let ie=U["@id"];V.isBlankNode(U)&&(ie=v.getId(ie)),b.createNodeMap(U,O,T,v,ie),re.addValue(D[ie],Q,M,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===H){y in O||(O[y]={}),b.createNodeMap(S[H],O,y,v);continue}if("@included"===H){b.createNodeMap(S[H],O,T,v);continue}if("@type"!==H&&q(H)){if("@index"===H&&H in j&&(S[H]!==j[H]||S[H]["@id"]!==j[H]["@id"]))throw new $("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:j});j[H]=S[H];continue}const Y=S[H];if(0===H.indexOf("_:")&&(H=v.getId(H)),0!==Y.length)for(let M of Y)if("@type"===H&&(M=0===M.indexOf("_:")?v.getId(M):M),V.isSubject(M)||V.isSubjectReference(M)){if("@id"in M&&!M["@id"])continue;const F=V.isBlankNode(M)?v.getId(M["@id"]):M["@id"];re.addValue(j,H,{"@id":F},{propertyIsArray:!0,allowDuplicate:!1}),b.createNodeMap(M,O,T,v,F)}else if(V.isValue(M))re.addValue(j,H,M,{propertyIsArray:!0,allowDuplicate:!1});else if(V.isList(M)){const F=[];b.createNodeMap(M["@list"],O,T,v,y,F),M={"@list":F},re.addValue(j,H,M,{propertyIsArray:!0,allowDuplicate:!1})}else b.createNodeMap(M,O,T,v,y),re.addValue(j,H,M,{propertyIsArray:!0,allowDuplicate:!1});else re.addValue(j,H,[],{propertyIsArray:!0})}},b.mergeNodeMapGraphs=S=>{const O={};for(const T of Object.keys(S).sort())for(const v of Object.keys(S[T]).sort()){const y=S[T][v];v in O||(O[v]={"@id":v});const w=O[v];for(const D of Object.keys(y).sort())if(q(D)&&"@type"!==D)w[D]=re.clone(y[D]);else for(const j of y[D])re.addValue(w,D,re.clone(j),{propertyIsArray:!0,allowDuplicate:!1})}return O},b.mergeNodeMaps=S=>{const O=S["@default"],T=Object.keys(S).sort();for(const v of T){if("@default"===v)continue;const y=S[v];let w=O[v];w?"@graph"in w||(w["@graph"]=[]):O[v]=w={"@id":v,"@graph":[]};const D=w["@graph"];for(const j of Object.keys(y).sort()){const I=y[j];V.isSubjectReference(I)||D.push(I)}}return O}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(K,Ae,he){"use strict";const q=K("./documentLoaders/xhr"),V={};Ae.exports=V,V.setupDocumentLoaders=function(L){"undefined"!=typeof XMLHttpRequest&&(L.documentLoaders.xhr=q,L.useDocumentLoader("xhr"))},V.setupGlobals=function(L){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:L.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(K,Ae,he){"use strict";const{createNodeMap:q}=K("./nodeMap"),{isKeyword:V}=K("./context"),L=K("./graphTypes"),re=K("canonicalize"),$=K("./types"),b=K("./util"),{RDF_FIRST:S,RDF_REST:O,RDF_NIL:T,RDF_TYPE:v,RDF_JSON_LITERAL:y,RDF_LANGSTRING:w,XSD_BOOLEAN:D,XSD_DOUBLE:j,XSD_INTEGER:I,XSD_STRING:H}=K("./constants"),{isAbsolute:Y}=K("./url"),M={};function F(U,ie,ue,ee,se){const Te=Object.keys(ie).sort();for(const me of Te){const te=ie[me],ye=Object.keys(te).sort();for(let Me of ye){const Ve=te[Me];if("@type"===Me)Me=v;else if(V(Me))continue;for(const nt of Ve){const Ze={termType:me.startsWith("_:")?"BlankNode":"NamedNode",value:me};if(!Y(me))continue;const Je={termType:Me.startsWith("_:")?"BlankNode":"NamedNode",value:Me};if(!Y(Me)||"BlankNode"===Je.termType&&!se.produceGeneralizedRdf)continue;const Ye=E(nt,ee,U,ue,se.rdfDirection);Ye&&U.push({subject:Ze,predicate:Je,object:Ye,graph:ue})}}}}function E(U,ie,ue,ee,se){const Te={};if(L.isValue(U)){Te.termType="Literal",Te.value=void 0,Te.datatype={termType:"NamedNode"};let me=U["@value"];const te=U["@type"]||null;"@json"===te?(Te.value=re(me),Te.datatype.value=y):$.isBoolean(me)?(Te.value=me.toString(),Te.datatype.value=te||D):$.isDouble(me)||te===j?($.isDouble(me)||(me=parseFloat(me)),Te.value=me.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Te.datatype.value=te||j):$.isNumber(me)?(Te.value=me.toFixed(0),Te.datatype.value=te||I):"i18n-datatype"===se&&"@direction"in U?(Te.datatype.value="https://www.w3.org/ns/i18n#"+(U["@language"]||"")+`_${U["@direction"]}`,Te.value=me):"@language"in U?(Te.value=me,Te.datatype.value=te||w,Te.language=U["@language"]):(Te.value=me,Te.datatype.value=te||H)}else if(L.isList(U)){const me=function(U,ie,ue,ee,se){const Te={termType:"NamedNode",value:S},me={termType:"NamedNode",value:O},te={termType:"NamedNode",value:T},ye=U.pop(),Me=ye?{termType:"BlankNode",value:ie.getId()}:te;let Ve=Me;for(const nt of U){const Ze=E(nt,ie,ue,ee,se),Je={termType:"BlankNode",value:ie.getId()};ue.push({subject:Ve,predicate:Te,object:Ze,graph:ee}),ue.push({subject:Ve,predicate:me,object:Je,graph:ee}),Ve=Je}if(ye){const nt=E(ye,ie,ue,ee,se);ue.push({subject:Ve,predicate:Te,object:nt,graph:ee}),ue.push({subject:Ve,predicate:me,object:te,graph:ee})}return Me}(U["@list"],ie,ue,ee,se);Te.termType=me.termType,Te.value=me.value}else{const me=$.isObject(U)?U["@id"]:U;Te.termType=me.startsWith("_:")?"BlankNode":"NamedNode",Te.value=me}return"NamedNode"!==Te.termType||Y(Te.value)?Te:null}Ae.exports=M,M.toRDF=(U,ie)=>{const ue=new b.IdentifierIssuer("_:b"),ee={"@default":{}};q(U,ee,"@default",ue);const se=[],Te=Object.keys(ee).sort();for(const me of Te){let te;if("@default"===me)te={termType:"DefaultGraph",value:""};else{if(!Y(me))continue;te=me.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},te.value=me}F(se,ee[me],te,ue,ie)}return se}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(K,Ae,he){"use strict";const q={};Ae.exports=q,q.isArray=Array.isArray,q.isBoolean=V=>"boolean"==typeof V||"[object Boolean]"===Object.prototype.toString.call(V),q.isDouble=V=>q.isNumber(V)&&(-1!==String(V).indexOf(".")||Math.abs(V)>=1e21),q.isEmptyObject=V=>q.isObject(V)&&0===Object.keys(V).length,q.isNumber=V=>"number"==typeof V||"[object Number]"===Object.prototype.toString.call(V),q.isNumeric=V=>!isNaN(parseFloat(V))&&isFinite(V),q.isObject=V=>"[object Object]"===Object.prototype.toString.call(V),q.isString=V=>"string"==typeof V||"[object String]"===Object.prototype.toString.call(V),q.isUndefined=V=>void 0===V},{}],31:[function(K,Ae,he){"use strict";const q=K("./types"),V={};Ae.exports=V,V.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},V.parse=(re,$)=>{const b={},S=V.parsers[$||"full"],O=S.regex.exec(re);let T=S.keys.length;for(;T--;)b[S.keys[T]]=void 0===O[T]?null:O[T];return("https"===b.scheme&&"443"===b.port||"http"===b.scheme&&"80"===b.port)&&(b.href=b.href.replace(":"+b.port,""),b.authority=b.authority.replace(":"+b.port,""),b.port=null),b.normalizedPath=V.removeDotSegments(b.path),b},V.prependBase=(re,$)=>{if(null===re||V.isAbsolute($))return $;(!re||q.isString(re))&&(re=V.parse(re||""));const b=V.parse($),S={protocol:re.protocol||""};if(null!==b.authority)S.authority=b.authority,S.path=b.path,S.query=b.query;else if(S.authority=re.authority,""===b.path)S.path=re.path,S.query=null!==b.query?b.query:re.query;else{if(0===b.path.indexOf("/"))S.path=b.path;else{let T=re.path;T=T.substr(0,T.lastIndexOf("/")+1),(T.length>0||re.authority)&&"/"!==T.substr(-1)&&(T+="/"),T+=b.path,S.path=T}S.query=b.query}""!==b.path&&(S.path=V.removeDotSegments(S.path));let O=S.protocol;return null!==S.authority&&(O+="//"+S.authority),O+=S.path,null!==S.query&&(O+="?"+S.query),null!==b.fragment&&(O+="#"+b.fragment),""===O&&(O="./"),O},V.removeBase=(re,$)=>{if(null===re)return $;(!re||q.isString(re))&&(re=V.parse(re||""));let b="";if(""!==re.href?b+=(re.protocol||"")+"//"+(re.authority||""):$.indexOf("//")&&(b+="//"),0!==$.indexOf(b))return $;const S=V.parse($.substr(b.length)),O=re.normalizedPath.split("/"),T=S.normalizedPath.split("/"),v=S.fragment||S.query?0:1;for(;O.length>0&&T.length>v&&O[0]===T[0];)O.shift(),T.shift();let y="";if(O.length>0){O.pop();for(let w=0;w<O.length;++w)y+="../"}return y+=T.join("/"),null!==S.query&&(y+="?"+S.query),null!==S.fragment&&(y+="#"+S.fragment),""===y&&(y="./"),y},V.removeDotSegments=re=>{if(0===re.length)return"";const $=re.split("/"),b=[];for(;$.length>0;){const S=$.shift(),O=0===$.length;"."!==S?".."!==S?b.push(S):(b.pop(),O&&b.push("")):O&&b.push("")}return"/"===re[0]&&b.length>0&&""!==b[0]&&b.unshift(""),1===b.length&&""===b[0]?"/":b.join("/")};const L=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;V.isAbsolute=re=>q.isString(re)&&L.test(re),V.isRelative=re=>q.isString(re)},{"./types":30}],32:[function(K,Ae,he){"use strict";const q=K("./graphTypes"),V=K("./types"),L=K("rdf-canonize").IdentifierIssuer,re=K("./JsonLdError"),$=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,b=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,S=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,O_headers={accept:"application/ld+json, application/json"},T={};function v(y,w){if(V.isArray(w))for(let D=0;D<w.length;++D)w[D]=v(y,w[D]);else if(q.isList(w))w["@list"]=v(y,w["@list"]);else if(V.isObject(w)){q.isBlankNode(w)&&(w["@id"]=y.getId(w["@id"]));const D=Object.keys(w).sort();for(let j=0;j<D.length;++j){const I=D[j];"@id"!==I&&(w[I]=v(y,w[I]))}}return w}Ae.exports=T,T.IdentifierIssuer=L,T.clone=function(y){if(y&&"object"==typeof y){let w;if(V.isArray(y)){w=[];for(let D=0;D<y.length;++D)w[D]=T.clone(y[D])}else if(y instanceof Map){w=new Map;for(const[D,j]of y)w.set(D,T.clone(j))}else if(y instanceof Set){w=new Set;for(const D of y)w.add(T.clone(D))}else if(V.isObject(y)){w={};for(const D in y)w[D]=T.clone(y[D])}else w=y.toString();return w}return y},T.asArray=function(y){return Array.isArray(y)?y:[y]},T.buildHeaders=(y={})=>{if(Object.keys(y).some(D=>"accept"===D.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+O_headers.accept+'" is supported.');return Object.assign({Accept:O_headers.accept},y)},T.parseLinkHeader=y=>{const w={},D=y.match($);for(let j=0;j<D.length;++j){let I=D[j].match(b);if(!I)continue;const H={target:I[1]},Y=I[2];for(;I=S.exec(Y);)H[I[1]]=void 0===I[2]?I[3]:I[2];const M=H.rel||"";Array.isArray(w[M])?w[M].push(H):w[M]=w.hasOwnProperty(M)?[w[M],H]:H}return w},T.validateTypeValue=(y,w)=>{if(!(V.isString(y)||V.isArray(y)&&y.every(D=>V.isString(D)))){if(w&&V.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&T.asArray(y["@default"]).every(D=>V.isString(D)))return}throw new re('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},T.hasProperty=(y,w)=>{if(y.hasOwnProperty(w)){const D=y[w];return!V.isArray(D)||D.length>0}return!1},T.hasValue=(y,w,D)=>{if(T.hasProperty(y,w)){let j=y[w];const I=q.isList(j);if(V.isArray(j)||I){I&&(j=j["@list"]);for(let H=0;H<j.length;++H)if(T.compareValues(D,j[H]))return!0}else if(!V.isArray(D))return T.compareValues(D,j)}return!1},T.addValue=(y,w,D,j)=>{if("propertyIsArray"in(j=j||{})||(j.propertyIsArray=!1),"valueIsArray"in j||(j.valueIsArray=!1),"allowDuplicate"in j||(j.allowDuplicate=!0),"prependValue"in j||(j.prependValue=!1),j.valueIsArray)y[w]=D;else if(V.isArray(D)){0===D.length&&j.propertyIsArray&&!y.hasOwnProperty(w)&&(y[w]=[]),j.prependValue&&(D=D.concat(y[w]),y[w]=[]);for(let I=0;I<D.length;++I)T.addValue(y,w,D[I],j)}else if(y.hasOwnProperty(w)){const I=!j.allowDuplicate&&T.hasValue(y,w,D);!V.isArray(y[w])&&(!I||j.propertyIsArray)&&(y[w]=[y[w]]),I||(j.prependValue?y[w].unshift(D):y[w].push(D))}else y[w]=j.propertyIsArray?[D]:D},T.getValues=(y,w)=>[].concat(y[w]||[]),T.removeProperty=(y,w)=>{delete y[w]},T.removeValue=(y,w,D,j)=>{"propertyIsArray"in(j=j||{})||(j.propertyIsArray=!1);const I=T.getValues(y,w).filter(H=>!T.compareValues(H,D));0===I.length?T.removeProperty(y,w):y[w]=1!==I.length||j.propertyIsArray?I:I[0]},T.relabelBlankNodes=(y,w)=>v((w=w||{}).issuer||new L("_:b"),y),T.compareValues=(y,w)=>!!(y===w||q.isValue(y)&&q.isValue(w)&&y["@value"]===w["@value"]&&y["@type"]===w["@type"]&&y["@language"]===w["@language"]&&y["@index"]===w["@index"])||!!(V.isObject(y)&&"@id"in y&&V.isObject(w)&&"@id"in w)&&y["@id"]===w["@id"],T.compareShortestLeast=(y,w)=>y.length<w.length?-1:w.length<y.length?1:y===w?0:y<w?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(K,Ae,he){"use strict";const q=K("yallist"),V=Symbol("max"),L=Symbol("length"),re=Symbol("lengthCalculator"),$=Symbol("allowStale"),b=Symbol("maxAge"),S=Symbol("dispose"),O=Symbol("noDisposeOnSet"),T=Symbol("lruList"),v=Symbol("cache"),y=Symbol("updateAgeOnGet"),w=()=>1;const j=(Q,E,U)=>{const ie=Q[v].get(E);if(ie){const ue=ie.value;if(I(Q,ue)){if(Y(Q,ie),!Q[$])return}else U&&(Q[y]&&(ie.value.now=Date.now()),Q[T].unshiftNode(ie));return ue.value}},I=(Q,E)=>{if(!E||!E.maxAge&&!Q[b])return!1;const U=Date.now()-E.now;return E.maxAge?U>E.maxAge:Q[b]&&U>Q[b]},H=Q=>{if(Q[L]>Q[V])for(let E=Q[T].tail;Q[L]>Q[V]&&null!==E;){const U=E.prev;Y(Q,E),E=U}},Y=(Q,E)=>{if(E){const U=E.value;Q[S]&&Q[S](U.key,U.value),Q[L]-=U.length,Q[v].delete(U.key),Q[T].removeNode(E)}};class M{constructor(E,U,ie,ue,ee){this.key=E,this.value=U,this.length=ie,this.now=ue,this.maxAge=ee||0}}const F=(Q,E,U,ie)=>{let ue=U.value;I(Q,ue)&&(Y(Q,U),Q[$]||(ue=void 0)),ue&&E.call(ie,ue.value,ue.key,Q)};Ae.exports=class{constructor(E){if("number"==typeof E&&(E={max:E}),E||(E={}),E.max&&("number"!=typeof E.max||E.max<0))throw new TypeError("max must be a non-negative number");this[V]=E.max||1/0;const ie=E.length||w;if(this[re]="function"!=typeof ie?w:ie,this[$]=E.stale||!1,E.maxAge&&"number"!=typeof E.maxAge)throw new TypeError("maxAge must be a number");this[b]=E.maxAge||0,this[S]=E.dispose,this[O]=E.noDisposeOnSet||!1,this[y]=E.updateAgeOnGet||!1,this.reset()}set max(E){if("number"!=typeof E||E<0)throw new TypeError("max must be a non-negative number");this[V]=E||1/0,H(this)}get max(){return this[V]}set allowStale(E){this[$]=!!E}get allowStale(){return this[$]}set maxAge(E){if("number"!=typeof E)throw new TypeError("maxAge must be a non-negative number");this[b]=E,H(this)}get maxAge(){return this[b]}set lengthCalculator(E){"function"!=typeof E&&(E=w),E!==this[re]&&(this[re]=E,this[L]=0,this[T].forEach(U=>{U.length=this[re](U.value,U.key),this[L]+=U.length})),H(this)}get lengthCalculator(){return this[re]}get length(){return this[L]}get itemCount(){return this[T].length}rforEach(E,U){U=U||this;for(let ie=this[T].tail;null!==ie;){const ue=ie.prev;F(this,E,ie,U),ie=ue}}forEach(E,U){U=U||this;for(let ie=this[T].head;null!==ie;){const ue=ie.next;F(this,E,ie,U),ie=ue}}keys(){return this[T].toArray().map(E=>E.key)}values(){return this[T].toArray().map(E=>E.value)}reset(){this[S]&&this[T]&&this[T].length&&this[T].forEach(E=>this[S](E.key,E.value)),this[v]=new Map,this[T]=new q,this[L]=0}dump(){return this[T].map(E=>!I(this,E)&&{k:E.key,v:E.value,e:E.now+(E.maxAge||0)}).toArray().filter(E=>E)}dumpLru(){return this[T]}set(E,U,ie){if((ie=ie||this[b])&&"number"!=typeof ie)throw new TypeError("maxAge must be a number");const ue=ie?Date.now():0,ee=this[re](U,E);if(this[v].has(E)){if(ee>this[V])return Y(this,this[v].get(E)),!1;const me=this[v].get(E).value;return this[S]&&(this[O]||this[S](E,me.value)),me.now=ue,me.maxAge=ie,me.value=U,this[L]+=ee-me.length,me.length=ee,this.get(E),H(this),!0}const se=new M(E,U,ee,ue,ie);return se.length>this[V]?(this[S]&&this[S](E,U),!1):(this[L]+=se.length,this[T].unshift(se),this[v].set(E,this[T].head),H(this),!0)}has(E){if(!this[v].has(E))return!1;const U=this[v].get(E).value;return!I(this,U)}get(E){return j(this,E,!0)}peek(E){return j(this,E,!1)}pop(){const E=this[T].tail;return E?(Y(this,E),E.value):null}del(E){Y(this,this[v].get(E))}load(E){this.reset();const U=Date.now();for(let ie=E.length-1;ie>=0;ie--){const ue=E[ie],ee=ue.e||0;if(0===ee)this.set(ue.k,ue.v);else{const se=ee-U;se>0&&this.set(ue.k,ue.v,se)}}}prune(){this[v].forEach((E,U)=>j(this,U,!1))}}},{yallist:92}],34:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;const q="http://www.w3.org/1999/02/22-rdf-syntax-ns#",V="http://www.w3.org/2001/XMLSchema#",L="http://www.w3.org/2000/10/swap/";he.default={xsd:{decimal:`${V}decimal`,boolean:`${V}boolean`,double:`${V}double`,integer:`${V}integer`,string:`${V}string`},rdf:{type:`${q}type`,nil:`${q}nil`,first:`${q}first`,rest:`${q}rest`,langString:`${q}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${L}reify#forSome`,forAll:`${L}reify#forAll`},log:{implies:`${L}log#implies`}}},{}],35:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.termFromId=function M(te,ye){if(ye=ye||v,!te)return ye.defaultGraph();switch(te[0]){case"?":return ye.variable(te.substr(1));case"_":return ye.blankNode(te.substr(2));case'"':if(ye===v)return new j(te);if('"'===te[te.length-1])return ye.literal(te.substr(1,te.length-2));const Me=te.lastIndexOf('"',te.length-1);return ye.literal(te.substr(1,Me-1),"@"===te[Me+1]?te.substr(Me+2):ye.namedNode(te.substr(Me+3)));case"<":const Ve=T.exec(te);return ye.quad(M(U(Ve[1]),ye),M(U(Ve[2]),ye),M(U(Ve[3]),ye),Ve[4]&&M(U(Ve[4]),ye));default:return ye.namedNode(te)}},he.termToId=function F(te){if("string"==typeof te)return te;if(te instanceof w&&"Quad"!==te.termType)return te.id;if(!te)return b.id;switch(te.termType){case"NamedNode":return te.value;case"BlankNode":return`_:${te.value}`;case"Variable":return`?${te.value}`;case"DefaultGraph":return"";case"Literal":return`"${te.value}"${te.language?`@${te.language}`:te.datatype&&te.datatype.value!==$.string?`^^${te.datatype.value}`:""}`;case"Quad":return`<<${E(F(te.subject))} ${E(F(te.predicate))} ${E(F(te.object))}${(0,V.isDefaultGraph)(te.graph)?"":` ${F(te.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${te.termType}`)}},he.escapeQuotes=E,he.unescapeQuotes=U,he.Triple=he.Quad=he.DefaultGraph=he.Variable=he.BlankNode=he.Literal=he.NamedNode=he.Term=he.default=void 0;var te,q=(te=K("./IRIs"))&&te.__esModule?te:{default:te},V=K("./N3Util");const{rdf:re,xsd:$}=q.default;let b,S=0;const O=/^"(.*".*)(?="[^"]*$)/,T=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,v={namedNode:function(te){return new D(te)},blankNode:function(te){return new I(te||"n3-"+S++)},variable:function(te){return new H(te)},literal:function(te,ye){if("string"==typeof ye)return new j(`"${te}"@${ye.toLowerCase()}`);let Me=ye?ye.value:"";return""===Me&&("boolean"==typeof te?Me=$.boolean:"number"==typeof te&&(Number.isFinite(te)?Me=Number.isInteger(te)?$.integer:$.double:(Me=$.double,Number.isNaN(te)||(te=te>0?"INF":"-INF")))),new j(""===Me||Me===$.string?`"${te}"`:`"${te}"^^${Me}`)},defaultGraph:function(){return b},quad:me,triple:me};he.default=v;class w{constructor(ye){this.id=ye}get value(){return this.id}equals(ye){return ye instanceof w?this.id===ye.id:!!ye&&this.termType===ye.termType&&this.value===ye.value}toJSON(){return{termType:this.termType,value:this.value}}}he.Term=w;class D extends w{get termType(){return"NamedNode"}}he.NamedNode=D;class j extends w{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const ye=this.id;let Me=ye.lastIndexOf('"')+1;return Me<ye.length&&"@"===ye[Me++]?ye.substr(Me).toLowerCase():""}get datatype(){return new D(this.datatypeString)}get datatypeString(){const ye=this.id,Me=ye.lastIndexOf('"')+1,Ve=Me<ye.length?ye[Me]:"";return"^"===Ve?ye.substr(Me+2):"@"!==Ve?$.string:re.langString}equals(ye){return ye instanceof j?this.id===ye.id:!!ye&&!!ye.datatype&&this.termType===ye.termType&&this.value===ye.value&&this.language===ye.language&&this.datatype.value===ye.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}he.Literal=j;class I extends w{constructor(ye){super(`_:${ye}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}he.BlankNode=I;class H extends w{constructor(ye){super(`?${ye}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}he.Variable=H;class Y extends w{constructor(){return super(""),b||this}get termType(){return"DefaultGraph"}equals(ye){return this===ye||!!ye&&this.termType===ye.termType}}he.DefaultGraph=Y,b=new Y;class Q extends w{constructor(ye,Me,Ve,nt){super(""),this._subject=ye,this._predicate=Me,this._object=Ve,this._graph=nt||b}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(ye){return!!ye&&this._subject.equals(ye.subject)&&this._predicate.equals(ye.predicate)&&this._object.equals(ye.object)&&this._graph.equals(ye.graph)}}function E(te){return te.replace(O,(ye,Me)=>`"${Me.replace(/"/g,'""')}`)}function U(te){return te.replace(O,(ye,Me)=>`"${Me.replace(/""/g,'"')}`)}function me(te,ye,Me,Ve){return new Q(te,ye,Me,Ve)}he.Triple=he.Quad=Q},{"./IRIs":34,"./N3Util":41}],36:[function(K,Ae,he){(function(q){(function(){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var V=re(K("./IRIs")),L=re(K("queue-microtask"));function re(w){return w&&w.__esModule?w:{default:w}}const{xsd:$}=V.default,b=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,S={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},O=/[\x00-\x20<>\\"\{\}\|\^\`]/,T={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},v=/$0^/;he.default=class{constructor(D){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(D=D||{}).lineMode){this._n3Mode=!1;for(const j in this)!(j in T)&&this[j]instanceof RegExp&&(this[j]=v)}else this._n3Mode=!1!==D.n3;this._comments=!!D.comments,this._literalClosingPos=0}_tokenizeToEnd(D,j){let I=this._input;const H=this._comments;for(;;){let M,F;for(;M=this._newline.exec(I);)H&&(F=this._comment.exec(M[0]))&&D(null,{line:this._line,type:"comment",value:F[1],prefix:""}),I=I.substr(M[0].length,I.length),this._line++;if(!M&&(M=this._whitespace.exec(I))&&(I=I.substr(M[0].length,I.length)),this._endOfFile.test(I))return j&&(H&&(F=this._comment.exec(I))&&D(null,{line:this._line,type:"comment",value:F[1],prefix:""}),D(I=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=I;const Q=this._line,E=I[0];let U="",ie="",ue="",ee=null,se=0,Te=!1;switch(E){case"^":if(I.length<3)break;if("^"!==I[1]){this._n3Mode&&(se=1,U="^");break}if(this._previousMarker="^^",I=I.substr(2),"<"!==I[0]){Te=!0;break}case"<":if(ee=this._unescapedIri.exec(I))U="IRI",ie=ee[1];else if(ee=this._iri.exec(I)){if(ie=this._unescape(ee[1]),null===ie||O.test(ie))return Y(this);U="IRI"}else I.length>1&&"<"===I[1]?(U="<<",se=2):this._n3Mode&&I.length>1&&"="===I[1]&&(U="inverse",se=2,ie=">");break;case">":I.length>1&&">"===I[1]&&(U=">>",se=2);break;case"_":((ee=this._blank.exec(I))||j&&(ee=this._blank.exec(`${I} `)))&&(U="blank",ue="_",ie=ee[1]);break;case'"':if(ee=this._simpleQuotedString.exec(I))ie=ee[1];else if(({value:ie,matchLength:se}=this._parseLiteral(I)),null===ie)return Y(this);(null!==ee||0!==se)&&(U="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(ee=this._simpleApostropheString.exec(I))ie=ee[1];else if(({value:ie,matchLength:se}=this._parseLiteral(I)),null===ie)return Y(this);(null!==ee||0!==se)&&(U="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(ee=this._variable.exec(I))&&(U="var",ie=ee[0]);break;case"@":"literal"===this._previousMarker&&(ee=this._langcode.exec(I))?(U="langcode",ie=ee[1]):(ee=this._keyword.exec(I))&&(U=ee[0]);break;case".":if(1===I.length?j:I[1]<"0"||I[1]>"9"){U=".",se=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(ee=this._number.exec(I)||j&&(ee=this._number.exec(`${I} `)))&&(U="literal",ie=ee[0],ue="string"==typeof ee[1]?$.double:"string"==typeof ee[2]?$.decimal:$.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(ee=this._sparqlKeyword.exec(I))?U=ee[0].toUpperCase():Te=!0;break;case"f":case"t":(ee=this._boolean.exec(I))?(U="literal",ie=ee[0],ue=$.boolean):Te=!0;break;case"a":(ee=this._shortPredicates.exec(I))?(U="abbreviation",ie="a"):Te=!0;break;case"=":this._n3Mode&&I.length>1&&(U="abbreviation",">"!==I[1]?(se=1,ie="="):(se=2,ie=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(se=1,U=E);break;default:Te=!0}if(Te&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(ee=this._prefix.exec(I))?((ee=this._prefixed.exec(I))||j&&(ee=this._prefixed.exec(`${I} `)))&&(U="prefixed",ue=ee[1]||"",ie=this._unescape(ee[2])):(U="prefix",ie=ee[1]||"")),"^^"===this._previousMarker)switch(U){case"prefixed":U="type";break;case"IRI":U="typeIRI";break;default:U=""}if(!U)return j||!/^'''|^"""/.test(I)&&/\n|\r/.test(I)?Y(this):this._input=I;const me={line:Q,type:U,value:ie,prefix:ue};D(null,me),this.previousToken=me,this._previousMarker=U,I=I.substr(se||ee[0].length,I.length)}function Y(M){D(M._syntaxError(/^\S*/.exec(I)[0]))}}_unescape(D){let j=!1;const I=D.replace(b,(H,Y,M,F)=>{if("string"==typeof Y)return String.fromCharCode(Number.parseInt(Y,16));if("string"==typeof M){let Q=Number.parseInt(M,16);return Q<=65535?String.fromCharCode(Number.parseInt(M,16)):String.fromCharCode(55296+((Q-=65536)>>10),56320+(1023&Q))}return F in S?S[F]:(j=!0,"")});return j?null:I}_parseLiteral(D){if(D.length>=3){const j=D.match(/^(?:"""|"|'''|'|)/)[0],I=j.length;let H=Math.max(this._literalClosingPos,I);for(;(H=D.indexOf(j,H))>0;){let Y=0;for(;"\\"===D[H-Y-1];)Y++;if(Y%2==0){const M=D.substring(I,H),F=M.split(/\r\n|\r|\n/).length-1,Q=H+I;if(1===I&&0!==F||3===I&&this._lineMode)break;return this._line+=F,{value:this._unescape(M),matchLength:Q}}H++}this._literalClosingPos=D.length-I+1}return{value:"",matchLength:0}}_syntaxError(D){this._input=null;const j=new Error(`Unexpected "${D}" on line ${this._line}.`);return j.context={token:void 0,line:this._line,previousToken:this.previousToken},j}_readStartingBom(D){return D.startsWith("\ufeff")?D.substr(1):D}tokenize(D,j){if(this._line=1,"string"==typeof D){if(this._input=this._readStartingBom(D),"function"!=typeof j){const I=[];let H;if(this._tokenizeToEnd((Y,M)=>Y?H=Y:I.push(M),!0),H)throw H;return I}(0,L.default)(()=>this._tokenizeToEnd(j,!0))}else this._pendingBuffer=null,"function"==typeof D.setEncoding&&D.setEncoding("utf8"),D.on("data",I=>{null!==this._input&&0!==I.length&&(this._pendingBuffer&&(I=q.concat([this._pendingBuffer,I]),this._pendingBuffer=null),128&I[I.length-1]?this._pendingBuffer=I:(void 0===this._input?this._input=this._readStartingBom("string"==typeof I?I:I.toString()):this._input+=I,this._tokenizeToEnd(j,!1)))}),D.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(j,!0)}),D.on("error",j)}}}).call(this)}).call(this,K("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var q=re(K("./N3Lexer")),V=re(K("./N3DataFactory")),L=re(K("./IRIs"));function re(T){return T&&T.__esModule?T:{default:T}}let $=0;class b{constructor(v){this._contextStack=[],this._graph=null,this._setBase((v=v||{}).baseIRI),v.factory&&O(this,v.factory);const y="string"==typeof v.format?v.format.match(/\w*$/)[0].toLowerCase():"",w=/turtle/.test(y),D=/trig/.test(y),j=/triple/.test(y),I=/quad/.test(y),H=this._n3Mode=/n3/.test(y),Y=j||I;(this._supportsNamedGraphs=!(w||H))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(w||D||j||H),this._supportsRDFStar=""===y||/star|\*$/.test(y),Y&&(this._resolveRelativeIRI=M=>null),this._blankNodePrefix="string"!=typeof v.blankNodePrefix?"":v.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=v.lexer||new q.default({lineMode:Y,n3:H}),this._explicitQuantifiers=!!v.explicitQuantifiers}static _resetBlankNodePrefix(){$=0}_setBase(v){if(v){const y=v.indexOf("#");y>=0&&(v=v.substr(0,y)),this._base=v,this._basePath=v.indexOf("/")<0?v:v.replace(/[^\/?]*(?:\?.*)?$/,""),v=v.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=v[0],this._baseScheme=v[1]}else this._base="",this._basePath=""}_saveContext(v,y,w,D,j){const I=this._n3Mode;this._contextStack.push({subject:w,predicate:D,object:j,graph:y,type:v,inverse:!!I&&this._inversePredicate,blankPrefix:I?this._prefixes._:"",quantified:I?this._quantified:null}),I&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const v=this._contextStack.pop(),y=this._n3Mode;this._subject=v.subject,this._predicate=v.predicate,this._object=v.object,this._graph=v.graph,y&&(this._inversePredicate=v.inverse,this._prefixes._=v.blankPrefix,this._quantified=v.quantified)}_readInTopContext(v){switch(v.type){case"eof":return null!==this._graph?this._error("Unclosed graph",v):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(v)}}_readEntity(v,y){let w;switch(v.type){case"IRI":case"typeIRI":const D=this._resolveIRI(v.value);if(null===D)return this._error("Invalid IRI",v);w=this._namedNode(D);break;case"type":case"prefixed":const j=this._prefixes[v.prefix];if(void 0===j)return this._error(`Undefined prefix "${v.prefix}:"`,v);w=this._namedNode(j+v.value);break;case"blank":w=this._blankNode(this._prefixes[v.prefix]+v.value);break;case"var":w=this._variable(v.value.substr(1));break;default:return this._error(`Expected entity but got ${v.type}`,v)}return!y&&this._n3Mode&&w.id in this._quantified&&(w=this._quantified[w.id]),w}_readSubject(v){switch(this._predicate=null,v.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",v);case"}":return this._readPunctuation(v);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',v);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',v);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",v);if(0===v.prefix.length)return this._literalValue=v.value,this._completeSubjectLiteral;this._subject=this._literal(v.value,this._namedNode(v.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._subject=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(v){const y=v.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[v.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,v):(this._subject=null,"]"===y?this._readBlankNodeTail(v):this._readPunctuation(v));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",v);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",v);default:if(void 0===(this._predicate=this._readEntity(v)))return}return this._readObject}_readObject(v){switch(v.type){case"literal":if(0===v.prefix.length)return this._literalValue=v.value,this._readDataTypeOrLang;this._object=this._literal(v.value,this._namedNode(v.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._object=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(v){return"{"===v.type?this._readGraph(v):this._readPredicate(v)}_readGraph(v){return"{"!==v.type?this._error(`Expected graph but got ${v.type}`,v):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(v){return"]"===v.type?(this._subject=null,this._readBlankNodeTail(v)):(this._predicate=null,this._readPredicate(v))}_readBlankNodeTail(v){if("]"!==v.type)return this._readBlankNodePunctuation(v);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null===this._object?y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()}_readPredicateAfterBlank(v){switch(v.type){case".":case"}":return this._subject=null,this._readPunctuation(v);default:return this._readPredicate(v)}}_readListItem(v){let y=null,w=null,D=this._readListItem;const j=this._subject,I=this._contextStack,H=I[I.length-1];switch(v.type){case"[":this._saveContext("blank",this._graph,w=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),D=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,w=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==I.length&&"list"===I[I.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(D=this._readPredicate,this._subject===this.RDF_NIL)return D}else if(D=this._getContextEndReader(),this._object===this.RDF_NIL)return D;w=this.RDF_NIL;break;case"literal":0===v.prefix.length?(this._literalValue=v.value,D=this._readListItemDataTypeOrLang):(y=this._literal(v.value,this._namedNode(v.prefix)),D=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);default:if(void 0===(y=this._readEntity(v)))return}if(null===w&&(this._subject=w=this._blankNode()),null===j?null===H.predicate?H.subject=w:H.object=w:this._emit(j,this.RDF_REST,w,this._graph),null!==y){if(this._n3Mode&&("IRI"===v.type||"prefixed"===v.type))return this._saveContext("item",this._graph,w,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(w,this.RDF_FIRST,y,this._graph)}return D}_readDataTypeOrLang(v){return this._completeObjectLiteral(v,!1)}_readListItemDataTypeOrLang(v){return this._completeObjectLiteral(v,!0)}_completeLiteral(v){let y=this._literal(this._literalValue);switch(v.type){case"type":case"typeIRI":const w=this._readEntity(v);if(void 0===w)return;y=this._literal(this._literalValue,w),v=null;break;case"langcode":y=this._literal(this._literalValue,v.value),v=null}return{token:v,literal:y}}_completeSubjectLiteral(v){return this._subject=this._completeLiteral(v).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(v,y){const w=this._completeLiteral(v);if(w)return this._object=w.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===w.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(w.token))}_readFormulaTail(v){return"}"!==v.type?this._readPunctuation(v):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(v){let y,w=this._graph;const D=this._subject,j=this._inversePredicate;switch(v.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",v);if(this._n3Mode)return this._readFormulaTail(v);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,j&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(w=this._readEntity(v))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}if(null!==D){const I=this._predicate,H=this._object;j?this._emit(H,I,D,w):this._emit(D,I,H,w)}return y}_readBlankNodePunctuation(v){let y;switch(v.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(v){return"."!==v.type?this._error("Expected dot to follow quad",v):this._readInTopContext}_readPrefix(v){return"prefix"!==v.type?this._error("Expected prefix to follow @prefix",v):(this._prefix=v.value,this._readPrefixIRI)}_readPrefixIRI(v){if("IRI"!==v.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,v);const y=this._readEntity(v);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(v){const y="IRI"===v.type&&this._resolveIRI(v.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",v)}_readNamedGraphLabel(v){switch(v.type){case"IRI":case"blank":case"prefixed":return this._readSubject(v),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",v)}}_readNamedGraphBlankLabel(v){return"]"!==v.type?this._error("Invalid graph label",v):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(v){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(v)):"."!==v.type?this._error("Expected declaration to end with a dot",v):this._readInTopContext}_readQuantifierList(v){let y;switch(v.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(v,!0)))break;default:return this._error(`Unexpected ${v.type}`,v)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(v){return","===v.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(v))}_getPathReader(v){return this._afterPath=v,this._readPath}_readPath(v){switch(v.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,w=y.length&&y[y.length-1];if(w&&"item"===w.type){const D=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,D,this._graph)}return this._afterPath(v)}}_readForwardPath(v){let y,w;const D=this._blankNode();if(void 0!==(w=this._readEntity(v)))return null===this._predicate?(y=this._subject,this._subject=D):(y=this._object,this._object=D),this._emit(y,w,D,this._graph),this._readPath}_readBackwardPath(v){const y=this._blankNode();let w,D;if(void 0!==(w=this._readEntity(v)))return null===this._predicate?(D=this._subject,this._subject=y):(D=this._object,this._object=y),this._emit(y,w,D,this._graph),this._readPath}_readRDFStarTailOrGraph(v){return">>"!==v.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(v))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,v):this._readRDFStarTail(v)}_readRDFStarTail(v){if(">>"!==v.type)return this._error(`Expected >> but got ${v.type}`,v);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const v=this._contextStack;if(!v.length)return this._readPunctuation;switch(v[v.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(v,y,w,D){this._callback(null,this._quad(v,y,w,D||this.DEFAULTGRAPH))}_error(v,y){const w=new Error(`${v} on line ${y.line}.`);w.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(w),this._callback=S}_resolveIRI(v){return/^[a-z][a-z0-9+.-]*:/i.test(v)?v:this._resolveRelativeIRI(v)}_resolveRelativeIRI(v){if(!v.length)return this._base;switch(v[0]){case"#":return this._base+v;case"?":return this._base.replace(/(?:\?.*)?$/,v);case"/":return("/"===v[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(v);default:return/^[^/:]*:/.test(v)?null:this._removeDotSegments(this._basePath+v)}}_removeDotSegments(v){if(!/(^|\/)\.\.?($|[/#?])/.test(v))return v;const y=v.length;let w="",D=-1,j=-1,I=0,H="/";for(;D<y;){switch(H){case":":if(j<0&&"/"===v[++D]&&"/"===v[++D])for(;(j=D+1)<y&&"/"!==v[j];)D=j;break;case"?":case"#":D=y;break;case"/":if("."===v[D+1])switch(H=v[1+ ++D],H){case"/":w+=v.substring(I,D-1),I=D+1;break;case void 0:case"?":case"#":return w+v.substring(I,D)+v.substr(D+1);case".":if(H=v[1+ ++D],void 0===H||"/"===H||"?"===H||"#"===H){if(w+=v.substring(I,D-2),(I=w.lastIndexOf("/"))>=j&&(w=w.substr(0,I)),"/"!==H)return`${w}/${v.substr(D+1)}`;I=D+1}}}H=v[++D]}return w+v.substring(I)}parse(v,y,w){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${$++}_`,this._prefixCallback=w||S,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const D=[];let j;if(this._callback=(I,H)=>{I?j=I:H&&D.push(H)},this._lexer.tokenize(v).every(I=>this._readCallback=this._readCallback(I)),j)throw j;return D}this._callback=y,this._lexer.tokenize(v,(D,j)=>{null!==D?(this._callback(D),this._callback=S):this._readCallback&&(this._readCallback=this._readCallback(j))})}}function S(){}function O(T,v){const y=v.namedNode;T._namedNode=y,T._blankNode=v.blankNode,T._literal=v.literal,T._variable=v.variable,T._quad=v.quad,T.DEFAULTGRAPH=v.defaultGraph(),T.RDF_FIRST=y(L.default.rdf.first),T.RDF_REST=y(L.default.rdf.rest),T.RDF_NIL=y(L.default.rdf.nil),T.N3_FORALL=y(L.default.r.forAll),T.N3_FORSOME=y(L.default.r.forSome),T.ABBREVIATIONS={a:y(L.default.rdf.type),"=":y(L.default.owl.sameAs),">":y(L.default.log.implies)},T.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}he.default=b,O(b.prototype,V.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var v,q=function(v,y){if(!y&&v&&v.__esModule)return v;if(null===v||"object"!=typeof v&&"function"!=typeof v)return{default:v};var w=$(y);if(w&&w.has(v))return w.get(v);var D={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var I in v)if("default"!==I&&Object.prototype.hasOwnProperty.call(v,I)){var H=j?Object.getOwnPropertyDescriptor(v,I):null;H&&(H.get||H.set)?Object.defineProperty(D,I,H):D[I]=v[I]}return D.default=v,w&&w.set(v,D),D}(K("./N3DataFactory")),V=K("readable-stream"),L=(v=K("./IRIs"))&&v.__esModule?v:{default:v};function $(v){if("function"!=typeof WeakMap)return null;var y=new WeakMap,w=new WeakMap;return($=function(D){return D?w:y})(v)}class S{constructor(y,w){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!w&&y&&!y[0]&&(w=y,y=null),this._factory=(w=w||{}).factory||q.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const w=this._graphs;let D,j;for(const I in w)for(const H in D=w[I].subjects)for(const Y in j=D[H])y+=Object.keys(j[Y]).length;return this._size=y}_addToIndex(y,w,D,j){const I=y[w]||(y[w]={}),H=I[D]||(I[D]={}),Y=j in H;return Y||(H[j]=null),!Y}_removeFromIndex(y,w,D,j){const I=y[w],H=I[D];delete H[j];for(const Y in H)return;delete I[D];for(const Y in I)return;delete y[w]}_findInIndex(y,w,D,j,I,H,Y,M,F,Q){let E,U,ie;const ee=!w+!D+!j>1?Object.keys(this._ids):this._entities;w&&((E=y,y={})[w]=E[w]);for(const se in y){const Te=ee[se];if(U=y[se]){D&&((E=U,U={})[D]=E[D]);for(const me in U){const te=ee[me];if(ie=U[me]){const ye=j?j in ie?[j]:[]:Object.keys(ie);for(let Me=0;Me<ye.length;Me++){const Ve={subject:null,predicate:null,object:null};Ve[I]=(0,q.termFromId)(Te,this._factory),Ve[H]=(0,q.termFromId)(te,this._factory),Ve[Y]=(0,q.termFromId)(ee[ye[Me]],this._factory);const nt=this._factory.quad(Ve.subject,Ve.predicate,Ve.object,(0,q.termFromId)(M,this._factory));if(Q)Q.push(nt);else if(F(nt))return!0}}}}}return Q}_loop(y,w){for(const D in y)w(D)}_loopByKey0(y,w,D){let j,I;if(j=y[w])for(I in j)D(I)}_loopByKey1(y,w,D){let j,I;for(j in y)I=y[j],I[w]&&D(j)}_loopBy2Keys(y,w,D,j){let I,H,Y;if((I=y[w])&&(H=I[D]))for(Y in H)j(Y)}_countInIndex(y,w,D,j){let H,Y,M,I=0;w&&((H=y,y={})[w]=H[w]);for(const F in y)if(Y=y[F]){D&&((H=Y,Y={})[D]=H[D]);for(const Q in Y)(M=Y[Q])&&(j?j in M&&I++:I+=Object.keys(M).length)}return I}_getGraphs(y){if(!O(y))return this._graphs;const w={};return w[y]=this._graphs[y],w}_uniqueEntities(y){const w=Object.create(null);return D=>{D in w||(w[D]=!0,y((0,q.termFromId)(this._entities[D],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,w,D,j){w||(j=y.graph,D=y.object,w=y.predicate,y=y.subject),y=(0,q.termToId)(y),w=(0,q.termToId)(w),D=(0,q.termToId)(D),j=(0,q.termToId)(j);let I=this._graphs[j];I||(I=this._graphs[j]={subjects:{},predicates:{},objects:{}},Object.freeze(I));const H=this._ids,Y=this._entities;y=H[y]||(H[Y[++this._id]=y]=this._id),w=H[w]||(H[Y[++this._id]=w]=this._id),D=H[D]||(H[Y[++this._id]=D]=this._id);const M=this._addToIndex(I.subjects,y,w,D);return this._addToIndex(I.predicates,w,D,y),this._addToIndex(I.objects,D,y,w),this._size=null,M}addQuads(y){for(let w=0;w<y.length;w++)this.addQuad(y[w])}delete(y){return this.removeQuad(y),this}has(y){return 0!==this.getQuads(y.subject,y.predicate,y.object,y.graph).length}import(y){return y.on("data",w=>{this.addQuad(w)}),y}removeQuad(y,w,D,j){w||(j=y.graph,D=y.object,w=y.predicate,y=y.subject),y=(0,q.termToId)(y),w=(0,q.termToId)(w),D=(0,q.termToId)(D),j=(0,q.termToId)(j);const I=this._ids,H=this._graphs;let Y,M,F;if(!((y=I[y])&&(w=I[w])&&(D=I[D])&&(Y=H[j])&&(M=Y.subjects[y])&&(F=M[w])&&D in F))return!1;for(y in this._removeFromIndex(Y.subjects,y,w,D),this._removeFromIndex(Y.predicates,w,D,y),this._removeFromIndex(Y.objects,D,y,w),null!==this._size&&this._size--,Y.subjects)return!0;return delete H[j],!0}removeQuads(y){for(let w=0;w<y.length;w++)this.removeQuad(y[w])}remove(y){return y.on("data",w=>{this.removeQuad(w)}),y}removeMatches(y,w,D,j){const I=new V.Readable({objectMode:!0});return I._read=()=>{for(const H of this.getQuads(y,w,D,j))I.push(H);I.push(null)},this.remove(I)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,w,D,j){y=y&&(0,q.termToId)(y),w=w&&(0,q.termToId)(w),D=D&&(0,q.termToId)(D),j=j&&(0,q.termToId)(j);const I=[],H=this._getGraphs(j),Y=this._ids;let M,F,Q,E;if(O(y)&&!(F=Y[y])||O(w)&&!(Q=Y[w])||O(D)&&!(E=Y[D]))return I;for(const U in H)(M=H[U])&&(F?E?this._findInIndex(M.objects,E,F,Q,"object","subject","predicate",U,null,I):this._findInIndex(M.subjects,F,Q,null,"subject","predicate","object",U,null,I):Q?this._findInIndex(M.predicates,Q,E,null,"predicate","object","subject",U,null,I):E?this._findInIndex(M.objects,E,null,null,"object","subject","predicate",U,null,I):this._findInIndex(M.subjects,null,null,null,"subject","predicate","object",U,null,I));return I}match(y,w,D,j){return new T(this,y,w,D,j)}countQuads(y,w,D,j){y=y&&(0,q.termToId)(y),w=w&&(0,q.termToId)(w),D=D&&(0,q.termToId)(D),j=j&&(0,q.termToId)(j);const I=this._getGraphs(j),H=this._ids;let M,F,Q,E,Y=0;if(O(y)&&!(F=H[y])||O(w)&&!(Q=H[w])||O(D)&&!(E=H[D]))return 0;for(const U in I)(M=I[U])&&(Y+=y?D?this._countInIndex(M.objects,E,F,Q):this._countInIndex(M.subjects,F,Q,E):w?this._countInIndex(M.predicates,Q,E,F):this._countInIndex(M.objects,E,F,Q));return Y}forEach(y,w,D,j,I){this.some(H=>(y(H),!1),w,D,j,I)}every(y,w,D,j,I){let H=!1;const Y=!this.some(M=>(H=!0,!y(M)),w,D,j,I);return H&&Y}some(y,w,D,j,I){w=w&&(0,q.termToId)(w),D=D&&(0,q.termToId)(D),j=j&&(0,q.termToId)(j),I=I&&(0,q.termToId)(I);const H=this._getGraphs(I),Y=this._ids;let M,F,Q,E;if(O(w)&&!(F=Y[w])||O(D)&&!(Q=Y[D])||O(j)&&!(E=Y[j]))return!1;for(const U in H)if(M=H[U])if(F){if(E){if(this._findInIndex(M.objects,E,F,Q,"object","subject","predicate",U,y,null))return!0}else if(this._findInIndex(M.subjects,F,Q,null,"subject","predicate","object",U,y,null))return!0}else if(Q){if(this._findInIndex(M.predicates,Q,E,null,"predicate","object","subject",U,y,null))return!0}else if(E){if(this._findInIndex(M.objects,E,null,null,"object","subject","predicate",U,y,null))return!0}else if(this._findInIndex(M.subjects,null,null,null,"subject","predicate","object",U,y,null))return!0;return!1}getSubjects(y,w,D){const j=[];return this.forSubjects(I=>{j.push(I)},y,w,D),j}forSubjects(y,w,D,j){w=w&&(0,q.termToId)(w),D=D&&(0,q.termToId)(D),j=j&&(0,q.termToId)(j);const I=this._ids,H=this._getGraphs(j);let Y,M,F;if(y=this._uniqueEntities(y),!(O(w)&&!(M=I[w])||O(D)&&!(F=I[D])))for(j in H)(Y=H[j])&&(M?F?this._loopBy2Keys(Y.predicates,M,F,y):this._loopByKey1(Y.subjects,M,y):F?this._loopByKey0(Y.objects,F,y):this._loop(Y.subjects,y))}getPredicates(y,w,D){const j=[];return this.forPredicates(I=>{j.push(I)},y,w,D),j}forPredicates(y,w,D,j){w=w&&(0,q.termToId)(w),D=D&&(0,q.termToId)(D),j=j&&(0,q.termToId)(j);const I=this._ids,H=this._getGraphs(j);let Y,M,F;if(y=this._uniqueEntities(y),!(O(w)&&!(M=I[w])||O(D)&&!(F=I[D])))for(j in H)(Y=H[j])&&(M?F?this._loopBy2Keys(Y.objects,F,M,y):this._loopByKey0(Y.subjects,M,y):F?this._loopByKey1(Y.predicates,F,y):this._loop(Y.predicates,y))}getObjects(y,w,D){const j=[];return this.forObjects(I=>{j.push(I)},y,w,D),j}forObjects(y,w,D,j){w=w&&(0,q.termToId)(w),D=D&&(0,q.termToId)(D),j=j&&(0,q.termToId)(j);const I=this._ids,H=this._getGraphs(j);let Y,M,F;if(y=this._uniqueEntities(y),!(O(w)&&!(M=I[w])||O(D)&&!(F=I[D])))for(j in H)(Y=H[j])&&(M?F?this._loopBy2Keys(Y.subjects,M,F,y):this._loopByKey1(Y.objects,M,y):F?this._loopByKey0(Y.predicates,F,y):this._loop(Y.objects,y))}getGraphs(y,w,D){const j=[];return this.forGraphs(I=>{j.push(I)},y,w,D),j}forGraphs(y,w,D,j){for(const I in this._graphs)this.some(H=>(y(H.graph),!0),w,D,j,I)}createBlankNode(y){let w,D;if(y)for(w=y=`_:${y}`,D=1;this._ids[w];)w=y+D++;else do{w="_:b"+this._blankNodeIndex++}while(this._ids[w]);return this._ids[w]=++this._id,this._entities[this._id]=w,this._factory.blankNode(w.substr(2))}extractLists({remove:y=!1,ignoreErrors:w=!1}={}){const D={},j=w?()=>!0:(Y,M)=>{throw new Error(`${Y.value} ${M}`)},I=this.getQuads(null,L.default.rdf.rest,L.default.rdf.nil,null),H=y?[...I]:[];return I.forEach(Y=>{const M=[];let Q,E,F=!1;const U=Y.graph;let ie=Y.subject;for(;ie&&!F;){const ue=this.getQuads(null,null,ie,null),ee=this.getQuads(ie,null,null,null);let se,Te=null,me=null,te=null;for(let ye=0;ye<ee.length&&!F;ye++)se=ee[ye],se.graph.equals(U)?Q?F=j(ie,"has non-list arcs out"):se.predicate.value===L.default.rdf.first?Te?F=j(ie,"has multiple rdf:first arcs"):H.push(Te=se):se.predicate.value===L.default.rdf.rest?me?F=j(ie,"has multiple rdf:rest arcs"):H.push(me=se):ue.length?F=j(ie,"can't be subject and object"):(Q=se,E="subject"):F=j(ie,"not confined to single graph");for(let ye=0;ye<ue.length&&!F;++ye)se=ue[ye],Q?F=j(ie,"can't have coreferences"):se.predicate.value===L.default.rdf.rest?te?F=j(ie,"has incoming rdf:rest arcs"):te=se:(Q=se,E="object");Te?M.unshift(Te.object):F=j(ie,"has no list head"),ie=te&&te.subject}F?y=!1:Q&&(D[Q[E].value]=M)}),y&&this.removeQuads(H),D}*[Symbol.iterator](){yield*this.getQuads()}}function O(v){return"string"==typeof v||v instanceof String}he.default=S;class T extends V.Readable{constructor(y,w,D,j,I){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:w,predicate:D,object:j,graph:I})}get filtered(){if(!this._filtered){const{n3Store:y,graph:w,object:D,predicate:j,subject:I}=this,H=y.getQuads(I,j,D,w);this._filtered=new S(H,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this.filtered.getQuads())this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,w,D,j){return new T(this.filtered,y,w,D,j)}*[Symbol.iterator](){yield*this.filtered.getQuads()}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var $,q=($=K("./N3Parser"))&&$.__esModule?$:{default:$},V=K("readable-stream");he.default=class extends V.Transform{constructor(b){let O,T;super({decodeStrings:!0}),this._readableState.objectMode=!0,new q.default(b).parse({on:(v,y)=>{switch(v){case"data":O=y;break;case"end":T=y}}},(v,y)=>{v&&this.emit("error",v)||y&&this.push(y)},(v,y)=>{this.emit("prefix",v,y)}),this._transform=(v,y,w)=>{O(v),w()},this._flush=v=>{T(),v()}}import(b){return b.on("data",S=>{this.write(S)}),b.on("end",()=>{this.end()}),b.on("error",S=>{this.emit("error",S)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var $,q=K("readable-stream"),V=($=K("./N3Writer"))&&$.__esModule?$:{default:$};he.default=class extends q.Transform{constructor(b){super({encoding:"utf8",writableObjectMode:!0});const S=this._writer=new V.default({write:(O,T,v)=>{this.push(O),v&&v()},end:O=>{this.push(null),O&&O()}},b);this._transform=(O,T,v)=>{S.addQuad(O,v)},this._flush=O=>{S.end(O)}}import(b){return b.on("data",S=>{this.write(S)}),b.on("end",()=>{this.end()}),b.on("error",S=>{this.emit("error",S)}),b.on("prefix",(S,O)=>{this._writer.addPrefix(S,O)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},he.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},he.isLiteral=function(y){return!!y&&"Literal"===y.termType},he.isVariable=function(y){return!!y&&"Variable"===y.termType},he.isDefaultGraph=S,he.inDefaultGraph=function(y){return S(y.graph)},he.prefix=function(y,w){return v({"":y},w)("")},he.prefixes=v;var y,q=(y=K("./N3DataFactory"))&&y.__esModule?y:{default:y};function S(y){return!!y&&"DefaultGraph"===y.termType}function v(y,w){const D=Object.create(null);for(const I in y)j(I,y[I]);function j(I,H){if("string"==typeof H){const Y=Object.create(null);D[I]=M=>Y[M]||(Y[M]=w.namedNode(H+M))}else if(!(I in D))throw new Error(`Unknown prefix: ${I}`);return D[I]}return w=w||q.default,j}},{"./N3DataFactory":35}],42:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var H,q=(H=K("./IRIs"))&&H.__esModule?H:{default:H},V=function(H,Y){if(!Y&&H&&H.__esModule)return H;if(null===H||"object"!=typeof H&&"function"!=typeof H)return{default:H};var M=re(Y);if(M&&M.has(H))return M.get(H);var F={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in H)if("default"!==E&&Object.prototype.hasOwnProperty.call(H,E)){var U=Q?Object.getOwnPropertyDescriptor(H,E):null;U&&(U.get||U.set)?Object.defineProperty(F,E,U):F[E]=H[E]}return F.default=H,M&&M.set(H,F),F}(K("./N3DataFactory")),L=K("./N3Util");function re(H){if("function"!=typeof WeakMap)return null;var Y=new WeakMap,M=new WeakMap;return(re=function(F){return F?M:Y})(H)}const S=V.default.defaultGraph(),{rdf:O,xsd:T}=q.default,v=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,w={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class D extends V.Term{equals(){return!1}}function I(H){let Y=w[H];return void 0===Y&&(1===H.length?(Y=H.charCodeAt(0).toString(16),Y="\\u0000".substr(0,6-Y.length)+Y):(Y=(1024*(H.charCodeAt(0)-55296)+H.charCodeAt(1)+9216).toString(16),Y="\\U00000000".substr(0,10-Y.length)+Y)),Y}he.default=class{constructor(Y,M){if(this._prefixRegex=/$0^/,Y&&"function"!=typeof Y.write&&(M=Y,Y=null),this._lists=(M=M||{}).lists,Y)this._outputStream=Y,this._endStream=void 0===M.end||!!M.end;else{let F="";this._outputStream={write(Q,E,U){F+=Q,U&&U()},end:Q=>{Q&&Q(null,F)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(M.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=S,this._baseIRI=M.baseIRI,this._prefixIRIs=Object.create(null),M.prefixes&&this.addPrefixes(M.prefixes))}get _inDefaultGraph(){return S.equals(this._graph)}_write(Y,M){this._outputStream.write(Y,"utf8",M)}_writeQuad(Y,M,F,Q,E){try{Q.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(S.equals(Q)?"":`${this._encodeIriOrBlank(Q)} {\n`)),this._graph=Q,this._subject=null),Y.equals(this._subject)?M.equals(this._predicate)?this._write(`, ${this._encodeObject(F)}`,E):this._write(`;\n    ${this._encodePredicate(this._predicate=M)} ${this._encodeObject(F)}`,E):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=Y)} ${this._encodePredicate(this._predicate=M)} ${this._encodeObject(F)}`,E)}catch(U){E&&E(U)}}_writeQuadLine(Y,M,F,Q,E){delete this._prefixMatch,this._write(this.quadToString(Y,M,F,Q),E)}quadToString(Y,M,F,Q){return`${this._encodeSubject(Y)} ${this._encodeIriOrBlank(M)} ${this._encodeObject(F)}${Q&&Q.value?` ${this._encodeIriOrBlank(Q)} .\n`:" .\n"}`}quadsToString(Y){return Y.map(M=>this.quadToString(M.subject,M.predicate,M.object,M.graph)).join("")}_encodeSubject(Y){return"Quad"===Y.termType?this._encodeQuad(Y):this._encodeIriOrBlank(Y)}_encodeIriOrBlank(Y){if("NamedNode"!==Y.termType)return this._lists&&Y.value in this._lists&&(Y=this.list(this._lists[Y.value])),"id"in Y?Y.id:`_:${Y.value}`;let M=Y.value;this._baseIRI&&M.startsWith(this._baseIRI)&&(M=M.substr(this._baseIRI.length)),v.test(M)&&(M=M.replace(y,I));const F=this._prefixRegex.exec(M);return F?F[1]?this._prefixIRIs[F[1]]+F[2]:M:`<${M}>`}_encodeLiteral(Y){let M=Y.value;if(v.test(M)&&(M=M.replace(y,I)),Y.language)return`"${M}"@${Y.language}`;if(this._lineMode){if(Y.datatype.value===T.string)return`"${M}"`}else switch(Y.datatype.value){case T.string:return`"${M}"`;case T.boolean:if("true"===M||"false"===M)return M;break;case T.integer:if(/^[+-]?\d+$/.test(M))return M;break;case T.decimal:if(/^[+-]?\d*\.\d+$/.test(M))return M;break;case T.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(M))return M}return`"${M}"^^${this._encodeIriOrBlank(Y.datatype)}`}_encodePredicate(Y){return Y.value===O.type?"a":this._encodeIriOrBlank(Y)}_encodeObject(Y){switch(Y.termType){case"Quad":return this._encodeQuad(Y);case"Literal":return this._encodeLiteral(Y);default:return this._encodeIriOrBlank(Y)}}_encodeQuad({subject:Y,predicate:M,object:F,graph:Q}){return`<<${this._encodeSubject(Y)} ${this._encodePredicate(M)} ${this._encodeObject(F)}${(0,L.isDefaultGraph)(Q)?"":` ${this._encodeIriOrBlank(Q)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(Y,M,F,Q,E){void 0===F?this._writeQuad(Y.subject,Y.predicate,Y.object,Y.graph,M):"function"==typeof Q?this._writeQuad(Y,M,F,S,Q):this._writeQuad(Y,M,F,Q||S,E)}addQuads(Y){for(let M=0;M<Y.length;M++)this.addQuad(Y[M])}addPrefix(Y,M,F){const Q={};Q[Y]=M,this.addPrefixes(Q,F)}addPrefixes(Y,M){if(!this._prefixIRIs)return M&&M();let F=!1;for(let Q in Y){let E=Y[Q];"string"!=typeof E&&(E=E.value),F=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[E]=Q+=":",this._write(`@prefix ${Q} <${E}>.\n`)}if(F){let Q="",E="";for(const U in this._prefixIRIs)Q+=Q?`|${U}`:U,E+=(E?"|":"")+this._prefixIRIs[U];Q=Q.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp(`^(?:${E})[^/]*$|^(${Q})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(F?"\n":"",M)}blank(Y,M){let Q,E,F=Y;switch(void 0===Y?F=[]:Y.termType?F=[{predicate:Y,object:M}]:"length"in Y||(F=[Y]),E=F.length){case 0:return new D("[]");case 1:if(Q=F[0],!(Q.object instanceof D))return new D(`[ ${this._encodePredicate(Q.predicate)} ${this._encodeObject(Q.object)} ]`);default:let U="[";for(let ie=0;ie<E;ie++)Q=F[ie],Q.predicate.equals(Y)?U+=`, ${this._encodeObject(Q.object)}`:(U+=`${(ie?";\n  ":"\n  ")+this._encodePredicate(Q.predicate)} ${this._encodeObject(Q.object)}`,Y=Q.predicate);return new D(`${U}\n]`)}}list(Y){const M=Y&&Y.length||0,F=new Array(M);for(let Q=0;Q<M;Q++)F[Q]=this._encodeObject(Y[Q]);return new D(`(${F.join(" ")})`)}end(Y){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let M=Y&&((F,Q)=>{M=null,Y(F,Q)});if(this._endStream)try{return this._outputStream.end(M)}catch(F){}M&&M()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),Object.defineProperty(he,"Lexer",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(he,"Parser",{enumerable:!0,get:function(){return V.default}}),Object.defineProperty(he,"Writer",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(he,"Store",{enumerable:!0,get:function(){return re.default}}),Object.defineProperty(he,"StreamParser",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(he,"StreamWriter",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(he,"DataFactory",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(he,"Term",{enumerable:!0,get:function(){return O.Term}}),Object.defineProperty(he,"NamedNode",{enumerable:!0,get:function(){return O.NamedNode}}),Object.defineProperty(he,"Literal",{enumerable:!0,get:function(){return O.Literal}}),Object.defineProperty(he,"BlankNode",{enumerable:!0,get:function(){return O.BlankNode}}),Object.defineProperty(he,"Variable",{enumerable:!0,get:function(){return O.Variable}}),Object.defineProperty(he,"DefaultGraph",{enumerable:!0,get:function(){return O.DefaultGraph}}),Object.defineProperty(he,"Quad",{enumerable:!0,get:function(){return O.Quad}}),Object.defineProperty(he,"Triple",{enumerable:!0,get:function(){return O.Triple}}),Object.defineProperty(he,"termFromId",{enumerable:!0,get:function(){return O.termFromId}}),Object.defineProperty(he,"termToId",{enumerable:!0,get:function(){return O.termToId}}),he.Util=void 0;var q=y(K("./N3Lexer")),V=y(K("./N3Parser")),L=y(K("./N3Writer")),re=y(K("./N3Store")),$=y(K("./N3StreamParser")),b=y(K("./N3StreamWriter")),S=v(K("./N3Util"));he.Util=S;var O=v(K("./N3DataFactory"));function T(w){if("function"!=typeof WeakMap)return null;var D=new WeakMap,j=new WeakMap;return(T=function(I){return I?j:D})(w)}function v(w,D){if(!D&&w&&w.__esModule)return w;if(null===w||"object"!=typeof w&&"function"!=typeof w)return{default:w};var j=T(D);if(j&&j.has(w))return j.get(w);var I={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Y in w)if("default"!==Y&&Object.prototype.hasOwnProperty.call(w,Y)){var M=H?Object.getOwnPropertyDescriptor(w,Y):null;M&&(M.get||M.set)?Object.defineProperty(I,Y,M):I[Y]=w[Y]}return I.default=w,j&&j.set(w,I),I}function y(w){return w&&w.__esModule?w:{default:w}}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(K,Ae,he){var V,L,q=Ae.exports={};function re(){throw new Error("setTimeout has not been defined")}function $(){throw new Error("clearTimeout has not been defined")}function b(H){if(V===setTimeout)return setTimeout(H,0);if((V===re||!V)&&setTimeout)return V=setTimeout,setTimeout(H,0);try{return V(H,0)}catch(Y){try{return V.call(null,H,0)}catch(M){return V.call(this,H,0)}}}!function(){try{V="function"==typeof setTimeout?setTimeout:re}catch(H){V=re}try{L="function"==typeof clearTimeout?clearTimeout:$}catch(H){L=$}}();var v,O=[],T=!1,y=-1;function w(){!T||!v||(T=!1,v.length?O=v.concat(O):y=-1,O.length&&D())}function D(){if(!T){var H=b(w);T=!0;for(var Y=O.length;Y;){for(v=O,O=[];++y<Y;)v&&v[y].run();y=-1,Y=O.length}v=null,T=!1,function(H){if(L===clearTimeout)return clearTimeout(H);if((L===$||!L)&&clearTimeout)return L=clearTimeout,clearTimeout(H);try{L(H)}catch(Y){try{return L.call(null,H)}catch(M){return L.call(this,H)}}}(H)}}function j(H,Y){this.fun=H,this.array=Y}function I(){}q.nextTick=function(H){var Y=new Array(arguments.length-1);if(arguments.length>1)for(var M=1;M<arguments.length;M++)Y[M-1]=arguments[M];O.push(new j(H,Y)),1===O.length&&!T&&b(D)},j.prototype.run=function(){this.fun.apply(null,this.array)},q.title="browser",q.browser=!0,q.env={},q.argv=[],q.version="",q.versions={},q.on=I,q.addListener=I,q.once=I,q.off=I,q.removeListener=I,q.removeAllListeners=I,q.emit=I,q.prependListener=I,q.prependOnceListener=I,q.listeners=function(H){return[]},q.binding=function(H){throw new Error("process.binding is not supported")},q.cwd=function(){return"/"},q.chdir=function(H){throw new Error("process.chdir is not supported")},q.umask=function(){return 0}},{}],45:[function(K,Ae,he){(function(q){(function(){let V;Ae.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:q):L=>(V||(V=Promise.resolve())).then(L).catch(re=>setTimeout(()=>{throw re},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(K,Ae,he){Ae.exports=K("./lib")},{"./lib":55}],47:[function(K,Ae,he){"use strict";Ae.exports=class k7{constructor(V,L=new Map,re=0){this.prefix=V,this._existing=L,this.counter=re}clone(){const{prefix:V,_existing:L,counter:re}=this;return new k7(V,new Map(L),re)}getId(V){const L=V&&this._existing.get(V);if(L)return L;const re=this.prefix+this.counter;return this.counter++,V&&this._existing.set(V,re),re}hasId(V){return this._existing.has(V)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(K,Ae,he){"use strict";K("setimmediate");const q=self.crypto||self.msCrypto;Ae.exports=class{constructor(L){if(!q||!q.subtle)throw new Error("crypto.subtle not found.");if("sha256"===L)this.algorithm={name:"SHA-256"};else{if("sha1"!==L)throw new Error(`Unsupport algorithm "${L}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(L){this._content+=L}digest(){var L=this;return gt(function*(){const re=(new TextEncoder).encode(L._content),$=new Uint8Array(yield q.subtle.digest(L.algorithm,re));let b="";for(let S=0;S<$.length;++S)b+=$[S].toString(16).padStart(2,"0");return b})()}}},{setimmediate:86}],49:[function(K,Ae,he){"use strict";const L="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",re="http://www.w3.org/2001/XMLSchema#string",$="NamedNode",b="BlankNode",S="Literal",O="DefaultGraph",T={};function v(I,H){return I.subject.termType===H.subject.termType&&I.object.termType===H.object.termType&&I.subject.value===H.subject.value&&I.predicate.value===H.predicate.value&&I.object.value===H.object.value&&(I.object.termType!==S||I.object.datatype.termType===H.object.datatype.termType&&I.object.language===H.object.language&&I.object.datatype.value===H.object.datatype.value)}T.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,T.empty=new RegExp("^[ \\t]*$"),T.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),Ae.exports=class AP{static parse(H){const Y=[],M={},F=H.split(T.eoln);let Q=0;for(const E of F){if(Q++,T.empty.test(E))continue;const U=E.match(T.quad);if(null===U)throw new Error("N-Quads parse error on line "+Q+".");const ie={subject:null,predicate:null,object:null,graph:null};if(ie.subject=void 0!==U[1]?{termType:$,value:U[1]}:{termType:b,value:U[2]},ie.predicate={termType:$,value:U[3]},void 0!==U[4]?ie.object={termType:$,value:U[4]}:void 0!==U[5]?ie.object={termType:b,value:U[5]}:(ie.object={termType:S,value:void 0,datatype:{termType:$}},void 0!==U[7]?ie.object.datatype.value=U[7]:void 0!==U[8]?(ie.object.datatype.value=L,ie.object.language=U[8]):ie.object.datatype.value=re,ie.object.value=U[6].replace(D,function(H,Y,M,F){if(Y)switch(Y){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(M)return String.fromCharCode(parseInt(M,16));if(F)throw new Error("Unsupported U escape")})),ie.graph=void 0!==U[9]?{termType:$,value:U[9]}:void 0!==U[10]?{termType:b,value:U[10]}:{termType:O,value:""},ie.graph.value in M){let ue=!0;const ee=M[ie.graph.value];for(const se of ee)if(v(se,ie)){ue=!1;break}ue&&(ee.push(ie),Y.push(ie))}else M[ie.graph.value]=[ie],Y.push(ie)}return Y}static serialize(H){Array.isArray(H)||(H=AP.legacyDatasetToQuads(H));const Y=[];for(const M of H)Y.push(AP.serializeQuad(M));return Y.sort().join("")}static serializeQuad(H){const Y=H.subject,F=H.object,Q=H.graph;let E="";return E+=Y.termType===$?`<${Y.value}>`:`${Y.value}`,E+=` <${H.predicate.value}> `,F.termType===$?E+=`<${F.value}>`:F.termType===b?E+=F.value:(E+=`"${I=F.value,I.replace(y,function(H){switch(H){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,F.datatype.value===L?F.language&&(E+=`@${F.language}`):F.datatype.value!==re&&(E+=`^^<${F.datatype.value}>`)),Q.termType===$?E+=` <${Q.value}>`:Q.termType===b&&(E+=` ${Q.value}`),E+=" .\n",E;var I}static legacyDatasetToQuads(H){const Y=[],M={"blank node":b,IRI:$,literal:S};for(const F in H)H[F].forEach(E=>{const U={};for(const ie in E){const ue=E[ie],ee={termType:M[ue.type],value:ue.value};ee.termType===S&&(ee.datatype={termType:$},"datatype"in ue&&(ee.datatype.value=ue.datatype),"language"in ue?("datatype"in ue||(ee.datatype.value=L),ee.language=ue.language):"datatype"in ue||(ee.datatype.value=re)),U[ie]=ee}U.graph="@default"===F?{termType:O,value:""}:{termType:F.startsWith("_:")?b:$,value:F},Y.push(U)});return Y}};const y=/["\\\n\r]/g;const D=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(K,Ae,he){"use strict";Ae.exports=class{constructor(V){this.current=V.sort(),this.done=!1,this.dir=new Map;for(let L=0;L<V.length;++L)this.dir.set(V[L],!0)}hasNext(){return!this.done}next(){const{current:V,dir:L}=this,re=V.slice();let $=null,b=0;const S=V.length;for(let O=0;O<S;++O){const T=V[O],v=L.get(T);(null===$||T>$)&&(v&&O>0&&T>V[O-1]||!v&&O<S-1&&T>V[O+1])&&($=T,b=O)}if(null===$)this.done=!0;else{const O=L.get($)?b-1:b+1;V[b]=V[O],V[O]=$;for(const T of V)T>$&&L.set(T,!L.get(T))}return re}}},{}],51:[function(K,Ae,he){(function(q){(function(){"use strict";const V=K("./IdentifierIssuer"),L=K("./MessageDigest"),re=K("./Permuter"),$=K("./NQuads");function b(S,O){return S.hash<O.hash?-1:S.hash>O.hash?1:0}Ae.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new V("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(O){var T=this;return gt(function*(){T.quads=O;for(const H of O)T._addBlankNodeQuadInfo({quad:H,component:H.subject}),T._addBlankNodeQuadInfo({quad:H,component:H.object}),T._addBlankNodeQuadInfo({quad:H,component:H.graph});const v=new Map,y=[...T.blankNodeInfo.keys()];let w=0;for(const H of y)++w%100==0&&(yield T._yield()),yield T._hashAndTrackBlankNode({id:H,hashToBlankNodes:v});const D=[...v.keys()].sort(),j=[];for(const H of D){const Y=v.get(H);Y.length>1?j.push(Y):T.canonicalIssuer.getId(Y[0])}for(const H of j){const Y=[];for(const M of H){if(T.canonicalIssuer.hasId(M))continue;const F=new V("_:b");F.getId(M);const Q=yield T.hashNDegreeQuads(M,F);Y.push(Q)}Y.sort(b);for(const M of Y){const F=M.issuer.getOldIds();for(const Q of F)T.canonicalIssuer.getId(Q)}}const I=[];for(const H of T.quads){const Y=ht({},H);Y.subject=T._useCanonicalId({component:Y.subject}),Y.object=T._useCanonicalId({component:Y.object}),Y.graph=T._useCanonicalId({component:Y.graph}),I.push($.serializeQuad(Y))}return I.sort(),I.join("")})()}hashFirstDegreeQuads(O){var T=this;return gt(function*(){const v=[],y=T.blankNodeInfo.get(O),w=y.quads;for(const j of w){const I={subject:null,predicate:j.predicate,object:null,graph:null};I.subject=T.modifyFirstDegreeComponent(O,j.subject,"subject"),I.object=T.modifyFirstDegreeComponent(O,j.object,"object"),I.graph=T.modifyFirstDegreeComponent(O,j.graph,"graph"),v.push($.serializeQuad(I))}v.sort();const D=new L(T.hashAlgorithm);for(const j of v)D.update(j);return y.hash=yield D.digest(),y.hash})()}hashRelatedBlankNode(O,T,v,y){var w=this;return gt(function*(){let D;D=w.canonicalIssuer.hasId(O)?w.canonicalIssuer.getId(O):v.hasId(O)?v.getId(O):w.blankNodeInfo.get(O).hash;const j=new L(w.hashAlgorithm);return j.update(y),"g"!==y&&j.update(w.getRelatedPredicate(T)),j.update(D),j.digest()})()}hashNDegreeQuads(O,T){var v=this;return gt(function*(){const y=new L(v.hashAlgorithm),w=yield v.createHashToRelated(O,T),D=[...w.keys()].sort();for(const j of D){y.update(j);let H,I="";const Y=new re(w.get(j));let M=0;for(;Y.hasNext();){const F=Y.next();++M%3==0&&(yield v._yield());let Q=T.clone(),E="";const U=[];let ie=!1;for(const ue of F)if(v.canonicalIssuer.hasId(ue)?E+=v.canonicalIssuer.getId(ue):(Q.hasId(ue)||U.push(ue),E+=Q.getId(ue)),0!==I.length&&E>I){ie=!0;break}if(!ie){for(const ue of U){const ee=yield v.hashNDegreeQuads(ue,Q);if(E+=Q.getId(ue),E+=`<${ee.hash}>`,Q=ee.issuer,0!==I.length&&E>I){ie=!0;break}}ie||(0===I.length||E<I)&&(I=E,H=Q)}}y.update(I),T=H}return{hash:yield y.digest(),issuer:T}})()}modifyFirstDegreeComponent(O,T){return"BlankNode"!==T.termType?T:{termType:"BlankNode",value:T.value===O?"_:a":"_:z"}}getRelatedPredicate(O){return`<${O.predicate.value}>`}createHashToRelated(O,T){var v=this;return gt(function*(){const y=new Map,w=v.blankNodeInfo.get(O).quads;let D=0;for(const j of w)++D%100==0&&(yield v._yield()),yield Promise.all([v._addRelatedBlankNodeHash({quad:j,component:j.subject,position:"s",id:O,issuer:T,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:j,component:j.object,position:"o",id:O,issuer:T,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:j,component:j.graph,position:"g",id:O,issuer:T,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:O,hashToBlankNodes:T}){var v=this;return gt(function*(){const y=yield v.hashFirstDegreeQuads(O),w=T.get(y);w?w.push(O):T.set(y,[O])})()}_addBlankNodeQuadInfo({quad:O,component:T}){if("BlankNode"!==T.termType)return;const v=T.value,y=this.blankNodeInfo.get(v);y?y.quads.add(O):this.blankNodeInfo.set(v,{quads:new Set([O]),hash:null})}_addRelatedBlankNodeHash({quad:O,component:T,position:v,id:y,issuer:w,hashToRelated:D}){var j=this;return gt(function*(){if("BlankNode"!==T.termType||T.value===y)return;const I=T.value,H=yield j.hashRelatedBlankNode(I,O,w,v),Y=D.get(H);Y?Y.push(I):D.set(H,[I])})()}_useCanonicalId({component:O}){return"BlankNode"!==O.termType||O.value.startsWith(this.canonicalIssuer.prefix)?O:{termType:"BlankNode",value:this.canonicalIssuer.getId(O.value)}}_yield(){return gt(function*(){return new Promise(O=>q(O))})()}}}).call(this)}).call(this,K("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(K,Ae,he){"use strict";const q=K("./IdentifierIssuer"),V=K("./MessageDigest"),L=K("./Permuter"),re=K("./NQuads");function $(b,S){return b.hash<S.hash?-1:b.hash>S.hash?1:0}Ae.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new q("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(S){this.quads=S;for(const D of S)this._addBlankNodeQuadInfo({quad:D,component:D.subject}),this._addBlankNodeQuadInfo({quad:D,component:D.object}),this._addBlankNodeQuadInfo({quad:D,component:D.graph});const O=new Map,T=[...this.blankNodeInfo.keys()];for(const D of T)this._hashAndTrackBlankNode({id:D,hashToBlankNodes:O});const v=[...O.keys()].sort(),y=[];for(const D of v){const j=O.get(D);j.length>1?y.push(j):this.canonicalIssuer.getId(j[0])}for(const D of y){const j=[];for(const I of D){if(this.canonicalIssuer.hasId(I))continue;const H=new q("_:b");H.getId(I);const Y=this.hashNDegreeQuads(I,H);j.push(Y)}j.sort($);for(const I of j){const H=I.issuer.getOldIds();for(const Y of H)this.canonicalIssuer.getId(Y)}}const w=[];for(const D of this.quads){const j=ht({},D);j.subject=this._useCanonicalId({component:j.subject}),j.object=this._useCanonicalId({component:j.object}),j.graph=this._useCanonicalId({component:j.graph}),w.push(re.serializeQuad(j))}return w.sort(),w.join("")}hashFirstDegreeQuads(S){const O=[],T=this.blankNodeInfo.get(S),v=T.quads;for(const w of v){const D={subject:null,predicate:w.predicate,object:null,graph:null};D.subject=this.modifyFirstDegreeComponent(S,w.subject,"subject"),D.object=this.modifyFirstDegreeComponent(S,w.object,"object"),D.graph=this.modifyFirstDegreeComponent(S,w.graph,"graph"),O.push(re.serializeQuad(D))}O.sort();const y=new V(this.hashAlgorithm);for(const w of O)y.update(w);return T.hash=y.digest(),T.hash}hashRelatedBlankNode(S,O,T,v){let y;y=this.canonicalIssuer.hasId(S)?this.canonicalIssuer.getId(S):T.hasId(S)?T.getId(S):this.blankNodeInfo.get(S).hash;const w=new V(this.hashAlgorithm);return w.update(v),"g"!==v&&w.update(this.getRelatedPredicate(O)),w.update(y),w.digest()}hashNDegreeQuads(S,O){const T=new V(this.hashAlgorithm),v=this.createHashToRelated(S,O),y=[...v.keys()].sort();for(const w of y){T.update(w);let j,D="";const I=new L(v.get(w));for(;I.hasNext();){const H=I.next();let Y=O.clone(),M="";const F=[];let Q=!1;for(const E of H)if(this.canonicalIssuer.hasId(E)?M+=this.canonicalIssuer.getId(E):(Y.hasId(E)||F.push(E),M+=Y.getId(E)),0!==D.length&&M>D){Q=!0;break}if(!Q){for(const E of F){const U=this.hashNDegreeQuads(E,Y);if(M+=Y.getId(E),M+=`<${U.hash}>`,Y=U.issuer,0!==D.length&&M>D){Q=!0;break}}Q||(0===D.length||M<D)&&(D=M,j=Y)}}T.update(D),O=j}return{hash:T.digest(),issuer:O}}modifyFirstDegreeComponent(S,O){return"BlankNode"!==O.termType?O:{termType:"BlankNode",value:O.value===S?"_:a":"_:z"}}getRelatedPredicate(S){return`<${S.predicate.value}>`}createHashToRelated(S,O){const T=new Map,v=this.blankNodeInfo.get(S).quads;for(const y of v)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:S,issuer:O,hashToRelated:T}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:S,issuer:O,hashToRelated:T}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:S,issuer:O,hashToRelated:T});return T}_hashAndTrackBlankNode({id:S,hashToBlankNodes:O}){const T=this.hashFirstDegreeQuads(S),v=O.get(T);v?v.push(S):O.set(T,[S])}_addBlankNodeQuadInfo({quad:S,component:O}){if("BlankNode"!==O.termType)return;const T=O.value,v=this.blankNodeInfo.get(T);v?v.quads.add(S):this.blankNodeInfo.set(T,{quads:new Set([S]),hash:null})}_addRelatedBlankNodeHash({quad:S,component:O,position:T,id:v,issuer:y,hashToRelated:w}){if("BlankNode"!==O.termType||O.value===v)return;const D=O.value,j=this.hashRelatedBlankNode(D,S,y,T),I=w.get(j);I?I.push(D):w.set(j,[D])}_useCanonicalId({component:S}){return"BlankNode"!==S.termType||S.value.startsWith(this.canonicalIssuer.prefix)?S:{termType:"BlankNode",value:this.canonicalIssuer.getId(S.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(K,Ae,he){"use strict";const q=K("./URDNA2015");Ae.exports=class extends q{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(L,re,$){return"BlankNode"!==re.termType?re:"graph"===$?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:re.value===L?"_:a":"_:z"}}getRelatedPredicate(L){return L.predicate.value}createHashToRelated(L,re){var $=this;return gt(function*(){const b=new Map,S=$.blankNodeInfo.get(L).quads;let O=0;for(const T of S){let v,y;if("BlankNode"===T.subject.termType&&T.subject.value!==L)y=T.subject.value,v="p";else{if("BlankNode"!==T.object.termType||T.object.value===L)continue;y=T.object.value,v="r"}++O%100==0&&(yield $._yield());const w=yield $.hashRelatedBlankNode(y,T,re,v),D=b.get(w);D?D.push(y):b.set(w,[y])}return b})()}}},{"./URDNA2015":51}],54:[function(K,Ae,he){"use strict";const q=K("./URDNA2015Sync");Ae.exports=class extends q{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(L,re,$){return"BlankNode"!==re.termType?re:"graph"===$?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:re.value===L?"_:a":"_:z"}}getRelatedPredicate(L){return L.predicate.value}createHashToRelated(L,re){const $=new Map,b=this.blankNodeInfo.get(L).quads;for(const S of b){let O,T;if("BlankNode"===S.subject.termType&&S.subject.value!==L)T=S.subject.value,O="p";else{if("BlankNode"!==S.object.termType||S.object.value===L)continue;T=S.object.value,O="r"}const v=this.hashRelatedBlankNode(T,S,re,O),y=$.get(v);y?y.push(T):$.set(v,[T])}return $}}},{"./URDNA2015Sync":52}],55:[function(K,Ae,he){"use strict";const q=K("./URDNA2015"),V=K("./URGNA2012"),L=K("./URDNA2015Sync"),re=K("./URGNA2012Sync");let $;try{$=K("rdf-canonize-native")}catch(S){}const b={};Ae.exports=b,b.NQuads=K("./NQuads"),b.IdentifierIssuer=K("./IdentifierIssuer"),b._rdfCanonizeNative=function(S){return S&&($=S),$},b.canonize=function(){var S=gt(function*(O,T){if(Array.isArray(O)||(O=b.NQuads.legacyDatasetToQuads(O)),T.useNative){if(!$)throw new Error("rdf-canonize-native not available");return new Promise((v,y)=>$.canonize(O,T,(w,D)=>w?y(w):v(D)))}if("URDNA2015"===T.algorithm)return new q(T).main(O);if("URGNA2012"===T.algorithm)return new V(T).main(O);throw"algorithm"in T?new Error("Invalid RDF Dataset Canonicalization algorithm: "+T.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(O,T){return S.apply(this,arguments)}}(),b._canonizeSync=function(S,O){if(Array.isArray(S)||(S=b.NQuads.legacyDatasetToQuads(S)),O.useNative){if($)return $.canonizeSync(S,O);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===O.algorithm)return new L(O).main(S);if("URGNA2012"===O.algorithm)return new re(O).main(S);throw"algorithm"in O?new Error("Invalid RDF Dataset Canonicalization algorithm: "+O.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(K,Ae,he){"use strict";var q=this&&this.__createBinding||(Object.create?function(L,re,$,b){void 0===b&&(b=$),Object.defineProperty(L,b,{enumerable:!0,get:function(){return re[$]}})}:function(L,re,$,b){void 0===b&&(b=$),L[b]=re[$]}),V=this&&this.__exportStar||function(L,re){for(var $ in L)"default"!==$&&!Object.prototype.hasOwnProperty.call(re,$)&&q(re,L,$)};Object.defineProperty(he,"__esModule",{value:!0}),V(K("./lib/BlankNode"),he),V(K("./lib/DataFactory"),he),V(K("./lib/DefaultGraph"),he),V(K("./lib/Literal"),he),V(K("./lib/NamedNode"),he),V(K("./lib/Quad"),he),V(K("./lib/Variable"),he)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.BlankNode=void 0;he.BlankNode=class{constructor(L){this.termType="BlankNode",this.value=L}equals(L){return!!L&&"BlankNode"===L.termType&&L.value===this.value}}},{}],58:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DataFactory=void 0;const q=K("./BlankNode"),V=K("./DefaultGraph"),L=K("./Literal"),re=K("./NamedNode"),$=K("./Quad"),b=K("./Variable");let S=0;he.DataFactory=class{constructor(v){this.blankNodeCounter=0,this.blankNodePrefix=(v=v||{}).blankNodePrefix||`df_${S++}_`}namedNode(v){return new re.NamedNode(v)}blankNode(v){return new q.BlankNode(v||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(v,y){return new L.Literal(v,y)}variable(v){return new b.Variable(v)}defaultGraph(){return V.DefaultGraph.INSTANCE}quad(v,y,w,D){return new $.Quad(v,y,w,D||this.defaultGraph())}fromTerm(v){switch(v.termType){case"NamedNode":return this.namedNode(v.value);case"BlankNode":return this.blankNode(v.value);case"Literal":return v.language?this.literal(v.value,v.language):v.datatype.equals(L.Literal.XSD_STRING)?this.literal(v.value):this.literal(v.value,this.fromTerm(v.datatype));case"Variable":return this.variable(v.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(v.subject),this.fromTerm(v.predicate),this.fromTerm(v.object),this.fromTerm(v.graph))}}fromQuad(v){return this.fromTerm(v)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DefaultGraph=void 0;class q{constructor(){this.termType="DefaultGraph",this.value=""}equals(L){return!!L&&"DefaultGraph"===L.termType}}he.DefaultGraph=q,q.INSTANCE=new q},{}],60:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Literal=void 0;const q=K("./NamedNode");class V{constructor(re,$){this.termType="Literal",this.value=re,"string"==typeof $?(this.language=$,this.datatype=V.RDF_LANGUAGE_STRING):$?(this.language="",this.datatype=$):(this.language="",this.datatype=V.XSD_STRING)}equals(re){return!!re&&"Literal"===re.termType&&re.value===this.value&&re.language===this.language&&re.datatype.equals(this.datatype)}}he.Literal=V,V.RDF_LANGUAGE_STRING=new q.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),V.XSD_STRING=new q.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.NamedNode=void 0;he.NamedNode=class{constructor(L){this.termType="NamedNode",this.value=L}equals(L){return!!L&&"NamedNode"===L.termType&&L.value===this.value}}},{}],62:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Quad=void 0;he.Quad=class{constructor(L,re,$,b){this.termType="Quad",this.value="",this.subject=L,this.predicate=re,this.object=$,this.graph=b}equals(L){return!!L&&("Quad"===L.termType||!L.termType)&&this.subject.equals(L.subject)&&this.predicate.equals(L.predicate)&&this.object.equals(L.object)&&this.graph.equals(L.graph)}}},{}],63:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Variable=void 0;he.Variable=class{constructor(L){this.termType="Variable",this.value=L}equals(L){return!!L&&"Variable"===L.termType&&L.value===this.value}}},{}],64:[function(K,Ae,he){"use strict";var q=this&&this.__createBinding||(Object.create?function(L,re,$,b){void 0===b&&(b=$),Object.defineProperty(L,b,{enumerable:!0,get:function(){return re[$]}})}:function(L,re,$,b){void 0===b&&(b=$),L[b]=re[$]}),V=this&&this.__exportStar||function(L,re){for(var $ in L)"default"!==$&&!Object.prototype.hasOwnProperty.call(re,$)&&q(re,L,$)};Object.defineProperty(he,"__esModule",{value:!0}),V(K("./lib/RdfXmlParser"),he)},{"./lib/RdfXmlParser":66}],65:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseError=void 0;class q extends Error{constructor(L,re){const $=L.saxStream._parser;super(L.trackPosition?`Line ${$.line+1} column ${$.column+1}: ${re}`:re)}}he.ParseError=q},{}],66:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseType=he.RdfXmlParser=void 0;const q=K("relative-to-absolute-iri"),V=K("sax"),L=K("stream"),re=K("./ParseError"),$=K("rdf-data-factory");class b extends L.Transform{constructor(T){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},T&&(Object.assign(this,T),this.options=T),this.dataFactory||(this.dataFactory=new $.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=V.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(T,v){const y={};let w=!1;for(const j in T.attributes)j.startsWith("xmlns")&&(5===j.length?(w=!0,y[""]=T.attributes[j]):":"===j.charAt(5)&&(w=!0,y[j.substr(6)]=T.attributes[j]));const D=v&&v.ns?v.ns:[b.DEFAULT_NS];return w?D.concat([y]):D}static expandPrefixedTerm(T,v,y){const w=T.indexOf(":");let D,j;w>=0?(D=T.substr(0,w),j=T.substr(w+1)):(D="",j=T);let I=null,H=null;for(let Y=v.length-1;Y>=0;Y--){const M=v[Y][D];if(M){I=M;break}H||(H=v[Y][""])}if(!I){if(D&&"xmlns"!==D)throw new re.ParseError(y,`The prefix '${D}' in term '${T}' was not bound.`);I=H||""}return{prefix:D,local:j,uri:I}}static isValidIri(T){return b.IRI_REGEX.test(T)}import(T){const v=new L.PassThrough({readableObjectMode:!0});T.on("error",w=>y.emit("error",w)),T.on("data",w=>v.push(w)),T.on("end",()=>v.push(null));const y=v.pipe(new b(this.options));return y}_transform(T,v,y){try{this.saxStream.write(T,v)}catch(w){return y(w)}y()}newParseError(T){return new re.ParseError(this,T)}valueToUri(T,v){return this.uriToNamedNode(q.resolve(T,v.baseIRI))}uriToNamedNode(T){if(!b.isValidIri(T))throw this.newParseError(`Invalid URI: ${T}`);return this.dataFactory.namedNode(T)}validateNcname(T){if(!b.NCNAME_MATCHER.test(T))throw this.newParseError(`Not a valid NCName: ${T}`)}attachSaxListeners(){this.saxStream.on("error",T=>this.emit("error",T)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(T){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=S.RESOURCE;if(v&&(v.hadChildren=!0,y=v.childrenParseType),v&&v.childrenStringTags){const D=T.name;let j="";for(const M in T.attributes)j+=` ${M}="${T.attributes[M]}"`;v.childrenStringTags.push(`<${D}${j}>`);const Y={childrenStringTags:v.childrenStringTags};return Y.childrenStringEmitClosingTag=`</${D}>`,void this.activeTagStack.push(Y)}const w={};v?(w.language=v.language,w.baseIRI=v.baseIRI):w.baseIRI=this.baseIRI,this.activeTagStack.push(w),w.ns=b.parseNamespace(T,v),y===S.RESOURCE?this.onTagResource(T,w,v,!v):this.onTagProperty(T,w,v)}onTagResource(T,v,y,w){const D=b.expandPrefixedTerm(T.name,v.ns,this);v.childrenParseType=S.PROPERTY;let j=!0;if(D.uri===b.RDF){if(!w&&b.FORBIDDEN_NODE_ELEMENTS.indexOf(D.local)>=0)throw this.newParseError(`Illegal node element name: ${D.local}`);switch(D.local){case"RDF":v.childrenParseType=S.RESOURCE;case"Description":j=!1}}const I=[],H=[];let Y=null,M=!1,F=!1,Q=null;for(const E in T.attributes){const U=T.attributes[E],ie=b.expandPrefixedTerm(E,v.ns,this);if(y&&ie.uri===b.RDF)switch(ie.local){case"about":if(Y)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${U} and ${Y} where found.`);Y=U;continue;case"ID":if(Y)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${U} and ${Y} where found.`);this.validateNcname(U),Y="#"+U,M=!0;continue;case"nodeID":if(Y)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${U} and ${Y} where found.`);this.validateNcname(U),Y=U,F=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":Q=U;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(ie.uri===b.XML){if("lang"===ie.local){v.language=""===U?null:U.toLowerCase();continue}if("base"===ie.local){v.baseIRI=q.resolve(U,v.baseIRI);continue}}"xml"!==ie.prefix&&ie.uri&&(I.push(this.uriToNamedNode(ie.uri+ie.local)),H.push(U))}if(null!==Y&&(v.subject=F?this.dataFactory.blankNode(Y):this.valueToUri(Y,v),M&&this.claimNodeId(v.subject)),v.subject||(v.subject=this.dataFactory.blankNode()),j){const E=this.uriToNamedNode(D.uri+D.local);this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),E,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const E=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,E,y.reifiedStatementId),this.emitTriple(E,this.dataFactory.namedNode(b.RDF+"first"),v.subject,v.reifiedStatementId),y.childrenCollectionSubject=E,y.childrenCollectionPredicate=this.dataFactory.namedNode(b.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,v.subject,y.reifiedStatementId);for(let E=0;E<y.predicateSubPredicates.length;E++)this.emitTriple(v.subject,y.predicateSubPredicates[E],y.predicateSubObjects[E],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let E=0;E<I.length;E++){const U=this.dataFactory.literal(H[E],v.datatype||v.language);this.emitTriple(v.subject,I[E],U,y.reifiedStatementId)}Q&&this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),this.uriToNamedNode(Q),null)}}onTagProperty(T,v,y){const w=b.expandPrefixedTerm(T.name,v.ns,this);if(v.childrenParseType=S.RESOURCE,v.subject=y.subject,w.uri===b.RDF&&"li"===w.local?(y.listItemCounter||(y.listItemCounter=1),v.predicate=this.uriToNamedNode(w.uri+"_"+y.listItemCounter++)):v.predicate=this.uriToNamedNode(w.uri+w.local),w.uri===b.RDF&&b.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(w.local)>=0)throw this.newParseError(`Illegal property element name: ${w.local}`);v.predicateSubPredicates=[],v.predicateSubObjects=[];let D=!1,j=!1,I=null,H=!0;const Y=[],M=[];for(const F in T.attributes){const Q=T.attributes[F],E=b.expandPrefixedTerm(F,v.ns,this);if(E.uri===b.RDF)switch(E.local){case"resource":if(I)throw this.newParseError(`Found both rdf:resource (${Q}) and rdf:nodeID (${I}).`);if(D)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${Q})`);v.hadChildren=!0,I=Q,H=!1;continue;case"datatype":if(j)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${Q}).`);if(D)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${Q})`);v.datatype=this.valueToUri(Q,v);continue;case"nodeID":if(j)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${Q}).`);if(v.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${Q}).`);if(D)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${Q})`);this.validateNcname(Q),v.hadChildren=!0,I=Q,H=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(j)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(v.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${v.datatype.value})`);if(I)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${I})`);if("Resource"===Q){D=!0,v.childrenParseType=S.PROPERTY;const U=this.dataFactory.blankNode();this.emitTriple(v.subject,v.predicate,U,v.reifiedStatementId),v.subject=U,v.predicate=null}else"Collection"===Q?(D=!0,v.hadChildren=!0,v.childrenCollectionSubject=v.subject,v.childrenCollectionPredicate=v.predicate,H=!1):"Literal"===Q&&(D=!0,v.childrenTagsToString=!0,v.childrenStringTags=[]);continue;case"ID":this.validateNcname(Q),v.reifiedStatementId=this.valueToUri("#"+Q,v),this.claimNodeId(v.reifiedStatementId);continue}else if(E.uri===b.XML&&"lang"===E.local){v.language=""===Q?null:Q.toLowerCase();continue}if("xml"!==E.prefix&&"xmlns"!==E.prefix&&E.uri){if(D||v.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${Q}`);v.hadChildren=!0,j=!0,Y.push(this.uriToNamedNode(E.uri+E.local)),M.push(this.dataFactory.literal(Q,v.datatype||v.language))}}if(null!==I){const F=v.subject;v.subject=H?this.dataFactory.blankNode(I):this.valueToUri(I,v),this.emitTriple(F,v.predicate,v.subject,v.reifiedStatementId);for(let Q=0;Q<Y.length;Q++)this.emitTriple(v.subject,Y[Q],M[Q],null);v.predicateEmitted=!0}else H&&(v.predicateSubPredicates=Y,v.predicateSubObjects=M,v.predicateEmitted=!1)}emitTriple(T,v,y,w){this.push(this.dataFactory.quad(T,v,y,this.defaultGraph)),w&&(this.push(this.dataFactory.quad(w,this.dataFactory.namedNode(b.RDF+"type"),this.dataFactory.namedNode(b.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(w,this.dataFactory.namedNode(b.RDF+"subject"),T,this.defaultGraph)),this.push(this.dataFactory.quad(w,this.dataFactory.namedNode(b.RDF+"predicate"),v,this.defaultGraph)),this.push(this.dataFactory.quad(w,this.dataFactory.namedNode(b.RDF+"object"),y,this.defaultGraph)))}claimNodeId(T){if(!this.allowDuplicateRdfIds){if(this.nodeIds[T.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${T.value}'.`);this.nodeIds[T.value]=!0}}onText(T){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;v&&(v.childrenStringTags?v.childrenStringTags.push(T):v.predicate&&(v.text=T))}onCloseTag(){const T=this.activeTagStack.pop();if(T.childrenStringEmitClosingTag&&T.childrenStringTags.push(T.childrenStringEmitClosingTag),T.childrenTagsToString&&(T.datatype=this.dataFactory.namedNode(b.RDF+"XMLLiteral"),T.text=T.childrenStringTags.join(""),T.hadChildren=!1),T.childrenCollectionSubject)this.emitTriple(T.childrenCollectionSubject,T.childrenCollectionPredicate,this.dataFactory.namedNode(b.RDF+"nil"),T.reifiedStatementId);else if(T.predicate)if(T.hadChildren||T.childrenParseType===S.PROPERTY){if(!T.predicateEmitted){const v=this.dataFactory.blankNode();this.emitTriple(T.subject,T.predicate,v,T.reifiedStatementId);for(let y=0;y<T.predicateSubPredicates.length;y++)this.emitTriple(v,T.predicateSubPredicates[y],T.predicateSubObjects[y],null)}}else this.emitTriple(T.subject,T.predicate,this.dataFactory.literal(T.text||"",T.datatype||T.language),T.reifiedStatementId)}onDoctype(T){T.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(v,y,w)=>(this.saxStream._parser.ENTITIES[y]=w,""))}}var S,O;he.RdfXmlParser=b,b.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,b.MIME_TYPE="application/rdf+xml",b.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",b.XML="http://www.w3.org/XML/1998/namespace",b.XMLNS="http://www.w3.org/2000/xmlns/",b.DEFAULT_NS={xml:b.XML},b.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],b.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],b.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(O=S=he.ParseType||(he.ParseType={}))[O.RESOURCE=0]="RESOURCE",O[O.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(K,Ae,he){"use strict";var V={};function L(O,T,v){v||(v=Error);var w=function(D){function j(I,H,Y){return D.call(this,function(D,j,I){return"string"==typeof T?T:T(D,j,I)}(I,H,Y))||this}return function(O,T){O.prototype=Object.create(T.prototype),O.prototype.constructor=O,O.__proto__=T}(j,D),j}(v);w.prototype.name=v.name,w.prototype.code=O,V[O]=w}function re(O,T){if(Array.isArray(O)){var v=O.length;return O=O.map(function(y){return String(y)}),v>2?"one of ".concat(T," ").concat(O.slice(0,v-1).join(", "),", or ")+O[v-1]:2===v?"one of ".concat(T," ").concat(O[0]," or ").concat(O[1]):"of ".concat(T," ").concat(O[0])}return"of ".concat(T," ").concat(String(O))}L("ERR_INVALID_OPT_VALUE",function(O,T){return'The value "'+T+'" is invalid for option "'+O+'"'},TypeError),L("ERR_INVALID_ARG_TYPE",function(O,T,v){var y,w;if("string"==typeof T&&function(O,T,v){return O.substr(!v||v<0?0:+v,T.length)===T}(T,"not ")?(y="must not be",T=T.replace(/^not /,"")):y="must be",function(O,T,v){return(void 0===v||v>O.length)&&(v=O.length),O.substring(v-T.length,v)===T}(O," argument"))w="The ".concat(O," ").concat(y," ").concat(re(T,"type"));else{var D=function(O,T,v){return"number"!=typeof v&&(v=0),!(v+T.length>O.length)&&-1!==O.indexOf(T,v)}(O,".")?"property":"argument";w='The "'.concat(O,'" ').concat(D," ").concat(y," ").concat(re(T,"type"))}return w+". Received type ".concat(typeof v)},TypeError),L("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),L("ERR_METHOD_NOT_IMPLEMENTED",function(O){return"The "+O+" method is not implemented"}),L("ERR_STREAM_PREMATURE_CLOSE","Premature close"),L("ERR_STREAM_DESTROYED",function(O){return"Cannot call "+O+" after a stream was destroyed"}),L("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),L("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),L("ERR_STREAM_WRITE_AFTER_END","write after end"),L("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),L("ERR_UNKNOWN_ENCODING",function(O){return"Unknown encoding: "+O},TypeError),L("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Ae.exports.codes=V},{}],68:[function(K,Ae,he){(function(q){(function(){"use strict";var V=Object.keys||function(y){var w=[];for(var D in y)w.push(D);return w};Ae.exports=O;var L=K("./_stream_readable"),re=K("./_stream_writable");K("inherits")(O,L);for(var $=V(re.prototype),b=0;b<$.length;b++){var S=$[b];O.prototype[S]||(O.prototype[S]=re.prototype[S])}function O(y){if(!(this instanceof O))return new O(y);L.call(this,y),re.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",T)))}function T(){this._writableState.ended||q.nextTick(v,this)}function v(y){y.end()}Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(w){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=w,this._writableState.destroyed=w)}})}).call(this)}).call(this,K("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(K,Ae,he){"use strict";Ae.exports=V;var q=K("./_stream_transform");function V(L){if(!(this instanceof V))return new V(L);q.call(this,L)}K("inherits")(V,q),V.prototype._transform=function(L,re,$){$(null,L)}},{"./_stream_transform":71,inherits:10}],70:[function(K,Ae,he){(function(q,V){(function(){"use strict";var L;Ae.exports=te,te.ReadableState=me,K("events");var $=function(B,R){return B.listeners(R).length},b=K("./internal/streams/stream"),S=K("buffer").Buffer,O=V.Uint8Array||function(){};var w,y=K("util");w=y&&y.debuglog?y.debuglog("stream"):function(){};var U,ie,ue,D=K("./internal/streams/buffer_list"),j=K("./internal/streams/destroy"),H=K("./internal/streams/state").getHighWaterMark,Y=K("../errors").codes,M=Y.ERR_INVALID_ARG_TYPE,F=Y.ERR_STREAM_PUSH_AFTER_EOF,Q=Y.ERR_METHOD_NOT_IMPLEMENTED,E=Y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;K("inherits")(te,b);var ee=j.errorOrDestroy,se=["error","close","destroy","pause","resume"];function me(fe,B,R){L=L||K("./_stream_duplex"),"boolean"!=typeof R&&(R=B instanceof L),this.objectMode=!!(fe=fe||{}).objectMode,R&&(this.objectMode=this.objectMode||!!fe.readableObjectMode),this.highWaterMark=H(this,fe,"readableHighWaterMark",R),this.buffer=new D,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==fe.emitClose,this.autoDestroy=!!fe.autoDestroy,this.destroyed=!1,this.defaultEncoding=fe.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,fe.encoding&&(U||(U=K("string_decoder/").StringDecoder),this.decoder=new U(fe.encoding),this.encoding=fe.encoding)}function te(fe){if(L=L||K("./_stream_duplex"),!(this instanceof te))return new te(fe);this._readableState=new me(fe,this,this instanceof L),this.readable=!0,fe&&("function"==typeof fe.read&&(this._read=fe.read),"function"==typeof fe.destroy&&(this._destroy=fe.destroy)),b.call(this)}function ye(fe,B,R,k,Oe){w("readableAddChunk",B);var yt,Xe=fe._readableState;if(null===B)Xe.reading=!1,function(fe,B){if(w("onEofChunk"),!B.ended){if(B.decoder){var R=B.decoder.end();R&&R.length&&(B.buffer.push(R),B.length+=B.objectMode?1:R.length)}B.ended=!0,B.sync?je(fe):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,Le(fe)))}}(fe,Xe);else if(Oe||(yt=function(fe,B){var R;return!function(fe){return S.isBuffer(fe)||fe instanceof O}(B)&&"string"!=typeof B&&void 0!==B&&!fe.objectMode&&(R=new M("chunk",["string","Buffer","Uint8Array"],B)),R}(Xe,B)),yt)ee(fe,yt);else if(Xe.objectMode||B&&B.length>0)if("string"!=typeof B&&!Xe.objectMode&&Object.getPrototypeOf(B)!==S.prototype&&(B=function(fe){return S.from(fe)}(B)),k)Xe.endEmitted?ee(fe,new E):Me(fe,Xe,B,!0);else if(Xe.ended)ee(fe,new F);else{if(Xe.destroyed)return!1;Xe.reading=!1,Xe.decoder&&!R?(B=Xe.decoder.write(B),Xe.objectMode||0!==B.length?Me(fe,Xe,B,!1):Ee(fe,Xe)):Me(fe,Xe,B,!1)}else k||(Xe.reading=!1,Ee(fe,Xe));return!Xe.ended&&(Xe.length<Xe.highWaterMark||0===Xe.length)}function Me(fe,B,R,k){B.flowing&&0===B.length&&!B.sync?(B.awaitDrain=0,fe.emit("data",R)):(B.length+=B.objectMode?1:R.length,k?B.buffer.unshift(R):B.buffer.push(R),B.needReadable&&je(fe)),Ee(fe,B)}Object.defineProperty(te.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(B){!this._readableState||(this._readableState.destroyed=B)}}),te.prototype.destroy=j.destroy,te.prototype._undestroy=j.undestroy,te.prototype._destroy=function(fe,B){B(fe)},te.prototype.push=function(fe,B){var k,R=this._readableState;return R.objectMode?k=!0:"string"==typeof fe&&((B=B||R.defaultEncoding)!==R.encoding&&(fe=S.from(fe,B),B=""),k=!0),ye(this,fe,B,!1,k)},te.prototype.unshift=function(fe){return ye(this,fe,null,!0,!1)},te.prototype.isPaused=function(){return!1===this._readableState.flowing},te.prototype.setEncoding=function(fe){U||(U=K("string_decoder/").StringDecoder);var B=new U(fe);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var R=this._readableState.buffer.head,k="";null!==R;)k+=B.write(R.data),R=R.next;return this._readableState.buffer.clear(),""!==k&&this._readableState.buffer.push(k),this._readableState.length=k.length,this};var nt=1073741824;function Je(fe,B){return fe<=0||0===B.length&&B.ended?0:B.objectMode?1:fe!=fe?B.flowing&&B.length?B.buffer.head.data.length:B.length:(fe>B.highWaterMark&&(B.highWaterMark=function(fe){return fe>=nt?fe=nt:(fe--,fe|=fe>>>1,fe|=fe>>>2,fe|=fe>>>4,fe|=fe>>>8,fe|=fe>>>16,fe++),fe}(fe)),fe<=B.length?fe:B.ended?B.length:(B.needReadable=!0,0))}function je(fe){var B=fe._readableState;w("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(w("emitReadable",B.flowing),B.emittedReadable=!0,q.nextTick(Le,fe))}function Le(fe){var B=fe._readableState;w("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(fe.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,be(fe)}function Ee(fe,B){B.readingMore||(B.readingMore=!0,q.nextTick(Re,fe,B))}function Re(fe,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&0===B.length);){var R=B.length;if(w("maybeReadMore read 0"),fe.read(0),R===B.length)break}B.readingMore=!1}function qe(fe){var B=fe._readableState;B.readableListening=fe.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:fe.listenerCount("data")>0&&fe.resume()}function Be(fe){w("readable nexttick read 0"),fe.read(0)}function X(fe,B){w("resume",B.reading),B.reading||fe.read(0),B.resumeScheduled=!1,fe.emit("resume"),be(fe),B.flowing&&!B.reading&&fe.read(0)}function be(fe){var B=fe._readableState;for(w("flow",B.flowing);B.flowing&&null!==fe.read(););}function ce(fe,B){return 0===B.length?null:(B.objectMode?R=B.buffer.shift():!fe||fe>=B.length?(R=B.decoder?B.buffer.join(""):1===B.buffer.length?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):R=B.buffer.consume(fe,B.decoder),R);var R}function Pe(fe){var B=fe._readableState;w("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,q.nextTick(wt,B,fe))}function wt(fe,B){if(w("endReadableNT",fe.endEmitted,fe.length),!fe.endEmitted&&0===fe.length&&(fe.endEmitted=!0,B.readable=!1,B.emit("end"),fe.autoDestroy)){var R=B._writableState;(!R||R.autoDestroy&&R.finished)&&B.destroy()}}function pt(fe,B){for(var R=0,k=fe.length;R<k;R++)if(fe[R]===B)return R;return-1}te.prototype.read=function(fe){w("read",fe),fe=parseInt(fe,10);var B=this._readableState,R=fe;if(0!==fe&&(B.emittedReadable=!1),0===fe&&B.needReadable&&((0!==B.highWaterMark?B.length>=B.highWaterMark:B.length>0)||B.ended))return w("read: emitReadable",B.length,B.ended),0===B.length&&B.ended?Pe(this):je(this),null;if(0===(fe=Je(fe,B))&&B.ended)return 0===B.length&&Pe(this),null;var Oe,k=B.needReadable;return w("need readable",k),(0===B.length||B.length-fe<B.highWaterMark)&&w("length less than watermark",k=!0),B.ended||B.reading?w("reading or ended",k=!1):k&&(w("do read"),B.reading=!0,B.sync=!0,0===B.length&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(fe=Je(R,B))),null===(Oe=fe>0?ce(fe,B):null)?(B.needReadable=B.length<=B.highWaterMark,fe=0):(B.length-=fe,B.awaitDrain=0),0===B.length&&(B.ended||(B.needReadable=!0),R!==fe&&B.ended&&Pe(this)),null!==Oe&&this.emit("data",Oe),Oe},te.prototype._read=function(fe){ee(this,new Q("_read()"))},te.prototype.pipe=function(fe,B){var R=this,k=this._readableState;switch(k.pipesCount){case 0:k.pipes=fe;break;case 1:k.pipes=[k.pipes,fe];break;default:k.pipes.push(fe)}k.pipesCount+=1,w("pipe count=%d opts=%j",k.pipesCount,B);var Xe=B&&!1===B.end||fe===q.stdout||fe===q.stderr?cs:It;function yt(Ps,Gr){w("onunpipe"),Ps===R&&Gr&&!1===Gr.hasUnpiped&&(Gr.hasUnpiped=!0,w("cleanup"),fe.removeListener("close",Hr),fe.removeListener("finish",Ns),fe.removeListener("drain",Tn),fe.removeListener("error",hi),fe.removeListener("unpipe",yt),R.removeListener("end",It),R.removeListener("end",cs),R.removeListener("data",yi),Pn=!0,k.awaitDrain&&(!fe._writableState||fe._writableState.needDrain)&&Tn())}function It(){w("onend"),fe.end()}k.endEmitted?q.nextTick(Xe):R.once("end",Xe),fe.on("unpipe",yt);var Tn=function(fe){return function(){var R=fe._readableState;w("pipeOnDrain",R.awaitDrain),R.awaitDrain&&R.awaitDrain--,0===R.awaitDrain&&$(fe,"data")&&(R.flowing=!0,be(fe))}}(R);fe.on("drain",Tn);var Pn=!1;function yi(Ps){w("ondata");var Gr=fe.write(Ps);w("dest.write",Gr),!1===Gr&&((1===k.pipesCount&&k.pipes===fe||k.pipesCount>1&&-1!==pt(k.pipes,fe))&&!Pn&&(w("false write response, pause",k.awaitDrain),k.awaitDrain++),R.pause())}function hi(Ps){w("onerror",Ps),cs(),fe.removeListener("error",hi),0===$(fe,"error")&&ee(fe,Ps)}function Hr(){fe.removeListener("finish",Ns),cs()}function Ns(){w("onfinish"),fe.removeListener("close",Hr),cs()}function cs(){w("unpipe"),R.unpipe(fe)}return R.on("data",yi),function(fe,B,R){if("function"==typeof fe.prependListener)return fe.prependListener(B,R);fe._events&&fe._events[B]?Array.isArray(fe._events[B])?fe._events[B].unshift(R):fe._events[B]=[R,fe._events[B]]:fe.on(B,R)}(fe,"error",hi),fe.once("close",Hr),fe.once("finish",Ns),fe.emit("pipe",R),k.flowing||(w("pipe resume"),R.resume()),fe},te.prototype.unpipe=function(fe){var B=this._readableState,R={hasUnpiped:!1};if(0===B.pipesCount)return this;if(1===B.pipesCount)return fe&&fe!==B.pipes||(fe||(fe=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,fe&&fe.emit("unpipe",this,R)),this;if(!fe){var k=B.pipes,Oe=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var Xe=0;Xe<Oe;Xe++)k[Xe].emit("unpipe",this,{hasUnpiped:!1});return this}var yt=pt(B.pipes,fe);return-1===yt||(B.pipes.splice(yt,1),B.pipesCount-=1,1===B.pipesCount&&(B.pipes=B.pipes[0]),fe.emit("unpipe",this,R)),this},te.prototype.addListener=te.prototype.on=function(fe,B){var R=b.prototype.on.call(this,fe,B),k=this._readableState;return"data"===fe?(k.readableListening=this.listenerCount("readable")>0,!1!==k.flowing&&this.resume()):"readable"===fe&&!k.endEmitted&&!k.readableListening&&(k.readableListening=k.needReadable=!0,k.flowing=!1,k.emittedReadable=!1,w("on readable",k.length,k.reading),k.length?je(this):k.reading||q.nextTick(Be,this)),R},te.prototype.removeListener=function(fe,B){var R=b.prototype.removeListener.call(this,fe,B);return"readable"===fe&&q.nextTick(qe,this),R},te.prototype.removeAllListeners=function(fe){var B=b.prototype.removeAllListeners.apply(this,arguments);return("readable"===fe||void 0===fe)&&q.nextTick(qe,this),B},te.prototype.resume=function(){var fe=this._readableState;return fe.flowing||(w("resume"),fe.flowing=!fe.readableListening,function(fe,B){B.resumeScheduled||(B.resumeScheduled=!0,q.nextTick(X,fe,B))}(this,fe)),fe.paused=!1,this},te.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},te.prototype.wrap=function(fe){var B=this,R=this._readableState,k=!1;for(var Oe in fe.on("end",function(){if(w("wrapped end"),R.decoder&&!R.ended){var yt=R.decoder.end();yt&&yt.length&&B.push(yt)}B.push(null)}),fe.on("data",function(yt){w("wrapped data"),R.decoder&&(yt=R.decoder.write(yt)),R.objectMode&&null==yt||!(R.objectMode||yt&&yt.length)||B.push(yt)||(k=!0,fe.pause())}),fe)void 0===this[Oe]&&"function"==typeof fe[Oe]&&(this[Oe]=function(It){return function(){return fe[It].apply(fe,arguments)}}(Oe));for(var Xe=0;Xe<se.length;Xe++)fe.on(se[Xe],this.emit.bind(this,se[Xe]));return this._read=function(yt){w("wrapped _read",yt),k&&(k=!1,fe.resume())},this},"function"==typeof Symbol&&(te.prototype[Symbol.asyncIterator]=function(){return void 0===ie&&(ie=K("./internal/streams/async_iterator")),ie(this)}),Object.defineProperty(te.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(te.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(te.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),te._fromList=ce,Object.defineProperty(te.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(te.from=function(fe,B){return void 0===ue&&(ue=K("./internal/streams/from")),ue(te,fe,B)})}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(K,Ae,he){"use strict";Ae.exports=O;var q=K("../errors").codes,V=q.ERR_METHOD_NOT_IMPLEMENTED,L=q.ERR_MULTIPLE_CALLBACK,re=q.ERR_TRANSFORM_ALREADY_TRANSFORMING,$=q.ERR_TRANSFORM_WITH_LENGTH_0,b=K("./_stream_duplex");function S(y,w){var D=this._transformState;D.transforming=!1;var j=D.writecb;if(null===j)return this.emit("error",new L);D.writechunk=null,D.writecb=null,null!=w&&this.push(w),j(y);var I=this._readableState;I.reading=!1,(I.needReadable||I.length<I.highWaterMark)&&this._read(I.highWaterMark)}function O(y){if(!(this instanceof O))return new O(y);b.call(this,y),this._transformState={afterTransform:S.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",T)}function T(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?v(this,null,null):this._flush(function(w,D){v(y,w,D)})}function v(y,w,D){if(w)return y.emit("error",w);if(null!=D&&y.push(D),y._writableState.length)throw new $;if(y._transformState.transforming)throw new re;return y.push(null)}K("inherits")(O,b),O.prototype.push=function(y,w){return this._transformState.needTransform=!1,b.prototype.push.call(this,y,w)},O.prototype._transform=function(y,w,D){D(new V("_transform()"))},O.prototype._write=function(y,w,D){var j=this._transformState;if(j.writecb=D,j.writechunk=y,j.writeencoding=w,!j.transforming){var I=this._readableState;(j.needTransform||I.needReadable||I.length<I.highWaterMark)&&this._read(I.highWaterMark)}},O.prototype._read=function(y){var w=this._transformState;null===w.writechunk||w.transforming?w.needTransform=!0:(w.transforming=!0,this._transform(w.writechunk,w.writeencoding,w.afterTransform))},O.prototype._destroy=function(y,w){b.prototype._destroy.call(this,y,function(D){w(D)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(K,Ae,he){(function(q,V){(function(){"use strict";function re(be){var ce=this;this.next=null,this.entry=null,this.finish=function(){!function(be,ce,Pe){var wt=be.entry;for(be.entry=null;wt;){var pt=wt.callback;ce.pendingcb--,pt(Pe),wt=wt.next}ce.corkedRequestsFree.next=be}(ce,be)}}var $;Ae.exports=me,me.WritableState=se;var b={deprecate:K("util-deprecate")},S=K("./internal/streams/stream"),O=K("buffer").Buffer,T=V.Uint8Array||function(){};var Te,w=K("./internal/streams/destroy"),j=K("./internal/streams/state").getHighWaterMark,I=K("../errors").codes,H=I.ERR_INVALID_ARG_TYPE,Y=I.ERR_METHOD_NOT_IMPLEMENTED,M=I.ERR_MULTIPLE_CALLBACK,F=I.ERR_STREAM_CANNOT_PIPE,Q=I.ERR_STREAM_DESTROYED,E=I.ERR_STREAM_NULL_VALUES,U=I.ERR_STREAM_WRITE_AFTER_END,ie=I.ERR_UNKNOWN_ENCODING,ue=w.errorOrDestroy;function ee(){}function se(be,ce,Pe){$=$||K("./_stream_duplex"),"boolean"!=typeof Pe&&(Pe=ce instanceof $),this.objectMode=!!(be=be||{}).objectMode,Pe&&(this.objectMode=this.objectMode||!!be.writableObjectMode),this.highWaterMark=j(this,be,"writableHighWaterMark",Pe),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===be.decodeStrings),this.defaultEncoding=be.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){!function(be,ce){var Pe=be._writableState,wt=Pe.sync,pt=Pe.writecb;if("function"!=typeof pt)throw new M;if(function(be){be.writing=!1,be.writecb=null,be.length-=be.writelen,be.writelen=0}(Pe),ce)!function(be,ce,Pe,wt,pt){--ce.pendingcb,Pe?(q.nextTick(pt,wt),q.nextTick(Be,be,ce),be._writableState.errorEmitted=!0,ue(be,wt)):(pt(wt),be._writableState.errorEmitted=!0,ue(be,wt),Be(be,ce))}(be,Pe,wt,ce,pt);else{var fe=Re(Pe)||be.destroyed;!fe&&!Pe.corked&&!Pe.bufferProcessing&&Pe.bufferedRequest&&Ee(be,Pe),wt?q.nextTick(je,be,Pe,fe,pt):je(be,Pe,fe,pt)}}(ce,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==be.emitClose,this.autoDestroy=!!be.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new re(this)}function me(be){var ce=this instanceof($=$||K("./_stream_duplex"));if(!ce&&!Te.call(me,this))return new me(be);this._writableState=new se(be,this,ce),this.writable=!0,be&&("function"==typeof be.write&&(this._write=be.write),"function"==typeof be.writev&&(this._writev=be.writev),"function"==typeof be.destroy&&(this._destroy=be.destroy),"function"==typeof be.final&&(this._final=be.final)),S.call(this)}function Ve(be,ce,Pe,wt,pt,fe){if(!Pe){var B=function(be,ce,Pe){return!be.objectMode&&!1!==be.decodeStrings&&"string"==typeof ce&&(ce=O.from(ce,Pe)),ce}(ce,wt,pt);wt!==B&&(Pe=!0,pt="buffer",wt=B)}var R=ce.objectMode?1:wt.length;ce.length+=R;var k=ce.length<ce.highWaterMark;if(k||(ce.needDrain=!0),ce.writing||ce.corked){var Oe=ce.lastBufferedRequest;ce.lastBufferedRequest={chunk:wt,encoding:pt,isBuf:Pe,callback:fe,next:null},Oe?Oe.next=ce.lastBufferedRequest:ce.bufferedRequest=ce.lastBufferedRequest,ce.bufferedRequestCount+=1}else nt(be,ce,!1,R,wt,pt,fe);return k}function nt(be,ce,Pe,wt,pt,fe,B){ce.writelen=wt,ce.writecb=B,ce.writing=!0,ce.sync=!0,ce.destroyed?ce.onwrite(new Q("write")):Pe?be._writev(pt,ce.onwrite):be._write(pt,fe,ce.onwrite),ce.sync=!1}function je(be,ce,Pe,wt){Pe||function(be,ce){0===ce.length&&ce.needDrain&&(ce.needDrain=!1,be.emit("drain"))}(be,ce),ce.pendingcb--,wt(),Be(be,ce)}function Ee(be,ce){ce.bufferProcessing=!0;var Pe=ce.bufferedRequest;if(be._writev&&Pe&&Pe.next){var pt=new Array(ce.bufferedRequestCount),fe=ce.corkedRequestsFree;fe.entry=Pe;for(var B=0,R=!0;Pe;)pt[B]=Pe,Pe.isBuf||(R=!1),Pe=Pe.next,B+=1;pt.allBuffers=R,nt(be,ce,!0,ce.length,pt,"",fe.finish),ce.pendingcb++,ce.lastBufferedRequest=null,fe.next?(ce.corkedRequestsFree=fe.next,fe.next=null):ce.corkedRequestsFree=new re(ce),ce.bufferedRequestCount=0}else{for(;Pe;){var k=Pe.chunk;if(nt(be,ce,!1,ce.objectMode?1:k.length,k,Pe.encoding,Pe.callback),Pe=Pe.next,ce.bufferedRequestCount--,ce.writing)break}null===Pe&&(ce.lastBufferedRequest=null)}ce.bufferedRequest=Pe,ce.bufferProcessing=!1}function Re(be){return be.ending&&0===be.length&&null===be.bufferedRequest&&!be.finished&&!be.writing}function Ue(be,ce){be._final(function(Pe){ce.pendingcb--,Pe&&ue(be,Pe),ce.prefinished=!0,be.emit("prefinish"),Be(be,ce)})}function Be(be,ce){var Pe=Re(ce);if(Pe&&(function(be,ce){!ce.prefinished&&!ce.finalCalled&&("function"!=typeof be._final||ce.destroyed?(ce.prefinished=!0,be.emit("prefinish")):(ce.pendingcb++,ce.finalCalled=!0,q.nextTick(Ue,be,ce)))}(be,ce),0===ce.pendingcb&&(ce.finished=!0,be.emit("finish"),ce.autoDestroy))){var wt=be._readableState;(!wt||wt.autoDestroy&&wt.endEmitted)&&be.destroy()}return Pe}K("inherits")(me,S),se.prototype.getBuffer=function(){for(var ce=this.bufferedRequest,Pe=[];ce;)Pe.push(ce),ce=ce.next;return Pe},function(){try{Object.defineProperty(se.prototype,"buffer",{get:b.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(be){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Te=Function.prototype[Symbol.hasInstance],Object.defineProperty(me,Symbol.hasInstance,{value:function(ce){return!!Te.call(this,ce)||this===me&&ce&&ce._writableState instanceof se}})):Te=function(ce){return ce instanceof this},me.prototype.pipe=function(){ue(this,new F)},me.prototype.write=function(be,ce,Pe){var wt=this._writableState,pt=!1,fe=!wt.objectMode&&function(be){return O.isBuffer(be)||be instanceof T}(be);return fe&&!O.isBuffer(be)&&(be=function(be){return O.from(be)}(be)),"function"==typeof ce&&(Pe=ce,ce=null),fe?ce="buffer":ce||(ce=wt.defaultEncoding),"function"!=typeof Pe&&(Pe=ee),wt.ending?function(be,ce){var Pe=new U;ue(be,Pe),q.nextTick(ce,Pe)}(this,Pe):(fe||function(be,ce,Pe,wt){var pt;return null===Pe?pt=new E:"string"!=typeof Pe&&!ce.objectMode&&(pt=new H("chunk",["string","Buffer"],Pe)),!pt||(ue(be,pt),q.nextTick(wt,pt),!1)}(this,wt,be,Pe))&&(wt.pendingcb++,pt=Ve(this,wt,fe,be,ce,Pe)),pt},me.prototype.cork=function(){this._writableState.corked++},me.prototype.uncork=function(){var be=this._writableState;be.corked&&(be.corked--,!be.writing&&!be.corked&&!be.bufferProcessing&&be.bufferedRequest&&Ee(this,be))},me.prototype.setDefaultEncoding=function(ce){if("string"==typeof ce&&(ce=ce.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ce+"").toLowerCase())>-1))throw new ie(ce);return this._writableState.defaultEncoding=ce,this},Object.defineProperty(me.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(me.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),me.prototype._write=function(be,ce,Pe){Pe(new Y("_write()"))},me.prototype._writev=null,me.prototype.end=function(be,ce,Pe){var wt=this._writableState;return"function"==typeof be?(Pe=be,be=null,ce=null):"function"==typeof ce&&(Pe=ce,ce=null),null!=be&&this.write(be,ce),wt.corked&&(wt.corked=1,this.uncork()),wt.ending||function(be,ce,Pe){ce.ending=!0,Be(be,ce),Pe&&(ce.finished?q.nextTick(Pe):be.once("finish",Pe)),ce.ended=!0,be.writable=!1}(this,wt,Pe),this},Object.defineProperty(me.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(me.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(ce){!this._writableState||(this._writableState.destroyed=ce)}}),me.prototype.destroy=w.destroy,me.prototype._undestroy=w.undestroy,me.prototype._destroy=function(be,ce){ce(be)}}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(K,Ae,he){(function(q){(function(){"use strict";var V;function L(F,Q,E){return Q in F?Object.defineProperty(F,Q,{value:E,enumerable:!0,configurable:!0,writable:!0}):F[Q]=E,F}var re=K("./end-of-stream"),$=Symbol("lastResolve"),b=Symbol("lastReject"),S=Symbol("error"),O=Symbol("ended"),T=Symbol("lastPromise"),v=Symbol("handlePromise"),y=Symbol("stream");function w(F,Q){return{value:F,done:Q}}function D(F){var Q=F[$];if(null!==Q){var E=F[y].read();null!==E&&(F[T]=null,F[$]=null,F[b]=null,Q(w(E,!1)))}}function j(F){q.nextTick(D,F)}var H=Object.getPrototypeOf(function(){}),Y=Object.setPrototypeOf((L(V={get stream(){return this[y]},next:function(){var Q=this,E=this[S];if(null!==E)return Promise.reject(E);if(this[O])return Promise.resolve(w(void 0,!0));if(this[y].destroyed)return new Promise(function(ee,se){q.nextTick(function(){Q[S]?se(Q[S]):ee(w(void 0,!0))})});var ie,U=this[T];if(U)ie=new Promise(function(F,Q){return function(E,U){F.then(function(){Q[O]?E(w(void 0,!0)):Q[v](E,U)},U)}}(U,this));else{var ue=this[y].read();if(null!==ue)return Promise.resolve(w(ue,!1));ie=new Promise(this[v])}return this[T]=ie,ie}},Symbol.asyncIterator,function(){return this}),L(V,"return",function(){var Q=this;return new Promise(function(E,U){Q[y].destroy(null,function(ie){ie?U(ie):E(w(void 0,!0))})})}),V),H);Ae.exports=function(Q){var E,U=Object.create(Y,(L(E={},y,{value:Q,writable:!0}),L(E,$,{value:null,writable:!0}),L(E,b,{value:null,writable:!0}),L(E,S,{value:null,writable:!0}),L(E,O,{value:Q._readableState.endEmitted,writable:!0}),L(E,v,{value:function(ue,ee){var se=U[y].read();se?(U[T]=null,U[$]=null,U[b]=null,ue(w(se,!1))):(U[$]=ue,U[b]=ee)},writable:!0}),E));return U[T]=null,re(Q,function(ie){if(ie&&"ERR_STREAM_PREMATURE_CLOSE"!==ie.code){var ue=U[b];return null!==ue&&(U[T]=null,U[$]=null,U[b]=null,ue(ie)),void(U[S]=ie)}var ee=U[$];null!==ee&&(U[T]=null,U[$]=null,U[b]=null,ee(w(void 0,!0))),U[O]=!0}),Q.on("readable",j.bind(null,U)),U}}).call(this)}).call(this,K("_process"))},{"./end-of-stream":76,_process:44}],74:[function(K,Ae,he){"use strict";function q(D,j){var I=Object.keys(D);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(D);j&&(H=H.filter(function(Y){return Object.getOwnPropertyDescriptor(D,Y).enumerable})),I.push.apply(I,H)}return I}function L(D,j,I){return j in D?Object.defineProperty(D,j,{value:I,enumerable:!0,configurable:!0,writable:!0}):D[j]=I,D}function $(D,j){for(var I=0;I<j.length;I++){var H=j[I];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(D,H.key,H)}}var O=K("buffer").Buffer,v=K("util").inspect,y=v&&v.custom||"inspect";function w(D,j,I){O.prototype.copy.call(D,j,I)}Ae.exports=function(){function D(){(function(D,j){if(!(D instanceof j))throw new TypeError("Cannot call a class as a function")})(this,D),this.head=null,this.tail=null,this.length=0}return function(D,j,I){j&&$(D.prototype,j),I&&$(D,I)}(D,[{key:"push",value:function(I){var H={data:I,next:null};this.length>0?this.tail.next=H:this.head=H,this.tail=H,++this.length}},{key:"unshift",value:function(I){var H={data:I,next:this.head};0===this.length&&(this.tail=H),this.head=H,++this.length}},{key:"shift",value:function(){if(0!==this.length){var I=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,I}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(I){if(0===this.length)return"";for(var H=this.head,Y=""+H.data;H=H.next;)Y+=I+H.data;return Y}},{key:"concat",value:function(I){if(0===this.length)return O.alloc(0);for(var H=O.allocUnsafe(I>>>0),Y=this.head,M=0;Y;)w(Y.data,H,M),M+=Y.data.length,Y=Y.next;return H}},{key:"consume",value:function(I,H){var Y;return I<this.head.data.length?(Y=this.head.data.slice(0,I),this.head.data=this.head.data.slice(I)):Y=I===this.head.data.length?this.shift():H?this._getString(I):this._getBuffer(I),Y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(I){var H=this.head,Y=1,M=H.data;for(I-=M.length;H=H.next;){var F=H.data,Q=I>F.length?F.length:I;if(M+=Q===F.length?F:F.slice(0,I),0==(I-=Q)){Q===F.length?(++Y,this.head=H.next?H.next:this.tail=null):(this.head=H,H.data=F.slice(Q));break}++Y}return this.length-=Y,M}},{key:"_getBuffer",value:function(I){var H=O.allocUnsafe(I),Y=this.head,M=1;for(Y.data.copy(H),I-=Y.data.length;Y=Y.next;){var F=Y.data,Q=I>F.length?F.length:I;if(F.copy(H,H.length-I,0,Q),0==(I-=Q)){Q===F.length?(++M,this.head=Y.next?Y.next:this.tail=null):(this.head=Y,Y.data=F.slice(Q));break}++M}return this.length-=M,H}},{key:y,value:function(I,H){return v(this,function(D){for(var j=1;j<arguments.length;j++){var I=null!=arguments[j]?arguments[j]:{};j%2?q(Object(I),!0).forEach(function(H){L(D,H,I[H])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(I)):q(Object(I)).forEach(function(H){Object.defineProperty(D,H,Object.getOwnPropertyDescriptor(I,H))})}return D}({},H,{depth:0,customInspect:!1}))}}]),D}()},{buffer:6,util:3}],75:[function(K,Ae,he){(function(q){(function(){"use strict";function L(O,T){b(O,T),re(O)}function re(O){O._writableState&&!O._writableState.emitClose||O._readableState&&!O._readableState.emitClose||O.emit("close")}function b(O,T){O.emit("error",T)}Ae.exports={destroy:function(O,T){var v=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(T?T(O):O&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,q.nextTick(b,this,O)):q.nextTick(b,this,O)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(O||null,function(D){!T&&D?v._writableState?v._writableState.errorEmitted?q.nextTick(re,v):(v._writableState.errorEmitted=!0,q.nextTick(L,v,D)):q.nextTick(L,v,D):T?(q.nextTick(re,v),T(D)):q.nextTick(re,v)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(O,T){var v=O._readableState,y=O._writableState;v&&v.autoDestroy||y&&y.autoDestroy?O.destroy(T):O.emit("error",T)}}}).call(this)}).call(this,K("_process"))},{_process:44}],76:[function(K,Ae,he){"use strict";var q=K("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function L(){}Ae.exports=function $(b,S,O){if("function"==typeof S)return $(b,null,S);S||(S={}),O=function(b){var S=!1;return function(){if(!S){S=!0;for(var O=arguments.length,T=new Array(O),v=0;v<O;v++)T[v]=arguments[v];b.apply(this,T)}}}(O||L);var T=S.readable||!1!==S.readable&&b.readable,v=S.writable||!1!==S.writable&&b.writable,y=function(){b.writable||D()},w=b._writableState&&b._writableState.finished,D=function(){v=!1,w=!0,T||O.call(b)},j=b._readableState&&b._readableState.endEmitted,I=function(){T=!1,j=!0,v||O.call(b)},H=function(Q){O.call(b,Q)},Y=function(){var Q;return T&&!j?((!b._readableState||!b._readableState.ended)&&(Q=new q),O.call(b,Q)):v&&!w?((!b._writableState||!b._writableState.ended)&&(Q=new q),O.call(b,Q)):void 0},M=function(){b.req.on("finish",D)};return function(b){return b.setHeader&&"function"==typeof b.abort}(b)?(b.on("complete",D),b.on("abort",Y),b.req?M():b.on("request",M)):v&&!b._writableState&&(b.on("end",y),b.on("close",y)),b.on("end",I),b.on("finish",D),!1!==S.error&&b.on("error",H),b.on("close",Y),function(){b.removeListener("complete",D),b.removeListener("abort",Y),b.removeListener("request",M),b.req&&b.req.removeListener("finish",D),b.removeListener("end",y),b.removeListener("close",y),b.removeListener("finish",D),b.removeListener("end",I),b.removeListener("error",H),b.removeListener("close",Y)}}},{"../../../errors":67}],77:[function(K,Ae,he){Ae.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(K,Ae,he){"use strict";var q;var L=K("../../../errors").codes,re=L.ERR_MISSING_ARGS,$=L.ERR_STREAM_DESTROYED;function b(D){if(D)throw D}function O(D,j,I,H){H=function(D){var j=!1;return function(){j||(j=!0,D.apply(void 0,arguments))}}(H);var Y=!1;D.on("close",function(){Y=!0}),void 0===q&&(q=K("./end-of-stream")),q(D,{readable:j,writable:I},function(F){if(F)return H(F);Y=!0,H()});var M=!1;return function(F){if(!Y&&!M){if(M=!0,function(D){return D.setHeader&&"function"==typeof D.abort}(D))return D.abort();if("function"==typeof D.destroy)return D.destroy();H(F||new $("pipe"))}}}function T(D){D()}function v(D,j){return D.pipe(j)}function y(D){return D.length&&"function"==typeof D[D.length-1]?D.pop():b}Ae.exports=function(){for(var D=arguments.length,j=new Array(D),I=0;I<D;I++)j[I]=arguments[I];var H=y(j);if(Array.isArray(j[0])&&(j=j[0]),j.length<2)throw new re("streams");var Y,M=j.map(function(F,Q){var E=Q<j.length-1;return O(F,E,Q>0,function(ie){Y||(Y=ie),ie&&M.forEach(T),!E&&(M.forEach(T),H(Y))})});return j.reduce(v)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(K,Ae,he){"use strict";var q=K("../../../errors").codes.ERR_INVALID_OPT_VALUE;Ae.exports={getHighWaterMark:function(re,$,b,S){var O=function(re,$,b){return null!=re.highWaterMark?re.highWaterMark:$?re[b]:null}($,S,b);if(null!=O){if(!isFinite(O)||Math.floor(O)!==O||O<0)throw new q(S?b:"highWaterMark",O);return Math.floor(O)}return re.objectMode?16:16384}}},{"../../../errors":67}],80:[function(K,Ae,he){Ae.exports=K("events").EventEmitter},{events:8}],81:[function(K,Ae,he){(he=Ae.exports=K("./lib/_stream_readable.js")).Stream=he,he.Readable=he,he.Writable=K("./lib/_stream_writable.js"),he.Duplex=K("./lib/_stream_duplex.js"),he.Transform=K("./lib/_stream_transform.js"),he.PassThrough=K("./lib/_stream_passthrough.js"),he.finished=K("./lib/internal/streams/end-of-stream.js"),he.pipeline=K("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(K,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),function(V){for(var L in V)he.hasOwnProperty(L)||(he[L]=V[L])}(K("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(K,Ae,he){"use strict";function V($){const b=[];let S=0;for(;S<$.length;)switch($[S]){case"/":if("."===$[S+1])if("."===$[S+2]){if(!re($[S+3])){b.push([]),S++;break}b.pop(),$[S+3]||b.push([]),S+=3}else{if(!re($[S+2])){b.push([]),S++;break}$[S+2]||b.push([]),S+=2}else b.push([]),S++;break;case"#":case"?":b.length||b.push([]),b[b.length-1].push($.substr(S)),S=$.length;break;default:b.length||b.push([]),b[b.length-1].push($[S]),S++}return"/"+b.map(O=>O.join("")).join("/")}function L($,b){let S=b+1;b>=0?"/"===$[b+1]&&"/"===$[b+2]&&(S=b+3):"/"===$[0]&&"/"===$[1]&&(S=2);const O=$.indexOf("/",S);return O<0?$:$.substr(0,O)+V($.substr(O))}function re($){return!$||"#"===$||"?"===$||"/"===$}Object.defineProperty(he,"__esModule",{value:!0}),he.resolve=function($,b){const S=(b=b||"").indexOf("#");if(S>0&&(b=b.substr(0,S)),!$.length){if(b.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${b}' for value '${$}'`);return b}if($.startsWith("?")){const j=b.indexOf("?");return j>0&&(b=b.substr(0,j)),b+$}if($.startsWith("#"))return b+$;if(!b.length){const j=$.indexOf(":");if(j<0)throw new Error(`Found invalid relative IRI '${$}' for a missing baseIRI`);return L($,j)}const O=$.indexOf(":");if(O>=0)return L($,O);const T=b.indexOf(":");if(T<0)throw new Error(`Found invalid baseIRI '${b}' for value '${$}'`);const v=b.substr(0,T+1);if(0===$.indexOf("//"))return v+L($,O);let y;if(b.indexOf("//",T)===T+1){if(y=b.indexOf("/",T+3),y<0)return b.length>T+3?b+"/"+L($,O):v+L($,O)}else if(y=b.indexOf("/",T+1),y<0)return v+L($,O);if(0===$.indexOf("/"))return b.substr(0,y)+V($);let w=b.substr(y);const D=w.lastIndexOf("/");return D>=0&&D<w.length-1&&(w=w.substr(0,D+1),"."===$[0]&&"."!==$[1]&&"/"!==$[1]&&$[2]&&($=$.substr(1))),$=V($=w+$),b.substr(0,y)+$},he.removeDotSegments=V,he.removeDotSegmentsOfPath=L},{}],84:[function(K,Ae,he){var q=K("buffer"),V=q.Buffer;function L($,b){for(var S in $)b[S]=$[S]}function re($,b,S){return V($,b,S)}V.from&&V.alloc&&V.allocUnsafe&&V.allocUnsafeSlow?Ae.exports=q:(L(q,he),he.Buffer=re),re.prototype=Object.create(V.prototype),L(V,re),re.from=function($,b,S){if("number"==typeof $)throw new TypeError("Argument must not be a number");return V($,b,S)},re.alloc=function($,b,S){if("number"!=typeof $)throw new TypeError("Argument must be a number");var O=V($);return void 0!==b?"string"==typeof S?O.fill(b,S):O.fill(b):O.fill(0),O},re.allocUnsafe=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return V($)},re.allocUnsafeSlow=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return q.SlowBuffer($)}},{buffer:6}],85:[function(K,Ae,he){(function(q){(function(){!function(V){V.parser=function(z,X){return new re(z,X)},V.SAXParser=re,V.SAXStream=y,V.createStream=function(z,X){return new y(z,X)},V.MAX_BUFFER_LENGTH=65536;var O,L=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function re(z,X){if(!(this instanceof re))return new re(z,X);var be=this;(function(z){for(var X=0,be=L.length;X<be;X++)z[L[X]]=""})(be),be.q=be.c="",be.bufferCheckPosition=V.MAX_BUFFER_LENGTH,be.opt=X||{},be.opt.lowercase=be.opt.lowercase||be.opt.lowercasetags,be.looseCase=be.opt.lowercase?"toLowerCase":"toUpperCase",be.tags=[],be.closed=be.closedRoot=be.sawRoot=!1,be.tag=be.error=null,be.strict=!!z,be.noscript=!(!z&&!be.opt.noscript),be.state=se.BEGIN,be.strictEntities=be.opt.strictEntities,be.ENTITIES=Object.create(be.strictEntities?V.XML_ENTITIES:V.ENTITIES),be.attribList=[],be.opt.xmlns&&(be.ns=Object.create(H)),be.trackPosition=!1!==be.opt.position,be.trackPosition&&(be.position=be.line=be.column=0),me(be,"onready")}V.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(z){function X(){}return X.prototype=z,new X}),Object.keys||(Object.keys=function(z){var X=[];for(var be in z)z.hasOwnProperty(be)&&X.push(be);return X}),re.prototype={end:function(){nt(this)},write:function(z){var X=this;if(this.error)throw this.error;if(X.closed)return Ve(X,"Cannot write after close. Assign an onready handler.");if(null===z)return nt(X);"object"==typeof z&&(z=z.toString());for(var be=0,ce="";ce=qe(z,be++),X.c=ce,ce;)switch(X.trackPosition&&(X.position++,"\n"===ce?(X.line++,X.column=0):X.column++),X.state){case se.BEGIN:if(X.state=se.BEGIN_WHITESPACE,"\ufeff"===ce)continue;Ue(X,ce);continue;case se.BEGIN_WHITESPACE:Ue(X,ce);continue;case se.TEXT:if(X.sawRoot&&!X.closedRoot){for(var Pe=be-1;ce&&"<"!==ce&&"&"!==ce;)(ce=qe(z,be++))&&X.trackPosition&&(X.position++,"\n"===ce?(X.line++,X.column=0):X.column++);X.textNode+=z.substring(Pe,be-1)}"<"!==ce||X.sawRoot&&X.closedRoot&&!X.strict?(!E(ce)&&(!X.sawRoot||X.closedRoot)&&Ze(X,"Text data outside of root node."),"&"===ce?X.state=se.TEXT_ENTITY:X.textNode+=ce):(X.state=se.OPEN_WAKA,X.startTagPosition=X.position);continue;case se.SCRIPT:"<"===ce?X.state=se.SCRIPT_ENDING:X.script+=ce;continue;case se.SCRIPT_ENDING:"/"===ce?X.state=se.CLOSE_TAG:(X.script+="<"+ce,X.state=se.SCRIPT);continue;case se.OPEN_WAKA:"!"===ce?(X.state=se.SGML_DECL,X.sgmlDecl=""):E(ce)||(ue(Y,ce)?(X.state=se.OPEN_TAG,X.tagName=ce):"/"===ce?(X.state=se.CLOSE_TAG,X.tagName=""):"?"===ce?(X.state=se.PROC_INST,X.procInstName=X.procInstBody=""):(Ze(X,"Unencoded <"),X.startTagPosition+1<X.position&&(ce=new Array(X.position-X.startTagPosition).join(" ")+ce),X.textNode+="<"+ce,X.state=se.TEXT));continue;case se.SGML_DECL:"[CDATA["===(X.sgmlDecl+ce).toUpperCase()?(te(X,"onopencdata"),X.state=se.CDATA,X.sgmlDecl="",X.cdata=""):X.sgmlDecl+ce==="--"?(X.state=se.COMMENT,X.comment="",X.sgmlDecl=""):"DOCTYPE"===(X.sgmlDecl+ce).toUpperCase()?(X.state=se.DOCTYPE,(X.doctype||X.sawRoot)&&Ze(X,"Inappropriately located doctype declaration"),X.doctype="",X.sgmlDecl=""):">"===ce?(te(X,"onsgmldeclaration",X.sgmlDecl),X.sgmlDecl="",X.state=se.TEXT):(U(ce)&&(X.state=se.SGML_DECL_QUOTED),X.sgmlDecl+=ce);continue;case se.SGML_DECL_QUOTED:ce===X.q&&(X.state=se.SGML_DECL,X.q=""),X.sgmlDecl+=ce;continue;case se.DOCTYPE:">"===ce?(X.state=se.TEXT,te(X,"ondoctype",X.doctype),X.doctype=!0):(X.doctype+=ce,"["===ce?X.state=se.DOCTYPE_DTD:U(ce)&&(X.state=se.DOCTYPE_QUOTED,X.q=ce));continue;case se.DOCTYPE_QUOTED:X.doctype+=ce,ce===X.q&&(X.q="",X.state=se.DOCTYPE);continue;case se.DOCTYPE_DTD:X.doctype+=ce,"]"===ce?X.state=se.DOCTYPE:U(ce)&&(X.state=se.DOCTYPE_DTD_QUOTED,X.q=ce);continue;case se.DOCTYPE_DTD_QUOTED:X.doctype+=ce,ce===X.q&&(X.state=se.DOCTYPE_DTD,X.q="");continue;case se.COMMENT:"-"===ce?X.state=se.COMMENT_ENDING:X.comment+=ce;continue;case se.COMMENT_ENDING:"-"===ce?(X.state=se.COMMENT_ENDED,X.comment=Me(X.opt,X.comment),X.comment&&te(X,"oncomment",X.comment),X.comment=""):(X.comment+="-"+ce,X.state=se.COMMENT);continue;case se.COMMENT_ENDED:">"!==ce?(Ze(X,"Malformed comment"),X.comment+="--"+ce,X.state=se.COMMENT):X.state=se.TEXT;continue;case se.CDATA:"]"===ce?X.state=se.CDATA_ENDING:X.cdata+=ce;continue;case se.CDATA_ENDING:"]"===ce?X.state=se.CDATA_ENDING_2:(X.cdata+="]"+ce,X.state=se.CDATA);continue;case se.CDATA_ENDING_2:">"===ce?(X.cdata&&te(X,"oncdata",X.cdata),te(X,"onclosecdata"),X.cdata="",X.state=se.TEXT):"]"===ce?X.cdata+="]":(X.cdata+="]]"+ce,X.state=se.CDATA);continue;case se.PROC_INST:"?"===ce?X.state=se.PROC_INST_ENDING:E(ce)?X.state=se.PROC_INST_BODY:X.procInstName+=ce;continue;case se.PROC_INST_BODY:if(!X.procInstBody&&E(ce))continue;"?"===ce?X.state=se.PROC_INST_ENDING:X.procInstBody+=ce;continue;case se.PROC_INST_ENDING:">"===ce?(te(X,"onprocessinginstruction",{name:X.procInstName,body:X.procInstBody}),X.procInstName=X.procInstBody="",X.state=se.TEXT):(X.procInstBody+="?"+ce,X.state=se.PROC_INST_BODY);continue;case se.OPEN_TAG:ue(M,ce)?X.tagName+=ce:(Je(X),">"===ce?Le(X):"/"===ce?X.state=se.OPEN_TAG_SLASH:(E(ce)||Ze(X,"Invalid character in tag name"),X.state=se.ATTRIB));continue;case se.OPEN_TAG_SLASH:">"===ce?(Le(X,!0),Ee(X)):(Ze(X,"Forward-slash in opening tag not followed by >"),X.state=se.ATTRIB);continue;case se.ATTRIB:if(E(ce))continue;">"===ce?Le(X):"/"===ce?X.state=se.OPEN_TAG_SLASH:ue(Y,ce)?(X.attribName=ce,X.attribValue="",X.state=se.ATTRIB_NAME):Ze(X,"Invalid attribute name");continue;case se.ATTRIB_NAME:"="===ce?X.state=se.ATTRIB_VALUE:">"===ce?(Ze(X,"Attribute without value"),X.attribValue=X.attribName,je(X),Le(X)):E(ce)?X.state=se.ATTRIB_NAME_SAW_WHITE:ue(M,ce)?X.attribName+=ce:Ze(X,"Invalid attribute name");continue;case se.ATTRIB_NAME_SAW_WHITE:if("="===ce)X.state=se.ATTRIB_VALUE;else{if(E(ce))continue;Ze(X,"Attribute without value"),X.tag.attributes[X.attribName]="",X.attribValue="",te(X,"onattribute",{name:X.attribName,value:""}),X.attribName="",">"===ce?Le(X):ue(Y,ce)?(X.attribName=ce,X.state=se.ATTRIB_NAME):(Ze(X,"Invalid attribute name"),X.state=se.ATTRIB)}continue;case se.ATTRIB_VALUE:if(E(ce))continue;U(ce)?(X.q=ce,X.state=se.ATTRIB_VALUE_QUOTED):(Ze(X,"Unquoted attribute value"),X.state=se.ATTRIB_VALUE_UNQUOTED,X.attribValue=ce);continue;case se.ATTRIB_VALUE_QUOTED:if(ce!==X.q){"&"===ce?X.state=se.ATTRIB_VALUE_ENTITY_Q:X.attribValue+=ce;continue}je(X),X.q="",X.state=se.ATTRIB_VALUE_CLOSED;continue;case se.ATTRIB_VALUE_CLOSED:E(ce)?X.state=se.ATTRIB:">"===ce?Le(X):"/"===ce?X.state=se.OPEN_TAG_SLASH:ue(Y,ce)?(Ze(X,"No whitespace between attributes"),X.attribName=ce,X.attribValue="",X.state=se.ATTRIB_NAME):Ze(X,"Invalid attribute name");continue;case se.ATTRIB_VALUE_UNQUOTED:if(!ie(ce)){"&"===ce?X.state=se.ATTRIB_VALUE_ENTITY_U:X.attribValue+=ce;continue}je(X),">"===ce?Le(X):X.state=se.ATTRIB;continue;case se.CLOSE_TAG:if(X.tagName)">"===ce?Ee(X):ue(M,ce)?X.tagName+=ce:X.script?(X.script+="</"+X.tagName,X.tagName="",X.state=se.SCRIPT):(E(ce)||Ze(X,"Invalid tagname in closing tag"),X.state=se.CLOSE_TAG_SAW_WHITE);else{if(E(ce))continue;ee(Y,ce)?X.script?(X.script+="</"+ce,X.state=se.SCRIPT):Ze(X,"Invalid tagname in closing tag."):X.tagName=ce}continue;case se.CLOSE_TAG_SAW_WHITE:if(E(ce))continue;">"===ce?Ee(X):Ze(X,"Invalid characters in closing tag");continue;case se.TEXT_ENTITY:case se.ATTRIB_VALUE_ENTITY_Q:case se.ATTRIB_VALUE_ENTITY_U:var pt,fe;switch(X.state){case se.TEXT_ENTITY:pt=se.TEXT,fe="textNode";break;case se.ATTRIB_VALUE_ENTITY_Q:pt=se.ATTRIB_VALUE_QUOTED,fe="attribValue";break;case se.ATTRIB_VALUE_ENTITY_U:pt=se.ATTRIB_VALUE_UNQUOTED,fe="attribValue"}";"===ce?(X[fe]+=Re(X),X.entity="",X.state=pt):ue(X.entity.length?Q:F,ce)?X.entity+=ce:(Ze(X,"Invalid character in entity name"),X[fe]+="&"+X.entity+ce,X.entity="",X.state=pt);continue;default:throw new Error(X,"Unknown state: "+X.state)}return X.position>=X.bufferCheckPosition&&function(z){for(var X=Math.max(V.MAX_BUFFER_LENGTH,10),be=0,ce=0,Pe=L.length;ce<Pe;ce++){var wt=z[L[ce]].length;if(wt>X)switch(L[ce]){case"textNode":ye(z);break;case"cdata":te(z,"oncdata",z.cdata),z.cdata="";break;case"script":te(z,"onscript",z.script),z.script="";break;default:Ve(z,"Max buffer length exceeded: "+L[ce])}be=Math.max(be,wt)}z.bufferCheckPosition=V.MAX_BUFFER_LENGTH-be+z.position}(X),X},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(z){ye(z),""!==z.cdata&&(te(z,"oncdata",z.cdata),z.cdata=""),""!==z.script&&(te(z,"onscript",z.script),z.script="")}(this)}};try{O=K("stream").Stream}catch(z){O=function(){}}var T=V.EVENTS.filter(function(z){return"error"!==z&&"end"!==z});function y(z,X){if(!(this instanceof y))return new y(z,X);O.apply(this),this._parser=new re(z,X),this.writable=!0,this.readable=!0;var be=this;this._parser.onend=function(){be.emit("end")},this._parser.onerror=function(ce){be.emit("error",ce),be._parser.error=null},this._decoder=null,T.forEach(function(ce){Object.defineProperty(be,"on"+ce,{get:function(){return be._parser["on"+ce]},set:function(Pe){if(!Pe)return be.removeAllListeners(ce),be._parser["on"+ce]=Pe,Pe;be.on(ce,Pe)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(O.prototype,{constructor:{value:y}})).write=function(z){if("function"==typeof q&&"function"==typeof q.isBuffer&&q.isBuffer(z)){if(!this._decoder){var X=K("string_decoder").StringDecoder;this._decoder=new X("utf8")}z=this._decoder.write(z)}return this._parser.write(z.toString()),this.emit("data",z),!0},y.prototype.end=function(z){return z&&z.length&&this.write(z),this._parser.end(),!0},y.prototype.on=function(z,X){var be=this;return!be._parser["on"+z]&&-1!==T.indexOf(z)&&(be._parser["on"+z]=function(){var ce=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);ce.splice(0,0,z),be.emit.apply(be,ce)}),O.prototype.on.call(be,z,X)};var j="http://www.w3.org/XML/1998/namespace",I="http://www.w3.org/2000/xmlns/",H={xml:j,xmlns:I},Y=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,M=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,F=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Q=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(z){return" "===z||"\n"===z||"\r"===z||"\t"===z}function U(z){return'"'===z||"'"===z}function ie(z){return">"===z||E(z)}function ue(z,X){return z.test(X)}function ee(z,X){return!ue(z,X)}var z,X,be,se=0;for(var Te in V.STATE={BEGIN:se++,BEGIN_WHITESPACE:se++,TEXT:se++,TEXT_ENTITY:se++,OPEN_WAKA:se++,SGML_DECL:se++,SGML_DECL_QUOTED:se++,DOCTYPE:se++,DOCTYPE_QUOTED:se++,DOCTYPE_DTD:se++,DOCTYPE_DTD_QUOTED:se++,COMMENT_STARTING:se++,COMMENT:se++,COMMENT_ENDING:se++,COMMENT_ENDED:se++,CDATA:se++,CDATA_ENDING:se++,CDATA_ENDING_2:se++,PROC_INST:se++,PROC_INST_BODY:se++,PROC_INST_ENDING:se++,OPEN_TAG:se++,OPEN_TAG_SLASH:se++,ATTRIB:se++,ATTRIB_NAME:se++,ATTRIB_NAME_SAW_WHITE:se++,ATTRIB_VALUE:se++,ATTRIB_VALUE_QUOTED:se++,ATTRIB_VALUE_CLOSED:se++,ATTRIB_VALUE_UNQUOTED:se++,ATTRIB_VALUE_ENTITY_Q:se++,ATTRIB_VALUE_ENTITY_U:se++,CLOSE_TAG:se++,CLOSE_TAG_SAW_WHITE:se++,SCRIPT:se++,SCRIPT_ENDING:se++},V.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},V.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(V.ENTITIES).forEach(function(z){var X=V.ENTITIES[z],be="number"==typeof X?String.fromCharCode(X):X;V.ENTITIES[z]=be}),V.STATE)V.STATE[V.STATE[Te]]=Te;function me(z,X,be){z[X]&&z[X](be)}function te(z,X,be){z.textNode&&ye(z),me(z,X,be)}function ye(z){z.textNode=Me(z.opt,z.textNode),z.textNode&&me(z,"ontext",z.textNode),z.textNode=""}function Me(z,X){return z.trim&&(X=X.trim()),z.normalize&&(X=X.replace(/\s+/g," ")),X}function Ve(z,X){return ye(z),z.trackPosition&&(X+="\nLine: "+z.line+"\nColumn: "+z.column+"\nChar: "+z.c),X=new Error(X),z.error=X,me(z,"onerror",X),z}function nt(z){return z.sawRoot&&!z.closedRoot&&Ze(z,"Unclosed root tag"),z.state!==se.BEGIN&&z.state!==se.BEGIN_WHITESPACE&&z.state!==se.TEXT&&Ve(z,"Unexpected end"),ye(z),z.c="",z.closed=!0,me(z,"onend"),re.call(z,z.strict,z.opt),z}function Ze(z,X){if("object"!=typeof z||!(z instanceof re))throw new Error("bad call to strictFail");z.strict&&Ve(z,X)}function Je(z){z.strict||(z.tagName=z.tagName[z.looseCase]());var X=z.tags[z.tags.length-1]||z,be=z.tag={name:z.tagName,attributes:{}};z.opt.xmlns&&(be.ns=X.ns),z.attribList.length=0,te(z,"onopentagstart",be)}function Ye(z,X){var ce=z.indexOf(":")<0?["",z]:z.split(":"),Pe=ce[0],wt=ce[1];return X&&"xmlns"===z&&(Pe="xmlns",wt=""),{prefix:Pe,local:wt}}function je(z){if(z.strict||(z.attribName=z.attribName[z.looseCase]()),-1!==z.attribList.indexOf(z.attribName)||z.tag.attributes.hasOwnProperty(z.attribName))z.attribName=z.attribValue="";else{if(z.opt.xmlns){var X=Ye(z.attribName,!0),ce=X.local;if("xmlns"===X.prefix)if("xml"===ce&&z.attribValue!==j)Ze(z,"xml: prefix must be bound to "+j+"\nActual: "+z.attribValue);else if("xmlns"===ce&&z.attribValue!==I)Ze(z,"xmlns: prefix must be bound to "+I+"\nActual: "+z.attribValue);else{var Pe=z.tag,wt=z.tags[z.tags.length-1]||z;Pe.ns===wt.ns&&(Pe.ns=Object.create(wt.ns)),Pe.ns[ce]=z.attribValue}z.attribList.push([z.attribName,z.attribValue])}else z.tag.attributes[z.attribName]=z.attribValue,te(z,"onattribute",{name:z.attribName,value:z.attribValue});z.attribName=z.attribValue=""}}function Le(z,X){if(z.opt.xmlns){var be=z.tag,ce=Ye(z.tagName);be.prefix=ce.prefix,be.local=ce.local,be.uri=be.ns[ce.prefix]||"",be.prefix&&!be.uri&&(Ze(z,"Unbound namespace prefix: "+JSON.stringify(z.tagName)),be.uri=ce.prefix),be.ns&&(z.tags[z.tags.length-1]||z).ns!==be.ns&&Object.keys(be.ns).forEach(function(Tn){te(z,"onopennamespace",{prefix:Tn,uri:be.ns[Tn]})});for(var wt=0,pt=z.attribList.length;wt<pt;wt++){var fe=z.attribList[wt],B=fe[0],R=fe[1],k=Ye(B,!0),Oe=k.prefix,yt=""===Oe?"":be.ns[Oe]||"",It={name:B,value:R,prefix:Oe,local:k.local,uri:yt};Oe&&"xmlns"!==Oe&&!yt&&(Ze(z,"Unbound namespace prefix: "+JSON.stringify(Oe)),It.uri=Oe),z.tag.attributes[B]=It,te(z,"onattribute",It)}z.attribList.length=0}z.tag.isSelfClosing=!!X,z.sawRoot=!0,z.tags.push(z.tag),te(z,"onopentag",z.tag),X||(z.state=z.noscript||"script"!==z.tagName.toLowerCase()?se.TEXT:se.SCRIPT,z.tag=null,z.tagName=""),z.attribName=z.attribValue="",z.attribList.length=0}function Ee(z){if(!z.tagName)return Ze(z,"Weird empty close tag."),z.textNode+="</>",void(z.state=se.TEXT);if(z.script){if("script"!==z.tagName)return z.script+="</"+z.tagName+">",z.tagName="",void(z.state=se.SCRIPT);te(z,"onscript",z.script),z.script=""}var X=z.tags.length,be=z.tagName;z.strict||(be=be[z.looseCase]());for(var ce=be;X--&&z.tags[X].name!==ce;)Ze(z,"Unexpected close tag");if(X<0)return Ze(z,"Unmatched closing tag: "+z.tagName),z.textNode+="</"+z.tagName+">",void(z.state=se.TEXT);z.tagName=be;for(var wt=z.tags.length;wt-- >X;){var pt=z.tag=z.tags.pop();z.tagName=z.tag.name,te(z,"onclosetag",z.tagName);var fe={};for(var B in pt.ns)fe[B]=pt.ns[B];z.opt.xmlns&&pt.ns!==(z.tags[z.tags.length-1]||z).ns&&Object.keys(pt.ns).forEach(function(k){te(z,"onclosenamespace",{prefix:k,uri:pt.ns[k]})})}0===X&&(z.closedRoot=!0),z.tagName=z.attribValue=z.attribName="",z.attribList.length=0,z.state=se.TEXT}function Re(z){var ce,X=z.entity,be=X.toLowerCase(),Pe="";return z.ENTITIES[X]?z.ENTITIES[X]:z.ENTITIES[be]?z.ENTITIES[be]:("#"===(X=be).charAt(0)&&("x"===X.charAt(1)?(X=X.slice(2),Pe=(ce=parseInt(X,16)).toString(16)):(X=X.slice(1),Pe=(ce=parseInt(X,10)).toString(10))),X=X.replace(/^0+/,""),isNaN(ce)||Pe.toLowerCase()!==X?(Ze(z,"Invalid character entity"),"&"+z.entity+";"):String.fromCodePoint(ce))}function Ue(z,X){"<"===X?(z.state=se.OPEN_WAKA,z.startTagPosition=z.position):E(X)||(Ze(z,"Non-whitespace before first tag."),z.textNode=X,z.state=se.TEXT)}function qe(z,X){var be="";return X<z.length&&(be=z.charAt(X)),be}se=V.STATE,String.fromCodePoint||(z=String.fromCharCode,X=Math.floor,be=function(){var ce=16384,Pe=[],fe=-1,B=arguments.length;if(!B)return"";for(var R="";++fe<B;){var k=Number(arguments[fe]);if(!isFinite(k)||k<0||k>1114111||X(k)!==k)throw RangeError("Invalid code point: "+k);k<=65535?Pe.push(k):Pe.push(55296+((k-=65536)>>10),k%1024+56320),(fe+1===B||Pe.length>ce)&&(R+=z.apply(null,Pe),Pe.length=0)}return R},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:be,configurable:!0,writable:!0}):String.fromCodePoint=be)}(void 0===he?this.sax={}:he)}).call(this)}).call(this,K("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(K,Ae,he){(function(q,V){(function(){!function(L,re){"use strict";if(!L.setImmediate){var T,$=1,b={},S=!1,O=L.document,Q=Object.getPrototypeOf&&Object.getPrototypeOf(L);Q=Q&&Q.setTimeout?Q:L,"[object process]"==={}.toString.call(L.process)?T=function(E){q.nextTick(function(){D(E)})}:function(){if(L.postMessage&&!L.importScripts){var E=!0,U=L.onmessage;return L.onmessage=function(){E=!1},L.postMessage("","*"),L.onmessage=U,E}}()?(E="setImmediate$"+Math.random()+"$",U=function(ie){ie.source===L&&"string"==typeof ie.data&&0===ie.data.indexOf(E)&&D(+ie.data.slice(E.length))},L.addEventListener?L.addEventListener("message",U,!1):L.attachEvent("onmessage",U),T=function(ie){L.postMessage(E+ie,"*")}):L.MessageChannel?function(){var E=new MessageChannel;E.port1.onmessage=function(U){D(U.data)},T=function(U){E.port2.postMessage(U)}}():O&&"onreadystatechange"in O.createElement("script")?function(){var E=O.documentElement;T=function(U){var ie=O.createElement("script");ie.onreadystatechange=function(){D(U),ie.onreadystatechange=null,E.removeChild(ie),ie=null},E.appendChild(ie)}}():T=function(E){setTimeout(D,0,E)},Q.setImmediate=function(E){"function"!=typeof E&&(E=new Function(""+E));for(var U=new Array(arguments.length-1),ie=0;ie<U.length;ie++)U[ie]=arguments[ie+1];return b[$]={callback:E,args:U},T($),$++},Q.clearImmediate=y}var E,U;function y(E){delete b[E]}function D(E){if(S)setTimeout(D,0,E);else{var U=b[E];if(U){S=!0;try{!function(E){var U=E.callback,ie=E.args;switch(ie.length){case 0:U();break;case 1:U(ie[0]);break;case 2:U(ie[0],ie[1]);break;case 3:U(ie[0],ie[1],ie[2]);break;default:U.apply(void 0,ie)}}(U)}finally{y(E),S=!1}}}}}("undefined"==typeof self?void 0===V?this:V:self)}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(K,Ae,he){Ae.exports=L;var q=K("events").EventEmitter;function L(){q.call(this)}K("inherits")(L,q),L.Readable=K("readable-stream/lib/_stream_readable.js"),L.Writable=K("readable-stream/lib/_stream_writable.js"),L.Duplex=K("readable-stream/lib/_stream_duplex.js"),L.Transform=K("readable-stream/lib/_stream_transform.js"),L.PassThrough=K("readable-stream/lib/_stream_passthrough.js"),L.finished=K("readable-stream/lib/internal/streams/end-of-stream.js"),L.pipeline=K("readable-stream/lib/internal/streams/pipeline.js"),L.Stream=L,L.prototype.pipe=function(re,$){var b=this;function S(j){re.writable&&!1===re.write(j)&&b.pause&&b.pause()}function O(){b.readable&&b.resume&&b.resume()}b.on("data",S),re.on("drain",O),!re._isStdio&&(!$||!1!==$.end)&&(b.on("end",v),b.on("close",y));var T=!1;function v(){T||(T=!0,re.end())}function y(){T||(T=!0,"function"==typeof re.destroy&&re.destroy())}function w(j){if(D(),0===q.listenerCount(this,"error"))throw j}function D(){b.removeListener("data",S),re.removeListener("drain",O),b.removeListener("end",v),b.removeListener("close",y),b.removeListener("error",w),re.removeListener("error",w),b.removeListener("end",D),b.removeListener("close",D),re.removeListener("close",D)}return b.on("error",w),re.on("error",w),b.on("end",D),b.on("close",D),re.on("close",D),re.emit("pipe",b),re}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(K,Ae,he){arguments[4][5][0].apply(he,arguments)},{dup:5,"safe-buffer":84}],89:[function(K,Ae,he){(function(q,V){(function(){var L=K("process/browser.js").nextTick,re=Function.prototype.apply,$=Array.prototype.slice,b={},S=0;function O(T,v){this._id=T,this._clearFn=v}he.setTimeout=function(){return new O(re.call(setTimeout,window,arguments),clearTimeout)},he.setInterval=function(){return new O(re.call(setInterval,window,arguments),clearInterval)},he.clearTimeout=he.clearInterval=function(T){T.close()},O.prototype.unref=O.prototype.ref=function(){},O.prototype.close=function(){this._clearFn.call(window,this._id)},he.enroll=function(T,v){clearTimeout(T._idleTimeoutId),T._idleTimeout=v},he.unenroll=function(T){clearTimeout(T._idleTimeoutId),T._idleTimeout=-1},he._unrefActive=he.active=function(T){clearTimeout(T._idleTimeoutId);var v=T._idleTimeout;v>=0&&(T._idleTimeoutId=setTimeout(function(){T._onTimeout&&T._onTimeout()},v))},he.setImmediate="function"==typeof q?q:function(T){var v=S++,y=!(arguments.length<2)&&$.call(arguments,1);return b[v]=!0,L(function(){b[v]&&(y?T.apply(null,y):T.call(null),he.clearImmediate(v))}),v},he.clearImmediate="function"==typeof V?V:function(T){delete b[T]}}).call(this)}).call(this,K("timers").setImmediate,K("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(K,Ae,he){(function(q){(function(){function L(re){try{if(!q.localStorage)return!1}catch(b){return!1}var $=q.localStorage[re];return null!=$&&"true"===String($).toLowerCase()}Ae.exports=function(re,$){if(L("noDeprecation"))return re;var b=!1;return function(){if(!b){if(L("throwDeprecation"))throw new Error($);L("traceDeprecation")?console.trace($):console.warn($),b=!0}return re.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(K,Ae,he){"use strict";Ae.exports=function(q){q.prototype[Symbol.iterator]=function*(){for(let V=this.head;V;V=V.next)yield V.value}}},{}],92:[function(K,Ae,he){"use strict";function q(b){var S=this;if(S instanceof q||(S=new q),S.tail=null,S.head=null,S.length=0,b&&"function"==typeof b.forEach)b.forEach(function(v){S.push(v)});else if(arguments.length>0)for(var O=0,T=arguments.length;O<T;O++)S.push(arguments[O]);return S}function V(b,S,O){var T=S===b.head?new $(O,null,S,b):new $(O,S,S.next,b);return null===T.next&&(b.tail=T),null===T.prev&&(b.head=T),b.length++,T}function L(b,S){b.tail=new $(S,b.tail,null,b),b.head||(b.head=b.tail),b.length++}function re(b,S){b.head=new $(S,null,b.head,b),b.tail||(b.tail=b.head),b.length++}function $(b,S,O,T){if(!(this instanceof $))return new $(b,S,O,T);this.list=T,this.value=b,S?(S.next=this,this.prev=S):this.prev=null,O?(O.prev=this,this.next=O):this.next=null}Ae.exports=q,q.Node=$,q.create=q,q.prototype.removeNode=function(b){if(b.list!==this)throw new Error("removing node which does not belong to this list");var S=b.next,O=b.prev;return S&&(S.prev=O),O&&(O.next=S),b===this.head&&(this.head=S),b===this.tail&&(this.tail=O),b.list.length--,b.next=null,b.prev=null,b.list=null,S},q.prototype.unshiftNode=function(b){if(b!==this.head){b.list&&b.list.removeNode(b);var S=this.head;b.list=this,b.next=S,S&&(S.prev=b),this.head=b,this.tail||(this.tail=b),this.length++}},q.prototype.pushNode=function(b){if(b!==this.tail){b.list&&b.list.removeNode(b);var S=this.tail;b.list=this,b.prev=S,S&&(S.next=b),this.tail=b,this.head||(this.head=b),this.length++}},q.prototype.push=function(){for(var b=0,S=arguments.length;b<S;b++)L(this,arguments[b]);return this.length},q.prototype.unshift=function(){for(var b=0,S=arguments.length;b<S;b++)re(this,arguments[b]);return this.length},q.prototype.pop=function(){if(this.tail){var b=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,b}},q.prototype.shift=function(){if(this.head){var b=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,b}},q.prototype.forEach=function(b,S){S=S||this;for(var O=this.head,T=0;null!==O;T++)b.call(S,O.value,T,this),O=O.next},q.prototype.forEachReverse=function(b,S){S=S||this;for(var O=this.tail,T=this.length-1;null!==O;T--)b.call(S,O.value,T,this),O=O.prev},q.prototype.get=function(b){for(var S=0,O=this.head;null!==O&&S<b;S++)O=O.next;if(S===b&&null!==O)return O.value},q.prototype.getReverse=function(b){for(var S=0,O=this.tail;null!==O&&S<b;S++)O=O.prev;if(S===b&&null!==O)return O.value},q.prototype.map=function(b,S){S=S||this;for(var O=new q,T=this.head;null!==T;)O.push(b.call(S,T.value,this)),T=T.next;return O},q.prototype.mapReverse=function(b,S){S=S||this;for(var O=new q,T=this.tail;null!==T;)O.push(b.call(S,T.value,this)),T=T.prev;return O},q.prototype.reduce=function(b,S){var O,T=this.head;if(arguments.length>1)O=S;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");T=this.head.next,O=this.head.value}for(var v=0;null!==T;v++)O=b(O,T.value,v),T=T.next;return O},q.prototype.reduceReverse=function(b,S){var O,T=this.tail;if(arguments.length>1)O=S;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");T=this.tail.prev,O=this.tail.value}for(var v=this.length-1;null!==T;v--)O=b(O,T.value,v),T=T.prev;return O},q.prototype.toArray=function(){for(var b=new Array(this.length),S=0,O=this.head;null!==O;S++)b[S]=O.value,O=O.next;return b},q.prototype.toArrayReverse=function(){for(var b=new Array(this.length),S=0,O=this.tail;null!==O;S++)b[S]=O.value,O=O.prev;return b},q.prototype.slice=function(b,S){(S=S||this.length)<0&&(S+=this.length),(b=b||0)<0&&(b+=this.length);var O=new q;if(S<b||S<0)return O;b<0&&(b=0),S>this.length&&(S=this.length);for(var T=0,v=this.head;null!==v&&T<b;T++)v=v.next;for(;null!==v&&T<S;T++,v=v.next)O.push(v.value);return O},q.prototype.sliceReverse=function(b,S){(S=S||this.length)<0&&(S+=this.length),(b=b||0)<0&&(b+=this.length);var O=new q;if(S<b||S<0)return O;b<0&&(b=0),S>this.length&&(S=this.length);for(var T=this.length,v=this.tail;null!==v&&T>S;T--)v=v.prev;for(;null!==v&&T>b;T--,v=v.prev)O.push(v.value);return O},q.prototype.splice=function(b,S,...O){b>this.length&&(b=this.length-1),b<0&&(b=this.length+b);for(var T=0,v=this.head;null!==v&&T<b;T++)v=v.next;var y=[];for(T=0;v&&T<S;T++)y.push(v.value),v=this.removeNode(v);for(null===v&&(v=this.tail),v!==this.head&&v!==this.tail&&(v=v.prev),T=0;T<O.length;T++)v=V(this,v,O[T]);return y},q.prototype.reverse=function(){for(var b=this.head,S=this.tail,O=b;null!==O;O=O.prev){var T=O.prev;O.prev=O.next,O.next=T}return this.head=S,this.tail=b,this};try{K("./iterator.js")(q)}catch(b){}},{"./iterator.js":91}]},{},[1])(1)},322:kt=>{kt.exports=function(tt,gt){var J=gt.length;if(0!==J){var At=tt.length;tt.length+=J;for(var dt=0;dt<J;dt++)tt[At+dt]=gt[dt]}}},517:(kt,it)=>{"use strict";var gt=(()=>{return(At=gt||(gt={})).typeOfFunction="function",At.boolTrue=!0,gt;var At})();function J(At,dt,K){if(!K||typeof K.value!==gt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+dt+"> is not a method!");return{configurable:gt.boolTrue,get:function(){var Ae=K.value.bind(this);return Object.defineProperty(this,dt,{value:Ae,configurable:gt.boolTrue,writable:gt.boolTrue}),Ae}}}it.ak=J,it.ZP=J},266:(kt,it,tt)=>{kt.exports={ResizeSensor:tt(835),ElementQueries:tt(845)}},845:function(kt,it,tt){"use strict";var gt,J,At;"undefined"!=typeof window&&window,J=[tt(835)],void 0!==(At="function"==typeof(gt=function(dt){var K=function(){var he,q={},V=[];function L(M){M||(M=document.documentElement);var F=window.getComputedStyle(M,null).fontSize;return parseFloat(F)||16}function $(M,F){var Q=F.split(/\d/),E=Q[Q.length-1];switch(F=parseFloat(F),E){case"px":return F;case"em":return F*L(M);case"rem":return F*L();case"vw":return F*document.documentElement.clientWidth/100;case"vh":return F*document.documentElement.clientHeight/100;case"vmin":case"vmax":var U=document.documentElement.clientWidth/100,ie=document.documentElement.clientHeight/100;return F*(0,Math["vmin"===E?"min":"max"])(U,ie);default:return F}}function b(M,F){this.element=M;var Q,E,U,ie,ue,ee,se,Te,me=["min-width","min-height","max-width","max-height"];this.call=function(){for(Q in U=function(M){if(!M.getBoundingClientRect)return{width:M.offsetWidth,height:M.offsetHeight};var F=M.getBoundingClientRect();return{width:Math.round(F.width),height:Math.round(F.height)}}(this.element),ee={},q[F])!q[F].hasOwnProperty(Q)||(ie=$(this.element,(E=q[F][Q]).value),ue="width"===E.property?U.width:U.height,se="","min"===E.mode&&ue>=ie&&(se+=E.value),"max"===E.mode&&ue<=ie&&(se+=E.value),ee[Te=E.mode+"-"+E.property]||(ee[Te]=""),se&&-1===(" "+ee[Te]+" ").indexOf(" "+se+" ")&&(ee[Te]+=" "+se));for(var te in me)!me.hasOwnProperty(te)||(ee[me[te]]?this.element.setAttribute(me[te],ee[me[te]].substr(1)):this.element.removeAttribute(me[te]))}}function S(M,F){M.elementQueriesSetupInformation||(M.elementQueriesSetupInformation=new b(M,F)),M.elementQueriesSensor||(M.elementQueriesSensor=new dt(M,function(){M.elementQueriesSetupInformation.call()}))}function O(M,F,Q,E){if(void 0===q[M]){q[M]=[];var U=V.length;he.innerHTML+="\n"+M+" {animation: 0.1s element-queries;}",he.innerHTML+="\n"+M+" > .resize-sensor {min-width: "+U+"px;}",V.push(M)}q[M].push({mode:F,property:Q,value:E})}function T(M){var F;if(document.querySelectorAll&&(F=M?M.querySelectorAll.bind(M):document.querySelectorAll.bind(document)),!F&&"undefined"!=typeof $$&&(F=$$),!F&&"undefined"!=typeof jQuery&&(F=jQuery),!F)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return F}function y(M){var F=[],Q=[],E=[],U=0,ie=-1,ue=[];for(var ee in M.children)if(M.children.hasOwnProperty(ee)&&M.children[ee].tagName&&"img"===M.children[ee].tagName.toLowerCase()){F.push(M.children[ee]);var se=M.children[ee].getAttribute("min-width")||M.children[ee].getAttribute("data-min-width"),Te=M.children[ee].getAttribute("data-src")||M.children[ee].getAttribute("url");E.push(Te),Q.push({minWidth:se}),se?M.children[ee].style.display="none":(U=F.length-1,M.children[ee].style.display="block")}function te(){var Me,ye=!1;for(Me in F)!F.hasOwnProperty(Me)||Q[Me].minWidth&&M.offsetWidth>Q[Me].minWidth&&(ye=Me);if(ye||(ye=U),ie!==ye)if(ue[ye])F[ie].style.display="none",F[ye].style.display="block",ie=ye;else{var Ve=new Image;Ve.onload=function(){F[ye].src=E[ye],F[ie].style.display="none",F[ye].style.display="block",ue[ye]=!0,ie=ye},Ve.src=E[ye]}else F[ye].src=E[ye]}ie=U,M.resizeSensorInstance=new dt(M,te),te()}var D=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,j=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function I(M){var F,Q,E,U;for(M=M.replace(/'/g,'"');null!==(F=D.exec(M));)for(Q=F[1]+F[3],E=F[2];null!==(U=j.exec(E));)O(Q,U[1],U[2],U[3])}function H(M){var F="";if(M)if("string"==typeof M)(-1!==(M=M.toLowerCase()).indexOf("min-width")||-1!==M.indexOf("max-width"))&&I(M);else for(var Q=0,E=M.length;Q<E;Q++)1===M[Q].type?(-1!==(F=M[Q].selectorText||M[Q].cssText).indexOf("min-height")||-1!==F.indexOf("max-height")||-1!==F.indexOf("min-width")||-1!==F.indexOf("max-width"))&&I(F):4===M[Q].type?H(M[Q].cssRules||M[Q].rules):3===M[Q].type&&M[Q].styleSheet.hasOwnProperty("cssRules")&&H(M[Q].styleSheet.cssRules)}var Y=!1;this.init=function(){var M="animationstart";void 0!==document.documentElement.style.webkitAnimationName?M="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?M="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(M="oanimationstart"),document.body.addEventListener(M,function(E){var U=E.target,ie=U&&window.getComputedStyle(U,null),ue=ie&&ie.getPropertyValue("animation-name");if(ue&&-1!==ue.indexOf("element-queries")){U.elementQueriesSensor=new dt(U,function(){U.elementQueriesSetupInformation&&U.elementQueriesSetupInformation.call()});var Te=window.getComputedStyle(U.resizeSensor,null).getPropertyValue("min-width");Te=parseInt(Te.replace("px","")),S(E.target,V[Te])}}),Y||((he=document.createElement("style")).type="text/css",he.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",he.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(he),Y=!0);for(var F=0,Q=document.styleSheets.length;F<Q;F++)try{document.styleSheets[F].href&&0===document.styleSheets[F].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[F].href),H(document.styleSheets[F].cssRules||document.styleSheets[F].rules||document.styleSheets[F].cssText)}catch(E){}!function(){for(var F=T()("[data-responsive-image],[responsive-image]"),Q=0,E=F.length;Q<E;Q++)y(F[Q])}()},this.findElementQueriesElements=function(M){!function(M){var F=T(M);for(var Q in q)if(q.hasOwnProperty(Q))for(var E=F(Q,M),U=0,ie=E.length;U<ie;U++)S(E[U],Q)}(M)},this.update=function(){this.init()}};K.update=function(){K.instance.update()},K.detach=function(he){he.elementQueriesSetupInformation?(he.elementQueriesSensor.detach(),delete he.elementQueriesSetupInformation,delete he.elementQueriesSensor):he.resizeSensorInstance&&(he.resizeSensorInstance.detach(),delete he.resizeSensorInstance)},K.init=function(){K.instance||(K.instance=new K),K.instance.init()};return K.findElementQueriesElements=function(he){K.instance.findElementQueriesElements(he)},K.listen=function(){!function(he){if(document.addEventListener)document.addEventListener("DOMContentLoaded",he,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var q=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(he(),clearInterval(q))},10);else window.onload=he}(K.init)},K})?gt.apply(it,J):gt)&&(kt.exports=At)},835:function(kt,it,tt){"use strict";var gt,J;"undefined"!=typeof window&&window,void 0!==(J="function"==typeof(gt=function(){if("undefined"==typeof window)return null;var At="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),dt=At.requestAnimationFrame||At.mozRequestAnimationFrame||At.webkitRequestAnimationFrame||function(re){return At.setTimeout(re,20)},K=At.cancelAnimationFrame||At.mozCancelAnimationFrame||At.webkitCancelAnimationFrame||function(re){At.clearTimeout(re)};function Ae(re,$){var b=Object.prototype.toString.call(re),S="[object Array]"===b||"[object NodeList]"===b||"[object HTMLCollection]"===b||"[object Object]"===b||"undefined"!=typeof jQuery&&re instanceof jQuery||"undefined"!=typeof Elements&&re instanceof Elements,O=0,T=re.length;if(S)for(;O<T;O++)$(re[O]);else $(re)}function he(re){if(!re.getBoundingClientRect)return{width:re.offsetWidth,height:re.offsetHeight};var $=re.getBoundingClientRect();return{width:Math.round($.width),height:Math.round($.height)}}function q(re,$){Object.keys($).forEach(function(b){re.style[b]=$[b]})}var V=function(re,$){var b=0;function S(){var v,y,T=[];this.add=function(w){T.push(w)},this.call=function(w){for(v=0,y=T.length;v<y;v++)T[v].call(this,w)},this.remove=function(w){var D=[];for(v=0,y=T.length;v<y;v++)T[v]!==w&&D.push(T[v]);T=D},this.length=function(){return T.length}}function O(T,v){if(T){if(T.resizedAttached)return void T.resizedAttached.add(v);T.resizedAttached=new S,T.resizedAttached.add(v),T.resizeSensor=document.createElement("div"),T.resizeSensor.dir="ltr",T.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},w={position:"absolute",left:"0px",top:"0px",transition:"0s"};q(T.resizeSensor,y);var D=document.createElement("div");D.className="resize-sensor-expand",q(D,y);var j=document.createElement("div");q(j,w),D.appendChild(j);var I=document.createElement("div");I.className="resize-sensor-shrink",q(I,y);var H=document.createElement("div");q(H,w),q(H,{width:"200%",height:"200%"}),I.appendChild(H),T.resizeSensor.appendChild(D),T.resizeSensor.appendChild(I),T.appendChild(T.resizeSensor);var Y=window.getComputedStyle(T),M=Y?Y.getPropertyValue("position"):null;"absolute"!==M&&"relative"!==M&&"fixed"!==M&&"sticky"!==M&&(T.style.position="relative");var F=!1,Q=0,E=he(T),U=0,ie=0,ue=!0;b=0;var se=function(){if(ue){if(0===T.offsetWidth&&0===T.offsetHeight)return void(b||(b=dt(function(){b=0,se()})));ue=!1}var ye,Me;Me=T.offsetHeight,j.style.width=(ye=T.offsetWidth)+10+"px",j.style.height=Me+10+"px",D.scrollLeft=ye+10,D.scrollTop=Me+10,I.scrollLeft=ye+10,I.scrollTop=Me+10};T.resizeSensor.resetSensor=se;var Te=function(){Q=0,F&&(U=E.width,ie=E.height,T.resizedAttached&&T.resizedAttached.call(E))},me=function(){E=he(T),(F=E.width!==U||E.height!==ie)&&!Q&&(Q=dt(Te)),se()},te=function(ye,Me,Ve){ye.attachEvent?ye.attachEvent("on"+Me,Ve):ye.addEventListener(Me,Ve)};te(D,"scroll",me),te(I,"scroll",me),b=dt(function(){b=0,se()})}}Ae(re,function(T){O(T,$)}),this.detach=function(T){b||(K(b),b=0),V.detach(re,T)},this.reset=function(){re.resizeSensor.resetSensor()}};if(V.reset=function(re){Ae(re,function($){$.resizeSensor.resetSensor()})},V.detach=function(re,$){Ae(re,function(b){!b||b.resizedAttached&&"function"==typeof $&&(b.resizedAttached.remove($),b.resizedAttached.length())||b.resizeSensor&&(b.contains(b.resizeSensor)&&b.removeChild(b.resizeSensor),delete b.resizeSensor,delete b.resizedAttached)})},"undefined"!=typeof MutationObserver){var L=new MutationObserver(function(re){for(var $ in re)if(re.hasOwnProperty($))for(var b=re[$].addedNodes,S=0;S<b.length;S++)b[S].resizeSensor&&V.reset(b[S])});document.addEventListener("DOMContentLoaded",function(re){L.observe(document.body,{childList:!0,subtree:!0})})}return V})?gt.call(it,tt,it,kt):gt)&&(kt.exports=J)},445:(kt,it,tt)=>{var gt=tt(910),J=tt(369),At=tt(322);function dt(re,$,b){if(!gt(re))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!re.hasNode($))throw new Error('graphology-shortest-path: the "'+$+'" source node does not exist in the given graph.');if(!re.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" target node does not exist in the given graph.');if(($=""+$)==(b=""+b))return[$];var S=re.inboundNeighbors.bind(re),O=re.outboundNeighbors.bind(re),T={},v={};T[$]=null,v[b]=null;var D,j,I,H,Y,M,F,Q,y=[$],w=[b],E=!1;e:for(;y.length&&w.length;)if(y.length<=w.length){for(D=y,y=[],Y=0,F=D.length;Y<F;Y++)for(M=0,Q=(I=O(j=D[Y])).length;M<Q;M++)if((H=I[M])in T||(y.push(H),T[H]=j),H in v){E=!0;break e}}else for(D=w,w=[],Y=0,F=D.length;Y<F;Y++)for(j=D[Y],I=S(j),M=0,Q=I.length;M<Q;M++)if(H=I[M],H in v||(w.push(H),v[H]=j),H in T){E=!0;break e}if(!E)return null;for(var U=[];H;)U.unshift(H),H=T[H];for(H=v[U[U.length-1]];H;)U.push(H),H=v[H];return U.length?U:null}function K(re,$){if(!gt(re))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!re.hasNode($))throw new Error('graphology-shortest-path: the "'+$+'" source node does not exist in the given graph.');var O,T,v,y,w,D,b={},S={};for(b[$=""+$]=!0,S[$]=[$];Object.keys(b).length;)for(v in O=b,b={},O)for(w=0,D=(T=re.outboundNeighbors(v)).length;w<D;w++)S[y=T[w]]||(S[y]=S[v].concat(y),b[y]=!0);return S}function Ae(re,$,b){if(!gt($))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!$.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" source node does not exist in the given graph.');b=""+b;var S=new Set,O={},T=0;O[b]=0;for(var y,w,D,v=[b];0!==v.length;){var j=[];for(y=0,w=v.length;y<w;y++)!S.has(D=v[y])&&(S.add(D),At(j,$[re](D)),O[D]=T);T++,v=j}return O}var he=Ae.bind(null,"outboundNeighbors"),q=Ae.bind(null,"neighbors");function V(re,$,b){return arguments.length<3?K(re,$):dt(re,$,b)}V.bidirectional=dt,V.singleSource=K,V.singleSourceLength=he,V.undirectedSingleSourceLength=q,V.brandes=function(re,$){$=""+$;var v,y,w,D,j,I,H,Y,M,b=[],S={},O={},T=re.nodes();for(I=0,Y=T.length;I<Y;I++)S[D=T[I]]=[],O[D]=0;var F={};O[$]=1,F[$]=0;for(var Q=J.of($);Q.size;)for(D=Q.dequeue(),b.push(D),v=F[D],y=O[D],H=0,M=(w=re.outboundNeighbors(D)).length;H<M;H++)(j=w[H])in F||(Q.enqueue(j),F[j]=v+1),F[j]===v+1&&(O[j]+=y,S[j].push(D));return[b,S,O]},kt.exports=V},910:kt=>{kt.exports=function(tt){return null!==tt&&"object"==typeof tt&&"function"==typeof tt.addUndirectedEdgeWithKey&&"function"==typeof tt.dropNode&&"boolean"==typeof tt.multi}},698:function(kt){kt.exports=function(){"use strict";function it(ne){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(de){return typeof de}:function(de){return de&&"function"==typeof Symbol&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de})(ne)}function tt(ne,de){ne.prototype=Object.create(de.prototype),ne.prototype.constructor=ne,J(ne,de)}function gt(ne){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(de){return de.__proto__||Object.getPrototypeOf(de)})(ne)}function J(ne,de){return(J=Object.setPrototypeOf||function(oe,C){return oe.__proto__=C,oe})(ne,de)}function At(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ne){return!1}}function dt(ne,de,oe){return(dt=At()?Reflect.construct:function(C,P,Z){var we=[null];we.push.apply(we,P);var Fe=new(Function.bind.apply(C,we));return Z&&J(Fe,Z.prototype),Fe}).apply(null,arguments)}function K(ne){var de="function"==typeof Map?new Map:void 0;return(K=function(oe){if(null===oe||-1===Function.toString.call(oe).indexOf("[native code]"))return oe;if("function"!=typeof oe)throw new TypeError("Super expression must either be null or a function");if(void 0!==de){if(de.has(oe))return de.get(oe);de.set(oe,P)}function P(){return dt(oe,arguments,gt(this).constructor)}return P.prototype=Object.create(oe.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),J(P,oe)})(ne)}function Ae(ne){if(void 0===ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne}var he=function(){for(var ne=arguments[0],de=1,oe=arguments.length;de<oe;de++)if(arguments[de])for(var C in arguments[de])ne[C]=arguments[de][C];return ne};function q(ne,de,oe,C){var P=ne._nodes.get(de),Z=null;return P?Z="mixed"===C?P.out&&P.out[oe]||P.undirected&&P.undirected[oe]:"directed"===C?P.out&&P.out[oe]:P.undirected&&P.undirected[oe]:Z}function V(ne){return null!==ne&&"object"===it(ne)&&"function"==typeof ne.addUndirectedEdgeWithKey&&"function"==typeof ne.dropNode}function L(ne){return"object"===it(ne)&&null!==ne&&ne.constructor===Object}function re(ne){var de;for(de in ne)return!1;return!0}function $(ne,de,oe){Object.defineProperty(ne,de,{enumerable:!1,configurable:!1,writable:!0,value:oe})}function b(ne,de,oe){var C={enumerable:!0,configurable:!0};"function"==typeof oe?C.get=oe:(C.value=oe,C.writable=!1),Object.defineProperty(ne,de,C)}function S(ne){return!(!L(ne)||ne.attributes&&!Array.isArray(ne.attributes))}"function"==typeof Object.assign&&(he=Object.assign);var O,T={exports:{}},v="object"==typeof Reflect?Reflect:null,y=v&&"function"==typeof v.apply?v.apply:function(ne,de,oe){return Function.prototype.apply.call(ne,de,oe)};O=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(ne){return Object.getOwnPropertyNames(ne).concat(Object.getOwnPropertySymbols(ne))}:function(ne){return Object.getOwnPropertyNames(ne)};var w=Number.isNaN||function(ne){return ne!=ne};function D(){D.init.call(this)}T.exports=D,T.exports.once=function(ne,de){return new Promise(function(oe,C){function P(we){ne.removeListener(de,Z),C(we)}function Z(){"function"==typeof ne.removeListener&&ne.removeListener("error",P),oe([].slice.call(arguments))}var we;ie(ne,de,Z,{once:!0}),"error"!==de&&("function"==typeof(we=ne).on&&ie(we,"error",P,{once:!0}))})},D.EventEmitter=D,D.prototype._events=void 0,D.prototype._eventsCount=0,D.prototype._maxListeners=void 0;var j=10;function I(ne){if("function"!=typeof ne)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ne)}function H(ne){return void 0===ne._maxListeners?D.defaultMaxListeners:ne._maxListeners}function Y(ne,de,oe,C){var P,Z,we;if(I(oe),void 0===(Z=ne._events)?(Z=ne._events=Object.create(null),ne._eventsCount=0):(void 0!==Z.newListener&&(ne.emit("newListener",de,oe.listener?oe.listener:oe),Z=ne._events),we=Z[de]),void 0===we)we=Z[de]=oe,++ne._eventsCount;else if("function"==typeof we?we=Z[de]=C?[oe,we]:[we,oe]:C?we.unshift(oe):we.push(oe),(P=H(ne))>0&&we.length>P&&!we.warned){we.warned=!0;var et=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+String(de)+" listeners added. Use emitter.setMaxListeners() to increase limit");et.name="MaxListenersExceededWarning",et.emitter=ne,et.type=de,et.count=we.length,console&&console.warn&&console.warn(et)}return ne}function M(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function F(ne,de,oe){var C={fired:!1,wrapFn:void 0,target:ne,type:de,listener:oe},P=M.bind(C);return P.listener=oe,C.wrapFn=P,P}function Q(ne,de,oe){var C=ne._events;if(void 0===C)return[];var P=C[de];return void 0===P?[]:"function"==typeof P?oe?[P.listener||P]:[P]:oe?function(Z){for(var we=new Array(Z.length),Fe=0;Fe<we.length;++Fe)we[Fe]=Z[Fe].listener||Z[Fe];return we}(P):U(P,P.length)}function E(ne){var de=this._events;if(void 0!==de){var oe=de[ne];if("function"==typeof oe)return 1;if(void 0!==oe)return oe.length}return 0}function U(ne,de){for(var oe=new Array(de),C=0;C<de;++C)oe[C]=ne[C];return oe}function ie(ne,de,oe,C){if("function"==typeof ne.on)C.once?ne.once(de,oe):ne.on(de,oe);else{if("function"!=typeof ne.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ne);ne.addEventListener(de,function P(Z){C.once&&ne.removeEventListener(de,P),oe(Z)})}}function ue(ne){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:ne}),this.done=!1}Object.defineProperty(D,"defaultMaxListeners",{enumerable:!0,get:function(){return j},set:function(ne){if("number"!=typeof ne||ne<0||w(ne))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ne+".");j=ne}}),D.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},D.prototype.setMaxListeners=function(ne){if("number"!=typeof ne||ne<0||w(ne))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ne+".");return this._maxListeners=ne,this},D.prototype.getMaxListeners=function(){return H(this)},D.prototype.emit=function(ne){for(var de=[],oe=1;oe<arguments.length;oe++)de.push(arguments[oe]);var C="error"===ne,P=this._events;if(void 0!==P)C=C&&void 0===P.error;else if(!C)return!1;if(C){var Z;if(de.length>0&&(Z=de[0]),Z instanceof Error)throw Z;var we=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw we.context=Z,we}var Fe=P[ne];if(void 0===Fe)return!1;if("function"==typeof Fe)y(Fe,this,de);else{var et=Fe.length,Mt=U(Fe,et);for(oe=0;oe<et;++oe)y(Mt[oe],this,de)}return!0},D.prototype.on=D.prototype.addListener=function(ne,de){return Y(this,ne,de,!1)},D.prototype.prependListener=function(ne,de){return Y(this,ne,de,!0)},D.prototype.once=function(ne,de){return I(de),this.on(ne,F(this,ne,de)),this},D.prototype.prependOnceListener=function(ne,de){return I(de),this.prependListener(ne,F(this,ne,de)),this},D.prototype.off=D.prototype.removeListener=function(ne,de){var oe,C,P,Z,we;if(I(de),void 0===(C=this._events))return this;if(void 0===(oe=C[ne]))return this;if(oe===de||oe.listener===de)0==--this._eventsCount?this._events=Object.create(null):(delete C[ne],C.removeListener&&this.emit("removeListener",ne,oe.listener||de));else if("function"!=typeof oe){for(P=-1,Z=oe.length-1;Z>=0;Z--)if(oe[Z]===de||oe[Z].listener===de){we=oe[Z].listener,P=Z;break}if(P<0)return this;0===P?oe.shift():function(Fe,et){for(;et+1<Fe.length;et++)Fe[et]=Fe[et+1];Fe.pop()}(oe,P),1===oe.length&&(C[ne]=oe[0]),void 0!==C.removeListener&&this.emit("removeListener",ne,we||de)}return this},D.prototype.removeAllListeners=function(ne){var de,oe,C;if(void 0===(oe=this._events))return this;if(void 0===oe.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==oe[ne]&&(0==--this._eventsCount?this._events=Object.create(null):delete oe[ne]),this;if(0===arguments.length){var P,Z=Object.keys(oe);for(C=0;C<Z.length;++C)"removeListener"!==(P=Z[C])&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(de=oe[ne]))this.removeListener(ne,de);else if(void 0!==de)for(C=de.length-1;C>=0;C--)this.removeListener(ne,de[C]);return this},D.prototype.listeners=function(ne){return Q(this,ne,!0)},D.prototype.rawListeners=function(ne){return Q(this,ne,!1)},D.listenerCount=function(ne,de){return"function"==typeof ne.listenerCount?ne.listenerCount(de):E.call(ne,de)},D.prototype.listenerCount=E,D.prototype.eventNames=function(){return this._eventsCount>0?O(this._events):[]},ue.prototype.next=function(){if(this.done)return{done:!0};var ne=this._next();return ne.done&&(this.done=!0),ne},"undefined"!=typeof Symbol&&(ue.prototype[Symbol.iterator]=function(){return this}),ue.of=function(){var ne=arguments,de=ne.length,oe=0;return new ue(function(){return oe>=de?{done:!0}:{done:!1,value:ne[oe++]}})},ue.empty=function(){var ne=new ue(null);return ne.done=!0,ne},ue.is=function(ne){return ne instanceof ue||"object"==typeof ne&&null!==ne&&"function"==typeof ne.next};var ee=ue,se=function(ne,de){for(var oe,C=arguments.length>1?de:1/0,P=C!==1/0?new Array(C):[],Z=0;;){if(Z===C)return P;if((oe=ne.next()).done)return Z!==de?P.slice(0,Z):P;P[Z++]=oe.value}},Te=function(ne){function de(oe,C){var P;return(P=ne.call(this)||this).name="GraphError",P.message=oe||"",P.data=C||{},P}return tt(de,ne),de}(K(Error)),me=function(ne){function de(oe,C){var P;return(P=ne.call(this,oe,C)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(P),de.prototype.constructor),P}return tt(de,ne),de}(Te),te=function(ne){function de(oe,C){var P;return(P=ne.call(this,oe,C)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(P),de.prototype.constructor),P}return tt(de,ne),de}(Te),ye=function(ne){function de(oe,C){var P;return(P=ne.call(this,oe,C)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(P),de.prototype.constructor),P}return tt(de,ne),de}(Te);function Me(ne,de){this.key=ne,this.attributes=de,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function Ve(ne,de){this.key=ne,this.attributes=de,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function nt(ne,de){this.key=ne,this.attributes=de,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Ze(ne,de,oe,C,P,Z){this.key=de,this.attributes=Z,this.undirected=ne,this.source=C,this.target=P,this.generatedKey=oe}function Je(ne,de,oe,C,P,Z,we){var Fe,et,Mt="out",We="in";if(de&&(Mt=We="undirected"),ne.multi){if(void 0===(et=(Fe=Z[Mt])[P])&&(et=new Set,Fe[P]=et),et.add(oe),C===P&&de)return;void 0===(Fe=we[We])[C]&&(Fe[C]=et)}else{if(Z[Mt][P]=oe,C===P&&de)return;we[We][C]=oe}}function Ye(ne,de,oe){var C=ne.multi,P=oe.source,Z=oe.target,we=P.key,Fe=Z.key,et=P[de?"undirected":"out"],Mt=de?"undirected":"in";if(Fe in et)if(C){var We=et[Fe];1===We.size?(delete et[Fe],delete Z[Mt][we]):We.delete(oe)}else delete et[Fe];C||delete Z[Mt][we]}Ve.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},nt.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var je=[{name:function(ne){return"get".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new ye("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=q(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return Z.attributes[P]}}},{name:function(ne){return"get".concat(ne,"Attributes")},attacher:function(ne,de,oe){ne.prototype[de]=function(C){var P;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new ye("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new ye("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Z=""+C,we=""+arguments[1];if(!(P=q(this,Z,we,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Z,'" - "').concat(we,'").'))}else if(!(P=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&P.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return P.attributes}}},{name:function(ne){return"has".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new ye("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=q(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return Z.attributes.hasOwnProperty(P)}}},{name:function(ne){return"set".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P,Z){var we;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new ye("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new ye("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+C,et=""+P;if(P=arguments[2],Z=arguments[3],!(we=q(this,Fe,et,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(et,'").'))}else if(!(we=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&we.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return we.attributes[P]=Z,this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:P}),this}}},{name:function(ne){return"update".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P,Z){var we;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new ye("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new ye("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+C,et=""+P;if(P=arguments[2],Z=arguments[3],!(we=q(this,Fe,et,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(et,'").'))}else if(!(we=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("function"!=typeof Z)throw new me("Graph.".concat(de,": updater should be a function."));if("mixed"!==oe&&we.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return we.attributes[P]=Z(we.attributes[P]),this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:P}),this}}},{name:function(ne){return"remove".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new ye("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=q(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return delete Z.attributes[P],this.emit("edgeAttributesUpdated",{key:Z.key,type:"remove",attributes:Z.attributes,name:P}),this}}},{name:function(ne){return"replace".concat(ne,"Attributes")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new ye("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=q(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if(!L(P))throw new me("Graph.".concat(de,": provided attributes are not a plain object."));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return Z.attributes=P,this.emit("edgeAttributesUpdated",{key:Z.key,type:"replace",attributes:Z.attributes}),this}}},{name:function(ne){return"merge".concat(ne,"Attributes")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new ye("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new ye("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=q(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if(!L(P))throw new me("Graph.".concat(de,": provided attributes are not a plain object."));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return he(Z.attributes,P),this.emit("edgeAttributesUpdated",{key:Z.key,type:"merge",attributes:Z.attributes,data:P}),this}}}],Le=ee,Ee=function(){var ne,de=arguments,oe=-1;return new Le(function C(){if(!ne){if(++oe>=de.length)return{done:!0};ne=de[oe]}var P=ne.next();return P.done?(ne=null,C()):P})},Re=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Ue(ne,de){for(var oe in de)ne.push(de[oe].key)}function qe(ne,de){for(var oe in de)de[oe].forEach(function(C){return ne.push(C.key)})}function Be(ne,de,oe){for(var C in ne)if(C!==oe){var P=ne[C];de(P.key,P.attributes,P.source.key,P.target.key,P.source.attributes,P.target.attributes,P.undirected,P.generatedKey)}}function z(ne,de,oe){for(var C in ne)C!==oe&&ne[C].forEach(function(P){return de(P.key,P.attributes,P.source.key,P.target.key,P.source.attributes,P.target.attributes,P.undirected,P.generatedKey)})}function X(ne,de,oe){for(var C in ne)if(C!==oe){var P=ne[C];if(de(P.key,P.attributes,P.source.key,P.target.key,P.source.attributes,P.target.attributes,P.undirected,P.generatedKey))return!0}return!1}function be(ne,de,oe){var C,P,Z,we,Fe;for(var et in ne)if(et!==oe)for(C=ne[et].values();!0!==(P=C.next()).done;)if(we=(Z=P.value).source,de(Z.key,Z.attributes,we.key,(Fe=Z.target).key,we.attributes,Fe.attributes,Z.undirected,Z.generatedKey))return!0;return!1}function ce(ne,de){var oe=Object.keys(ne),C=oe.length,P=null,Z=0;return new ee(function we(){var Fe;if(P){var et=P.next();if(et.done)return P=null,Z++,we();Fe=et.value}else{if(Z>=C)return{done:!0};var Mt=oe[Z];if(Mt===de)return Z++,we();if((Fe=ne[Mt])instanceof Set)return P=Fe.values(),we();Z++}return{done:!1,value:[Fe.key,Fe.attributes,Fe.source.key,Fe.target.key,Fe.source.attributes,Fe.target.attributes]}})}function Pe(ne,de,oe){var C=de[oe];C&&ne.push(C.key)}function wt(ne,de,oe){var C=de[oe];C&&C.forEach(function(P){return ne.push(P.key)})}function pt(ne,de,oe){var C=ne[de];if(C){var P=C.source,Z=C.target;oe(C.key,C.attributes,P.key,Z.key,P.attributes,Z.attributes,C.undirected,C.generatedKey)}}function fe(ne,de,oe){var C=ne[de];C&&C.forEach(function(P){return oe(P.key,P.attributes,P.source.key,P.target.key,P.source.attributes,P.target.attributes,P.undirected,P.generatedKey)})}function B(ne,de,oe){var C=ne[de];if(C){var P=C.source,Z=C.target;return oe(C.key,C.attributes,P.key,Z.key,P.attributes,Z.attributes,C.undirected,C.generatedKey)}}function R(ne,de,oe){var C=ne[de];if(C){for(var P,Z,we=C.values();!0!==(P=we.next()).done;)if(oe((Z=P.value).key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes,Z.undirected,Z.generatedKey))return!0;return!1}}function k(ne,de){var oe=ne[de];if(oe instanceof Set){var C=oe.values();return new ee(function(){var P=C.next();if(P.done)return P;var Z=P.value;return{done:!1,value:[Z.key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes]}})}return ee.of([oe.key,oe.attributes,oe.source.key,oe.target.key,oe.source.attributes,oe.target.attributes])}function Oe(ne,de){if(0===ne.size)return[];if("mixed"===de||de===ne.type)return"function"==typeof Array.from?Array.from(ne._edges.keys()):se(ne._edges.keys(),ne._edges.size);for(var oe,C,Z=new Array("undirected"===de?ne.undirectedSize:ne.directedSize),we="undirected"===de,Fe=ne._edges.values(),et=0;!0!==(oe=Fe.next()).done;)(C=oe.value).undirected===we&&(Z[et++]=C.key);return Z}function Xe(ne,de,oe){if(0!==ne.size)for(var C,P,Z="mixed"!==de&&de!==ne.type,we="undirected"===de,Fe=ne._edges.values();!0!==(C=Fe.next()).done;)if(P=C.value,!Z||P.undirected===we){var zt=P.source,Et=P.target;oe(P.key,P.attributes,zt.key,Et.key,zt.attributes,Et.attributes,P.undirected,P.generatedKey)}}function yt(ne,de,oe){if(0!==ne.size)for(var C,P,Z="mixed"!==de&&de!==ne.type,we="undirected"===de,Fe=ne._edges.values();!0!==(C=Fe.next()).done;)if(P=C.value,!Z||P.undirected===we){var zt=P.source,Et=P.target;if(oe(P.key,P.attributes,zt.key,Et.key,zt.attributes,Et.attributes,P.undirected,P.generatedKey))break}}function It(ne,de){if(0===ne.size)return ee.empty();var oe="mixed"!==de&&de!==ne.type,C="undirected"===de,P=ne._edges.values();return new ee(function(){for(var Z,we;;){if((Z=P.next()).done)return Z;if(we=Z.value,!oe||we.undirected===C)break}return{value:[we.key,we.attributes,we.source.key,we.target.key,we.source.attributes,we.target.attributes],done:!1}})}function Tn(ne,de,oe,C){var P=[],Z=ne?qe:Ue;return"undirected"!==de&&("out"!==oe&&Z(P,C.in),"in"!==oe&&Z(P,C.out),!oe&&C.directedSelfLoops>0&&P.splice(P.lastIndexOf(C.key),1)),"directed"!==de&&Z(P,C.undirected),P}function Pn(ne,de,oe,C,P){var Z=ne?z:Be;"undirected"!==de&&("out"!==oe&&Z(C.in,P),"in"!==oe&&Z(C.out,P,oe?null:C.key)),"directed"!==de&&Z(C.undirected,P)}function $n(ne,de,oe,C,P){var Z=ne?be:X;"undirected"!==de&&("out"!==oe&&Z(C.in,P)||"in"!==oe&&Z(C.out,P,oe?null:C.key))||"directed"===de||Z(C.undirected,P)}function yi(ne,de,oe){var C=ee.empty();return"undirected"!==ne&&("out"!==de&&void 0!==oe.in&&(C=Ee(C,ce(oe.in))),"in"!==de&&void 0!==oe.out&&(C=Ee(C,ce(oe.out,de?null:oe.key)))),"directed"!==ne&&void 0!==oe.undirected&&(C=Ee(C,ce(oe.undirected))),C}function hi(ne,de,oe,C,P){var Z=de?wt:Pe,we=[];return"undirected"!==ne&&(void 0!==C.in&&"out"!==oe&&Z(we,C.in,P),void 0!==C.out&&"in"!==oe&&Z(we,C.out,P),!oe&&C.directedSelfLoops>0&&we.splice(we.lastIndexOf(C.key),1)),"directed"!==ne&&void 0!==C.undirected&&Z(we,C.undirected,P),we}function Hr(ne,de,oe,C,P,Z){var we=de?fe:pt;"undirected"!==ne&&(void 0!==C.in&&"out"!==oe&&we(C.in,P,Z),C.key!==P&&void 0!==C.out&&"in"!==oe&&we(C.out,P,Z)),"directed"!==ne&&void 0!==C.undirected&&we(C.undirected,P,Z)}function Ns(ne,de,oe,C,P,Z){var we=de?R:B;"undirected"!==ne&&(void 0!==C.in&&"out"!==oe&&we(C.in,P,Z)||C.key!==P&&void 0!==C.out&&"in"!==oe&&we(C.out,P,Z,oe?null:C.key))||"directed"===ne||void 0===C.undirected||we(C.undirected,P,Z)}function cs(ne,de,oe,C){var P=ee.empty();return"undirected"!==ne&&(void 0!==oe.in&&"out"!==de&&C in oe.in&&(P=Ee(P,k(oe.in,C))),void 0!==oe.out&&"in"!==de&&C in oe.out&&(P=Ee(P,k(oe.out,C)))),"directed"!==ne&&void 0!==oe.undirected&&C in oe.undirected&&(P=Ee(P,k(oe.undirected,C))),P}var Ps=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Gr(ne,de){if(void 0!==de)for(var oe in de)ne.add(oe)}function qa(ne,de,oe){if("mixed"!==ne){if("undirected"===ne)return Object.keys(oe.undirected);if("string"==typeof de)return Object.keys(oe[de])}var C=new Set;return"undirected"!==ne&&("out"!==de&&Gr(C,oe.in),"in"!==de&&Gr(C,oe.out)),"directed"!==ne&&Gr(C,oe.undirected),se(C.values(),C.size)}function Al(ne,de,oe){for(var C in de){var P=de[C];P instanceof Set&&(P=P.values().next().value);var Z=P.source,Fe=Z===ne?P.target:Z;oe(Fe.key,Fe.attributes)}}function ua(ne,de,oe,C){for(var P in oe){var Z=oe[P];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===de?Z.target:we;ne.has(et.key)||(ne.add(et.key),C(et.key,et.attributes))}}function ms(ne,de,oe){for(var C in de){var P=de[C];P instanceof Set&&(P=P.values().next().value);var Z=P.source,Fe=Z===ne?P.target:Z;if(oe(Fe.key,Fe.attributes))return!0}return!1}function Qt(ne,de,oe,C){for(var P in oe){var Z=oe[P];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===de?Z.target:we;if(!ne.has(et.key)&&(ne.add(et.key),C(et.key,et.attributes)))return!0}return!1}function Ka(ne,de){var oe=Object.keys(de),C=oe.length,P=0;return new ee(function(){if(P>=C)return{done:!0};var Z=de[oe[P++]];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===ne?Z.target:we;return{done:!1,value:[et.key,et.attributes]}})}function rt(ne,de,oe){var C=Object.keys(oe),P=C.length,Z=0;return new ee(function we(){if(Z>=P)return{done:!0};var Fe=oe[C[Z++]];Fe instanceof Set&&(Fe=Fe.values().next().value);var et=Fe.source,We=et===de?Fe.target:et;return ne.has(We.key)?we():(ne.add(We.key),{done:!1,value:[We.key,We.attributes]})})}function ot(ne,de,oe,C,P){var Z=ne._nodes.get(C);if("undirected"!==de){if("out"!==oe&&void 0!==Z.in)for(var we in Z.in)if(we===P)return!0;if("in"!==oe&&void 0!==Z.out)for(var Fe in Z.out)if(Fe===P)return!0}if("directed"!==de&&void 0!==Z.undirected)for(var et in Z.undirected)if(et===P)return!0;return!1}function ke(ne,de,oe){for(var C,P,Z,we,Fe,et,Mt,We=de._nodes.values(),zt=de.type;!0!==(C=We.next()).done;){if(P=C.value,"undirected"!==zt)for(Z in we=P.out)if(et=(Fe=we[Z]).target,Mt=oe(P.key,et.key,P.attributes,et.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ne&&Mt)return;if("directed"!==zt)for(Z in we=P.undirected)if((et=(Fe=we[Z]).target).key!==Z&&(et=Fe.source),Mt=oe(P.key,et.key,P.attributes,et.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ne&&Mt)return}}function ct(ne,de,oe){for(var C,P,Z,we,Fe,et,Mt,We,zt,Et=de._nodes.values(),pn=de.type;!0!==(C=Et.next()).done;){if(P=C.value,"undirected"!==pn)for(Z in et=P.out)for(we=et[Z].values();!0!==(Fe=we.next()).done;)if(We=(Mt=Fe.value).target,zt=oe(P.key,We.key,P.attributes,We.attributes,Mt.key,Mt.attributes,Mt.undirected,Mt.generatedKey),ne&&zt)return;if("directed"!==pn)for(Z in et=P.undirected)for(we=et[Z].values();!0!==(Fe=we.next()).done;)if((We=(Mt=Fe.value).target).key!==Z&&(We=Mt.source),zt=oe(P.key,We.key,P.attributes,We.attributes,Mt.key,Mt.attributes,Mt.undirected,Mt.generatedKey),ne&&zt)return}}function Qe(ne,de){var oe={key:ne};return re(de.attributes)||(oe.attributes=he({},de.attributes)),oe}function vt(ne,de){var oe={source:de.source.key,target:de.target.key};return de.generatedKey||(oe.key=ne),re(de.attributes)||(oe.attributes=he({},de.attributes)),de.undirected&&(oe.undirected=!0),oe}function xt(ne){return L(ne)?"key"in ne?!("attributes"in ne)||L(ne.attributes)&&null!==ne.attributes?null:"invalid-attributes":"no-key":"not-object"}function Tt(ne){return L(ne)?"source"in ne?"target"in ne?!("attributes"in ne)||L(ne.attributes)&&null!==ne.attributes?"undirected"in ne&&"boolean"!=typeof ne.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var $t=new Set(["directed","undirected","mixed"]),jn=new Set(["domain","_events","_eventsCount","_maxListeners"]),ii={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function Mn(ne,de,oe){var C=new ne.NodeDataClass(de,oe);return ne._nodes.set(de,C),ne.emit("nodeAdded",{key:de,attributes:oe}),C}function fn(ne,de,oe,C,P,Z,we,Fe){if(!C&&"undirected"===ne.type)throw new ye("Graph.".concat(de,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(C&&"directed"===ne.type)throw new ye("Graph.".concat(de,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe&&!L(Fe))throw new me("Graph.".concat(de,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));if(Z=""+Z,we=""+we,Fe=Fe||{},!ne.allowSelfLoops&&Z===we)throw new ye("Graph.".concat(de,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var et=ne._nodes.get(Z),Mt=ne._nodes.get(we);if(!et)throw new te("Graph.".concat(de,': source node "').concat(Z,'" not found.'));if(!Mt)throw new te("Graph.".concat(de,': target node "').concat(we,'" not found.'));var We={key:null,undirected:C,source:Z,target:we,attributes:Fe};if(oe&&(P=ne._edgeKeyGenerator(We)),ne._edges.has(P=""+P))throw new ye("Graph.".concat(de,': the "').concat(P,'" edge already exists in the graph.'));if(!ne.multi&&(C?void 0!==et.undirected[we]:void 0!==et.out[we]))throw new ye("Graph.".concat(de,': an edge linking "').concat(Z,'" to "').concat(we,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var zt=new Ze(C,P,oe,et,Mt,Fe);return ne._edges.set(P,zt),Z===we?C?(et.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(et.directedSelfLoops++,ne._directedSelfLoopCount++):C?(et.undirectedDegree++,Mt.undirectedDegree++):(et.outDegree++,Mt.inDegree++),Je(ne,C,zt,Z,we,et,Mt),C?ne._undirectedSize++:ne._directedSize++,We.key=P,ne.emit("edgeAdded",We),P}function zn(ne,de,oe,C,P,Z,we,Fe,et){if(!C&&"undirected"===ne.type)throw new ye("Graph.".concat(de,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(C&&"directed"===ne.type)throw new ye("Graph.".concat(de,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe)if(et){if("function"!=typeof Fe)throw new me("Graph.".concat(de,': invalid updater function. Expecting a function but got "').concat(Fe,'"'))}else if(!L(Fe))throw new me("Graph.".concat(de,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));var Mt;if(Z=""+Z,we=""+we,et&&(Mt=Fe,Fe=void 0),!ne.allowSelfLoops&&Z===we)throw new ye("Graph.".concat(de,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var We,zt,Et=ne._nodes.get(Z),pn=ne._nodes.get(we);if(!oe&&(We=ne._edges.get(P))){if(We.source.key!==Z||We.target.key!==we||C&&(We.source.key!==we||We.target.key!==Z))throw new ye("Graph.".concat(de,': inconsistency detected when attempting to merge the "').concat(P,'" edge with "').concat(Z,'" source & "').concat(we,'" target vs. ("').concat(We.source.key,'", "').concat(We.target.key,'").'));zt=We}if(zt||ne.multi||!Et||(zt=C?Et.undirected[we]:Et.out[we]),zt)return(et?Mt:Fe)?(et?(zt.attributes=Mt(zt.attributes),ne.emit("edgeAttributesUpdated",{type:"replace",key:zt.key,attributes:zt.attributes})):(he(zt.attributes,Fe),ne.emit("edgeAttributesUpdated",{type:"merge",key:zt.key,attributes:zt.attributes,data:Fe})),zt.key):zt.key;Fe=Fe||{},et&&Mt&&(Fe=Mt(Fe));var Wr={key:null,undirected:C,source:Z,target:we,attributes:Fe};if(oe&&(P=ne._edgeKeyGenerator(Wr)),ne._edges.has(P=""+P))throw new ye("Graph.".concat(de,': the "').concat(P,'" edge already exists in the graph.'));return Et||(Et=Mn(ne,Z,{}),Z===we&&(pn=Et)),pn||(pn=Mn(ne,we,{})),We=new Ze(C,P,oe,Et,pn,Fe),ne._edges.set(P,We),Z===we?C?(Et.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(Et.directedSelfLoops++,ne._directedSelfLoopCount++):C?(Et.undirectedDegree++,pn.undirectedDegree++):(Et.outDegree++,pn.inDegree++),Je(ne,C,We,Z,we,Et,pn),C?ne._undirectedSize++:ne._directedSize++,Wr.key=P,ne.emit("edgeAdded",Wr),P}var ne,bn=function(ne){function de(C){var P;if(P=ne.call(this)||this,(C=he({},ii,C)).edgeKeyGenerator&&"function"!=typeof C.edgeKeyGenerator)throw new me("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(C.edgeKeyGenerator,'".'));if("boolean"!=typeof C.multi)throw new me("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(C.multi,'".'));if(!$t.has(C.type))throw new me('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(C.type,'".'));if("boolean"!=typeof C.allowSelfLoops)throw new me("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(C.allowSelfLoops,'".'));var Z,we="mixed"===C.type?Me:"directed"===C.type?Ve:nt;return $(Ae(P),"NodeDataClass",we),$(Ae(P),"_attributes",{}),$(Ae(P),"_nodes",new Map),$(Ae(P),"_edges",new Map),$(Ae(P),"_directedSize",0),$(Ae(P),"_undirectedSize",0),$(Ae(P),"_directedSelfLoopCount",0),$(Ae(P),"_undirectedSelfLoopCount",0),$(Ae(P),"_edgeKeyGenerator",C.edgeKeyGenerator||(Z=0,function(){return Z++})),$(Ae(P),"_options",C),jn.forEach(function(Fe){return $(Ae(P),Fe,P[Fe])}),b(Ae(P),"order",function(){return P._nodes.size}),b(Ae(P),"size",function(){return P._edges.size}),b(Ae(P),"directedSize",function(){return P._directedSize}),b(Ae(P),"undirectedSize",function(){return P._undirectedSize}),b(Ae(P),"selfLoopCount",function(){return P._directedSelfLoopCount+P._undirectedSelfLoopCount}),b(Ae(P),"directedSelfLoopCount",function(){return P._directedSelfLoopCount}),b(Ae(P),"undirectedSelfLoopCount",function(){return P._undirectedSelfLoopCount}),b(Ae(P),"multi",P._options.multi),b(Ae(P),"type",P._options.type),b(Ae(P),"allowSelfLoops",P._options.allowSelfLoops),b(Ae(P),"implementation",function(){return"graphology"}),P}tt(de,ne);var oe=de.prototype;return oe.hasNode=function(C){return this._nodes.has(""+C)},oe.hasDirectedEdge=function(C,P){if("undirected"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+C);return!!we&&!we.undirected}if(2===arguments.length){P=""+P;var Fe=this._nodes.get(C=""+C);if(!Fe)return!1;var et=Fe.out[P];return!(!et||this.multi&&!et.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},oe.hasUndirectedEdge=function(C,P){if("directed"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+C);return!!we&&we.undirected}if(2===arguments.length){P=""+P;var Fe=this._nodes.get(C=""+C);if(!Fe)return!1;var et=Fe.undirected[P];return!(!et||this.multi&&!et.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},oe.hasEdge=function(C,P){if(1===arguments.length)return this._edges.has(""+C);if(2===arguments.length){P=""+P;var we=this._nodes.get(C=""+C);if(!we)return!1;var Fe=void 0!==we.out&&we.out[P];return Fe||(Fe=void 0!==we.undirected&&we.undirected[P]),!(!Fe||this.multi&&!Fe.size)}throw new me("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},oe.directedEdge=function(C,P){if("undirected"!==this.type){if(C=""+C,P=""+P,this.multi)throw new ye("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var Z=this._nodes.get(C);if(!Z)throw new te('Graph.directedEdge: could not find the "'.concat(C,'" source node in the graph.'));if(!this._nodes.has(P))throw new te('Graph.directedEdge: could not find the "'.concat(P,'" target node in the graph.'));var we=Z.out&&Z.out[P]||void 0;return we?we.key:void 0}},oe.undirectedEdge=function(C,P){if("directed"!==this.type){if(C=""+C,P=""+P,this.multi)throw new ye("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var Z=this._nodes.get(C);if(!Z)throw new te('Graph.undirectedEdge: could not find the "'.concat(C,'" source node in the graph.'));if(!this._nodes.has(P))throw new te('Graph.undirectedEdge: could not find the "'.concat(P,'" target node in the graph.'));var we=Z.undirected&&Z.undirected[P]||void 0;return we?we.key:void 0}},oe.edge=function(C,P){if(this.multi)throw new ye("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");P=""+P;var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.edge: could not find the "'.concat(C,'" source node in the graph.'));if(!this._nodes.has(P))throw new te('Graph.edge: could not find the "'.concat(P,'" target node in the graph.'));var we=Z.out&&Z.out[P]||Z.undirected&&Z.undirected[P]||void 0;if(we)return we.key},oe.inDegree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new me('Graph.inDegree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.inDegree: could not find the "'.concat(C,'" node in the graph.'));return"undirected"===this.type?0:Z.inDegree+(P?Z.directedSelfLoops:0)},oe.outDegree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new me('Graph.outDegree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.outDegree: could not find the "'.concat(C,'" node in the graph.'));return"undirected"===this.type?0:Z.outDegree+(P?Z.directedSelfLoops:0)},oe.directedDegree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new me('Graph.directedDegree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.directedDegree: could not find the "'.concat(C,'" node in the graph.'));if("undirected"===this.type)return 0;var we=P?Z.directedSelfLoops:0;return Z.inDegree+we+(Z.outDegree+we)},oe.undirectedDegree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new me('Graph.undirectedDegree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.undirectedDegree: could not find the "'.concat(C,'" node in the graph.'));return"directed"===this.type?0:Z.undirectedDegree+2*(P?Z.undirectedSelfLoops:0)},oe.degree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new me('Graph.degree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.degree: could not find the "'.concat(C,'" node in the graph.'));var we=0,Fe=0;return"directed"!==this.type&&(P&&(Fe=Z.undirectedSelfLoops),we+=Z.undirectedDegree+2*Fe),"undirected"!==this.type&&(P&&(Fe=Z.directedSelfLoops),we+=Z.inDegree+Z.outDegree+2*Fe),we},oe.source=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.source: could not find the "'.concat(C,'" edge in the graph.'));return P.source.key},oe.target=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.target: could not find the "'.concat(C,'" edge in the graph.'));return P.target.key},oe.extremities=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.extremities: could not find the "'.concat(C,'" edge in the graph.'));return[P.source.key,P.target.key]},oe.opposite=function(C,P){C=""+C;var Z=this._edges.get(P=""+P);if(!Z)throw new te('Graph.opposite: could not find the "'.concat(P,'" edge in the graph.'));var we=Z.source.key,Fe=Z.target.key;if(C!==we&&C!==Fe)throw new te('Graph.opposite: the "'.concat(C,'" node is not attached to the "').concat(P,'" edge (').concat(we,", ").concat(Fe,")."));return C===we?Fe:we},oe.hasExtremity=function(C,P){P=""+P;var Z=this._edges.get(C=""+C);if(!Z)throw new te('Graph.hasExtremity: could not find the "'.concat(C,'" edge in the graph.'));return Z.source.key===P||Z.target.key===P},oe.isUndirected=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.isUndirected: could not find the "'.concat(C,'" edge in the graph.'));return P.undirected},oe.isDirected=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.isDirected: could not find the "'.concat(C,'" edge in the graph.'));return!P.undirected},oe.isSelfLoop=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.isSelfLoop: could not find the "'.concat(C,'" edge in the graph.'));return P.source===P.target},oe.hasGeneratedKey=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.hasGeneratedKey: could not find the "'.concat(C,'" edge in the graph.'));return P.generatedKey},oe.addNode=function(C,P){return function(Z,we,Fe){if(Fe&&!L(Fe))throw new me('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Fe,'"'));if(Fe=Fe||{},Z._nodes.has(we=""+we))throw new ye('Graph.addNode: the "'.concat(we,'" node already exist in the graph.'));var et=new Z.NodeDataClass(we,Fe);return Z._nodes.set(we,et),Z.emit("nodeAdded",{key:we,attributes:Fe}),et}(this,C,P).key},oe.mergeNode=function(C,P){if(P&&!L(P))throw new me('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(P,'"'));P=P||{};var Z=this._nodes.get(C=""+C);return Z?(P&&(he(Z.attributes,P),this.emit("nodeAttributesUpdated",{type:"merge",key:C,attributes:Z.attributes,data:P})),C):(Z=new this.NodeDataClass(C,P),this._nodes.set(C,Z),this.emit("nodeAdded",{key:C,attributes:P}),C)},oe.updateNode=function(C,P){if(P&&"function"!=typeof P)throw new me('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(P,'"'));var Z=this._nodes.get(C=""+C);if(Z)return P&&(Z.attributes=P(Z.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:C,attributes:Z.attributes})),C;var Fe=P?P({}):{};return Z=new this.NodeDataClass(C,Fe),this._nodes.set(C,Z),this.emit("nodeAdded",{key:C,attributes:Fe}),C},oe.dropNode=function(C){var P=this,Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.dropNode: could not find the "'.concat(C,'" node in the graph.'));this.forEachEdge(C,function(we){P.dropEdge(we)}),this._nodes.delete(C),this.emit("nodeDropped",{key:C,attributes:Z.attributes})},oe.dropEdge=function(C){var P;if(arguments.length>1){var Z=""+arguments[0],we=""+arguments[1];if(!(P=q(this,Z,we,this.type)))throw new te('Graph.dropEdge: could not find the "'.concat(Z,'" -> "').concat(we,'" edge in the graph.'))}else if(!(P=this._edges.get(C=""+C)))throw new te('Graph.dropEdge: could not find the "'.concat(C,'" edge in the graph.'));this._edges.delete(P.key);var et=P.source,Mt=P.target,We=P.attributes,zt=P.undirected;return et===Mt?zt?(et.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(et.directedSelfLoops--,this._directedSelfLoopCount--):zt?(et.undirectedDegree--,Mt.undirectedDegree--):(et.outDegree--,Mt.inDegree--),Ye(this,zt,P),zt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:C,attributes:We,source:et.key,target:Mt.key,undirected:zt}),this},oe.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},oe.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},oe.getAttribute=function(C){return this._attributes[C]},oe.getAttributes=function(){return this._attributes},oe.hasAttribute=function(C){return this._attributes.hasOwnProperty(C)},oe.setAttribute=function(C,P){return this._attributes[C]=P,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:C}),this},oe.updateAttribute=function(C,P){if("function"!=typeof P)throw new me("Graph.updateAttribute: updater should be a function.");return this._attributes[C]=P(this._attributes[C]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:C}),this},oe.removeAttribute=function(C){return delete this._attributes[C],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:C}),this},oe.replaceAttributes=function(C){if(!L(C))throw new me("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=C,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},oe.mergeAttributes=function(C){if(!L(C))throw new me("Graph.mergeAttributes: provided attributes are not a plain object.");return he(this._attributes,C),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:C}),this},oe.getNodeAttribute=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.getNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));return Z.attributes[P]},oe.getNodeAttributes=function(C){var P=this._nodes.get(C=""+C);if(!P)throw new te('Graph.getNodeAttributes: could not find the "'.concat(C,'" node in the graph.'));return P.attributes},oe.hasNodeAttribute=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));return Z.attributes.hasOwnProperty(P)},oe.setNodeAttribute=function(C,P,Z){var we=this._nodes.get(C=""+C);if(!we)throw new te('Graph.setNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return we.attributes[P]=Z,this.emit("nodeAttributesUpdated",{key:C,type:"set",attributes:we.attributes,name:P}),this},oe.updateNodeAttribute=function(C,P,Z){var we=this._nodes.get(C=""+C);if(!we)throw new te('Graph.updateNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof Z)throw new me("Graph.updateAttribute: updater should be a function.");var Fe=we.attributes,et=Z(Fe[P]);return Fe[P]=et,this.emit("nodeAttributesUpdated",{key:C,type:"set",attributes:we.attributes,name:P}),this},oe.removeNodeAttribute=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));return delete Z.attributes[P],this.emit("nodeAttributesUpdated",{key:C,type:"remove",attributes:Z.attributes,name:P}),this},oe.replaceNodeAttributes=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.replaceNodeAttributes: could not find the "'.concat(C,'" node in the graph.'));if(!L(P))throw new me("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return Z.attributes=P,this.emit("nodeAttributesUpdated",{key:C,type:"replace",attributes:Z.attributes}),this},oe.mergeNodeAttributes=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.mergeNodeAttributes: could not find the "'.concat(C,'" node in the graph.'));if(!L(P))throw new me("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return he(Z.attributes,P),this.emit("nodeAttributesUpdated",{key:C,type:"merge",attributes:Z.attributes,data:P}),this},oe.updateEachNodeAttributes=function(C,P){if("function"!=typeof C)throw new me("Graph.updateEachNodeAttributes: expecting an updater function.");if(P&&!S(P))throw new me("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Fe=this._nodes.values();!0!==(Z=Fe.next()).done;)(we=Z.value).attributes=C(we.key,we.attributes);this.emit("eachNodeAttributesUpdated",{hints:P||null})},oe.updateEachEdgeAttributes=function(C,P){if("function"!=typeof C)throw new me("Graph.updateEachEdgeAttributes: expecting an updater function.");if(P&&!S(P))throw new me("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Fe=this._edges.values();!0!==(Z=Fe.next()).done;)(we=Z.value).attributes=C(we.key,we.attributes);this.emit("eachEdgeAttributesUpdated",{hints:P||null})},oe.forEach=function(C){if("function"!=typeof C)throw new me("Graph.forEach: expecting a callback.");this.multi?ct(!1,this,C):ke(!1,this,C)},oe.forEachUntil=function(C){if("function"!=typeof C)throw new me("Graph.forEach: expecting a callback.");this.multi?ct(!0,this,C):ke(!0,this,C)},oe.adjacency=function(){return this.multi?(et=(C=this)._nodes.values(),Mt=C.type,We="outer",zt=null,new ee(function Et(){var pn;if("outer"===We)return!0===(pn=et.next()).done?pn:(P=pn.value,We="directed",Et());if("directed"===We)return"undirected"===Mt?(We="undirected",Et()):(we=P.out,Z=Object.keys(P.out),Fe=0,We="inner-directed",Et());if("undirected"===We){if("directed"===Mt)return We="outer",Et();we=P.undirected,Z=Object.keys(P.undirected),Fe=0,We="inner-undirected"}if(!zt&&Fe>=Z.length)return We="inner-undirected"===We?"outer":"undirected",Et();if(!zt){var _s=Z[Fe++];return zt=we[_s].values(),Et()}if((pn=zt.next()).done)return zt=null,Et();var Wr=pn.value,Ks=Wr.target;return"inner-undirected"===We&&Ks.key===P.key&&(Ks=Wr.source),{done:!1,value:[P.key,Ks.key,P.attributes,Ks.attributes,Wr.key,Wr.attributes]}})):(Tl=(Et=this)._nodes.values(),oo=Et.type,Pr="outer",new ee(function Fs(){var fc;if("outer"===Pr)return!0===(fc=Tl.next()).done?fc:(pn=fc.value,Pr="directed",Fs());if("directed"===Pr)return"undirected"===oo?(Pr="undirected",Fs()):(Wr=pn.out,_s=Object.keys(pn.out),Ks=0,Pr="inner-directed",Fs());if("undirected"===Pr){if("directed"===oo)return Pr="outer",Fs();Wr=pn.undirected,_s=Object.keys(pn.undirected),Ks=0,Pr="inner-undirected"}if(Ks>=_s.length)return Pr="inner-undirected"===Pr?"outer":"undirected",Fs();var yn=_s[Ks++],ao=Wr[yn],Dl=ao.target;return"inner-undirected"===Pr&&Dl.key===pn.key&&(Dl=ao.source),{done:!1,value:[pn.key,Dl.key,pn.attributes,Dl.attributes,ao.key,ao.attributes]}}));var Et,pn,_s,Wr,Ks,Tl,oo,Pr,C,P,Z,we,Fe,et,Mt,We,zt},oe.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):se(this._nodes.keys(),this._nodes.size)},oe.forEachNode=function(C){if("function"!=typeof C)throw new me("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(P,Z){C(Z,P.attributes)})},oe.forEachNodeUntil=function(C){if("function"!=typeof C)throw new me("Graph.forEachNode: expecting a callback.");for(var P,Z,we=this._nodes.values();!0!==(P=we.next())&&!C((Z=P.value).key,Z.attributes););},oe.nodeEntries=function(){var C=this._nodes.values();return new ee(function(){var P=C.next();if(P.done)return P;var Z=P.value;return{value:[Z.key,Z.attributes],done:!1}})},oe.exportNode=function(C){var P=this._nodes.get(C=""+C);if(!P)throw new te('Graph.exportNode: could not find the "'.concat(C,'" node in the graph.'));return Qe(C,P)},oe.exportEdge=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.exportEdge: could not find the "'.concat(C,'" edge in the graph.'));return vt(C,P)},oe.export=function(){var C=new Array(this._nodes.size),P=0;this._nodes.forEach(function(we,Fe){C[P++]=Qe(Fe,we)});var Z=new Array(this._edges.size);return P=0,this._edges.forEach(function(we,Fe){Z[P++]=vt(Fe,we)}),{attributes:this.getAttributes(),nodes:C,edges:Z,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},oe.importNode=function(C){var P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=xt(C);if(Z){if("not-object"===Z)throw new me('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===Z)throw new me("Graph.importNode: no key provided.");if("invalid-attributes"===Z)throw new me("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var we=C.key,Fe=C.attributes,et=void 0===Fe?{}:Fe;return P?this.mergeNode(we,et):this.addNode(we,et),this},oe.importEdge=function(C){var P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=Tt(C);if(Z){if("not-object"===Z)throw new me('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===Z)throw new me("Graph.importEdge: missing souce.");if("no-target"===Z)throw new me("Graph.importEdge: missing target.");if("invalid-attributes"===Z)throw new me("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===Z)throw new me("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var we=C.source,Fe=C.target,et=C.attributes,Mt=void 0===et?{}:et,We=C.undirected,zt=void 0!==We&&We;return"key"in C?(P?zt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:zt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,C.key,we,Fe,Mt):(P?zt?this.mergeUndirectedEdge:this.mergeDirectedEdge:zt?this.addUndirectedEdge:this.addDirectedEdge).call(this,we,Fe,Mt),this},oe.import=function(C){var P,Z,we,Fe=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(V(C))return this.import(C.export(),Fe),this;if(!L(C))throw new me("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(C.attributes){if(!L(C.attributes))throw new me("Graph.import: invalid attributes. Expecting a plain object.");Fe?this.mergeAttributes(C.attributes):this.replaceAttributes(C.attributes)}if(C.nodes){if(we=C.nodes,!Array.isArray(we))throw new me("Graph.import: invalid nodes. Expecting an array.");for(P=0,Z=we.length;P<Z;P++)this.importNode(we[P],Fe)}if(C.edges){if(we=C.edges,!Array.isArray(we))throw new me("Graph.import: invalid edges. Expecting an array.");for(P=0,Z=we.length;P<Z;P++)this.importEdge(we[P],Fe)}return this},oe.nullCopy=function(C){return new de(he({},this._options,C))},oe.emptyCopy=function(C){var P=this.nullCopy(C);return this._nodes.forEach(function(Z,we){var Fe=he({},Z.attributes);Z=new P.NodeDataClass(we,Fe),P._nodes.set(we,Z)}),P},oe.copy=function(){var C=new de(this._options);return C.import(this),C},oe.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(C){return C.upgradeToMixed()}),this._options.type="mixed",b(this,"type",this._options.type),$(this,"NodeDataClass",Me)),this},oe.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,b(this,"multi",!0),(C=this)._nodes.forEach(function(P,Z){if(P.out)for(var we in P.out){var Fe=new Set;Fe.add(P.out[we]),P.out[we]=Fe,C._nodes.get(we).in[Z]=Fe}if(P.undirected)for(var et in P.undirected)if(!(et>Z)){var Mt=new Set;Mt.add(P.undirected[et]),P.undirected[et]=Mt,C._nodes.get(et).undirected[Z]=Mt}})),this;var C},oe.clearIndex=function(){return this._nodes.forEach(function(C){void 0!==C.in&&(C.in={},C.out={}),void 0!==C.undirected&&(C.undirected={})}),this},oe.toJSON=function(){return this.export()},oe.toString=function(){return"[object Graph]"},oe.inspect=function(){var C=this,P={};this._nodes.forEach(function(Mt,We){P[We]=Mt.attributes});var Z={},we={};this._edges.forEach(function(Mt,We){var zt=Mt.undirected?"--":"->",Et="",pn="(".concat(Mt.source.key,")").concat(zt,"(").concat(Mt.target.key,")");Mt.generatedKey?C.multi&&(void 0===we[pn]?we[pn]=0:we[pn]++,Et+="".concat(we[pn],". ")):Et+="[".concat(We,"]: "),Z[Et+=pn]=Mt.attributes});var Fe={};for(var et in this)this.hasOwnProperty(et)&&!jn.has(et)&&"function"!=typeof this[et]&&(Fe[et]=this[et]);return Fe.attributes=this._attributes,Fe.nodes=P,Fe.edges=Z,$(Fe,"constructor",this.constructor),Fe},de}(T.exports.EventEmitter);"undefined"!=typeof Symbol&&(bn.prototype[Symbol.for("nodejs.util.inspect.custom")]=bn.prototype.inspect),[{name:function(ne){return"".concat(ne,"Edge")},generateKey:!0},{name:function(ne){return"".concat(ne,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(ne){return"".concat(ne,"EdgeWithKey")}},{name:function(ne){return"".concat(ne,"DirectedEdgeWithKey")},type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(ne){["add","merge","update"].forEach(function(de){var oe=ne.name(de),C="add"===de?fn:zn;bn.prototype[oe]=ne.generateKey?function(P,Z,we){return C(this,oe,!0,"undirected"===(ne.type||this.type),null,P,Z,we,"update"===de)}:function(P,Z,we,Fe){return C(this,oe,!1,"undirected"===(ne.type||this.type),P,Z,we,Fe,"update"===de)}})}),"undefined"!=typeof Symbol&&(bn.prototype[Symbol.iterator]=bn.prototype.adjacency),ne=bn,je.forEach(function(de){var oe=de.name,C=de.attacher;C(ne,oe("Edge"),"mixed"),C(ne,oe("DirectedEdge"),"directed"),C(ne,oe("UndirectedEdge"),"undirected")}),function(ne){Re.forEach(function(de){var C,P,Z,we;Z=(C=de).type,we=C.direction,ne.prototype[P=C.name]=function(Fe,et){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(!arguments.length)return Oe(this,Z);if(1===arguments.length){var Mt=this._nodes.get(Fe=""+Fe);if(void 0===Mt)throw new te("Graph.".concat(P,': could not find the "').concat(Fe,'" node in the graph.'));return Tn(this.multi,"mixed"===Z?this.type:Z,we,Mt)}if(2===arguments.length){et=""+et;var We=this._nodes.get(Fe=""+Fe);if(!We)throw new te("Graph.".concat(P,':  could not find the "').concat(Fe,'" source node in the graph.'));if(!this._nodes.has(et))throw new te("Graph.".concat(P,':  could not find the "').concat(et,'" target node in the graph.'));return hi(Z,this.multi,we,We,et)}throw new me("Graph.".concat(P,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(oe,C){var P=C.name,Z=C.type,we=C.direction,Fe="forEach"+P[0].toUpperCase()+P.slice(1,-1);oe.prototype[Fe]=function(et,Mt,We){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return Xe(this,Z,We=et);if(2===arguments.length){We=Mt;var zt=this._nodes.get(et=""+et);if(void 0===zt)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return Pn(this.multi,"mixed"===Z?this.type:Z,we,zt,We)}if(3===arguments.length){Mt=""+Mt;var Et=this._nodes.get(et=""+et);if(!Et)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Mt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Mt,'" target node in the graph.'));return Hr(Z,this.multi,we,Et,Mt,We)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,de),function(oe,C){var P=C.name,Z=C.type,we=C.direction,Fe="forEach"+P[0].toUpperCase()+P.slice(1,-1)+"Until";oe.prototype[Fe]=function(et,Mt,We){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return yt(this,Z,We=et);if(2===arguments.length){We=Mt;var zt=this._nodes.get(et=""+et);if(void 0===zt)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return $n(this.multi,"mixed"===Z?this.type:Z,we,zt,We)}if(3===arguments.length){Mt=""+Mt;var Et=this._nodes.get(et=""+et);if(!Et)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Mt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Mt,'" target node in the graph.'));return Ns(Z,this.multi,we,Et,Mt,We)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,de),function(oe,C){var Z=C.type,we=C.direction,Fe=C.name.slice(0,-1)+"Entries";oe.prototype[Fe]=function(et,Mt){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return ee.empty();if(!arguments.length)return It(this,Z);if(1===arguments.length){var We=this._nodes.get(et=""+et);if(!We)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return yi(Z,we,We)}if(2===arguments.length){Mt=""+Mt;var zt=this._nodes.get(et=""+et);if(!zt)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Mt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Mt,'" target node in the graph.'));return cs(Z,we,zt,Mt)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(ne,de)})}(bn),function(ne){Ps.forEach(function(de){var C,P,Z,we;Z=(C=de).type,we=C.direction,ne.prototype[P=C.name]=function(Fe){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(2===arguments.length){var et=""+arguments[0],Mt=""+arguments[1];if(!this._nodes.has(et))throw new te("Graph.".concat(P,': could not find the "').concat(et,'" node in the graph.'));if(!this._nodes.has(Mt))throw new te("Graph.".concat(P,': could not find the "').concat(Mt,'" node in the graph.'));return ot(this,Z,we,et,Mt)}if(1===arguments.length){var We=this._nodes.get(Fe=""+Fe);if(void 0===We)throw new te("Graph.".concat(P,': could not find the "').concat(Fe,'" node in the graph.'));return qa("mixed"===Z?this.type:Z,we,We)}throw new me("Graph.".concat(P,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(ne,de){var oe=de.name,C=de.type,P=de.direction,Z="forEach"+oe[0].toUpperCase()+oe.slice(1,-1);ne.prototype[Z]=function(we,Fe){if("mixed"===C||"mixed"===this.type||C===this.type){var et=this._nodes.get(we=""+we);if(void 0===et)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Mt,We,zt,Et){if("mixed"!==Mt){if("undirected"===Mt)return Al(zt,zt.undirected,Et);if("string"==typeof We)return Al(zt,zt[We],Et)}var pn=new Set;"undirected"!==Mt&&("out"!==We&&ua(pn,zt,zt.in,Et),"in"!==We&&ua(pn,zt,zt.out,Et)),"directed"!==Mt&&ua(pn,zt,zt.undirected,Et)}("mixed"===C?this.type:C,P,et,Fe)}}}(ne,de),function(ne,de){var oe=de.name,C=de.type,P=de.direction,Z="forEach"+oe[0].toUpperCase()+oe.slice(1,-1)+"Until";ne.prototype[Z]=function(we,Fe){if("mixed"===C||"mixed"===this.type||C===this.type){var et=this._nodes.get(we=""+we);if(void 0===et)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Mt,We,zt,Et){if("mixed"!==Mt){if("undirected"===Mt)return ms(zt,zt.undirected,Et);if("string"==typeof We)return ms(zt,zt[We],Et)}var pn=new Set;"undirected"!==Mt&&("out"!==We&&Qt(pn,zt,zt.in,Et)||"in"!==We&&Qt(pn,zt,zt.out,Et))||"directed"===Mt||Qt(pn,zt,zt.undirected,Et)}("mixed"===C?this.type:C,P,et,Fe)}}}(ne,de),function(ne,de){var C=de.type,P=de.direction,Z=de.name.slice(0,-1)+"Entries";ne.prototype[Z]=function(we){if("mixed"!==C&&"mixed"!==this.type&&C!==this.type)return ee.empty();var Fe=this._nodes.get(we=""+we);if(void 0===Fe)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));return function(et,Mt,We){if("mixed"!==et){if("undirected"===et)return Ka(We,We.undirected);if("string"==typeof Mt)return Ka(We,We[Mt])}var zt=ee.empty(),Et=new Set;return"undirected"!==et&&("out"!==Mt&&(zt=Ee(zt,rt(Et,We,We.in))),"in"!==Mt&&(zt=Ee(zt,rt(Et,We,We.out)))),"directed"!==et&&(zt=Ee(zt,rt(Et,We,We.undirected))),zt}("mixed"===C?this.type:C,P,Fe)}}(ne,de)})}(bn);var Zi=function(ne){function de(oe){var C=he({type:"directed"},oe);if("multi"in C&&!1!==C.multi)throw new me("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==C.type)throw new me('DirectedGraph.from: inconsistent "'+C.type+'" type in given options!');return ne.call(this,C)||this}return tt(de,ne),de}(bn),Ji=function(ne){function de(oe){var C=he({type:"undirected"},oe);if("multi"in C&&!1!==C.multi)throw new me("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==C.type)throw new me('UndirectedGraph.from: inconsistent "'+C.type+'" type in given options!');return ne.call(this,C)||this}return tt(de,ne),de}(bn),qn=function(ne){function de(oe){var C=he({multi:!0},oe);if("multi"in C&&!0!==C.multi)throw new me("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return ne.call(this,C)||this}return tt(de,ne),de}(bn),Pi=function(ne){function de(oe){var C=he({type:"directed",multi:!0},oe);if("multi"in C&&!0!==C.multi)throw new me("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==C.type)throw new me('MultiDirectedGraph.from: inconsistent "'+C.type+'" type in given options!');return ne.call(this,C)||this}return tt(de,ne),de}(bn),da=function(ne){function de(oe){var C=he({type:"undirected",multi:!0},oe);if("multi"in C&&!0!==C.multi)throw new me("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==C.type)throw new me('MultiUndirectedGraph.from: inconsistent "'+C.type+'" type in given options!');return ne.call(this,C)||this}return tt(de,ne),de}(bn);function $r(ne){ne.from=function(de,oe){var C=he({},de.options,oe),P=new ne(C);return P.import(de),P}}return $r(bn),$r(Zi),$r(Ji),$r(qn),$r(Pi),$r(da),bn.Graph=bn,bn.DirectedGraph=Zi,bn.UndirectedGraph=Ji,bn.MultiGraph=qn,bn.MultiDirectedGraph=Pi,bn.MultiUndirectedGraph=da,bn.InvalidArgumentsGraphError=me,bn.NotFoundGraphError=te,bn.UsageGraphError=ye,bn}()},524:(kt,it,tt)=>{var gt;!function(J,At,dt,K){"use strict";var T,Ae=["","webkit","Moz","MS","ms","o"],he=At.createElement("div"),V=Math.round,L=Math.abs,re=Date.now;function $(_e,Ce,He){return setTimeout(D(_e,He),Ce)}function b(_e,Ce,He){return!!Array.isArray(_e)&&(S(_e,He[Ce],He),!0)}function S(_e,Ce,He){var mt;if(_e)if(_e.forEach)_e.forEach(Ce,He);else if(_e.length!==K)for(mt=0;mt<_e.length;)Ce.call(He,_e[mt],mt,_e),mt++;else for(mt in _e)_e.hasOwnProperty(mt)&&Ce.call(He,_e[mt],mt,_e)}function O(_e,Ce,He){var mt="DEPRECATED METHOD: "+Ce+"\n"+He+" AT \n";return function(){var jt=new Error("get-stack-trace"),Ht=jt&&jt.stack?jt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ri=J.console&&(J.console.warn||J.console.log);return ri&&ri.call(J.console,mt,Ht),_e.apply(this,arguments)}}T="function"!=typeof Object.assign?function(Ce){if(Ce===K||null===Ce)throw new TypeError("Cannot convert undefined or null to object");for(var He=Object(Ce),mt=1;mt<arguments.length;mt++){var jt=arguments[mt];if(jt!==K&&null!==jt)for(var Ht in jt)jt.hasOwnProperty(Ht)&&(He[Ht]=jt[Ht])}return He}:Object.assign;var v=O(function(Ce,He,mt){for(var jt=Object.keys(He),Ht=0;Ht<jt.length;)(!mt||mt&&Ce[jt[Ht]]===K)&&(Ce[jt[Ht]]=He[jt[Ht]]),Ht++;return Ce},"extend","Use `assign`."),y=O(function(Ce,He){return v(Ce,He,!0)},"merge","Use `assign`.");function w(_e,Ce,He){var jt,mt=Ce.prototype;(jt=_e.prototype=Object.create(mt)).constructor=_e,jt._super=mt,He&&T(jt,He)}function D(_e,Ce){return function(){return _e.apply(Ce,arguments)}}function j(_e,Ce){return"function"==typeof _e?_e.apply(Ce&&Ce[0]||K,Ce):_e}function I(_e,Ce){return _e===K?Ce:_e}function H(_e,Ce,He){S(Q(Ce),function(mt){_e.addEventListener(mt,He,!1)})}function Y(_e,Ce,He){S(Q(Ce),function(mt){_e.removeEventListener(mt,He,!1)})}function M(_e,Ce){for(;_e;){if(_e==Ce)return!0;_e=_e.parentNode}return!1}function F(_e,Ce){return _e.indexOf(Ce)>-1}function Q(_e){return _e.trim().split(/\s+/g)}function E(_e,Ce,He){if(_e.indexOf&&!He)return _e.indexOf(Ce);for(var mt=0;mt<_e.length;){if(He&&_e[mt][He]==Ce||!He&&_e[mt]===Ce)return mt;mt++}return-1}function U(_e){return Array.prototype.slice.call(_e,0)}function ie(_e,Ce,He){for(var mt=[],jt=[],Ht=0;Ht<_e.length;){var ri=Ce?_e[Ht][Ce]:_e[Ht];E(jt,ri)<0&&mt.push(_e[Ht]),jt[Ht]=ri,Ht++}return He&&(mt=Ce?mt.sort(function(qr,ys){return qr[Ce]>ys[Ce]}):mt.sort()),mt}function ue(_e,Ce){for(var He,mt,jt=Ce[0].toUpperCase()+Ce.slice(1),Ht=0;Ht<Ae.length;){if((mt=(He=Ae[Ht])?He+jt:Ce)in _e)return mt;Ht++}return K}var ee=1;function Te(_e){var Ce=_e.ownerDocument||_e;return Ce.defaultView||Ce.parentWindow||J}var te="ontouchstart"in J,ye=ue(J,"PointerEvent")!==K,Me=te&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ve="touch",Ze="mouse",wt=["x","y"],pt=["clientX","clientY"];function fe(_e,Ce){var He=this;this.manager=_e,this.callback=Ce,this.element=_e.element,this.target=_e.options.inputTarget,this.domHandler=function(mt){j(_e.options.enable,[_e])&&He.handler(mt)},this.init()}function R(_e,Ce,He){var mt=He.pointers.length,jt=He.changedPointers.length,Ht=1&Ce&&mt-jt==0,ri=12&Ce&&mt-jt==0;He.isFirst=!!Ht,He.isFinal=!!ri,Ht&&(_e.session={}),He.eventType=Ce,function(_e,Ce){var He=_e.session,mt=Ce.pointers,jt=mt.length;He.firstInput||(He.firstInput=yt(Ce)),jt>1&&!He.firstMultiple?He.firstMultiple=yt(Ce):1===jt&&(He.firstMultiple=!1);var Ht=He.firstInput,ri=He.firstMultiple,Fr=ri?ri.center:Ht.center,qr=Ce.center=It(mt);Ce.timeStamp=re(),Ce.deltaTime=Ce.timeStamp-Ht.timeStamp,Ce.angle=yi(Fr,qr),Ce.distance=$n(Fr,qr),function(_e,Ce){var He=Ce.center,mt=_e.offsetDelta||{},jt=_e.prevDelta||{},Ht=_e.prevInput||{};(1===Ce.eventType||4===Ht.eventType)&&(jt=_e.prevDelta={x:Ht.deltaX||0,y:Ht.deltaY||0},mt=_e.offsetDelta={x:He.x,y:He.y}),Ce.deltaX=jt.x+(He.x-mt.x),Ce.deltaY=jt.y+(He.y-mt.y)}(He,Ce),Ce.offsetDirection=Pn(Ce.deltaX,Ce.deltaY);var ys=Tn(Ce.deltaTime,Ce.deltaX,Ce.deltaY);Ce.overallVelocityX=ys.x,Ce.overallVelocityY=ys.y,Ce.overallVelocity=L(ys.x)>L(ys.y)?ys.x:ys.y,Ce.scale=ri?function(_e,Ce){return $n(Ce[0],Ce[1],pt)/$n(_e[0],_e[1],pt)}(ri.pointers,mt):1,Ce.rotation=ri?function(_e,Ce){return yi(Ce[1],Ce[0],pt)+yi(_e[1],_e[0],pt)}(ri.pointers,mt):0,Ce.maxPointers=He.prevInput?Ce.pointers.length>He.prevInput.maxPointers?Ce.pointers.length:He.prevInput.maxPointers:Ce.pointers.length,function(_e,Ce){var jt,Ht,ri,Fr,He=_e.lastInterval||Ce,mt=Ce.timeStamp-He.timeStamp;if(8!=Ce.eventType&&(mt>25||He.velocity===K)){var qr=Ce.deltaX-He.deltaX,ys=Ce.deltaY-He.deltaY,ti=Tn(mt,qr,ys);Ht=ti.x,ri=ti.y,jt=L(ti.x)>L(ti.y)?ti.x:ti.y,Fr=Pn(qr,ys),_e.lastInterval=Ce}else jt=He.velocity,Ht=He.velocityX,ri=He.velocityY,Fr=He.direction;Ce.velocity=jt,Ce.velocityX=Ht,Ce.velocityY=ri,Ce.direction=Fr}(He,Ce);var ti=_e.element;M(Ce.srcEvent.target,ti)&&(ti=Ce.srcEvent.target),Ce.target=ti}(_e,He),_e.emit("hammer.input",He),_e.recognize(He),_e.session.prevInput=He}function yt(_e){for(var Ce=[],He=0;He<_e.pointers.length;)Ce[He]={clientX:V(_e.pointers[He].clientX),clientY:V(_e.pointers[He].clientY)},He++;return{timeStamp:re(),pointers:Ce,center:It(Ce),deltaX:_e.deltaX,deltaY:_e.deltaY}}function It(_e){var Ce=_e.length;if(1===Ce)return{x:V(_e[0].clientX),y:V(_e[0].clientY)};for(var He=0,mt=0,jt=0;jt<Ce;)He+=_e[jt].clientX,mt+=_e[jt].clientY,jt++;return{x:V(He/Ce),y:V(mt/Ce)}}function Tn(_e,Ce,He){return{x:Ce/_e||0,y:He/_e||0}}function Pn(_e,Ce){return _e===Ce?1:L(_e)>=L(Ce)?_e<0?2:4:Ce<0?8:16}function $n(_e,Ce,He){He||(He=wt);var mt=Ce[He[0]]-_e[He[0]],jt=Ce[He[1]]-_e[He[1]];return Math.sqrt(mt*mt+jt*jt)}function yi(_e,Ce,He){return He||(He=wt),180*Math.atan2(Ce[He[1]]-_e[He[1]],Ce[He[0]]-_e[He[0]])/Math.PI}fe.prototype={handler:function(){},init:function(){this.evEl&&H(this.element,this.evEl,this.domHandler),this.evTarget&&H(this.target,this.evTarget,this.domHandler),this.evWin&&H(Te(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Y(this.element,this.evEl,this.domHandler),this.evTarget&&Y(this.target,this.evTarget,this.domHandler),this.evWin&&Y(Te(this.element),this.evWin,this.domHandler)}};var Ns={mousedown:1,mousemove:2,mouseup:4},cs="mousedown",Ps="mousemove mouseup";function Gr(){this.evEl=cs,this.evWin=Ps,this.pressed=!1,fe.apply(this,arguments)}w(Gr,fe,{handler:function(Ce){var He=Ns[Ce.type];1&He&&0===Ce.button&&(this.pressed=!0),2&He&&1!==Ce.which&&(He=4),this.pressed&&(4&He&&(this.pressed=!1),this.callback(this.manager,He,{pointers:[Ce],changedPointers:[Ce],pointerType:Ze,srcEvent:Ce}))}});var qa={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Al={2:Ve,3:"pen",4:Ze,5:"kinect"},ua="pointerdown",ms="pointermove pointerup pointercancel";function Qt(){this.evEl=ua,this.evWin=ms,fe.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}J.MSPointerEvent&&!J.PointerEvent&&(ua="MSPointerDown",ms="MSPointerMove MSPointerUp MSPointerCancel"),w(Qt,fe,{handler:function(Ce){var He=this.store,mt=!1,jt=Ce.type.toLowerCase().replace("ms",""),Ht=qa[jt],ri=Al[Ce.pointerType]||Ce.pointerType,Fr=ri==Ve,qr=E(He,Ce.pointerId,"pointerId");1&Ht&&(0===Ce.button||Fr)?qr<0&&(He.push(Ce),qr=He.length-1):12&Ht&&(mt=!0),!(qr<0)&&(He[qr]=Ce,this.callback(this.manager,Ht,{pointers:He,changedPointers:[Ce],pointerType:ri,srcEvent:Ce}),mt&&He.splice(qr,1))}});var Ka={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rt="touchstart",ot="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=rt,this.evWin=ot,this.started=!1,fe.apply(this,arguments)}function pe(_e,Ce){var He=U(_e.touches),mt=U(_e.changedTouches);return 12&Ce&&(He=ie(He.concat(mt),"identifier",!0)),[He,mt]}w(ut,fe,{handler:function(Ce){var He=Ka[Ce.type];if(1===He&&(this.started=!0),this.started){var mt=pe.call(this,Ce,He);12&He&&mt[0].length-mt[1].length==0&&(this.started=!1),this.callback(this.manager,He,{pointers:mt[0],changedPointers:mt[1],pointerType:Ve,srcEvent:Ce})}}});var ve={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ke="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=ke,this.targetIds={},fe.apply(this,arguments)}function Qe(_e,Ce){var He=U(_e.touches),mt=this.targetIds;if(3&Ce&&1===He.length)return mt[He[0].identifier]=!0,[He,He];var jt,Ht,ri=U(_e.changedTouches),Fr=[],qr=this.target;if(Ht=He.filter(function(ys){return M(ys.target,qr)}),1===Ce)for(jt=0;jt<Ht.length;)mt[Ht[jt].identifier]=!0,jt++;for(jt=0;jt<ri.length;)mt[ri[jt].identifier]&&Fr.push(ri[jt]),12&Ce&&delete mt[ri[jt].identifier],jt++;return Fr.length?[ie(Ht.concat(Fr),"identifier",!0),Fr]:void 0}function Tt(){fe.apply(this,arguments);var _e=D(this.handler,this);this.touch=new ct(this.manager,_e),this.mouse=new Gr(this.manager,_e),this.primaryTouch=null,this.lastTouches=[]}function $t(_e,Ce){1&_e?(this.primaryTouch=Ce.changedPointers[0].identifier,jn.call(this,Ce)):12&_e&&jn.call(this,Ce)}function jn(_e){var Ce=_e.changedPointers[0];if(Ce.identifier===this.primaryTouch){var He={x:Ce.clientX,y:Ce.clientY};this.lastTouches.push(He);var mt=this.lastTouches;setTimeout(function(){var Ht=mt.indexOf(He);Ht>-1&&mt.splice(Ht,1)},2500)}}function ii(_e){for(var Ce=_e.srcEvent.clientX,He=_e.srcEvent.clientY,mt=0;mt<this.lastTouches.length;mt++){var jt=this.lastTouches[mt],Ht=Math.abs(Ce-jt.x),ri=Math.abs(He-jt.y);if(Ht<=25&&ri<=25)return!0}return!1}w(ct,fe,{handler:function(Ce){var He=ve[Ce.type],mt=Qe.call(this,Ce,He);!mt||this.callback(this.manager,He,{pointers:mt[0],changedPointers:mt[1],pointerType:Ve,srcEvent:Ce})}}),w(Tt,fe,{handler:function(Ce,He,mt){var Ht=mt.pointerType==Ze;if(!(Ht&&mt.sourceCapabilities&&mt.sourceCapabilities.firesTouchEvents)){if(mt.pointerType==Ve)$t.call(this,He,mt);else if(Ht&&ii.call(this,mt))return;this.callback(Ce,He,mt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Mn=ue(he.style,"touchAction"),fn=Mn!==K,zn="compute",Zi="manipulation",Ji="none",qn="pan-x",Pi="pan-y",da=function(){if(!fn)return!1;var _e={},Ce=J.CSS&&J.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(He){_e[He]=!Ce||J.CSS.supports("touch-action",He)}),_e}();function $r(_e,Ce){this.manager=_e,this.set(Ce)}function Mt(_e){this.options=T({},this.defaults,_e||{}),this.id=ee++,this.manager=null,this.options.enable=I(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function We(_e){return 16&_e?"cancel":8&_e?"end":4&_e?"move":2&_e?"start":""}function zt(_e){return 16==_e?"down":8==_e?"up":2==_e?"left":4==_e?"right":""}function Et(_e,Ce){var He=Ce.manager;return He?He.get(_e):_e}function pn(){Mt.apply(this,arguments)}function _s(){pn.apply(this,arguments),this.pX=null,this.pY=null}function Wr(){pn.apply(this,arguments)}function Ks(){Mt.apply(this,arguments),this._timer=null,this._input=null}function Tl(){pn.apply(this,arguments)}function oo(){pn.apply(this,arguments)}function Pr(){Mt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Fs(_e,Ce){return(Ce=Ce||{}).recognizers=I(Ce.recognizers,Fs.defaults.preset),new ao(_e,Ce)}function ao(_e,Ce){this.options=T({},Fs.defaults,Ce||{}),this.options.inputTarget=this.options.inputTarget||_e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=_e,this.input=function(_e){return new(_e.options.inputClass||(ye?Qt:Me?ct:te?Tt:Gr))(_e,R)}(this),this.touchAction=new $r(this,this.options.touchAction),Dl(this,!0),S(this.options.recognizers,function(He){var mt=this.add(new He[0](He[1]));He[2]&&mt.recognizeWith(He[2]),He[3]&&mt.requireFailure(He[3])},this)}function Dl(_e,Ce){var mt,He=_e.element;He.style&&(S(_e.options.cssProps,function(jt,Ht){mt=ue(He.style,Ht),Ce?(_e.oldCssProps[mt]=He.style[mt],He.style[mt]=jt):He.style[mt]=_e.oldCssProps[mt]||""}),Ce||(_e.oldCssProps={}))}$r.prototype={set:function(_e){_e==zn&&(_e=this.compute()),fn&&this.manager.element.style&&da[_e]&&(this.manager.element.style[Mn]=_e),this.actions=_e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var _e=[];return S(this.manager.recognizers,function(Ce){j(Ce.options.enable,[Ce])&&(_e=_e.concat(Ce.getTouchAction()))}),function(_e){if(F(_e,Ji))return Ji;var Ce=F(_e,qn),He=F(_e,Pi);return Ce&&He?Ji:Ce||He?Ce?qn:Pi:F(_e,Zi)?Zi:"auto"}(_e.join(" "))},preventDefaults:function(_e){var Ce=_e.srcEvent,He=_e.offsetDirection;if(!this.manager.session.prevented){var mt=this.actions,jt=F(mt,Ji)&&!da[Ji],Ht=F(mt,Pi)&&!da[Pi],ri=F(mt,qn)&&!da[qn];if(jt&&1===_e.pointers.length&&_e.distance<2&&_e.deltaTime<250)return;return ri&&Ht||!(jt||Ht&&6&He||ri&&24&He)?void 0:this.preventSrc(Ce)}Ce.preventDefault()},preventSrc:function(_e){this.manager.session.prevented=!0,_e.preventDefault()}},Mt.prototype={defaults:{},set:function(_e){return T(this.options,_e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(_e){if(b(_e,"recognizeWith",this))return this;var Ce=this.simultaneous;return Ce[(_e=Et(_e,this)).id]||(Ce[_e.id]=_e,_e.recognizeWith(this)),this},dropRecognizeWith:function(_e){return b(_e,"dropRecognizeWith",this)||(_e=Et(_e,this),delete this.simultaneous[_e.id]),this},requireFailure:function(_e){if(b(_e,"requireFailure",this))return this;var Ce=this.requireFail;return-1===E(Ce,_e=Et(_e,this))&&(Ce.push(_e),_e.requireFailure(this)),this},dropRequireFailure:function(_e){if(b(_e,"dropRequireFailure",this))return this;_e=Et(_e,this);var Ce=E(this.requireFail,_e);return Ce>-1&&this.requireFail.splice(Ce,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(_e){return!!this.simultaneous[_e.id]},emit:function(_e){var Ce=this,He=this.state;function mt(jt){Ce.manager.emit(jt,_e)}He<8&&mt(Ce.options.event+We(He)),mt(Ce.options.event),_e.additionalEvent&&mt(_e.additionalEvent),He>=8&&mt(Ce.options.event+We(He))},tryEmit:function(_e){if(this.canEmit())return this.emit(_e);this.state=32},canEmit:function(){for(var _e=0;_e<this.requireFail.length;){if(!(33&this.requireFail[_e].state))return!1;_e++}return!0},recognize:function(_e){var Ce=T({},_e);if(!j(this.options.enable,[this,Ce]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Ce),30&this.state&&this.tryEmit(Ce)},process:function(_e){},getTouchAction:function(){},reset:function(){}},w(pn,Mt,{defaults:{pointers:1},attrTest:function(_e){var Ce=this.options.pointers;return 0===Ce||_e.pointers.length===Ce},process:function(_e){var Ce=this.state,He=_e.eventType,mt=6&Ce,jt=this.attrTest(_e);return mt&&(8&He||!jt)?16|Ce:mt||jt?4&He?8|Ce:2&Ce?4|Ce:2:32}}),w(_s,pn,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var _e=this.options.direction,Ce=[];return 6&_e&&Ce.push(Pi),24&_e&&Ce.push(qn),Ce},directionTest:function(_e){var Ce=this.options,He=!0,mt=_e.distance,jt=_e.direction,Ht=_e.deltaX,ri=_e.deltaY;return jt&Ce.direction||(6&Ce.direction?(jt=0===Ht?1:Ht<0?2:4,He=Ht!=this.pX,mt=Math.abs(_e.deltaX)):(jt=0===ri?1:ri<0?8:16,He=ri!=this.pY,mt=Math.abs(_e.deltaY))),_e.direction=jt,He&&mt>Ce.threshold&&jt&Ce.direction},attrTest:function(_e){return pn.prototype.attrTest.call(this,_e)&&(2&this.state||!(2&this.state)&&this.directionTest(_e))},emit:function(_e){this.pX=_e.deltaX,this.pY=_e.deltaY;var Ce=zt(_e.direction);Ce&&(_e.additionalEvent=this.options.event+Ce),this._super.emit.call(this,_e)}}),w(Wr,pn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ji]},attrTest:function(_e){return this._super.attrTest.call(this,_e)&&(Math.abs(_e.scale-1)>this.options.threshold||2&this.state)},emit:function(_e){1!==_e.scale&&(_e.additionalEvent=this.options.event+(_e.scale<1?"in":"out")),this._super.emit.call(this,_e)}}),w(Ks,Mt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(_e){var Ce=this.options,He=_e.pointers.length===Ce.pointers,mt=_e.distance<Ce.threshold,jt=_e.deltaTime>Ce.time;if(this._input=_e,!mt||!He||12&_e.eventType&&!jt)this.reset();else if(1&_e.eventType)this.reset(),this._timer=$(function(){this.state=8,this.tryEmit()},Ce.time,this);else if(4&_e.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(_e){8===this.state&&(_e&&4&_e.eventType?this.manager.emit(this.options.event+"up",_e):(this._input.timeStamp=re(),this.manager.emit(this.options.event,this._input)))}}),w(Tl,pn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ji]},attrTest:function(_e){return this._super.attrTest.call(this,_e)&&(Math.abs(_e.rotation)>this.options.threshold||2&this.state)}}),w(oo,pn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return _s.prototype.getTouchAction.call(this)},attrTest:function(_e){var He,Ce=this.options.direction;return 30&Ce?He=_e.overallVelocity:6&Ce?He=_e.overallVelocityX:24&Ce&&(He=_e.overallVelocityY),this._super.attrTest.call(this,_e)&&Ce&_e.offsetDirection&&_e.distance>this.options.threshold&&_e.maxPointers==this.options.pointers&&L(He)>this.options.velocity&&4&_e.eventType},emit:function(_e){var Ce=zt(_e.offsetDirection);Ce&&this.manager.emit(this.options.event+Ce,_e),this.manager.emit(this.options.event,_e)}}),w(Pr,Mt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Zi]},process:function(_e){var Ce=this.options,He=_e.pointers.length===Ce.pointers,mt=_e.distance<Ce.threshold,jt=_e.deltaTime<Ce.time;if(this.reset(),1&_e.eventType&&0===this.count)return this.failTimeout();if(mt&&jt&&He){if(4!=_e.eventType)return this.failTimeout();var Ht=!this.pTime||_e.timeStamp-this.pTime<Ce.interval,ri=!this.pCenter||$n(this.pCenter,_e.center)<Ce.posThreshold;if(this.pTime=_e.timeStamp,this.pCenter=_e.center,ri&&Ht?this.count+=1:this.count=1,this._input=_e,0==this.count%Ce.taps)return this.hasRequireFailures()?(this._timer=$(function(){this.state=8,this.tryEmit()},Ce.interval,this),2):8}return 32},failTimeout:function(){return this._timer=$(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Fs.VERSION="2.0.7",Fs.defaults={domEvents:!1,touchAction:zn,enable:!0,inputTarget:null,inputClass:null,preset:[[Tl,{enable:!1}],[Wr,{enable:!1},["rotate"]],[oo,{direction:6}],[_s,{direction:6},["swipe"]],[Pr],[Pr,{event:"doubletap",taps:2},["tap"]],[Ks]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},ao.prototype={set:function(_e){return T(this.options,_e),_e.touchAction&&this.touchAction.update(),_e.inputTarget&&(this.input.destroy(),this.input.target=_e.inputTarget,this.input.init()),this},stop:function(_e){this.session.stopped=_e?2:1},recognize:function(_e){var Ce=this.session;if(!Ce.stopped){this.touchAction.preventDefaults(_e);var He,mt=this.recognizers,jt=Ce.curRecognizer;(!jt||jt&&8&jt.state)&&(jt=Ce.curRecognizer=null);for(var Ht=0;Ht<mt.length;)He=mt[Ht],2===Ce.stopped||jt&&He!=jt&&!He.canRecognizeWith(jt)?He.reset():He.recognize(_e),!jt&&14&He.state&&(jt=Ce.curRecognizer=He),Ht++}},get:function(_e){if(_e instanceof Mt)return _e;for(var Ce=this.recognizers,He=0;He<Ce.length;He++)if(Ce[He].options.event==_e)return Ce[He];return null},add:function(_e){if(b(_e,"add",this))return this;var Ce=this.get(_e.options.event);return Ce&&this.remove(Ce),this.recognizers.push(_e),_e.manager=this,this.touchAction.update(),_e},remove:function(_e){if(b(_e,"remove",this))return this;if(_e=this.get(_e)){var Ce=this.recognizers,He=E(Ce,_e);-1!==He&&(Ce.splice(He,1),this.touchAction.update())}return this},on:function(_e,Ce){if(_e!==K&&Ce!==K){var He=this.handlers;return S(Q(_e),function(mt){He[mt]=He[mt]||[],He[mt].push(Ce)}),this}},off:function(_e,Ce){if(_e!==K){var He=this.handlers;return S(Q(_e),function(mt){Ce?He[mt]&&He[mt].splice(E(He[mt],Ce),1):delete He[mt]}),this}},emit:function(_e,Ce){this.options.domEvents&&function(_e,Ce){var He=At.createEvent("Event");He.initEvent(_e,!0,!0),He.gesture=Ce,Ce.target.dispatchEvent(He)}(_e,Ce);var He=this.handlers[_e]&&this.handlers[_e].slice();if(He&&He.length){Ce.type=_e,Ce.preventDefault=function(){Ce.srcEvent.preventDefault()};for(var mt=0;mt<He.length;)He[mt](Ce),mt++}},destroy:function(){this.element&&Dl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},T(Fs,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:ao,Input:fe,TouchAction:$r,TouchInput:ct,MouseInput:Gr,PointerEventInput:Qt,TouchMouseInput:Tt,SingleTouchInput:ut,Recognizer:Mt,AttrRecognizer:pn,Tap:Pr,Pan:_s,Swipe:oo,Pinch:Wr,Rotate:Tl,Press:Ks,on:H,off:Y,each:S,merge:y,extend:v,assign:T,inherit:w,bindFn:D,prefixed:ue}),(void 0!==J?J:"undefined"!=typeof self?self:{}).Hammer=Fs,(gt=function(){return Fs}.call(it,tt,it,kt))!==K&&(kt.exports=gt)}(window,document)},815:function(kt,it,tt){var gt;kt=tt.nmd(kt),function(){var J,Ae="Expected a function",q="__lodash_hash_undefined__",L="__lodash_placeholder__",j=32,H=128,se=1/0,Te=9007199254740991,ye=4294967295,nt=[["ary",H],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",j],["partialRight",64],["rearg",256]],Ze="[object Arguments]",Je="[object Array]",je="[object Boolean]",Le="[object Date]",Re="[object Error]",Ue="[object Function]",qe="[object GeneratorFunction]",Be="[object Map]",z="[object Number]",be="[object Object]",ce="[object Promise]",wt="[object RegExp]",pt="[object Set]",fe="[object String]",B="[object Symbol]",k="[object WeakMap]",Xe="[object ArrayBuffer]",yt="[object DataView]",It="[object Float32Array]",Tn="[object Float64Array]",Pn="[object Int8Array]",$n="[object Int16Array]",yi="[object Int32Array]",hi="[object Uint8Array]",Hr="[object Uint8ClampedArray]",Ns="[object Uint16Array]",cs="[object Uint32Array]",Ps=/\b__p \+= '';/g,Gr=/\b(__p \+=) '' \+/g,qa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Al=/&(?:amp|lt|gt|quot|#39);/g,ua=/[&<>"']/g,ms=RegExp(Al.source),Qt=RegExp(ua.source),Ka=/<%-([\s\S]+?)%>/g,rt=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,ut=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pe=/^\w*$/,ve=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/[\\^$.*+?()[\]{}|]/g,ct=RegExp(ke.source),Qe=/^\s+/,vt=/\s/,xt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Tt=/\{\n\/\* \[wrapped with (.+)\] \*/,$t=/,? & /,jn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ii=/[()=,{}\[\]\/\s]/,Mn=/\\(\\)?/g,fn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,zn=/\w*$/,bn=/^[-+]0x[0-9a-f]+$/i,Zi=/^0b[01]+$/i,Ji=/^\[object .+?Constructor\]$/,qn=/^0o[0-7]+$/i,Pi=/^(?:0|[1-9]\d*)$/,da=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$r=/($^)/,ne=/['\n\r\u2028\u2029\\]/g,de="\\ud800-\\udfff",Z="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",Fe="a-z\\xdf-\\xf6\\xf8-\\xff",Et="A-Z\\xc0-\\xd6\\xd8-\\xde",pn="\\ufe0e\\ufe0f",_s="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ks="["+de+"]",Tl="["+_s+"]",oo="["+Z+"]",Pr="\\d+",Fs="["+we+"]",fc="["+Fe+"]",yn="[^"+de+_s+Pr+we+Fe+Et+"]",ao="\\ud83c[\\udffb-\\udfff]",ha="[^"+de+"]",id="(?:\\ud83c[\\udde6-\\uddff]){2}",_e="[\\ud800-\\udbff][\\udc00-\\udfff]",Ce="["+Et+"]",mt="(?:"+fc+"|"+yn+")",jt="(?:"+Ce+"|"+yn+")",Ht="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ri="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Fr="(?:"+oo+"|"+ao+")?",qr="["+pn+"]?",TC=qr+Fr+"(?:\\u200d(?:"+[ha,id,_e].join("|")+")"+qr+Fr+")*",rd="(?:"+[Fs,id,_e].join("|")+")"+TC,Wi="(?:"+[ha+oo+"?",oo,id,_e,Ks].join("|")+")",Wf=RegExp("['\u2019]","g"),xm=RegExp(oo,"g"),fh=RegExp(ao+"(?="+ao+")|"+Wi+TC,"g"),gv=RegExp([Ce+"?"+fc+"+"+Ht+"(?="+[Tl,Ce,"$"].join("|")+")",jt+"+"+ri+"(?="+[Tl,Ce+mt,"$"].join("|")+")",Ce+"?"+mt+"+"+Ht,Ce+"+"+ri,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pr,rd].join("|"),"g"),DC=RegExp("[\\u200d"+de+Z+pn+"]"),Ml=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ph=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],MC=-1,wn={};wn[It]=wn[Tn]=wn[Pn]=wn[$n]=wn[yi]=wn[hi]=wn[Hr]=wn[Ns]=wn[cs]=!0,wn[Ze]=wn[Je]=wn[Xe]=wn[je]=wn[yt]=wn[Le]=wn[Re]=wn[Ue]=wn[Be]=wn[z]=wn[be]=wn[wt]=wn[pt]=wn[fe]=wn[k]=!1;var er={};er[Ze]=er[Je]=er[Xe]=er[yt]=er[je]=er[Le]=er[It]=er[Tn]=er[Pn]=er[$n]=er[yi]=er[Be]=er[z]=er[be]=er[wt]=er[pt]=er[fe]=er[B]=er[hi]=er[Hr]=er[Ns]=er[cs]=!0,er[Re]=er[Ue]=er[k]=!1;var gn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},IC=parseFloat,vv=parseInt,Lt="object"==typeof global&&global&&global.Object===Object&&global,Ls="object"==typeof self&&self&&self.Object===Object&&self,Mi=Lt||Ls||Function("return this")(),Il=it&&!it.nodeType&&it,fa=Il&&kt&&!kt.nodeType&&kt,xo=fa&&fa.exports===Il,Cm=xo&&Lt.process,yr=function(){try{return fa&&fa.require&&fa.require("util").types||Cm&&Cm.binding&&Cm.binding("util")}catch(Dt){}}(),en=yr&&yr.isArrayBuffer,si=yr&&yr.isDate,sr=yr&&yr.isMap,lo=yr&&yr.isRegExp,pc=yr&&yr.isSet,Jr=yr&&yr.isTypedArray;function es(st,Dt,_t){switch(_t.length){case 0:return st.call(Dt);case 1:return st.call(Dt,_t[0]);case 2:return st.call(Dt,_t[0],_t[1]);case 3:return st.call(Dt,_t[0],_t[1],_t[2])}return st.apply(Dt,_t)}function Lr(st,Dt,_t,sn){for(var xn=-1,Ci=null==st?0:st.length;++xn<Ci;){var Kr=st[xn];Dt(sn,Kr,_t(Kr),st)}return sn}function ks(st,Dt){for(var _t=-1,sn=null==st?0:st.length;++_t<sn&&!1!==Dt(st[_t],_t,st););return st}function sd(st,Dt){for(var _t=null==st?0:st.length;_t--&&!1!==Dt(st[_t],_t,st););return st}function Zn(st,Dt){for(var _t=-1,sn=null==st?0:st.length;++_t<sn;)if(!Dt(st[_t],_t,st))return!1;return!0}function pa(st,Dt){for(var _t=-1,sn=null==st?0:st.length,xn=0,Ci=[];++_t<sn;){var Kr=st[_t];Dt(Kr,_t,st)&&(Ci[xn++]=Kr)}return Ci}function Rl(st,Dt){return!(null==st||!st.length)&&Ya(st,Dt,0)>-1}function gh(st,Dt,_t){for(var sn=-1,xn=null==st?0:st.length;++sn<xn;)if(_t(Dt,st[sn]))return!0;return!1}function ki(st,Dt){for(var _t=-1,sn=null==st?0:st.length,xn=Array(sn);++_t<sn;)xn[_t]=Dt(st[_t],_t,st);return xn}function kr(st,Dt){for(var _t=-1,sn=Dt.length,xn=st.length;++_t<sn;)st[xn+_t]=Dt[_t];return st}function su(st,Dt,_t,sn){var xn=-1,Ci=null==st?0:st.length;for(sn&&Ci&&(_t=st[++xn]);++xn<Ci;)_t=Dt(_t,st[xn],xn,st);return _t}function od(st,Dt,_t,sn){var xn=null==st?0:st.length;for(sn&&xn&&(_t=st[--xn]);xn--;)_t=Dt(_t,st[xn],xn,st);return _t}function Co(st,Dt){for(var _t=-1,sn=null==st?0:st.length;++_t<sn;)if(Dt(st[_t],_t,st))return!0;return!1}var tr=Am("length");function mh(st,Dt,_t){var sn;return _t(st,function(xn,Ci,Kr){if(Dt(xn,Ci,Kr))return sn=Ci,!1}),sn}function ad(st,Dt,_t,sn){for(var xn=st.length,Ci=_t+(sn?1:-1);sn?Ci--:++Ci<xn;)if(Dt(st[Ci],Ci,st))return Ci;return-1}function Ya(st,Dt,_t){return Dt==Dt?function(st,Dt,_t){for(var sn=_t-1,xn=st.length;++sn<xn;)if(st[sn]===Dt)return sn;return-1}(st,Dt,_t):ad(st,gc,_t)}function qf(st,Dt,_t,sn){for(var xn=_t-1,Ci=st.length;++xn<Ci;)if(sn(st[xn],Dt))return xn;return-1}function gc(st){return st!=st}function vs(st,Dt){var _t=null==st?0:st.length;return _t?ld(st,Dt)/_t:NaN}function Am(st){return function(Dt){return null==Dt?J:Dt[st]}}function Ho(st){return function(Dt){return null==st?J:st[Dt]}}function Go(st,Dt,_t,sn,xn){return xn(st,function(Ci,Kr,Bi){_t=sn?(sn=!1,Ci):Dt(_t,Ci,Kr,Bi)}),_t}function ld(st,Dt){for(var _t,sn=-1,xn=st.length;++sn<xn;){var Ci=Dt(st[sn]);Ci!==J&&(_t=_t===J?Ci:_t+Ci)}return _t}function cd(st,Dt){for(var _t=-1,sn=Array(st);++_t<st;)sn[_t]=Dt(_t);return sn}function bv(st){return st&&st.slice(0,mc(st)+1).replace(Qe,"")}function $o(st){return function(Dt){return st(Dt)}}function Dm(st,Dt){return ki(Dt,function(_t){return st[_t]})}function _h(st,Dt){return st.has(Dt)}function NC(st,Dt){for(var _t=-1,sn=st.length;++_t<sn&&Ya(Dt,st[_t],0)>-1;);return _t}function PC(st,Dt){for(var _t=st.length;_t--&&Ya(Dt,st[_t],0)>-1;);return _t}function DP(st,Dt){for(var _t=st.length,sn=0;_t--;)st[_t]===Dt&&++sn;return sn}var MP=Ho({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),IP=Ho({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function RP(st){return"\\"+gn[st]}function yh(st){return DC.test(st)}function wv(st){var Dt=-1,_t=Array(st.size);return st.forEach(function(sn,xn){_t[++Dt]=[xn,sn]}),_t}function FC(st,Dt){return function(_t){return st(Dt(_t))}}function ou(st,Dt){for(var _t=-1,sn=st.length,xn=0,Ci=[];++_t<sn;){var Kr=st[_t];(Kr===Dt||Kr===L)&&(st[_t]=L,Ci[xn++]=_t)}return Ci}function Mm(st){var Dt=-1,_t=Array(st.size);return st.forEach(function(sn){_t[++Dt]=sn}),_t}function vh(st){return yh(st)?function(st){for(var Dt=fh.lastIndex=0;fh.test(st);)++Dt;return Dt}(st):tr(st)}function Xa(st){return yh(st)?function(st){return st.match(fh)||[]}(st):function(st){return st.split("")}(st)}function mc(st){for(var Dt=st.length;Dt--&&vt.test(st.charAt(Dt)););return Dt}var Rm=Ho({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),bh=function st(Dt){var u,_t=(Dt=null==Dt?Mi:bh.defaults(Mi.Object(),Dt,bh.pick(Mi,ph))).Array,sn=Dt.Date,xn=Dt.Error,Ci=Dt.Function,Kr=Dt.Math,Bi=Dt.Object,Om=Dt.RegExp,Nm=Dt.String,ma=Dt.TypeError,or=_t.prototype,au=Bi.prototype,Kf=Dt["__core-js_shared__"],vr=Ci.prototype.toString,ji=au.hasOwnProperty,kP=0,wh=(u=/[^.]+$/.exec(Kf&&Kf.keys&&Kf.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",Ys=au.toString,BC=vr.call(Bi),Pm=Mi._,ud=Om("^"+vr.call(ji).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bs=xo?Dt.Buffer:J,Ol=Dt.Symbol,dd=Dt.Uint8Array,xv=Bs?Bs.allocUnsafe:J,_a=FC(Bi.getPrototypeOf,Bi),Fm=Bi.create,Yf=au.propertyIsEnumerable,Ln=or.splice,jC=Ol?Ol.isConcatSpreadable:J,Eh=Ol?Ol.iterator:J,lu=Ol?Ol.toStringTag:J,Xf=function(){try{var u=Ac(Bi,"defineProperty");return u({},"",{}),u}catch(h){}}(),Cv=Dt.clearTimeout!==Mi.clearTimeout&&Dt.clearTimeout,VC=sn&&sn.now!==Mi.Date.now&&sn.now,UC=Dt.setTimeout!==Mi.setTimeout&&Dt.setTimeout,Ft=Kr.ceil,fi=Kr.floor,ya=Bi.getOwnPropertySymbols,ts=Bs?Bs.isBuffer:J,Lm=Dt.isFinite,Sh=or.join,Qa=FC(Bi.keys,Bi),Br=Kr.max,us=Kr.min,BP=sn.now,zC=Dt.parseInt,xh=Kr.random,Qf=or.reverse,bs=Ac(Dt,"DataView"),co=Ac(Dt,"Map"),Zf=Ac(Dt,"Promise"),va=Ac(Dt,"Set"),Ao=Ac(Dt,"WeakMap"),Ch=Ac(Bi,"create"),Ah=Ao&&new Ao,hd={},HC=bu(bs),km=bu(co),Bm=bu(Zf),Av=bu(va),jm=bu(Ao),Jf=Ol?Ol.prototype:J,fd=Jf?Jf.valueOf:J,Th=Jf?Jf.toString:J;function Se(u){if(Er(u)&&!Dn(u)&&!(u instanceof oi)){if(u instanceof To)return u;if(ji.call(u,"__wrapped__"))return Sp(u)}return new To(u)}var cu=function(){function u(){}return function(h){if(!wr(h))return{};if(Fm)return Fm(h);u.prototype=h;var m=new u;return u.prototype=J,m}}();function Dh(){}function To(u,h){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=J}function oi(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ye,this.__views__=[]}function uo(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var N=u[h];this.set(N[0],N[1])}}function Nl(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var N=u[h];this.set(N[0],N[1])}}function Za(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var N=u[h];this.set(N[0],N[1])}}function ba(u){var h=-1,m=null==u?0:u.length;for(this.__data__=new Za;++h<m;)this.add(u[h])}function wa(u){var h=this.__data__=new Nl(u);this.size=h.size}function Ih(u,h){var m=Dn(u),N=!m&&al(u),ae=!m&&!N&&ll(u),xe=!m&&!N&&!ae&&$h(u),ze=m||N||ae||xe,Ke=ze?cd(u.length,Nm):[],lt=Ke.length;for(var Ot in u)(h||ji.call(u,Ot))&&(!ze||!("length"==Ot||ae&&("offset"==Ot||"parent"==Ot)||xe&&("buffer"==Ot||"byteLength"==Ot||"byteOffset"==Ot)||Io(Ot,lt)))&&Ke.push(Ot);return Ke}function Hm(u){var h=u.length;return h?u[Pl(0,h-1)]:J}function Dv(u,h){return Dd(Qs(u),uu(h,0,u.length))}function pd(u){return Dd(Qs(u))}function Gm(u,h,m){(m!==J&&!Cn(u[h],m)||m===J&&!(h in u))&&el(u,h,m)}function Ja(u,h,m){var N=u[h];(!ji.call(u,h)||!Cn(N,m)||m===J&&!(h in u))&&el(u,h,m)}function gd(u,h){for(var m=u.length;m--;)if(Cn(u[m][0],h))return m;return-1}function rp(u,h,m,N){return vc(u,function(ae,xe,ze){h(N,ae,m(ae),ze)}),N}function tA(u,h){return u&&xa(h,Cs(h),u)}function el(u,h,m){"__proto__"==h&&Xf?Xf(u,h,{configurable:!0,enumerable:!0,value:m,writable:!0}):u[h]=m}function $m(u,h){for(var m=-1,N=h.length,ae=_t(N),xe=null==u;++m<N;)ae[m]=xe?J:Kh(u,h[m]);return ae}function uu(u,h,m){return u==u&&(m!==J&&(u=u<=m?u:m),h!==J&&(u=u>=h?u:h)),u}function js(u,h,m,N,ae,xe){var ze,Ke=1&h,lt=2&h,Ot=4&h;if(m&&(ze=ae?m(u,N,ae,xe):m(u)),ze!==J)return ze;if(!wr(u))return u;var Nt=Dn(u);if(Nt){if(ze=function(u){var h=u.length,m=new u.constructor(h);return h&&"string"==typeof u[0]&&ji.call(u,"index")&&(m.index=u.index,m.input=u.input),m}(u),!Ke)return Qs(u,ze)}else{var Bt=Us(u),Jt=Bt==Ue||Bt==qe;if(ll(u))return hp(u,Ke);if(Bt==be||Bt==Ze||Jt&&!ae){if(ze=lt||Jt?{}:Qv(u),!Ke)return lt?function(u,h){return xa(u,Kv(u),h)}(u,function(u,h){return u&&xa(h,Js(h),u)}(ze,u)):function(u,h){return xa(u,a_(u),h)}(u,tA(ze,u))}else{if(!er[Bt])return ae?u:{};ze=function(u,h,m){var N=u.constructor;switch(h){case Xe:return mu(u);case je:case Le:return new N(+u);case yt:return function(u,h){var m=h?mu(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.byteLength)}(u,m);case It:case Tn:case Pn:case $n:case yi:case hi:case Hr:case Ns:case cs:return n_(u,m);case Be:return new N;case z:case fe:return new N(u);case wt:return function(u){var h=new u.constructor(u.source,zn.exec(u));return h.lastIndex=u.lastIndex,h}(u);case pt:return new N;case B:return function(u){return fd?Bi(fd.call(u)):{}}(u)}}(u,Bt,Ke)}}xe||(xe=new wa);var _n=xe.get(u);if(_n)return _n;xe.set(u,ze),E1(u)?u.forEach(function(kn){ze.add(js(kn,h,m,kn,u,xe))}):y1(u)&&u.forEach(function(kn,ci){ze.set(ci,js(kn,h,m,ci,u,xe))});var li=Nt?J:(Ot?lt?s_:Bl:lt?Js:Cs)(u);return ks(li||u,function(kn,ci){li&&(kn=u[ci=kn]),Ja(ze,ci,js(kn,h,m,ci,u,xe))}),ze}function sp(u,h,m){var N=m.length;if(null==u)return!N;for(u=Bi(u);N--;){var ae=m[N],ze=u[ae];if(ze===J&&!(ae in u)||!(0,h[ae])(ze))return!1}return!0}function Rh(u,h,m){if("function"!=typeof u)throw new ma(Ae);return Bh(function(){u.apply(J,m)},h)}function yc(u,h,m,N){var ae=-1,xe=Rl,ze=!0,Ke=u.length,lt=[],Ot=h.length;if(!Ke)return lt;m&&(h=ki(h,$o(m))),N?(xe=gh,ze=!1):h.length>=200&&(xe=_h,ze=!1,h=new ba(h));e:for(;++ae<Ke;){var Nt=u[ae],Bt=null==m?Nt:m(Nt);if(Nt=N||0!==Nt?Nt:0,ze&&Bt==Bt){for(var Jt=Ot;Jt--;)if(h[Jt]===Bt)continue e;lt.push(Nt)}else xe(h,Bt,N)||lt.push(Nt)}return lt}Se.templateSettings={escape:Ka,evaluate:rt,interpolate:ot,variable:"",imports:{_:Se}},(Se.prototype=Dh.prototype).constructor=Se,(To.prototype=cu(Dh.prototype)).constructor=To,(oi.prototype=cu(Dh.prototype)).constructor=oi,uo.prototype.clear=function(){this.__data__=Ch?Ch(null):{},this.size=0},uo.prototype.delete=function(u){var h=this.has(u)&&delete this.__data__[u];return this.size-=h?1:0,h},uo.prototype.get=function(u){var h=this.__data__;if(Ch){var m=h[u];return m===q?J:m}return ji.call(h,u)?h[u]:J},uo.prototype.has=function(u){var h=this.__data__;return Ch?h[u]!==J:ji.call(h,u)},uo.prototype.set=function(u,h){var m=this.__data__;return this.size+=this.has(u)?0:1,m[u]=Ch&&h===J?q:h,this},Nl.prototype.clear=function(){this.__data__=[],this.size=0},Nl.prototype.delete=function(u){var h=this.__data__,m=gd(h,u);return!(m<0||(m==h.length-1?h.pop():Ln.call(h,m,1),--this.size,0))},Nl.prototype.get=function(u){var h=this.__data__,m=gd(h,u);return m<0?J:h[m][1]},Nl.prototype.has=function(u){return gd(this.__data__,u)>-1},Nl.prototype.set=function(u,h){var m=this.__data__,N=gd(m,u);return N<0?(++this.size,m.push([u,h])):m[N][1]=h,this},Za.prototype.clear=function(){this.size=0,this.__data__={hash:new uo,map:new(co||Nl),string:new uo}},Za.prototype.delete=function(u){var h=Vs(this,u).delete(u);return this.size-=h?1:0,h},Za.prototype.get=function(u){return Vs(this,u).get(u)},Za.prototype.has=function(u){return Vs(this,u).has(u)},Za.prototype.set=function(u,h){var m=Vs(this,u),N=m.size;return m.set(u,h),this.size+=m.size==N?0:1,this},ba.prototype.add=ba.prototype.push=function(u){return this.__data__.set(u,q),this},ba.prototype.has=function(u){return this.__data__.has(u)},wa.prototype.clear=function(){this.__data__=new Nl,this.size=0},wa.prototype.delete=function(u){var h=this.__data__,m=h.delete(u);return this.size=h.size,m},wa.prototype.get=function(u){return this.__data__.get(u)},wa.prototype.has=function(u){return this.__data__.has(u)},wa.prototype.set=function(u,h){var m=this.__data__;if(m instanceof Nl){var N=m.__data__;if(!co||N.length<199)return N.push([u,h]),this.size=++m.size,this;m=this.__data__=new Za(N)}return m.set(u,h),this.size=m.size,this};var vc=il(tl),qm=il(op,!0);function Iv(u,h){var m=!0;return vc(u,function(N,ae,xe){return m=!!h(N,ae,xe)}),m}function Oh(u,h,m){for(var N=-1,ae=u.length;++N<ae;){var xe=u[N],ze=h(xe);if(null!=ze&&(Ke===J?ze==ze&&!ta(ze):m(ze,Ke)))var Ke=ze,lt=xe}return lt}function Ov(u,h){var m=[];return vc(u,function(N,ae,xe){h(N,ae,xe)&&m.push(N)}),m}function ws(u,h,m,N,ae){var xe=-1,ze=u.length;for(m||(m=vA),ae||(ae=[]);++xe<ze;){var Ke=u[xe];h>0&&m(Ke)?h>1?ws(Ke,h-1,m,N,ae):kr(ae,Ke):N||(ae[ae.length]=Ke)}return ae}var md=jv(),_d=jv(!0);function tl(u,h){return u&&md(u,h,Cs)}function op(u,h){return u&&_d(u,h,Cs)}function Nh(u,h){return pa(h,function(m){return ea(u[m])})}function Wo(u,h){for(var m=0,N=(h=Sc(h,u)).length;null!=u&&m<N;)u=u[Jn(h[m++])];return m&&m==N?u:J}function nr(u,h,m){var N=h(u);return Dn(u)?N:kr(N,m(u))}function Es(u){return null==u?u===J?"[object Undefined]":"[object Null]":lu&&lu in Bi(u)?function(u){var h=ji.call(u,lu),m=u[lu];try{u[lu]=J;var N=!0}catch(xe){}var ae=Ys.call(u);return N&&(h?u[lu]=m:delete u[lu]),ae}(u):function(u){return Ys.call(u)}(u)}function Ea(u,h){return u>h}function yd(u,h){return null!=u&&ji.call(u,h)}function vd(u,h){return null!=u&&h in Bi(u)}function du(u,h,m){for(var N=m?gh:Rl,ae=u[0].length,xe=u.length,ze=xe,Ke=_t(xe),lt=1/0,Ot=[];ze--;){var Nt=u[ze];ze&&h&&(Nt=ki(Nt,$o(h))),lt=us(Nt.length,lt),Ke[ze]=!m&&(h||ae>=120&&Nt.length>=120)?new ba(ze&&Nt):J}Nt=u[0];var Bt=-1,Jt=Ke[0];e:for(;++Bt<ae&&Ot.length<lt;){var _n=Nt[Bt],Fn=h?h(_n):_n;if(_n=m||0!==_n?_n:0,!(Jt?_h(Jt,Fn):N(Ot,Fn,m))){for(ze=xe;--ze;){var li=Ke[ze];if(!(li?_h(li,Fn):N(u[ze],Fn,m)))continue e}Jt&&Jt.push(Fn),Ot.push(_n)}}return Ot}function Sa(u,h,m){var N=null==(u=d_(u,h=Sc(h,u)))?u:u[Jn(Qo(h))];return null==N?J:es(N,u,m)}function nA(u){return Er(u)&&Es(u)==Ze}function ap(u,h,m,N,ae){return u===h||(null==u||null==h||!Er(u)&&!Er(h)?u!=u&&h!=h:function(u,h,m,N,ae,xe){var ze=Dn(u),Ke=Dn(h),lt=ze?Je:Us(u),Ot=Ke?Je:Us(h),Nt=(lt=lt==Ze?be:lt)==be,Bt=(Ot=Ot==Ze?be:Ot)==be,Jt=lt==Ot;if(Jt&&ll(u)){if(!ll(h))return!1;ze=!0,Nt=!1}if(Jt&&!Nt)return xe||(xe=new wa),ze||$h(u)?yp(u,h,m,N,ae,xe):function(u,h,m,N,ae,xe,ze){switch(m){case yt:if(u.byteLength!=h.byteLength||u.byteOffset!=h.byteOffset)return!1;u=u.buffer,h=h.buffer;case Xe:return!(u.byteLength!=h.byteLength||!xe(new dd(u),new dd(h)));case je:case Le:case z:return Cn(+u,+h);case Re:return u.name==h.name&&u.message==h.message;case wt:case fe:return u==h+"";case Be:var Ke=wv;case pt:if(Ke||(Ke=Mm),u.size!=h.size&&!(1&N))return!1;var Ot=ze.get(u);if(Ot)return Ot==h;N|=2,ze.set(u,h);var Nt=yp(Ke(u),Ke(h),N,ae,xe,ze);return ze.delete(u),Nt;case B:if(fd)return fd.call(u)==fd.call(h)}return!1}(u,h,lt,m,N,ae,xe);if(!(1&m)){var _n=Nt&&ji.call(u,"__wrapped__"),Fn=Bt&&ji.call(h,"__wrapped__");if(_n||Fn){var li=_n?u.value():u,kn=Fn?h.value():h;return xe||(xe=new wa),ae(li,kn,m,N,xe)}}return!!Jt&&(xe||(xe=new wa),function(u,h,m,N,ae,xe){var ze=1&m,Ke=Bl(u),lt=Ke.length;if(lt!=Bl(h).length&&!ze)return!1;for(var Bt=lt;Bt--;){var Jt=Ke[Bt];if(!(ze?Jt in h:ji.call(h,Jt)))return!1}var _n=xe.get(u),Fn=xe.get(h);if(_n&&Fn)return _n==h&&Fn==u;var li=!0;xe.set(u,h),xe.set(h,u);for(var kn=ze;++Bt<lt;){var ci=u[Jt=Ke[Bt]],vi=h[Jt];if(N)var po=ze?N(vi,ci,Jt,h,u,xe):N(ci,vi,Jt,u,h,xe);if(!(po===J?ci===vi||ae(ci,vi,m,N,xe):po)){li=!1;break}kn||(kn="constructor"==Jt)}if(li&&!kn){var Hs=u.constructor,na=h.constructor;Hs!=na&&"constructor"in u&&"constructor"in h&&!("function"==typeof Hs&&Hs instanceof Hs&&"function"==typeof na&&na instanceof na)&&(li=!1)}return xe.delete(u),xe.delete(h),li}(u,h,m,N,ae,xe))}(u,h,m,N,ap,ae))}function Ym(u,h,m,N){var ae=m.length,xe=ae,ze=!N;if(null==u)return!xe;for(u=Bi(u);ae--;){var Ke=m[ae];if(ze&&Ke[2]?Ke[1]!==u[Ke[0]]:!(Ke[0]in u))return!1}for(;++ae<xe;){var lt=(Ke=m[ae])[0],Ot=u[lt],Nt=Ke[1];if(ze&&Ke[2]){if(Ot===J&&!(lt in u))return!1}else{var Bt=new wa;if(N)var Jt=N(Ot,Nt,lt,u,h,Bt);if(!(Jt===J?ap(Nt,Ot,3,N,Bt):Jt))return!1}}return!0}function Xm(u){return!(!wr(u)||function(u){return!!wh&&wh in u}(u))&&(ea(u)?ud:Ji).test(bu(u))}function sA(u){return"function"==typeof u?u:null==u?eo:"object"==typeof u?Dn(u)?wd(u[0],u[1]):aA(u):Su(u)}function Nv(u){if(!wp(u))return Qa(u);var h=[];for(var m in Bi(u))ji.call(u,m)&&"constructor"!=m&&h.push(m);return h}function Pv(u,h){return u<h}function oA(u,h){var m=-1,N=ho(u)?_t(u.length):[];return vc(u,function(ae,xe,ze){N[++m]=h(ae,xe,ze)}),N}function aA(u){var h=Yo(u);return 1==h.length&&h[0][2]?wA(h[0][0],h[0][1]):function(m){return m===u||Ym(m,u,h)}}function wd(u,h){return Xo(u)&&bA(h)?wA(Jn(u),h):function(m){var N=Kh(m,u);return N===J&&N===h?Pp(m,u):ap(h,N,3)}}function Qm(u,h,m,N,ae){u!==h&&md(h,function(xe,ze){if(ae||(ae=new wa),wr(xe))!function(u,h,m,N,ae,xe,ze){var Ke=h_(u,m),lt=h_(h,m),Ot=ze.get(lt);if(Ot)Gm(u,m,Ot);else{var Nt=xe?xe(Ke,lt,m+"",u,h,ze):J,Bt=Nt===J;if(Bt){var Jt=Dn(lt),_n=!Jt&&ll(lt),Fn=!Jt&&!_n&&$h(lt);Nt=lt,Jt||_n||Fn?Dn(Ke)?Nt=Ke:br(Ke)?Nt=Qs(Ke):_n?(Bt=!1,Nt=hp(lt,!0)):Fn?(Bt=!1,Nt=n_(lt,!0)):Nt=[]:Np(lt)||al(lt)?(Nt=Ke,al(Ke)?Nt=Hb(Ke):(!wr(Ke)||ea(Ke))&&(Nt=Qv(lt))):Bt=!1}Bt&&(ze.set(lt,Nt),ae(Nt,lt,N,xe,ze),ze.delete(lt)),Gm(u,m,Nt)}}(u,h,ze,m,Qm,N,ae);else{var Ke=N?N(h_(u,ze),xe,ze+"",u,h,ae):J;Ke===J&&(Ke=xe),Gm(u,ze,Ke)}},Js)}function hu(u,h){var m=u.length;if(m)return Io(h+=h<0?m:0,m)?u[h]:J}function Ph(u,h,m){h=h.length?ki(h,function(xe){return Dn(xe)?function(ze){return Wo(ze,1===xe.length?xe[0]:xe)}:xe}):[eo];var N=-1;return h=ki(h,$o(On())),function(st,Dt){var _t=st.length;for(st.sort(function(xe,ze){return function(u,h,m){for(var N=-1,ae=u.criteria,xe=h.criteria,ze=ae.length,Ke=m.length;++N<ze;){var lt=xc(ae[N],xe[N]);if(lt)return N>=Ke?lt:lt*("desc"==m[N]?-1:1)}return u.index-h.index}(xe,ze,m)});_t--;)st[_t]=st[_t].value;return st}(oA(u,function(xe,ze,Ke){return{criteria:ki(h,function(Ot){return Ot(xe)}),index:++N,value:xe}}))}function Fv(u,h,m){for(var N=-1,ae=h.length,xe={};++N<ae;){var ze=h[N],Ke=Wo(u,ze);m(Ke,ze)&&cp(xe,Sc(ze,u),Ke)}return xe}function Ko(u,h,m,N){var ae=N?qf:Ya,xe=-1,ze=h.length,Ke=u;for(u===h&&(h=Qs(h)),m&&(Ke=ki(u,$o(m)));++xe<ze;)for(var lt=0,Ot=h[xe],Nt=m?m(Ot):Ot;(lt=ae(Ke,Nt,lt,N))>-1;)Ke!==u&&Ln.call(Ke,lt,1),Ln.call(u,lt,1);return u}function Fh(u,h){for(var m=u?h.length:0,N=m-1;m--;){var ae=h[m];if(m==N||ae!==xe){var xe=ae;Io(ae)?Ln.call(u,ae,1):fu(u,ae)}}return u}function Pl(u,h){return u+fi(xh()*(h-u+1))}function lp(u,h){var m="";if(!u||h<1||h>Te)return m;do{h%2&&(m+=u),(h=fi(h/2))&&(u+=u)}while(h);return m}function ai(u,h){return Ep(EA(u,h,eo),u+"")}function lA(u){return Hm(kd(u))}function qP(u,h){var m=kd(u);return Dd(m,uu(h,0,m.length))}function cp(u,h,m,N){if(!wr(u))return u;for(var ae=-1,xe=(h=Sc(h,u)).length,ze=xe-1,Ke=u;null!=Ke&&++ae<xe;){var lt=Jn(h[ae]),Ot=m;if("__proto__"===lt||"constructor"===lt||"prototype"===lt)return u;if(ae!=ze){var Nt=Ke[lt];(Ot=N?N(Nt,lt,Ke):J)===J&&(Ot=wr(Nt)?Nt:Io(h[ae+1])?[]:{})}Ja(Ke,lt,Ot),Ke=Ke[lt]}return u}var Zm=Ah?function(u,h){return Ah.set(u,h),u}:eo,Do=Xf?function(u,h){return Xf(u,"toString",{configurable:!0,enumerable:!1,value:J_(h),writable:!0})}:eo;function Jm(u){return Dd(kd(u))}function Ss(u,h,m){var N=-1,ae=u.length;h<0&&(h=-h>ae?0:ae+h),(m=m>ae?ae:m)<0&&(m+=ae),ae=h>m?0:m-h>>>0,h>>>=0;for(var xe=_t(ae);++N<ae;)xe[N]=u[N+h];return xe}function KP(u,h){var m;return vc(u,function(N,ae,xe){return!(m=h(N,ae,xe))}),!!m}function Lh(u,h,m){var N=0,ae=null==u?N:u.length;if("number"==typeof h&&h==h&&ae<=2147483647){for(;N<ae;){var xe=N+ae>>>1,ze=u[xe];null!==ze&&!ta(ze)&&(m?ze<=h:ze<h)?N=xe+1:ae=xe}return ae}return e_(u,h,eo,m)}function e_(u,h,m,N){var ae=0,xe=null==u?0:u.length;if(0===xe)return 0;for(var ze=(h=m(h))!=h,Ke=null===h,lt=ta(h),Ot=h===J;ae<xe;){var Nt=fi((ae+xe)/2),Bt=m(u[Nt]),Jt=Bt!==J,_n=null===Bt,Fn=Bt==Bt,li=ta(Bt);if(ze)var kn=N||Fn;else kn=Ot?Fn&&(N||Jt):Ke?Fn&&Jt&&(N||!_n):lt?Fn&&Jt&&!_n&&(N||!li):!_n&&!li&&(N?Bt<=h:Bt<h);kn?ae=Nt+1:xe=Nt}return us(xe,4294967294)}function Lv(u,h){for(var m=-1,N=u.length,ae=0,xe=[];++m<N;){var ze=u[m],Ke=h?h(ze):ze;if(!m||!Cn(Ke,lt)){var lt=Ke;xe[ae++]=0===ze?0:ze}}return xe}function kv(u){return"number"==typeof u?u:ta(u)?NaN:+u}function Mo(u){if("string"==typeof u)return u;if(Dn(u))return ki(u,Mo)+"";if(ta(u))return Th?Th.call(u):"";var h=u+"";return"0"==h&&1/u==-se?"-0":h}function wc(u,h,m){var N=-1,ae=Rl,xe=u.length,ze=!0,Ke=[],lt=Ke;if(m)ze=!1,ae=gh;else if(xe>=200){var Ot=h?null:r_(u);if(Ot)return Mm(Ot);ze=!1,ae=_h,lt=new ba}else lt=h?[]:Ke;e:for(;++N<xe;){var Nt=u[N],Bt=h?h(Nt):Nt;if(Nt=m||0!==Nt?Nt:0,ze&&Bt==Bt){for(var Jt=lt.length;Jt--;)if(lt[Jt]===Bt)continue e;h&&lt.push(Bt),Ke.push(Nt)}else ae(lt,Bt,m)||(lt!==Ke&&lt.push(Bt),Ke.push(Nt))}return Ke}function fu(u,h){return null==(u=d_(u,h=Sc(h,u)))||delete u[Jn(Qo(h))]}function up(u,h,m,N){return cp(u,h,m(Wo(u,h)),N)}function pu(u,h,m,N){for(var ae=u.length,xe=N?ae:-1;(N?xe--:++xe<ae)&&h(u[xe],xe,u););return m?Ss(u,N?0:xe,N?xe+1:ae):Ss(u,N?xe+1:0,N?ae:xe)}function cA(u,h){var m=u;return m instanceof oi&&(m=m.value()),su(h,function(N,ae){return ae.func.apply(ae.thisArg,kr([N],ae.args))},m)}function gu(u,h,m){var N=u.length;if(N<2)return N?wc(u[0]):[];for(var ae=-1,xe=_t(N);++ae<N;)for(var ze=u[ae],Ke=-1;++Ke<N;)Ke!=ae&&(xe[ae]=yc(xe[ae]||ze,u[Ke],h,m));return wc(ws(xe,1),h,m)}function dp(u,h,m){for(var N=-1,ae=u.length,xe=h.length,ze={};++N<ae;)m(ze,u[N],N<xe?h[N]:J);return ze}function Ec(u){return br(u)?u:[]}function t_(u){return"function"==typeof u?u:eo}function Sc(u,h){return Dn(u)?u:Xo(u,h)?[u]:tb(Ii(u))}var uA=ai;function nl(u,h,m){var N=u.length;return m=m===J?N:m,!h&&m>=N?u:Ss(u,h,m)}var dA=Cv||function(u){return Mi.clearTimeout(u)};function hp(u,h){if(h)return u.slice();var m=u.length,N=xv?xv(m):new u.constructor(m);return u.copy(N),N}function mu(u){var h=new u.constructor(u.byteLength);return new dd(h).set(new dd(u)),h}function n_(u,h){var m=h?mu(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.length)}function xc(u,h){if(u!==h){var m=u!==J,N=null===u,ae=u==u,xe=ta(u),ze=h!==J,Ke=null===h,lt=h==h,Ot=ta(h);if(!Ke&&!Ot&&!xe&&u>h||xe&&ze&&lt&&!Ke&&!Ot||N&&ze&&lt||!m&&lt||!ae)return 1;if(!N&&!xe&&!Ot&&u<h||Ot&&m&&ae&&!N&&!xe||Ke&&m&&ae||!ze&&ae||!lt)return-1}return 0}function Sd(u,h,m,N){for(var ae=-1,xe=u.length,ze=m.length,Ke=-1,lt=h.length,Ot=Br(xe-ze,0),Nt=_t(lt+Ot),Bt=!N;++Ke<lt;)Nt[Ke]=h[Ke];for(;++ae<ze;)(Bt||ae<xe)&&(Nt[m[ae]]=u[ae]);for(;Ot--;)Nt[Ke++]=u[ae++];return Nt}function Bv(u,h,m,N){for(var ae=-1,xe=u.length,ze=-1,Ke=m.length,lt=-1,Ot=h.length,Nt=Br(xe-Ke,0),Bt=_t(Nt+Ot),Jt=!N;++ae<Nt;)Bt[ae]=u[ae];for(var _n=ae;++lt<Ot;)Bt[_n+lt]=h[lt];for(;++ze<Ke;)(Jt||ae<xe)&&(Bt[_n+m[ze]]=u[ae++]);return Bt}function Qs(u,h){var m=-1,N=u.length;for(h||(h=_t(N));++m<N;)h[m]=u[m];return h}function xa(u,h,m,N){var ae=!m;m||(m={});for(var xe=-1,ze=h.length;++xe<ze;){var Ke=h[xe],lt=N?N(m[Ke],u[Ke],Ke,m,u):J;lt===J&&(lt=u[Ke]),ae?el(m,Ke,lt):Ja(m,Ke,lt)}return m}function Yr(u,h){return function(m,N){var ae=Dn(m)?Lr:rp,xe=h?h():{};return ae(m,u,On(N,2),xe)}}function Fl(u){return ai(function(h,m){var N=-1,ae=m.length,xe=ae>1?m[ae-1]:J,ze=ae>2?m[2]:J;for(xe=u.length>3&&"function"==typeof xe?(ae--,xe):J,ze&&zs(m[0],m[1],ze)&&(xe=ae<3?J:xe,ae=1),h=Bi(h);++N<ae;){var Ke=m[N];Ke&&u(h,Ke,N,xe)}return h})}function il(u,h){return function(m,N){if(null==m)return m;if(!ho(m))return u(m,N);for(var ae=m.length,xe=h?ae:-1,ze=Bi(m);(h?xe--:++xe<ae)&&!1!==N(ze[xe],xe,ze););return m}}function jv(u){return function(h,m,N){for(var ae=-1,xe=Bi(h),ze=N(h),Ke=ze.length;Ke--;){var lt=ze[u?Ke:++ae];if(!1===m(xe[lt],lt,xe))break}return h}}function fp(u){return function(h){var m=yh(h=Ii(h))?Xa(h):J,N=m?m[0]:h.charAt(0),ae=m?nl(m,1).join(""):h.slice(1);return N[u]()+ae}}function Ll(u){return function(h){return su(Q_(G_(h).replace(Wf,"")),u,"")}}function Cd(u){return function(){var h=arguments;switch(h.length){case 0:return new u;case 1:return new u(h[0]);case 2:return new u(h[0],h[1]);case 3:return new u(h[0],h[1],h[2]);case 4:return new u(h[0],h[1],h[2],h[3]);case 5:return new u(h[0],h[1],h[2],h[3],h[4]);case 6:return new u(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new u(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var m=cu(u.prototype),N=u.apply(m,h);return wr(N)?N:m}}function Uv(u){return function(h,m,N){var ae=Bi(h);if(!ho(h)){var xe=On(m,3);h=Cs(h),m=function(Ke){return xe(ae[Ke],Ke,ae)}}var ze=u(h,m,N);return ze>-1?ae[xe?h[ze]:ze]:J}}function yu(u){return rl(function(h){var m=h.length,N=m,ae=To.prototype.thru;for(u&&h.reverse();N--;){var xe=h[N];if("function"!=typeof xe)throw new ma(Ae);if(ae&&!ze&&"wrapper"==vp(xe))var ze=new To([],!0)}for(N=ze?N:m;++N<m;){var Ke=vp(xe=h[N]),lt="wrapper"==Ke?o_(xe):J;ze=lt&&bp(lt[0])&&424==lt[1]&&!lt[4].length&&1==lt[9]?ze[vp(lt[0])].apply(ze,lt[3]):1==xe.length&&bp(xe)?ze[Ke]():ze.thru(xe)}return function(){var Ot=arguments,Nt=Ot[0];if(ze&&1==Ot.length&&Dn(Nt))return ze.plant(Nt).value();for(var Bt=0,Jt=m?h[Bt].apply(this,Ot):Nt;++Bt<m;)Jt=h[Bt].call(this,Jt);return Jt}})}function Cc(u,h,m,N,ae,xe,ze,Ke,lt,Ot){var Nt=h&H,Bt=1&h,Jt=2&h,_n=24&h,Fn=512&h,li=Jt?J:Cd(u);return function kn(){for(var ci=arguments.length,vi=_t(ci),po=ci;po--;)vi[po]=arguments[po];if(_n)var Hs=Td(kn),na=DP(vi,Hs);if(N&&(vi=Sd(vi,N,ae,_n)),xe&&(vi=Bv(vi,xe,ze,_n)),ci-=na,_n&&ci<Ot){var Ri=ou(vi,Hs);return Gv(u,h,Cc,kn.placeholder,m,vi,Ri,Ke,lt,Ot-ci)}var dl=Bt?m:this,Ic=Jt?dl[u]:u;return ci=vi.length,Ke?vi=SA(vi,Ke):Fn&&ci>1&&vi.reverse(),Nt&&lt<ci&&(vi.length=lt),this&&this!==Mi&&this instanceof kn&&(Ic=li||Cd(Ic)),Ic.apply(dl,vi)}}function zv(u,h){return function(m,N){return function(u,h,m,N){return tl(u,function(ae,xe,ze){h(N,m(ae),xe,ze)}),N}(m,u,h(N),{})}}function i_(u,h){return function(m,N){var ae;if(m===J&&N===J)return h;if(m!==J&&(ae=m),N!==J){if(ae===J)return N;"string"==typeof m||"string"==typeof N?(m=Mo(m),N=Mo(N)):(m=kv(m),N=kv(N)),ae=u(m,N)}return ae}}function pp(u){return rl(function(h){return h=ki(h,$o(On())),ai(function(m){var N=this;return u(h,function(ae){return es(ae,N,m)})})})}function gp(u,h){var m=(h=h===J?" ":Mo(h)).length;if(m<2)return m?lp(h,u):h;var N=lp(h,Ft(u/vh(h)));return yh(h)?nl(Xa(N),0,u).join(""):N.slice(0,u)}function Hv(u){return function(h,m,N){return N&&"number"!=typeof N&&zs(h,m,N)&&(m=N=J),h=cl(h),m===J?(m=h,h=0):m=cl(m),function(u,h,m,N){for(var ae=-1,xe=Br(Ft((h-u)/(m||1)),0),ze=_t(xe);xe--;)ze[N?xe:++ae]=u,u+=m;return ze}(h,m,N=N===J?h<m?1:-1:cl(N),u)}}function mp(u){return function(h,m){return"string"==typeof h&&"string"==typeof m||(h=fo(h),m=fo(m)),u(h,m)}}function Gv(u,h,m,N,ae,xe,ze,Ke,lt,Ot){var Nt=8&h;h|=Nt?j:64,4&(h&=~(Nt?64:j))||(h&=-4);var li=[u,h,ae,Nt?xe:J,Nt?ze:J,Nt?J:xe,Nt?J:ze,Ke,lt,Ot],kn=m.apply(J,li);return bp(u)&&eb(kn,li),kn.placeholder=N,jh(kn,u,h)}function Ad(u){var h=Kr[u];return function(m,N){if(m=fo(m),(N=null==N?0:us(Yn(N),292))&&Lm(m)){var ae=(Ii(m)+"e").split("e");return+((ae=(Ii(h(ae[0]+"e"+(+ae[1]+N)))+"e").split("e"))[0]+"e"+(+ae[1]-N))}return h(m)}}var r_=va&&1/Mm(new va([,-0]))[1]==se?function(u){return new va(u)}:ny;function vu(u){return function(h){var m=Us(h);return m==Be?wv(h):m==pt?function(st){var Dt=-1,_t=Array(st.size);return st.forEach(function(sn){_t[++Dt]=[sn,sn]}),_t}(h):function(st,Dt){return ki(Dt,function(_t){return[_t,st[_t]]})}(h,u(h))}}function kl(u,h,m,N,ae,xe,ze,Ke){var lt=2&h;if(!lt&&"function"!=typeof u)throw new ma(Ae);var Ot=N?N.length:0;if(Ot||(h&=-97,N=ae=J),ze=ze===J?ze:Br(Yn(ze),0),Ke=Ke===J?Ke:Yn(Ke),Ot-=ae?ae.length:0,64&h){var Nt=N,Bt=ae;N=ae=J}var Jt=lt?J:o_(u),_n=[u,h,m,N,ae,Nt,Bt,xe,ze,Ke];if(Jt&&function(u,h){var m=u[1],N=h[1],ae=m|N;if(!(ae<131||(N==H&&8==m||N==H&&256==m&&u[7].length<=h[8]||384==N&&h[7].length<=h[8]&&8==m)))return u;1&N&&(u[2]=h[2],ae|=1&m?0:4);var Ke=h[3];if(Ke){var lt=u[3];u[3]=lt?Sd(lt,Ke,h[4]):Ke,u[4]=lt?ou(u[3],L):h[4]}(Ke=h[5])&&(u[5]=(lt=u[5])?Bv(lt,Ke,h[6]):Ke,u[6]=lt?ou(u[5],L):h[6]),(Ke=h[7])&&(u[7]=Ke),N&H&&(u[8]=null==u[8]?h[8]:us(u[8],h[8])),null==u[9]&&(u[9]=h[9]),u[0]=h[0],u[1]=ae}(_n,Jt),u=_n[0],h=_n[1],m=_n[2],N=_n[3],ae=_n[4],!(Ke=_n[9]=_n[9]===J?lt?0:u.length:Br(_n[9]-Ot,0))&&24&h&&(h&=-25),h&&1!=h)Fn=8==h||16==h?function(u,h,m){var N=Cd(u);return function ae(){for(var xe=arguments.length,ze=_t(xe),Ke=xe,lt=Td(ae);Ke--;)ze[Ke]=arguments[Ke];var Ot=xe<3&&ze[0]!==lt&&ze[xe-1]!==lt?[]:ou(ze,lt);return(xe-=Ot.length)<m?Gv(u,h,Cc,ae.placeholder,J,ze,Ot,J,J,m-xe):es(this&&this!==Mi&&this instanceof ae?N:u,this,ze)}}(u,h,Ke):h!=j&&33!=h||ae.length?Cc.apply(J,_n):function(u,h,m,N){var ae=1&h,xe=Cd(u);return function ze(){for(var Ke=-1,lt=arguments.length,Ot=-1,Nt=N.length,Bt=_t(Nt+lt),Jt=this&&this!==Mi&&this instanceof ze?xe:u;++Ot<Nt;)Bt[Ot]=N[Ot];for(;lt--;)Bt[Ot++]=arguments[++Ke];return es(Jt,ae?m:this,Bt)}}(u,h,m,N);else var Fn=function(u,h,m){var N=1&h,ae=Cd(u);return function xe(){return(this&&this!==Mi&&this instanceof xe?ae:u).apply(N?m:this,arguments)}}(u,h,m);return jh((Jt?Zm:eb)(Fn,_n),u,h)}function $v(u,h,m,N){return u===J||Cn(u,au[m])&&!ji.call(N,m)?h:u}function pA(u,h,m,N,ae,xe){return wr(u)&&wr(h)&&(xe.set(h,u),Qm(u,h,J,pA,xe),xe.delete(h)),u}function _p(u){return Np(u)?J:u}function yp(u,h,m,N,ae,xe){var ze=1&m,Ke=u.length,lt=h.length;if(Ke!=lt&&!(ze&&lt>Ke))return!1;var Ot=xe.get(u),Nt=xe.get(h);if(Ot&&Nt)return Ot==h&&Nt==u;var Bt=-1,Jt=!0,_n=2&m?new ba:J;for(xe.set(u,h),xe.set(h,u);++Bt<Ke;){var Fn=u[Bt],li=h[Bt];if(N)var kn=ze?N(li,Fn,Bt,h,u,xe):N(Fn,li,Bt,u,h,xe);if(kn!==J){if(kn)continue;Jt=!1;break}if(_n){if(!Co(h,function(ci,vi){if(!_h(_n,vi)&&(Fn===ci||ae(Fn,ci,m,N,xe)))return _n.push(vi)})){Jt=!1;break}}else if(Fn!==li&&!ae(Fn,li,m,N,xe)){Jt=!1;break}}return xe.delete(u),xe.delete(h),Jt}function rl(u){return Ep(EA(u,J,xs),u+"")}function Bl(u){return nr(u,Cs,a_)}function s_(u){return nr(u,Js,Kv)}var o_=Ah?function(u){return Ah.get(u)}:ny;function vp(u){for(var h=u.name+"",m=hd[h],N=ji.call(hd,h)?m.length:0;N--;){var ae=m[N],xe=ae.func;if(null==xe||xe==u)return ae.name}return h}function Td(u){return(ji.call(Se,"placeholder")?Se:u).placeholder}function On(){var u=Se.iteratee||Eu;return u=u===Eu?sA:u,arguments.length?u(arguments[0],arguments[1]):u}function Vs(u,h){var m=u.__data__;return function(u){var h=typeof u;return"string"==h||"number"==h||"symbol"==h||"boolean"==h?"__proto__"!==u:null===u}(h)?m["string"==typeof h?"string":"hash"]:m.map}function Yo(u){for(var h=Cs(u),m=h.length;m--;){var N=h[m],ae=u[N];h[m]=[N,ae,bA(ae)]}return h}function Ac(u,h){var m=function(st,Dt){return null==st?J:st[Dt]}(u,h);return Xm(m)?m:J}var a_=ya?function(u){return null==u?[]:(u=Bi(u),pa(ya(u),function(h){return Yf.call(u,h)}))}:Mc,Kv=ya?function(u){for(var h=[];u;)kr(h,a_(u)),u=_a(u);return h}:Mc,Us=Es;function Xv(u,h,m){for(var N=-1,ae=(h=Sc(h,u)).length,xe=!1;++N<ae;){var ze=Jn(h[N]);if(!(xe=null!=u&&m(u,ze)))break;u=u[ze]}return xe||++N!=ae?xe:!!(ae=null==u?0:u.length)&&F_(ae)&&Io(ze,ae)&&(Dn(u)||al(u))}function Qv(u){return"function"!=typeof u.constructor||wp(u)?{}:cu(_a(u))}function vA(u){return Dn(u)||al(u)||!!(jC&&u&&u[jC])}function Io(u,h){var m=typeof u;return!!(h=null==h?Te:h)&&("number"==m||"symbol"!=m&&Pi.test(u))&&u>-1&&u%1==0&&u<h}function zs(u,h,m){if(!wr(m))return!1;var N=typeof h;return!!("number"==N?ho(m)&&Io(h,m.length):"string"==N&&h in m)&&Cn(m[h],u)}function Xo(u,h){if(Dn(u))return!1;var m=typeof u;return!("number"!=m&&"symbol"!=m&&"boolean"!=m&&null!=u&&!ta(u))||pe.test(u)||!ut.test(u)||null!=h&&u in Bi(h)}function bp(u){var h=vp(u),m=Se[h];if("function"!=typeof m||!(h in oi.prototype))return!1;if(u===m)return!0;var N=o_(m);return!!N&&u===N[0]}(bs&&Us(new bs(new ArrayBuffer(1)))!=yt||co&&Us(new co)!=Be||Zf&&Us(Zf.resolve())!=ce||va&&Us(new va)!=pt||Ao&&Us(new Ao)!=k)&&(Us=function(u){var h=Es(u),m=h==be?u.constructor:J,N=m?bu(m):"";if(N)switch(N){case HC:return yt;case km:return Be;case Bm:return ce;case Av:return pt;case jm:return k}return h});var Jv=Kf?ea:ry;function wp(u){var h=u&&u.constructor;return u===("function"==typeof h&&h.prototype||au)}function bA(u){return u==u&&!wr(u)}function wA(u,h){return function(m){return null!=m&&m[u]===h&&(h!==J||u in Bi(m))}}function EA(u,h,m){return h=Br(h===J?u.length-1:h,0),function(){for(var N=arguments,ae=-1,xe=Br(N.length-h,0),ze=_t(xe);++ae<xe;)ze[ae]=N[h+ae];ae=-1;for(var Ke=_t(h+1);++ae<h;)Ke[ae]=N[ae];return Ke[h]=m(ze),es(u,this,Ke)}}function d_(u,h){return h.length<2?u:Wo(u,Ss(h,0,-1))}function SA(u,h){for(var m=u.length,N=us(h.length,m),ae=Qs(u);N--;){var xe=h[N];u[N]=Io(xe,m)?ae[xe]:J}return u}function h_(u,h){if(("constructor"!==h||"function"!=typeof u[h])&&"__proto__"!=h)return u[h]}var eb=f_(Zm),Bh=UC||function(u,h){return Mi.setTimeout(u,h)},Ep=f_(Do);function jh(u,h,m){var N=h+"";return Ep(u,function(u,h){var m=h.length;if(!m)return u;var N=m-1;return h[N]=(m>1?"& ":"")+h[N],h=h.join(m>2?", ":" "),u.replace(xt,"{\n/* [wrapped with "+h+"] */\n")}(N,function(u,h){return ks(nt,function(m){var N="_."+m[0];h&m[1]&&!Rl(u,N)&&u.push(N)}),u.sort()}(function(u){var h=u.match(Tt);return h?h[1].split($t):[]}(N),m)))}function f_(u){var h=0,m=0;return function(){var N=BP(),ae=16-(N-m);if(m=N,ae>0){if(++h>=800)return arguments[0]}else h=0;return u.apply(J,arguments)}}function Dd(u,h){var m=-1,N=u.length,ae=N-1;for(h=h===J?N:h;++m<h;){var xe=Pl(m,ae),ze=u[xe];u[xe]=u[m],u[m]=ze}return u.length=h,u}var h,m,tb=(h=Gh(function(u){var h=[];return 46===u.charCodeAt(0)&&h.push(""),u.replace(ve,function(m,N,ae,xe){h.push(ae?xe.replace(Mn,"$1"):N||m)}),h},function(N){return 500===m.size&&m.clear(),N}),m=h.cache,h);function Jn(u){if("string"==typeof u||ta(u))return u;var h=u+"";return"0"==h&&1/u==-se?"-0":h}function bu(u){if(null!=u){try{return vr.call(u)}catch(h){}try{return u+""}catch(h){}}return""}function Sp(u){if(u instanceof oi)return u.clone();var h=new To(u.__wrapped__,u.__chain__);return h.__actions__=Qs(u.__actions__),h.__index__=u.__index__,h.__values__=u.__values__,h}var TA=ai(function(u,h){return br(u)?yc(u,ws(h,1,br,!0)):[]}),DA=ai(function(u,h){var m=Qo(h);return br(m)&&(m=J),br(u)?yc(u,ws(h,1,br,!0),On(m,2)):[]}),MA=ai(function(u,h){var m=Qo(h);return br(m)&&(m=J),br(u)?yc(u,ws(h,1,br,!0),J,m):[]});function g_(u,h,m){var N=null==u?0:u.length;if(!N)return-1;var ae=null==m?0:Yn(m);return ae<0&&(ae=Br(N+ae,0)),ad(u,On(h,3),ae)}function m_(u,h,m){var N=null==u?0:u.length;if(!N)return-1;var ae=N-1;return m!==J&&(ae=Yn(m),ae=m<0?Br(N+ae,0):us(ae,N-1)),ad(u,On(h,3),ae,!0)}function xs(u){return null!=u&&u.length?ws(u,1):[]}function ib(u){return u&&u.length?u[0]:J}var sb=ai(function(u){var h=ki(u,Ec);return h.length&&h[0]===u[0]?du(h):[]}),OA=ai(function(u){var h=Qo(u),m=ki(u,Ec);return h===Qo(m)?h=J:m.pop(),m.length&&m[0]===u[0]?du(m,On(h,2)):[]}),ob=ai(function(u){var h=Qo(u),m=ki(u,Ec);return(h="function"==typeof h?h:J)&&m.pop(),m.length&&m[0]===u[0]?du(m,J,h):[]});function Qo(u){var h=null==u?0:u.length;return h?u[h-1]:J}var y_=ai(v_);function v_(u,h){return u&&u.length&&h&&h.length?Ko(u,h):u}var lb=rl(function(u,h){var m=null==u?0:u.length,N=$m(u,h);return Fh(u,ki(h,function(ae){return Io(ae,m)?+ae:ae}).sort(xc)),N});function b_(u){return null==u?u:Qf.call(u)}var db=ai(function(u){return wc(ws(u,1,br,!0))}),GA=ai(function(u){var h=Qo(u);return br(h)&&(h=J),wc(ws(u,1,br,!0),On(h,2))}),$A=ai(function(u){var h=Qo(u);return h="function"==typeof h?h:J,wc(ws(u,1,br,!0),J,h)});function hb(u){if(!u||!u.length)return[];var h=0;return u=pa(u,function(m){if(br(m))return h=Br(m.length,h),!0}),cd(h,function(m){return ki(u,Am(m))})}function qA(u,h){if(!u||!u.length)return[];var m=hb(u);return null==h?m:ki(m,function(N){return es(h,J,N)})}var fb=ai(function(u,h){return br(u)?yc(u,h):[]}),iF=ai(function(u){return gu(pa(u,br))}),Ro=ai(function(u){var h=Qo(u);return br(h)&&(h=J),gu(pa(u,br),On(h,2))}),w_=ai(function(u){var h=Qo(u);return h="function"==typeof h?h:J,gu(pa(u,br),J,h)}),E_=ai(hb),zh=ai(function(u){var h=u.length,m=h>1?u[h-1]:J;return m="function"==typeof m?(u.pop(),m):J,qA(u,m)});function S_(u){var h=Se(u);return h.__chain__=!0,h}function Id(u,h){return h(u)}var x_=rl(function(u){var h=u.length,m=h?u[0]:0,N=this.__wrapped__,ae=function(xe){return $m(xe,u)};return!(h>1||this.__actions__.length)&&N instanceof oi&&Io(m)?((N=N.slice(m,+m+(h?1:0))).__actions__.push({func:Id,args:[ae],thisArg:J}),new To(N,this.__chain__).thru(function(xe){return h&&!xe.length&&xe.push(J),xe})):this.thru(ae)}),XA=Yr(function(u,h,m){ji.call(u,m)?++u[m]:el(u,m,1)}),JA=Uv(g_),e1=Uv(m_);function D_(u,h){return(Dn(u)?ks:vc)(u,On(h,3))}function Ap(u,h){return(Dn(u)?sd:qm)(u,On(h,3))}var n1=Yr(function(u,h,m){ji.call(u,m)?u[m].push(h):el(u,m,[h])}),vb=ai(function(u,h,m){var N=-1,ae="function"==typeof h,xe=ho(u)?_t(u.length):[];return vc(u,function(ze){xe[++N]=ae?es(h,ze,m):Sa(ze,h,m)}),xe}),bb=Yr(function(u,h,m){el(u,m,h)});function ol(u,h){return(Dn(u)?ki:oA)(u,On(h,3))}var Eb=Yr(function(u,h,m){u[m?0:1].push(h)},function(){return[[],[]]}),Dp=ai(function(u,h){if(null==u)return[];var m=h.length;return m>1&&zs(u,h[0],h[1])?h=[]:m>2&&zs(h[0],h[1],h[2])&&(h=[h[0]]),Ph(u,ws(h,1),[])}),wu=VC||function(){return Mi.Date.now()};function Mp(u,h,m){return h=m?J:h,kl(u,H,J,J,J,J,h=u&&null==h?u.length:h)}function I_(u,h){var m;if("function"!=typeof h)throw new ma(Ae);return u=Yn(u),function(){return--u>0&&(m=h.apply(this,arguments)),u<=1&&(h=J),m}}var Hh=ai(function(u,h,m){var N=1;if(m.length){var ae=ou(m,Td(Hh));N|=j}return kl(u,N,h,m,ae)}),Od=ai(function(u,h,m){var N=3;if(m.length){var ae=ou(m,Td(Od));N|=j}return kl(h,N,u,m,ae)});function Mb(u,h,m){var N,ae,xe,ze,Ke,lt,Ot=0,Nt=!1,Bt=!1,Jt=!0;if("function"!=typeof u)throw new ma(Ae);function _n(Ri){var dl=N,Ic=ae;return N=ae=J,Ot=Ri,ze=u.apply(Ic,dl)}function Fn(Ri){return Ot=Ri,Ke=Bh(ci,h),Nt?_n(Ri):ze}function kn(Ri){var dl=Ri-lt;return lt===J||dl>=h||dl<0||Bt&&Ri-Ot>=xe}function ci(){var Ri=wu();if(kn(Ri))return vi(Ri);Ke=Bh(ci,function(Ri){var dT=h-(Ri-lt);return Bt?us(dT,xe-(Ri-Ot)):dT}(Ri))}function vi(Ri){return Ke=J,Jt&&N?_n(Ri):(N=ae=J,ze)}function na(){var Ri=wu(),dl=kn(Ri);if(N=arguments,ae=this,lt=Ri,dl){if(Ke===J)return Fn(lt);if(Bt)return dA(Ke),Ke=Bh(ci,h),_n(lt)}return Ke===J&&(Ke=Bh(ci,h)),ze}return h=fo(h)||0,wr(m)&&(Nt=!!m.leading,xe=(Bt="maxWait"in m)?Br(fo(m.maxWait)||0,h):xe,Jt="trailing"in m?!!m.trailing:Jt),na.cancel=function(){Ke!==J&&dA(Ke),Ot=0,N=lt=ae=Ke=J},na.flush=function(){return Ke===J?ze:vi(wu())},na}var a1=ai(function(u,h){return Rh(u,1,h)}),Ib=ai(function(u,h,m){return Rh(u,fo(h)||0,m)});function Gh(u,h){if("function"!=typeof u||null!=h&&"function"!=typeof h)throw new ma(Ae);var m=function(){var N=arguments,ae=h?h.apply(this,N):N[0],xe=m.cache;if(xe.has(ae))return xe.get(ae);var ze=u.apply(this,N);return m.cache=xe.set(ae,ze)||xe,ze};return m.cache=new(Gh.Cache||Za),m}function N_(u){if("function"!=typeof u)throw new ma(Ae);return function(){var h=arguments;switch(h.length){case 0:return!u.call(this);case 1:return!u.call(this,h[0]);case 2:return!u.call(this,h[0],h[1]);case 3:return!u.call(this,h[0],h[1],h[2])}return!u.apply(this,h)}}Gh.Cache=Za;var l1=uA(function(u,h){var m=(h=1==h.length&&Dn(h[0])?ki(h[0],$o(On())):ki(ws(h,1),$o(On()))).length;return ai(function(N){for(var ae=-1,xe=us(N.length,m);++ae<xe;)N[ae]=h[ae].call(this,N[ae]);return es(u,this,N)})}),Ip=ai(function(u,h){var m=ou(h,Td(Ip));return kl(u,j,J,h,m)}),Ob=ai(function(u,h){var m=ou(h,Td(Ob));return kl(u,64,J,h,m)}),c1=rl(function(u,h){return kl(u,256,J,J,J,h)});function Cn(u,h){return u===h||u!=u&&h!=h}var on=mp(Ea),Fb=mp(function(u,h){return u>=h}),al=nA(function(){return arguments}())?nA:function(u){return Er(u)&&ji.call(u,"callee")&&!Yf.call(u,"callee")},Dn=_t.isArray,Lb=en?$o(en):function(u){return Er(u)&&Es(u)==Xe};function ho(u){return null!=u&&F_(u.length)&&!ea(u)}function br(u){return Er(u)&&ho(u)}var ll=ts||ry,kb=si?$o(si):function(u){return Er(u)&&Es(u)==Le};function Aa(u){if(!Er(u))return!1;var h=Es(u);return h==Re||"[object DOMException]"==h||"string"==typeof u.message&&"string"==typeof u.name&&!Np(u)}function ea(u){if(!wr(u))return!1;var h=Es(u);return h==Ue||h==qe||"[object AsyncFunction]"==h||"[object Proxy]"==h}function Op(u){return"number"==typeof u&&u==Yn(u)}function F_(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=Te}function wr(u){var h=typeof u;return null!=u&&("object"==h||"function"==h)}function Er(u){return null!=u&&"object"==typeof u}var y1=sr?$o(sr):function(u){return Er(u)&&Us(u)==Be};function w1(u){return"number"==typeof u||Er(u)&&Es(u)==z}function Np(u){if(!Er(u)||Es(u)!=be)return!1;var h=_a(u);if(null===h)return!0;var m=ji.call(h,"constructor")&&h.constructor;return"function"==typeof m&&m instanceof m&&vr.call(m)==BC}var Ub=lo?$o(lo):function(u){return Er(u)&&Es(u)==wt},E1=pc?$o(pc):function(u){return Er(u)&&Us(u)==pt};function k_(u){return"string"==typeof u||!Dn(u)&&Er(u)&&Es(u)==fe}function ta(u){return"symbol"==typeof u||Er(u)&&Es(u)==B}var $h=Jr?$o(Jr):function(u){return Er(u)&&F_(u.length)&&!!wn[Es(u)]},Tc=mp(Pv),B_=mp(function(u,h){return u<=h});function zb(u){if(!u)return[];if(ho(u))return k_(u)?Xa(u):Qs(u);if(Eh&&u[Eh])return function(st){for(var Dt,_t=[];!(Dt=st.next()).done;)_t.push(Dt.value);return _t}(u[Eh]());var h=Us(u);return(h==Be?wv:h==pt?Mm:kd)(u)}function cl(u){return u?(u=fo(u))===se||u===-se?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Yn(u){var h=cl(u),m=h%1;return h==h?m?h-m:h:0}function j_(u){return u?uu(Yn(u),0,ye):0}function fo(u){if("number"==typeof u)return u;if(ta(u))return NaN;if(wr(u)){var h="function"==typeof u.valueOf?u.valueOf():u;u=wr(h)?h+"":h}if("string"!=typeof u)return 0===u?u:+u;u=bv(u);var m=Zi.test(u);return m||qn.test(u)?vv(u.slice(2),m?2:8):bn.test(u)?NaN:+u}function Hb(u){return xa(u,Js(u))}function Ii(u){return null==u?"":Mo(u)}var S1=Fl(function(u,h){if(wp(h)||ho(h))xa(h,Cs(h),u);else for(var m in h)ji.call(h,m)&&Ja(u,m,h[m])}),x1=Fl(function(u,h){xa(h,Js(h),u)}),Nd=Fl(function(u,h,m,N){xa(h,Js(h),u,N)}),C1=Fl(function(u,h,m,N){xa(h,Cs(h),u,N)}),Gb=rl($m),T1=ai(function(u,h){u=Bi(u);var m=-1,N=h.length,ae=N>2?h[2]:J;for(ae&&zs(h[0],h[1],ae)&&(N=1);++m<N;)for(var xe=h[m],ze=Js(xe),Ke=-1,lt=ze.length;++Ke<lt;){var Ot=ze[Ke],Nt=u[Ot];(Nt===J||Cn(Nt,au[Ot])&&!ji.call(u,Ot))&&(u[Ot]=xe[Ot])}return u}),Wh=ai(function(u){return u.push(J,pA),es(Xb,J,u)});function Kh(u,h,m){var N=null==u?J:Wo(u,h);return N===J?m:N}function Pp(u,h){return null!=u&&Xv(u,h,vd)}var Fp=zv(function(u,h,m){null!=h&&"function"!=typeof h.toString&&(h=Ys.call(h)),u[h]=m},J_(eo)),M1=zv(function(u,h,m){null!=h&&"function"!=typeof h.toString&&(h=Ys.call(h)),ji.call(u,h)?u[h].push(m):u[h]=[m]},On),qb=ai(Sa);function Cs(u){return ho(u)?Ih(u):Nv(u)}function Js(u){return ho(u)?Ih(u,!0):function(u){if(!wr(u))return function(u){var h=[];if(null!=u)for(var m in Bi(u))h.push(m);return h}(u);var h=wp(u),m=[];for(var N in u)"constructor"==N&&(h||!ji.call(u,N))||m.push(N);return m}(u)}var Yb=Fl(function(u,h,m){Qm(u,h,m)}),Xb=Fl(function(u,h,m,N){Qm(u,h,m,N)}),R1=rl(function(u,h){var m={};if(null==u)return m;var N=!1;h=ki(h,function(xe){return xe=Sc(xe,u),N||(N=xe.length>1),xe}),xa(u,s_(u),m),N&&(m=js(m,7,_p));for(var ae=h.length;ae--;)fu(m,h[ae]);return m}),O1=rl(function(u,h){return null==u?{}:function(u,h){return Fv(u,h,function(m,N){return Pp(u,N)})}(u,h)});function Qb(u,h){if(null==u)return{};var m=ki(s_(u),function(N){return[N]});return h=On(h),Fv(u,m,function(N,ae){return h(N,ae[0])})}var N1=vu(Cs),Jb=vu(Js);function kd(u){return null==u?[]:Dm(u,Cs(u))}var B1=Ll(function(u,h,m){return h=h.toLowerCase(),u+(m?H_(h):h)});function H_(u){return kp(Ii(u).toLowerCase())}function G_(u){return(u=Ii(u))&&u.replace(da,MP).replace(xm,"")}var V1=Ll(function(u,h,m){return u+(m?"-":"")+h.toLowerCase()}),U1=Ll(function(u,h,m){return u+(m?" ":"")+h.toLowerCase()}),pF=fp("toLowerCase"),W1=Ll(function(u,h,m){return u+(m?"_":"")+h.toLowerCase()}),q_=Ll(function(u,h,m){return u+(m?" ":"")+kp(h)}),sw=Ll(function(u,h,m){return u+(m?" ":"")+h.toUpperCase()}),kp=fp("toUpperCase");function Q_(u,h,m){return u=Ii(u),(h=m?J:h)===J?function(st){return Ml.test(st)}(u)?function(st){return st.match(gv)||[]}(u):function(st){return st.match(jn)||[]}(u):u.match(h)||[]}var Z_=ai(function(u,h){try{return es(u,J,h)}catch(m){return Aa(m)?m:new xn(m)}}),ow=rl(function(u,h){return ks(h,function(m){m=Jn(m),el(u,m,Hh(u[m],u))}),u});function J_(u){return function(){return u}}var mF=yu(),Bd=yu(!0);function eo(u){return u}function Eu(u){return sA("function"==typeof u?u:js(u,1))}var ey=ai(function(u,h){return function(m){return Sa(m,u,h)}}),aw=ai(function(u,h){return function(m){return Sa(u,m,h)}});function ty(u,h,m){var N=Cs(h),ae=Nh(h,N);null==m&&(!wr(h)||!ae.length&&N.length)&&(m=h,h=u,u=this,ae=Nh(h,Cs(h)));var xe=!(wr(m)&&"chain"in m&&!m.chain),ze=ea(u);return ks(ae,function(Ke){var lt=h[Ke];u[Ke]=lt,ze&&(u.prototype[Ke]=function(){var Ot=this.__chain__;if(xe||Ot){var Nt=u(this.__wrapped__),Bt=Nt.__actions__=Qs(this.__actions__);return Bt.push({func:lt,args:arguments,thisArg:u}),Nt.__chain__=Ot,Nt}return lt.apply(u,kr([this.value()],arguments))})}),u}function ny(){}var J1=pp(ki),eT=pp(Zn),cw=pp(Co);function Su(u){return Xo(u)?Am(Jn(u)):function(u){return function(h){return Wo(h,u)}}(u)}var tT=Hv(),nT=Hv(!0);function Mc(){return[]}function ry(){return!1}var Hn=i_(function(u,h){return u+h},0),sy=Ad("ceil"),yF=i_(function(u,h){return u/h},1),Ul=Ad("floor"),fw=i_(function(u,h){return u*h},1),pw=Ad("round"),gw=i_(function(u,h){return u-h},0);return Se.after=function(u,h){if("function"!=typeof h)throw new ma(Ae);return u=Yn(u),function(){if(--u<1)return h.apply(this,arguments)}},Se.ary=Mp,Se.assign=S1,Se.assignIn=x1,Se.assignInWith=Nd,Se.assignWith=C1,Se.at=Gb,Se.before=I_,Se.bind=Hh,Se.bindAll=ow,Se.bindKey=Od,Se.castArray=function(){if(!arguments.length)return[];var u=arguments[0];return Dn(u)?u:[u]},Se.chain=S_,Se.chunk=function(u,h,m){h=(m?zs(u,h,m):h===J)?1:Br(Yn(h),0);var N=null==u?0:u.length;if(!N||h<1)return[];for(var ae=0,xe=0,ze=_t(Ft(N/h));ae<N;)ze[xe++]=Ss(u,ae,ae+=h);return ze},Se.compact=function(u){for(var h=-1,m=null==u?0:u.length,N=0,ae=[];++h<m;){var xe=u[h];xe&&(ae[N++]=xe)}return ae},Se.concat=function(){var u=arguments.length;if(!u)return[];for(var h=_t(u-1),m=arguments[0],N=u;N--;)h[N-1]=arguments[N];return kr(Dn(m)?Qs(m):[m],ws(h,1))},Se.cond=function(u){var h=null==u?0:u.length,m=On();return u=h?ki(u,function(N){if("function"!=typeof N[1])throw new ma(Ae);return[m(N[0]),N[1]]}):[],ai(function(N){for(var ae=-1;++ae<h;){var xe=u[ae];if(es(xe[0],this,N))return es(xe[1],this,N)}})},Se.conforms=function(u){return function(u){var h=Cs(u);return function(m){return sp(m,u,h)}}(js(u,1))},Se.constant=J_,Se.countBy=XA,Se.create=function(u,h){var m=cu(u);return null==h?m:tA(m,h)},Se.curry=function Db(u,h,m){var N=kl(u,8,J,J,J,J,J,h=m?J:h);return N.placeholder=Db.placeholder,N},Se.curryRight=function R_(u,h,m){var N=kl(u,16,J,J,J,J,J,h=m?J:h);return N.placeholder=R_.placeholder,N},Se.debounce=Mb,Se.defaults=T1,Se.defaultsDeep=Wh,Se.defer=a1,Se.delay=Ib,Se.difference=TA,Se.differenceBy=DA,Se.differenceWith=MA,Se.drop=function(u,h,m){var N=null==u?0:u.length;return N?Ss(u,(h=m||h===J?1:Yn(h))<0?0:h,N):[]},Se.dropRight=function(u,h,m){var N=null==u?0:u.length;return N?Ss(u,0,(h=N-(h=m||h===J?1:Yn(h)))<0?0:h):[]},Se.dropRightWhile=function(u,h){return u&&u.length?pu(u,On(h,3),!0,!0):[]},Se.dropWhile=function(u,h){return u&&u.length?pu(u,On(h,3),!0):[]},Se.fill=function(u,h,m,N){var ae=null==u?0:u.length;return ae?(m&&"number"!=typeof m&&zs(u,h,m)&&(m=0,N=ae),function(u,h,m,N){var ae=u.length;for((m=Yn(m))<0&&(m=-m>ae?0:ae+m),(N=N===J||N>ae?ae:Yn(N))<0&&(N+=ae),N=m>N?0:j_(N);m<N;)u[m++]=h;return u}(u,h,m,N)):[]},Se.filter=function(u,h){return(Dn(u)?pa:Ov)(u,On(h,3))},Se.flatMap=function(u,h){return ws(ol(u,h),1)},Se.flatMapDeep=function(u,h){return ws(ol(u,h),se)},Se.flatMapDepth=function(u,h,m){return m=m===J?1:Yn(m),ws(ol(u,h),m)},Se.flatten=xs,Se.flattenDeep=function(u){return null!=u&&u.length?ws(u,se):[]},Se.flattenDepth=function(u,h){return null!=u&&u.length?ws(u,h=h===J?1:Yn(h)):[]},Se.flip=function(u){return kl(u,512)},Se.flow=mF,Se.flowRight=Bd,Se.fromPairs=function(u){for(var h=-1,m=null==u?0:u.length,N={};++h<m;){var ae=u[h];N[ae[0]]=ae[1]}return N},Se.functions=function(u){return null==u?[]:Nh(u,Cs(u))},Se.functionsIn=function(u){return null==u?[]:Nh(u,Js(u))},Se.groupBy=n1,Se.initial=function(u){return null!=u&&u.length?Ss(u,0,-1):[]},Se.intersection=sb,Se.intersectionBy=OA,Se.intersectionWith=ob,Se.invert=Fp,Se.invertBy=M1,Se.invokeMap=vb,Se.iteratee=Eu,Se.keyBy=bb,Se.keys=Cs,Se.keysIn=Js,Se.map=ol,Se.mapKeys=function(u,h){var m={};return h=On(h,3),tl(u,function(N,ae,xe){el(m,h(N,ae,xe),N)}),m},Se.mapValues=function(u,h){var m={};return h=On(h,3),tl(u,function(N,ae,xe){el(m,ae,h(N,ae,xe))}),m},Se.matches=function(u){return aA(js(u,1))},Se.matchesProperty=function(u,h){return wd(u,js(h,1))},Se.memoize=Gh,Se.merge=Yb,Se.mergeWith=Xb,Se.method=ey,Se.methodOf=aw,Se.mixin=ty,Se.negate=N_,Se.nthArg=function(u){return u=Yn(u),ai(function(h){return hu(h,u)})},Se.omit=R1,Se.omitBy=function(u,h){return Qb(u,N_(On(h)))},Se.once=function(u){return I_(2,u)},Se.orderBy=function(u,h,m,N){return null==u?[]:(Dn(h)||(h=null==h?[]:[h]),Dn(m=N?J:m)||(m=null==m?[]:[m]),Ph(u,h,m))},Se.over=J1,Se.overArgs=l1,Se.overEvery=eT,Se.overSome=cw,Se.partial=Ip,Se.partialRight=Ob,Se.partition=Eb,Se.pick=O1,Se.pickBy=Qb,Se.property=Su,Se.propertyOf=function(u){return function(h){return null==u?J:Wo(u,h)}},Se.pull=y_,Se.pullAll=v_,Se.pullAllBy=function(u,h,m){return u&&u.length&&h&&h.length?Ko(u,h,On(m,2)):u},Se.pullAllWith=function(u,h,m){return u&&u.length&&h&&h.length?Ko(u,h,J,m):u},Se.pullAt=lb,Se.range=tT,Se.rangeRight=nT,Se.rearg=c1,Se.reject=function(u,h){return(Dn(u)?pa:Ov)(u,N_(On(h,3)))},Se.remove=function(u,h){var m=[];if(!u||!u.length)return m;var N=-1,ae=[],xe=u.length;for(h=On(h,3);++N<xe;){var ze=u[N];h(ze,N,u)&&(m.push(ze),ae.push(N))}return Fh(u,ae),m},Se.rest=function(u,h){if("function"!=typeof u)throw new ma(Ae);return ai(u,h=h===J?h:Yn(h))},Se.reverse=b_,Se.sampleSize=function(u,h,m){return h=(m?zs(u,h,m):h===J)?1:Yn(h),(Dn(u)?Dv:qP)(u,h)},Se.set=function(u,h,m){return null==u?u:cp(u,h,m)},Se.setWith=function(u,h,m,N){return N="function"==typeof N?N:J,null==u?u:cp(u,h,m,N)},Se.shuffle=function(u){return(Dn(u)?pd:Jm)(u)},Se.slice=function(u,h,m){var N=null==u?0:u.length;return N?(m&&"number"!=typeof m&&zs(u,h,m)?(h=0,m=N):(h=null==h?0:Yn(h),m=m===J?N:Yn(m)),Ss(u,h,m)):[]},Se.sortBy=Dp,Se.sortedUniq=function(u){return u&&u.length?Lv(u):[]},Se.sortedUniqBy=function(u,h){return u&&u.length?Lv(u,On(h,2)):[]},Se.split=function(u,h,m){return m&&"number"!=typeof m&&zs(u,h,m)&&(h=m=J),(m=m===J?ye:m>>>0)?(u=Ii(u))&&("string"==typeof h||null!=h&&!Ub(h))&&!(h=Mo(h))&&yh(u)?nl(Xa(u),0,m):u.split(h,m):[]},Se.spread=function(u,h){if("function"!=typeof u)throw new ma(Ae);return h=null==h?0:Br(Yn(h),0),ai(function(m){var N=m[h],ae=nl(m,0,h);return N&&kr(ae,N),es(u,this,ae)})},Se.tail=function(u){var h=null==u?0:u.length;return h?Ss(u,1,h):[]},Se.take=function(u,h,m){return u&&u.length?Ss(u,0,(h=m||h===J?1:Yn(h))<0?0:h):[]},Se.takeRight=function(u,h,m){var N=null==u?0:u.length;return N?Ss(u,(h=N-(h=m||h===J?1:Yn(h)))<0?0:h,N):[]},Se.takeRightWhile=function(u,h){return u&&u.length?pu(u,On(h,3),!1,!0):[]},Se.takeWhile=function(u,h){return u&&u.length?pu(u,On(h,3)):[]},Se.tap=function(u,h){return h(u),u},Se.throttle=function(u,h,m){var N=!0,ae=!0;if("function"!=typeof u)throw new ma(Ae);return wr(m)&&(N="leading"in m?!!m.leading:N,ae="trailing"in m?!!m.trailing:ae),Mb(u,h,{leading:N,maxWait:h,trailing:ae})},Se.thru=Id,Se.toArray=zb,Se.toPairs=N1,Se.toPairsIn=Jb,Se.toPath=function(u){return Dn(u)?ki(u,Jn):ta(u)?[u]:Qs(tb(Ii(u)))},Se.toPlainObject=Hb,Se.transform=function(u,h,m){var N=Dn(u),ae=N||ll(u)||$h(u);if(h=On(h,4),null==m){var xe=u&&u.constructor;m=ae?N?new xe:[]:wr(u)&&ea(xe)?cu(_a(u)):{}}return(ae?ks:tl)(u,function(ze,Ke,lt){return h(m,ze,Ke,lt)}),m},Se.unary=function(u){return Mp(u,1)},Se.union=db,Se.unionBy=GA,Se.unionWith=$A,Se.uniq=function(u){return u&&u.length?wc(u):[]},Se.uniqBy=function(u,h){return u&&u.length?wc(u,On(h,2)):[]},Se.uniqWith=function(u,h){return h="function"==typeof h?h:J,u&&u.length?wc(u,J,h):[]},Se.unset=function(u,h){return null==u||fu(u,h)},Se.unzip=hb,Se.unzipWith=qA,Se.update=function(u,h,m){return null==u?u:up(u,h,t_(m))},Se.updateWith=function(u,h,m,N){return N="function"==typeof N?N:J,null==u?u:up(u,h,t_(m),N)},Se.values=kd,Se.valuesIn=function(u){return null==u?[]:Dm(u,Js(u))},Se.without=fb,Se.words=Q_,Se.wrap=function(u,h){return Ip(t_(h),u)},Se.xor=iF,Se.xorBy=Ro,Se.xorWith=w_,Se.zip=E_,Se.zipObject=function(u,h){return dp(u||[],h||[],Ja)},Se.zipObjectDeep=function(u,h){return dp(u||[],h||[],cp)},Se.zipWith=zh,Se.entries=N1,Se.entriesIn=Jb,Se.extend=x1,Se.extendWith=Nd,ty(Se,Se),Se.add=Hn,Se.attempt=Z_,Se.camelCase=B1,Se.capitalize=H_,Se.ceil=sy,Se.clamp=function(u,h,m){return m===J&&(m=h,h=J),m!==J&&(m=(m=fo(m))==m?m:0),h!==J&&(h=(h=fo(h))==h?h:0),uu(fo(u),h,m)},Se.clone=function(u){return js(u,4)},Se.cloneDeep=function(u){return js(u,5)},Se.cloneDeepWith=function(u,h){return js(u,5,h="function"==typeof h?h:J)},Se.cloneWith=function(u,h){return js(u,4,h="function"==typeof h?h:J)},Se.conformsTo=function(u,h){return null==h||sp(u,h,Cs(h))},Se.deburr=G_,Se.defaultTo=function(u,h){return null==u||u!=u?h:u},Se.divide=yF,Se.endsWith=function(u,h,m){u=Ii(u),h=Mo(h);var N=u.length,ae=m=m===J?N:uu(Yn(m),0,N);return(m-=h.length)>=0&&u.slice(m,ae)==h},Se.eq=Cn,Se.escape=function(u){return(u=Ii(u))&&Qt.test(u)?u.replace(ua,IP):u},Se.escapeRegExp=function(u){return(u=Ii(u))&&ct.test(u)?u.replace(ke,"\\$&"):u},Se.every=function(u,h,m){var N=Dn(u)?Zn:Iv;return m&&zs(u,h,m)&&(h=J),N(u,On(h,3))},Se.find=JA,Se.findIndex=g_,Se.findKey=function(u,h){return mh(u,On(h,3),tl)},Se.findLast=e1,Se.findLastIndex=m_,Se.findLastKey=function(u,h){return mh(u,On(h,3),op)},Se.floor=Ul,Se.forEach=D_,Se.forEachRight=Ap,Se.forIn=function(u,h){return null==u?u:md(u,On(h,3),Js)},Se.forInRight=function(u,h){return null==u?u:_d(u,On(h,3),Js)},Se.forOwn=function(u,h){return u&&tl(u,On(h,3))},Se.forOwnRight=function(u,h){return u&&op(u,On(h,3))},Se.get=Kh,Se.gt=on,Se.gte=Fb,Se.has=function(u,h){return null!=u&&Xv(u,h,yd)},Se.hasIn=Pp,Se.head=ib,Se.identity=eo,Se.includes=function(u,h,m,N){u=ho(u)?u:kd(u),m=m&&!N?Yn(m):0;var ae=u.length;return m<0&&(m=Br(ae+m,0)),k_(u)?m<=ae&&u.indexOf(h,m)>-1:!!ae&&Ya(u,h,m)>-1},Se.indexOf=function(u,h,m){var N=null==u?0:u.length;if(!N)return-1;var ae=null==m?0:Yn(m);return ae<0&&(ae=Br(N+ae,0)),Ya(u,h,ae)},Se.inRange=function(u,h,m){return h=cl(h),m===J?(m=h,h=0):m=cl(m),function(u,h,m){return u>=us(h,m)&&u<Br(h,m)}(u=fo(u),h,m)},Se.invoke=qb,Se.isArguments=al,Se.isArray=Dn,Se.isArrayBuffer=Lb,Se.isArrayLike=ho,Se.isArrayLikeObject=br,Se.isBoolean=function(u){return!0===u||!1===u||Er(u)&&Es(u)==je},Se.isBuffer=ll,Se.isDate=kb,Se.isElement=function(u){return Er(u)&&1===u.nodeType&&!Np(u)},Se.isEmpty=function(u){if(null==u)return!0;if(ho(u)&&(Dn(u)||"string"==typeof u||"function"==typeof u.splice||ll(u)||$h(u)||al(u)))return!u.length;var h=Us(u);if(h==Be||h==pt)return!u.size;if(wp(u))return!Nv(u).length;for(var m in u)if(ji.call(u,m))return!1;return!0},Se.isEqual=function(u,h){return ap(u,h)},Se.isEqualWith=function(u,h,m){var N=(m="function"==typeof m?m:J)?m(u,h):J;return N===J?ap(u,h,J,m):!!N},Se.isError=Aa,Se.isFinite=function(u){return"number"==typeof u&&Lm(u)},Se.isFunction=ea,Se.isInteger=Op,Se.isLength=F_,Se.isMap=y1,Se.isMatch=function(u,h){return u===h||Ym(u,h,Yo(h))},Se.isMatchWith=function(u,h,m){return m="function"==typeof m?m:J,Ym(u,h,Yo(h),m)},Se.isNaN=function(u){return w1(u)&&u!=+u},Se.isNative=function(u){if(Jv(u))throw new xn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Xm(u)},Se.isNil=function(u){return null==u},Se.isNull=function(u){return null===u},Se.isNumber=w1,Se.isObject=wr,Se.isObjectLike=Er,Se.isPlainObject=Np,Se.isRegExp=Ub,Se.isSafeInteger=function(u){return Op(u)&&u>=-Te&&u<=Te},Se.isSet=E1,Se.isString=k_,Se.isSymbol=ta,Se.isTypedArray=$h,Se.isUndefined=function(u){return u===J},Se.isWeakMap=function(u){return Er(u)&&Us(u)==k},Se.isWeakSet=function(u){return Er(u)&&"[object WeakSet]"==Es(u)},Se.join=function(u,h){return null==u?"":Sh.call(u,h)},Se.kebabCase=V1,Se.last=Qo,Se.lastIndexOf=function(u,h,m){var N=null==u?0:u.length;if(!N)return-1;var ae=N;return m!==J&&(ae=(ae=Yn(m))<0?Br(N+ae,0):us(ae,N-1)),h==h?function(st,Dt,_t){for(var sn=_t+1;sn--;)if(st[sn]===Dt)return sn;return sn}(u,h,ae):ad(u,gc,ae,!0)},Se.lowerCase=U1,Se.lowerFirst=pF,Se.lt=Tc,Se.lte=B_,Se.max=function(u){return u&&u.length?Oh(u,eo,Ea):J},Se.maxBy=function(u,h){return u&&u.length?Oh(u,On(h,2),Ea):J},Se.mean=function(u){return vs(u,eo)},Se.meanBy=function(u,h){return vs(u,On(h,2))},Se.min=function(u){return u&&u.length?Oh(u,eo,Pv):J},Se.minBy=function(u,h){return u&&u.length?Oh(u,On(h,2),Pv):J},Se.stubArray=Mc,Se.stubFalse=ry,Se.stubObject=function(){return{}},Se.stubString=function(){return""},Se.stubTrue=function(){return!0},Se.multiply=fw,Se.nth=function(u,h){return u&&u.length?hu(u,Yn(h)):J},Se.noConflict=function(){return Mi._===this&&(Mi._=Pm),this},Se.noop=ny,Se.now=wu,Se.pad=function(u,h,m){u=Ii(u);var N=(h=Yn(h))?vh(u):0;if(!h||N>=h)return u;var ae=(h-N)/2;return gp(fi(ae),m)+u+gp(Ft(ae),m)},Se.padEnd=function(u,h,m){u=Ii(u);var N=(h=Yn(h))?vh(u):0;return h&&N<h?u+gp(h-N,m):u},Se.padStart=function(u,h,m){u=Ii(u);var N=(h=Yn(h))?vh(u):0;return h&&N<h?gp(h-N,m)+u:u},Se.parseInt=function(u,h,m){return m||null==h?h=0:h&&(h=+h),zC(Ii(u).replace(Qe,""),h||0)},Se.random=function(u,h,m){if(m&&"boolean"!=typeof m&&zs(u,h,m)&&(h=m=J),m===J&&("boolean"==typeof h?(m=h,h=J):"boolean"==typeof u&&(m=u,u=J)),u===J&&h===J?(u=0,h=1):(u=cl(u),h===J?(h=u,u=0):h=cl(h)),u>h){var N=u;u=h,h=N}if(m||u%1||h%1){var ae=xh();return us(u+ae*(h-u+IC("1e-"+((ae+"").length-1))),h)}return Pl(u,h)},Se.reduce=function(u,h,m){var N=Dn(u)?su:Go,ae=arguments.length<3;return N(u,On(h,4),m,ae,vc)},Se.reduceRight=function(u,h,m){var N=Dn(u)?od:Go,ae=arguments.length<3;return N(u,On(h,4),m,ae,qm)},Se.repeat=function(u,h,m){return h=(m?zs(u,h,m):h===J)?1:Yn(h),lp(Ii(u),h)},Se.replace=function(){var u=arguments,h=Ii(u[0]);return u.length<3?h:h.replace(u[1],u[2])},Se.result=function(u,h,m){var N=-1,ae=(h=Sc(h,u)).length;for(ae||(ae=1,u=J);++N<ae;){var xe=null==u?J:u[Jn(h[N])];xe===J&&(N=ae,xe=m),u=ea(xe)?xe.call(u):xe}return u},Se.round=pw,Se.runInContext=st,Se.sample=function(u){return(Dn(u)?Hm:lA)(u)},Se.size=function(u){if(null==u)return 0;if(ho(u))return k_(u)?vh(u):u.length;var h=Us(u);return h==Be||h==pt?u.size:Nv(u).length},Se.snakeCase=W1,Se.some=function(u,h,m){var N=Dn(u)?Co:KP;return m&&zs(u,h,m)&&(h=J),N(u,On(h,3))},Se.sortedIndex=function(u,h){return Lh(u,h)},Se.sortedIndexBy=function(u,h,m){return e_(u,h,On(m,2))},Se.sortedIndexOf=function(u,h){var m=null==u?0:u.length;if(m){var N=Lh(u,h);if(N<m&&Cn(u[N],h))return N}return-1},Se.sortedLastIndex=function(u,h){return Lh(u,h,!0)},Se.sortedLastIndexBy=function(u,h,m){return e_(u,h,On(m,2),!0)},Se.sortedLastIndexOf=function(u,h){if(null!=u&&u.length){var N=Lh(u,h,!0)-1;if(Cn(u[N],h))return N}return-1},Se.startCase=q_,Se.startsWith=function(u,h,m){return u=Ii(u),m=null==m?0:uu(Yn(m),0,u.length),h=Mo(h),u.slice(m,m+h.length)==h},Se.subtract=gw,Se.sum=function(u){return u&&u.length?ld(u,eo):0},Se.sumBy=function(u,h){return u&&u.length?ld(u,On(h,2)):0},Se.template=function(u,h,m){var N=Se.templateSettings;m&&zs(u,h,m)&&(h=J),u=Ii(u),h=Nd({},h,N,$v);var Ke,lt,ae=Nd({},h.imports,N.imports,$v),xe=Cs(ae),ze=Dm(ae,xe),Ot=0,Nt=h.interpolate||$r,Bt="__p += '",Jt=Om((h.escape||$r).source+"|"+Nt.source+"|"+(Nt===ot?fn:$r).source+"|"+(h.evaluate||$r).source+"|$","g"),_n="//# sourceURL="+(ji.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++MC+"]")+"\n";u.replace(Jt,function(kn,ci,vi,po,Hs,na){return vi||(vi=po),Bt+=u.slice(Ot,na).replace(ne,RP),ci&&(Ke=!0,Bt+="' +\n__e("+ci+") +\n'"),Hs&&(lt=!0,Bt+="';\n"+Hs+";\n__p += '"),vi&&(Bt+="' +\n((__t = ("+vi+")) == null ? '' : __t) +\n'"),Ot=na+kn.length,kn}),Bt+="';\n";var Fn=ji.call(h,"variable")&&h.variable;if(Fn){if(ii.test(Fn))throw new xn("Invalid `variable` option passed into `_.template`")}else Bt="with (obj) {\n"+Bt+"\n}\n";Bt=(lt?Bt.replace(Ps,""):Bt).replace(Gr,"$1").replace(qa,"$1;"),Bt="function("+(Fn||"obj")+") {\n"+(Fn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(Ke?", __e = _.escape":"")+(lt?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+Bt+"return __p\n}";var li=Z_(function(){return Ci(xe,_n+"return "+Bt).apply(J,ze)});if(li.source=Bt,Aa(li))throw li;return li},Se.times=function(u,h){if((u=Yn(u))<1||u>Te)return[];var m=ye,N=us(u,ye);h=On(h),u-=ye;for(var ae=cd(N,h);++m<u;)h(m);return ae},Se.toFinite=cl,Se.toInteger=Yn,Se.toLength=j_,Se.toLower=function(u){return Ii(u).toLowerCase()},Se.toNumber=fo,Se.toSafeInteger=function(u){return u?uu(Yn(u),-Te,Te):0===u?u:0},Se.toString=Ii,Se.toUpper=function(u){return Ii(u).toUpperCase()},Se.trim=function(u,h,m){if((u=Ii(u))&&(m||h===J))return bv(u);if(!u||!(h=Mo(h)))return u;var N=Xa(u),ae=Xa(h);return nl(N,NC(N,ae),PC(N,ae)+1).join("")},Se.trimEnd=function(u,h,m){if((u=Ii(u))&&(m||h===J))return u.slice(0,mc(u)+1);if(!u||!(h=Mo(h)))return u;var N=Xa(u);return nl(N,0,PC(N,Xa(h))+1).join("")},Se.trimStart=function(u,h,m){if((u=Ii(u))&&(m||h===J))return u.replace(Qe,"");if(!u||!(h=Mo(h)))return u;var N=Xa(u);return nl(N,NC(N,Xa(h))).join("")},Se.truncate=function(u,h){var m=30,N="...";if(wr(h)){var ae="separator"in h?h.separator:ae;m="length"in h?Yn(h.length):m,N="omission"in h?Mo(h.omission):N}var xe=(u=Ii(u)).length;if(yh(u)){var ze=Xa(u);xe=ze.length}if(m>=xe)return u;var Ke=m-vh(N);if(Ke<1)return N;var lt=ze?nl(ze,0,Ke).join(""):u.slice(0,Ke);if(ae===J)return lt+N;if(ze&&(Ke+=lt.length-Ke),Ub(ae)){if(u.slice(Ke).search(ae)){var Ot,Nt=lt;for(ae.global||(ae=Om(ae.source,Ii(zn.exec(ae))+"g")),ae.lastIndex=0;Ot=ae.exec(Nt);)var Bt=Ot.index;lt=lt.slice(0,Bt===J?Ke:Bt)}}else if(u.indexOf(Mo(ae),Ke)!=Ke){var Jt=lt.lastIndexOf(ae);Jt>-1&&(lt=lt.slice(0,Jt))}return lt+N},Se.unescape=function(u){return(u=Ii(u))&&ms.test(u)?u.replace(Al,Rm):u},Se.uniqueId=function(u){var h=++kP;return Ii(u)+h},Se.upperCase=sw,Se.upperFirst=kp,Se.each=D_,Se.eachRight=Ap,Se.first=ib,ty(Se,function(){var u={};return tl(Se,function(h,m){ji.call(Se.prototype,m)||(u[m]=h)}),u}(),{chain:!1}),Se.VERSION="4.17.21",ks(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){Se[u].placeholder=Se}),ks(["drop","take"],function(u,h){oi.prototype[u]=function(m){m=m===J?1:Br(Yn(m),0);var N=this.__filtered__&&!h?new oi(this):this.clone();return N.__filtered__?N.__takeCount__=us(m,N.__takeCount__):N.__views__.push({size:us(m,ye),type:u+(N.__dir__<0?"Right":"")}),N},oi.prototype[u+"Right"]=function(m){return this.reverse()[u](m).reverse()}}),ks(["filter","map","takeWhile"],function(u,h){var m=h+1,N=1==m||3==m;oi.prototype[u]=function(ae){var xe=this.clone();return xe.__iteratees__.push({iteratee:On(ae,3),type:m}),xe.__filtered__=xe.__filtered__||N,xe}}),ks(["head","last"],function(u,h){var m="take"+(h?"Right":"");oi.prototype[u]=function(){return this[m](1).value()[0]}}),ks(["initial","tail"],function(u,h){var m="drop"+(h?"":"Right");oi.prototype[u]=function(){return this.__filtered__?new oi(this):this[m](1)}}),oi.prototype.compact=function(){return this.filter(eo)},oi.prototype.find=function(u){return this.filter(u).head()},oi.prototype.findLast=function(u){return this.reverse().find(u)},oi.prototype.invokeMap=ai(function(u,h){return"function"==typeof u?new oi(this):this.map(function(m){return Sa(m,u,h)})}),oi.prototype.reject=function(u){return this.filter(N_(On(u)))},oi.prototype.slice=function(u,h){u=Yn(u);var m=this;return m.__filtered__&&(u>0||h<0)?new oi(m):(u<0?m=m.takeRight(-u):u&&(m=m.drop(u)),h!==J&&(m=(h=Yn(h))<0?m.dropRight(-h):m.take(h-u)),m)},oi.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},oi.prototype.toArray=function(){return this.take(ye)},tl(oi.prototype,function(u,h){var m=/^(?:filter|find|map|reject)|While$/.test(h),N=/^(?:head|last)$/.test(h),ae=Se[N?"take"+("last"==h?"Right":""):h],xe=N||/^find/.test(h);!ae||(Se.prototype[h]=function(){var ze=this.__wrapped__,Ke=N?[1]:arguments,lt=ze instanceof oi,Ot=Ke[0],Nt=lt||Dn(ze),Bt=function(ci){var vi=ae.apply(Se,kr([ci],Ke));return N&&Jt?vi[0]:vi};Nt&&m&&"function"==typeof Ot&&1!=Ot.length&&(lt=Nt=!1);var Jt=this.__chain__,_n=!!this.__actions__.length,Fn=xe&&!Jt,li=lt&&!_n;if(!xe&&Nt){ze=li?ze:new oi(this);var kn=u.apply(ze,Ke);return kn.__actions__.push({func:Id,args:[Bt],thisArg:J}),new To(kn,Jt)}return Fn&&li?u.apply(this,Ke):(kn=this.thru(Bt),Fn?N?kn.value()[0]:kn.value():kn)})}),ks(["pop","push","shift","sort","splice","unshift"],function(u){var h=or[u],m=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",N=/^(?:pop|shift)$/.test(u);Se.prototype[u]=function(){var ae=arguments;if(N&&!this.__chain__){var xe=this.value();return h.apply(Dn(xe)?xe:[],ae)}return this[m](function(ze){return h.apply(Dn(ze)?ze:[],ae)})}}),tl(oi.prototype,function(u,h){var m=Se[h];if(m){var N=m.name+"";ji.call(hd,N)||(hd[N]=[]),hd[N].push({name:h,func:m})}}),hd[Cc(J,2).name]=[{name:"wrapper",func:J}],oi.prototype.clone=function(){var u=new oi(this.__wrapped__);return u.__actions__=Qs(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Qs(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Qs(this.__views__),u},oi.prototype.reverse=function(){if(this.__filtered__){var u=new oi(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},oi.prototype.value=function(){var u=this.__wrapped__.value(),h=this.__dir__,m=Dn(u),N=h<0,ae=m?u.length:0,xe=function(u,h,m){for(var N=-1,ae=m.length;++N<ae;){var xe=m[N],ze=xe.size;switch(xe.type){case"drop":u+=ze;break;case"dropRight":h-=ze;break;case"take":h=us(h,u+ze);break;case"takeRight":u=Br(u,h-ze)}}return{start:u,end:h}}(0,ae,this.__views__),ze=xe.start,Ke=xe.end,lt=Ke-ze,Ot=N?Ke:ze-1,Nt=this.__iteratees__,Bt=Nt.length,Jt=0,_n=us(lt,this.__takeCount__);if(!m||!N&&ae==lt&&_n==lt)return cA(u,this.__actions__);var Fn=[];e:for(;lt--&&Jt<_n;){for(var li=-1,kn=u[Ot+=h];++li<Bt;){var ci=Nt[li],po=ci.type,Hs=(0,ci.iteratee)(kn);if(2==po)kn=Hs;else if(!Hs){if(1==po)continue e;break e}}Fn[Jt++]=kn}return Fn},Se.prototype.at=x_,Se.prototype.chain=function(){return S_(this)},Se.prototype.commit=function(){return new To(this.value(),this.__chain__)},Se.prototype.next=function(){this.__values__===J&&(this.__values__=zb(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?J:this.__values__[this.__index__++]}},Se.prototype.plant=function(u){for(var h,m=this;m instanceof Dh;){var N=Sp(m);N.__index__=0,N.__values__=J,h?ae.__wrapped__=N:h=N;var ae=N;m=m.__wrapped__}return ae.__wrapped__=u,h},Se.prototype.reverse=function(){var u=this.__wrapped__;if(u instanceof oi){var h=u;return this.__actions__.length&&(h=new oi(this)),(h=h.reverse()).__actions__.push({func:Id,args:[b_],thisArg:J}),new To(h,this.__chain__)}return this.thru(b_)},Se.prototype.toJSON=Se.prototype.valueOf=Se.prototype.value=function(){return cA(this.__wrapped__,this.__actions__)},Se.prototype.first=Se.prototype.head,Eh&&(Se.prototype[Eh]=function(){return this}),Se}();Mi._=bh,(gt=function(){return bh}.call(it,tt,it,kt))!==J&&(kt.exports=gt)}.call(this)},478:function(kt){kt.exports=function(){"use strict";function it(rt,ot){for(var ut=0;ut<ot.length;ut++){var pe=ot[ut];pe.enumerable=pe.enumerable||!1,pe.configurable=!0,"value"in pe&&(pe.writable=!0),Object.defineProperty(rt,pe.key,pe)}}function J(rt,ot){(null==ot||ot>rt.length)&&(ot=rt.length);for(var ut=0,pe=new Array(ot);ut<ot;ut++)pe[ut]=rt[ut];return pe}function At(rt,ot){var ut="undefined"!=typeof Symbol&&rt[Symbol.iterator]||rt["@@iterator"];if(ut)return(ut=ut.call(rt)).next.bind(ut);if(Array.isArray(rt)||(ut=function(rt,ot){if(rt){if("string"==typeof rt)return J(rt,ot);var ut=Object.prototype.toString.call(rt).slice(8,-1);if("Object"===ut&&rt.constructor&&(ut=rt.constructor.name),"Map"===ut||"Set"===ut)return Array.from(rt);if("Arguments"===ut||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ut))return J(rt,ot)}}(rt))||ot&&rt&&"number"==typeof rt.length){ut&&(rt=ut);var pe=0;return function(){return pe>=rt.length?{done:!0}:{done:!1,value:rt[pe++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var dt={exports:{}};function K(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}dt.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:K,changeDefaults:function(rt){dt.exports.defaults=rt}};var he=/[&<>"']/,q=/[&<>"']/g,V=/[<>"']|&(?!#?\w+;)/,L=/[<>"']|&(?!#?\w+;)/g,re={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$=function(ot){return re[ot]};var S=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function O(rt){return rt.replace(S,function(ot,ut){return"colon"===(ut=ut.toLowerCase())?":":"#"===ut.charAt(0)?"x"===ut.charAt(1)?String.fromCharCode(parseInt(ut.substring(2),16)):String.fromCharCode(+ut.substring(1)):""})}var T=/(^|[^\[])\^/g;var y=/[^\w:]/g,w=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var j={},I=/^[^:]+:\/*[^/]*$/,H=/^([^:]+:)[\s\S]*$/,Y=/^([^:]+:\/*[^/]*)[\s\S]*$/;function M(rt,ot){j[" "+rt]||(j[" "+rt]=I.test(rt)?rt+"/":U(rt,"/",!0));var ut=-1===(rt=j[" "+rt]).indexOf(":");return"//"===ot.substring(0,2)?ut?ot:rt.replace(H,"$1")+ot:"/"===ot.charAt(0)?ut?ot:rt.replace(Y,"$1")+ot:rt+ot}function U(rt,ot,ut){var pe=rt.length;if(0===pe)return"";for(var ve=0;ve<pe;){var ke=rt.charAt(pe-ve-1);if(ke!==ot||ut){if(ke===ot||!ut)break;ve++}else ve++}return rt.substr(0,pe-ve)}var se_escape=function(rt,ot){if(ot){if(he.test(rt))return rt.replace(q,$)}else if(V.test(rt))return rt.replace(L,$);return rt},se_unescape=O,se_edit=function(rt,ot){rt=rt.source||rt,ot=ot||"";var ut={replace:function(ve,ke){return ke=(ke=ke.source||ke).replace(T,"$1"),rt=rt.replace(ve,ke),ut},getRegex:function(){return new RegExp(rt,ot)}};return ut},se_cleanUrl=function(rt,ot,ut){if(rt){var pe;try{pe=decodeURIComponent(O(ut)).replace(y,"").toLowerCase()}catch(ve){return null}if(0===pe.indexOf("javascript:")||0===pe.indexOf("vbscript:")||0===pe.indexOf("data:"))return null}ot&&!w.test(ut)&&(ut=M(ot,ut));try{ut=encodeURI(ut).replace(/%25/g,"%")}catch(ve){return null}return ut},se_noopTest={exec:function(){}},se_merge=function(rt){for(var ut,pe,ot=1;ot<arguments.length;ot++)for(pe in ut=arguments[ot])Object.prototype.hasOwnProperty.call(ut,pe)&&(rt[pe]=ut[pe]);return rt},se_checkSanitizeDeprecation=function(rt){rt&&rt.sanitize&&!rt.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},se_repeatString=function(rt,ot){if(ot<1)return"";for(var ut="";ot>1;)1&ot&&(ut+=rt),ot>>=1,rt+=rt;return ut+rt},Te=dt.exports.defaults,me=U,te=function(rt,ot){var pe=rt.replace(/\|/g,function(ke,ct,Qe){for(var vt=!1,xt=ct;--xt>=0&&"\\"===Qe[xt];)vt=!vt;return vt?"|":" |"}).split(/ \|/),ve=0;if(pe.length>ot)pe.splice(ot);else for(;pe.length<ot;)pe.push("");for(;ve<pe.length;ve++)pe[ve]=pe[ve].trim().replace(/\\\|/g,"|");return pe},ye=se_escape,Me=function(rt,ot){if(-1===rt.indexOf(ot[1]))return-1;for(var ut=rt.length,pe=0,ve=0;ve<ut;ve++)if("\\"===rt[ve])ve++;else if(rt[ve]===ot[0])pe++;else if(rt[ve]===ot[1]&&--pe<0)return ve;return-1};function Ve(rt,ot,ut){var pe=ot.href,ve=ot.title?ye(ot.title):null,ke=rt[1].replace(/\\([\[\]])/g,"$1");return"!"!==rt[0].charAt(0)?{type:"link",raw:ut,href:pe,title:ve,text:ke}:{type:"image",raw:ut,href:pe,title:ve,text:ye(ke)}}var Ze=function(){function rt(ut){this.options=ut||Te}var ot=rt.prototype;return ot.space=function(pe){var ve=this.rules.block.newline.exec(pe);if(ve)return ve[0].length>1?{type:"space",raw:ve[0]}:{raw:"\n"}},ot.code=function(pe){var ve=this.rules.block.code.exec(pe);if(ve){var ke=ve[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:ve[0],codeBlockStyle:"indented",text:this.options.pedantic?ke:me(ke,"\n")}}},ot.fences=function(pe){var ve=this.rules.block.fences.exec(pe);if(ve){var ke=ve[0],ct=function(rt,ot){var ut=rt.match(/^(\s+)(?:```)/);if(null===ut)return ot;var pe=ut[1];return ot.split("\n").map(function(ve){var ke=ve.match(/^\s+/);return null===ke?ve:ke[0].length>=pe.length?ve.slice(pe.length):ve}).join("\n")}(ke,ve[3]||"");return{type:"code",raw:ke,lang:ve[2]?ve[2].trim():ve[2],text:ct}}},ot.heading=function(pe){var ve=this.rules.block.heading.exec(pe);if(ve){var ke=ve[2].trim();if(/#$/.test(ke)){var ct=me(ke,"#");(this.options.pedantic||!ct||/ $/.test(ct))&&(ke=ct.trim())}return{type:"heading",raw:ve[0],depth:ve[1].length,text:ke}}},ot.nptable=function(pe){var ve=this.rules.block.nptable.exec(pe);if(ve){var ke={type:"table",header:te(ve[1].replace(/^ *| *\| *$/g,"")),align:ve[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ve[3]?ve[3].replace(/\n$/,"").split("\n"):[],raw:ve[0]};if(ke.header.length===ke.align.length){var Qe,ct=ke.align.length;for(Qe=0;Qe<ct;Qe++)ke.align[Qe]=/^ *-+: *$/.test(ke.align[Qe])?"right":/^ *:-+: *$/.test(ke.align[Qe])?"center":/^ *:-+ *$/.test(ke.align[Qe])?"left":null;for(ct=ke.cells.length,Qe=0;Qe<ct;Qe++)ke.cells[Qe]=te(ke.cells[Qe],ke.header.length);return ke}}},ot.hr=function(pe){var ve=this.rules.block.hr.exec(pe);if(ve)return{type:"hr",raw:ve[0]}},ot.blockquote=function(pe){var ve=this.rules.block.blockquote.exec(pe);if(ve){var ke=ve[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:ve[0],text:ke}}},ot.list=function(pe){var ve=this.rules.block.list.exec(pe);if(ve){var $t,jn,ii,Mn,fn,zn,bn,Zi,Ji,ke=ve[0],ct=ve[2],Qe=ct.length>1,vt={type:"list",raw:ke,ordered:Qe,start:Qe?+ct.slice(0,-1):"",loose:!1,items:[]},xt=ve[0].match(this.rules.block.item),Tt=!1,qn=xt.length;ii=this.rules.block.listItemStart.exec(xt[0]);for(var Pi=0;Pi<qn;Pi++){if(ke=$t=xt[Pi],this.options.pedantic||(Ji=$t.match(new RegExp("\\n\\s*\\n {0,"+(ii[0].length-1)+"}\\S")))&&(fn=$t.length-Ji.index+xt.slice(Pi+1).join("\n").length,vt.raw=vt.raw.substring(0,vt.raw.length-fn),ke=$t=$t.substring(0,Ji.index),qn=Pi+1),Pi!==qn-1){if(Mn=this.rules.block.listItemStart.exec(xt[Pi+1]),this.options.pedantic?Mn[1].length>ii[1].length:Mn[1].length>=ii[0].length||Mn[1].length>3){xt.splice(Pi,2,xt[Pi]+(!this.options.pedantic&&Mn[1].length<ii[0].length&&!xt[Pi].match(/\n$/)?"":"\n")+xt[Pi+1]),Pi--,qn--;continue}(!this.options.pedantic||this.options.smartLists?Mn[2][Mn[2].length-1]!==ct[ct.length-1]:Qe===(1===Mn[2].length))&&(fn=xt.slice(Pi+1).join("\n").length,vt.raw=vt.raw.substring(0,vt.raw.length-fn),Pi=qn-1),ii=Mn}jn=$t.length,~($t=$t.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(jn-=$t.length,$t=$t.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+jn+"}","gm"),"")),$t=me($t,"\n"),Pi!==qn-1&&(ke+="\n"),zn=Tt||/\n\n(?!\s*$)/.test(ke),Pi!==qn-1&&(Tt="\n\n"===ke.slice(-2),zn||(zn=Tt)),zn&&(vt.loose=!0),this.options.gfm&&(Zi=void 0,(bn=/^\[[ xX]\] /.test($t))&&(Zi=" "!==$t[1],$t=$t.replace(/^\[[ xX]\] +/,""))),vt.items.push({type:"list_item",raw:ke,task:bn,checked:Zi,loose:zn,text:$t})}return vt}},ot.html=function(pe){var ve=this.rules.block.html.exec(pe);if(ve)return{type:this.options.sanitize?"paragraph":"html",raw:ve[0],pre:!this.options.sanitizer&&("pre"===ve[1]||"script"===ve[1]||"style"===ve[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ve[0]):ye(ve[0]):ve[0]}},ot.def=function(pe){var ve=this.rules.block.def.exec(pe);if(ve)return ve[3]&&(ve[3]=ve[3].substring(1,ve[3].length-1)),{type:"def",tag:ve[1].toLowerCase().replace(/\s+/g," "),raw:ve[0],href:ve[2],title:ve[3]}},ot.table=function(pe){var ve=this.rules.block.table.exec(pe);if(ve){var ke={type:"table",header:te(ve[1].replace(/^ *| *\| *$/g,"")),align:ve[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ve[3]?ve[3].replace(/\n$/,"").split("\n"):[]};if(ke.header.length===ke.align.length){ke.raw=ve[0];var Qe,ct=ke.align.length;for(Qe=0;Qe<ct;Qe++)ke.align[Qe]=/^ *-+: *$/.test(ke.align[Qe])?"right":/^ *:-+: *$/.test(ke.align[Qe])?"center":/^ *:-+ *$/.test(ke.align[Qe])?"left":null;for(ct=ke.cells.length,Qe=0;Qe<ct;Qe++)ke.cells[Qe]=te(ke.cells[Qe].replace(/^ *\| *| *\| *$/g,""),ke.header.length);return ke}}},ot.lheading=function(pe){var ve=this.rules.block.lheading.exec(pe);if(ve)return{type:"heading",raw:ve[0],depth:"="===ve[2].charAt(0)?1:2,text:ve[1]}},ot.paragraph=function(pe){var ve=this.rules.block.paragraph.exec(pe);if(ve)return{type:"paragraph",raw:ve[0],text:"\n"===ve[1].charAt(ve[1].length-1)?ve[1].slice(0,-1):ve[1]}},ot.text=function(pe){var ve=this.rules.block.text.exec(pe);if(ve)return{type:"text",raw:ve[0],text:ve[0]}},ot.escape=function(pe){var ve=this.rules.inline.escape.exec(pe);if(ve)return{type:"escape",raw:ve[0],text:ye(ve[1])}},ot.tag=function(pe,ve,ke){var ct=this.rules.inline.tag.exec(pe);if(ct)return!ve&&/^<a /i.test(ct[0])?ve=!0:ve&&/^<\/a>/i.test(ct[0])&&(ve=!1),!ke&&/^<(pre|code|kbd|script)(\s|>)/i.test(ct[0])?ke=!0:ke&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ct[0])&&(ke=!1),{type:this.options.sanitize?"text":"html",raw:ct[0],inLink:ve,inRawBlock:ke,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ct[0]):ye(ct[0]):ct[0]}},ot.link=function(pe){var ve=this.rules.inline.link.exec(pe);if(ve){var ke=ve[2].trim();if(!this.options.pedantic&&/^</.test(ke)){if(!/>$/.test(ke))return;var ct=me(ke.slice(0,-1),"\\");if((ke.length-ct.length)%2==0)return}else{var Qe=Me(ve[2],"()");if(Qe>-1){var xt=(0===ve[0].indexOf("!")?5:4)+ve[1].length+Qe;ve[2]=ve[2].substring(0,Qe),ve[0]=ve[0].substring(0,xt).trim(),ve[3]=""}}var Tt=ve[2],$t="";if(this.options.pedantic){var jn=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Tt);jn&&(Tt=jn[1],$t=jn[3])}else $t=ve[3]?ve[3].slice(1,-1):"";return Tt=Tt.trim(),/^</.test(Tt)&&(Tt=this.options.pedantic&&!/>$/.test(ke)?Tt.slice(1):Tt.slice(1,-1)),Ve(ve,{href:Tt&&Tt.replace(this.rules.inline._escapes,"$1"),title:$t&&$t.replace(this.rules.inline._escapes,"$1")},ve[0])}},ot.reflink=function(pe,ve){var ke;if((ke=this.rules.inline.reflink.exec(pe))||(ke=this.rules.inline.nolink.exec(pe))){var ct=(ke[2]||ke[1]).replace(/\s+/g," ");if(!(ct=ve[ct.toLowerCase()])||!ct.href){var Qe=ke[0].charAt(0);return{type:"text",raw:Qe,text:Qe}}return Ve(ke,ct,ke[0])}},ot.emStrong=function(pe,ve,ke){void 0===ke&&(ke="");var ct=this.rules.inline.emStrong.lDelim.exec(pe);if(ct&&(!ct[3]||!ke.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Qe=ct[1]||ct[2]||"";if(!Qe||Qe&&(""===ke||this.rules.inline.punctuation.exec(ke))){var xt,Tt,vt=ct[0].length-1,$t=vt,jn=0,ii="*"===ct[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ii.lastIndex=0,ve=ve.slice(-1*pe.length+vt);null!=(ct=ii.exec(ve));)if(xt=ct[1]||ct[2]||ct[3]||ct[4]||ct[5]||ct[6]){if(Tt=xt.length,ct[3]||ct[4]){$t+=Tt;continue}if((ct[5]||ct[6])&&vt%3&&!((vt+Tt)%3)){jn+=Tt;continue}if(!(($t-=Tt)>0))return Tt=Math.min(Tt,Tt+$t+jn),Math.min(vt,Tt)%2?{type:"em",raw:pe.slice(0,vt+ct.index+Tt+1),text:pe.slice(1,vt+ct.index+Tt)}:{type:"strong",raw:pe.slice(0,vt+ct.index+Tt+1),text:pe.slice(2,vt+ct.index+Tt-1)}}}}},ot.codespan=function(pe){var ve=this.rules.inline.code.exec(pe);if(ve){var ke=ve[2].replace(/\n/g," "),ct=/[^ ]/.test(ke),Qe=/^ /.test(ke)&&/ $/.test(ke);return ct&&Qe&&(ke=ke.substring(1,ke.length-1)),ke=ye(ke,!0),{type:"codespan",raw:ve[0],text:ke}}},ot.br=function(pe){var ve=this.rules.inline.br.exec(pe);if(ve)return{type:"br",raw:ve[0]}},ot.del=function(pe){var ve=this.rules.inline.del.exec(pe);if(ve)return{type:"del",raw:ve[0],text:ve[2]}},ot.autolink=function(pe,ve){var ct,Qe,ke=this.rules.inline.autolink.exec(pe);if(ke)return Qe="@"===ke[2]?"mailto:"+(ct=ye(this.options.mangle?ve(ke[1]):ke[1])):ct=ye(ke[1]),{type:"link",raw:ke[0],text:ct,href:Qe,tokens:[{type:"text",raw:ct,text:ct}]}},ot.url=function(pe,ve){var ke;if(ke=this.rules.inline.url.exec(pe)){var ct,Qe;if("@"===ke[2])Qe="mailto:"+(ct=ye(this.options.mangle?ve(ke[0]):ke[0]));else{var vt;do{vt=ke[0],ke[0]=this.rules.inline._backpedal.exec(ke[0])[0]}while(vt!==ke[0]);ct=ye(ke[0]),Qe="www."===ke[1]?"http://"+ct:ct}return{type:"link",raw:ke[0],text:ct,href:Qe,tokens:[{type:"text",raw:ct,text:ct}]}}},ot.inlineText=function(pe,ve,ke){var Qe,ct=this.rules.inline.text.exec(pe);if(ct)return Qe=ve?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ct[0]):ye(ct[0]):ct[0]:ye(this.options.smartypants?ke(ct[0]):ct[0]),{type:"text",raw:ct[0],text:Qe}},rt}(),Je=se_noopTest,Ye=se_edit,je=se_merge,Le={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:Je,table:Je,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Le.def=Ye(Le.def).replace("label",Le._label).replace("title",Le._title).getRegex(),Le.bullet=/(?:[*+-]|\d{1,9}[.)])/,Le.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,Le.item=Ye(Le.item,"gm").replace(/bull/g,Le.bullet).getRegex(),Le.listItemStart=Ye(/^( *)(bull) */).replace("bull",Le.bullet).getRegex(),Le.list=Ye(Le.list).replace(/bull/g,Le.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Le.def.source+")").getRegex(),Le._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Le._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Le.html=Ye(Le.html,"i").replace("comment",Le._comment).replace("tag",Le._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Le.paragraph=Ye(Le._paragraph).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.blockquote=Ye(Le.blockquote).replace("paragraph",Le.paragraph).getRegex(),Le.normal=je({},Le),Le.gfm=je({},Le.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Le.gfm.nptable=Ye(Le.gfm.nptable).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.gfm.table=Ye(Le.gfm.table).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.pedantic=je({},Le.normal,{html:Ye("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Le._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Je,paragraph:Ye(Le.normal._paragraph).replace("hr",Le.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Le.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Ee={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Je,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Je,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Ee.punctuation=Ye(Ee.punctuation).replace(/punctuation/g,Ee._punctuation).getRegex(),Ee.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Ee.escapedEmSt=/\\\*|\\_/g,Ee._comment=Ye(Le._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ee.emStrong.lDelim=Ye(Ee.emStrong.lDelim).replace(/punct/g,Ee._punctuation).getRegex(),Ee.emStrong.rDelimAst=Ye(Ee.emStrong.rDelimAst,"g").replace(/punct/g,Ee._punctuation).getRegex(),Ee.emStrong.rDelimUnd=Ye(Ee.emStrong.rDelimUnd,"g").replace(/punct/g,Ee._punctuation).getRegex(),Ee._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Ee._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Ee._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Ee.autolink=Ye(Ee.autolink).replace("scheme",Ee._scheme).replace("email",Ee._email).getRegex(),Ee._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Ee.tag=Ye(Ee.tag).replace("comment",Ee._comment).replace("attribute",Ee._attribute).getRegex(),Ee._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ee._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Ee._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Ee.link=Ye(Ee.link).replace("label",Ee._label).replace("href",Ee._href).replace("title",Ee._title).getRegex(),Ee.reflink=Ye(Ee.reflink).replace("label",Ee._label).getRegex(),Ee.reflinkSearch=Ye(Ee.reflinkSearch,"g").replace("reflink",Ee.reflink).replace("nolink",Ee.nolink).getRegex(),Ee.normal=je({},Ee),Ee.pedantic=je({},Ee.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ye(/^!?\[(label)\]\((.*?)\)/).replace("label",Ee._label).getRegex(),reflink:Ye(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ee._label).getRegex()}),Ee.gfm=je({},Ee.normal,{escape:Ye(Ee.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Ee.gfm.url=Ye(Ee.gfm.url,"i").replace("email",Ee.gfm._extended_email).getRegex(),Ee.breaks=je({},Ee.gfm,{br:Ye(Ee.br).replace("{2,}","*").getRegex(),text:Ye(Ee.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Re={block:Le,inline:Ee},Ue=Ze,qe=dt.exports.defaults,Be=Re.block,z=Re.inline,X=se_repeatString;function be(rt){return rt.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function ce(rt){var ut,pe,ot="",ve=rt.length;for(ut=0;ut<ve;ut++)pe=rt.charCodeAt(ut),Math.random()>.5&&(pe="x"+pe.toString(16)),ot+="&#"+pe+";";return ot}var Pe=function(){function rt(ut){this.tokens=[],this.tokens.links=Object.create(null),this.options=ut||qe,this.options.tokenizer=this.options.tokenizer||new Ue,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var pe={block:Be.normal,inline:z.normal};this.options.pedantic?(pe.block=Be.pedantic,pe.inline=z.pedantic):this.options.gfm&&(pe.block=Be.gfm,pe.inline=this.options.breaks?z.breaks:z.gfm),this.tokenizer.rules=pe}rt.lex=function(pe,ve){return new rt(ve).lex(pe)},rt.lexInline=function(pe,ve){return new rt(ve).inlineTokens(pe)};var ot=rt.prototype;return ot.lex=function(pe){return pe=pe.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(pe,this.tokens,!0),this.inline(this.tokens),this.tokens},ot.blockTokens=function(pe,ve,ke){var Qe,vt,xt,Tt,$t,jn,ct=this;for(void 0===ve&&(ve=[]),void 0===ke&&(ke=!0),this.options.pedantic&&(pe=pe.replace(/^ +$/gm,""));pe;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(Mn){return!!(Qe=Mn.call(ct,pe,ve))&&(pe=pe.substring(Qe.raw.length),ve.push(Qe),!0)}))){if(Qe=this.tokenizer.space(pe)){pe=pe.substring(Qe.raw.length),Qe.type&&ve.push(Qe);continue}if(Qe=this.tokenizer.code(pe)){pe=pe.substring(Qe.raw.length),(Tt=ve[ve.length-1])&&"paragraph"===Tt.type?(Tt.raw+="\n"+Qe.raw,Tt.text+="\n"+Qe.text):ve.push(Qe);continue}if(Qe=this.tokenizer.fences(pe)){pe=pe.substring(Qe.raw.length),ve.push(Qe);continue}if(Qe=this.tokenizer.heading(pe)){pe=pe.substring(Qe.raw.length),ve.push(Qe);continue}if(Qe=this.tokenizer.nptable(pe)){pe=pe.substring(Qe.raw.length),ve.push(Qe);continue}if(Qe=this.tokenizer.hr(pe)){pe=pe.substring(Qe.raw.length),ve.push(Qe);continue}if(Qe=this.tokenizer.blockquote(pe)){pe=pe.substring(Qe.raw.length),Qe.tokens=this.blockTokens(Qe.text,[],ke),ve.push(Qe);continue}if(Qe=this.tokenizer.list(pe)){for(pe=pe.substring(Qe.raw.length),xt=Qe.items.length,vt=0;vt<xt;vt++)Qe.items[vt].tokens=this.blockTokens(Qe.items[vt].text,[],!1);ve.push(Qe);continue}if(Qe=this.tokenizer.html(pe)){pe=pe.substring(Qe.raw.length),ve.push(Qe);continue}if(ke&&(Qe=this.tokenizer.def(pe))){pe=pe.substring(Qe.raw.length),this.tokens.links[Qe.tag]||(this.tokens.links[Qe.tag]={href:Qe.href,title:Qe.title});continue}if(Qe=this.tokenizer.table(pe)){pe=pe.substring(Qe.raw.length),ve.push(Qe);continue}if(Qe=this.tokenizer.lheading(pe)){pe=pe.substring(Qe.raw.length),ve.push(Qe);continue}if($t=pe,this.options.extensions&&this.options.extensions.startBlock&&function(){var Mn=1/0,fn=pe.slice(1),zn=void 0;ct.options.extensions.startBlock.forEach(function(bn){"number"==typeof(zn=bn.call(this,fn))&&zn>=0&&(Mn=Math.min(Mn,zn))}),Mn<1/0&&Mn>=0&&($t=pe.substring(0,Mn+1))}(),ke&&(Qe=this.tokenizer.paragraph($t))){Tt=ve[ve.length-1],jn&&"paragraph"===Tt.type?(Tt.raw+="\n"+Qe.raw,Tt.text+="\n"+Qe.text):ve.push(Qe),jn=$t.length!==pe.length,pe=pe.substring(Qe.raw.length);continue}if(Qe=this.tokenizer.text(pe)){pe=pe.substring(Qe.raw.length),(Tt=ve[ve.length-1])&&"text"===Tt.type?(Tt.raw+="\n"+Qe.raw,Tt.text+="\n"+Qe.text):ve.push(Qe);continue}if(pe){var ii="Infinite loop on byte: "+pe.charCodeAt(0);if(this.options.silent){console.error(ii);break}throw new Error(ii)}}return ve},ot.inline=function(pe){var ve,ke,ct,Qe,vt,xt,Tt=pe.length;for(ve=0;ve<Tt;ve++)switch(xt=pe[ve],xt.type){case"paragraph":case"text":case"heading":xt.tokens=[],this.inlineTokens(xt.text,xt.tokens);break;case"table":for(xt.tokens={header:[],cells:[]},Qe=xt.header.length,ke=0;ke<Qe;ke++)xt.tokens.header[ke]=[],this.inlineTokens(xt.header[ke],xt.tokens.header[ke]);for(Qe=xt.cells.length,ke=0;ke<Qe;ke++)for(vt=xt.cells[ke],xt.tokens.cells[ke]=[],ct=0;ct<vt.length;ct++)xt.tokens.cells[ke][ct]=[],this.inlineTokens(vt[ct],xt.tokens.cells[ke][ct]);break;case"blockquote":this.inline(xt.tokens);break;case"list":for(Qe=xt.items.length,ke=0;ke<Qe;ke++)this.inline(xt.items[ke].tokens)}return pe},ot.inlineTokens=function(pe,ve,ke,ct){var Qe=this;void 0===ve&&(ve=[]),void 0===ke&&(ke=!1),void 0===ct&&(ct=!1);var vt,xt,Tt,jn,ii,Mn,$t=pe;if(this.tokens.links){var fn=Object.keys(this.tokens.links);if(fn.length>0)for(;null!=(jn=this.tokenizer.rules.inline.reflinkSearch.exec($t));)fn.includes(jn[0].slice(jn[0].lastIndexOf("[")+1,-1))&&($t=$t.slice(0,jn.index)+"["+X("a",jn[0].length-2)+"]"+$t.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(jn=this.tokenizer.rules.inline.blockSkip.exec($t));)$t=$t.slice(0,jn.index)+"["+X("a",jn[0].length-2)+"]"+$t.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(jn=this.tokenizer.rules.inline.escapedEmSt.exec($t));)$t=$t.slice(0,jn.index)+"++"+$t.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;pe;)if(ii||(Mn=""),ii=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(bn){return!!(vt=bn.call(Qe,pe,ve))&&(pe=pe.substring(vt.raw.length),ve.push(vt),!0)}))){if(vt=this.tokenizer.escape(pe)){pe=pe.substring(vt.raw.length),ve.push(vt);continue}if(vt=this.tokenizer.tag(pe,ke,ct)){pe=pe.substring(vt.raw.length),ke=vt.inLink,ct=vt.inRawBlock,(xt=ve[ve.length-1])&&"text"===vt.type&&"text"===xt.type?(xt.raw+=vt.raw,xt.text+=vt.text):ve.push(vt);continue}if(vt=this.tokenizer.link(pe)){pe=pe.substring(vt.raw.length),"link"===vt.type&&(vt.tokens=this.inlineTokens(vt.text,[],!0,ct)),ve.push(vt);continue}if(vt=this.tokenizer.reflink(pe,this.tokens.links)){pe=pe.substring(vt.raw.length),xt=ve[ve.length-1],"link"===vt.type?(vt.tokens=this.inlineTokens(vt.text,[],!0,ct),ve.push(vt)):xt&&"text"===vt.type&&"text"===xt.type?(xt.raw+=vt.raw,xt.text+=vt.text):ve.push(vt);continue}if(vt=this.tokenizer.emStrong(pe,$t,Mn)){pe=pe.substring(vt.raw.length),vt.tokens=this.inlineTokens(vt.text,[],ke,ct),ve.push(vt);continue}if(vt=this.tokenizer.codespan(pe)){pe=pe.substring(vt.raw.length),ve.push(vt);continue}if(vt=this.tokenizer.br(pe)){pe=pe.substring(vt.raw.length),ve.push(vt);continue}if(vt=this.tokenizer.del(pe)){pe=pe.substring(vt.raw.length),vt.tokens=this.inlineTokens(vt.text,[],ke,ct),ve.push(vt);continue}if(vt=this.tokenizer.autolink(pe,ce)){pe=pe.substring(vt.raw.length),ve.push(vt);continue}if(!ke&&(vt=this.tokenizer.url(pe,ce))){pe=pe.substring(vt.raw.length),ve.push(vt);continue}if(Tt=pe,this.options.extensions&&this.options.extensions.startInline&&function(){var bn=1/0,Zi=pe.slice(1),Ji=void 0;Qe.options.extensions.startInline.forEach(function(qn){"number"==typeof(Ji=qn.call(this,Zi))&&Ji>=0&&(bn=Math.min(bn,Ji))}),bn<1/0&&bn>=0&&(Tt=pe.substring(0,bn+1))}(),vt=this.tokenizer.inlineText(Tt,ct,be)){pe=pe.substring(vt.raw.length),"_"!==vt.raw.slice(-1)&&(Mn=vt.raw.slice(-1)),ii=!0,(xt=ve[ve.length-1])&&"text"===xt.type?(xt.raw+=vt.raw,xt.text+=vt.text):ve.push(vt);continue}if(pe){var zn="Infinite loop on byte: "+pe.charCodeAt(0);if(this.options.silent){console.error(zn);break}throw new Error(zn)}}return ve},function(rt,ot,ut){ot&&it(rt.prototype,ot),ut&&it(rt,ut)}(rt,null,[{key:"rules",get:function(){return{block:Be,inline:z}}}]),rt}(),wt=dt.exports.defaults,pt=se_cleanUrl,fe=se_escape,B=function(){function rt(ut){this.options=ut||wt}var ot=rt.prototype;return ot.code=function(pe,ve,ke){var ct=(ve||"").match(/\S*/)[0];if(this.options.highlight){var Qe=this.options.highlight(pe,ct);null!=Qe&&Qe!==pe&&(ke=!0,pe=Qe)}return pe=pe.replace(/\n$/,"")+"\n",ct?'<pre><code class="'+this.options.langPrefix+fe(ct,!0)+'">'+(ke?pe:fe(pe,!0))+"</code></pre>\n":"<pre><code>"+(ke?pe:fe(pe,!0))+"</code></pre>\n"},ot.blockquote=function(pe){return"<blockquote>\n"+pe+"</blockquote>\n"},ot.html=function(pe){return pe},ot.heading=function(pe,ve,ke,ct){return this.options.headerIds?"<h"+ve+' id="'+this.options.headerPrefix+ct.slug(ke)+'">'+pe+"</h"+ve+">\n":"<h"+ve+">"+pe+"</h"+ve+">\n"},ot.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},ot.list=function(pe,ve,ke){var ct=ve?"ol":"ul";return"<"+ct+(ve&&1!==ke?' start="'+ke+'"':"")+">\n"+pe+"</"+ct+">\n"},ot.listitem=function(pe){return"<li>"+pe+"</li>\n"},ot.checkbox=function(pe){return"<input "+(pe?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},ot.paragraph=function(pe){return"<p>"+pe+"</p>\n"},ot.table=function(pe,ve){return ve&&(ve="<tbody>"+ve+"</tbody>"),"<table>\n<thead>\n"+pe+"</thead>\n"+ve+"</table>\n"},ot.tablerow=function(pe){return"<tr>\n"+pe+"</tr>\n"},ot.tablecell=function(pe,ve){var ke=ve.header?"th":"td";return(ve.align?"<"+ke+' align="'+ve.align+'">':"<"+ke+">")+pe+"</"+ke+">\n"},ot.strong=function(pe){return"<strong>"+pe+"</strong>"},ot.em=function(pe){return"<em>"+pe+"</em>"},ot.codespan=function(pe){return"<code>"+pe+"</code>"},ot.br=function(){return this.options.xhtml?"<br/>":"<br>"},ot.del=function(pe){return"<del>"+pe+"</del>"},ot.link=function(pe,ve,ke){if(null===(pe=pt(this.options.sanitize,this.options.baseUrl,pe)))return ke;var ct='<a href="'+fe(pe)+'"';return ve&&(ct+=' title="'+ve+'"'),ct+">"+ke+"</a>"},ot.image=function(pe,ve,ke){if(null===(pe=pt(this.options.sanitize,this.options.baseUrl,pe)))return ke;var ct='<img src="'+pe+'" alt="'+ke+'"';return ve&&(ct+=' title="'+ve+'"'),ct+(this.options.xhtml?"/>":">")},ot.text=function(pe){return pe},rt}(),R=function(){function rt(){}var ot=rt.prototype;return ot.strong=function(pe){return pe},ot.em=function(pe){return pe},ot.codespan=function(pe){return pe},ot.del=function(pe){return pe},ot.html=function(pe){return pe},ot.text=function(pe){return pe},ot.link=function(pe,ve,ke){return""+ke},ot.image=function(pe,ve,ke){return""+ke},ot.br=function(){return""},rt}(),k=function(){function rt(){this.seen={}}var ot=rt.prototype;return ot.serialize=function(pe){return pe.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},ot.getNextSafeSlug=function(pe,ve){var ke=pe,ct=0;if(this.seen.hasOwnProperty(ke)){ct=this.seen[pe];do{ke=pe+"-"+ ++ct}while(this.seen.hasOwnProperty(ke))}return ve||(this.seen[pe]=ct,this.seen[ke]=0),ke},ot.slug=function(pe,ve){void 0===ve&&(ve={});var ke=this.serialize(pe);return this.getNextSafeSlug(ke,ve.dryrun)},rt}(),Oe=B,Xe=R,yt=k,It=dt.exports.defaults,Tn=se_unescape,$n=Pe,yi=function(){function rt(ut){this.options=ut||It,this.options.renderer=this.options.renderer||new Oe,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Xe,this.slugger=new yt}rt.parse=function(pe,ve){return new rt(ve).parse(pe)},rt.parseInline=function(pe,ve){return new rt(ve).parseInline(pe)};var ot=rt.prototype;return ot.parse=function(pe,ve){void 0===ve&&(ve=!0);var ct,Qe,vt,xt,Tt,$t,jn,ii,Mn,fn,zn,bn,Zi,Ji,qn,Pi,da,$r,ne,ke="",de=pe.length;for(ct=0;ct<de;ct++)if(fn=pe[ct],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[fn.type]&&(!1!==(ne=this.options.extensions.renderers[fn.type].call(this,fn))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(fn.type)))ke+=ne||"";else switch(fn.type){case"space":continue;case"hr":ke+=this.renderer.hr();continue;case"heading":ke+=this.renderer.heading(this.parseInline(fn.tokens),fn.depth,Tn(this.parseInline(fn.tokens,this.textRenderer)),this.slugger);continue;case"code":ke+=this.renderer.code(fn.text,fn.lang,fn.escaped);continue;case"table":for(ii="",jn="",xt=fn.header.length,Qe=0;Qe<xt;Qe++)jn+=this.renderer.tablecell(this.parseInline(fn.tokens.header[Qe]),{header:!0,align:fn.align[Qe]});for(ii+=this.renderer.tablerow(jn),Mn="",xt=fn.cells.length,Qe=0;Qe<xt;Qe++){for(jn="",Tt=($t=fn.tokens.cells[Qe]).length,vt=0;vt<Tt;vt++)jn+=this.renderer.tablecell(this.parseInline($t[vt]),{header:!1,align:fn.align[vt]});Mn+=this.renderer.tablerow(jn)}ke+=this.renderer.table(ii,Mn);continue;case"blockquote":Mn=this.parse(fn.tokens),ke+=this.renderer.blockquote(Mn);continue;case"list":for(zn=fn.ordered,bn=fn.start,Zi=fn.loose,xt=fn.items.length,Mn="",Qe=0;Qe<xt;Qe++)Pi=(qn=fn.items[Qe]).checked,da=qn.task,Ji="",qn.task&&($r=this.renderer.checkbox(Pi),Zi?qn.tokens.length>0&&"text"===qn.tokens[0].type?(qn.tokens[0].text=$r+" "+qn.tokens[0].text,qn.tokens[0].tokens&&qn.tokens[0].tokens.length>0&&"text"===qn.tokens[0].tokens[0].type&&(qn.tokens[0].tokens[0].text=$r+" "+qn.tokens[0].tokens[0].text)):qn.tokens.unshift({type:"text",text:$r}):Ji+=$r),Ji+=this.parse(qn.tokens,Zi),Mn+=this.renderer.listitem(Ji,da,Pi);ke+=this.renderer.list(Mn,zn,bn);continue;case"html":ke+=this.renderer.html(fn.text);continue;case"paragraph":ke+=this.renderer.paragraph(this.parseInline(fn.tokens));continue;case"text":for(Mn=fn.tokens?this.parseInline(fn.tokens):fn.text;ct+1<de&&"text"===pe[ct+1].type;)Mn+="\n"+((fn=pe[++ct]).tokens?this.parseInline(fn.tokens):fn.text);ke+=ve?this.renderer.paragraph(Mn):Mn;continue;default:var oe='Token with "'+fn.type+'" type was not found.';if(this.options.silent)return void console.error(oe);throw new Error(oe)}return ke},ot.parseInline=function(pe,ve){ve=ve||this.renderer;var ct,Qe,vt,ke="",xt=pe.length;for(ct=0;ct<xt;ct++)if(Qe=pe[ct],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Qe.type]&&(!1!==(vt=this.options.extensions.renderers[Qe.type].call(this,Qe))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Qe.type)))ke+=vt||"";else switch(Qe.type){case"escape":ke+=ve.text(Qe.text);break;case"html":ke+=ve.html(Qe.text);break;case"link":ke+=ve.link(Qe.href,Qe.title,this.parseInline(Qe.tokens,ve));break;case"image":ke+=ve.image(Qe.href,Qe.title,Qe.text);break;case"strong":ke+=ve.strong(this.parseInline(Qe.tokens,ve));break;case"em":ke+=ve.em(this.parseInline(Qe.tokens,ve));break;case"codespan":ke+=ve.codespan(Qe.text);break;case"br":ke+=ve.br();break;case"del":ke+=ve.del(this.parseInline(Qe.tokens,ve));break;case"text":ke+=ve.text(Qe.text);break;default:var Tt='Token with "'+Qe.type+'" type was not found.';if(this.options.silent)return void console.error(Tt);throw new Error(Tt)}return ke},rt}(),hi=Ze,Hr=B,Ns=R,cs=k,Ps=se_merge,Gr=se_checkSanitizeDeprecation,qa=se_escape,Al=dt.exports.getDefaults,ua=dt.exports.changeDefaults,ms=dt.exports.defaults;function Qt(rt,ot,ut){if(null==rt)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");if("function"==typeof ot&&(ut=ot,ot=null),ot=Ps({},Qt.defaults,ot||{}),Gr(ot),ut){var ve,pe=ot.highlight;try{ve=$n.lex(rt,ot)}catch(vt){return ut(vt)}var ke=function(xt){var Tt;if(!xt)try{ot.walkTokens&&Qt.walkTokens(ve,ot.walkTokens),Tt=yi.parse(ve,ot)}catch($t){xt=$t}return ot.highlight=pe,xt?ut(xt):ut(null,Tt)};if(!pe||pe.length<3||(delete ot.highlight,!ve.length))return ke();var ct=0;return Qt.walkTokens(ve,function(vt){"code"===vt.type&&(ct++,setTimeout(function(){pe(vt.text,vt.lang,function(xt,Tt){if(xt)return ke(xt);null!=Tt&&Tt!==vt.text&&(vt.text=Tt,vt.escaped=!0),0==--ct&&ke()})},0))}),void(0===ct&&ke())}try{var Qe=$n.lex(rt,ot);return ot.walkTokens&&Qt.walkTokens(Qe,ot.walkTokens),yi.parse(Qe,ot)}catch(vt){if(vt.message+="\nPlease report this to https://github.com/markedjs/marked.",ot.silent)return"<p>An error occurred:</p><pre>"+qa(vt.message+"",!0)+"</pre>";throw vt}}return Qt.options=Qt.setOptions=function(rt){return Ps(Qt.defaults,rt),ua(Qt.defaults),Qt},Qt.getDefaults=Al,Qt.defaults=ms,Qt.use=function(){for(var rt=this,ot=arguments.length,ut=new Array(ot),pe=0;pe<ot;pe++)ut[pe]=arguments[pe];var ct,ve=Ps.apply(void 0,[{}].concat(ut)),ke=Qt.defaults.extensions||{renderers:{},childTokens:{}};ut.forEach(function(Qe){if(Qe.extensions&&(ct=!0,Qe.extensions.forEach(function(xt){if(!xt.name)throw new Error("extension name required");if(xt.renderer){var Tt=ke.renderers?ke.renderers[xt.name]:null;ke.renderers[xt.name]=Tt?function(){for(var $t=arguments.length,jn=new Array($t),ii=0;ii<$t;ii++)jn[ii]=arguments[ii];var Mn=xt.renderer.apply(this,jn);return!1===Mn&&(Mn=Tt.apply(this,jn)),Mn}:xt.renderer}if(xt.tokenizer){if(!xt.level||"block"!==xt.level&&"inline"!==xt.level)throw new Error("extension level must be 'block' or 'inline'");ke[xt.level]?ke[xt.level].unshift(xt.tokenizer):ke[xt.level]=[xt.tokenizer],xt.start&&("block"===xt.level?ke.startBlock?ke.startBlock.push(xt.start):ke.startBlock=[xt.start]:"inline"===xt.level&&(ke.startInline?ke.startInline.push(xt.start):ke.startInline=[xt.start]))}xt.childTokens&&(ke.childTokens[xt.name]=xt.childTokens)})),Qe.renderer&&function(){var xt=Qt.defaults.renderer||new Hr,Tt=function(ii){var Mn=xt[ii];xt[ii]=function(){for(var fn=arguments.length,zn=new Array(fn),bn=0;bn<fn;bn++)zn[bn]=arguments[bn];var Zi=Qe.renderer[ii].apply(xt,zn);return!1===Zi&&(Zi=Mn.apply(xt,zn)),Zi}};for(var $t in Qe.renderer)Tt($t);ve.renderer=xt}(),Qe.tokenizer&&function(){var xt=Qt.defaults.tokenizer||new hi,Tt=function(ii){var Mn=xt[ii];xt[ii]=function(){for(var fn=arguments.length,zn=new Array(fn),bn=0;bn<fn;bn++)zn[bn]=arguments[bn];var Zi=Qe.tokenizer[ii].apply(xt,zn);return!1===Zi&&(Zi=Mn.apply(xt,zn)),Zi}};for(var $t in Qe.tokenizer)Tt($t);ve.tokenizer=xt}(),Qe.walkTokens){var vt=Qt.defaults.walkTokens;ve.walkTokens=function(xt){Qe.walkTokens.call(rt,xt),vt&&vt(xt)}}ct&&(ve.extensions=ke),Qt.setOptions(ve)})},Qt.walkTokens=function(rt,ot){for(var ve,ut=function(){var ct=ve.value;switch(ot(ct),ct.type){case"table":for(var vt,Qe=At(ct.tokens.header);!(vt=Qe()).done;)Qt.walkTokens(vt.value,ot);for(var $t,Tt=At(ct.tokens.cells);!($t=Tt()).done;)for(var Mn,ii=At($t.value);!(Mn=ii()).done;)Qt.walkTokens(Mn.value,ot);break;case"list":Qt.walkTokens(ct.items,ot);break;default:Qt.defaults.extensions&&Qt.defaults.extensions.childTokens&&Qt.defaults.extensions.childTokens[ct.type]?Qt.defaults.extensions.childTokens[ct.type].forEach(function(zn){Qt.walkTokens(ct[zn],ot)}):ct.tokens&&Qt.walkTokens(ct.tokens,ot)}},pe=At(rt);!(ve=pe()).done;)ut()},Qt.parseInline=function(rt,ot){if(null==rt)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");ot=Ps({},Qt.defaults,ot||{}),Gr(ot);try{var ut=$n.lexInline(rt,ot);return ot.walkTokens&&Qt.walkTokens(ut,ot.walkTokens),yi.parseInline(ut,ot)}catch(pe){if(pe.message+="\nPlease report this to https://github.com/markedjs/marked.",ot.silent)return"<p>An error occurred:</p><pre>"+qa(pe.message+"",!0)+"</pre>";throw pe}},Qt.Parser=yi,Qt.parser=yi.parse,Qt.Renderer=Hr,Qt.TextRenderer=Ns,Qt.Lexer=$n,Qt.lexer=$n.lex,Qt.Tokenizer=hi,Qt.Slugger=cs,Qt.parse=Qt,Qt}()},369:(kt,it,tt)=>{var gt=tt(284),J=tt(830);function At(){this.clear()}At.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},At.prototype.enqueue=function(dt){return this.items.push(dt),++this.size},At.prototype.dequeue=function(){if(this.size){var dt=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,dt}},At.prototype.peek=function(){if(this.size)return this.items[this.offset]},At.prototype.forEach=function(dt,K){K=arguments.length>1?K:this;for(var Ae=this.offset,he=0,q=this.items.length;Ae<q;Ae++,he++)dt.call(K,this.items[Ae],he,this)},At.prototype.toArray=function(){return this.items.slice(this.offset)},At.prototype.values=function(){var dt=this.items,K=this.offset;return new gt(function(){if(K>=dt.length)return{done:!0};var Ae=dt[K];return K++,{value:Ae,done:!1}})},At.prototype.entries=function(){var dt=this.items,K=this.offset,Ae=0;return new gt(function(){if(K>=dt.length)return{done:!0};var he=dt[K];return K++,{value:[Ae++,he],done:!1}})},"undefined"!=typeof Symbol&&(At.prototype[Symbol.iterator]=At.prototype.values),At.prototype.toString=function(){return this.toArray().join(",")},At.prototype.toJSON=function(){return this.toArray()},At.prototype.inspect=function(){var dt=this.toArray();return Object.defineProperty(dt,"constructor",{value:At,enumerable:!1}),dt},"undefined"!=typeof Symbol&&(At.prototype[Symbol.for("nodejs.util.inspect.custom")]=At.prototype.inspect),At.from=function(dt){var K=new At;return J(dt,function(Ae){K.enqueue(Ae)}),K},At.of=function(){return At.from(arguments)},kt.exports=At},830:kt=>{var it="undefined"!=typeof ArrayBuffer,tt="undefined"!=typeof Symbol;function gt(J,At){var dt,K,Ae,he,q;if(!J)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof At)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(J)||it&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Ae=0,he=J.length;Ae<he;Ae++)At(J[Ae],Ae);else if("function"!=typeof J.forEach)if(tt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(K in J)J.hasOwnProperty(K)&&At(J[K],K);else for(dt=J,Ae=0;!0!==(q=dt.next()).done;)At(q.value,Ae),Ae++;else J.forEach(At)}gt.forEachWithNullKeys=function(J,At){var dt,K,Ae,he,q;if(!J)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof At)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(J)||it&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Ae=0,he=J.length;Ae<he;Ae++)At(J[Ae],null);else if(J instanceof Set)J.forEach(function(V){At(V,null)});else if("function"!=typeof J.forEach)if(tt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(K in J)J.hasOwnProperty(K)&&At(J[K],K);else for(dt=J,Ae=0;!0!==(q=dt.next()).done;)At(q.value,null),Ae++;else J.forEach(At)},kt.exports=gt},284:kt=>{function it(tt){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:tt}),this.done=!1}it.prototype.next=function(){if(this.done)return{done:!0};var tt=this._next();return tt.done&&(this.done=!0),tt},"undefined"!=typeof Symbol&&(it.prototype[Symbol.iterator]=function(){return this}),it.of=function(){var tt=arguments,gt=tt.length,J=0;return new it(function(){return J>=gt?{done:!0}:{done:!1,value:tt[J++]}})},it.empty=function(){var tt=new it(null);return tt.done=!0,tt},it.is=function(tt){return tt instanceof it||"object"==typeof tt&&null!==tt&&"function"==typeof tt.next},kt.exports=it},310:(kt,it,tt)=>{"use strict";var gt=tt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.isMobile=function(){return void 0!==J.window.orientation},it.default=function(he){if(!he&&!(0,At.default)())return"Node";if((0,dt.default)(he))return"Electron";var q="undefined"!=typeof navigator?navigator:{},V=he||q.userAgent||"";if(V.indexOf("Edge")>-1)return"Edge";var L=-1!==V.indexOf("MSIE "),re=-1!==V.indexOf("Trident/");return L||re?"IE":J.window.chrome?"Chrome":J.window.safari?"Safari":J.window.mozInnerScreenX?"Firefox":"Unknown"};var J=tt(151),At=gt(tt(602)),dt=gt(tt(344))},151:(kt,it,tt)=>{"use strict";var gt=tt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.console=it.process=it.document=it.global=it.window=it.self=void 0;var J=gt(tt(321)),At={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&process};it.self=At.self||At.window||At.global,it.window=At.window||At.self||At.global,it.global=At.global||At.self||At.window,it.document=At.document||{},it.process=At.process||{};var V=console;it.console=V},761:(kt,it,tt)=>{"use strict";var J=tt(948),At=tt(321);Object.defineProperty(it,"CO",{enumerable:!0,get:function(){return dt.global}}),Object.defineProperty(it,"jU",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(it,"qs",{enumerable:!0,get:function(){return Ae.default}});var dt=tt(151),K=V(tt(602)),Ae=V(tt(310));J(tt(344));function q(L){if("function"!=typeof WeakMap)return null;var re=new WeakMap,$=new WeakMap;return(q=function(S){return S?$:re})(L)}function V(L,re){if(!re&&L&&L.__esModule)return L;if(null===L||"object"!==At(L)&&"function"!=typeof L)return{default:L};var $=q(re);if($&&$.has(L))return $.get(L);var b={},S=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in L)if("default"!==O&&Object.prototype.hasOwnProperty.call(L,O)){var T=S?Object.getOwnPropertyDescriptor(L,O):null;T&&(T.get||T.set)?Object.defineProperty(b,O,T):b[O]=L[O]}return b.default=L,$&&$.set(L,b),b}},602:(kt,it,tt)=>{"use strict";var gt=tt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=dt,it.isBrowserMainThread=function(){return dt()&&"undefined"!=typeof document};var J=gt(tt(321)),At=gt(tt(344));function dt(){return!("object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,At.default)()}},344:(kt,it,tt)=>{"use strict";var gt=tt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=function(dt){if("undefined"!=typeof window&&"object"===(0,J.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,J.default)(process.versions)&&Boolean(process.versions.electron))return!0;var K="object"===("undefined"==typeof navigator?"undefined":(0,J.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,Ae=dt||K;return!!(Ae&&Ae.indexOf("Electron")>=0)};var J=gt(tt(321))},991:function(kt,it,tt){"use strict";var gt=this&&this.__createBinding||(Object.create?function(At,dt,K,Ae){void 0===Ae&&(Ae=K),Object.defineProperty(At,Ae,{enumerable:!0,get:function(){return dt[K]}})}:function(At,dt,K,Ae){void 0===Ae&&(Ae=K),At[Ae]=dt[K]}),J=this&&this.__exportStar||function(At,dt){for(var K in At)"default"!==K&&!Object.prototype.hasOwnProperty.call(dt,K)&&gt(dt,At,K)};Object.defineProperty(it,"__esModule",{value:!0}),J(tt(180),it),J(tt(103),it),J(tt(965),it),J(tt(595),it),J(tt(417),it),J(tt(451),it),J(tt(735),it)},180:(kt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.BlankNode=void 0,it.BlankNode=class{constructor(J){this.termType="BlankNode",this.value=J}equals(J){return!!J&&"BlankNode"===J.termType&&J.value===this.value}}},103:(kt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DataFactory=void 0;const gt=tt(180),J=tt(965),At=tt(595),dt=tt(417),K=tt(451),Ae=tt(735);let he=0;it.DataFactory=class{constructor(L){this.blankNodeCounter=0,this.blankNodePrefix=(L=L||{}).blankNodePrefix||`df_${he++}_`}namedNode(L){return new dt.NamedNode(L)}blankNode(L){return new gt.BlankNode(L||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(L,re){return new At.Literal(L,re)}variable(L){return new Ae.Variable(L)}defaultGraph(){return J.DefaultGraph.INSTANCE}quad(L,re,$,b){return new K.Quad(L,re,$,b||this.defaultGraph())}fromTerm(L){switch(L.termType){case"NamedNode":return this.namedNode(L.value);case"BlankNode":return this.blankNode(L.value);case"Literal":return L.language?this.literal(L.value,L.language):L.datatype.equals(At.Literal.XSD_STRING)?this.literal(L.value):this.literal(L.value,this.fromTerm(L.datatype));case"Variable":return this.variable(L.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(L.subject),this.fromTerm(L.predicate),this.fromTerm(L.object),this.fromTerm(L.graph))}}fromQuad(L){return this.fromTerm(L)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(kt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DefaultGraph=void 0;class tt{constructor(){this.termType="DefaultGraph",this.value=""}equals(J){return!!J&&"DefaultGraph"===J.termType}}it.DefaultGraph=tt,tt.INSTANCE=new tt},595:(kt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Literal=void 0;const gt=tt(417);class J{constructor(dt,K){this.termType="Literal",this.value=dt,"string"==typeof K?(this.language=K,this.datatype=J.RDF_LANGUAGE_STRING):K?(this.language="",this.datatype=K):(this.language="",this.datatype=J.XSD_STRING)}equals(dt){return!!dt&&"Literal"===dt.termType&&dt.value===this.value&&dt.language===this.language&&dt.datatype.equals(this.datatype)}}it.Literal=J,J.RDF_LANGUAGE_STRING=new gt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),J.XSD_STRING=new gt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(kt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.NamedNode=void 0,it.NamedNode=class{constructor(J){this.termType="NamedNode",this.value=J}equals(J){return!!J&&"NamedNode"===J.termType&&J.value===this.value}}},451:(kt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Quad=void 0,it.Quad=class{constructor(J,At,dt,K){this.termType="Quad",this.value="",this.subject=J,this.predicate=At,this.object=dt,this.graph=K}equals(J){return!!J&&("Quad"===J.termType||!J.termType)&&this.subject.equals(J.subject)&&this.predicate.equals(J.predicate)&&this.object.equals(J.object)&&this.graph.equals(J.graph)}}},735:(kt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Variable=void 0,it.Variable=class{constructor(J){this.termType="Variable",this.value=J}equals(J){return!!J&&"Variable"===J.termType&&J.value===this.value}}},609:function(kt,it,tt){"use strict";var gt=this&&this.__createBinding||(Object.create?function(b,S,O,T){void 0===T&&(T=O),Object.defineProperty(b,T,{enumerable:!0,get:function(){return S[O]}})}:function(b,S,O,T){void 0===T&&(T=O),b[T]=S[O]}),J=this&&this.__exportStar||function(b,S){for(var O in b)"default"!==O&&!Object.prototype.hasOwnProperty.call(S,O)&&gt(S,b,O)};Object.defineProperty(it,"__esModule",{value:!0}),it.getSupportedJavaScriptPrimitives=it.getSupportedRdfDatatypes=it.getTermRaw=it.toRdf=it.fromRdf=void 0;const At=tt(991),dt=tt(938),K=tt(60);J(tt(938),it),J(tt(871),it),J(tt(60),it);const Ae=new At.DataFactory,he=new K.Translator;function q(b,S){return he.fromRdf(b,S)}he.registerHandler(new dt.TypeHandlerString,dt.TypeHandlerString.TYPES.map(b=>Ae.namedNode(b)),["string"]),he.registerHandler(new dt.TypeHandlerBoolean,[dt.TypeHandlerBoolean.TYPE].map(b=>Ae.namedNode(b)),["boolean"]),he.registerHandler(new dt.TypeHandlerNumberDouble,dt.TypeHandlerNumberDouble.TYPES.map(b=>Ae.namedNode(b)),["number"]),he.registerHandler(new dt.TypeHandlerNumberInteger,dt.TypeHandlerNumberInteger.TYPES.map(b=>Ae.namedNode(b)),["number"]),he.registerHandler(new dt.TypeHandlerDate,dt.TypeHandlerDate.TYPES.map(b=>Ae.namedNode(b)),["object"]),it.fromRdf=q,it.toRdf=function(b,S){return S&&"namedNode"in S&&(S={dataFactory:S}),(S=S||{})&&!S.dataFactory&&(S.dataFactory=Ae),he.toRdf(b,S)},it.getTermRaw=function(b,S){return"Literal"===b.termType?q(b,S):b.value},it.getSupportedRdfDatatypes=function(){return he.getSupportedRdfDatatypes()},it.getSupportedJavaScriptPrimitives=function(){return he.getSupportedJavaScriptPrimitives()}},871:(kt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0})},60:(kt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Translator=void 0,it.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(J){throw new Error(`Invalid RDF ${J.datatype.value} value: '${J.value}'`)}registerHandler(J,At,dt){for(const K of At)this.supportedRdfDatatypes.push(K),this.fromRdfHandlers[K.value]=J;for(const K of dt){let Ae=this.toRdfHandlers[K];Ae||(this.toRdfHandlers[K]=Ae=[]),Ae.push(J)}}fromRdf(J,At){const dt=this.fromRdfHandlers[J.datatype.value];return dt?dt.fromRdf(J,At):J.value}toRdf(J,At){const dt=this.toRdfHandlers[typeof J];if(dt)for(const K of dt){const Ae=K.toRdf(J,At);if(Ae)return Ae}throw new Error(`Invalid JavaScript value: '${J}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(kt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerBoolean=void 0;const gt=tt(60);class J{fromRdf(dt,K){switch(dt.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return K&&gt.Translator.incorrectRdfDataType(dt),!1}toRdf(dt,{datatype:K,dataFactory:Ae}){return Ae.literal(dt?"true":"false",K||Ae.namedNode(J.TYPE))}}it.TypeHandlerBoolean=J,J.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},525:(kt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerDate=void 0;const gt=tt(60);class J{fromRdf(dt,K){switch(K&&!dt.value.match(J.VALIDATORS[dt.datatype.value.substr(33,dt.datatype.value.length)])&&gt.Translator.incorrectRdfDataType(dt),dt.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(dt.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const Ae=dt.value.split("-");return new Date(0,parseInt(Ae[0],10)-1,parseInt(Ae[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(dt.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(dt.value+"-01");default:return new Date(dt.value)}}toRdf(dt,{datatype:K,dataFactory:Ae}){if(K=K||Ae.namedNode(J.TYPES[0]),!(dt instanceof Date))return null;const he=dt;let q;switch(K.value){case"http://www.w3.org/2001/XMLSchema#gDay":q=String(he.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":q=he.getUTCMonth()+1+"-"+he.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":q=String(he.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":q=he.getUTCFullYear()+"-"+(he.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":q=he.toISOString().replace(/T.*$/,"");break;default:q=he.toISOString()}return Ae.literal(q,K)}}it.TypeHandlerDate=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],J.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(kt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberDouble=void 0;const gt=tt(60);class J{fromRdf(dt,K){const Ae=parseFloat(dt.value);return K&&isNaN(Ae)&&gt.Translator.incorrectRdfDataType(dt),Ae}toRdf(dt,{datatype:K,dataFactory:Ae}){return K=K||Ae.namedNode(J.TYPES[0]),isNaN(dt)?Ae.literal("NaN",K):isFinite(dt)?dt%1==0?null:Ae.literal(dt.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),K):Ae.literal(dt>0?"INF":"-INF",K)}}it.TypeHandlerNumberDouble=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(kt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberInteger=void 0;const gt=tt(60);class J{fromRdf(dt,K){const Ae=parseInt(dt.value,10);return K&&(isNaN(Ae)||dt.value.indexOf(".")>=0)&&gt.Translator.incorrectRdfDataType(dt),Ae}toRdf(dt,{datatype:K,dataFactory:Ae}){return Ae.literal(String(dt),K||Ae.namedNode(dt<=J.MAX_INT&&dt>=J.MIN_INT?J.TYPES[0]:J.TYPES[1]))}}it.TypeHandlerNumberInteger=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],J.MAX_INT=2147483647,J.MIN_INT=-2147483648},608:(kt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerString=void 0;class tt{fromRdf(J){return J.value}toRdf(J,{datatype:At,dataFactory:dt}){return dt.literal(J,At)}}it.TypeHandlerString=tt,tt.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:function(kt,it,tt){"use strict";var gt=this&&this.__createBinding||(Object.create?function(At,dt,K,Ae){void 0===Ae&&(Ae=K),Object.defineProperty(At,Ae,{enumerable:!0,get:function(){return dt[K]}})}:function(At,dt,K,Ae){void 0===Ae&&(Ae=K),At[Ae]=dt[K]}),J=this&&this.__exportStar||function(At,dt){for(var K in At)"default"!==K&&!Object.prototype.hasOwnProperty.call(dt,K)&&gt(dt,At,K)};Object.defineProperty(it,"__esModule",{value:!0}),J(tt(727),it),J(tt(525),it),J(tt(554),it),J(tt(750),it),J(tt(608),it)},18:(kt,it,tt)=>{"use strict";var gt={};tt.r(gt),tt.d(gt,{decode:()=>_fe,encode:()=>yfe});var J={};tt.r(J),tt.d(J,{decode:()=>Sfe,encode:()=>xfe});var At={};tt.r(At),tt.d(At,{decode:()=>Cfe,encode:()=>Afe});var dt={};function K(n){return"function"==typeof n}tt.r(dt),tt.d(dt,{decode:()=>Tfe,encode:()=>Dfe});let Ae=!1;const he={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Ae&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Ae=n},get useDeprecatedSynchronousErrorHandling(){return Ae}};function q(n){setTimeout(()=>{throw n},0)}const V={closed:!0,next(n){},error(n){if(he.useDeprecatedSynchronousErrorHandling)throw n;q(n)},complete(){}},L=Array.isArray||(n=>n&&"number"==typeof n.length);function re(n){return null!==n&&"object"==typeof n}const b=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class S{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof S)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(K(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof b?O(o.errors):[o]}}if(L(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(re(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof b?e=e.concat(O(c.errors)):e.push(c)}}}if(e)throw new b(e)}add(e){let t=e;if(!e)return S.EMPTY;switch(typeof e){case"function":t=new S(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof S)){const s=t;t=new S,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof S){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function O(n){return n.reduce((e,t)=>e.concat(t instanceof b?t.errors:t),[])}S.EMPTY=((n=new S).closed=!0,n);const T="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends S{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=V;break;case 1:if(!e){this.destination=V;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new w(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new w(this,e,t,i)}}[T](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class w extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;K(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==V&&(o=Object.create(t),K(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;he.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=he;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):q(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;q(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);he.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),he.useDeprecatedSynchronousErrorHandling)throw i;q(i)}}__tryOrSetError(e,t,i){if(!he.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return he.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(q(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const I="function"==typeof Symbol&&Symbol.observable||"@@observable";function H(n){return n}let F=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[T])return n[T]()}return n||e||t?new y(n,e,t):new y(V)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||he.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),he.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){he.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=Q(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[I](){return this}pipe(...t){return 0===t.length?this:function(n){return 0===n.length?H:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=Q(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Q(n){if(n||(n=he.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const U=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class ie extends S{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class ue extends y{constructor(e){super(e),this.destination=e}}let ee=(()=>{class n extends F{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[T](){return new ue(this)}lift(t){const i=new se(this,this);return i.operator=t,i}next(t){if(this.closed)throw new U;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new U;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new U;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new U;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new U;return this.hasError?(t.error(this.thrownError),S.EMPTY):this.isStopped?(t.complete(),S.EMPTY):(this.observers.push(t),new ie(this,t))}asObservable(){const t=new F;return t.source=this,t}}return n.create=(e,t)=>new se(e,t),n})();class se extends ee{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):S.EMPTY}}function Te(n){return n&&"function"==typeof n.schedule}function me(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new te(n,e))}}class te{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new ye(e,this.project,this.thisArg))}}class ye extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Me=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Ze="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Le=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ee(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const Re=n=>{if(n&&"function"==typeof n[I])return(n=>e=>{const t=n[I]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(Le(n))return Me(n);if(Ee(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,q),e))(n);if(n&&"function"==typeof n[Ze])return(n=>e=>{const t=n[Ze]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${re(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Be(n,e){return new F(t=>{const i=new S;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function Pe(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[I]}(n))return function(n,e){return new F(t=>{const i=new S;return i.add(e.schedule(()=>{const r=n[I]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Ee(n))return function(n,e){return new F(t=>{const i=new S;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(Le(n))return Be(n,e);if(function(n){return n&&"function"==typeof n[Ze]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new F(t=>{const i=new S;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Ze](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof F?n:new F(Re(n))}class wt extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class fe extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function R(n,e){if(e.closed)return;if(n instanceof F)return n.subscribe(e);let t;try{t=Re(n)(e)}catch(i){e.error(i)}return t}function k(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(k((r,s)=>Pe(n(r,s)).pipe(me((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Oe(n,t)))}class Oe{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Xe(e,this.project,this.concurrent))}}class Xe extends fe{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new wt(this),i=this.destination;i.add(t);const r=R(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function It(n=Number.POSITIVE_INFINITY){return k(H,n)}function Tn(n,e){return e?Be(n,e):new F(Me(n))}function Pn(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return Te(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof F?n[0]:It(e)(Tn(n,t))}function $n(){return function(e){return e.lift(new yi(e))}}class yi{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new hi(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class hi extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Hr extends F{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new S,e.add(this.source.subscribe(new cs(this.getSubject(),this))),e.closed&&(this._connection=null,e=S.EMPTY)),e}refCount(){return $n()(this)}}const Ns=(()=>{const n=Hr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class cs extends ue{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}class Al{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function ua(){return new ee}function ms(){return n=>$n()(function(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new Al(r,e));const s=Object.create(i,Ns);return s.source=i,s.subjectFactory=r,s}}(ua)(n))}function Qt(n){for(let e in n)if(n[e]===Qt)return e;throw Error("Could not find renamed property on target object.")}function Ka(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function rt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(rt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function ot(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ut=Qt({__forward_ref__:Qt});function pe(n){return n.__forward_ref__=pe,n.toString=function(){return rt(this())},n}function ve(n){return ke(n)?n():n}function ke(n){return"function"==typeof n&&n.hasOwnProperty(ut)&&n.__forward_ref__===pe}class Qe extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function $t(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():function(n){return"string"==typeof n?n:null==n?"":String(n)}(n)}function fn(n,e){const t=e?` in ${e}`:"";throw new Qe("201",`No provider for ${$t(n)} found${t}`)}function Z(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function We(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Et(n){return{providers:n.providers||[],imports:n.imports||[]}}function pn(n){return _s(n,oo)||_s(n,Fs)}function _s(n,e){return n.hasOwnProperty(e)?n[e]:null}function Tl(n){return n&&(n.hasOwnProperty(Pr)||n.hasOwnProperty(fc))?n[Pr]:null}const oo=Qt({\u0275prov:Qt}),Pr=Qt({\u0275inj:Qt}),Fs=Qt({ngInjectableDef:Qt}),fc=Qt({ngInjectorDef:Qt});var yn=(()=>((yn=yn||{})[yn.Default=0]="Default",yn[yn.Host=1]="Host",yn[yn.Self=2]="Self",yn[yn.SkipSelf=4]="SkipSelf",yn[yn.Optional=8]="Optional",yn))();let ao;function ha(n){const e=ao;return ao=n,e}function id(n,e,t){const i=pn(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&yn.Optional?null:void 0!==e?e:void fn(rt(n),"Injector")}function Ce(n){return{toString:n}.toString()}var He=(()=>((He=He||{})[He.OnPush=0]="OnPush",He[He.Default=1]="Default",He))(),Ht=(()=>((Ht=Ht||{})[Ht.Emulated=0]="Emulated",Ht[Ht.None=2]="None",Ht[Ht.ShadowDom=3]="ShadowDom",Ht))();const ri="undefined"!=typeof globalThis&&globalThis,Fr="undefined"!=typeof window&&window,qr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ys="undefined"!=typeof global&&global,ti=ri||ys||Fr||qr,rd={},Wi=[],Wf=Qt({\u0275cmp:Qt}),xm=Qt({\u0275dir:Qt}),fh=Qt({\u0275pipe:Qt}),gv=Qt({\u0275mod:Qt}),DC=Qt({\u0275loc:Qt}),Ml=Qt({\u0275fac:Qt}),ph=Qt({__NG_ELEMENT_ID__:Qt});let MC=0;function wn(n){return Ce(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===He.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Wi,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Ht.Emulated,id:"c",styles:n.styles||Wi,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=MC++,i.inputs=vv(n.inputs,t),i.outputs=vv(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(mv):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(_v):null,i})}function mv(n){return Mi(n)||function(n){return n[xm]||null}(n)}function _v(n){return function(n){return n[fh]||null}(n)}const yv={};function gn(n){return Ce(()=>{const e={type:n.type,bootstrap:n.bootstrap||Wi,declarations:n.declarations||Wi,imports:n.imports||Wi,exports:n.exports||Wi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(yv[n.id]=n.type),e})}function vv(n,e){if(null==n)return rd;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Lt=wn;function Ls(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Mi(n){return n[Wf]||null}function xo(n,e){const t=n[gv]||null;if(!t&&!0===e)throw new Error(`Type ${rt(n)} does not have '\u0275mod' property.`);return t}function Ho(n){return Array.isArray(n)&&"object"==typeof n[1]}function Go(n){return Array.isArray(n)&&!0===n[1]}function Tm(n){return 0!=(8&n.flags)}function ld(n){return 2==(2&n.flags)}function cd(n){return 1==(1&n.flags)}function ga(n){return null!==n.template}function bv(n){return 0!=(512&n[2])}function mc(n,e){return n.hasOwnProperty(Ml)?n[Ml]:null}class Rm{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function qi(){return Sv}function Sv(n){return n.type.prototype.ngOnChanges&&(n.setInput=kC),LC}function LC(){const n=st(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===rd)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function kC(n,e,t,i){const r=st(n)||function(n,e){return n[bh]=e}(n,{previous:rd,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new Rm(l&&l.currentValue,e,o===rd),n[i]=e}qi.ngInherit=!0;const bh="__ngSimpleChanges__";function st(n){return n[bh]||null}let Bi;function or(n){return!!n.listen}const au={createRenderer:(n,e)=>void 0!==Bi?Bi:"undefined"!=typeof document?document:void 0};function vr(n){for(;Array.isArray(n);)n=n[0];return n}function Ys(n,e){return vr(e[n.index])}function Pm(n,e){return n.data[e]}function Bs(n,e){const t=e[n];return Ho(t)?t:t[0]}function Ol(n){return 4==(4&n[2])}function dd(n){return 128==(128&n[2])}function _a(n,e){return null==e?null:n[e]}function Fm(n){n[18]=0}function Yf(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Ln={lFrame:cu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Cv(){return Ln.bindingsEnabled}function Ft(){return Ln.lFrame.lView}function fi(){return Ln.lFrame.tView}function ya(n){return Ln.lFrame.contextLView=n,n[8]}function ts(){let n=Lm();for(;null!==n&&64===n.type;)n=n.parent;return n}function Lm(){return Ln.lFrame.currentTNode}function Qa(n,e){const t=Ln.lFrame;t.currentTNode=n,t.isParent=e}function Br(){return Ln.lFrame.isParent}function xh(){return Ln.isInCheckNoChangesMode}function Qf(n){Ln.isInCheckNoChangesMode=n}function hd(n,e){const t=Ln.lFrame;t.bindingIndex=t.bindingRootIndex=n,km(e)}function km(n){Ln.lFrame.currentDirectiveIndex=n}function Av(){return Ln.lFrame.currentQueryIndex}function jm(n){Ln.lFrame.currentQueryIndex=n}function Jf(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function fd(n,e,t){if(t&yn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&yn.Host||(r=Jf(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ln.lFrame=Se();return i.currentTNode=e,i.lView=n,!0}function Th(n){const e=Se(),t=n[1];Ln.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Se(){const n=Ln.lFrame,e=null===n?null:n.child;return null===e?cu(n):e}function cu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Dh(){const n=Ln.lFrame;return Ln.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const To=Dh;function oi(){const n=Dh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Xs(){return Ln.lFrame.selectedIndex}function uo(n){Ln.lFrame.selectedIndex=n}function ep(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=d&&(n.destroyHooks||(n.destroyHooks=[])).push(t,d)}}function tp(n,e,t){Za(n,e,3,t)}function np(n,e,t,i){(3&n[2])===t&&Za(n,e,t,i)}function Vm(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Za(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(QC(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function QC(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Mh{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function ip(n,e,t){const i=or(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];zm(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Tv(n){return 3===n||4===n||6===n}function zm(n){return 64===n.charCodeAt(0)}function Ih(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||Hm(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function Hm(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function Dv(n){return-1!==n}function pd(n){return 32767&n}function Ja(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let gd=!0;function rp(n){const e=gd;return gd=n,e}let $m=0;function js(n,e){const t=sp(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,Wm(i.data,n),Wm(e,null),Wm(i.blueprint,null));const r=Rh(n,e),s=n.injectorIndex;if(Dv(r)){const o=pd(r),a=Ja(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Wm(n,e){n.push(0,0,0,0,0,0,0,0,e)}function sp(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Rh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function yc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(ph)&&(i=t[ph]),null==i&&(i=t[ph]=$m++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function qm(n,e,t){if(t&yn.Optional)return n;fn(e,"NodeInjector")}function Iv(n,e,t,i){if(t&yn.Optional&&void 0===i&&(i=null),0==(t&(yn.Self|yn.Host))){const r=n[9],s=ha(void 0);try{return r?r.get(e,i,t&yn.Optional):id(e,i,t&yn.Optional)}finally{ha(s)}}return qm(i,e,t)}function Oh(n,e,t,i=yn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ph)?n[ph]:void 0;return"number"==typeof e?e>=0?255&e:Ov:e}(t);if("function"==typeof s){if(!fd(e,n,i))return i&yn.Host?qm(r,t,i):Iv(e,t,i,r);try{const o=s(i);if(null!=o||i&yn.Optional)return o;fn(t)}finally{To()}}else if("number"==typeof s){let o=null,a=sp(n,e),l=-1,c=i&yn.Host?e[16][6]:null;for((-1===a||i&yn.SkipSelf)&&(l=-1===a?Rh(n,e):e[a+8],-1!==l&&Nh(i,!1)?(o=e[1],a=pd(l),e=Ja(l,e)):a=-1);-1!==a;){const d=e[1];if(op(s,a,d.data)){const f=ws(a,e,t,o,i,c);if(f!==Rv)return f}l=e[a+8],-1!==l&&Nh(i,e[1].data[a+8]===c)&&op(s,a,e)?(o=d,a=pd(l),e=Ja(l,e)):a=-1}}}return Iv(e,t,i,r)}const Rv={};function Ov(){return new Wo(ts(),Ft())}function ws(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],d=md(a,o,t,null==i?ld(a)&&gd:i!=o&&0!=(3&a.type),r&yn.Host&&s===a);return null!==d?_d(e,o,d,a):Rv}function md(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,d=s>>20,p=r?a+d:n.directiveEnd;for(let g=i?a:a+d;g<p;g++){const _=o[g];if(g<l&&t===_||g>=l&&_.type===t)return g}if(r){const g=o[l];if(g&&ga(g)&&g.type===t)return l}return null}function _d(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof Mh}(r)){const o=r;o.resolving&&function(n,e){throw new Qe("200",`Circular dependency in DI detected for ${n}`)}($t(s[t]));const a=rp(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ha(o.injectImpl):null;fd(n,i,yn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=Sv(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&ha(l),rp(a),o.resolving=!1,To()}}return r}function op(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Nh(n,e){return!(n&yn.Self||n&yn.Host&&e)}class Wo{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Oh(this._tNode,this._lView,e,void 0,t)}}function nr(n){return Ce(()=>{const e=n.prototype.constructor,t=e[Ml]||Es(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Ml]||Es(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Es(n){return ke(n)?()=>{const e=Es(ve(n));return e&&e()}:mc(n)}const vd="__parameters__";function Sa(n,e,t){return Ce(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,d){const f=l.hasOwnProperty(vd)?l[vd]:Object.defineProperty(l,vd,{value:[]})[vd];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Vt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function qo(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),qo(i,e)):e!==n&&e.push(i)}return e}function Ko(n,e){n.forEach(t=>Array.isArray(t)?Ko(t,e):e(t))}function Fh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Pl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Do(n,e,t){let i=Ss(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Jm(n,e){const t=Ss(n,e);if(t>=0)return n[1|t]}function Ss(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const gu={},dp="__NG_DI_FLAG__",Ec="ngTempTokenPath",Sc=/\n/gm,nl="__source",hp=Qt({provide:String,useValue:Qt});let mu;function Ed(n){const e=mu;return mu=n,e}function hA(n,e=yn.Default){if(void 0===mu)throw new Error("inject() must be called from an injection context");return null===mu?id(n,void 0,e):mu.get(n,e&yn.Optional?null:void 0,e)}function Ie(n,e=yn.Default){return(ao||hA)(ve(n),e)}const xc=Ie;function _u(n){const e=[];for(let t=0;t<n.length;t++){const i=ve(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=yn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=Bv(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Ie(r,s))}else e.push(Ie(i))}return e}function Sd(n,e){return n[dp]=e,n.prototype[dp]=e,n}function Bv(n){return n[dp]}function Qs(n,e,t,i){const r=n[Ec];throw e[nl]&&r.unshift(e[nl]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=rt(e);if(Array.isArray(e))r=e.map(rt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):rt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Sc,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Ec]=null,n}const xd=Sd(Sa("Inject",n=>({token:n})),-1),Yr=Sd(Sa("Optional"),8),il=Sd(Sa("SkipSelf"),4);const m_="__ngContext__";function xs(n,e){n[m_]=e}function __(n){const e=function(n){return n[m_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function xp(n){return n.ngOriginalError}function LA(n,...e){n.error(...e)}class Zo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||LA}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(xp(e)):null}_findOriginalError(e){let t=e&&xp(e);for(;t&&xp(t);)t=xp(t);return t||null}}const db=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ti))();function sl(n){return n instanceof Function?n():n}var Ro=(()=>((Ro=Ro||{})[Ro.Important=1]="Important",Ro[Ro.DashCase=2]="DashCase",Ro))();function E_(n,e){return undefined(n,e)}function zh(n){const e=n[3];return Go(e)?e[3]:e}function Id(n){return mb(n[13])}function x_(n){return mb(n[4])}function mb(n){for(;null!==n&&!Go(n);)n=n[4];return n}function Rd(n,e,t,i,r){if(null!=i){let s,o=!1;Go(i)?s=i:Ho(i)&&(o=!0,i=i[0]);const a=vr(i);0===n&&null!==t?null==r?wb(e,t,a):ol(e,t,a,r||null,!0):1===n&&null!==t?ol(e,t,a,r||null,!0):2===n?function(n,e,t){const i=Tp(n,e);i&&function(n,e,t,i){or(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==vr(t)&&Rd(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Od(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function A_(n,e,t){return or(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function yb(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Yf(r,-1)),t.splice(i,1)}function T_(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&yb(r,i),e>0&&(n[t-1][4]=i[4]);const s=Pl(n,10+e);!function(n,e){Od(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function D_(n,e){if(!(256&e[2])){const t=e[11];or(t)&&t.destroyNode&&Od(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return Ap(n[1],n);for(;e;){let t=null;if(Ho(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Ho(e)&&Ap(e[1],e),e=e[3];null===e&&(e=n),Ho(e)&&Ap(e[1],e),t=e&&e[4]}e=t}}(e)}}function Ap(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Mh)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):vr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&or(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Go(e[3])){t!==e[3]&&yb(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function vb(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Ht.None||r===Ht.Emulated)return null}return Ys(i,t)}(n,e.parent,t)}function ol(n,e,t,i,r){or(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function wb(n,e,t){or(n)?n.appendChild(e,t):e.appendChild(t)}function Eb(n,e,t,i,r){null!==i?ol(n,e,t,i,r):wb(n,e,t)}function Tp(n,e){return or(n)?n.parentNode(e):e.parentNode}let Cb=function(n,e,t){return 40&n.type?Ys(n,t):null};function Dp(n,e,t,i){const r=vb(n,i,e),s=e[11],a=function(n,e,t){return Cb(n,e,t)}(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Eb(s,r,t[l],a,!1);else Eb(s,r,t,a,!1)}function wu(n,e){if(null!==e){const t=e.type;if(3&t)return Ys(e,n);if(4&t)return Mp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return wu(n,i);{const r=n[e.index];return Go(r)?Mp(-1,r):vr(r)}}if(32&t)return E_(e,n)()||vr(n[e.index]);{const i=Tb(n,e);return null!==i?Array.isArray(i)?i[0]:wu(zh(n[16]),i):wu(n,e.next)}}return null}function Tb(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Mp(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return wu(i,r)}return e[7]}function Hh(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&xs(vr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)Hh(n,e,t.child,i,r,s,!1),Rd(e,n,r,a,s);else if(32&l){const c=E_(t,i);let d;for(;d=c();)Rd(e,n,r,d,s);Rd(e,n,r,a,s)}else 16&l?R_(n,e,i,t,r,s):Rd(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Od(n,e,t,i,r,s){Hh(t,i,n.firstChild,e,r,s,!1)}function R_(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Rd(e,n,r,l[c],s);else Hh(n,e,l,o[3],r,s,!0)}function Ib(n,e,t){or(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function O_(n,e,t){or(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function Gh(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const Rb="ng-template";function l1(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==Gh(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Ip(n){return 4===n.type&&n.value!==Rb}function Ob(n,e,t){return e===(4!==n.type||t?n.value:Rb)}function c1(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(Tv(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Ob(n,l,t)||""===l&&1===e.length){if(Ca(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!l1(n.attrs,c,t)){if(Ca(i))return!1;o=!0}continue}const f=u1(8&i?"class":l,r,Ip(n),t);if(-1===f){if(Ca(i))return!1;o=!0;continue}if(""!==c){let p;p=f>s?"":r[f+1].toLowerCase();const g=8&i?p:null;if(g&&-1!==Gh(g,c,0)||2&i&&c!==p){if(Ca(i))return!1;o=!0}}}}else{if(!o&&!Ca(i)&&!Ca(l))return!1;if(o&&Ca(l))continue;o=!1,i=l|1&i}}return Ca(i)||o}function Ca(n){return 0==(1&n)}function u1(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function Nb(n,e,t=!1){for(let i=0;i<e.length;i++)if(c1(n,e[i],t))return!0;return!1}function Pb(n,e){return n?":not("+e.trim()+")":e}function g1(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ca(o)&&(e+=Pb(s,r),r=""),i=o,s=s||!Ca(i);t++}return""!==r&&(e+=Pb(s,r)),e}const Cn={};function al(n,e){return n<<17|e<<2}function Dn(n){return n>>17&32767}function br(n){return 2|n}function jl(n){return(131068&n)>>2}function ll(n,e){return-131069&n|e<<2}function P_(n){return 1|n}function Gb(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];jm(r),o.contentQueries(2,e[s],s)}}}function Wh(n,e,t,i,r,s,o,a,l,c){const d=e.blueprint.slice();return d[0]=r,d[2]=140|i,Fm(d),d[3]=d[15]=n,d[8]=t,d[10]=o||n&&n[10],d[11]=a||n&&n[11],d[12]=l||n&&n[12]||null,d[9]=c||n&&n[9]||null,d[6]=s,d[16]=2==e.type?n[16]:d,d}function Pd(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=Lm(),o=Br(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Ln.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Ln.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Qa(s,!0),s}function Fd(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function qh(n,e,t){Th(e);try{const i=n.viewQuery;null!==i&&X_(1,i,t);const r=n.template;null!==r&&$b(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Gb(n,e),n.staticViewQueries&&X_(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)$1(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,oi()}}function Ld(n,e,t,i){const r=e[2];if(256==(256&r))return;Th(e);const s=xh();try{Fm(e),function(n){Ln.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&$b(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&tp(e,c,null)}else{const c=n.preOrderHooks;null!==c&&np(e,c,0,null),Vm(e,0)}if(function(n){for(let e=Id(n);null!==e;e=x_(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&Yf(s,1),r[2]|=1024}}}(e),function(n){for(let e=Id(n);null!==e;e=x_(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];dd(i)&&Ld(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&Gb(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&tp(e,c)}else{const c=n.contentHooks;null!==c&&np(e,c,1),Vm(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)uo(~r);else{const s=r,o=t[++i],a=t[++i];hd(o,s),a(2,e[s])}}}finally{uo(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)G1(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&X_(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&tp(e,c)}else{const c=n.viewHooks;null!==c&&np(e,c,2),Vm(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Yf(e[3],-1))}finally{oi()}}function D1(n,e,t,i){const r=e[10],s=!xh(),o=Ol(e);try{s&&!o&&r.begin&&r.begin(),o&&qh(n,e,i),Ld(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function $b(n,e,t,i,r){const s=Xs(),o=2&i;try{uo(-1),o&&e.length>20&&function(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&tp(e,s,t)}else{const s=n.preOrderHooks;null!==s&&np(e,s,0,t)}uo(t)}(n,e,20,xh()),t(i,r)}finally{uo(s)}}function Kh(n,e,t){!Cv()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||js(t,e),xs(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=ga(l);c&&j1(e,t,l);const d=_d(e,n,a,t);xs(d,e),null!==o&&V1(0,a-r,d,l,0,o),c&&(Bs(t.index,e)[8]=d)}}(n,e,t,Ys(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Ln.lFrame.currentDirectiveIndex;try{uo(o);for(let l=i;l<r;l++){const c=n.data[l],d=e[l];km(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&tw(c,d)}}finally{uo(-1),km(a)}}(n,e,t))}function U_(n,e,t=Ys){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Pp(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Fp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Fp(n,e,t,i,r,s,o,a,l,c){const d=20+i,f=d+r,p=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Cn);return t}(d,f),g="function"==typeof c?c():c;return p[1]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function Kb(n,e,t,i){const r=sw(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&kp(n).push(i,r.length-1))}function Yb(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function z_(n,e,t,i){let r=!1;if(Cv()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];Nb(t,o.selectors,!1)&&(r||(r=[]),yc(js(t,e),n,o.type),ga(o)?(nw(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,H_(t,n.data.length,s.length);for(let d=0;d<s.length;d++){const f=s[d];f.providersResolver&&f.providersResolver(f)}let a=!1,l=!1,c=Fd(n,e,s.length,null);for(let d=0;d<s.length;d++){const f=s[d];t.mergedAttrs=Ih(t.mergedAttrs,f.hostAttrs),G_(n,t,e,c,f),B1(c,f,o),null!==f.contentQueries&&(t.flags|=8),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=128);const p=f.type.prototype;!a&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const d=r[c],f=d.inputs,p=null===s||Ip(e)?null:U1(f,s);o.push(p),a=Yb(f,c,a),l=Yb(d.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Qe("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Ih(t.mergedAttrs,t.attrs),r}function ew(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function tw(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function nw(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function B1(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ga(e)&&(t[""]=n)}}function H_(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function G_(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=mc(r.type)),o=new Mh(s,ga(r),null);n.blueprint[i]=o,t[i]=o,ew(n,e,0,i,Fd(n,t,r.hostVars,Cn),r)}function j1(n,e,t){const i=Ys(e,n),r=Pp(t),s=n[10],o=Lp(n,Wh(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function V1(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],d=o[l++],f=o[l++];null!==a?i.setInput(t,f,c,d):t[d]=f}}}function U1(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function iw(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function G1(n,e){const t=Bs(e,n);if(dd(t)){const i=t[1];80&t[2]?Ld(i,t,i.template,t[8]):t[5]>0&&W_(t)}}function W_(n){for(let i=Id(n);null!==i;i=x_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Ld(o,s,o.template,s[8])}else s[5]>0&&W_(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Bs(t[i],n);dd(r)&&r[5]>0&&W_(r)}}function $1(n,e){const t=Bs(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),qh(i,t,t[8])}function Lp(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function q_(n){for(;n;){n[2]|=64;const e=zh(n);if(bv(n)&&!e)return n;n=e}return null}function Y_(n,e,t){const i=e[10];i.begin&&i.begin();try{Ld(n,e,n.template,t)}catch(r){throw Z_(e,r),r}finally{i.end&&i.end()}}function rw(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=__(t),r=i[1];D1(r,i,r.template,t)}}(n[8])}function X_(n,e,t){jm(0),e(n,t)}const X1=(()=>Promise.resolve(null))();function sw(n){return n[7]||(n[7]=[])}function kp(n){return n.cleanup||(n.cleanup=[])}function Z_(n,e){const t=n[9],i=t?t.get(Zo,null):null;i&&i.handleError(e)}function ow(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Bp(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=ot(r,a):2==s&&(i=ot(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Bd=new Vt("INJECTOR",-1);class eo{get(e,t=gu){if(t===gu){const i=new Error(`NullInjectorError: No provider for ${rt(e)}!`);throw i.name="NullInjectorError",i}return t}}const Eu=new Vt("Set Injector scope."),Yh={},Z1={};let ey;function aw(){return void 0===ey&&(ey=new eo),ey}function lw(n,e=null,t=null,i){return new ny(n,t,e||aw(),i)}class ny{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Ko(t,a=>this.processProvider(a,e,t)),Ko([e],a=>this.processInjectorType(a,[],s)),this.records.set(Bd,Su(void 0,this));const o=this.records.get(Eu);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:rt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=gu,i=yn.Default){this.assertNotDestroyed();const r=Ed(this),s=ha(void 0);try{if(!(i&yn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof Vt}(e)&&pn(e);a=l&&this.injectableDefInScope(l)?Su(iy(e),Yh):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&yn.Self?aw():this.parent).get(e,t=i&yn.Optional&&t===gu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Ec]=o[Ec]||[]).unshift(rt(e)),r)throw o;return Qs(o,e,"R3InjectorError",this.source)}throw o}finally{ha(s),Ed(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(rt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=ve(e)))return!1;let r=Tl(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Tl(s)),null==r)return!1;if(null!=r.imports&&!a){let d;i.push(o);try{Ko(r.imports,f=>{this.processInjectorType(f,t,i)&&(void 0===d&&(d=[]),d.push(f))})}finally{}if(void 0!==d)for(let f=0;f<d.length;f++){const{ngModule:p,providers:g}=d[f];Ko(g,_=>this.processProvider(_,p,g||Wi))}}this.injectorDefTypes.add(o);const l=mc(o)||(()=>new o);this.records.set(o,Su(l,Yh));const c=r.providers;if(null!=c&&!a){const d=e;Ko(c,f=>this.processProvider(f,d,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=Mc(e=ve(e))?e:ve(e&&e.provide);const s=function(n,e,t){return uw(n)?Su(void 0,n.useValue):Su(function(n,e,t){let i;if(Mc(n)){const r=ve(n);return mc(r)||iy(r)}if(uw(n))i=()=>ve(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(..._u(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>Ie(ve(n.useExisting));else{const r=ve(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return mc(r)||iy(r);i=()=>new r(..._u(n.deps))}return i}(n),Yh)}(e);if(Mc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Su(void 0,Yh,!0),o.factory=()=>_u(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===Yh&&(t.value=Z1,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ve(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function iy(n){const e=pn(n),t=null!==e?e.factory:mc(n);if(null!==t)return t;if(n instanceof Vt)throw new Error(`Token ${rt(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=function(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?");throw new Error(`Can't resolve all parameters for ${rt(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[oo]||n[Fs]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function Su(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function uw(n){return null!==n&&"object"==typeof n&&hp in n}function Mc(n){return"function"==typeof n}const dw=function(n,e,t){return function(n,e=null,t=null,i){const r=lw(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class Hn{static create(e,t){return Array.isArray(e)?dw(e,t,""):dw(e.providers,e.parent,e.name||"")}}function B7(n,e){ep(__(n)[1],ts())}function Nn(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(ga(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=hT(n.inputs),o.declaredInputs=hT(n.declaredInputs),o.outputs=hT(n.outputs);const a=r.hostBindings;a&&z7(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&V7(n,l),c&&U7(n,c),Ka(n.inputs,r.inputs),Ka(n.declaredInputs,r.declaredInputs),Ka(n.outputs,r.outputs),ga(r)&&r.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Nn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Ih(r.hostAttrs,t=Ih(t,r.hostAttrs))}}(i)}function hT(n){return n===rd?{}:n===Wi?[]:n}function V7(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function U7(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function z7(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}Hn.THROW_IF_NOT_FOUND=gu,Hn.NULL=new eo,Hn.\u0275prov=We({token:Hn,providedIn:"any",factory:()=>Ie(Bd)}),Hn.__NG_ELEMENT_ID__=-1;let mw=null;function jp(){if(!mw){const n=ti.Symbol;if(n&&n.iterator)mw=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(mw=i)}}}return mw}class zl{constructor(e){this.wrapped=e}static wrap(e){return new zl(e)}static unwrap(e){return zl.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof zl}}function ly(n){return!!fT(n)&&(Array.isArray(n)||!(n instanceof Map)&&jp()in n)}function fT(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function go(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function De(n,e=yn.Default){const t=Ft();return null===t?Ie(n,e):Oh(ts(),t,ve(n),e)}function vn(n,e,t){const i=Ft();return go(i,Ln.lFrame.bindingIndex++,e)&&function(n,e,t,i,r,s,o,a){const l=Ys(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[i])?(ow(n,t,d,i,r),ld(e)&&function(n,e){const t=Bs(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,or(s)?s.setProperty(l,i,r):zm(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}(fi(),function(){const n=Ln.lFrame;return Pm(n.tView,n.selectedIndex)}(),i,n,e,i[11],t,!1),vn}function yT(n,e,t,i,r){const o=r?"class":"style";ow(n,t,e.inputs[o],o,i)}function Kt(n,e,t,i){const r=Ft(),s=fi(),o=20+n,a=r[11],l=r[o]=A_(a,e,Ln.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=Pd(e,n,2,r,_a(a,s));return z_(e,t,c,_a(a,o)),null!==c.attrs&&Bp(c,c.attrs,!1),null!==c.mergedAttrs&&Bp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Qa(c,!0);const d=c.mergedAttrs;null!==d&&ip(a,l,d);const f=c.classes;null!==f&&O_(a,l,f);const p=c.styles;null!==p&&Ib(a,l,p),64!=(64&c.flags)&&Dp(s,r,l,c),0===Ln.lFrame.elementDepthCount&&xs(l,r),Ln.lFrame.elementDepthCount++,cd(c)&&(Kh(s,r,c),function(n,e,t){if(Tm(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&U_(r,c)}function Yt(){let n=ts();Br()?Ln.lFrame.isParent=!1:(n=n.parent,Qa(n,!1));const e=n;Ln.lFrame.elementDepthCount--;const t=fi();t.firstCreatePass&&(ep(t,n),Tm(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&yT(t,e,Ft(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&yT(t,e,Ft(),e.stylesWithoutHost,!1)}function uy(n){return!!n&&"function"==typeof n.then}function qF(n){return!!n&&"function"==typeof n.subscribe}const vw=qF;function ui(n,e,t,i){const r=Ft(),s=fi(),o=ts();return function(n,e,t,i,r,s,o,a){const l=cd(i),d=n.firstCreatePass&&kp(n),f=e[8],p=sw(e);let g=!0;if(3&i.type||a){const A=Ys(i,e),W=a?a(A):A,G=p.length,ge=a?Ne=>a(vr(Ne[i.index])):i.index;if(or(t)){let Ne=null;if(!a&&l&&(Ne=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Ne)(Ne.__ngLastListenerFn__||Ne).__ngNextListenerFn__=s,Ne.__ngLastListenerFn__=s,g=!1;else{s=vT(i,e,f,s,!1);const Ge=t.listen(W,r,s);p.push(s,Ge),d&&d.push(r,ge,G,G+1)}}else s=vT(i,e,f,s,!0),W.addEventListener(r,s,o),p.push(s),d&&d.push(r,ge,G,o)}else s=vT(i,e,f,s,!1);const _=i.outputs;let x;if(g&&null!==_&&(x=_[r])){const A=x.length;if(A)for(let W=0;W<A;W+=2){const $e=e[x[W]][x[W+1]].subscribe(s),at=p.length;p.push(s,$e),d&&d.push(r,i.index,at,-(at+1))}}}(s,r,r[11],o,n,e,!!t,i),ui}function YF(n,e,t,i){try{return!1!==t(i)}catch(r){return Z_(n,r),!1}}function vT(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Bs(n.index,e):e;0==(32&e[2])&&q_(a);let l=YF(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=YF(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function cr(n=1){return function(n){return(Ln.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Ln.lFrame.contextLView))[8]}(n)}function rL(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Dn(s):jl(s),l=!1;for(;0!==a&&(!1===l||o);){const d=n[a+1];CW(n[a],e)&&(l=!0,n[a+1]=i?P_(d):br(d)),a=i?Dn(d):jl(d)}l&&(n[t+1]=i?br(s):P_(s))}function CW(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Ss(n,e)>=0}const As={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function sL(n){return n.substring(As.key,As.keyEnd)}function oL(n,e){const t=As.textEnd;return t===e?-1:(e=As.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,As.key=e,t),Zp(n,e,t))}function Zp(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function xu(n){!function(n,e,t,i){const r=fi(),s=function(n){const e=Ln.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);r.firstUpdatePass&&function(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Xs()],o=dL(n,t);mL(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=function(n){const e=Ln.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=hy(t=wT(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=wT(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==jl(i))return n[Dn(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=wT(null,n,e,l[1],i),l=hy(l,e.attrs,i),function(n,e,t,i){n[Dn(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=hy(i,n[s].hostAttrs,t);return hy(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Dn(o),l=jl(o);n[i]=t;let d,c=!1;if(Array.isArray(t)){const f=t;d=f[1],(null===d||Ss(f,d)>0)&&(c=!0)}else d=t;if(r)if(0!==l){const p=Dn(n[a+1]);n[i+1]=al(p,a),0!==p&&(n[p+1]=ll(n[p+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=al(a,0),0!==a&&(n[a+1]=ll(n[a+1],i)),a=i;else n[i+1]=al(l,0),0===a?a=i:n[l+1]=ll(n[l+1],i),l=i;c&&(n[i+1]=br(n[i+1])),rL(n,d,i,!0),rL(n,d,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Ss(s,e)>=0&&(t[i+1]=P_(t[i+1]))}(e,d,n,i,s),o=al(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(r,null,s,i);const o=Ft();if(t!==Cn&&go(o,s,t)){const a=r.data[Xs()];if(mL(a,i)&&!dL(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=ot(l,t||"")),yT(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===Cn&&(r=Wi);let l=0,c=0,d=0<r.length?r[0]:null,f=0<s.length?s[0]:null;for(;null!==d||null!==f;){const p=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let x,_=null;d===f?(l+=2,c+=2,p!==g&&(_=f,x=g)):null===f||null!==d&&d<f?(l+=2,_=d):(c+=2,_=f,x=g),null!==_&&pL(n,e,t,i,_,x,o,a),d=l<r.length?r[l]:null,f=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return Wi;const i=[],r=function(n){return n instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(Do,Oc,n,!0)}function Oc(n,e){for(let t=function(n){return function(n){As.key=0,As.keyEnd=0,As.value=0,As.valueEnd=0,As.textEnd=n.length}(n),oL(n,Zp(n,0,As.textEnd))}(e);t>=0;t=oL(e,t))Do(n,sL(e),!0)}function dL(n,e){return e>=n.expandoStartIndex}function wT(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=hy(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function hy(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Do(n,o,!!t||e[++s]))}return void 0===n?null:n}function pL(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];Ew(function(n){return 1==(1&n)}(c)?gL(l,e,t,r,jl(c),o):void 0)||(Ew(s)||function(n){return 2==(2&n)}(c)&&(s=gL(l,null,t,r,a,o)),function(n,e,t,i,r){const s=or(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Ro.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Ro.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,function(n,e){return vr(e[n])}(Xs(),t),r,s))}function gL(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),d=c?l[1]:l,f=null===d;let p=t[r+1];p===Cn&&(p=f?Wi:void 0);let g=f?Jm(p,i):d===i?p:void 0;if(c&&!Ew(g)&&(g=Jm(l,i)),Ew(g)&&(a=g,o))return a;const _=n[r+1];r=o?Dn(_):jl(_)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Jm(l,i))}return a}function Ew(n){return void 0!==n}function mL(n,e){return 0!=(n.flags&(e?16:32))}const Zh=void 0;var s9=["en",[["a","p"],["AM","PM"],Zh],[["AM","PM"],Zh,Zh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Zh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Zh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Zh,"{1} 'at' {0}",Zh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let Jp={};function PL(n){return n in Jp||(Jp[n]=ti.ng&&ti.ng.common&&ti.ng.common.locales&&ti.ng.common.locales[n]),Jp[n]}var rn=(()=>((rn=rn||{})[rn.LocaleId=0]="LocaleId",rn[rn.DayPeriodsFormat=1]="DayPeriodsFormat",rn[rn.DayPeriodsStandalone=2]="DayPeriodsStandalone",rn[rn.DaysFormat=3]="DaysFormat",rn[rn.DaysStandalone=4]="DaysStandalone",rn[rn.MonthsFormat=5]="MonthsFormat",rn[rn.MonthsStandalone=6]="MonthsStandalone",rn[rn.Eras=7]="Eras",rn[rn.FirstDayOfWeek=8]="FirstDayOfWeek",rn[rn.WeekendRange=9]="WeekendRange",rn[rn.DateFormat=10]="DateFormat",rn[rn.TimeFormat=11]="TimeFormat",rn[rn.DateTimeFormat=12]="DateTimeFormat",rn[rn.NumberSymbols=13]="NumberSymbols",rn[rn.NumberFormats=14]="NumberFormats",rn[rn.CurrencyCode=15]="CurrencyCode",rn[rn.CurrencySymbol=16]="CurrencySymbol",rn[rn.CurrencyName=17]="CurrencyName",rn[rn.Currencies=18]="Currencies",rn[rn.Directionality=19]="Directionality",rn[rn.PluralCase=20]="PluralCase",rn[rn.ExtraData=21]="ExtraData",rn))();const xw="en-US";let FL=xw;function ST(n){Z(n,"Expected localeId to be defined"),"string"==typeof n&&(FL=n.toLowerCase().replace(/_/g,"-"))}class a2{}const c2="ngComponent";class sq{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${rt(n)}. Did you add it to @NgModule.entryComponents?`);return e[c2]=n,e}(e)}}class fl{}function Mw(...n){}function tg(n,e){return new An(Ys(n,e))}fl.NULL=new sq;const lq=function(){return tg(ts(),Ft())};let An=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=lq,n})();function u2(n){return n instanceof An?n.nativeElement:n}class Jh{}let RT=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>null}),n})();class Au{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const d2=new Au("12.2.5");class h2{constructor(){}supports(e){return ly(e)}create(e){return new pq(e)}}const fq=(n,e)=>e;class pq{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||fq}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<p2(i,r,s)?t:i,a=p2(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,d=l-r;if(c!=d){for(let p=0;p<c;p++){const g=p<s.length?s[p]:s[p]=0,_=g+p;d<=_&&_<c&&(s[p]=g+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!ly(e))throw new Error(`Error trying to diff '${rt(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[jp()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new gq(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new f2),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new f2),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class gq{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class mq{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class f2{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new mq,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function p2(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class g2{constructor(){}supports(e){return e instanceof Map||fT(e)}create(){return new _q}}class _q{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||fT(e)))throw new Error(`Error trying to diff '${rt(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new yq(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class yq{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function m2(){return new ng([new h2])}let ng=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||m2()),deps:[[n,new il,new Yr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:m2}),n})();function _2(){return new ig([new g2])}let ig=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||_2()),deps:[[n,new il,new Yr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:_2}),n})();function Iw(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(vr(s)),Go(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Iw(l[1],l,c,i)}const o=t.type;if(8&o)Iw(n,e,t.child,i);else if(32&o){const a=E_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Tb(e,t);if(Array.isArray(a))i.push(...a);else{const l=zh(e[16]);Iw(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class _y{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Iw(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Go(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(T_(e,i),Pl(t,i))}this._attachedToViewContainer=!1}D_(this._lView[1],this._lView)}onDestroy(e){Kb(this._lView[1],this._lView,null,e)}markForCheck(){q_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Y_(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){Qf(!0);try{Y_(n,e,t)}finally{Qf(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){Od(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class bq extends _y{constructor(e){super(e),this._view=e}detectChanges(){rw(this._view)}checkNoChanges(){!function(n){Qf(!0);try{rw(n)}finally{Qf(!1)}}(this._view)}get context(){return null}}const Eq=function(n){return function(n,e,t){if(ld(n)&&!t){const i=Bs(n.index,e);return new _y(i,i)}return 47&n.type?new _y(e[16],e):null}(ts(),Ft(),16==(16&n))};let is=(()=>{class n{}return n.__NG_ELEMENT_ID__=Eq,n})();const Cq=[new g2],Tq=new ng([new h2]),Dq=new ig(Cq),Iq=function(){return Rw(ts(),Ft())};let Po=(()=>{class n{}return n.__NG_ELEMENT_ID__=Iq,n})();const Rq=Po,Oq=class extends Rq{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Wh(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),qh(t,i,e),new _y(i)}};function Rw(n,e){return 4&n.type?new Oq(e,n,tg(n,e)):null}class Nc{}const Fq=function(){return w2(ts(),Ft())};let Ts=(()=>{class n{}return n.__NG_ELEMENT_ID__=Fq,n})();const kq=Ts,v2=class extends kq{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return tg(this._hostTNode,this._hostLView)}get injector(){return new Wo(this._hostTNode,this._hostLView)}get parentInjector(){const e=Rh(this._hostTNode,this._hostLView);if(Dv(e)){const t=Ja(e,this._hostLView),i=pd(e);return new Wo(t[1].data[i+8],t)}return new Wo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=b2(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(Nc,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return Go(n[3])}(i)){const d=this.indexOf(e);if(-1!==d)this.detach(d);else{const f=i[3],p=new v2(f,f[6],f[3]);p.detach(p.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Fh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Mp(s,o),l=i[11],c=Tp(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,Od(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Fh(OT(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=b2(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=T_(this._lContainer,t);i&&(Pl(OT(this._lContainer),t),D_(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=T_(this._lContainer,t);return i&&null!=Pl(OT(this._lContainer),t)?new _y(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function b2(n){return n[8]}function OT(n){return n[8]||(n[8]=[])}function w2(n,e){let t;const i=e[n.index];if(Go(i))t=i;else{let r;if(8&n.type)r=vr(i);else{const s=e[11];r=s.createComment("");const o=Ys(n,e);ol(s,Tp(s,o),r,function(n,e){return or(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=iw(i,e,r,n),Lp(e,t)}return new v2(t,n,e)}const ag={};class U2 extends fl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Mi(e);return new H2(t,this.ngModule)}}function z2(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const NK=new Vt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>db});class H2 extends a2{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map(g1).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return z2(this.componentDef.inputs)}get outputs(){return z2(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,ag,r);return s!==ag||i===ag?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(Jh,au),a=s.get(RT,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",d=i?function(n,e,t){if(or(n))return n.selectRootElement(e,t===Ht.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):A_(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),f=this.componentDef.onPush?576:528,p=function(n,e){return{components:[],scheduler:n||db,clean:X1,playerHandler:e||null,flags:0}}(),g=Fp(0,null,null,1,0,null,null,null,null,null),_=Wh(null,g,p,f,null,null,o,l,a,s);let x,A;Th(_);try{const W=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=Pd(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(Bp(l,c,!0),null!==n&&(ip(r,n,c),null!==l.classes&&O_(r,n,l.classes),null!==l.styles&&Ib(r,n,l.styles)));const d=i.createRenderer(n,e),f=Wh(t,Pp(e),null,e.onPush?64:16,t[20],l,i,d,s||null,null);return o.firstCreatePass&&(yc(js(l,t),o,e.type),nw(o,l),H_(l,t.length,1)),Lp(t,f),t[20]=f}(d,this.componentDef,_,o,l);if(d)if(i)ip(l,d,["ng-version",d2.full]);else{const{attrs:G,classes:ge}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ca(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);G&&ip(l,d,G),ge&&ge.length>0&&O_(l,d,ge.join(" "))}if(A=Pm(g,20),void 0!==t){const G=A.projection=[];for(let ge=0;ge<this.ngContentSelectors.length;ge++){const Ne=t[ge];G.push(null!=Ne?Array.from(Ne):null)}}x=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=ts();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),G_(n,i,e,Fd(n,e,1,null),t));const r=_d(e,n,i.directiveStart,i);xs(r,e);const s=Ys(i,e);return s&&xs(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=ts();e.contentQueries(1,o,l.directiveStart)}const a=ts();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(uo(a.index),ew(t[1],a,0,a.directiveStart,a.directiveEnd,e),tw(e,o)),o}(W,this.componentDef,_,p,[B7]),qh(g,_,null)}finally{oi()}return new LK(this.componentType,x,tg(A,_),_,A)}}class LK extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new bq(r),this.componentType=e}get injector(){return new Wo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const lg=new Map;class jK extends Nc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new U2(this);const i=xo(e),r=function(n){return n[DC]||null}(e);r&&ST(r),this._bootstrapComponents=sl(i.bootstrap),this._r3Injector=lw(e,t,[{provide:Nc,useValue:this},{provide:fl,useValue:this.componentFactoryResolver}],rt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Hn.THROW_IF_NOT_FOUND,i=yn.Default){return e===Hn||e===Nc||e===Bd?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class $T extends class{}{constructor(e){super(),this.moduleType=e,null!==xo(e)&&function(n){const e=new Set;!function t(i){const r=xo(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${rt(e)} vs ${rt(e.name)}`)}(s,lg.get(s),i),lg.set(s,i));const o=sl(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new jK(this.moduleType,e)}}function W2(n,e,t,i,r,s){const o=e+t;return go(n,o,r)?function(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===Cn?void 0:t}(n,o+1)}function Ty(n,e,t){const i=n+20,r=Ft(),s=function(n,e){return n[e]}(r,i);return function(n,e){zl.isWrapped(e)&&(e=zl.unwrap(e),n[Ln.lFrame.bindingIndex]=Cn);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?W2(r,function(){const n=Ln.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),e,s.transform,t,s):s.transform(t))}function WT(n){return e=>{setTimeout(n,void 0,e)}}const cn=class extends ee{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const f=e;a=null===(r=f.next)||void 0===r?void 0:r.bind(f),l=null===(s=f.error)||void 0===s?void 0:s.bind(f),c=null===(o=f.complete)||void 0===o?void 0:o.bind(f)}this.__isAsync&&(l=WT(l),a&&(a=WT(a)),c&&(c=WT(c)));const d=super.subscribe({next:a,error:l,complete:c});return e instanceof S&&e.add(d),d}};function nY(){return this._results[jp()]()}class nf{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=jp(),i=nf.prototype;i[t]||(i[t]=nY)}get changes(){return this._changes||(this._changes=new cn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=qo(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class qT{constructor(e){this.queryList=e,this.matches=null}clone(){return new qT(this.queryList)}setDirty(){this.queryList.setDirty()}}class KT{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new KT(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==tk(e,t).matches&&this.queries[t].setDirty()}}class Q2{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class XT{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new XT(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class QT{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new QT(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,sY(t,s)),this.matchTNodeWithReadOption(e,t,md(t,e,s,!1,!1))}else i===Po?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,md(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===An||r===Ts||r===Po&&4&t.type)this.addMatch(t.index,-2);else{const s=md(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function sY(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function aY(n,e,t,i){return-1===t?function(n,e){return 11&n.type?tg(n,e):4&n.type?Rw(n,e):null}(e,n):-2===t?function(n,e,t){return t===An?tg(e,n):t===Po?Rw(e,n):t===Ts?w2(e,n):void 0}(n,e,i):_d(n,n[1],t,e)}function Z2(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:aY(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function ZT(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=Z2(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let f=10;f<d.length;f++){const p=d[f];p[17]===p[3]&&ZT(p[1],p,c,i)}if(null!==d[9]){const f=d[9];for(let p=0;p<f.length;p++){const g=f[p];ZT(g[1],g,c,i)}}}}}return i}function Ai(n){const e=Ft(),t=fi(),i=Av();jm(i+1);const r=tk(t,i);if(n.dirty&&Ol(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?ZT(t,e,i,[]):Z2(t,e,r,i);n.reset(s,u2),n.notifyOnChanges()}return!0}return!1}function Ds(n,e,t){const i=fi();i.firstCreatePass&&(function(n,e,t){null===n.queries&&(n.queries=new XT),n.queries.track(new QT(e,t))}(i,new Q2(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function(n,e,t){const i=new nf(4==(4&t));Kb(n,e,i,i.destroy),null===e[19]&&(e[19]=new KT),e[19].queries.push(new qT(i))}(i,Ft(),e)}function Ti(){return function(n,e){return n[19].queries[e].queryList}(Ft(),Av())}function tk(n,e){return n.queries.getByIndex(e)}const rf=new Vt("Application Initializer");let ug=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Mw,this.reject=Mw,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(uy(s))t.push(s);else if(vw(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Ie(rf,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Ry=new Vt("AppId"),BY={provide:Ry,useFactory:function(){return`${rD()}${rD()}${rD()}`},deps:[]};function rD(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const vk=new Vt("Platform Initializer"),Pc=new Vt("Platform ID"),Bw=new Vt("appBootstrapListener");let jw=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Tu=new Vt("LocaleId"),bk=new Vt("DefaultCurrencyCode");class VY{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const sD=function(n){return new $T(n)},UY=sD,zY=function(n){return Promise.resolve(sD(n))},wk=function(n){const e=sD(n),i=sl(xo(n).declarations).reduce((r,s)=>{const o=Mi(s);return o&&r.push(new H2(o)),r},[]);return new VY(e,i)},HY=wk,GY=function(n){return Promise.resolve(wk(n))};let sf=(()=>{class n{constructor(){this.compileModuleSync=UY,this.compileModuleAsync=zY,this.compileModuleAndAllComponentsSync=HY,this.compileModuleAndAllComponentsAsync=GY}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Ek=new Vt("compilerOptions"),WY=(()=>Promise.resolve(0))();function oD(n){"undefined"==typeof Zone?WY.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class mn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cn(!1),this.onMicrotaskEmpty=new cn(!1),this.onStable=new cn(!1),this.onError=new cn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=ti.requestAnimationFrame,e=ti.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ti,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,lD(n),n.isCheckStableRunning=!0,aD(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),lD(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return Sk(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),xk(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return Sk(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),xk(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,lD(n),aD(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!mn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(mn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,KY,Mw,Mw);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const KY={};function aD(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function lD(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Sk(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function xk(n){n._nesting--,aD(n)}class QY{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cn,this.onMicrotaskEmpty=new cn,this.onStable=new cn,this.onError=new cn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let cD=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{mn.assertNotInAngularZone(),oD(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())oD(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Ie(mn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Ck=(()=>{class n{constructor(){this._applications=new Map,uD.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return uD.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class ZY{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let uD=new ZY,Ak=!0,Tk=!1;function Ma(){return Tk=!0,Ak}let Kl;const Dk=new Vt("AllowMultipleToken");function Mk(n,e,t=[]){const i=`Platform: ${e}`,r=new Vt(i);return(s=[])=>{let o=hD();if(!o||o.injector.get(Dk,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:Eu,useValue:"platform"});!function(n){if(Kl&&!Kl.destroyed&&!Kl.injector.get(Dk,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Kl=n.get(Ik);const e=n.get(vk,null);e&&e.forEach(t=>t())}(Hn.create({providers:a,name:i}))}return function(n){const e=hD();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function hD(){return Kl&&!Kl.destroyed?Kl:null}let Ik=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new QY:("zone.js"===n?void 0:n)||new mn({enableLongStackTrace:Ma(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:mn,useValue:a}];return a.run(()=>{const c=Hn.create({providers:l,parent:this.injector,name:t.moduleType.name}),d=t.create(c),f=d.injector.get(Zo,null);if(!f)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const p=a.onError.subscribe({next:g=>{f.handleError(g)}});d.onDestroy(()=>{fD(this._modules,d),p.unsubscribe()})}),function(n,e,t){try{const i=t();return uy(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(f,a,()=>{const p=d.injector.get(ug);return p.runInitializers(),p.donePromise.then(()=>(ST(d.injector.get(Tu,xw)||xw),this._moduleDoBootstrap(d),d))})})}bootstrapModule(t,i=[]){const r=Rk({},i);return function(n,e,t){const i=new $T(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(zd);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${rt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function Rk(n,e){return Array.isArray(e)?e.reduce(Rk,n):Object.assign(Object.assign({},n),e)}let zd=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new F(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new F(c=>{let d;this._zone.runOutsideAngular(()=>{d=this._zone.onStable.subscribe(()=>{mn.assertNotInAngularZone(),oD(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const f=this._zone.onUnstable.subscribe(()=>{mn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{d.unsubscribe(),f.unsubscribe()}});this.isStable=Pn(a,l.pipe(ms()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof a2?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Nc),a=r.create(Hn.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(cD,null),d=c&&a.injector.get(Ck);return c&&d&&d.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),fD(this.components,a),d&&d.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;fD(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Bw,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Ie(mn),Ie(Hn),Ie(Zo),Ie(fl),Ie(ug))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function fD(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const CX=Mk(null,"core",[{provide:Pc,useValue:"unknown"},{provide:Ik,deps:[Hn]},{provide:Ck,deps:[]},{provide:jw,deps:[]}]),IX=[{provide:zd,useClass:zd,deps:[mn,Hn,Zo,fl,ug]},{provide:NK,deps:[mn],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:ug,useClass:ug,deps:[[new Yr,rf]]},{provide:sf,useClass:sf,deps:[]},BY,{provide:ng,useFactory:function(){return Tq},deps:[]},{provide:ig,useFactory:function(){return Dq},deps:[]},{provide:Tu,useFactory:function(n){return ST(n=n||"undefined"!=typeof $localize&&$localize.locale||xw),n},deps:[[new xd(Tu),new Yr,new il]]},{provide:bk,useValue:"USD"}];let OX=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Ie(zd))},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({providers:IX}),n})(),Qw=null;function Fc(){return Qw}const ln=new Vt("DocumentToken");let lf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:RQ,token:n,providedIn:"platform"}),n})();function RQ(){return Ie(o3)}let o3=(()=>{class n extends lf{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Fc().getBaseHref(this._doc)}onPopState(t){const i=Fc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Fc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){a3()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){a3()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Ie(ln))},n.\u0275prov=We({factory:NQ,token:n,providedIn:"platform"}),n})();function a3(){return!!window.history.pushState}function NQ(){return new o3(Ie(ln))}function Mu(n){return n&&"?"!==n[0]?"?"+n:n}let cf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:PQ,token:n,providedIn:"root"}),n})();function PQ(n){const e=Ie(ln).location;return new c3(Ie(lf),e&&e.origin||"")}const MD=new Vt("appBaseHref");let c3=(()=>{class n extends cf{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return function(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Mu(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Mu(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Mu(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(lf),Ie(MD,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();var ds=(()=>((ds=ds||{})[ds.Zero=0]="Zero",ds[ds.One=1]="One",ds[ds.Two=2]="Two",ds[ds.Few=3]="Few",ds[ds.Many=4]="Many",ds[ds.Other=5]="Other",ds))();const GQ=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=PL(e);if(t)return t;const i=e.split("-")[0];if(t=PL(i),t)return t;if("en"===i)return s9;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[rn.PluralCase]};class aE{}let vZ=(()=>{class n extends aE{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(GQ(i||this.locale)(t)){case ds.Zero:return"zero";case ds.One:return"one";case ds.Two:return"two";case ds.Few:return"few";case ds.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Tu))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();let Ru=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new SZ,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){w3("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){w3("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(Ts),De(Po))},n.\u0275dir=Lt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class SZ{constructor(){this.$implicit=null,this.ngIf=null}}function w3(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${rt(e)}'.`)}class TZ{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class DZ{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const MZ=new DZ,IZ=new TZ;let cE=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(uy(t))return MZ;if(qF(t))return IZ;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${rt(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(De(is,16))},n.\u0275pipe=Ls({name:"async",type:n,pure:!1}),n})(),Ws=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({providers:[{provide:aE,useClass:vZ}]}),n})();const T3="browser";class zD extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){Qw||(Qw=n)}(new zD)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(By=By||document.querySelector("base"),By?By.getAttribute("href"):null);return null==t?null:function(n){uE=uE||document.createElement("a"),uE.setAttribute("href",n);const e=uE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){By=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let uE,By=null;const R3=new Vt("TRANSITION_ID"),tJ=[{provide:rf,useFactory:function(n,e,t){return()=>{t.get(ug).donePromise.then(()=>{const i=Fc(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[R3,ln,Hn],multi:!0}];class HD{static init(){!function(n){uD=n}(new HD)}addToWindow(e){ti.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},ti.getAllAngularTestabilities=()=>e.getAllTestabilities(),ti.getAllAngularRootElements=()=>e.getAllRootElements(),ti.frameworkStabilizers||(ti.frameworkStabilizers=[]),ti.frameworkStabilizers.push(i=>{const r=ti.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Fc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let nJ=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const jy=new Vt("EventManagerPlugins");let hE=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Ie(jy),Ie(mn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class GD{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Fc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let N3=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Vy=(()=>{class n extends N3{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(P3),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(P3))}}return n.\u0275fac=function(t){return new(t||n)(Ie(ln))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function P3(n){Fc().remove(n)}const $D={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},WD=/%COMP%/g;function fE(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?fE(n,r,t):(r=r.replace(WD,n),t.push(r))}return t}function k3(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let pE=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new qD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Ht.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new _J(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Ht.ShadowDom:return new yJ(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=fE(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Ie(hE),Ie(Vy),Ie(Ry))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class qD{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS($D[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=$D[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=$D[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Ro.DashCase|Ro.Important)?e.style.setProperty(t,i,r&Ro.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Ro.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,k3(i)):this.eventManager.addEventListener(e,t,k3(i))}}class _J extends qD{constructor(e,t,i,r){super(e),this.component=i;const s=fE(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(WD,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(WD,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class yJ extends qD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=fE(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let vJ=(()=>{class n extends GD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Ie(ln))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const V3=["alt","control","meta","shift"],AJ={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},U3={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},TJ={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let DJ=(()=>{class n extends GD{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Fc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(V3.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&U3.hasOwnProperty(e)&&(e=U3[e]))}return AJ[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),V3.forEach(s=>{s!=r&&TJ[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(Ie(ln))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const LJ=Mk(CX,"browser",[{provide:Pc,useValue:T3},{provide:vk,useValue:function(){zD.makeCurrent(),HD.init()},multi:!0},{provide:ln,useFactory:function(){return function(n){Bi=n}(document),document},deps:[]}]),kJ=[[],{provide:Eu,useValue:"root"},{provide:Zo,useFactory:function(){return new Zo},deps:[]},{provide:jy,useClass:vJ,multi:!0,deps:[ln,mn,Pc]},{provide:jy,useClass:DJ,multi:!0,deps:[ln]},[],{provide:pE,useClass:pE,deps:[hE,Vy,Ry]},{provide:Jh,useExisting:pE},{provide:N3,useExisting:Vy},{provide:Vy,useClass:Vy,deps:[ln]},{provide:cD,useClass:cD,deps:[mn]},{provide:hE,useClass:hE,deps:[jy,mn]},{provide:class{},useClass:nJ,deps:[]},[]];let XD=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:Ry,useValue:t.appId},{provide:R3,useExisting:Ry},tJ]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12))},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({providers:kJ,imports:[Ws,OX]}),n})();"undefined"!=typeof window&&window;class $J extends S{constructor(e,t){super()}schedule(e,t=0){return this}}class gE extends $J{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let H3=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class Jl extends H3{constructor(e,t=H3.now){super(e,()=>Jl.delegate&&Jl.delegate!==this?Jl.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return Jl.delegate&&Jl.delegate!==this?Jl.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const KJ=new class extends Jl{}(class extends gE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),Lc=new F(n=>n.complete());function mE(n){return n?function(n){return new F(e=>n.schedule(()=>e.complete()))}(n):Lc}function an(...n){let e=n[n.length-1];return Te(e)?(n.pop(),Be(n,e)):Tn(n)}function gg(n,e){return new F(e?t=>e.schedule(XJ,0,{error:n,subscriber:t}):t=>t.error(n))}function XJ({error:n,subscriber:e}){e.error(n)}class ra{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return an(this.value);case"E":return gg(this.error);case"C":return mE()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new ra("N",e):ra.undefinedValueNotification}static createError(e){return new ra("E",void 0,e)}static createComplete(){return ra.completeNotification}}ra.completeNotification=new ra("C"),ra.undefinedValueNotification=new ra("N",void 0);class _E extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(_E.dispatch,this.delay,new ZJ(e,this.destination)))}_next(e){this.scheduleMessage(ra.createNext(e))}_error(e){this.scheduleMessage(ra.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(ra.createComplete()),this.unsubscribe()}}class ZJ{constructor(e,t){this.notification=e,this.destination=t}}class mg extends ee{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new JJ(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new U;if(this.isStopped||this.hasError?o=S.EMPTY:(this.observers.push(e),o=new ie(this,e)),r&&e.add(e=new _E(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||KJ).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class JJ{constructor(e,t){this.time=e,this.value=t}}function Ur(n,e){return"function"==typeof e?t=>t.pipe(Ur((i,r)=>Pe(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new eee(n))}class eee{constructor(e){this.project=e}call(e,t){return t.subscribe(new tee(e,this.project))}}class tee extends fe{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new wt(this),r=this.destination;r.add(i),this.innerSubscription=R(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const yE={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return yE.schedule(n,0);if(void 0===window.requestAnimationFrame)return yE.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let ZD;function dee(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!ZD){const t=Element.prototype;ZD=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&ZD.call(n,e)}(n,r)||(i=s,0))),i}class fee{constructor(e,t){this.componentFactory=t.get(fl).resolveComponentFactory(e)}create(e){return new pee(this.componentFactory,e)}}class pee{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new mg(1),this.events=this.eventEmitters.pipe(Ur(i=>Pn(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(mn),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=yE.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=Hn.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=dee(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(is),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(zd).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(me(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=yE.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new Rm(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class gee extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}const _ee={initialConfig:{},parse:{},rename:{}};class yee{constructor(e,t){this.configState=e,this.storedChanges={},this.options=Object.assign(Object.assign({},_ee),t)}addChanges(e){this.storedChanges=Object.assign(Object.assign({},this.storedChanges),e)}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,s=i.snapshot,o=Object.assign(Object.assign(Object.assign({},r),s),t);for(const[a,l]of Object.entries(e))this.processChange(a,l,o);i.setConfig(o)}processChange(e,t,i){var r,s;const{options:{parse:o,rename:a}}=this,l=null!==(r=a[e])&&void 0!==r?r:e,c=t.currentValue,d=null!==(s=o[e])&&void 0!==s?s:o[l];if(null==c)delete i[l];else if(d)try{i[l]=d(c)}catch(f){console.warn(`Failed to parse ${e} = ${c}`,f.message)}else i[l]=c}}let vee=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new yee(this.configState,this.options)}ngOnInit(){var t;this._init=setTimeout(()=>this.initialize(),null!==(t=this.options.initialDelay)&&void 0!==t?t:0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}}return n.\u0275fac=function(t){!function(){throw new Error("invalid")}()},n.\u0275dir=Lt({type:n,features:[qi]}),n})();var JD;const Uy={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],organNodes:["http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0002049"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org",hubmapToken:null!==(JD=localStorage.getItem("HUBMAP_TOKEN"))&&void 0!==JD?JD:""},googleAnalyticsToken:"portal.hubmapconsortium.org"===window.location.hostname?"G-1WRJHN9FM6":"G-J9HWV9QPJ4"};function Ia(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function $3(n,e){return function(t,i){e(t,i,n)}}function ec(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function Yi(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(d){try{c(i.next(d))}catch(f){o(f)}}function l(d){try{c(i.throw(d))}catch(f){o(f)}}function c(d){d.done?s(d.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function K3(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function tM(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||K3()}const Y3="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",bE=tM();class See{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function nM(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const X3={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Q3(n){return"string"==typeof n?X3[n.toUpperCase()]||X3.WHITE:n}function wE(n,e){if(!n)throw new Error(e||"Assertion failed")}const tc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},zy=tc.window||tc.self||tc.global,Z3=tc.process||{};function _g(){let n;if(bE&&zy.performance)n=zy.performance.now();else if(Z3.hrtime){const e=Z3.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const yg={debug:bE&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Iee={enabled:!0,level:0};function yl(){}const J3={},eB={once:!0};function Ree(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let iM=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=Y3,this._startTs=_g(),this._deltaTs=_g(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new See("__probe-".concat(this.id,"__"),Iee),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((_g()-this._startTs).toPrecision(10))}getDelta(){return Number((_g()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){wE(t,i)}warn(t){return this._getLogFunction(0,t,yg.warn,arguments,eB)}error(t){return this._getLogFunction(0,t,yg.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,yg.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,yg.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,yg.debug||yg.info,arguments,eB)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||yl,r&&[r],{tag:Ree(i)}):yl}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?bE?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=nM(r,e,t);console.log(...s)},r.src=n,yl}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...nM(n,e,t)),yl;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...nM(r,e,t)),r.src=n.toDataURL(),yl}return yl}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=tt(307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):yl}({image:r,message:s,scale:o}):yl}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||yl)}group(t,i,r={collapsed:!1}){r=nB({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||yl)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=tB(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=nB({logLevel:t,message:i,args:s,opts:o}),wE(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=_g();const a=o.tag||o.message;if(o.once){if(J3[a])return yl;J3[a]=_g()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!bE&&"string"==typeof n&&(e&&(e=Q3(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=Q3(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return yl}}return n.VERSION=Y3,n})();function tB(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return wE(Number.isFinite(e)&&e>=0),e}function nB(n){const{logLevel:e,message:t}=n;n.logLevel=tB(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return wE("string"===r||"object"===r),Object.assign(n,n.opts)}const Oi=new iM({id:"deck"}),Di={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Di,"IDENTITY",{get:()=>Oi.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const kc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},iB={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},un=new iM({id:"luma.gl"});function ko(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function EE(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function pi(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function SE(n){return ko(EE(n),"Invalid WebGLRenderingContext"),n}function Bo(n){return ko(pi(n),"Requires WebGL2"),n}var Sr=tt(761);const Hy={};const Gy=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(Gy.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const hf=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(Hy[i]=!0)}while(0!==i);for(i in Hy)if(Hy[i])return delete Hy[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,d){const f=t.currentVertexArrayObject;f.maxAttrib=Math.max(f.maxAttrib,s);const p=f.attribs[s];return p.buffer=t.currentArrayBuffer,p.size=o,p.type=a,p.normalized=l,p.stride=c,p.offset=d,p.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{Sr.CO.console&&Sr.CO.console.log&&Sr.CO.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};hf.prototype.VERTEX_ARRAY_BINDING_OES=34229,hf.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new Gy(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},hf.prototype.createVertexArrayOES=function(){const e=new Gy(this);return this.vertexArrayObjects.push(e),e},hf.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},hf.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Gy&&e.hasBeenBound&&e.ext===this)},hf.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){Hy[n]=!0,void 0!==e&&function(n){Sr.CO.console&&Sr.CO.console.error&&Sr.CO.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],d=r?r.attribs[l]:null;if((!r||c.enabled!==d.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let f=!1;(!r||c.buffer!==d.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),f=!0),(f||c.cached!==d.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const rB="OES_element_index",sB="WEBGL_draw_buffers",oB="WEBGL_debug_renderer_info",fr=n=>pi(n)?void 0:0,Zee={3074:n=>pi(n)?void 0:36064,35723:n=>pi(n)?void 0:4352,35977:fr,32937:fr,36795:(n,e)=>{const t=pi(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(oB);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(oB);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:fr,35071:fr,37447:fr,36063:(n,e)=>{if(!pi(n)){const t=n.getExtension(sB);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:fr,35374:fr,35377:fr,34852:n=>{if(!pi(n)){const e=n.getExtension(sB);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(rB)?2147483647:65535,33001:n=>n.getExtension(rB)?16777216:65535,33e3:n=>16777216,37157:fr,35373:fr,35657:fr,36183:fr,37137:fr,34045:fr,35978:fr,35979:fr,35968:fr,35376:fr,35375:fr,35659:fr,37154:fr,35371:fr,35658:fr,35076:fr,35077:fr,35380:fr},aB="ANGLE_instanced_arrays",lB={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{ko(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[aB]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){ko(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{ko(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{ko(!1)},deleteQuery:()=>{ko(!1)},beginQuery:()=>{ko(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},rM={readBuffer:(n,e,t)=>{pi(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:pi(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!pi(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!pi(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=Zee[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function dte(n,{extension:e,target:t,target2:i}){const r=lB[e];ko(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let d=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?d=(...f)=>a[c](...f):"function"==typeof r[l]&&(d=r[l].bind(t))),d&&(t[l]=d,i[l]=d)}}("undefined"!=typeof global?global:window).polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new hf(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&dte(n,{extension:t,target:n.luma,target2:n})}(n,lB),function(n,{target:e,target2:t}){Object.keys(rM).forEach(i=>{if("function"==typeof rM[i]){const r=n[i]?n[i].bind(n):()=>{},s=rM[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const sM={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},$d=(n,e,t)=>e?n.enable(t):n.disable(t),cB=(n,e,t)=>n.hint(t,e),Ra=(n,e,t)=>n.pixelStorei(t,e);function $y(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const pte={3042:$d,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:$d,2885:(n,e)=>n.cullFace(e),2929:$d,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:$d,35723:cB,36006:(n,e)=>{const t=pi(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:cB,2849:(n,e)=>n.lineWidth(e),32823:$d,32824:"polygonOffset",10752:"polygonOffset",35977:$d,32938:"sampleCoverage",32939:"sampleCoverage",3089:$d,3088:(n,e)=>n.scissor(...e),2960:$d,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Ra,3317:Ra,37440:Ra,37441:Ra,37443:Ra,3330:Ra,3332:Ra,3331:Ra,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Ra,32878:Ra,3316:Ra,3315:Ra,32877:Ra,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=$y(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=$y(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=$y(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=$y(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=$y(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function Qr(n,e,t){return void 0!==e[n]?e[n]:t[n]}const gte={blendEquation:(n,e,t)=>n.blendEquationSeparate(Qr(32777,e,t),Qr(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(Qr(32969,e,t),Qr(32968,e,t),Qr(32971,e,t),Qr(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(Qr(32824,e,t),Qr(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(Qr(32938,e,t),Qr(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,Qr(2962,e,t),Qr(2967,e,t),Qr(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,Qr(34816,e,t),Qr(36003,e,t),Qr(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,Qr(2964,e,t),Qr(2965,e,t),Qr(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,Qr(34817,e,t),Qr(34818,e,t),Qr(34819,e,t))},uB={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Bc=(n,e)=>n.isEnabled(e),dB={3042:Bc,2884:Bc,2929:Bc,3024:Bc,32823:Bc,32926:Bc,32928:Bc,3089:Bc,2960:Bc,35977:Bc};function hB(n){for(const e in n)return!1;return!0}function mte(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function fB(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache||(n.state.cache[s]=t(...r)),n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function _te(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class vte{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||sM)){const r=e,s=dB[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=dB[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},sM),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){ko(this.stateStack.length>0),Ou(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){ko(void 0!==s);const o=e[s],a=this.cache[s];mte(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function pB(n,e={}){const{enable:t=!0,copyState:i}=e;if(ko(void 0!==i),!n.state){const r="undefined"!=typeof global?global:window,{polyfillContext:s}=r;s&&s(n),n.state=new vte(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const o in uB)_te(n,o,uB[o]);fB(n,"getParameter"),fB(n,"isEnabled")}return n.state.enable=t,n}function gB(n){ko(n.state),n.state.pop()}function Ou(n,e){if(ko(EE(n),"setParameters requires a WebGL context"),hB(e))return;const t={};for(const r in e){const s=Number(r),o=pte[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)gte[r](n,e,i)}function nc(n,e,t){if(hB(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||pB(n,{copyState:!1}),n.state.push()}(n),Ou(n,e),i)r=t(n),gB(n);else try{r=t(n)}finally{gB(n)}return r}function vg(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function oM(n,e,t=!0){return function(n,e,t,i,r){const s=mB(n[0],e,t);let o=_B(n[1],e,i,r),a=mB(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=_B(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,vg(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function mB(n,e,t){return Math.min(Math.round(n*e),t-1)}function _B(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const aM=(0,Sr.jU)(),Cte=aM&&"undefined"!=typeof document,yB={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function vB(n={}){ko(aM,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},yB,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(Cte&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=lM(r,n),function(n){const e=pi(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);un.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function lM(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},yB,e);const{manageState:t,debug:i}=e;return t&&pB(n,{copyState:!1,log:(...r)=>un.log(1,...r)()}),aM&&i&&(Sr.CO.makeDebugContext?(n=Sr.CO.makeDebugContext(n,e),un.level=Math.max(un.level,1)):un.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function bB(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class wB{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=bB(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(bB()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class cM{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof wB?e:new wB(t,i)),this.stats[t]}}const Wy="8.5.7",ff=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new cM({id:e})),this.stats.get(e)}};if(Sr.CO.luma&&Sr.CO.luma.VERSION!==Wy)throw new Error(`luma.gl - multiple VERSIONs detected: ${Sr.CO.luma.VERSION} vs 8.5.7`);function tn(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function uM(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return tn(void 0!==i,`Accessing undefined constant GL.${e}`),i}function Wd(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}Sr.CO.luma||((0,Sr.jU)()&&un.log(1,"luma.gl 8.5.7 - set luma.log.level=1 (or higher) to trace rendering")(),Sr.CO.luma=Sr.CO.luma||{VERSION:Wy,version:Wy,log:un,stats:ff,globals:{modules:{},nodeIO:{}}});const dM={};function jc(n="id"){return dM[n]=dM[n]||1,`${n}-${dM[n]++}`}function EB(n){return tn("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function bg(n){let e=!0;for(const t in n){e=!1;break}return e}function SB(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw un.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const wg="Resource subclass must define virtual methods";class Nu{constructor(e,t={}){SE(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||jc(this.constructor.name),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){tn(e=uM(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=pi(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=pi(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const f=i?Wd(this.gl,l):l;o[f]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[f]=Wd(this.gl,o[f]))}}return o}setParameter(e,t){tn(e=uM(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=pi(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=uM(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return SB(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(wg)}_deleteHandle(){throw new Error(wg)}_bindHandle(e){throw new Error(wg)}_getOptsFromHandle(){throw new Error(wg)}_getParameter(e,t){throw new Error(wg)}_setParameter(e,t){throw new Error(wg)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,t=ff.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this.constructor.name;ff.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this.constructor.name){const i=ff.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this.constructor.name){const t=ff.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function hM(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function qy(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function kte({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function fM(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&un.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&un.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];un.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const Bte={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},jte={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class sa{static getBytesPerElement(e){return qy(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return tn(e.size),qy(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new sa(...[Bte,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return sa.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return sa.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=fM("Accessor",e,jte)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const CB={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Vte={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:CB},Ute={removedProps:CB};class rr extends Nu{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/sa.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/sa.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=fM("Buffer",e,Vte),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=fM("Buffer",e,Ute))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new sa(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;tn(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(Bo(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return Bo(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){Bo(this.gl);const s=qy(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const d=Math.min(o,l);return tn((r=r||d)<=d),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(tn(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){tn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=hM(e);return tn(s),this.setAccessor(new sa(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){tn(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/qy(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new sa(this.accessor,{type:hM(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return un.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return un.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return un.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return un.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new sa(this.accessor,e),this}}const pM={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},AB={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},TB={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},Gte=[9729,9728],DB=Sr.CO.WebGLBuffer||function(){};class Eg extends Nu{static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=pM[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=pi(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=pM[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=jc("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(G=>this.initialize(Object.assign({},e,{pixels:G,data:G}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:d}=e;t||(t=r);let{width:f,height:p,dataFormat:g,type:_,compressed:x=!1,mipmaps:A=!0}=e;const{depth:W=0}=e;return({width:f,height:p,compressed:x,dataFormat:g,type:_}=this._deduceParameters({format:s,type:_,dataFormat:g,compressed:x,data:t,width:f,height:p})),this.width=f,this.height=p,this.depth=W,this.format=s,this.type=_,this.dataFormat=g,this.border=o,this.textureUnit=d,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),A&&this._isNPOT()&&(un.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),A=!1,this._updateForNPOT(l)),this.mipmaps=A,this.setImageData({data:t,width:f,height:p,depth:W,format:s,type:_,dataFormat:g,border:o,mipmaps:A,parameters:c,compressed:x}),A&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(un.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),nc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:d=this.type,width:f=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:_=!1}=e;c||(c=i),({type:d,dataFormat:g,compressed:_,width:f,height:p}=this._deduceParameters({format:s,type:d,dataFormat:g,compressed:_,data:c,width:f,height:p}));const{gl:x}=this;x.bindTexture(this.target,this.handle);let W,A=null;return({data:c,dataType:A}=this._getDataType({data:c,compressed:_})),nc(this.gl,l,()=>{switch(A){case"null":x.texImage2D(t,r,s,f,p,o,g,d,c);break;case"typed-array":x.texImage2D(t,r,s,f,p,o,g,d,c,a);break;case"buffer":W=Bo(x),W.bindBuffer(35052,c.handle||c),W.texImage2D(t,r,s,f,p,o,g,d,a),W.bindBuffer(35052,null);break;case"browser-object":pi(x)?x.texImage2D(t,r,s,f,p,o,g,d,c):x.texImage2D(t,r,s,g,d,c);break;case"compressed":for(const[G,ge]of c.entries())x.compressedTexImage2D(t,G,ge.format,ge.width,ge.height,o,ge.data);break;default:tn(!1,"Unknown image data type")}}),this._trackAllocatedMemory(c&&c.byteLength?c.byteLength:this.width*this.height*(AB[this.dataFormat]||4)*(TB[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:d=this.type,dataFormat:f=this.dataFormat,compressed:p=!1,offset:g=0,border:_=this.border,parameters:x={}}){if(({type:d,dataFormat:f,compressed:p,width:o,height:a}=this._deduceParameters({format:c,type:d,dataFormat:f,compressed:p,data:i,width:o,height:a})),tn(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const A=i;i=A.data,o=A.shape[0],a=A.shape[1]}i instanceof rr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),nc(this.gl,x,()=>{if(p)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,f,d,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,f,d,i,g);else if(i instanceof DB){const A=Bo(this.gl);A.bindBuffer(35052,i),A.texSubImage2D(e,l,r,s,o,a,f,d,g),A.bindBuffer(35052,null)}else pi(this.gl)?Bo(this.gl).texSubImage2D(e,l,r,s,o,a,f,d,i):this.gl.texSubImage2D(e,l,r,s,f,d,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return un.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof rr?{data:e.handle,dataType:"buffer"}:e instanceof DB?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=pM[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},tn(r,"Could not deduced texture size"),tn(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),tn(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:tn(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(pi(this.gl)||!this.width||!this.height||EB(this.width)&&EB(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===Gte.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function $te(n,e){return tn("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class Oa extends Eg{static isSupported(e,t){return Eg.isSupported(e,t)}constructor(e,t={}){SE(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:$te(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const pf="EXT_color_buffer_float",MB={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:pf,bpp:2},33327:{gl2:pf,bpp:4},34842:{gl2:pf,bpp:8},33326:{gl2:pf,bpp:4},33328:{gl2:pf,bpp:8},34836:{gl2:pf,bpp:16},35898:{gl2:pf,bpp:4}};class Sg extends Nu{static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=pi(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,MB)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return tn(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&pi(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*MB[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const PB="clear: bad arguments";function mM(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),tn(0!==o,PB),nc(n,s,()=>{n.clear(o)})}function FB(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function ni(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){FB(s,i,r,o,a,"next",l)}function a(l){FB(s,i,r,o,a,"throw",l)}o(void 0)})}}const _M=[34069,34070,34071,34072,34073,34074];let Zte=(()=>{class n extends Eg{constructor(t,i={}){SE(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return ni(function*(){const{gl:d}=c,f=r||s,p=yield Promise.all(_M.map(g=>{const _=f[g];return Promise.all(Array.isArray(_)?_:[_])}));c.bind(),_M.forEach((g,_)=>{p[_].length>1&&!1!==c.opts.mipmaps&&un.warn(`${c.id} has mipmap and multiple LODs.`)(),p[_].forEach((x,A)=>{t&&i?d.texImage2D(g,A,a,t,i,o,a,l,x):d.texImage2D(g,A,a,a,l,x)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:d=5121}=t,{gl:f}=this,p=o||a;return this.bind(),p instanceof Promise?p.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?f.texImage2D(i,0,c,r,s,l,c,d,p):f.texImage2D(i,0,c,c,d,p),this}}return n.FACES=_M,n})();class Jte extends Eg{static isSupported(e){return pi(e)}constructor(e,t={}){Bo(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:d,parameters:f={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),nc(this.gl,f,()=>{ArrayBuffer.isView(d)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,d),d instanceof rr&&(this.gl.bindBuffer(35052,d.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(d&&d.byteLength?d.byteLength:this.width*this.height*this.depth*(AB[this.dataFormat]||4)*(TB[this.type]||1),"Texture"),this.loaded=!0,this}}function tne(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Is(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function xE(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:d,deleteFramebuffer:f}=function(n){return n instanceof Is?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:tne(n),deleteFramebuffer:!0}}(n);tn(d);const{gl:p,handle:g,attachments:_}=d;a=a||d.width,l=l||d.height,36064===s&&null===g&&(s=1028),tn(_[s]),c=c||_[s].type,o=function(n,e,t,i,r){if(n)return n;return new(qy(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return tn(!1),0}}(t))}(o,c,r,a,l),c=c||hM(o);const x=p.bindFramebuffer(36160,g);return p.readPixels(t,i,a,l,r,c,o),p.bindFramebuffer(36160,x||null),f&&d.delete(),o}function yM(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=xE(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=kte({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}const LB="Multiple render targets not supported";class Is extends Nu{static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Is(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Bo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Bo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(tn(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const d in i){const f=i[d];(Array.isArray(f)?f[0]:f).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return tn(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&un.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){tn(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof Sg)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[d,f=0,p=0]=l;c=d,this._attachTexture({attachment:a,texture:d,layer:f,level:p})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(Is.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&mM(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){Bo(n),nc(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:tn(!1,PB)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return un.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return un.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return un.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return un.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return un.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return un.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=Bo(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=Wd(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?Wd(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?Wd(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(yM(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>un.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=yM(this,{targetMaxHeight:100});return un.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new Oa(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new Sg(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new Sg(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&tn(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof Sg?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:Bo(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:tn(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return pi(n)?n:null}(this.gl);t?t.readBuffer(e):tn(36064===e||1029===e,LB),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=Bo(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):tn(1===e.length&&(36064===e[0]||1029===e[0]),LB)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in kB)void 0===n.luma.caps[e]&&(n.luma.caps[e]=jB(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Is.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const kB={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new Oa(n,{format:6408,type:5126,dataFormat:6408}),t=new Is(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function vM(n,e){return BB(n,e)}function BB(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>jB(n,t))}function jB(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=kB[e];let i;tn(t,e);const r=pi(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:tn(!1);return i}(n,e)),n.luma.caps[e]||un.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class bM{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return ht(ht({},this.source.getAccessor()),this.opts)}}const Yy=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,d=t*i+s;if(ArrayBuffer.isView(e)){if(d<=e.length)return e;if(d*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,d)}let f;l&&(f=l*i+s);const p=this._allocate(c,d,a,f);return e&&o?p.set(e):a||p.fill(0,0,4),this._release(e),p}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},fne=(Math,1/180*Math.PI),xr={};function gne(n,{precision:e=xr.precision||4}={}){return n=function(n){return Math.round(n/xr.EPSILON)*xr.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function qd(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Pu(n,e,t){if(qd(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function VB(n){return function(n,e){return Pu(n,t=>t*fne,void 0)}(n)}function gf(n,e,t){return Pu(n,i=>Math.max(e,Math.min(t,i)))}function CE(n,e,t){return qd(n)?n.map((i,r)=>CE(i,e[r],t)):t*e+(1-t)*n}function Xy(n,e,t){const i=xr.EPSILON;t&&(xr.EPSILON=t);try{if(n===e)return!0;if(qd(n)&&qd(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!Xy(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=xr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{xr.EPSILON=i}}function Fu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}xr.EPSILON=1e-12,xr.debug=!1,xr.precision=4,xr.printTypes=!1,xr.printDegrees=!1,xr.printRowMajor=!0;class wM extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return Fu(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:qd(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(xr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+gne(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Xy(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(xr.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function to(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function AE(n,e,t=""){if(xr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const UB={};function EM(n,e){UB[n]||(UB[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class Ene extends wM{get ELEMENTS(){return Fu(!1),0}copy(e){return Fu(!1),this}get x(){return this[0]}set x(e){this[0]=to(e)}get y(){return this[1]}set y(e){this[1]=to(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return to(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return to(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Fu(e>=0&&e<this.ELEMENTS,"index is out of range"),to(this[e])}setComponent(e,t){return Fu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var gr=1e-6,oa="undefined"!=typeof Float32Array?Float32Array:Array;function zB(){var n=new oa(3);return oa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function HB(n,e,t){var i=new oa(3);return i[0]=n,i[1]=e,i[2]=t,i}function GB(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function TE(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function $B(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function WB(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}zB();const SM=[0,0,0],qB={};class vo extends Ene{static get ZERO(){return qB.ZERO=qB.ZERO||Object.freeze(new vo(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&qd(e)?this.copy(e):(xr.debug&&(to(e),to(t),to(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return xr.debug&&(to(e.x),to(e.y),to(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=to(e)}angle(e){return function(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],d=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),f=d&&GB(n,e)/d;return Math.acos(Math.min(Math.max(f,-1),1))}(this,e)}cross(e){return TE(this,this,e),this.check()}rotateX({radians:e,origin:t=SM}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=SM}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=SM}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return $B(this,this,e),this.check()}transformAsVector(e){return WB(this,this,e),this.check()}transformByMatrix3(e){return function(n,e,t){var i=e[0],r=e[1],s=e[2];n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8]}(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],d=r*c-s*l,f=s*a-i*c,p=i*l-r*a,g=r*p-s*f,_=s*d-i*p,x=i*f-r*d,A=2*t[3];f*=A,p*=A,_*=2,x*=2,n[0]=a+(d*=A)+(g*=2),n[1]=l+f+_,n[2]=c+p+x}(this,this,e),this.check()}}const KB=new vo;function xg(n,e,t,i){KB.set(n,e,t);const r=KB.len();return{distance:i/r,normal:new vo(-n/r,-e/r,-t/r)}}function Gne(n){return n-Math.fround(n)}let Zy;function xM(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;Zy=Yy.allocate(Zy,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];Zy[o+a]=l,Zy[o+a+e]=Gne(l)}o+=2*e}return Zy.subarray(0,r*e*2)}function DE(n){return n.stride||n.size*n.bytesPerElement}function YB(n,e){e.offset&&Oi.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=DE(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return Un(ht({},e),{offset:s,stride:t})}function ic(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const XB=[],QB=[];function ZB(n,e=0,t=1/0){let i=XB;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(QB.length=n.length,i=QB):i=XB,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function JB(n){return n&&n[Symbol.asyncIterator]}function CM(n,e=(()=>!0)){return Array.isArray(n)?ej(n,e,[]):e(n)?[n]:[]}function ej(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?ej(r,e,t):e(r)&&t.push(r)}return t}function Kne({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const Yne=[],ME=[[0,1/0]];function AM({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let d=0;d<r;d++)e[t+l]=c[d]||0,l++}}const Zne={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function tj(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",ht(ht(ht({},Zne[n.type]),e),n)):null}function nj(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function ij(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function rj(n){n.push(n.shift())}function TM(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function sj({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,d=r&&c,f=TM(t,e),p=t.state.constant;if(!d&&i>=f)return;const g=p?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!p){const W=s;s=(G,ge)=>t._normalizeConstant(W(G,ge))}const _=p?(W,G)=>s(g,G):(W,G)=>s(g.subarray(W,W+a),G),x=n.getData({length:i}),A=new Float32Array(f);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return AM({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((d,f)=>i(d+a,f)),c=Math.min(r.length,s.length);for(let d=1;d<c;d++){const f=r[d]*t,p=s[d]*t;AM({source:n.subarray(o,f),target:e,start:a,end:p,size:t,getData:l}),o=f,a=p}a<e.length&&AM({source:[],target:e,start:a,size:t,getData:l})})({source:x,target:A,sourceStartIndices:r,targetStartIndices:c,size:a,getData:_}),n.byteLength<A.byteLength+l&&n.reallocate(A.byteLength+l),n.subData({data:A,offset:l})}class DM extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&vM(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new rr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*DE(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Yy.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=YB(n,e);return{high:t,low:Un(ht({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new bM(this,s.high),i["".concat(e,"64Low")]=r?new bM(this,s.low):new Float32Array(this.size),i}if(t){const i=YB(this.getAccessor(),t);return{[e]:new bM(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof rr&&(e={buffer:e});const i=ht(ht({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=DE(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=DE(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=xM(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?xM(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=Yy.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?xM(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Oi.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:ME,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return tj(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===ME||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=ME}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Yne}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==ME}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,d]of s)o.call(r,this,{data:t,startRow:c,endRow:d,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,d]of s){const f=Number.isFinite(c)?this.getVertexOffset(c):0,p=Number.isFinite(d)?this.getVertexOffset(d):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:p})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(ic(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(d,{index:f,target:p})=>{if(!r){const A=f*a+l;for(let W=0;W<e;W++)p[W]=n[A+W];return p}const g=r[f],_=r[f+1]||c;let x;if(s){x=new Array(_-g);for(let A=g;A<_;A++){const W=A*a+l;p=new Array(e);for(let G=0;G<e;G++)p[G]=n[W+G];x[A-g]=p}}else if(a===e)x=n.subarray(g*e+l,_*e+l);else{x=new n.constructor((_-g)*e);let A=0;for(let W=g;W<_;W++){const G=W*a+l;for(let ge=0;ge<e;ge++)x[A++]=n[G+ge]}}return x}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:d,startIndices:f}=e,{accessor:p,transform:g}=a,_=l.binaryAccessor||("function"==typeof p?p:s[p]);ic("function"==typeof _,'accessor "'.concat(p,'" is not a function'));let x=e.getVertexOffset(i);const{iterable:A,objectInfo:W}=ZB(t,i,r);for(const G of A){W.index++;let ge=_(G,W);if(g&&(ge=g.call(this,ge)),f){const Ne=(W.index<f.length-1?f[W.index+1]:o)-f[W.index];if(ge&&Array.isArray(ge[0])){let Ge=x;for(const $e of ge)e._normalizeValue($e,c,Ge),Ge+=d}else ge&&ge.length>d?c.set(ge,x):(e._normalizeValue(ge,W.target,0),Kne({target:c,source:W.target,start:x,count:Ne}));x+=Ne*d}else e._normalizeValue(ge,c,x),x+=d}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let MM={};function bo(n){Oi.level>0&&MM[n]&&MM[n].call(...arguments)}function Na(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const oj="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",tie=`#version 300 es\n${oj}`;function aj(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function lj(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?tie:e>300?`#version ${e}\n${oj}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return Na(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class cj extends Nu{static isSupported(e){return pi(e)}constructor(e,t={}){Bo(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,bg(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,un.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof rr?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class sie{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof rr?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&tn(pi(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new cj(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],tn(i[s]instanceof rr)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new rr(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function uj(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const Jy="vs",lie={[Jy]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},IE="__LUMA_INJECT_DECLARATIONS__",dj=/void\s+main\s*\([^)]*\)\s*\{\n?/,hj=/}\n?[^{}]*$/,RM=[];function fj(n,e,t,i=!1){const r=e===Jy;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),RM.length=o.length;for(let l=0,c=o.length;l<c;++l)RM[l]=o[l].injection;const a=`${RM.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(IE,a));break;case"vs:#main-start":r&&(n=n.replace(dj,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(hj,l=>a+l));break;case"fs:#decl":r||(n=n.replace(IE,a));break;case"fs:#main-start":r||(n=n.replace(dj,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(hj,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(IE,""),i&&(n=n.replace(/\}\s*$/,s=>s+lie[e])),n}function OM(n){const e={};return Na(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const cie={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},RE="transform_uSize_",pj="transform_position";const _ie={10241:9728,10240:9728,10242:33071,10243:33071};class vie{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const f in this.samplerTextureMap)a[f]=i[this.samplerTextureMap[f]];this._setSourceTextureParameters();const d=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${RE}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${RE}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,d)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=xE(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Na(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof Oa)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new rr(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Is(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(_ie)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function(n,e){tn(n instanceof Oa||n instanceof Zte||n instanceof Jte);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:d}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:d},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(e);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const d=l.split("\n"),f=d.slice();if(d.forEach((p,g,_)=>{if(s>0){const x=function(n,e){const t={},i=function(n){return aj(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${RE}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),f=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Na(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":f},samplerTextureMap:t}}return null}(p,e);if(x){const{updatedLine:A,inject:W}=x;f[g]=A,c=OM([c,W]),Object.assign(a,x.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=aj(n,["varying","out"]);return t&&t.name===e?t.type:null}(p,t))}),t){tn(i);const p=`${RE}${t}`;c=OM([c,{"vs:#decl":`uniform vec2 ${p};\n`,"vs:#main-start":`     vec2 ${pj} = transform_getPos(${p});\n     gl_Position = vec4(${pj}, 0, 1.);\n`}])}l=f.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=OM([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||lj({version:uj(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[cie].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const NM={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function wie(n){let e=gj(n);return"object"===e?n?"type"in n?Object.assign({},n,NM[n.type]):"value"in n?(e=gj(n.value),Object.assign({type:e},n,NM[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},NM[e])}function gj(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class PM{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:d,fragmentShader:f}){Na("string"==typeof e),this.name=e,this.vs=t||d,this.fs=i||f,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=wie(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Na(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Na(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function Cie(n){return function(n){const e={},t={};return FM({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(_j(n))}function FM({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&FM({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function _j(n,e){return n.map(t=>(t instanceof PM||(Na("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),Na(t.name,"shader module has no name"),(t=new PM(t)).dependencies=_j(t.dependencies)),t))}const LM={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},mf={};function Nie(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/Apple/i)||e.match(/Apple/i)?"APPLE":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN"}Object.keys(LM).forEach(n=>{mf[n]=n});const kM={};function yj(n,e,t={}){const i=LM[e];if(Na(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in kM)return kM[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),kM[e]=l,l}function OE(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=LM[e];Na(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return Na(!1===r||!0===r),r}(n,t))}function Cg(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const vj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],kie=[...vj,[Cg("attribute"),"in $1"],[Cg("varying"),"out $1"]],Bie=[...vj,[Cg("varying"),"in $1"]],bj=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],jie=[...bj,[Cg("in"),"attribute $1"],[Cg("out"),"varying $1"]],Vie=[...bj,[Cg("in"),"varying $1"]],BM="gl_FragColor",jM=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Uie=/void\s+main\s*\([^)]*\)\s*\{\n?/;function NE(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const $ie=`\n\n${IE}\n\n`,wj={[Jy]:"vertex",fs:"fragment"};function Ej(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:d}){Na("string"==typeof t,"shader source must be a string");const f=i===Jy,p=t.split("\n");let g=100,_="",x=t;0===p[0].indexOf("#version ")?(g=300,_=p[0],x=p.slice(1).join("\n")):_=`#version ${g}`;const A={};r.forEach($e=>{Object.assign(A,$e.getDefines())}),Object.assign(A,s);let W=c?`${_}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${wj[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${wj[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:Nie(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return OE(n,mf.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),OE(n,mf.GLSL_DERIVATIVES)&&yj(n,mf.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),OE(n,mf.GLSL_FRAG_DATA)&&yj(n,mf.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),OE(n,mf.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(A)}\n${f?"":"precision highp float;\n\n"}\n`:`${_}\n`;const G=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),ge={},Ne={},Ge={};for(const $e in a){const at="string"==typeof a[$e]?{injection:a[$e],order:0}:a[$e],St=$e.match(/^(v|f)s:(#)?([\w-]+)$/);if(St){const Pt=St[3];St[2]?"decl"===Pt?Ne[$e]=[at]:Ge[$e]=[at]:ge[$e]=[at]}else Ge[$e]=[at]}for(const $e of r){d&&$e.checkDeprecations(x,d),W+=$e.getModuleSource(i,g);const St=$e.injections[i];for(const Rt in St){const Pt=Rt.match(/^(v|f)s:#([\w-]+)$/);if(Pt){const Zt="decl"===Pt[2]?Ne:Ge;Zt[Rt]=Zt[Rt]||[],Zt[Rt].push(St[Rt])}else ge[Rt]=ge[Rt]||[],ge[Rt].push(St[Rt])}}return W+=$ie,W=fj(W,i,Ne),W+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(G[i],ge),W+=x,W=fj(W,i,Ge),W=function(n,e,t){switch(e){case 300:return t?NE(n,kie):function(n){const e=(n=NE(n,Bie)).match(jM);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${BM}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace(Uie,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${BM}\\b`,"g"),t)}return n}(n);case 100:return t?NE(n,jie):function(n){const e=(n=NE(n,Vie)).match(jM);if(e){const t=e[1];n=n.replace(jM,"").replace(new RegExp(`\\b${t}\\b`,"g"),BM)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(W,l?100:g,f),W}function Kie(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const ere={5126:Cr.bind(null,"uniform1fv",Pa,1,wo),35664:Cr.bind(null,"uniform2fv",Pa,2,wo),35665:Cr.bind(null,"uniform3fv",Pa,3,wo),35666:Cr.bind(null,"uniform4fv",Pa,4,wo),5124:Cr.bind(null,"uniform1iv",Kd,1,wo),35667:Cr.bind(null,"uniform2iv",Kd,2,wo),35668:Cr.bind(null,"uniform3iv",Kd,3,wo),35669:Cr.bind(null,"uniform4iv",Kd,4,wo),35670:Cr.bind(null,"uniform1iv",Kd,1,wo),35671:Cr.bind(null,"uniform2iv",Kd,2,wo),35672:Cr.bind(null,"uniform3iv",Kd,3,wo),35673:Cr.bind(null,"uniform4iv",Kd,4,wo),35674:Cr.bind(null,"uniformMatrix2fv",Pa,4,Lu),35675:Cr.bind(null,"uniformMatrix3fv",Pa,9,Lu),35676:Cr.bind(null,"uniformMatrix4fv",Pa,16,Lu),35678:no,35680:no,5125:Cr.bind(null,"uniform1uiv",PE,1,wo),36294:Cr.bind(null,"uniform2uiv",PE,2,wo),36295:Cr.bind(null,"uniform3uiv",PE,3,wo),36296:Cr.bind(null,"uniform4uiv",PE,4,wo),35685:Cr.bind(null,"uniformMatrix2x3fv",Pa,6,Lu),35686:Cr.bind(null,"uniformMatrix2x4fv",Pa,8,Lu),35687:Cr.bind(null,"uniformMatrix3x2fv",Pa,6,Lu),35688:Cr.bind(null,"uniformMatrix3x4fv",Pa,12,Lu),35689:Cr.bind(null,"uniformMatrix4x2fv",Pa,8,Lu),35690:Cr.bind(null,"uniformMatrix4x3fv",Pa,12,Lu),35678:no,35680:no,35679:no,35682:no,36289:no,36292:no,36293:no,36298:no,36299:no,36300:no,36303:no,36306:no,36307:no,36308:no,36311:no},tre={},nre={},ire={},Sj=[0];function VM(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(Sj[0]=n,n=Sj);const r=n.length;if(r%e&&un.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Pa(n,e){return VM(n,e,Float32Array,tre)}function Kd(n,e){return VM(n,e,Int32Array,nre)}function PE(n,e){return VM(n,e,Uint32Array,ire)}function xj(n,e,t){const i=ere[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function rre(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function ore(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof Eg||n instanceof Sg)||n instanceof Is&&Boolean(n.texture)}function are(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function no(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Cr(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),d=c.length;let f=!1;if(null===r)r=new Float32Array(d),s=d,f=!0;else{tn(s===d,"Uniform length cannot change.");for(let p=0;p<d;++p)if(c[p]!==r[p]){f=!0;break}}return f&&(i(o,n,a,c),r.set(c)),f}}function wo(n,e,t,i){n[e](t,i)}function Lu(n,e,t,i){n[e](t,!1,i)}function FE(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function Aj(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=Tj(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function Tj(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class e0 extends Nu{static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return tn(!1),"unknown"}}constructor(e,t){SE(e),tn("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:FE(t.source,null)||t.id||jc(`unnamed ${e0.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=FE(e,null);t&&(this.id=jc(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${e0.getTypeName(this.shaderType)}:${this.id}`}getName(){return FE(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||FE(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let d=0;d<r.length;d++){const f=r[d];if(f.length<=1)continue;const p=f.split(":"),g=p[0],_=parseInt(p[2],10);if(isNaN(_))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[_]=f:o[_]=f}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return Tj(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:Aj(s,c),warnings:Aj(o,c)}}(i,this.source,this.shaderType,this.id);throw un.error(`GLSL compilation errors in ${r}\n${s}`)(),un.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class UM extends e0{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class zM extends e0{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Rs=5126,t0=5124,n0=5125,HM={[Rs]:[Rs,1,"float"],35664:[Rs,2,"vec2"],35665:[Rs,3,"vec3"],35666:[Rs,4,"vec4"],[t0]:[t0,1,"int"],35667:[t0,2,"ivec2"],35668:[t0,3,"ivec3"],35669:[t0,4,"ivec4"],[n0]:[n0,1,"uint"],36294:[n0,2,"uvec2"],36295:[n0,3,"uvec3"],36296:[n0,4,"uvec4"],35670:[Rs,1,"bool"],35671:[Rs,2,"bvec2"],35672:[Rs,3,"bvec3"],35673:[Rs,4,"bvec4"],35674:[Rs,8,"mat2"],35685:[Rs,8,"mat2x3"],35686:[Rs,8,"mat2x4"],35675:[Rs,12,"mat3"],35687:[Rs,12,"mat3x2"],35688:[Rs,12,"mat3x4"],35676:[Rs,16,"mat4"],35689:[Rs,16,"mat4x2"],35690:[Rs,16,"mat4x3"]};function Nj(n){const e=HM[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function Pj(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Rs}for(const t in HM){const[i,r,s]=HM[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class Ure{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!pi(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=Nj(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new sa(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=Nj(i),l={location:e,name:t,accessor:new sa({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const zre=35981,Hre=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Lj extends Nu{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",Hre),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=zre}=e;return this.hash=t||"",this.vs="string"==typeof i?new UM(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new zM(this.gl,{id:`${e.id}-fs`,source:r}):r,tn(this.vs instanceof UM),tn(this.fs instanceof zM),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Bo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Ure(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:d=c>0,vertexArray:f=null,transformFeedback:p,framebuffer:g,parameters:_={},uniforms:x,samplers:A}){if((x||A)&&(un.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(x||{})),un.priority>=e){const W=g?g.id:"default",G=`mode=${Wd(this.gl,t)} verts=${i} instances=${c} indexType=${Wd(this.gl,l)} isInstanced=${d} isIndexed=${a} Framebuffer=${W}`;un.log(e,G)()}return tn(f),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||d&&0===c||(f.bindForDraw(i,c,()=>{if(void 0!==g&&(_=Object.assign({},_,{framebuffer:g})),p){const W=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return tn(!1),0}}(t);p.begin(W)}this._bindTextures(),nc(this.gl,_,()=>{a&&d?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&pi(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):d?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),p&&p.end()}),0))}setUniforms(e={}){un.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!ore(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Is&&(s=s.texture),s instanceof Eg)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&are(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new UM({handle:r});break;case 35632:i.fs=new zM({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=jc(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),un.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),un.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||un.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=rre(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=xj(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=xj(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class r0{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new r0(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),d=this._getHash(t),f=this._getHash(i),p=c.map(ge=>this._getHash(ge.name)).sort(),g=o.map(ge=>this._getHash(ge)),_=Object.keys(r).sort(),x=Object.keys(s).sort(),A=[],W=[];for(const ge of _)A.push(this._getHash(ge)),A.push(this._getHash(r[ge]));for(const ge of x)W.push(this._getHash(ge)),W.push(this._getHash(s[ge]));const G=`${d}/${f}D${A.join("/")}M${p.join("/")}I${W.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[G]){const ge=function(n,e){const{vs:t,fs:i}=e,r=Cie(e.modules||[]);return{gl:n,vs:Ej(n,Object.assign({},e,{source:t,type:Jy,modules:r})),fs:Ej(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:Kie(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[G]=new Lj(this.gl,{hash:G,vs:ge.vs,fs:ge.fs,varyings:o,bufferMode:a}),this._getUniforms[G]=ge.getUniforms||(Ne=>{}),this._useCounts[G]=0}return this._useCounts[G]++,this._programCache[G]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let kE=null;class Fa extends Nu{static isSupported(e,t={}){return!t.constantAttributeZero||pi(e)||"Chrome"===function(n){if(!tM())return"Node";if(K3(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":zy.chrome?"Chrome":zy.safari?"Safari":zy.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Fa(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Fa.MAX_ATTRIBUTES=Fa.MAX_ATTRIBUTES||e.getParameter(34921),Fa.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:Fa._setConstantFloatArray(e,t,i);break;case Int32Array:Fa._setConstantIntArray(e,t,i);break;case Uint32Array:Fa._setConstantUintArray(e,t,i);break;default:tn(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Fa.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return tn(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:d}=i,{gl:f,gl2:p}=this;return e=Number(e),this.bind(()=>{f.bindBuffer(34962,t.handle),c?(tn(pi(f)),p.vertexAttribIPointer(e,r,s,o,a)):f.vertexAttribPointer(e,r,s,l,o,a),f.enableVertexAttribArray(e),p.vertexAttribDivisor(e,d||0)}),this}enable(e,t=!0){return!t&&0===e&&!Fa.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new rr(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!kE||kE.byteLength<n)&&(kE=new ArrayBuffer(n)),kE}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:tn(!1)}}static _setConstantIntArray(e,t,i){switch(tn(pi(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:tn(!1)}}static _setConstantUintArray(e,t,i){switch(tn(pi(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:tn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return tn(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const Xre=/^(.+)__LOCATION_([0-9]+)$/,Qre=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Zre{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Fa(e),SB(this,"VertexArray","v6.0",Qre),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new rr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof rr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof rr&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,un.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const d=sa.resolve(l.accessor,this.accessors[o]||{},i,r),{size:f,type:p}=d;return tn(Number.isFinite(f)&&Number.isFinite(p)),{location:o,accessor:d}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=Xre.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof rr)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof rr)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof rr))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(Fa.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){Fa.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof rr){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return un.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function s0(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=s0(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function kj(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,d,f,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof rr){const p=e,{data:g,changed:_}=p.getDebugData();let x;return d=_?"*":"",f=g,l=p.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?x=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${Wd(r,s)})`:(c=!0,x=`${l} bytes`),{[i]:`${d}${s0(f,{size:o,isInteger:c})}`,"Format ":x}}return f=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${s0(f,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function tse(n,e){const{type:t,size:i}=e,r=Pj(t,i);return r?`${n} (${r.name})`:n}function Bj({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){tn(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const p of l)!p.match(".*_.*")&&!p.match(s)&&GM({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)p.match(s)&&GM({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)a[p]||GM({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;let d=0;const f={};if(!i)for(const p in t){const g=t[p];a[p]||(d++,f[p]={Type:`NOT USED: ${g}`,[n]:s0(g)})}return{table:a,count:c,unusedTable:f,unusedCount:d}}function GM({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?s0(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function jj(n){const{type:e,size:t}=n.accessor,i=Pj(e,t);return i?`${i.name} ${n.name}`:n.name}const rse={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function ose(n,e){const{attributeMap:t=rse}=e||{};return t&&t[n]||n}function ase(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}tn(Number.isFinite(e.size),`attribute ${n} needs size`)}const Vj=()=>{},use={};class BE{constructor(e,t={}){const{id:i=jc("model")}=t;tn(EE(e)),this.id=i,this.gl=e,this.id=t.id||jc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||r0.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},tn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return tn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return tn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=ose(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=ht({},o);delete c.value,i[a]=[new rr(n,l),c],ase(s,c)}}if(r){const s=r.value||r;tn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new rr(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(bg(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return mM(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),un.priority>=2&&(c=this._logDrawCallStart(2));const d=this.vertexArray.getDrawParams(),{isIndexed:f=d.isIndexed,indexType:p=d.indexType,indexOffset:g=d.indexOffset,vertexArrayInstanced:_=d.isInstanced}=this.props;_&&!this.isInstanced&&un.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:x,instanceCount:A}=this,{onBeforeRender:W=Vj,onAfterRender:G=Vj}=this.props;W(),this.program.setUniforms(this.uniforms);const ge=this.program.draw(Object.assign(use,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:f,indexType:p,isInstanced:x,instanceCount:A,offset:f?g:0}));return G(),un.priority>=2&&this._logDrawCallEnd(c,l,i),ge}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return un.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:d}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}tn(t instanceof Lj,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Zre(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof rr&&t.delete()}}_setAnimationProps(e){this.animated&&tn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(bg(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new cj(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),un.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:un.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=kj(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${tse(s.name,a)}`),t[o]=kj(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=Bj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:d}=Bj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});d>0&&un.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&un.log("UNUSED UNIFORMS",Object.keys(a))();const f=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${jj(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${jj(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);un.table(e,s)(),un.table(e,o)(),un.table(e+1,f)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),un.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class $M{static isSupported(e){return pi(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();tn(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new BE(t,Object.assign({},e,{fs:e.fs||lj({version:uj(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(bg(n.feedbackBuffers)&&bg(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new sie(e,t)),function(n){return!(bg(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new vie(e,t)),tn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function jE(){}const fse={onStart:jE,onUpdate:jE,onInterrupt:jE,onEnd:jE};class o0{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=ht(ht({},fse),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const wse={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new o0(i),this.attribute=t,this.attributeInTransition=new DM(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=ij(e.size);return new $M(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new rr(e,r),new rr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;rj(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)sj(ht({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=TM(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:nj(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new o0(i),this.attribute=t,this.attributeInTransition=new DM(e,Un(ht({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new Oa(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new Is(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=ij(e.size);return new $M(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new rr(e,r),new rr(e,r),new rr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)sj(ht({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=TM(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:nj(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),rj(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),xE(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Ese{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=$M.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void Oi.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=wse[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Oi.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const Uj="attributeManager.invalidate";class Dse{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Ese(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);bo(Uj,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);bo(Uj,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;bo("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const d=this.attributes[c],f=d.settings.accessor;d.startIndices=i,s[c]&&Oi.removed("props.".concat(c),"data.attributes.".concat(c))(),d.setExternalBuffer(o[c])||d.setBinaryValue(o[f],e.startIndices)||!o[f]&&d.setConstantValue(s[f])||d.needsUpdate()&&(l=!0,this._updateAttribute({attribute:d,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=d.needsRedraw()}l&&bo("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=ht({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&Oi.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=Un(ht({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new DM(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;bo("attribute.updateStart",t),t.allocate(i)&&bo("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,bo("attribute.updateEnd",t,i))}}function Hj(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function Gj(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const Ose={interpolation:class extends o0{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=CE(t,i,o)}},spring:class extends o0{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=Hj(n[o],e[o],t[o],i,r);return s}return Hj(n,e,t,i,r)}(s,o,t,i,r);const l=Gj(a,t),c=Gj(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class Nse{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=tj(r)))return;const o=Ose[r.type];if(!o)return void Oi.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(Un(ht({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const VE={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:Pse}=VE;function kse(n,e){if(!n.transitions)return null;const t={},i=qM(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&WM(n[r],e[r],s)&&(t[r]=!0)}return t}function $j({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=WM(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=WM(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function WM(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Vse(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function Wj(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,$j({oldProps:r,newProps:i,triggerName:t})}function qM(n){const e=n[Pse],t=e&&e.constructor;return t?t._propTypes:{}}function Wse(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function UE(n){let t,e={};return i=>{for(const r in i)if(!Wse(i[r],e[r])){t=n(i),e=i;break}return t}}function qse(n,e){if(!e)return n;const t=ht(ht({},n),e);if("defines"in e&&(t.defines=ht(ht({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=ht({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function zE(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],f=e[9],p=e[10],g=e[11],_=e[12],x=e[13],A=e[14],W=e[15],G=t*a-i*o,ge=t*l-r*o,Ne=t*c-s*o,Ge=i*l-r*a,$e=i*c-s*a,at=r*c-s*l,St=d*x-f*_,Rt=d*A-p*_,Pt=d*W-g*_,Xt=f*A-p*x,Zt=f*W-g*x,bt=p*W-g*A,Ct=G*bt-ge*Zt+Ne*Xt+Ge*Pt-$e*Rt+at*St;return Ct?(n[0]=(a*bt-l*Zt+c*Xt)*(Ct=1/Ct),n[1]=(r*Zt-i*bt-s*Xt)*Ct,n[2]=(x*at-A*$e+W*Ge)*Ct,n[3]=(p*$e-f*at-g*Ge)*Ct,n[4]=(l*Pt-o*bt-c*Rt)*Ct,n[5]=(t*bt-r*Pt+s*Rt)*Ct,n[6]=(A*Ne-_*at-W*ge)*Ct,n[7]=(d*at-p*Ne+g*ge)*Ct,n[8]=(o*Zt-a*Pt+c*St)*Ct,n[9]=(i*Pt-t*Zt-s*St)*Ct,n[10]=(_*$e-x*Ne+W*G)*Ct,n[11]=(f*Ne-d*$e-g*G)*Ct,n[12]=(a*Rt-o*Xt-l*St)*Ct,n[13]=(t*Xt-i*Rt+r*St)*Ct,n[14]=(x*ge-_*Ge-A*G)*Ct,n[15]=(d*Ge-f*ge+p*G)*Ct,n):null}function Vc(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],d=e[7],f=e[8],p=e[9],g=e[10],_=e[11],x=e[12],A=e[13],W=e[14],G=e[15],ge=t[0],Ne=t[1],Ge=t[2],$e=t[3];return n[0]=ge*i+Ne*a+Ge*f+$e*x,n[1]=ge*r+Ne*l+Ge*p+$e*A,n[2]=ge*s+Ne*c+Ge*g+$e*W,n[3]=ge*o+Ne*d+Ge*_+$e*G,n[4]=(ge=t[4])*i+(Ne=t[5])*a+(Ge=t[6])*f+($e=t[7])*x,n[5]=ge*r+Ne*l+Ge*p+$e*A,n[6]=ge*s+Ne*c+Ge*g+$e*W,n[7]=ge*o+Ne*d+Ge*_+$e*G,n[8]=(ge=t[8])*i+(Ne=t[9])*a+(Ge=t[10])*f+($e=t[11])*x,n[9]=ge*r+Ne*l+Ge*p+$e*A,n[10]=ge*s+Ne*c+Ge*g+$e*W,n[11]=ge*o+Ne*d+Ge*_+$e*G,n[12]=(ge=t[12])*i+(Ne=t[13])*a+(Ge=t[14])*f+($e=t[15])*x,n[13]=ge*r+Ne*l+Ge*p+$e*A,n[14]=ge*s+Ne*c+Ge*g+$e*W,n[15]=ge*o+Ne*d+Ge*_+$e*G,n}function a0(n,e,t){var o,a,l,c,d,f,p,g,_,x,A,W,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],d=e[4],f=e[5],p=e[6],g=e[7],_=e[8],x=e[9],A=e[10],W=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=d,n[5]=f,n[6]=p,n[7]=g,n[8]=_,n[9]=x,n[10]=A,n[11]=W,n[12]=o*i+d*r+_*s+e[12],n[13]=a*i+f*r+x*s+e[13],n[14]=l*i+p*r+A*s+e[14],n[15]=c*i+g*r+W*s+e[15]),n}function l0(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function qj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],d=e[9],f=e[10],p=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+d*i,n[6]=a*r+f*i,n[7]=l*r+p*i,n[8]=c*r-s*i,n[9]=d*r-o*i,n[10]=f*r-a*i,n[11]=p*r-l*i,n}function Kj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],d=e[5],f=e[6],p=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+d*i,n[2]=a*r+f*i,n[3]=l*r+p*i,n[4]=c*r-s*i,n[5]=d*r-o*i,n[6]=f*r-a*i,n[7]=p*r-l*i,n}function Yj(n,e,t,i,r){var o,s=1/Math.tan(e/2);return n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i),n}function Xj(n,e){var t=n[0],i=n[1],r=n[2],s=n[3],o=n[4],a=n[5],l=n[6],c=n[7],d=n[8],f=n[9],p=n[10],g=n[11],_=n[12],x=n[13],A=n[14],W=n[15],G=e[0],ge=e[1],Ne=e[2],Ge=e[3],$e=e[4],at=e[5],St=e[6],Rt=e[7],Pt=e[8],Xt=e[9],Zt=e[10],bt=e[11],Ct=e[12],Ut=e[13],ft=e[14],Wt=e[15];return Math.abs(t-G)<=gr*Math.max(1,Math.abs(t),Math.abs(G))&&Math.abs(i-ge)<=gr*Math.max(1,Math.abs(i),Math.abs(ge))&&Math.abs(r-Ne)<=gr*Math.max(1,Math.abs(r),Math.abs(Ne))&&Math.abs(s-Ge)<=gr*Math.max(1,Math.abs(s),Math.abs(Ge))&&Math.abs(o-$e)<=gr*Math.max(1,Math.abs(o),Math.abs($e))&&Math.abs(a-at)<=gr*Math.max(1,Math.abs(a),Math.abs(at))&&Math.abs(l-St)<=gr*Math.max(1,Math.abs(l),Math.abs(St))&&Math.abs(c-Rt)<=gr*Math.max(1,Math.abs(c),Math.abs(Rt))&&Math.abs(d-Pt)<=gr*Math.max(1,Math.abs(d),Math.abs(Pt))&&Math.abs(f-Xt)<=gr*Math.max(1,Math.abs(f),Math.abs(Xt))&&Math.abs(p-Zt)<=gr*Math.max(1,Math.abs(p),Math.abs(Zt))&&Math.abs(g-bt)<=gr*Math.max(1,Math.abs(g),Math.abs(bt))&&Math.abs(_-Ct)<=gr*Math.max(1,Math.abs(_),Math.abs(Ct))&&Math.abs(x-Ut)<=gr*Math.max(1,Math.abs(x),Math.abs(Ut))&&Math.abs(A-ft)<=gr*Math.max(1,Math.abs(A),Math.abs(ft))&&Math.abs(W-Wt)<=gr*Math.max(1,Math.abs(W),Math.abs(Wt))}function Qj(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function HE(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}!function(){var n=new oa(4);oa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const Zj=[0,0,0,0],voe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],boe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],woe=[0,0,0],Eoe=[0,0,0],Soe=UE(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=Zj,l=Zj,c=n.cameraPosition;const{geospatialOrigin:d,shaderCoordinateOrigin:f,offsetMode:p}=Jj(n,e,t);return p&&(l=n.projectPosition(d||f),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=HE([],l,o),s=i||s,o=Vc([],r,s),o=Vc([],o,voe)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:d}}(n,t,i),d=n.getDistanceScales(),f=[n.width*e,n.height*e],p=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:p,project_uCommonUnitsPerMeter:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:woe,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const _=n.getDistanceScales(c);switch(t){case Di.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=_.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=_.unitsPerMeter2;break;case Di.LNGLAT:case Di.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=_.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=_.unitsPerDegree2;break;case Di.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,_.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,_.unitsPerMeter2[2]]}}return g});function Jj(n,e,t=Eoe){let r,i=t,s=!0;switch(r=e===Di.LNGLAT_OFFSETS||e===Di.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case kc.WEB_MERCATOR:(e===Di.LNGLAT||e===Di.CARTESIAN)&&(s=!1);break;case kc.WEB_MERCATOR_AUTO_OFFSET:e===Di.LNGLAT?i=r:e===Di.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case kc.IDENTITY:i=n.position.map(Math.fround);break;case kc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class Toe extends wM{get ELEMENTS(){return Fu(!1),0}get RANK(){return Fu(!1),0}toString(){let e="[";if(xr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=to(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function Ig(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function KM(n,e){return n[0]=-e[0],n[1]=-e[1],n}function eV(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}!function(){var n=new oa(2);oa!=Float32Array&&(n[0]=0,n[1]=0)}();const tV=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Ioe=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Roe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Rg={};class Gn extends Toe{static get IDENTITY(){return Rg.IDENTITY=Rg.IDENTITY||Object.freeze(new Gn(tV)),Rg.IDENTITY}static get ZERO(){return Rg.ZERO=Rg.ZERO||Object.freeze(new Gn(Ioe)),Rg.ZERO}get INDICES(){return Roe}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,d,f,p,g,_,x,A){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=d,this[10]=f,this[11]=p,this[12]=g,this[13]=_,this[14]=x,this[15]=A,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,d,f,p,g,_,x,A){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=d,this[7]=_,this[8]=i,this[9]=a,this[10]=f,this[11]=x,this[12]=r,this[13]=l,this[14]=p,this[15]=A,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(tV)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,d=i*o,f=i*a,p=r*o,g=r*a,_=r*l,x=s*o,A=s*a,W=s*l;n[0]=1-f-_,n[1]=d+W,n[2]=p-A,n[3]=0,n[4]=d-W,n[5]=1-c-_,n[6]=g+x,n[7]=0,n[8]=p+A,n[9]=g-x,n[10]=1-c-f,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?Gn._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),d=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=d,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,d,f,p,g,_=e[0],x=e[1],A=e[2],W=i[0],G=i[1],ge=i[2],Ne=t[0],Ge=t[1],$e=t[2];Math.abs(_-Ne)<gr&&Math.abs(x-Ge)<gr&&Math.abs(A-$e)<gr?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(d=_-Ne,f=x-Ge,p=A-$e,r=G*(p*=g=1/Math.hypot(d,f,p))-ge*(f*=g),s=ge*(d*=g)-W*p,o=W*f-G*d,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=f*o-p*s,l=p*r-d*o,c=d*s-f*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=d,n[3]=0,n[4]=s,n[5]=l,n[6]=f,n[7]=0,n[8]=o,n[9]=c,n[10]=p,n[11]=0,n[12]=-(r*_+s*x+o*A),n[13]=-(a*_+l*x+c*A),n[14]=-(d*_+f*x+p*A),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new Gn).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return Yj(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],d=n[9],f=n[10],p=n[11],g=n[12],_=n[13],x=n[14],A=n[15];return(e*o-t*s)*(f*A-p*x)-(e*a-i*s)*(d*A-p*_)+(e*l-r*s)*(d*x-f*_)+(t*a-i*o)*(c*A-p*g)-(t*l-r*o)*(c*x-f*g)+(i*l-r*a)*(c*_-d*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return zE(this,this),this.check()}multiplyLeft(e){return Vc(this,e,this),this.check()}multiplyRight(e){return Vc(this,this,e),this.check()}rotateX(e){return qj(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],d=e[9],f=e[10],p=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-d*i,n[2]=a*r-f*i,n[3]=l*r-p*i,n[8]=s*i+c*r,n[9]=o*i+d*r,n[10]=a*i+f*r,n[11]=l*i+p*r}(this,this,e),this.check()}rotateZ(e){return Kj(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,d,f,p,g,_,x,A,W,G,ge,Ne,Ge,$e,at,St,Rt,Pt,Xt,Zt,bt,Ct,Ut,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<gr||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),p=e[1],g=e[2],_=e[3],A=e[5],W=e[6],G=e[7],Ne=e[9],Ge=e[10],$e=e[11],Pt=r*s*(d=1-c)-o*l,Xt=s*s*d+c,Zt=o*s*d+r*l,bt=r*o*d+s*l,Ct=s*o*d-r*l,Ut=o*o*d+c,n[0]=(f=e[0])*(at=r*r*d+c)+(x=e[4])*(St=s*r*d+o*l)+(ge=e[8])*(Rt=o*r*d-s*l),n[1]=p*at+A*St+Ne*Rt,n[2]=g*at+W*St+Ge*Rt,n[3]=_*at+G*St+$e*Rt,n[4]=f*Pt+x*Xt+ge*Zt,n[5]=p*Pt+A*Xt+Ne*Zt,n[6]=g*Pt+W*Xt+Ge*Zt,n[7]=_*Pt+G*Xt+$e*Zt,n[8]=f*bt+x*Ct+ge*Ut,n[9]=p*bt+A*Ct+Ne*Ut,n[10]=g*bt+W*Ct+Ge*Ut,n[11]=_*bt+G*Ct+$e*Ut,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?l0(this,this,e):l0(this,this,[e,e,e]),this.check()}translate(e){return a0(this,this,e),this.check()}transform(e,t){return 4===e.length?(AE(t=HE(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=$B(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return AE(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=WB(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return AE(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return EM("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return EM("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return EM("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Og(n,e){const t=HE([],e,n);return Qj(t,t,1/t[3]),t}function nV(n,e){const t=n%e;return t<0?e+t:t}const YM=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function ku(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const rc=Math.PI,iV=rc/4,sc=rc/180,XM=180/rc,QM=4003e4;function Ng([n,e]){return ku(Number.isFinite(n)),ku(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*sc+rc)/(2*rc),512*(rc+Math.log(Math.tan(iV+e*sc*.5)))/(2*rc)]}function Yd([n,e]){const t=n/512*(2*rc)-rc,i=2*(Math.atan(Math.exp(e/512*(2*rc)-rc))-iV);return[t*XM,i*XM]}function $E({latitude:n,longitude:e,highPrecision:t=!1}){ku(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*sc),o=512/360,a=o/s,l=512/QM/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=sc*Math.tan(n*sc)/s,f=512/QM*c,p=f/a*l;i.unitsPerDegree2=[0,o*c/2,f],i.unitsPerMeter2=[p,0,p]}return i}function sV(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=$E({longitude:t,latitude:i,highPrecision:!0}),d=Ng(n);d[0]+=s*(l[0]+c[0]*o),d[1]+=o*(l[1]+c[1]*o);const f=Yd(d),p=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[f[0],f[1],p]:f}function oV({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return a0(o,o,[0,0,-i]),qj(o,o,-e*sc),Kj(o,o,t*sc),l0(o,o,[r/=n,r,r]),s&&a0(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}function aV({width:n,height:e,fovy:t=WE(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=WE(i));const a=.5*t*sc,l=lV(t),c=r*sc,d=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*d+l)*o}}function WE(n){return 2*Math.atan(.5/n)*XM}function lV(n){return.5/Math.tan(.5*n*sc)}function ZM(n,e){const[t,i,r=0]=n;return ku(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Og(e,[t,i,r,1])}function _f(n,e,t=0){const[i,r,s]=n;if(ku(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Og(e,[i,r,s,1]);const o=Og(e,[i,r,0,1]),a=Og(e,[i,r,1,1]),l=o[2],c=a[2];return eV([],o,a,l===c?0:((t||0)-l)/(c-l))}function cV({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,d]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:ku(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const f=new qE({width:n,height:e,longitude:0,latitude:0,zoom:0}),p=f.project([a,d]),g=f.project([c,l]),_=[Math.max(Math.abs(g[0]-p[0]),i),Math.max(Math.abs(g[1]-p[1]),i)],x=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];ku(x[0]>0&&x[1]>0);const A=x[0]/_[0],W=x[1]/_[1],Ge=f.unproject([(g[0]+p[0])/2+(s.right-s.left)/2/A,(g[1]+p[1])/2+(s.bottom-s.top)/2/W]),$e=Math.min(r,f.zoom+YM(Math.abs(Math.min(A,W))));return ku(Number.isFinite($e)),{longitude:Ge[0],latitude:Ge[1],zoom:$e}}const uV=Math.PI/180;function dV(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*uV:Math.atan(.5/n.altitude))>(90-n.pitch)*uV-.01?(l=hV(n,0,e),c=hV(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}function hV(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Og(i,[e,0,1,1]),s=Og(i,[e,n.height,1,1]),c=Yd(eV([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}class qE{constructor({width:e,height:t,latitude:i=0,longitude:r=0,zoom:s=0,pitch:o=0,bearing:a=0,altitude:l=null,fovy:c=null,position:d=null,nearZMultiplier:f=.02,farZMultiplier:p=1.01}={width:1,height:1}){e=e||1,t=t||1,null===c&&null===l?c=WE(l=1.5):null===c?c=WE(l):null===l&&(l=lV(c));const g=function(n){return Math.pow(2,n)}(s);l=Math.max(.75,l);const _=$E({longitude:r,latitude:i}),x=Ng([r,i]);x[2]=0,d&&function(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2]}(x,x,function(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}([],d,_.unitsPerMeter)),this.projectionMatrix=function({width:n,height:e,pitch:t,altitude:i,fovy:r,nearZMultiplier:s,farZMultiplier:o}){const{fov:a,aspect:l,near:c,far:d}=aV({width:n,height:e,altitude:i,fovy:r,pitch:t,nearZMultiplier:s,farZMultiplier:o});return Yj([],a,l,c,d)}({width:e,height:t,pitch:o,fovy:c,nearZMultiplier:f,farZMultiplier:p}),this.viewMatrix=oV({height:t,scale:g,center:x,pitch:o,bearing:a,altitude:l}),this.width=e,this.height=t,this.scale=g,this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=l,this.fovy=c,this.center=x,this.meterOffset=d||[0,0,0],this.distanceScales=_,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:e,height:t,projectionMatrix:i,viewMatrix:r}=this,s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Vc(s,s,i),Vc(s,s,r),this.viewProjectionMatrix=s;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l0(o,o,[e/2,-t/2,1]),a0(o,o,[1,-1,0]),Vc(o,o,s);const a=zE([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!a)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=a}equals(e){return e instanceof qE&&e.width===this.width&&e.height===this.height&&Xj(e.projectionMatrix,this.projectionMatrix)&&Xj(e.viewMatrix,this.viewMatrix)}project(e,{topLeft:t=!0}={}){const r=ZM(this.projectPosition(e),this.pixelProjectionMatrix),[s,o]=r,a=t?o:this.height-o;return 2===e.length?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[r,s,o]=e,c=_f([r,t?s:this.height-s,o],this.pixelUnprojectionMatrix,i&&i*this.distanceScales.unitsPerMeter[2]),[d,f,p]=this.unprojectPosition(c);return Number.isFinite(o)?[d,f,p]:Number.isFinite(i)?[d,f,i]:[d,f]}projectPosition(e){const[t,i]=Ng(e);return[t,i,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,i]=Yd(e);return[t,i,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){return Ng(e)}unprojectFlat(e){return Yd(e)}getMapCenterByLngLatPosition({lngLat:e,pos:t}){const i=_f(t,this.pixelUnprojectionMatrix),s=Ig([],Ng(e),KM([],i));return Yd(Ig([],this.center,s))}getLocationAtPoint({lngLat:e,pos:t}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:t})}fitBounds(e,t={}){const{width:i,height:r}=this,{longitude:s,latitude:o,zoom:a}=cV(Object.assign({width:i,height:r,bounds:e},t));return new qE({width:i,height:r,longitude:s,latitude:o,zoom:a})}getBounds(e){const t=this.getBoundingRegion(e),i=Math.min(...t.map(a=>a[0])),r=Math.max(...t.map(a=>a[0]));return[[i,Math.min(...t.map(a=>a[1]))],[r,Math.max(...t.map(a=>a[1]))]]}getBoundingRegion(e={}){return dV(this,e.z||0)}}const joe=Math.PI/180,Voe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],JM=[0,0,0],zoe={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let Pg=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?kc.WEB_MERCATOR:kc.WEB_MERCATOR_AUTO_OFFSET:kc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Xy(t.projectionMatrix,this.projectionMatrix)&&Xy(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=ZM(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,d=_f([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[f,p,g]=this.unprojectPosition(d);return Number.isFinite(a)?[f,p,g]:Number.isFinite(r)?[f,p,r]:[f,p]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?Ng(t):t}unprojectFlat(t){return this.isGeospatial?Yd(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?$E({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=xg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=xg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=xg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=xg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=xg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=xg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new Gn).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new Gn).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=Voe,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:d=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){ku(Number.isFinite(n));const e=Math.cos(n*sc);return function(n){return YM(n)}(QM*e)-9}({latitude:s})+Math.log2(c):0);const f=Math.pow(2,this.zoom);this.scale=f,this.distanceScales=this.isGeospatial?$E({latitude:s,longitude:r}):d||zoe,this.focalDistance=c,this.distanceScales.metersPerUnit=new vo(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new vo(this.distanceScales.unitsPerMeter),this.position=JM,this.meterOffset=JM,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new Gn).multiplyRight(this.viewMatrixUncentered).translate(new vo(this.center||JM).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new vo(this.projectPosition([t,i,0]));if(r){const a=new vo(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*joe,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Vc(t,t,this.projectionMatrix),Vc(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=zE([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l0(i,i,[this.width/2,-this.height/2,1]),a0(i,i,[1,-1,0]),Vc(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=zE([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Oi.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),_V=(()=>{class n extends Pg{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:d=!1,repeat:f=!1,worldOffset:p=0}=t;let{width:g,height:_,altitude:x=1.5}=t;const A=Math.pow(2,s);g=g||1,_=_||1,x=Math.max(.75,x);const{fov:W,aspect:G,focalDistance:ge,near:Ne,far:Ge}=aV({width:g,height:_,pitch:o,altitude:x,nearZMultiplier:l,farZMultiplier:c});let $e=oV({height:_,pitch:o,bearing:a,scale:A,altitude:x});p&&($e=(new Gn).translate([512*p,0,0]).multiplyLeft($e)),super(Un(ht({},t),{width:g,height:_,viewMatrix:$e,longitude:r,latitude:i,zoom:s,orthographic:d,fovyRadians:W,aspect:G,focalDistance:ge,near:Ne,far:Ge})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=x,this.orthographic=d,this._subViewports=f?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(Un(ht({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return sV(t,i)}panByPosition(t,i){const r=_f(i,this.pixelUnprojectionMatrix),o=Ig([],this.projectFlat(t),KM([],r)),a=Ig([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=dV(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=cV(ht({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function eI(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof _V){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function yV(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=HE([],[o,a,l,1],t)),i){case Di.LNGLAT:return eI([o,a,l],e,s);case Di.LNGLAT_OFFSETS:return eI([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Di.METER_OFFSETS:return eI(sV(r,[o,a,l]),e,s);case Di.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const $oe={10241:9987,10240:9729,10242:33071,10243:33071},tI={},Koe={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||d0(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>nI(n,e)},accessor:{validate(n,e){const t=KE(n);return"function"===t||t===KE(e.value)},equal:(n,e,t)=>"function"==typeof e||nI(n,e)},array:{validate:(n,e)=>e.optional&&!n||d0(n),equal:(n,e,t)=>t.compare?nI(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof Oa)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new Oa(t,Un(ht({},e),{parameters:ht(ht(ht({},$oe),i),n.props.textureParameters)}));return tI[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof Oa)||tI[n.id]&&(n.delete(),delete tI[n.id])}(n)}}};function nI(n,e){if(n===e)return!0;if(!d0(n)||!d0(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function Xoe(n,e){switch(KE(e)){case"object":return u0(n,e);case"array":return u0(n,{type:"array",value:e,compare:!1});case"boolean":return u0(n,{type:"boolean",value:e});case"number":return u0(n,{type:"number",value:e});case"function":return u0(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function u0(n,e){return"type"in e?ht(ht({name:n},Koe[e.type]),e):"value"in e?ht({name:n,type:KE(e.value)},e):{name:n,type:"object",value:e}}function d0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function KE(n){return d0(n)?"array":null===n?"null":typeof n}const{COMPONENT:iI,ASYNC_ORIGINAL:YE,ASYNC_RESOLVED:h0,ASYNC_DEFAULTS:XE}=VE;function Qoe(){const n=this,e=vV(n.constructor),t=Object.create(e);t[iI]=n,t[YE]={},t[h0]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function vV(n){return QE(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=vV(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=Xoe(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(QE(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=QE(n,"layerName")||QE(n,"componentName");return e||Oi.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=ht(ht({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=nae(o))}n[XE]=t,n[YE]={},Object.defineProperties(n,i)}(o,a);const l=ht(ht({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])bV(this,s)||(this[s]=i);Oi.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function nae(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||JB(e)?this[YE][n]=e:this[h0][n]=e},get(){if(this[h0]){if(n in this[h0])return this[h0][n]||this[XE][n];if(n in this[YE]){const e=this[iI]&&this[iI].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[XE][n]}}return this[XE][n]}}}function bV(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function QE(n,e){return bV(n,e)&&n[e]}function rI(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:rae,ASYNC_RESOLVED:sae,ASYNC_DEFAULTS:oae}=VE,aae=Object.freeze({});class wV{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=aae,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[sae]||{},i=e[rae]||e,r=e[oae]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(JB(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return ni(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var f,c=!0,d=!1;try{for(var g,_,p=rI(t);c=(g=yield p.next()).done,_=yield g.value,!c;c=!0){const A=_,{dataTransform:W}=i.component?i.component.props:{};a=W?W(A,a):a.concat(A),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(A){d=!0,f=A}finally{try{!c&&null!=p.return&&(yield p.return())}finally{if(d)throw f}}const x=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;x&&x(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:EV,ASYNC_RESOLVED:SV,ASYNC_DEFAULTS:lae}=VE,cae={};let uae=0,dae=(()=>{class n{constructor(){this.props=Qoe.apply(this,arguments),this.id=this.props.id,this.count=uae++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[lae])s in i[SV]?r[s]=i[SV][s]:s in i[EV]&&(r[s]=i[EV][s]);return new this.constructor(ht(ht(ht({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new wV({})}}return n.componentName="Component",n.defaultProps=cae,n})();class hae extends wV{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const oc=n=>"function"==typeof n,Xd=n=>null!==n&&"object"==typeof n,CV=n=>Xd(n)&&n.constructor==={}.constructor,fae=n=>n&&"function"==typeof n[Symbol.iterator],pae=n=>n&&"function"==typeof n[Symbol.asyncIterator],f0=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Fg=n=>"undefined"!=typeof Blob&&n instanceof Blob,AV=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||Xd(n)&&oc(n.tee)&&oc(n.cancel)&&oc(n.getReader))(n)||(n=>Xd(n)&&oc(n.read)&&oc(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function yf(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function sI(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function oI(n){var e,t;let i;return yf(n,"null loader"),yf(sI(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=Un(ht({},n=n[0]),{options:ht(ht({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const Uc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},aI=Uc.global||Uc.self||Uc.window||{},bae="object"!=typeof process||"[object process]"!==String(process)||process.browser,TV="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);TV&&parseFloat(TV[1]);const cI={};function wae(n){for(const e in cI)n.startsWith(e)&&(n=n.replace(e,cI[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const Eae=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Sae=/^([-\w.]+\/[-\w.+]+)/;function xae(n){const e=Sae.exec(n);return e?e[1]:n}function DV(n){const e=Eae.exec(n);return e?e[1]:""}const Cae=/\?.*/;function ZE(n){if(f0(n)){const e=uI(n.url||"");return{url:e,type:xae(n.headers.get("content-type")||"")||DV(e)}}return Fg(n)?{url:uI(n.name||""),type:n.type||""}:"string"==typeof n?{url:uI(n),type:DV(n)}:{url:"",type:""}}function Aae(n){return f0(n)?n.headers["content-length"]||-1:Fg(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function uI(n){return n.replace(Cae,"")}function MV(n){return dI.apply(this,arguments)}function dI(){return(dI=ni(function*(n){if(f0(n))return n;const e={},t=Aae(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=ZE(n);r&&(e["content-type"]=r);const s=yield Mae(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function Tae(n){return hI.apply(this,arguments)}function hI(){return(hI=ni(function*(n){if(!n.ok){const e=yield Dae(n);throw new Error(e)}})).apply(this,arguments)}function Dae(n){return fI.apply(this,arguments)}function fI(){return(fI=ni(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function Mae(n){return pI.apply(this,arguments)}function pI(){return(pI=ni(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${Iae(n.slice(0,5))}`:null})).apply(this,arguments)}function Iae(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function IV(n,e){return gI.apply(this,arguments)}function gI(){return(gI=ni(function*(n,e){if("string"==typeof n){n=wae(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield MV(n)})).apply(this,arguments)}function Wn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const RV=new iM({id:"loaders.gl"});class Rae{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const OV={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){Wn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Nae={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function mI(){aI.loaders=aI.loaders||{};const{loaders:n}=aI;return n._state=n._state||{},n._state}const _I=()=>{const n=mI();return n.globalOptions=n.globalOptions||ht({},OV),n.globalOptions};function Pae(n,e,t,i){return t=t||[],function(n,e){PV(n,null,OV,Nae,e);for(const t of e)PV(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=ht({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new Rae),LV(r,_I()),LV(r,e),r}(e,n,i)}function NV(n,e){const t=_I(),i=n||t;return"function"==typeof i.fetch?i.fetch:Xd(i.fetch)?r=>IV(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:IV}function PV(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&Xd(n[a]),c="baseUri"===a&&!e,d="workerUrl"===a&&e;if(!(a in t)&&!c&&!d)if(a in i)RV.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const f=Lae(a,r);RV.warn(`${s} loader option '${o}${a}' not recognized. ${f}`)()}}}function Lae(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function LV(n,e){for(const t in e)t in e&&(n[t]=CV(e[t])&&CV(n[t])?ht(ht({},n[t]),e[t]):e[t])}function zc(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function jae(n,e="3.0.12"){return zc(n,"no worker provided"),!(!e||!n.version)}const Hc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Vae=Hc.global||Hc.self||Hc.window||{},yI="object"!=typeof process||"[object process]"!==String(process)||process.browser,vI="function"==typeof importScripts,Uae="undefined"!=typeof window&&void 0!==window.orientation,kV="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),bI=(kV&&parseFloat(kV[1]),new Map);function BV(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function jV(n,e=!0,t){const i=t||new Set;if(n)if(VV(n))i.add(n);else if(VV(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)jV(n[r],e,i);return void 0===t?Array.from(i):[]}function VV(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const wI=()=>{};class UV{static isSupported(){return"undefined"!=typeof Worker}constructor(e){Wn(this,"name",void 0),Wn(this,"source",void 0),Wn(this,"url",void 0),Wn(this,"terminated",!1),Wn(this,"worker",void 0),Wn(this,"onMessage",void 0),Wn(this,"onError",void 0),Wn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;zc(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=wI,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=wI,this.onError=wI,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||jV(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){zc(n.source&&!n.url||!n.source&&n.url);let e=bI.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?BV(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),bI.set(n.url,e)),n.source&&(e=BV(n.source),bI.set(n.source,e))),zc(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class $ae{constructor(e,t){Wn(this,"name",void 0),Wn(this,"workerThread",void 0),Wn(this,"isRunning",void 0),Wn(this,"result",void 0),Wn(this,"_resolve",void 0),Wn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){zc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){zc(this.isRunning),this.isRunning=!1,this._reject(e)}}class Wae{constructor(e){Wn(this,"name","unnamed"),Wn(this,"source",void 0),Wn(this,"url",void 0),Wn(this,"maxConcurrency",1),Wn(this,"maxMobileConcurrency",1),Wn(this,"onDebug",()=>{}),Wn(this,"reuseWorkers",!0),Wn(this,"props",{}),Wn(this,"jobQueue",[]),Wn(this,"idleQueue",[]),Wn(this,"count",0),Wn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=ht(ht({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return ni(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return ni(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new $ae(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new UV({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Uae?this.maxMobileConcurrency:this.maxConcurrency}}const qae={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Bu{static isSupported(){return UV.isSupported()}static getWorkerFarm(e={}){return Bu._workerFarm=Bu._workerFarm||new Bu({}),Bu._workerFarm.setProps(e),Bu._workerFarm}constructor(e){Wn(this,"props",void 0),Wn(this,"workerPools",new Map),this.props=ht({},qae),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=ht(ht({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new Wae({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function Yae(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return zc(r),r}function Xae(n,e){return!!Bu.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function Qae(n,e,t,i,r){return EI.apply(this,arguments)}function EI(){return(EI=ni(function*(n,e,t,i,r){const s=n.id,o=Yae(n,t),l=Bu.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",Zae.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function Zae(n,e,t,i){return SI.apply(this,arguments)}function SI(){return(SI=ni(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}Wn(Bu,"_workerFarm",void 0);var HV=tt(521);function GV(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return HV.toArrayBuffer?HV.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function nle(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function $V(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function ile(n){return CI.apply(this,arguments)}function CI(){return(CI=ni(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=rI(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return nle(...e)})).apply(this,arguments)}const ole=262144;function WV(n){this.wrapped=n}function p0(n){return new WV(n)}function g0(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,d=c instanceof WV;Promise.resolve(d?c.wrapped:c).then(function(f){d?r("return"===o?"return":"next",f):s(l.done?"return":"normal",f)},function(f){r("throw",f)})}catch(f){s("throw",f)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var d={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=d:(e=t=d,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function TI(n){return function(){return new g0(n.apply(this,arguments))}}function DI(){return(DI=TI(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield p0(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function qV(n,e){return bae?function(n,e){return MI.apply(this,arguments)}(n,e):function(n,e){return II.apply(this,arguments)}(n,e)}function MI(){return(MI=TI(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield p0(r);if(s)return;yield GV(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function II(){return(II=TI(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=rI(n);t=(o=yield p0(s.next())).done,a=yield p0(o.value),!t;t=!0)yield GV(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield p0(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function hle(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=ole}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(Fg(n))return function(n,e){return DI.apply(this,arguments)}(n,e);if(AV(n))return qV(n,e);if(f0(n))return qV(n.body,e);throw new Error("makeIterator")}g0.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},g0.prototype.next=function(n){return this._invoke("next",n)},g0.prototype.throw=function(n){return this._invoke("throw",n)},g0.prototype.return=function(n){return this._invoke("return",n)};const RI="Cannot convert supplied data type";function fle(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(RI)}function ple(n,e,t){return OI.apply(this,arguments)}function OI(){return(OI=ni(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return fle(n,e);if(Fg(n)&&(n=yield MV(n)),f0(n)){const r=n;return yield Tae(r),e.binary?yield r.arrayBuffer():yield r.text()}if(AV(n)&&(n=hle(n,t)),fae(n)||pae(n))return ile(n);throw new Error(RI)})).apply(this,arguments)}function mle(n,e,t=null){if(t)return t;const i=ht({fetch:NV(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function _le(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const KV=()=>{const n=mI();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function YV(n){const e=KV();n=Array.isArray(n)?n:[n];for(const t of n){const i=oI(t);e.find(r=>i===r)||e.unshift(i)}}const vle=/\.([^.]+)$/;function ble(n){return FI.apply(this,arguments)}function FI(){return(FI=ni(function*(n,e=[],t,i){if(!QV(n))return null;let r=XV(n,e,Un(ht({},t),{nothrow:!0}),i);if(r)return r;if(Fg(n)&&(r=XV(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(ZV(n));return r})).apply(this,arguments)}function XV(n,e=[],t,i){if(!QV(n))return null;if(e&&!Array.isArray(e))return oI(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...KV()),function(n){for(const e of n)oI(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=ZE(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=LI(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&vle.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||LI(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(Ale(e,t))return t}else if(ArrayBuffer.isView(e)){if(JV(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&JV(e,0,t))return t;return null}(e,n),a=a||LI(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(ZV(n));return s}function QV(n){return!(n instanceof Response&&204===n.status)}function ZV(n){const{url:e,type:t}=ZE(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?kI(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?kI(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function LI(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function Ale(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function JV(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===kI(n,e,i.length);default:return!1}}(n,e,t,r))}function kI(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function JE(n,e,t,i){return BI.apply(this,arguments)}function BI(){return(BI=ni(function*(n,e,t,i){zc(!i||"object"==typeof i),e&&!Array.isArray(e)&&!sI(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=ZE(n),o=_le(e,i),a=yield ble(n,o,t);return a?(i=mle({url:r,parse:JE,loaders:o},t=Pae(t,a,o,r),i),yield Mle(a,n,t,i)):null})).apply(this,arguments)}function Mle(n,e,t,i){return jI.apply(this,arguments)}function jI(){return(jI=ni(function*(n,e,t,i){if(jae(n),e=yield ple(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(Xae(n,t))return yield Qae(n,e,t,i,JE);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw zc(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function eS(n,e,t,i){return VI.apply(this,arguments)}function VI(){return(VI=ni(function*(n,e,t,i){!Array.isArray(e)&&!sI(e)&&(t=e,e=void 0);const r=NV(t);let s=n;return"string"==typeof n&&(s=yield r(n)),Fg(n)&&(s=yield r(n)),yield JE(s,e,t)})).apply(this,arguments)}const eU=_r(2,24)-1,Fle=Object.freeze([]),Lle=UE(({oldViewport:n,viewport:e})=>n.equals(e));let Gc=new Uint8ClampedArray(0);const kle={data:{type:"data",value:Fle,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=Un(ht({},r),{fetch:Un(ht({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:eS(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):eS(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Di.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let UI=(()=>{class n extends dae{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=yV(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=ZM(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=ht({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Di.DEFAULT&&(t=i.isGeospatial?Di.LNGLAT:Di.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:d}=Jj(t,i,r),f=yV(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:d});d&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(f,f,t.projectPosition(l||c));return f}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Di.DEFAULT||t===Di.LNGLAT||t===Di.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){ic(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=qse(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const d of c)o.invalidateAll(d);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:d}=o.attributes,f=c||d;f&&(l&&f.constant&&(f.constant=!1,o.invalidate(f.id)),!f.value&&!l&&(f.constant=!0,f.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!Lle({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(Gc.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>eU&&Oi.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Gc=Yy.allocate(Gc,i,{size:3,copy:!0,maxCount:Math.max(i,eU)});const s=Math.floor(Gc.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),Gc[3*a+0]=o[0],Gc[3*a+1]=o[1],Gc[3*a+2]=o[2]}t.value=Gc.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==Gc.buffer&&(r.value=Gc.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){bo("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();bo("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){bo("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];Ou(this.context.gl,{polygonOffset:l}),nc(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const d of this.props.extensions)d.draw.call(this,c,d);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&bo("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=$j({newProps:n,oldProps:e,propTypes:qM(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&Wj(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&Wj(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Vse(n,e),transitionsChanged:kse(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=qM(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new Dse(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){ic(!this.internalState&&!this.state),ic(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new hae({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Oi.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new Nse(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){bo("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=kle,n})(),jle=(()=>{class n extends UI{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:d,coordinateSystem:f,coordinateOrigin:p,wrapLongitude:g,positionFormat:_,modelMatrix:x,extensions:A,fetch:W,_subLayerProps:G}=this.props,ge={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:d,coordinateSystem:f,coordinateOrigin:p,wrapLongitude:g,positionFormat:_,modelMatrix:x,extensions:A,fetch:W},Ne=G&&G[t.id],Ge=Ne&&Ne.updateTriggers,$e=t.id||"sublayer";if(Ne){const at=this.constructor._propTypes,St=t.type?t.type._propTypes:{};for(const Rt in Ne){const Pt=St[Rt]||at[Rt];Pt&&"accessor"===Pt.type&&(Ne[Rt]=this.getSubLayerAccessor(Ne[Rt]))}}Object.assign(ge,t,Ne),ge.id="".concat(this.props.id,"-").concat($e),ge.updateTriggers=ht(ht({all:this.props.updateTriggers.all},t.updateTriggers),Ge);for(const at of A){const St=at.getSubLayerProps.call(this,at);St&&Object.assign(ge,St,{updateTriggers:Object.assign(ge.updateTriggers,St.updateTriggers)})}return ge}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=CM(t,Boolean),this.internalState.subLayers=t),bo("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const Vle=/([0-9]+\.?[0-9]*)(%|px)/;function tS(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match(Vle);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function nS(n,e){return n.relative?Math.round(n.position*e):n.position}function m0(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&m0(i,r)))return!1}return!0}class zI{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:d=1e3,modelMatrix:f=null,viewportInstance:p=null,type:g=Pg}=e;ic(!p||p instanceof Pg),this.viewportInstance=p,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=Un(ht({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:d,modelMatrix:f}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):m0(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=ht({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:nS(this._x,e),y:nS(this._y,t),width:nS(this._width,e),height:nS(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),ht(ht({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(ht(ht(ht({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=tS(e),this._y=tS(t),this._width=tS(i),this._height=tS(r)}}const _0=()=>{},tU={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:_0,onTransitionInterrupt:_0,onTransitionEnd:_0};class Ule{constructor(e,t={}){this.ControllerState=e,this.props=ht(ht({},tU),t),this.propsInTransition=null,this.transition=new o0(t.timeline),this.onViewStateChange=t.onViewStateChange||_0,this.onStateChange=t.onStateChange||_0,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=ht(ht({},tU),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=ht(ht({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(ht(ht({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const nU=["longitude","latitude","zoom","bearing","pitch"],Hle=["longitude","latitude","zoom"];class iU extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!Xy(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];ic(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:nU,extract:nU,required:Hle}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=CE(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(ht(ht({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,CE(e.around,t.around,i)))}return r}}const Qd={transitionDuration:0},Gle={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},rS=n=>1-(1-n)*(1-n),Lg_WHEEL=["wheel"],Lg_PAN=["panstart","panmove","panend"],Lg_PINCH=["pinchstart","pinchmove","pinchend"],Lg_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],Lg_DOUBLE_TAP=["doubletap"],Lg_KEYBOARD=["keydown"];class HI{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new Ule(e,Un(ht({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&Un(ht({},Gle),{transitionInterpolator:new iU({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(ht(ht({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,d=Boolean(this.onViewStateChange);this.toggleEvents(Lg_WHEEL,d&&i),this.toggleEvents(Lg_PAN,d&&(r||s)),this.toggleEvents(Lg_PINCH,d&&(a||l)),this.toggleEvents(Lg_TRIPLE_PAN,d&&l),this.toggleEvents(Lg_DOUBLE_TAP,d&&o),this.toggleEvents(Lg_KEYBOARD,d&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=ht(ht({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,Qd,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,Qd,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,Un(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:rS}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Qd,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,Un(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:rS}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,Un(ht({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,Qd,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Qd,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,Un(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:rS}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,Qd,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,Qd,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,Un(ht({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:rS}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?Un(ht({},t),{transitionInterpolator:new iU(Un(ht({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:Qd}}class rU{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const Zd_target=[0,0,0];class sS extends rU{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=Zd_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:d=-(1/0),maxZoom:f=Infinity,startPanPosition:p,startRotatePos:g,startRotationX:_,startRotationOrbit:x,startZoomPosition:A,startZoom:W}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:d,maxZoom:f}),this._state={startPanPosition:p,startRotatePos:g,startRotationX:_,startRotationOrbit:x,startZoomPosition:A,startZoom:W},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let d=(e[0]-r[0])/a;(s<-90||s>90)&&(d*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*d}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=ht({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(Un(ht({},this._viewportProps),{zoom:a}));return this._getUpdatedState(ht({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),gf(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new sS(ht(ht(ht({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=gf(r,i,t),e.rotationX=gf(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class Wle extends HI{constructor(e){super(sS,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class qle extends HI{constructor(e){e.dragMode=e.dragMode||"pan",super(sS,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const Kle=(new Gn).lookAt({eye:[0,0,1]});function Yle({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new Gn).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class Xle extends Pg{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(Un(ht({},e),{longitude:null,position:a,viewMatrix:Kle.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:Yle({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=Ig([],e,KM([],_f(t,this.pixelUnprojectionMatrix)));return{target:Ig([],this.center,r)}}}let Qle=(()=>{class n extends zI{constructor(t){super(Un(ht({},t),{type:Xle}))}get controller(){return this._getControllerProps({type:qle})}}return n.displayName="OrthographicView",n})();const oS=Math.PI/180;function Zle({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*oS/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new Gn).lookAt({eye:l,up:a});c.rotateX(i*oS),"Z"===t?c.rotateZ(r*oS):c.rotateY(r*oS);const d=Math.pow(2,s)/(n||1);return c.scale(d),c}class Jle extends Pg{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(Un(ht({},e),{longitude:null,viewMatrix:Zle({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=_f([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let ece=(()=>{class n extends zI{constructor(t={}){const{orbitAxis:i="Z"}=t;super(Un(ht({},t),{orbitAxis:i,type:Jle}))}get controller(){return this._getControllerProps({type:Wle})}}return n.displayName="OrbitView",n})();const tce=[255,255,255],nce=1;let ice=0;class sU{constructor(e={}){const{color:t=tce}=e,{intensity:i=nce}=e;this.id=e.id||"ambient-".concat(ice++),this.color=t,this.intensity=i,this.type="ambient"}}const rce=[255,255,255],sce=1,oce=[0,0,-1];let ace=0;class oU{constructor(e={}){const{color:t=rce}=e,{intensity:i=sce}=e,{direction:r=oce}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(ace++),this.color=t,this.intensity=i,this.type="directional",this.direction=new vo(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class aU{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=ht({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class GI extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=ht({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return Ou(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){Ou(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,d=i&&i[c.id];r(c);const f=this._getDrawLayerParams(c,e);e.view=d;const p=c.subViewports||[c];for(const g of p){e.viewport=g;const _=this._drawLayersInViewport(o,e,f);a.push(_)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=lU(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let d=0;d<t.length;d++){const f=t[d],p=this._shouldDrawLayer(f,c,r),_={shouldDrawLayer:p,layerRenderIndex:l(f,p)};p&&(_.moduleParameters=this._getModuleParameters(f,s,i,o),_.layerParameters=this.getLayerParameters(f,d)),a[d]=_}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=vg(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;nc(e,{scissorTest:!0,scissor:a},()=>mM(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Ou(e,{viewport:a});for(let c=0;c<t.length;c++){const d=t[c],{shouldDrawLayer:f,layerRenderIndex:p,moduleParameters:g,layerParameters:_}=o[c];if(f&&d.props.pickable&&l.pickableCount++,d.isComposite)l.compositeCount++;else if(f){l.visibleCount++,g.viewport=r;try{d.drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:_})}catch(x){d.raiseError(x,"drawing ".concat(d," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:vg(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function lU(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const d=t[l]=t[l]||lU(e[l],e);c=d(r,s),t[a]=d}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class dce extends GI{constructor(e,t){super(e,t),this.shadowMap=new Oa(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Sg(e,{format:33189,width:1,height:1}),this.fbo=new Is(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;nc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=vg(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(Un(ht({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const fce=Object.keys(Di).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Di[n],";")).join(""),pce=Object.keys(kc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(kc[n],";")).join(""),gce="".concat(fce,"\n").concat(pce,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),mce={},$I={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:gce,getUniforms:function(n=mce){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Di.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Di.DEFAULT&&(i=n.isGeospatial?Di.LNGLAT:Di.CARTESIAN);const o=Soe({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||boe,o}(n):{}}},bce=UE(function({viewport:n,center:e}){return new Gn(n.viewProjectionMatrix).invert().transform(e)}),wce=UE(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=_f([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new vo(n.center).negate()),l=s.map(d=>a.transform(d)),c=(new Gn).ortho({left:Math.min(...l.map(d=>d[0])),right:Math.max(...l.map(d=>d[0])),bottom:Math.min(...l.map(d=>d[1])),top:Math.max(...l.map(d=>d[1])),near:Math.min(...l.map(d=>-d[2])),far:Math.max(...l.map(d=>-d[2]))});t.push(c.multiplyRight(o))}return t}),Ece=[0,0,0,1],Sce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],WI={name:"shadow",dependencies:[$I],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Ece,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=bce({viewport:n.viewport,center:e.project_uCenter}),r=[],s=wce({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new vo(n.viewport.center).negate());e.project_uCoordinateSystem===Di.LNGLAT&&e.project_uProjectionMode===kc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(Sce),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},Dce={color:[255,255,255],intensity:1},cU=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Mce=[0,0,0,200/255];class qI extends aU{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=Mce,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=r0.getDefaultProgramManager(e),WI&&this.programManager.addDefaultModule(WI)),this.dummyShadowMap||(this.dummyShadowMap=new Oa(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(WI),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new Gn).lookAt({eye:new vo(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new dce(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new sU(Dce),this.directionalLights.push(new oU(cU[0]),new oU(cU[1])))}}let Ice=1,Rce=1;class uU{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=Ice++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=Rce++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class Oce{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=eS(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class Nce{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new Oce(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const Pce=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},$I],Fce=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Lce(n){const e=r0.getDefaultProgramManager(n);for(const t of Pce)e.addDefaultModule(t);for(const t of Fce)e.addShaderHook(t);return e}const jce=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class Vce{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new Nce({gl:e,protocol:"deck://"}),this.context=Un(ht({},jce),{layerManager:this,gl:e,deck:t,programManager:e&&Lce(e),stats:i||new cM({id:"deck.gl"}),viewport:r||new Pg({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new uU,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){bo("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=CM(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return bo("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?Oi.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&Oi.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class Uce{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=CM(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!m0(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Oi.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(ht({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=Un(ht(ht(ht({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let d=r[a.id];a.controller&&!d&&(s=!0),(s||!a.controller)&&d&&(d.finalize(),d=null),this.controllers[a.id]=this._updateController(a,l,c,d),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class Hce extends rU{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:d=20,minZoom:f=0,maxPitch:p=60,minPitch:g=0,startPanLngLat:_,startZoomLngLat:x,startRotatePos:A,startBearing:W,startPitch:G,startZoom:ge,normalize:Ne}={}){ic(Number.isFinite(s)),ic(Number.isFinite(r)),ic(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:d,minZoom:f,maxPitch:p,minPitch:g,normalize:Ne}),this._state={startPanLngLat:_,startZoomLngLat:x,startRotatePos:A,startBearing:W,startPitch:G,startZoom:ge},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(Un(ht({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(Un(ht({},this._viewportProps),{zoom:o}));return this._getUpdatedState(ht({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=ht({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(ht(ht(ht({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=gf(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=gf(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=nV(t+180,360)-180),(o<-180||o>180)&&(o=nV(o+180,360)-180);const a=YM(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=Yd([0,l])[1];if(i<c)i=c;else{const d=Yd([0,512-l])[1];i>d&&(i=d)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return gf(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=gf(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let d=0;return r>0?Math.abs(l-o)>5&&(d=r/(o-l)*1.2):r<0&&o>5&&(d=1-s/o),d=Math.min(1,Math.max(-1,d)),{deltaScaleX:c,deltaScaleY:d}}}class Gce extends HI{constructor(e){e.dragMode=e.dragMode||"pan",super(Hce,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(ht(ht({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let $ce=(()=>{class n extends zI{constructor(t){super(Un(ht({},t),{type:_V}))}get controller(){return this._getControllerProps({type:Gce})}}return n.displayName="MapView",n})();const Wce=new qI;class qce{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!m0(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof qI)||this._internalEffects.push(Wce)}}class Kce extends GI{}const hU={blendFunc:[1,0,32771,0],blendEquation:32774};class fU extends GI{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:d},pass:f="picking",redrawReason:p,pickZ:g}){const _=this.gl;return this.pickZ=g,nc(_,Un(ht({scissorTest:!0,scissor:[a,l,c,d],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},hU),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:f,redrawReason:p})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:Un(ht({},hU),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return ht(ht({},e.props.parameters),i)}}class Xce{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Kce(e),this.pickLayersPass=new fU(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||Is.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(Un(ht({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,bo("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Is(this.gl),new Is(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const Qce={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function Zce({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let d=r*r,f=-1,p=0;for(let g=0;g<c;g++){const _=g+a-i,x=_*_;if(x>d)p+=4*l;else for(let A=0;A<l;A++){if(n[p+3]-1>=0){const G=A+o-t,ge=G*G+x;ge<=d&&(d=ge,f=p)}p+=4}}if(f>=0){const g=n[f+3]-1,_=n.slice(f,f+4),x=e[g];if(x){const A=x.decodePickingColor(_),W=Math.floor(f/4/l);return{pickedColor:_,pickedLayer:x,pickedObjectIndex:A,pickedX:o+(f/4-W*l),pickedY:a+W}}Oi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Qce}function pU({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,d=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(p=>i({layer:l,viewport:p,isPicking:!0,renderPass:"picking:".concat(e)}))),f=d&&d.unproject([s-d.x,o-d.y],{targetZ:a});return{color:null,layer:null,viewport:d,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:f,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function eue(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const f=t.index,p=t.layerId,g=o&&o.props.id;if(g!==p||a!==f){if(g!==p){const _=r.find(x=>x.props.id===p);_&&l.unshift(_)}t.layerId=g,t.index=a,t.info=null}}const c=pU(n),d=new Map;return d.set(null,c),l.forEach(f=>{let p=ht({},c);f===o&&(p.color=s,p.index=a,p.picked=!0),p=gU({layer:f,info:p,mode:i}),f===o&&"hover"===i&&(t.info=p),d.set(p.layer.id,p),"hover"===i&&p.layer.updateAutoHighlight(p)}),d}function gU({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class nue{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new fU(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(p=>p.id===o):null,c=a&&r.find(p=>p.id===a)||r[0],d=c&&c.unproject([e-c.x,t-c.y]),f={x:e,y:t,viewport:c,coordinate:d,layer:l};return l?ht(ht({},s),f):Object.assign(f,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Is(e),Is.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Is(e),this.depthFBO.attach({36064:new Oa(e,{format:pi(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(Oi.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:d}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:pU({viewports:i,x:r,y:s})};this._resizeBuffer();const f=vg(this.gl),p=oM(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],_=Math.round(o*f),{width:x,height:A}=this.pickingFBO,W=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceWidth:x,deviceHeight:A});let G;const ge=[],Ne={};for(let Ge=0;Ge<a;Ge++){const at=Zce({pickedColors:W&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:d,deviceRect:W,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceRect:W});let St;if(at.pickedLayer&&c&&this.depthFBO&&(St=this._drawAndSample({layers:[at.pickedLayer],views:t,viewports:i,onViewportActive:d,deviceRect:{x:at.pickedX,y:at.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),at.pickedColor&&Ge+1<a){const Rt=at.pickedColor[3]-1;Ne[Rt]=!0,e[Rt].disablePickingIndex(at.pickedObjectIndex)}G=eue({pickInfo:at,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:St,pixelRatio:f});for(const Rt of G.values())Rt.layer&&ge.push(Rt);if(!at.pickedColor)break}for(const Ge in Ne)e[Ge].restorePickingColors();return{result:ge,emptyInfo:G&&G.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:d}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const f=vg(this.gl),p=oM(this.gl,[r,s],!0),g=p.x,_=p.y+p.height,x=oM(this.gl,[r+o,s+a],!0),W=x.y,Ne=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):Oi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:d,deviceRect:{x:g,y:W,width:x.x+x.width-g,height:_-W},pass:"picking:".concat(l),redrawReason:l}),layers:e}),Ge=new Map,$e=Number.isFinite(c);for(let at=0;at<Ne.length&&!($e&&Ge.size>=c);at++){const St=Ne[at];let Rt={color:St.pickedColor,layer:null,index:St.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:f};Rt=gU({layer:St.pickedLayer,info:Rt,mode:l}),Ge.has(Rt.object)||Ge.set(Rt.object,Rt)}return Array.from(Ge.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:d,y:f,width:p,height:g}=s,_=new(l?Float32Array:Uint8Array)(p*g*4);return xE(c,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:_}),_}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const iue={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class rue{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,iue),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function mU(n,e){if(!n)throw new Error(e)}const $c={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},_U=$c.global||$c.self||$c.window,oue="object"!=typeof process||"[object process]"!==String(process)||process.browser,yU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:aue}=(yU&&parseFloat(yU[1]),_U),KI="undefined"!=typeof Image,YI="undefined"!=typeof ImageBitmap,lue=Boolean(aue),XI=!!oue||lue;function vU(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function bU(n){switch(vU(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const due=/^data:image\/svg\+xml/,hue=/\.svg((\?|#).*)?$/;function QI(n){return n&&(due.test(n)||hue.test(n))}function fue(n,e){if(QI(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return EU(n,e)}function EU(n,e){if(QI(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function SU(n,e,t){return ZI.apply(this,arguments)}function ZI(){return(ZI=ni(function*(n,e,t){const i=fue(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield pue(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function pue(n,e){return JI.apply(this,arguments)}function JI(){return(JI=ni(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const gue={};let xU=!0;function mue(n,e,t){return eR.apply(this,arguments)}function eR(){return(eR=ni(function*(n,e,t){let i;i=QI(t)?yield SU(n,e,t):EU(n,t);const r=e&&e.imagebitmap;return yield _ue(i,r)})).apply(this,arguments)}function _ue(n){return tR.apply(this,arguments)}function tR(){return(tR=ni(function*(n,e=null){if((yue(e)||!xU)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),xU=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function yue(n){for(const e in n||gue)return!1;return!0}const Wc=!1,y0=!0;function nR(n){const e=v0(n);return function(n){const e=v0(n);return e.byteLength>=24&&2303741511===e.getUint32(0,Wc)?{mimeType:"image/png",width:e.getUint32(16,Wc),height:e.getUint32(20,Wc)}:null}(e)||function(n){const e=v0(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,Wc)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Wc);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Wc),width:e.getUint16(s+7,Wc)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,Wc)}return null}(e)||function(n){const e=v0(n);return e.byteLength>=10&&1195984440===e.getUint32(0,Wc)?{mimeType:"image/gif",width:e.getUint16(6,y0),height:e.getUint16(8,y0)}:null}(e)||function(n){const e=v0(n);return e.byteLength>=14&&16973===e.getUint16(0,Wc)&&e.getUint32(2,y0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,y0),height:e.getUint32(22,y0)}:null}(e)}function v0(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function xue(n,e){const{mimeType:t}=nR(n)||{},{_parseImageNode:i}=_U;return mU(i),i(n,t,e)}function iR(){return(iR=ni(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(Aue(r)){case"imagebitmap":a=yield mue(n,e,s);break;case"image":a=yield SU(n,e,s);break;case"data":a=yield xue(n,e);break;default:mU(!1)}return"data"===r&&(a=bU(a)),a})).apply(this,arguments)}function Aue(n){switch(n){case"auto":case"data":return function(){if(YI)return"imagebitmap";if(KI)return"image";if(XI)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return YI||KI||XI;case"imagebitmap":return YI;case"image":return KI;case"data":return XI;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const CU={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return iR.apply(this,arguments)},tests:[n=>Boolean(nR(new DataView(n)))],options:{image:{type:"auto",decode:!0}}},Due={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},b0="8.5.8",aS=Sr.CO.deck&&Sr.CO.deck.VERSION;if(aS&&aS!==b0)throw new Error("deck.gl - multiple versions detected: ".concat(aS," vs ").concat(b0));aS||(Oi.log(1,"deck.gl ".concat(b0))(),Sr.CO.deck=Object.assign(Sr.CO.deck||{},{VERSION:b0,version:b0,log:Oi,_registerLoggers:function(n){MM=n}}),YV([Due,[CU,{imagebitmap:{premultiplyAlpha:"none"}}]]));const Mue=Sr.CO.deck;class lS extends Nu{static isSupported(e,t=[]){const i=pi(e),r=BB(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:tn(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return lS.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const AU=(0,Sr.jU)()&&"undefined"!=typeof document;let jue=0;class Vue{constructor(e={}){const{onCreateContext:t=(A=>vB(A)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:d=!1,createFramebuffer:f=!1,autoResizeViewport:p=!0,autoResizeDrawingBuffer:g=!0,stats:_=ff.get("animation-loop-"+jue++)}=e;let{useDevicePixels:x=!0}=e;"useDevicePixelRatio"in e&&(un.deprecated("useDevicePixelRatio","useDevicePixels")(),x=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:d,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=_,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:p,autoResizeDrawingBuffer:g,useDevicePixels:x}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return tn("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=lS.isSupported(this.gl,["timers"])?new lS(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return ni(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return un.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=AU?new Promise((e,t)=>{AU&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?lM(this.props.gl,e):this.onCreateContext(e),!EE(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){Ou(n,sM)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(un.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(un.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Is(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Uue=tt(524),cS=tt.n(Uue);const zue={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})(cS().PointerEventInput),function(n){n.prototype.handler=function(t){let i=zue[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(cS().MouseInput);const Wue=cS().Manager,qc=cS(),que=qc?[[qc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[qc.Rotate,{enable:!1}],[qc.Pinch,{enable:!1}],[qc.Swipe,{enable:!1}],[qc.Pan,{threshold:0,enable:!1}],[qc.Press,{enable:!1}],[qc.Tap,{event:"doubletap",taps:2,enable:!1}],[qc.Tap,{event:"anytap",enable:!1}],[qc.Tap,{enable:!1}]]:null,MU={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Kue={doubletap:["tap"]},Yue={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},sR={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Xue={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},IU={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Que="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",kg="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let RU=!1;try{const n={get passive(){return RU=!0,!0}};kg.addEventListener("test",n,n),kg.removeEventListener("test",n,n)}catch(n){}const Zue=-1!==Que.indexOf("firefox"),{WHEEL_EVENTS:Jue}=sR,NU=4.000244140625;class nde{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=Jue.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!RU&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;kg.WheelEvent&&(Zue&&e.deltaMode===kg.WheelEvent.DOM_DELTA_PIXEL&&(t/=kg.devicePixelRatio),e.deltaMode===kg.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%NU==0&&(t=Math.floor(t/NU)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:ide}=sR,PU="pointermove",FU="pointerover",LU="pointerout",kU="pointerleave";class rde{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=ide.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===PU&&(this.enableMoveEvent=t),e===FU&&(this.enableOverEvent=t),e===LU&&(this.enableOutEvent=t),e===kU&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:FU,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:LU,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:kU,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:PU,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:sde}=sR,BU="keydown";class ode{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=sde.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===BU&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:BU,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const VU="contextmenu";class ade{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===VU&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:VU,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const lde={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},UU={srcElement:"root",priority:0};class bde{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},UU,i):UU;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let d=l.length-1;for(;d>=0&&!(l[d].priority>=c.priority);)d--;l.splice(d+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:d,once:f}=i[l];if(d(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),f&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:d}=a[l];this.remove(c,d)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=lde[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const wde={events:null,recognizers:null,recognizerOptions:{},Manager:Wue,touchAction:"none",tabIndex:0};class Ede{constructor(e=null,t={}){this.options=Object.assign({},wde,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||que}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(MU).forEach(r=>{const s=this.manager.get(r);s&&MU[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new nde(e,this._onOtherEvent,{enable:!1}),this.moveInput=new rde(e,this._onOtherEvent,{enable:!1}),this.keyInput=new ode(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new ade(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=Kue[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const d in e)this._addEventHandler(d,e[d],i,r,s);return}const{manager:o,events:a}=this,l=IU[e]||e;let c=a.get(l);c||(c=new bde(this),a.set(l,c),c.recognizerName=Xue[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(IU[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=Yue[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function bf(){}const zU={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:bf,onResize:bf,onViewStateChange:bf,onInteractionStateChange:bf,onBeforeRender:bf,onAfterRender:bf,onLoad:bf,onError:(n,e)=>Oi.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class dS{constructor(e){e=ht(ht({},zU),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&Oi.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Sr.qs)()&&Oi.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new cM({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Yy.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Oi.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Oi.removed("onLayerClick","onClick")(),e.initialViewState&&!m0(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](ht({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),ic(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:d,autoResizeDrawingBuffer:f}=e;return new Vue({width:t,height:i,useDevicePixels:d,autoResizeDrawingBuffer:f,autoResizeViewport:!1,gl:r,onCreateContext:p=>vB(Un(ht(ht({},s),p),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:p=>this._setGLContext(p.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new $ce({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,lM(e,{enable:!0,copyState:!0})),this.tooltip=new rue(this.canvas),Ou(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new uU;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Ede(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in iB)this.eventManager.on(r,this._onEvent);this.viewManager=new Uce({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new Vce(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new qce,this.deckRenderer=new Xce(e),this.deckPicker=new nue(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;Ou(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(ht({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Oi.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=Un(ht({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=iB[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=ff.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}dS.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(aU)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},dS.defaultProps=zU,dS.VERSION=Mue.VERSION;const HU={name:"project32",dependencies:[$I],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},GU="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Cde={lightSources:{}};function lR({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const cR={name:"lights",vs:GU,fs:GU,getUniforms:function $U(n=Cde){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?lR(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=lR(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=lR(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return $U({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Tde={};const Mde={name:"phong-lighting",dependencies:[cR],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=Tde){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},Rde={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},KU=ht({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=Rde){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),YU={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class hS{static get DRAW_MODE(){return YU}constructor(e={}){const{id:t=jc("geometry"),drawMode:i=YU.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?ht({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,tn(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(tn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return tn(Number.isFinite(i)),i}}const uR=Math.PI/180,fS=new Float32Array(16),XU=new Float32Array(12);function QU(n,e,t){const i=e[0]*uR,r=e[1]*uR,s=e[2]*uR,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),d=Math.cos(i),f=Math.cos(r),p=t[0],g=t[1],_=t[2];n[0]=p*f*d,n[1]=p*l*d,n[2]=p*-a,n[3]=g*(-l*c+f*a*o),n[4]=g*(f*c+l*a*o),n[5]=g*d*o,n[6]=_*(l*o+f*a*c),n[7]=_*(-f*o+l*a*c),n[8]=_*d*c}function ZU(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const JU={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,d=Array.isArray(s),f=Array.isArray(r),p=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:f&&d&&p;const _=n.value;if(n.constant){let x;g?(fS.set(a),x=ZU(fS)):(x=XU,QU(x,r,s),x.set(o,9)),n.value=new Float32Array(x)}else{let x=e*n.size;const{iterable:A,objectInfo:W}=ZB(i,e,t);for(const G of A){let ge;W.index++,g?(fS.set(c?a:a(G,W)),ge=ZU(fS)):(ge=XU,QU(ge,f?r:r(G,W),d?s:s(G,W)),ge.set(p?o:o(G,W),9)),_[x++]=ge[0],_[x++]=ge[1],_[x++]=ge[2],_[x++]=ge[3],_[x++]=ge[4],_[x++]=ge[5],_[x++]=ge[6],_[x++]=ge[7],_[x++]=ge[8],_[x++]=ge[9],_[x++]=ge[10],_[x++]=ge[11]}}}};function ez(n,e){return e===Di.CARTESIAN||e===Di.METER_OFFSETS||e===Di.DEFAULT&&!n.isGeospatial}function tz(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),Oi.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Fde(n,e){if(n.attributes)return tz(n.attributes,e),n instanceof hS?n:new hS(n);if(n.positions||n.POSITION)return tz(n,e),new hS({attributes:n});throw Error("Invalid mesh")}const Lde={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let kde=(()=>{class n extends UI{getShaders(){const t=!pi(this.context.gl),i={};return vM(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[HU,Mde,KU],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:JU}),this.setState({emptyTexture:new Oa(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||ez(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new BE(this.context.gl,Un(ht({},this.getShaders()),{id:this.props.id,geometry:Fde(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=Lde,n})();const nz={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[cR]};class Bg{constructor(e={}){const{id:t}=e;this.id=t||jc(this.constructor.name),this.display=!0,this.position=new vo,this.rotation=new vo,this.scale=new vo(1,1,1),this.matrix=new Gn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return tn(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return tn(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return tn(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){tn(e),t=t||this.matrix;const i=new Gn(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class w0 extends Bg{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;un.assert(t.every(i=>i instanceof Bg),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new Gn}={}){const i=new Gn(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof w0?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function iz(){var n=new oa(4);return oa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function rz(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function sz(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],d=t[3];return n[0]=i*d+o*a+r*c-s*l,n[1]=r*d+o*l+s*a-i*c,n[2]=s*d+o*c+i*l-r*a,n[3]=o*d-i*a-r*l-s*c,n}var az=Qj,Zde=function(){var n=zB(),e=HB(1,0,0),t=HB(0,1,0);return function(i,r,s){var o=GB(r,s);return o<-.999999?(TE(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&TE(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),rz(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(TE(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();iz(),iz(),function(){var n=new oa(9);oa!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const Jde=[0,0,0,1],the={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nhe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function uz(n){if(!n._animation){const e=nhe[n.componentType],t=the[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const ihe=new Gn,dR=new class extends wM{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return function(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}}(this,e),this.check()}identity(){return function(n){n[0]=0,n[1]=0,n[2]=0,n[3]=1}(this),this.check()}fromAxisRotation(e,t){return rz(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=to(e)}get y(){return this[1]}set y(e){this[1]=to(e)}get z(){return this[2]}set z(e){this[2]=to(e)}get w(){return this[3]}set w(e){this[3]=to(e)}len(){return function(n){return Math.hypot(n[0],n[1],n[2],n[3])}(this)}lengthSquared(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r}(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}(this,e)}rotationTo(e,t){return Zde(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return function(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3]}(this,this,e),this.check()}calculateW(){return function(n,e){var t=e[0],i=e[1],r=e[2];n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r))}(this,this),this.check()}conjugate(){return function(n,e){n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3]}(this,this),this.check()}invert(){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a}(this,this),this.check()}lerp(e,t,i){return function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a)}(this,e,t,i),this.check()}multiplyRight(e,t){return Fu(!t),sz(this,this,e),this.check()}multiplyLeft(e,t){return Fu(!t),sz(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a}(this,this,e),this.check()}rotateY(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a}(this,this,e),this.check()}rotateZ(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a}(this,this,e),this.check()}scale(e){return az(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=Jde,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return function(n,e,t,i){var p,g,_,x,A,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],d=t[2],f=t[3];(g=r*l+s*c+o*d+a*f)<0&&(g=-g,l=-l,c=-c,d=-d,f=-f),1-g>gr?(p=Math.acos(g),_=Math.sin(p),x=Math.sin((1-i)*p)/_,A=Math.sin(i*p)/_):(x=1-i,A=i),n[0]=x*r+A*l,n[1]=x*s+A*c,n[2]=x*o+A*d,n[3]=x*a+A*f}(this,e,t,i),this.check()}transformVector4(e,t=e){return function(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],d=c*i+a*s-l*r,f=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;n[0]=d*c+g*-o+f*-l-p*-a,n[1]=f*c+g*-a+p*-o-d*-l,n[2]=p*c+g*-l+d*-a-f*-o,n[3]=e[3]}(t,e,this),AE(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}};class che{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(p=>p>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:un.warn(`Bad animation path ${s}`)()}tn(r[s].length===i[c].length);const d=e[c],f=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":f>d&&function(n,e,t,i,r){if("rotation"===e){dR.slerp({start:t,target:i,ratio:r});for(let s=0;s<dR.length;s++)n[e][s]=dR[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-d)/(f-d));break;case"CUBICSPLINE":f>d&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,d=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*d}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:f-d,ratio:(a-d)/(f-d)});break;default:un.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=ihe.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class uhe{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:uz(e.accessors[a]),interpolation:l,output:uz(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new che({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class dhe extends Bg{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof BE?(this.model=e,this._setModelNodeProps(t)):this.model=new BE(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class hhe{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},vM(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new Oa(this.gl,ht({id:e.name||e.id,parameters:ht(ht({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(un.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function dz(n,e){return pi(n)?`#version 300 es\n${e}`:e}const mhe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_he={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class yhe{constructor(e,t={}){this.gl=e,this.options=Object.assign({},_he,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new uhe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new w0({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new w0({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new Gn).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new w0({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){un.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new hhe(n,e);un.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(d=>d.buffer));const c=new dhe(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[nz],defines:a.defines,parameters:a.parameters,vs:dz(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:dz(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),un.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new rr(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new sa({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:mhe[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function hz(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function La(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function fz(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function pz(n,e,t){const i=n.bufferViews[t];La(i);const s=e[i.buffer];return La(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const gz={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class jg{constructor(e,t){Wn(this,"fields",void 0),Wn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new jg(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new jg(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof jg){const o=e;t=o.fields,i=mz(mz(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new jg(s,i)}}function mz(n,e){return new Map([...n||new Map,...e||new Map])}let Rr,_z,yz,vz,bz,wz,Ez,Sz;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(Rr||(Rr={}));class hR{static isNull(e){return e&&e.typeId===Rr.Null}static isInt(e){return e&&e.typeId===Rr.Int}static isFloat(e){return e&&e.typeId===Rr.Float}static isBinary(e){return e&&e.typeId===Rr.Binary}static isUtf8(e){return e&&e.typeId===Rr.Utf8}static isBool(e){return e&&e.typeId===Rr.Bool}static isDecimal(e){return e&&e.typeId===Rr.Decimal}static isDate(e){return e&&e.typeId===Rr.Date}static isTime(e){return e&&e.typeId===Rr.Time}static isTimestamp(e){return e&&e.typeId===Rr.Timestamp}static isInterval(e){return e&&e.typeId===Rr.Interval}static isList(e){return e&&e.typeId===Rr.List}static isStruct(e){return e&&e.typeId===Rr.Struct}static isUnion(e){return e&&e.typeId===Rr.Union}static isFixedSizeBinary(e){return e&&e.typeId===Rr.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Rr.FixedSizeList}static isMap(e){return e&&e.typeId===Rr.Map}static isDictionary(e){return e&&e.typeId===Rr.Dictionary}get typeId(){return Rr.NONE}compareTo(e){return this===e}}Symbol,Symbol,_z=Symbol.toStringTag;class Vg extends hR{constructor(e,t){super(),Wn(this,"isSigned",void 0),Wn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Rr.Int}get[_z](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class Dhe extends Vg{constructor(){super(!0,8)}}class Mhe extends Vg{constructor(){super(!0,16)}}class Ihe extends Vg{constructor(){super(!0,32)}}class Rhe extends Vg{constructor(){super(!1,8)}}class Ohe extends Vg{constructor(){super(!1,16)}}class Nhe extends Vg{constructor(){super(!1,32)}}yz=Symbol.toStringTag;class xz extends hR{constructor(e){super(),Wn(this,"precision",void 0),this.precision=e}get typeId(){return Rr.Float}get[yz](){return"Float"}toString(){return`Float${this.precision}`}}class Phe extends xz{constructor(){super(32)}}class Fhe extends xz{constructor(){super(64)}}Symbol,Symbol,vz=Symbol.toStringTag,bz=Symbol.toStringTag,wz=Symbol.toStringTag,Ez=Symbol.toStringTag,Sz=Symbol.toStringTag;class Lhe extends hR{constructor(e,t){super(),Wn(this,"listSize",void 0),Wn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Rr.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Sz](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class gS{constructor(e,t,i=!1,r=new Map){Wn(this,"name",void 0),Wn(this,"type",void 0),Wn(this,"nullable",void 0),Wn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new gS(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function Cz(n,e,t){const i=t?Az(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new Dhe;case Uint8Array:return new Rhe;case Int16Array:return new Mhe;case Uint16Array:return new Ohe;case Int32Array:return new Ihe;case Uint32Array:return new Nhe;case Float32Array:return new Phe;case Float64Array:return new Fhe;default:throw new Error("array type not supported")}}(e.value);return new gS(n,new Lhe(e.size,new gS("value",r)),!1,i)}function Az(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const Tz={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Vhe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class zhe{constructor(e){Wn(this,"draco",void 0),Wn(this,"decoder",void 0),Wn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const p=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(p)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const d=a[c],f=a[c+1],p=a[c+2];e=d<e?d:e,t=f<t?f:t,i=p<i?p:i,r=d>r?d:r,s=f>s?f:s,o=p>o?p:o}return[[e,t,i],[r,s,o]]}(l.attributes),d=function(n,e,t){const i=Az(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=Cz(o,n[o],s[o]);r.push(l)}if(t){const o=Cz("indices",t);r.push(o)}return new jg(r,i)}(l.attributes,a,l.indices);return Un(ht({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:d})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=Vhe[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const d=this.draco._malloc(a);try{const f=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,f,l,a,d),c=new i(this.draco.HEAPF32.buffer,d,o).slice()}finally{this.draco._free(d)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in Tz)if(this.draco[o]===r)return Tz[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var mS=tt(125);const mR={};function _R(n){return yR.apply(this,arguments)}function yR(){return(yR=ni(function*(n,e=null,t={}){return e&&(n=qhe(n,e,t)),mR[n]=mR[n]||Khe(n),yield mR[n]})).apply(this,arguments)}function qhe(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:yI?t.CDN?(zc(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):vI?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function Khe(n){return vR.apply(this,arguments)}function vR(){return(vR=ni(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():yI?vI?importScripts(n):Yhe(yield(yield fetch(n)).text(),n):mS.requireFromFile&&(yield mS.requireFromFile(n))})).apply(this,arguments)}function Yhe(n,e){if(!yI)return mS.requireFromString&&mS.requireFromString(n,e);if(vI)return eval.call(Vae,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const Xhe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",Qhe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",Zhe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let E0;function efe(n){return bR.apply(this,arguments)}function bR(){return(bR=ni(function*(n){const e=n.modules||{};return E0=e.draco3d?E0||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):E0||tfe(n),yield E0})).apply(this,arguments)}function tfe(n){return ER.apply(this,arguments)}function ER(){return(ER=ni(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield _R(Xhe,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield _R(Qhe,"draco",n),yield _R(Zhe,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield nfe(e,t)})).apply(this,arguments)}function nfe(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(Un(ht({},t),{onModuleLoaded:r=>i({draco:r})}))})}const xR=Un(ht({},gz),{parse:function(n,e){return CR.apply(this,arguments)}});function CR(){return(CR=ni(function*(n,e){const{draco:t}=yield efe(e),i=new zhe(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function x0(n,e){return yf(n>=0),yf(e>0),n+(e-1)&~(e-1)}function sfe(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+x0(i.byteLength,4)}const Dz=["SCALAR","VEC2","VEC3","VEC4"],ofe=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],afe=new Map(ofe),lfe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},cfe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ufe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Mz(n){return Dz[n-1]||Dz[0]}function Iz(n){const e=afe.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function Rz(n,e){const t=ufe[n.componentType],i=lfe[n.type],s=n.count*i,o=n.count*i*cfe[n.componentType];return La(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const dfe={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class eh{constructor(e){Wn(this,"gltf",void 0),Wn(this,"sourceBuffers",void 0),Wn(this,"byteLength",void 0),this.gltf=e||{json:ht({},dfe),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return La(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=Rz(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return La(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return La(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=nR(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;La(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=x0(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:Mz(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:Iz(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=sfe(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const Oz="KHR_binary_glTF",C0="KHR_draco_mesh_compression",Ug="KHR_lights_punctual",yS="KHR_materials_unlit",vS="KHR_techniques_webgl";function pfe(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=Nz(i);e[t]=r}}return e}function Nz(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:Mz(t),componentType:Iz(e)}}function _fe(n,e,t){return AR.apply(this,arguments)}function AR(){return(AR=ni(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new eh(n),s=[];for(const o of Efe(r))r.getObjectExtension(o,C0)&&s.push(vfe(r,o,e,t));yield Promise.all(s),r.removeExtension(C0)})).apply(this,arguments)}function yfe(n,e={}){const t=new eh(n);for(const i of t.json.meshes||[])bfe(i),t.addRequiredExtension(C0)}function vfe(n,e,t,i){return TR.apply(this,arguments)}function TR(){return(TR=ni(function*(n,e,t,i){const r=n.getObjectExtension(e,C0);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=$V(s.buffer,s.byteOffset),{parse:a}=i,l=ht({},t);delete l["3d-tiles"];const c=yield a(o,xR,l,i),d=pfe(c.attributes);for(const[f,p]of Object.entries(d))if(f in e.attributes){const _=n.getAccessor(e.attributes[f]);null!=_&&_.min&&null!=_&&_.max&&(p.min=_.min,p.max=_.max)}e.attributes=d,c.indices&&(e.indices=Nz(c.indices)),wfe(e)})).apply(this,arguments)}function bfe(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[C0]:{bufferView:c,attributes:l}}}]}}function wfe(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Efe(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function Sfe(n){return DR.apply(this,arguments)}function DR(){return(DR=ni(function*(n){const e=new eh(n),{json:t}=e;e.removeExtension(yS);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,yS)})).apply(this,arguments)}function xfe(n){const e=new eh(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,yS,{}),e.addExtension(yS))}function Cfe(n){return MR.apply(this,arguments)}function MR(){return(MR=ni(function*(n){const e=new eh(n),{json:t}=e,i=e.getExtension(Ug);i&&(e.json.lights=i.lights,e.removeExtension(Ug));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,Ug);s&&(r.light=s.light),e.removeObjectExtension(r,Ug)}})).apply(this,arguments)}function Afe(n){return IR.apply(this,arguments)}function IR(){return(IR=ni(function*(n){const e=new eh(n),{json:t}=e;if(t.lights){const i=e.addExtension(Ug);La(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,Ug,i);delete e.json.lights}})).apply(this,arguments)}function Tfe(n){return RR.apply(this,arguments)}function RR(){return(RR=ni(function*(n){const e=new eh(n),{json:t}=e,i=e.getExtension(vS);if(i){const r=Mfe(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,vS);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=Ife(s.technique,e)),e.removeObjectExtension(s,vS)}e.removeExtension(vS)}})).apply(this,arguments)}function Dfe(n,e){return OR.apply(this,arguments)}function OR(){return(OR=ni(function*(n,e){})).apply(this,arguments)}function Mfe(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function Ife(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const Pz={KHR_draco_mesh_compression:gt,KHR_materials_unlit:J,KHR_lights_punctual:At,KHR_techniques_webgl:dt};function Rfe(n){return NR.apply(this,arguments)}function NR(){return(NR=ni(function*(n,e={},t){for(const r in Pz){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield Pz[r].decode(n,e,t))}})).apply(this,arguments)}const Fz={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Nfe={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Pfe{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new eh(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,Oz);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(Oz)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in Fz)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in Fz)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=Nfe[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function Ffe(n,e={}){return(new Pfe).normalize(n,e)}const Lfe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},kfe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},vl={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Bfe={magFilter:vl.TEXTURE_MAG_FILTER,minFilter:vl.TEXTURE_MIN_FILTER,wrapS:vl.TEXTURE_WRAP_S,wrapT:vl.TEXTURE_WRAP_T},jfe={[vl.TEXTURE_MAG_FILTER]:vl.LINEAR,[vl.TEXTURE_MIN_FILTER]:vl.NEAREST_MIPMAP_LINEAR,[vl.TEXTURE_WRAP_S]:vl.REPEAT,[vl.TEXTURE_WRAP_]:vl.REPEAT};class zfe{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return La(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=ht({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=ht({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ht({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ht({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ht({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=ht({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=ht({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return kfe[n]}(e.componentType),e.components=function(n){return Lfe[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=Rz(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):jfe,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return Bfe[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function Hfe(n,e){return(new zfe).postProcess(n,e)}const Lz=1735152710,zg=!0;function FR(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),x0(i,4)}function LR(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),x0(i,4)}function tpe(n,e){return kR.apply(this,arguments)}function kR(){return(kR=ni(function*(n,e,t=0,i,r){var s,o,a,l;npe(n,e,t,i),Ffe(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield ipe(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const f=rpe(n,i,r);c.push(f)}const d=Rfe(n,i,r);return c.push(d),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?Hfe(n,i):n})).apply(this,arguments)}function npe(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=Lz}=t,s=i.getUint32(e,!1);return s===r||s===Lz}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?hz(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?hz(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,zg),a=r.getUint32(t+8,zg);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){yf(n.header.byteLength>20);const i=e.getUint32(t+0,zg),r=e.getUint32(t+4,zg);return t+=8,yf(0===r),FR(n,e,t,i),(t+=i)+LR(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return yf(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,zg),s=e.getUint32(t+4,zg);switch(t+=8,s){case 1313821514:FR(n,e,t,r);break;case 5130562:LR(n,e,t,r);break;case 0:i.strict||FR(n,e,t,r);break;case 1:i.strict||LR(n,e,t,r)}t+=x0(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),La("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else La(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function ipe(n,e,t){return BR.apply(this,arguments)}function BR(){return(BR=ni(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;La(a);const l=fz(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),d=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:d,byteOffset:0,byteLength:d.byteLength},delete o.uri}}})).apply(this,arguments)}function rpe(n,e,t){return jR.apply(this,arguments)}function jR(){return(jR=ni(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(spe(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function spe(n,e,t,i,r){return VR.apply(this,arguments)}function VR(){return(VR=ni(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=fz(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=pz(n.json,n.buffers,e.bufferView);a=$V(c.buffer,c.byteOffset,c.byteLength)}La(a,"glTF image has no data");const l=yield o(a,CU,{},r);n.images[t]=l})).apply(this,arguments)}const Hg={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return UR.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function UR(){return(UR=ni(function*(n,e={},t){(e=ht(ht({},Hg.options),e)).gltf=ht(ht({},Hg.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield tpe({},n,i,e,t)})).apply(this,arguments)}function zR(){return(zR=ni(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield lpe(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function lpe(n){return HR.apply(this,arguments)}function HR(){return(HR=ni(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const kz=[255,255,255,255],dpe={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:kz},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Hg]};let hpe=(()=>{class n extends UI{getShaders(){const t=[HU,KU];return"pbr"===this.props._lighting&&t.push(nz),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:kz,transition:!0},instanceModelMatrix:JU})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof Bg)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new yhe(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=ht({gltf:l},c),function(n){return zR.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Oi.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof Bg?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&Oi.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):Oi.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):Oi.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof Bg&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:ht({isInstanced:!0,transpileToGLSL100:!pi(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:d}=this.props,f=this.getNumInstances();this.state.scenegraph.traverse((p,{worldMatrix:g})=>{p.model.setInstanceCount(f),p.updateModuleSettings(t),p.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:ez(s,d),sceneModelMatrix:g,u_Camera:p.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=dpe,n})();const fpe=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ppe=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),gpe=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),mpe=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),_pe={POSITION:{size:3,value:new Float32Array(ppe)},NORMAL:{size:3,value:new Float32Array(gpe)},TEXCOORD_0:{size:2,value:new Float32Array(mpe)}};class ype extends hS{constructor(e={}){const{id:t=jc("cube-geometry")}=e;super(Un(ht({},e),{id:t,indices:{size:1,value:new Uint16Array(fpe)},attributes:ht(ht({},_pe),e.attributes)}))}}class Kc{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new le){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new le){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new Kc){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],d=i[4],f=i[5],p=i[6],g=i[7],_=i[8],x=r[0],A=r[1],W=r[2],G=r[3],ge=r[4],Ne=r[5],Ge=r[6],$e=r[7],at=r[8];return s[0]=o*x+a*G+l*Ge,s[1]=o*A+a*ge+l*$e,s[2]=o*W+a*Ne+l*at,s[3]=c*x+d*G+f*Ge,s[4]=c*A+d*ge+f*$e,s[5]=c*W+d*Ne+f*at,s[6]=p*x+g*G+_*Ge,s[7]=p*A+g*ge+_*$e,s[8]=p*W+g*Ne+_*at,t}scale(e,t=new Kc){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new le){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let d,p;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){d=4;do{p=4-d,s[p+4*o]+=s[p+4*a]}while(--d);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];d=4;do{p=4-d,s[p+4*a]=p<=o?0:s[p+4*a]-s[p+4*o]*g}while(--d)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new Kc){const r=vpe;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,f;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{f=6-c,r[f+6*s]+=r[f+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const p=r[s+6*o]/r[s+6*s];c=6;do{f=6-c,r[f+6*o]=f<=s?0:r[f+6*o]-r[f+6*s]*p}while(--c)}}while(--a);s=2;do{o=s-1;do{const p=r[s+6*o]/r[s+6*s];c=6;do{f=6-c,r[f+6*o]=r[f+6*o]-r[f+6*s]*p}while(--c)}while(o--)}while(--s);s=2;do{const p=1/r[s+6*s];c=6;do{f=6-c,r[f+6*s]=r[f+6*s]*p}while(--c)}while(s--);s=2;do{o=2;do{if(f=r[3+o+6*s],isNaN(f)||f===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,f)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,d=t*a,f=t*l,p=i*a,g=i*l,_=r*l,x=s*o,A=s*a,W=s*l,G=this.elements;return G[0]=1-(p+_),G[1]=d-W,G[2]=f+A,G[3]=d+W,G[4]=1-(c+_),G[5]=g-x,G[6]=f-A,G[7]=g+x,G[8]=1-(c+p),this}transpose(e=new Kc){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const vpe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class le{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new le(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new le(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new Kc([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new le){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new le){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new le){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new le){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new le){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=bpe,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=wpe;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(Bz),Bz.almostEquals(e,t)}clone(){return new le(this.x,this.y,this.z)}}le.ZERO=void 0,le.UNIT_X=void 0,le.UNIT_Y=void 0,le.UNIT_Z=void 0,le.ZERO=new le(0,0,0),le.UNIT_X=new le(1,0,0),le.UNIT_Y=new le(0,1,0),le.UNIT_Z=new le(0,0,1);const bpe=new le,wpe=new le,Bz=new le;class ar{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new le,this.upperBound=new le,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,jz),c=jz),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new ar).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,d=this.upperBound;e.copy(c),t.set(d.x,c.y,c.z),i.set(d.x,d.y,c.z),r.set(c.x,d.y,d.z),s.set(d.x,c.y,d.z),o.set(c.x,d.y,c.z),a.set(c.x,c.y,d.z),l.copy(d)}toLocalFrame(e,t){const i=Vz;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=Vz;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,d=(this.upperBound.y-i.y)*s,f=(this.lowerBound.z-i.z)*o,p=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,d)),Math.min(f,p)),_=Math.min(Math.min(Math.max(a,l),Math.max(c,d)),Math.max(f,p));return!(_<0||g>_)}}const jz=new le,Vz=[new le,new le,new le,new le,new le,new le,new le,new le];class ss{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new le){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=Spe;e.tangents(i,xpe),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(_r(e.length(),2)*_r(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new ss){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,d=e.w;return t.x=i*d+o*a+r*c-s*l,t.y=r*d+o*l+s*a-i*c,t.z=s*d+o*c+i*l-r*a,t.w=o*d-i*a-r*l-s*c,t}inverse(e=new ss){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new ss){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,d=c*i+a*s-l*r,f=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=d*c+g*-o+f*-l-p*-a,t.y=f*c+g*-a+p*-o-d*-l,t.z=p*c+g*-l+d*-a-f*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const d=o*a+l*c;if(d>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),d<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const f=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*d),s=Math.atan2(2*o*c-2*a*l,1-2*f-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),d=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a-l*c*d):"YXZ"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a+l*c*d):"ZXY"===r?(this.x=l*o*a-s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a-l*c*d):"ZYX"===r?(this.x=l*o*a-s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a+l*c*d):"YZX"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a-l*c*d):"XZY"===r&&(this.x=l*o*a-s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a+l*c*d),this}clone(){return new ss(this.x,this.y,this.z,this.w)}slerp(e,t,i=new ss){const r=this.x,s=this.y,o=this.z,a=this.w;let p,g,_,x,A,l=e.x,c=e.y,d=e.z,f=e.w;return g=r*l+s*c+o*d+a*f,g<0&&(g=-g,l=-l,c=-c,d=-d,f=-f),1-g>1e-6?(p=Math.acos(g),_=Math.sin(p),x=Math.sin((1-t)*p)/_,A=Math.sin(t*p)/_):(x=1-t,A=t),i.x=x*r+A*l,i.y=x*s+A*c,i.z=x*o+A*d,i.w=x*a+A*f,i}integrate(e,t,i,r=new ss){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,d=this.z,f=this.w,p=.5*t;return r.x+=p*(s*f+o*d-a*c),r.y+=p*(o*f+a*l-s*d),r.z+=p*(a*f+s*c-o*l),r.w+=p*(-s*l-o*c-a*d),r}}const Spe=new le,xpe=new le,Cpe={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let dn=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=Cpe,n})();class Ni{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new le,this.quaternion=new ss,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return Ni.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return Ni.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new le){return i.vsub(e,r),t.conjugate(zz),zz.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new le){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new le){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new le){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const zz=new ss;class wf extends dn{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:dn.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new le;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let d=!1;for(let f=0;f!==i.length;f++)if(i[f].almostEquals(r)||i[f].almostEquals(r)){d=!0;break}d||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new le;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];wf.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new le,o=new le;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const d=new le;let f=-1,p=-Number.MAX_VALUE;for(let _=0;_<i.faces.length;_++){d.copy(i.faceNormals[_]),s.vmult(d,d);const x=d.dot(o);x>p&&(p=x,f=_)}const g=[];for(let _=0;_<i.faces[f].length;_++){const x=i.vertices[i.faces[f][_]],A=new le;A.copy(x),s.vmult(A,A),r.vadd(A,A),g.push(A)}f>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new le,d=new le,f=new le,p=new le,g=new le,_=new le;let x=Number.MAX_VALUE;const A=this;if(A.uniqueAxes)for(let W=0;W!==A.uniqueAxes.length;W++){i.vmult(A.uniqueAxes[W],c);const G=A.testSepAxis(c,e,t,i,r,s);if(!1===G)return!1;G<x&&(x=G,o.copy(c))}else{const W=a?a.length:A.faces.length;for(let G=0;G<W;G++){c.copy(A.faceNormals[a?a[G]:G]),i.vmult(c,c);const Ne=A.testSepAxis(c,e,t,i,r,s);if(!1===Ne)return!1;Ne<x&&(x=Ne,o.copy(c))}}if(e.uniqueAxes)for(let W=0;W!==e.uniqueAxes.length;W++){s.vmult(e.uniqueAxes[W],d);const G=A.testSepAxis(d,e,t,i,r,s);if(!1===G)return!1;G<x&&(x=G,o.copy(d))}else{const W=l?l.length:e.faces.length;for(let G=0;G<W;G++){d.copy(e.faceNormals[l?l[G]:G]),s.vmult(d,d);const Ne=A.testSepAxis(d,e,t,i,r,s);if(!1===Ne)return!1;Ne<x&&(x=Ne,o.copy(d))}}for(let W=0;W!==A.uniqueEdges.length;W++){i.vmult(A.uniqueEdges[W],p);for(let G=0;G!==e.uniqueEdges.length;G++)if(s.vmult(e.uniqueEdges[G],g),p.cross(g,_),!_.almostZero()){_.normalize();const ge=A.testSepAxis(_,e,t,i,r,s);if(!1===ge)return!1;ge<x&&(x=ge,o.copy(_))}}return r.vsub(t,f),f.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){wf.project(this,e,i,r,GR),wf.project(t,e,s,o,$R);const l=GR[0],c=GR[1],d=$R[0],f=$R[1];if(l<f||d<c)return!1;const p=l-f,g=d-c;return p<g?p:g}calculateLocalInertia(e,t){const i=new le,r=new le;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new le,c=new le,d=new le,f=new le,p=new le,g=new le,_=new le,x=new le,A=this,G=r,ge=[];let Ne=-1,Ge=Number.MAX_VALUE;for(let Pt=0;Pt<A.faces.length;Pt++){l.copy(A.faceNormals[Pt]),i.vmult(l,l);const Xt=l.dot(e);Xt<Ge&&(Ge=Xt,Ne=Pt)}if(Ne<0)return;const $e=A.faces[Ne];$e.connectedFaces=[];for(let Pt=0;Pt<A.faces.length;Pt++)for(let Xt=0;Xt<A.faces[Pt].length;Xt++)-1!==$e.indexOf(A.faces[Pt][Xt])&&Pt!==Ne&&-1===$e.connectedFaces.indexOf(Pt)&&$e.connectedFaces.push(Pt);const at=$e.length;for(let Pt=0;Pt<at;Pt++){const Xt=A.vertices[$e[Pt]];Xt.vsub(A.vertices[$e[(Pt+1)%at]],c),d.copy(c),i.vmult(d,d),t.vadd(d,d),f.copy(this.faceNormals[Ne]),i.vmult(f,f),t.vadd(f,f),d.cross(f,p),p.negate(p),g.copy(Xt),i.vmult(g,g),t.vadd(g,g);const bt=$e.connectedFaces[Pt];_.copy(this.faceNormals[bt]);const Ct=this.getPlaneConstantOfFace(bt);x.copy(_),i.vmult(x,x);const Ut=Ct-x.dot(t);for(this.clipFaceAgainstPlane(G,ge,x,Ut);G.length;)G.shift();for(;ge.length;)G.push(ge.shift())}_.copy(this.faceNormals[Ne]);const St=this.getPlaneConstantOfFace(Ne);x.copy(_),i.vmult(x,x);const Rt=St-x.dot(t);for(let Pt=0;Pt<G.length;Pt++){let Xt=x.dot(G[Pt])+Rt;if(Xt<=s&&(console.log("clamped: depth="+Xt+" to minDist="+s),Xt=s),Xt<=o){const Zt=G[Pt];Xt<=1e-6&&a.push({point:Zt,normal:x,depth:Xt})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let d=0;d<a;d++){if(c=e[d],o=i.dot(c)+r,s<0)if(o<0){const f=new le;f.copy(c),t.push(f)}else{const f=new le;l.lerp(c,s/(s-o),f),t.push(f)}else if(o<0){const f=new le;l.lerp(c,s/(s-o),f),t.push(f),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new le);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new le);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,d,f,p=new le;for(let g=0;g<s.length;g++){p.copy(s[g]),t.vmult(p,p),e.vadd(p,p);const _=p;(void 0===o||_.x<o)&&(o=_.x),(void 0===c||_.x>c)&&(c=_.x),(void 0===a||_.y<a)&&(a=_.y),(void 0===d||_.y>d)&&(d=_.y),(void 0===l||_.z<l)&&(l=_.z),(void 0===f||_.z>f)&&(f=_.z)}i.set(o,a,l),r.set(c,d,f)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new le){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new le;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new le;e.vsub(l,c);const d=a.dot(c),f=new le;s.vsub(l,f);const p=a.dot(f);if(d<0&&p>0||d>0&&p<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=Ape;let l=0,c=0;const d=Tpe,f=e.vertices;d.setZero(),Ni.vectorToLocalFrame(i,r,t,a),Ni.pointToLocalFrame(i,r,d,d);const p=d.dot(a);c=l=f[0].dot(a);for(let g=1;g<o;g++){const _=f[g].dot(a);_>l&&(l=_),_<c&&(c=_)}if(c-=p,l-=p,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const GR=[],$R=[],Ape=new le,Tpe=new le;class wS extends dn{constructor(e){super({type:dn.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=le,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new wf({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new le){return wS.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)th.set(s[o][0],s[o][1],s[o][2]),t.vmult(th,th),e.vadd(th,th),i(th.x,th.y,th.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;Yc[0].set(s.x,s.y,s.z),Yc[1].set(-s.x,s.y,s.z),Yc[2].set(-s.x,-s.y,s.z),Yc[3].set(-s.x,-s.y,-s.z),Yc[4].set(s.x,-s.y,-s.z),Yc[5].set(s.x,s.y,-s.z),Yc[6].set(-s.x,s.y,-s.z),Yc[7].set(s.x,-s.y,s.z);const o=Yc[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=Yc[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,d=l.y,f=l.z;c>r.x&&(r.x=c),d>r.y&&(r.y=d),f>r.z&&(r.z=f),c<i.x&&(i.x=c),d<i.y&&(i.y=d),f<i.z&&(i.z=f)}}}const th=new le,Yc=[new le,new le,new le,new le,new le,new le,new le,new le];class hn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=hn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new le,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new le,this.previousPosition=new le,this.interpolatedPosition=new le,this.initPosition=new le,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new le,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new le,this.force=new le;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?hn.STATIC:hn.DYNAMIC,typeof e.type==typeof hn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=hn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new le,this.quaternion=new ss,this.initQuaternion=new ss,this.previousQuaternion=new ss,this.interpolatedQuaternion=new ss,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new le,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new le,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new le,this.invInertia=new le,this.invInertiaWorld=new Kc,this.invMassSolve=0,this.invInertiaSolve=new le,this.invInertiaWorldSolve=new Kc,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new le(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new le(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new ar,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new le,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=hn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===hn.SLEEPING&&this.dispatchEvent(hn.wakeupEvent)}sleep(){this.sleepState=hn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=_r(this.sleepSpeedLimit,2);t===hn.AWAKE&&i<r?(this.sleepState=hn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(hn.sleepyEvent)):t===hn.SLEEPY&&i>r?this.wakeUp():t===hn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(hn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===hn.SLEEPING||this.type===hn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new le){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new le){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new le,s=new ss;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=Dpe,o=Mpe,a=this.quaternion,l=this.aabb,c=Ipe;for(let d=0;d!==r;d++){const f=e[d];a.vmult(t[d],s),s.vadd(this.position,s),a.mult(i[d],o),f.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===d?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=Rpe,r=Ope;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new le){if(this.type!==hn.DYNAMIC)return;this.sleepState===hn.SLEEPING&&this.wakeUp();const i=Npe;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new le){if(this.type!==hn.DYNAMIC)return;const i=Ppe,r=Fpe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===hn.DYNAMIC&&(this.sleepState===hn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new le){if(this.type!==hn.DYNAMIC)return;this.sleepState===hn.SLEEPING&&this.wakeUp();const i=t,r=Lpe;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=kpe;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new le){if(this.type!==hn.DYNAMIC)return;const i=Bpe,r=jpe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=Vpe;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),wS.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new le;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==hn.DYNAMIC&&this.type!==hn.KINEMATIC||this.sleepState===hn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,f=this.invInertiaWorld,p=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*p.x,r.y+=a.y*g*p.y,r.z+=a.z*g*p.z;const _=f.elements,x=this.angularFactor,A=l.x*x.x,W=l.y*x.y,G=l.z*x.z;s.x+=e*(_[0]*A+_[1]*W+_[2]*G),s.y+=e*(_[3]*A+_[4]*W+_[5]*G),s.z+=e*(_[6]*A+_[7]*W+_[8]*G),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}hn.idCounter=0,hn.COLLIDE_EVENT_NAME="collide",hn.DYNAMIC=1,hn.STATIC=2,hn.KINEMATIC=4,hn.AWAKE=0,hn.SLEEPY=1,hn.SLEEPING=2,hn.wakeupEvent={type:"wakeup"},hn.sleepyEvent={type:"sleepy"},hn.sleepEvent={type:"sleep"};const Dpe=new le,Mpe=new ss,Ipe=new ar,Rpe=new Kc,Ope=new Kc,Npe=new le,Ppe=new le,Fpe=new le,Lpe=new le,kpe=new le,Bpe=new le,jpe=new le,Vpe=new le;new le,new le;class ES{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new le,this.rayToWorld=new le,this.hitNormalWorld=new le,this.hitPointWorld=new le,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let Hz,Gz,$z,Wz,qz,Kz,Yz;Hz=dn.types.SPHERE,Gz=dn.types.PLANE,$z=dn.types.BOX,Wz=dn.types.CYLINDER,qz=dn.types.CONVEXPOLYHEDRON,Kz=dn.types.HEIGHTFIELD,Yz=dn.types.TRIMESH;class fs{get[Hz](){return this._intersectSphere}get[Gz](){return this._intersectPlane}get[$z](){return this._intersectBox}get[Wz](){return this._intersectConvex}get[qz](){return this._intersectConvex}get[Kz](){return this._intersectHeightfield}get[Yz](){return this._intersectTrimesh}constructor(e=new le,t=new le){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new le,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=fs.ANY,this.result=new ES,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||fs.ANY,this.result=t.result||new ES,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Xz),YR.length=0,e.broadphase.aabbQuery(e,Xz,YR),this.intersectBodies(YR),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=qpe,s=Kpe;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,Ef);const i=Ef.dot(e);return e.scale(i,xS),xS.vadd(n,xS),t.distanceTo(xS)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new le(0,0,1);t.vmult(c,c);const d=new le;o.vsub(i,d);const f=d.dot(c);if(a.vsub(i,d),f*d.dot(c)>0||o.distanceTo(a)<f)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const _=new le,x=new le,A=new le;o.vsub(i,_);const W=-c.dot(_)/g;l.scale(W,x),o.vadd(x,A),this.reportIntersection(c,A,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=Ype;o.from.copy(this.from),o.to.copy(this.to),Ni.pointToLocalFrame(i,t,o.from,o.from),Ni.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=Xpe;let l,c,d,f;l=c=0,d=f=e.data.length-1;const p=new ar;o.getAABB(p),e.getIndexOfPosition(p.lowerBound.x,p.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(p.upperBound.x,p.upperBound.y,a,!0),d=Math.min(d,a[0]+1),f=Math.min(f,a[1]+1);for(let g=l;g<d;g++)for(let _=c;_<f;_++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,_,p),p.overlapsRay(o)){if(e.getConvexTrianglePillar(g,_,!1),Ni.pointToWorldFrame(i,t,e.pillarOffset,SS),this._intersectConvex(e.pillarConvex,t,SS,r,s,Qz),this.result.shouldStop)return;e.getConvexTrianglePillar(g,_,!0),Ni.pointToWorldFrame(i,t,e.pillarOffset,SS),this._intersectConvex(e.pillarConvex,t,SS,r,s,Qz)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=_r(a.x-o.x,2)+_r(a.y-o.y,2)+_r(a.z-o.z,2),d=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),f=_r(o.x-i.x,2)+_r(o.y-i.y,2)+_r(o.z-i.z,2)-_r(l,2),p=_r(d,2)-4*c*f,g=Qpe,_=Zpe;if(!(p<0))if(0===p)o.lerp(a,p,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1);else{const x=(-d-Math.sqrt(p))/(2*c),A=(-d+Math.sqrt(p))/(2*c);if(x>=0&&x<=1&&(o.lerp(a,x,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1)),this.result.shouldStop)return;A>=0&&A<=1&&(o.lerp(a,A,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=Jpe,l=Zz,c=o&&o.faceList||null,d=e.faces,f=e.vertices,p=e.faceNormals,g=this.direction,_=this.from,A=_.distanceTo(this.to),W=c?c.length:d.length,G=this.result;for(let ge=0;!G.shouldStop&&ge<W;ge++){const Ne=c?c[ge]:ge,Ge=d[Ne],$e=p[Ne],at=t,St=i;l.copy(f[Ge[0]]),at.vmult(l,l),l.vadd(St,l),l.vsub(_,l),at.vmult($e,a);const Rt=g.dot(a);if(Math.abs(Rt)<this.precision)continue;const Pt=a.dot(l)/Rt;if(!(Pt<0)){g.scale(Pt,aa),aa.vadd(_,aa),ac.copy(f[Ge[0]]),at.vmult(ac,ac),St.vadd(ac,ac);for(let Xt=1;!G.shouldStop&&Xt<Ge.length-1;Xt++){Xc.copy(f[Ge[Xt]]),Qc.copy(f[Ge[Xt+1]]),at.vmult(Xc,Xc),at.vmult(Qc,Qc),St.vadd(Xc,Xc),St.vadd(Qc,Qc);const Zt=aa.distanceTo(_);!fs.pointInTriangle(aa,ac,Xc,Qc)&&!fs.pointInTriangle(aa,Xc,ac,Qc)||Zt>A||this.reportIntersection(a,aa,s,r,Ne)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=ege,l=oge,c=age,d=Zz,f=tge,p=nge,g=ige,_=sge,x=rge,A=e.indices,W=this.from,G=this.to,ge=this.direction;c.position.copy(i),c.quaternion.copy(t),Ni.vectorToLocalFrame(i,t,ge,f),Ni.pointToLocalFrame(i,t,W,p),Ni.pointToLocalFrame(i,t,G,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,p.x*=e.scale.x,p.y*=e.scale.y,p.z*=e.scale.z,g.vsub(p,f),f.normalize();const Ne=p.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let Ge=0,$e=l.length;!this.result.shouldStop&&Ge!==$e;Ge++){const at=l[Ge];e.getNormal(at,a),e.getVertex(A[3*at],ac),ac.vsub(p,d);const St=f.dot(a),Rt=a.dot(d)/St;if(Rt<0)continue;f.scale(Rt,aa),aa.vadd(p,aa),e.getVertex(A[3*at+1],Xc),e.getVertex(A[3*at+2],Qc);const Pt=aa.distanceSquared(p);!fs.pointInTriangle(aa,Xc,ac,Qc)&&!fs.pointInTriangle(aa,ac,Xc,Qc)||Pt>Ne||(Ni.vectorToWorldFrame(t,a,x),Ni.pointToWorldFrame(i,t,aa,_),this.reportIntersection(x,_,s,r,at))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case fs.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case fs.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case fs.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,Ef),i.vsub(t,A0),e.vsub(t,XR);const s=Ef.dot(Ef),o=Ef.dot(A0),a=Ef.dot(XR),l=A0.dot(A0),c=A0.dot(XR);let d,f;return(d=l*a-o*c)>=0&&(f=s*c-o*a)>=0&&d+f<s*l-o*o}}fs.CLOSEST=1,fs.ANY=2,fs.ALL=4;const Xz=new ar,YR=[],A0=new le,XR=new le,qpe=new le,Kpe=new ss,aa=new le,ac=new le,Xc=new le,Qc=new le,Qz={faceList:[0]},SS=new le,Ype=new fs,Xpe=[],Qpe=new le,Zpe=new le,Jpe=new le,Zz=new le,ege=new le,tge=new le,nge=new le,ige=new le,rge=new le,sge=new le;new ar;const oge=[],age=new Ni,Ef=new le,xS=new le;let f4,p4,g4,m4,_4,y4,v4,b4,w4,E4,S4,x4,C4,A4,T4,D4,M4,I4,R4,O4,N4,P4,F4,L4,k4;new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new fs,new le,new le,new le(1,0,0),new le(0,1,0),new le(0,0,1),new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new ar,new le,new ar,new le,new le,new le,new le,new le,new le,new le,new ar,new le,new Ni,new ar;const Ar={sphereSphere:dn.types.SPHERE,spherePlane:dn.types.SPHERE|dn.types.PLANE,boxBox:dn.types.BOX|dn.types.BOX,sphereBox:dn.types.SPHERE|dn.types.BOX,planeBox:dn.types.PLANE|dn.types.BOX,convexConvex:dn.types.CONVEXPOLYHEDRON,sphereConvex:dn.types.SPHERE|dn.types.CONVEXPOLYHEDRON,planeConvex:dn.types.PLANE|dn.types.CONVEXPOLYHEDRON,boxConvex:dn.types.BOX|dn.types.CONVEXPOLYHEDRON,sphereHeightfield:dn.types.SPHERE|dn.types.HEIGHTFIELD,boxHeightfield:dn.types.BOX|dn.types.HEIGHTFIELD,convexHeightfield:dn.types.CONVEXPOLYHEDRON|dn.types.HEIGHTFIELD,sphereParticle:dn.types.PARTICLE|dn.types.SPHERE,planeParticle:dn.types.PLANE|dn.types.PARTICLE,boxParticle:dn.types.BOX|dn.types.PARTICLE,convexParticle:dn.types.PARTICLE|dn.types.CONVEXPOLYHEDRON,cylinderCylinder:dn.types.CYLINDER,sphereCylinder:dn.types.SPHERE|dn.types.CYLINDER,planeCylinder:dn.types.PLANE|dn.types.CYLINDER,boxCylinder:dn.types.BOX|dn.types.CYLINDER,convexCylinder:dn.types.CONVEXPOLYHEDRON|dn.types.CYLINDER,heightfieldCylinder:dn.types.HEIGHTFIELD|dn.types.CYLINDER,particleCylinder:dn.types.PARTICLE|dn.types.CYLINDER,sphereTrimesh:dn.types.SPHERE|dn.types.TRIMESH,planeTrimesh:dn.types.PLANE|dn.types.TRIMESH};f4=Ar.sphereSphere,p4=Ar.spherePlane,g4=Ar.boxBox,m4=Ar.sphereBox,_4=Ar.planeBox,y4=Ar.convexConvex,v4=Ar.sphereConvex,b4=Ar.planeConvex,w4=Ar.boxConvex,E4=Ar.sphereHeightfield,S4=Ar.boxHeightfield,x4=Ar.convexHeightfield,C4=Ar.sphereParticle,A4=Ar.planeParticle,T4=Ar.boxParticle,D4=Ar.convexParticle,M4=Ar.cylinderCylinder,I4=Ar.sphereCylinder,R4=Ar.planeCylinder,O4=Ar.boxCylinder,N4=Ar.convexCylinder,P4=Ar.heightfieldCylinder,F4=Ar.particleCylinder,L4=Ar.sphereTrimesh,k4=Ar.planeTrimesh,new le,new le,new le,new le,new le,new ss,new ss,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new ar,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new ss,new le,new le,new le,new le,new le,new le,new le,new le,new ar,new fs;const qs=globalThis.performance||{};if(!qs.now){let n=Date.now();qs.timing&&qs.timing.navigationStart&&(n=qs.timing.navigationStart),qs.now=()=>Date.now()-n}var Af=tt(517);class Or extends ee{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new U;return this._value}next(e){super.next(this._value=e)}}function qg(n,e,t){e||(e=new Gn(Gn.IDENTITY));const i=new Gn(Gn.IDENTITY);if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new Gn(Gn.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new Gn(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===qg(s,r,t))return!1;return!0}function H4(){YV([gz,Hg])}function G4(n,e){const t=e.nodes.find(i=>i.name===n);if(t){let i=!1;for(const r of e.scenes)i||qg(r,new Gn(Gn.IDENTITY),(s,o)=>s!==t||(s.matrix=o,s.translation=void 0,s.rotation=void 0,s.scale=void 0,i=!0,!1));return e.scene={id:n,name:n,nodes:[t]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function JR(n,e){return Yi(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield JE(i,Hg,{DracoLoader:xR,gltf:{decompressMeshes:!0,postProcess:!0}});return G4(n.scenegraphNode,r)})}function lye(n,e){return Yi(this,void 0,void 0,function*(){return G4(n,yield e)})}function eO(n,e,t){if(e&&0!==e.length)return new kde(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Di.CARTESIAN,data:e,mesh:new ype,wireframe:!1,getTransformMatrix:i=>i.transformMatrix,getColor:i=>i.color||[255,255,255,229.5]},t))}let uye=(()=>{class n extends jle{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),H4()}renderLayers(){const t=this.state,i=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&l.unpickable),r=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&!l.unpickable),s=t.data.filter(l=>!l.scenegraph&&l.wireframe),o=t.data.filter(l=>!!l.scenegraph);t.doCollisions&&function(n){Yi(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&!o.wireframe).map(o=>{const a=new Gn(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new ar({lowerBound:new le(...l.map((d,f)=>Math.min(d,c[f]))),upperBound:new le(...c.map((d,f)=>Math.max(d,l[f])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield eS(o.scenegraph,Hg,{DracoLoader:xR,decompress:!0,postProcess:!0});for(const l of a.scenes)qg(l,new Gn(o.transformMatrix),(c,d)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const f of c.mesh.primitives)if(f.attributes.POSITION&&f.attributes.POSITION.min){const p=d.transformAsPoint(f.attributes.POSITION.min,[]),g=d.transformAsPoint(f.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new ar({lowerBound:new le(...p.map((_,x)=>Math.min(_,g[x]))),upperBound:new le(...g.map((_,x)=>Math.max(_,p[x])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(t.data);const a={};for(const l of o)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(a,l.scenegraph)&&(a[l.scenegraph]=JR({scenegraph:l.scenegraph},n.gltfCache));return[eO("cubes",i,{wireframe:!1,pickable:!1}),eO("pickableCubes",r,{wireframe:!1,pickable:!0}),eO("wireframes",s,{wireframe:!0,pickable:!1}),...o.map(l=>{var c;return new hpe({id:"models-"+l["@id"],opacity:l.zoomBasedOpacity?t.zoomOpacity:void 0!==l.opacity?l.opacity:1,pickable:!l.unpickable,coordinateSystem:Di.CARTESIAN,data:[l],scenegraph:l.scenegraphNode?lye(l.scenegraphNode,a[l.scenegraph]):l.scenegraph,_lighting:l._lighting,getTransformMatrix:l.transformMatrix,getColor:null!==(c=l.color)&&void 0!==c?c:[0,255,0,127.5],parameters:{depthMask:!l.zoomBasedOpacity&&(void 0===l.opacity||1===l.opacity)}})})].filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function $4(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),$4(t,e);return e}let hye=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new uye({}),this.nodeClickSubject=new ee,this.nodeHoverStartSubject=new ee,this.nodeHoverStopSubject=new ee,this.sceneRotationSubject=new Or([0,0]),this.nodeDragStartSubject=new ee,this.nodeDragSubject=new ee,this.nodeDragEndSubject=new ee,this.nodeClick$=this.nodeClickSubject.pipe(ms()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(ms()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(ms()),this.sceneRotation$=this.sceneRotationSubject.pipe(ms()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(ms()),this.nodeDrag$=this.nodeDragSubject.pipe(ms()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(ms());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new Qle({flipY:!1,near:-1e3}):new ece({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var d;return null!==(d=this.cursor)&&void 0!==d?d:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new qI({ambientLight:new sU({color:[255,255,255],intensity:10})})]),this.deck=new dS(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return Yi(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new Gn([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t){return Yi(this,void 0,void 0,function*(){H4();const i=yield JR({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},s=[];for(const o of i.scenes)qg(o,e=new Gn(e||Gn.IDENTITY),(a,l)=>{const c={"@id":a.name||a.id,"@type":"ProcessedNode",transformMatrix:new Gn(l),wireframe:!0,node:a};if(s.push({"@id":`GLTF:${c["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:c["@id"],transformMatrix:new Gn(e||Gn.IDENTITY),tooltip:a.name||a.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:a}),a.mesh&&a.mesh.primitives&&a.mesh.primitives.length>0)for(const d of a.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const f=l.transformAsPoint(d.attributes.POSITION.min,[]),p=l.transformAsPoint(d.attributes.POSITION.max,[]);c.bbox=new ar({lowerBound:new le(...f.map((g,_)=>Math.min(g,p[_]))),upperBound:new le(...p.map((g,_)=>Math.max(g,f[_])))})}return r[c["@id"]]=c,!0});for(const o of Object.values(r).filter(a=>!a.bbox)){for(const a of $4(o.node).map(l=>r[l]).filter(l=>l.bbox))o.bbox?o.bbox.extend(a.bbox):o.bbox=a.bbox.clone();o.bbox||delete r[o["@id"]]}for(const o of Object.values(r)){const a=o.bbox.lowerBound,d=(o.size=o.bbox.upperBound.clone().vsub(a)).clone().vmul(new le(.5,.5,.5)),f=o.center=a.clone().vadd(d);o.transformMatrix=new Gn(Gn.IDENTITY).translate(f.toArray()).scale(d.toArray())}for(const o of s)r[o["@id"]]=o;return r})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new Gn(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return Ia([Af.ZP],n.prototype,"_onHover",null),Ia([Af.ZP],n.prototype,"_onClick",null),Ia([Af.ZP],n.prototype,"_onViewStateChange",null),Ia([Af.ZP],n.prototype,"_onDragStart",null),Ia([Af.ZP],n.prototype,"_onDrag",null),Ia([Af.ZP],n.prototype,"_onDragEnd",null),n})();function fye(n,e){return n===e}function pye(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function W4(n,e=fye){let t=null,i=null;function r(){return pye(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const mye=W4(function(){const n=hD();if(!n)return!1;const e=n.injector.get(Ek,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let tO=(()=>{class n{constructor(){this.bootstrap$=new mg(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const nO=new Vt("INITIAL_STATE_TOKEN");let _ye=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const q4=new Vt("Internals.StateContextFactory"),K4=new Vt("Internals.StateFactory");function O0(...n){if(1===n.length){const e=n[0];if(L(e))return RS(e,null);if(re(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return RS(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return RS(n=1===n.length&&L(n[0])?n[0]:n,null).pipe(me(t=>e(...t)))}return RS(n,null)}function RS(n,e){return new F(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=Pe(n[a]);let c=!1;t.add(l.subscribe({next:d=>{c||(c=!0,o++),r[a]=d},error:d=>t.error(d),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((d,f,p)=>(d[f]=r[p],d),{}):r),t.complete())}}))}})}function Ui(n,e){return function(i){return i.lift(new yye(n,e))}}class yye{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new vye(e,this.predicate,this.thisArg))}}class vye extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function ka(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(d){let f;s++,!r||a?(a=!1,r=new mg(n,e,i),f=r.subscribe(this),o=d.subscribe({next(p){r.next(p)},error(p){a=!0,r.error(p)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):f=r.subscribe(this),this.add(()=>{s--,f.unsubscribe(),f=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}const Y4=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function Xi(n){return e=>0===n?mE():e.lift(new wye(n))}class wye{constructor(e){if(this.total=e,this.total<0)throw new Y4}call(e,t){return t.subscribe(new Eye(e,this.total))}}class Eye extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function X4(n,e){return e?t=>t.pipe(X4((i,r)=>Pe(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new Sye(n))}class Sye{constructor(e){this.project=e}call(e,t){return t.subscribe(new xye(e,this.project))}}class xye extends fe{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new wt(this),i=this.destination;i.add(t);const r=R(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function OS(n=null){return e=>e.lift(new Cye(n))}class Cye{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new Aye(e,this.defaultValue))}}class Aye extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function lc(n){return function(t){const i=new Tye(n),r=t.lift(i);return i.caught=r}}class Tye{constructor(e){this.selector=e}call(e,t){return t.subscribe(new Dye(e,this.selector,this.caught))}}class Dye extends fe{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new wt(this);this.add(i);const r=R(t,i);r!==i&&this.add(r)}}}function os(n){return e=>e.lift(new Mye(n))}class Mye{constructor(e){this.notifier=e}call(e,t){const i=new Iye(e),r=R(this.notifier,new wt(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class Iye extends fe{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function nh(){}function Zr(n,e,t){return function(r){return r.lift(new Rye(n,e,t))}}class Rye{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new Oye(e,this.nextOrObserver,this.error,this.complete))}}class Oye extends y{constructor(e,t,i,r){super(e),this._tapNext=nh,this._tapError=nh,this._tapComplete=nh,this._tapError=i||nh,this._tapComplete=r||nh,K(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||nh,this._tapError=t.error||nh,this._tapComplete=t.complete||nh)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function $u(n,e){return t=>t.lift(new Nye(n,e))}class Nye{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new Pye(e,this.compare,this.keySelector))}}class Pye extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const Ba={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let Q4=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return mn.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return mn.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof mn||console.warn(Ba.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(Ie(mn),Ie(Pc))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Z4=new Vt("ROOT_STATE_TOKEN"),J4=new Vt("FEATURE_STATE_TOKEN"),e8=new Vt("NGXS_PLUGINS"),t8=new Vt("NG_TEST_MODE"),n8=new Vt("NG_DEV_MODE"),Wu="NGXS_META",i8="NGXS_OPTIONS_META";let Tf=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=Q4}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Fye{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const r8=new Vt("NGXS_EXECUTION_STRATEGY");function Df(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const s8=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},NS=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),rO=n=>n&&"object"==typeof n&&!Array.isArray(n),sO=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(rO(n)&&rO(t))for(const i in t)rO(t[i])?(n[i]||Object.assign(n,{[i]:{}}),sO(n[i],t[i])):Object.assign(n,{[i]:t[i]});return sO(n,...e)};function N0(n){return n[Wu]}function a8(n,e){const t=NS(e.currentAppState,n.path),i=NS(e.newAppState,n.path);return new Fye(t,i,!n.isInitialised)}function Hye(...n){return function(n,e,t=Wye){const i=function(n){return n.reduce((e,t)=>(e[Df(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return Ui(t=>{const i=Df(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function Wye(){return me(n=>n.action)}function PS(n){return e=>new F(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let FS=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(r8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Yye extends ee{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let LS=(()=>{class n extends Yye{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=nr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Xye=(()=>{class n extends F{constructor(t,i){super(r=>{const s=t.pipe(PS(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(Ie(LS),Ie(FS))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const l8=n=>(...e)=>n.shift()(...e,(...i)=>l8(n)(...i));let kS=(()=>{class n extends Or{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),cO=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12),Ie(e8,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),uO=(()=>{class n extends ee{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=nr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),c8=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(Zo),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(PS(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?an(this._stateStream.getValue()):O0(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!Df(t))return gg(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return l8([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(ka())}getActionResultStream(t){return this._actionResults.pipe(Ui(i=>i.action===t&&"DISPATCHED"!==i.status),Xi(1),ka())}createDispatchObservable(t){return t.pipe(X4(i=>{switch(i.status){case"SUCCESSFUL":return an(this._stateStream.getValue());case"ERRORED":return gg(i.error);default:return Lc}})).pipe(ka())}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hn),Ie(LS),Ie(uO),Ie(cO),Ie(kS),Ie(FS))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const u8=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&u8(n[i])}),n};let d8=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(Ie(n8),Ie(t8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),h8=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(Ba.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(Ba.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(Ie(d8),Ie(Tf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Yg=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=u8(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(Ie(kS),Ie(c8),Ie(Tf),Ie(h8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),BS=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return NS(l,t.path)}function s(l,c){const d=s8(l,t.path,c),f=t.instance;if(f.ngxsOnChanges){const p=a8(t,{currentAppState:l,newAppState:d});f.ngxsOnChanges(p)}return i.setState(d),d}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error(Ba.PATCHING_ARRAY());if("object"!=typeof n)throw new Error(Ba.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Yg))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class jS{static stateNameErrorMessage(e){return Ba.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(Ba.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error(Ba.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=N0(e);if(!t)throw new Error(Ba.STATE_DECORATOR());return t}}jS.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let Xg=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=W4(()=>{const c=this;function d(p){const g=c.statePaths[p];return g?function(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(p){let g=d(p);return g||((..._)=>(g||(g=d(p)),g?g(..._):void 0))},getSelectorOptions:p=>Object.assign({},c._config.selectorOptions,p||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach(jS.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[Wu].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[Wu];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[Wu].name]=t,e),{})}(i),l=[];for(const c of s){const d=a[c],f=o[c],p=d[Wu];this.addRuntimeInfoToMeta(p,f);const g={name:c,path:f,isInitialised:!1,actions:p.actions,instance:this._injector.get(d),defaults:n.cloneDefaults(p.defaults)};this.hasBeenMountedAndBootstrapped(c,f)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>s8(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(Ui(t=>"DISPATCHED"===t.status),k(({action:t})=>this.invokeActions(this._actions,t).pipe(me(()=>({action:t,status:"SUCCESSFUL"})),OS({action:t,status:"CANCELED"}),lc(i=>an({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=Df(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let d=o.instance[l.fn](c,i);d instanceof Promise&&(d=Pe(d)),d instanceof F?(d=d.pipe(OS({})),l.options.cancelUncompleted&&(d=d.pipe(os(t.pipe(Hye(i)))))):d=an({}).pipe(ka()),s.push(d)}catch(d){s.push(gg(d))}}}return s.length||s.push(an({})),O0(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=jS.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==NS(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hn),Ie(Tf),Ie(n,12),Ie(LS),Ie(uO),Ie(BS),Ie(nO,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),dO=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(Ui(()=>!!i),Zr(()=>this.invokeInit(i.states)),k(()=>this.bootstrapper.appBootstrapped$),Ui(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=a8(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Yg),Ie(BS),Ie(tO))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();let ih=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(me(i),lc(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?an(void 0):gg(r)}),$u(),PS(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(Xi(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(PS(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return function(n){const e=function(n){return n.NGXS_SELECTOR_META}(n)||N0(n);return e&&e.makeRootSelector||(()=>n)}(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(kS),Ie(Yg),Ie(Tf),Ie(FS),Ie(Xg),Ie(nO,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),P0=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(Ie(ih),Ie(Tf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class i0e{static get type(){return"@@INIT"}}class r0e{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const US=new mg(1);let LO,o0e=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&Ma();US.next(t)}catch(n){US.next(!1)}finally{US.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new i0e,l)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Xg),Ie(Yg),Ie(ih),Ie(P0),Ie(Z4,8),Ie(dO))},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({}),n})(),a0e=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new r0e(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(Ie(ih),Ie(Yg),Ie(Xg),Ie(J4,8),Ie(dO))},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({}),n})();class la{static forRoot(e=[],t={}){return{ngModule:o0e,providers:[Xg,BS,Xye,LS,tO,h8,d8,dO,c8,uO,Yg,FS,ih,kS,P0,cO,...e,...la.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:a0e,providers:[Xg,cO,...e,{provide:J4,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:t8,useValue:mye},{provide:n8,useValue:Ma},{provide:r8,useClass:t.executionStrategy||Q4},{provide:Z4,useValue:e},{provide:la.ROOT_OPTIONS,useValue:t},{provide:Tf,useFactory:la.ngxsConfigFactory,deps:[la.ROOT_OPTIONS]},{provide:Bw,useFactory:la.appBootstrapListenerFactory,multi:!0,deps:[tO]},{provide:nO,useFactory:la.getInitialState},{provide:q4,useExisting:BS},{provide:K4,useExisting:Xg}]}static ngxsConfigFactory(e){return sO(new Tf,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return _ye.pop()}}function c0e(n){return i=>{!function(n){US.subscribe(e=>{e&&(n.\u0275prov||console.warn(Ba.UNDECORATED_STATE_IN_IVY(n.name)))})}(i);const r=i,s=function(n){if(!n.hasOwnProperty(Wu)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,Wu,{value:e})}return N0(n)}(r),o=Object.getPrototypeOf(r),a=function(i){return Object.assign({},i[i8]||{},n)}(o);(function(i){const{meta:r,inheritedStateClass:s,optionsWithInheritance:o}=i,{children:a,defaults:l,name:c}=o,d="string"==typeof c?c:c&&c.getName()||null;jS.checkCorrectStateName(d),s.hasOwnProperty(Wu)&&(r.actions=Object.assign({},r.actions,(s[Wu]||{}).actions)),r.children=a,r.defaults=l,r.name=d})({meta:s,inheritedStateClass:o,optionsWithInheritance:a}),r[i8]=a}}la.\u0275fac=function(e){return new(e||la)},la.\u0275mod=gn({type:la}),la.\u0275inj=Et({}),la.ROOT_OPTIONS=new Vt("ROOT_OPTIONS"),new Jl(gE);try{LO="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){LO=!1}"undefined"!=typeof Element&&Element;function ZH(n){Promise.resolve(null).then(n)}class nm{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){ZH(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function e5(){return"undefined"!=typeof window&&void 0!==window.document}function zO(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let WO=(n,e)=>!1,qO=(n,e)=>!1,i5=(n,e,t)=>[];const r5=zO();(r5||"undefined"!=typeof Element)&&(WO=e5()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),qO=(()=>{if(r5||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):qO}})(),i5=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let Of=null,s5=!1;function KO(n){Of||(Of=("undefined"!=typeof document?document.body:null)||{},s5=!!Of.style&&"WebkitAppearance"in Of.style);let e=!0;return Of.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Of.style,!e&&s5&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Of.style)),e}const YO=qO,XO=WO,QO=i5;let a5=(()=>{class n{validateStyleProperty(t){return KO(t)}matchesElement(t,i){return YO(t,i)}containsElement(t,i){return XO(t,i)}query(t,i,r){return QO(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new nm(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class ox{}ox.NOOP=new a5;function d5(n,e,t){return t?e+":"+t+";":""}function h5(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=d5(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=d5(0,lbe(t),n.style[t]));n.setAttribute("style",e)}function eu(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=nN(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),zO()&&h5(n))}function Pf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=nN(t);n.style[i]=""}),zO()&&h5(n))}const abe=/-+([a-z0-9])/g;function nN(n){return n.replace(abe,(...e)=>e[1].toUpperCase())}function lbe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class sm{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=sm.initialStylesByElement.get(e);r||sm.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&eu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(eu(this._element,this._initialStyles),this._endStyles&&(eu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(sm.initialStylesByElement.delete(this._element),this._startStyles&&(Pf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Pf(this._element,this._endStyles),this._endStyles=null),eu(this._element,this._initialStyles),this._state=3)}}sm.initialStylesByElement=new WeakMap;let Lf;try{Lf="undefined"!=typeof Intl}catch(n){Lf=!1}new class extends Jl{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends gE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let lEe=1;const cEe=Promise.resolve(),Dx={};function c6(n){return n in Dx&&(delete Dx[n],!0)}const u6={setImmediate(n){const e=lEe++;return Dx[e]=!0,cEe.then(()=>c6(e)&&n()),e},clearImmediate(n){c6(n)}};new class extends Jl{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends gE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=u6.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(u6.clearImmediate(t),e.scheduled=void 0)}});function X0(n){return!!n&&(n instanceof F||"function"==typeof n.lift&&"function"==typeof n.subscribe)}function Ix(...n){return It(1)(an(...n))}function Vo(...n){const e=n[n.length-1];return Te(e)?(n.pop(),t=>Ix(n,t,e)):t=>Ix(n,t)}function H6(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return t=>me(function(n,e){return i=>{let r=i;for(let s=0;s<e;s++){const o=null!=r?r[n[s]]:void 0;if(void 0===o)return;r=o}return r}}(n,e))(t)}"undefined"!=typeof window&&window,tt(266);class G6 extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class rxe extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function $6(n,e,t,i,r=new rxe(n,t,i)){if(!r.closed)return e instanceof F?e.subscribe(r):Re(e)(r)}const W6={};function Uo(...n){let e,t;return Te(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&L(n[0])&&(n=n[0]),Tn(n,t).lift(new q6(e))}class q6{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new sxe(e,this.resultSelector))}}class sxe extends G6{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(W6),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add($6(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===W6?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function tv(n){return!0===n}function za(n){return null==n}function Ha(n){return!za(n)}function HN(n){return Boolean(n)}function jG(n){return za(n)?n:JSON.parse(JSON.stringify(n))}tt(478),Object.create(Error.prototype),new Vt("SECURITY_CONTEXT");const qx=n=>{const t=n instanceof Date;if("object"!=typeof n||null===n||t)return n;Object.freeze(n);const r="function"==typeof n,s=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(o=>{s.call(n,o)&&(!r||"caller"!==o&&"callee"!==o&&"arguments"!==o)&&null!==n[o]&&("object"==typeof n[o]||"function"==typeof n[o])&&!Object.isFrozen(n[o])&&qx(n[o])}),n};function VG(n){return Ha(n)&&"object"==typeof n&&function(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}const HG="NGXS_DATA_META",$N="NGXS_META",GG="NGXS_ARGUMENT_REGISTRY_META";let $G=(()=>{class n{constructor(t){this.sequence$=new Or(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(Ie(ih,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function nv(n){return n[HG]}let Ga=(()=>{class n{constructor(t,i,r){n.store=t.get(ih),n.ngZone=t.get(mn),n.factory=i,n.context=r,n.computed=t.get($G)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(Ie(Hn),Ie(K4),Ie(q4))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class ls{constructor(){ls.statesCachedMeta.clear()}static createStateContext(e){return Ga.context.createStateContext(e)}static ensureMappedState(e){if(za(Ga.factory)||za(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(Ha(e.name)?ls.statesCachedMeta.get(e.name):null)||ls.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=nv(ls.getStateClassByInstance(e)))&&void 0!==t?t:null;if(za(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=ls.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);Ha(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=ls.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=Ha(e.name)?null===(t=Ga.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return Ha(i)&&Ha(e.name)&&ls.statesCachedMeta.set(e.name,i),i}}ls.statesCachedMeta=new Map,ls.\u0275fac=function(e){return new(e||ls)},ls.\u0275prov=We({token:ls,factory:ls.\u0275fac}),new mg(1);class NAe extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${Ha(null==e?void 0:e.constructor)?e.constructor.name:e} to PlainObject`)}}function WG(n){var e;return null!==(e=n.NGXS_OPTIONS_META)&&void 0!==e?e:{name:""}}function qG(n){var e;const t=WG(n),i=null!==(e=t.children)&&void 0!==e?e:[],s=jG(void 0===t.defaults?{}:t.defaults);if(i.length){if(VG(s))return function(n,e){return e.reduce((t,i)=>{const r=WG(i);if(function(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=qG(i),t},null!=n?n:{})}(s,i);throw new NAe(s)}return s}function YG(n){var e;return null!==(e=n.__NGXS_COMPUTED_OPTION__)&&void 0!==e?e:null}function XG(){var n,e;return null!==(e=null===(n=null==Ga?void 0:Ga.computed)||void 0===n?void 0:n.sequenceValue)&&void 0!==e?e:0}function kAe(n){let e=!1;return X0(n)&&(e=!0),e}function WN(n){return n[GG]}class BAe extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class jAe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){var t;return null!==(t=this.payloadMap.get(e))&&void 0!==t?t:null}getArgumentNameByIndex(e){var t;return null!==(t=this.argumentMap.get(e))&&void 0!==t?t:null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(HN(this.argumentMap.has(e))||HN(this.payloadMap.has(e)))throw new BAe(e,t)}}function $Ae(n){return{enumerable:!0,configurable:!0,get(){const e=nv(n),t=ls.ensureMappedState(e.stateMeta);return ls.createStateContext(t)}}}function QG(){return(n,e,t)=>{!function(n,e){if(!function(n,e){var t;let i=n,r=!1;if(VG(i))for(;null!==i;){if(tv(null==i?void 0:i.hasOwnProperty(e))){r=!!(null===(t=Object.getOwnPropertyDescriptor(i,e))||void 0===t?void 0:t.get);break}i=Object.getPrototypeOf(i)}return r}(n,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function(n){return za(YG(n))&&Object.defineProperties(n,{__NGXS_COMPUTED_OPTION__:{enumerable:!0,configurable:!0,value:new WeakMap}}),YG(n)}(this),o=null==s?void 0:s.get(i);if(tv(null==o?void 0:o.isObservable))return null==o?void 0:o.value;if(za(o)||o.sequenceId!==XG()){s.delete(i);const l=i.apply(this,r);return s.set(i,{value:l,sequenceId:XG(),isObservable:kAe(l)}),l}return o.value},t}}const QAe={cancelUncompleted:!0,insideZone:!1};function qN(n=QAe){return(e,t,i)=>{!function(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(e,i);const r=i.value,s=t.toString();return i.value=function(...o){const a=this;let l=null;const c=ls.getRepositoryByInstance(a),d=c.operations;let f=d[s];const p=c.stateMeta,g=WN(r);if(za(f)){const G=function(n){var e,t,i;return null!==(i=null===(t=null===(e=(n+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1))||void 0===e?void 0:e[0])||void 0===t?void 0:t.replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean))&&void 0!==i?i:[]}(r),ge=function(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)Ha(null==r?void 0:r.getArgumentNameByIndex(o))?s+=null==r?void 0:r.getArgumentNameByIndex(o):Ha(null==r?void 0:r.getPayloadTypeByIndex(o))?s+=null==r?void 0:r.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replace(/\./g,"/")}.${i}(${s})`}({statePath:p.path,methodName:s,argumentsNames:G,argumentRegistry:g});f=d[s]={type:ge,options:{cancelUncompleted:n.cancelUncompleted}},p.actions[f.type]=[{type:f.type,options:f.options,fn:f.type}]}ls.ensureMappedState(p).instance[f.type]=()=>{var G;return tv(n.insideZone)?null===(G=Ga.ngZone)||void 0===G||G.run(()=>{l=r.apply(a,o)}):l=r.apply(a,o),X0(l)?an(null).pipe(me(()=>l)):l};const A=ls.createAction(f,o,g),W=Ga.store.dispatch(A);return X0(l)?function(n,e){return O0([n,e]).pipe(me(t=>t.pop()))}(W,l):l},i}}function ZG(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function(n,e){const t=n[e];return za(WN(t))&&Object.defineProperties(t,{[GG]:{enumerable:!0,configurable:!0,value:new jAe}}),WN(t)})(e,t).createPayloadType(r,t,i)}}function JAe(){return n=>{const e=function(n){if(function(n){return!HN(n)}(n.hasOwnProperty($N))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,$N,{value:e})}return function(n){var e;return null===(e=n)||void 0===e?void 0:e[$N]}(n)}(n);if(za(e.name))throw new Error("@StateRepository should be add before decorator @State");!function(n,e){(function(n){var e;const t=null!==(e=nv(n))&&void 0!==e?e:null;return(za(t)||(null==t?void 0:t.stateClass)!==n)&&function(n){Object.defineProperty(n,HG,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),nv(n)}(n)).stateMeta=e}(n,e),function(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>jG(t)},context:$Ae(n)})}(n,e,qG(n)),function(n){var e,t;const i=nv(n),r=null!==(t=null===(e=null==i?void 0:i.stateMeta)||void 0===e?void 0:e.name)&&void 0!==t?t:null;if(Ha(r)){const s=`__${r}__selector`;Object.defineProperties(n.prototype,{[s]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(Ha(this[s]))return this[s];if(za(Ga.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[s]=Ga.store.select(n).pipe(me(o=>Ma()?qx(o):o),ka({refCount:!0,bufferSize:1})),this[s]}}})}}(n)}}let t1e=(()=>{class n{constructor(){this.browserStorageEvents$=new ee,this.isInitialised=!1,this.isBootstrapped=!1,this._dirty=!0}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){var r;this.dirty&&this.isBootstrapped&&(this.dirty=!1,null===(r=this.ngxsDataDoCheck)||void 0===r||r.call(this))}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){var i;this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,null===(i=this.ngxsDataDoCheck)||void 0===i||i.call(this))}markAsDirtyAfterReset(){var i;this.dirty=!0,null===(i=this.ngxsDataAfterReset)||void 0===i||i.call(this)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),n1e=(()=>{class n extends t1e{get snapshot(){return function(n){return Ma()?qx(n):n}(this.getState())}get ctx(){return function(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},n),{getState:()=>Ma()?qx(n.getState()):n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}})}(this.context)}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=nr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Ia([QG(),ec("design:type",Object),ec("design:paramtypes",[])],n.prototype,"snapshot",null),Ia([qN(),$3(0,ZG("patchValue")),ec("design:type",Function),ec("design:paramtypes",[Object]),ec("design:returntype",void 0)],n.prototype,"patchState",null),Ia([qN(),$3(0,ZG("stateValue")),ec("design:type",Function),ec("design:paramtypes",[Object]),ec("design:returntype",void 0)],n.prototype,"setState",null),Ia([qN(),ec("design:type",Function),ec("design:paramtypes",[]),ec("design:returntype",void 0)],n.prototype,"reset",null),n})();new Vt("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})});const _P=new Vt("ngx-window",{providedIn:"root",factory:()=>function(n){return function(n){return n===T3}(n)?window:null}(xc(Pc))}),xDe=new Vt("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(xc(_P))});new Vt("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(xc(_P),xc(xDe))}),new Vt("ngx-google-analytics-routing-settings",{factory:()=>({})}),new Vt("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"});const LDe=["bodyCanvas"];let kDe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new cn,this.nodeDrag=new cn,this.nodeClick=new cn,this.nodeHoverStart=new cn,this.nodeHoverStop=new cn,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return Yi(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new hye({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))]})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=wn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&Ds(LDe,5,An),2&t){let r;Ai(r=Ti())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&xu(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&function(n,e,t,i){Kt(n,e,t,i),Yt()}(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),BDe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({imports:[[Ws]]}),n})();new Vt("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10}),[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:large_intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:brain",organ:"Brain",name:"Allen Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{src:"app:lymph_nodes",organ:"Lymph Node",name:"Lymph Node, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph_nodes",organ:"Lymph Node",name:"Lymph Node, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:bone_marrow",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{src:"app:vasculature",organ:"Vasculature",name:"Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].filter(n=>!0!==n.disabled);let hv=(()=>{let n=class extends n1e{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(Ui(n=>null!=n),ka(1))}setConfig(t){this.setState(t)}patchConfig(t){this.patchState(t)}getProperty(t){return this.config$.pipe(H6(...t),$u(),ka(1))}getOption(...t){const i=this.getPathKey(t);if(this.optionCache.has(i))return this.optionCache.get(i);const r=this.config$.pipe(H6(...t),$u(),ka(1));return this.optionCache.set(i,r),r}getPathKey(t){return`${t.length}:${t.join(".")}`}};return n.\u0275fac=function(){let e;return function(i){return(e||(e=nr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Ia([QG()],n.prototype,"config$",null),n=Ia([JAe(),c0e({name:"globalConfig",defaults:null})],n),n})();function hC(n){return Array.isArray(n)?n.join(","):`${n}`}!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}(),hC([1,110]),hC([13,83]),hC(["http://purl.obolibrary.org/obo/UBERON_0013702"]);const f7="http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity",yMe=[173,255,47,229.5];var Qn=tt(440),SMe=tt(698),xMe=tt(445),CMe=tt.n(xMe),En=tt(815),$a=tt(609);const Hi=Qn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},Qn.DataFactory),ym=(Hi("rdf"),Hi("rdf")("type"),{x:Hi("rdfs"),label:Hi("rdfs")("label"),comment:Hi("rdfs")("comment"),isDefinedBy:Hi("rdfs")("isDefinedBy"),seeAlso:Hi("rdfs")("seeAlso")}),Os={x:Hi("entity"),id:Hi("entity")("id"),label:ym.label,description:ym.comment,link:ym.seeAlso,sex:Hi("entity")("sex"),age:Hi("entity")("age"),bmi:Hi("entity")("bmi"),Male:Qn.DataFactory.literal("Male"),Female:Qn.DataFactory.literal("Female"),consortiumName:Hi("entity")("consortium_name"),providerName:Hi("entity")("provider_name"),providerUUID:Hi("entity")("provider_uuid"),donor:Hi("entity")("has_donor"),sections:Hi("entity")("has_tissue_section"),datasets:Hi("entity")("has_dataset"),sampleType:Hi("entity")("sample_type"),TissueBlock:Qn.DataFactory.literal("Tissue Block"),TissueSection:Qn.DataFactory.literal("Tissue Section"),NonStandard:Qn.DataFactory.literal("Non-standard"),sectionCount:Hi("entity")("section_count"),sectionSize:Hi("entity")("section_size"),sectionUnits:Hi("entity")("section_units"),sectionNumber:Hi("entity")("section_number"),spatialEntity:Hi("entity")("has_spatial_entity"),ontologyTerms:Hi("entity")("has_ontology_term"),technology:Hi("entity")("technology"),thumbnail:Hi("entity")("has_thumbnail")},In=Hi("ccf"),dc={x:In,ontologyNode:{label:In("ccf_preferred_label"),parent:In("ccf_part_of"),children:In("ccf_part_of"),rui_rank:In("ccf_rui_rank"),synonymLabels:Qn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},spatial:{Female:In("VHFemale"),Male:In("VHMale"),BothSexes:In("VHBothSexes"),FemaleOrgans:In("VHFemaleOrgans"),MaleOrgans:In("VHMaleOrgans")},SpatialObjectReference:In("SpatialObjectReference"),SpatialEntity:In("SpatialEntity"),SpatialPlacement:In("SpatialPlacement"),spatialObjectReference:{file:In("has_object_file"),file_format:In("has_object_file_format"),file_subpath:In("has_object_file_subpath")},extractionSet:{label:ym.label,rui_rank:In("ccf_rui_rank")},spatialEntity:{label:ym.label,comment:ym.comment,creator:Hi("dc")("creator"),creator_first_name:In("creator_first_name"),creator_last_name:In("creator_last_name"),creator_orcid:In("creator_orcid"),creation_date:In("creation_date"),updated_date:In("updated_date"),ccf_annotations:In("ccf_annotation"),representation_of:In("ccf_representation_of"),reference_organ:In("anatomical_structure_of"),extraction_set_for:In("extraction_set_for"),extraction_set:In("extraction_site_for"),sex:In("has_sex"),side:In("has_side"),rui_rank:In("ccf_rui_rank"),slice_thickness:In("ccf_slice_thickness"),slice_count:In("ccf_slice_count"),x_dimension:In("has_x_dimension"),y_dimension:In("has_y_dimension"),z_dimension:In("has_z_dimension"),dimension_units:In("has_dimension_units"),object:In("has_object_reference")},spatialPlacement:{source:In("has_placement_source"),target:In("has_placement_target"),placement_date:In("has_placement_date"),x_scaling:In("has_x_scaling"),y_scaling:In("has_y_scaling"),z_scaling:In("has_z_scaling"),scaling_units:In("has_scaling_units"),x_rotation:In("has_x_rotation"),y_rotation:In("has_y_rotation"),z_rotation:In("has_z_rotation"),w_rotation:In("has_theta_rotation"),rotation_order:In("has_rotation_order"),rotation_units:In("has_rotation_units"),x_translation:In("has_x_translation"),y_translation:In("has_y_translation"),z_translation:In("has_z_translation"),translation_units:In("has_translation_units")}},Tr={x:Hi("uberon")},TMe=(Hi("lmha"),{bladder:Tr.x("0001255"),body:Tr.x("0013702"),brain:Tr.x("0000955"),colon:Tr.x("0001155"),heart:Tr.x("0000948"),kidney:Tr.x("0002113"),large_intestine:Tr.x("0000059"),left_kidney:Tr.x("0004538"),left_lung:Tr.x("0002168"),left_ureter:Tr.x("0001223"),liver:Tr.x("0002107"),lung:Tr.x("0002048"),respiratory_system:Tr.x("0001004"),lymph_node:Tr.x("0000029"),pelvis:Tr.x("0001270"),rectum:Tr.x("0001052"),right_kidney:Tr.x("0004539"),right_lung:Tr.x("0002167"),right_ureter:Tr.x("0001222"),skin:Tr.x("0002097"),small_intestine:Tr.x("0002108"),spleen:Tr.x("0002106"),thymus:Tr.x("0002370"),ureter:Tr.x("0000056"),vasculature:Tr.x("0002049")});function bP(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const fC={spatialObjectReference:bP(dc.spatialObjectReference),spatialEntity:bP(dc.spatialEntity),spatialPlacement:bP(dc.spatialPlacement)};function pC(n,e,t,i){const r={"@id":e,"@type":t};return n.some(s=>{const o=i[s.predicate.id];if(o){const a="Literal"===s.object.termType?(0,$a.fromRdf)(s.object):s.object.id;(0,En.set)(r,o,a)}return!1},Qn.DataFactory.namedNode(e),null,null,null),r}const MMe=(0,En.memoize)(function(n,e){return pC(n,e,"SpatialObjectReference",fC.spatialObjectReference)},(n,e)=>e),RMe=(0,En.memoize)(function(n,e){const t=pC(n,e,"ExtractionSet",fC.spatialEntity);return t.extractionSites=(0,En.sortBy)(n.getSubjects(dc.spatialEntity.extraction_set,e,null).map(i=>vm(n,i.id)),["rui_rank"]),t},(n,e)=>e);(0,En.memoize)(function(n,e){return(0,En.sortBy)(n.getSubjects(dc.spatialEntity.extraction_set_for,e,null).map(t=>RMe(n,t.id)),["rui_rank"])},(n,e)=>e),(0,En.memoize)(function(n,e){return(0,En.sortBy)(n.getSubjects(dc.spatialEntity.reference_organ,e,null).map(t=>vm(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])},(n,e)=>e),(0,En.memoize)(function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(vm(n,t.subject.id))},null,dc.spatialEntity.reference_organ,null,null),(0,En.sortBy)(e,["rui_rank"])});const vm=(0,En.memoize)(function(n,e){const t=pC(n,e,"SpatialEntity",fC.spatialEntity);return t.object&&(t.object=MMe(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,dc.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,Os.spatialEntity,e,null),t},(n,e)=>e);(0,En.memoize)(function(n,e){const t=pC(n,e,"SpatialPlacement",fC.spatialPlacement);return t.source&&(t.source=vm(n,t.source)),t.target&&(t.target=vm(n,t.target)),t},(n,e)=>e),(0,En.memoize)(function(n,e){const t=n.getObjects(Qn.DataFactory.namedNode(e),Os.spatialEntity,null);if(t.length>0)return vm(n,t[0].id)},(n,e)=>e),new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),function(){const n={};Object.entries(TMe).forEach(([e,t])=>n[e]=t.id)}();const yC={[Os.label.id]:"label",[Os.description.id]:"description",[Os.link.id]:"link"},lIe=Object.assign(Object.assign({},yC),{[Os.providerName.id]:"providerName"}),cIe=Object.assign(Object.assign({},yC),{[Os.technology.id]:"technology",[Os.thumbnail.id]:"thumbnail"}),uIe=Object.assign(Object.assign({},yC),{[Os.sampleType.id]:"sampleType",[Os.sectionNumber.id]:"sectionNumber",[Os.datasets.id]:"datasets"}),dIe=Object.assign(Object.assign({},yC),{[Os.sampleType.id]:"sampleType",[Os.sectionCount.id]:"sectionCount",[Os.sectionSize.id]:"sectionSize",[Os.sectionUnits.id]:"sectionUnits",[Os.donor.id]:"donor",[Os.spatialEntity.id]:"spatialEntityId",[Os.sections.id]:"sections",[Os.datasets.id]:"datasets"}),fIe=(0,En.memoize)(function(n,e){const t={"@id":e,"@type":"Donor"};return n.some(i=>{const r=lIe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,$a.fromRdf)(i.object):i.object.id;(0,En.set)(t,r,s)}return!1},Qn.DataFactory.namedNode(e),null,null,null),t},(n,e)=>e);function _7(n,e){const t={"@id":e,"@type":"Dataset"};return n.some(i=>{const r=cIe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,$a.fromRdf)(i.object):i.object.id;(0,En.set)(t,r,s)}return!1},Qn.DataFactory.namedNode(e),null,null,null),t}(0,En.memoize)(function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};return n.some(i=>{const r=dIe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,$a.fromRdf)(i.object):i.object.id;if("sections"===r){const o=function(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};return n.some(i=>{const r=uIe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,$a.fromRdf)(i.object):i.object.id;if("datasets"===r){const o=_7(n,s);t[r].push(o)}else(0,En.set)(t,r,s)}return!1},Qn.DataFactory.namedNode(e),null,null,null),t}(n,s);t[r].push(o)}else if("datasets"===r){const o=_7(n,s);t[r].push(o)}else"donor"===r?t[r]=fIe(n,s):(0,En.set)(t,r,s)}return!1},Qn.DataFactory.namedNode(e),null,null,null),t},(n,e)=>e);const y7={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};function ru(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let EP;function hc(){return EP||(EP=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),ru(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),EP}function v7(n,e=hc()){return e("readonly",t=>ru(t.get(n)))}const Gi=Qn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},Qn.DataFactory),b7={x:Gi("rdf"),type:Gi("rdf")("type")},bm={x:Gi("rdfs"),label:Gi("rdfs")("label"),comment:Gi("rdfs")("comment"),isDefinedBy:Gi("rdfs")("isDefinedBy"),seeAlso:Gi("rdfs")("seeAlso")},gi={x:Gi("entity"),id:Gi("entity")("id"),label:bm.label,description:bm.comment,link:bm.seeAlso,sex:Gi("entity")("sex"),age:Gi("entity")("age"),bmi:Gi("entity")("bmi"),Male:Qn.DataFactory.literal("Male"),Female:Qn.DataFactory.literal("Female"),consortiumName:Gi("entity")("consortium_name"),providerName:Gi("entity")("provider_name"),providerUUID:Gi("entity")("provider_uuid"),donor:Gi("entity")("has_donor"),sections:Gi("entity")("has_tissue_section"),datasets:Gi("entity")("has_dataset"),sampleType:Gi("entity")("sample_type"),TissueBlock:Qn.DataFactory.literal("Tissue Block"),TissueSection:Qn.DataFactory.literal("Tissue Section"),NonStandard:Qn.DataFactory.literal("Non-standard"),sectionCount:Gi("entity")("section_count"),sectionSize:Gi("entity")("section_size"),sectionUnits:Gi("entity")("section_units"),sectionNumber:Gi("entity")("section_number"),spatialEntity:Gi("entity")("has_spatial_entity"),ontologyTerms:Gi("entity")("has_ontology_term"),technology:Gi("entity")("technology"),thumbnail:Gi("entity")("has_thumbnail")},Rn=Gi("ccf"),lr={x:Rn,ontologyNode:{label:Rn("ccf_preferred_label"),parent:Rn("ccf_part_of"),children:Rn("ccf_part_of"),rui_rank:Rn("ccf_rui_rank"),synonymLabels:Qn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},spatial:{Female:Rn("VHFemale"),Male:Rn("VHMale"),BothSexes:Rn("VHBothSexes"),FemaleOrgans:Rn("VHFemaleOrgans"),MaleOrgans:Rn("VHMaleOrgans")},SpatialObjectReference:Rn("SpatialObjectReference"),SpatialEntity:Rn("SpatialEntity"),SpatialPlacement:Rn("SpatialPlacement"),spatialObjectReference:{file:Rn("has_object_file"),file_format:Rn("has_object_file_format"),file_subpath:Rn("has_object_file_subpath")},extractionSet:{label:bm.label,rui_rank:Rn("ccf_rui_rank")},spatialEntity:{label:bm.label,comment:bm.comment,creator:Gi("dc")("creator"),creator_first_name:Rn("creator_first_name"),creator_last_name:Rn("creator_last_name"),creator_orcid:Rn("creator_orcid"),creation_date:Rn("creation_date"),updated_date:Rn("updated_date"),ccf_annotations:Rn("ccf_annotation"),representation_of:Rn("ccf_representation_of"),reference_organ:Rn("anatomical_structure_of"),extraction_set_for:Rn("extraction_set_for"),extraction_set:Rn("extraction_site_for"),sex:Rn("has_sex"),side:Rn("has_side"),rui_rank:Rn("ccf_rui_rank"),slice_thickness:Rn("ccf_slice_thickness"),slice_count:Rn("ccf_slice_count"),x_dimension:Rn("has_x_dimension"),y_dimension:Rn("has_y_dimension"),z_dimension:Rn("has_z_dimension"),dimension_units:Rn("has_dimension_units"),object:Rn("has_object_reference")},spatialPlacement:{source:Rn("has_placement_source"),target:Rn("has_placement_target"),placement_date:Rn("has_placement_date"),x_scaling:Rn("has_x_scaling"),y_scaling:Rn("has_y_scaling"),z_scaling:Rn("has_z_scaling"),scaling_units:Rn("has_scaling_units"),x_rotation:Rn("has_x_rotation"),y_rotation:Rn("has_y_rotation"),z_rotation:Rn("has_z_rotation"),w_rotation:Rn("has_theta_rotation"),rotation_order:Rn("has_rotation_order"),rotation_units:Rn("has_rotation_units"),x_translation:Rn("has_x_translation"),y_translation:Rn("has_y_translation"),z_translation:Rn("has_z_translation"),translation_units:Rn("has_translation_units")}},Dr={x:Gi("uberon")},w7=(Gi("lmha"),{bladder:Dr.x("0001255"),body:Dr.x("0013702"),brain:Dr.x("0000955"),colon:Dr.x("0001155"),heart:Dr.x("0000948"),kidney:Dr.x("0002113"),large_intestine:Dr.x("0000059"),left_kidney:Dr.x("0004538"),left_lung:Dr.x("0002168"),left_ureter:Dr.x("0001223"),liver:Dr.x("0002107"),lung:Dr.x("0002048"),respiratory_system:Dr.x("0001004"),lymph_node:Dr.x("0000029"),pelvis:Dr.x("0001270"),rectum:Dr.x("0001052"),right_kidney:Dr.x("0004539"),right_lung:Dr.x("0002167"),right_ureter:Dr.x("0001222"),skin:Dr.x("0002097"),small_intestine:Dr.x("0002108"),spleen:Dr.x("0002106"),thymus:Dr.x("0002370"),ureter:Dr.x("0000056"),vasculature:Dr.x("0002049")});function xP(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const vC={spatialObjectReference:xP(lr.spatialObjectReference),spatialEntity:xP(lr.spatialEntity),spatialPlacement:xP(lr.spatialPlacement)};function bC(n,e,t,i){const r={"@id":e,"@type":t};return n.some(s=>{const o=i[s.predicate.id];if(o){const a="Literal"===s.object.termType?(0,$a.fromRdf)(s.object):s.object.id;(0,En.set)(r,o,a)}return!1},Qn.DataFactory.namedNode(e),null,null,null),r}const SIe=(0,En.memoize)(function(n,e){return bC(n,e,"SpatialObjectReference",vC.spatialObjectReference)},(n,e)=>e),E7=(0,En.memoize)(function(n,e){const t=bC(n,e,"ExtractionSet",vC.spatialEntity);return t.extractionSites=(0,En.sortBy)(n.getSubjects(lr.spatialEntity.extraction_set,e,null).map(i=>$f(n,i.id)),["rui_rank"]),t},(n,e)=>e),AIe=(0,En.memoize)(function(n,e){return(0,En.sortBy)(n.getSubjects(lr.spatialEntity.extraction_set_for,e,null).map(t=>E7(n,t.id)),["rui_rank"])},(n,e)=>e),DIe=(0,En.memoize)(function(n,e){return(0,En.sortBy)(n.getSubjects(lr.spatialEntity.reference_organ,e,null).map(t=>$f(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])},(n,e)=>e),IIe=(0,En.memoize)(function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push($f(n,t.subject.id))},null,lr.spatialEntity.reference_organ,null,null),(0,En.sortBy)(e,["rui_rank"])}),$f=(0,En.memoize)(function(n,e){const t=bC(n,e,"SpatialEntity",vC.spatialEntity);return t.object&&(t.object=SIe(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,lr.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,gi.spatialEntity,e,null),t},(n,e)=>e),NIe=(0,En.memoize)(function(n,e){const t=bC(n,e,"SpatialPlacement",vC.spatialPlacement);return t.source&&(t.source=$f(n,t.source)),t.target&&(t.target=$f(n,t.target)),t},(n,e)=>e),FIe=(0,En.memoize)(function(n,e){const t=n.getObjects(Qn.DataFactory.namedNode(e),gi.spatialEntity,null);if(t.length>0)return $f(n,t[0].id)},(n,e)=>e);function LIe(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(VB),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class S7{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new SMe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},b7.type,lr.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},b7.type,lr.SpatialEntity,null);const t={};e.some(i=>(t[i.subject.id]=i.object.id,!1),null,lr.spatialPlacement.source,null,null),e.some(i=>{const r=t[i.subject.id];return r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement"),!1},null,lr.spatialPlacement.target,null,null)}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new Gn(Gn.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new Gn(Gn.IDENTITY),s=CMe()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s){if(o){const l=this.graph.getEdgeAttribute(a,o,"id");LIe(r,NIe(i,l))}o=a}return r}}}class x7{constructor(e){this.db=e}getSpatialEntity(e){return $f(this.db.store,e)}getExtractionSets(e){return AIe(this.db.store,e)}getExtractionSet(e){return E7(this.db.store,e)}getAnatomicalStructures(e){return DIe(this.db.store,e)}getReferenceOrgans(){return IIe(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=lr.spatial.Male.id;break;case"Female":t=lr.spatial.Female.id;break;case"Both":default:t=lr.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e);let i=[...this.getReferenceOrganSets(e).map(r=>{const s="http://purl.obolibrary.org/obo/UBERON_0002097"===r.representation_of;return this.getSceneNode(r,t,{color:[255,255,255,255],opacity:s?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!s})})];return(null==e?void 0:e.debug)&&(i=i.concat([this.getSceneNode(this.getSpatialEntity(lr.x("VHRightKidney").id),t,{color:[0,0,255,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(lr.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(lr.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(lr.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(lr.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],wireframe:!0})])),i.filter(r=>void 0!==r)}getReferenceOrganScene(e,t){var i,r;const s=null!==(i=void 0!==(null==t?void 0:t.sex))&&void 0!==i&&i,o=this.getReferenceOrgans().filter(a=>a.representation_of===e&&(!s||a.sex===(null==t?void 0:t.sex)));if(o.length>0){const a=o[0],c=this.getSceneNode(a,a,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===a.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),d=(null!==(r=this.db.getSpatialEntities(t))&&void 0!==r?r:[]).map(f=>this.getSceneNode(f,a,{color:[255,255,255,229.5]}));return[c].concat(d).filter(f=>void 0!==f)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let d=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(d){if(l)d=new Gn(Gn.IDENTITY).rotateX(VB(90)).multiplyLeft(d);else{let f;switch(e.dimension_units){case"centimeter":f=.01;break;case"millimeter":f=.001;break;case"meter":default:f=1}const p=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*f/2);d.scale(p)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:d,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const wC="https://entity.api.hubmapconsortium.org/entities/",C7=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),kIe={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},EC={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford"},xi=function(){const n={};return Object.entries(w7).forEach(([e,t])=>n[e]=t.id),n}(),jIe={BL:[xi.body,xi.bladder],RK:[xi.body,xi.kidney,xi.right_kidney],LK:[xi.body,xi.kidney,xi.left_kidney],HT:[xi.body,xi.heart],LI:[xi.body,xi.large_intestine,xi.colon],SI:[xi.body,xi.small_instestine],LL:[xi.body,xi.respiratory_system,xi.lung,xi.left_lung],RL:[xi.body,xi.respiratory_system,xi.lung,xi.right_lung],LY:[xi.body,xi.lymph_node],SP:[xi.body,xi.spleen],TH:[xi.body,xi.thymus],UR:[xi.body,xi.ureter],LV:[xi.body,xi.liver],OT:[xi.body]},A7={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class zIe{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],d=(this.data.ancestors||[]).find($e=>"Donor"===$e.entity_type);this.donor=this.getDonor(d,i);const f=this.getRuiLocation(e,this.donor);f?this.rui_location=f:this.bad=!0;const p=new Date(e.last_modified_timestamp).toLocaleDateString(),g=EC[e.group_uuid]||e.group_name,_=e.created_by_user_displayname;this["@id"]=wC+e.uuid,this.label=`Registered ${p}, ${_}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const x={},A=[];this.sections=A;const W=[];this.datasets=W;for(const $e of c.filter(at=>"Sample"===at.entity_type)){const at=this.getSection($e,e,i);x[$e.submission_id]=at,A.push(at),at.section_number=null!==(s=at.section_number)&&void 0!==s?s:A.length}for(const $e of c)if("Dataset"===$e.entity_type){const at=this.getDataset($e,t,i,r),St=(0,En.get)($e,["ingest_metadata","metadata","tissue_id"]);x[St]?null===(o=x[St].datasets)||void 0===o||o.push(at):W.push(at)}const G=null!=f?f:{},ge=`${G.x_dimension} x ${G.y_dimension} x ${G.z_dimension} ${G.dimension_units}`;this.section_count=G.slice_count||A.length;const Ne=parseFloat((G.slice_thickness||(G.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=Ne;const Ge=G.dimension_units||"millimeter";this.section_units=Ge,this.description=`${ge}, ${Ne} ${Ge}, ${e.specimen_type}, ${this.section_count} Sections`,A.forEach(($e,at)=>{$e.description=`${G.x_dimension} x ${G.y_dimension} x ${Ne} ${Ge}, ${Ne} ${Ge}, ${$e.description}`,$e.section_number=at+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":wC+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${EC[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=EC[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,En.get)(e,["ingest_metadata","metadata","assay_type"],"")],d=c.join("|").toLowerCase();let f,p="assets/icons/ico-unknown.svg";return-1!==d.indexOf("10x")?(f="10x",p="assets/icons/ico-bulk-10x.svg"):-1!==d.indexOf("af")?(f="AF",p="assets/icons/ico-spatial-af.svg"):-1!==d.indexOf("codex")?(f="CODEX",p="assets/icons/ico-spatial-codex.svg"):-1!==d.indexOf("imc")?(f="IMC",p="assets/icons/ico-spatial-imc.svg"):-1!==d.indexOf("lc")&&-1===d.indexOf("af")?(f="LC",p="assets/icons/ico-bulk-lc.svg"):f=-1!==d.indexOf("maldi")?"MALDI":-1!==d.indexOf("pas")?"PAS":"OTHER",p=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:p,{"@id":wC+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:f,thumbnail:p}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,En.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>C7.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(C7.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=kIe[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,En.toNumber)(s[1]));for(const p of(0,En.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===p.preferred_term||"Female"===p.preferred_term?r="Female":"Masculine gender"===p.preferred_term||"Male"===p.preferred_term?r="Male":"Current chronological age"===p.preferred_term||"Age"===p.preferred_term?o=(0,En.toNumber)(p.data_value):"Body mass index"===p.preferred_term&&(a=(0,En.toNumber)(p.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),d=EC[e.group_uuid]||e.group_name;return{"@id":wC+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${d}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:d,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;const s=(e.ancestors||[]).find(c=>"Sample"===c.entity_type&&"organ"===c.specimen_type),o=jIe[null==s?void 0:s.organ]||[xi.body];let a,l=e.rui_location;if(l&&("string"==typeof l&&(l=JSON.parse(l)),l.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):l["@id"]&&(a=l)),a){a.ccf_annotations=o.concat(a.ccf_annotations||[]);const c=null!==(i=(0,En.get)(a,["placement","target"]))&&void 0!==i?i:"";c.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")&&(0,En.set)(a,["placement","target"],c.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")),("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===c||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===c)&&(0,En.set)(a,["placement","target"],"Male"===t.sex?c.replace("#VH","#VHM")+"_Patch":c.replace("#VH","#VHF")+"_Patch")}return a}getTissueBlock(){return(0,En.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}const GIe=["uuid","entity_type","group_uuid","group_name","last_modified_timestamp","created_by_user_displayname","ancestors","descendants","rui_location","specimen_type"],$Ie={exists:{field:"rui_location"}};function T7(n,e,t){return JSON.stringify({version:!0,from:n,size:e,stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:$Ie,_source:{includes:GIe}})}function CP(n,e){return Yi(this,void 0,void 0,function*(){try{const t=yield fetch(n,e);return t.ok?yield t.json():void 0}catch(t){return}})}function D7(n,e,t,i,r="",s=""){return Yi(this,void 0,void 0,function*(){let o;if("static"===e?o=yield CP(n):"search-api"===e&&(o=yield function(n,e,t){return Yi(this,void 0,void 0,function*(){const r=function(n){const e=new Headers;return e.append("Content-type","application/json"),n&&e.append("Authorization",`Bearer ${n}`),e}(e),s=T7(0,50,t),o=yield CP(n,{method:"POST",headers:r,body:s});if(!o)return;const a=o.hits.total.value;if(a<=50)return o;const l=[];for(let f=50;f<a;f+=50)l.push(CP(n,{method:"POST",headers:r,body:T7(f,50,t)}));const c=yield Promise.all(l);if(c.some(f=>!f))return;const d=c.map(f=>f.hits.hits);return Object.assign(Object.assign({},o),{hits:Object.assign(Object.assign({},o.hits),{hits:o.hits.hits.concat(...d)})})})}(n,i,t)),o)return function(n,e="",t="",i,r=!1){const o={},a=(0,En.get)(n,"hits.hits",[]).map(c=>(0,En.get)(c,"_source",{})).map(c=>new zIe(c,e,t,i).toJsonLd());for(const c of a){const d=c["@id"];o[d]?o[d].samples.push(c.samples[0]):o[d]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":A7},c)))),{"@context":A7,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function SC(n,e,t){var i;const r=new Map,s=new Set;n.some(l=>{var c;return e.has(l.subject.id)&&(s.add(l.object.id),r.has(l.object.id)?null===(c=r.get(l.object.id))||void 0===c||c.push(l.subject.id):r.set(l.object.id,[l.subject.id])),!1},null,gi.donor,null,null);const o=t(s),a=new Set;for(const l of o)for(const c of null!==(i=r.get(l))&&void 0!==i?i:[])a.add(c);return a}function pv(n,e){return t=>n.has(t.id)?e.add(t.id):void 0}const cRe={[lr.ontologyNode.label.id]:"label",[lr.ontologyNode.parent.id]:"parent",[lr.ontologyNode.synonymLabels.id]:"synonymLabels"};function uRe(n,e){const t=Qn.DataFactory.namedNode(e),i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""};return n.some(r=>{const s=cRe[r.predicate.id];if(s){const o="Literal"===r.object.termType?(0,$a.fromRdf)(r.object):r.object.id;"synonymLabels"===s?i.synonymLabels.push(o):(0,En.set)(i,s,o)}return!1},t,null,null,null),i.children=n.getSubjects(lr.ontologyNode.children,t,null).map(r=>r.id),i}const xC={[gi.label.id]:"label",[gi.description.id]:"description",[gi.link.id]:"link"},hRe=Object.assign(Object.assign({},xC),{[gi.providerName.id]:"providerName"}),fRe=Object.assign(Object.assign({},xC),{[gi.technology.id]:"technology",[gi.thumbnail.id]:"thumbnail"}),pRe=Object.assign(Object.assign({},xC),{[gi.sampleType.id]:"sampleType",[gi.sectionNumber.id]:"sectionNumber",[gi.datasets.id]:"datasets"}),gRe=Object.assign(Object.assign({},xC),{[gi.sampleType.id]:"sampleType",[gi.sectionCount.id]:"sectionCount",[gi.sectionSize.id]:"sectionSize",[gi.sectionUnits.id]:"sectionUnits",[gi.donor.id]:"donor",[gi.spatialEntity.id]:"spatialEntityId",[gi.sections.id]:"sections",[gi.datasets.id]:"datasets"}),_Re=(0,En.memoize)(function(n,e){const t={"@id":e,"@type":"Donor"};return n.some(i=>{const r=hRe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,$a.fromRdf)(i.object):i.object.id;(0,En.set)(t,r,s)}return!1},Qn.DataFactory.namedNode(e),null,null,null),t},(n,e)=>e);function M7(n,e){const t={"@id":e,"@type":"Dataset"};return n.some(i=>{const r=fRe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,$a.fromRdf)(i.object):i.object.id;(0,En.set)(t,r,s)}return!1},Qn.DataFactory.namedNode(e),null,null,null),t}const bRe=(0,En.memoize)(function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};return n.some(i=>{const r=gRe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,$a.fromRdf)(i.object):i.object.id;if("sections"===r){const o=function(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};return n.some(i=>{const r=pRe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,$a.fromRdf)(i.object):i.object.id;if("datasets"===r){const o=M7(n,s);t[r].push(o)}else(0,En.set)(t,r,s)}return!1},Qn.DataFactory.namedNode(e),null,null,null),t}(n,s);t[r].push(o)}else if("datasets"===r){const o=M7(n,s);t[r].push(o)}else"donor"===r?t[r]=_Re(n,s):(0,En.set)(t,r,s)}return!1},Qn.DataFactory.namedNode(e),null,null,null),t},(n,e)=>e),wRe={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class ERe{constructor(e=wRe){this.options=e,this.store=new Qn.Store(void 0,{factory:Qn.DataFactory}),this.graph=new S7(this),this.scene=new x7(this)}connect(e,t=!1){return Yi(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return Yi(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield v7(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=hc()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),ru(t.transaction)))}([i,t]).catch(()=>{}):s=yield v7(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=hc()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),ru(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return Yi(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,Qn.deserializeN3Store)(o,Qn.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(D7(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return Yi(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>Yi(this,void 0,void 0,function*(){"string"==typeof r?r.endsWith("jsonld")?yield(0,Qn.addJsonLdToStore)(r,i):r.endsWith("n3")?yield(0,Qn.addN3ToStore)(r,i):r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml")?yield(0,Qn.addRdfXmlToStore)(r,i):yield(0,Qn.addJsonLdToStore)(r,i):yield(0,Qn.addJsonLdToStore)(r,i)}))),this})}synchronize(){return Yi(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),this})}serialize(){return(0,Qn.serializeN3Store)(this.store)}deserialize(e){return Yi(this,void 0,void 0,function*(){this.store=(0,Qn.deserializeN3Store)(e,Qn.DataFactory),this.graph=new S7(this),this.scene=new x7(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e){var t,i,r,s,o;let a=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),gi.spatialEntity,null,null),e}(n);if(a.size>0&&(a=function(n,e,t=!0){const i=new Set;if(n.forSubjects(pv(e,i),gi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,a)),a.size>0&&("Male"===e.sex||"Female"===e.sex)){const l=e.sex;a=SC(n,a,c=>function(n,e,t){const i=new Set;return n.forSubjects(pv(e,i),gi.sex,gi[t],null),i}(n,c,l))}if(a.size>0&&(null===(t=e.tmc)||void 0===t?void 0:t.length)>0&&(a=SC(n,a,l=>function(n,e,t){const i=new Set;for(const r of t){const s=Qn.DataFactory.literal(r);n.forSubjects(pv(e,i),gi.providerName,s,null)}return i}(n,l,e.tmc))),a.size>0&&(null===(i=e.technologies)||void 0===i?void 0:i.length)>0&&(a=function(n,e,t){var i;const r=new Map,s=new Set,o=new Set;n.some(c=>(e.has(c.subject.id)&&o.add(c.object.id),!1),null,gi.sections,null,null),n.some(c=>{var d;return(e.has(c.subject.id)||o.has(c.subject.id))&&(s.add(c.object.id),r.has(c.object.id)?null===(d=r.get(c.object.id))||void 0===d||d.push(c.subject.id):r.set(c.object.id,[c.subject.id])),!1},null,gi.datasets,null,null);const a=t(s),l=new Set;for(const c of a)for(const d of null!==(i=r.get(c))&&void 0!==i?i:[])l.add(d);return l}(n,a,l=>function(n,e,t){const i=new Set;for(const r of t){const s=Qn.DataFactory.literal(r);n.forSubjects(pv(e,i),gi.technology,s,null)}return i}(n,l,e.technologies))),a.size>0&&(null===(r=e.ontologyTerms)||void 0===r?void 0:r.length)>0&&(a=function(n,e,t){var i;const r=new Map,s=new Set;n.some(l=>{var c;return e.has(l.subject.id)&&(s.add(l.object.id),r.has(l.object.id)?null===(c=r.get(l.object.id))||void 0===c||c.push(l.subject.id):r.set(l.object.id,[l.subject.id])),!1},null,gi.spatialEntity,null,null);const o=t(s),a=new Set;for(const l of o)for(const c of null!==(i=r.get(l))&&void 0!==i?i:[])a.add(c);return a}(n,a,l=>function(n,e,t){const i=new Set;for(const r of t){const s=Qn.DataFactory.namedNode(r);n.forSubjects(pv(e,i),lr.spatialEntity.ccf_annotations,s,null)}return i}(n,l,e.ontologyTerms))),a.size>0&&2===(null===(s=e.ageRange)||void 0===s?void 0:s.length)&&(0,En.isFinite)(e.ageRange[0])&&(0,En.isFinite)(e.ageRange[1])){const l=Math.max(...e.ageRange),c=Math.min(...e.ageRange);1===c&&110===l||(a=SC(n,a,d=>function(n,e,t,i){const r=new Set;return n.some(s=>{if(e.has(s.subject.id)){const o=(0,$a.fromRdf)(s.object);o>=t&&o<=i&&r.add(s.subject.id)}return!1},null,gi.age,null,null),r}(n,d,c,l)))}if(a.size>0&&2===(null===(o=e.bmiRange)||void 0===o?void 0:o.length)&&(0,En.isFinite)(e.bmiRange[0])&&(0,En.isFinite)(e.bmiRange[1])){const l=Math.max(...e.bmiRange),c=Math.min(...e.bmiRange);13===c&&83===l||(a=SC(n,a,d=>function(n,e,t,i){const r=new Set;return n.some(s=>{if(e.has(s.subject.id)){const o=(0,$a.fromRdf)(s.object);o>=t&&o<=i&&r.add(s.subject.id)}return!1},null,gi.bmi,null,null),r}(n,d,c,l)))}return a}(this.store,e)}get(e){return this.store.getQuads(Qn.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>FIe(this.store,t))}getDatasetTechnologyNames(){return Yi(this,void 0,void 0,function*(){return function(n){const e=new Set;return n.some(t=>(e.add(t.object.value),!1),null,gi.technology,null,null),Array.from(e).sort()}(this.store)})}getProviderNames(){return Yi(this,void 0,void 0,function*(){return function(n){const e=new Set;return n.some(t=>(e.add(t.object.value),!1),null,gi.providerName,null,null),Array.from(e).sort()}(this.store)})}getTissueBlockResults(e){return Yi(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>bRe(this.store,t))})}getAggregateResults(e){return Yi(this,void 0,void 0,function*(){return function(n,e){const t=new Set;e.some(l=>(n.has(l.subject.id)&&t.add(l.object.id),!1),null,gi.donor,null,null);const i=new Set;e.some(l=>(t.has(l.subject.id)&&i.add(l.object.id),!1),null,gi.providerUUID,null,null);const r=new Set;e.forSubjects(l=>{n.has(l.id)&&r.add(l.id)},gi.spatialEntity,null,null);const s=new Set;e.some(l=>(r.has(l.subject.id)&&s.add(l.object.id),!1),null,gi.sections,null,null);const o=new Set;return e.some(l=>{const c=l.subject;return(r.has(c.id)||s.has(c.id))&&o.add(l.object.id),!1},null,gi.datasets,null,null),Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return Yi(this,void 0,void 0,function*(){return function(n,e){const t=new Map;e.some(r=>(n.has(r.subject.id)&&(t.has(r.object.id)?t.get(r.object.id).push(r.subject.id):t.set(r.object.id,[r.subject.id])),!1),null,gi.spatialEntity,null,null);const i={};return e.some(r=>{var s,o;if(t.has(r.subject.id)){const a=null!==(o=null===(s=t.get(r.subject.id))||void 0===s?void 0:s.length)&&void 0!==o?o:0;i[r.object.id]=a+(i[r.object.id]||0)}return!1},null,lr.spatialEntity.ccf_annotations,null,null),i}(this.getIds(e),this.store)})}getOntologyTreeModel(){return Yi(this,void 0,void 0,function*(){return function(n){const e={root:w7.body.id,nodes:{}},t=new Set;n.some(i=>(t.add(i.subject.id),t.add(i.predicate.id),!1),null,lr.ontologyNode.parent,null,null);for(const i of t)e.nodes[i]=uRe(n,i);return e}(this.store)})}getReferenceOrgans(){return Yi(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return Yi(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return Yi(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}}function xRe(n,e){return n===e}let CRe=(()=>{class n{constructor(t,i){this.locator=t,this.globalConfig=i,this.subscriptions=new S,this.dataSource=i.getOption("data").pipe(me(r=>Object.assign(Object.assign({},y7),{dataSources:r})),Ui(r=>Object.keys(r).length>0),me(r=>r),$u(xRe),Ur(r=>function(n,e){return new F(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?Pe(r):Lc).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDataSource(),s=>this.connectDataSource(s.source,r))),ka(1)),this.subscriptions.add(this.dataSource.subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}getTissueBlockResults(t){return this.dataSource.pipe(Ur(i=>i.getTissueBlockResults(t)),Xi(1))}getAggregateResults(t){return this.dataSource.pipe(Ur(i=>i.getAggregateResults(t)),Xi(1))}getOntologyTermOccurences(t){return this.dataSource.pipe(Ur(i=>i.getOntologyTermOccurences(t)),Xi(1))}getOntologyTreeModel(){return this.dataSource.pipe(Ur(t=>t.getOntologyTreeModel()),Xi(1))}getReferenceOrgans(){return this.dataSource.pipe(Ur(t=>t.getReferenceOrgans()),Xi(1))}getScene(t){return this.dataSource.pipe(Ur(i=>i.getScene(t)),Xi(1))}getOrganScene(t,i){return this.dataSource.pipe(Ur(r=>r.getReferenceOrganScene(t,i)),Xi(1))}createDataSource(){return{source:new ERe,unsubscribe:()=>{}}}connectDataSource(t,i){return Yi(this,void 0,void 0,function*(){const r=(new Date).getTime();return yield t.connect(i,!1),Uy.production||(console.info(`Loaded CCF database in ${((new Date).getTime()-r)/1e3}s`),console.log(t)),t})}}return n.\u0275fac=function(t){return new(t||n)(Ie(cf),Ie(hv))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ARe=(()=>{class n{constructor(t,i){this.configState=t,this.source=i,this.data$=this.configState.getOption("data"),this.zoomToID$=this.configState.getOption("zoomToID").pipe(me(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.highlightID$=this.configState.getOption("highlightID").pipe(me(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.referenceOrgans$=this.source.getReferenceOrgans(),this.scene$=Uo([this.data$,this.referenceOrgans$,this.source.dataSource]).pipe(Ur(([r,s,o])=>this.chooseScene(r,s))),this.organs$=this.configState.getOption("data").pipe(me(r=>this.selectOrgans(r)),ka(1)),this.filteredOrgans$=Uo([this.organs$,this.referenceOrgans$]).pipe(me(([r,s])=>this.getNeededReferenceOrgans(s,r)),ka(1)),this.filteredScene$=Uo([this.scene$,this.organs$,this.referenceOrgans$]).pipe(me(([r,s,o])=>this.filterSceneNodes(r,s,o)),function(n,e){const t=n.pipe(Vo(""));return i=>Uo([i,t]).pipe(me(([r,s])=>r.map(o=>function(n,e,t){return n.entityId!==e?n:Object.assign(Object.assign({},n),{color:t})}(o,s,e))))}(this.highlightID$,yMe),function(n){const e=n.pipe(Vo(""));return t=>Uo([t,e]).pipe(me(([i,r])=>i.map(s=>function(n,e){return n.entityId!==e?n:Object.assign(Object.assign({},n),{zoomToOnLoad:!0})}(s,r))))}(this.zoomToID$),ka(1))}chooseScene(t,i){var r;const s=null!==(r=null==t?void 0:t.map(a=>{const l=a[f7];return null==l?void 0:l.placement.target}))&&void 0!==r?r:[];if(new Set(s).size>1)return this.source.getScene();if(i){const a=i.find(l=>l["@id"]===s[0]);if(a)return this.source.getOrganScene(a.representation_of,{ontologyTerms:[a.reference_organ],sex:a.sex})}return an([])}selectOrgans(t){const r=(null!=t?t:[]).map(s=>s[f7].placement.target);return new Set(r)}filterSceneNodes(t,i,r){const s=this.getNeededReferenceOrgans(r,i),o=this.getNeededSkins(s),a=new Set([...i,...o]);return t.filter(c=>!c.reference_organ||a.has(c.reference_organ))}getNeededReferenceOrgans(t,i){return t.filter(r=>{var s;return i.has(null!==(s=r.reference_organ)&&void 0!==s?s:"")})}getNeededSkins(t){if(1===t.length)return[];const i=new Set;return t.forEach(r=>{"Female"===r.sex?i.add("http://purl.org/ccf/latest/ccf.owl#VHFSkin"):"Male"===r.sex&&i.add("http://purl.org/ccf/latest/ccf.owl#VHMSkin")}),[...i]}}return n.\u0275fac=function(t){return new(t||n)(Ie(hv),Ie(CRe))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const TRe=["bodyUI"];let DRe=(()=>{class n{constructor(t,i,r){this.configState=t,this.sceneSource=i,this.cdr=r,this.onMouseEnter=new cn,this.onMouseLeave=new cn,this.onClick=new cn,this.data$=this.configState.getOption("data"),this.organs$=this.sceneSource.filteredOrgans$,this.scene$=this.sceneSource.filteredScene$.pipe(Zr(s=>this.reset()))}reset(){var t,i;return Yi(this,void 0,void 0,function*(){const{bodyUI:r}=this;yield new Promise(a=>setTimeout(a,200));const s=yield this.organs$.pipe(Xi(1)).toPromise(),o=null!==(i=!!(null===(t=r.scene)||void 0===t?void 0:t.find(a=>a.zoomToOnLoad)))&&void 0!==i&&i;if(r.rotation=0,r.rotationX=0,!o)if(1===s.length){const{x_dimension:a,y_dimension:l,z_dimension:c}=s[0];r.bounds={x:1.25*a/1e3,y:1.25*l/1e3,z:1.25*c/1e3},r.target=[a/1e3/2,l/1e3/2,c/1e3/2]}else r.bounds={x:2.2,y:2,z:.4},r.target=[0,0,0];this.cdr.detectChanges()})}}return n.\u0275fac=function(t){return new(t||n)(De(hv),De(ARe),De(is))},n.\u0275cmp=wn({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&Ds(TRe,7),2&t){let r;Ai(r=Ti())&&(i.bodyUI=r.first)}},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},decls:3,vars:4,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick","nodeHoverStart","nodeHoverStop"],["bodyUI",""]],template:function(t,i){1&t&&(Kt(0,"ccf-body-ui",0,1),ui("nodeClick",function(s){return i.onClick.emit(s)})("nodeHoverStart",function(s){return i.onMouseEnter.emit(s)})("nodeHoverStop",function(s){return i.onMouseLeave.emit(s)}),function(n,e){const t=fi();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Qe("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=mc(i.type)),o=ha(De);try{const a=rp(!1),l=s();rp(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,Ft(),r,l)}finally{ha(o)}}(2,"async"),Yt()),2&t&&vn("scene",Ty(2,2,i.scene$))("interactive",!0)},directives:[kDe],pipes:[cE],styles:[".body-ui[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),n})();function MRe(n,e){if(1&n){const t=Ft();Kt(0,"ccf-root",1),ui("onMouseEnter",function(r){return ya(t),cr().onMouseEnter.emit(r)})("onMouseLeave",function(r){return ya(t),cr().onMouseLeave.emit(r)})("onClick",function(r){return ya(t),cr().onClick.emit(r)}),Yt()}}function IRe(n){return n.map(e=>({"@id":`http://purl.org/ccf/1.5/entity/${e.id}`,"@type":"http://purl.org/ccf/latest/ccf-entity.owl#Sample","http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity":e.rui_location}))}let RRe=(()=>{class n extends vee{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:Object.assign(Object.assign({},Uy.dbOptions),globalThis.dbOptions),parse:{data:IRe}}),this.onMouseEnter=new cn,this.onMouseLeave=new cn,this.onClick=new cn}}return n.\u0275fac=function(t){return new(t||n)(De(hv),De(is))},n.\u0275cmp=wn({type:n,selectors:[["ccf-root-wc"]],inputs:{data:"data",highlightID:"highlightID",zoomToID:"zoomToID"},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},features:[Nn],decls:1,vars:1,consts:[[3,"onMouseEnter","onMouseLeave","onClick",4,"ngIf"],[3,"onMouseEnter","onMouseLeave","onClick"]],template:function(t,i){1&t&&function(n,e,t,i,r,s,o,a){const l=Ft(),c=fi(),d=n+20,f=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,d=Pd(e,n,4,o||null,_a(c,a));z_(e,t,d,_a(c,l)),ep(e,d);const f=d.tViews=Fp(2,d,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,i,r,s,o):c.data[d];Qa(f,!1);const p=l[11].createComment("");Dp(c,l,p,f),xs(p,l),Lp(l,l[d]=iw(p,l,p,f)),cd(f)&&Kh(c,l,f),null!=o&&U_(l,f,a)}(0,MRe,1,0,"ccf-root",0),2&t&&vn("ngIf",i.initialized)},directives:[Ru,DRe],encapsulation:2,changeDetection:0}),n})(),ORe=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[ls,Ga,$G,...t]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(ls,2),Ie(Ga,2))},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({}),n})();const CC=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class FRe{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=Df(this.action),i=function(n){return CC(n.getHours(),2)+":"+CC(n.getMinutes(),2)+":"+CC(n.getSeconds(),2)+"."+CC(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",Object.assign({},this.action)),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class LRe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch(i){console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch(e){this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,t,i)}isIE(){const e="undefined"!=typeof window&&window.navigator.userAgent?window.navigator.userAgent:"";let t=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(t=!0),t}}const I7=new Vt("NGXS_LOGGER_PLUGIN_OPTIONS");let kRe=(()=>{class n{constructor(t,i){this._options=t,this._injector=i}handle(t,i,r){if(this._options.disabled||!this._options.filter(i,t))return r(t,i);this._logWriter=this._logWriter||new LRe(this._options),this._store=this._store||this._injector.get(ih);const s=new FRe(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(Zr(o=>{s.completed(o)}),lc(o=>{throw s.errored(o),o}))}}return n.\u0275fac=function(t){return new(t||n)(Ie(I7),Ie(Hn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const R7=new Vt("LOGGER_USER_OPTIONS");function BRe(n){return Object.assign({},{logger:console,collapsed:!1,disabled:!1,filter:()=>!0},n)}let jRe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:e8,useClass:kRe,multi:!0},{provide:R7,useValue:t},{provide:I7,useFactory:BRe,deps:[R7]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({}),n})();const VRe=[hv];let URe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({imports:[[ORe.forRoot(),la.forRoot(VRe,{developmentMode:!Uy.production}),jRe.forRoot({disabled:Uy.production})]]}),n})(),zRe=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(fl).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new fee(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends gee{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,d){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(RRe,{injector:this.injector});customElements.define("ccf-body-ui-wc",t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Hn))},n.\u0275mod=gn({type:n}),n.\u0275inj=Et({providers:[],imports:[[XD,URe,BDe]]}),n})();Uy.production&&function(){if(Tk)throw new Error("Cannot enable prod mode after platform setup.");Ak=!1}(),LJ().bootstrapModule(zRe).catch(n=>console.error(n))},52:kt=>{function it(gt,J,At,dt,K,Ae,he){try{var q=gt[Ae](he),V=q.value}catch(L){return void At(L)}q.done?J(V):Promise.resolve(V).then(dt,K)}kt.exports=function(gt){return function(){var J=this,At=arguments;return new Promise(function(dt,K){var Ae=gt.apply(J,At);function he(V){it(Ae,dt,K,he,q,"next",V)}function q(V){it(Ae,dt,K,he,q,"throw",V)}he(void 0)})}},kt.exports.default=kt.exports,kt.exports.__esModule=!0},948:kt=>{kt.exports=function(tt){return tt&&tt.__esModule?tt:{default:tt}},kt.exports.default=kt.exports,kt.exports.__esModule=!0},321:kt=>{function it(tt){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(kt.exports=it=function(J){return typeof J},kt.exports.default=kt.exports,kt.exports.__esModule=!0):(kt.exports=it=function(J){return J&&"function"==typeof Symbol&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},kt.exports.default=kt.exports,kt.exports.__esModule=!0),it(tt)}kt.exports=it,kt.exports.default=kt.exports,kt.exports.__esModule=!0},380:kt=>{function it(tt){return Promise.resolve().then(()=>{var gt=new Error("Cannot find module '"+tt+"'");throw gt.code="MODULE_NOT_FOUND",gt})}it.keys=()=>[],it.resolve=it,it.id=380,kt.exports=it},521:()=>{},125:()=>{},307:()=>{}},kt=>{kt(kt.s=18)}]);