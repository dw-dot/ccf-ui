var kFe=Object.defineProperty,BFe=Object.defineProperties,jFe=Object.getOwnPropertyDescriptors,mC=Object.getOwnPropertySymbols,Z9=Object.prototype.hasOwnProperty,J9=Object.prototype.propertyIsEnumerable,br=Math.pow,eq=(Bt,it,Je)=>it in Bt?kFe(Bt,it,{enumerable:!0,configurable:!0,writable:!0,value:Je}):Bt[it]=Je,ot=(Bt,it)=>{for(var Je in it||(it={}))Z9.call(it,Je)&&eq(Bt,Je,it[Je]);if(mC)for(var Je of mC(it))J9.call(it,Je)&&eq(Bt,Je,it[Je]);return Bt},wn=(Bt,it)=>BFe(Bt,jFe(it)),tq=(Bt,it)=>{var Je={};for(var yt in Bt)Z9.call(Bt,yt)&&it.indexOf(yt)<0&&(Je[yt]=Bt[yt]);if(null!=Bt&&mC)for(var yt of mC(Bt))it.indexOf(yt)<0&&J9.call(Bt,yt)&&(Je[yt]=Bt[yt]);return Je};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:(Bt,it,Je)=>{var yt=Je(52).default;Bt.exports=function Y(Se,he,W){function j(z,v){if(!he[z]){if(!Se[z]){if(P)return P(z,!0);var O=new Error("Cannot find module '"+z+"'");throw O.code="MODULE_NOT_FOUND",O}var A=he[z]={exports:{}};Se[z][0].call(A.exports,function(b){return j(Se[z][1][b]||b)},A,A.exports,Y,Se,he,W)}return he[z].exports}for(var P=void 0,Q=0;Q<W.length;Q++)j(W[Q]);return j}({1:[function(Y,Se,he){var W,j;W=this,j=function(W,j,P,Q,z){"use strict";function T(Te,Ve,$e,Ne){return new($e||($e=Promise))(function(G,pe){function ue(pt){try{_t(Ne.next(pt))}catch(ve){pe(ve)}}function je(pt){try{_t(Ne.throw(pt))}catch(ve){pe(ve)}}function _t(pt){pt.done?G(pt.value):function(G){return G instanceof $e?G:new $e(function(pe){pe(G)})}(pt.value).then(ue,je)}_t((Ne=Ne.apply(Te,Ve||[])).next())})}function V(Te,Ve){var Ne,q,G,pe,$e={label:0,sent:function(){if(1&G[0])throw G[1];return G[1]},trys:[],ops:[]};return pe={next:ue(0),throw:ue(1),return:ue(2)},"function"==typeof Symbol&&(pe[Symbol.iterator]=function(){return this}),pe;function ue(_t){return function(pt){return function(_t){if(Ne)throw new TypeError("Generator is already executing.");for(;$e;)try{if(Ne=1,q&&(G=2&_t[0]?q.return:_t[0]?q.throw||((G=q.return)&&G.call(q),0):q.next)&&!(G=G.call(q,_t[1])).done)return G;switch(q=0,G&&(_t=[2&_t[0],G.value]),_t[0]){case 0:case 1:G=_t;break;case 4:return $e.label++,{value:_t[1],done:!1};case 5:$e.label++,q=_t[1],_t=[0];continue;case 7:_t=$e.ops.pop(),$e.trys.pop();continue;default:if(!(G=(G=$e.trys).length>0&&G[G.length-1])&&(6===_t[0]||2===_t[0])){$e=0;continue}if(3===_t[0]&&(!G||_t[1]>G[0]&&_t[1]<G[3])){$e.label=_t[1];break}if(6===_t[0]&&$e.label<G[1]){$e.label=G[1],G=_t;break}if(G&&$e.label<G[2]){$e.label=G[2],$e.ops.push(_t);break}G[2]&&$e.ops.pop(),$e.trys.pop();continue}_t=Ve.call(Te,$e)}catch(pt){_t=[6,pt],q=0}finally{Ne=G=0}if(5&_t[0])throw _t[1];return{value:_t[0]?_t[1]:void 0,done:!0}}([_t,pt])}}}function Xe(Te){var Ve=Te.length,$e=0;return new z.Readable({objectMode:!0,read:function(){this.push($e<Ve?Te[$e++]:null)}})}W.addJsonLdToStore=function(Te,Ve){return T(this,void 0,void 0,function(){var $e,Ne,q;return V(this,function(G){switch(G.label){case 0:return"string"!=typeof Te?[3,4]:[4,fetch(Te,{redirect:"follow"})];case 1:return(Ne=G.sent()).ok?[4,Ne.json()]:[3,3];case 2:$e=G.sent(),G.label=3;case 3:return[3,5];case 4:$e=Te,G.label=5;case 5:return $e?[4,j.toRDF($e)]:[3,7];case 6:q=G.sent(),Ve.import(Xe(q)),G.label=7;case 7:return[2,Ve]}})})},W.addN3ToStore=function(Te,Ve){return T(this,void 0,void 0,function(){var $e,Ne,q;return V(this,function(G){switch(G.label){case 0:return"string"==typeof Te&&(null==Te?void 0:Te.startsWith("http"))?[4,fetch(Te,{redirect:"follow"})]:[3,4];case 1:return(Ne=G.sent()).ok?[4,Ne.text()]:[3,3];case 2:$e=G.sent(),G.label=3;case 3:return[3,5];case 4:$e=Te,G.label=5;case 5:return $e&&(q=new P.Parser({format:"n3"}).parse($e),Ve.import(Xe(q))),[2,Ve]}})})},W.addRdfXmlToStore=function(Te,Ve){return T(this,void 0,void 0,function(){var $e,Ne,q,G;return V(this,function(pe){switch(pe.label){case 0:return"string"==typeof Te&&(null==Te?void 0:Te.startsWith("http"))?[4,fetch(Te,{redirect:"follow"})]:[3,4];case 1:return(Ne=pe.sent()).ok?[4,Ne.text()]:[3,3];case 2:$e=pe.sent(),pe.label=3;case 3:return[3,5];case 4:$e=Te,pe.label=5;case 5:return $e?(q=new Q.RdfXmlParser({dataFactory:P.DataFactory,strict:!0}),G=new Promise(function(ue){q.once("end",function(){return ue(Ve)})}),Ve.import(q),q.write($e),q.end(),[2,G]):[2,Ve]}})})},W.arrayToStream=Xe,W.deserializeN3Store=function(Te,Ve){var $e=JSON.parse(Te),Ne=new P.Store;return Object.assign(Ne,$e,{_factory:null!=Ve?Ve:P.DataFactory}),Ne},W.readQuads=function(Te,Ve,$e,Ne,q){return Te.readQuads(Ve,$e,Ne,q)},W.serializeN3Store=function(Te){var Ve=Object.assign({},Te);return delete Ve._factory,JSON.stringify(Ve)},W.streamToArray=function(Te){return new Promise(function(Ve,$e){var Ne=[];Te.on("data",function(q){Ne.push(q)}).once("end",function(){Ve(Ne)}).once("error",function(q){$e(q)})})},Object.keys(P).forEach(function(Te){"default"!==Te&&!W.hasOwnProperty(Te)&&Object.defineProperty(W,Te,{enumerable:!0,get:function(){return P[Te]}})}),Object.defineProperty(W,"__esModule",{value:!0})},"object"==typeof he&&void 0!==Se?j(he,Y("jsonld"),Y("n3"),Y("rdfxml-streaming-parser"),Y("readable-stream")):j((W="undefined"!=typeof globalThis?globalThis:W||self).tripleStoreUtils={},W.jsonld,W.n3,W.rdfxmlStreamingParser,W.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(Y,Se,he){"use strict";he.byteLength=function(V){var R=x(V),ce=R[1];return 3*(R[0]+ce)/4-ce},he.toByteArray=function(V){var R,$,K=x(V),ce=K[0],D=K[1],I=new P(function(V,R,K){return 3*(R+K)/4-K}(0,ce,D)),X=0,E=D>0?ce-4:ce;for($=0;$<E;$+=4)R=j[V.charCodeAt($)]<<18|j[V.charCodeAt($+1)]<<12|j[V.charCodeAt($+2)]<<6|j[V.charCodeAt($+3)],I[X++]=R>>16&255,I[X++]=R>>8&255,I[X++]=255&R;return 2===D&&(R=j[V.charCodeAt($)]<<2|j[V.charCodeAt($+1)]>>4,I[X++]=255&R),1===D&&(R=j[V.charCodeAt($)]<<10|j[V.charCodeAt($+1)]<<4|j[V.charCodeAt($+2)]>>2,I[X++]=R>>8&255,I[X++]=255&R),I},he.fromByteArray=function(V){for(var R,K=V.length,ce=K%3,D=[],I=16383,X=0,E=K-ce;X<E;X+=I)D.push(S(V,X,X+I>E?E:X+I));return 1===ce?D.push(W[(R=V[K-1])>>2]+W[R<<4&63]+"=="):2===ce&&D.push(W[(R=(V[K-2]<<8)+V[K-1])>>10]+W[R>>4&63]+W[R<<2&63]+"="),D.join("")};for(var W=[],j=[],P="undefined"!=typeof Uint8Array?Uint8Array:Array,Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",z=0,v=Q.length;z<v;++z)W[z]=Q[z],j[Q.charCodeAt(z)]=z;function x(V){var R=V.length;if(R%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var K=V.indexOf("=");return-1===K&&(K=R),[K,K===R?0:4-K%4]}function y(V){return W[V>>18&63]+W[V>>12&63]+W[V>>6&63]+W[63&V]}function S(V,R,K){for(var D=[],I=R;I<K;I+=3)D.push(y((V[I]<<16&16711680)+(V[I+1]<<8&65280)+(255&V[I+2])));return D.join("")}j["-".charCodeAt(0)]=62,j["_".charCodeAt(0)]=63},{}],3:[function(Y,Se,he){},{}],4:[function(Y,Se,he){var W=Y("buffer"),j=W.Buffer;function P(z,v){for(var x in z)v[x]=z[x]}function Q(z,v,x){return j(z,v,x)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Se.exports=W:(P(W,he),he.Buffer=Q),P(j,Q),Q.from=function(z,v,x){if("number"==typeof z)throw new TypeError("Argument must not be a number");return j(z,v,x)},Q.alloc=function(z,v,x){if("number"!=typeof z)throw new TypeError("Argument must be a number");var O=j(z);return void 0!==v?"string"==typeof x?O.fill(v,x):O.fill(v):O.fill(0),O},Q.allocUnsafe=function(z){if("number"!=typeof z)throw new TypeError("Argument must be a number");return j(z)},Q.allocUnsafeSlow=function(z){if("number"!=typeof z)throw new TypeError("Argument must be a number");return W.SlowBuffer(z)}},{buffer:6}],5:[function(Y,Se,he){"use strict";var W=Y("safe-buffer").Buffer,j=W.isEncoding||function(D){switch((D=""+D)&&D.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function z(D){var I;switch(this.encoding=function(D){var I=function(D){if(!D)return"utf8";for(var I;;)switch(D){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return D;default:if(I)return;D=(""+D).toLowerCase(),I=!0}}(D);if("string"!=typeof I&&(W.isEncoding===j||!j(D)))throw new Error("Unknown encoding: "+D);return I||D}(D),this.encoding){case"utf16le":this.text=S,this.end=T,I=4;break;case"utf8":this.fillLast=A,I=4;break;case"base64":this.text=V,this.end=R,I=3;break;default:return this.write=K,void(this.end=ce)}this.lastNeed=0,this.lastTotal=0,this.lastChar=W.allocUnsafe(I)}function v(D){return D<=127?0:D>>5==6?2:D>>4==14?3:D>>3==30?4:D>>6==2?-1:-2}function A(D){var I=this.lastTotal-this.lastNeed,X=function(D,I,X){if(128!=(192&I[0]))return D.lastNeed=0,"\ufffd";if(D.lastNeed>1&&I.length>1){if(128!=(192&I[1]))return D.lastNeed=1,"\ufffd";if(D.lastNeed>2&&I.length>2&&128!=(192&I[2]))return D.lastNeed=2,"\ufffd"}}(this,D);return void 0!==X?X:this.lastNeed<=D.length?(D.copy(this.lastChar,I,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(D.copy(this.lastChar,I,0,D.length),void(this.lastNeed-=D.length))}function S(D,I){if((D.length-I)%2==0){var X=D.toString("utf16le",I);if(X){var E=X.charCodeAt(X.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1],X.slice(0,-1)}return X}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=D[D.length-1],D.toString("utf16le",I,D.length-1)}function T(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):I}function V(D,I){var X=(D.length-I)%3;return 0===X?D.toString("base64",I):(this.lastNeed=3-X,this.lastTotal=3,1===X?this.lastChar[0]=D[D.length-1]:(this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1]),D.toString("base64",I,D.length-X))}function R(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+this.lastChar.toString("base64",0,3-this.lastNeed):I}function K(D){return D.toString(this.encoding)}function ce(D){return D&&D.length?this.write(D):""}he.StringDecoder=z,z.prototype.write=function(D){if(0===D.length)return"";var I,X;if(this.lastNeed){if(void 0===(I=this.fillLast(D)))return"";X=this.lastNeed,this.lastNeed=0}else X=0;return X<D.length?I?I+this.text(D,X):this.text(D,X):I||""},z.prototype.end=function(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+"\ufffd":I},z.prototype.text=function(D,I){var X=function(D,I,X){var E=I.length-1;if(E<X)return 0;var $=v(I[E]);return $>=0?($>0&&(D.lastNeed=$-1),$):--E<X||-2===$?0:($=v(I[E]))>=0?($>0&&(D.lastNeed=$-2),$):--E<X||-2===$?0:($=v(I[E]))>=0?($>0&&(2===$?$=0:D.lastNeed=$-3),$):0}(this,D,I);if(!this.lastNeed)return D.toString("utf8",I);this.lastTotal=X;var E=D.length-(X-this.lastNeed);return D.copy(this.lastChar,0,E),D.toString("utf8",I,E)},z.prototype.fillLast=function(D){if(this.lastNeed<=D.length)return D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,D.length),this.lastNeed-=D.length}},{"safe-buffer":4}],6:[function(Y,Se,he){(function(W){(function(){"use strict";var j=Y("base64-js"),P=Y("ieee754");he.Buffer=x,he.SlowBuffer=function(k){return+k!=k&&(k=0),x.alloc(+k)},he.INSPECT_MAX_BYTES=50;var Q=2147483647;function v(k){if(k>Q)throw new RangeError('The value "'+k+'" is invalid for option "size"');var N=new Uint8Array(k);return N.__proto__=x.prototype,N}function x(k,N,B){if("number"==typeof k){if("string"==typeof N)throw new TypeError('The "string" argument must be of type string. Received type number');return y(k)}return O(k,N,B)}function O(k,N,B){if("string"==typeof k)return function(k,N){if(("string"!=typeof N||""===N)&&(N="utf8"),!x.isEncoding(N))throw new TypeError("Unknown encoding: "+N);var B=0|D(k,N),Re=v(B),Qe=Re.write(k,N);return Qe!==B&&(Re=Re.slice(0,Qe)),Re}(k,N);if(ArrayBuffer.isView(k))return T(k);if(null==k)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k);if(pt(k,ArrayBuffer)||k&&pt(k.buffer,ArrayBuffer))return function(k,N,B){if(N<0||k.byteLength<N)throw new RangeError('"offset" is outside of buffer bounds');if(k.byteLength<N+(B||0))throw new RangeError('"length" is outside of buffer bounds');var Re;return(Re=void 0===N&&void 0===B?new Uint8Array(k):void 0===B?new Uint8Array(k,N):new Uint8Array(k,N,B)).__proto__=x.prototype,Re}(k,N,B);if("number"==typeof k)throw new TypeError('The "value" argument must not be of type number. Received type number');var Re=k.valueOf&&k.valueOf();if(null!=Re&&Re!==k)return x.from(Re,N,B);var Qe=function(k){if(x.isBuffer(k)){var N=0|K(k.length),B=v(N);return 0===B.length||k.copy(B,0,0,N),B}return void 0!==k.length?"number"!=typeof k.length||ve(k.length)?v(0):T(k):"Buffer"===k.type&&Array.isArray(k.data)?T(k.data):void 0}(k);if(Qe)return Qe;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof k[Symbol.toPrimitive])return x.from(k[Symbol.toPrimitive]("string"),N,B);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k)}function A(k){if("number"!=typeof k)throw new TypeError('"size" argument must be of type number');if(k<0)throw new RangeError('The value "'+k+'" is invalid for option "size"')}function y(k){return A(k),v(k<0?0:0|K(k))}function T(k){for(var N=k.length<0?0:0|K(k.length),B=v(N),Re=0;Re<N;Re+=1)B[Re]=255&k[Re];return B}function K(k){if(k>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return 0|k}function D(k,N){if(x.isBuffer(k))return k.length;if(ArrayBuffer.isView(k)||pt(k,ArrayBuffer))return k.byteLength;if("string"!=typeof k)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof k);var B=k.length,Re=arguments.length>2&&!0===arguments[2];if(!Re&&0===B)return 0;for(var Qe=!1;;)switch(N){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":return G(k).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*B;case"hex":return B>>>1;case"base64":return je(k).length;default:if(Qe)return Re?-1:G(k).length;N=(""+N).toLowerCase(),Qe=!0}}function I(k,N,B){var Re=!1;if((void 0===N||N<0)&&(N=0),N>this.length||((void 0===B||B>this.length)&&(B=this.length),B<=0)||(B>>>=0)<=(N>>>=0))return"";for(k||(k="utf8");;)switch(k){case"hex":return tt(this,N,B);case"utf8":case"utf-8":return _e(this,N,B);case"ascii":return st(this,N,B);case"latin1":case"binary":return Xe(this,N,B);case"base64":return ne(this,N,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ye(this,N,B);default:if(Re)throw new TypeError("Unknown encoding: "+k);k=(k+"").toLowerCase(),Re=!0}}function X(k,N,B){var Re=k[N];k[N]=k[B],k[B]=Re}function E(k,N,B,Re,Qe){if(0===k.length)return-1;if("string"==typeof B?(Re=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),ve(B=+B)&&(B=Qe?0:k.length-1),B<0&&(B=k.length+B),B>=k.length){if(Qe)return-1;B=k.length-1}else if(B<0){if(!Qe)return-1;B=0}if("string"==typeof N&&(N=x.from(N,Re)),x.isBuffer(N))return 0===N.length?-1:$(k,N,B,Re,Qe);if("number"==typeof N)return N&=255,"function"==typeof Uint8Array.prototype.indexOf?Qe?Uint8Array.prototype.indexOf.call(k,N,B):Uint8Array.prototype.lastIndexOf.call(k,N,B):$(k,[N],B,Re,Qe);throw new TypeError("val must be string, number or Buffer")}function $(k,N,B,Re,Qe){var Wn,St=1,Rt=k.length,In=N.length;if(void 0!==Re&&("ucs2"===(Re=String(Re).toLowerCase())||"ucs-2"===Re||"utf16le"===Re||"utf-16le"===Re)){if(k.length<2||N.length<2)return-1;St=2,Rt/=2,In/=2,B/=2}function Ln(Ns,us){return 1===St?Ns[us]:Ns.readUInt16BE(us*St)}if(Qe){var wi=-1;for(Wn=B;Wn<Rt;Wn++)if(Ln(k,Wn)===Ln(N,-1===wi?0:Wn-wi)){if(-1===wi&&(wi=Wn),Wn-wi+1===In)return wi*St}else-1!==wi&&(Wn-=Wn-wi),wi=-1}else for(B+In>Rt&&(B=Rt-In),Wn=B;Wn>=0;Wn--){for(var gi=!0,Gr=0;Gr<In;Gr++)if(Ln(k,Wn+Gr)!==Ln(N,Gr)){gi=!1;break}if(gi)return Wn}return-1}function Z(k,N,B,Re){B=Number(B)||0;var Qe=k.length-B;Re?(Re=Number(Re))>Qe&&(Re=Qe):Re=Qe;var St=N.length;Re>St/2&&(Re=St/2);for(var Rt=0;Rt<Re;++Rt){var In=parseInt(N.substr(2*Rt,2),16);if(ve(In))return Rt;k[B+Rt]=In}return Rt}function se(k,N,B,Re){return _t(G(N,k.length-B),k,B,Re)}function oe(k,N,B,Re){return _t(function(k){for(var N=[],B=0;B<k.length;++B)N.push(255&k.charCodeAt(B));return N}(N),k,B,Re)}function te(k,N,B,Re){return oe(k,N,B,Re)}function xe(k,N,B,Re){return _t(je(N),k,B,Re)}function ge(k,N,B,Re){return _t(function(k,N){for(var B,Re,St=[],Rt=0;Rt<k.length&&!((N-=2)<0);++Rt)Re=(B=k.charCodeAt(Rt))>>8,St.push(B%256),St.push(Re);return St}(N,k.length-B),k,B,Re)}function ne(k,N,B){return j.fromByteArray(0===N&&B===k.length?k:k.slice(N,B))}function _e(k,N,B){B=Math.min(k.length,B);for(var Re=[],Qe=N;Qe<B;){var Ln,Wn,wi,gi,St=k[Qe],Rt=null,In=St>239?4:St>223?3:St>191?2:1;if(Qe+In<=B)switch(In){case 1:St<128&&(Rt=St);break;case 2:128==(192&(Ln=k[Qe+1]))&&(gi=(31&St)<<6|63&Ln)>127&&(Rt=gi);break;case 3:Wn=k[Qe+2],128==(192&(Ln=k[Qe+1]))&&128==(192&Wn)&&(gi=(15&St)<<12|(63&Ln)<<6|63&Wn)>2047&&(gi<55296||gi>57343)&&(Rt=gi);break;case 4:Wn=k[Qe+2],wi=k[Qe+3],128==(192&(Ln=k[Qe+1]))&&128==(192&Wn)&&128==(192&wi)&&(gi=(15&St)<<18|(63&Ln)<<12|(63&Wn)<<6|63&wi)>65535&&gi<1114112&&(Rt=gi)}null===Rt?(Rt=65533,In=1):Rt>65535&&(Re.push((Rt-=65536)>>>10&1023|55296),Rt=56320|1023&Rt),Re.push(Rt),Qe+=In}return function(k){var N=k.length;if(N<=4096)return String.fromCharCode.apply(String,k);for(var B="",Re=0;Re<N;)B+=String.fromCharCode.apply(String,k.slice(Re,Re+=4096));return B}(Re)}he.kMaxLength=Q,!(x.TYPED_ARRAY_SUPPORT=function(){try{var k=new Uint8Array(1);return k.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===k.foo()}catch(N){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.buffer}}),Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&x[Symbol.species]===x&&Object.defineProperty(x,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),x.poolSize=8192,x.from=function(k,N,B){return O(k,N,B)},x.prototype.__proto__=Uint8Array.prototype,x.__proto__=Uint8Array,x.alloc=function(k,N,B){return function(k,N,B){return A(k),k<=0?v(k):void 0!==N?"string"==typeof B?v(k).fill(N,B):v(k).fill(N):v(k)}(k,N,B)},x.allocUnsafe=function(k){return y(k)},x.allocUnsafeSlow=function(k){return y(k)},x.isBuffer=function(N){return null!=N&&!0===N._isBuffer&&N!==x.prototype},x.compare=function(N,B){if(pt(N,Uint8Array)&&(N=x.from(N,N.offset,N.byteLength)),pt(B,Uint8Array)&&(B=x.from(B,B.offset,B.byteLength)),!x.isBuffer(N)||!x.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===B)return 0;for(var Re=N.length,Qe=B.length,St=0,Rt=Math.min(Re,Qe);St<Rt;++St)if(N[St]!==B[St]){Re=N[St],Qe=B[St];break}return Re<Qe?-1:Qe<Re?1:0},x.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},x.concat=function(N,B){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(0===N.length)return x.alloc(0);var Re;if(void 0===B)for(B=0,Re=0;Re<N.length;++Re)B+=N[Re].length;var Qe=x.allocUnsafe(B),St=0;for(Re=0;Re<N.length;++Re){var Rt=N[Re];if(pt(Rt,Uint8Array)&&(Rt=x.from(Rt)),!x.isBuffer(Rt))throw new TypeError('"list" argument must be an Array of Buffers');Rt.copy(Qe,St),St+=Rt.length}return Qe},x.byteLength=D,x.prototype._isBuffer=!0,x.prototype.swap16=function(){var N=this.length;if(N%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<N;B+=2)X(this,B,B+1);return this},x.prototype.swap32=function(){var N=this.length;if(N%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<N;B+=4)X(this,B,B+3),X(this,B+1,B+2);return this},x.prototype.swap64=function(){var N=this.length;if(N%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<N;B+=8)X(this,B,B+7),X(this,B+1,B+6),X(this,B+2,B+5),X(this,B+3,B+4);return this},x.prototype.toLocaleString=x.prototype.toString=function(){var N=this.length;return 0===N?"":0===arguments.length?_e(this,0,N):I.apply(this,arguments)},x.prototype.equals=function(N){if(!x.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N||0===x.compare(this,N)},x.prototype.inspect=function(){var N="",B=he.INSPECT_MAX_BYTES;return N=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(N+=" ... "),"<Buffer "+N+">"},x.prototype.compare=function(N,B,Re,Qe,St){if(pt(N,Uint8Array)&&(N=x.from(N,N.offset,N.byteLength)),!x.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(void 0===B&&(B=0),void 0===Re&&(Re=N?N.length:0),void 0===Qe&&(Qe=0),void 0===St&&(St=this.length),B<0||Re>N.length||Qe<0||St>this.length)throw new RangeError("out of range index");if(Qe>=St&&B>=Re)return 0;if(Qe>=St)return-1;if(B>=Re)return 1;if(this===N)return 0;for(var Rt=(St>>>=0)-(Qe>>>=0),In=(Re>>>=0)-(B>>>=0),Ln=Math.min(Rt,In),Wn=this.slice(Qe,St),wi=N.slice(B,Re),gi=0;gi<Ln;++gi)if(Wn[gi]!==wi[gi]){Rt=Wn[gi],In=wi[gi];break}return Rt<In?-1:In<Rt?1:0},x.prototype.includes=function(N,B,Re){return-1!==this.indexOf(N,B,Re)},x.prototype.indexOf=function(N,B,Re){return E(this,N,B,Re,!0)},x.prototype.lastIndexOf=function(N,B,Re){return E(this,N,B,Re,!1)},x.prototype.write=function(N,B,Re,Qe){if(void 0===B)Qe="utf8",Re=this.length,B=0;else if(void 0===Re&&"string"==typeof B)Qe=B,Re=this.length,B=0;else{if(!isFinite(B))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");B>>>=0,isFinite(Re)?(Re>>>=0,void 0===Qe&&(Qe="utf8")):(Qe=Re,Re=void 0)}var St=this.length-B;if((void 0===Re||Re>St)&&(Re=St),N.length>0&&(Re<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");Qe||(Qe="utf8");for(var Rt=!1;;)switch(Qe){case"hex":return Z(this,N,B,Re);case"utf8":case"utf-8":return se(this,N,B,Re);case"ascii":return oe(this,N,B,Re);case"latin1":case"binary":return te(this,N,B,Re);case"base64":return xe(this,N,B,Re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge(this,N,B,Re);default:if(Rt)throw new TypeError("Unknown encoding: "+Qe);Qe=(""+Qe).toLowerCase(),Rt=!0}},x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function st(k,N,B){var Re="";B=Math.min(k.length,B);for(var Qe=N;Qe<B;++Qe)Re+=String.fromCharCode(127&k[Qe]);return Re}function Xe(k,N,B){var Re="";B=Math.min(k.length,B);for(var Qe=N;Qe<B;++Qe)Re+=String.fromCharCode(k[Qe]);return Re}function tt(k,N,B){var Re=k.length;(!N||N<0)&&(N=0),(!B||B<0||B>Re)&&(B=Re);for(var Qe="",St=N;St<B;++St)Qe+=q(k[St]);return Qe}function Ye(k,N,B){for(var Re=k.slice(N,B),Qe="",St=0;St<Re.length;St+=2)Qe+=String.fromCharCode(Re[St]+256*Re[St+1]);return Qe}function Ue(k,N,B){if(k%1!=0||k<0)throw new RangeError("offset is not uint");if(k+N>B)throw new RangeError("Trying to access beyond buffer length")}function Le(k,N,B,Re,Qe,St){if(!x.isBuffer(k))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>Qe||N<St)throw new RangeError('"value" argument is out of bounds');if(B+Re>k.length)throw new RangeError("Index out of range")}function Ke(k,N,B,Re,Qe,St){if(B+Re>k.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function Te(k,N,B,Re,Qe){return N=+N,B>>>=0,Qe||Ke(k,0,B,4),P.write(k,N,B,Re,23,4),B+4}function Ve(k,N,B,Re,Qe){return N=+N,B>>>=0,Qe||Ke(k,0,B,8),P.write(k,N,B,Re,52,8),B+8}x.prototype.slice=function(N,B){var Re=this.length;(N=~~N)<0?(N+=Re)<0&&(N=0):N>Re&&(N=Re),(B=void 0===B?Re:~~B)<0?(B+=Re)<0&&(B=0):B>Re&&(B=Re),B<N&&(B=N);var Qe=this.subarray(N,B);return Qe.__proto__=x.prototype,Qe},x.prototype.readUIntLE=function(N,B,Re){N>>>=0,B>>>=0,Re||Ue(N,B,this.length);for(var Qe=this[N],St=1,Rt=0;++Rt<B&&(St*=256);)Qe+=this[N+Rt]*St;return Qe},x.prototype.readUIntBE=function(N,B,Re){N>>>=0,B>>>=0,Re||Ue(N,B,this.length);for(var Qe=this[N+--B],St=1;B>0&&(St*=256);)Qe+=this[N+--B]*St;return Qe},x.prototype.readUInt8=function(N,B){return N>>>=0,B||Ue(N,1,this.length),this[N]},x.prototype.readUInt16LE=function(N,B){return N>>>=0,B||Ue(N,2,this.length),this[N]|this[N+1]<<8},x.prototype.readUInt16BE=function(N,B){return N>>>=0,B||Ue(N,2,this.length),this[N]<<8|this[N+1]},x.prototype.readUInt32LE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+16777216*this[N+3]},x.prototype.readUInt32BE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),16777216*this[N]+(this[N+1]<<16|this[N+2]<<8|this[N+3])},x.prototype.readIntLE=function(N,B,Re){N>>>=0,B>>>=0,Re||Ue(N,B,this.length);for(var Qe=this[N],St=1,Rt=0;++Rt<B&&(St*=256);)Qe+=this[N+Rt]*St;return Qe>=(St*=128)&&(Qe-=Math.pow(2,8*B)),Qe},x.prototype.readIntBE=function(N,B,Re){N>>>=0,B>>>=0,Re||Ue(N,B,this.length);for(var Qe=B,St=1,Rt=this[N+--Qe];Qe>0&&(St*=256);)Rt+=this[N+--Qe]*St;return Rt>=(St*=128)&&(Rt-=Math.pow(2,8*B)),Rt},x.prototype.readInt8=function(N,B){return N>>>=0,B||Ue(N,1,this.length),128&this[N]?-1*(255-this[N]+1):this[N]},x.prototype.readInt16LE=function(N,B){N>>>=0,B||Ue(N,2,this.length);var Re=this[N]|this[N+1]<<8;return 32768&Re?4294901760|Re:Re},x.prototype.readInt16BE=function(N,B){N>>>=0,B||Ue(N,2,this.length);var Re=this[N+1]|this[N]<<8;return 32768&Re?4294901760|Re:Re},x.prototype.readInt32LE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},x.prototype.readInt32BE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},x.prototype.readFloatLE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),P.read(this,N,!0,23,4)},x.prototype.readFloatBE=function(N,B){return N>>>=0,B||Ue(N,4,this.length),P.read(this,N,!1,23,4)},x.prototype.readDoubleLE=function(N,B){return N>>>=0,B||Ue(N,8,this.length),P.read(this,N,!0,52,8)},x.prototype.readDoubleBE=function(N,B){return N>>>=0,B||Ue(N,8,this.length),P.read(this,N,!1,52,8)},x.prototype.writeUIntLE=function(N,B,Re,Qe){N=+N,B>>>=0,Re>>>=0,Qe||Le(this,N,B,Re,Math.pow(2,8*Re)-1,0);var Rt=1,In=0;for(this[B]=255&N;++In<Re&&(Rt*=256);)this[B+In]=N/Rt&255;return B+Re},x.prototype.writeUIntBE=function(N,B,Re,Qe){N=+N,B>>>=0,Re>>>=0,Qe||Le(this,N,B,Re,Math.pow(2,8*Re)-1,0);var Rt=Re-1,In=1;for(this[B+Rt]=255&N;--Rt>=0&&(In*=256);)this[B+Rt]=N/In&255;return B+Re},x.prototype.writeUInt8=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,1,255,0),this[B]=255&N,B+1},x.prototype.writeUInt16LE=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,2,65535,0),this[B]=255&N,this[B+1]=N>>>8,B+2},x.prototype.writeUInt16BE=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,2,65535,0),this[B]=N>>>8,this[B+1]=255&N,B+2},x.prototype.writeUInt32LE=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,4,4294967295,0),this[B+3]=N>>>24,this[B+2]=N>>>16,this[B+1]=N>>>8,this[B]=255&N,B+4},x.prototype.writeUInt32BE=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,4,4294967295,0),this[B]=N>>>24,this[B+1]=N>>>16,this[B+2]=N>>>8,this[B+3]=255&N,B+4},x.prototype.writeIntLE=function(N,B,Re,Qe){if(N=+N,B>>>=0,!Qe){var St=Math.pow(2,8*Re-1);Le(this,N,B,Re,St-1,-St)}var Rt=0,In=1,Ln=0;for(this[B]=255&N;++Rt<Re&&(In*=256);)N<0&&0===Ln&&0!==this[B+Rt-1]&&(Ln=1),this[B+Rt]=(N/In>>0)-Ln&255;return B+Re},x.prototype.writeIntBE=function(N,B,Re,Qe){if(N=+N,B>>>=0,!Qe){var St=Math.pow(2,8*Re-1);Le(this,N,B,Re,St-1,-St)}var Rt=Re-1,In=1,Ln=0;for(this[B+Rt]=255&N;--Rt>=0&&(In*=256);)N<0&&0===Ln&&0!==this[B+Rt+1]&&(Ln=1),this[B+Rt]=(N/In>>0)-Ln&255;return B+Re},x.prototype.writeInt8=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,1,127,-128),N<0&&(N=255+N+1),this[B]=255&N,B+1},x.prototype.writeInt16LE=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,2,32767,-32768),this[B]=255&N,this[B+1]=N>>>8,B+2},x.prototype.writeInt16BE=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,2,32767,-32768),this[B]=N>>>8,this[B+1]=255&N,B+2},x.prototype.writeInt32LE=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,4,2147483647,-2147483648),this[B]=255&N,this[B+1]=N>>>8,this[B+2]=N>>>16,this[B+3]=N>>>24,B+4},x.prototype.writeInt32BE=function(N,B,Re){return N=+N,B>>>=0,Re||Le(this,N,B,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[B]=N>>>24,this[B+1]=N>>>16,this[B+2]=N>>>8,this[B+3]=255&N,B+4},x.prototype.writeFloatLE=function(N,B,Re){return Te(this,N,B,!0,Re)},x.prototype.writeFloatBE=function(N,B,Re){return Te(this,N,B,!1,Re)},x.prototype.writeDoubleLE=function(N,B,Re){return Ve(this,N,B,!0,Re)},x.prototype.writeDoubleBE=function(N,B,Re){return Ve(this,N,B,!1,Re)},x.prototype.copy=function(N,B,Re,Qe){if(!x.isBuffer(N))throw new TypeError("argument should be a Buffer");if(Re||(Re=0),!Qe&&0!==Qe&&(Qe=this.length),B>=N.length&&(B=N.length),B||(B=0),Qe>0&&Qe<Re&&(Qe=Re),Qe===Re||0===N.length||0===this.length)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(Re<0||Re>=this.length)throw new RangeError("Index out of range");if(Qe<0)throw new RangeError("sourceEnd out of bounds");Qe>this.length&&(Qe=this.length),N.length-B<Qe-Re&&(Qe=N.length-B+Re);var St=Qe-Re;if(this===N&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(B,Re,Qe);else if(this===N&&Re<B&&B<Qe)for(var Rt=St-1;Rt>=0;--Rt)N[Rt+B]=this[Rt+Re];else Uint8Array.prototype.set.call(N,this.subarray(Re,Qe),B);return St},x.prototype.fill=function(N,B,Re,Qe){if("string"==typeof N){if("string"==typeof B?(Qe=B,B=0,Re=this.length):"string"==typeof Re&&(Qe=Re,Re=this.length),void 0!==Qe&&"string"!=typeof Qe)throw new TypeError("encoding must be a string");if("string"==typeof Qe&&!x.isEncoding(Qe))throw new TypeError("Unknown encoding: "+Qe);if(1===N.length){var St=N.charCodeAt(0);("utf8"===Qe&&St<128||"latin1"===Qe)&&(N=St)}}else"number"==typeof N&&(N&=255);if(B<0||this.length<B||this.length<Re)throw new RangeError("Out of range index");if(Re<=B)return this;var Rt;if(B>>>=0,Re=void 0===Re?this.length:Re>>>0,N||(N=0),"number"==typeof N)for(Rt=B;Rt<Re;++Rt)this[Rt]=N;else{var In=x.isBuffer(N)?N:x.from(N,Qe),Ln=In.length;if(0===Ln)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(Rt=0;Rt<Re-B;++Rt)this[Rt+B]=In[Rt%Ln]}return this};var $e=/[^+/0-9A-Za-z-_]/g;function q(k){return k<16?"0"+k.toString(16):k.toString(16)}function G(k,N){N=N||1/0;for(var B,Re=k.length,Qe=null,St=[],Rt=0;Rt<Re;++Rt){if((B=k.charCodeAt(Rt))>55295&&B<57344){if(!Qe){if(B>56319){(N-=3)>-1&&St.push(239,191,189);continue}if(Rt+1===Re){(N-=3)>-1&&St.push(239,191,189);continue}Qe=B;continue}if(B<56320){(N-=3)>-1&&St.push(239,191,189),Qe=B;continue}B=65536+(Qe-55296<<10|B-56320)}else Qe&&(N-=3)>-1&&St.push(239,191,189);if(Qe=null,B<128){if((N-=1)<0)break;St.push(B)}else if(B<2048){if((N-=2)<0)break;St.push(B>>6|192,63&B|128)}else if(B<65536){if((N-=3)<0)break;St.push(B>>12|224,B>>6&63|128,63&B|128)}else{if(!(B<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;St.push(B>>18|240,B>>12&63|128,B>>6&63|128,63&B|128)}}return St}function je(k){return j.toByteArray(function(k){if((k=(k=k.split("=")[0]).trim().replace($e,"")).length<2)return"";for(;k.length%4!=0;)k+="=";return k}(k))}function _t(k,N,B,Re){for(var Qe=0;Qe<Re&&!(Qe+B>=N.length||Qe>=k.length);++Qe)N[Qe+B]=k[Qe];return Qe}function pt(k,N){return k instanceof N||null!=k&&null!=k.constructor&&null!=k.constructor.name&&k.constructor.name===N.name}function ve(k){return k!=k}}).call(this)}).call(this,Y("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(Y,Se,he){"use strict";Se.exports=function W(j){return null===j||"object"!=typeof j||null!=j.toJSON?JSON.stringify(j):Array.isArray(j)?"["+j.reduce((P,Q,z)=>P+(0===z?"":",")+W(void 0===Q||"symbol"==typeof Q?null:Q),"")+"]":"{"+Object.keys(j).sort().reduce((P,Q,z)=>void 0===j[Q]||"symbol"==typeof j[Q]?P:P+(0===P.length?"":",")+W(Q)+":"+W(j[Q]),"")+"}"}},{}],8:[function(Y,Se,he){"use strict";var P,W="object"==typeof Reflect?Reflect:null,j=W&&"function"==typeof W.apply?W.apply:function($,Z,se){return Function.prototype.apply.call($,Z,se)};P=W&&"function"==typeof W.ownKeys?W.ownKeys:Object.getOwnPropertySymbols?function($){return Object.getOwnPropertyNames($).concat(Object.getOwnPropertySymbols($))}:function($){return Object.getOwnPropertyNames($)};var z=Number.isNaN||function($){return $!=$};function v(){v.init.call(this)}Se.exports=v,Se.exports.once=function(E,$){return new Promise(function(Z,se){function oe(xe){E.removeListener($,te),se(xe)}function te(){"function"==typeof E.removeListener&&E.removeListener("error",oe),Z([].slice.call(arguments))}X(E,$,te,{once:!0}),"error"!==$&&function(E,$,Z){"function"==typeof E.on&&X(E,"error",$,Z)}(E,oe,{once:!0})})},v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var x=10;function O(E){if("function"!=typeof E)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}function A(E){return void 0===E._maxListeners?v.defaultMaxListeners:E._maxListeners}function b(E,$,Z,se){var oe,te,xe;if(O(Z),void 0===(te=E._events)?(te=E._events=Object.create(null),E._eventsCount=0):(void 0!==te.newListener&&(E.emit("newListener",$,Z.listener?Z.listener:Z),te=E._events),xe=te[$]),void 0===xe)xe=te[$]=Z,++E._eventsCount;else if("function"==typeof xe?xe=te[$]=se?[Z,xe]:[xe,Z]:se?xe.unshift(Z):xe.push(Z),(oe=A(E))>0&&xe.length>oe&&!xe.warned){xe.warned=!0;var ge=new Error("Possible EventEmitter memory leak detected. "+xe.length+" "+String($)+" listeners added. Use emitter.setMaxListeners() to increase limit");ge.name="MaxListenersExceededWarning",ge.emitter=E,ge.type=$,ge.count=xe.length,function(E){console&&console.warn&&console.warn(E)}(ge)}return E}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function S(E,$,Z){var se={fired:!1,wrapFn:void 0,target:E,type:$,listener:Z},oe=y.bind(se);return oe.listener=Z,se.wrapFn=oe,oe}function T(E,$,Z){var se=E._events;if(void 0===se)return[];var oe=se[$];return void 0===oe?[]:"function"==typeof oe?Z?[oe.listener||oe]:[oe]:Z?function(E){for(var $=new Array(E.length),Z=0;Z<$.length;++Z)$[Z]=E[Z].listener||E[Z];return $}(oe):R(oe,oe.length)}function V(E){var $=this._events;if(void 0!==$){var Z=$[E];if("function"==typeof Z)return 1;if(void 0!==Z)return Z.length}return 0}function R(E,$){for(var Z=new Array($),se=0;se<$;++se)Z[se]=E[se];return Z}function X(E,$,Z,se){if("function"==typeof E.on)se.once?E.once($,Z):E.on($,Z);else{if("function"!=typeof E.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E);E.addEventListener($,function oe(te){se.once&&E.removeEventListener($,oe),Z(te)})}}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return x},set:function(E){if("number"!=typeof E||E<0||z(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");x=E}}),v.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function($){if("number"!=typeof $||$<0||z($))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+$+".");return this._maxListeners=$,this},v.prototype.getMaxListeners=function(){return A(this)},v.prototype.emit=function($){for(var Z=[],se=1;se<arguments.length;se++)Z.push(arguments[se]);var oe="error"===$,te=this._events;if(void 0!==te)oe=oe&&void 0===te.error;else if(!oe)return!1;if(oe){var xe;if(Z.length>0&&(xe=Z[0]),xe instanceof Error)throw xe;var ge=new Error("Unhandled error."+(xe?" ("+xe.message+")":""));throw ge.context=xe,ge}var ne=te[$];if(void 0===ne)return!1;if("function"==typeof ne)j(ne,this,Z);else{var _e=ne.length,Ie=R(ne,_e);for(se=0;se<_e;++se)j(Ie[se],this,Z)}return!0},v.prototype.on=v.prototype.addListener=function($,Z){return b(this,$,Z,!1)},v.prototype.prependListener=function($,Z){return b(this,$,Z,!0)},v.prototype.once=function($,Z){return O(Z),this.on($,S(this,$,Z)),this},v.prototype.prependOnceListener=function($,Z){return O(Z),this.prependListener($,S(this,$,Z)),this},v.prototype.off=v.prototype.removeListener=function($,Z){var se,oe,te,xe,ge;if(O(Z),void 0===(oe=this._events))return this;if(void 0===(se=oe[$]))return this;if(se===Z||se.listener===Z)0==--this._eventsCount?this._events=Object.create(null):(delete oe[$],oe.removeListener&&this.emit("removeListener",$,se.listener||Z));else if("function"!=typeof se){for(te=-1,xe=se.length-1;xe>=0;xe--)if(se[xe]===Z||se[xe].listener===Z){ge=se[xe].listener,te=xe;break}if(te<0)return this;0===te?se.shift():function(E,$){for(;$+1<E.length;$++)E[$]=E[$+1];E.pop()}(se,te),1===se.length&&(oe[$]=se[0]),void 0!==oe.removeListener&&this.emit("removeListener",$,ge||Z)}return this},v.prototype.removeAllListeners=function($){var Z,se,oe;if(void 0===(se=this._events))return this;if(void 0===se.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==se[$]&&(0==--this._eventsCount?this._events=Object.create(null):delete se[$]),this;if(0===arguments.length){var xe,te=Object.keys(se);for(oe=0;oe<te.length;++oe)"removeListener"!==(xe=te[oe])&&this.removeAllListeners(xe);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Z=se[$]))this.removeListener($,Z);else if(void 0!==Z)for(oe=Z.length-1;oe>=0;oe--)this.removeListener($,Z[oe]);return this},v.prototype.listeners=function($){return T(this,$,!0)},v.prototype.rawListeners=function($){return T(this,$,!1)},v.listenerCount=function(E,$){return"function"==typeof E.listenerCount?E.listenerCount($):V.call(E,$)},v.prototype.listenerCount=V,v.prototype.eventNames=function(){return this._eventsCount>0?P(this._events):[]}},{}],9:[function(Y,Se,he){he.read=function(W,j,P,Q,z){var v,x,O=8*z-Q-1,A=(1<<O)-1,b=A>>1,y=-7,S=P?z-1:0,T=P?-1:1,V=W[j+S];for(S+=T,v=V&(1<<-y)-1,V>>=-y,y+=O;y>0;v=256*v+W[j+S],S+=T,y-=8);for(x=v&(1<<-y)-1,v>>=-y,y+=Q;y>0;x=256*x+W[j+S],S+=T,y-=8);if(0===v)v=1-b;else{if(v===A)return x?NaN:1/0*(V?-1:1);x+=Math.pow(2,Q),v-=b}return(V?-1:1)*x*Math.pow(2,v-Q)},he.write=function(W,j,P,Q,z,v){var x,O,A,b=8*v-z-1,y=(1<<b)-1,S=y>>1,T=23===z?Math.pow(2,-24)-Math.pow(2,-77):0,V=Q?0:v-1,R=Q?1:-1,K=j<0||0===j&&1/j<0?1:0;for(j=Math.abs(j),isNaN(j)||j===1/0?(O=isNaN(j)?1:0,x=y):(x=Math.floor(Math.log(j)/Math.LN2),j*(A=Math.pow(2,-x))<1&&(x--,A*=2),(j+=x+S>=1?T/A:T*Math.pow(2,1-S))*A>=2&&(x++,A/=2),x+S>=y?(O=0,x=y):x+S>=1?(O=(j*A-1)*Math.pow(2,z),x+=S):(O=j*Math.pow(2,S-1)*Math.pow(2,z),x=0));z>=8;W[P+V]=255&O,V+=R,O/=256,z-=8);for(x=x<<z|O,b+=z;b>0;W[P+V]=255&x,V+=R,x/=256,b-=8);W[P+V-R]|=128*K}},{}],10:[function(Y,Se,he){Se.exports="function"==typeof Object.create?function(j,P){P&&(j.super_=P,j.prototype=Object.create(P.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}))}:function(j,P){if(P){j.super_=P;var Q=function(){};Q.prototype=P.prototype,j.prototype=new Q,j.prototype.constructor=j}}},{}],11:[function(Y,Se,he){"use strict";const{isArray:W,isObject:j,isString:P}=Y("./types"),{asArray:Q}=Y("./util"),{prependBase:z}=Y("./url"),v=Y("./JsonLdError"),x=Y("./ResolvedContext");function A(y){throw new v("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function b({context:y,base:S}){if(!y)return;const T=y["@context"];if(P(T))y["@context"]=z(S,T);else if(W(T))for(let V=0;V<T.length;++V){const R=T[V];P(R)?T[V]=z(S,R):j(R)&&b({context:{"@context":R},base:S})}else if(j(T))for(const V in T)b({context:T[V],base:S})}Se.exports=class{constructor({sharedCache:S}){this.perOpCache=new Map,this.sharedCache=S}resolve({activeCtx:S,context:T,documentLoader:V,base:R,cycles:K=new Set}){var ce=this;return yt(function*(){T&&j(T)&&T["@context"]&&(T=T["@context"]),T=Q(T);const D=[];for(const I of T){if(P(I)){let $=ce._get(I);$||($=yield ce._resolveRemoteContext({activeCtx:S,url:I,documentLoader:V,base:R,cycles:K})),W($)?D.push(...$):D.push($);continue}if(null===I){D.push(new x({document:null}));continue}j(I)||A(T);const X=JSON.stringify(I);let E=ce._get(X);E||(E=new x({document:I}),ce._cacheResolvedContext({key:X,resolved:E,tag:"static"})),D.push(E)}return D})()}_get(S){let T=this.perOpCache.get(S);if(!T){const V=this.sharedCache.get(S);V&&(T=V.get("static"),T&&this.perOpCache.set(S,T))}return T}_cacheResolvedContext({key:S,resolved:T,tag:V}){if(this.perOpCache.set(S,T),void 0!==V){let R=this.sharedCache.get(S);R||(R=new Map,this.sharedCache.set(S,R)),R.set(V,T)}return T}_resolveRemoteContext({activeCtx:S,url:T,documentLoader:V,base:R,cycles:K}){var ce=this;return yt(function*(){T=z(R,T);const{context:D,remoteDoc:I}=yield ce._fetchContext({activeCtx:S,url:T,documentLoader:V,cycles:K});b({context:D,base:R=I.documentUrl||T});const X=yield ce.resolve({activeCtx:S,context:D,documentLoader:V,base:R,cycles:K});return ce._cacheResolvedContext({key:T,resolved:X,tag:I.tag}),X})()}_fetchContext({activeCtx:S,url:T,documentLoader:V,cycles:R}){return yt(function*(){if(R.size>10)throw new v("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"loading remote context failed":"context overflow",max:10});if(R.has(T))throw new v("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"recursive context inclusion":"context overflow",url:T});let K,ce;R.add(T);try{ce=yield V(T),K=ce.document||null,P(K)&&(K=JSON.parse(K))}catch(D){throw new v("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:T,cause:D})}if(!j(K))throw new v("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:T});return K="@context"in K?{"@context":K["@context"]}:{"@context":{}},ce.contextUrl&&(W(K["@context"])||(K["@context"]=[K["@context"]]),K["@context"].push(ce.contextUrl)),{context:K,remoteDoc:ce}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(Y,Se,he){"use strict";Se.exports=class extends Error{constructor(j="An unspecified JSON-LD error occurred.",P="jsonld.Error",Q={}){super(j),this.name=P,this.message=j,this.details=Q}}},{}],13:[function(Y,Se,he){"use strict";Se.exports=W=>{class j{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(j,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(j.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:j}),j.compact=function(P,Q){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):W.compact(P,Q)},j.expand=function(P){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):W.expand(P)},j.flatten=function(P){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):W.flatten(P)},j}},{}],14:[function(Y,Se,he){"use strict";Se.exports=Y("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(Y,Se,he){"use strict";Se.exports=class{constructor(){this._requests={}}wrapLoader(j){const P=this;return P._loader=j,function(){return P.add.apply(P,arguments)}}add(j){var P=this;return yt(function*(){let Q=P._requests[j];if(Q)return Promise.resolve(Q);Q=P._requests[j]=P._loader(j);try{return yield Q}finally{delete P._requests[j]}})()}}},{}],16:[function(Y,Se,he){"use strict";const W=Y("lru-cache");Se.exports=class{constructor({document:Q}){this.document=Q,this.cache=new W({max:10})}getProcessed(Q){return this.cache.get(Q)}setProcessed(Q,z){this.cache.set(Q,z)}}},{"lru-cache":33}],17:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:P,isString:Q,isUndefined:z}=Y("./types"),{isList:v,isValue:x,isGraph:O,isSimpleGraph:A,isSubjectReference:b}=Y("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:T,process:V,processingMode:R}=Y("./context"),{removeBase:K,prependBase:ce}=Y("./url"),{addValue:D,asArray:I,compareShortestLeast:X}=Y("./util"),E={};function Z(se,oe,te){if("@nest"!==y(se,oe,{vocab:!0},te))throw new W("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}Se.exports=E,E.compact=function(){var se=yt(function*({activeCtx:oe,activeProperty:te=null,element:xe,options:ge={},compactionMap:ne=(()=>{})}){if(j(xe)){let Ie=[];for(let Ge=0;Ge<xe.length;++Ge){let st=yield E.compact({activeCtx:oe,activeProperty:te,element:xe[Ge],options:ge,compactionMap:ne});null===st&&(st=yield ne({unmappedValue:xe[Ge],activeCtx:oe,activeProperty:te,parent:xe,index:Ge,options:ge}),void 0===st)||Ie.push(st)}return ge.compactArrays&&1===Ie.length&&0===(S(oe,te,"@container")||[]).length&&(Ie=Ie[0]),Ie}const _e=S(oe,te,"@context");if(z(_e)||(oe=yield V({activeCtx:oe,localCtx:_e,propagate:!0,overrideProtected:!0,options:ge})),P(xe)){if(ge.link&&"@id"in xe&&ge.link.hasOwnProperty(xe["@id"])){const Le=ge.link[xe["@id"]];for(let Ke=0;Ke<Le.length;++Ke)if(Le[Ke].expanded===xe)return Le[Ke].compacted}if(x(xe)||b(xe)){const Le=E.compactValue({activeCtx:oe,activeProperty:te,value:xe,options:ge});return ge.link&&b(xe)&&(ge.link.hasOwnProperty(xe["@id"])||(ge.link[xe["@id"]]=[]),ge.link[xe["@id"]].push({expanded:xe,compacted:Le})),Le}if(v(xe)&&(S(oe,te,"@container")||[]).includes("@list"))return E.compact({activeCtx:oe,activeProperty:te,element:xe["@list"],options:ge,compactionMap:ne});const Ie="@reverse"===te,Ge={},st=oe;!x(xe)&&!b(xe)&&(oe=oe.revertToPreviousContext());const Xe=S(st,te,"@context");z(Xe)||(oe=yield V({activeCtx:oe,localCtx:Xe,propagate:!0,overrideProtected:!0,options:ge})),ge.link&&"@id"in xe&&(ge.link.hasOwnProperty(xe["@id"])||(ge.link[xe["@id"]]=[]),ge.link[xe["@id"]].push({expanded:xe,compacted:Ge}));let tt=xe["@type"]||[];tt.length>1&&(tt=Array.from(tt).sort());const Ye=oe;for(const Le of tt){const Ke=E.compactIri({activeCtx:Ye,iri:Le,relativeTo:{vocab:!0}}),Te=S(st,Ke,"@context");z(Te)||(oe=yield V({activeCtx:oe,localCtx:Te,options:ge,propagate:!1}))}const Ue=Object.keys(xe).sort();for(const Le of Ue){const Ke=xe[Le];if("@id"!==Le)if("@type"!==Le)if("@reverse"!==Le)if("@preserve"!==Le)if("@index"!==Le)if("@graph"!==Le&&"@list"!==Le&&"@included"!==Le&&T(Le)){const Te=E.compactIri({activeCtx:oe,iri:Le,relativeTo:{vocab:!0}});D(Ge,Te,Ke)}else{if(!j(Ke))throw new W("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Ke.length){const Te=E.compactIri({activeCtx:oe,iri:Le,value:Ke,relativeTo:{vocab:!0},reverse:Ie}),Ve=oe.mappings.has(Te)?oe.mappings.get(Te)["@nest"]:null;let $e=Ge;Ve&&(Z(oe,Ve,ge),P(Ge[Ve])||(Ge[Ve]={}),$e=Ge[Ve]),D($e,Te,Ke,{propertyIsArray:!0})}for(const Te of Ke){const Ve=E.compactIri({activeCtx:oe,iri:Le,value:Te,relativeTo:{vocab:!0},reverse:Ie}),$e=oe.mappings.has(Ve)?oe.mappings.get(Ve)["@nest"]:null;let Ne=Ge;$e&&(Z(oe,$e,ge),P(Ge[$e])||(Ge[$e]={}),Ne=Ge[$e]);const q=S(oe,Ve,"@container")||[],G=O(Te),pe=v(Te);let ue;pe?ue=Te["@list"]:G&&(ue=Te["@graph"]);let je=yield E.compact({activeCtx:oe,activeProperty:Ve,element:pe||G?ue:Te,options:ge,compactionMap:ne});if(pe){if(j(je)||(je=[je]),q.includes("@list")){D(Ne,Ve,je,{valueIsArray:!0,allowDuplicate:!0});continue}je={[E.compactIri({activeCtx:oe,iri:"@list",relativeTo:{vocab:!0}})]:je},"@index"in Te&&(je[E.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=Te["@index"])}if(G)if(q.includes("@graph")&&(q.includes("@id")||q.includes("@index")&&A(Te))){let _t;Ne.hasOwnProperty(Ve)?_t=Ne[Ve]:Ne[Ve]=_t={};const pt=(q.includes("@id")?Te["@id"]:Te["@index"])||E.compactIri({activeCtx:oe,iri:"@none",relativeTo:{vocab:!0}});D(_t,pt,je,{propertyIsArray:!ge.compactArrays||q.includes("@set")})}else q.includes("@graph")&&A(Te)?(j(je)&&je.length>1&&(je={"@included":je}),D(Ne,Ve,je,{propertyIsArray:!ge.compactArrays||q.includes("@set")})):(j(je)&&1===je.length&&ge.compactArrays&&(je=je[0]),je={[E.compactIri({activeCtx:oe,iri:"@graph",relativeTo:{vocab:!0}})]:je},"@id"in Te&&(je[E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]=Te["@id"]),"@index"in Te&&(je[E.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=Te["@index"]),D(Ne,Ve,je,{propertyIsArray:!ge.compactArrays||q.includes("@set")}));else if(q.includes("@language")||q.includes("@index")||q.includes("@id")||q.includes("@type")){let _t,pt;if(Ne.hasOwnProperty(Ve)?_t=Ne[Ve]:Ne[Ve]=_t={},q.includes("@language"))x(je)&&(je=je["@value"]),pt=Te["@language"];else if(q.includes("@index")){const ve=S(oe,Ve,"@index")||"@index",k=E.compactIri({activeCtx:oe,iri:ve,relativeTo:{vocab:!0}});if("@index"===ve)pt=Te["@index"],delete je[k];else{let N;if([pt,...N]=I(je[ve]||[]),Q(pt))switch(N.length){case 0:delete je[ve];break;case 1:je[ve]=N[0];break;default:je[ve]=N}else pt=null}}else if(q.includes("@id")){const ve=E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}});pt=je[ve],delete je[ve]}else if(q.includes("@type")){const ve=E.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}});let k;switch([pt,...k]=I(je[ve]||[]),k.length){case 0:delete je[ve];break;case 1:je[ve]=k[0];break;default:je[ve]=k}1===Object.keys(je).length&&"@id"in Te&&(je=yield E.compact({activeCtx:oe,activeProperty:Ve,element:{"@id":Te["@id"]},options:ge,compactionMap:ne}))}pt||(pt=E.compactIri({activeCtx:oe,iri:"@none",relativeTo:{vocab:!0}})),D(_t,pt,je,{propertyIsArray:q.includes("@set")})}else{const _t=!ge.compactArrays||q.includes("@set")||q.includes("@list")||j(je)&&0===je.length||"@list"===Le||"@graph"===Le;D(Ne,Ve,je,{propertyIsArray:_t})}}}else{if((S(oe,te,"@container")||[]).includes("@index"))continue;const Ve=E.compactIri({activeCtx:oe,iri:Le,relativeTo:{vocab:!0}});D(Ge,Ve,Ke)}else{const Te=yield E.compact({activeCtx:oe,activeProperty:te,element:Ke,options:ge,compactionMap:ne});j(Te)&&0===Te.length||D(Ge,Le,Te)}else{const Te=yield E.compact({activeCtx:oe,activeProperty:"@reverse",element:Ke,options:ge,compactionMap:ne});for(const Ve in Te)if(oe.mappings.has(Ve)&&oe.mappings.get(Ve).reverse){const $e=Te[Ve],q=(S(oe,Ve,"@container")||[]).includes("@set")||!ge.compactArrays;D(Ge,Ve,$e,{propertyIsArray:q}),delete Te[Ve]}if(Object.keys(Te).length>0){const Ve=E.compactIri({activeCtx:oe,iri:Le,relativeTo:{vocab:!0}});D(Ge,Ve,Te)}}else{let Te=I(Ke).map(G=>E.compactIri({activeCtx:st,iri:G,relativeTo:{vocab:!0}}));1===Te.length&&(Te=Te[0]);const Ve=E.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}}),q=(S(oe,Ve,"@container")||[]).includes("@set")&&R(oe,1.1)||j(Te)&&0===Ke.length;D(Ge,Ve,Te,{propertyIsArray:q})}else{let Te=I(Ke).map($e=>E.compactIri({activeCtx:oe,iri:$e,relativeTo:{vocab:!1},base:ge.base}));1===Te.length&&(Te=Te[0]),Ge[E.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]=Te}}return Ge}return xe});return function(oe){return se.apply(this,arguments)}}(),E.compactIri=({activeCtx:se,iri:oe,value:te=null,relativeTo:xe={vocab:!1},reverse:ge=!1,base:ne=null})=>{if(null===oe)return oe;se.isPropertyTermScoped&&se.previousContext&&(se=se.previousContext);const _e=se.getInverse();if(T(oe)&&oe in _e&&"@none"in _e[oe]&&"@type"in _e[oe]["@none"]&&"@none"in _e[oe]["@none"]["@type"])return _e[oe]["@none"]["@type"]["@none"];if(xe.vocab&&oe in _e){const tt=se["@language"]||"@none",Ye=[];P(te)&&"@index"in te&&!("@graph"in te)&&Ye.push("@index","@index@set"),P(te)&&"@preserve"in te&&(te=te["@preserve"][0]),O(te)?("@index"in te&&Ye.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in te&&Ye.push("@graph@id","@graph@id@set"),Ye.push("@graph","@graph@set","@set"),"@index"in te||Ye.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in te||Ye.push("@graph@id","@graph@id@set")):P(te)&&!x(te)&&Ye.push("@id","@id@set","@type","@set@type");let Ue="@language",Le="@null";if(ge)Ue="@type",Le="@reverse",Ye.push("@set");else if(v(te)){"@index"in te||Ye.push("@list");const Te=te["@list"];if(0===Te.length)Ue="@any",Le="@none";else{let Ve=0===Te.length?tt:null,$e=null;for(let Ne=0;Ne<Te.length;++Ne){const q=Te[Ne];let G="@none",pe="@none";if(x(q)?"@direction"in q?G=`${(q["@language"]||"").toLowerCase()}_${q["@direction"]}`:"@language"in q?G=q["@language"].toLowerCase():"@type"in q?pe=q["@type"]:G="@null":pe="@id",null===Ve?Ve=G:G!==Ve&&x(q)&&(Ve="@none"),null===$e?$e=pe:pe!==$e&&($e="@none"),"@none"===Ve&&"@none"===$e)break}Ve=Ve||"@none",$e=$e||"@none","@none"!==$e?(Ue="@type",Le=$e):Le=Ve}}else{if(x(te))if("@language"in te&&!("@index"in te)){Ye.push("@language","@language@set"),Le=te["@language"];const Te=te["@direction"];Te&&(Le=`${Le}_${Te}`)}else"@direction"in te&&!("@index"in te)?Le=`_${te["@direction"]}`:"@type"in te&&(Ue="@type",Le=te["@type"]);else Ue="@type",Le="@id";Ye.push("@set")}Ye.push("@none"),P(te)&&!("@index"in te)&&Ye.push("@index","@index@set"),x(te)&&1===Object.keys(te).length&&Ye.push("@language","@language@set");const Ke=function(se,oe,te,xe,ge,ne){null===ne&&(ne="@null");const _e=[];if(("@id"===ne||"@reverse"===ne)&&P(te)&&"@id"in te){"@reverse"===ne&&_e.push("@reverse");const Ge=E.compactIri({activeCtx:se,iri:te["@id"],relativeTo:{vocab:!0}});se.mappings.has(Ge)&&se.mappings.get(Ge)&&se.mappings.get(Ge)["@id"]===te["@id"]?_e.push.apply(_e,["@vocab","@id"]):_e.push.apply(_e,["@id","@vocab"])}else{_e.push(ne);const Ge=_e.find(st=>st.includes("_"));Ge&&_e.push(Ge.replace(/^[^_]+_/,"_"))}_e.push("@none");const Ie=se.inverse[oe];for(const Ge of xe){if(!(Ge in Ie))continue;const st=Ie[Ge][ge];for(const Xe of _e)if(Xe in st)return st[Xe]}return null}(se,oe,te,Ye,Ue,Le);if(null!==Ke)return Ke}if(xe.vocab&&"@vocab"in se){const tt=se["@vocab"];if(0===oe.indexOf(tt)&&oe!==tt){const Ye=oe.substr(tt.length);if(!se.mappings.has(Ye))return Ye}}let Ie=null;const Ge=[];let st=se.fastCurieMap;const Xe=oe.length-1;for(let tt=0;tt<Xe&&oe[tt]in st;++tt)st=st[oe[tt]],""in st&&Ge.push(st[""][0]);for(let tt=Ge.length-1;tt>=0;--tt){const Ye=Ge[tt],Ue=Ye.terms;for(const Le of Ue){const Ke=Le+":"+oe.substr(Ye.iri.length);se.mappings.get(Le)._prefix&&(!se.mappings.has(Ke)||null===te&&se.mappings.get(Ke)["@id"]===oe)&&(null===Ie||X(Ke,Ie)<0)&&(Ie=Ke)}}if(null!==Ie)return Ie;for(const[tt,Ye]of se.mappings)if(Ye&&Ye._prefix&&oe.startsWith(tt+":"))throw new W(`Absolute IRI "${oe}" confused with prefix "${tt}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:se});return xe.vocab?oe:"@base"in se?se["@base"]?K(ce(ne,se["@base"]),oe):oe:K(ne,oe)},E.compactValue=({activeCtx:se,activeProperty:oe,value:te,options:xe})=>{if(x(te)){const Ie=S(se,oe,"@type"),Ge=S(se,oe,"@language"),st=S(se,oe,"@direction"),Xe=S(se,oe,"@container")||[],tt="@index"in te&&!Xe.includes("@index");if(!tt&&"@none"!==Ie&&(te["@type"]===Ie||"@language"in te&&te["@language"]===Ge&&"@direction"in te&&te["@direction"]===st||"@language"in te&&te["@language"]===Ge||"@direction"in te&&te["@direction"]===st))return te["@value"];const Ye=Object.keys(te).length,Ue=1===Ye||2===Ye&&"@index"in te&&!tt,Le="@language"in se,Ke=Q(te["@value"]),Te=se.mappings.has(oe)&&null===se.mappings.get(oe)["@language"];if(Ue&&"@none"!==Ie&&(!Le||!Ke||Te))return te["@value"];const Ve={};return tt&&(Ve[E.compactIri({activeCtx:se,iri:"@index",relativeTo:{vocab:!0}})]=te["@index"]),"@type"in te?Ve[E.compactIri({activeCtx:se,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:se,iri:te["@type"],relativeTo:{vocab:!0}}):"@language"in te&&(Ve[E.compactIri({activeCtx:se,iri:"@language",relativeTo:{vocab:!0}})]=te["@language"]),"@direction"in te&&(Ve[E.compactIri({activeCtx:se,iri:"@direction",relativeTo:{vocab:!0}})]=te["@direction"]),Ve[E.compactIri({activeCtx:se,iri:"@value",relativeTo:{vocab:!0}})]=te["@value"],Ve}const ge=y(se,oe,{vocab:!0},xe),ne=S(se,oe,"@type"),_e=E.compactIri({activeCtx:se,iri:te["@id"],relativeTo:{vocab:"@vocab"===ne},base:xe.base});return"@id"===ne||"@vocab"===ne||"@graph"===ge?_e:{[E.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}})]:_e}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(Y,Se,he){"use strict";const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#";Se.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:W,RDF_LIST:W+"List",RDF_FIRST:W+"first",RDF_REST:W+"rest",RDF_NIL:W+"nil",RDF_TYPE:W+"type",RDF_PLAIN_LITERAL:W+"PlainLiteral",RDF_XML_LITERAL:W+"XMLLiteral",RDF_JSON_LITERAL:W+"JSON",RDF_OBJECT:W+"object",RDF_LANGSTRING:W+"langString",XSD:j,XSD_BOOLEAN:j+"boolean",XSD_DOUBLE:j+"double",XSD_INTEGER:j+"integer",XSD_STRING:j+"string"}},{}],19:[function(Y,Se,he){"use strict";const W=Y("./util"),j=Y("./JsonLdError"),{isArray:P,isObject:Q,isString:z,isUndefined:v}=Y("./types"),{isAbsolute:x,isRelative:O,prependBase:A}=Y("./url"),{asArray:b,compareShortestLeast:y}=Y("./util"),S=new Map,V=/^@[a-zA-Z]+$/,R={};function K(D,I,X,E,$,Z){if(null===I||!z(I)||R.isKeyword(I))return I;if(I.match(V))return null;if(E&&E.hasOwnProperty(I)&&!0!==$.get(I)&&R.createTermDefinition({activeCtx:D,localCtx:E,term:I,defined:$,options:Z}),(X=X||{}).vocab){const oe=D.mappings.get(I);if(null===oe)return null;if(Q(oe)&&"@id"in oe)return oe["@id"]}const se=I.indexOf(":");if(se>0){const oe=I.substr(0,se),te=I.substr(se+1);if("_"===oe||0===te.indexOf("//"))return I;E&&E.hasOwnProperty(oe)&&R.createTermDefinition({activeCtx:D,localCtx:E,term:oe,defined:$,options:Z});const xe=D.mappings.get(oe);if(xe&&xe._prefix)return xe["@id"]+te;if(x(I))return I}if(X.vocab&&"@vocab"in D)return D["@vocab"]+I;if(X.base&&"@base"in D){if(D["@base"])return A(A(Z.base,D["@base"]),I)}else if(X.base)return A(Z.base,I);return I}function ce(D,I){if(!D||"object"!=typeof D||!I||"object"!=typeof I)return D===I;const X=Array.isArray(D);if(X!==Array.isArray(I))return!1;if(X){if(D.length!==I.length)return!1;for(let Z=0;Z<D.length;++Z)if(!ce(D[Z],I[Z]))return!1;return!0}const E=Object.keys(D),$=Object.keys(I);if(E.length!==$.length)return!1;for(const Z in D){let se=D[Z],oe=I[Z];if("@container"===Z&&Array.isArray(se)&&Array.isArray(oe)&&(se=se.slice().sort(),oe=oe.slice().sort()),!ce(se,oe))return!1}return!0}Se.exports=R,R.process=function(){var D=yt(function*({activeCtx:I,localCtx:X,options:E,propagate:$=!0,overrideProtected:Z=!1,cycles:se=new Set}){if(Q(X)&&"@context"in X&&P(X["@context"])&&(X=X["@context"]),0===b(X).length)return I;const te=yield E.contextResolver.resolve({activeCtx:I,context:X,documentLoader:E.documentLoader,base:E.base});Q(te[0].document)&&"boolean"==typeof te[0].document["@propagate"]&&($=te[0].document["@propagate"]);let xe=I;!$&&!xe.previousContext&&(xe=xe.clone(),xe.previousContext=I);for(const ge of te){let{document:ne}=ge;if(I=xe,null===ne){if(!Z&&0!==Object.keys(I.protected).length){const Ge=E&&E.protectedMode||"error";if("error"===Ge)throw new j("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===Ge){console.warn("WARNING: invalid context nullification");const st=ge.getProcessed(I);if(st){xe=I=st;continue}const Xe=I;xe=I=R.getInitialContext(E).clone();for(const[tt,Ye]of Object.entries(Xe.protected))Ye&&(I.mappings[tt]=W.clone(Xe.mappings[tt]));I.protected=W.clone(Xe.protected),ge.setProcessed(Xe,xe);continue}throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:X,protectedMode:Ge})}xe=I=R.getInitialContext(E).clone();continue}const _e=ge.getProcessed(I);if(_e){xe=I=_e;continue}if(Q(ne)&&"@context"in ne&&(ne=ne["@context"]),!Q(ne))throw new j("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:ne});xe=xe.clone();const Ie=new Map;if("@version"in ne){if(1.1!==ne["@version"])throw new j("Unsupported JSON-LD version: "+ne["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:ne});if(I.processingMode&&"json-ld-1.0"===I.processingMode)throw new j("@version: "+ne["@version"]+" not compatible with "+I.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:ne});xe.processingMode="json-ld-1.1",xe["@version"]=ne["@version"],Ie.set("@version",!0)}if(xe.processingMode=xe.processingMode||I.processingMode,"@base"in ne){let Ge=ne["@base"];if(null!==Ge&&!x(Ge)){if(!O(Ge))throw new j('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:ne});Ge=A(xe["@base"],Ge)}xe["@base"]=Ge,Ie.set("@base",!0)}if("@vocab"in ne){const Ge=ne["@vocab"];if(null===Ge)delete xe["@vocab"];else{if(!z(Ge))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ne});if(!x(Ge)&&R.processingMode(xe,1))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:ne});xe["@vocab"]=K(xe,Ge,{vocab:!0,base:!0},void 0,void 0,E)}Ie.set("@vocab",!0)}if("@language"in ne){const Ge=ne["@language"];if(null===Ge)delete xe["@language"];else{if(!z(Ge))throw new j('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:ne});xe["@language"]=Ge.toLowerCase()}Ie.set("@language",!0)}if("@direction"in ne){const Ge=ne["@direction"];if("json-ld-1.0"===I.processingMode)throw new j("Invalid JSON-LD syntax; @direction not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:ne});if(null===Ge)delete xe["@direction"];else{if("ltr"!==Ge&&"rtl"!==Ge)throw new j('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:ne});xe["@direction"]=Ge}Ie.set("@direction",!0)}if("@propagate"in ne){const Ge=ne["@propagate"];if("json-ld-1.0"===I.processingMode)throw new j("Invalid JSON-LD syntax; @propagate not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ne});if("boolean"!=typeof Ge)throw new j("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:X});Ie.set("@propagate",!0)}if("@import"in ne){const Ge=ne["@import"];if("json-ld-1.0"===I.processingMode)throw new j("Invalid JSON-LD syntax; @import not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:ne});if(!z(Ge))throw new j("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:X});const st=yield E.contextResolver.resolve({activeCtx:I,context:Ge,documentLoader:E.documentLoader,base:E.base});if(1!==st.length)throw new j("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:X});const Xe=st[0].getProcessed(I);if(Xe)ne=Xe;else{const tt=st[0].document;if("@import"in tt)throw new j("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:X});for(const Ye in tt)ne.hasOwnProperty(Ye)||(ne[Ye]=tt[Ye]);st[0].setProcessed(I,ne)}Ie.set("@import",!0)}Ie.set("@protected",ne["@protected"]||!1);for(const Ge in ne)if(R.createTermDefinition({activeCtx:xe,localCtx:ne,term:Ge,defined:Ie,options:E,overrideProtected:Z}),Q(ne[Ge])&&"@context"in ne[Ge]){const st=ne[Ge]["@context"];let Xe=!0;if(z(st)){const tt=A(E.base,st);se.has(tt)?Xe=!1:se.add(tt)}if(Xe)try{yield R.process({activeCtx:xe.clone(),localCtx:ne[Ge]["@context"],overrideProtected:!0,options:E,cycles:se})}catch(tt){throw new j("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:ne[Ge]["@context"],term:Ge})}}ge.setProcessed(I,xe)}return xe});return function(I){return D.apply(this,arguments)}}(),R.createTermDefinition=({activeCtx:D,localCtx:I,term:X,defined:E,options:$,overrideProtected:Z=!1})=>{if(E.has(X)){if(E.get(X))return;throw new j("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:I,term:X})}let se;if(E.set(X,!1),I.hasOwnProperty(X)&&(se=I[X]),"@type"===X&&Q(se)&&"@set"===(se["@container"]||"@set")&&R.processingMode(D,1.1)){const Ie=["@container","@id","@protected"],Ge=Object.keys(se);if(0===Ge.length||Ge.some(st=>!Ie.includes(st)))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:I,term:X})}else{if(R.isKeyword(X))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:I,term:X});if(X.match(V))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:X});if(""===X)throw new j("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:I})}const oe=D.mappings.get(X);D.mappings.has(X)&&D.mappings.delete(X);let te=!1;if((z(se)||null===se)&&(te=!0,se={"@id":se}),!Q(se))throw new j("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:I});const xe={};D.mappings.set(X,xe),xe.reverse=!1;const ge=["@container","@id","@language","@reverse","@type"];R.processingMode(D,1.1)&&ge.push("@context","@direction","@index","@nest","@prefix","@protected");for(const Ie in se)if(!ge.includes(Ie))throw new j("Invalid JSON-LD syntax; a term definition must not contain "+Ie,"jsonld.SyntaxError",{code:"invalid term definition",context:I});const ne=X.indexOf(":");if(xe._termHasColon=ne>0,"@reverse"in se){if("@id"in se)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});if("@nest"in se)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});const Ie=se["@reverse"];if(!z(Ie))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(!R.isKeyword(Ie)&&Ie.match(V))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:Ie}),void(oe?D.mappings.set(X,oe):D.mappings.delete(X));const Ge=K(D,Ie,{vocab:!0,base:!1},I,E,$);if(!x(Ge))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});xe["@id"]=Ge,xe.reverse=!0}else if("@id"in se){let Ie=se["@id"];if(Ie&&!z(Ie))throw new j("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(null===Ie)xe["@id"]=null;else{if(!R.isKeyword(Ie)&&Ie.match(V))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:Ie}),void(oe?D.mappings.set(X,oe):D.mappings.delete(X));if(Ie!==X){if(Ie=K(D,Ie,{vocab:!0,base:!1},I,E,$),!x(Ie)&&!R.isKeyword(Ie))throw new j("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(X.match(/(?::[^:])|\//)&&K(D,X,{vocab:!0,base:!1},I,new Map(E).set(X,!0),$)!==Ie)throw new j("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});xe["@id"]=Ie,xe._prefix=te&&!xe._termHasColon&&Ie.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in xe))if(xe._termHasColon){const Ie=X.substr(0,ne);if(I.hasOwnProperty(Ie)&&R.createTermDefinition({activeCtx:D,localCtx:I,term:Ie,defined:E,options:$}),D.mappings.has(Ie)){const Ge=X.substr(ne+1);xe["@id"]=D.mappings.get(Ie)["@id"]+Ge}else xe["@id"]=X}else if("@type"===X)xe["@id"]=X;else{if(!("@vocab"in D))throw new j("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I,term:X});xe["@id"]=D["@vocab"]+X}if((!0===se["@protected"]||!0===E.get("@protected")&&!1!==se["@protected"])&&(D.protected[X]=!0,xe.protected=!0),E.set(X,!0),"@type"in se){let Ie=se["@type"];if(!z(Ie))throw new j("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:I});if("@json"===Ie||"@none"===Ie){if(R.processingMode(D,1))throw new j(`Invalid JSON-LD syntax; an @context @type value must not be "${Ie}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:I})}else if("@id"!==Ie&&"@vocab"!==Ie){if(Ie=K(D,Ie,{vocab:!0,base:!1},I,E,$),!x(Ie))throw new j("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:I});if(0===Ie.indexOf("_:"))throw new j("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:I})}xe["@type"]=Ie}if("@container"in se){const Ie=z(se["@container"])?[se["@container"]]:se["@container"]||[],Ge=["@list","@set","@index","@language"];let st=!0;const Xe=Ie.includes("@set");if(R.processingMode(D,1.1)){if(Ge.push("@graph","@id","@type"),Ie.includes("@list")){if(1!==Ie.length)throw new j("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:I})}else if(Ie.includes("@graph")){if(Ie.some(tt=>"@graph"!==tt&&"@id"!==tt&&"@index"!==tt&&"@set"!==tt))throw new j("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:I})}else st&=Ie.length<=(Xe?2:1);if(Ie.includes("@type")&&(xe["@type"]=xe["@type"]||"@id",!["@id","@vocab"].includes(xe["@type"])))throw new j("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:I})}else st&=!P(se["@container"]),st&=Ie.length<=1;if(st&=Ie.every(tt=>Ge.includes(tt)),st&=!(Xe&&Ie.includes("@list")),!st)throw new j("Invalid JSON-LD syntax; @context @container value must be one of the following: "+Ge.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:I});if(xe.reverse&&!Ie.every(tt=>["@index","@set"].includes(tt)))throw new j("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});xe["@container"]=Ie}if("@index"in se){if(!("@container"in se)||!xe["@container"].includes("@index"))throw new j(`Invalid JSON-LD syntax; @index without @index in @container: "${se["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:I});if(!z(se["@index"])||0===se["@index"].indexOf("@"))throw new j(`Invalid JSON-LD syntax; @index must expand to an IRI: "${se["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:I});xe["@index"]=se["@index"]}if("@context"in se&&(xe["@context"]=se["@context"]),"@language"in se&&!("@type"in se)){let Ie=se["@language"];if(null!==Ie&&!z(Ie))throw new j("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:I});null!==Ie&&(Ie=Ie.toLowerCase()),xe["@language"]=Ie}if("@prefix"in se){if(X.match(/:|\//))throw new j("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:I});if(R.isKeyword(xe["@id"]))throw new j("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:I});if("boolean"!=typeof se["@prefix"])throw new j("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:I});xe._prefix=!0===se["@prefix"]}if("@direction"in se){const Ie=se["@direction"];if(null!==Ie&&"ltr"!==Ie&&"rtl"!==Ie)throw new j('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:I});xe["@direction"]=Ie}if("@nest"in se){const Ie=se["@nest"];if(!z(Ie)||"@nest"!==Ie&&0===Ie.indexOf("@"))throw new j("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:I});xe["@nest"]=Ie}const _e=xe["@id"];if("@context"===_e||"@preserve"===_e)throw new j("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:I});if(oe&&oe.protected&&!Z&&(D.protected[X]=!0,xe.protected=!0,!ce(oe,xe))){const Ie=$&&$.protectedMode||"error";if("error"===Ie)throw new j(`Invalid JSON-LD syntax; tried to redefine "${X}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:I,term:X});if("warn"===Ie)return void console.warn("WARNING: protected term redefinition",{term:X});throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:I,term:X,protectedMode:Ie})}},R.expandIri=(D,I,X,E)=>K(D,I,X,void 0,void 0,E),R.getInitialContext=D=>{const I=JSON.stringify({processingMode:D.processingMode}),X=S.get(I);if(X)return X;const E={processingMode:D.processingMode,mappings:new Map,inverse:null,getInverse:function(){const xe=this;if(xe.inverse)return xe.inverse;const ge=xe.inverse={},ne=xe.fastCurieMap={},_e={},Ie=(xe["@language"]||"@none").toLowerCase(),Ge=xe["@direction"],st=xe.mappings,Xe=[...st.keys()].sort(y);for(const tt of Xe){const Ye=st.get(tt);if(null===Ye)continue;let Ue=Ye["@container"]||"@none";if(Ue=[].concat(Ue).sort().join(""),null===Ye["@id"])continue;const Le=b(Ye["@id"]);for(const Ke of Le){let Te=ge[Ke];const Ve=R.isKeyword(Ke);if(Te)!Ve&&!Ye._termHasColon&&_e[Ke].push(tt);else if(ge[Ke]=Te={},!Ve&&!Ye._termHasColon){_e[Ke]=[tt];const $e={iri:Ke,terms:_e[Ke]};Ke[0]in ne?ne[Ke[0]].push($e):ne[Ke[0]]=[$e]}if(Te[Ue]||(Te[Ue]={"@language":{},"@type":{},"@any":{}}),Te=Te[Ue],se(tt,Te["@any"],"@none"),Ye.reverse)se(tt,Te["@type"],"@reverse");else if("@none"===Ye["@type"])se(tt,Te["@any"],"@none"),se(tt,Te["@language"],"@none"),se(tt,Te["@type"],"@none");else if("@type"in Ye)se(tt,Te["@type"],Ye["@type"]);else if("@language"in Ye&&"@direction"in Ye){const $e=Ye["@language"],Ne=Ye["@direction"];se(tt,Te["@language"],$e&&Ne?`${$e}_${Ne}`.toLowerCase():$e?$e.toLowerCase():Ne?`_${Ne}`:"@null")}else"@language"in Ye?se(tt,Te["@language"],(Ye["@language"]||"@null").toLowerCase()):"@direction"in Ye?se(tt,Te["@language"],Ye["@direction"]?`_${Ye["@direction"]}`:"@none"):Ge?(se(tt,Te["@language"],`_${Ge}`),se(tt,Te["@language"],"@none"),se(tt,Te["@type"],"@none")):(se(tt,Te["@language"],Ie),se(tt,Te["@language"],"@none"),se(tt,Te["@type"],"@none"))}}for(const tt in ne)Z(ne,tt,1);return ge},clone:function(){const xe={};return xe.mappings=W.clone(this.mappings),xe.clone=this.clone,xe.inverse=null,xe.getInverse=this.getInverse,xe.protected=W.clone(this.protected),this.previousContext&&(xe.previousContext=this.previousContext.clone()),xe.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(xe["@base"]=this["@base"]),"@language"in this&&(xe["@language"]=this["@language"]),"@vocab"in this&&(xe["@vocab"]=this["@vocab"]),xe},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===S.size&&S.clear(),S.set(I,E),E;function Z(xe,ge,ne){const _e=xe[ge],Ie=xe[ge]={};let Ge,st;for(const Xe of _e)Ge=Xe.iri,st=ne>=Ge.length?"":Ge[ne],st in Ie?Ie[st].push(Xe):Ie[st]=[Xe];for(const Xe in Ie)""!==Xe&&Z(Ie,Xe,ne+1)}function se(xe,ge,ne){ge.hasOwnProperty(ne)||(ge[ne]=xe)}},R.getContextValue=(D,I,X)=>{if(null===I)return"@context"===X?void 0:null;if(D.mappings.has(I)){const E=D.mappings.get(I);if(v(X))return E;if(E.hasOwnProperty(X))return E[X]}return"@language"===X&&X in D||"@direction"===X&&X in D?D[X]:"@context"!==X?null:void 0},R.processingMode=(D,I)=>I.toString()>="1.1"?!D.processingMode||D.processingMode>="json-ld-"+I.toString():"json-ld-1.0"===D.processingMode,R.isKeyword=D=>{if(!z(D)||"@"!==D[0])return!1;switch(D){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(Y,Se,he){"use strict";const{parseLinkHeader:W,buildHeaders:j}=Y("../util"),{LINK_HEADER_CONTEXT:P}=Y("../constants"),Q=Y("../JsonLdError"),z=Y("../RequestQueue"),{prependBase:v}=Y("../url"),x=/(^|(\r\n))link:/i;function O(A,b,y){const S=new(A=A||XMLHttpRequest);return new Promise((T,V)=>{S.onload=()=>T(S),S.onerror=R=>V(R),S.open("GET",b,!0);for(const R in y)S.setRequestHeader(R,y[R]);S.send()})}Se.exports=({secure:A,headers:b={},xhr:y}={headers:{}})=>{return b=j(b),(new z).wrapLoader(T);function T(R){return V.apply(this,arguments)}function V(){return(V=yt(function*(R){if(0!==R.indexOf("http:")&&0!==R.indexOf("https:"))throw new Q('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:R});if(A&&0!==R.indexOf("https"))throw new Q('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:R});let K;try{K=yield O(y,R,b)}catch(E){throw new Q("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:R,cause:E})}if(K.status>=400)throw new Q("URL could not be dereferenced: "+K.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:R,httpStatusCode:K.status});let ce={contextUrl:null,documentUrl:R,document:K.response},D=null;const I=K.getResponseHeader("Content-Type");let X;if(x.test(K.getAllResponseHeaders())&&(X=K.getResponseHeader("Link")),X&&"application/ld+json"!==I){const E=W(X),$=E[P];if(Array.isArray($))throw new Q("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:R});$&&(ce.contextUrl=$.target),D=E.alternate,D&&"application/ld+json"==D.type&&!(I||"").match(/^application\/(\w*\+)?json$/)&&(ce=yield T(v(R,D.target)))}return ce})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:P,isEmptyObject:Q,isString:z,isUndefined:v}=Y("./types"),{isList:x,isValue:O,isGraph:A,isSubject:b}=Y("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:T,process:V,processingMode:R}=Y("./context"),{isAbsolute:K}=Y("./url"),{addValue:ce,asArray:D,getValues:I,validateTypeValue:X}=Y("./util"),E={};Se.exports=E;const $=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function Z(ne){return se.apply(this,arguments)}function se(){return(se=yt(function*({activeCtx:ne,activeProperty:_e,expandedActiveProperty:Ie,element:Ge,expandedParent:st,options:Xe={},insideList:tt,typeKey:Ye,typeScopedContext:Ue,expansionMap:Le}){const Ke=Object.keys(Ge).sort(),Te=[];let Ve;const $e=Ge[Ye]&&"@json"===y(ne,j(Ge[Ye])?Ge[Ye][0]:Ge[Ye],{vocab:!0},Xe);for(const Ne of Ke){let G,q=Ge[Ne];if("@context"===Ne)continue;let pe=y(ne,Ne,{vocab:!0},Xe);if((null===pe||!K(pe)&&!T(pe))&&(pe=Le({unmappedProperty:Ne,activeCtx:ne,activeProperty:_e,parent:Ge,options:Xe,insideList:tt,value:q,expandedParent:st}),void 0===pe))continue;if(T(pe)){if("@reverse"===Ie)throw new W("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:q});if(pe in st&&"@included"!==pe&&"@type"!==pe)throw new W("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:pe})}if("@id"===pe){if(!z(q)){if(!Xe.isFrame)throw new W('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:q});if(P(q)){if(!Q(q))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q})}else{if(!j(q))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q});if(!q.every(pt=>z(pt)))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:q})}}ce(st,"@id",D(q).map(pt=>z(pt)?y(ne,pt,{base:!0},Xe):pt),{propertyIsArray:Xe.isFrame});continue}if("@type"===pe){P(q)&&(q=Object.fromEntries(Object.entries(q).map(([pt,ve])=>[y(Ue,pt,{vocab:!0}),D(ve).map(k=>y(Ue,k,{base:!0,vocab:!0}))]))),X(q,Xe.isFrame),ce(st,"@type",D(q).map(pt=>z(pt)?y(Ue,pt,{base:!0,vocab:!0},Xe):pt),{propertyIsArray:Xe.isFrame});continue}if("@included"===pe&&R(ne,1.1)){const pt=D(yield E.expand({activeCtx:ne,activeProperty:_e,element:q,options:Xe,expansionMap:Le}));if(!pt.every(ve=>b(ve)))throw new W("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:q});ce(st,"@included",pt,{propertyIsArray:!0});continue}if("@graph"===pe&&!P(q)&&!j(q))throw new W('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:q});if("@value"===pe){Ve=q,$e&&R(ne,1.1)?st["@value"]=q:ce(st,"@value",q,{propertyIsArray:Xe.isFrame});continue}if("@language"===pe){if(null===q)continue;if(!z(q)&&!Xe.isFrame)throw new W('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:q});q=D(q).map(pt=>z(pt)?pt.toLowerCase():pt);for(const pt of q)z(pt)&&!pt.match($)&&console.warn(`@language must be valid BCP47: ${pt}`);ce(st,"@language",q,{propertyIsArray:Xe.isFrame});continue}if("@direction"===pe){if(!z(q)&&!Xe.isFrame)throw new W('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:q});q=D(q);for(const pt of q)if(z(pt)&&"ltr"!==pt&&"rtl"!==pt)throw new W('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:q});ce(st,"@direction",q,{propertyIsArray:Xe.isFrame});continue}if("@index"===pe){if(!z(q))throw new W('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:q});ce(st,"@index",q);continue}if("@reverse"===pe){if(!P(q))throw new W('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:q});if(G=yield E.expand({activeCtx:ne,activeProperty:"@reverse",element:q,options:Xe,expansionMap:Le}),"@reverse"in G)for(const ve in G["@reverse"])ce(st,ve,G["@reverse"][ve],{propertyIsArray:!0});let pt=st["@reverse"]||null;for(const ve in G){if("@reverse"===ve)continue;null===pt&&(pt=st["@reverse"]={}),ce(pt,ve,[],{propertyIsArray:!0});const k=G[ve];for(let N=0;N<k.length;++N){const B=k[N];if(O(B)||x(B))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:G});ce(pt,ve,B,{propertyIsArray:!0})}}continue}if("@nest"===pe){Te.push(Ne);continue}let ue=ne;const je=S(ne,Ne,"@context");v(je)||(ue=yield V({activeCtx:ne,localCtx:je,propagate:!0,overrideProtected:!0,options:Xe}));const _t=S(ue,Ne,"@container")||[];if(_t.includes("@language")&&P(q))G=te(ue,q,S(ue,Ne,"@direction"),Xe);else if(_t.includes("@index")&&P(q)){const pt=_t.includes("@graph"),ve=S(ue,Ne,"@index")||"@index",k="@index"!==ve&&y(ne,ve,{vocab:!0},Xe);G=yield xe({activeCtx:ue,options:Xe,activeProperty:Ne,value:q,expansionMap:Le,asGraph:pt,indexKey:ve,propertyIndex:k})}else if(_t.includes("@id")&&P(q)){const pt=_t.includes("@graph");G=yield xe({activeCtx:ue,options:Xe,activeProperty:Ne,value:q,expansionMap:Le,asGraph:pt,indexKey:"@id"})}else if(_t.includes("@type")&&P(q))G=yield xe({activeCtx:ue.revertToPreviousContext(),options:Xe,activeProperty:Ne,value:q,expansionMap:Le,asGraph:!1,indexKey:"@type"});else{const pt="@list"===pe;if(pt||"@set"===pe){let ve=_e;pt&&"@graph"===Ie&&(ve=null),G=yield E.expand({activeCtx:ue,activeProperty:ve,element:q,options:Xe,insideList:pt,expansionMap:Le})}else G="@json"===S(ne,Ne,"@type")?{"@type":"@json","@value":q}:yield E.expand({activeCtx:ue,activeProperty:Ne,element:q,options:Xe,insideList:!1,expansionMap:Le})}if(null!==G||"@value"===pe||(G=Le({unmappedValue:q,expandedProperty:pe,activeCtx:ue,activeProperty:_e,parent:Ge,options:Xe,insideList:tt,key:Ne,expandedParent:st}),void 0!==G)){if("@list"!==pe&&!x(G)&&_t.includes("@list")&&(G={"@list":D(G)}),_t.includes("@graph")&&!_t.some(pt=>"@id"===pt||"@index"===pt)&&(G=D(G).map(pt=>({"@graph":D(pt)}))),ue.mappings.has(Ne)&&ue.mappings.get(Ne).reverse){const pt=st["@reverse"]=st["@reverse"]||{};G=D(G);for(let ve=0;ve<G.length;++ve){const k=G[ve];if(O(k)||x(k))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:G});ce(pt,pe,k,{propertyIsArray:!0})}continue}ce(st,pe,G,{propertyIsArray:!0})}}if("@value"in st&&("@json"!==st["@type"]||!R(ne,1.1))&&(P(Ve)||j(Ve))&&!Xe.isFrame)throw new W('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:Ve});for(const Ne of Te){const q=j(Ge[Ne])?Ge[Ne]:[Ge[Ne]];for(const G of q){if(!P(G)||Object.keys(G).some(pe=>"@value"===y(ne,pe,{vocab:!0},Xe)))throw new W("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:G});yield Z({activeCtx:ne,activeProperty:_e,expandedActiveProperty:Ie,element:G,expandedParent:st,options:Xe,insideList:tt,typeScopedContext:Ue,typeKey:Ye,expansionMap:Le})}}})).apply(this,arguments)}function oe({activeCtx:ne,activeProperty:_e,value:Ie,options:Ge}){if(null==Ie)return null;const st=y(ne,_e,{vocab:!0},Ge);if("@id"===st)return y(ne,Ie,{base:!0},Ge);if("@type"===st)return y(ne,Ie,{vocab:!0,base:!0},Ge);const Xe=S(ne,_e,"@type");if(("@id"===Xe||"@graph"===st)&&z(Ie))return{"@id":y(ne,Ie,{base:!0},Ge)};if("@vocab"===Xe&&z(Ie))return{"@id":y(ne,Ie,{vocab:!0,base:!0},Ge)};if(T(st))return Ie;const tt={};if(Xe&&!["@id","@vocab","@none"].includes(Xe))tt["@type"]=Xe;else if(z(Ie)){const Ye=S(ne,_e,"@language");null!==Ye&&(tt["@language"]=Ye);const Ue=S(ne,_e,"@direction");null!==Ue&&(tt["@direction"]=Ue)}return["boolean","number","string"].includes(typeof Ie)||(Ie=Ie.toString()),tt["@value"]=Ie,tt}function te(ne,_e,Ie,Ge){const st=[],Xe=Object.keys(_e).sort();for(const tt of Xe){const Ye=y(ne,tt,{vocab:!0},Ge);let Ue=_e[tt];j(Ue)||(Ue=[Ue]);for(const Le of Ue){if(null===Le)continue;if(!z(Le))throw new W("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:_e});const Ke={"@value":Le};"@none"!==Ye&&(Ke["@language"]=tt.toLowerCase()),Ie&&(Ke["@direction"]=Ie),st.push(Ke)}}return st}function xe(ne){return ge.apply(this,arguments)}function ge(){return(ge=yt(function*({activeCtx:ne,options:_e,activeProperty:Ie,value:Ge,expansionMap:st,asGraph:Xe,indexKey:tt,propertyIndex:Ye}){const Ue=[],Le=Object.keys(Ge).sort(),Ke="@type"===tt;for(let Te of Le){if(Ke){const Ne=S(ne,Te,"@context");v(Ne)||(ne=yield V({activeCtx:ne,localCtx:Ne,propagate:!1,options:_e}))}let $e,Ve=Ge[Te];j(Ve)||(Ve=[Ve]),Ve=yield E.expand({activeCtx:ne,activeProperty:Ie,element:Ve,options:_e,insideList:!1,insideIndex:!0,expansionMap:st}),$e=Ye?"@none"===Te?"@none":oe({activeCtx:ne,activeProperty:tt,value:Te,options:_e}):y(ne,Te,{vocab:!0},_e),"@id"===tt?Te=y(ne,Te,{base:!0},_e):Ke&&(Te=$e);for(let Ne of Ve){if(Xe&&!A(Ne)&&(Ne={"@graph":[Ne]}),"@type"===tt)"@none"===$e||(Ne["@type"]=Ne["@type"]?[Te].concat(Ne["@type"]):[Te]);else{if(O(Ne)&&!["@language","@type","@index"].includes(tt))throw new W(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${tt}".`,"jsonld.SyntaxError",{code:"invalid value object",value:Ne});Ye?"@none"!==$e&&ce(Ne,Ye,$e,{propertyIsArray:!0,prependValue:!0}):"@none"!==$e&&!(tt in Ne)&&(Ne[tt]=Te)}Ue.push(Ne)}}return Ue})).apply(this,arguments)}E.expand=function(){var ne=yt(function*({activeCtx:_e,activeProperty:Ie=null,element:Ge,options:st={},insideList:Xe=!1,insideIndex:tt=!1,typeScopedContext:Ye=null,expansionMap:Ue=(()=>{})}){if(null==Ge)return null;if("@default"===Ie&&(st=Object.assign({},st,{isFrame:!1})),!j(Ge)&&!P(Ge)){if(!Xe&&(null===Ie||"@graph"===y(_e,Ie,{vocab:!0},st))){const G=yield Ue({unmappedValue:Ge,activeCtx:_e,activeProperty:Ie,options:st,insideList:Xe});return void 0===G?null:G}return oe({activeCtx:_e,activeProperty:Ie,value:Ge,options:st})}if(j(Ge)){let G=[];const pe=S(_e,Ie,"@container")||[];Xe=Xe||pe.includes("@list");for(let ue=0;ue<Ge.length;++ue){let je=yield E.expand({activeCtx:_e,activeProperty:Ie,element:Ge[ue],options:st,expansionMap:Ue,insideIndex:tt,typeScopedContext:Ye});Xe&&j(je)&&(je={"@list":je}),(null!==je||(je=yield Ue({unmappedValue:Ge[ue],activeCtx:_e,activeProperty:Ie,parent:Ge,index:ue,options:st,expandedParent:G,insideList:Xe}),void 0!==je))&&(j(je)?G=G.concat(je):G.push(je))}return G}const Le=y(_e,Ie,{vocab:!0},st),Ke=S(_e,Ie,"@context");Ye=Ye||(_e.previousContext?_e:null);let Te=Object.keys(Ge).sort(),Ve=!tt;if(Ve&&Ye&&Te.length<=2&&!Te.includes("@context"))for(const G of Te){const pe=y(Ye,G,{vocab:!0},st);if("@value"===pe){Ve=!1,_e=Ye;break}if("@id"===pe&&1===Te.length){Ve=!1;break}}Ve&&(_e=_e.revertToPreviousContext()),v(Ke)||(_e=yield V({activeCtx:_e,localCtx:Ke,propagate:!0,overrideProtected:!0,options:st})),"@context"in Ge&&(_e=yield V({activeCtx:_e,localCtx:Ge["@context"],options:st})),Ye=_e;let $e=null;for(const G of Te)if("@type"===y(_e,G,{vocab:!0},st)){$e=$e||G;const ue=Ge[G],je=Array.isArray(ue)?ue.length>1?ue.slice().sort():ue:[ue];for(const _t of je){const pt=S(Ye,_t,"@context");v(pt)||(_e=yield V({activeCtx:_e,localCtx:pt,options:st,propagate:!1}))}}let Ne={};yield Z({activeCtx:_e,activeProperty:Ie,expandedActiveProperty:Le,element:Ge,expandedParent:Ne,options:st,insideList:Xe,typeKey:$e,typeScopedContext:Ye,expansionMap:Ue}),Te=Object.keys(Ne);let q=Te.length;if("@value"in Ne){if("@type"in Ne&&("@language"in Ne||"@direction"in Ne))throw new W('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Ne});let G=q-1;if("@type"in Ne&&(G-=1),"@index"in Ne&&(G-=1),"@language"in Ne&&(G-=1),"@direction"in Ne&&(G-=1),0!==G)throw new W('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Ne});const pe=null===Ne["@value"]?[]:D(Ne["@value"]),ue=I(Ne,"@type");if(!R(_e,1.1)||!ue.includes("@json")||1!==ue.length)if(0===pe.length){const je=yield Ue({unmappedValue:Ne,activeCtx:_e,activeProperty:Ie,element:Ge,options:st,insideList:Xe});Ne=void 0!==je?je:null}else{if(!pe.every(je=>z(je)||Q(je))&&"@language"in Ne)throw new W("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:Ne});if(!ue.every(je=>K(je)&&!(z(je)&&0===je.indexOf("_:"))||Q(je)))throw new W('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:Ne})}}else if("@type"in Ne&&!j(Ne["@type"]))Ne["@type"]=[Ne["@type"]];else if("@set"in Ne||"@list"in Ne){if(q>1&&(2!==q||!("@index"in Ne)))throw new W('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:Ne});"@set"in Ne&&(Ne=Ne["@set"],Te=Object.keys(Ne),q=Te.length)}else if(1===q&&"@language"in Ne){const G=yield Ue(Ne,{unmappedValue:Ne,activeCtx:_e,activeProperty:Ie,element:Ge,options:st,insideList:Xe});Ne=void 0!==G?G:null}if(P(Ne)&&!st.keepFreeFloatingNodes&&!Xe&&(null===Ie||"@graph"===Le)&&(0===q||"@value"in Ne||"@list"in Ne||1===q&&"@id"in Ne)){const G=yield Ue({unmappedValue:Ne,activeCtx:_e,activeProperty:Ie,element:Ge,options:st,insideList:Xe});Ne=void 0!==G?G:null}return Ne});return function(_e){return ne.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(Y,Se,he){"use strict";const{isSubjectReference:W}=Y("./graphTypes"),{createMergedNodeMap:j}=Y("./nodeMap"),P={};Se.exports=P,P.flatten=Q=>{const z=j(Q),v=[],x=Object.keys(z).sort();for(let O=0;O<x.length;++O){const A=z[x[O]];W(A)||v.push(A)}return v}},{"./graphTypes":25,"./nodeMap":27}],23:[function(Y,Se,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),P=Y("./types"),Q=Y("./util"),z=Y("./url"),v=Y("./JsonLdError"),{createNodeMap:x,mergeNodeMapGraphs:O}=Y("./nodeMap"),A={};function b(E){const $={};for(const Z in E)void 0!==E[Z]&&($["@"+Z]=[E[Z]]);return[$]}function y(E,$,Z){for(let se=Z.length-1;se>=0;--se){const oe=Z[se];if(oe.graph===$&&oe.subject["@id"]===E["@id"])return!0}return!1}function S(E,$,Z){const se="@"+Z;let oe=se in E?E[se][0]:$[Z];if("embed"===Z)if(!0===oe)oe="@once";else if(!1===oe)oe="@never";else if("@always"!==oe&&"@never"!==oe&&"@link"!==oe&&"@first"!==oe&&"@last"!==oe&&"@once"!==oe)throw new v("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:E});return oe}function T(E){if(!P.isArray(E)||1!==E.length||!P.isObject(E[0]))throw new v("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:E});if("@id"in E[0])for(const $ of Q.asArray(E[0]["@id"]))if(!P.isObject($)&&!z.isAbsolute($)||P.isString($)&&0===$.indexOf("_:"))throw new v("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E});if("@type"in E[0])for(const $ of Q.asArray(E[0]["@type"]))if(!P.isObject($)&&!z.isAbsolute($)||P.isString($)&&0===$.indexOf("_:"))throw new v("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E})}function R(E,$,Z,se){let oe=!0,te=!1;for(const xe in Z){let ge=!1;const ne=Q.getValues($,xe),_e=0===Q.getValues(Z,xe).length;if("@id"===xe){if(P.isEmptyObject(Z["@id"][0]||{})?ge=!0:Z["@id"].length>=0&&(ge=Z["@id"].includes(ne[0])),!se.requireAll)return ge}else if("@type"===xe){if(oe=!1,_e){if(ne.length>0)return!1;ge=!0}else if(1===Z["@type"].length&&P.isEmptyObject(Z["@type"][0]))ge=ne.length>0;else for(const Ie of Z["@type"])ge=!(!P.isObject(Ie)||!("@default"in Ie))||ge||ne.some(Ge=>Ge===Ie);if(!se.requireAll)return ge}else{if(W(xe))continue;{const Ie=Q.getValues(Z,xe)[0];let Ge=!1;if(Ie&&(T([Ie]),Ge="@default"in Ie),oe=!1,0===ne.length&&Ge)continue;if(ne.length>0&&_e)return!1;if(void 0===Ie){if(ne.length>0)return!1;ge=!0}else if(j.isList(Ie)){const st=Ie["@list"][0];if(j.isList(ne[0])){const Xe=ne[0]["@list"];j.isValue(st)?ge=Xe.some(tt=>X(st,tt)):(j.isSubject(st)||j.isSubjectReference(st))&&(ge=Xe.some(tt=>I(E,st,tt,se)))}}else ge=j.isValue(Ie)?ne.some(st=>X(Ie,st)):j.isSubjectReference(Ie)?ne.some(st=>I(E,Ie,st,se)):!!P.isObject(Ie)&&ne.length>0}}if(!ge&&se.requireAll)return!1;te=te||ge}return oe||te}function K(E,$){const Z=E.uniqueEmbeds[E.graph],se=Z[$],oe=se.parent,te=se.property,xe={"@id":$};if(P.isArray(oe)){for(let ne=0;ne<oe.length;++ne)if(Q.compareValues(oe[ne],xe)){oe[ne]=xe;break}}else{const ne=P.isArray(oe[te]);Q.removeValue(oe,te,xe,{propertyIsArray:ne}),Q.addValue(oe,te,xe,{propertyIsArray:ne})}const ge=ne=>{const _e=Object.keys(Z);for(const Ie of _e)Ie in Z&&P.isObject(Z[Ie].parent)&&Z[Ie].parent["@id"]===ne&&(delete Z[Ie],ge(Ie))};ge($)}function ce(E,$){if(P.isArray(E))return E.map(Z=>ce(Z,$));if(P.isObject(E)){if("@preserve"in E)return E["@preserve"][0];if(j.isValue(E))return E;if(j.isList(E))return E["@list"]=ce(E["@list"],$),E;if("@id"in E){const Z=E["@id"];if($.link.hasOwnProperty(Z)){const se=$.link[Z].indexOf(E);if(-1!==se)return $.link[Z][se];$.link[Z].push(E)}else $.link[Z]=[E]}for(const Z in E)"@id"===Z&&$.bnodesToClear.includes(E[Z])?delete E["@id"]:E[Z]=ce(E[Z],$)}return E}function D(E,$,Z){P.isObject(E)?Q.addValue(E,$,Z,{propertyIsArray:!0}):E.push(Z)}function I(E,$,Z,se){if(!("@id"in Z))return!1;const oe=E.subjects[Z["@id"]];return oe&&R(E,oe,$,se)}function X(E,$){const Z=$["@value"],se=$["@type"],oe=$["@language"],te=E["@value"]?P.isArray(E["@value"])?E["@value"]:[E["@value"]]:[],xe=E["@type"]?P.isArray(E["@type"])?E["@type"]:[E["@type"]]:[],ge=E["@language"]?P.isArray(E["@language"])?E["@language"]:[E["@language"]]:[];return 0===te.length&&0===xe.length&&0===ge.length||!(!te.includes(Z)&&!P.isEmptyObject(te[0])||!(!se&&0===xe.length||xe.includes(se)||se&&P.isEmptyObject(xe[0]))||!(!oe&&0===ge.length||ge.includes(oe)||oe&&P.isEmptyObject(ge[0])))}Se.exports=A,A.frameMergedOrDefault=(E,$,Z)=>{const se={options:Z,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},oe=new Q.IdentifierIssuer("_:b");x(E,se.graphMap,"@default",oe),Z.merged&&(se.graphMap["@merged"]=O(se.graphMap),se.graph="@merged"),se.subjects=se.graphMap[se.graph];const te=[];return A.frame(se,Object.keys(se.subjects).sort(),$,te),Z.pruneBlankNodeIdentifiers&&(Z.bnodesToClear=Object.keys(se.bnodeMap).filter(xe=>1===se.bnodeMap[xe].length)),Z.link={},ce(te,Z)},A.frame=(E,$,Z,se,oe=null)=>{T(Z);const te=E.options,xe={embed:S(Z=Z[0],te,"embed"),explicit:S(Z,te,"explicit"),requireAll:S(Z,te,"requireAll")};E.link.hasOwnProperty(E.graph)||(E.link[E.graph]={});const ge=E.link[E.graph],ne=function(E,$,Z,se){const oe={};for(const te of $){const xe=E.graphMap[E.graph][te];R(E,xe,Z,se)&&(oe[te]=xe)}return oe}(E,$,Z,xe),_e=Object.keys(ne).sort();for(const Ie of _e){const Ge=ne[Ie];if(null===oe?E.uniqueEmbeds={[E.graph]:{}}:E.uniqueEmbeds[E.graph]=E.uniqueEmbeds[E.graph]||{},"@link"===xe.embed&&Ie in ge){D(se,oe,ge[Ie]);continue}const st={"@id":Ie};if(0===Ie.indexOf("_:")&&Q.addValue(E.bnodeMap,Ie,st,{propertyIsArray:!0}),ge[Ie]=st,("@first"===xe.embed||"@last"===xe.embed)&&E.is11)throw new v("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:Z});if(E.embedded||!E.uniqueEmbeds[E.graph].hasOwnProperty(Ie)){if(E.embedded&&("@never"===xe.embed||y(Ge,E.graph,E.subjectStack))){D(se,oe,st);continue}if(E.embedded&&("@first"==xe.embed||"@once"==xe.embed)&&E.uniqueEmbeds[E.graph].hasOwnProperty(Ie)){D(se,oe,st);continue}if("@last"===xe.embed&&Ie in E.uniqueEmbeds[E.graph]&&K(E,Ie),E.uniqueEmbeds[E.graph][Ie]={parent:se,property:oe},E.subjectStack.push({subject:Ge,graph:E.graph}),Ie in E.graphMap){let Xe=!1,tt=null;"@graph"in Z?(tt=Z["@graph"][0],Xe=!("@merged"===Ie||"@default"===Ie),P.isObject(tt)||(tt={})):(Xe="@merged"!==E.graph,tt={}),Xe&&A.frame(wn(ot({},E),{graph:Ie,embedded:!1}),Object.keys(E.graphMap[Ie]).sort(),[tt],st,"@graph")}"@included"in Z&&A.frame(wn(ot({},E),{embedded:!1}),$,Z["@included"],st,"@included");for(const Xe of Object.keys(Ge).sort())if(W(Xe)){if(st[Xe]=Q.clone(Ge[Xe]),"@type"===Xe)for(const tt of Ge["@type"])0===tt.indexOf("_:")&&Q.addValue(E.bnodeMap,tt,st,{propertyIsArray:!0})}else if(!xe.explicit||Xe in Z)for(const tt of Ge[Xe]){const Ye=Xe in Z?Z[Xe]:b(xe);if(j.isList(tt)){const Ue=Z[Xe]&&Z[Xe][0]&&Z[Xe][0]["@list"]?Z[Xe][0]["@list"]:b(xe),Le={"@list":[]};D(st,Xe,Le);const Ke=tt["@list"];for(const Te of Ke)j.isSubjectReference(Te)?A.frame(wn(ot({},E),{embedded:!0}),[Te["@id"]],Ue,Le,"@list"):D(Le,"@list",Q.clone(Te))}else j.isSubjectReference(tt)?A.frame(wn(ot({},E),{embedded:!0}),[tt["@id"]],Ye,st,Xe):X(Ye[0],tt)&&D(st,Xe,Q.clone(tt))}for(const Xe of Object.keys(Z).sort()){if("@type"===Xe){if(!P.isObject(Z[Xe][0])||!("@default"in Z[Xe][0]))continue}else if(W(Xe))continue;const tt=Z[Xe][0]||{};if(!S(tt,te,"omitDefault")&&!(Xe in st)){let Ue="@null";"@default"in tt&&(Ue=Q.clone(tt["@default"])),P.isArray(Ue)||(Ue=[Ue]),st[Xe]=[{"@preserve":Ue}]}}for(const Xe of Object.keys(Z["@reverse"]||{}).sort()){const tt=Z["@reverse"][Xe];for(const Ye of Object.keys(E.subjects))Q.getValues(E.subjects[Ye],Xe).some(Le=>Le["@id"]===Ie)&&(st["@reverse"]=st["@reverse"]||{},Q.addValue(st["@reverse"],Xe,[],{propertyIsArray:!0}),A.frame(wn(ot({},E),{embedded:!0}),[Ye],tt,st["@reverse"][Xe],oe))}D(se,oe,st),E.subjectStack.pop()}}},A.cleanupNull=(E,$)=>{if(P.isArray(E))return E.map(se=>A.cleanupNull(se,$)).filter(se=>se);if("@null"===E)return null;if(P.isObject(E)){if("@id"in E){const Z=E["@id"];if($.link.hasOwnProperty(Z)){const se=$.link[Z].indexOf(E);if(-1!==se)return $.link[Z][se];$.link[Z].push(E)}else $.link[Z]=[E]}for(const Z in E)E[Z]=A.cleanupNull(E[Z],$)}return E}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(Y,Se,he){"use strict";const W=Y("./JsonLdError"),j=Y("./graphTypes"),P=Y("./types"),Q=Y("./util"),{RDF_LIST:z,RDF_FIRST:v,RDF_REST:x,RDF_NIL:O,RDF_TYPE:A,RDF_JSON_LITERAL:b,XSD_BOOLEAN:y,XSD_DOUBLE:S,XSD_INTEGER:T,XSD_STRING:V}=Y("./constants"),R=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,K={};function ce(D,I,X){if(D.termType.endsWith("Node"))return{"@id":D.value};const E={"@value":D.value};if(D.language)E["@language"]=D.language;else{let $=D.datatype.value;if($||($=V),$===b){$="@json";try{E["@value"]=JSON.parse(E["@value"])}catch(Z){throw new W("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:E["@value"],cause:Z})}}if(I){if($===y)"true"===E["@value"]?E["@value"]=!0:"false"===E["@value"]&&(E["@value"]=!1);else if(P.isNumeric(E["@value"]))if($===T){const Z=parseInt(E["@value"],10);Z.toFixed(0)===E["@value"]&&(E["@value"]=Z)}else $===S&&(E["@value"]=parseFloat(E["@value"]));[y,T,S,V].includes($)||(E["@type"]=$)}else if("i18n-datatype"===X&&$.startsWith("https://www.w3.org/ns/i18n#")){const[,Z,se]=$.split(/[#_]/);Z.length>0&&(E["@language"]=Z,Z.match(R)||console.warn(`@language must be valid BCP47: ${Z}`)),E["@direction"]=se}else $!==V&&(E["@type"]=$)}return E}Se.exports=K,K.fromRDF=function(){var D=yt(function*(I,{useRdfType:X=!1,useNativeTypes:E=!1,rdfDirection:$=null}){const Z={},se={"@default":Z},oe={};for(const ge of I){const ne="DefaultGraph"===ge.graph.termType?"@default":ge.graph.value;ne in se||(se[ne]={}),"@default"!==ne&&!(ne in Z)&&(Z[ne]={"@id":ne});const _e=se[ne],Ie=ge.subject.value,Ge=ge.predicate.value,st=ge.object;Ie in _e||(_e[Ie]={"@id":Ie});const Xe=_e[Ie],tt=st.termType.endsWith("Node");if(tt&&!(st.value in _e)&&(_e[st.value]={"@id":st.value}),Ge===A&&!X&&tt){Q.addValue(Xe,"@type",st.value,{propertyIsArray:!0});continue}const Ye=ce(st,E,$);if(Q.addValue(Xe,Ge,Ye,{propertyIsArray:!0}),tt)if(st.value===O){const Ue=_e[st.value];"usages"in Ue||(Ue.usages=[]),Ue.usages.push({node:Xe,property:Ge,value:Ye})}else oe[st.value]=!(st.value in oe)&&{node:Xe,property:Ge,value:Ye}}for(const ge in se){const ne=se[ge];if(!(O in ne))continue;const _e=ne[O];if(_e.usages){for(let Ie of _e.usages){let Ge=Ie.node,st=Ie.property,Xe=Ie.value;const tt=[],Ye=[];let Ue=Object.keys(Ge).length;for(;st===x&&P.isObject(oe[Ge["@id"]])&&P.isArray(Ge[v])&&1===Ge[v].length&&P.isArray(Ge[x])&&1===Ge[x].length&&(3===Ue||4===Ue&&P.isArray(Ge["@type"])&&1===Ge["@type"].length&&Ge["@type"][0]===z)&&(tt.push(Ge[v][0]),Ye.push(Ge["@id"]),Ie=oe[Ge["@id"]],Ge=Ie.node,st=Ie.property,Xe=Ie.value,Ue=Object.keys(Ge).length,j.isBlankNode(Ge)););delete Xe["@id"],Xe["@list"]=tt.reverse();for(const Le of Ye)delete ne[Le]}delete _e.usages}}const te=[],xe=Object.keys(Z).sort();for(const ge of xe){const ne=Z[ge];if(ge in se){const _e=ne["@graph"]=[],Ie=se[ge],Ge=Object.keys(Ie).sort();for(const st of Ge){const Xe=Ie[st];j.isSubjectReference(Xe)||_e.push(Xe)}}j.isSubjectReference(ne)||te.push(ne)}return te});return function(I,X){return D.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(Y,Se,he){"use strict";const W=Y("./types"),j={};Se.exports=j,j.isSubject=P=>!(!W.isObject(P)||"@value"in P||"@set"in P||"@list"in P)&&(Object.keys(P).length>1||!("@id"in P)),j.isSubjectReference=P=>W.isObject(P)&&1===Object.keys(P).length&&"@id"in P,j.isValue=P=>W.isObject(P)&&"@value"in P,j.isList=P=>W.isObject(P)&&"@list"in P,j.isGraph=P=>W.isObject(P)&&"@graph"in P&&1===Object.keys(P).filter(Q=>"@id"!==Q&&"@index"!==Q).length,j.isSimpleGraph=P=>j.isGraph(P)&&!("@id"in P),j.isBlankNode=P=>!!W.isObject(P)&&("@id"in P?0===P["@id"].indexOf("_:"):0===Object.keys(P).length||!("@value"in P||"@set"in P||"@list"in P))},{"./types":30}],26:[function(Y,Se,he){const W=Y("rdf-canonize"),j=Y("./platform"),P=Y("./util"),Q=Y("./ContextResolver"),z=P.IdentifierIssuer,v=Y("./JsonLdError"),x=Y("lru-cache"),O=Y("./NQuads"),{expand:A}=Y("./expand"),{flatten:b}=Y("./flatten"),{fromRDF:y}=Y("./fromRdf"),{toRDF:S}=Y("./toRdf"),{frameMergedOrDefault:T,cleanupNull:V}=Y("./frame"),{isArray:R,isObject:K,isString:ce}=Y("./types"),{isSubjectReference:D}=Y("./graphTypes"),{expandIri:I,getInitialContext:X,process:E,processingMode:$}=Y("./context"),{compact:Z,compactIri:se}=Y("./compact"),{createNodeMap:oe,createMergedNodeMap:te,mergeNodeMaps:xe}=Y("./nodeMap"),ge=function(_e){const Ie={},st=new x({max:100});function Xe(tt,Le){var Ke=Le,{documentLoader:Ye=_e.documentLoader}=Ke,Ue=tq(Ke,["documentLoader"]);return Object.assign({},{documentLoader:Ye},Ue,tt)}return _e.compact=function(){var tt=yt(function*(Ye,Ue,Le){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===Ue)throw new v("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Ye)return null;let Ke;(Le=Xe(Le,{base:ce(Ye)?Ye:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new z("_:b"),contextResolver:new Q({sharedCache:st})})).link&&(Le.skipExpansion=!0),Le.compactToRelative||delete Le.base,Ke=Le.skipExpansion?Ye:yield _e.expand(Ye,Le);const Te=yield _e.processContext(X(Le),Ue,Le);let Ve=yield Z({activeCtx:Te,element:Ke,options:Le,compactionMap:Le.compactionMap});Le.compactArrays&&!Le.graph&&R(Ve)?1===Ve.length?Ve=Ve[0]:0===Ve.length&&(Ve={}):Le.graph&&K(Ve)&&(Ve=[Ve]),K(Ue)&&"@context"in Ue&&(Ue=Ue["@context"]),Ue=P.clone(Ue),R(Ue)||(Ue=[Ue]);const $e=Ue;Ue=[];for(let q=0;q<$e.length;++q)(!K($e[q])||Object.keys($e[q]).length>0)&&Ue.push($e[q]);const Ne=Ue.length>0;if(1===Ue.length&&(Ue=Ue[0]),R(Ve)){const q=se({activeCtx:Te,iri:"@graph",relativeTo:{vocab:!0}}),G=Ve;Ve={},Ne&&(Ve["@context"]=Ue),Ve[q]=G}else if(K(Ve)&&Ne){const q=Ve;Ve={"@context":Ue};for(const G in q)Ve[G]=q[G]}return Ve});return function(Ye,Ue,Le){return tt.apply(this,arguments)}}(),_e.expand=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(Ue=Xe(Ue,{keepFreeFloatingNodes:!1,contextResolver:new Q({sharedCache:st})})).expansionMap&&(Ue.expansionMap=void 0);const Le={},Ke=[];if("expandContext"in Ue){const Ne=P.clone(Ue.expandContext);Le.expandContext=K(Ne)&&"@context"in Ne?Ne:{"@context":Ne},Ke.push(Le.expandContext)}let Te;if(ce(Ye)){const Ne=yield _e.get(Ye,Ue);Te=Ne.documentUrl,Le.input=Ne.document,Ne.contextUrl&&(Le.remoteContext={"@context":Ne.contextUrl},Ke.push(Le.remoteContext))}else Le.input=P.clone(Ye);"base"in Ue||(Ue.base=Te||"");let Ve=X(Ue);for(const Ne of Ke)Ve=yield E({activeCtx:Ve,localCtx:Ne,options:Ue});let $e=yield A({activeCtx:Ve,element:Le.input,options:Ue,expansionMap:Ue.expansionMap});return K($e)&&"@graph"in $e&&1===Object.keys($e).length?$e=$e["@graph"]:null===$e&&($e=[]),R($e)||($e=[$e]),$e});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.flatten=function(){var tt=yt(function*(Ye,Ue,Le){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");Ue="function"==typeof Ue?null:Ue||null,Le=Xe(Le,{base:ce(Ye)?Ye:"",contextResolver:new Q({sharedCache:st})});const Ke=yield _e.expand(Ye,Le),Te=b(Ke);return null===Ue?Te:(Le.graph=!0,Le.skipExpansion=!0,yield _e.compact(Te,Ue,Le))});return function(Ye,Ue,Le){return tt.apply(this,arguments)}}(),_e.frame=function(){var tt=yt(function*(Ye,Ue,Le){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(Le=Xe(Le,{base:ce(Ye)?Ye:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new Q({sharedCache:st})}),ce(Ue)){const ue=yield _e.get(Ue,Le);if(Ue=ue.document,ue.contextUrl){let je=Ue["@context"];je?R(je)?je.push(ue.contextUrl):je=[je,ue.contextUrl]:je=ue.contextUrl,Ue["@context"]=je}}const Ke=Ue&&Ue["@context"]||{},Te=yield _e.processContext(X(Le),Ke,Le);Le.hasOwnProperty("omitGraph")||(Le.omitGraph=$(Te,1.1)),Le.hasOwnProperty("pruneBlankNodeIdentifiers")||(Le.pruneBlankNodeIdentifiers=$(Te,1.1));const Ve=yield _e.expand(Ye,Le),$e=ot({},Le);$e.isFrame=!0,$e.keepFreeFloatingNodes=!0;const Ne=yield _e.expand(Ue,$e),q=Object.keys(Ue).map(ue=>I(Te,ue,{vocab:!0}));$e.merged=!q.includes("@graph"),$e.is11=$(Te,1.1);const G=T(Ve,Ne,$e);$e.graph=!Le.omitGraph,$e.skipExpansion=!0,$e.link={},$e.framing=!0;let pe=yield _e.compact(G,Ke,$e);return $e.link={},pe=V(pe,$e),pe});return function(Ye,Ue,Le){return tt.apply(this,arguments)}}(),_e.link=function(){var tt=yt(function*(Ye,Ue,Le){const Ke={};return Ue&&(Ke["@context"]=Ue),Ke["@embed"]="@link",_e.frame(Ye,Ke,Le)});return function(Ye,Ue,Le){return tt.apply(this,arguments)}}(),_e.normalize=_e.canonize=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(Ue=Xe(Ue,{base:ce(Ye)?Ye:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new Q({sharedCache:st})}))){if("application/n-quads"!==Ue.inputFormat&&"application/nquads"!==Ue.inputFormat)throw new v("Unknown canonicalization input format.","jsonld.CanonizeError");const Te=O.parse(Ye);return W.canonize(Te,Ue)}const Le=ot({},Ue);delete Le.format,Le.produceGeneralizedRdf=!1;const Ke=yield _e.toRDF(Ye,Le);return W.canonize(Ke,Ue)});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.fromRDF=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");Ue=Xe(Ue,{format:ce(Ye)?"application/n-quads":void 0});const{format:Le}=Ue;let{rdfParser:Ke}=Ue;if(Le){if(Ke=Ke||Ie[Le],!Ke)throw new v("Unknown input format.","jsonld.UnknownFormat",{format:Le})}else Ke=()=>Ye;const Te=yield Ke(Ye);return y(Te,Ue)});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.toRDF=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let Le;Le=(Ue=Xe(Ue,{base:ce(Ye)?Ye:"",skipExpansion:!1,contextResolver:new Q({sharedCache:st})})).skipExpansion?Ye:yield _e.expand(Ye,Ue);const Ke=S(Le,Ue);if(Ue.format){if("application/n-quads"===Ue.format||"application/nquads"===Ue.format)return O.serialize(Ke);throw new v("Unknown output format.","jsonld.UnknownFormat",{format:Ue.format})}return Ke});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.createNodeMap=function(){var tt=yt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");Ue=Xe(Ue,{base:ce(Ye)?Ye:"",contextResolver:new Q({sharedCache:st})});const Le=yield _e.expand(Ye,Ue);return te(Le,Ue)});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.merge=function(){var tt=yt(function*(Ye,Ue,Le){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!R(Ye))throw new TypeError('Could not merge, "docs" must be an array.');Ue="function"==typeof Ue?null:Ue||null,Le=Xe(Le,{contextResolver:new Q({sharedCache:st})});const Ke=yield Promise.all(Ye.map(ue=>{const je=ot({},Le);return _e.expand(ue,je)}));let Te=!0;"mergeNodes"in Le&&(Te=Le.mergeNodes);const Ve=Le.issuer||new z("_:b"),$e={"@default":{}};for(let ue=0;ue<Ke.length;++ue){const je=P.relabelBlankNodes(Ke[ue],{issuer:new z("_:b"+ue+"-")}),_t=Te||0===ue?$e:{"@default":{}};if(oe(je,_t,"@default",Ve),_t!==$e)for(const pt in _t){const ve=_t[pt];if(!(pt in $e)){$e[pt]=ve;continue}const k=$e[pt];for(const N in ve)N in k||(k[N]=ve[N])}}const Ne=xe($e),q=[],G=Object.keys(Ne).sort();for(let ue=0;ue<G.length;++ue){const je=Ne[G[ue]];D(je)||q.push(je)}return null===Ue?q:(Le.graph=!0,Le.skipExpansion=!0,yield _e.compact(q,Ue,Le))});return function(Ye,Ue,Le){return tt.apply(this,arguments)}}(),Object.defineProperty(_e,"documentLoader",{get:()=>_e._documentLoader,set:tt=>_e._documentLoader=tt}),_e.documentLoader=function(){var tt=yt(function*(Ye){throw new v("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Ye})});return function(Ye){return tt.apply(this,arguments)}}(),_e.get=function(){var tt=yt(function*(Ye,Ue){let Le;Le="function"==typeof Ue.documentLoader?Ue.documentLoader:_e.documentLoader;const Ke=yield Le(Ye);try{if(!Ke.document)throw new v("No remote document found at the given URL.","jsonld.NullRemoteDocument");ce(Ke.document)&&(Ke.document=JSON.parse(Ke.document))}catch(Te){throw new v("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:Te,remoteDoc:Ke})}return Ke});return function(Ye,Ue){return tt.apply(this,arguments)}}(),_e.processContext=function(){var tt=yt(function*(Ye,Ue,Le){return Le=Xe(Le,{base:"",contextResolver:new Q({sharedCache:st})}),null===Ue?X(Le):(Ue=P.clone(Ue),K(Ue)&&"@context"in Ue||(Ue={"@context":Ue}),E({activeCtx:Ye,localCtx:Ue,options:Le}))});return function(Ye,Ue,Le){return tt.apply(this,arguments)}}(),_e.getContextValue=Y("./context").getContextValue,_e.documentLoaders={},_e.useDocumentLoader=function(tt){if(!(tt in _e.documentLoaders))throw new v('Unknown document loader type: "'+tt+'"',"jsonld.UnknownDocumentLoader",{type:tt});_e.documentLoader=_e.documentLoaders[tt].apply(_e,Array.prototype.slice.call(arguments,1))},_e.registerRDFParser=function(tt,Ye){Ie[tt]=Ye},_e.unregisterRDFParser=function(tt){delete Ie[tt]},_e.registerRDFParser("application/n-quads",O.parse),_e.registerRDFParser("application/nquads",O.parse),_e.url=Y("./url"),_e.util=P,Object.assign(_e,P),_e.promises=_e,_e.RequestQueue=Y("./RequestQueue"),_e.JsonLdProcessor=Y("./JsonLdProcessor")(_e),j.setupGlobals(_e),j.setupDocumentLoaders(_e),_e},ne=function(){return ge(function(){return ne()})};ge(ne),Se.exports=ne},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(Y,Se,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),P=Y("./types"),Q=Y("./util"),z=Y("./JsonLdError"),v={};Se.exports=v,v.createMergedNodeMap=(x,O)=>{const A=(O=O||{}).issuer||new Q.IdentifierIssuer("_:b"),b={"@default":{}};return v.createNodeMap(x,b,"@default",A),v.mergeNodeMaps(b)},v.createNodeMap=(x,O,A,b,y,S)=>{if(P.isArray(x)){for(const K of x)v.createNodeMap(K,O,A,b,void 0,S);return}if(!P.isObject(x))return void(S&&S.push(x));if(j.isValue(x)){if("@type"in x){let K=x["@type"];0===K.indexOf("_:")&&(x["@type"]=K=b.getId(K))}return void(S&&S.push(x))}if(S&&j.isList(x)){const K=[];return v.createNodeMap(x["@list"],O,A,b,y,K),void S.push({"@list":K})}if("@type"in x){const K=x["@type"];for(const ce of K)0===ce.indexOf("_:")&&b.getId(ce)}P.isUndefined(y)&&(y=j.isBlankNode(x)?b.getId(x["@id"]):x["@id"]),S&&S.push({"@id":y});const T=O[A],V=T[y]=T[y]||{};V["@id"]=y;const R=Object.keys(x).sort();for(let K of R){if("@id"===K)continue;if("@reverse"===K){const D={"@id":y},I=x["@reverse"];for(const X in I){const E=I[X];for(const $ of E){let Z=$["@id"];j.isBlankNode($)&&(Z=b.getId(Z)),v.createNodeMap($,O,A,b,Z),Q.addValue(T[Z],X,D,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===K){y in O||(O[y]={}),v.createNodeMap(x[K],O,y,b);continue}if("@included"===K){v.createNodeMap(x[K],O,A,b);continue}if("@type"!==K&&W(K)){if("@index"===K&&K in V&&(x[K]!==V[K]||x[K]["@id"]!==V[K]["@id"]))throw new z("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:V});V[K]=x[K];continue}const ce=x[K];if(0===K.indexOf("_:")&&(K=b.getId(K)),0!==ce.length)for(let D of ce)if("@type"===K&&(D=0===D.indexOf("_:")?b.getId(D):D),j.isSubject(D)||j.isSubjectReference(D)){if("@id"in D&&!D["@id"])continue;const I=j.isBlankNode(D)?b.getId(D["@id"]):D["@id"];Q.addValue(V,K,{"@id":I},{propertyIsArray:!0,allowDuplicate:!1}),v.createNodeMap(D,O,A,b,I)}else if(j.isValue(D))Q.addValue(V,K,D,{propertyIsArray:!0,allowDuplicate:!1});else if(j.isList(D)){const I=[];v.createNodeMap(D["@list"],O,A,b,y,I),D={"@list":I},Q.addValue(V,K,D,{propertyIsArray:!0,allowDuplicate:!1})}else v.createNodeMap(D,O,A,b,y),Q.addValue(V,K,D,{propertyIsArray:!0,allowDuplicate:!1});else Q.addValue(V,K,[],{propertyIsArray:!0})}},v.mergeNodeMapGraphs=x=>{const O={};for(const A of Object.keys(x).sort())for(const b of Object.keys(x[A]).sort()){const y=x[A][b];b in O||(O[b]={"@id":b});const S=O[b];for(const T of Object.keys(y).sort())if(W(T)&&"@type"!==T)S[T]=Q.clone(y[T]);else for(const V of y[T])Q.addValue(S,T,Q.clone(V),{propertyIsArray:!0,allowDuplicate:!1})}return O},v.mergeNodeMaps=x=>{const O=x["@default"],A=Object.keys(x).sort();for(const b of A){if("@default"===b)continue;const y=x[b];let S=O[b];S?"@graph"in S||(S["@graph"]=[]):O[b]=S={"@id":b,"@graph":[]};const T=S["@graph"];for(const V of Object.keys(y).sort()){const R=y[V];j.isSubjectReference(R)||T.push(R)}}return O}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(Y,Se,he){"use strict";const W=Y("./documentLoaders/xhr"),j={};Se.exports=j,j.setupDocumentLoaders=function(P){"undefined"!=typeof XMLHttpRequest&&(P.documentLoaders.xhr=W,P.useDocumentLoader("xhr"))},j.setupGlobals=function(P){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:P.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(Y,Se,he){"use strict";const{createNodeMap:W}=Y("./nodeMap"),{isKeyword:j}=Y("./context"),P=Y("./graphTypes"),Q=Y("canonicalize"),z=Y("./types"),v=Y("./util"),{RDF_FIRST:x,RDF_REST:O,RDF_NIL:A,RDF_TYPE:b,RDF_JSON_LITERAL:y,RDF_LANGSTRING:S,XSD_BOOLEAN:T,XSD_DOUBLE:V,XSD_INTEGER:R,XSD_STRING:K}=Y("./constants"),{isAbsolute:ce}=Y("./url"),D={};function I($,Z,se,oe,te){const xe=Object.keys(Z).sort();for(const ge of xe){const ne=Z[ge],_e=Object.keys(ne).sort();for(let Ie of _e){const Ge=ne[Ie];if("@type"===Ie)Ie=b;else if(j(Ie))continue;for(const st of Ge){const Xe={termType:ge.startsWith("_:")?"BlankNode":"NamedNode",value:ge};if(!ce(ge))continue;const tt={termType:Ie.startsWith("_:")?"BlankNode":"NamedNode",value:Ie};if(!ce(Ie)||"BlankNode"===tt.termType&&!te.produceGeneralizedRdf)continue;const Ye=E(st,oe,$,se,te.rdfDirection);Ye&&$.push({subject:Xe,predicate:tt,object:Ye,graph:se})}}}}function E($,Z,se,oe,te){const xe={};if(P.isValue($)){xe.termType="Literal",xe.value=void 0,xe.datatype={termType:"NamedNode"};let ge=$["@value"];const ne=$["@type"]||null;"@json"===ne?(xe.value=Q(ge),xe.datatype.value=y):z.isBoolean(ge)?(xe.value=ge.toString(),xe.datatype.value=ne||T):z.isDouble(ge)||ne===V?(z.isDouble(ge)||(ge=parseFloat(ge)),xe.value=ge.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),xe.datatype.value=ne||V):z.isNumber(ge)?(xe.value=ge.toFixed(0),xe.datatype.value=ne||R):"i18n-datatype"===te&&"@direction"in $?(xe.datatype.value="https://www.w3.org/ns/i18n#"+($["@language"]||"")+`_${$["@direction"]}`,xe.value=ge):"@language"in $?(xe.value=ge,xe.datatype.value=ne||S,xe.language=$["@language"]):(xe.value=ge,xe.datatype.value=ne||K)}else if(P.isList($)){const ge=function($,Z,se,oe,te){const xe={termType:"NamedNode",value:x},ge={termType:"NamedNode",value:O},ne={termType:"NamedNode",value:A},_e=$.pop(),Ie=_e?{termType:"BlankNode",value:Z.getId()}:ne;let Ge=Ie;for(const st of $){const Xe=E(st,Z,se,oe,te),tt={termType:"BlankNode",value:Z.getId()};se.push({subject:Ge,predicate:xe,object:Xe,graph:oe}),se.push({subject:Ge,predicate:ge,object:tt,graph:oe}),Ge=tt}if(_e){const st=E(_e,Z,se,oe,te);se.push({subject:Ge,predicate:xe,object:st,graph:oe}),se.push({subject:Ge,predicate:ge,object:ne,graph:oe})}return Ie}($["@list"],Z,se,oe,te);xe.termType=ge.termType,xe.value=ge.value}else{const ge=z.isObject($)?$["@id"]:$;xe.termType=ge.startsWith("_:")?"BlankNode":"NamedNode",xe.value=ge}return"NamedNode"!==xe.termType||ce(xe.value)?xe:null}Se.exports=D,D.toRDF=($,Z)=>{const se=new v.IdentifierIssuer("_:b"),oe={"@default":{}};W($,oe,"@default",se);const te=[],xe=Object.keys(oe).sort();for(const ge of xe){let ne;if("@default"===ge)ne={termType:"DefaultGraph",value:""};else{if(!ce(ge))continue;ne=ge.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},ne.value=ge}I(te,oe[ge],ne,se,Z)}return te}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(Y,Se,he){"use strict";const W={};Se.exports=W,W.isArray=Array.isArray,W.isBoolean=j=>"boolean"==typeof j||"[object Boolean]"===Object.prototype.toString.call(j),W.isDouble=j=>W.isNumber(j)&&(-1!==String(j).indexOf(".")||Math.abs(j)>=1e21),W.isEmptyObject=j=>W.isObject(j)&&0===Object.keys(j).length,W.isNumber=j=>"number"==typeof j||"[object Number]"===Object.prototype.toString.call(j),W.isNumeric=j=>!isNaN(parseFloat(j))&&isFinite(j),W.isObject=j=>"[object Object]"===Object.prototype.toString.call(j),W.isString=j=>"string"==typeof j||"[object String]"===Object.prototype.toString.call(j),W.isUndefined=j=>void 0===j},{}],31:[function(Y,Se,he){"use strict";const W=Y("./types"),j={};Se.exports=j,j.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},j.parse=(Q,z)=>{const v={},x=j.parsers[z||"full"],O=x.regex.exec(Q);let A=x.keys.length;for(;A--;)v[x.keys[A]]=void 0===O[A]?null:O[A];return("https"===v.scheme&&"443"===v.port||"http"===v.scheme&&"80"===v.port)&&(v.href=v.href.replace(":"+v.port,""),v.authority=v.authority.replace(":"+v.port,""),v.port=null),v.normalizedPath=j.removeDotSegments(v.path),v},j.prependBase=(Q,z)=>{if(null===Q||j.isAbsolute(z))return z;(!Q||W.isString(Q))&&(Q=j.parse(Q||""));const v=j.parse(z),x={protocol:Q.protocol||""};if(null!==v.authority)x.authority=v.authority,x.path=v.path,x.query=v.query;else if(x.authority=Q.authority,""===v.path)x.path=Q.path,x.query=null!==v.query?v.query:Q.query;else{if(0===v.path.indexOf("/"))x.path=v.path;else{let A=Q.path;A=A.substr(0,A.lastIndexOf("/")+1),(A.length>0||Q.authority)&&"/"!==A.substr(-1)&&(A+="/"),A+=v.path,x.path=A}x.query=v.query}""!==v.path&&(x.path=j.removeDotSegments(x.path));let O=x.protocol;return null!==x.authority&&(O+="//"+x.authority),O+=x.path,null!==x.query&&(O+="?"+x.query),null!==v.fragment&&(O+="#"+v.fragment),""===O&&(O="./"),O},j.removeBase=(Q,z)=>{if(null===Q)return z;(!Q||W.isString(Q))&&(Q=j.parse(Q||""));let v="";if(""!==Q.href?v+=(Q.protocol||"")+"//"+(Q.authority||""):z.indexOf("//")&&(v+="//"),0!==z.indexOf(v))return z;const x=j.parse(z.substr(v.length)),O=Q.normalizedPath.split("/"),A=x.normalizedPath.split("/"),b=x.fragment||x.query?0:1;for(;O.length>0&&A.length>b&&O[0]===A[0];)O.shift(),A.shift();let y="";if(O.length>0){O.pop();for(let S=0;S<O.length;++S)y+="../"}return y+=A.join("/"),null!==x.query&&(y+="?"+x.query),null!==x.fragment&&(y+="#"+x.fragment),""===y&&(y="./"),y},j.removeDotSegments=Q=>{if(0===Q.length)return"";const z=Q.split("/"),v=[];for(;z.length>0;){const x=z.shift(),O=0===z.length;"."!==x?".."!==x?v.push(x):(v.pop(),O&&v.push("")):O&&v.push("")}return"/"===Q[0]&&v.length>0&&""!==v[0]&&v.unshift(""),1===v.length&&""===v[0]?"/":v.join("/")};const P=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;j.isAbsolute=Q=>W.isString(Q)&&P.test(Q),j.isRelative=Q=>W.isString(Q)},{"./types":30}],32:[function(Y,Se,he){"use strict";const W=Y("./graphTypes"),j=Y("./types"),P=Y("rdf-canonize").IdentifierIssuer,Q=Y("./JsonLdError"),z=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,v=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,x=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,O_headers={accept:"application/ld+json, application/json"},A={};function b(y,S){if(j.isArray(S))for(let T=0;T<S.length;++T)S[T]=b(y,S[T]);else if(W.isList(S))S["@list"]=b(y,S["@list"]);else if(j.isObject(S)){W.isBlankNode(S)&&(S["@id"]=y.getId(S["@id"]));const T=Object.keys(S).sort();for(let V=0;V<T.length;++V){const R=T[V];"@id"!==R&&(S[R]=b(y,S[R]))}}return S}Se.exports=A,A.IdentifierIssuer=P,A.clone=function(y){if(y&&"object"==typeof y){let S;if(j.isArray(y)){S=[];for(let T=0;T<y.length;++T)S[T]=A.clone(y[T])}else if(y instanceof Map){S=new Map;for(const[T,V]of y)S.set(T,A.clone(V))}else if(y instanceof Set){S=new Set;for(const T of y)S.add(A.clone(T))}else if(j.isObject(y)){S={};for(const T in y)S[T]=A.clone(y[T])}else S=y.toString();return S}return y},A.asArray=function(y){return Array.isArray(y)?y:[y]},A.buildHeaders=(y={})=>{if(Object.keys(y).some(T=>"accept"===T.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+O_headers.accept+'" is supported.');return Object.assign({Accept:O_headers.accept},y)},A.parseLinkHeader=y=>{const S={},T=y.match(z);for(let V=0;V<T.length;++V){let R=T[V].match(v);if(!R)continue;const K={target:R[1]},ce=R[2];for(;R=x.exec(ce);)K[R[1]]=void 0===R[2]?R[3]:R[2];const D=K.rel||"";Array.isArray(S[D])?S[D].push(K):S[D]=S.hasOwnProperty(D)?[S[D],K]:K}return S},A.validateTypeValue=(y,S)=>{if(!(j.isString(y)||j.isArray(y)&&y.every(T=>j.isString(T)))){if(S&&j.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&A.asArray(y["@default"]).every(T=>j.isString(T)))return}throw new Q('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},A.hasProperty=(y,S)=>{if(y.hasOwnProperty(S)){const T=y[S];return!j.isArray(T)||T.length>0}return!1},A.hasValue=(y,S,T)=>{if(A.hasProperty(y,S)){let V=y[S];const R=W.isList(V);if(j.isArray(V)||R){R&&(V=V["@list"]);for(let K=0;K<V.length;++K)if(A.compareValues(T,V[K]))return!0}else if(!j.isArray(T))return A.compareValues(T,V)}return!1},A.addValue=(y,S,T,V)=>{if("propertyIsArray"in(V=V||{})||(V.propertyIsArray=!1),"valueIsArray"in V||(V.valueIsArray=!1),"allowDuplicate"in V||(V.allowDuplicate=!0),"prependValue"in V||(V.prependValue=!1),V.valueIsArray)y[S]=T;else if(j.isArray(T)){0===T.length&&V.propertyIsArray&&!y.hasOwnProperty(S)&&(y[S]=[]),V.prependValue&&(T=T.concat(y[S]),y[S]=[]);for(let R=0;R<T.length;++R)A.addValue(y,S,T[R],V)}else if(y.hasOwnProperty(S)){const R=!V.allowDuplicate&&A.hasValue(y,S,T);!j.isArray(y[S])&&(!R||V.propertyIsArray)&&(y[S]=[y[S]]),R||(V.prependValue?y[S].unshift(T):y[S].push(T))}else y[S]=V.propertyIsArray?[T]:T},A.getValues=(y,S)=>[].concat(y[S]||[]),A.removeProperty=(y,S)=>{delete y[S]},A.removeValue=(y,S,T,V)=>{"propertyIsArray"in(V=V||{})||(V.propertyIsArray=!1);const R=A.getValues(y,S).filter(K=>!A.compareValues(K,T));0===R.length?A.removeProperty(y,S):y[S]=1!==R.length||V.propertyIsArray?R:R[0]},A.relabelBlankNodes=(y,S)=>b((S=S||{}).issuer||new P("_:b"),y),A.compareValues=(y,S)=>!!(y===S||W.isValue(y)&&W.isValue(S)&&y["@value"]===S["@value"]&&y["@type"]===S["@type"]&&y["@language"]===S["@language"]&&y["@index"]===S["@index"])||!!(j.isObject(y)&&"@id"in y&&j.isObject(S)&&"@id"in S)&&y["@id"]===S["@id"],A.compareShortestLeast=(y,S)=>y.length<S.length?-1:S.length<y.length?1:y===S?0:y<S?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(Y,Se,he){"use strict";const W=Y("yallist"),j=Symbol("max"),P=Symbol("length"),Q=Symbol("lengthCalculator"),z=Symbol("allowStale"),v=Symbol("maxAge"),x=Symbol("dispose"),O=Symbol("noDisposeOnSet"),A=Symbol("lruList"),b=Symbol("cache"),y=Symbol("updateAgeOnGet"),S=()=>1;const V=(X,E,$)=>{const Z=X[b].get(E);if(Z){const se=Z.value;if(R(X,se)){if(ce(X,Z),!X[z])return}else $&&(X[y]&&(Z.value.now=Date.now()),X[A].unshiftNode(Z));return se.value}},R=(X,E)=>{if(!E||!E.maxAge&&!X[v])return!1;const $=Date.now()-E.now;return E.maxAge?$>E.maxAge:X[v]&&$>X[v]},K=X=>{if(X[P]>X[j])for(let E=X[A].tail;X[P]>X[j]&&null!==E;){const $=E.prev;ce(X,E),E=$}},ce=(X,E)=>{if(E){const $=E.value;X[x]&&X[x]($.key,$.value),X[P]-=$.length,X[b].delete($.key),X[A].removeNode(E)}};class D{constructor(E,$,Z,se,oe){this.key=E,this.value=$,this.length=Z,this.now=se,this.maxAge=oe||0}}const I=(X,E,$,Z)=>{let se=$.value;R(X,se)&&(ce(X,$),X[z]||(se=void 0)),se&&E.call(Z,se.value,se.key,X)};Se.exports=class{constructor(E){if("number"==typeof E&&(E={max:E}),E||(E={}),E.max&&("number"!=typeof E.max||E.max<0))throw new TypeError("max must be a non-negative number");this[j]=E.max||1/0;const Z=E.length||S;if(this[Q]="function"!=typeof Z?S:Z,this[z]=E.stale||!1,E.maxAge&&"number"!=typeof E.maxAge)throw new TypeError("maxAge must be a number");this[v]=E.maxAge||0,this[x]=E.dispose,this[O]=E.noDisposeOnSet||!1,this[y]=E.updateAgeOnGet||!1,this.reset()}set max(E){if("number"!=typeof E||E<0)throw new TypeError("max must be a non-negative number");this[j]=E||1/0,K(this)}get max(){return this[j]}set allowStale(E){this[z]=!!E}get allowStale(){return this[z]}set maxAge(E){if("number"!=typeof E)throw new TypeError("maxAge must be a non-negative number");this[v]=E,K(this)}get maxAge(){return this[v]}set lengthCalculator(E){"function"!=typeof E&&(E=S),E!==this[Q]&&(this[Q]=E,this[P]=0,this[A].forEach($=>{$.length=this[Q]($.value,$.key),this[P]+=$.length})),K(this)}get lengthCalculator(){return this[Q]}get length(){return this[P]}get itemCount(){return this[A].length}rforEach(E,$){$=$||this;for(let Z=this[A].tail;null!==Z;){const se=Z.prev;I(this,E,Z,$),Z=se}}forEach(E,$){$=$||this;for(let Z=this[A].head;null!==Z;){const se=Z.next;I(this,E,Z,$),Z=se}}keys(){return this[A].toArray().map(E=>E.key)}values(){return this[A].toArray().map(E=>E.value)}reset(){this[x]&&this[A]&&this[A].length&&this[A].forEach(E=>this[x](E.key,E.value)),this[b]=new Map,this[A]=new W,this[P]=0}dump(){return this[A].map(E=>!R(this,E)&&{k:E.key,v:E.value,e:E.now+(E.maxAge||0)}).toArray().filter(E=>E)}dumpLru(){return this[A]}set(E,$,Z){if((Z=Z||this[v])&&"number"!=typeof Z)throw new TypeError("maxAge must be a number");const se=Z?Date.now():0,oe=this[Q]($,E);if(this[b].has(E)){if(oe>this[j])return ce(this,this[b].get(E)),!1;const ge=this[b].get(E).value;return this[x]&&(this[O]||this[x](E,ge.value)),ge.now=se,ge.maxAge=Z,ge.value=$,this[P]+=oe-ge.length,ge.length=oe,this.get(E),K(this),!0}const te=new D(E,$,oe,se,Z);return te.length>this[j]?(this[x]&&this[x](E,$),!1):(this[P]+=te.length,this[A].unshift(te),this[b].set(E,this[A].head),K(this),!0)}has(E){if(!this[b].has(E))return!1;const $=this[b].get(E).value;return!R(this,$)}get(E){return V(this,E,!0)}peek(E){return V(this,E,!1)}pop(){const E=this[A].tail;return E?(ce(this,E),E.value):null}del(E){ce(this,this[b].get(E))}load(E){this.reset();const $=Date.now();for(let Z=E.length-1;Z>=0;Z--){const se=E[Z],oe=se.e||0;if(0===oe)this.set(se.k,se.v);else{const te=oe-$;te>0&&this.set(se.k,se.v,te)}}}prune(){this[b].forEach((E,$)=>V(this,$,!1))}}},{yallist:92}],34:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#",P="http://www.w3.org/2000/10/swap/";he.default={xsd:{decimal:`${j}decimal`,boolean:`${j}boolean`,double:`${j}double`,integer:`${j}integer`,string:`${j}string`},rdf:{type:`${W}type`,nil:`${W}nil`,first:`${W}first`,rest:`${W}rest`,langString:`${W}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${P}reify#forSome`,forAll:`${P}reify#forAll`},log:{implies:`${P}log#implies`}}},{}],35:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=he.Variable=he.Triple=he.Term=he.Quad=he.NamedNode=he.Literal=he.DefaultGraph=he.BlankNode=void 0,he.escapeQuotes=E,he.termFromId=function D(ne,_e){if(_e=_e||b,!ne)return _e.defaultGraph();switch(ne[0]){case"?":return _e.variable(ne.substr(1));case"_":return _e.blankNode(ne.substr(2));case'"':if(_e===b)return new V(ne);if('"'===ne[ne.length-1])return _e.literal(ne.substr(1,ne.length-2));const Ie=ne.lastIndexOf('"',ne.length-1);return _e.literal(ne.substr(1,Ie-1),"@"===ne[Ie+1]?ne.substr(Ie+2):_e.namedNode(ne.substr(Ie+3)));case"<":const Ge=A.exec(ne);return _e.quad(D($(Ge[1]),_e),D($(Ge[2]),_e),D($(Ge[3]),_e),Ge[4]&&D($(Ge[4]),_e));default:return _e.namedNode(ne)}},he.termToId=function I(ne){if("string"==typeof ne)return ne;if(ne instanceof S&&"Quad"!==ne.termType)return ne.id;if(!ne)return v.id;switch(ne.termType){case"NamedNode":return ne.value;case"BlankNode":return`_:${ne.value}`;case"Variable":return`?${ne.value}`;case"DefaultGraph":return"";case"Literal":return`"${ne.value}"${ne.language?`@${ne.language}`:ne.datatype&&ne.datatype.value!==z.string?`^^${ne.datatype.value}`:""}`;case"Quad":return`<<${E(I(ne.subject))} ${E(I(ne.predicate))} ${E(I(ne.object))}${(0,j.isDefaultGraph)(ne.graph)?"":` ${I(ne.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${ne.termType}`)}},he.unescapeQuotes=$;var ne,W=(ne=Y("./IRIs"))&&ne.__esModule?ne:{default:ne},j=Y("./N3Util");const{rdf:Q,xsd:z}=W.default;let v,x=0;const O=/^"(.*".*)(?="[^"]*$)/,A=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,b={namedNode:function(ne){return new T(ne)},blankNode:function(ne){return new R(ne||"n3-"+x++)},variable:function(ne){return new K(ne)},literal:function(ne,_e){if("string"==typeof _e)return new V(`"${ne}"@${_e.toLowerCase()}`);let Ie=_e?_e.value:"";return""===Ie&&("boolean"==typeof ne?Ie=z.boolean:"number"==typeof ne&&(Number.isFinite(ne)?Ie=Number.isInteger(ne)?z.integer:z.double:(Ie=z.double,Number.isNaN(ne)||(ne=ne>0?"INF":"-INF")))),new V(""===Ie||Ie===z.string?`"${ne}"`:`"${ne}"^^${Ie}`)},defaultGraph:function(){return v},quad:ge,triple:ge};he.default=b;class S{constructor(_e){this.id=_e}get value(){return this.id}equals(_e){return _e instanceof S?this.id===_e.id:!!_e&&this.termType===_e.termType&&this.value===_e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}he.Term=S;class T extends S{get termType(){return"NamedNode"}}he.NamedNode=T;class V extends S{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const _e=this.id;let Ie=_e.lastIndexOf('"')+1;return Ie<_e.length&&"@"===_e[Ie++]?_e.substr(Ie).toLowerCase():""}get datatype(){return new T(this.datatypeString)}get datatypeString(){const _e=this.id,Ie=_e.lastIndexOf('"')+1,Ge=Ie<_e.length?_e[Ie]:"";return"^"===Ge?_e.substr(Ie+2):"@"!==Ge?z.string:Q.langString}equals(_e){return _e instanceof V?this.id===_e.id:!!_e&&!!_e.datatype&&this.termType===_e.termType&&this.value===_e.value&&this.language===_e.language&&this.datatype.value===_e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}he.Literal=V;class R extends S{constructor(_e){super(`_:${_e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}he.BlankNode=R;class K extends S{constructor(_e){super(`?${_e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}he.Variable=K;class ce extends S{constructor(){return super(""),v||this}get termType(){return"DefaultGraph"}equals(_e){return this===_e||!!_e&&this.termType===_e.termType}}he.DefaultGraph=ce,v=new ce;class X extends S{constructor(_e,Ie,Ge,st){super(""),this._subject=_e,this._predicate=Ie,this._object=Ge,this._graph=st||v}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(_e){return!!_e&&this._subject.equals(_e.subject)&&this._predicate.equals(_e.predicate)&&this._object.equals(_e.object)&&this._graph.equals(_e.graph)}}function E(ne){return ne.replace(O,(_e,Ie)=>`"${Ie.replace(/"/g,'""')}`)}function $(ne){return ne.replace(O,(_e,Ie)=>`"${Ie.replace(/""/g,'"')}`)}function ge(ne,_e,Ie,Ge){return new X(ne,_e,Ie,Ge)}he.Triple=he.Quad=X},{"./IRIs":34,"./N3Util":41}],36:[function(Y,Se,he){(function(W){(function(){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var j=Q(Y("./IRIs")),P=Q(Y("queue-microtask"));function Q(S){return S&&S.__esModule?S:{default:S}}const{xsd:z}=j.default,v=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,x={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},O=/[\x00-\x20<>\\"\{\}\|\^\`]/,A={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},b=/$0^/;he.default=class{constructor(T){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(T=T||{}).lineMode){this._n3Mode=!1;for(const V in this)!(V in A)&&this[V]instanceof RegExp&&(this[V]=b)}else this._n3Mode=!1!==T.n3;this._comments=!!T.comments,this._literalClosingPos=0}_tokenizeToEnd(T,V){let R=this._input,K=R.length;for(;;){let I,X;for(;I=this._newline.exec(R);)this._comments&&(X=this._comment.exec(I[0]))&&ce("comment",X[1],"",this._line,I[0].length),R=R.substr(I[0].length,R.length),K=R.length,this._line++;if(!I&&(I=this._whitespace.exec(R))&&(R=R.substr(I[0].length,R.length)),this._endOfFile.test(R))return V&&(this._comments&&(X=this._comment.exec(R))&&ce("comment",X[1],"",this._line,R.length),R=null,ce("eof","","",this._line,0)),this._input=R;const E=this._line,$=R[0];let Z="",se="",oe="",te=null,xe=0,ge=!1;switch($){case"^":if(R.length<3)break;if("^"!==R[1]){this._n3Mode&&(xe=1,Z="^");break}if(this._previousMarker="^^",R=R.substr(2),"<"!==R[0]){ge=!0;break}case"<":if(te=this._unescapedIri.exec(R))Z="IRI",se=te[1];else if(te=this._iri.exec(R)){if(se=this._unescape(te[1]),null===se||O.test(se))return D(this);Z="IRI"}else R.length>1&&"<"===R[1]?(Z="<<",xe=2):this._n3Mode&&R.length>1&&"="===R[1]&&(Z="inverse",xe=2,se=">");break;case">":R.length>1&&">"===R[1]&&(Z=">>",xe=2);break;case"_":((te=this._blank.exec(R))||V&&(te=this._blank.exec(`${R} `)))&&(Z="blank",oe="_",se=te[1]);break;case'"':if(te=this._simpleQuotedString.exec(R))se=te[1];else if(({value:se,matchLength:xe}=this._parseLiteral(R)),null===se)return D(this);(null!==te||0!==xe)&&(Z="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(te=this._simpleApostropheString.exec(R))se=te[1];else if(({value:se,matchLength:xe}=this._parseLiteral(R)),null===se)return D(this);(null!==te||0!==xe)&&(Z="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(te=this._variable.exec(R))&&(Z="var",se=te[0]);break;case"@":"literal"===this._previousMarker&&(te=this._langcode.exec(R))?(Z="langcode",se=te[1]):(te=this._keyword.exec(R))&&(Z=te[0]);break;case".":if(1===R.length?V:R[1]<"0"||R[1]>"9"){Z=".",xe=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(te=this._number.exec(R)||V&&(te=this._number.exec(`${R} `)))&&(Z="literal",se=te[0],oe="string"==typeof te[1]?z.double:"string"==typeof te[2]?z.decimal:z.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(te=this._sparqlKeyword.exec(R))?Z=te[0].toUpperCase():ge=!0;break;case"f":case"t":(te=this._boolean.exec(R))?(Z="literal",se=te[0],oe=z.boolean):ge=!0;break;case"a":(te=this._shortPredicates.exec(R))?(Z="abbreviation",se="a"):ge=!0;break;case"=":this._n3Mode&&R.length>1&&(Z="abbreviation",">"!==R[1]?(xe=1,se="="):(xe=2,se=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(xe=1,Z=$);break;default:ge=!0}if(ge&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(te=this._prefix.exec(R))?((te=this._prefixed.exec(R))||V&&(te=this._prefixed.exec(`${R} `)))&&(Z="prefixed",oe=te[1]||"",se=this._unescape(te[2])):(Z="prefix",se=te[1]||"")),"^^"===this._previousMarker)switch(Z){case"prefixed":Z="type";break;case"IRI":Z="typeIRI";break;default:Z=""}if(!Z)return V||!/^'''|^"""/.test(R)&&/\n|\r/.test(R)?D(this):this._input=R;const ne=xe||te[0].length,_e=ce(Z,se,oe,E,ne);this.previousToken=_e,this._previousMarker=Z,R=R.substr(ne,R.length)}function ce(I,X,E,$,Z){const se=R?K-R.length:K,te={type:I,value:X,prefix:E,line:$,start:se,end:se+Z};return T(null,te),te}function D(I){T(I._syntaxError(/^\S*/.exec(R)[0]))}}_unescape(T){let V=!1;const R=T.replace(v,(K,ce,D,I)=>{if("string"==typeof ce)return String.fromCharCode(Number.parseInt(ce,16));if("string"==typeof D){let X=Number.parseInt(D,16);return X<=65535?String.fromCharCode(Number.parseInt(D,16)):String.fromCharCode(55296+((X-=65536)>>10),56320+(1023&X))}return I in x?x[I]:(V=!0,"")});return V?null:R}_parseLiteral(T){if(T.length>=3){const V=T.match(/^(?:"""|"|'''|'|)/)[0],R=V.length;let K=Math.max(this._literalClosingPos,R);for(;(K=T.indexOf(V,K))>0;){let ce=0;for(;"\\"===T[K-ce-1];)ce++;if(ce%2==0){const D=T.substring(R,K),I=D.split(/\r\n|\r|\n/).length-1,X=K+R;if(1===R&&0!==I||3===R&&this._lineMode)break;return this._line+=I,{value:this._unescape(D),matchLength:X}}K++}this._literalClosingPos=T.length-R+1}return{value:"",matchLength:0}}_syntaxError(T){this._input=null;const V=new Error(`Unexpected "${T}" on line ${this._line}.`);return V.context={token:void 0,line:this._line,previousToken:this.previousToken},V}_readStartingBom(T){return T.startsWith("\ufeff")?T.substr(1):T}tokenize(T,V){if(this._line=1,"string"==typeof T){if(this._input=this._readStartingBom(T),"function"!=typeof V){const R=[];let K;if(this._tokenizeToEnd((ce,D)=>ce?K=ce:R.push(D),!0),K)throw K;return R}(0,P.default)(()=>this._tokenizeToEnd(V,!0))}else this._pendingBuffer=null,"function"==typeof T.setEncoding&&T.setEncoding("utf8"),T.on("data",R=>{null!==this._input&&0!==R.length&&(this._pendingBuffer&&(R=W.concat([this._pendingBuffer,R]),this._pendingBuffer=null),128&R[R.length-1]?this._pendingBuffer=R:(void 0===this._input?this._input=this._readStartingBom("string"==typeof R?R:R.toString()):this._input+=R,this._tokenizeToEnd(V,!1)))}),T.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(V,!0)}),T.on("error",V)}}}).call(this)}).call(this,Y("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var W=Q(Y("./N3Lexer")),j=Q(Y("./N3DataFactory")),P=Q(Y("./IRIs"));function Q(A){return A&&A.__esModule?A:{default:A}}let z=0;class v{constructor(b){this._contextStack=[],this._graph=null,this._setBase((b=b||{}).baseIRI),b.factory&&O(this,b.factory);const y="string"==typeof b.format?b.format.match(/\w*$/)[0].toLowerCase():"",S=/turtle/.test(y),T=/trig/.test(y),V=/triple/.test(y),R=/quad/.test(y),K=this._n3Mode=/n3/.test(y),ce=V||R;(this._supportsNamedGraphs=!(S||K))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(S||T||V||K),this._supportsRDFStar=""===y||/star|\*$/.test(y),ce&&(this._resolveRelativeIRI=D=>null),this._blankNodePrefix="string"!=typeof b.blankNodePrefix?"":b.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=b.lexer||new W.default({lineMode:ce,n3:K}),this._explicitQuantifiers=!!b.explicitQuantifiers}static _resetBlankNodePrefix(){z=0}_setBase(b){if(b){const y=b.indexOf("#");y>=0&&(b=b.substr(0,y)),this._base=b,this._basePath=b.indexOf("/")<0?b:b.replace(/[^\/?]*(?:\?.*)?$/,""),b=b.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=b[0],this._baseScheme=b[1]}else this._base="",this._basePath=""}_saveContext(b,y,S,T,V){const R=this._n3Mode;this._contextStack.push({subject:S,predicate:T,object:V,graph:y,type:b,inverse:!!R&&this._inversePredicate,blankPrefix:R?this._prefixes._:"",quantified:R?this._quantified:null}),R&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const b=this._contextStack.pop(),y=this._n3Mode;this._subject=b.subject,this._predicate=b.predicate,this._object=b.object,this._graph=b.graph,y&&(this._inversePredicate=b.inverse,this._prefixes._=b.blankPrefix,this._quantified=b.quantified)}_readInTopContext(b){switch(b.type){case"eof":return null!==this._graph?this._error("Unclosed graph",b):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(b)}}_readEntity(b,y){let S;switch(b.type){case"IRI":case"typeIRI":const T=this._resolveIRI(b.value);if(null===T)return this._error("Invalid IRI",b);S=this._namedNode(T);break;case"type":case"prefixed":const V=this._prefixes[b.prefix];if(void 0===V)return this._error(`Undefined prefix "${b.prefix}:"`,b);S=this._namedNode(V+b.value);break;case"blank":S=this._blankNode(this._prefixes[b.prefix]+b.value);break;case"var":S=this._variable(b.value.substr(1));break;default:return this._error(`Expected entity but got ${b.type}`,b)}return!y&&this._n3Mode&&S.id in this._quantified&&(S=this._quantified[S.id]),S}_readSubject(b){switch(this._predicate=null,b.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",b);case"}":return this._readPunctuation(b);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',b);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',b);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",b);if(0===b.prefix.length)return this._literalValue=b.value,this._completeSubjectLiteral;this._subject=this._literal(b.value,this._namedNode(b.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",b);default:if(void 0===(this._subject=this._readEntity(b)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(b){const y=b.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[b.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,b):(this._subject=null,"]"===y?this._readBlankNodeTail(b):this._readPunctuation(b));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",b);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",b);default:if(void 0===(this._predicate=this._readEntity(b)))return}return this._readObject}_readObject(b){switch(b.type){case"literal":if(0===b.prefix.length)return this._literalValue=b.value,this._readDataTypeOrLang;this._object=this._literal(b.value,this._namedNode(b.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",b);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",b);default:if(void 0===(this._object=this._readEntity(b)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(b){return"{"===b.type?this._readGraph(b):this._readPredicate(b)}_readGraph(b){return"{"!==b.type?this._error(`Expected graph but got ${b.type}`,b):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(b){return"]"===b.type?(this._subject=null,this._readBlankNodeTail(b)):(this._predicate=null,this._readPredicate(b))}_readBlankNodeTail(b){if("]"!==b.type)return this._readBlankNodePunctuation(b);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(b){switch(b.type){case".":case"}":return this._subject=null,this._readPunctuation(b);default:return this._readPredicate(b)}}_readListItem(b){let y=null,S=null,T=this._readListItem;const V=this._subject,R=this._contextStack,K=R[R.length-1];switch(b.type){case"[":this._saveContext("blank",this._graph,S=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),T=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,S=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==R.length&&"list"===R[R.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(T=this._readPredicate,this._subject===this.RDF_NIL)return T}else if(T=this._getContextEndReader(),this._object===this.RDF_NIL)return T;S=this.RDF_NIL;break;case"literal":0===b.prefix.length?(this._literalValue=b.value,T=this._readListItemDataTypeOrLang):(y=this._literal(b.value,this._namedNode(b.prefix)),T=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",b);default:if(void 0===(y=this._readEntity(b)))return}if(null===S&&(this._subject=S=this._blankNode()),null===V?null===K.predicate?K.subject=S:K.object=S:this._emit(V,this.RDF_REST,S,this._graph),null!==y){if(this._n3Mode&&("IRI"===b.type||"prefixed"===b.type))return this._saveContext("item",this._graph,S,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(S,this.RDF_FIRST,y,this._graph)}return T}_readDataTypeOrLang(b){return this._completeObjectLiteral(b,!1)}_readListItemDataTypeOrLang(b){return this._completeObjectLiteral(b,!0)}_completeLiteral(b){let y=this._literal(this._literalValue);switch(b.type){case"type":case"typeIRI":const S=this._readEntity(b);if(void 0===S)return;y=this._literal(this._literalValue,S),b=null;break;case"langcode":y=this._literal(this._literalValue,b.value),b=null}return{token:b,literal:y}}_completeSubjectLiteral(b){return this._subject=this._completeLiteral(b).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(b,y){const S=this._completeLiteral(b);if(S)return this._object=S.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===S.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(S.token))}_readFormulaTail(b){return"}"!==b.type?this._readPunctuation(b):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(b){let y,S=this._graph;const T=this._subject,V=this._inversePredicate;switch(b.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",b);if(this._n3Mode)return this._readFormulaTail(b);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,V&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(S=this._readEntity(b))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,b)}if(null!==T){const R=this._predicate,K=this._object;V?this._emit(K,R,T,S):this._emit(T,R,K,S)}return y}_readBlankNodePunctuation(b){let y;switch(b.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,b)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(b){return"."!==b.type?this._error("Expected dot to follow quad",b):this._readInTopContext}_readPrefix(b){return"prefix"!==b.type?this._error("Expected prefix to follow @prefix",b):(this._prefix=b.value,this._readPrefixIRI)}_readPrefixIRI(b){if("IRI"!==b.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,b);const y=this._readEntity(b);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(b){const y="IRI"===b.type&&this._resolveIRI(b.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",b)}_readNamedGraphLabel(b){switch(b.type){case"IRI":case"blank":case"prefixed":return this._readSubject(b),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",b)}}_readNamedGraphBlankLabel(b){return"]"!==b.type?this._error("Invalid graph label",b):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(b){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(b)):"."!==b.type?this._error("Expected declaration to end with a dot",b):this._readInTopContext}_readQuantifierList(b){let y;switch(b.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(b,!0)))break;default:return this._error(`Unexpected ${b.type}`,b)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(b){return","===b.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(b))}_getPathReader(b){return this._afterPath=b,this._readPath}_readPath(b){switch(b.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,S=y.length&&y[y.length-1];if(S&&"item"===S.type){const T=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,T,this._graph)}return this._afterPath(b)}}_readForwardPath(b){let y,S;const T=this._blankNode();if(void 0!==(S=this._readEntity(b)))return null===this._predicate?(y=this._subject,this._subject=T):(y=this._object,this._object=T),this._emit(y,S,T,this._graph),this._readPath}_readBackwardPath(b){const y=this._blankNode();let S,T;if(void 0!==(S=this._readEntity(b)))return null===this._predicate?(T=this._subject,this._subject=y):(T=this._object,this._object=y),this._emit(y,S,T,this._graph),this._readPath}_readRDFStarTailOrGraph(b){return">>"!==b.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(b))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,b):this._readRDFStarTail(b)}_readRDFStarTail(b){if(">>"!==b.type)return this._error(`Expected >> but got ${b.type}`,b);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const b=this._contextStack;if(!b.length)return this._readPunctuation;switch(b[b.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(b,y,S,T){this._callback(null,this._quad(b,y,S,T||this.DEFAULTGRAPH))}_error(b,y){const S=new Error(`${b} on line ${y.line}.`);S.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(S),this._callback=x}_resolveIRI(b){return/^[a-z][a-z0-9+.-]*:/i.test(b)?b:this._resolveRelativeIRI(b)}_resolveRelativeIRI(b){if(!b.length)return this._base;switch(b[0]){case"#":return this._base+b;case"?":return this._base.replace(/(?:\?.*)?$/,b);case"/":return("/"===b[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(b);default:return/^[^/:]*:/.test(b)?null:this._removeDotSegments(this._basePath+b)}}_removeDotSegments(b){if(!/(^|\/)\.\.?($|[/#?])/.test(b))return b;const y=b.length;let S="",T=-1,V=-1,R=0,K="/";for(;T<y;){switch(K){case":":if(V<0&&"/"===b[++T]&&"/"===b[++T])for(;(V=T+1)<y&&"/"!==b[V];)T=V;break;case"?":case"#":T=y;break;case"/":if("."===b[T+1])switch(K=b[1+ ++T],K){case"/":S+=b.substring(R,T-1),R=T+1;break;case void 0:case"?":case"#":return S+b.substring(R,T)+b.substr(T+1);case".":if(K=b[1+ ++T],void 0===K||"/"===K||"?"===K||"#"===K){if(S+=b.substring(R,T-2),(R=S.lastIndexOf("/"))>=V&&(S=S.substr(0,R)),"/"!==K)return`${S}/${b.substr(T+1)}`;R=T+1}}}K=b[++T]}return S+b.substring(R)}parse(b,y,S){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${z++}_`,this._prefixCallback=S||x,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const T=[];let V;if(this._callback=(R,K)=>{R?V=R:K&&T.push(K)},this._lexer.tokenize(b).every(R=>this._readCallback=this._readCallback(R)),V)throw V;return T}this._callback=y,this._lexer.tokenize(b,(T,V)=>{null!==T?(this._callback(T),this._callback=x):this._readCallback&&(this._readCallback=this._readCallback(V))})}}function x(){}function O(A,b){const y=b.namedNode;A._namedNode=y,A._blankNode=b.blankNode,A._literal=b.literal,A._variable=b.variable,A._quad=b.quad,A.DEFAULTGRAPH=b.defaultGraph(),A.RDF_FIRST=y(P.default.rdf.first),A.RDF_REST=y(P.default.rdf.rest),A.RDF_NIL=y(P.default.rdf.nil),A.N3_FORALL=y(P.default.r.forAll),A.N3_FORSOME=y(P.default.r.forSome),A.ABBREVIATIONS={a:y(P.default.rdf.type),"=":y(P.default.owl.sameAs),">":y(P.default.log.implies)},A.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}he.default=v,O(v.prototype,j.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var b,W=function(b,y){if(!y&&b&&b.__esModule)return b;if(null===b||"object"!=typeof b&&"function"!=typeof b)return{default:b};var S=z(y);if(S&&S.has(b))return S.get(b);var T={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in b)if("default"!==R&&Object.prototype.hasOwnProperty.call(b,R)){var K=V?Object.getOwnPropertyDescriptor(b,R):null;K&&(K.get||K.set)?Object.defineProperty(T,R,K):T[R]=b[R]}return T.default=b,S&&S.set(b,T),T}(Y("./N3DataFactory")),j=Y("readable-stream"),P=(b=Y("./IRIs"))&&b.__esModule?b:{default:b};function z(b){if("function"!=typeof WeakMap)return null;var y=new WeakMap,S=new WeakMap;return(z=function(T){return T?S:y})(b)}class x{constructor(y,S){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!S&&y&&!y[0]&&(S=y,y=null),this._factory=(S=S||{}).factory||W.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const S=this._graphs;let T,V;for(const R in S)for(const K in T=S[R].subjects)for(const ce in V=T[K])y+=Object.keys(V[ce]).length;return this._size=y}_addToIndex(y,S,T,V){const R=y[S]||(y[S]={}),K=R[T]||(R[T]={}),ce=V in K;return ce||(K[V]=null),!ce}_removeFromIndex(y,S,T,V){const R=y[S],K=R[T];delete K[V];for(const ce in K)return;delete R[T];for(const ce in R)return;delete y[S]}*_findInIndex(y,S,T,V,R,K,ce,D){let I,X,E;const Z=!S+!T+!V>1?Object.keys(this._ids):this._entities,se=(0,W.termFromId)(D,this._factory);S&&((I=y,y={})[S]=I[S]);for(const oe in y){const te=Z[oe];if(X=y[oe]){T&&((I=X,X={})[T]=I[T]);for(const xe in X){const ge=Z[xe];if(E=X[xe]){const ne=V?V in E?[V]:[]:Object.keys(E);for(let _e=0;_e<ne.length;_e++){const Ie={subject:null,predicate:null,object:null};Ie[R]=(0,W.termFromId)(te,this._factory),Ie[K]=(0,W.termFromId)(ge,this._factory),Ie[ce]=(0,W.termFromId)(Z[ne[_e]],this._factory),yield this._factory.quad(Ie.subject,Ie.predicate,Ie.object,se)}}}}}}_loop(y,S){for(const T in y)S(T)}_loopByKey0(y,S,T){let V,R;if(V=y[S])for(R in V)T(R)}_loopByKey1(y,S,T){let V,R;for(V in y)R=y[V],R[S]&&T(V)}_loopBy2Keys(y,S,T,V){let R,K,ce;if((R=y[S])&&(K=R[T]))for(ce in K)V(ce)}_countInIndex(y,S,T,V){let K,ce,D,R=0;S&&((K=y,y={})[S]=K[S]);for(const I in y)if(ce=y[I]){T&&((K=ce,ce={})[T]=K[T]);for(const X in ce)(D=ce[X])&&(V?V in D&&R++:R+=Object.keys(D).length)}return R}_getGraphs(y){if(!O(y))return this._graphs;const S={};return S[y]=this._graphs[y],S}_uniqueEntities(y){const S=Object.create(null);return T=>{T in S||(S[T]=!0,y((0,W.termFromId)(this._entities[T],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,S,T,V){S||(V=y.graph,T=y.object,S=y.predicate,y=y.subject),y=(0,W.termToId)(y),S=(0,W.termToId)(S),T=(0,W.termToId)(T),V=(0,W.termToId)(V);let R=this._graphs[V];R||(R=this._graphs[V]={subjects:{},predicates:{},objects:{}},Object.freeze(R));const K=this._ids,ce=this._entities;y=K[y]||(K[ce[++this._id]=y]=this._id),S=K[S]||(K[ce[++this._id]=S]=this._id),T=K[T]||(K[ce[++this._id]=T]=this._id);const D=this._addToIndex(R.subjects,y,S,T);return this._addToIndex(R.predicates,S,T,y),this._addToIndex(R.objects,T,y,S),this._size=null,D}addQuads(y){for(let S=0;S<y.length;S++)this.addQuad(y[S])}delete(y){return this.removeQuad(y),this}has(y,S,T,V){return y&&y.subject&&({subject:y,predicate:S,object:T,graph:V}=y),!this.readQuads(y,S,T,V).next().done}import(y){return y.on("data",S=>{this.addQuad(S)}),y}removeQuad(y,S,T,V){S||(V=y.graph,T=y.object,S=y.predicate,y=y.subject),y=(0,W.termToId)(y),S=(0,W.termToId)(S),T=(0,W.termToId)(T),V=(0,W.termToId)(V);const R=this._ids,K=this._graphs;let ce,D,I;if(!((y=R[y])&&(S=R[S])&&(T=R[T])&&(ce=K[V])&&(D=ce.subjects[y])&&(I=D[S])&&T in I))return!1;for(y in this._removeFromIndex(ce.subjects,y,S,T),this._removeFromIndex(ce.predicates,S,T,y),this._removeFromIndex(ce.objects,T,y,S),null!==this._size&&this._size--,ce.subjects)return!0;return delete K[V],!0}removeQuads(y){for(let S=0;S<y.length;S++)this.removeQuad(y[S])}remove(y){return y.on("data",S=>{this.removeQuad(S)}),y}removeMatches(y,S,T,V){const R=new j.Readable({objectMode:!0});return R._read=()=>{for(const K of this.readQuads(y,S,T,V))R.push(K);R.push(null)},this.remove(R)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,S,T,V){return[...this.readQuads(y,S,T,V)]}*readQuads(y,S,T,V){y=y&&(0,W.termToId)(y),S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._getGraphs(V),K=this._ids;let ce,D,I,X;if(!(O(y)&&!(D=K[y])||O(S)&&!(I=K[S])||O(T)&&!(X=K[T])))for(const E in R)(ce=R[E])&&(D?X?yield*this._findInIndex(ce.objects,X,D,I,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ce.subjects,D,I,null,"subject","predicate","object",E,null,!0):I?yield*this._findInIndex(ce.predicates,I,X,null,"predicate","object","subject",E,null,!0):X?yield*this._findInIndex(ce.objects,X,null,null,"object","subject","predicate",E,null,!0):yield*this._findInIndex(ce.subjects,null,null,null,"subject","predicate","object",E,null,!0))}match(y,S,T,V){return new A(this,y,S,T,V)}countQuads(y,S,T,V){y=y&&(0,W.termToId)(y),S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._getGraphs(V),K=this._ids;let D,I,X,E,ce=0;if(O(y)&&!(I=K[y])||O(S)&&!(X=K[S])||O(T)&&!(E=K[T]))return 0;for(const $ in R)(D=R[$])&&(ce+=y?T?this._countInIndex(D.objects,E,I,X):this._countInIndex(D.subjects,I,X,E):S?this._countInIndex(D.predicates,X,E,I):this._countInIndex(D.objects,E,I,X));return ce}forEach(y,S,T,V,R){this.some(K=>(y(K),!1),S,T,V,R)}every(y,S,T,V,R){let K=!1;const ce=!this.some(D=>(K=!0,!y(D)),S,T,V,R);return K&&ce}some(y,S,T,V,R){for(const K of this.readQuads(S,T,V,R))if(y(K))return!0;return!1}getSubjects(y,S,T){const V=[];return this.forSubjects(R=>{V.push(R)},y,S,T),V}forSubjects(y,S,T,V){S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._ids,K=this._getGraphs(V);let ce,D,I;if(y=this._uniqueEntities(y),!(O(S)&&!(D=R[S])||O(T)&&!(I=R[T])))for(V in K)(ce=K[V])&&(D?I?this._loopBy2Keys(ce.predicates,D,I,y):this._loopByKey1(ce.subjects,D,y):I?this._loopByKey0(ce.objects,I,y):this._loop(ce.subjects,y))}getPredicates(y,S,T){const V=[];return this.forPredicates(R=>{V.push(R)},y,S,T),V}forPredicates(y,S,T,V){S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._ids,K=this._getGraphs(V);let ce,D,I;if(y=this._uniqueEntities(y),!(O(S)&&!(D=R[S])||O(T)&&!(I=R[T])))for(V in K)(ce=K[V])&&(D?I?this._loopBy2Keys(ce.objects,I,D,y):this._loopByKey0(ce.subjects,D,y):I?this._loopByKey1(ce.predicates,I,y):this._loop(ce.predicates,y))}getObjects(y,S,T){const V=[];return this.forObjects(R=>{V.push(R)},y,S,T),V}forObjects(y,S,T,V){S=S&&(0,W.termToId)(S),T=T&&(0,W.termToId)(T),V=V&&(0,W.termToId)(V);const R=this._ids,K=this._getGraphs(V);let ce,D,I;if(y=this._uniqueEntities(y),!(O(S)&&!(D=R[S])||O(T)&&!(I=R[T])))for(V in K)(ce=K[V])&&(D?I?this._loopBy2Keys(ce.subjects,D,I,y):this._loopByKey1(ce.objects,D,y):I?this._loopByKey0(ce.predicates,I,y):this._loop(ce.objects,y))}getGraphs(y,S,T){const V=[];return this.forGraphs(R=>{V.push(R)},y,S,T),V}forGraphs(y,S,T,V){for(const R in this._graphs)this.some(K=>(y(K.graph),!0),S,T,V,R)}createBlankNode(y){let S,T;if(y)for(S=y=`_:${y}`,T=1;this._ids[S];)S=y+T++;else do{S="_:b"+this._blankNodeIndex++}while(this._ids[S]);return this._ids[S]=++this._id,this._entities[this._id]=S,this._factory.blankNode(S.substr(2))}extractLists({remove:y=!1,ignoreErrors:S=!1}={}){const T={},V=S?()=>!0:(ce,D)=>{throw new Error(`${ce.value} ${D}`)},R=this.getQuads(null,P.default.rdf.rest,P.default.rdf.nil,null),K=y?[...R]:[];return R.forEach(ce=>{const D=[];let X,E,I=!1;const $=ce.graph;let Z=ce.subject;for(;Z&&!I;){const se=this.getQuads(null,null,Z,null),oe=this.getQuads(Z,null,null,null);let te,xe=null,ge=null,ne=null;for(let _e=0;_e<oe.length&&!I;_e++)te=oe[_e],te.graph.equals($)?X?I=V(Z,"has non-list arcs out"):te.predicate.value===P.default.rdf.first?xe?I=V(Z,"has multiple rdf:first arcs"):K.push(xe=te):te.predicate.value===P.default.rdf.rest?ge?I=V(Z,"has multiple rdf:rest arcs"):K.push(ge=te):se.length?I=V(Z,"can't be subject and object"):(X=te,E="subject"):I=V(Z,"not confined to single graph");for(let _e=0;_e<se.length&&!I;++_e)te=se[_e],X?I=V(Z,"can't have coreferences"):te.predicate.value===P.default.rdf.rest?ne?I=V(Z,"has incoming rdf:rest arcs"):ne=te:(X=te,E="object");xe?D.unshift(xe.object):I=V(Z,"has no list head"),Z=ne&&ne.subject}I?y=!1:X&&(T[X[E].value]=D)}),y&&this.removeQuads(K),T}*[Symbol.iterator](){yield*this.readQuads()}}function O(b){return"string"==typeof b||b instanceof String}he.default=x;class A extends j.Readable{constructor(y,S,T,V,R){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:S,predicate:T,object:V,graph:R})}get filtered(){if(!this._filtered){const{n3Store:y,graph:S,object:T,predicate:V,subject:R}=this,K=y.getQuads(R,V,T,S);this._filtered=new x(K,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this)this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,S,T,V){return new A(this.filtered,y,S,T,V)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var z,W=(z=Y("./N3Parser"))&&z.__esModule?z:{default:z},j=Y("readable-stream");he.default=class extends j.Transform{constructor(v){let O,A;super({decodeStrings:!0}),this._readableState.objectMode=!0,new W.default(v).parse({on:(b,y)=>{switch(b){case"data":O=y;break;case"end":A=y}}},(b,y)=>{b&&this.emit("error",b)||y&&this.push(y)},(b,y)=>{this.emit("prefix",b,y)}),this._transform=(b,y,S)=>{O(b),S()},this._flush=b=>{A(),b()}}import(v){return v.on("data",x=>{this.write(x)}),v.on("end",()=>{this.end()}),v.on("error",x=>{this.emit("error",x)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var z,W=Y("readable-stream"),j=(z=Y("./N3Writer"))&&z.__esModule?z:{default:z};he.default=class extends W.Transform{constructor(v){super({encoding:"utf8",writableObjectMode:!0});const x=this._writer=new j.default({write:(O,A,b)=>{this.push(O),b&&b()},end:O=>{this.push(null),O&&O()}},v);this._transform=(O,A,b)=>{x.addQuad(O,b)},this._flush=O=>{x.end(O)}}import(v){return v.on("data",x=>{this.write(x)}),v.on("end",()=>{this.end()}),v.on("error",x=>{this.emit("error",x)}),v.on("prefix",(x,O)=>{this._writer.addPrefix(x,O)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.inDefaultGraph=function(y){return x(y.graph)},he.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},he.isDefaultGraph=x,he.isLiteral=function(y){return!!y&&"Literal"===y.termType},he.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},he.isVariable=function(y){return!!y&&"Variable"===y.termType},he.prefix=function(y,S){return b({"":y.value||y},S)("")},he.prefixes=b;var y,W=(y=Y("./N3DataFactory"))&&y.__esModule?y:{default:y};function x(y){return!!y&&"DefaultGraph"===y.termType}function b(y,S){const T=Object.create(null);for(const R in y)V(R,y[R]);function V(R,K){if("string"==typeof K){const ce=Object.create(null);T[R]=D=>ce[D]||(ce[D]=S.namedNode(K+D))}else if(!(R in T))throw new Error(`Unknown prefix: ${R}`);return T[R]}return S=S||W.default,V}},{"./N3DataFactory":35}],42:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var ce,W=(ce=Y("./IRIs"))&&ce.__esModule?ce:{default:ce},j=function(ce,D){if(!D&&ce&&ce.__esModule)return ce;if(null===ce||"object"!=typeof ce&&"function"!=typeof ce)return{default:ce};var I=Q(D);if(I&&I.has(ce))return I.get(ce);var X={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in ce)if("default"!==$&&Object.prototype.hasOwnProperty.call(ce,$)){var Z=E?Object.getOwnPropertyDescriptor(ce,$):null;Z&&(Z.get||Z.set)?Object.defineProperty(X,$,Z):X[$]=ce[$]}return X.default=ce,I&&I.set(ce,X),X}(Y("./N3DataFactory")),P=Y("./N3Util");function Q(ce){if("function"!=typeof WeakMap)return null;var D=new WeakMap,I=new WeakMap;return(Q=function(X){return X?I:D})(ce)}const x=j.default.defaultGraph(),{rdf:O,xsd:A}=W.default,b=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,S={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class T extends j.Term{equals(){return!1}}function R(ce){let D=S[ce];return void 0===D&&(1===ce.length?(D=ce.charCodeAt(0).toString(16),D="\\u0000".substr(0,6-D.length)+D):(D=(1024*(ce.charCodeAt(0)-55296)+ce.charCodeAt(1)+9216).toString(16),D="\\U00000000".substr(0,10-D.length)+D)),D}function K(ce){return ce.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}he.default=class{constructor(D,I){if(this._prefixRegex=/$0^/,D&&"function"!=typeof D.write&&(I=D,D=null),this._lists=(I=I||{}).lists,D)this._outputStream=D,this._endStream=void 0===I.end||!!I.end;else{let X="";this._outputStream={write(E,$,Z){X+=E,Z&&Z()},end:E=>{E&&E(null,X)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(I.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=x,this._prefixIRIs=Object.create(null),I.prefixes&&this.addPrefixes(I.prefixes),I.baseIRI&&(this._baseMatcher=new RegExp(`^${K(I.baseIRI)}${I.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=I.baseIRI.length))}get _inDefaultGraph(){return x.equals(this._graph)}_write(D,I){this._outputStream.write(D,"utf8",I)}_writeQuad(D,I,X,E,$){try{E.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(x.equals(E)?"":`${this._encodeIriOrBlank(E)} {\n`)),this._graph=E,this._subject=null),D.equals(this._subject)?I.equals(this._predicate)?this._write(`, ${this._encodeObject(X)}`,$):this._write(`;\n    ${this._encodePredicate(this._predicate=I)} ${this._encodeObject(X)}`,$):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=D)} ${this._encodePredicate(this._predicate=I)} ${this._encodeObject(X)}`,$)}catch(Z){$&&$(Z)}}_writeQuadLine(D,I,X,E,$){delete this._prefixMatch,this._write(this.quadToString(D,I,X,E),$)}quadToString(D,I,X,E){return`${this._encodeSubject(D)} ${this._encodeIriOrBlank(I)} ${this._encodeObject(X)}${E&&E.value?` ${this._encodeIriOrBlank(E)} .\n`:" .\n"}`}quadsToString(D){return D.map(I=>this.quadToString(I.subject,I.predicate,I.object,I.graph)).join("")}_encodeSubject(D){return"Quad"===D.termType?this._encodeQuad(D):this._encodeIriOrBlank(D)}_encodeIriOrBlank(D){if("NamedNode"!==D.termType)return this._lists&&D.value in this._lists&&(D=this.list(this._lists[D.value])),"id"in D?D.id:`_:${D.value}`;let I=D.value;this._baseMatcher&&this._baseMatcher.test(I)&&(I=I.substr(this._baseLength)),b.test(I)&&(I=I.replace(y,R));const X=this._prefixRegex.exec(I);return X?X[1]?this._prefixIRIs[X[1]]+X[2]:I:`<${I}>`}_encodeLiteral(D){let I=D.value;if(b.test(I)&&(I=I.replace(y,R)),D.language)return`"${I}"@${D.language}`;if(this._lineMode){if(D.datatype.value===A.string)return`"${I}"`}else switch(D.datatype.value){case A.string:return`"${I}"`;case A.boolean:if("true"===I||"false"===I)return I;break;case A.integer:if(/^[+-]?\d+$/.test(I))return I;break;case A.decimal:if(/^[+-]?\d*\.\d+$/.test(I))return I;break;case A.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(I))return I}return`"${I}"^^${this._encodeIriOrBlank(D.datatype)}`}_encodePredicate(D){return D.value===O.type?"a":this._encodeIriOrBlank(D)}_encodeObject(D){switch(D.termType){case"Quad":return this._encodeQuad(D);case"Literal":return this._encodeLiteral(D);default:return this._encodeIriOrBlank(D)}}_encodeQuad({subject:D,predicate:I,object:X,graph:E}){return`<<${this._encodeSubject(D)} ${this._encodePredicate(I)} ${this._encodeObject(X)}${(0,P.isDefaultGraph)(E)?"":` ${this._encodeIriOrBlank(E)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(D,I,X,E,$){void 0===X?this._writeQuad(D.subject,D.predicate,D.object,D.graph,I):"function"==typeof E?this._writeQuad(D,I,X,x,E):this._writeQuad(D,I,X,E||x,$)}addQuads(D){for(let I=0;I<D.length;I++)this.addQuad(D[I])}addPrefix(D,I,X){const E={};E[D]=I,this.addPrefixes(E,X)}addPrefixes(D,I){if(!this._prefixIRIs)return I&&I();let X=!1;for(let E in D){let $=D[E];"string"!=typeof $&&($=$.value),X=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[$]=E+=":",this._write(`@prefix ${E} <${$}>.\n`)}if(X){let E="",$="";for(const Z in this._prefixIRIs)E+=E?`|${Z}`:Z,$+=($?"|":"")+this._prefixIRIs[Z];E=K(E),this._prefixRegex=new RegExp(`^(?:${$})[^/]*$|^(${E})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(X?"\n":"",I)}blank(D,I){let E,$,X=D;switch(void 0===D?X=[]:D.termType?X=[{predicate:D,object:I}]:"length"in D||(X=[D]),$=X.length){case 0:return new T("[]");case 1:if(E=X[0],!(E.object instanceof T))return new T(`[ ${this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)} ]`);default:let Z="[";for(let se=0;se<$;se++)E=X[se],E.predicate.equals(D)?Z+=`, ${this._encodeObject(E.object)}`:(Z+=`${(se?";\n  ":"\n  ")+this._encodePredicate(E.predicate)} ${this._encodeObject(E.object)}`,D=E.predicate);return new T(`${Z}\n]`)}}list(D){const I=D&&D.length||0,X=new Array(I);for(let E=0;E<I;E++)X[E]=this._encodeObject(D[E]);return new T(`(${X.join(" ")})`)}end(D){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let I=D&&((X,E)=>{I=null,D(X,E)});if(this._endStream)try{return this._outputStream.end(I)}catch(X){}I&&I()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),Object.defineProperty(he,"BlankNode",{enumerable:!0,get:function(){return O.BlankNode}}),Object.defineProperty(he,"DataFactory",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(he,"DefaultGraph",{enumerable:!0,get:function(){return O.DefaultGraph}}),Object.defineProperty(he,"Lexer",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(he,"Literal",{enumerable:!0,get:function(){return O.Literal}}),Object.defineProperty(he,"NamedNode",{enumerable:!0,get:function(){return O.NamedNode}}),Object.defineProperty(he,"Parser",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(he,"Quad",{enumerable:!0,get:function(){return O.Quad}}),Object.defineProperty(he,"Store",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(he,"StreamParser",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(he,"StreamWriter",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(he,"Term",{enumerable:!0,get:function(){return O.Term}}),Object.defineProperty(he,"Triple",{enumerable:!0,get:function(){return O.Triple}}),he.Util=void 0,Object.defineProperty(he,"Variable",{enumerable:!0,get:function(){return O.Variable}}),Object.defineProperty(he,"Writer",{enumerable:!0,get:function(){return P.default}}),he.default=void 0,Object.defineProperty(he,"termFromId",{enumerable:!0,get:function(){return O.termFromId}}),Object.defineProperty(he,"termToId",{enumerable:!0,get:function(){return O.termToId}});var W=y(Y("./N3Lexer")),j=y(Y("./N3Parser")),P=y(Y("./N3Writer")),Q=y(Y("./N3Store")),z=y(Y("./N3StreamParser")),v=y(Y("./N3StreamWriter")),x=b(Y("./N3Util"));he.Util=x;var O=b(Y("./N3DataFactory"));function A(T){if("function"!=typeof WeakMap)return null;var V=new WeakMap,R=new WeakMap;return(A=function(K){return K?R:V})(T)}function b(T,V){if(!V&&T&&T.__esModule)return T;if(null===T||"object"!=typeof T&&"function"!=typeof T)return{default:T};var R=A(V);if(R&&R.has(T))return R.get(T);var K={},ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in T)if("default"!==D&&Object.prototype.hasOwnProperty.call(T,D)){var I=ce?Object.getOwnPropertyDescriptor(T,D):null;I&&(I.get||I.set)?Object.defineProperty(K,D,I):K[D]=T[D]}return K.default=T,R&&R.set(T,K),K}function y(T){return T&&T.__esModule?T:{default:T}}he.default={Lexer:W.default,Parser:j.default,Writer:P.default,Store:Q.default,StreamParser:z.default,StreamWriter:v.default,Util:x,DataFactory:O.default,Term:O.Term,NamedNode:O.NamedNode,Literal:O.Literal,BlankNode:O.BlankNode,Variable:O.Variable,DefaultGraph:O.DefaultGraph,Quad:O.Quad,Triple:O.Triple,termFromId:O.termFromId,termToId:O.termToId}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(Y,Se,he){var j,P,W=Se.exports={};function Q(){throw new Error("setTimeout has not been defined")}function z(){throw new Error("clearTimeout has not been defined")}function v(K){if(j===setTimeout)return setTimeout(K,0);if((j===Q||!j)&&setTimeout)return j=setTimeout,setTimeout(K,0);try{return j(K,0)}catch(ce){try{return j.call(null,K,0)}catch(D){return j.call(this,K,0)}}}!function(){try{j="function"==typeof setTimeout?setTimeout:Q}catch(K){j=Q}try{P="function"==typeof clearTimeout?clearTimeout:z}catch(K){P=z}}();var b,O=[],A=!1,y=-1;function S(){!A||!b||(A=!1,b.length?O=b.concat(O):y=-1,O.length&&T())}function T(){if(!A){var K=v(S);A=!0;for(var ce=O.length;ce;){for(b=O,O=[];++y<ce;)b&&b[y].run();y=-1,ce=O.length}b=null,A=!1,function(K){if(P===clearTimeout)return clearTimeout(K);if((P===z||!P)&&clearTimeout)return P=clearTimeout,clearTimeout(K);try{P(K)}catch(ce){try{return P.call(null,K)}catch(D){return P.call(this,K)}}}(K)}}function V(K,ce){this.fun=K,this.array=ce}function R(){}W.nextTick=function(K){var ce=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)ce[D-1]=arguments[D];O.push(new V(K,ce)),1===O.length&&!A&&v(T)},V.prototype.run=function(){this.fun.apply(null,this.array)},W.title="browser",W.browser=!0,W.env={},W.argv=[],W.version="",W.versions={},W.on=R,W.addListener=R,W.once=R,W.off=R,W.removeListener=R,W.removeAllListeners=R,W.emit=R,W.prependListener=R,W.prependOnceListener=R,W.listeners=function(K){return[]},W.binding=function(K){throw new Error("process.binding is not supported")},W.cwd=function(){return"/"},W.chdir=function(K){throw new Error("process.chdir is not supported")},W.umask=function(){return 0}},{}],45:[function(Y,Se,he){(function(W){(function(){let j;Se.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:W):P=>(j||(j=Promise.resolve())).then(P).catch(Q=>setTimeout(()=>{throw Q},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(Y,Se,he){Se.exports=Y("./lib")},{"./lib":55}],47:[function(Y,Se,he){"use strict";Se.exports=class nq{constructor(j,P=new Map,Q=0){this.prefix=j,this._existing=P,this.counter=Q}clone(){const{prefix:j,_existing:P,counter:Q}=this;return new nq(j,new Map(P),Q)}getId(j){const P=j&&this._existing.get(j);if(P)return P;const Q=this.prefix+this.counter;return this.counter++,j&&this._existing.set(j,Q),Q}hasId(j){return this._existing.has(j)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(Y,Se,he){"use strict";Y("setimmediate");const W=self.crypto||self.msCrypto;Se.exports=class{constructor(P){if(!W||!W.subtle)throw new Error("crypto.subtle not found.");if("sha256"===P)this.algorithm={name:"SHA-256"};else{if("sha1"!==P)throw new Error(`Unsupport algorithm "${P}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(P){this._content+=P}digest(){var P=this;return yt(function*(){const Q=(new TextEncoder).encode(P._content),z=new Uint8Array(yield W.subtle.digest(P.algorithm,Q));let v="";for(let x=0;x<z.length;++x)v+=z[x].toString(16).padStart(2,"0");return v})()}}},{setimmediate:86}],49:[function(Y,Se,he){"use strict";const P="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",Q="http://www.w3.org/2001/XMLSchema#string",z="NamedNode",v="BlankNode",x="Literal",O="DefaultGraph",A={};function b(R,K){return R.subject.termType===K.subject.termType&&R.object.termType===K.object.termType&&R.subject.value===K.subject.value&&R.predicate.value===K.predicate.value&&R.object.value===K.object.value&&(R.object.termType!==x||R.object.datatype.termType===K.object.datatype.termType&&R.object.language===K.object.language&&R.object.datatype.value===K.object.datatype.value)}A.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,A.empty=new RegExp("^[ \\t]*$"),A.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),Se.exports=class kF{static parse(K){const ce=[],D={},I=K.split(A.eoln);let X=0;for(const E of I){if(X++,A.empty.test(E))continue;const $=E.match(A.quad);if(null===$)throw new Error("N-Quads parse error on line "+X+".");const Z={subject:null,predicate:null,object:null,graph:null};if(Z.subject=void 0!==$[1]?{termType:z,value:$[1]}:{termType:v,value:$[2]},Z.predicate={termType:z,value:$[3]},void 0!==$[4]?Z.object={termType:z,value:$[4]}:void 0!==$[5]?Z.object={termType:v,value:$[5]}:(Z.object={termType:x,value:void 0,datatype:{termType:z}},void 0!==$[7]?Z.object.datatype.value=$[7]:void 0!==$[8]?(Z.object.datatype.value=P,Z.object.language=$[8]):Z.object.datatype.value=Q,Z.object.value=$[6].replace(T,function(K,ce,D,I){if(ce)switch(ce){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(D)return String.fromCharCode(parseInt(D,16));if(I)throw new Error("Unsupported U escape")})),Z.graph=void 0!==$[9]?{termType:z,value:$[9]}:void 0!==$[10]?{termType:v,value:$[10]}:{termType:O,value:""},Z.graph.value in D){let se=!0;const oe=D[Z.graph.value];for(const te of oe)if(b(te,Z)){se=!1;break}se&&(oe.push(Z),ce.push(Z))}else D[Z.graph.value]=[Z],ce.push(Z)}return ce}static serialize(K){Array.isArray(K)||(K=kF.legacyDatasetToQuads(K));const ce=[];for(const D of K)ce.push(kF.serializeQuad(D));return ce.sort().join("")}static serializeQuad(K){const ce=K.subject,I=K.object,X=K.graph;let E="";return E+=ce.termType===z?`<${ce.value}>`:`${ce.value}`,E+=` <${K.predicate.value}> `,I.termType===z?E+=`<${I.value}>`:I.termType===v?E+=I.value:(E+=`"${R=I.value,R.replace(y,function(K){switch(K){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,I.datatype.value===P?I.language&&(E+=`@${I.language}`):I.datatype.value!==Q&&(E+=`^^<${I.datatype.value}>`)),X.termType===z?E+=` <${X.value}>`:X.termType===v&&(E+=` ${X.value}`),E+=" .\n",E;var R}static legacyDatasetToQuads(K){const ce=[],D={"blank node":v,IRI:z,literal:x};for(const I in K)K[I].forEach(E=>{const $={};for(const Z in E){const se=E[Z],oe={termType:D[se.type],value:se.value};oe.termType===x&&(oe.datatype={termType:z},"datatype"in se&&(oe.datatype.value=se.datatype),"language"in se?("datatype"in se||(oe.datatype.value=P),oe.language=se.language):"datatype"in se||(oe.datatype.value=Q)),$[Z]=oe}$.graph="@default"===I?{termType:O,value:""}:{termType:I.startsWith("_:")?v:z,value:I},ce.push($)});return ce}};const y=/["\\\n\r]/g;const T=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(Y,Se,he){"use strict";Se.exports=class{constructor(j){this.current=j.sort(),this.done=!1,this.dir=new Map;for(let P=0;P<j.length;++P)this.dir.set(j[P],!0)}hasNext(){return!this.done}next(){const{current:j,dir:P}=this,Q=j.slice();let z=null,v=0;const x=j.length;for(let O=0;O<x;++O){const A=j[O],b=P.get(A);(null===z||A>z)&&(b&&O>0&&A>j[O-1]||!b&&O<x-1&&A>j[O+1])&&(z=A,v=O)}if(null===z)this.done=!0;else{const O=P.get(z)?v-1:v+1;j[v]=j[O],j[O]=z;for(const A of j)A>z&&P.set(A,!P.get(A))}return Q}}},{}],51:[function(Y,Se,he){(function(W){(function(){"use strict";const j=Y("./IdentifierIssuer"),P=Y("./MessageDigest"),Q=Y("./Permuter"),z=Y("./NQuads");function v(x,O){return x.hash<O.hash?-1:x.hash>O.hash?1:0}Se.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new j("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(O){var A=this;return yt(function*(){A.quads=O;for(const K of O)A._addBlankNodeQuadInfo({quad:K,component:K.subject}),A._addBlankNodeQuadInfo({quad:K,component:K.object}),A._addBlankNodeQuadInfo({quad:K,component:K.graph});const b=new Map,y=[...A.blankNodeInfo.keys()];let S=0;for(const K of y)++S%100==0&&(yield A._yield()),yield A._hashAndTrackBlankNode({id:K,hashToBlankNodes:b});const T=[...b.keys()].sort(),V=[];for(const K of T){const ce=b.get(K);ce.length>1?V.push(ce):A.canonicalIssuer.getId(ce[0])}for(const K of V){const ce=[];for(const D of K){if(A.canonicalIssuer.hasId(D))continue;const I=new j("_:b");I.getId(D);const X=yield A.hashNDegreeQuads(D,I);ce.push(X)}ce.sort(v);for(const D of ce){const I=D.issuer.getOldIds();for(const X of I)A.canonicalIssuer.getId(X)}}const R=[];for(const K of A.quads){const ce=ot({},K);ce.subject=A._useCanonicalId({component:ce.subject}),ce.object=A._useCanonicalId({component:ce.object}),ce.graph=A._useCanonicalId({component:ce.graph}),R.push(z.serializeQuad(ce))}return R.sort(),R.join("")})()}hashFirstDegreeQuads(O){var A=this;return yt(function*(){const b=[],y=A.blankNodeInfo.get(O),S=y.quads;for(const V of S){const R={subject:null,predicate:V.predicate,object:null,graph:null};R.subject=A.modifyFirstDegreeComponent(O,V.subject,"subject"),R.object=A.modifyFirstDegreeComponent(O,V.object,"object"),R.graph=A.modifyFirstDegreeComponent(O,V.graph,"graph"),b.push(z.serializeQuad(R))}b.sort();const T=new P(A.hashAlgorithm);for(const V of b)T.update(V);return y.hash=yield T.digest(),y.hash})()}hashRelatedBlankNode(O,A,b,y){var S=this;return yt(function*(){let T;T=S.canonicalIssuer.hasId(O)?S.canonicalIssuer.getId(O):b.hasId(O)?b.getId(O):S.blankNodeInfo.get(O).hash;const V=new P(S.hashAlgorithm);return V.update(y),"g"!==y&&V.update(S.getRelatedPredicate(A)),V.update(T),V.digest()})()}hashNDegreeQuads(O,A){var b=this;return yt(function*(){const y=new P(b.hashAlgorithm),S=yield b.createHashToRelated(O,A),T=[...S.keys()].sort();for(const V of T){y.update(V);let K,R="";const ce=new Q(S.get(V));let D=0;for(;ce.hasNext();){const I=ce.next();++D%3==0&&(yield b._yield());let X=A.clone(),E="";const $=[];let Z=!1;for(const se of I)if(b.canonicalIssuer.hasId(se)?E+=b.canonicalIssuer.getId(se):(X.hasId(se)||$.push(se),E+=X.getId(se)),0!==R.length&&E>R){Z=!0;break}if(!Z){for(const se of $){const oe=yield b.hashNDegreeQuads(se,X);if(E+=X.getId(se),E+=`<${oe.hash}>`,X=oe.issuer,0!==R.length&&E>R){Z=!0;break}}Z||(0===R.length||E<R)&&(R=E,K=X)}}y.update(R),A=K}return{hash:yield y.digest(),issuer:A}})()}modifyFirstDegreeComponent(O,A){return"BlankNode"!==A.termType?A:{termType:"BlankNode",value:A.value===O?"_:a":"_:z"}}getRelatedPredicate(O){return`<${O.predicate.value}>`}createHashToRelated(O,A){var b=this;return yt(function*(){const y=new Map,S=b.blankNodeInfo.get(O).quads;let T=0;for(const V of S)++T%100==0&&(yield b._yield()),yield Promise.all([b._addRelatedBlankNodeHash({quad:V,component:V.subject,position:"s",id:O,issuer:A,hashToRelated:y}),b._addRelatedBlankNodeHash({quad:V,component:V.object,position:"o",id:O,issuer:A,hashToRelated:y}),b._addRelatedBlankNodeHash({quad:V,component:V.graph,position:"g",id:O,issuer:A,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:O,hashToBlankNodes:A}){var b=this;return yt(function*(){const y=yield b.hashFirstDegreeQuads(O),S=A.get(y);S?S.push(O):A.set(y,[O])})()}_addBlankNodeQuadInfo({quad:O,component:A}){if("BlankNode"!==A.termType)return;const b=A.value,y=this.blankNodeInfo.get(b);y?y.quads.add(O):this.blankNodeInfo.set(b,{quads:new Set([O]),hash:null})}_addRelatedBlankNodeHash({quad:O,component:A,position:b,id:y,issuer:S,hashToRelated:T}){var V=this;return yt(function*(){if("BlankNode"!==A.termType||A.value===y)return;const R=A.value,K=yield V.hashRelatedBlankNode(R,O,S,b),ce=T.get(K);ce?ce.push(R):T.set(K,[R])})()}_useCanonicalId({component:O}){return"BlankNode"!==O.termType||O.value.startsWith(this.canonicalIssuer.prefix)?O:{termType:"BlankNode",value:this.canonicalIssuer.getId(O.value)}}_yield(){return yt(function*(){return new Promise(O=>W(O))})()}}}).call(this)}).call(this,Y("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(Y,Se,he){"use strict";const W=Y("./IdentifierIssuer"),j=Y("./MessageDigest"),P=Y("./Permuter"),Q=Y("./NQuads");function z(v,x){return v.hash<x.hash?-1:v.hash>x.hash?1:0}Se.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new W("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(x){this.quads=x;for(const T of x)this._addBlankNodeQuadInfo({quad:T,component:T.subject}),this._addBlankNodeQuadInfo({quad:T,component:T.object}),this._addBlankNodeQuadInfo({quad:T,component:T.graph});const O=new Map,A=[...this.blankNodeInfo.keys()];for(const T of A)this._hashAndTrackBlankNode({id:T,hashToBlankNodes:O});const b=[...O.keys()].sort(),y=[];for(const T of b){const V=O.get(T);V.length>1?y.push(V):this.canonicalIssuer.getId(V[0])}for(const T of y){const V=[];for(const R of T){if(this.canonicalIssuer.hasId(R))continue;const K=new W("_:b");K.getId(R);const ce=this.hashNDegreeQuads(R,K);V.push(ce)}V.sort(z);for(const R of V){const K=R.issuer.getOldIds();for(const ce of K)this.canonicalIssuer.getId(ce)}}const S=[];for(const T of this.quads){const V=ot({},T);V.subject=this._useCanonicalId({component:V.subject}),V.object=this._useCanonicalId({component:V.object}),V.graph=this._useCanonicalId({component:V.graph}),S.push(Q.serializeQuad(V))}return S.sort(),S.join("")}hashFirstDegreeQuads(x){const O=[],A=this.blankNodeInfo.get(x),b=A.quads;for(const S of b){const T={subject:null,predicate:S.predicate,object:null,graph:null};T.subject=this.modifyFirstDegreeComponent(x,S.subject,"subject"),T.object=this.modifyFirstDegreeComponent(x,S.object,"object"),T.graph=this.modifyFirstDegreeComponent(x,S.graph,"graph"),O.push(Q.serializeQuad(T))}O.sort();const y=new j(this.hashAlgorithm);for(const S of O)y.update(S);return A.hash=y.digest(),A.hash}hashRelatedBlankNode(x,O,A,b){let y;y=this.canonicalIssuer.hasId(x)?this.canonicalIssuer.getId(x):A.hasId(x)?A.getId(x):this.blankNodeInfo.get(x).hash;const S=new j(this.hashAlgorithm);return S.update(b),"g"!==b&&S.update(this.getRelatedPredicate(O)),S.update(y),S.digest()}hashNDegreeQuads(x,O){const A=new j(this.hashAlgorithm),b=this.createHashToRelated(x,O),y=[...b.keys()].sort();for(const S of y){A.update(S);let V,T="";const R=new P(b.get(S));for(;R.hasNext();){const K=R.next();let ce=O.clone(),D="";const I=[];let X=!1;for(const E of K)if(this.canonicalIssuer.hasId(E)?D+=this.canonicalIssuer.getId(E):(ce.hasId(E)||I.push(E),D+=ce.getId(E)),0!==T.length&&D>T){X=!0;break}if(!X){for(const E of I){const $=this.hashNDegreeQuads(E,ce);if(D+=ce.getId(E),D+=`<${$.hash}>`,ce=$.issuer,0!==T.length&&D>T){X=!0;break}}X||(0===T.length||D<T)&&(T=D,V=ce)}}A.update(T),O=V}return{hash:A.digest(),issuer:O}}modifyFirstDegreeComponent(x,O){return"BlankNode"!==O.termType?O:{termType:"BlankNode",value:O.value===x?"_:a":"_:z"}}getRelatedPredicate(x){return`<${x.predicate.value}>`}createHashToRelated(x,O){const A=new Map,b=this.blankNodeInfo.get(x).quads;for(const y of b)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:x,issuer:O,hashToRelated:A}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:x,issuer:O,hashToRelated:A}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:x,issuer:O,hashToRelated:A});return A}_hashAndTrackBlankNode({id:x,hashToBlankNodes:O}){const A=this.hashFirstDegreeQuads(x),b=O.get(A);b?b.push(x):O.set(A,[x])}_addBlankNodeQuadInfo({quad:x,component:O}){if("BlankNode"!==O.termType)return;const A=O.value,b=this.blankNodeInfo.get(A);b?b.quads.add(x):this.blankNodeInfo.set(A,{quads:new Set([x]),hash:null})}_addRelatedBlankNodeHash({quad:x,component:O,position:A,id:b,issuer:y,hashToRelated:S}){if("BlankNode"!==O.termType||O.value===b)return;const T=O.value,V=this.hashRelatedBlankNode(T,x,y,A),R=S.get(V);R?R.push(T):S.set(V,[T])}_useCanonicalId({component:x}){return"BlankNode"!==x.termType||x.value.startsWith(this.canonicalIssuer.prefix)?x:{termType:"BlankNode",value:this.canonicalIssuer.getId(x.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015");Se.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(P,Q,z){return"BlankNode"!==Q.termType?Q:"graph"===z?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:Q.value===P?"_:a":"_:z"}}getRelatedPredicate(P){return P.predicate.value}createHashToRelated(P,Q){var z=this;return yt(function*(){const v=new Map,x=z.blankNodeInfo.get(P).quads;let O=0;for(const A of x){let b,y;if("BlankNode"===A.subject.termType&&A.subject.value!==P)y=A.subject.value,b="p";else{if("BlankNode"!==A.object.termType||A.object.value===P)continue;y=A.object.value,b="r"}++O%100==0&&(yield z._yield());const S=yield z.hashRelatedBlankNode(y,A,Q,b),T=v.get(S);T?T.push(y):v.set(S,[y])}return v})()}}},{"./URDNA2015":51}],54:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015Sync");Se.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(P,Q,z){return"BlankNode"!==Q.termType?Q:"graph"===z?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:Q.value===P?"_:a":"_:z"}}getRelatedPredicate(P){return P.predicate.value}createHashToRelated(P,Q){const z=new Map,v=this.blankNodeInfo.get(P).quads;for(const x of v){let O,A;if("BlankNode"===x.subject.termType&&x.subject.value!==P)A=x.subject.value,O="p";else{if("BlankNode"!==x.object.termType||x.object.value===P)continue;A=x.object.value,O="r"}const b=this.hashRelatedBlankNode(A,x,Q,O),y=z.get(b);y?y.push(A):z.set(b,[A])}return z}}},{"./URDNA2015Sync":52}],55:[function(Y,Se,he){"use strict";const W=Y("./URDNA2015"),j=Y("./URGNA2012"),P=Y("./URDNA2015Sync"),Q=Y("./URGNA2012Sync");let z;try{z=Y("rdf-canonize-native")}catch(x){}const v={};Se.exports=v,v.NQuads=Y("./NQuads"),v.IdentifierIssuer=Y("./IdentifierIssuer"),v._rdfCanonizeNative=function(x){return x&&(z=x),z},v.canonize=function(){var x=yt(function*(O,A){if(Array.isArray(O)||(O=v.NQuads.legacyDatasetToQuads(O)),A.useNative){if(!z)throw new Error("rdf-canonize-native not available");return new Promise((b,y)=>z.canonize(O,A,(S,T)=>S?y(S):b(T)))}if("URDNA2015"===A.algorithm)return new W(A).main(O);if("URGNA2012"===A.algorithm)return new j(A).main(O);throw"algorithm"in A?new Error("Invalid RDF Dataset Canonicalization algorithm: "+A.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(O,A){return x.apply(this,arguments)}}(),v._canonizeSync=function(x,O){if(Array.isArray(x)||(x=v.NQuads.legacyDatasetToQuads(x)),O.useNative){if(z)return z.canonizeSync(x,O);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===O.algorithm)return new P(O).main(x);if("URGNA2012"===O.algorithm)return new Q(O).main(x);throw"algorithm"in O?new Error("Invalid RDF Dataset Canonicalization algorithm: "+O.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(Y,Se,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(P,Q,z,v){void 0===v&&(v=z),Object.defineProperty(P,v,{enumerable:!0,get:function(){return Q[z]}})}:function(P,Q,z,v){void 0===v&&(v=z),P[v]=Q[z]}),j=this&&this.__exportStar||function(P,Q){for(var z in P)"default"!==z&&!Object.prototype.hasOwnProperty.call(Q,z)&&W(Q,P,z)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/BlankNode"),he),j(Y("./lib/DataFactory"),he),j(Y("./lib/DefaultGraph"),he),j(Y("./lib/Literal"),he),j(Y("./lib/NamedNode"),he),j(Y("./lib/Quad"),he),j(Y("./lib/Variable"),he)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.BlankNode=void 0;he.BlankNode=class{constructor(P){this.termType="BlankNode",this.value=P}equals(P){return!!P&&"BlankNode"===P.termType&&P.value===this.value}}},{}],58:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DataFactory=void 0;const W=Y("./BlankNode"),j=Y("./DefaultGraph"),P=Y("./Literal"),Q=Y("./NamedNode"),z=Y("./Quad"),v=Y("./Variable");let x=0;he.DataFactory=class{constructor(b){this.blankNodeCounter=0,this.blankNodePrefix=(b=b||{}).blankNodePrefix||`df_${x++}_`}namedNode(b){return new Q.NamedNode(b)}blankNode(b){return new W.BlankNode(b||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(b,y){return new P.Literal(b,y)}variable(b){return new v.Variable(b)}defaultGraph(){return j.DefaultGraph.INSTANCE}quad(b,y,S,T){return new z.Quad(b,y,S,T||this.defaultGraph())}fromTerm(b){switch(b.termType){case"NamedNode":return this.namedNode(b.value);case"BlankNode":return this.blankNode(b.value);case"Literal":return b.language?this.literal(b.value,b.language):b.datatype.equals(P.Literal.XSD_STRING)?this.literal(b.value):this.literal(b.value,this.fromTerm(b.datatype));case"Variable":return this.variable(b.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(b.subject),this.fromTerm(b.predicate),this.fromTerm(b.object),this.fromTerm(b.graph))}}fromQuad(b){return this.fromTerm(b)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DefaultGraph=void 0;class W{constructor(){this.termType="DefaultGraph",this.value=""}equals(P){return!!P&&"DefaultGraph"===P.termType}}he.DefaultGraph=W,W.INSTANCE=new W},{}],60:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Literal=void 0;const W=Y("./NamedNode");class j{constructor(Q,z){this.termType="Literal",this.value=Q,"string"==typeof z?(this.language=z,this.datatype=j.RDF_LANGUAGE_STRING):z?(this.language="",this.datatype=z):(this.language="",this.datatype=j.XSD_STRING)}equals(Q){return!!Q&&"Literal"===Q.termType&&Q.value===this.value&&Q.language===this.language&&Q.datatype.equals(this.datatype)}}he.Literal=j,j.RDF_LANGUAGE_STRING=new W.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),j.XSD_STRING=new W.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.NamedNode=void 0;he.NamedNode=class{constructor(P){this.termType="NamedNode",this.value=P}equals(P){return!!P&&"NamedNode"===P.termType&&P.value===this.value}}},{}],62:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Quad=void 0;he.Quad=class{constructor(P,Q,z,v){this.termType="Quad",this.value="",this.subject=P,this.predicate=Q,this.object=z,this.graph=v}equals(P){return!!P&&("Quad"===P.termType||!P.termType)&&this.subject.equals(P.subject)&&this.predicate.equals(P.predicate)&&this.object.equals(P.object)&&this.graph.equals(P.graph)}}},{}],63:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Variable=void 0;he.Variable=class{constructor(P){this.termType="Variable",this.value=P}equals(P){return!!P&&"Variable"===P.termType&&P.value===this.value}}},{}],64:[function(Y,Se,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(P,Q,z,v){void 0===v&&(v=z),Object.defineProperty(P,v,{enumerable:!0,get:function(){return Q[z]}})}:function(P,Q,z,v){void 0===v&&(v=z),P[v]=Q[z]}),j=this&&this.__exportStar||function(P,Q){for(var z in P)"default"!==z&&!Object.prototype.hasOwnProperty.call(Q,z)&&W(Q,P,z)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/RdfXmlParser"),he)},{"./lib/RdfXmlParser":66}],65:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseError=void 0;class W extends Error{constructor(P,Q){const z=P.saxStream._parser;super(P.trackPosition?`Line ${z.line+1} column ${z.column+1}: ${Q}`:Q)}}he.ParseError=W},{}],66:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseType=he.RdfXmlParser=void 0;const W=Y("relative-to-absolute-iri"),j=Y("sax"),P=Y("stream"),Q=Y("./ParseError"),z=Y("rdf-data-factory");class v extends P.Transform{constructor(A){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},A&&(Object.assign(this,A),this.options=A),this.dataFactory||(this.dataFactory=new z.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=j.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(A,b){const y={};let S=!1;for(const V in A.attributes)V.startsWith("xmlns")&&(5===V.length?(S=!0,y[""]=A.attributes[V]):":"===V.charAt(5)&&(S=!0,y[V.substr(6)]=A.attributes[V]));const T=b&&b.ns?b.ns:[v.DEFAULT_NS];return S?T.concat([y]):T}static expandPrefixedTerm(A,b,y){const S=A.indexOf(":");let T,V;S>=0?(T=A.substr(0,S),V=A.substr(S+1)):(T="",V=A);let R=null,K=null;for(let ce=b.length-1;ce>=0;ce--){const D=b[ce][T];if(D){R=D;break}K||(K=b[ce][""])}if(!R){if(T&&"xmlns"!==T)throw new Q.ParseError(y,`The prefix '${T}' in term '${A}' was not bound.`);R=K||""}return{prefix:T,local:V,uri:R}}static isValidIri(A){return v.IRI_REGEX.test(A)}import(A){const b=new P.PassThrough({readableObjectMode:!0});A.on("error",S=>y.emit("error",S)),A.on("data",S=>b.push(S)),A.on("end",()=>b.push(null));const y=b.pipe(new v(this.options));return y}_transform(A,b,y){try{this.saxStream.write(A,b)}catch(S){return y(S)}y()}newParseError(A){return new Q.ParseError(this,A)}valueToUri(A,b){return this.uriToNamedNode(W.resolve(A,b.baseIRI))}uriToNamedNode(A){if(!v.isValidIri(A))throw this.newParseError(`Invalid URI: ${A}`);return this.dataFactory.namedNode(A)}validateNcname(A){if(!v.NCNAME_MATCHER.test(A))throw this.newParseError(`Not a valid NCName: ${A}`)}attachSaxListeners(){this.saxStream.on("error",A=>this.emit("error",A)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(A){const b=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=x.RESOURCE;if(b&&(b.hadChildren=!0,y=b.childrenParseType),b&&b.childrenStringTags){const T=A.name;let V="";for(const D in A.attributes)V+=` ${D}="${A.attributes[D]}"`;b.childrenStringTags.push(`<${T}${V}>`);const ce={childrenStringTags:b.childrenStringTags};return ce.childrenStringEmitClosingTag=`</${T}>`,void this.activeTagStack.push(ce)}const S={};b?(S.language=b.language,S.baseIRI=b.baseIRI):S.baseIRI=this.baseIRI,this.activeTagStack.push(S),S.ns=v.parseNamespace(A,b),y===x.RESOURCE?this.onTagResource(A,S,b,!b):this.onTagProperty(A,S,b)}onTagResource(A,b,y,S){const T=v.expandPrefixedTerm(A.name,b.ns,this);b.childrenParseType=x.PROPERTY;let V=!0;if(T.uri===v.RDF){if(!S&&v.FORBIDDEN_NODE_ELEMENTS.indexOf(T.local)>=0)throw this.newParseError(`Illegal node element name: ${T.local}`);switch(T.local){case"RDF":b.childrenParseType=x.RESOURCE;case"Description":V=!1}}const R=[],K=[];let ce=null,D=!1,I=!1,X=null;for(const E in A.attributes){const $=A.attributes[E],Z=v.expandPrefixedTerm(E,b.ns,this);if(y&&Z.uri===v.RDF)switch(Z.local){case"about":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ce} where found.`);ce=$;continue;case"ID":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ce} where found.`);this.validateNcname($),ce="#"+$,D=!0;continue;case"nodeID":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${$} and ${ce} where found.`);this.validateNcname($),ce=$,I=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":X=$;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(Z.uri===v.XML){if("lang"===Z.local){b.language=""===$?null:$.toLowerCase();continue}if("base"===Z.local){b.baseIRI=W.resolve($,b.baseIRI);continue}}"xml"!==Z.prefix&&Z.uri&&(R.push(this.uriToNamedNode(Z.uri+Z.local)),K.push($))}if(null!==ce&&(b.subject=I?this.dataFactory.blankNode(ce):this.valueToUri(ce,b),D&&this.claimNodeId(b.subject)),b.subject||(b.subject=this.dataFactory.blankNode()),V){const E=this.uriToNamedNode(T.uri+T.local);this.emitTriple(b.subject,this.dataFactory.namedNode(v.RDF+"type"),E,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const E=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,E,y.reifiedStatementId),this.emitTriple(E,this.dataFactory.namedNode(v.RDF+"first"),b.subject,b.reifiedStatementId),y.childrenCollectionSubject=E,y.childrenCollectionPredicate=this.dataFactory.namedNode(v.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,b.subject,y.reifiedStatementId);for(let E=0;E<y.predicateSubPredicates.length;E++)this.emitTriple(b.subject,y.predicateSubPredicates[E],y.predicateSubObjects[E],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let E=0;E<R.length;E++){const $=this.dataFactory.literal(K[E],b.datatype||b.language);this.emitTriple(b.subject,R[E],$,y.reifiedStatementId)}X&&this.emitTriple(b.subject,this.dataFactory.namedNode(v.RDF+"type"),this.uriToNamedNode(X),null)}}onTagProperty(A,b,y){const S=v.expandPrefixedTerm(A.name,b.ns,this);if(b.childrenParseType=x.RESOURCE,b.subject=y.subject,S.uri===v.RDF&&"li"===S.local?(y.listItemCounter||(y.listItemCounter=1),b.predicate=this.uriToNamedNode(S.uri+"_"+y.listItemCounter++)):b.predicate=this.uriToNamedNode(S.uri+S.local),S.uri===v.RDF&&v.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(S.local)>=0)throw this.newParseError(`Illegal property element name: ${S.local}`);b.predicateSubPredicates=[],b.predicateSubObjects=[];let T=!1,V=!1,R=null,K=!0;const ce=[],D=[];for(const I in A.attributes){const X=A.attributes[I],E=v.expandPrefixedTerm(I,b.ns,this);if(E.uri===v.RDF)switch(E.local){case"resource":if(R)throw this.newParseError(`Found both rdf:resource (${X}) and rdf:nodeID (${R}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${X})`);b.hadChildren=!0,R=X,K=!1;continue;case"datatype":if(V)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${X}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${X})`);b.datatype=this.valueToUri(X,b);continue;case"nodeID":if(V)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${X}).`);if(b.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${X}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${X})`);this.validateNcname(X),b.hadChildren=!0,R=X,K=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(V)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(b.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${b.datatype.value})`);if(R)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${R})`);if("Resource"===X){T=!0,b.childrenParseType=x.PROPERTY;const $=this.dataFactory.blankNode();this.emitTriple(b.subject,b.predicate,$,b.reifiedStatementId),b.subject=$,b.predicate=null}else"Collection"===X?(T=!0,b.hadChildren=!0,b.childrenCollectionSubject=b.subject,b.childrenCollectionPredicate=b.predicate,K=!1):"Literal"===X&&(T=!0,b.childrenTagsToString=!0,b.childrenStringTags=[]);continue;case"ID":this.validateNcname(X),b.reifiedStatementId=this.valueToUri("#"+X,b),this.claimNodeId(b.reifiedStatementId);continue}else if(E.uri===v.XML&&"lang"===E.local){b.language=""===X?null:X.toLowerCase();continue}if("xml"!==E.prefix&&"xmlns"!==E.prefix&&E.uri){if(T||b.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${X}`);b.hadChildren=!0,V=!0,ce.push(this.uriToNamedNode(E.uri+E.local)),D.push(this.dataFactory.literal(X,b.datatype||b.language))}}if(null!==R){const I=b.subject;b.subject=K?this.dataFactory.blankNode(R):this.valueToUri(R,b),this.emitTriple(I,b.predicate,b.subject,b.reifiedStatementId);for(let X=0;X<ce.length;X++)this.emitTriple(b.subject,ce[X],D[X],null);b.predicateEmitted=!0}else K&&(b.predicateSubPredicates=ce,b.predicateSubObjects=D,b.predicateEmitted=!1)}emitTriple(A,b,y,S){this.push(this.dataFactory.quad(A,b,y,this.defaultGraph)),S&&(this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(v.RDF+"type"),this.dataFactory.namedNode(v.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(v.RDF+"subject"),A,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(v.RDF+"predicate"),b,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(v.RDF+"object"),y,this.defaultGraph)))}claimNodeId(A){if(!this.allowDuplicateRdfIds){if(this.nodeIds[A.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${A.value}'.`);this.nodeIds[A.value]=!0}}onText(A){const b=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;b&&(b.childrenStringTags?b.childrenStringTags.push(A):b.predicate&&(b.text=A))}onCloseTag(){const A=this.activeTagStack.pop();if(A.childrenStringEmitClosingTag&&A.childrenStringTags.push(A.childrenStringEmitClosingTag),A.childrenTagsToString&&(A.datatype=this.dataFactory.namedNode(v.RDF+"XMLLiteral"),A.text=A.childrenStringTags.join(""),A.hadChildren=!1),A.childrenCollectionSubject)this.emitTriple(A.childrenCollectionSubject,A.childrenCollectionPredicate,this.dataFactory.namedNode(v.RDF+"nil"),A.reifiedStatementId);else if(A.predicate)if(A.hadChildren||A.childrenParseType===x.PROPERTY){if(!A.predicateEmitted){const b=this.dataFactory.blankNode();this.emitTriple(A.subject,A.predicate,b,A.reifiedStatementId);for(let y=0;y<A.predicateSubPredicates.length;y++)this.emitTriple(b,A.predicateSubPredicates[y],A.predicateSubObjects[y],null)}}else this.emitTriple(A.subject,A.predicate,this.dataFactory.literal(A.text||"",A.datatype||A.language),A.reifiedStatementId)}onDoctype(A){A.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(b,y,S)=>(this.saxStream._parser.ENTITIES[y]=S,""))}}var x,O;he.RdfXmlParser=v,v.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,v.MIME_TYPE="application/rdf+xml",v.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",v.XML="http://www.w3.org/XML/1998/namespace",v.XMLNS="http://www.w3.org/2000/xmlns/",v.DEFAULT_NS={xml:v.XML},v.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],v.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],v.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(O=x=he.ParseType||(he.ParseType={}))[O.RESOURCE=0]="RESOURCE",O[O.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(Y,Se,he){"use strict";var j={};function P(O,A,b){b||(b=Error);var S=function(T){function V(R,K,ce){return T.call(this,function(T,V,R){return"string"==typeof A?A:A(T,V,R)}(R,K,ce))||this}return function(O,A){O.prototype=Object.create(A.prototype),O.prototype.constructor=O,O.__proto__=A}(V,T),V}(b);S.prototype.name=b.name,S.prototype.code=O,j[O]=S}function Q(O,A){if(Array.isArray(O)){var b=O.length;return O=O.map(function(y){return String(y)}),b>2?"one of ".concat(A," ").concat(O.slice(0,b-1).join(", "),", or ")+O[b-1]:2===b?"one of ".concat(A," ").concat(O[0]," or ").concat(O[1]):"of ".concat(A," ").concat(O[0])}return"of ".concat(A," ").concat(String(O))}P("ERR_INVALID_OPT_VALUE",function(O,A){return'The value "'+A+'" is invalid for option "'+O+'"'},TypeError),P("ERR_INVALID_ARG_TYPE",function(O,A,b){var y,S;if("string"==typeof A&&function(O,A,b){return O.substr(!b||b<0?0:+b,A.length)===A}(A,"not ")?(y="must not be",A=A.replace(/^not /,"")):y="must be",function(O,A,b){return(void 0===b||b>O.length)&&(b=O.length),O.substring(b-A.length,b)===A}(O," argument"))S="The ".concat(O," ").concat(y," ").concat(Q(A,"type"));else{var T=function(O,A,b){return"number"!=typeof b&&(b=0),!(b+A.length>O.length)&&-1!==O.indexOf(A,b)}(O,".")?"property":"argument";S='The "'.concat(O,'" ').concat(T," ").concat(y," ").concat(Q(A,"type"))}return S+". Received type ".concat(typeof b)},TypeError),P("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),P("ERR_METHOD_NOT_IMPLEMENTED",function(O){return"The "+O+" method is not implemented"}),P("ERR_STREAM_PREMATURE_CLOSE","Premature close"),P("ERR_STREAM_DESTROYED",function(O){return"Cannot call "+O+" after a stream was destroyed"}),P("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),P("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),P("ERR_STREAM_WRITE_AFTER_END","write after end"),P("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),P("ERR_UNKNOWN_ENCODING",function(O){return"Unknown encoding: "+O},TypeError),P("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Se.exports.codes=j},{}],68:[function(Y,Se,he){(function(W){(function(){"use strict";var j=Object.keys||function(y){var S=[];for(var T in y)S.push(T);return S};Se.exports=O;var P=Y("./_stream_readable"),Q=Y("./_stream_writable");Y("inherits")(O,P);for(var z=j(Q.prototype),v=0;v<z.length;v++){var x=z[v];O.prototype[x]||(O.prototype[x]=Q.prototype[x])}function O(y){if(!(this instanceof O))return new O(y);P.call(this,y),Q.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",A)))}function A(){this._writableState.ended||W.nextTick(b,this)}function b(y){y.end()}Object.defineProperty(O.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(O.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(O.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(S){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=S,this._writableState.destroyed=S)}})}).call(this)}).call(this,Y("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(Y,Se,he){"use strict";Se.exports=j;var W=Y("./_stream_transform");function j(P){if(!(this instanceof j))return new j(P);W.call(this,P)}Y("inherits")(j,W),j.prototype._transform=function(P,Q,z){z(null,P)}},{"./_stream_transform":71,inherits:10}],70:[function(Y,Se,he){(function(W,j){(function(){"use strict";var P;Se.exports=ne,ne.ReadableState=ge,Y("events");var z=function(k,N){return k.listeners(N).length},v=Y("./internal/streams/stream"),x=Y("buffer").Buffer,O=j.Uint8Array||function(){};var S,y=Y("util");S=y&&y.debuglog?y.debuglog("stream"):function(){};var $,Z,se,T=Y("./internal/streams/buffer_list"),V=Y("./internal/streams/destroy"),K=Y("./internal/streams/state").getHighWaterMark,ce=Y("../errors").codes,D=ce.ERR_INVALID_ARG_TYPE,I=ce.ERR_STREAM_PUSH_AFTER_EOF,X=ce.ERR_METHOD_NOT_IMPLEMENTED,E=ce.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;Y("inherits")(ne,v);var oe=V.errorOrDestroy,te=["error","close","destroy","pause","resume"];function ge(ve,k,N){P=P||Y("./_stream_duplex"),"boolean"!=typeof N&&(N=k instanceof P),this.objectMode=!!(ve=ve||{}).objectMode,N&&(this.objectMode=this.objectMode||!!ve.readableObjectMode),this.highWaterMark=K(this,ve,"readableHighWaterMark",N),this.buffer=new T,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==ve.emitClose,this.autoDestroy=!!ve.autoDestroy,this.destroyed=!1,this.defaultEncoding=ve.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ve.encoding&&($||($=Y("string_decoder/").StringDecoder),this.decoder=new $(ve.encoding),this.encoding=ve.encoding)}function ne(ve){if(P=P||Y("./_stream_duplex"),!(this instanceof ne))return new ne(ve);this._readableState=new ge(ve,this,this instanceof P),this.readable=!0,ve&&("function"==typeof ve.read&&(this._read=ve.read),"function"==typeof ve.destroy&&(this._destroy=ve.destroy)),v.call(this)}function _e(ve,k,N,B,Re){S("readableAddChunk",k);var St,Qe=ve._readableState;if(null===k)Qe.reading=!1,function(ve,k){if(S("onEofChunk"),!k.ended){if(k.decoder){var N=k.decoder.end();N&&N.length&&(k.buffer.push(N),k.length+=k.objectMode?1:N.length)}k.ended=!0,k.sync?Ue(ve):(k.needReadable=!1,k.emittedReadable||(k.emittedReadable=!0,Le(ve)))}}(ve,Qe);else if(Re||(St=function(ve,k){var N;return!function(ve){return x.isBuffer(ve)||ve instanceof O}(k)&&"string"!=typeof k&&void 0!==k&&!ve.objectMode&&(N=new D("chunk",["string","Buffer","Uint8Array"],k)),N}(Qe,k)),St)oe(ve,St);else if(Qe.objectMode||k&&k.length>0)if("string"!=typeof k&&!Qe.objectMode&&Object.getPrototypeOf(k)!==x.prototype&&(k=function(ve){return x.from(ve)}(k)),B)Qe.endEmitted?oe(ve,new E):Ie(ve,Qe,k,!0);else if(Qe.ended)oe(ve,new I);else{if(Qe.destroyed)return!1;Qe.reading=!1,Qe.decoder&&!N?(k=Qe.decoder.write(k),Qe.objectMode||0!==k.length?Ie(ve,Qe,k,!1):Ke(ve,Qe)):Ie(ve,Qe,k,!1)}else B||(Qe.reading=!1,Ke(ve,Qe));return!Qe.ended&&(Qe.length<Qe.highWaterMark||0===Qe.length)}function Ie(ve,k,N,B){k.flowing&&0===k.length&&!k.sync?(k.awaitDrain=0,ve.emit("data",N)):(k.length+=k.objectMode?1:N.length,B?k.buffer.unshift(N):k.buffer.push(N),k.needReadable&&Ue(ve)),Ke(ve,k)}Object.defineProperty(ne.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(k){!this._readableState||(this._readableState.destroyed=k)}}),ne.prototype.destroy=V.destroy,ne.prototype._undestroy=V.undestroy,ne.prototype._destroy=function(ve,k){k(ve)},ne.prototype.push=function(ve,k){var B,N=this._readableState;return N.objectMode?B=!0:"string"==typeof ve&&((k=k||N.defaultEncoding)!==N.encoding&&(ve=x.from(ve,k),k=""),B=!0),_e(this,ve,k,!1,B)},ne.prototype.unshift=function(ve){return _e(this,ve,null,!0,!1)},ne.prototype.isPaused=function(){return!1===this._readableState.flowing},ne.prototype.setEncoding=function(ve){$||($=Y("string_decoder/").StringDecoder);var k=new $(ve);this._readableState.decoder=k,this._readableState.encoding=this._readableState.decoder.encoding;for(var N=this._readableState.buffer.head,B="";null!==N;)B+=k.write(N.data),N=N.next;return this._readableState.buffer.clear(),""!==B&&this._readableState.buffer.push(B),this._readableState.length=B.length,this};var st=1073741824;function tt(ve,k){return ve<=0||0===k.length&&k.ended?0:k.objectMode?1:ve!=ve?k.flowing&&k.length?k.buffer.head.data.length:k.length:(ve>k.highWaterMark&&(k.highWaterMark=function(ve){return ve>=st?ve=st:(ve--,ve|=ve>>>1,ve|=ve>>>2,ve|=ve>>>4,ve|=ve>>>8,ve|=ve>>>16,ve++),ve}(ve)),ve<=k.length?ve:k.ended?k.length:(k.needReadable=!0,0))}function Ue(ve){var k=ve._readableState;S("emitReadable",k.needReadable,k.emittedReadable),k.needReadable=!1,k.emittedReadable||(S("emitReadable",k.flowing),k.emittedReadable=!0,W.nextTick(Le,ve))}function Le(ve){var k=ve._readableState;S("emitReadable_",k.destroyed,k.length,k.ended),!k.destroyed&&(k.length||k.ended)&&(ve.emit("readable"),k.emittedReadable=!1),k.needReadable=!k.flowing&&!k.ended&&k.length<=k.highWaterMark,pe(ve)}function Ke(ve,k){k.readingMore||(k.readingMore=!0,W.nextTick(Te,ve,k))}function Te(ve,k){for(;!k.reading&&!k.ended&&(k.length<k.highWaterMark||k.flowing&&0===k.length);){var N=k.length;if(S("maybeReadMore read 0"),ve.read(0),N===k.length)break}k.readingMore=!1}function $e(ve){var k=ve._readableState;k.readableListening=ve.listenerCount("readable")>0,k.resumeScheduled&&!k.paused?k.flowing=!0:ve.listenerCount("data")>0&&ve.resume()}function Ne(ve){S("readable nexttick read 0"),ve.read(0)}function G(ve,k){S("resume",k.reading),k.reading||ve.read(0),k.resumeScheduled=!1,ve.emit("resume"),pe(ve),k.flowing&&!k.reading&&ve.read(0)}function pe(ve){var k=ve._readableState;for(S("flow",k.flowing);k.flowing&&null!==ve.read(););}function ue(ve,k){return 0===k.length?null:(k.objectMode?N=k.buffer.shift():!ve||ve>=k.length?(N=k.decoder?k.buffer.join(""):1===k.buffer.length?k.buffer.first():k.buffer.concat(k.length),k.buffer.clear()):N=k.buffer.consume(ve,k.decoder),N);var N}function je(ve){var k=ve._readableState;S("endReadable",k.endEmitted),k.endEmitted||(k.ended=!0,W.nextTick(_t,k,ve))}function _t(ve,k){if(S("endReadableNT",ve.endEmitted,ve.length),!ve.endEmitted&&0===ve.length&&(ve.endEmitted=!0,k.readable=!1,k.emit("end"),ve.autoDestroy)){var N=k._writableState;(!N||N.autoDestroy&&N.finished)&&k.destroy()}}function pt(ve,k){for(var N=0,B=ve.length;N<B;N++)if(ve[N]===k)return N;return-1}ne.prototype.read=function(ve){S("read",ve),ve=parseInt(ve,10);var k=this._readableState,N=ve;if(0!==ve&&(k.emittedReadable=!1),0===ve&&k.needReadable&&((0!==k.highWaterMark?k.length>=k.highWaterMark:k.length>0)||k.ended))return S("read: emitReadable",k.length,k.ended),0===k.length&&k.ended?je(this):Ue(this),null;if(0===(ve=tt(ve,k))&&k.ended)return 0===k.length&&je(this),null;var Re,B=k.needReadable;return S("need readable",B),(0===k.length||k.length-ve<k.highWaterMark)&&S("length less than watermark",B=!0),k.ended||k.reading?S("reading or ended",B=!1):B&&(S("do read"),k.reading=!0,k.sync=!0,0===k.length&&(k.needReadable=!0),this._read(k.highWaterMark),k.sync=!1,k.reading||(ve=tt(N,k))),null===(Re=ve>0?ue(ve,k):null)?(k.needReadable=k.length<=k.highWaterMark,ve=0):(k.length-=ve,k.awaitDrain=0),0===k.length&&(k.ended||(k.needReadable=!0),N!==ve&&k.ended&&je(this)),null!==Re&&this.emit("data",Re),Re},ne.prototype._read=function(ve){oe(this,new X("_read()"))},ne.prototype.pipe=function(ve,k){var N=this,B=this._readableState;switch(B.pipesCount){case 0:B.pipes=ve;break;case 1:B.pipes=[B.pipes,ve];break;default:B.pipes.push(ve)}B.pipesCount+=1,S("pipe count=%d opts=%j",B.pipesCount,k);var Qe=k&&!1===k.end||ve===W.stdout||ve===W.stderr?us:Rt;function St(Ps,$r){S("onunpipe"),Ps===N&&$r&&!1===$r.hasUnpiped&&($r.hasUnpiped=!0,S("cleanup"),ve.removeListener("close",Gr),ve.removeListener("finish",Ns),ve.removeListener("drain",In),ve.removeListener("error",gi),ve.removeListener("unpipe",St),N.removeListener("end",Rt),N.removeListener("end",us),N.removeListener("data",wi),Ln=!0,B.awaitDrain&&(!ve._writableState||ve._writableState.needDrain)&&In())}function Rt(){S("onend"),ve.end()}B.endEmitted?W.nextTick(Qe):N.once("end",Qe),ve.on("unpipe",St);var In=function(ve){return function(){var N=ve._readableState;S("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,0===N.awaitDrain&&z(ve,"data")&&(N.flowing=!0,pe(ve))}}(N);ve.on("drain",In);var Ln=!1;function wi(Ps){S("ondata");var $r=ve.write(Ps);S("dest.write",$r),!1===$r&&((1===B.pipesCount&&B.pipes===ve||B.pipesCount>1&&-1!==pt(B.pipes,ve))&&!Ln&&(S("false write response, pause",B.awaitDrain),B.awaitDrain++),N.pause())}function gi(Ps){S("onerror",Ps),us(),ve.removeListener("error",gi),0===z(ve,"error")&&oe(ve,Ps)}function Gr(){ve.removeListener("finish",Ns),us()}function Ns(){S("onfinish"),ve.removeListener("close",Gr),us()}function us(){S("unpipe"),N.unpipe(ve)}return N.on("data",wi),function(ve,k,N){if("function"==typeof ve.prependListener)return ve.prependListener(k,N);ve._events&&ve._events[k]?Array.isArray(ve._events[k])?ve._events[k].unshift(N):ve._events[k]=[N,ve._events[k]]:ve.on(k,N)}(ve,"error",gi),ve.once("close",Gr),ve.once("finish",Ns),ve.emit("pipe",N),B.flowing||(S("pipe resume"),N.resume()),ve},ne.prototype.unpipe=function(ve){var k=this._readableState,N={hasUnpiped:!1};if(0===k.pipesCount)return this;if(1===k.pipesCount)return ve&&ve!==k.pipes||(ve||(ve=k.pipes),k.pipes=null,k.pipesCount=0,k.flowing=!1,ve&&ve.emit("unpipe",this,N)),this;if(!ve){var B=k.pipes,Re=k.pipesCount;k.pipes=null,k.pipesCount=0,k.flowing=!1;for(var Qe=0;Qe<Re;Qe++)B[Qe].emit("unpipe",this,{hasUnpiped:!1});return this}var St=pt(k.pipes,ve);return-1===St||(k.pipes.splice(St,1),k.pipesCount-=1,1===k.pipesCount&&(k.pipes=k.pipes[0]),ve.emit("unpipe",this,N)),this},ne.prototype.addListener=ne.prototype.on=function(ve,k){var N=v.prototype.on.call(this,ve,k),B=this._readableState;return"data"===ve?(B.readableListening=this.listenerCount("readable")>0,!1!==B.flowing&&this.resume()):"readable"===ve&&!B.endEmitted&&!B.readableListening&&(B.readableListening=B.needReadable=!0,B.flowing=!1,B.emittedReadable=!1,S("on readable",B.length,B.reading),B.length?Ue(this):B.reading||W.nextTick(Ne,this)),N},ne.prototype.removeListener=function(ve,k){var N=v.prototype.removeListener.call(this,ve,k);return"readable"===ve&&W.nextTick($e,this),N},ne.prototype.removeAllListeners=function(ve){var k=v.prototype.removeAllListeners.apply(this,arguments);return("readable"===ve||void 0===ve)&&W.nextTick($e,this),k},ne.prototype.resume=function(){var ve=this._readableState;return ve.flowing||(S("resume"),ve.flowing=!ve.readableListening,function(ve,k){k.resumeScheduled||(k.resumeScheduled=!0,W.nextTick(G,ve,k))}(this,ve)),ve.paused=!1,this},ne.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},ne.prototype.wrap=function(ve){var k=this,N=this._readableState,B=!1;for(var Re in ve.on("end",function(){if(S("wrapped end"),N.decoder&&!N.ended){var St=N.decoder.end();St&&St.length&&k.push(St)}k.push(null)}),ve.on("data",function(St){S("wrapped data"),N.decoder&&(St=N.decoder.write(St)),N.objectMode&&null==St||!(N.objectMode||St&&St.length)||k.push(St)||(B=!0,ve.pause())}),ve)void 0===this[Re]&&"function"==typeof ve[Re]&&(this[Re]=function(Rt){return function(){return ve[Rt].apply(ve,arguments)}}(Re));for(var Qe=0;Qe<te.length;Qe++)ve.on(te[Qe],this.emit.bind(this,te[Qe]));return this._read=function(St){S("wrapped _read",St),B&&(B=!1,ve.resume())},this},"function"==typeof Symbol&&(ne.prototype[Symbol.asyncIterator]=function(){return void 0===Z&&(Z=Y("./internal/streams/async_iterator")),Z(this)}),Object.defineProperty(ne.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ne.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ne.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(k){this._readableState&&(this._readableState.flowing=k)}}),ne._fromList=ue,Object.defineProperty(ne.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(ne.from=function(ve,k){return void 0===se&&(se=Y("./internal/streams/from")),se(ne,ve,k)})}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(Y,Se,he){"use strict";Se.exports=O;var W=Y("../errors").codes,j=W.ERR_METHOD_NOT_IMPLEMENTED,P=W.ERR_MULTIPLE_CALLBACK,Q=W.ERR_TRANSFORM_ALREADY_TRANSFORMING,z=W.ERR_TRANSFORM_WITH_LENGTH_0,v=Y("./_stream_duplex");function x(y,S){var T=this._transformState;T.transforming=!1;var V=T.writecb;if(null===V)return this.emit("error",new P);T.writechunk=null,T.writecb=null,null!=S&&this.push(S),V(y);var R=this._readableState;R.reading=!1,(R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}function O(y){if(!(this instanceof O))return new O(y);v.call(this,y),this._transformState={afterTransform:x.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",A)}function A(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?b(this,null,null):this._flush(function(S,T){b(y,S,T)})}function b(y,S,T){if(S)return y.emit("error",S);if(null!=T&&y.push(T),y._writableState.length)throw new z;if(y._transformState.transforming)throw new Q;return y.push(null)}Y("inherits")(O,v),O.prototype.push=function(y,S){return this._transformState.needTransform=!1,v.prototype.push.call(this,y,S)},O.prototype._transform=function(y,S,T){T(new j("_transform()"))},O.prototype._write=function(y,S,T){var V=this._transformState;if(V.writecb=T,V.writechunk=y,V.writeencoding=S,!V.transforming){var R=this._readableState;(V.needTransform||R.needReadable||R.length<R.highWaterMark)&&this._read(R.highWaterMark)}},O.prototype._read=function(y){var S=this._transformState;null===S.writechunk||S.transforming?S.needTransform=!0:(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform))},O.prototype._destroy=function(y,S){v.prototype._destroy.call(this,y,function(T){S(T)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(Y,Se,he){(function(W,j){(function(){"use strict";function Q(pe){var ue=this;this.next=null,this.entry=null,this.finish=function(){!function(pe,ue,je){var _t=pe.entry;for(pe.entry=null;_t;){var pt=_t.callback;ue.pendingcb--,pt(je),_t=_t.next}ue.corkedRequestsFree.next=pe}(ue,pe)}}var z;Se.exports=ge,ge.WritableState=te;var v={deprecate:Y("util-deprecate")},x=Y("./internal/streams/stream"),O=Y("buffer").Buffer,A=j.Uint8Array||function(){};var xe,S=Y("./internal/streams/destroy"),V=Y("./internal/streams/state").getHighWaterMark,R=Y("../errors").codes,K=R.ERR_INVALID_ARG_TYPE,ce=R.ERR_METHOD_NOT_IMPLEMENTED,D=R.ERR_MULTIPLE_CALLBACK,I=R.ERR_STREAM_CANNOT_PIPE,X=R.ERR_STREAM_DESTROYED,E=R.ERR_STREAM_NULL_VALUES,$=R.ERR_STREAM_WRITE_AFTER_END,Z=R.ERR_UNKNOWN_ENCODING,se=S.errorOrDestroy;function oe(){}function te(pe,ue,je){z=z||Y("./_stream_duplex"),"boolean"!=typeof je&&(je=ue instanceof z),this.objectMode=!!(pe=pe||{}).objectMode,je&&(this.objectMode=this.objectMode||!!pe.writableObjectMode),this.highWaterMark=V(this,pe,"writableHighWaterMark",je),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===pe.decodeStrings),this.defaultEncoding=pe.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){!function(pe,ue){var je=pe._writableState,_t=je.sync,pt=je.writecb;if("function"!=typeof pt)throw new D;if(function(pe){pe.writing=!1,pe.writecb=null,pe.length-=pe.writelen,pe.writelen=0}(je),ue)!function(pe,ue,je,_t,pt){--ue.pendingcb,je?(W.nextTick(pt,_t),W.nextTick(Ne,pe,ue),pe._writableState.errorEmitted=!0,se(pe,_t)):(pt(_t),pe._writableState.errorEmitted=!0,se(pe,_t),Ne(pe,ue))}(pe,je,_t,ue,pt);else{var ve=Te(je)||pe.destroyed;!ve&&!je.corked&&!je.bufferProcessing&&je.bufferedRequest&&Ke(pe,je),_t?W.nextTick(Ue,pe,je,ve,pt):Ue(pe,je,ve,pt)}}(ue,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==pe.emitClose,this.autoDestroy=!!pe.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Q(this)}function ge(pe){var ue=this instanceof(z=z||Y("./_stream_duplex"));if(!ue&&!xe.call(ge,this))return new ge(pe);this._writableState=new te(pe,this,ue),this.writable=!0,pe&&("function"==typeof pe.write&&(this._write=pe.write),"function"==typeof pe.writev&&(this._writev=pe.writev),"function"==typeof pe.destroy&&(this._destroy=pe.destroy),"function"==typeof pe.final&&(this._final=pe.final)),x.call(this)}function Ge(pe,ue,je,_t,pt,ve){if(!je){var k=function(pe,ue,je){return!pe.objectMode&&!1!==pe.decodeStrings&&"string"==typeof ue&&(ue=O.from(ue,je)),ue}(ue,_t,pt);_t!==k&&(je=!0,pt="buffer",_t=k)}var N=ue.objectMode?1:_t.length;ue.length+=N;var B=ue.length<ue.highWaterMark;if(B||(ue.needDrain=!0),ue.writing||ue.corked){var Re=ue.lastBufferedRequest;ue.lastBufferedRequest={chunk:_t,encoding:pt,isBuf:je,callback:ve,next:null},Re?Re.next=ue.lastBufferedRequest:ue.bufferedRequest=ue.lastBufferedRequest,ue.bufferedRequestCount+=1}else st(pe,ue,!1,N,_t,pt,ve);return B}function st(pe,ue,je,_t,pt,ve,k){ue.writelen=_t,ue.writecb=k,ue.writing=!0,ue.sync=!0,ue.destroyed?ue.onwrite(new X("write")):je?pe._writev(pt,ue.onwrite):pe._write(pt,ve,ue.onwrite),ue.sync=!1}function Ue(pe,ue,je,_t){je||function(pe,ue){0===ue.length&&ue.needDrain&&(ue.needDrain=!1,pe.emit("drain"))}(pe,ue),ue.pendingcb--,_t(),Ne(pe,ue)}function Ke(pe,ue){ue.bufferProcessing=!0;var je=ue.bufferedRequest;if(pe._writev&&je&&je.next){var pt=new Array(ue.bufferedRequestCount),ve=ue.corkedRequestsFree;ve.entry=je;for(var k=0,N=!0;je;)pt[k]=je,je.isBuf||(N=!1),je=je.next,k+=1;pt.allBuffers=N,st(pe,ue,!0,ue.length,pt,"",ve.finish),ue.pendingcb++,ue.lastBufferedRequest=null,ve.next?(ue.corkedRequestsFree=ve.next,ve.next=null):ue.corkedRequestsFree=new Q(ue),ue.bufferedRequestCount=0}else{for(;je;){var B=je.chunk;if(st(pe,ue,!1,ue.objectMode?1:B.length,B,je.encoding,je.callback),je=je.next,ue.bufferedRequestCount--,ue.writing)break}null===je&&(ue.lastBufferedRequest=null)}ue.bufferedRequest=je,ue.bufferProcessing=!1}function Te(pe){return pe.ending&&0===pe.length&&null===pe.bufferedRequest&&!pe.finished&&!pe.writing}function Ve(pe,ue){pe._final(function(je){ue.pendingcb--,je&&se(pe,je),ue.prefinished=!0,pe.emit("prefinish"),Ne(pe,ue)})}function Ne(pe,ue){var je=Te(ue);if(je&&(function(pe,ue){!ue.prefinished&&!ue.finalCalled&&("function"!=typeof pe._final||ue.destroyed?(ue.prefinished=!0,pe.emit("prefinish")):(ue.pendingcb++,ue.finalCalled=!0,W.nextTick(Ve,pe,ue)))}(pe,ue),0===ue.pendingcb&&(ue.finished=!0,pe.emit("finish"),ue.autoDestroy))){var _t=pe._readableState;(!_t||_t.autoDestroy&&_t.endEmitted)&&pe.destroy()}return je}Y("inherits")(ge,x),te.prototype.getBuffer=function(){for(var ue=this.bufferedRequest,je=[];ue;)je.push(ue),ue=ue.next;return je},function(){try{Object.defineProperty(te.prototype,"buffer",{get:v.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(pe){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(xe=Function.prototype[Symbol.hasInstance],Object.defineProperty(ge,Symbol.hasInstance,{value:function(ue){return!!xe.call(this,ue)||this===ge&&ue&&ue._writableState instanceof te}})):xe=function(ue){return ue instanceof this},ge.prototype.pipe=function(){se(this,new I)},ge.prototype.write=function(pe,ue,je){var _t=this._writableState,pt=!1,ve=!_t.objectMode&&function(pe){return O.isBuffer(pe)||pe instanceof A}(pe);return ve&&!O.isBuffer(pe)&&(pe=function(pe){return O.from(pe)}(pe)),"function"==typeof ue&&(je=ue,ue=null),ve?ue="buffer":ue||(ue=_t.defaultEncoding),"function"!=typeof je&&(je=oe),_t.ending?function(pe,ue){var je=new $;se(pe,je),W.nextTick(ue,je)}(this,je):(ve||function(pe,ue,je,_t){var pt;return null===je?pt=new E:"string"!=typeof je&&!ue.objectMode&&(pt=new K("chunk",["string","Buffer"],je)),!pt||(se(pe,pt),W.nextTick(_t,pt),!1)}(this,_t,pe,je))&&(_t.pendingcb++,pt=Ge(this,_t,ve,pe,ue,je)),pt},ge.prototype.cork=function(){this._writableState.corked++},ge.prototype.uncork=function(){var pe=this._writableState;pe.corked&&(pe.corked--,!pe.writing&&!pe.corked&&!pe.bufferProcessing&&pe.bufferedRequest&&Ke(this,pe))},ge.prototype.setDefaultEncoding=function(ue){if("string"==typeof ue&&(ue=ue.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ue+"").toLowerCase())>-1))throw new Z(ue);return this._writableState.defaultEncoding=ue,this},Object.defineProperty(ge.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(ge.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),ge.prototype._write=function(pe,ue,je){je(new ce("_write()"))},ge.prototype._writev=null,ge.prototype.end=function(pe,ue,je){var _t=this._writableState;return"function"==typeof pe?(je=pe,pe=null,ue=null):"function"==typeof ue&&(je=ue,ue=null),null!=pe&&this.write(pe,ue),_t.corked&&(_t.corked=1,this.uncork()),_t.ending||function(pe,ue,je){ue.ending=!0,Ne(pe,ue),je&&(ue.finished?W.nextTick(je):pe.once("finish",je)),ue.ended=!0,pe.writable=!1}(this,_t,je),this},Object.defineProperty(ge.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(ge.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(ue){!this._writableState||(this._writableState.destroyed=ue)}}),ge.prototype.destroy=S.destroy,ge.prototype._undestroy=S.undestroy,ge.prototype._destroy=function(pe,ue){ue(pe)}}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(Y,Se,he){(function(W){(function(){"use strict";var j;function P(I,X,E){return X in I?Object.defineProperty(I,X,{value:E,enumerable:!0,configurable:!0,writable:!0}):I[X]=E,I}var Q=Y("./end-of-stream"),z=Symbol("lastResolve"),v=Symbol("lastReject"),x=Symbol("error"),O=Symbol("ended"),A=Symbol("lastPromise"),b=Symbol("handlePromise"),y=Symbol("stream");function S(I,X){return{value:I,done:X}}function T(I){var X=I[z];if(null!==X){var E=I[y].read();null!==E&&(I[A]=null,I[z]=null,I[v]=null,X(S(E,!1)))}}function V(I){W.nextTick(T,I)}var K=Object.getPrototypeOf(function(){}),ce=Object.setPrototypeOf((P(j={get stream(){return this[y]},next:function(){var X=this,E=this[x];if(null!==E)return Promise.reject(E);if(this[O])return Promise.resolve(S(void 0,!0));if(this[y].destroyed)return new Promise(function(oe,te){W.nextTick(function(){X[x]?te(X[x]):oe(S(void 0,!0))})});var Z,$=this[A];if($)Z=new Promise(function(I,X){return function(E,$){I.then(function(){X[O]?E(S(void 0,!0)):X[b](E,$)},$)}}($,this));else{var se=this[y].read();if(null!==se)return Promise.resolve(S(se,!1));Z=new Promise(this[b])}return this[A]=Z,Z}},Symbol.asyncIterator,function(){return this}),P(j,"return",function(){var X=this;return new Promise(function(E,$){X[y].destroy(null,function(Z){Z?$(Z):E(S(void 0,!0))})})}),j),K);Se.exports=function(X){var E,$=Object.create(ce,(P(E={},y,{value:X,writable:!0}),P(E,z,{value:null,writable:!0}),P(E,v,{value:null,writable:!0}),P(E,x,{value:null,writable:!0}),P(E,O,{value:X._readableState.endEmitted,writable:!0}),P(E,b,{value:function(se,oe){var te=$[y].read();te?($[A]=null,$[z]=null,$[v]=null,se(S(te,!1))):($[z]=se,$[v]=oe)},writable:!0}),E));return $[A]=null,Q(X,function(Z){if(Z&&"ERR_STREAM_PREMATURE_CLOSE"!==Z.code){var se=$[v];return null!==se&&($[A]=null,$[z]=null,$[v]=null,se(Z)),void($[x]=Z)}var oe=$[z];null!==oe&&($[A]=null,$[z]=null,$[v]=null,oe(S(void 0,!0))),$[O]=!0}),X.on("readable",V.bind(null,$)),$}}).call(this)}).call(this,Y("_process"))},{"./end-of-stream":76,_process:44}],74:[function(Y,Se,he){"use strict";function W(T,V){var R=Object.keys(T);if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(T);V&&(K=K.filter(function(ce){return Object.getOwnPropertyDescriptor(T,ce).enumerable})),R.push.apply(R,K)}return R}function P(T,V,R){return V in T?Object.defineProperty(T,V,{value:R,enumerable:!0,configurable:!0,writable:!0}):T[V]=R,T}function z(T,V){for(var R=0;R<V.length;R++){var K=V[R];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(T,K.key,K)}}var O=Y("buffer").Buffer,b=Y("util").inspect,y=b&&b.custom||"inspect";function S(T,V,R){O.prototype.copy.call(T,V,R)}Se.exports=function(){function T(){(function(T,V){if(!(T instanceof V))throw new TypeError("Cannot call a class as a function")})(this,T),this.head=null,this.tail=null,this.length=0}return function(T,V,R){V&&z(T.prototype,V),R&&z(T,R)}(T,[{key:"push",value:function(R){var K={data:R,next:null};this.length>0?this.tail.next=K:this.head=K,this.tail=K,++this.length}},{key:"unshift",value:function(R){var K={data:R,next:this.head};0===this.length&&(this.tail=K),this.head=K,++this.length}},{key:"shift",value:function(){if(0!==this.length){var R=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,R}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(R){if(0===this.length)return"";for(var K=this.head,ce=""+K.data;K=K.next;)ce+=R+K.data;return ce}},{key:"concat",value:function(R){if(0===this.length)return O.alloc(0);for(var K=O.allocUnsafe(R>>>0),ce=this.head,D=0;ce;)S(ce.data,K,D),D+=ce.data.length,ce=ce.next;return K}},{key:"consume",value:function(R,K){var ce;return R<this.head.data.length?(ce=this.head.data.slice(0,R),this.head.data=this.head.data.slice(R)):ce=R===this.head.data.length?this.shift():K?this._getString(R):this._getBuffer(R),ce}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(R){var K=this.head,ce=1,D=K.data;for(R-=D.length;K=K.next;){var I=K.data,X=R>I.length?I.length:R;if(D+=X===I.length?I:I.slice(0,R),0==(R-=X)){X===I.length?(++ce,this.head=K.next?K.next:this.tail=null):(this.head=K,K.data=I.slice(X));break}++ce}return this.length-=ce,D}},{key:"_getBuffer",value:function(R){var K=O.allocUnsafe(R),ce=this.head,D=1;for(ce.data.copy(K),R-=ce.data.length;ce=ce.next;){var I=ce.data,X=R>I.length?I.length:R;if(I.copy(K,K.length-R,0,X),0==(R-=X)){X===I.length?(++D,this.head=ce.next?ce.next:this.tail=null):(this.head=ce,ce.data=I.slice(X));break}++D}return this.length-=D,K}},{key:y,value:function(R,K){return b(this,function(T){for(var V=1;V<arguments.length;V++){var R=null!=arguments[V]?arguments[V]:{};V%2?W(Object(R),!0).forEach(function(K){P(T,K,R[K])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(R)):W(Object(R)).forEach(function(K){Object.defineProperty(T,K,Object.getOwnPropertyDescriptor(R,K))})}return T}({},K,{depth:0,customInspect:!1}))}}]),T}()},{buffer:6,util:3}],75:[function(Y,Se,he){(function(W){(function(){"use strict";function P(O,A){v(O,A),Q(O)}function Q(O){O._writableState&&!O._writableState.emitClose||O._readableState&&!O._readableState.emitClose||O.emit("close")}function v(O,A){O.emit("error",A)}Se.exports={destroy:function(O,A){var b=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(A?A(O):O&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,W.nextTick(v,this,O)):W.nextTick(v,this,O)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(O||null,function(T){!A&&T?b._writableState?b._writableState.errorEmitted?W.nextTick(Q,b):(b._writableState.errorEmitted=!0,W.nextTick(P,b,T)):W.nextTick(P,b,T):A?(W.nextTick(Q,b),A(T)):W.nextTick(Q,b)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(O,A){var b=O._readableState,y=O._writableState;b&&b.autoDestroy||y&&y.autoDestroy?O.destroy(A):O.emit("error",A)}}}).call(this)}).call(this,Y("_process"))},{_process:44}],76:[function(Y,Se,he){"use strict";var W=Y("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function P(){}Se.exports=function z(v,x,O){if("function"==typeof x)return z(v,null,x);x||(x={}),O=function(v){var x=!1;return function(){if(!x){x=!0;for(var O=arguments.length,A=new Array(O),b=0;b<O;b++)A[b]=arguments[b];v.apply(this,A)}}}(O||P);var A=x.readable||!1!==x.readable&&v.readable,b=x.writable||!1!==x.writable&&v.writable,y=function(){v.writable||T()},S=v._writableState&&v._writableState.finished,T=function(){b=!1,S=!0,A||O.call(v)},V=v._readableState&&v._readableState.endEmitted,R=function(){A=!1,V=!0,b||O.call(v)},K=function(X){O.call(v,X)},ce=function(){var X;return A&&!V?((!v._readableState||!v._readableState.ended)&&(X=new W),O.call(v,X)):b&&!S?((!v._writableState||!v._writableState.ended)&&(X=new W),O.call(v,X)):void 0},D=function(){v.req.on("finish",T)};return function(v){return v.setHeader&&"function"==typeof v.abort}(v)?(v.on("complete",T),v.on("abort",ce),v.req?D():v.on("request",D)):b&&!v._writableState&&(v.on("end",y),v.on("close",y)),v.on("end",R),v.on("finish",T),!1!==x.error&&v.on("error",K),v.on("close",ce),function(){v.removeListener("complete",T),v.removeListener("abort",ce),v.removeListener("request",D),v.req&&v.req.removeListener("finish",T),v.removeListener("end",y),v.removeListener("close",y),v.removeListener("finish",T),v.removeListener("end",R),v.removeListener("error",K),v.removeListener("close",ce)}}},{"../../../errors":67}],77:[function(Y,Se,he){Se.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(Y,Se,he){"use strict";var W;var P=Y("../../../errors").codes,Q=P.ERR_MISSING_ARGS,z=P.ERR_STREAM_DESTROYED;function v(T){if(T)throw T}function O(T,V,R,K){K=function(T){var V=!1;return function(){V||(V=!0,T.apply(void 0,arguments))}}(K);var ce=!1;T.on("close",function(){ce=!0}),void 0===W&&(W=Y("./end-of-stream")),W(T,{readable:V,writable:R},function(I){if(I)return K(I);ce=!0,K()});var D=!1;return function(I){if(!ce&&!D){if(D=!0,function(T){return T.setHeader&&"function"==typeof T.abort}(T))return T.abort();if("function"==typeof T.destroy)return T.destroy();K(I||new z("pipe"))}}}function A(T){T()}function b(T,V){return T.pipe(V)}function y(T){return T.length&&"function"==typeof T[T.length-1]?T.pop():v}Se.exports=function(){for(var T=arguments.length,V=new Array(T),R=0;R<T;R++)V[R]=arguments[R];var K=y(V);if(Array.isArray(V[0])&&(V=V[0]),V.length<2)throw new Q("streams");var ce,D=V.map(function(I,X){var E=X<V.length-1;return O(I,E,X>0,function(Z){ce||(ce=Z),Z&&D.forEach(A),!E&&(D.forEach(A),K(ce))})});return V.reduce(b)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(Y,Se,he){"use strict";var W=Y("../../../errors").codes.ERR_INVALID_OPT_VALUE;Se.exports={getHighWaterMark:function(Q,z,v,x){var O=function(Q,z,v){return null!=Q.highWaterMark?Q.highWaterMark:z?Q[v]:null}(z,x,v);if(null!=O){if(!isFinite(O)||Math.floor(O)!==O||O<0)throw new W(x?v:"highWaterMark",O);return Math.floor(O)}return Q.objectMode?16:16384}}},{"../../../errors":67}],80:[function(Y,Se,he){Se.exports=Y("events").EventEmitter},{events:8}],81:[function(Y,Se,he){(he=Se.exports=Y("./lib/_stream_readable.js")).Stream=he,he.Readable=he,he.Writable=Y("./lib/_stream_writable.js"),he.Duplex=Y("./lib/_stream_duplex.js"),he.Transform=Y("./lib/_stream_transform.js"),he.PassThrough=Y("./lib/_stream_passthrough.js"),he.finished=Y("./lib/internal/streams/end-of-stream.js"),he.pipeline=Y("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(Y,Se,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),function(j){for(var P in j)he.hasOwnProperty(P)||(he[P]=j[P])}(Y("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(Y,Se,he){"use strict";function j(z){const v=[];let x=0;for(;x<z.length;)switch(z[x]){case"/":if("."===z[x+1])if("."===z[x+2]){if(!Q(z[x+3])){v.push([]),x++;break}v.pop(),z[x+3]||v.push([]),x+=3}else{if(!Q(z[x+2])){v.push([]),x++;break}z[x+2]||v.push([]),x+=2}else v.push([]),x++;break;case"#":case"?":v.length||v.push([]),v[v.length-1].push(z.substr(x)),x=z.length;break;default:v.length||v.push([]),v[v.length-1].push(z[x]),x++}return"/"+v.map(O=>O.join("")).join("/")}function P(z,v){let x=v+1;v>=0?"/"===z[v+1]&&"/"===z[v+2]&&(x=v+3):"/"===z[0]&&"/"===z[1]&&(x=2);const O=z.indexOf("/",x);return O<0?z:z.substr(0,O)+j(z.substr(O))}function Q(z){return!z||"#"===z||"?"===z||"/"===z}Object.defineProperty(he,"__esModule",{value:!0}),he.resolve=function(z,v){const x=(v=v||"").indexOf("#");if(x>0&&(v=v.substr(0,x)),!z.length){if(v.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${v}' for value '${z}'`);return v}if(z.startsWith("?")){const V=v.indexOf("?");return V>0&&(v=v.substr(0,V)),v+z}if(z.startsWith("#"))return v+z;if(!v.length){const V=z.indexOf(":");if(V<0)throw new Error(`Found invalid relative IRI '${z}' for a missing baseIRI`);return P(z,V)}const O=z.indexOf(":");if(O>=0)return P(z,O);const A=v.indexOf(":");if(A<0)throw new Error(`Found invalid baseIRI '${v}' for value '${z}'`);const b=v.substr(0,A+1);if(0===z.indexOf("//"))return b+P(z,O);let y;if(v.indexOf("//",A)===A+1){if(y=v.indexOf("/",A+3),y<0)return v.length>A+3?v+"/"+P(z,O):b+P(z,O)}else if(y=v.indexOf("/",A+1),y<0)return b+P(z,O);if(0===z.indexOf("/"))return v.substr(0,y)+j(z);let S=v.substr(y);const T=S.lastIndexOf("/");return T>=0&&T<S.length-1&&(S=S.substr(0,T+1),"."===z[0]&&"."!==z[1]&&"/"!==z[1]&&z[2]&&(z=z.substr(1))),z=j(z=S+z),v.substr(0,y)+z},he.removeDotSegments=j,he.removeDotSegmentsOfPath=P},{}],84:[function(Y,Se,he){var W=Y("buffer"),j=W.Buffer;function P(z,v){for(var x in z)v[x]=z[x]}function Q(z,v,x){return j(z,v,x)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Se.exports=W:(P(W,he),he.Buffer=Q),Q.prototype=Object.create(j.prototype),P(j,Q),Q.from=function(z,v,x){if("number"==typeof z)throw new TypeError("Argument must not be a number");return j(z,v,x)},Q.alloc=function(z,v,x){if("number"!=typeof z)throw new TypeError("Argument must be a number");var O=j(z);return void 0!==v?"string"==typeof x?O.fill(v,x):O.fill(v):O.fill(0),O},Q.allocUnsafe=function(z){if("number"!=typeof z)throw new TypeError("Argument must be a number");return j(z)},Q.allocUnsafeSlow=function(z){if("number"!=typeof z)throw new TypeError("Argument must be a number");return W.SlowBuffer(z)}},{buffer:6}],85:[function(Y,Se,he){(function(W){(function(){!function(j){j.parser=function(q,G){return new Q(q,G)},j.SAXParser=Q,j.SAXStream=y,j.createStream=function(q,G){return new y(q,G)},j.MAX_BUFFER_LENGTH=65536;var O,P=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function Q(q,G){if(!(this instanceof Q))return new Q(q,G);var pe=this;(function(q){for(var G=0,pe=P.length;G<pe;G++)q[P[G]]=""})(pe),pe.q=pe.c="",pe.bufferCheckPosition=j.MAX_BUFFER_LENGTH,pe.opt=G||{},pe.opt.lowercase=pe.opt.lowercase||pe.opt.lowercasetags,pe.looseCase=pe.opt.lowercase?"toLowerCase":"toUpperCase",pe.tags=[],pe.closed=pe.closedRoot=pe.sawRoot=!1,pe.tag=pe.error=null,pe.strict=!!q,pe.noscript=!(!q&&!pe.opt.noscript),pe.state=te.BEGIN,pe.strictEntities=pe.opt.strictEntities,pe.ENTITIES=Object.create(pe.strictEntities?j.XML_ENTITIES:j.ENTITIES),pe.attribList=[],pe.opt.xmlns&&(pe.ns=Object.create(K)),pe.trackPosition=!1!==pe.opt.position,pe.trackPosition&&(pe.position=pe.line=pe.column=0),ge(pe,"onready")}j.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(q){function G(){}return G.prototype=q,new G}),Object.keys||(Object.keys=function(q){var G=[];for(var pe in q)q.hasOwnProperty(pe)&&G.push(pe);return G}),Q.prototype={end:function(){st(this)},write:function(q){var G=this;if(this.error)throw this.error;if(G.closed)return Ge(G,"Cannot write after close. Assign an onready handler.");if(null===q)return st(G);"object"==typeof q&&(q=q.toString());for(var pe=0,ue="";ue=$e(q,pe++),G.c=ue,ue;)switch(G.trackPosition&&(G.position++,"\n"===ue?(G.line++,G.column=0):G.column++),G.state){case te.BEGIN:if(G.state=te.BEGIN_WHITESPACE,"\ufeff"===ue)continue;Ve(G,ue);continue;case te.BEGIN_WHITESPACE:Ve(G,ue);continue;case te.TEXT:if(G.sawRoot&&!G.closedRoot){for(var je=pe-1;ue&&"<"!==ue&&"&"!==ue;)(ue=$e(q,pe++))&&G.trackPosition&&(G.position++,"\n"===ue?(G.line++,G.column=0):G.column++);G.textNode+=q.substring(je,pe-1)}"<"!==ue||G.sawRoot&&G.closedRoot&&!G.strict?(!E(ue)&&(!G.sawRoot||G.closedRoot)&&Xe(G,"Text data outside of root node."),"&"===ue?G.state=te.TEXT_ENTITY:G.textNode+=ue):(G.state=te.OPEN_WAKA,G.startTagPosition=G.position);continue;case te.SCRIPT:"<"===ue?G.state=te.SCRIPT_ENDING:G.script+=ue;continue;case te.SCRIPT_ENDING:"/"===ue?G.state=te.CLOSE_TAG:(G.script+="<"+ue,G.state=te.SCRIPT);continue;case te.OPEN_WAKA:"!"===ue?(G.state=te.SGML_DECL,G.sgmlDecl=""):E(ue)||(se(ce,ue)?(G.state=te.OPEN_TAG,G.tagName=ue):"/"===ue?(G.state=te.CLOSE_TAG,G.tagName=""):"?"===ue?(G.state=te.PROC_INST,G.procInstName=G.procInstBody=""):(Xe(G,"Unencoded <"),G.startTagPosition+1<G.position&&(ue=new Array(G.position-G.startTagPosition).join(" ")+ue),G.textNode+="<"+ue,G.state=te.TEXT));continue;case te.SGML_DECL:"[CDATA["===(G.sgmlDecl+ue).toUpperCase()?(ne(G,"onopencdata"),G.state=te.CDATA,G.sgmlDecl="",G.cdata=""):G.sgmlDecl+ue==="--"?(G.state=te.COMMENT,G.comment="",G.sgmlDecl=""):"DOCTYPE"===(G.sgmlDecl+ue).toUpperCase()?(G.state=te.DOCTYPE,(G.doctype||G.sawRoot)&&Xe(G,"Inappropriately located doctype declaration"),G.doctype="",G.sgmlDecl=""):">"===ue?(ne(G,"onsgmldeclaration",G.sgmlDecl),G.sgmlDecl="",G.state=te.TEXT):($(ue)&&(G.state=te.SGML_DECL_QUOTED),G.sgmlDecl+=ue);continue;case te.SGML_DECL_QUOTED:ue===G.q&&(G.state=te.SGML_DECL,G.q=""),G.sgmlDecl+=ue;continue;case te.DOCTYPE:">"===ue?(G.state=te.TEXT,ne(G,"ondoctype",G.doctype),G.doctype=!0):(G.doctype+=ue,"["===ue?G.state=te.DOCTYPE_DTD:$(ue)&&(G.state=te.DOCTYPE_QUOTED,G.q=ue));continue;case te.DOCTYPE_QUOTED:G.doctype+=ue,ue===G.q&&(G.q="",G.state=te.DOCTYPE);continue;case te.DOCTYPE_DTD:G.doctype+=ue,"]"===ue?G.state=te.DOCTYPE:$(ue)&&(G.state=te.DOCTYPE_DTD_QUOTED,G.q=ue);continue;case te.DOCTYPE_DTD_QUOTED:G.doctype+=ue,ue===G.q&&(G.state=te.DOCTYPE_DTD,G.q="");continue;case te.COMMENT:"-"===ue?G.state=te.COMMENT_ENDING:G.comment+=ue;continue;case te.COMMENT_ENDING:"-"===ue?(G.state=te.COMMENT_ENDED,G.comment=Ie(G.opt,G.comment),G.comment&&ne(G,"oncomment",G.comment),G.comment=""):(G.comment+="-"+ue,G.state=te.COMMENT);continue;case te.COMMENT_ENDED:">"!==ue?(Xe(G,"Malformed comment"),G.comment+="--"+ue,G.state=te.COMMENT):G.state=te.TEXT;continue;case te.CDATA:"]"===ue?G.state=te.CDATA_ENDING:G.cdata+=ue;continue;case te.CDATA_ENDING:"]"===ue?G.state=te.CDATA_ENDING_2:(G.cdata+="]"+ue,G.state=te.CDATA);continue;case te.CDATA_ENDING_2:">"===ue?(G.cdata&&ne(G,"oncdata",G.cdata),ne(G,"onclosecdata"),G.cdata="",G.state=te.TEXT):"]"===ue?G.cdata+="]":(G.cdata+="]]"+ue,G.state=te.CDATA);continue;case te.PROC_INST:"?"===ue?G.state=te.PROC_INST_ENDING:E(ue)?G.state=te.PROC_INST_BODY:G.procInstName+=ue;continue;case te.PROC_INST_BODY:if(!G.procInstBody&&E(ue))continue;"?"===ue?G.state=te.PROC_INST_ENDING:G.procInstBody+=ue;continue;case te.PROC_INST_ENDING:">"===ue?(ne(G,"onprocessinginstruction",{name:G.procInstName,body:G.procInstBody}),G.procInstName=G.procInstBody="",G.state=te.TEXT):(G.procInstBody+="?"+ue,G.state=te.PROC_INST_BODY);continue;case te.OPEN_TAG:se(D,ue)?G.tagName+=ue:(tt(G),">"===ue?Le(G):"/"===ue?G.state=te.OPEN_TAG_SLASH:(E(ue)||Xe(G,"Invalid character in tag name"),G.state=te.ATTRIB));continue;case te.OPEN_TAG_SLASH:">"===ue?(Le(G,!0),Ke(G)):(Xe(G,"Forward-slash in opening tag not followed by >"),G.state=te.ATTRIB);continue;case te.ATTRIB:if(E(ue))continue;">"===ue?Le(G):"/"===ue?G.state=te.OPEN_TAG_SLASH:se(ce,ue)?(G.attribName=ue,G.attribValue="",G.state=te.ATTRIB_NAME):Xe(G,"Invalid attribute name");continue;case te.ATTRIB_NAME:"="===ue?G.state=te.ATTRIB_VALUE:">"===ue?(Xe(G,"Attribute without value"),G.attribValue=G.attribName,Ue(G),Le(G)):E(ue)?G.state=te.ATTRIB_NAME_SAW_WHITE:se(D,ue)?G.attribName+=ue:Xe(G,"Invalid attribute name");continue;case te.ATTRIB_NAME_SAW_WHITE:if("="===ue)G.state=te.ATTRIB_VALUE;else{if(E(ue))continue;Xe(G,"Attribute without value"),G.tag.attributes[G.attribName]="",G.attribValue="",ne(G,"onattribute",{name:G.attribName,value:""}),G.attribName="",">"===ue?Le(G):se(ce,ue)?(G.attribName=ue,G.state=te.ATTRIB_NAME):(Xe(G,"Invalid attribute name"),G.state=te.ATTRIB)}continue;case te.ATTRIB_VALUE:if(E(ue))continue;$(ue)?(G.q=ue,G.state=te.ATTRIB_VALUE_QUOTED):(Xe(G,"Unquoted attribute value"),G.state=te.ATTRIB_VALUE_UNQUOTED,G.attribValue=ue);continue;case te.ATTRIB_VALUE_QUOTED:if(ue!==G.q){"&"===ue?G.state=te.ATTRIB_VALUE_ENTITY_Q:G.attribValue+=ue;continue}Ue(G),G.q="",G.state=te.ATTRIB_VALUE_CLOSED;continue;case te.ATTRIB_VALUE_CLOSED:E(ue)?G.state=te.ATTRIB:">"===ue?Le(G):"/"===ue?G.state=te.OPEN_TAG_SLASH:se(ce,ue)?(Xe(G,"No whitespace between attributes"),G.attribName=ue,G.attribValue="",G.state=te.ATTRIB_NAME):Xe(G,"Invalid attribute name");continue;case te.ATTRIB_VALUE_UNQUOTED:if(!Z(ue)){"&"===ue?G.state=te.ATTRIB_VALUE_ENTITY_U:G.attribValue+=ue;continue}Ue(G),">"===ue?Le(G):G.state=te.ATTRIB;continue;case te.CLOSE_TAG:if(G.tagName)">"===ue?Ke(G):se(D,ue)?G.tagName+=ue:G.script?(G.script+="</"+G.tagName,G.tagName="",G.state=te.SCRIPT):(E(ue)||Xe(G,"Invalid tagname in closing tag"),G.state=te.CLOSE_TAG_SAW_WHITE);else{if(E(ue))continue;oe(ce,ue)?G.script?(G.script+="</"+ue,G.state=te.SCRIPT):Xe(G,"Invalid tagname in closing tag."):G.tagName=ue}continue;case te.CLOSE_TAG_SAW_WHITE:if(E(ue))continue;">"===ue?Ke(G):Xe(G,"Invalid characters in closing tag");continue;case te.TEXT_ENTITY:case te.ATTRIB_VALUE_ENTITY_Q:case te.ATTRIB_VALUE_ENTITY_U:var pt,ve;switch(G.state){case te.TEXT_ENTITY:pt=te.TEXT,ve="textNode";break;case te.ATTRIB_VALUE_ENTITY_Q:pt=te.ATTRIB_VALUE_QUOTED,ve="attribValue";break;case te.ATTRIB_VALUE_ENTITY_U:pt=te.ATTRIB_VALUE_UNQUOTED,ve="attribValue"}";"===ue?(G[ve]+=Te(G),G.entity="",G.state=pt):se(G.entity.length?X:I,ue)?G.entity+=ue:(Xe(G,"Invalid character in entity name"),G[ve]+="&"+G.entity+ue,G.entity="",G.state=pt);continue;default:throw new Error(G,"Unknown state: "+G.state)}return G.position>=G.bufferCheckPosition&&function(q){for(var G=Math.max(j.MAX_BUFFER_LENGTH,10),pe=0,ue=0,je=P.length;ue<je;ue++){var _t=q[P[ue]].length;if(_t>G)switch(P[ue]){case"textNode":_e(q);break;case"cdata":ne(q,"oncdata",q.cdata),q.cdata="";break;case"script":ne(q,"onscript",q.script),q.script="";break;default:Ge(q,"Max buffer length exceeded: "+P[ue])}pe=Math.max(pe,_t)}q.bufferCheckPosition=j.MAX_BUFFER_LENGTH-pe+q.position}(G),G},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(q){_e(q),""!==q.cdata&&(ne(q,"oncdata",q.cdata),q.cdata=""),""!==q.script&&(ne(q,"onscript",q.script),q.script="")}(this)}};try{O=Y("stream").Stream}catch(q){O=function(){}}var A=j.EVENTS.filter(function(q){return"error"!==q&&"end"!==q});function y(q,G){if(!(this instanceof y))return new y(q,G);O.apply(this),this._parser=new Q(q,G),this.writable=!0,this.readable=!0;var pe=this;this._parser.onend=function(){pe.emit("end")},this._parser.onerror=function(ue){pe.emit("error",ue),pe._parser.error=null},this._decoder=null,A.forEach(function(ue){Object.defineProperty(pe,"on"+ue,{get:function(){return pe._parser["on"+ue]},set:function(je){if(!je)return pe.removeAllListeners(ue),pe._parser["on"+ue]=je,je;pe.on(ue,je)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(O.prototype,{constructor:{value:y}})).write=function(q){if("function"==typeof W&&"function"==typeof W.isBuffer&&W.isBuffer(q)){if(!this._decoder){var G=Y("string_decoder").StringDecoder;this._decoder=new G("utf8")}q=this._decoder.write(q)}return this._parser.write(q.toString()),this.emit("data",q),!0},y.prototype.end=function(q){return q&&q.length&&this.write(q),this._parser.end(),!0},y.prototype.on=function(q,G){var pe=this;return!pe._parser["on"+q]&&-1!==A.indexOf(q)&&(pe._parser["on"+q]=function(){var ue=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);ue.splice(0,0,q),pe.emit.apply(pe,ue)}),O.prototype.on.call(pe,q,G)};var V="http://www.w3.org/XML/1998/namespace",R="http://www.w3.org/2000/xmlns/",K={xml:V,xmlns:R},ce=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,D=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,I=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,X=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(q){return" "===q||"\n"===q||"\r"===q||"\t"===q}function $(q){return'"'===q||"'"===q}function Z(q){return">"===q||E(q)}function se(q,G){return q.test(G)}function oe(q,G){return!se(q,G)}var q,G,pe,te=0;for(var xe in j.STATE={BEGIN:te++,BEGIN_WHITESPACE:te++,TEXT:te++,TEXT_ENTITY:te++,OPEN_WAKA:te++,SGML_DECL:te++,SGML_DECL_QUOTED:te++,DOCTYPE:te++,DOCTYPE_QUOTED:te++,DOCTYPE_DTD:te++,DOCTYPE_DTD_QUOTED:te++,COMMENT_STARTING:te++,COMMENT:te++,COMMENT_ENDING:te++,COMMENT_ENDED:te++,CDATA:te++,CDATA_ENDING:te++,CDATA_ENDING_2:te++,PROC_INST:te++,PROC_INST_BODY:te++,PROC_INST_ENDING:te++,OPEN_TAG:te++,OPEN_TAG_SLASH:te++,ATTRIB:te++,ATTRIB_NAME:te++,ATTRIB_NAME_SAW_WHITE:te++,ATTRIB_VALUE:te++,ATTRIB_VALUE_QUOTED:te++,ATTRIB_VALUE_CLOSED:te++,ATTRIB_VALUE_UNQUOTED:te++,ATTRIB_VALUE_ENTITY_Q:te++,ATTRIB_VALUE_ENTITY_U:te++,CLOSE_TAG:te++,CLOSE_TAG_SAW_WHITE:te++,SCRIPT:te++,SCRIPT_ENDING:te++},j.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},j.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(j.ENTITIES).forEach(function(q){var G=j.ENTITIES[q],pe="number"==typeof G?String.fromCharCode(G):G;j.ENTITIES[q]=pe}),j.STATE)j.STATE[j.STATE[xe]]=xe;function ge(q,G,pe){q[G]&&q[G](pe)}function ne(q,G,pe){q.textNode&&_e(q),ge(q,G,pe)}function _e(q){q.textNode=Ie(q.opt,q.textNode),q.textNode&&ge(q,"ontext",q.textNode),q.textNode=""}function Ie(q,G){return q.trim&&(G=G.trim()),q.normalize&&(G=G.replace(/\s+/g," ")),G}function Ge(q,G){return _e(q),q.trackPosition&&(G+="\nLine: "+q.line+"\nColumn: "+q.column+"\nChar: "+q.c),G=new Error(G),q.error=G,ge(q,"onerror",G),q}function st(q){return q.sawRoot&&!q.closedRoot&&Xe(q,"Unclosed root tag"),q.state!==te.BEGIN&&q.state!==te.BEGIN_WHITESPACE&&q.state!==te.TEXT&&Ge(q,"Unexpected end"),_e(q),q.c="",q.closed=!0,ge(q,"onend"),Q.call(q,q.strict,q.opt),q}function Xe(q,G){if("object"!=typeof q||!(q instanceof Q))throw new Error("bad call to strictFail");q.strict&&Ge(q,G)}function tt(q){q.strict||(q.tagName=q.tagName[q.looseCase]());var G=q.tags[q.tags.length-1]||q,pe=q.tag={name:q.tagName,attributes:{}};q.opt.xmlns&&(pe.ns=G.ns),q.attribList.length=0,ne(q,"onopentagstart",pe)}function Ye(q,G){var ue=q.indexOf(":")<0?["",q]:q.split(":"),je=ue[0],_t=ue[1];return G&&"xmlns"===q&&(je="xmlns",_t=""),{prefix:je,local:_t}}function Ue(q){if(q.strict||(q.attribName=q.attribName[q.looseCase]()),-1!==q.attribList.indexOf(q.attribName)||q.tag.attributes.hasOwnProperty(q.attribName))q.attribName=q.attribValue="";else{if(q.opt.xmlns){var G=Ye(q.attribName,!0),ue=G.local;if("xmlns"===G.prefix)if("xml"===ue&&q.attribValue!==V)Xe(q,"xml: prefix must be bound to "+V+"\nActual: "+q.attribValue);else if("xmlns"===ue&&q.attribValue!==R)Xe(q,"xmlns: prefix must be bound to "+R+"\nActual: "+q.attribValue);else{var je=q.tag,_t=q.tags[q.tags.length-1]||q;je.ns===_t.ns&&(je.ns=Object.create(_t.ns)),je.ns[ue]=q.attribValue}q.attribList.push([q.attribName,q.attribValue])}else q.tag.attributes[q.attribName]=q.attribValue,ne(q,"onattribute",{name:q.attribName,value:q.attribValue});q.attribName=q.attribValue=""}}function Le(q,G){if(q.opt.xmlns){var pe=q.tag,ue=Ye(q.tagName);pe.prefix=ue.prefix,pe.local=ue.local,pe.uri=pe.ns[ue.prefix]||"",pe.prefix&&!pe.uri&&(Xe(q,"Unbound namespace prefix: "+JSON.stringify(q.tagName)),pe.uri=ue.prefix),pe.ns&&(q.tags[q.tags.length-1]||q).ns!==pe.ns&&Object.keys(pe.ns).forEach(function(In){ne(q,"onopennamespace",{prefix:In,uri:pe.ns[In]})});for(var _t=0,pt=q.attribList.length;_t<pt;_t++){var ve=q.attribList[_t],k=ve[0],N=ve[1],B=Ye(k,!0),Re=B.prefix,St=""===Re?"":pe.ns[Re]||"",Rt={name:k,value:N,prefix:Re,local:B.local,uri:St};Re&&"xmlns"!==Re&&!St&&(Xe(q,"Unbound namespace prefix: "+JSON.stringify(Re)),Rt.uri=Re),q.tag.attributes[k]=Rt,ne(q,"onattribute",Rt)}q.attribList.length=0}q.tag.isSelfClosing=!!G,q.sawRoot=!0,q.tags.push(q.tag),ne(q,"onopentag",q.tag),G||(q.state=q.noscript||"script"!==q.tagName.toLowerCase()?te.TEXT:te.SCRIPT,q.tag=null,q.tagName=""),q.attribName=q.attribValue="",q.attribList.length=0}function Ke(q){if(!q.tagName)return Xe(q,"Weird empty close tag."),q.textNode+="</>",void(q.state=te.TEXT);if(q.script){if("script"!==q.tagName)return q.script+="</"+q.tagName+">",q.tagName="",void(q.state=te.SCRIPT);ne(q,"onscript",q.script),q.script=""}var G=q.tags.length,pe=q.tagName;q.strict||(pe=pe[q.looseCase]());for(var ue=pe;G--&&q.tags[G].name!==ue;)Xe(q,"Unexpected close tag");if(G<0)return Xe(q,"Unmatched closing tag: "+q.tagName),q.textNode+="</"+q.tagName+">",void(q.state=te.TEXT);q.tagName=pe;for(var _t=q.tags.length;_t-- >G;){var pt=q.tag=q.tags.pop();q.tagName=q.tag.name,ne(q,"onclosetag",q.tagName);var ve={};for(var k in pt.ns)ve[k]=pt.ns[k];q.opt.xmlns&&pt.ns!==(q.tags[q.tags.length-1]||q).ns&&Object.keys(pt.ns).forEach(function(B){ne(q,"onclosenamespace",{prefix:B,uri:pt.ns[B]})})}0===G&&(q.closedRoot=!0),q.tagName=q.attribValue=q.attribName="",q.attribList.length=0,q.state=te.TEXT}function Te(q){var ue,G=q.entity,pe=G.toLowerCase(),je="";return q.ENTITIES[G]?q.ENTITIES[G]:q.ENTITIES[pe]?q.ENTITIES[pe]:("#"===(G=pe).charAt(0)&&("x"===G.charAt(1)?(G=G.slice(2),je=(ue=parseInt(G,16)).toString(16)):(G=G.slice(1),je=(ue=parseInt(G,10)).toString(10))),G=G.replace(/^0+/,""),isNaN(ue)||je.toLowerCase()!==G?(Xe(q,"Invalid character entity"),"&"+q.entity+";"):String.fromCodePoint(ue))}function Ve(q,G){"<"===G?(q.state=te.OPEN_WAKA,q.startTagPosition=q.position):E(G)||(Xe(q,"Non-whitespace before first tag."),q.textNode=G,q.state=te.TEXT)}function $e(q,G){var pe="";return G<q.length&&(pe=q.charAt(G)),pe}te=j.STATE,String.fromCodePoint||(q=String.fromCharCode,G=Math.floor,pe=function(){var ue=16384,je=[],ve=-1,k=arguments.length;if(!k)return"";for(var N="";++ve<k;){var B=Number(arguments[ve]);if(!isFinite(B)||B<0||B>1114111||G(B)!==B)throw RangeError("Invalid code point: "+B);B<=65535?je.push(B):je.push(55296+((B-=65536)>>10),B%1024+56320),(ve+1===k||je.length>ue)&&(N+=q.apply(null,je),je.length=0)}return N},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:pe,configurable:!0,writable:!0}):String.fromCodePoint=pe)}(void 0===he?this.sax={}:he)}).call(this)}).call(this,Y("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(Y,Se,he){(function(W,j){(function(){!function(P,Q){"use strict";if(!P.setImmediate){var A,z=1,v={},x=!1,O=P.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(P);X=X&&X.setTimeout?X:P,"[object process]"==={}.toString.call(P.process)?A=function(E){W.nextTick(function(){T(E)})}:function(){if(P.postMessage&&!P.importScripts){var E=!0,$=P.onmessage;return P.onmessage=function(){E=!1},P.postMessage("","*"),P.onmessage=$,E}}()?(E="setImmediate$"+Math.random()+"$",$=function(Z){Z.source===P&&"string"==typeof Z.data&&0===Z.data.indexOf(E)&&T(+Z.data.slice(E.length))},P.addEventListener?P.addEventListener("message",$,!1):P.attachEvent("onmessage",$),A=function(Z){P.postMessage(E+Z,"*")}):P.MessageChannel?function(){var E=new MessageChannel;E.port1.onmessage=function($){T($.data)},A=function($){E.port2.postMessage($)}}():O&&"onreadystatechange"in O.createElement("script")?function(){var E=O.documentElement;A=function($){var Z=O.createElement("script");Z.onreadystatechange=function(){T($),Z.onreadystatechange=null,E.removeChild(Z),Z=null},E.appendChild(Z)}}():A=function(E){setTimeout(T,0,E)},X.setImmediate=function(E){"function"!=typeof E&&(E=new Function(""+E));for(var $=new Array(arguments.length-1),Z=0;Z<$.length;Z++)$[Z]=arguments[Z+1];return v[z]={callback:E,args:$},A(z),z++},X.clearImmediate=y}var E,$;function y(E){delete v[E]}function T(E){if(x)setTimeout(T,0,E);else{var $=v[E];if($){x=!0;try{!function(E){var $=E.callback,Z=E.args;switch(Z.length){case 0:$();break;case 1:$(Z[0]);break;case 2:$(Z[0],Z[1]);break;case 3:$(Z[0],Z[1],Z[2]);break;default:$.apply(void 0,Z)}}($)}finally{y(E),x=!1}}}}}("undefined"==typeof self?void 0===j?this:j:self)}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(Y,Se,he){Se.exports=P;var W=Y("events").EventEmitter;function P(){W.call(this)}Y("inherits")(P,W),P.Readable=Y("readable-stream/lib/_stream_readable.js"),P.Writable=Y("readable-stream/lib/_stream_writable.js"),P.Duplex=Y("readable-stream/lib/_stream_duplex.js"),P.Transform=Y("readable-stream/lib/_stream_transform.js"),P.PassThrough=Y("readable-stream/lib/_stream_passthrough.js"),P.finished=Y("readable-stream/lib/internal/streams/end-of-stream.js"),P.pipeline=Y("readable-stream/lib/internal/streams/pipeline.js"),P.Stream=P,P.prototype.pipe=function(Q,z){var v=this;function x(V){Q.writable&&!1===Q.write(V)&&v.pause&&v.pause()}function O(){v.readable&&v.resume&&v.resume()}v.on("data",x),Q.on("drain",O),!Q._isStdio&&(!z||!1!==z.end)&&(v.on("end",b),v.on("close",y));var A=!1;function b(){A||(A=!0,Q.end())}function y(){A||(A=!0,"function"==typeof Q.destroy&&Q.destroy())}function S(V){if(T(),0===W.listenerCount(this,"error"))throw V}function T(){v.removeListener("data",x),Q.removeListener("drain",O),v.removeListener("end",b),v.removeListener("close",y),v.removeListener("error",S),Q.removeListener("error",S),v.removeListener("end",T),v.removeListener("close",T),Q.removeListener("close",T)}return v.on("error",S),Q.on("error",S),v.on("end",T),v.on("close",T),Q.on("close",T),Q.emit("pipe",v),Q}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(Y,Se,he){arguments[4][5][0].apply(he,arguments)},{dup:5,"safe-buffer":84}],89:[function(Y,Se,he){(function(W,j){(function(){var P=Y("process/browser.js").nextTick,Q=Function.prototype.apply,z=Array.prototype.slice,v={},x=0;function O(A,b){this._id=A,this._clearFn=b}he.setTimeout=function(){return new O(Q.call(setTimeout,window,arguments),clearTimeout)},he.setInterval=function(){return new O(Q.call(setInterval,window,arguments),clearInterval)},he.clearTimeout=he.clearInterval=function(A){A.close()},O.prototype.unref=O.prototype.ref=function(){},O.prototype.close=function(){this._clearFn.call(window,this._id)},he.enroll=function(A,b){clearTimeout(A._idleTimeoutId),A._idleTimeout=b},he.unenroll=function(A){clearTimeout(A._idleTimeoutId),A._idleTimeout=-1},he._unrefActive=he.active=function(A){clearTimeout(A._idleTimeoutId);var b=A._idleTimeout;b>=0&&(A._idleTimeoutId=setTimeout(function(){A._onTimeout&&A._onTimeout()},b))},he.setImmediate="function"==typeof W?W:function(A){var b=x++,y=!(arguments.length<2)&&z.call(arguments,1);return v[b]=!0,P(function(){v[b]&&(y?A.apply(null,y):A.call(null),he.clearImmediate(b))}),b},he.clearImmediate="function"==typeof j?j:function(A){delete v[A]}}).call(this)}).call(this,Y("timers").setImmediate,Y("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(Y,Se,he){(function(W){(function(){function P(Q){try{if(!W.localStorage)return!1}catch(v){return!1}var z=W.localStorage[Q];return null!=z&&"true"===String(z).toLowerCase()}Se.exports=function(Q,z){if(P("noDeprecation"))return Q;var v=!1;return function(){if(!v){if(P("throwDeprecation"))throw new Error(z);P("traceDeprecation")?console.trace(z):console.warn(z),v=!0}return Q.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(Y,Se,he){"use strict";Se.exports=function(W){W.prototype[Symbol.iterator]=function*(){for(let j=this.head;j;j=j.next)yield j.value}}},{}],92:[function(Y,Se,he){"use strict";function W(v){var x=this;if(x instanceof W||(x=new W),x.tail=null,x.head=null,x.length=0,v&&"function"==typeof v.forEach)v.forEach(function(b){x.push(b)});else if(arguments.length>0)for(var O=0,A=arguments.length;O<A;O++)x.push(arguments[O]);return x}function j(v,x,O){var A=x===v.head?new z(O,null,x,v):new z(O,x,x.next,v);return null===A.next&&(v.tail=A),null===A.prev&&(v.head=A),v.length++,A}function P(v,x){v.tail=new z(x,v.tail,null,v),v.head||(v.head=v.tail),v.length++}function Q(v,x){v.head=new z(x,null,v.head,v),v.tail||(v.tail=v.head),v.length++}function z(v,x,O,A){if(!(this instanceof z))return new z(v,x,O,A);this.list=A,this.value=v,x?(x.next=this,this.prev=x):this.prev=null,O?(O.prev=this,this.next=O):this.next=null}Se.exports=W,W.Node=z,W.create=W,W.prototype.removeNode=function(v){if(v.list!==this)throw new Error("removing node which does not belong to this list");var x=v.next,O=v.prev;return x&&(x.prev=O),O&&(O.next=x),v===this.head&&(this.head=x),v===this.tail&&(this.tail=O),v.list.length--,v.next=null,v.prev=null,v.list=null,x},W.prototype.unshiftNode=function(v){if(v!==this.head){v.list&&v.list.removeNode(v);var x=this.head;v.list=this,v.next=x,x&&(x.prev=v),this.head=v,this.tail||(this.tail=v),this.length++}},W.prototype.pushNode=function(v){if(v!==this.tail){v.list&&v.list.removeNode(v);var x=this.tail;v.list=this,v.prev=x,x&&(x.next=v),this.tail=v,this.head||(this.head=v),this.length++}},W.prototype.push=function(){for(var v=0,x=arguments.length;v<x;v++)P(this,arguments[v]);return this.length},W.prototype.unshift=function(){for(var v=0,x=arguments.length;v<x;v++)Q(this,arguments[v]);return this.length},W.prototype.pop=function(){if(this.tail){var v=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,v}},W.prototype.shift=function(){if(this.head){var v=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,v}},W.prototype.forEach=function(v,x){x=x||this;for(var O=this.head,A=0;null!==O;A++)v.call(x,O.value,A,this),O=O.next},W.prototype.forEachReverse=function(v,x){x=x||this;for(var O=this.tail,A=this.length-1;null!==O;A--)v.call(x,O.value,A,this),O=O.prev},W.prototype.get=function(v){for(var x=0,O=this.head;null!==O&&x<v;x++)O=O.next;if(x===v&&null!==O)return O.value},W.prototype.getReverse=function(v){for(var x=0,O=this.tail;null!==O&&x<v;x++)O=O.prev;if(x===v&&null!==O)return O.value},W.prototype.map=function(v,x){x=x||this;for(var O=new W,A=this.head;null!==A;)O.push(v.call(x,A.value,this)),A=A.next;return O},W.prototype.mapReverse=function(v,x){x=x||this;for(var O=new W,A=this.tail;null!==A;)O.push(v.call(x,A.value,this)),A=A.prev;return O},W.prototype.reduce=function(v,x){var O,A=this.head;if(arguments.length>1)O=x;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");A=this.head.next,O=this.head.value}for(var b=0;null!==A;b++)O=v(O,A.value,b),A=A.next;return O},W.prototype.reduceReverse=function(v,x){var O,A=this.tail;if(arguments.length>1)O=x;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");A=this.tail.prev,O=this.tail.value}for(var b=this.length-1;null!==A;b--)O=v(O,A.value,b),A=A.prev;return O},W.prototype.toArray=function(){for(var v=new Array(this.length),x=0,O=this.head;null!==O;x++)v[x]=O.value,O=O.next;return v},W.prototype.toArrayReverse=function(){for(var v=new Array(this.length),x=0,O=this.tail;null!==O;x++)v[x]=O.value,O=O.prev;return v},W.prototype.slice=function(v,x){(x=x||this.length)<0&&(x+=this.length),(v=v||0)<0&&(v+=this.length);var O=new W;if(x<v||x<0)return O;v<0&&(v=0),x>this.length&&(x=this.length);for(var A=0,b=this.head;null!==b&&A<v;A++)b=b.next;for(;null!==b&&A<x;A++,b=b.next)O.push(b.value);return O},W.prototype.sliceReverse=function(v,x){(x=x||this.length)<0&&(x+=this.length),(v=v||0)<0&&(v+=this.length);var O=new W;if(x<v||x<0)return O;v<0&&(v=0),x>this.length&&(x=this.length);for(var A=this.length,b=this.tail;null!==b&&A>x;A--)b=b.prev;for(;null!==b&&A>v;A--,b=b.prev)O.push(b.value);return O},W.prototype.splice=function(v,x,...O){v>this.length&&(v=this.length-1),v<0&&(v=this.length+v);for(var A=0,b=this.head;null!==b&&A<v;A++)b=b.next;var y=[];for(A=0;b&&A<x;A++)y.push(b.value),b=this.removeNode(b);for(null===b&&(b=this.tail),b!==this.head&&b!==this.tail&&(b=b.prev),A=0;A<O.length;A++)b=j(this,b,O[A]);return y},W.prototype.reverse=function(){for(var v=this.head,x=this.tail,O=v;null!==O;O=O.prev){var A=O.prev;O.prev=O.next,O.next=A}return this.head=x,this.tail=v,this};try{Y("./iterator.js")(W)}catch(v){}},{"./iterator.js":91}]},{},[1])(1)},2:Bt=>{"use strict";Bt.exports=Je,Bt.exports.default=Je;var it=1e20;function Je(Y,Se,he,W,j,P){this.fontSize=Y||24,this.buffer=void 0===Se?3:Se,this.cutoff=W||.25,this.fontFamily=j||"sans-serif",this.fontWeight=P||"normal",this.radius=he||8;var Q=this.size=this.fontSize+2*this.buffer,z=Q+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Q,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(z*z),this.gridInner=new Float64Array(z*z),this.f=new Float64Array(z),this.z=new Float64Array(z+1),this.v=new Uint16Array(z),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(Q/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function At(Y,Se,he,W,j,P){for(var Q=0;Q<Se;Q++)dt(Y,Q,Se,he,W,j,P);for(var z=0;z<he;z++)dt(Y,z*Se,1,Se,W,j,P)}function dt(Y,Se,he,W,j,P,Q){var z,v,x,O;for(P[0]=0,Q[0]=-it,Q[1]=it,z=0;z<W;z++)j[z]=Y[Se+z*he];for(z=1,v=0,x=0;z<W;z++){do{x=(j[z]-j[O=P[v]]+z*z-O*O)/(z-O)/2}while(x<=Q[v]&&--v>-1);P[++v]=z,Q[v]=x,Q[v+1]=it}for(z=0,v=0;z<W;z++){for(;Q[v+1]<z;)v++;Y[Se+z*he]=j[O=P[v]]+(z-O)*(z-O)}}Je.prototype._draw=function(Y,Se){var P,Q,z,v,x,O,A,b,y,he=this.ctx.measureText(Y),W=he.width,j=2*this.buffer;Se&&this.useMetrics?(x=Math.floor(he.actualBoundingBoxAscent),b=this.buffer+Math.ceil(he.actualBoundingBoxAscent),O=this.buffer,A=this.buffer,P=(Q=Math.min(this.size,Math.ceil(he.actualBoundingBoxRight-he.actualBoundingBoxLeft)))+j,z=(v=Math.min(this.size-O,Math.ceil(he.actualBoundingBoxAscent+he.actualBoundingBoxDescent)))+j,this.ctx.textBaseline="alphabetic"):(P=Q=this.size,z=v=this.size,x=19*this.fontSize/24,O=A=0,b=this.middle,this.ctx.textBaseline="middle"),Q&&v&&(this.ctx.clearRect(A,O,Q,v),this.ctx.fillText(Y,this.buffer,b),y=this.ctx.getImageData(A,O,Q,v));var S=new Uint8ClampedArray(P*z);return function(Y,Se,he,W,j,P,Q){P.fill(it,0,Se*he),Q.fill(0,0,Se*he);for(var z=(Se-W)/2,v=0;v<j;v++)for(var x=0;x<W;x++){var O=(v+z)*Se+x+z,A=Y.data[4*(v*W+x)+3]/255;if(1===A)P[O]=0,Q[O]=it;else if(0===A)P[O]=it,Q[O]=0;else{var b=Math.max(0,.5-A),y=Math.max(0,A-.5);P[O]=b*b,Q[O]=y*y}}}(y,P,z,Q,v,this.gridOuter,this.gridInner),At(this.gridOuter,P,z,this.f,this.v,this.z),At(this.gridInner,P,z,this.f,this.v,this.z),function(Y,Se,he,W,j,P,Q){for(var z=0;z<Se*he;z++){var v=Math.sqrt(W[z])-Math.sqrt(j[z]);Y[z]=Math.round(255-255*(v/P+Q))}}(S,P,z,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:S,metrics:{width:Q,height:v,sdfWidth:P,sdfHeight:z,top:x,left:0,advance:W}}},Je.prototype.draw=function(Y){return this._draw(Y,!1).data},Je.prototype.drawWithMetrics=function(Y){return this._draw(Y,!0)}},322:Bt=>{Bt.exports=function(Je,yt){var ee=yt.length;if(0!==ee){var At=Je.length;Je.length+=ee;for(var dt=0;dt<ee;dt++)Je[At+dt]=yt[dt]}}},517:(Bt,it)=>{"use strict";var yt=(()=>{return(At=yt||(yt={})).typeOfFunction="function",At.boolTrue=!0,yt;var At})();function ee(At,dt,Y){if(!Y||typeof Y.value!==yt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+dt+"> is not a method!");return{configurable:yt.boolTrue,get:function(){var Se=Y.value.bind(this);return Object.defineProperty(this,dt,{value:Se,configurable:yt.boolTrue,writable:yt.boolTrue}),Se}}}it.ak=ee,it.ZP=ee},266:(Bt,it,Je)=>{Bt.exports={ResizeSensor:Je(835),ElementQueries:Je(845)}},845:function(Bt,it,Je){"use strict";var yt,ee,At;"undefined"!=typeof window&&window,ee=[Je(835)],void 0!==(At="function"==typeof(yt=function(dt){var Y=function(){var he,W={},j=[];function P(D){D||(D=document.documentElement);var I=window.getComputedStyle(D,null).fontSize;return parseFloat(I)||16}function z(D,I){var X=I.split(/\d/),E=X[X.length-1];switch(I=parseFloat(I),E){case"px":return I;case"em":return I*P(D);case"rem":return I*P();case"vw":return I*document.documentElement.clientWidth/100;case"vh":return I*document.documentElement.clientHeight/100;case"vmin":case"vmax":var $=document.documentElement.clientWidth/100,Z=document.documentElement.clientHeight/100;return I*(0,Math["vmin"===E?"min":"max"])($,Z);default:return I}}function v(D,I){this.element=D;var X,E,$,Z,se,oe,te,xe,ge=["min-width","min-height","max-width","max-height"];this.call=function(){for(X in $=function(D){if(!D.getBoundingClientRect)return{width:D.offsetWidth,height:D.offsetHeight};var I=D.getBoundingClientRect();return{width:Math.round(I.width),height:Math.round(I.height)}}(this.element),oe={},W[I])!W[I].hasOwnProperty(X)||(Z=z(this.element,(E=W[I][X]).value),se="width"===E.property?$.width:$.height,te="","min"===E.mode&&se>=Z&&(te+=E.value),"max"===E.mode&&se<=Z&&(te+=E.value),oe[xe=E.mode+"-"+E.property]||(oe[xe]=""),te&&-1===(" "+oe[xe]+" ").indexOf(" "+te+" ")&&(oe[xe]+=" "+te));for(var ne in ge)!ge.hasOwnProperty(ne)||(oe[ge[ne]]?this.element.setAttribute(ge[ne],oe[ge[ne]].substr(1)):this.element.removeAttribute(ge[ne]))}}function x(D,I){D.elementQueriesSetupInformation||(D.elementQueriesSetupInformation=new v(D,I)),D.elementQueriesSensor||(D.elementQueriesSensor=new dt(D,function(){D.elementQueriesSetupInformation.call()}))}function O(D,I,X,E){if(void 0===W[D]){W[D]=[];var $=j.length;he.innerHTML+="\n"+D+" {animation: 0.1s element-queries;}",he.innerHTML+="\n"+D+" > .resize-sensor {min-width: "+$+"px;}",j.push(D)}W[D].push({mode:I,property:X,value:E})}function A(D){var I;if(document.querySelectorAll&&(I=D?D.querySelectorAll.bind(D):document.querySelectorAll.bind(document)),!I&&"undefined"!=typeof $$&&(I=$$),!I&&"undefined"!=typeof jQuery&&(I=jQuery),!I)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return I}function y(D){var I=[],X=[],E=[],$=0,Z=-1,se=[];for(var oe in D.children)if(D.children.hasOwnProperty(oe)&&D.children[oe].tagName&&"img"===D.children[oe].tagName.toLowerCase()){I.push(D.children[oe]);var te=D.children[oe].getAttribute("min-width")||D.children[oe].getAttribute("data-min-width"),xe=D.children[oe].getAttribute("data-src")||D.children[oe].getAttribute("url");E.push(xe),X.push({minWidth:te}),te?D.children[oe].style.display="none":($=I.length-1,D.children[oe].style.display="block")}function ne(){var Ie,_e=!1;for(Ie in I)!I.hasOwnProperty(Ie)||X[Ie].minWidth&&D.offsetWidth>X[Ie].minWidth&&(_e=Ie);if(_e||(_e=$),Z!==_e)if(se[_e])I[Z].style.display="none",I[_e].style.display="block",Z=_e;else{var Ge=new Image;Ge.onload=function(){I[_e].src=E[_e],I[Z].style.display="none",I[_e].style.display="block",se[_e]=!0,Z=_e},Ge.src=E[_e]}else I[_e].src=E[_e]}Z=$,D.resizeSensorInstance=new dt(D,ne),ne()}var T=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,V=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function R(D){var I,X,E,$;for(D=D.replace(/'/g,'"');null!==(I=T.exec(D));)for(X=I[1]+I[3],E=I[2];null!==($=V.exec(E));)O(X,$[1],$[2],$[3])}function K(D){var I="";if(D)if("string"==typeof D)(-1!==(D=D.toLowerCase()).indexOf("min-width")||-1!==D.indexOf("max-width"))&&R(D);else for(var X=0,E=D.length;X<E;X++)1===D[X].type?(-1!==(I=D[X].selectorText||D[X].cssText).indexOf("min-height")||-1!==I.indexOf("max-height")||-1!==I.indexOf("min-width")||-1!==I.indexOf("max-width"))&&R(I):4===D[X].type?K(D[X].cssRules||D[X].rules):3===D[X].type&&D[X].styleSheet.hasOwnProperty("cssRules")&&K(D[X].styleSheet.cssRules)}var ce=!1;this.init=function(){var D="animationstart";void 0!==document.documentElement.style.webkitAnimationName?D="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?D="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(D="oanimationstart"),document.body.addEventListener(D,function(E){var $=E.target,Z=$&&window.getComputedStyle($,null),se=Z&&Z.getPropertyValue("animation-name");if(se&&-1!==se.indexOf("element-queries")){$.elementQueriesSensor=new dt($,function(){$.elementQueriesSetupInformation&&$.elementQueriesSetupInformation.call()});var xe=window.getComputedStyle($.resizeSensor,null).getPropertyValue("min-width");xe=parseInt(xe.replace("px","")),x(E.target,j[xe])}}),ce||((he=document.createElement("style")).type="text/css",he.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",he.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(he),ce=!0);for(var I=0,X=document.styleSheets.length;I<X;I++)try{document.styleSheets[I].href&&0===document.styleSheets[I].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[I].href),K(document.styleSheets[I].cssRules||document.styleSheets[I].rules||document.styleSheets[I].cssText)}catch(E){}!function(){for(var I=A()("[data-responsive-image],[responsive-image]"),X=0,E=I.length;X<E;X++)y(I[X])}()},this.findElementQueriesElements=function(D){!function(D){var I=A(D);for(var X in W)if(W.hasOwnProperty(X))for(var E=I(X,D),$=0,Z=E.length;$<Z;$++)x(E[$],X)}(D)},this.update=function(){this.init()}};Y.update=function(){Y.instance.update()},Y.detach=function(he){he.elementQueriesSetupInformation?(he.elementQueriesSensor.detach(),delete he.elementQueriesSetupInformation,delete he.elementQueriesSensor):he.resizeSensorInstance&&(he.resizeSensorInstance.detach(),delete he.resizeSensorInstance)},Y.init=function(){Y.instance||(Y.instance=new Y),Y.instance.init()};return Y.findElementQueriesElements=function(he){Y.instance.findElementQueriesElements(he)},Y.listen=function(){!function(he){if(document.addEventListener)document.addEventListener("DOMContentLoaded",he,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var W=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(he(),clearInterval(W))},10);else window.onload=he}(Y.init)},Y})?yt.apply(it,ee):yt)&&(Bt.exports=At)},835:function(Bt,it,Je){"use strict";var yt,ee;"undefined"!=typeof window&&window,void 0!==(ee="function"==typeof(yt=function(){if("undefined"==typeof window)return null;var At="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),dt=At.requestAnimationFrame||At.mozRequestAnimationFrame||At.webkitRequestAnimationFrame||function(Q){return At.setTimeout(Q,20)},Y=At.cancelAnimationFrame||At.mozCancelAnimationFrame||At.webkitCancelAnimationFrame||function(Q){At.clearTimeout(Q)};function Se(Q,z){var v=Object.prototype.toString.call(Q),x="[object Array]"===v||"[object NodeList]"===v||"[object HTMLCollection]"===v||"[object Object]"===v||"undefined"!=typeof jQuery&&Q instanceof jQuery||"undefined"!=typeof Elements&&Q instanceof Elements,O=0,A=Q.length;if(x)for(;O<A;O++)z(Q[O]);else z(Q)}function he(Q){if(!Q.getBoundingClientRect)return{width:Q.offsetWidth,height:Q.offsetHeight};var z=Q.getBoundingClientRect();return{width:Math.round(z.width),height:Math.round(z.height)}}function W(Q,z){Object.keys(z).forEach(function(v){Q.style[v]=z[v]})}var j=function(Q,z){var v=0;function x(){var b,y,A=[];this.add=function(S){A.push(S)},this.call=function(S){for(b=0,y=A.length;b<y;b++)A[b].call(this,S)},this.remove=function(S){var T=[];for(b=0,y=A.length;b<y;b++)A[b]!==S&&T.push(A[b]);A=T},this.length=function(){return A.length}}function O(A,b){if(A){if(A.resizedAttached)return void A.resizedAttached.add(b);A.resizedAttached=new x,A.resizedAttached.add(b),A.resizeSensor=document.createElement("div"),A.resizeSensor.dir="ltr",A.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},S={position:"absolute",left:"0px",top:"0px",transition:"0s"};W(A.resizeSensor,y);var T=document.createElement("div");T.className="resize-sensor-expand",W(T,y);var V=document.createElement("div");W(V,S),T.appendChild(V);var R=document.createElement("div");R.className="resize-sensor-shrink",W(R,y);var K=document.createElement("div");W(K,S),W(K,{width:"200%",height:"200%"}),R.appendChild(K),A.resizeSensor.appendChild(T),A.resizeSensor.appendChild(R),A.appendChild(A.resizeSensor);var ce=window.getComputedStyle(A),D=ce?ce.getPropertyValue("position"):null;"absolute"!==D&&"relative"!==D&&"fixed"!==D&&"sticky"!==D&&(A.style.position="relative");var I=!1,X=0,E=he(A),$=0,Z=0,se=!0;v=0;var te=function(){if(se){if(0===A.offsetWidth&&0===A.offsetHeight)return void(v||(v=dt(function(){v=0,te()})));se=!1}var _e,Ie;Ie=A.offsetHeight,V.style.width=(_e=A.offsetWidth)+10+"px",V.style.height=Ie+10+"px",T.scrollLeft=_e+10,T.scrollTop=Ie+10,R.scrollLeft=_e+10,R.scrollTop=Ie+10};A.resizeSensor.resetSensor=te;var xe=function(){X=0,I&&($=E.width,Z=E.height,A.resizedAttached&&A.resizedAttached.call(E))},ge=function(){E=he(A),(I=E.width!==$||E.height!==Z)&&!X&&(X=dt(xe)),te()},ne=function(_e,Ie,Ge){_e.attachEvent?_e.attachEvent("on"+Ie,Ge):_e.addEventListener(Ie,Ge)};ne(T,"scroll",ge),ne(R,"scroll",ge),v=dt(function(){v=0,te()})}}Se(Q,function(A){O(A,z)}),this.detach=function(A){v||(Y(v),v=0),j.detach(Q,A)},this.reset=function(){Q.resizeSensor.resetSensor()}};if(j.reset=function(Q){Se(Q,function(z){z.resizeSensor.resetSensor()})},j.detach=function(Q,z){Se(Q,function(v){!v||v.resizedAttached&&"function"==typeof z&&(v.resizedAttached.remove(z),v.resizedAttached.length())||v.resizeSensor&&(v.contains(v.resizeSensor)&&v.removeChild(v.resizeSensor),delete v.resizeSensor,delete v.resizedAttached)})},"undefined"!=typeof MutationObserver){var P=new MutationObserver(function(Q){for(var z in Q)if(Q.hasOwnProperty(z))for(var v=Q[z].addedNodes,x=0;x<v.length;x++)v[x].resizeSensor&&j.reset(v[x])});document.addEventListener("DOMContentLoaded",function(Q){P.observe(document.body,{childList:!0,subtree:!0})})}return j})?yt.call(it,Je,it,Bt):yt)&&(Bt.exports=ee)},445:(Bt,it,Je)=>{var yt=Je(910),ee=Je(369),At=Je(322);function dt(Q,z,v){if(!yt(Q))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!Q.hasNode(z))throw new Error('graphology-shortest-path: the "'+z+'" source node does not exist in the given graph.');if(!Q.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" target node does not exist in the given graph.');if((z=""+z)==(v=""+v))return[z];var x=Q.inboundNeighbors.bind(Q),O=Q.outboundNeighbors.bind(Q),A={},b={};A[z]=null,b[v]=null;var T,V,R,K,ce,D,I,X,y=[z],S=[v],E=!1;e:for(;y.length&&S.length;)if(y.length<=S.length){for(T=y,y=[],ce=0,I=T.length;ce<I;ce++)for(D=0,X=(R=O(V=T[ce])).length;D<X;D++)if((K=R[D])in A||(y.push(K),A[K]=V),K in b){E=!0;break e}}else for(T=S,S=[],ce=0,I=T.length;ce<I;ce++)for(V=T[ce],R=x(V),D=0,X=R.length;D<X;D++)if(K=R[D],K in b||(S.push(K),b[K]=V),K in A){E=!0;break e}if(!E)return null;for(var $=[];K;)$.unshift(K),K=A[K];for(K=b[$[$.length-1]];K;)$.push(K),K=b[K];return $.length?$:null}function Y(Q,z){if(!yt(Q))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!Q.hasNode(z))throw new Error('graphology-shortest-path: the "'+z+'" source node does not exist in the given graph.');var O,A,b,y,S,T,v={},x={};for(v[z=""+z]=!0,x[z]=[z];Object.keys(v).length;)for(b in O=v,v={},O)for(S=0,T=(A=Q.outboundNeighbors(b)).length;S<T;S++)x[y=A[S]]||(x[y]=x[b].concat(y),v[y]=!0);return x}function Se(Q,z,v){if(!yt(z))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!z.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" source node does not exist in the given graph.');v=""+v;var x=new Set,O={},A=0;O[v]=0;for(var y,S,T,b=[v];0!==b.length;){var V=[];for(y=0,S=b.length;y<S;y++)!x.has(T=b[y])&&(x.add(T),At(V,z[Q](T)),O[T]=A);A++,b=V}return O}var he=Se.bind(null,"outboundNeighbors"),W=Se.bind(null,"neighbors");function j(Q,z,v){return arguments.length<3?Y(Q,z):dt(Q,z,v)}j.bidirectional=dt,j.singleSource=Y,j.singleSourceLength=he,j.undirectedSingleSourceLength=W,j.brandes=function(Q,z){z=""+z;var b,y,S,T,V,R,K,ce,D,v=[],x={},O={},A=Q.nodes();for(R=0,ce=A.length;R<ce;R++)x[T=A[R]]=[],O[T]=0;var I={};O[z]=1,I[z]=0;for(var X=ee.of(z);X.size;)for(T=X.dequeue(),v.push(T),b=I[T],y=O[T],K=0,D=(S=Q.outboundNeighbors(T)).length;K<D;K++)(V=S[K])in I||(X.enqueue(V),I[V]=b+1),I[V]===b+1&&(O[V]+=y,x[V].push(T));return[v,x,O]},Bt.exports=j},910:Bt=>{Bt.exports=function(Je){return null!==Je&&"object"==typeof Je&&"function"==typeof Je.addUndirectedEdgeWithKey&&"function"==typeof Je.dropNode&&"boolean"==typeof Je.multi}},698:function(Bt){Bt.exports=function(){"use strict";function it(ie){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(fe){return typeof fe}:function(fe){return fe&&"function"==typeof Symbol&&fe.constructor===Symbol&&fe!==Symbol.prototype?"symbol":typeof fe})(ie)}function Je(ie,fe){ie.prototype=Object.create(fe.prototype),ie.prototype.constructor=ie,ee(ie,fe)}function yt(ie){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(fe){return fe.__proto__||Object.getPrototypeOf(fe)})(ie)}function ee(ie,fe){return(ee=Object.setPrototypeOf||function(re,M){return re.__proto__=M,re})(ie,fe)}function At(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ie){return!1}}function dt(ie,fe,re){return(dt=At()?Reflect.construct:function(M,L,J){var we=[null];we.push.apply(we,L);var Fe=new(Function.bind.apply(M,we));return J&&ee(Fe,J.prototype),Fe}).apply(null,arguments)}function Y(ie){var fe="function"==typeof Map?new Map:void 0;return(Y=function(re){if(null===re||-1===Function.toString.call(re).indexOf("[native code]"))return re;if("function"!=typeof re)throw new TypeError("Super expression must either be null or a function");if(void 0!==fe){if(fe.has(re))return fe.get(re);fe.set(re,L)}function L(){return dt(re,arguments,yt(this).constructor)}return L.prototype=Object.create(re.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),ee(L,re)})(ie)}function Se(ie){if(void 0===ie)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ie}var he=function(){for(var ie=arguments[0],fe=1,re=arguments.length;fe<re;fe++)if(arguments[fe])for(var M in arguments[fe])ie[M]=arguments[fe][M];return ie};function W(ie,fe,re,M){var L=ie._nodes.get(fe),J=null;return L?J="mixed"===M?L.out&&L.out[re]||L.undirected&&L.undirected[re]:"directed"===M?L.out&&L.out[re]:L.undirected&&L.undirected[re]:J}function j(ie){return null!==ie&&"object"===it(ie)&&"function"==typeof ie.addUndirectedEdgeWithKey&&"function"==typeof ie.dropNode}function P(ie){return"object"===it(ie)&&null!==ie&&ie.constructor===Object}function Q(ie){var fe;for(fe in ie)return!1;return!0}function z(ie,fe,re){Object.defineProperty(ie,fe,{enumerable:!1,configurable:!1,writable:!0,value:re})}function v(ie,fe,re){var M={enumerable:!0,configurable:!0};"function"==typeof re?M.get=re:(M.value=re,M.writable=!1),Object.defineProperty(ie,fe,M)}function x(ie){return!(!P(ie)||ie.attributes&&!Array.isArray(ie.attributes))}"function"==typeof Object.assign&&(he=Object.assign);var O,A={exports:{}},b="object"==typeof Reflect?Reflect:null,y=b&&"function"==typeof b.apply?b.apply:function(ie,fe,re){return Function.prototype.apply.call(ie,fe,re)};O=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(ie){return Object.getOwnPropertyNames(ie).concat(Object.getOwnPropertySymbols(ie))}:function(ie){return Object.getOwnPropertyNames(ie)};var S=Number.isNaN||function(ie){return ie!=ie};function T(){T.init.call(this)}A.exports=T,A.exports.once=function(ie,fe){return new Promise(function(re,M){function L(we){ie.removeListener(fe,J),M(we)}function J(){"function"==typeof ie.removeListener&&ie.removeListener("error",L),re([].slice.call(arguments))}var we;Z(ie,fe,J,{once:!0}),"error"!==fe&&("function"==typeof(we=ie).on&&Z(we,"error",L,{once:!0}))})},T.EventEmitter=T,T.prototype._events=void 0,T.prototype._eventsCount=0,T.prototype._maxListeners=void 0;var V=10;function R(ie){if("function"!=typeof ie)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ie)}function K(ie){return void 0===ie._maxListeners?T.defaultMaxListeners:ie._maxListeners}function ce(ie,fe,re,M){var L,J,we;if(R(re),void 0===(J=ie._events)?(J=ie._events=Object.create(null),ie._eventsCount=0):(void 0!==J.newListener&&(ie.emit("newListener",fe,re.listener?re.listener:re),J=ie._events),we=J[fe]),void 0===we)we=J[fe]=re,++ie._eventsCount;else if("function"==typeof we?we=J[fe]=M?[re,we]:[we,re]:M?we.unshift(re):we.push(re),(L=K(ie))>0&&we.length>L&&!we.warned){we.warned=!0;var nt=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+String(fe)+" listeners added. Use emitter.setMaxListeners() to increase limit");nt.name="MaxListenersExceededWarning",nt.emitter=ie,nt.type=fe,nt.count=we.length,console&&console.warn&&console.warn(nt)}return ie}function D(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function I(ie,fe,re){var M={fired:!1,wrapFn:void 0,target:ie,type:fe,listener:re},L=D.bind(M);return L.listener=re,M.wrapFn=L,L}function X(ie,fe,re){var M=ie._events;if(void 0===M)return[];var L=M[fe];return void 0===L?[]:"function"==typeof L?re?[L.listener||L]:[L]:re?function(J){for(var we=new Array(J.length),Fe=0;Fe<we.length;++Fe)we[Fe]=J[Fe].listener||J[Fe];return we}(L):$(L,L.length)}function E(ie){var fe=this._events;if(void 0!==fe){var re=fe[ie];if("function"==typeof re)return 1;if(void 0!==re)return re.length}return 0}function $(ie,fe){for(var re=new Array(fe),M=0;M<fe;++M)re[M]=ie[M];return re}function Z(ie,fe,re,M){if("function"==typeof ie.on)M.once?ie.once(fe,re):ie.on(fe,re);else{if("function"!=typeof ie.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ie);ie.addEventListener(fe,function L(J){M.once&&ie.removeEventListener(fe,L),re(J)})}}function se(ie){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:ie}),this.done=!1}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return V},set:function(ie){if("number"!=typeof ie||ie<0||S(ie))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ie+".");V=ie}}),T.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(ie){if("number"!=typeof ie||ie<0||S(ie))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ie+".");return this._maxListeners=ie,this},T.prototype.getMaxListeners=function(){return K(this)},T.prototype.emit=function(ie){for(var fe=[],re=1;re<arguments.length;re++)fe.push(arguments[re]);var M="error"===ie,L=this._events;if(void 0!==L)M=M&&void 0===L.error;else if(!M)return!1;if(M){var J;if(fe.length>0&&(J=fe[0]),J instanceof Error)throw J;var we=new Error("Unhandled error."+(J?" ("+J.message+")":""));throw we.context=J,we}var Fe=L[ie];if(void 0===Fe)return!1;if("function"==typeof Fe)y(Fe,this,fe);else{var nt=Fe.length,Ot=$(Fe,nt);for(re=0;re<nt;++re)y(Ot[re],this,fe)}return!0},T.prototype.on=T.prototype.addListener=function(ie,fe){return ce(this,ie,fe,!1)},T.prototype.prependListener=function(ie,fe){return ce(this,ie,fe,!0)},T.prototype.once=function(ie,fe){return R(fe),this.on(ie,I(this,ie,fe)),this},T.prototype.prependOnceListener=function(ie,fe){return R(fe),this.prependListener(ie,I(this,ie,fe)),this},T.prototype.off=T.prototype.removeListener=function(ie,fe){var re,M,L,J,we;if(R(fe),void 0===(M=this._events))return this;if(void 0===(re=M[ie]))return this;if(re===fe||re.listener===fe)0==--this._eventsCount?this._events=Object.create(null):(delete M[ie],M.removeListener&&this.emit("removeListener",ie,re.listener||fe));else if("function"!=typeof re){for(L=-1,J=re.length-1;J>=0;J--)if(re[J]===fe||re[J].listener===fe){we=re[J].listener,L=J;break}if(L<0)return this;0===L?re.shift():function(Fe,nt){for(;nt+1<Fe.length;nt++)Fe[nt]=Fe[nt+1];Fe.pop()}(re,L),1===re.length&&(M[ie]=re[0]),void 0!==M.removeListener&&this.emit("removeListener",ie,we||fe)}return this},T.prototype.removeAllListeners=function(ie){var fe,re,M;if(void 0===(re=this._events))return this;if(void 0===re.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==re[ie]&&(0==--this._eventsCount?this._events=Object.create(null):delete re[ie]),this;if(0===arguments.length){var L,J=Object.keys(re);for(M=0;M<J.length;++M)"removeListener"!==(L=J[M])&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(fe=re[ie]))this.removeListener(ie,fe);else if(void 0!==fe)for(M=fe.length-1;M>=0;M--)this.removeListener(ie,fe[M]);return this},T.prototype.listeners=function(ie){return X(this,ie,!0)},T.prototype.rawListeners=function(ie){return X(this,ie,!1)},T.listenerCount=function(ie,fe){return"function"==typeof ie.listenerCount?ie.listenerCount(fe):E.call(ie,fe)},T.prototype.listenerCount=E,T.prototype.eventNames=function(){return this._eventsCount>0?O(this._events):[]},se.prototype.next=function(){if(this.done)return{done:!0};var ie=this._next();return ie.done&&(this.done=!0),ie},"undefined"!=typeof Symbol&&(se.prototype[Symbol.iterator]=function(){return this}),se.of=function(){var ie=arguments,fe=ie.length,re=0;return new se(function(){return re>=fe?{done:!0}:{done:!1,value:ie[re++]}})},se.empty=function(){var ie=new se(null);return ie.done=!0,ie},se.is=function(ie){return ie instanceof se||"object"==typeof ie&&null!==ie&&"function"==typeof ie.next};var oe=se,te=function(ie,fe){for(var re,M=arguments.length>1?fe:1/0,L=M!==1/0?new Array(M):[],J=0;;){if(J===M)return L;if((re=ie.next()).done)return J!==fe?L.slice(0,J):L;L[J++]=re.value}},xe=function(ie){function fe(re,M){var L;return(L=ie.call(this)||this).name="GraphError",L.message=re||"",L.data=M||{},L}return Je(fe,ie),fe}(Y(Error)),ge=function(ie){function fe(re,M){var L;return(L=ie.call(this,re,M)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(L),fe.prototype.constructor),L}return Je(fe,ie),fe}(xe),ne=function(ie){function fe(re,M){var L;return(L=ie.call(this,re,M)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(L),fe.prototype.constructor),L}return Je(fe,ie),fe}(xe),_e=function(ie){function fe(re,M){var L;return(L=ie.call(this,re,M)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Se(L),fe.prototype.constructor),L}return Je(fe,ie),fe}(xe);function Ie(ie,fe){this.key=ie,this.attributes=fe,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function Ge(ie,fe){this.key=ie,this.attributes=fe,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function st(ie,fe){this.key=ie,this.attributes=fe,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Xe(ie,fe,re,M,L,J){this.key=fe,this.attributes=J,this.undirected=ie,this.source=M,this.target=L,this.generatedKey=re}function tt(ie,fe,re,M,L,J,we){var Fe,nt,Ot="out",We="in";if(fe&&(Ot=We="undirected"),ie.multi){if(void 0===(nt=(Fe=J[Ot])[L])&&(nt=new Set,Fe[L]=nt),nt.add(re),M===L&&fe)return;void 0===(Fe=we[We])[M]&&(Fe[M]=nt)}else{if(J[Ot][L]=re,M===L&&fe)return;we[We][M]=re}}function Ye(ie,fe,re){var M=ie.multi,L=re.source,J=re.target,we=L.key,Fe=J.key,nt=L[fe?"undirected":"out"],Ot=fe?"undirected":"in";if(Fe in nt)if(M){var We=nt[Fe];1===We.size?(delete nt[Fe],delete J[Ot][we]):We.delete(re)}else delete nt[Fe];M||delete J[Ot][we]}Ge.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},st.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var Ue=[{name:function(ie){return"get".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return J.attributes[L]}}},{name:function(ie){return"get".concat(ie,"Attributes")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M){var L;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var J=""+M,we=""+arguments[1];if(!(L=W(this,J,we,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(J,'" - "').concat(we,'").'))}else if(!(L=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&L.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return L.attributes}}},{name:function(ie){return"has".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return J.attributes.hasOwnProperty(L)}}},{name:function(ie){return"set".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,L,J){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+M,nt=""+L;if(L=arguments[2],J=arguments[3],!(we=W(this,Fe,nt,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(nt,'").'))}else if(!(we=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return we.attributes[L]=J,this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:L}),this}}},{name:function(ie){return"update".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,L,J){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+M,nt=""+L;if(L=arguments[2],J=arguments[3],!(we=W(this,Fe,nt,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(nt,'").'))}else if(!(we=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("function"!=typeof J)throw new ge("Graph.".concat(fe,": updater should be a function."));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return we.attributes[L]=J(we.attributes[L]),this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:L}),this}}},{name:function(ie){return"remove".concat(ie,"Attribute")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return delete J.attributes[L],this.emit("edgeAttributesUpdated",{key:J.key,type:"remove",attributes:J.attributes,name:L}),this}}},{name:function(ie){return"replace".concat(ie,"Attributes")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if(!P(L))throw new ge("Graph.".concat(fe,": provided attributes are not a plain object."));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return J.attributes=L,this.emit("edgeAttributesUpdated",{key:J.key,type:"replace",attributes:J.attributes}),this}}},{name:function(ie){return"merge".concat(ie,"Attributes")},attacher:function(ie,fe,re){ie.prototype[fe]=function(M,L){var J;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(fe,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(fe,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+M,Fe=""+L;if(L=arguments[2],!(J=W(this,we,Fe,re)))throw new ne("Graph.".concat(fe,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(J=this._edges.get(M=""+M)))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" edge in the graph.'));if(!P(L))throw new ge("Graph.".concat(fe,": provided attributes are not a plain object."));if("mixed"!==re&&J.undirected!==("undirected"===re))throw new ne("Graph.".concat(fe,': could not find the "').concat(M,'" ').concat(re," edge in the graph."));return he(J.attributes,L),this.emit("edgeAttributesUpdated",{key:J.key,type:"merge",attributes:J.attributes,data:L}),this}}}],Le=oe,Ke=function(){var ie,fe=arguments,re=-1;return new Le(function M(){if(!ie){if(++re>=fe.length)return{done:!0};ie=fe[re]}var L=ie.next();return L.done?(ie=null,M()):L})},Te=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Ve(ie,fe){for(var re in fe)ie.push(fe[re].key)}function $e(ie,fe){for(var re in fe)fe[re].forEach(function(M){return ie.push(M.key)})}function Ne(ie,fe,re){for(var M in ie)if(M!==re){var L=ie[M];fe(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)}}function q(ie,fe,re){for(var M in ie)M!==re&&ie[M].forEach(function(L){return fe(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)})}function G(ie,fe,re){for(var M in ie)if(M!==re){var L=ie[M];if(fe(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey))return!0}return!1}function pe(ie,fe,re){var M,L,J,we,Fe;for(var nt in ie)if(nt!==re)for(M=ie[nt].values();!0!==(L=M.next()).done;)if(we=(J=L.value).source,fe(J.key,J.attributes,we.key,(Fe=J.target).key,we.attributes,Fe.attributes,J.undirected,J.generatedKey))return!0;return!1}function ue(ie,fe){var re=Object.keys(ie),M=re.length,L=null,J=0;return new oe(function we(){var Fe;if(L){var nt=L.next();if(nt.done)return L=null,J++,we();Fe=nt.value}else{if(J>=M)return{done:!0};var Ot=re[J];if(Ot===fe)return J++,we();if((Fe=ie[Ot])instanceof Set)return L=Fe.values(),we();J++}return{done:!1,value:[Fe.key,Fe.attributes,Fe.source.key,Fe.target.key,Fe.source.attributes,Fe.target.attributes]}})}function je(ie,fe,re){var M=fe[re];M&&ie.push(M.key)}function _t(ie,fe,re){var M=fe[re];M&&M.forEach(function(L){return ie.push(L.key)})}function pt(ie,fe,re){var M=ie[fe];if(M){var L=M.source,J=M.target;re(M.key,M.attributes,L.key,J.key,L.attributes,J.attributes,M.undirected,M.generatedKey)}}function ve(ie,fe,re){var M=ie[fe];M&&M.forEach(function(L){return re(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)})}function k(ie,fe,re){var M=ie[fe];if(M){var L=M.source,J=M.target;return re(M.key,M.attributes,L.key,J.key,L.attributes,J.attributes,M.undirected,M.generatedKey)}}function N(ie,fe,re){var M=ie[fe];if(M){for(var L,J,we=M.values();!0!==(L=we.next()).done;)if(re((J=L.value).key,J.attributes,J.source.key,J.target.key,J.source.attributes,J.target.attributes,J.undirected,J.generatedKey))return!0;return!1}}function B(ie,fe){var re=ie[fe];if(re instanceof Set){var M=re.values();return new oe(function(){var L=M.next();if(L.done)return L;var J=L.value;return{done:!1,value:[J.key,J.attributes,J.source.key,J.target.key,J.source.attributes,J.target.attributes]}})}return oe.of([re.key,re.attributes,re.source.key,re.target.key,re.source.attributes,re.target.attributes])}function Re(ie,fe){if(0===ie.size)return[];if("mixed"===fe||fe===ie.type)return"function"==typeof Array.from?Array.from(ie._edges.keys()):te(ie._edges.keys(),ie._edges.size);for(var re,M,J=new Array("undirected"===fe?ie.undirectedSize:ie.directedSize),we="undirected"===fe,Fe=ie._edges.values(),nt=0;!0!==(re=Fe.next()).done;)(M=re.value).undirected===we&&(J[nt++]=M.key);return J}function Qe(ie,fe,re){if(0!==ie.size)for(var M,L,J="mixed"!==fe&&fe!==ie.type,we="undirected"===fe,Fe=ie._edges.values();!0!==(M=Fe.next()).done;)if(L=M.value,!J||L.undirected===we){var Gt=L.source,Tt=L.target;re(L.key,L.attributes,Gt.key,Tt.key,Gt.attributes,Tt.attributes,L.undirected,L.generatedKey)}}function St(ie,fe,re){if(0!==ie.size)for(var M,L,J="mixed"!==fe&&fe!==ie.type,we="undirected"===fe,Fe=ie._edges.values();!0!==(M=Fe.next()).done;)if(L=M.value,!J||L.undirected===we){var Gt=L.source,Tt=L.target;if(re(L.key,L.attributes,Gt.key,Tt.key,Gt.attributes,Tt.attributes,L.undirected,L.generatedKey))break}}function Rt(ie,fe){if(0===ie.size)return oe.empty();var re="mixed"!==fe&&fe!==ie.type,M="undirected"===fe,L=ie._edges.values();return new oe(function(){for(var J,we;;){if((J=L.next()).done)return J;if(we=J.value,!re||we.undirected===M)break}return{value:[we.key,we.attributes,we.source.key,we.target.key,we.source.attributes,we.target.attributes],done:!1}})}function In(ie,fe,re,M){var L=[],J=ie?$e:Ve;return"undirected"!==fe&&("out"!==re&&J(L,M.in),"in"!==re&&J(L,M.out),!re&&M.directedSelfLoops>0&&L.splice(L.lastIndexOf(M.key),1)),"directed"!==fe&&J(L,M.undirected),L}function Ln(ie,fe,re,M,L){var J=ie?q:Ne;"undirected"!==fe&&("out"!==re&&J(M.in,L),"in"!==re&&J(M.out,L,re?null:M.key)),"directed"!==fe&&J(M.undirected,L)}function Wn(ie,fe,re,M,L){var J=ie?pe:G;"undirected"!==fe&&("out"!==re&&J(M.in,L)||"in"!==re&&J(M.out,L,re?null:M.key))||"directed"===fe||J(M.undirected,L)}function wi(ie,fe,re){var M=oe.empty();return"undirected"!==ie&&("out"!==fe&&void 0!==re.in&&(M=Ke(M,ue(re.in))),"in"!==fe&&void 0!==re.out&&(M=Ke(M,ue(re.out,fe?null:re.key)))),"directed"!==ie&&void 0!==re.undirected&&(M=Ke(M,ue(re.undirected))),M}function gi(ie,fe,re,M,L){var J=fe?_t:je,we=[];return"undirected"!==ie&&(void 0!==M.in&&"out"!==re&&J(we,M.in,L),void 0!==M.out&&"in"!==re&&J(we,M.out,L),!re&&M.directedSelfLoops>0&&we.splice(we.lastIndexOf(M.key),1)),"directed"!==ie&&void 0!==M.undirected&&J(we,M.undirected,L),we}function Gr(ie,fe,re,M,L,J){var we=fe?ve:pt;"undirected"!==ie&&(void 0!==M.in&&"out"!==re&&we(M.in,L,J),M.key!==L&&void 0!==M.out&&"in"!==re&&we(M.out,L,J)),"directed"!==ie&&void 0!==M.undirected&&we(M.undirected,L,J)}function Ns(ie,fe,re,M,L,J){var we=fe?N:k;"undirected"!==ie&&(void 0!==M.in&&"out"!==re&&we(M.in,L,J)||M.key!==L&&void 0!==M.out&&"in"!==re&&we(M.out,L,J,re?null:M.key))||"directed"===ie||void 0===M.undirected||we(M.undirected,L,J)}function us(ie,fe,re,M){var L=oe.empty();return"undirected"!==ie&&(void 0!==re.in&&"out"!==fe&&M in re.in&&(L=Ke(L,B(re.in,M))),void 0!==re.out&&"in"!==fe&&M in re.out&&(L=Ke(L,B(re.out,M)))),"directed"!==ie&&void 0!==re.undirected&&M in re.undirected&&(L=Ke(L,B(re.undirected,M))),L}var Ps=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function $r(ie,fe){if(void 0!==fe)for(var re in fe)ie.add(re)}function Xa(ie,fe,re){if("mixed"!==ie){if("undirected"===ie)return Object.keys(re.undirected);if("string"==typeof fe)return Object.keys(re[fe])}var M=new Set;return"undirected"!==ie&&("out"!==fe&&$r(M,re.in),"in"!==fe&&$r(M,re.out)),"directed"!==ie&&$r(M,re.undirected),te(M.values(),M.size)}function Dl(ie,fe,re){for(var M in fe){var L=fe[M];L instanceof Set&&(L=L.values().next().value);var J=L.source,Fe=J===ie?L.target:J;re(Fe.key,Fe.attributes)}}function ga(ie,fe,re,M){for(var L in re){var J=re[L];J instanceof Set&&(J=J.values().next().value);var we=J.source,nt=we===fe?J.target:we;ie.has(nt.key)||(ie.add(nt.key),M(nt.key,nt.attributes))}}function _s(ie,fe,re){for(var M in fe){var L=fe[M];L instanceof Set&&(L=L.values().next().value);var J=L.source,Fe=J===ie?L.target:J;if(re(Fe.key,Fe.attributes))return!0}return!1}function Zt(ie,fe,re,M){for(var L in re){var J=re[L];J instanceof Set&&(J=J.values().next().value);var we=J.source,nt=we===fe?J.target:we;if(!ie.has(nt.key)&&(ie.add(nt.key),M(nt.key,nt.attributes)))return!0}return!1}function Qa(ie,fe){var re=Object.keys(fe),M=re.length,L=0;return new oe(function(){if(L>=M)return{done:!0};var J=fe[re[L++]];J instanceof Set&&(J=J.values().next().value);var we=J.source,nt=we===ie?J.target:we;return{done:!1,value:[nt.key,nt.attributes]}})}function rt(ie,fe,re){var M=Object.keys(re),L=M.length,J=0;return new oe(function we(){if(J>=L)return{done:!0};var Fe=re[M[J++]];Fe instanceof Set&&(Fe=Fe.values().next().value);var nt=Fe.source,We=nt===fe?Fe.target:nt;return ie.has(We.key)?we():(ie.add(We.key),{done:!1,value:[We.key,We.attributes]})})}function lt(ie,fe,re,M,L){var J=ie._nodes.get(M);if("undirected"!==fe){if("out"!==re&&void 0!==J.in)for(var we in J.in)if(we===L)return!0;if("in"!==re&&void 0!==J.out)for(var Fe in J.out)if(Fe===L)return!0}if("directed"!==fe&&void 0!==J.undirected)for(var nt in J.undirected)if(nt===L)return!0;return!1}function ke(ie,fe,re){for(var M,L,J,we,Fe,nt,Ot,We=fe._nodes.values(),Gt=fe.type;!0!==(M=We.next()).done;){if(L=M.value,"undirected"!==Gt)for(J in we=L.out)if(nt=(Fe=we[J]).target,Ot=re(L.key,nt.key,L.attributes,nt.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ie&&Ot)return;if("directed"!==Gt)for(J in we=L.undirected)if((nt=(Fe=we[J]).target).key!==J&&(nt=Fe.source),Ot=re(L.key,nt.key,L.attributes,nt.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ie&&Ot)return}}function ut(ie,fe,re){for(var M,L,J,we,Fe,nt,Ot,We,Gt,Tt=fe._nodes.values(),pn=fe.type;!0!==(M=Tt.next()).done;){if(L=M.value,"undirected"!==pn)for(J in nt=L.out)for(we=nt[J].values();!0!==(Fe=we.next()).done;)if(We=(Ot=Fe.value).target,Gt=re(L.key,We.key,L.attributes,We.attributes,Ot.key,Ot.attributes,Ot.undirected,Ot.generatedKey),ie&&Gt)return;if("directed"!==pn)for(J in nt=L.undirected)for(we=nt[J].values();!0!==(Fe=we.next()).done;)if((We=(Ot=Fe.value).target).key!==J&&(We=Ot.source),Gt=re(L.key,We.key,L.attributes,We.attributes,Ot.key,Ot.attributes,Ot.undirected,Ot.generatedKey),ie&&Gt)return}}function Ze(ie,fe){var re={key:ie};return Q(fe.attributes)||(re.attributes=he({},fe.attributes)),re}function Ct(ie,fe){var re={source:fe.source.key,target:fe.target.key};return fe.generatedKey||(re.key=ie),Q(fe.attributes)||(re.attributes=he({},fe.attributes)),fe.undirected&&(re.undirected=!0),re}function Mt(ie){return P(ie)?"key"in ie?!("attributes"in ie)||P(ie.attributes)&&null!==ie.attributes?null:"invalid-attributes":"no-key":"not-object"}function Dt(ie){return P(ie)?"source"in ie?"target"in ie?!("attributes"in ie)||P(ie.attributes)&&null!==ie.attributes?"undirected"in ie&&"boolean"!=typeof ie.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var Yt=new Set(["directed","undirected","mixed"]),Un=new Set(["domain","_events","_eventsCount","_maxListeners"]),ii={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function Rn(ie,fe,re){var M=new ie.NodeDataClass(fe,re);return ie._nodes.set(fe,M),ie.emit("nodeAdded",{key:fe,attributes:re}),M}function fn(ie,fe,re,M,L,J,we,Fe){if(!M&&"undirected"===ie.type)throw new _e("Graph.".concat(fe,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(M&&"directed"===ie.type)throw new _e("Graph.".concat(fe,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe&&!P(Fe))throw new ge("Graph.".concat(fe,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));if(J=""+J,we=""+we,Fe=Fe||{},!ie.allowSelfLoops&&J===we)throw new _e("Graph.".concat(fe,': source & target are the same ("').concat(J,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var nt=ie._nodes.get(J),Ot=ie._nodes.get(we);if(!nt)throw new ne("Graph.".concat(fe,': source node "').concat(J,'" not found.'));if(!Ot)throw new ne("Graph.".concat(fe,': target node "').concat(we,'" not found.'));var We={key:null,undirected:M,source:J,target:we,attributes:Fe};if(re&&(L=ie._edgeKeyGenerator(We)),ie._edges.has(L=""+L))throw new _e("Graph.".concat(fe,': the "').concat(L,'" edge already exists in the graph.'));if(!ie.multi&&(M?void 0!==nt.undirected[we]:void 0!==nt.out[we]))throw new _e("Graph.".concat(fe,': an edge linking "').concat(J,'" to "').concat(we,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var Gt=new Xe(M,L,re,nt,Ot,Fe);return ie._edges.set(L,Gt),J===we?M?(nt.undirectedSelfLoops++,ie._undirectedSelfLoopCount++):(nt.directedSelfLoops++,ie._directedSelfLoopCount++):M?(nt.undirectedDegree++,Ot.undirectedDegree++):(nt.outDegree++,Ot.inDegree++),tt(ie,M,Gt,J,we,nt,Ot),M?ie._undirectedSize++:ie._directedSize++,We.key=L,ie.emit("edgeAdded",We),L}function Hn(ie,fe,re,M,L,J,we,Fe,nt){if(!M&&"undirected"===ie.type)throw new _e("Graph.".concat(fe,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(M&&"directed"===ie.type)throw new _e("Graph.".concat(fe,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe)if(nt){if("function"!=typeof Fe)throw new ge("Graph.".concat(fe,': invalid updater function. Expecting a function but got "').concat(Fe,'"'))}else if(!P(Fe))throw new ge("Graph.".concat(fe,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));var Ot;if(J=""+J,we=""+we,nt&&(Ot=Fe,Fe=void 0),!ie.allowSelfLoops&&J===we)throw new _e("Graph.".concat(fe,': source & target are the same ("').concat(J,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var We,Gt,Tt=ie._nodes.get(J),pn=ie._nodes.get(we);if(!re&&(We=ie._edges.get(L))){if(We.source.key!==J||We.target.key!==we||M&&(We.source.key!==we||We.target.key!==J))throw new _e("Graph.".concat(fe,': inconsistency detected when attempting to merge the "').concat(L,'" edge with "').concat(J,'" source & "').concat(we,'" target vs. ("').concat(We.source.key,'", "').concat(We.target.key,'").'));Gt=We}if(Gt||ie.multi||!Tt||(Gt=M?Tt.undirected[we]:Tt.out[we]),Gt)return(nt?Ot:Fe)?(nt?(Gt.attributes=Ot(Gt.attributes),ie.emit("edgeAttributesUpdated",{type:"replace",key:Gt.key,attributes:Gt.attributes})):(he(Gt.attributes,Fe),ie.emit("edgeAttributesUpdated",{type:"merge",key:Gt.key,attributes:Gt.attributes,data:Fe})),Gt.key):Gt.key;Fe=Fe||{},nt&&Ot&&(Fe=Ot(Fe));var qr={key:null,undirected:M,source:J,target:we,attributes:Fe};if(re&&(L=ie._edgeKeyGenerator(qr)),ie._edges.has(L=""+L))throw new _e("Graph.".concat(fe,': the "').concat(L,'" edge already exists in the graph.'));return Tt||(Tt=Rn(ie,J,{}),J===we&&(pn=Tt)),pn||(pn=Rn(ie,we,{})),We=new Xe(M,L,re,Tt,pn,Fe),ie._edges.set(L,We),J===we?M?(Tt.undirectedSelfLoops++,ie._undirectedSelfLoopCount++):(Tt.directedSelfLoops++,ie._directedSelfLoopCount++):M?(Tt.undirectedDegree++,pn.undirectedDegree++):(Tt.outDegree++,pn.inDegree++),tt(ie,M,We,J,we,Tt,pn),M?ie._undirectedSize++:ie._directedSize++,qr.key=L,ie.emit("edgeAdded",qr),L}var ie,En=function(ie){function fe(M){var L;if(L=ie.call(this)||this,(M=he({},ii,M)).edgeKeyGenerator&&"function"!=typeof M.edgeKeyGenerator)throw new ge("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(M.edgeKeyGenerator,'".'));if("boolean"!=typeof M.multi)throw new ge("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(M.multi,'".'));if(!Yt.has(M.type))throw new ge('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(M.type,'".'));if("boolean"!=typeof M.allowSelfLoops)throw new ge("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(M.allowSelfLoops,'".'));var J,we="mixed"===M.type?Ie:"directed"===M.type?Ge:st;return z(Se(L),"NodeDataClass",we),z(Se(L),"_attributes",{}),z(Se(L),"_nodes",new Map),z(Se(L),"_edges",new Map),z(Se(L),"_directedSize",0),z(Se(L),"_undirectedSize",0),z(Se(L),"_directedSelfLoopCount",0),z(Se(L),"_undirectedSelfLoopCount",0),z(Se(L),"_edgeKeyGenerator",M.edgeKeyGenerator||(J=0,function(){return J++})),z(Se(L),"_options",M),Un.forEach(function(Fe){return z(Se(L),Fe,L[Fe])}),v(Se(L),"order",function(){return L._nodes.size}),v(Se(L),"size",function(){return L._edges.size}),v(Se(L),"directedSize",function(){return L._directedSize}),v(Se(L),"undirectedSize",function(){return L._undirectedSize}),v(Se(L),"selfLoopCount",function(){return L._directedSelfLoopCount+L._undirectedSelfLoopCount}),v(Se(L),"directedSelfLoopCount",function(){return L._directedSelfLoopCount}),v(Se(L),"undirectedSelfLoopCount",function(){return L._undirectedSelfLoopCount}),v(Se(L),"multi",L._options.multi),v(Se(L),"type",L._options.type),v(Se(L),"allowSelfLoops",L._options.allowSelfLoops),v(Se(L),"implementation",function(){return"graphology"}),L}Je(fe,ie);var re=fe.prototype;return re.hasNode=function(M){return this._nodes.has(""+M)},re.hasDirectedEdge=function(M,L){if("undirected"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+M);return!!we&&!we.undirected}if(2===arguments.length){L=""+L;var Fe=this._nodes.get(M=""+M);if(!Fe)return!1;var nt=Fe.out[L];return!(!nt||this.multi&&!nt.size)}throw new ge("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasUndirectedEdge=function(M,L){if("directed"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+M);return!!we&&we.undirected}if(2===arguments.length){L=""+L;var Fe=this._nodes.get(M=""+M);if(!Fe)return!1;var nt=Fe.undirected[L];return!(!nt||this.multi&&!nt.size)}throw new ge("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasEdge=function(M,L){if(1===arguments.length)return this._edges.has(""+M);if(2===arguments.length){L=""+L;var we=this._nodes.get(M=""+M);if(!we)return!1;var Fe=void 0!==we.out&&we.out[L];return Fe||(Fe=void 0!==we.undirected&&we.undirected[L]),!(!Fe||this.multi&&!Fe.size)}throw new ge("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.directedEdge=function(M,L){if("undirected"!==this.type){if(M=""+M,L=""+L,this.multi)throw new _e("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var J=this._nodes.get(M);if(!J)throw new ne('Graph.directedEdge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(L))throw new ne('Graph.directedEdge: could not find the "'.concat(L,'" target node in the graph.'));var we=J.out&&J.out[L]||void 0;return we?we.key:void 0}},re.undirectedEdge=function(M,L){if("directed"!==this.type){if(M=""+M,L=""+L,this.multi)throw new _e("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var J=this._nodes.get(M);if(!J)throw new ne('Graph.undirectedEdge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(L))throw new ne('Graph.undirectedEdge: could not find the "'.concat(L,'" target node in the graph.'));var we=J.undirected&&J.undirected[L]||void 0;return we?we.key:void 0}},re.edge=function(M,L){if(this.multi)throw new _e("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");L=""+L;var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.edge: could not find the "'.concat(M,'" source node in the graph.'));if(!this._nodes.has(L))throw new ne('Graph.edge: could not find the "'.concat(L,'" target node in the graph.'));var we=J.out&&J.out[L]||J.undirected&&J.undirected[L]||void 0;if(we)return we.key},re.inDegree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new ge('Graph.inDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.inDegree: could not find the "'.concat(M,'" node in the graph.'));return"undirected"===this.type?0:J.inDegree+(L?J.directedSelfLoops:0)},re.outDegree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new ge('Graph.outDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.outDegree: could not find the "'.concat(M,'" node in the graph.'));return"undirected"===this.type?0:J.outDegree+(L?J.directedSelfLoops:0)},re.directedDegree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new ge('Graph.directedDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.directedDegree: could not find the "'.concat(M,'" node in the graph.'));if("undirected"===this.type)return 0;var we=L?J.directedSelfLoops:0;return J.inDegree+we+(J.outDegree+we)},re.undirectedDegree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new ge('Graph.undirectedDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.undirectedDegree: could not find the "'.concat(M,'" node in the graph.'));return"directed"===this.type?0:J.undirectedDegree+2*(L?J.undirectedSelfLoops:0)},re.degree=function(M){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new ge('Graph.degree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.degree: could not find the "'.concat(M,'" node in the graph.'));var we=0,Fe=0;return"directed"!==this.type&&(L&&(Fe=J.undirectedSelfLoops),we+=J.undirectedDegree+2*Fe),"undirected"!==this.type&&(L&&(Fe=J.directedSelfLoops),we+=J.inDegree+J.outDegree+2*Fe),we},re.source=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.source: could not find the "'.concat(M,'" edge in the graph.'));return L.source.key},re.target=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.target: could not find the "'.concat(M,'" edge in the graph.'));return L.target.key},re.extremities=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.extremities: could not find the "'.concat(M,'" edge in the graph.'));return[L.source.key,L.target.key]},re.opposite=function(M,L){M=""+M;var J=this._edges.get(L=""+L);if(!J)throw new ne('Graph.opposite: could not find the "'.concat(L,'" edge in the graph.'));var we=J.source.key,Fe=J.target.key;if(M!==we&&M!==Fe)throw new ne('Graph.opposite: the "'.concat(M,'" node is not attached to the "').concat(L,'" edge (').concat(we,", ").concat(Fe,")."));return M===we?Fe:we},re.hasExtremity=function(M,L){L=""+L;var J=this._edges.get(M=""+M);if(!J)throw new ne('Graph.hasExtremity: could not find the "'.concat(M,'" edge in the graph.'));return J.source.key===L||J.target.key===L},re.isUndirected=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.isUndirected: could not find the "'.concat(M,'" edge in the graph.'));return L.undirected},re.isDirected=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.isDirected: could not find the "'.concat(M,'" edge in the graph.'));return!L.undirected},re.isSelfLoop=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.isSelfLoop: could not find the "'.concat(M,'" edge in the graph.'));return L.source===L.target},re.hasGeneratedKey=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.hasGeneratedKey: could not find the "'.concat(M,'" edge in the graph.'));return L.generatedKey},re.addNode=function(M,L){return function(J,we,Fe){if(Fe&&!P(Fe))throw new ge('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Fe,'"'));if(Fe=Fe||{},J._nodes.has(we=""+we))throw new _e('Graph.addNode: the "'.concat(we,'" node already exist in the graph.'));var nt=new J.NodeDataClass(we,Fe);return J._nodes.set(we,nt),J.emit("nodeAdded",{key:we,attributes:Fe}),nt}(this,M,L).key},re.mergeNode=function(M,L){if(L&&!P(L))throw new ge('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(L,'"'));L=L||{};var J=this._nodes.get(M=""+M);return J?(L&&(he(J.attributes,L),this.emit("nodeAttributesUpdated",{type:"merge",key:M,attributes:J.attributes,data:L})),M):(J=new this.NodeDataClass(M,L),this._nodes.set(M,J),this.emit("nodeAdded",{key:M,attributes:L}),M)},re.updateNode=function(M,L){if(L&&"function"!=typeof L)throw new ge('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(L,'"'));var J=this._nodes.get(M=""+M);if(J)return L&&(J.attributes=L(J.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:M,attributes:J.attributes})),M;var Fe=L?L({}):{};return J=new this.NodeDataClass(M,Fe),this._nodes.set(M,J),this.emit("nodeAdded",{key:M,attributes:Fe}),M},re.dropNode=function(M){var L=this,J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.dropNode: could not find the "'.concat(M,'" node in the graph.'));this.forEachEdge(M,function(we){L.dropEdge(we)}),this._nodes.delete(M),this.emit("nodeDropped",{key:M,attributes:J.attributes})},re.dropEdge=function(M){var L;if(arguments.length>1){var J=""+arguments[0],we=""+arguments[1];if(!(L=W(this,J,we,this.type)))throw new ne('Graph.dropEdge: could not find the "'.concat(J,'" -> "').concat(we,'" edge in the graph.'))}else if(!(L=this._edges.get(M=""+M)))throw new ne('Graph.dropEdge: could not find the "'.concat(M,'" edge in the graph.'));this._edges.delete(L.key);var nt=L.source,Ot=L.target,We=L.attributes,Gt=L.undirected;return nt===Ot?Gt?(nt.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(nt.directedSelfLoops--,this._directedSelfLoopCount--):Gt?(nt.undirectedDegree--,Ot.undirectedDegree--):(nt.outDegree--,Ot.inDegree--),Ye(this,Gt,L),Gt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:M,attributes:We,source:nt.key,target:Ot.key,undirected:Gt}),this},re.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},re.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},re.getAttribute=function(M){return this._attributes[M]},re.getAttributes=function(){return this._attributes},re.hasAttribute=function(M){return this._attributes.hasOwnProperty(M)},re.setAttribute=function(M,L){return this._attributes[M]=L,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:M}),this},re.updateAttribute=function(M,L){if("function"!=typeof L)throw new ge("Graph.updateAttribute: updater should be a function.");return this._attributes[M]=L(this._attributes[M]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:M}),this},re.removeAttribute=function(M){return delete this._attributes[M],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:M}),this},re.replaceAttributes=function(M){if(!P(M))throw new ge("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=M,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},re.mergeAttributes=function(M){if(!P(M))throw new ge("Graph.mergeAttributes: provided attributes are not a plain object.");return he(this._attributes,M),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:M}),this},re.getNodeAttribute=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.getNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return J.attributes[L]},re.getNodeAttributes=function(M){var L=this._nodes.get(M=""+M);if(!L)throw new ne('Graph.getNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));return L.attributes},re.hasNodeAttribute=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.hasNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return J.attributes.hasOwnProperty(L)},re.setNodeAttribute=function(M,L,J){var we=this._nodes.get(M=""+M);if(!we)throw new ne('Graph.setNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));if(arguments.length<3)throw new ge("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return we.attributes[L]=J,this.emit("nodeAttributesUpdated",{key:M,type:"set",attributes:we.attributes,name:L}),this},re.updateNodeAttribute=function(M,L,J){var we=this._nodes.get(M=""+M);if(!we)throw new ne('Graph.updateNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));if(arguments.length<3)throw new ge("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof J)throw new ge("Graph.updateAttribute: updater should be a function.");var Fe=we.attributes,nt=J(Fe[L]);return Fe[L]=nt,this.emit("nodeAttributesUpdated",{key:M,type:"set",attributes:we.attributes,name:L}),this},re.removeNodeAttribute=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.hasNodeAttribute: could not find the "'.concat(M,'" node in the graph.'));return delete J.attributes[L],this.emit("nodeAttributesUpdated",{key:M,type:"remove",attributes:J.attributes,name:L}),this},re.replaceNodeAttributes=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.replaceNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));if(!P(L))throw new ge("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return J.attributes=L,this.emit("nodeAttributesUpdated",{key:M,type:"replace",attributes:J.attributes}),this},re.mergeNodeAttributes=function(M,L){var J=this._nodes.get(M=""+M);if(!J)throw new ne('Graph.mergeNodeAttributes: could not find the "'.concat(M,'" node in the graph.'));if(!P(L))throw new ge("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return he(J.attributes,L),this.emit("nodeAttributesUpdated",{key:M,type:"merge",attributes:J.attributes,data:L}),this},re.updateEachNodeAttributes=function(M,L){if("function"!=typeof M)throw new ge("Graph.updateEachNodeAttributes: expecting an updater function.");if(L&&!x(L))throw new ge("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var J,we,Fe=this._nodes.values();!0!==(J=Fe.next()).done;)(we=J.value).attributes=M(we.key,we.attributes);this.emit("eachNodeAttributesUpdated",{hints:L||null})},re.updateEachEdgeAttributes=function(M,L){if("function"!=typeof M)throw new ge("Graph.updateEachEdgeAttributes: expecting an updater function.");if(L&&!x(L))throw new ge("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var J,we,Fe=this._edges.values();!0!==(J=Fe.next()).done;)(we=J.value).attributes=M(we.key,we.attributes);this.emit("eachEdgeAttributesUpdated",{hints:L||null})},re.forEach=function(M){if("function"!=typeof M)throw new ge("Graph.forEach: expecting a callback.");this.multi?ut(!1,this,M):ke(!1,this,M)},re.forEachUntil=function(M){if("function"!=typeof M)throw new ge("Graph.forEach: expecting a callback.");this.multi?ut(!0,this,M):ke(!0,this,M)},re.adjacency=function(){return this.multi?(nt=(M=this)._nodes.values(),Ot=M.type,We="outer",Gt=null,new oe(function Tt(){var pn;if("outer"===We)return!0===(pn=nt.next()).done?pn:(L=pn.value,We="directed",Tt());if("directed"===We)return"undirected"===Ot?(We="undirected",Tt()):(we=L.out,J=Object.keys(L.out),Fe=0,We="inner-directed",Tt());if("undirected"===We){if("directed"===Ot)return We="outer",Tt();we=L.undirected,J=Object.keys(L.undirected),Fe=0,We="inner-undirected"}if(!Gt&&Fe>=J.length)return We="inner-undirected"===We?"outer":"undirected",Tt();if(!Gt){var ys=J[Fe++];return Gt=we[ys].values(),Tt()}if((pn=Gt.next()).done)return Gt=null,Tt();var qr=pn.value,Ys=qr.target;return"inner-undirected"===We&&Ys.key===L.key&&(Ys=qr.source),{done:!1,value:[L.key,Ys.key,L.attributes,Ys.attributes,qr.key,qr.attributes]}})):(Il=(Tt=this)._nodes.values(),lo=Tt.type,Fr="outer",new oe(function Fs(){var mc;if("outer"===Fr)return!0===(mc=Il.next()).done?mc:(pn=mc.value,Fr="directed",Fs());if("directed"===Fr)return"undirected"===lo?(Fr="undirected",Fs()):(qr=pn.out,ys=Object.keys(pn.out),Ys=0,Fr="inner-directed",Fs());if("undirected"===Fr){if("directed"===lo)return Fr="outer",Fs();qr=pn.undirected,ys=Object.keys(pn.undirected),Ys=0,Fr="inner-undirected"}if(Ys>=ys.length)return Fr="inner-undirected"===Fr?"outer":"undirected",Fs();var bn=ys[Ys++],co=qr[bn],Ol=co.target;return"inner-undirected"===Fr&&Ol.key===pn.key&&(Ol=co.source),{done:!1,value:[pn.key,Ol.key,pn.attributes,Ol.attributes,co.key,co.attributes]}}));var Tt,pn,ys,qr,Ys,Il,lo,Fr,M,L,J,we,Fe,nt,Ot,We,Gt},re.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):te(this._nodes.keys(),this._nodes.size)},re.forEachNode=function(M){if("function"!=typeof M)throw new ge("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(L,J){M(J,L.attributes)})},re.forEachNodeUntil=function(M){if("function"!=typeof M)throw new ge("Graph.forEachNode: expecting a callback.");for(var L,J,we=this._nodes.values();!0!==(L=we.next())&&!M((J=L.value).key,J.attributes););},re.nodeEntries=function(){var M=this._nodes.values();return new oe(function(){var L=M.next();if(L.done)return L;var J=L.value;return{value:[J.key,J.attributes],done:!1}})},re.exportNode=function(M){var L=this._nodes.get(M=""+M);if(!L)throw new ne('Graph.exportNode: could not find the "'.concat(M,'" node in the graph.'));return Ze(M,L)},re.exportEdge=function(M){var L=this._edges.get(M=""+M);if(!L)throw new ne('Graph.exportEdge: could not find the "'.concat(M,'" edge in the graph.'));return Ct(M,L)},re.export=function(){var M=new Array(this._nodes.size),L=0;this._nodes.forEach(function(we,Fe){M[L++]=Ze(Fe,we)});var J=new Array(this._edges.size);return L=0,this._edges.forEach(function(we,Fe){J[L++]=Ct(Fe,we)}),{attributes:this.getAttributes(),nodes:M,edges:J,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},re.importNode=function(M){var L=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=Mt(M);if(J){if("not-object"===J)throw new ge('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===J)throw new ge("Graph.importNode: no key provided.");if("invalid-attributes"===J)throw new ge("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var we=M.key,Fe=M.attributes,nt=void 0===Fe?{}:Fe;return L?this.mergeNode(we,nt):this.addNode(we,nt),this},re.importEdge=function(M){var L=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=Dt(M);if(J){if("not-object"===J)throw new ge('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===J)throw new ge("Graph.importEdge: missing souce.");if("no-target"===J)throw new ge("Graph.importEdge: missing target.");if("invalid-attributes"===J)throw new ge("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===J)throw new ge("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var we=M.source,Fe=M.target,nt=M.attributes,Ot=void 0===nt?{}:nt,We=M.undirected,Gt=void 0!==We&&We;return"key"in M?(L?Gt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:Gt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,M.key,we,Fe,Ot):(L?Gt?this.mergeUndirectedEdge:this.mergeDirectedEdge:Gt?this.addUndirectedEdge:this.addDirectedEdge).call(this,we,Fe,Ot),this},re.import=function(M){var L,J,we,Fe=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(j(M))return this.import(M.export(),Fe),this;if(!P(M))throw new ge("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(M.attributes){if(!P(M.attributes))throw new ge("Graph.import: invalid attributes. Expecting a plain object.");Fe?this.mergeAttributes(M.attributes):this.replaceAttributes(M.attributes)}if(M.nodes){if(we=M.nodes,!Array.isArray(we))throw new ge("Graph.import: invalid nodes. Expecting an array.");for(L=0,J=we.length;L<J;L++)this.importNode(we[L],Fe)}if(M.edges){if(we=M.edges,!Array.isArray(we))throw new ge("Graph.import: invalid edges. Expecting an array.");for(L=0,J=we.length;L<J;L++)this.importEdge(we[L],Fe)}return this},re.nullCopy=function(M){return new fe(he({},this._options,M))},re.emptyCopy=function(M){var L=this.nullCopy(M);return this._nodes.forEach(function(J,we){var Fe=he({},J.attributes);J=new L.NodeDataClass(we,Fe),L._nodes.set(we,J)}),L},re.copy=function(){var M=new fe(this._options);return M.import(this),M},re.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(M){return M.upgradeToMixed()}),this._options.type="mixed",v(this,"type",this._options.type),z(this,"NodeDataClass",Ie)),this},re.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,v(this,"multi",!0),(M=this)._nodes.forEach(function(L,J){if(L.out)for(var we in L.out){var Fe=new Set;Fe.add(L.out[we]),L.out[we]=Fe,M._nodes.get(we).in[J]=Fe}if(L.undirected)for(var nt in L.undirected)if(!(nt>J)){var Ot=new Set;Ot.add(L.undirected[nt]),L.undirected[nt]=Ot,M._nodes.get(nt).undirected[J]=Ot}})),this;var M},re.clearIndex=function(){return this._nodes.forEach(function(M){void 0!==M.in&&(M.in={},M.out={}),void 0!==M.undirected&&(M.undirected={})}),this},re.toJSON=function(){return this.export()},re.toString=function(){return"[object Graph]"},re.inspect=function(){var M=this,L={};this._nodes.forEach(function(Ot,We){L[We]=Ot.attributes});var J={},we={};this._edges.forEach(function(Ot,We){var Gt=Ot.undirected?"--":"->",Tt="",pn="(".concat(Ot.source.key,")").concat(Gt,"(").concat(Ot.target.key,")");Ot.generatedKey?M.multi&&(void 0===we[pn]?we[pn]=0:we[pn]++,Tt+="".concat(we[pn],". ")):Tt+="[".concat(We,"]: "),J[Tt+=pn]=Ot.attributes});var Fe={};for(var nt in this)this.hasOwnProperty(nt)&&!Un.has(nt)&&"function"!=typeof this[nt]&&(Fe[nt]=this[nt]);return Fe.attributes=this._attributes,Fe.nodes=L,Fe.edges=J,z(Fe,"constructor",this.constructor),Fe},fe}(A.exports.EventEmitter);"undefined"!=typeof Symbol&&(En.prototype[Symbol.for("nodejs.util.inspect.custom")]=En.prototype.inspect),[{name:function(ie){return"".concat(ie,"Edge")},generateKey:!0},{name:function(ie){return"".concat(ie,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(ie){return"".concat(ie,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(ie){return"".concat(ie,"EdgeWithKey")}},{name:function(ie){return"".concat(ie,"DirectedEdgeWithKey")},type:"directed"},{name:function(ie){return"".concat(ie,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(ie){["add","merge","update"].forEach(function(fe){var re=ie.name(fe),M="add"===fe?fn:Hn;En.prototype[re]=ie.generateKey?function(L,J,we){return M(this,re,!0,"undirected"===(ie.type||this.type),null,L,J,we,"update"===fe)}:function(L,J,we,Fe){return M(this,re,!1,"undirected"===(ie.type||this.type),L,J,we,Fe,"update"===fe)}})}),"undefined"!=typeof Symbol&&(En.prototype[Symbol.iterator]=En.prototype.adjacency),ie=En,Ue.forEach(function(fe){var re=fe.name,M=fe.attacher;M(ie,re("Edge"),"mixed"),M(ie,re("DirectedEdge"),"directed"),M(ie,re("UndirectedEdge"),"undirected")}),function(ie){Te.forEach(function(fe){var M,L,J,we;J=(M=fe).type,we=M.direction,ie.prototype[L=M.name]=function(Fe,nt){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return[];if(!arguments.length)return Re(this,J);if(1===arguments.length){var Ot=this._nodes.get(Fe=""+Fe);if(void 0===Ot)throw new ne("Graph.".concat(L,': could not find the "').concat(Fe,'" node in the graph.'));return In(this.multi,"mixed"===J?this.type:J,we,Ot)}if(2===arguments.length){nt=""+nt;var We=this._nodes.get(Fe=""+Fe);if(!We)throw new ne("Graph.".concat(L,':  could not find the "').concat(Fe,'" source node in the graph.'));if(!this._nodes.has(nt))throw new ne("Graph.".concat(L,':  could not find the "').concat(nt,'" target node in the graph.'));return gi(J,this.multi,we,We,nt)}throw new ge("Graph.".concat(L,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(re,M){var L=M.name,J=M.type,we=M.direction,Fe="forEach"+L[0].toUpperCase()+L.slice(1,-1);re.prototype[Fe]=function(nt,Ot,We){if("mixed"===J||"mixed"===this.type||J===this.type){if(1===arguments.length)return Qe(this,J,We=nt);if(2===arguments.length){We=Ot;var Gt=this._nodes.get(nt=""+nt);if(void 0===Gt)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return Ln(this.multi,"mixed"===J?this.type:J,we,Gt,We)}if(3===arguments.length){Ot=""+Ot;var Tt=this._nodes.get(nt=""+nt);if(!Tt)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return Gr(J,this.multi,we,Tt,Ot,We)}throw new ge("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ie,fe),function(re,M){var L=M.name,J=M.type,we=M.direction,Fe="forEach"+L[0].toUpperCase()+L.slice(1,-1)+"Until";re.prototype[Fe]=function(nt,Ot,We){if("mixed"===J||"mixed"===this.type||J===this.type){if(1===arguments.length)return St(this,J,We=nt);if(2===arguments.length){We=Ot;var Gt=this._nodes.get(nt=""+nt);if(void 0===Gt)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return Wn(this.multi,"mixed"===J?this.type:J,we,Gt,We)}if(3===arguments.length){Ot=""+Ot;var Tt=this._nodes.get(nt=""+nt);if(!Tt)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return Ns(J,this.multi,we,Tt,Ot,We)}throw new ge("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ie,fe),function(re,M){var J=M.type,we=M.direction,Fe=M.name.slice(0,-1)+"Entries";re.prototype[Fe]=function(nt,Ot){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return oe.empty();if(!arguments.length)return Rt(this,J);if(1===arguments.length){var We=this._nodes.get(nt=""+nt);if(!We)throw new ne("Graph.".concat(Fe,': could not find the "').concat(nt,'" node in the graph.'));return wi(J,we,We)}if(2===arguments.length){Ot=""+Ot;var Gt=this._nodes.get(nt=""+nt);if(!Gt)throw new ne("Graph.".concat(Fe,':  could not find the "').concat(nt,'" source node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(Fe,':  could not find the "').concat(Ot,'" target node in the graph.'));return us(J,we,Gt,Ot)}throw new ge("Graph.".concat(Fe,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(ie,fe)})}(En),function(ie){Ps.forEach(function(fe){var M,L,J,we;J=(M=fe).type,we=M.direction,ie.prototype[L=M.name]=function(Fe){if("mixed"!==J&&"mixed"!==this.type&&J!==this.type)return[];if(2===arguments.length){var nt=""+arguments[0],Ot=""+arguments[1];if(!this._nodes.has(nt))throw new ne("Graph.".concat(L,': could not find the "').concat(nt,'" node in the graph.'));if(!this._nodes.has(Ot))throw new ne("Graph.".concat(L,': could not find the "').concat(Ot,'" node in the graph.'));return lt(this,J,we,nt,Ot)}if(1===arguments.length){var We=this._nodes.get(Fe=""+Fe);if(void 0===We)throw new ne("Graph.".concat(L,': could not find the "').concat(Fe,'" node in the graph.'));return Xa("mixed"===J?this.type:J,we,We)}throw new ge("Graph.".concat(L,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(ie,fe){var re=fe.name,M=fe.type,L=fe.direction,J="forEach"+re[0].toUpperCase()+re.slice(1,-1);ie.prototype[J]=function(we,Fe){if("mixed"===M||"mixed"===this.type||M===this.type){var nt=this._nodes.get(we=""+we);if(void 0===nt)throw new ne("Graph.".concat(J,': could not find the "').concat(we,'" node in the graph.'));!function(Ot,We,Gt,Tt){if("mixed"!==Ot){if("undirected"===Ot)return Dl(Gt,Gt.undirected,Tt);if("string"==typeof We)return Dl(Gt,Gt[We],Tt)}var pn=new Set;"undirected"!==Ot&&("out"!==We&&ga(pn,Gt,Gt.in,Tt),"in"!==We&&ga(pn,Gt,Gt.out,Tt)),"directed"!==Ot&&ga(pn,Gt,Gt.undirected,Tt)}("mixed"===M?this.type:M,L,nt,Fe)}}}(ie,fe),function(ie,fe){var re=fe.name,M=fe.type,L=fe.direction,J="forEach"+re[0].toUpperCase()+re.slice(1,-1)+"Until";ie.prototype[J]=function(we,Fe){if("mixed"===M||"mixed"===this.type||M===this.type){var nt=this._nodes.get(we=""+we);if(void 0===nt)throw new ne("Graph.".concat(J,': could not find the "').concat(we,'" node in the graph.'));!function(Ot,We,Gt,Tt){if("mixed"!==Ot){if("undirected"===Ot)return _s(Gt,Gt.undirected,Tt);if("string"==typeof We)return _s(Gt,Gt[We],Tt)}var pn=new Set;"undirected"!==Ot&&("out"!==We&&Zt(pn,Gt,Gt.in,Tt)||"in"!==We&&Zt(pn,Gt,Gt.out,Tt))||"directed"===Ot||Zt(pn,Gt,Gt.undirected,Tt)}("mixed"===M?this.type:M,L,nt,Fe)}}}(ie,fe),function(ie,fe){var M=fe.type,L=fe.direction,J=fe.name.slice(0,-1)+"Entries";ie.prototype[J]=function(we){if("mixed"!==M&&"mixed"!==this.type&&M!==this.type)return oe.empty();var Fe=this._nodes.get(we=""+we);if(void 0===Fe)throw new ne("Graph.".concat(J,': could not find the "').concat(we,'" node in the graph.'));return function(nt,Ot,We){if("mixed"!==nt){if("undirected"===nt)return Qa(We,We.undirected);if("string"==typeof Ot)return Qa(We,We[Ot])}var Gt=oe.empty(),Tt=new Set;return"undirected"!==nt&&("out"!==Ot&&(Gt=Ke(Gt,rt(Tt,We,We.in))),"in"!==Ot&&(Gt=Ke(Gt,rt(Tt,We,We.out)))),"directed"!==nt&&(Gt=Ke(Gt,rt(Tt,We,We.undirected))),Gt}("mixed"===M?this.type:M,L,Fe)}}(ie,fe)})}(En);var nr=function(ie){function fe(re){var M=he({type:"directed"},re);if("multi"in M&&!1!==M.multi)throw new ge("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==M.type)throw new ge('DirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return ie.call(this,M)||this}return Je(fe,ie),fe}(En),ir=function(ie){function fe(re){var M=he({type:"undirected"},re);if("multi"in M&&!1!==M.multi)throw new ge("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==M.type)throw new ge('UndirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return ie.call(this,M)||this}return Je(fe,ie),fe}(En),Yn=function(ie){function fe(re){var M=he({multi:!0},re);if("multi"in M&&!0!==M.multi)throw new ge("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return ie.call(this,M)||this}return Je(fe,ie),fe}(En),Vi=function(ie){function fe(re){var M=he({type:"directed",multi:!0},re);if("multi"in M&&!0!==M.multi)throw new ge("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==M.type)throw new ge('MultiDirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return ie.call(this,M)||this}return Je(fe,ie),fe}(En),ma=function(ie){function fe(re){var M=he({type:"undirected",multi:!0},re);if("multi"in M&&!0!==M.multi)throw new ge("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==M.type)throw new ge('MultiUndirectedGraph.from: inconsistent "'+M.type+'" type in given options!');return ie.call(this,M)||this}return Je(fe,ie),fe}(En);function Wr(ie){ie.from=function(fe,re){var M=he({},fe.options,re),L=new ie(M);return L.import(fe),L}}return Wr(En),Wr(nr),Wr(ir),Wr(Yn),Wr(Vi),Wr(ma),En.Graph=En,En.DirectedGraph=nr,En.UndirectedGraph=ir,En.MultiGraph=Yn,En.MultiDirectedGraph=Vi,En.MultiUndirectedGraph=ma,En.InvalidArgumentsGraphError=ge,En.NotFoundGraphError=ne,En.UsageGraphError=_e,En}()},524:(Bt,it,Je)=>{var yt;!function(ee,At,dt,Y){"use strict";var A,Se=["","webkit","Moz","MS","ms","o"],he=At.createElement("div"),j=Math.round,P=Math.abs,Q=Date.now;function z(ye,Me,He){return setTimeout(T(ye,He),Me)}function v(ye,Me,He){return!!Array.isArray(ye)&&(x(ye,He[Me],He),!0)}function x(ye,Me,He){var bt;if(ye)if(ye.forEach)ye.forEach(Me,He);else if(ye.length!==Y)for(bt=0;bt<ye.length;)Me.call(He,ye[bt],bt,ye),bt++;else for(bt in ye)ye.hasOwnProperty(bt)&&Me.call(He,ye[bt],bt,ye)}function O(ye,Me,He){var bt="DEPRECATED METHOD: "+Me+"\n"+He+" AT \n";return function(){var Ut=new Error("get-stack-trace"),Wt=Ut&&Ut.stack?Ut.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ri=ee.console&&(ee.console.warn||ee.console.log);return ri&&ri.call(ee.console,bt,Wt),ye.apply(this,arguments)}}A="function"!=typeof Object.assign?function(Me){if(Me===Y||null===Me)throw new TypeError("Cannot convert undefined or null to object");for(var He=Object(Me),bt=1;bt<arguments.length;bt++){var Ut=arguments[bt];if(Ut!==Y&&null!==Ut)for(var Wt in Ut)Ut.hasOwnProperty(Wt)&&(He[Wt]=Ut[Wt])}return He}:Object.assign;var b=O(function(Me,He,bt){for(var Ut=Object.keys(He),Wt=0;Wt<Ut.length;)(!bt||bt&&Me[Ut[Wt]]===Y)&&(Me[Ut[Wt]]=He[Ut[Wt]]),Wt++;return Me},"extend","Use `assign`."),y=O(function(Me,He){return b(Me,He,!0)},"merge","Use `assign`.");function S(ye,Me,He){var Ut,bt=Me.prototype;(Ut=ye.prototype=Object.create(bt)).constructor=ye,Ut._super=bt,He&&A(Ut,He)}function T(ye,Me){return function(){return ye.apply(Me,arguments)}}function V(ye,Me){return"function"==typeof ye?ye.apply(Me&&Me[0]||Y,Me):ye}function R(ye,Me){return ye===Y?Me:ye}function K(ye,Me,He){x(X(Me),function(bt){ye.addEventListener(bt,He,!1)})}function ce(ye,Me,He){x(X(Me),function(bt){ye.removeEventListener(bt,He,!1)})}function D(ye,Me){for(;ye;){if(ye==Me)return!0;ye=ye.parentNode}return!1}function I(ye,Me){return ye.indexOf(Me)>-1}function X(ye){return ye.trim().split(/\s+/g)}function E(ye,Me,He){if(ye.indexOf&&!He)return ye.indexOf(Me);for(var bt=0;bt<ye.length;){if(He&&ye[bt][He]==Me||!He&&ye[bt]===Me)return bt;bt++}return-1}function $(ye){return Array.prototype.slice.call(ye,0)}function Z(ye,Me,He){for(var bt=[],Ut=[],Wt=0;Wt<ye.length;){var ri=Me?ye[Wt][Me]:ye[Wt];E(Ut,ri)<0&&bt.push(ye[Wt]),Ut[Wt]=ri,Wt++}return He&&(bt=Me?bt.sort(function(Yr,bs){return Yr[Me]>bs[Me]}):bt.sort()),bt}function se(ye,Me){for(var He,bt,Ut=Me[0].toUpperCase()+Me.slice(1),Wt=0;Wt<Se.length;){if((bt=(He=Se[Wt])?He+Ut:Me)in ye)return bt;Wt++}return Y}var oe=1;function xe(ye){var Me=ye.ownerDocument||ye;return Me.defaultView||Me.parentWindow||ee}var ne="ontouchstart"in ee,_e=se(ee,"PointerEvent")!==Y,Ie=ne&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ge="touch",Xe="mouse",_t=["x","y"],pt=["clientX","clientY"];function ve(ye,Me){var He=this;this.manager=ye,this.callback=Me,this.element=ye.element,this.target=ye.options.inputTarget,this.domHandler=function(bt){V(ye.options.enable,[ye])&&He.handler(bt)},this.init()}function N(ye,Me,He){var bt=He.pointers.length,Ut=He.changedPointers.length,Wt=1&Me&&bt-Ut==0,ri=12&Me&&bt-Ut==0;He.isFirst=!!Wt,He.isFinal=!!ri,Wt&&(ye.session={}),He.eventType=Me,function(ye,Me){var He=ye.session,bt=Me.pointers,Ut=bt.length;He.firstInput||(He.firstInput=St(Me)),Ut>1&&!He.firstMultiple?He.firstMultiple=St(Me):1===Ut&&(He.firstMultiple=!1);var Wt=He.firstInput,ri=He.firstMultiple,Lr=ri?ri.center:Wt.center,Yr=Me.center=Rt(bt);Me.timeStamp=Q(),Me.deltaTime=Me.timeStamp-Wt.timeStamp,Me.angle=wi(Lr,Yr),Me.distance=Wn(Lr,Yr),function(ye,Me){var He=Me.center,bt=ye.offsetDelta||{},Ut=ye.prevDelta||{},Wt=ye.prevInput||{};(1===Me.eventType||4===Wt.eventType)&&(Ut=ye.prevDelta={x:Wt.deltaX||0,y:Wt.deltaY||0},bt=ye.offsetDelta={x:He.x,y:He.y}),Me.deltaX=Ut.x+(He.x-bt.x),Me.deltaY=Ut.y+(He.y-bt.y)}(He,Me),Me.offsetDirection=Ln(Me.deltaX,Me.deltaY);var bs=In(Me.deltaTime,Me.deltaX,Me.deltaY);Me.overallVelocityX=bs.x,Me.overallVelocityY=bs.y,Me.overallVelocity=P(bs.x)>P(bs.y)?bs.x:bs.y,Me.scale=ri?function(ye,Me){return Wn(Me[0],Me[1],pt)/Wn(ye[0],ye[1],pt)}(ri.pointers,bt):1,Me.rotation=ri?function(ye,Me){return wi(Me[1],Me[0],pt)+wi(ye[1],ye[0],pt)}(ri.pointers,bt):0,Me.maxPointers=He.prevInput?Me.pointers.length>He.prevInput.maxPointers?Me.pointers.length:He.prevInput.maxPointers:Me.pointers.length,function(ye,Me){var Ut,Wt,ri,Lr,He=ye.lastInterval||Me,bt=Me.timeStamp-He.timeStamp;if(8!=Me.eventType&&(bt>25||He.velocity===Y)){var Yr=Me.deltaX-He.deltaX,bs=Me.deltaY-He.deltaY,ti=In(bt,Yr,bs);Wt=ti.x,ri=ti.y,Ut=P(ti.x)>P(ti.y)?ti.x:ti.y,Lr=Ln(Yr,bs),ye.lastInterval=Me}else Ut=He.velocity,Wt=He.velocityX,ri=He.velocityY,Lr=He.direction;Me.velocity=Ut,Me.velocityX=Wt,Me.velocityY=ri,Me.direction=Lr}(He,Me);var ti=ye.element;D(Me.srcEvent.target,ti)&&(ti=Me.srcEvent.target),Me.target=ti}(ye,He),ye.emit("hammer.input",He),ye.recognize(He),ye.session.prevInput=He}function St(ye){for(var Me=[],He=0;He<ye.pointers.length;)Me[He]={clientX:j(ye.pointers[He].clientX),clientY:j(ye.pointers[He].clientY)},He++;return{timeStamp:Q(),pointers:Me,center:Rt(Me),deltaX:ye.deltaX,deltaY:ye.deltaY}}function Rt(ye){var Me=ye.length;if(1===Me)return{x:j(ye[0].clientX),y:j(ye[0].clientY)};for(var He=0,bt=0,Ut=0;Ut<Me;)He+=ye[Ut].clientX,bt+=ye[Ut].clientY,Ut++;return{x:j(He/Me),y:j(bt/Me)}}function In(ye,Me,He){return{x:Me/ye||0,y:He/ye||0}}function Ln(ye,Me){return ye===Me?1:P(ye)>=P(Me)?ye<0?2:4:Me<0?8:16}function Wn(ye,Me,He){He||(He=_t);var bt=Me[He[0]]-ye[He[0]],Ut=Me[He[1]]-ye[He[1]];return Math.sqrt(bt*bt+Ut*Ut)}function wi(ye,Me,He){return He||(He=_t),180*Math.atan2(Me[He[1]]-ye[He[1]],Me[He[0]]-ye[He[0]])/Math.PI}ve.prototype={handler:function(){},init:function(){this.evEl&&K(this.element,this.evEl,this.domHandler),this.evTarget&&K(this.target,this.evTarget,this.domHandler),this.evWin&&K(xe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ce(this.element,this.evEl,this.domHandler),this.evTarget&&ce(this.target,this.evTarget,this.domHandler),this.evWin&&ce(xe(this.element),this.evWin,this.domHandler)}};var Ns={mousedown:1,mousemove:2,mouseup:4},us="mousedown",Ps="mousemove mouseup";function $r(){this.evEl=us,this.evWin=Ps,this.pressed=!1,ve.apply(this,arguments)}S($r,ve,{handler:function(Me){var He=Ns[Me.type];1&He&&0===Me.button&&(this.pressed=!0),2&He&&1!==Me.which&&(He=4),this.pressed&&(4&He&&(this.pressed=!1),this.callback(this.manager,He,{pointers:[Me],changedPointers:[Me],pointerType:Xe,srcEvent:Me}))}});var Xa={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Dl={2:Ge,3:"pen",4:Xe,5:"kinect"},ga="pointerdown",_s="pointermove pointerup pointercancel";function Zt(){this.evEl=ga,this.evWin=_s,ve.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ee.MSPointerEvent&&!ee.PointerEvent&&(ga="MSPointerDown",_s="MSPointerMove MSPointerUp MSPointerCancel"),S(Zt,ve,{handler:function(Me){var He=this.store,bt=!1,Ut=Me.type.toLowerCase().replace("ms",""),Wt=Xa[Ut],ri=Dl[Me.pointerType]||Me.pointerType,Lr=ri==Ge,Yr=E(He,Me.pointerId,"pointerId");1&Wt&&(0===Me.button||Lr)?Yr<0&&(He.push(Me),Yr=He.length-1):12&Wt&&(bt=!0),!(Yr<0)&&(He[Yr]=Me,this.callback(this.manager,Wt,{pointers:He,changedPointers:[Me],pointerType:ri,srcEvent:Me}),bt&&He.splice(Yr,1))}});var Qa={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rt="touchstart",lt="touchstart touchmove touchend touchcancel";function ht(){this.evTarget=rt,this.evWin=lt,this.started=!1,ve.apply(this,arguments)}function me(ye,Me){var He=$(ye.touches),bt=$(ye.changedTouches);return 12&Me&&(He=Z(He.concat(bt),"identifier",!0)),[He,bt]}S(ht,ve,{handler:function(Me){var He=Qa[Me.type];if(1===He&&(this.started=!0),this.started){var bt=me.call(this,Me,He);12&He&&bt[0].length-bt[1].length==0&&(this.started=!1),this.callback(this.manager,He,{pointers:bt[0],changedPointers:bt[1],pointerType:Ge,srcEvent:Me})}}});var be={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ke="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=ke,this.targetIds={},ve.apply(this,arguments)}function Ze(ye,Me){var He=$(ye.touches),bt=this.targetIds;if(3&Me&&1===He.length)return bt[He[0].identifier]=!0,[He,He];var Ut,Wt,ri=$(ye.changedTouches),Lr=[],Yr=this.target;if(Wt=He.filter(function(bs){return D(bs.target,Yr)}),1===Me)for(Ut=0;Ut<Wt.length;)bt[Wt[Ut].identifier]=!0,Ut++;for(Ut=0;Ut<ri.length;)bt[ri[Ut].identifier]&&Lr.push(ri[Ut]),12&Me&&delete bt[ri[Ut].identifier],Ut++;return Lr.length?[Z(Wt.concat(Lr),"identifier",!0),Lr]:void 0}function Dt(){ve.apply(this,arguments);var ye=T(this.handler,this);this.touch=new ut(this.manager,ye),this.mouse=new $r(this.manager,ye),this.primaryTouch=null,this.lastTouches=[]}function Yt(ye,Me){1&ye?(this.primaryTouch=Me.changedPointers[0].identifier,Un.call(this,Me)):12&ye&&Un.call(this,Me)}function Un(ye){var Me=ye.changedPointers[0];if(Me.identifier===this.primaryTouch){var He={x:Me.clientX,y:Me.clientY};this.lastTouches.push(He);var bt=this.lastTouches;setTimeout(function(){var Wt=bt.indexOf(He);Wt>-1&&bt.splice(Wt,1)},2500)}}function ii(ye){for(var Me=ye.srcEvent.clientX,He=ye.srcEvent.clientY,bt=0;bt<this.lastTouches.length;bt++){var Ut=this.lastTouches[bt],Wt=Math.abs(Me-Ut.x),ri=Math.abs(He-Ut.y);if(Wt<=25&&ri<=25)return!0}return!1}S(ut,ve,{handler:function(Me){var He=be[Me.type],bt=Ze.call(this,Me,He);!bt||this.callback(this.manager,He,{pointers:bt[0],changedPointers:bt[1],pointerType:Ge,srcEvent:Me})}}),S(Dt,ve,{handler:function(Me,He,bt){var Wt=bt.pointerType==Xe;if(!(Wt&&bt.sourceCapabilities&&bt.sourceCapabilities.firesTouchEvents)){if(bt.pointerType==Ge)Yt.call(this,He,bt);else if(Wt&&ii.call(this,bt))return;this.callback(Me,He,bt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Rn=se(he.style,"touchAction"),fn=Rn!==Y,Hn="compute",nr="manipulation",ir="none",Yn="pan-x",Vi="pan-y",ma=function(){if(!fn)return!1;var ye={},Me=ee.CSS&&ee.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(He){ye[He]=!Me||ee.CSS.supports("touch-action",He)}),ye}();function Wr(ye,Me){this.manager=ye,this.set(Me)}function Ot(ye){this.options=A({},this.defaults,ye||{}),this.id=oe++,this.manager=null,this.options.enable=R(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function We(ye){return 16&ye?"cancel":8&ye?"end":4&ye?"move":2&ye?"start":""}function Gt(ye){return 16==ye?"down":8==ye?"up":2==ye?"left":4==ye?"right":""}function Tt(ye,Me){var He=Me.manager;return He?He.get(ye):ye}function pn(){Ot.apply(this,arguments)}function ys(){pn.apply(this,arguments),this.pX=null,this.pY=null}function qr(){pn.apply(this,arguments)}function Ys(){Ot.apply(this,arguments),this._timer=null,this._input=null}function Il(){pn.apply(this,arguments)}function lo(){pn.apply(this,arguments)}function Fr(){Ot.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Fs(ye,Me){return(Me=Me||{}).recognizers=R(Me.recognizers,Fs.defaults.preset),new co(ye,Me)}function co(ye,Me){this.options=A({},Fs.defaults,Me||{}),this.options.inputTarget=this.options.inputTarget||ye,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ye,this.input=function(ye){return new(ye.options.inputClass||(_e?Zt:Ie?ut:ne?Dt:$r))(ye,N)}(this),this.touchAction=new Wr(this,this.options.touchAction),Ol(this,!0),x(this.options.recognizers,function(He){var bt=this.add(new He[0](He[1]));He[2]&&bt.recognizeWith(He[2]),He[3]&&bt.requireFailure(He[3])},this)}function Ol(ye,Me){var bt,He=ye.element;He.style&&(x(ye.options.cssProps,function(Ut,Wt){bt=se(He.style,Wt),Me?(ye.oldCssProps[bt]=He.style[bt],He.style[bt]=Ut):He.style[bt]=ye.oldCssProps[bt]||""}),Me||(ye.oldCssProps={}))}Wr.prototype={set:function(ye){ye==Hn&&(ye=this.compute()),fn&&this.manager.element.style&&ma[ye]&&(this.manager.element.style[Rn]=ye),this.actions=ye.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ye=[];return x(this.manager.recognizers,function(Me){V(Me.options.enable,[Me])&&(ye=ye.concat(Me.getTouchAction()))}),function(ye){if(I(ye,ir))return ir;var Me=I(ye,Yn),He=I(ye,Vi);return Me&&He?ir:Me||He?Me?Yn:Vi:I(ye,nr)?nr:"auto"}(ye.join(" "))},preventDefaults:function(ye){var Me=ye.srcEvent,He=ye.offsetDirection;if(!this.manager.session.prevented){var bt=this.actions,Ut=I(bt,ir)&&!ma[ir],Wt=I(bt,Vi)&&!ma[Vi],ri=I(bt,Yn)&&!ma[Yn];if(Ut&&1===ye.pointers.length&&ye.distance<2&&ye.deltaTime<250)return;return ri&&Wt||!(Ut||Wt&&6&He||ri&&24&He)?void 0:this.preventSrc(Me)}Me.preventDefault()},preventSrc:function(ye){this.manager.session.prevented=!0,ye.preventDefault()}},Ot.prototype={defaults:{},set:function(ye){return A(this.options,ye),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ye){if(v(ye,"recognizeWith",this))return this;var Me=this.simultaneous;return Me[(ye=Tt(ye,this)).id]||(Me[ye.id]=ye,ye.recognizeWith(this)),this},dropRecognizeWith:function(ye){return v(ye,"dropRecognizeWith",this)||(ye=Tt(ye,this),delete this.simultaneous[ye.id]),this},requireFailure:function(ye){if(v(ye,"requireFailure",this))return this;var Me=this.requireFail;return-1===E(Me,ye=Tt(ye,this))&&(Me.push(ye),ye.requireFailure(this)),this},dropRequireFailure:function(ye){if(v(ye,"dropRequireFailure",this))return this;ye=Tt(ye,this);var Me=E(this.requireFail,ye);return Me>-1&&this.requireFail.splice(Me,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ye){return!!this.simultaneous[ye.id]},emit:function(ye){var Me=this,He=this.state;function bt(Ut){Me.manager.emit(Ut,ye)}He<8&&bt(Me.options.event+We(He)),bt(Me.options.event),ye.additionalEvent&&bt(ye.additionalEvent),He>=8&&bt(Me.options.event+We(He))},tryEmit:function(ye){if(this.canEmit())return this.emit(ye);this.state=32},canEmit:function(){for(var ye=0;ye<this.requireFail.length;){if(!(33&this.requireFail[ye].state))return!1;ye++}return!0},recognize:function(ye){var Me=A({},ye);if(!V(this.options.enable,[this,Me]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Me),30&this.state&&this.tryEmit(Me)},process:function(ye){},getTouchAction:function(){},reset:function(){}},S(pn,Ot,{defaults:{pointers:1},attrTest:function(ye){var Me=this.options.pointers;return 0===Me||ye.pointers.length===Me},process:function(ye){var Me=this.state,He=ye.eventType,bt=6&Me,Ut=this.attrTest(ye);return bt&&(8&He||!Ut)?16|Me:bt||Ut?4&He?8|Me:2&Me?4|Me:2:32}}),S(ys,pn,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var ye=this.options.direction,Me=[];return 6&ye&&Me.push(Vi),24&ye&&Me.push(Yn),Me},directionTest:function(ye){var Me=this.options,He=!0,bt=ye.distance,Ut=ye.direction,Wt=ye.deltaX,ri=ye.deltaY;return Ut&Me.direction||(6&Me.direction?(Ut=0===Wt?1:Wt<0?2:4,He=Wt!=this.pX,bt=Math.abs(ye.deltaX)):(Ut=0===ri?1:ri<0?8:16,He=ri!=this.pY,bt=Math.abs(ye.deltaY))),ye.direction=Ut,He&&bt>Me.threshold&&Ut&Me.direction},attrTest:function(ye){return pn.prototype.attrTest.call(this,ye)&&(2&this.state||!(2&this.state)&&this.directionTest(ye))},emit:function(ye){this.pX=ye.deltaX,this.pY=ye.deltaY;var Me=Gt(ye.direction);Me&&(ye.additionalEvent=this.options.event+Me),this._super.emit.call(this,ye)}}),S(qr,pn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ir]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.scale-1)>this.options.threshold||2&this.state)},emit:function(ye){1!==ye.scale&&(ye.additionalEvent=this.options.event+(ye.scale<1?"in":"out")),this._super.emit.call(this,ye)}}),S(Ys,Ot,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(ye){var Me=this.options,He=ye.pointers.length===Me.pointers,bt=ye.distance<Me.threshold,Ut=ye.deltaTime>Me.time;if(this._input=ye,!bt||!He||12&ye.eventType&&!Ut)this.reset();else if(1&ye.eventType)this.reset(),this._timer=z(function(){this.state=8,this.tryEmit()},Me.time,this);else if(4&ye.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(ye){8===this.state&&(ye&&4&ye.eventType?this.manager.emit(this.options.event+"up",ye):(this._input.timeStamp=Q(),this.manager.emit(this.options.event,this._input)))}}),S(Il,pn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ir]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.rotation)>this.options.threshold||2&this.state)}}),S(lo,pn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ys.prototype.getTouchAction.call(this)},attrTest:function(ye){var He,Me=this.options.direction;return 30&Me?He=ye.overallVelocity:6&Me?He=ye.overallVelocityX:24&Me&&(He=ye.overallVelocityY),this._super.attrTest.call(this,ye)&&Me&ye.offsetDirection&&ye.distance>this.options.threshold&&ye.maxPointers==this.options.pointers&&P(He)>this.options.velocity&&4&ye.eventType},emit:function(ye){var Me=Gt(ye.offsetDirection);Me&&this.manager.emit(this.options.event+Me,ye),this.manager.emit(this.options.event,ye)}}),S(Fr,Ot,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[nr]},process:function(ye){var Me=this.options,He=ye.pointers.length===Me.pointers,bt=ye.distance<Me.threshold,Ut=ye.deltaTime<Me.time;if(this.reset(),1&ye.eventType&&0===this.count)return this.failTimeout();if(bt&&Ut&&He){if(4!=ye.eventType)return this.failTimeout();var Wt=!this.pTime||ye.timeStamp-this.pTime<Me.interval,ri=!this.pCenter||Wn(this.pCenter,ye.center)<Me.posThreshold;if(this.pTime=ye.timeStamp,this.pCenter=ye.center,ri&&Wt?this.count+=1:this.count=1,this._input=ye,0==this.count%Me.taps)return this.hasRequireFailures()?(this._timer=z(function(){this.state=8,this.tryEmit()},Me.interval,this),2):8}return 32},failTimeout:function(){return this._timer=z(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Fs.VERSION="2.0.7",Fs.defaults={domEvents:!1,touchAction:Hn,enable:!0,inputTarget:null,inputClass:null,preset:[[Il,{enable:!1}],[qr,{enable:!1},["rotate"]],[lo,{direction:6}],[ys,{direction:6},["swipe"]],[Fr],[Fr,{event:"doubletap",taps:2},["tap"]],[Ys]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},co.prototype={set:function(ye){return A(this.options,ye),ye.touchAction&&this.touchAction.update(),ye.inputTarget&&(this.input.destroy(),this.input.target=ye.inputTarget,this.input.init()),this},stop:function(ye){this.session.stopped=ye?2:1},recognize:function(ye){var Me=this.session;if(!Me.stopped){this.touchAction.preventDefaults(ye);var He,bt=this.recognizers,Ut=Me.curRecognizer;(!Ut||Ut&&8&Ut.state)&&(Ut=Me.curRecognizer=null);for(var Wt=0;Wt<bt.length;)He=bt[Wt],2===Me.stopped||Ut&&He!=Ut&&!He.canRecognizeWith(Ut)?He.reset():He.recognize(ye),!Ut&&14&He.state&&(Ut=Me.curRecognizer=He),Wt++}},get:function(ye){if(ye instanceof Ot)return ye;for(var Me=this.recognizers,He=0;He<Me.length;He++)if(Me[He].options.event==ye)return Me[He];return null},add:function(ye){if(v(ye,"add",this))return this;var Me=this.get(ye.options.event);return Me&&this.remove(Me),this.recognizers.push(ye),ye.manager=this,this.touchAction.update(),ye},remove:function(ye){if(v(ye,"remove",this))return this;if(ye=this.get(ye)){var Me=this.recognizers,He=E(Me,ye);-1!==He&&(Me.splice(He,1),this.touchAction.update())}return this},on:function(ye,Me){if(ye!==Y&&Me!==Y){var He=this.handlers;return x(X(ye),function(bt){He[bt]=He[bt]||[],He[bt].push(Me)}),this}},off:function(ye,Me){if(ye!==Y){var He=this.handlers;return x(X(ye),function(bt){Me?He[bt]&&He[bt].splice(E(He[bt],Me),1):delete He[bt]}),this}},emit:function(ye,Me){this.options.domEvents&&function(ye,Me){var He=At.createEvent("Event");He.initEvent(ye,!0,!0),He.gesture=Me,Me.target.dispatchEvent(He)}(ye,Me);var He=this.handlers[ye]&&this.handlers[ye].slice();if(He&&He.length){Me.type=ye,Me.preventDefault=function(){Me.srcEvent.preventDefault()};for(var bt=0;bt<He.length;)He[bt](Me),bt++}},destroy:function(){this.element&&Ol(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},A(Fs,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:co,Input:ve,TouchAction:Wr,TouchInput:ut,MouseInput:$r,PointerEventInput:Zt,TouchMouseInput:Dt,SingleTouchInput:ht,Recognizer:Ot,AttrRecognizer:pn,Tap:Fr,Pan:ys,Swipe:lo,Pinch:qr,Rotate:Il,Press:Ys,on:K,off:ce,each:x,merge:y,extend:b,assign:A,inherit:S,bindFn:T,prefixed:se}),(void 0!==ee?ee:"undefined"!=typeof self?self:{}).Hammer=Fs,(yt=function(){return Fs}.call(it,Je,it,Bt))!==Y&&(Bt.exports=yt)}(window,document)},815:function(Bt,it,Je){var yt;Bt=Je.nmd(Bt),function(){var ee,Se="Expected a function",W="__lodash_hash_undefined__",P="__lodash_placeholder__",V=32,K=128,te=1/0,xe=9007199254740991,_e=4294967295,st=[["ary",K],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",V],["partialRight",64],["rearg",256]],Xe="[object Arguments]",tt="[object Array]",Ue="[object Boolean]",Le="[object Date]",Te="[object Error]",Ve="[object Function]",$e="[object GeneratorFunction]",Ne="[object Map]",q="[object Number]",pe="[object Object]",ue="[object Promise]",_t="[object RegExp]",pt="[object Set]",ve="[object String]",k="[object Symbol]",B="[object WeakMap]",Qe="[object ArrayBuffer]",St="[object DataView]",Rt="[object Float32Array]",In="[object Float64Array]",Ln="[object Int8Array]",Wn="[object Int16Array]",wi="[object Int32Array]",gi="[object Uint8Array]",Gr="[object Uint8ClampedArray]",Ns="[object Uint16Array]",us="[object Uint32Array]",Ps=/\b__p \+= '';/g,$r=/\b(__p \+=) '' \+/g,Xa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Dl=/&(?:amp|lt|gt|quot|#39);/g,ga=/[&<>"']/g,_s=RegExp(Dl.source),Zt=RegExp(ga.source),Qa=/<%-([\s\S]+?)%>/g,rt=/<%([\s\S]+?)%>/g,lt=/<%=([\s\S]+?)%>/g,ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,me=/^\w*$/,be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/[\\^$.*+?()[\]{}|]/g,ut=RegExp(ke.source),Ze=/^\s+/,Ct=/\s/,Mt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Dt=/\{\n\/\* \[wrapped with (.+)\] \*/,Yt=/,? & /,Un=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ii=/[()=,{}\[\]\/\s]/,Rn=/\\(\\)?/g,fn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Hn=/\w*$/,En=/^[-+]0x[0-9a-f]+$/i,nr=/^0b[01]+$/i,ir=/^\[object .+?Constructor\]$/,Yn=/^0o[0-7]+$/i,Vi=/^(?:0|[1-9]\d*)$/,ma=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wr=/($^)/,ie=/['\n\r\u2028\u2029\\]/g,fe="\\ud800-\\udfff",J="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",Fe="a-z\\xdf-\\xf6\\xf8-\\xff",Tt="A-Z\\xc0-\\xd6\\xd8-\\xde",pn="\\ufe0e\\ufe0f",ys="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ys="["+fe+"]",Il="["+ys+"]",lo="["+J+"]",Fr="\\d+",Fs="["+we+"]",mc="["+Fe+"]",bn="[^"+fe+ys+Fr+we+Fe+Tt+"]",co="\\ud83c[\\udffb-\\udfff]",_a="[^"+fe+"]",dd="(?:\\ud83c[\\udde6-\\uddff]){2}",ye="[\\ud800-\\udbff][\\udc00-\\udfff]",Me="["+Tt+"]",bt="(?:"+mc+"|"+bn+")",Ut="(?:"+Me+"|"+bn+")",Wt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ri="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Lr="(?:"+lo+"|"+co+")?",Yr="["+pn+"]?",_C=Yr+Lr+"(?:\\u200d(?:"+[_a,dd,ye].join("|")+")"+Yr+Lr+")*",hd="(?:"+[Fs,dd,ye].join("|")+")"+_C,Qi="(?:"+[_a+lo+"?",lo,dd,ye,Ys].join("|")+")",ip=RegExp("['\u2019]","g"),Wm=RegExp(lo,"g"),xh=RegExp(co+"(?="+co+")|"+Qi+_C,"g"),Qb=RegExp([Me+"?"+mc+"+"+Wt+"(?="+[Il,Me,"$"].join("|")+")",Ut+"+"+ri+"(?="+[Il,Me+bt,"$"].join("|")+")",Me+"?"+bt+"+"+Wt,Me+"+"+ri,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fr,hd].join("|"),"g"),yC=RegExp("[\\u200d"+fe+J+pn+"]"),Rl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ch=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],bC=-1,Sn={};Sn[Rt]=Sn[In]=Sn[Ln]=Sn[Wn]=Sn[wi]=Sn[gi]=Sn[Gr]=Sn[Ns]=Sn[us]=!0,Sn[Xe]=Sn[tt]=Sn[Qe]=Sn[Ue]=Sn[St]=Sn[Le]=Sn[Te]=Sn[Ve]=Sn[Ne]=Sn[q]=Sn[pe]=Sn[_t]=Sn[pt]=Sn[ve]=Sn[B]=!1;var rr={};rr[Xe]=rr[tt]=rr[Qe]=rr[St]=rr[Ue]=rr[Le]=rr[Rt]=rr[In]=rr[Ln]=rr[Wn]=rr[wi]=rr[Ne]=rr[q]=rr[pe]=rr[_t]=rr[pt]=rr[ve]=rr[k]=rr[gi]=rr[Gr]=rr[Ns]=rr[us]=!0,rr[Te]=rr[Ve]=rr[B]=!1;var gn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},vC=parseFloat,tv=parseInt,jt="object"==typeof global&&global&&global.Object===Object&&global,Ls="object"==typeof self&&self&&self.Object===Object&&self,Li=jt||Ls||Function("return this")(),Nl=it&&!it.nodeType&&it,ya=Nl&&Bt&&!Bt.nodeType&&Bt,To=ya&&ya.exports===Nl,qm=To&&jt.process,vr=function(){try{return ya&&ya.require&&ya.require("util").types||qm&&qm.binding&&qm.binding("util")}catch(It){}}(),tn=vr&&vr.isArrayBuffer,ai=vr&&vr.isDate,cr=vr&&vr.isMap,uo=vr&&vr.isRegExp,_c=vr&&vr.isSet,es=vr&&vr.isTypedArray;function ts(at,It,Et){switch(Et.length){case 0:return at.call(It);case 1:return at.call(It,Et[0]);case 2:return at.call(It,Et[0],Et[1]);case 3:return at.call(It,Et[0],Et[1],Et[2])}return at.apply(It,Et)}function kr(at,It,Et,sn){for(var Tn=-1,Oi=null==at?0:at.length;++Tn<Oi;){var Kr=at[Tn];It(sn,Kr,Et(Kr),at)}return sn}function ks(at,It){for(var Et=-1,sn=null==at?0:at.length;++Et<sn&&!1!==It(at[Et],Et,at););return at}function fd(at,It){for(var Et=null==at?0:at.length;Et--&&!1!==It(at[Et],Et,at););return at}function Zn(at,It){for(var Et=-1,sn=null==at?0:at.length;++Et<sn;)if(!It(at[Et],Et,at))return!1;return!0}function ba(at,It){for(var Et=-1,sn=null==at?0:at.length,Tn=0,Oi=[];++Et<sn;){var Kr=at[Et];It(Kr,Et,at)&&(Oi[Tn++]=Kr)}return Oi}function Pl(at,It){return!(null==at||!at.length)&&Za(at,It,0)>-1}function Ah(at,It,Et){for(var sn=-1,Tn=null==at?0:at.length;++sn<Tn;)if(Et(It,at[sn]))return!0;return!1}function Hi(at,It){for(var Et=-1,sn=null==at?0:at.length,Tn=Array(sn);++Et<sn;)Tn[Et]=It(at[Et],Et,at);return Tn}function Br(at,It){for(var Et=-1,sn=It.length,Tn=at.length;++Et<sn;)at[Tn+Et]=It[Et];return at}function lu(at,It,Et,sn){var Tn=-1,Oi=null==at?0:at.length;for(sn&&Oi&&(Et=at[++Tn]);++Tn<Oi;)Et=It(Et,at[Tn],Tn,at);return Et}function pd(at,It,Et,sn){var Tn=null==at?0:at.length;for(sn&&Tn&&(Et=at[--Tn]);Tn--;)Et=It(Et,at[Tn],Tn,at);return Et}function Mo(at,It){for(var Et=-1,sn=null==at?0:at.length;++Et<sn;)if(It(at[Et],Et,at))return!0;return!1}var sr=Ym("length");function Th(at,It,Et){var sn;return Et(at,function(Tn,Oi,Kr){if(It(Tn,Oi,Kr))return sn=Oi,!1}),sn}function gd(at,It,Et,sn){for(var Tn=at.length,Oi=Et+(sn?1:-1);sn?Oi--:++Oi<Tn;)if(It(at[Oi],Oi,at))return Oi;return-1}function Za(at,It,Et){return It==It?function(at,It,Et){for(var sn=Et-1,Tn=at.length;++sn<Tn;)if(at[sn]===It)return sn;return-1}(at,It,Et):gd(at,yc,Et)}function rp(at,It,Et,sn){for(var Tn=Et-1,Oi=at.length;++Tn<Oi;)if(sn(at[Tn],It))return Tn;return-1}function yc(at){return at!=at}function vs(at,It){var Et=null==at?0:at.length;return Et?md(at,It)/Et:NaN}function Ym(at){return function(It){return null==It?ee:It[at]}}function Wo(at){return function(It){return null==at?ee:at[It]}}function qo(at,It,Et,sn,Tn){return Tn(at,function(Oi,Kr,Gi){Et=sn?(sn=!1,Oi):It(Et,Oi,Kr,Gi)}),Et}function md(at,It){for(var Et,sn=-1,Tn=at.length;++sn<Tn;){var Oi=It(at[sn]);Oi!==ee&&(Et=Et===ee?Oi:Et+Oi)}return Et}function _d(at,It){for(var Et=-1,sn=Array(at);++Et<at;)sn[Et]=It(Et);return sn}function nv(at){return at&&at.slice(0,bc(at)+1).replace(Ze,"")}function Yo(at){return function(It){return at(It)}}function Xm(at,It){return Hi(It,function(Et){return at[Et]})}function Mh(at,It){return at.has(It)}function SC(at,It){for(var Et=-1,sn=at.length;++Et<sn&&Za(It,at[Et],0)>-1;);return Et}function xC(at,It){for(var Et=at.length;Et--&&Za(It,at[Et],0)>-1;);return Et}function jF(at,It){for(var Et=at.length,sn=0;Et--;)at[Et]===It&&++sn;return sn}var VF=Wo({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),UF=Wo({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function zF(at){return"\\"+gn[at]}function Dh(at){return yC.test(at)}function iv(at){var It=-1,Et=Array(at.size);return at.forEach(function(sn,Tn){Et[++It]=[Tn,sn]}),Et}function CC(at,It){return function(Et){return at(It(Et))}}function cu(at,It){for(var Et=-1,sn=at.length,Tn=0,Oi=[];++Et<sn;){var Kr=at[Et];(Kr===It||Kr===P)&&(at[Et]=P,Oi[Tn++]=Et)}return Oi}function Qm(at){var It=-1,Et=Array(at.size);return at.forEach(function(sn){Et[++It]=sn}),Et}function Ih(at){return Dh(at)?function(at){for(var It=xh.lastIndex=0;xh.test(at);)++It;return It}(at):sr(at)}function Ja(at){return Dh(at)?function(at){return at.match(xh)||[]}(at):function(at){return at.split("")}(at)}function bc(at){for(var It=at.length;It--&&Ct.test(at.charAt(It)););return It}var Jm=Wo({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Oh=function at(It){var d,Et=(It=null==It?Li:Oh.defaults(Li.Object(),It,Oh.pick(Li,Ch))).Array,sn=It.Date,Tn=It.Error,Oi=It.Function,Kr=It.Math,Gi=It.Object,e_=It.RegExp,t_=It.String,wa=It.TypeError,ur=Et.prototype,uu=Gi.prototype,sp=It["__core-js_shared__"],wr=Oi.prototype.toString,$i=uu.hasOwnProperty,YF=0,Rh=(d=/[^.]+$/.exec(sp&&sp.keys&&sp.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",Ks=uu.toString,MC=wr.call(Gi),n_=Li._,yd=e_("^"+wr.call($i).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bs=To?It.Buffer:ee,Fl=It.Symbol,bd=It.Uint8Array,ov=Bs?Bs.allocUnsafe:ee,Ea=CC(Gi.getPrototypeOf,Gi),i_=Gi.create,op=uu.propertyIsEnumerable,Bn=ur.splice,DC=Fl?Fl.isConcatSpreadable:ee,Nh=Fl?Fl.iterator:ee,du=Fl?Fl.toStringTag:ee,ap=function(){try{var d=Dc(Gi,"defineProperty");return d({},"",{}),d}catch(f){}}(),av=It.clearTimeout!==Li.clearTimeout&&It.clearTimeout,IC=sn&&sn.now!==Li.Date.now&&sn.now,OC=It.setTimeout!==Li.setTimeout&&It.setTimeout,Lt=Kr.ceil,mi=Kr.floor,jr=Gi.getOwnPropertySymbols,ns=Bs?Bs.isBuffer:ee,r_=It.isFinite,Ph=ur.join,el=CC(Gi.keys,Gi),Vr=Kr.max,ds=Kr.min,KF=sn.now,RC=It.parseInt,Fh=Kr.random,lp=ur.reverse,ws=Dc(It,"DataView"),ho=Dc(It,"Map"),cp=Dc(It,"Promise"),Sa=Dc(It,"Set"),Do=Dc(It,"WeakMap"),Lh=Dc(Gi,"create"),kh=Do&&new Do,vd={},NC=Su(ws),s_=Su(ho),o_=Su(cp),lv=Su(Sa),a_=Su(Do),up=Fl?Fl.prototype:ee,wd=up?up.valueOf:ee,Bh=up?up.toString:ee;function Ee(d){if(xr(d)&&!On(d)&&!(d instanceof li)){if(d instanceof Io)return d;if($i.call(d,"__wrapped__"))return Pp(d)}return new Io(d)}var hu=function(){function d(){}return function(f){if(!Sr(f))return{};if(i_)return i_(f);d.prototype=f;var _=new d;return d.prototype=ee,_}}();function jh(){}function Io(d,f){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=ee}function li(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function fo(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function Ll(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function tl(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function xa(d){var f=-1,_=null==d?0:d.length;for(this.__data__=new tl;++f<_;)this.add(d[f])}function Ca(d){var f=this.__data__=new Ll(d);this.size=f.size}function Uh(d,f){var _=On(d),F=!_&&ul(d),ae=!_&&!F&&dl(d),Ae=!_&&!F&&!ae&&nf(d),ze=_||F||ae||Ae,qe=ze?_d(d.length,t_):[],ct=qe.length;for(var Nt in d)(f||$i.call(d,Nt))&&(!ze||!("length"==Nt||ae&&("offset"==Nt||"parent"==Nt)||Ae&&("buffer"==Nt||"byteLength"==Nt||"byteOffset"==Nt)||No(Nt,ct)))&&qe.push(Nt);return qe}function d_(d){var f=d.length;return f?d[kl(0,f-1)]:ee}function uv(d,f){return Ld(Qs(d),fu(f,0,d.length))}function Ed(d){return Ld(Qs(d))}function h_(d,f,_){(_!==ee&&!Mn(d[f],_)||_===ee&&!(f in d))&&il(d,f,_)}function nl(d,f,_){var F=d[f];(!$i.call(d,f)||!Mn(F,_)||_===ee&&!(f in d))&&il(d,f,_)}function Sd(d,f){for(var _=d.length;_--;)if(Mn(d[_][0],f))return _;return-1}function gp(d,f,_,F){return Ec(d,function(ae,Ae,ze){f(F,ae,_(ae),ze)}),F}function $C(d,f){return d&&Ma(f,As(f),d)}function il(d,f,_){"__proto__"==f&&ap?ap(d,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):d[f]=_}function f_(d,f){for(var _=-1,F=f.length,ae=Et(F),Ae=null==d;++_<F;)ae[_]=Ae?ee:of(d,f[_]);return ae}function fu(d,f,_){return d==d&&(_!==ee&&(d=d<=_?d:_),f!==ee&&(d=d>=f?d:f)),d}function js(d,f,_,F,ae,Ae){var ze,qe=1&f,ct=2&f,Nt=4&f;if(_&&(ze=ae?_(d,F,ae,Ae):_(d)),ze!==ee)return ze;if(!Sr(d))return d;var Pt=On(d);if(Pt){if(ze=function(d){var f=d.length,_=new d.constructor(f);return f&&"string"==typeof d[0]&&$i.call(d,"index")&&(_.index=d.index,_.input=d.input),_}(d),!qe)return Qs(d,ze)}else{var Vt=Us(d),Jt=Vt==Ve||Vt==$e;if(dl(d))return Sp(d,qe);if(Vt==pe||Vt==Xe||Jt&&!ae){if(ze=ct||Jt?{}:Nv(d),!qe)return ct?function(d,f){return Ma(d,Iv(d),f)}(d,function(d,f){return d&&Ma(f,Js(f),d)}(ze,d)):function(d,f){return Ma(d,D_(d),f)}(d,$C(ze,d))}else{if(!rr[Vt])return ae?d:{};ze=function(d,f,_){var F=d.constructor;switch(f){case Qe:return bu(d);case Ue:case Le:return new F(+d);case St:return function(d,f){var _=f?bu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.byteLength)}(d,_);case Rt:case In:case Ln:case Wn:case wi:case gi:case Gr:case Ns:case us:return x_(d,_);case Ne:return new F;case q:case ve:return new F(d);case _t:return function(d){var f=new d.constructor(d.source,Hn.exec(d));return f.lastIndex=d.lastIndex,f}(d);case pt:return new F;case k:return function(d){return wd?Gi(wd.call(d)):{}}(d)}}(d,Vt,qe)}}Ae||(Ae=new Ca);var _n=Ae.get(d);if(_n)return _n;Ae.set(d,ze),dT(d)?d.forEach(function(jn){ze.add(js(jn,f,_,jn,d,Ae))}):aT(d)&&d.forEach(function(jn,di){ze.set(di,js(jn,f,_,di,d,Ae))});var ui=Pt?ee:(Nt?ct?T_:Ul:ct?Js:As)(d);return ks(ui||d,function(jn,di){ui&&(jn=d[di=jn]),nl(ze,di,js(jn,f,_,di,d,Ae))}),ze}function mp(d,f,_){var F=_.length;if(null==d)return!F;for(d=Gi(d);F--;){var ae=_[F],ze=d[ae];if(ze===ee&&!(ae in d)||!(0,f[ae])(ze))return!1}return!0}function zh(d,f,_){if("function"!=typeof d)throw new wa(Se);return Kh(function(){d.apply(ee,_)},f)}function wc(d,f,_,F){var ae=-1,Ae=Pl,ze=!0,qe=d.length,ct=[],Nt=f.length;if(!qe)return ct;_&&(f=Hi(f,Yo(_))),F?(Ae=Ah,ze=!1):f.length>=200&&(Ae=Mh,ze=!1,f=new xa(f));e:for(;++ae<qe;){var Pt=d[ae],Vt=null==_?Pt:_(Pt);if(Pt=F||0!==Pt?Pt:0,ze&&Vt==Vt){for(var Jt=Nt;Jt--;)if(f[Jt]===Vt)continue e;ct.push(Pt)}else Ae(f,Vt,F)||ct.push(Pt)}return ct}Ee.templateSettings={escape:Qa,evaluate:rt,interpolate:lt,variable:"",imports:{_:Ee}},(Ee.prototype=jh.prototype).constructor=Ee,(Io.prototype=hu(jh.prototype)).constructor=Io,(li.prototype=hu(jh.prototype)).constructor=li,fo.prototype.clear=function(){this.__data__=Lh?Lh(null):{},this.size=0},fo.prototype.delete=function(d){var f=this.has(d)&&delete this.__data__[d];return this.size-=f?1:0,f},fo.prototype.get=function(d){var f=this.__data__;if(Lh){var _=f[d];return _===W?ee:_}return $i.call(f,d)?f[d]:ee},fo.prototype.has=function(d){var f=this.__data__;return Lh?f[d]!==ee:$i.call(f,d)},fo.prototype.set=function(d,f){var _=this.__data__;return this.size+=this.has(d)?0:1,_[d]=Lh&&f===ee?W:f,this},Ll.prototype.clear=function(){this.__data__=[],this.size=0},Ll.prototype.delete=function(d){var f=this.__data__,_=Sd(f,d);return!(_<0||(_==f.length-1?f.pop():Bn.call(f,_,1),--this.size,0))},Ll.prototype.get=function(d){var f=this.__data__,_=Sd(f,d);return _<0?ee:f[_][1]},Ll.prototype.has=function(d){return Sd(this.__data__,d)>-1},Ll.prototype.set=function(d,f){var _=this.__data__,F=Sd(_,d);return F<0?(++this.size,_.push([d,f])):_[F][1]=f,this},tl.prototype.clear=function(){this.size=0,this.__data__={hash:new fo,map:new(ho||Ll),string:new fo}},tl.prototype.delete=function(d){var f=Vs(this,d).delete(d);return this.size-=f?1:0,f},tl.prototype.get=function(d){return Vs(this,d).get(d)},tl.prototype.has=function(d){return Vs(this,d).has(d)},tl.prototype.set=function(d,f){var _=Vs(this,d),F=_.size;return _.set(d,f),this.size+=_.size==F?0:1,this},xa.prototype.add=xa.prototype.push=function(d){return this.__data__.set(d,W),this},xa.prototype.has=function(d){return this.__data__.has(d)},Ca.prototype.clear=function(){this.__data__=new Ll,this.size=0},Ca.prototype.delete=function(d){var f=this.__data__,_=f.delete(d);return this.size=f.size,_},Ca.prototype.get=function(d){return this.__data__.get(d)},Ca.prototype.has=function(d){return this.__data__.has(d)},Ca.prototype.set=function(d,f){var _=this.__data__;if(_ instanceof Ll){var F=_.__data__;if(!ho||F.length<199)return F.push([d,f]),this.size=++_.size,this;_=this.__data__=new tl(F)}return _.set(d,f),this.size=_.size,this};var Ec=ol(rl),g_=ol(_p,!0);function hv(d,f){var _=!0;return Ec(d,function(F,ae,Ae){return _=!!f(F,ae,Ae)}),_}function Hh(d,f,_){for(var F=-1,ae=d.length;++F<ae;){var Ae=d[F],ze=f(Ae);if(null!=ze&&(qe===ee?ze==ze&&!ra(ze):_(ze,qe)))var qe=ze,ct=Ae}return ct}function pv(d,f){var _=[];return Ec(d,function(F,ae,Ae){f(F,ae,Ae)&&_.push(F)}),_}function Es(d,f,_,F,ae){var Ae=-1,ze=d.length;for(_||(_=cA),ae||(ae=[]);++Ae<ze;){var qe=d[Ae];f>0&&_(qe)?f>1?Es(qe,f-1,_,F,ae):Br(ae,qe):F||(ae[ae.length]=qe)}return ae}var xd=wv(),Cd=wv(!0);function rl(d,f){return d&&xd(d,f,As)}function _p(d,f){return d&&Cd(d,f,As)}function Gh(d,f){return ba(f,function(_){return ia(d[_])})}function Ko(d,f){for(var _=0,F=(f=Ac(f,d)).length;null!=d&&_<F;)d=d[Jn(f[_++])];return _&&_==F?d:ee}function or(d,f,_){var F=f(d);return On(d)?F:Br(F,_(d))}function Ss(d){return null==d?d===ee?"[object Undefined]":"[object Null]":du&&du in Gi(d)?function(d){var f=$i.call(d,du),_=d[du];try{d[du]=ee;var F=!0}catch(Ae){}var ae=Ks.call(d);return F&&(f?d[du]=_:delete d[du]),ae}(d):function(d){return Ks.call(d)}(d)}function Aa(d,f){return d>f}function Ad(d,f){return null!=d&&$i.call(d,f)}function Td(d,f){return null!=d&&f in Gi(d)}function pu(d,f,_){for(var F=_?Ah:Pl,ae=d[0].length,Ae=d.length,ze=Ae,qe=Et(Ae),ct=1/0,Nt=[];ze--;){var Pt=d[ze];ze&&f&&(Pt=Hi(Pt,Yo(f))),ct=ds(Pt.length,ct),qe[ze]=!_&&(f||ae>=120&&Pt.length>=120)?new xa(ze&&Pt):ee}Pt=d[0];var Vt=-1,Jt=qe[0];e:for(;++Vt<ae&&Nt.length<ct;){var _n=Pt[Vt],kn=f?f(_n):_n;if(_n=_||0!==_n?_n:0,!(Jt?Mh(Jt,kn):F(Nt,kn,_))){for(ze=Ae;--ze;){var ui=qe[ze];if(!(ui?Mh(ui,kn):F(d[ze],kn,_)))continue e}Jt&&Jt.push(kn),Nt.push(_n)}}return Nt}function Ta(d,f,_){var F=null==(d=N_(d,f=Ac(f,d)))?d:d[Jn(ea(f))];return null==F?ee:ts(F,d,_)}function WC(d){return xr(d)&&Ss(d)==Xe}function yp(d,f,_,F,ae){return d===f||(null==d||null==f||!xr(d)&&!xr(f)?d!=d&&f!=f:function(d,f,_,F,ae,Ae){var ze=On(d),qe=On(f),ct=ze?tt:Us(d),Nt=qe?tt:Us(f),Pt=(ct=ct==Xe?pe:ct)==pe,Vt=(Nt=Nt==Xe?pe:Nt)==pe,Jt=ct==Nt;if(Jt&&dl(d)){if(!dl(f))return!1;ze=!0,Pt=!1}if(Jt&&!Pt)return Ae||(Ae=new Ca),ze||nf(d)?Dp(d,f,_,F,ae,Ae):function(d,f,_,F,ae,Ae,ze){switch(_){case St:if(d.byteLength!=f.byteLength||d.byteOffset!=f.byteOffset)return!1;d=d.buffer,f=f.buffer;case Qe:return!(d.byteLength!=f.byteLength||!Ae(new bd(d),new bd(f)));case Ue:case Le:case q:return Mn(+d,+f);case Te:return d.name==f.name&&d.message==f.message;case _t:case ve:return d==f+"";case Ne:var qe=iv;case pt:if(qe||(qe=Qm),d.size!=f.size&&!(1&F))return!1;var Nt=ze.get(d);if(Nt)return Nt==f;F|=2,ze.set(d,f);var Pt=Dp(qe(d),qe(f),F,ae,Ae,ze);return ze.delete(d),Pt;case k:if(wd)return wd.call(d)==wd.call(f)}return!1}(d,f,ct,_,F,ae,Ae);if(!(1&_)){var _n=Pt&&$i.call(d,"__wrapped__"),kn=Vt&&$i.call(f,"__wrapped__");if(_n||kn){var ui=_n?d.value():d,jn=kn?f.value():f;return Ae||(Ae=new Ca),ae(ui,jn,_,F,Ae)}}return!!Jt&&(Ae||(Ae=new Ca),function(d,f,_,F,ae,Ae){var ze=1&_,qe=Ul(d),ct=qe.length;if(ct!=Ul(f).length&&!ze)return!1;for(var Vt=ct;Vt--;){var Jt=qe[Vt];if(!(ze?Jt in f:$i.call(f,Jt)))return!1}var _n=Ae.get(d),kn=Ae.get(f);if(_n&&kn)return _n==f&&kn==d;var ui=!0;Ae.set(d,f),Ae.set(f,d);for(var jn=ze;++Vt<ct;){var di=d[Jt=qe[Vt]],Ei=f[Jt];if(F)var mo=ze?F(Ei,di,Jt,f,d,Ae):F(di,Ei,Jt,d,f,Ae);if(!(mo===ee?di===Ei||ae(di,Ei,_,F,Ae):mo)){ui=!1;break}jn||(jn="constructor"==Jt)}if(ui&&!jn){var Hs=d.constructor,sa=f.constructor;Hs!=sa&&"constructor"in d&&"constructor"in f&&!("function"==typeof Hs&&Hs instanceof Hs&&"function"==typeof sa&&sa instanceof sa)&&(ui=!1)}return Ae.delete(d),Ae.delete(f),ui}(d,f,_,F,ae,Ae))}(d,f,_,F,yp,ae))}function __(d,f,_,F){var ae=_.length,Ae=ae,ze=!F;if(null==d)return!Ae;for(d=Gi(d);ae--;){var qe=_[ae];if(ze&&qe[2]?qe[1]!==d[qe[0]]:!(qe[0]in d))return!1}for(;++ae<Ae;){var ct=(qe=_[ae])[0],Nt=d[ct],Pt=qe[1];if(ze&&qe[2]){if(Nt===ee&&!(ct in d))return!1}else{var Vt=new Ca;if(F)var Jt=F(Nt,Pt,ct,d,f,Vt);if(!(Jt===ee?yp(Pt,Nt,3,F,Vt):Jt))return!1}}return!0}function y_(d){return!(!Sr(d)||function(d){return!!Rh&&Rh in d}(d))&&(ia(d)?yd:ir).test(Su(d))}function KC(d){return"function"==typeof d?d:null==d?eo:"object"==typeof d?On(d)?Dd(d[0],d[1]):QC(d):Au(d)}function gv(d){if(!Rp(d))return el(d);var f=[];for(var _ in Gi(d))$i.call(d,_)&&"constructor"!=_&&f.push(_);return f}function mv(d,f){return d<f}function XC(d,f){var _=-1,F=po(d)?Et(d.length):[];return Ec(d,function(ae,Ae,ze){F[++_]=f(ae,Ae,ze)}),F}function QC(d){var f=Zo(d);return 1==f.length&&f[0][2]?dA(f[0][0],f[0][1]):function(_){return _===d||__(_,d,f)}}function Dd(d,f){return Jo(d)&&uA(f)?dA(Jn(d),f):function(_){var F=of(_,d);return F===ee&&F===f?$p(_,d):yp(f,F,3)}}function b_(d,f,_,F,ae){d!==f&&xd(f,function(Ae,ze){if(ae||(ae=new Ca),Sr(Ae))!function(d,f,_,F,ae,Ae,ze){var qe=P_(d,_),ct=P_(f,_),Nt=ze.get(ct);if(Nt)h_(d,_,Nt);else{var Pt=Ae?Ae(qe,ct,_+"",d,f,ze):ee,Vt=Pt===ee;if(Vt){var Jt=On(ct),_n=!Jt&&dl(ct),kn=!Jt&&!_n&&nf(ct);Pt=ct,Jt||_n||kn?On(qe)?Pt=qe:Er(qe)?Pt=Qs(qe):_n?(Vt=!1,Pt=Sp(ct,!0)):kn?(Vt=!1,Pt=x_(ct,!0)):Pt=[]:Gp(ct)||ul(ct)?(Pt=qe,ul(qe)?Pt=Cw(qe):(!Sr(qe)||ia(qe))&&(Pt=Nv(ct))):Vt=!1}Vt&&(ze.set(ct,Pt),ae(Pt,ct,F,Ae,ze),ze.delete(ct)),h_(d,_,Pt)}}(d,f,ze,_,b_,F,ae);else{var qe=F?F(P_(d,ze),Ae,ze+"",d,f,ae):ee;qe===ee&&(qe=Ae),h_(d,ze,qe)}},Js)}function gu(d,f){var _=d.length;if(_)return No(f+=f<0?_:0,_)?d[f]:ee}function $h(d,f,_){f=f.length?Hi(f,function(Ae){return On(Ae)?function(ze){return Ko(ze,1===Ae.length?Ae[0]:Ae)}:Ae}):[eo];var F=-1;return f=Hi(f,Yo(Pn())),function(at,It){var Et=at.length;for(at.sort(function(Ae,ze){return function(d,f,_){for(var F=-1,ae=d.criteria,Ae=f.criteria,ze=ae.length,qe=_.length;++F<ze;){var ct=Tc(ae[F],Ae[F]);if(ct)return F>=qe?ct:ct*("desc"==_[F]?-1:1)}return d.index-f.index}(Ae,ze,_)});Et--;)at[Et]=at[Et].value;return at}(XC(d,function(Ae,ze,qe){return{criteria:Hi(f,function(Nt){return Nt(Ae)}),index:++F,value:Ae}}))}function _v(d,f,_){for(var F=-1,ae=f.length,Ae={};++F<ae;){var ze=f[F],qe=Ko(d,ze);_(qe,ze)&&vp(Ae,Ac(ze,d),qe)}return Ae}function Qo(d,f,_,F){var ae=F?rp:Za,Ae=-1,ze=f.length,qe=d;for(d===f&&(f=Qs(f)),_&&(qe=Hi(d,Yo(_)));++Ae<ze;)for(var ct=0,Nt=f[Ae],Pt=_?_(Nt):Nt;(ct=ae(qe,Pt,ct,F))>-1;)qe!==d&&Bn.call(qe,ct,1),Bn.call(d,ct,1);return d}function Wh(d,f){for(var _=d?f.length:0,F=_-1;_--;){var ae=f[_];if(_==F||ae!==Ae){var Ae=ae;No(ae)?Bn.call(d,ae,1):mu(d,ae)}}return d}function kl(d,f){return d+mi(Fh()*(f-d+1))}function bp(d,f){var _="";if(!d||f<1||f>xe)return _;do{f%2&&(_+=d),(f=mi(f/2))&&(d+=d)}while(f);return _}function ci(d,f){return Np(hA(d,f,eo),d+"")}function ZC(d){return d_($d(d))}function s2(d,f){var _=$d(d);return Ld(_,fu(f,0,_.length))}function vp(d,f,_,F){if(!Sr(d))return d;for(var ae=-1,Ae=(f=Ac(f,d)).length,ze=Ae-1,qe=d;null!=qe&&++ae<Ae;){var ct=Jn(f[ae]),Nt=_;if("__proto__"===ct||"constructor"===ct||"prototype"===ct)return d;if(ae!=ze){var Pt=qe[ct];(Nt=F?F(Pt,ct,qe):ee)===ee&&(Nt=Sr(Pt)?Pt:No(f[ae+1])?[]:{})}nl(qe,ct,Nt),qe=qe[ct]}return d}var v_=kh?function(d,f){return kh.set(d,f),d}:eo,Oo=ap?function(d,f){return ap(d,"toString",{configurable:!0,enumerable:!1,value:wy(f),writable:!0})}:eo;function w_(d){return Ld($d(d))}function xs(d,f,_){var F=-1,ae=d.length;f<0&&(f=-f>ae?0:ae+f),(_=_>ae?ae:_)<0&&(_+=ae),ae=f>_?0:_-f>>>0,f>>>=0;for(var Ae=Et(ae);++F<ae;)Ae[F]=d[F+f];return Ae}function o2(d,f){var _;return Ec(d,function(F,ae,Ae){return!(_=f(F,ae,Ae))}),!!_}function qh(d,f,_){var F=0,ae=null==d?F:d.length;if("number"==typeof f&&f==f&&ae<=2147483647){for(;F<ae;){var Ae=F+ae>>>1,ze=d[Ae];null!==ze&&!ra(ze)&&(_?ze<=f:ze<f)?F=Ae+1:ae=Ae}return ae}return E_(d,f,eo,_)}function E_(d,f,_,F){var ae=0,Ae=null==d?0:d.length;if(0===Ae)return 0;for(var ze=(f=_(f))!=f,qe=null===f,ct=ra(f),Nt=f===ee;ae<Ae;){var Pt=mi((ae+Ae)/2),Vt=_(d[Pt]),Jt=Vt!==ee,_n=null===Vt,kn=Vt==Vt,ui=ra(Vt);if(ze)var jn=F||kn;else jn=Nt?kn&&(F||Jt):qe?kn&&Jt&&(F||!_n):ct?kn&&Jt&&!_n&&(F||!ui):!_n&&!ui&&(F?Vt<=f:Vt<f);jn?ae=Pt+1:Ae=Pt}return ds(Ae,4294967294)}function yv(d,f){for(var _=-1,F=d.length,ae=0,Ae=[];++_<F;){var ze=d[_],qe=f?f(ze):ze;if(!_||!Mn(qe,ct)){var ct=qe;Ae[ae++]=0===ze?0:ze}}return Ae}function bv(d){return"number"==typeof d?d:ra(d)?NaN:+d}function Ro(d){if("string"==typeof d)return d;if(On(d))return Hi(d,Ro)+"";if(ra(d))return Bh?Bh.call(d):"";var f=d+"";return"0"==f&&1/d==-te?"-0":f}function xc(d,f,_){var F=-1,ae=Pl,Ae=d.length,ze=!0,qe=[],ct=qe;if(_)ze=!1,ae=Ah;else if(Ae>=200){var Nt=f?null:A_(d);if(Nt)return Qm(Nt);ze=!1,ae=Mh,ct=new xa}else ct=f?[]:qe;e:for(;++F<Ae;){var Pt=d[F],Vt=f?f(Pt):Pt;if(Pt=_||0!==Pt?Pt:0,ze&&Vt==Vt){for(var Jt=ct.length;Jt--;)if(ct[Jt]===Vt)continue e;f&&ct.push(Vt),qe.push(Pt)}else ae(ct,Vt,_)||(ct!==qe&&ct.push(Vt),qe.push(Pt))}return qe}function mu(d,f){return null==(d=N_(d,f=Ac(f,d)))||delete d[Jn(ea(f))]}function wp(d,f,_,F){return vp(d,f,_(Ko(d,f)),F)}function _u(d,f,_,F){for(var ae=d.length,Ae=F?ae:-1;(F?Ae--:++Ae<ae)&&f(d[Ae],Ae,d););return _?xs(d,F?0:Ae,F?Ae+1:ae):xs(d,F?Ae+1:0,F?ae:Ae)}function JC(d,f){var _=d;return _ instanceof li&&(_=_.value()),lu(f,function(F,ae){return ae.func.apply(ae.thisArg,Br([F],ae.args))},_)}function yu(d,f,_){var F=d.length;if(F<2)return F?xc(d[0]):[];for(var ae=-1,Ae=Et(F);++ae<F;)for(var ze=d[ae],qe=-1;++qe<F;)qe!=ae&&(Ae[ae]=wc(Ae[ae]||ze,d[qe],f,_));return xc(Es(Ae,1),f,_)}function Ep(d,f,_){for(var F=-1,ae=d.length,Ae=f.length,ze={};++F<ae;)_(ze,d[F],F<Ae?f[F]:ee);return ze}function Cc(d){return Er(d)?d:[]}function S_(d){return"function"==typeof d?d:eo}function Ac(d,f){return On(d)?d:Jo(d,f)?[d]:kv(ki(d))}var eA=ci;function sl(d,f,_){var F=d.length;return _=_===ee?F:_,!f&&_>=F?d:xs(d,f,_)}var tA=av||function(d){return Li.clearTimeout(d)};function Sp(d,f){if(f)return d.slice();var _=d.length,F=ov?ov(_):new d.constructor(_);return d.copy(F),F}function bu(d){var f=new d.constructor(d.byteLength);return new bd(f).set(new bd(d)),f}function x_(d,f){var _=f?bu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.length)}function Tc(d,f){if(d!==f){var _=d!==ee,F=null===d,ae=d==d,Ae=ra(d),ze=f!==ee,qe=null===f,ct=f==f,Nt=ra(f);if(!qe&&!Nt&&!Ae&&d>f||Ae&&ze&&ct&&!qe&&!Nt||F&&ze&&ct||!_&&ct||!ae)return 1;if(!F&&!Ae&&!Nt&&d<f||Nt&&_&&ae&&!F&&!Ae||qe&&_&&ae||!ze&&ae||!ct)return-1}return 0}function Od(d,f,_,F){for(var ae=-1,Ae=d.length,ze=_.length,qe=-1,ct=f.length,Nt=Vr(Ae-ze,0),Pt=Et(ct+Nt),Vt=!F;++qe<ct;)Pt[qe]=f[qe];for(;++ae<ze;)(Vt||ae<Ae)&&(Pt[_[ae]]=d[ae]);for(;Nt--;)Pt[qe++]=d[ae++];return Pt}function vv(d,f,_,F){for(var ae=-1,Ae=d.length,ze=-1,qe=_.length,ct=-1,Nt=f.length,Pt=Vr(Ae-qe,0),Vt=Et(Pt+Nt),Jt=!F;++ae<Pt;)Vt[ae]=d[ae];for(var _n=ae;++ct<Nt;)Vt[_n+ct]=f[ct];for(;++ze<qe;)(Jt||ae<Ae)&&(Vt[_n+_[ze]]=d[ae++]);return Vt}function Qs(d,f){var _=-1,F=d.length;for(f||(f=Et(F));++_<F;)f[_]=d[_];return f}function Ma(d,f,_,F){var ae=!_;_||(_={});for(var Ae=-1,ze=f.length;++Ae<ze;){var qe=f[Ae],ct=F?F(_[qe],d[qe],qe,_,d):ee;ct===ee&&(ct=d[qe]),ae?il(_,qe,ct):nl(_,qe,ct)}return _}function Xr(d,f){return function(_,F){var ae=On(_)?kr:gp,Ae=f?f():{};return ae(_,d,Pn(F,2),Ae)}}function Bl(d){return ci(function(f,_){var F=-1,ae=_.length,Ae=ae>1?_[ae-1]:ee,ze=ae>2?_[2]:ee;for(Ae=d.length>3&&"function"==typeof Ae?(ae--,Ae):ee,ze&&zs(_[0],_[1],ze)&&(Ae=ae<3?ee:Ae,ae=1),f=Gi(f);++F<ae;){var qe=_[F];qe&&d(f,qe,F,Ae)}return f})}function ol(d,f){return function(_,F){if(null==_)return _;if(!po(_))return d(_,F);for(var ae=_.length,Ae=f?ae:-1,ze=Gi(_);(f?Ae--:++Ae<ae)&&!1!==F(ze[Ae],Ae,ze););return _}}function wv(d){return function(f,_,F){for(var ae=-1,Ae=Gi(f),ze=F(f),qe=ze.length;qe--;){var ct=ze[d?qe:++ae];if(!1===_(Ae[ct],ct,Ae))break}return f}}function xp(d){return function(f){var _=Dh(f=ki(f))?Ja(f):ee,F=_?_[0]:f.charAt(0),ae=_?sl(_,1).join(""):f.slice(1);return F[d]()+ae}}function jl(d){return function(f){return lu(by(hy(f).replace(ip,"")),d,"")}}function Nd(d){return function(){var f=arguments;switch(f.length){case 0:return new d;case 1:return new d(f[0]);case 2:return new d(f[0],f[1]);case 3:return new d(f[0],f[1],f[2]);case 4:return new d(f[0],f[1],f[2],f[3]);case 5:return new d(f[0],f[1],f[2],f[3],f[4]);case 6:return new d(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new d(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=hu(d.prototype),F=d.apply(_,f);return Sr(F)?F:_}}function Sv(d){return function(f,_,F){var ae=Gi(f);if(!po(f)){var Ae=Pn(_,3);f=As(f),_=function(qe){return Ae(ae[qe],qe,ae)}}var ze=d(f,_,F);return ze>-1?ae[Ae?f[ze]:ze]:ee}}function wu(d){return al(function(f){var _=f.length,F=_,ae=Io.prototype.thru;for(d&&f.reverse();F--;){var Ae=f[F];if("function"!=typeof Ae)throw new wa(Se);if(ae&&!ze&&"wrapper"==Ip(Ae))var ze=new Io([],!0)}for(F=ze?F:_;++F<_;){var qe=Ip(Ae=f[F]),ct="wrapper"==qe?M_(Ae):ee;ze=ct&&Op(ct[0])&&424==ct[1]&&!ct[4].length&&1==ct[9]?ze[Ip(ct[0])].apply(ze,ct[3]):1==Ae.length&&Op(Ae)?ze[qe]():ze.thru(Ae)}return function(){var Nt=arguments,Pt=Nt[0];if(ze&&1==Nt.length&&On(Pt))return ze.plant(Pt).value();for(var Vt=0,Jt=_?f[Vt].apply(this,Nt):Pt;++Vt<_;)Jt=f[Vt].call(this,Jt);return Jt}})}function Mc(d,f,_,F,ae,Ae,ze,qe,ct,Nt){var Pt=f&K,Vt=1&f,Jt=2&f,_n=24&f,kn=512&f,ui=Jt?ee:Nd(d);return function jn(){for(var di=arguments.length,Ei=Et(di),mo=di;mo--;)Ei[mo]=arguments[mo];if(_n)var Hs=Fd(jn),sa=jF(Ei,Hs);if(F&&(Ei=Od(Ei,F,ae,_n)),Ae&&(Ei=vv(Ei,Ae,ze,_n)),di-=sa,_n&&di<Nt){var Bi=cu(Ei,Hs);return Av(d,f,Mc,jn.placeholder,_,Ei,Bi,qe,ct,Nt-di)}var pl=Vt?_:this,Nc=Jt?pl[d]:d;return di=Ei.length,qe?Ei=fA(Ei,qe):kn&&di>1&&Ei.reverse(),Pt&&ct<di&&(Ei.length=ct),this&&this!==Li&&this instanceof jn&&(Nc=ui||Nd(Nc)),Nc.apply(pl,Ei)}}function xv(d,f){return function(_,F){return function(d,f,_,F){return rl(d,function(ae,Ae,ze){f(F,_(ae),Ae,ze)}),F}(_,d,f(F),{})}}function C_(d,f){return function(_,F){var ae;if(_===ee&&F===ee)return f;if(_!==ee&&(ae=_),F!==ee){if(ae===ee)return F;"string"==typeof _||"string"==typeof F?(_=Ro(_),F=Ro(F)):(_=bv(_),F=bv(F)),ae=d(_,F)}return ae}}function Cp(d){return al(function(f){return f=Hi(f,Yo(Pn())),ci(function(_){var F=this;return d(f,function(ae){return ts(ae,F,_)})})})}function Ap(d,f){var _=(f=f===ee?" ":Ro(f)).length;if(_<2)return _?bp(f,d):f;var F=bp(f,Lt(d/Ih(f)));return Dh(f)?sl(Ja(F),0,d).join(""):F.slice(0,d)}function Cv(d){return function(f,_,F){return F&&"number"!=typeof F&&zs(f,_,F)&&(_=F=ee),f=hl(f),_===ee?(_=f,f=0):_=hl(_),function(d,f,_,F){for(var ae=-1,Ae=Vr(Lt((f-d)/(_||1)),0),ze=Et(Ae);Ae--;)ze[F?Ae:++ae]=d,d+=_;return ze}(f,_,F=F===ee?f<_?1:-1:hl(F),d)}}function Tp(d){return function(f,_){return"string"==typeof f&&"string"==typeof _||(f=go(f),_=go(_)),d(f,_)}}function Av(d,f,_,F,ae,Ae,ze,qe,ct,Nt){var Pt=8&f;f|=Pt?V:64,4&(f&=~(Pt?64:V))||(f&=-4);var ui=[d,f,ae,Pt?Ae:ee,Pt?ze:ee,Pt?ee:Ae,Pt?ee:ze,qe,ct,Nt],jn=_.apply(ee,ui);return Op(d)&&Lv(jn,ui),jn.placeholder=F,Xh(jn,d,f)}function Pd(d){var f=Kr[d];return function(_,F){if(_=go(_),(F=null==F?0:ds(Xn(F),292))&&r_(_)){var ae=(ki(_)+"e").split("e");return+((ae=(ki(f(ae[0]+"e"+(+ae[1]+F)))+"e").split("e"))[0]+"e"+(+ae[1]-F))}return f(_)}}var A_=Sa&&1/Qm(new Sa([,-0]))[1]==te?function(d){return new Sa(d)}:xy;function Eu(d){return function(f){var _=Us(f);return _==Ne?iv(f):_==pt?function(at){var It=-1,Et=Array(at.size);return at.forEach(function(sn){Et[++It]=[sn,sn]}),Et}(f):function(at,It){return Hi(It,function(Et){return[Et,at[Et]]})}(f,d(f))}}function Vl(d,f,_,F,ae,Ae,ze,qe){var ct=2&f;if(!ct&&"function"!=typeof d)throw new wa(Se);var Nt=F?F.length:0;if(Nt||(f&=-97,F=ae=ee),ze=ze===ee?ze:Vr(Xn(ze),0),qe=qe===ee?qe:Xn(qe),Nt-=ae?ae.length:0,64&f){var Pt=F,Vt=ae;F=ae=ee}var Jt=ct?ee:M_(d),_n=[d,f,_,F,ae,Pt,Vt,Ae,ze,qe];if(Jt&&function(d,f){var _=d[1],F=f[1],ae=_|F;if(!(ae<131||(F==K&&8==_||F==K&&256==_&&d[7].length<=f[8]||384==F&&f[7].length<=f[8]&&8==_)))return d;1&F&&(d[2]=f[2],ae|=1&_?0:4);var qe=f[3];if(qe){var ct=d[3];d[3]=ct?Od(ct,qe,f[4]):qe,d[4]=ct?cu(d[3],P):f[4]}(qe=f[5])&&(d[5]=(ct=d[5])?vv(ct,qe,f[6]):qe,d[6]=ct?cu(d[5],P):f[6]),(qe=f[7])&&(d[7]=qe),F&K&&(d[8]=null==d[8]?f[8]:ds(d[8],f[8])),null==d[9]&&(d[9]=f[9]),d[0]=f[0],d[1]=ae}(_n,Jt),d=_n[0],f=_n[1],_=_n[2],F=_n[3],ae=_n[4],!(qe=_n[9]=_n[9]===ee?ct?0:d.length:Vr(_n[9]-Nt,0))&&24&f&&(f&=-25),f&&1!=f)kn=8==f||16==f?function(d,f,_){var F=Nd(d);return function ae(){for(var Ae=arguments.length,ze=Et(Ae),qe=Ae,ct=Fd(ae);qe--;)ze[qe]=arguments[qe];var Nt=Ae<3&&ze[0]!==ct&&ze[Ae-1]!==ct?[]:cu(ze,ct);return(Ae-=Nt.length)<_?Av(d,f,Mc,ae.placeholder,ee,ze,Nt,ee,ee,_-Ae):ts(this&&this!==Li&&this instanceof ae?F:d,this,ze)}}(d,f,qe):f!=V&&33!=f||ae.length?Mc.apply(ee,_n):function(d,f,_,F){var ae=1&f,Ae=Nd(d);return function ze(){for(var qe=-1,ct=arguments.length,Nt=-1,Pt=F.length,Vt=Et(Pt+ct),Jt=this&&this!==Li&&this instanceof ze?Ae:d;++Nt<Pt;)Vt[Nt]=F[Nt];for(;ct--;)Vt[Nt++]=arguments[++qe];return ts(Jt,ae?_:this,Vt)}}(d,f,_,F);else var kn=function(d,f,_){var F=1&f,ae=Nd(d);return function Ae(){return(this&&this!==Li&&this instanceof Ae?ae:d).apply(F?_:this,arguments)}}(d,f,_);return Xh((Jt?v_:Lv)(kn,_n),d,f)}function Tv(d,f,_,F){return d===ee||Mn(d,uu[_])&&!$i.call(F,_)?f:d}function rA(d,f,_,F,ae,Ae){return Sr(d)&&Sr(f)&&(Ae.set(f,d),b_(d,f,ee,rA,Ae),Ae.delete(f)),d}function Mp(d){return Gp(d)?ee:d}function Dp(d,f,_,F,ae,Ae){var ze=1&_,qe=d.length,ct=f.length;if(qe!=ct&&!(ze&&ct>qe))return!1;var Nt=Ae.get(d),Pt=Ae.get(f);if(Nt&&Pt)return Nt==f&&Pt==d;var Vt=-1,Jt=!0,_n=2&_?new xa:ee;for(Ae.set(d,f),Ae.set(f,d);++Vt<qe;){var kn=d[Vt],ui=f[Vt];if(F)var jn=ze?F(ui,kn,Vt,f,d,Ae):F(kn,ui,Vt,d,f,Ae);if(jn!==ee){if(jn)continue;Jt=!1;break}if(_n){if(!Mo(f,function(di,Ei){if(!Mh(_n,Ei)&&(kn===di||ae(kn,di,_,F,Ae)))return _n.push(Ei)})){Jt=!1;break}}else if(kn!==ui&&!ae(kn,ui,_,F,Ae)){Jt=!1;break}}return Ae.delete(d),Ae.delete(f),Jt}function al(d){return Np(hA(d,ee,Cs),d+"")}function Ul(d){return or(d,As,D_)}function T_(d){return or(d,Js,Iv)}var M_=kh?function(d){return kh.get(d)}:xy;function Ip(d){for(var f=d.name+"",_=vd[f],F=$i.call(vd,f)?_.length:0;F--;){var ae=_[F],Ae=ae.func;if(null==Ae||Ae==d)return ae.name}return f}function Fd(d){return($i.call(Ee,"placeholder")?Ee:d).placeholder}function Pn(){var d=Ee.iteratee||Cu;return d=d===Cu?KC:d,arguments.length?d(arguments[0],arguments[1]):d}function Vs(d,f){var _=d.__data__;return function(d){var f=typeof d;return"string"==f||"number"==f||"symbol"==f||"boolean"==f?"__proto__"!==d:null===d}(f)?_["string"==typeof f?"string":"hash"]:_.map}function Zo(d){for(var f=As(d),_=f.length;_--;){var F=f[_],ae=d[F];f[_]=[F,ae,uA(ae)]}return f}function Dc(d,f){var _=function(at,It){return null==at?ee:at[It]}(d,f);return y_(_)?_:ee}var D_=jr?function(d){return null==d?[]:(d=Gi(d),ba(jr(d),function(f){return op.call(d,f)}))}:Rc,Iv=jr?function(d){for(var f=[];d;)Br(f,D_(d)),d=Ea(d);return f}:Rc,Us=Ss;function Rv(d,f,_){for(var F=-1,ae=(f=Ac(f,d)).length,Ae=!1;++F<ae;){var ze=Jn(f[F]);if(!(Ae=null!=d&&_(d,ze)))break;d=d[ze]}return Ae||++F!=ae?Ae:!!(ae=null==d?0:d.length)&&iy(ae)&&No(ze,ae)&&(On(d)||ul(d))}function Nv(d){return"function"!=typeof d.constructor||Rp(d)?{}:hu(Ea(d))}function cA(d){return On(d)||ul(d)||!!(DC&&d&&d[DC])}function No(d,f){var _=typeof d;return!!(f=null==f?xe:f)&&("number"==_||"symbol"!=_&&Vi.test(d))&&d>-1&&d%1==0&&d<f}function zs(d,f,_){if(!Sr(_))return!1;var F=typeof f;return!!("number"==F?po(_)&&No(f,_.length):"string"==F&&f in _)&&Mn(_[f],d)}function Jo(d,f){if(On(d))return!1;var _=typeof d;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=d&&!ra(d))||me.test(d)||!ht.test(d)||null!=f&&d in Gi(f)}function Op(d){var f=Ip(d),_=Ee[f];if("function"!=typeof _||!(f in li.prototype))return!1;if(d===_)return!0;var F=M_(_);return!!F&&d===F[0]}(ws&&Us(new ws(new ArrayBuffer(1)))!=St||ho&&Us(new ho)!=Ne||cp&&Us(cp.resolve())!=ue||Sa&&Us(new Sa)!=pt||Do&&Us(new Do)!=B)&&(Us=function(d){var f=Ss(d),_=f==pe?d.constructor:ee,F=_?Su(_):"";if(F)switch(F){case NC:return St;case s_:return Ne;case o_:return ue;case lv:return pt;case a_:return B}return f});var Fv=sp?ia:Ay;function Rp(d){var f=d&&d.constructor;return d===("function"==typeof f&&f.prototype||uu)}function uA(d){return d==d&&!Sr(d)}function dA(d,f){return function(_){return null!=_&&_[d]===f&&(f!==ee||d in Gi(_))}}function hA(d,f,_){return f=Vr(f===ee?d.length-1:f,0),function(){for(var F=arguments,ae=-1,Ae=Vr(F.length-f,0),ze=Et(Ae);++ae<Ae;)ze[ae]=F[f+ae];ae=-1;for(var qe=Et(f+1);++ae<f;)qe[ae]=F[ae];return qe[f]=_(ze),ts(d,this,qe)}}function N_(d,f){return f.length<2?d:Ko(d,xs(f,0,-1))}function fA(d,f){for(var _=d.length,F=ds(f.length,_),ae=Qs(d);F--;){var Ae=f[F];d[F]=No(Ae,_)?ae[Ae]:ee}return d}function P_(d,f){if(("constructor"!==f||"function"!=typeof d[f])&&"__proto__"!=f)return d[f]}var Lv=F_(v_),Kh=OC||function(d,f){return Li.setTimeout(d,f)},Np=F_(Oo);function Xh(d,f,_){var F=f+"";return Np(d,function(d,f){var _=f.length;if(!_)return d;var F=_-1;return f[F]=(_>1?"& ":"")+f[F],f=f.join(_>2?", ":" "),d.replace(Mt,"{\n/* [wrapped with "+f+"] */\n")}(F,function(d,f){return ks(st,function(_){var F="_."+_[0];f&_[1]&&!Pl(d,F)&&d.push(F)}),d.sort()}(function(d){var f=d.match(Dt);return f?f[1].split(Yt):[]}(F),_)))}function F_(d){var f=0,_=0;return function(){var F=KF(),ae=16-(F-_);if(_=F,ae>0){if(++f>=800)return arguments[0]}else f=0;return d.apply(ee,arguments)}}function Ld(d,f){var _=-1,F=d.length,ae=F-1;for(f=f===ee?F:f;++_<f;){var Ae=kl(_,ae),ze=d[Ae];d[Ae]=d[_],d[_]=ze}return d.length=f,d}var f,_,kv=(f=tf(function(d){var f=[];return 46===d.charCodeAt(0)&&f.push(""),d.replace(be,function(_,F,ae,Ae){f.push(ae?Ae.replace(Rn,"$1"):F||_)}),f},function(F){return 500===_.size&&_.clear(),F}),_=f.cache,f);function Jn(d){if("string"==typeof d||ra(d))return d;var f=d+"";return"0"==f&&1/d==-te?"-0":f}function Su(d){if(null!=d){try{return wr.call(d)}catch(f){}try{return d+""}catch(f){}}return""}function Pp(d){if(d instanceof li)return d.clone();var f=new Io(d.__wrapped__,d.__chain__);return f.__actions__=Qs(d.__actions__),f.__index__=d.__index__,f.__values__=d.__values__,f}var _A=ci(function(d,f){return Er(d)?wc(d,Es(f,1,Er,!0)):[]}),yA=ci(function(d,f){var _=ea(f);return Er(_)&&(_=ee),Er(d)?wc(d,Es(f,1,Er,!0),Pn(_,2)):[]}),bA=ci(function(d,f){var _=ea(f);return Er(_)&&(_=ee),Er(d)?wc(d,Es(f,1,Er,!0),ee,_):[]});function k_(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=null==_?0:Xn(_);return ae<0&&(ae=Vr(F+ae,0)),gd(d,Pn(f,3),ae)}function B_(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=F-1;return _!==ee&&(ae=Xn(_),ae=_<0?Vr(F+ae,0):ds(ae,F-1)),gd(d,Pn(f,3),ae,!0)}function Cs(d){return null!=d&&d.length?Es(d,1):[]}function jv(d){return d&&d.length?d[0]:ee}var Uv=ci(function(d){var f=Hi(d,Cc);return f.length&&f[0]===d[0]?pu(f):[]}),EA=ci(function(d){var f=ea(d),_=Hi(d,Cc);return f===ea(_)?f=ee:_.pop(),_.length&&_[0]===d[0]?pu(_,Pn(f,2)):[]}),zv=ci(function(d){var f=ea(d),_=Hi(d,Cc);return(f="function"==typeof f?f:ee)&&_.pop(),_.length&&_[0]===d[0]?pu(_,ee,f):[]});function ea(d){var f=null==d?0:d.length;return f?d[f-1]:ee}var V_=ci(U_);function U_(d,f){return d&&d.length&&f&&f.length?Qo(d,f):d}var Gv=al(function(d,f){var _=null==d?0:d.length,F=f_(d,f);return Wh(d,Hi(f,function(ae){return No(ae,_)?+ae:ae}).sort(Tc)),F});function z_(d){return null==d?d:lp.call(d)}var qv=ci(function(d){return xc(Es(d,1,Er,!0))}),PA=ci(function(d){var f=ea(d);return Er(f)&&(f=ee),xc(Es(d,1,Er,!0),Pn(f,2))}),FA=ci(function(d){var f=ea(d);return f="function"==typeof f?f:ee,xc(Es(d,1,Er,!0),ee,f)});function Yv(d){if(!d||!d.length)return[];var f=0;return d=ba(d,function(_){if(Er(_))return f=Vr(_.length,f),!0}),_d(f,function(_){return Hi(d,Ym(_))})}function kA(d,f){if(!d||!d.length)return[];var _=Yv(d);return null==f?_:Hi(_,function(F){return ts(f,ee,F)})}var Kv=ci(function(d,f){return Er(d)?wc(d,f):[]}),g2=ci(function(d){return yu(ba(d,Er))}),Po=ci(function(d){var f=ea(d);return Er(f)&&(f=ee),yu(ba(d,Er),Pn(f,2))}),H_=ci(function(d){var f=ea(d);return f="function"==typeof f?f:ee,yu(ba(d,Er),ee,f)}),G_=ci(Yv),Jh=ci(function(d){var f=d.length,_=f>1?d[f-1]:ee;return _="function"==typeof _?(d.pop(),_):ee,kA(d,_)});function $_(d){var f=Ee(d);return f.__chain__=!0,f}function Bd(d,f){return f(d)}var W_=al(function(d){var f=d.length,_=f?d[0]:0,F=this.__wrapped__,ae=function(Ae){return f_(Ae,d)};return!(f>1||this.__actions__.length)&&F instanceof li&&No(_)?((F=F.slice(_,+_+(f?1:0))).__actions__.push({func:Bd,args:[ae],thisArg:ee}),new Io(F,this.__chain__).thru(function(Ae){return f&&!Ae.length&&Ae.push(ee),Ae})):this.thru(ae)}),VA=Xr(function(d,f,_){$i.call(d,_)?++d[_]:il(d,_,1)}),HA=Sv(k_),GA=Sv(B_);function X_(d,f){return(On(d)?ks:Ec)(d,Pn(f,3))}function kp(d,f){return(On(d)?fd:g_)(d,Pn(f,3))}var WA=Xr(function(d,f,_){$i.call(d,_)?d[_].push(f):il(d,_,[f])}),tw=ci(function(d,f,_){var F=-1,ae="function"==typeof f,Ae=po(d)?Et(d.length):[];return Ec(d,function(ze){Ae[++F]=ae?ts(f,ze,_):Ta(ze,f,_)}),Ae}),nw=Xr(function(d,f,_){il(d,_,f)});function cl(d,f){return(On(d)?Hi:XC)(d,Pn(f,3))}var rw=Xr(function(d,f,_){d[_?0:1].push(f)},function(){return[[],[]]}),jp=ci(function(d,f){if(null==d)return[];var _=f.length;return _>1&&zs(d,f[0],f[1])?f=[]:_>2&&zs(f[0],f[1],f[2])&&(f=[f[0]]),$h(d,Es(f,1),[])}),xu=IC||function(){return Li.Date.now()};function Vp(d,f,_){return f=_?ee:f,Vl(d,K,ee,ee,ee,ee,f=d&&null==f?d.length:f)}function Z_(d,f){var _;if("function"!=typeof f)throw new wa(Se);return d=Xn(d),function(){return--d>0&&(_=f.apply(this,arguments)),d<=1&&(f=ee),_}}var ef=ci(function(d,f,_){var F=1;if(_.length){var ae=cu(_,Fd(ef));F|=V}return Vl(d,F,f,_,ae)}),Vd=ci(function(d,f,_){var F=3;if(_.length){var ae=cu(_,Fd(Vd));F|=V}return Vl(f,F,d,_,ae)});function dw(d,f,_){var F,ae,Ae,ze,qe,ct,Nt=0,Pt=!1,Vt=!1,Jt=!0;if("function"!=typeof d)throw new wa(Se);function _n(Bi){var pl=F,Nc=ae;return F=ae=ee,Nt=Bi,ze=d.apply(Nc,pl)}function kn(Bi){return Nt=Bi,qe=Kh(di,f),Pt?_n(Bi):ze}function jn(Bi){var pl=Bi-ct;return ct===ee||pl>=f||pl<0||Vt&&Bi-Nt>=Ae}function di(){var Bi=xu();if(jn(Bi))return Ei(Bi);qe=Kh(di,function(Bi){var tM=f-(Bi-ct);return Vt?ds(tM,Ae-(Bi-Nt)):tM}(Bi))}function Ei(Bi){return qe=ee,Jt&&F?_n(Bi):(F=ae=ee,ze)}function sa(){var Bi=xu(),pl=jn(Bi);if(F=arguments,ae=this,ct=Bi,pl){if(qe===ee)return kn(ct);if(Vt)return tA(qe),qe=Kh(di,f),_n(ct)}return qe===ee&&(qe=Kh(di,f)),ze}return f=go(f)||0,Sr(_)&&(Pt=!!_.leading,Ae=(Vt="maxWait"in _)?Vr(go(_.maxWait)||0,f):Ae,Jt="trailing"in _?!!_.trailing:Jt),sa.cancel=function(){qe!==ee&&tA(qe),Nt=0,F=ct=ae=qe=ee},sa.flush=function(){return qe===ee?ze:Ei(xu())},sa}var XA=ci(function(d,f){return zh(d,1,f)}),hw=ci(function(d,f,_){return zh(d,go(f)||0,_)});function tf(d,f){if("function"!=typeof d||null!=f&&"function"!=typeof f)throw new wa(Se);var _=function(){var F=arguments,ae=f?f.apply(this,F):F[0],Ae=_.cache;if(Ae.has(ae))return Ae.get(ae);var ze=d.apply(this,F);return _.cache=Ae.set(ae,ze)||Ae,ze};return _.cache=new(tf.Cache||tl),_}function ty(d){if("function"!=typeof d)throw new wa(Se);return function(){var f=arguments;switch(f.length){case 0:return!d.call(this);case 1:return!d.call(this,f[0]);case 2:return!d.call(this,f[0],f[1]);case 3:return!d.call(this,f[0],f[1],f[2])}return!d.apply(this,f)}}tf.Cache=tl;var QA=eA(function(d,f){var _=(f=1==f.length&&On(f[0])?Hi(f[0],Yo(Pn())):Hi(Es(f,1),Yo(Pn()))).length;return ci(function(F){for(var ae=-1,Ae=ds(F.length,_);++ae<Ae;)F[ae]=f[ae].call(this,F[ae]);return ts(d,this,F)})}),Up=ci(function(d,f){var _=cu(f,Fd(Up));return Vl(d,V,ee,f,_)}),pw=ci(function(d,f){var _=cu(f,Fd(pw));return Vl(d,64,ee,f,_)}),ZA=al(function(d,f){return Vl(d,256,ee,ee,ee,f)});function Mn(d,f){return d===f||d!=d&&f!=f}var on=Tp(Aa),_w=Tp(function(d,f){return d>=f}),ul=WC(function(){return arguments}())?WC:function(d){return xr(d)&&$i.call(d,"callee")&&!op.call(d,"callee")},On=Et.isArray,yw=tn?Yo(tn):function(d){return xr(d)&&Ss(d)==Qe};function po(d){return null!=d&&iy(d.length)&&!ia(d)}function Er(d){return xr(d)&&po(d)}var dl=ns||Ay,bw=ai?Yo(ai):function(d){return xr(d)&&Ss(d)==Le};function Ia(d){if(!xr(d))return!1;var f=Ss(d);return f==Te||"[object DOMException]"==f||"string"==typeof d.message&&"string"==typeof d.name&&!Gp(d)}function ia(d){if(!Sr(d))return!1;var f=Ss(d);return f==Ve||f==$e||"[object AsyncFunction]"==f||"[object Proxy]"==f}function Hp(d){return"number"==typeof d&&d==Xn(d)}function iy(d){return"number"==typeof d&&d>-1&&d%1==0&&d<=xe}function Sr(d){var f=typeof d;return null!=d&&("object"==f||"function"==f)}function xr(d){return null!=d&&"object"==typeof d}var aT=cr?Yo(cr):function(d){return xr(d)&&Us(d)==Ne};function uT(d){return"number"==typeof d||xr(d)&&Ss(d)==q}function Gp(d){if(!xr(d)||Ss(d)!=pe)return!1;var f=Ea(d);if(null===f)return!0;var _=$i.call(f,"constructor")&&f.constructor;return"function"==typeof _&&_ instanceof _&&wr.call(_)==MC}var Sw=uo?Yo(uo):function(d){return xr(d)&&Ss(d)==_t},dT=_c?Yo(_c):function(d){return xr(d)&&Us(d)==pt};function sy(d){return"string"==typeof d||!On(d)&&xr(d)&&Ss(d)==ve}function ra(d){return"symbol"==typeof d||xr(d)&&Ss(d)==k}var nf=es?Yo(es):function(d){return xr(d)&&iy(d.length)&&!!Sn[Ss(d)]},Ic=Tp(mv),oy=Tp(function(d,f){return d<=f});function xw(d){if(!d)return[];if(po(d))return sy(d)?Ja(d):Qs(d);if(Nh&&d[Nh])return function(at){for(var It,Et=[];!(It=at.next()).done;)Et.push(It.value);return Et}(d[Nh]());var f=Us(d);return(f==Ne?iv:f==pt?Qm:$d)(d)}function hl(d){return d?(d=go(d))===te||d===-te?17976931348623157e292*(d<0?-1:1):d==d?d:0:0===d?d:0}function Xn(d){var f=hl(d),_=f%1;return f==f?_?f-_:f:0}function ay(d){return d?fu(Xn(d),0,_e):0}function go(d){if("number"==typeof d)return d;if(ra(d))return NaN;if(Sr(d)){var f="function"==typeof d.valueOf?d.valueOf():d;d=Sr(f)?f+"":f}if("string"!=typeof d)return 0===d?d:+d;d=nv(d);var _=nr.test(d);return _||Yn.test(d)?tv(d.slice(2),_?2:8):En.test(d)?NaN:+d}function Cw(d){return Ma(d,Js(d))}function ki(d){return null==d?"":Ro(d)}var hT=Bl(function(d,f){if(Rp(f)||po(f))Ma(f,As(f),d);else for(var _ in f)$i.call(f,_)&&nl(d,_,f[_])}),fT=Bl(function(d,f){Ma(f,Js(f),d)}),Ud=Bl(function(d,f,_,F){Ma(f,Js(f),d,F)}),pT=Bl(function(d,f,_,F){Ma(f,As(f),d,F)}),Aw=al(f_),mT=ci(function(d,f){d=Gi(d);var _=-1,F=f.length,ae=F>2?f[2]:ee;for(ae&&zs(f[0],f[1],ae)&&(F=1);++_<F;)for(var Ae=f[_],ze=Js(Ae),qe=-1,ct=ze.length;++qe<ct;){var Nt=ze[qe],Pt=d[Nt];(Pt===ee||Mn(Pt,uu[Nt])&&!$i.call(d,Nt))&&(d[Nt]=Ae[Nt])}return d}),rf=ci(function(d){return d.push(ee,rA),ts(Rw,ee,d)});function of(d,f,_){var F=null==d?ee:Ko(d,f);return F===ee?_:F}function $p(d,f){return null!=d&&Rv(d,f,Td)}var Wp=xv(function(d,f,_){null!=f&&"function"!=typeof f.toString&&(f=Ks.call(f)),d[f]=_},wy(eo)),yT=xv(function(d,f,_){null!=f&&"function"!=typeof f.toString&&(f=Ks.call(f)),$i.call(d,f)?d[f].push(_):d[f]=[_]},Pn),Dw=ci(Ta);function As(d){return po(d)?Uh(d):gv(d)}function Js(d){return po(d)?Uh(d,!0):function(d){if(!Sr(d))return function(d){var f=[];if(null!=d)for(var _ in Gi(d))f.push(_);return f}(d);var f=Rp(d),_=[];for(var F in d)"constructor"==F&&(f||!$i.call(d,F))||_.push(F);return _}(d)}var Ow=Bl(function(d,f,_){b_(d,f,_)}),Rw=Bl(function(d,f,_,F){b_(d,f,_,F)}),vT=al(function(d,f){var _={};if(null==d)return _;var F=!1;f=Hi(f,function(Ae){return Ae=Ac(Ae,d),F||(F=Ae.length>1),Ae}),Ma(d,T_(d),_),F&&(_=js(_,7,Mp));for(var ae=f.length;ae--;)mu(_,f[ae]);return _}),wT=al(function(d,f){return null==d?{}:function(d,f){return _v(d,f,function(_,F){return $p(d,F)})}(d,f)});function Nw(d,f){if(null==d)return{};var _=Hi(T_(d),function(F){return[F]});return f=Pn(f),_v(d,_,function(F,ae){return f(F,ae[0])})}var ET=Eu(As),Fw=Eu(Js);function $d(d){return null==d?[]:Xm(d,As(d))}var TT=jl(function(d,f,_){return f=f.toLowerCase(),d+(_?dy(f):f)});function dy(d){return Yp(ki(d).toLowerCase())}function hy(d){return(d=ki(d))&&d.replace(ma,VF).replace(Wm,"")}var DT=jl(function(d,f,_){return d+(_?"-":"")+f.toLowerCase()}),IT=jl(function(d,f,_){return d+(_?" ":"")+f.toLowerCase()}),A2=xp("toLowerCase"),FT=jl(function(d,f,_){return d+(_?"_":"")+f.toLowerCase()}),gy=jl(function(d,f,_){return d+(_?" ":"")+Yp(f)}),Uw=jl(function(d,f,_){return d+(_?" ":"")+f.toUpperCase()}),Yp=xp("toUpperCase");function by(d,f,_){return d=ki(d),(f=_?ee:f)===ee?function(at){return Rl.test(at)}(d)?function(at){return at.match(Qb)||[]}(d):function(at){return at.match(Un)||[]}(d):d.match(f)||[]}var vy=ci(function(d,f){try{return ts(d,ee,f)}catch(_){return Ia(_)?_:new Tn(_)}}),zw=al(function(d,f){return ks(f,function(_){_=Jn(_),il(d,_,ef(d[_],d))}),d});function wy(d){return function(){return d}}var M2=wu(),Wd=wu(!0);function eo(d){return d}function Cu(d){return KC("function"==typeof d?d:js(d,1))}var Ey=ci(function(d,f){return function(_){return Ta(_,d,f)}}),Hw=ci(function(d,f){return function(_){return Ta(d,_,f)}});function Sy(d,f,_){var F=As(f),ae=Gh(f,F);null==_&&(!Sr(f)||!ae.length&&F.length)&&(_=f,f=d,d=this,ae=Gh(f,As(f)));var Ae=!(Sr(_)&&"chain"in _&&!_.chain),ze=ia(d);return ks(ae,function(qe){var ct=f[qe];d[qe]=ct,ze&&(d.prototype[qe]=function(){var Nt=this.__chain__;if(Ae||Nt){var Pt=d(this.__wrapped__),Vt=Pt.__actions__=Qs(this.__actions__);return Vt.push({func:ct,args:arguments,thisArg:d}),Pt.__chain__=Nt,Pt}return ct.apply(d,Br([this.value()],arguments))})}),d}function xy(){}var zT=Cp(Hi),HT=Cp(Zn),$w=Cp(Mo);function Au(d){return Jo(d)?Ym(Jn(d)):function(d){return function(f){return Ko(f,d)}}(d)}var GT=Cv(),$T=Cv(!0);function Rc(){return[]}function Ay(){return!1}var Gn=C_(function(d,f){return d+f},0),Ty=Pd("ceil"),I2=C_(function(d,f){return d/f},1),Gl=Pd("floor"),Kw=C_(function(d,f){return d*f},1),Xw=Pd("round"),Qw=C_(function(d,f){return d-f},0);return Ee.after=function(d,f){if("function"!=typeof f)throw new wa(Se);return d=Xn(d),function(){if(--d<1)return f.apply(this,arguments)}},Ee.ary=Vp,Ee.assign=hT,Ee.assignIn=fT,Ee.assignInWith=Ud,Ee.assignWith=pT,Ee.at=Aw,Ee.before=Z_,Ee.bind=ef,Ee.bindAll=zw,Ee.bindKey=Vd,Ee.castArray=function(){if(!arguments.length)return[];var d=arguments[0];return On(d)?d:[d]},Ee.chain=$_,Ee.chunk=function(d,f,_){f=(_?zs(d,f,_):f===ee)?1:Vr(Xn(f),0);var F=null==d?0:d.length;if(!F||f<1)return[];for(var ae=0,Ae=0,ze=Et(Lt(F/f));ae<F;)ze[Ae++]=xs(d,ae,ae+=f);return ze},Ee.compact=function(d){for(var f=-1,_=null==d?0:d.length,F=0,ae=[];++f<_;){var Ae=d[f];Ae&&(ae[F++]=Ae)}return ae},Ee.concat=function(){var d=arguments.length;if(!d)return[];for(var f=Et(d-1),_=arguments[0],F=d;F--;)f[F-1]=arguments[F];return Br(On(_)?Qs(_):[_],Es(f,1))},Ee.cond=function(d){var f=null==d?0:d.length,_=Pn();return d=f?Hi(d,function(F){if("function"!=typeof F[1])throw new wa(Se);return[_(F[0]),F[1]]}):[],ci(function(F){for(var ae=-1;++ae<f;){var Ae=d[ae];if(ts(Ae[0],this,F))return ts(Ae[1],this,F)}})},Ee.conforms=function(d){return function(d){var f=As(d);return function(_){return mp(_,d,f)}}(js(d,1))},Ee.constant=wy,Ee.countBy=VA,Ee.create=function(d,f){var _=hu(d);return null==f?_:$C(_,f)},Ee.curry=function uw(d,f,_){var F=Vl(d,8,ee,ee,ee,ee,ee,f=_?ee:f);return F.placeholder=uw.placeholder,F},Ee.curryRight=function J_(d,f,_){var F=Vl(d,16,ee,ee,ee,ee,ee,f=_?ee:f);return F.placeholder=J_.placeholder,F},Ee.debounce=dw,Ee.defaults=mT,Ee.defaultsDeep=rf,Ee.defer=XA,Ee.delay=hw,Ee.difference=_A,Ee.differenceBy=yA,Ee.differenceWith=bA,Ee.drop=function(d,f,_){var F=null==d?0:d.length;return F?xs(d,(f=_||f===ee?1:Xn(f))<0?0:f,F):[]},Ee.dropRight=function(d,f,_){var F=null==d?0:d.length;return F?xs(d,0,(f=F-(f=_||f===ee?1:Xn(f)))<0?0:f):[]},Ee.dropRightWhile=function(d,f){return d&&d.length?_u(d,Pn(f,3),!0,!0):[]},Ee.dropWhile=function(d,f){return d&&d.length?_u(d,Pn(f,3),!0):[]},Ee.fill=function(d,f,_,F){var ae=null==d?0:d.length;return ae?(_&&"number"!=typeof _&&zs(d,f,_)&&(_=0,F=ae),function(d,f,_,F){var ae=d.length;for((_=Xn(_))<0&&(_=-_>ae?0:ae+_),(F=F===ee||F>ae?ae:Xn(F))<0&&(F+=ae),F=_>F?0:ay(F);_<F;)d[_++]=f;return d}(d,f,_,F)):[]},Ee.filter=function(d,f){return(On(d)?ba:pv)(d,Pn(f,3))},Ee.flatMap=function(d,f){return Es(cl(d,f),1)},Ee.flatMapDeep=function(d,f){return Es(cl(d,f),te)},Ee.flatMapDepth=function(d,f,_){return _=_===ee?1:Xn(_),Es(cl(d,f),_)},Ee.flatten=Cs,Ee.flattenDeep=function(d){return null!=d&&d.length?Es(d,te):[]},Ee.flattenDepth=function(d,f){return null!=d&&d.length?Es(d,f=f===ee?1:Xn(f)):[]},Ee.flip=function(d){return Vl(d,512)},Ee.flow=M2,Ee.flowRight=Wd,Ee.fromPairs=function(d){for(var f=-1,_=null==d?0:d.length,F={};++f<_;){var ae=d[f];F[ae[0]]=ae[1]}return F},Ee.functions=function(d){return null==d?[]:Gh(d,As(d))},Ee.functionsIn=function(d){return null==d?[]:Gh(d,Js(d))},Ee.groupBy=WA,Ee.initial=function(d){return null!=d&&d.length?xs(d,0,-1):[]},Ee.intersection=Uv,Ee.intersectionBy=EA,Ee.intersectionWith=zv,Ee.invert=Wp,Ee.invertBy=yT,Ee.invokeMap=tw,Ee.iteratee=Cu,Ee.keyBy=nw,Ee.keys=As,Ee.keysIn=Js,Ee.map=cl,Ee.mapKeys=function(d,f){var _={};return f=Pn(f,3),rl(d,function(F,ae,Ae){il(_,f(F,ae,Ae),F)}),_},Ee.mapValues=function(d,f){var _={};return f=Pn(f,3),rl(d,function(F,ae,Ae){il(_,ae,f(F,ae,Ae))}),_},Ee.matches=function(d){return QC(js(d,1))},Ee.matchesProperty=function(d,f){return Dd(d,js(f,1))},Ee.memoize=tf,Ee.merge=Ow,Ee.mergeWith=Rw,Ee.method=Ey,Ee.methodOf=Hw,Ee.mixin=Sy,Ee.negate=ty,Ee.nthArg=function(d){return d=Xn(d),ci(function(f){return gu(f,d)})},Ee.omit=vT,Ee.omitBy=function(d,f){return Nw(d,ty(Pn(f)))},Ee.once=function(d){return Z_(2,d)},Ee.orderBy=function(d,f,_,F){return null==d?[]:(On(f)||(f=null==f?[]:[f]),On(_=F?ee:_)||(_=null==_?[]:[_]),$h(d,f,_))},Ee.over=zT,Ee.overArgs=QA,Ee.overEvery=HT,Ee.overSome=$w,Ee.partial=Up,Ee.partialRight=pw,Ee.partition=rw,Ee.pick=wT,Ee.pickBy=Nw,Ee.property=Au,Ee.propertyOf=function(d){return function(f){return null==d?ee:Ko(d,f)}},Ee.pull=V_,Ee.pullAll=U_,Ee.pullAllBy=function(d,f,_){return d&&d.length&&f&&f.length?Qo(d,f,Pn(_,2)):d},Ee.pullAllWith=function(d,f,_){return d&&d.length&&f&&f.length?Qo(d,f,ee,_):d},Ee.pullAt=Gv,Ee.range=GT,Ee.rangeRight=$T,Ee.rearg=ZA,Ee.reject=function(d,f){return(On(d)?ba:pv)(d,ty(Pn(f,3)))},Ee.remove=function(d,f){var _=[];if(!d||!d.length)return _;var F=-1,ae=[],Ae=d.length;for(f=Pn(f,3);++F<Ae;){var ze=d[F];f(ze,F,d)&&(_.push(ze),ae.push(F))}return Wh(d,ae),_},Ee.rest=function(d,f){if("function"!=typeof d)throw new wa(Se);return ci(d,f=f===ee?f:Xn(f))},Ee.reverse=z_,Ee.sampleSize=function(d,f,_){return f=(_?zs(d,f,_):f===ee)?1:Xn(f),(On(d)?uv:s2)(d,f)},Ee.set=function(d,f,_){return null==d?d:vp(d,f,_)},Ee.setWith=function(d,f,_,F){return F="function"==typeof F?F:ee,null==d?d:vp(d,f,_,F)},Ee.shuffle=function(d){return(On(d)?Ed:w_)(d)},Ee.slice=function(d,f,_){var F=null==d?0:d.length;return F?(_&&"number"!=typeof _&&zs(d,f,_)?(f=0,_=F):(f=null==f?0:Xn(f),_=_===ee?F:Xn(_)),xs(d,f,_)):[]},Ee.sortBy=jp,Ee.sortedUniq=function(d){return d&&d.length?yv(d):[]},Ee.sortedUniqBy=function(d,f){return d&&d.length?yv(d,Pn(f,2)):[]},Ee.split=function(d,f,_){return _&&"number"!=typeof _&&zs(d,f,_)&&(f=_=ee),(_=_===ee?_e:_>>>0)?(d=ki(d))&&("string"==typeof f||null!=f&&!Sw(f))&&!(f=Ro(f))&&Dh(d)?sl(Ja(d),0,_):d.split(f,_):[]},Ee.spread=function(d,f){if("function"!=typeof d)throw new wa(Se);return f=null==f?0:Vr(Xn(f),0),ci(function(_){var F=_[f],ae=sl(_,0,f);return F&&Br(ae,F),ts(d,this,ae)})},Ee.tail=function(d){var f=null==d?0:d.length;return f?xs(d,1,f):[]},Ee.take=function(d,f,_){return d&&d.length?xs(d,0,(f=_||f===ee?1:Xn(f))<0?0:f):[]},Ee.takeRight=function(d,f,_){var F=null==d?0:d.length;return F?xs(d,(f=F-(f=_||f===ee?1:Xn(f)))<0?0:f,F):[]},Ee.takeRightWhile=function(d,f){return d&&d.length?_u(d,Pn(f,3),!1,!0):[]},Ee.takeWhile=function(d,f){return d&&d.length?_u(d,Pn(f,3)):[]},Ee.tap=function(d,f){return f(d),d},Ee.throttle=function(d,f,_){var F=!0,ae=!0;if("function"!=typeof d)throw new wa(Se);return Sr(_)&&(F="leading"in _?!!_.leading:F,ae="trailing"in _?!!_.trailing:ae),dw(d,f,{leading:F,maxWait:f,trailing:ae})},Ee.thru=Bd,Ee.toArray=xw,Ee.toPairs=ET,Ee.toPairsIn=Fw,Ee.toPath=function(d){return On(d)?Hi(d,Jn):ra(d)?[d]:Qs(kv(ki(d)))},Ee.toPlainObject=Cw,Ee.transform=function(d,f,_){var F=On(d),ae=F||dl(d)||nf(d);if(f=Pn(f,4),null==_){var Ae=d&&d.constructor;_=ae?F?new Ae:[]:Sr(d)&&ia(Ae)?hu(Ea(d)):{}}return(ae?ks:rl)(d,function(ze,qe,ct){return f(_,ze,qe,ct)}),_},Ee.unary=function(d){return Vp(d,1)},Ee.union=qv,Ee.unionBy=PA,Ee.unionWith=FA,Ee.uniq=function(d){return d&&d.length?xc(d):[]},Ee.uniqBy=function(d,f){return d&&d.length?xc(d,Pn(f,2)):[]},Ee.uniqWith=function(d,f){return f="function"==typeof f?f:ee,d&&d.length?xc(d,ee,f):[]},Ee.unset=function(d,f){return null==d||mu(d,f)},Ee.unzip=Yv,Ee.unzipWith=kA,Ee.update=function(d,f,_){return null==d?d:wp(d,f,S_(_))},Ee.updateWith=function(d,f,_,F){return F="function"==typeof F?F:ee,null==d?d:wp(d,f,S_(_),F)},Ee.values=$d,Ee.valuesIn=function(d){return null==d?[]:Xm(d,Js(d))},Ee.without=Kv,Ee.words=by,Ee.wrap=function(d,f){return Up(S_(f),d)},Ee.xor=g2,Ee.xorBy=Po,Ee.xorWith=H_,Ee.zip=G_,Ee.zipObject=function(d,f){return Ep(d||[],f||[],nl)},Ee.zipObjectDeep=function(d,f){return Ep(d||[],f||[],vp)},Ee.zipWith=Jh,Ee.entries=ET,Ee.entriesIn=Fw,Ee.extend=fT,Ee.extendWith=Ud,Sy(Ee,Ee),Ee.add=Gn,Ee.attempt=vy,Ee.camelCase=TT,Ee.capitalize=dy,Ee.ceil=Ty,Ee.clamp=function(d,f,_){return _===ee&&(_=f,f=ee),_!==ee&&(_=(_=go(_))==_?_:0),f!==ee&&(f=(f=go(f))==f?f:0),fu(go(d),f,_)},Ee.clone=function(d){return js(d,4)},Ee.cloneDeep=function(d){return js(d,5)},Ee.cloneDeepWith=function(d,f){return js(d,5,f="function"==typeof f?f:ee)},Ee.cloneWith=function(d,f){return js(d,4,f="function"==typeof f?f:ee)},Ee.conformsTo=function(d,f){return null==f||mp(d,f,As(f))},Ee.deburr=hy,Ee.defaultTo=function(d,f){return null==d||d!=d?f:d},Ee.divide=I2,Ee.endsWith=function(d,f,_){d=ki(d),f=Ro(f);var F=d.length,ae=_=_===ee?F:fu(Xn(_),0,F);return(_-=f.length)>=0&&d.slice(_,ae)==f},Ee.eq=Mn,Ee.escape=function(d){return(d=ki(d))&&Zt.test(d)?d.replace(ga,UF):d},Ee.escapeRegExp=function(d){return(d=ki(d))&&ut.test(d)?d.replace(ke,"\\$&"):d},Ee.every=function(d,f,_){var F=On(d)?Zn:hv;return _&&zs(d,f,_)&&(f=ee),F(d,Pn(f,3))},Ee.find=HA,Ee.findIndex=k_,Ee.findKey=function(d,f){return Th(d,Pn(f,3),rl)},Ee.findLast=GA,Ee.findLastIndex=B_,Ee.findLastKey=function(d,f){return Th(d,Pn(f,3),_p)},Ee.floor=Gl,Ee.forEach=X_,Ee.forEachRight=kp,Ee.forIn=function(d,f){return null==d?d:xd(d,Pn(f,3),Js)},Ee.forInRight=function(d,f){return null==d?d:Cd(d,Pn(f,3),Js)},Ee.forOwn=function(d,f){return d&&rl(d,Pn(f,3))},Ee.forOwnRight=function(d,f){return d&&_p(d,Pn(f,3))},Ee.get=of,Ee.gt=on,Ee.gte=_w,Ee.has=function(d,f){return null!=d&&Rv(d,f,Ad)},Ee.hasIn=$p,Ee.head=jv,Ee.identity=eo,Ee.includes=function(d,f,_,F){d=po(d)?d:$d(d),_=_&&!F?Xn(_):0;var ae=d.length;return _<0&&(_=Vr(ae+_,0)),sy(d)?_<=ae&&d.indexOf(f,_)>-1:!!ae&&Za(d,f,_)>-1},Ee.indexOf=function(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=null==_?0:Xn(_);return ae<0&&(ae=Vr(F+ae,0)),Za(d,f,ae)},Ee.inRange=function(d,f,_){return f=hl(f),_===ee?(_=f,f=0):_=hl(_),function(d,f,_){return d>=ds(f,_)&&d<Vr(f,_)}(d=go(d),f,_)},Ee.invoke=Dw,Ee.isArguments=ul,Ee.isArray=On,Ee.isArrayBuffer=yw,Ee.isArrayLike=po,Ee.isArrayLikeObject=Er,Ee.isBoolean=function(d){return!0===d||!1===d||xr(d)&&Ss(d)==Ue},Ee.isBuffer=dl,Ee.isDate=bw,Ee.isElement=function(d){return xr(d)&&1===d.nodeType&&!Gp(d)},Ee.isEmpty=function(d){if(null==d)return!0;if(po(d)&&(On(d)||"string"==typeof d||"function"==typeof d.splice||dl(d)||nf(d)||ul(d)))return!d.length;var f=Us(d);if(f==Ne||f==pt)return!d.size;if(Rp(d))return!gv(d).length;for(var _ in d)if($i.call(d,_))return!1;return!0},Ee.isEqual=function(d,f){return yp(d,f)},Ee.isEqualWith=function(d,f,_){var F=(_="function"==typeof _?_:ee)?_(d,f):ee;return F===ee?yp(d,f,ee,_):!!F},Ee.isError=Ia,Ee.isFinite=function(d){return"number"==typeof d&&r_(d)},Ee.isFunction=ia,Ee.isInteger=Hp,Ee.isLength=iy,Ee.isMap=aT,Ee.isMatch=function(d,f){return d===f||__(d,f,Zo(f))},Ee.isMatchWith=function(d,f,_){return _="function"==typeof _?_:ee,__(d,f,Zo(f),_)},Ee.isNaN=function(d){return uT(d)&&d!=+d},Ee.isNative=function(d){if(Fv(d))throw new Tn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return y_(d)},Ee.isNil=function(d){return null==d},Ee.isNull=function(d){return null===d},Ee.isNumber=uT,Ee.isObject=Sr,Ee.isObjectLike=xr,Ee.isPlainObject=Gp,Ee.isRegExp=Sw,Ee.isSafeInteger=function(d){return Hp(d)&&d>=-xe&&d<=xe},Ee.isSet=dT,Ee.isString=sy,Ee.isSymbol=ra,Ee.isTypedArray=nf,Ee.isUndefined=function(d){return d===ee},Ee.isWeakMap=function(d){return xr(d)&&Us(d)==B},Ee.isWeakSet=function(d){return xr(d)&&"[object WeakSet]"==Ss(d)},Ee.join=function(d,f){return null==d?"":Ph.call(d,f)},Ee.kebabCase=DT,Ee.last=ea,Ee.lastIndexOf=function(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=F;return _!==ee&&(ae=(ae=Xn(_))<0?Vr(F+ae,0):ds(ae,F-1)),f==f?function(at,It,Et){for(var sn=Et+1;sn--;)if(at[sn]===It)return sn;return sn}(d,f,ae):gd(d,yc,ae,!0)},Ee.lowerCase=IT,Ee.lowerFirst=A2,Ee.lt=Ic,Ee.lte=oy,Ee.max=function(d){return d&&d.length?Hh(d,eo,Aa):ee},Ee.maxBy=function(d,f){return d&&d.length?Hh(d,Pn(f,2),Aa):ee},Ee.mean=function(d){return vs(d,eo)},Ee.meanBy=function(d,f){return vs(d,Pn(f,2))},Ee.min=function(d){return d&&d.length?Hh(d,eo,mv):ee},Ee.minBy=function(d,f){return d&&d.length?Hh(d,Pn(f,2),mv):ee},Ee.stubArray=Rc,Ee.stubFalse=Ay,Ee.stubObject=function(){return{}},Ee.stubString=function(){return""},Ee.stubTrue=function(){return!0},Ee.multiply=Kw,Ee.nth=function(d,f){return d&&d.length?gu(d,Xn(f)):ee},Ee.noConflict=function(){return Li._===this&&(Li._=n_),this},Ee.noop=xy,Ee.now=xu,Ee.pad=function(d,f,_){d=ki(d);var F=(f=Xn(f))?Ih(d):0;if(!f||F>=f)return d;var ae=(f-F)/2;return Ap(mi(ae),_)+d+Ap(Lt(ae),_)},Ee.padEnd=function(d,f,_){d=ki(d);var F=(f=Xn(f))?Ih(d):0;return f&&F<f?d+Ap(f-F,_):d},Ee.padStart=function(d,f,_){d=ki(d);var F=(f=Xn(f))?Ih(d):0;return f&&F<f?Ap(f-F,_)+d:d},Ee.parseInt=function(d,f,_){return _||null==f?f=0:f&&(f=+f),RC(ki(d).replace(Ze,""),f||0)},Ee.random=function(d,f,_){if(_&&"boolean"!=typeof _&&zs(d,f,_)&&(f=_=ee),_===ee&&("boolean"==typeof f?(_=f,f=ee):"boolean"==typeof d&&(_=d,d=ee)),d===ee&&f===ee?(d=0,f=1):(d=hl(d),f===ee?(f=d,d=0):f=hl(f)),d>f){var F=d;d=f,f=F}if(_||d%1||f%1){var ae=Fh();return ds(d+ae*(f-d+vC("1e-"+((ae+"").length-1))),f)}return kl(d,f)},Ee.reduce=function(d,f,_){var F=On(d)?lu:qo,ae=arguments.length<3;return F(d,Pn(f,4),_,ae,Ec)},Ee.reduceRight=function(d,f,_){var F=On(d)?pd:qo,ae=arguments.length<3;return F(d,Pn(f,4),_,ae,g_)},Ee.repeat=function(d,f,_){return f=(_?zs(d,f,_):f===ee)?1:Xn(f),bp(ki(d),f)},Ee.replace=function(){var d=arguments,f=ki(d[0]);return d.length<3?f:f.replace(d[1],d[2])},Ee.result=function(d,f,_){var F=-1,ae=(f=Ac(f,d)).length;for(ae||(ae=1,d=ee);++F<ae;){var Ae=null==d?ee:d[Jn(f[F])];Ae===ee&&(F=ae,Ae=_),d=ia(Ae)?Ae.call(d):Ae}return d},Ee.round=Xw,Ee.runInContext=at,Ee.sample=function(d){return(On(d)?d_:ZC)(d)},Ee.size=function(d){if(null==d)return 0;if(po(d))return sy(d)?Ih(d):d.length;var f=Us(d);return f==Ne||f==pt?d.size:gv(d).length},Ee.snakeCase=FT,Ee.some=function(d,f,_){var F=On(d)?Mo:o2;return _&&zs(d,f,_)&&(f=ee),F(d,Pn(f,3))},Ee.sortedIndex=function(d,f){return qh(d,f)},Ee.sortedIndexBy=function(d,f,_){return E_(d,f,Pn(_,2))},Ee.sortedIndexOf=function(d,f){var _=null==d?0:d.length;if(_){var F=qh(d,f);if(F<_&&Mn(d[F],f))return F}return-1},Ee.sortedLastIndex=function(d,f){return qh(d,f,!0)},Ee.sortedLastIndexBy=function(d,f,_){return E_(d,f,Pn(_,2),!0)},Ee.sortedLastIndexOf=function(d,f){if(null!=d&&d.length){var F=qh(d,f,!0)-1;if(Mn(d[F],f))return F}return-1},Ee.startCase=gy,Ee.startsWith=function(d,f,_){return d=ki(d),_=null==_?0:fu(Xn(_),0,d.length),f=Ro(f),d.slice(_,_+f.length)==f},Ee.subtract=Qw,Ee.sum=function(d){return d&&d.length?md(d,eo):0},Ee.sumBy=function(d,f){return d&&d.length?md(d,Pn(f,2)):0},Ee.template=function(d,f,_){var F=Ee.templateSettings;_&&zs(d,f,_)&&(f=ee),d=ki(d),f=Ud({},f,F,Tv);var qe,ct,ae=Ud({},f.imports,F.imports,Tv),Ae=As(ae),ze=Xm(ae,Ae),Nt=0,Pt=f.interpolate||Wr,Vt="__p += '",Jt=e_((f.escape||Wr).source+"|"+Pt.source+"|"+(Pt===lt?fn:Wr).source+"|"+(f.evaluate||Wr).source+"|$","g"),_n="//# sourceURL="+($i.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++bC+"]")+"\n";d.replace(Jt,function(jn,di,Ei,mo,Hs,sa){return Ei||(Ei=mo),Vt+=d.slice(Nt,sa).replace(ie,zF),di&&(qe=!0,Vt+="' +\n__e("+di+") +\n'"),Hs&&(ct=!0,Vt+="';\n"+Hs+";\n__p += '"),Ei&&(Vt+="' +\n((__t = ("+Ei+")) == null ? '' : __t) +\n'"),Nt=sa+jn.length,jn}),Vt+="';\n";var kn=$i.call(f,"variable")&&f.variable;if(kn){if(ii.test(kn))throw new Tn("Invalid `variable` option passed into `_.template`")}else Vt="with (obj) {\n"+Vt+"\n}\n";Vt=(ct?Vt.replace(Ps,""):Vt).replace($r,"$1").replace(Xa,"$1;"),Vt="function("+(kn||"obj")+") {\n"+(kn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(qe?", __e = _.escape":"")+(ct?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+Vt+"return __p\n}";var ui=vy(function(){return Oi(Ae,_n+"return "+Vt).apply(ee,ze)});if(ui.source=Vt,Ia(ui))throw ui;return ui},Ee.times=function(d,f){if((d=Xn(d))<1||d>xe)return[];var _=_e,F=ds(d,_e);f=Pn(f),d-=_e;for(var ae=_d(F,f);++_<d;)f(_);return ae},Ee.toFinite=hl,Ee.toInteger=Xn,Ee.toLength=ay,Ee.toLower=function(d){return ki(d).toLowerCase()},Ee.toNumber=go,Ee.toSafeInteger=function(d){return d?fu(Xn(d),-xe,xe):0===d?d:0},Ee.toString=ki,Ee.toUpper=function(d){return ki(d).toUpperCase()},Ee.trim=function(d,f,_){if((d=ki(d))&&(_||f===ee))return nv(d);if(!d||!(f=Ro(f)))return d;var F=Ja(d),ae=Ja(f);return sl(F,SC(F,ae),xC(F,ae)+1).join("")},Ee.trimEnd=function(d,f,_){if((d=ki(d))&&(_||f===ee))return d.slice(0,bc(d)+1);if(!d||!(f=Ro(f)))return d;var F=Ja(d);return sl(F,0,xC(F,Ja(f))+1).join("")},Ee.trimStart=function(d,f,_){if((d=ki(d))&&(_||f===ee))return d.replace(Ze,"");if(!d||!(f=Ro(f)))return d;var F=Ja(d);return sl(F,SC(F,Ja(f))).join("")},Ee.truncate=function(d,f){var _=30,F="...";if(Sr(f)){var ae="separator"in f?f.separator:ae;_="length"in f?Xn(f.length):_,F="omission"in f?Ro(f.omission):F}var Ae=(d=ki(d)).length;if(Dh(d)){var ze=Ja(d);Ae=ze.length}if(_>=Ae)return d;var qe=_-Ih(F);if(qe<1)return F;var ct=ze?sl(ze,0,qe).join(""):d.slice(0,qe);if(ae===ee)return ct+F;if(ze&&(qe+=ct.length-qe),Sw(ae)){if(d.slice(qe).search(ae)){var Nt,Pt=ct;for(ae.global||(ae=e_(ae.source,ki(Hn.exec(ae))+"g")),ae.lastIndex=0;Nt=ae.exec(Pt);)var Vt=Nt.index;ct=ct.slice(0,Vt===ee?qe:Vt)}}else if(d.indexOf(Ro(ae),qe)!=qe){var Jt=ct.lastIndexOf(ae);Jt>-1&&(ct=ct.slice(0,Jt))}return ct+F},Ee.unescape=function(d){return(d=ki(d))&&_s.test(d)?d.replace(Dl,Jm):d},Ee.uniqueId=function(d){var f=++YF;return ki(d)+f},Ee.upperCase=Uw,Ee.upperFirst=Yp,Ee.each=X_,Ee.eachRight=kp,Ee.first=jv,Sy(Ee,function(){var d={};return rl(Ee,function(f,_){$i.call(Ee.prototype,_)||(d[_]=f)}),d}(),{chain:!1}),Ee.VERSION="4.17.21",ks(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){Ee[d].placeholder=Ee}),ks(["drop","take"],function(d,f){li.prototype[d]=function(_){_=_===ee?1:Vr(Xn(_),0);var F=this.__filtered__&&!f?new li(this):this.clone();return F.__filtered__?F.__takeCount__=ds(_,F.__takeCount__):F.__views__.push({size:ds(_,_e),type:d+(F.__dir__<0?"Right":"")}),F},li.prototype[d+"Right"]=function(_){return this.reverse()[d](_).reverse()}}),ks(["filter","map","takeWhile"],function(d,f){var _=f+1,F=1==_||3==_;li.prototype[d]=function(ae){var Ae=this.clone();return Ae.__iteratees__.push({iteratee:Pn(ae,3),type:_}),Ae.__filtered__=Ae.__filtered__||F,Ae}}),ks(["head","last"],function(d,f){var _="take"+(f?"Right":"");li.prototype[d]=function(){return this[_](1).value()[0]}}),ks(["initial","tail"],function(d,f){var _="drop"+(f?"":"Right");li.prototype[d]=function(){return this.__filtered__?new li(this):this[_](1)}}),li.prototype.compact=function(){return this.filter(eo)},li.prototype.find=function(d){return this.filter(d).head()},li.prototype.findLast=function(d){return this.reverse().find(d)},li.prototype.invokeMap=ci(function(d,f){return"function"==typeof d?new li(this):this.map(function(_){return Ta(_,d,f)})}),li.prototype.reject=function(d){return this.filter(ty(Pn(d)))},li.prototype.slice=function(d,f){d=Xn(d);var _=this;return _.__filtered__&&(d>0||f<0)?new li(_):(d<0?_=_.takeRight(-d):d&&(_=_.drop(d)),f!==ee&&(_=(f=Xn(f))<0?_.dropRight(-f):_.take(f-d)),_)},li.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},li.prototype.toArray=function(){return this.take(_e)},rl(li.prototype,function(d,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),F=/^(?:head|last)$/.test(f),ae=Ee[F?"take"+("last"==f?"Right":""):f],Ae=F||/^find/.test(f);!ae||(Ee.prototype[f]=function(){var ze=this.__wrapped__,qe=F?[1]:arguments,ct=ze instanceof li,Nt=qe[0],Pt=ct||On(ze),Vt=function(di){var Ei=ae.apply(Ee,Br([di],qe));return F&&Jt?Ei[0]:Ei};Pt&&_&&"function"==typeof Nt&&1!=Nt.length&&(ct=Pt=!1);var Jt=this.__chain__,_n=!!this.__actions__.length,kn=Ae&&!Jt,ui=ct&&!_n;if(!Ae&&Pt){ze=ui?ze:new li(this);var jn=d.apply(ze,qe);return jn.__actions__.push({func:Bd,args:[Vt],thisArg:ee}),new Io(jn,Jt)}return kn&&ui?d.apply(this,qe):(jn=this.thru(Vt),kn?F?jn.value()[0]:jn.value():jn)})}),ks(["pop","push","shift","sort","splice","unshift"],function(d){var f=ur[d],_=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",F=/^(?:pop|shift)$/.test(d);Ee.prototype[d]=function(){var ae=arguments;if(F&&!this.__chain__){var Ae=this.value();return f.apply(On(Ae)?Ae:[],ae)}return this[_](function(ze){return f.apply(On(ze)?ze:[],ae)})}}),rl(li.prototype,function(d,f){var _=Ee[f];if(_){var F=_.name+"";$i.call(vd,F)||(vd[F]=[]),vd[F].push({name:f,func:_})}}),vd[Mc(ee,2).name]=[{name:"wrapper",func:ee}],li.prototype.clone=function(){var d=new li(this.__wrapped__);return d.__actions__=Qs(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=Qs(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=Qs(this.__views__),d},li.prototype.reverse=function(){if(this.__filtered__){var d=new li(this);d.__dir__=-1,d.__filtered__=!0}else(d=this.clone()).__dir__*=-1;return d},li.prototype.value=function(){var d=this.__wrapped__.value(),f=this.__dir__,_=On(d),F=f<0,ae=_?d.length:0,Ae=function(d,f,_){for(var F=-1,ae=_.length;++F<ae;){var Ae=_[F],ze=Ae.size;switch(Ae.type){case"drop":d+=ze;break;case"dropRight":f-=ze;break;case"take":f=ds(f,d+ze);break;case"takeRight":d=Vr(d,f-ze)}}return{start:d,end:f}}(0,ae,this.__views__),ze=Ae.start,qe=Ae.end,ct=qe-ze,Nt=F?qe:ze-1,Pt=this.__iteratees__,Vt=Pt.length,Jt=0,_n=ds(ct,this.__takeCount__);if(!_||!F&&ae==ct&&_n==ct)return JC(d,this.__actions__);var kn=[];e:for(;ct--&&Jt<_n;){for(var ui=-1,jn=d[Nt+=f];++ui<Vt;){var di=Pt[ui],mo=di.type,Hs=(0,di.iteratee)(jn);if(2==mo)jn=Hs;else if(!Hs){if(1==mo)continue e;break e}}kn[Jt++]=jn}return kn},Ee.prototype.at=W_,Ee.prototype.chain=function(){return $_(this)},Ee.prototype.commit=function(){return new Io(this.value(),this.__chain__)},Ee.prototype.next=function(){this.__values__===ee&&(this.__values__=xw(this.value()));var d=this.__index__>=this.__values__.length;return{done:d,value:d?ee:this.__values__[this.__index__++]}},Ee.prototype.plant=function(d){for(var f,_=this;_ instanceof jh;){var F=Pp(_);F.__index__=0,F.__values__=ee,f?ae.__wrapped__=F:f=F;var ae=F;_=_.__wrapped__}return ae.__wrapped__=d,f},Ee.prototype.reverse=function(){var d=this.__wrapped__;if(d instanceof li){var f=d;return this.__actions__.length&&(f=new li(this)),(f=f.reverse()).__actions__.push({func:Bd,args:[z_],thisArg:ee}),new Io(f,this.__chain__)}return this.thru(z_)},Ee.prototype.toJSON=Ee.prototype.valueOf=Ee.prototype.value=function(){return JC(this.__wrapped__,this.__actions__)},Ee.prototype.first=Ee.prototype.head,Nh&&(Ee.prototype[Nh]=function(){return this}),Ee}();Li._=Oh,(yt=function(){return Oh}.call(it,Je,it,Bt))!==ee&&(Bt.exports=yt)}.call(this)},478:function(Bt){Bt.exports=function(){"use strict";function it(rt,lt){for(var ht=0;ht<lt.length;ht++){var me=lt[ht];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(rt,me.key,me)}}function ee(rt,lt){(null==lt||lt>rt.length)&&(lt=rt.length);for(var ht=0,me=new Array(lt);ht<lt;ht++)me[ht]=rt[ht];return me}function At(rt,lt){var ht="undefined"!=typeof Symbol&&rt[Symbol.iterator]||rt["@@iterator"];if(ht)return(ht=ht.call(rt)).next.bind(ht);if(Array.isArray(rt)||(ht=function(rt,lt){if(rt){if("string"==typeof rt)return ee(rt,lt);var ht=Object.prototype.toString.call(rt).slice(8,-1);if("Object"===ht&&rt.constructor&&(ht=rt.constructor.name),"Map"===ht||"Set"===ht)return Array.from(rt);if("Arguments"===ht||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ht))return ee(rt,lt)}}(rt))||lt&&rt&&"number"==typeof rt.length){ht&&(rt=ht);var me=0;return function(){return me>=rt.length?{done:!0}:{done:!1,value:rt[me++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var dt={exports:{}};function Y(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}dt.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:Y,changeDefaults:function(rt){dt.exports.defaults=rt}};var he=/[&<>"']/,W=/[&<>"']/g,j=/[<>"']|&(?!#?\w+;)/,P=/[<>"']|&(?!#?\w+;)/g,Q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z=function(lt){return Q[lt]};var x=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function O(rt){return rt.replace(x,function(lt,ht){return"colon"===(ht=ht.toLowerCase())?":":"#"===ht.charAt(0)?"x"===ht.charAt(1)?String.fromCharCode(parseInt(ht.substring(2),16)):String.fromCharCode(+ht.substring(1)):""})}var A=/(^|[^\[])\^/g;var y=/[^\w:]/g,S=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var V={},R=/^[^:]+:\/*[^/]*$/,K=/^([^:]+:)[\s\S]*$/,ce=/^([^:]+:\/*[^/]*)[\s\S]*$/;function D(rt,lt){V[" "+rt]||(V[" "+rt]=R.test(rt)?rt+"/":$(rt,"/",!0));var ht=-1===(rt=V[" "+rt]).indexOf(":");return"//"===lt.substring(0,2)?ht?lt:rt.replace(K,"$1")+lt:"/"===lt.charAt(0)?ht?lt:rt.replace(ce,"$1")+lt:rt+lt}function $(rt,lt,ht){var me=rt.length;if(0===me)return"";for(var be=0;be<me;){var ke=rt.charAt(me-be-1);if(ke!==lt||ht){if(ke===lt||!ht)break;be++}else be++}return rt.substr(0,me-be)}var te_escape=function(rt,lt){if(lt){if(he.test(rt))return rt.replace(W,z)}else if(j.test(rt))return rt.replace(P,z);return rt},te_unescape=O,te_edit=function(rt,lt){rt=rt.source||rt,lt=lt||"";var ht={replace:function(be,ke){return ke=(ke=ke.source||ke).replace(A,"$1"),rt=rt.replace(be,ke),ht},getRegex:function(){return new RegExp(rt,lt)}};return ht},te_cleanUrl=function(rt,lt,ht){if(rt){var me;try{me=decodeURIComponent(O(ht)).replace(y,"").toLowerCase()}catch(be){return null}if(0===me.indexOf("javascript:")||0===me.indexOf("vbscript:")||0===me.indexOf("data:"))return null}lt&&!S.test(ht)&&(ht=D(lt,ht));try{ht=encodeURI(ht).replace(/%25/g,"%")}catch(be){return null}return ht},te_noopTest={exec:function(){}},te_merge=function(rt){for(var ht,me,lt=1;lt<arguments.length;lt++)for(me in ht=arguments[lt])Object.prototype.hasOwnProperty.call(ht,me)&&(rt[me]=ht[me]);return rt},te_checkSanitizeDeprecation=function(rt){rt&&rt.sanitize&&!rt.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},te_repeatString=function(rt,lt){if(lt<1)return"";for(var ht="";lt>1;)1&lt&&(ht+=rt),lt>>=1,rt+=rt;return ht+rt},xe=dt.exports.defaults,ge=$,ne=function(rt,lt){var me=rt.replace(/\|/g,function(ke,ut,Ze){for(var Ct=!1,Mt=ut;--Mt>=0&&"\\"===Ze[Mt];)Ct=!Ct;return Ct?"|":" |"}).split(/ \|/),be=0;if(me.length>lt)me.splice(lt);else for(;me.length<lt;)me.push("");for(;be<me.length;be++)me[be]=me[be].trim().replace(/\\\|/g,"|");return me},_e=te_escape,Ie=function(rt,lt){if(-1===rt.indexOf(lt[1]))return-1;for(var ht=rt.length,me=0,be=0;be<ht;be++)if("\\"===rt[be])be++;else if(rt[be]===lt[0])me++;else if(rt[be]===lt[1]&&--me<0)return be;return-1};function Ge(rt,lt,ht){var me=lt.href,be=lt.title?_e(lt.title):null,ke=rt[1].replace(/\\([\[\]])/g,"$1");return"!"!==rt[0].charAt(0)?{type:"link",raw:ht,href:me,title:be,text:ke}:{type:"image",raw:ht,href:me,title:be,text:_e(ke)}}var Xe=function(){function rt(ht){this.options=ht||xe}var lt=rt.prototype;return lt.space=function(me){var be=this.rules.block.newline.exec(me);if(be)return be[0].length>1?{type:"space",raw:be[0]}:{raw:"\n"}},lt.code=function(me){var be=this.rules.block.code.exec(me);if(be){var ke=be[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:be[0],codeBlockStyle:"indented",text:this.options.pedantic?ke:ge(ke,"\n")}}},lt.fences=function(me){var be=this.rules.block.fences.exec(me);if(be){var ke=be[0],ut=function(rt,lt){var ht=rt.match(/^(\s+)(?:```)/);if(null===ht)return lt;var me=ht[1];return lt.split("\n").map(function(be){var ke=be.match(/^\s+/);return null===ke?be:ke[0].length>=me.length?be.slice(me.length):be}).join("\n")}(ke,be[3]||"");return{type:"code",raw:ke,lang:be[2]?be[2].trim():be[2],text:ut}}},lt.heading=function(me){var be=this.rules.block.heading.exec(me);if(be){var ke=be[2].trim();if(/#$/.test(ke)){var ut=ge(ke,"#");(this.options.pedantic||!ut||/ $/.test(ut))&&(ke=ut.trim())}return{type:"heading",raw:be[0],depth:be[1].length,text:ke}}},lt.nptable=function(me){var be=this.rules.block.nptable.exec(me);if(be){var ke={type:"table",header:ne(be[1].replace(/^ *| *\| *$/g,"")),align:be[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:be[3]?be[3].replace(/\n$/,"").split("\n"):[],raw:be[0]};if(ke.header.length===ke.align.length){var Ze,ut=ke.align.length;for(Ze=0;Ze<ut;Ze++)ke.align[Ze]=/^ *-+: *$/.test(ke.align[Ze])?"right":/^ *:-+: *$/.test(ke.align[Ze])?"center":/^ *:-+ *$/.test(ke.align[Ze])?"left":null;for(ut=ke.cells.length,Ze=0;Ze<ut;Ze++)ke.cells[Ze]=ne(ke.cells[Ze],ke.header.length);return ke}}},lt.hr=function(me){var be=this.rules.block.hr.exec(me);if(be)return{type:"hr",raw:be[0]}},lt.blockquote=function(me){var be=this.rules.block.blockquote.exec(me);if(be){var ke=be[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:be[0],text:ke}}},lt.list=function(me){var be=this.rules.block.list.exec(me);if(be){var Yt,Un,ii,Rn,fn,Hn,En,nr,ir,ke=be[0],ut=be[2],Ze=ut.length>1,Ct={type:"list",raw:ke,ordered:Ze,start:Ze?+ut.slice(0,-1):"",loose:!1,items:[]},Mt=be[0].match(this.rules.block.item),Dt=!1,Yn=Mt.length;ii=this.rules.block.listItemStart.exec(Mt[0]);for(var Vi=0;Vi<Yn;Vi++){if(ke=Yt=Mt[Vi],this.options.pedantic||(ir=Yt.match(new RegExp("\\n\\s*\\n {0,"+(ii[0].length-1)+"}\\S")))&&(fn=Yt.length-ir.index+Mt.slice(Vi+1).join("\n").length,Ct.raw=Ct.raw.substring(0,Ct.raw.length-fn),ke=Yt=Yt.substring(0,ir.index),Yn=Vi+1),Vi!==Yn-1){if(Rn=this.rules.block.listItemStart.exec(Mt[Vi+1]),this.options.pedantic?Rn[1].length>ii[1].length:Rn[1].length>=ii[0].length||Rn[1].length>3){Mt.splice(Vi,2,Mt[Vi]+(!this.options.pedantic&&Rn[1].length<ii[0].length&&!Mt[Vi].match(/\n$/)?"":"\n")+Mt[Vi+1]),Vi--,Yn--;continue}(!this.options.pedantic||this.options.smartLists?Rn[2][Rn[2].length-1]!==ut[ut.length-1]:Ze===(1===Rn[2].length))&&(fn=Mt.slice(Vi+1).join("\n").length,Ct.raw=Ct.raw.substring(0,Ct.raw.length-fn),Vi=Yn-1),ii=Rn}Un=Yt.length,~(Yt=Yt.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(Un-=Yt.length,Yt=Yt.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+Un+"}","gm"),"")),Yt=ge(Yt,"\n"),Vi!==Yn-1&&(ke+="\n"),Hn=Dt||/\n\n(?!\s*$)/.test(ke),Vi!==Yn-1&&(Dt="\n\n"===ke.slice(-2),Hn||(Hn=Dt)),Hn&&(Ct.loose=!0),this.options.gfm&&(nr=void 0,(En=/^\[[ xX]\] /.test(Yt))&&(nr=" "!==Yt[1],Yt=Yt.replace(/^\[[ xX]\] +/,""))),Ct.items.push({type:"list_item",raw:ke,task:En,checked:nr,loose:Hn,text:Yt})}return Ct}},lt.html=function(me){var be=this.rules.block.html.exec(me);if(be)return{type:this.options.sanitize?"paragraph":"html",raw:be[0],pre:!this.options.sanitizer&&("pre"===be[1]||"script"===be[1]||"style"===be[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(be[0]):_e(be[0]):be[0]}},lt.def=function(me){var be=this.rules.block.def.exec(me);if(be)return be[3]&&(be[3]=be[3].substring(1,be[3].length-1)),{type:"def",tag:be[1].toLowerCase().replace(/\s+/g," "),raw:be[0],href:be[2],title:be[3]}},lt.table=function(me){var be=this.rules.block.table.exec(me);if(be){var ke={type:"table",header:ne(be[1].replace(/^ *| *\| *$/g,"")),align:be[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:be[3]?be[3].replace(/\n$/,"").split("\n"):[]};if(ke.header.length===ke.align.length){ke.raw=be[0];var Ze,ut=ke.align.length;for(Ze=0;Ze<ut;Ze++)ke.align[Ze]=/^ *-+: *$/.test(ke.align[Ze])?"right":/^ *:-+: *$/.test(ke.align[Ze])?"center":/^ *:-+ *$/.test(ke.align[Ze])?"left":null;for(ut=ke.cells.length,Ze=0;Ze<ut;Ze++)ke.cells[Ze]=ne(ke.cells[Ze].replace(/^ *\| *| *\| *$/g,""),ke.header.length);return ke}}},lt.lheading=function(me){var be=this.rules.block.lheading.exec(me);if(be)return{type:"heading",raw:be[0],depth:"="===be[2].charAt(0)?1:2,text:be[1]}},lt.paragraph=function(me){var be=this.rules.block.paragraph.exec(me);if(be)return{type:"paragraph",raw:be[0],text:"\n"===be[1].charAt(be[1].length-1)?be[1].slice(0,-1):be[1]}},lt.text=function(me){var be=this.rules.block.text.exec(me);if(be)return{type:"text",raw:be[0],text:be[0]}},lt.escape=function(me){var be=this.rules.inline.escape.exec(me);if(be)return{type:"escape",raw:be[0],text:_e(be[1])}},lt.tag=function(me,be,ke){var ut=this.rules.inline.tag.exec(me);if(ut)return!be&&/^<a /i.test(ut[0])?be=!0:be&&/^<\/a>/i.test(ut[0])&&(be=!1),!ke&&/^<(pre|code|kbd|script)(\s|>)/i.test(ut[0])?ke=!0:ke&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ut[0])&&(ke=!1),{type:this.options.sanitize?"text":"html",raw:ut[0],inLink:be,inRawBlock:ke,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ut[0]):_e(ut[0]):ut[0]}},lt.link=function(me){var be=this.rules.inline.link.exec(me);if(be){var ke=be[2].trim();if(!this.options.pedantic&&/^</.test(ke)){if(!/>$/.test(ke))return;var ut=ge(ke.slice(0,-1),"\\");if((ke.length-ut.length)%2==0)return}else{var Ze=Ie(be[2],"()");if(Ze>-1){var Mt=(0===be[0].indexOf("!")?5:4)+be[1].length+Ze;be[2]=be[2].substring(0,Ze),be[0]=be[0].substring(0,Mt).trim(),be[3]=""}}var Dt=be[2],Yt="";if(this.options.pedantic){var Un=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Dt);Un&&(Dt=Un[1],Yt=Un[3])}else Yt=be[3]?be[3].slice(1,-1):"";return Dt=Dt.trim(),/^</.test(Dt)&&(Dt=this.options.pedantic&&!/>$/.test(ke)?Dt.slice(1):Dt.slice(1,-1)),Ge(be,{href:Dt&&Dt.replace(this.rules.inline._escapes,"$1"),title:Yt&&Yt.replace(this.rules.inline._escapes,"$1")},be[0])}},lt.reflink=function(me,be){var ke;if((ke=this.rules.inline.reflink.exec(me))||(ke=this.rules.inline.nolink.exec(me))){var ut=(ke[2]||ke[1]).replace(/\s+/g," ");if(!(ut=be[ut.toLowerCase()])||!ut.href){var Ze=ke[0].charAt(0);return{type:"text",raw:Ze,text:Ze}}return Ge(ke,ut,ke[0])}},lt.emStrong=function(me,be,ke){void 0===ke&&(ke="");var ut=this.rules.inline.emStrong.lDelim.exec(me);if(ut&&(!ut[3]||!ke.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Ze=ut[1]||ut[2]||"";if(!Ze||Ze&&(""===ke||this.rules.inline.punctuation.exec(ke))){var Mt,Dt,Ct=ut[0].length-1,Yt=Ct,Un=0,ii="*"===ut[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ii.lastIndex=0,be=be.slice(-1*me.length+Ct);null!=(ut=ii.exec(be));)if(Mt=ut[1]||ut[2]||ut[3]||ut[4]||ut[5]||ut[6]){if(Dt=Mt.length,ut[3]||ut[4]){Yt+=Dt;continue}if((ut[5]||ut[6])&&Ct%3&&!((Ct+Dt)%3)){Un+=Dt;continue}if(!((Yt-=Dt)>0))return Dt=Math.min(Dt,Dt+Yt+Un),Math.min(Ct,Dt)%2?{type:"em",raw:me.slice(0,Ct+ut.index+Dt+1),text:me.slice(1,Ct+ut.index+Dt)}:{type:"strong",raw:me.slice(0,Ct+ut.index+Dt+1),text:me.slice(2,Ct+ut.index+Dt-1)}}}}},lt.codespan=function(me){var be=this.rules.inline.code.exec(me);if(be){var ke=be[2].replace(/\n/g," "),ut=/[^ ]/.test(ke),Ze=/^ /.test(ke)&&/ $/.test(ke);return ut&&Ze&&(ke=ke.substring(1,ke.length-1)),ke=_e(ke,!0),{type:"codespan",raw:be[0],text:ke}}},lt.br=function(me){var be=this.rules.inline.br.exec(me);if(be)return{type:"br",raw:be[0]}},lt.del=function(me){var be=this.rules.inline.del.exec(me);if(be)return{type:"del",raw:be[0],text:be[2]}},lt.autolink=function(me,be){var ut,Ze,ke=this.rules.inline.autolink.exec(me);if(ke)return Ze="@"===ke[2]?"mailto:"+(ut=_e(this.options.mangle?be(ke[1]):ke[1])):ut=_e(ke[1]),{type:"link",raw:ke[0],text:ut,href:Ze,tokens:[{type:"text",raw:ut,text:ut}]}},lt.url=function(me,be){var ke;if(ke=this.rules.inline.url.exec(me)){var ut,Ze;if("@"===ke[2])Ze="mailto:"+(ut=_e(this.options.mangle?be(ke[0]):ke[0]));else{var Ct;do{Ct=ke[0],ke[0]=this.rules.inline._backpedal.exec(ke[0])[0]}while(Ct!==ke[0]);ut=_e(ke[0]),Ze="www."===ke[1]?"http://"+ut:ut}return{type:"link",raw:ke[0],text:ut,href:Ze,tokens:[{type:"text",raw:ut,text:ut}]}}},lt.inlineText=function(me,be,ke){var Ze,ut=this.rules.inline.text.exec(me);if(ut)return Ze=be?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ut[0]):_e(ut[0]):ut[0]:_e(this.options.smartypants?ke(ut[0]):ut[0]),{type:"text",raw:ut[0],text:Ze}},rt}(),tt=te_noopTest,Ye=te_edit,Ue=te_merge,Le={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:tt,table:tt,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Le.def=Ye(Le.def).replace("label",Le._label).replace("title",Le._title).getRegex(),Le.bullet=/(?:[*+-]|\d{1,9}[.)])/,Le.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,Le.item=Ye(Le.item,"gm").replace(/bull/g,Le.bullet).getRegex(),Le.listItemStart=Ye(/^( *)(bull) */).replace("bull",Le.bullet).getRegex(),Le.list=Ye(Le.list).replace(/bull/g,Le.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Le.def.source+")").getRegex(),Le._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Le._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Le.html=Ye(Le.html,"i").replace("comment",Le._comment).replace("tag",Le._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Le.paragraph=Ye(Le._paragraph).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.blockquote=Ye(Le.blockquote).replace("paragraph",Le.paragraph).getRegex(),Le.normal=Ue({},Le),Le.gfm=Ue({},Le.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Le.gfm.nptable=Ye(Le.gfm.nptable).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.gfm.table=Ye(Le.gfm.table).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.pedantic=Ue({},Le.normal,{html:Ye("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Le._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:tt,paragraph:Ye(Le.normal._paragraph).replace("hr",Le.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Le.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Ke={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:tt,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:tt,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Ke.punctuation=Ye(Ke.punctuation).replace(/punctuation/g,Ke._punctuation).getRegex(),Ke.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Ke.escapedEmSt=/\\\*|\\_/g,Ke._comment=Ye(Le._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ke.emStrong.lDelim=Ye(Ke.emStrong.lDelim).replace(/punct/g,Ke._punctuation).getRegex(),Ke.emStrong.rDelimAst=Ye(Ke.emStrong.rDelimAst,"g").replace(/punct/g,Ke._punctuation).getRegex(),Ke.emStrong.rDelimUnd=Ye(Ke.emStrong.rDelimUnd,"g").replace(/punct/g,Ke._punctuation).getRegex(),Ke._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Ke._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Ke._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Ke.autolink=Ye(Ke.autolink).replace("scheme",Ke._scheme).replace("email",Ke._email).getRegex(),Ke._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Ke.tag=Ye(Ke.tag).replace("comment",Ke._comment).replace("attribute",Ke._attribute).getRegex(),Ke._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ke._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Ke._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Ke.link=Ye(Ke.link).replace("label",Ke._label).replace("href",Ke._href).replace("title",Ke._title).getRegex(),Ke.reflink=Ye(Ke.reflink).replace("label",Ke._label).getRegex(),Ke.reflinkSearch=Ye(Ke.reflinkSearch,"g").replace("reflink",Ke.reflink).replace("nolink",Ke.nolink).getRegex(),Ke.normal=Ue({},Ke),Ke.pedantic=Ue({},Ke.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ye(/^!?\[(label)\]\((.*?)\)/).replace("label",Ke._label).getRegex(),reflink:Ye(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ke._label).getRegex()}),Ke.gfm=Ue({},Ke.normal,{escape:Ye(Ke.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Ke.gfm.url=Ye(Ke.gfm.url,"i").replace("email",Ke.gfm._extended_email).getRegex(),Ke.breaks=Ue({},Ke.gfm,{br:Ye(Ke.br).replace("{2,}","*").getRegex(),text:Ye(Ke.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Te={block:Le,inline:Ke},Ve=Xe,$e=dt.exports.defaults,Ne=Te.block,q=Te.inline,G=te_repeatString;function pe(rt){return rt.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function ue(rt){var ht,me,lt="",be=rt.length;for(ht=0;ht<be;ht++)me=rt.charCodeAt(ht),Math.random()>.5&&(me="x"+me.toString(16)),lt+="&#"+me+";";return lt}var je=function(){function rt(ht){this.tokens=[],this.tokens.links=Object.create(null),this.options=ht||$e,this.options.tokenizer=this.options.tokenizer||new Ve,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var me={block:Ne.normal,inline:q.normal};this.options.pedantic?(me.block=Ne.pedantic,me.inline=q.pedantic):this.options.gfm&&(me.block=Ne.gfm,me.inline=this.options.breaks?q.breaks:q.gfm),this.tokenizer.rules=me}rt.lex=function(me,be){return new rt(be).lex(me)},rt.lexInline=function(me,be){return new rt(be).inlineTokens(me)};var lt=rt.prototype;return lt.lex=function(me){return me=me.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(me,this.tokens,!0),this.inline(this.tokens),this.tokens},lt.blockTokens=function(me,be,ke){var Ze,Ct,Mt,Dt,Yt,Un,ut=this;for(void 0===be&&(be=[]),void 0===ke&&(ke=!0),this.options.pedantic&&(me=me.replace(/^ +$/gm,""));me;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(Rn){return!!(Ze=Rn.call(ut,me,be))&&(me=me.substring(Ze.raw.length),be.push(Ze),!0)}))){if(Ze=this.tokenizer.space(me)){me=me.substring(Ze.raw.length),Ze.type&&be.push(Ze);continue}if(Ze=this.tokenizer.code(me)){me=me.substring(Ze.raw.length),(Dt=be[be.length-1])&&"paragraph"===Dt.type?(Dt.raw+="\n"+Ze.raw,Dt.text+="\n"+Ze.text):be.push(Ze);continue}if(Ze=this.tokenizer.fences(me)){me=me.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.heading(me)){me=me.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.nptable(me)){me=me.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.hr(me)){me=me.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.blockquote(me)){me=me.substring(Ze.raw.length),Ze.tokens=this.blockTokens(Ze.text,[],ke),be.push(Ze);continue}if(Ze=this.tokenizer.list(me)){for(me=me.substring(Ze.raw.length),Mt=Ze.items.length,Ct=0;Ct<Mt;Ct++)Ze.items[Ct].tokens=this.blockTokens(Ze.items[Ct].text,[],!1);be.push(Ze);continue}if(Ze=this.tokenizer.html(me)){me=me.substring(Ze.raw.length),be.push(Ze);continue}if(ke&&(Ze=this.tokenizer.def(me))){me=me.substring(Ze.raw.length),this.tokens.links[Ze.tag]||(this.tokens.links[Ze.tag]={href:Ze.href,title:Ze.title});continue}if(Ze=this.tokenizer.table(me)){me=me.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.lheading(me)){me=me.substring(Ze.raw.length),be.push(Ze);continue}if(Yt=me,this.options.extensions&&this.options.extensions.startBlock&&function(){var Rn=1/0,fn=me.slice(1),Hn=void 0;ut.options.extensions.startBlock.forEach(function(En){"number"==typeof(Hn=En.call(this,fn))&&Hn>=0&&(Rn=Math.min(Rn,Hn))}),Rn<1/0&&Rn>=0&&(Yt=me.substring(0,Rn+1))}(),ke&&(Ze=this.tokenizer.paragraph(Yt))){Dt=be[be.length-1],Un&&"paragraph"===Dt.type?(Dt.raw+="\n"+Ze.raw,Dt.text+="\n"+Ze.text):be.push(Ze),Un=Yt.length!==me.length,me=me.substring(Ze.raw.length);continue}if(Ze=this.tokenizer.text(me)){me=me.substring(Ze.raw.length),(Dt=be[be.length-1])&&"text"===Dt.type?(Dt.raw+="\n"+Ze.raw,Dt.text+="\n"+Ze.text):be.push(Ze);continue}if(me){var ii="Infinite loop on byte: "+me.charCodeAt(0);if(this.options.silent){console.error(ii);break}throw new Error(ii)}}return be},lt.inline=function(me){var be,ke,ut,Ze,Ct,Mt,Dt=me.length;for(be=0;be<Dt;be++)switch(Mt=me[be],Mt.type){case"paragraph":case"text":case"heading":Mt.tokens=[],this.inlineTokens(Mt.text,Mt.tokens);break;case"table":for(Mt.tokens={header:[],cells:[]},Ze=Mt.header.length,ke=0;ke<Ze;ke++)Mt.tokens.header[ke]=[],this.inlineTokens(Mt.header[ke],Mt.tokens.header[ke]);for(Ze=Mt.cells.length,ke=0;ke<Ze;ke++)for(Ct=Mt.cells[ke],Mt.tokens.cells[ke]=[],ut=0;ut<Ct.length;ut++)Mt.tokens.cells[ke][ut]=[],this.inlineTokens(Ct[ut],Mt.tokens.cells[ke][ut]);break;case"blockquote":this.inline(Mt.tokens);break;case"list":for(Ze=Mt.items.length,ke=0;ke<Ze;ke++)this.inline(Mt.items[ke].tokens)}return me},lt.inlineTokens=function(me,be,ke,ut){var Ze=this;void 0===be&&(be=[]),void 0===ke&&(ke=!1),void 0===ut&&(ut=!1);var Ct,Mt,Dt,Un,ii,Rn,Yt=me;if(this.tokens.links){var fn=Object.keys(this.tokens.links);if(fn.length>0)for(;null!=(Un=this.tokenizer.rules.inline.reflinkSearch.exec(Yt));)fn.includes(Un[0].slice(Un[0].lastIndexOf("[")+1,-1))&&(Yt=Yt.slice(0,Un.index)+"["+G("a",Un[0].length-2)+"]"+Yt.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(Un=this.tokenizer.rules.inline.blockSkip.exec(Yt));)Yt=Yt.slice(0,Un.index)+"["+G("a",Un[0].length-2)+"]"+Yt.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(Un=this.tokenizer.rules.inline.escapedEmSt.exec(Yt));)Yt=Yt.slice(0,Un.index)+"++"+Yt.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;me;)if(ii||(Rn=""),ii=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(En){return!!(Ct=En.call(Ze,me,be))&&(me=me.substring(Ct.raw.length),be.push(Ct),!0)}))){if(Ct=this.tokenizer.escape(me)){me=me.substring(Ct.raw.length),be.push(Ct);continue}if(Ct=this.tokenizer.tag(me,ke,ut)){me=me.substring(Ct.raw.length),ke=Ct.inLink,ut=Ct.inRawBlock,(Mt=be[be.length-1])&&"text"===Ct.type&&"text"===Mt.type?(Mt.raw+=Ct.raw,Mt.text+=Ct.text):be.push(Ct);continue}if(Ct=this.tokenizer.link(me)){me=me.substring(Ct.raw.length),"link"===Ct.type&&(Ct.tokens=this.inlineTokens(Ct.text,[],!0,ut)),be.push(Ct);continue}if(Ct=this.tokenizer.reflink(me,this.tokens.links)){me=me.substring(Ct.raw.length),Mt=be[be.length-1],"link"===Ct.type?(Ct.tokens=this.inlineTokens(Ct.text,[],!0,ut),be.push(Ct)):Mt&&"text"===Ct.type&&"text"===Mt.type?(Mt.raw+=Ct.raw,Mt.text+=Ct.text):be.push(Ct);continue}if(Ct=this.tokenizer.emStrong(me,Yt,Rn)){me=me.substring(Ct.raw.length),Ct.tokens=this.inlineTokens(Ct.text,[],ke,ut),be.push(Ct);continue}if(Ct=this.tokenizer.codespan(me)){me=me.substring(Ct.raw.length),be.push(Ct);continue}if(Ct=this.tokenizer.br(me)){me=me.substring(Ct.raw.length),be.push(Ct);continue}if(Ct=this.tokenizer.del(me)){me=me.substring(Ct.raw.length),Ct.tokens=this.inlineTokens(Ct.text,[],ke,ut),be.push(Ct);continue}if(Ct=this.tokenizer.autolink(me,ue)){me=me.substring(Ct.raw.length),be.push(Ct);continue}if(!ke&&(Ct=this.tokenizer.url(me,ue))){me=me.substring(Ct.raw.length),be.push(Ct);continue}if(Dt=me,this.options.extensions&&this.options.extensions.startInline&&function(){var En=1/0,nr=me.slice(1),ir=void 0;Ze.options.extensions.startInline.forEach(function(Yn){"number"==typeof(ir=Yn.call(this,nr))&&ir>=0&&(En=Math.min(En,ir))}),En<1/0&&En>=0&&(Dt=me.substring(0,En+1))}(),Ct=this.tokenizer.inlineText(Dt,ut,pe)){me=me.substring(Ct.raw.length),"_"!==Ct.raw.slice(-1)&&(Rn=Ct.raw.slice(-1)),ii=!0,(Mt=be[be.length-1])&&"text"===Mt.type?(Mt.raw+=Ct.raw,Mt.text+=Ct.text):be.push(Ct);continue}if(me){var Hn="Infinite loop on byte: "+me.charCodeAt(0);if(this.options.silent){console.error(Hn);break}throw new Error(Hn)}}return be},function(rt,lt,ht){lt&&it(rt.prototype,lt),ht&&it(rt,ht)}(rt,null,[{key:"rules",get:function(){return{block:Ne,inline:q}}}]),rt}(),_t=dt.exports.defaults,pt=te_cleanUrl,ve=te_escape,k=function(){function rt(ht){this.options=ht||_t}var lt=rt.prototype;return lt.code=function(me,be,ke){var ut=(be||"").match(/\S*/)[0];if(this.options.highlight){var Ze=this.options.highlight(me,ut);null!=Ze&&Ze!==me&&(ke=!0,me=Ze)}return me=me.replace(/\n$/,"")+"\n",ut?'<pre><code class="'+this.options.langPrefix+ve(ut,!0)+'">'+(ke?me:ve(me,!0))+"</code></pre>\n":"<pre><code>"+(ke?me:ve(me,!0))+"</code></pre>\n"},lt.blockquote=function(me){return"<blockquote>\n"+me+"</blockquote>\n"},lt.html=function(me){return me},lt.heading=function(me,be,ke,ut){return this.options.headerIds?"<h"+be+' id="'+this.options.headerPrefix+ut.slug(ke)+'">'+me+"</h"+be+">\n":"<h"+be+">"+me+"</h"+be+">\n"},lt.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},lt.list=function(me,be,ke){var ut=be?"ol":"ul";return"<"+ut+(be&&1!==ke?' start="'+ke+'"':"")+">\n"+me+"</"+ut+">\n"},lt.listitem=function(me){return"<li>"+me+"</li>\n"},lt.checkbox=function(me){return"<input "+(me?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},lt.paragraph=function(me){return"<p>"+me+"</p>\n"},lt.table=function(me,be){return be&&(be="<tbody>"+be+"</tbody>"),"<table>\n<thead>\n"+me+"</thead>\n"+be+"</table>\n"},lt.tablerow=function(me){return"<tr>\n"+me+"</tr>\n"},lt.tablecell=function(me,be){var ke=be.header?"th":"td";return(be.align?"<"+ke+' align="'+be.align+'">':"<"+ke+">")+me+"</"+ke+">\n"},lt.strong=function(me){return"<strong>"+me+"</strong>"},lt.em=function(me){return"<em>"+me+"</em>"},lt.codespan=function(me){return"<code>"+me+"</code>"},lt.br=function(){return this.options.xhtml?"<br/>":"<br>"},lt.del=function(me){return"<del>"+me+"</del>"},lt.link=function(me,be,ke){if(null===(me=pt(this.options.sanitize,this.options.baseUrl,me)))return ke;var ut='<a href="'+ve(me)+'"';return be&&(ut+=' title="'+be+'"'),ut+">"+ke+"</a>"},lt.image=function(me,be,ke){if(null===(me=pt(this.options.sanitize,this.options.baseUrl,me)))return ke;var ut='<img src="'+me+'" alt="'+ke+'"';return be&&(ut+=' title="'+be+'"'),ut+(this.options.xhtml?"/>":">")},lt.text=function(me){return me},rt}(),N=function(){function rt(){}var lt=rt.prototype;return lt.strong=function(me){return me},lt.em=function(me){return me},lt.codespan=function(me){return me},lt.del=function(me){return me},lt.html=function(me){return me},lt.text=function(me){return me},lt.link=function(me,be,ke){return""+ke},lt.image=function(me,be,ke){return""+ke},lt.br=function(){return""},rt}(),B=function(){function rt(){this.seen={}}var lt=rt.prototype;return lt.serialize=function(me){return me.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},lt.getNextSafeSlug=function(me,be){var ke=me,ut=0;if(this.seen.hasOwnProperty(ke)){ut=this.seen[me];do{ke=me+"-"+ ++ut}while(this.seen.hasOwnProperty(ke))}return be||(this.seen[me]=ut,this.seen[ke]=0),ke},lt.slug=function(me,be){void 0===be&&(be={});var ke=this.serialize(me);return this.getNextSafeSlug(ke,be.dryrun)},rt}(),Re=k,Qe=N,St=B,Rt=dt.exports.defaults,In=te_unescape,Wn=je,wi=function(){function rt(ht){this.options=ht||Rt,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Qe,this.slugger=new St}rt.parse=function(me,be){return new rt(be).parse(me)},rt.parseInline=function(me,be){return new rt(be).parseInline(me)};var lt=rt.prototype;return lt.parse=function(me,be){void 0===be&&(be=!0);var ut,Ze,Ct,Mt,Dt,Yt,Un,ii,Rn,fn,Hn,En,nr,ir,Yn,Vi,ma,Wr,ie,ke="",fe=me.length;for(ut=0;ut<fe;ut++)if(fn=me[ut],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[fn.type]&&(!1!==(ie=this.options.extensions.renderers[fn.type].call(this,fn))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(fn.type)))ke+=ie||"";else switch(fn.type){case"space":continue;case"hr":ke+=this.renderer.hr();continue;case"heading":ke+=this.renderer.heading(this.parseInline(fn.tokens),fn.depth,In(this.parseInline(fn.tokens,this.textRenderer)),this.slugger);continue;case"code":ke+=this.renderer.code(fn.text,fn.lang,fn.escaped);continue;case"table":for(ii="",Un="",Mt=fn.header.length,Ze=0;Ze<Mt;Ze++)Un+=this.renderer.tablecell(this.parseInline(fn.tokens.header[Ze]),{header:!0,align:fn.align[Ze]});for(ii+=this.renderer.tablerow(Un),Rn="",Mt=fn.cells.length,Ze=0;Ze<Mt;Ze++){for(Un="",Dt=(Yt=fn.tokens.cells[Ze]).length,Ct=0;Ct<Dt;Ct++)Un+=this.renderer.tablecell(this.parseInline(Yt[Ct]),{header:!1,align:fn.align[Ct]});Rn+=this.renderer.tablerow(Un)}ke+=this.renderer.table(ii,Rn);continue;case"blockquote":Rn=this.parse(fn.tokens),ke+=this.renderer.blockquote(Rn);continue;case"list":for(Hn=fn.ordered,En=fn.start,nr=fn.loose,Mt=fn.items.length,Rn="",Ze=0;Ze<Mt;Ze++)Vi=(Yn=fn.items[Ze]).checked,ma=Yn.task,ir="",Yn.task&&(Wr=this.renderer.checkbox(Vi),nr?Yn.tokens.length>0&&"text"===Yn.tokens[0].type?(Yn.tokens[0].text=Wr+" "+Yn.tokens[0].text,Yn.tokens[0].tokens&&Yn.tokens[0].tokens.length>0&&"text"===Yn.tokens[0].tokens[0].type&&(Yn.tokens[0].tokens[0].text=Wr+" "+Yn.tokens[0].tokens[0].text)):Yn.tokens.unshift({type:"text",text:Wr}):ir+=Wr),ir+=this.parse(Yn.tokens,nr),Rn+=this.renderer.listitem(ir,ma,Vi);ke+=this.renderer.list(Rn,Hn,En);continue;case"html":ke+=this.renderer.html(fn.text);continue;case"paragraph":ke+=this.renderer.paragraph(this.parseInline(fn.tokens));continue;case"text":for(Rn=fn.tokens?this.parseInline(fn.tokens):fn.text;ut+1<fe&&"text"===me[ut+1].type;)Rn+="\n"+((fn=me[++ut]).tokens?this.parseInline(fn.tokens):fn.text);ke+=be?this.renderer.paragraph(Rn):Rn;continue;default:var re='Token with "'+fn.type+'" type was not found.';if(this.options.silent)return void console.error(re);throw new Error(re)}return ke},lt.parseInline=function(me,be){be=be||this.renderer;var ut,Ze,Ct,ke="",Mt=me.length;for(ut=0;ut<Mt;ut++)if(Ze=me[ut],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Ze.type]&&(!1!==(Ct=this.options.extensions.renderers[Ze.type].call(this,Ze))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Ze.type)))ke+=Ct||"";else switch(Ze.type){case"escape":ke+=be.text(Ze.text);break;case"html":ke+=be.html(Ze.text);break;case"link":ke+=be.link(Ze.href,Ze.title,this.parseInline(Ze.tokens,be));break;case"image":ke+=be.image(Ze.href,Ze.title,Ze.text);break;case"strong":ke+=be.strong(this.parseInline(Ze.tokens,be));break;case"em":ke+=be.em(this.parseInline(Ze.tokens,be));break;case"codespan":ke+=be.codespan(Ze.text);break;case"br":ke+=be.br();break;case"del":ke+=be.del(this.parseInline(Ze.tokens,be));break;case"text":ke+=be.text(Ze.text);break;default:var Dt='Token with "'+Ze.type+'" type was not found.';if(this.options.silent)return void console.error(Dt);throw new Error(Dt)}return ke},rt}(),gi=Xe,Gr=k,Ns=N,us=B,Ps=te_merge,$r=te_checkSanitizeDeprecation,Xa=te_escape,Dl=dt.exports.getDefaults,ga=dt.exports.changeDefaults,_s=dt.exports.defaults;function Zt(rt,lt,ht){if(null==rt)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");if("function"==typeof lt&&(ht=lt,lt=null),lt=Ps({},Zt.defaults,lt||{}),$r(lt),ht){var be,me=lt.highlight;try{be=Wn.lex(rt,lt)}catch(Ct){return ht(Ct)}var ke=function(Mt){var Dt;if(!Mt)try{lt.walkTokens&&Zt.walkTokens(be,lt.walkTokens),Dt=wi.parse(be,lt)}catch(Yt){Mt=Yt}return lt.highlight=me,Mt?ht(Mt):ht(null,Dt)};if(!me||me.length<3||(delete lt.highlight,!be.length))return ke();var ut=0;return Zt.walkTokens(be,function(Ct){"code"===Ct.type&&(ut++,setTimeout(function(){me(Ct.text,Ct.lang,function(Mt,Dt){if(Mt)return ke(Mt);null!=Dt&&Dt!==Ct.text&&(Ct.text=Dt,Ct.escaped=!0),0==--ut&&ke()})},0))}),void(0===ut&&ke())}try{var Ze=Wn.lex(rt,lt);return lt.walkTokens&&Zt.walkTokens(Ze,lt.walkTokens),wi.parse(Ze,lt)}catch(Ct){if(Ct.message+="\nPlease report this to https://github.com/markedjs/marked.",lt.silent)return"<p>An error occurred:</p><pre>"+Xa(Ct.message+"",!0)+"</pre>";throw Ct}}return Zt.options=Zt.setOptions=function(rt){return Ps(Zt.defaults,rt),ga(Zt.defaults),Zt},Zt.getDefaults=Dl,Zt.defaults=_s,Zt.use=function(){for(var rt=this,lt=arguments.length,ht=new Array(lt),me=0;me<lt;me++)ht[me]=arguments[me];var ut,be=Ps.apply(void 0,[{}].concat(ht)),ke=Zt.defaults.extensions||{renderers:{},childTokens:{}};ht.forEach(function(Ze){if(Ze.extensions&&(ut=!0,Ze.extensions.forEach(function(Mt){if(!Mt.name)throw new Error("extension name required");if(Mt.renderer){var Dt=ke.renderers?ke.renderers[Mt.name]:null;ke.renderers[Mt.name]=Dt?function(){for(var Yt=arguments.length,Un=new Array(Yt),ii=0;ii<Yt;ii++)Un[ii]=arguments[ii];var Rn=Mt.renderer.apply(this,Un);return!1===Rn&&(Rn=Dt.apply(this,Un)),Rn}:Mt.renderer}if(Mt.tokenizer){if(!Mt.level||"block"!==Mt.level&&"inline"!==Mt.level)throw new Error("extension level must be 'block' or 'inline'");ke[Mt.level]?ke[Mt.level].unshift(Mt.tokenizer):ke[Mt.level]=[Mt.tokenizer],Mt.start&&("block"===Mt.level?ke.startBlock?ke.startBlock.push(Mt.start):ke.startBlock=[Mt.start]:"inline"===Mt.level&&(ke.startInline?ke.startInline.push(Mt.start):ke.startInline=[Mt.start]))}Mt.childTokens&&(ke.childTokens[Mt.name]=Mt.childTokens)})),Ze.renderer&&function(){var Mt=Zt.defaults.renderer||new Gr,Dt=function(ii){var Rn=Mt[ii];Mt[ii]=function(){for(var fn=arguments.length,Hn=new Array(fn),En=0;En<fn;En++)Hn[En]=arguments[En];var nr=Ze.renderer[ii].apply(Mt,Hn);return!1===nr&&(nr=Rn.apply(Mt,Hn)),nr}};for(var Yt in Ze.renderer)Dt(Yt);be.renderer=Mt}(),Ze.tokenizer&&function(){var Mt=Zt.defaults.tokenizer||new gi,Dt=function(ii){var Rn=Mt[ii];Mt[ii]=function(){for(var fn=arguments.length,Hn=new Array(fn),En=0;En<fn;En++)Hn[En]=arguments[En];var nr=Ze.tokenizer[ii].apply(Mt,Hn);return!1===nr&&(nr=Rn.apply(Mt,Hn)),nr}};for(var Yt in Ze.tokenizer)Dt(Yt);be.tokenizer=Mt}(),Ze.walkTokens){var Ct=Zt.defaults.walkTokens;be.walkTokens=function(Mt){Ze.walkTokens.call(rt,Mt),Ct&&Ct(Mt)}}ut&&(be.extensions=ke),Zt.setOptions(be)})},Zt.walkTokens=function(rt,lt){for(var be,ht=function(){var ut=be.value;switch(lt(ut),ut.type){case"table":for(var Ct,Ze=At(ut.tokens.header);!(Ct=Ze()).done;)Zt.walkTokens(Ct.value,lt);for(var Yt,Dt=At(ut.tokens.cells);!(Yt=Dt()).done;)for(var Rn,ii=At(Yt.value);!(Rn=ii()).done;)Zt.walkTokens(Rn.value,lt);break;case"list":Zt.walkTokens(ut.items,lt);break;default:Zt.defaults.extensions&&Zt.defaults.extensions.childTokens&&Zt.defaults.extensions.childTokens[ut.type]?Zt.defaults.extensions.childTokens[ut.type].forEach(function(Hn){Zt.walkTokens(ut[Hn],lt)}):ut.tokens&&Zt.walkTokens(ut.tokens,lt)}},me=At(rt);!(be=me()).done;)ht()},Zt.parseInline=function(rt,lt){if(null==rt)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");lt=Ps({},Zt.defaults,lt||{}),$r(lt);try{var ht=Wn.lexInline(rt,lt);return lt.walkTokens&&Zt.walkTokens(ht,lt.walkTokens),wi.parseInline(ht,lt)}catch(me){if(me.message+="\nPlease report this to https://github.com/markedjs/marked.",lt.silent)return"<p>An error occurred:</p><pre>"+Xa(me.message+"",!0)+"</pre>";throw me}},Zt.Parser=wi,Zt.parser=wi.parse,Zt.Renderer=Gr,Zt.TextRenderer=Ns,Zt.Lexer=Wn,Zt.lexer=Wn.lex,Zt.Tokenizer=gi,Zt.Slugger=us,Zt.parse=Zt,Zt}()},369:(Bt,it,Je)=>{var yt=Je(284),ee=Je(830);function At(){this.clear()}At.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},At.prototype.enqueue=function(dt){return this.items.push(dt),++this.size},At.prototype.dequeue=function(){if(this.size){var dt=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,dt}},At.prototype.peek=function(){if(this.size)return this.items[this.offset]},At.prototype.forEach=function(dt,Y){Y=arguments.length>1?Y:this;for(var Se=this.offset,he=0,W=this.items.length;Se<W;Se++,he++)dt.call(Y,this.items[Se],he,this)},At.prototype.toArray=function(){return this.items.slice(this.offset)},At.prototype.values=function(){var dt=this.items,Y=this.offset;return new yt(function(){if(Y>=dt.length)return{done:!0};var Se=dt[Y];return Y++,{value:Se,done:!1}})},At.prototype.entries=function(){var dt=this.items,Y=this.offset,Se=0;return new yt(function(){if(Y>=dt.length)return{done:!0};var he=dt[Y];return Y++,{value:[Se++,he],done:!1}})},"undefined"!=typeof Symbol&&(At.prototype[Symbol.iterator]=At.prototype.values),At.prototype.toString=function(){return this.toArray().join(",")},At.prototype.toJSON=function(){return this.toArray()},At.prototype.inspect=function(){var dt=this.toArray();return Object.defineProperty(dt,"constructor",{value:At,enumerable:!1}),dt},"undefined"!=typeof Symbol&&(At.prototype[Symbol.for("nodejs.util.inspect.custom")]=At.prototype.inspect),At.from=function(dt){var Y=new At;return ee(dt,function(Se){Y.enqueue(Se)}),Y},At.of=function(){return At.from(arguments)},Bt.exports=At},830:Bt=>{var it="undefined"!=typeof ArrayBuffer,Je="undefined"!=typeof Symbol;function yt(ee,At){var dt,Y,Se,he,W;if(!ee)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof At)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(ee)||it&&ArrayBuffer.isView(ee)||"string"==typeof ee||"[object Arguments]"===ee.toString())for(Se=0,he=ee.length;Se<he;Se++)At(ee[Se],Se);else if("function"!=typeof ee.forEach)if(Je&&Symbol.iterator in ee&&"function"!=typeof ee.next&&(ee=ee[Symbol.iterator]()),"function"!=typeof ee.next)for(Y in ee)ee.hasOwnProperty(Y)&&At(ee[Y],Y);else for(dt=ee,Se=0;!0!==(W=dt.next()).done;)At(W.value,Se),Se++;else ee.forEach(At)}yt.forEachWithNullKeys=function(ee,At){var dt,Y,Se,he,W;if(!ee)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof At)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(ee)||it&&ArrayBuffer.isView(ee)||"string"==typeof ee||"[object Arguments]"===ee.toString())for(Se=0,he=ee.length;Se<he;Se++)At(ee[Se],null);else if(ee instanceof Set)ee.forEach(function(j){At(j,null)});else if("function"!=typeof ee.forEach)if(Je&&Symbol.iterator in ee&&"function"!=typeof ee.next&&(ee=ee[Symbol.iterator]()),"function"!=typeof ee.next)for(Y in ee)ee.hasOwnProperty(Y)&&At(ee[Y],Y);else for(dt=ee,Se=0;!0!==(W=dt.next()).done;)At(W.value,null),Se++;else ee.forEach(At)},Bt.exports=yt},284:Bt=>{function it(Je){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:Je}),this.done=!1}it.prototype.next=function(){if(this.done)return{done:!0};var Je=this._next();return Je.done&&(this.done=!0),Je},"undefined"!=typeof Symbol&&(it.prototype[Symbol.iterator]=function(){return this}),it.of=function(){var Je=arguments,yt=Je.length,ee=0;return new it(function(){return ee>=yt?{done:!0}:{done:!1,value:Je[ee++]}})},it.empty=function(){var Je=new it(null);return Je.done=!0,Je},it.is=function(Je){return Je instanceof it||"object"==typeof Je&&null!==Je&&"function"==typeof Je.next},Bt.exports=it},310:(Bt,it,Je)=>{"use strict";var yt=Je(948);Object.defineProperty(it,"__esModule",{value:!0}),it.isMobile=function(){return void 0!==ee.window.orientation},it.default=function(he){if(!he&&!(0,At.default)())return"Node";if((0,dt.default)(he))return"Electron";var W="undefined"!=typeof navigator?navigator:{},j=he||W.userAgent||"";if(j.indexOf("Edge")>-1)return"Edge";var P=-1!==j.indexOf("MSIE "),Q=-1!==j.indexOf("Trident/");return P||Q?"IE":ee.window.chrome?"Chrome":ee.window.safari?"Safari":ee.window.mozInnerScreenX?"Firefox":"Unknown"};var ee=Je(151),At=yt(Je(602)),dt=yt(Je(344))},151:(Bt,it,Je)=>{"use strict";var yt=Je(948);Object.defineProperty(it,"__esModule",{value:!0}),it.console=it.process=it.document=it.global=it.window=it.self=void 0;var ee=yt(Je(321)),At={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,ee.default)(process))&&process};it.self=At.self||At.window||At.global,it.window=At.window||At.self||At.global,it.global=At.global||At.self||At.window,it.document=At.document||{},it.process=At.process||{};var j=console;it.console=j},761:(Bt,it,Je)=>{"use strict";var ee=Je(948),At=Je(321);Object.defineProperty(it,"CO",{enumerable:!0,get:function(){return dt.global}}),Object.defineProperty(it,"qs",{enumerable:!0,get:function(){return Se.default}});var dt=Je(151),Se=(j(Je(602)),j(Je(310)));ee(Je(344));function W(P){if("function"!=typeof WeakMap)return null;var Q=new WeakMap,z=new WeakMap;return(W=function(x){return x?z:Q})(P)}function j(P,Q){if(!Q&&P&&P.__esModule)return P;if(null===P||"object"!==At(P)&&"function"!=typeof P)return{default:P};var z=W(Q);if(z&&z.has(P))return z.get(P);var v={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in P)if("default"!==O&&Object.prototype.hasOwnProperty.call(P,O)){var A=x?Object.getOwnPropertyDescriptor(P,O):null;A&&(A.get||A.set)?Object.defineProperty(v,O,A):v[O]=P[O]}return v.default=P,z&&z.set(P,v),v}},602:(Bt,it,Je)=>{"use strict";var yt=Je(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=dt,it.isBrowserMainThread=function(){return dt()&&"undefined"!=typeof document};var ee=yt(Je(321)),At=yt(Je(344));function dt(){return!("object"===("undefined"==typeof process?"undefined":(0,ee.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,At.default)()}},344:(Bt,it,Je)=>{"use strict";var yt=Je(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=function(dt){if("undefined"!=typeof window&&"object"===(0,ee.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,ee.default)(process.versions)&&Boolean(process.versions.electron))return!0;var Y="object"===("undefined"==typeof navigator?"undefined":(0,ee.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,Se=dt||Y;return!!(Se&&Se.indexOf("Electron")>=0)};var ee=yt(Je(321))},991:function(Bt,it,Je){"use strict";var yt=this&&this.__createBinding||(Object.create?function(At,dt,Y,Se){void 0===Se&&(Se=Y),Object.defineProperty(At,Se,{enumerable:!0,get:function(){return dt[Y]}})}:function(At,dt,Y,Se){void 0===Se&&(Se=Y),At[Se]=dt[Y]}),ee=this&&this.__exportStar||function(At,dt){for(var Y in At)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&yt(dt,At,Y)};Object.defineProperty(it,"__esModule",{value:!0}),ee(Je(180),it),ee(Je(103),it),ee(Je(965),it),ee(Je(595),it),ee(Je(417),it),ee(Je(451),it),ee(Je(735),it)},180:(Bt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.BlankNode=void 0,it.BlankNode=class{constructor(ee){this.termType="BlankNode",this.value=ee}equals(ee){return!!ee&&"BlankNode"===ee.termType&&ee.value===this.value}}},103:(Bt,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DataFactory=void 0;const yt=Je(180),ee=Je(965),At=Je(595),dt=Je(417),Y=Je(451),Se=Je(735);let he=0;it.DataFactory=class{constructor(P){this.blankNodeCounter=0,this.blankNodePrefix=(P=P||{}).blankNodePrefix||`df_${he++}_`}namedNode(P){return new dt.NamedNode(P)}blankNode(P){return new yt.BlankNode(P||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(P,Q){return new At.Literal(P,Q)}variable(P){return new Se.Variable(P)}defaultGraph(){return ee.DefaultGraph.INSTANCE}quad(P,Q,z,v){return new Y.Quad(P,Q,z,v||this.defaultGraph())}fromTerm(P){switch(P.termType){case"NamedNode":return this.namedNode(P.value);case"BlankNode":return this.blankNode(P.value);case"Literal":return P.language?this.literal(P.value,P.language):P.datatype.equals(At.Literal.XSD_STRING)?this.literal(P.value):this.literal(P.value,this.fromTerm(P.datatype));case"Variable":return this.variable(P.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(P.subject),this.fromTerm(P.predicate),this.fromTerm(P.object),this.fromTerm(P.graph))}}fromQuad(P){return this.fromTerm(P)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(Bt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DefaultGraph=void 0;class Je{constructor(){this.termType="DefaultGraph",this.value=""}equals(ee){return!!ee&&"DefaultGraph"===ee.termType}}it.DefaultGraph=Je,Je.INSTANCE=new Je},595:(Bt,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Literal=void 0;const yt=Je(417);class ee{constructor(dt,Y){this.termType="Literal",this.value=dt,"string"==typeof Y?(this.language=Y,this.datatype=ee.RDF_LANGUAGE_STRING):Y?(this.language="",this.datatype=Y):(this.language="",this.datatype=ee.XSD_STRING)}equals(dt){return!!dt&&"Literal"===dt.termType&&dt.value===this.value&&dt.language===this.language&&dt.datatype.equals(this.datatype)}}it.Literal=ee,ee.RDF_LANGUAGE_STRING=new yt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),ee.XSD_STRING=new yt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(Bt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.NamedNode=void 0,it.NamedNode=class{constructor(ee){this.termType="NamedNode",this.value=ee}equals(ee){return!!ee&&"NamedNode"===ee.termType&&ee.value===this.value}}},451:(Bt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Quad=void 0,it.Quad=class{constructor(ee,At,dt,Y){this.termType="Quad",this.value="",this.subject=ee,this.predicate=At,this.object=dt,this.graph=Y}equals(ee){return!!ee&&("Quad"===ee.termType||!ee.termType)&&this.subject.equals(ee.subject)&&this.predicate.equals(ee.predicate)&&this.object.equals(ee.object)&&this.graph.equals(ee.graph)}}},735:(Bt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Variable=void 0,it.Variable=class{constructor(ee){this.termType="Variable",this.value=ee}equals(ee){return!!ee&&"Variable"===ee.termType&&ee.value===this.value}}},609:function(Bt,it,Je){"use strict";var yt=this&&this.__createBinding||(Object.create?function(v,x,O,A){void 0===A&&(A=O),Object.defineProperty(v,A,{enumerable:!0,get:function(){return x[O]}})}:function(v,x,O,A){void 0===A&&(A=O),v[A]=x[O]}),ee=this&&this.__exportStar||function(v,x){for(var O in v)"default"!==O&&!Object.prototype.hasOwnProperty.call(x,O)&&yt(x,v,O)};Object.defineProperty(it,"__esModule",{value:!0}),it.getSupportedJavaScriptPrimitives=it.getSupportedRdfDatatypes=it.getTermRaw=it.toRdf=it.fromRdf=void 0;const At=Je(991),dt=Je(938),Y=Je(60);ee(Je(938),it),ee(Je(871),it),ee(Je(60),it);const Se=new At.DataFactory,he=new Y.Translator;function W(v,x){return he.fromRdf(v,x)}he.registerHandler(new dt.TypeHandlerString,dt.TypeHandlerString.TYPES.map(v=>Se.namedNode(v)),["string"]),he.registerHandler(new dt.TypeHandlerBoolean,[dt.TypeHandlerBoolean.TYPE].map(v=>Se.namedNode(v)),["boolean"]),he.registerHandler(new dt.TypeHandlerNumberDouble,dt.TypeHandlerNumberDouble.TYPES.map(v=>Se.namedNode(v)),["number"]),he.registerHandler(new dt.TypeHandlerNumberInteger,dt.TypeHandlerNumberInteger.TYPES.map(v=>Se.namedNode(v)),["number"]),he.registerHandler(new dt.TypeHandlerDate,dt.TypeHandlerDate.TYPES.map(v=>Se.namedNode(v)),["object"]),it.fromRdf=W,it.toRdf=function(v,x){return x&&"namedNode"in x&&(x={dataFactory:x}),(x=x||{})&&!x.dataFactory&&(x.dataFactory=Se),he.toRdf(v,x)},it.getTermRaw=function(v,x){return"Literal"===v.termType?W(v,x):v.value},it.getSupportedRdfDatatypes=function(){return he.getSupportedRdfDatatypes()},it.getSupportedJavaScriptPrimitives=function(){return he.getSupportedJavaScriptPrimitives()}},871:(Bt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0})},60:(Bt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Translator=void 0,it.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(ee){throw new Error(`Invalid RDF ${ee.datatype.value} value: '${ee.value}'`)}registerHandler(ee,At,dt){for(const Y of At)this.supportedRdfDatatypes.push(Y),this.fromRdfHandlers[Y.value]=ee;for(const Y of dt){let Se=this.toRdfHandlers[Y];Se||(this.toRdfHandlers[Y]=Se=[]),Se.push(ee)}}fromRdf(ee,At){const dt=this.fromRdfHandlers[ee.datatype.value];return dt?dt.fromRdf(ee,At):ee.value}toRdf(ee,At){const dt=this.toRdfHandlers[typeof ee];if(dt)for(const Y of dt){const Se=Y.toRdf(ee,At);if(Se)return Se}throw new Error(`Invalid JavaScript value: '${ee}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(Bt,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerBoolean=void 0;const yt=Je(60);class ee{fromRdf(dt,Y){switch(dt.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return Y&&yt.Translator.incorrectRdfDataType(dt),!1}toRdf(dt,{datatype:Y,dataFactory:Se}){return Se.literal(dt?"true":"false",Y||Se.namedNode(ee.TYPE))}}it.TypeHandlerBoolean=ee,ee.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},525:(Bt,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerDate=void 0;const yt=Je(60);class ee{fromRdf(dt,Y){switch(Y&&!dt.value.match(ee.VALIDATORS[dt.datatype.value.substr(33,dt.datatype.value.length)])&&yt.Translator.incorrectRdfDataType(dt),dt.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(dt.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const Se=dt.value.split("-");return new Date(0,parseInt(Se[0],10)-1,parseInt(Se[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(dt.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(dt.value+"-01");default:return new Date(dt.value)}}toRdf(dt,{datatype:Y,dataFactory:Se}){if(Y=Y||Se.namedNode(ee.TYPES[0]),!(dt instanceof Date))return null;const he=dt;let W;switch(Y.value){case"http://www.w3.org/2001/XMLSchema#gDay":W=String(he.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":W=he.getUTCMonth()+1+"-"+he.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":W=String(he.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":W=he.getUTCFullYear()+"-"+(he.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":W=he.toISOString().replace(/T.*$/,"");break;default:W=he.toISOString()}return Se.literal(W,Y)}}it.TypeHandlerDate=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],ee.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(Bt,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberDouble=void 0;const yt=Je(60);class ee{fromRdf(dt,Y){const Se=parseFloat(dt.value);return Y&&isNaN(Se)&&yt.Translator.incorrectRdfDataType(dt),Se}toRdf(dt,{datatype:Y,dataFactory:Se}){return Y=Y||Se.namedNode(ee.TYPES[0]),isNaN(dt)?Se.literal("NaN",Y):isFinite(dt)?dt%1==0?null:Se.literal(dt.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Y):Se.literal(dt>0?"INF":"-INF",Y)}}it.TypeHandlerNumberDouble=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(Bt,it,Je)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberInteger=void 0;const yt=Je(60);class ee{fromRdf(dt,Y){const Se=parseInt(dt.value,10);return Y&&(isNaN(Se)||dt.value.indexOf(".")>=0)&&yt.Translator.incorrectRdfDataType(dt),Se}toRdf(dt,{datatype:Y,dataFactory:Se}){return Se.literal(String(dt),Y||Se.namedNode(dt<=ee.MAX_INT&&dt>=ee.MIN_INT?ee.TYPES[0]:ee.TYPES[1]))}}it.TypeHandlerNumberInteger=ee,ee.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],ee.MAX_INT=2147483647,ee.MIN_INT=-2147483648},608:(Bt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerString=void 0;class Je{fromRdf(ee){return ee.value}toRdf(ee,{datatype:At,dataFactory:dt}){return dt.literal(ee,At)}}it.TypeHandlerString=Je,Je.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:function(Bt,it,Je){"use strict";var yt=this&&this.__createBinding||(Object.create?function(At,dt,Y,Se){void 0===Se&&(Se=Y),Object.defineProperty(At,Se,{enumerable:!0,get:function(){return dt[Y]}})}:function(At,dt,Y,Se){void 0===Se&&(Se=Y),At[Se]=dt[Y]}),ee=this&&this.__exportStar||function(At,dt){for(var Y in At)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&yt(dt,At,Y)};Object.defineProperty(it,"__esModule",{value:!0}),ee(Je(727),it),ee(Je(525),it),ee(Je(554),it),ee(Je(750),it),ee(Je(608),it)},630:(Bt,it,Je)=>{"use strict";var yt={};Je.r(yt),Je.d(yt,{decode:()=>sme,encode:()=>ome});var ee={};Je.r(ee),Je.d(ee,{decode:()=>dme,encode:()=>hme});var At={};Je.r(At),Je.d(At,{decode:()=>fme,encode:()=>pme});var dt={};function Y(n){return"function"==typeof n}Je.r(dt),Je.d(dt,{decode:()=>gme,encode:()=>mme});let Se=!1;const he={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Se&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Se=n},get useDeprecatedSynchronousErrorHandling(){return Se}};function W(n){setTimeout(()=>{throw n},0)}const j={closed:!0,next(n){},error(n){if(he.useDeprecatedSynchronousErrorHandling)throw n;W(n)},complete(){}},P=Array.isArray||(n=>n&&"number"==typeof n.length);function Q(n){return null!==n&&"object"==typeof n}const v=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class x{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof x)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(Y(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof v?O(o.errors):[o]}}if(P(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(Q(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof v?e=e.concat(O(c.errors)):e.push(c)}}}if(e)throw new v(e)}add(e){let t=e;if(!e)return x.EMPTY;switch(typeof e){case"function":t=new x(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof x)){const s=t;t=new x,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof x){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function O(n){return n.reduce((e,t)=>e.concat(t instanceof v?t.errors:t),[])}x.EMPTY=((n=new x).closed=!0,n);const A="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends x{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=j;break;case 1:if(!e){this.destination=j;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new S(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new S(this,e,t,i)}}[A](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class S extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;Y(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==j&&(o=Object.create(t),Y(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;he.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=he;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):W(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;W(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);he.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),he.useDeprecatedSynchronousErrorHandling)throw i;W(i)}}__tryOrSetError(e,t,i){if(!he.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return he.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(W(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const R="function"==typeof Symbol&&Symbol.observable||"@@observable";function K(n){return n}let I=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[A])return n[A]()}return n||e||t?new y(n,e,t):new y(j)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||he.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),he.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){he.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=X(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[R](){return this}pipe(...t){return 0===t.length?this:function(n){return 0===n.length?K:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=X(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function X(n){if(n||(n=he.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const $=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class Z extends x{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class se extends y{constructor(e){super(e),this.destination=e}}let oe=(()=>{class n extends I{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[A](){return new se(this)}lift(t){const i=new te(this,this);return i.operator=t,i}next(t){if(this.closed)throw new $;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new $;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new $;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new $;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new $;return this.hasError?(t.error(this.thrownError),x.EMPTY):this.isStopped?(t.complete(),x.EMPTY):(this.observers.push(t),new Z(this,t))}asObservable(){const t=new I;return t.source=this,t}}return n.create=(e,t)=>new te(e,t),n})();class te extends oe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):x.EMPTY}}function xe(n){return n&&"function"==typeof n.schedule}function ge(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new ne(n,e))}}class ne{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new _e(e,this.project,this.thisArg))}}class _e extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Ie=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Xe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Le=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ke(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const Te=n=>{if(n&&"function"==typeof n[R])return(n=>e=>{const t=n[R]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(Le(n))return Ie(n);if(Ke(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,W),e))(n);if(n&&"function"==typeof n[Xe])return(n=>e=>{const t=n[Xe]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${Q(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Ne(n,e){return new I(t=>{const i=new x;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function je(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[R]}(n))return function(n,e){return new I(t=>{const i=new x;return i.add(e.schedule(()=>{const r=n[R]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Ke(n))return function(n,e){return new I(t=>{const i=new x;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(Le(n))return Ne(n,e);if(function(n){return n&&"function"==typeof n[Xe]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new I(t=>{const i=new x;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Xe](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof I?n:new I(Te(n))}class _t extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class ve extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function N(n,e){if(e.closed)return;if(n instanceof I)return n.subscribe(e);let t;try{t=Te(n)(e)}catch(i){e.error(i)}return t}function B(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(B((r,s)=>je(n(r,s)).pipe(ge((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Re(n,t)))}class Re{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Qe(e,this.project,this.concurrent))}}class Qe extends ve{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new _t(this),i=this.destination;i.add(t);const r=N(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Rt(n=Number.POSITIVE_INFINITY){return B(K,n)}function In(n,e){return e?Ne(n,e):new I(Ie(n))}function Ln(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return xe(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof I?n[0]:Rt(e)(In(n,t))}function Wn(){return function(e){return e.lift(new wi(e))}}class wi{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new gi(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class gi extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Gr extends I{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new x,e.add(this.source.subscribe(new us(this.getSubject(),this))),e.closed&&(this._connection=null,e=x.EMPTY)),e}refCount(){return Wn()(this)}}const Ns=(()=>{const n=Gr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class us extends se{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}class Dl{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function ga(){return new oe}function _s(){return n=>Wn()(function(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new Dl(r,e));const s=Object.create(i,Ns);return s.source=i,s.subjectFactory=r,s}}(ga)(n))}function Zt(n){for(let e in n)if(n[e]===Zt)return e;throw Error("Could not find renamed property on target object.")}function Qa(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function rt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(rt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function lt(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ht=Zt({__forward_ref__:Zt});function me(n){return n.__forward_ref__=me,n.toString=function(){return rt(this())},n}function be(n){return ke(n)?n():n}function ke(n){return"function"==typeof n&&n.hasOwnProperty(ht)&&n.__forward_ref__===me}class Ze extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function Yt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():function(n){return"string"==typeof n?n:null==n?"":String(n)}(n)}function fn(n,e){const t=e?` in ${e}`:"";throw new Ze("201",`No provider for ${Yt(n)} found${t}`)}function J(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function We(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Tt(n){return{providers:n.providers||[],imports:n.imports||[]}}function pn(n){return ys(n,lo)||ys(n,Fs)}function ys(n,e){return n.hasOwnProperty(e)?n[e]:null}function Il(n){return n&&(n.hasOwnProperty(Fr)||n.hasOwnProperty(mc))?n[Fr]:null}const lo=Zt({\u0275prov:Zt}),Fr=Zt({\u0275inj:Zt}),Fs=Zt({ngInjectableDef:Zt}),mc=Zt({ngInjectorDef:Zt});var bn=(()=>((bn=bn||{})[bn.Default=0]="Default",bn[bn.Host=1]="Host",bn[bn.Self=2]="Self",bn[bn.SkipSelf=4]="SkipSelf",bn[bn.Optional=8]="Optional",bn))();let co;function _a(n){const e=co;return co=n,e}function dd(n,e,t){const i=pn(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&bn.Optional?null:void 0!==e?e:void fn(rt(n),"Injector")}function Me(n){return{toString:n}.toString()}var He=(()=>((He=He||{})[He.OnPush=0]="OnPush",He[He.Default=1]="Default",He))(),Wt=(()=>((Wt=Wt||{})[Wt.Emulated=0]="Emulated",Wt[Wt.None=2]="None",Wt[Wt.ShadowDom=3]="ShadowDom",Wt))();const ri="undefined"!=typeof globalThis&&globalThis,Lr="undefined"!=typeof window&&window,Yr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,bs="undefined"!=typeof global&&global,ti=ri||bs||Lr||Yr,hd={},Qi=[],ip=Zt({\u0275cmp:Zt}),Wm=Zt({\u0275dir:Zt}),xh=Zt({\u0275pipe:Zt}),Qb=Zt({\u0275mod:Zt}),yC=Zt({\u0275loc:Zt}),Rl=Zt({\u0275fac:Zt}),Ch=Zt({__NG_ELEMENT_ID__:Zt});let bC=0;function Sn(n){return Me(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===He.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Qi,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Wt.Emulated,id:"c",styles:n.styles||Qi,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=bC++,i.inputs=tv(n.inputs,t),i.outputs=tv(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(Zb):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(Jb):null,i})}function Zb(n){return Li(n)||function(n){return n[Wm]||null}(n)}function Jb(n){return function(n){return n[xh]||null}(n)}const ev={};function gn(n){return Me(()=>{const e={type:n.type,bootstrap:n.bootstrap||Qi,declarations:n.declarations||Qi,imports:n.imports||Qi,exports:n.exports||Qi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(ev[n.id]=n.type),e})}function tv(n,e){if(null==n)return hd;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const jt=Sn;function Ls(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Li(n){return n[ip]||null}function To(n,e){const t=n[Qb]||null;if(!t&&!0===e)throw new Error(`Type ${rt(n)} does not have '\u0275mod' property.`);return t}function Wo(n){return Array.isArray(n)&&"object"==typeof n[1]}function qo(n){return Array.isArray(n)&&!0===n[1]}function Km(n){return 0!=(8&n.flags)}function md(n){return 2==(2&n.flags)}function _d(n){return 1==(1&n.flags)}function va(n){return null!==n.template}function nv(n){return 0!=(512&n[2])}function bc(n,e){return n.hasOwnProperty(Rl)?n[Rl]:null}class Jm{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Zi(){return sv}function sv(n){return n.type.prototype.ngOnChanges&&(n.setInput=TC),AC}function AC(){const n=at(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===hd)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function TC(n,e,t,i){const r=at(n)||function(n,e){return n[Oh]=e}(n,{previous:hd,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new Jm(l&&l.currentValue,e,o===hd),n[i]=e}Zi.ngInherit=!0;const Oh="__ngSimpleChanges__";function at(n){return n[Oh]||null}let Gi;function ur(n){return!!n.listen}const uu={createRenderer:(n,e)=>void 0!==Gi?Gi:"undefined"!=typeof document?document:void 0};function wr(n){for(;Array.isArray(n);)n=n[0];return n}function Ks(n,e){return wr(e[n.index])}function n_(n,e){return n.data[e]}function Bs(n,e){const t=e[n];return Wo(t)?t:t[0]}function Fl(n){return 4==(4&n[2])}function bd(n){return 128==(128&n[2])}function Ea(n,e){return null==e?null:n[e]}function i_(n){n[18]=0}function op(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Bn={lFrame:hu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function av(){return Bn.bindingsEnabled}function Lt(){return Bn.lFrame.lView}function mi(){return Bn.lFrame.tView}function jr(n){return Bn.lFrame.contextLView=n,n[8]}function ns(){let n=r_();for(;null!==n&&64===n.type;)n=n.parent;return n}function r_(){return Bn.lFrame.currentTNode}function el(n,e){const t=Bn.lFrame;t.currentTNode=n,t.isParent=e}function Vr(){return Bn.lFrame.isParent}function Fh(){return Bn.isInCheckNoChangesMode}function lp(n){Bn.isInCheckNoChangesMode=n}function vd(n,e){const t=Bn.lFrame;t.bindingIndex=t.bindingRootIndex=n,s_(e)}function s_(n){Bn.lFrame.currentDirectiveIndex=n}function lv(){return Bn.lFrame.currentQueryIndex}function a_(n){Bn.lFrame.currentQueryIndex=n}function up(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function wd(n,e,t){if(t&bn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&bn.Host||(r=up(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Bn.lFrame=Ee();return i.currentTNode=e,i.lView=n,!0}function Bh(n){const e=Ee(),t=n[1];Bn.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Ee(){const n=Bn.lFrame,e=null===n?null:n.child;return null===e?hu(n):e}function hu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function jh(){const n=Bn.lFrame;return Bn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Io=jh;function li(){const n=jh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Xs(){return Bn.lFrame.selectedIndex}function fo(n){Bn.lFrame.selectedIndex=n}function dp(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function hp(n,e,t){tl(n,e,3,t)}function fp(n,e,t,i){(3&n[2])===t&&tl(n,e,t,i)}function l_(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function tl(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(UC(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function UC(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Vh{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function pp(n,e,t){const i=ur(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];u_(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function cv(n){return 3===n||4===n||6===n}function u_(n){return 64===n.charCodeAt(0)}function Uh(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||d_(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function d_(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function uv(n){return-1!==n}function Ed(n){return 32767&n}function nl(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let Sd=!0;function gp(n){const e=Sd;return Sd=n,e}let f_=0;function js(n,e){const t=mp(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,p_(i.data,n),p_(e,null),p_(i.blueprint,null));const r=zh(n,e),s=n.injectorIndex;if(uv(r)){const o=Ed(r),a=nl(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function p_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function mp(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function zh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function wc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ch)&&(i=t[Ch]),null==i&&(i=t[Ch]=f_++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function g_(n,e,t){if(t&bn.Optional)return n;fn(e,"NodeInjector")}function hv(n,e,t,i){if(t&bn.Optional&&void 0===i&&(i=null),0==(t&(bn.Self|bn.Host))){const r=n[9],s=_a(void 0);try{return r?r.get(e,i,t&bn.Optional):dd(e,i,t&bn.Optional)}finally{_a(s)}}return g_(i,e,t)}function Hh(n,e,t,i=bn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Ch)?n[Ch]:void 0;return"number"==typeof e?e>=0?255&e:pv:e}(t);if("function"==typeof s){if(!wd(e,n,i))return i&bn.Host?g_(r,t,i):hv(e,t,i,r);try{const o=s(i);if(null!=o||i&bn.Optional)return o;fn(t)}finally{Io()}}else if("number"==typeof s){let o=null,a=mp(n,e),l=-1,c=i&bn.Host?e[16][6]:null;for((-1===a||i&bn.SkipSelf)&&(l=-1===a?zh(n,e):e[a+8],-1!==l&&Gh(i,!1)?(o=e[1],a=Ed(l),e=nl(l,e)):a=-1);-1!==a;){const u=e[1];if(_p(s,a,u.data)){const h=Es(a,e,t,o,i,c);if(h!==fv)return h}l=e[a+8],-1!==l&&Gh(i,e[1].data[a+8]===c)&&_p(s,a,e)?(o=u,a=Ed(l),e=nl(l,e)):a=-1}}}return hv(e,t,i,r)}const fv={};function pv(){return new Ko(ns(),Lt())}function Es(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=xd(a,o,t,null==i?md(a)&&Sd:i!=o&&0!=(3&a.type),r&bn.Host&&s===a);return null!==u?Cd(e,o,u,a):fv}function xd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,p=r?a+u:n.directiveEnd;for(let g=i?a:a+u;g<p;g++){const m=o[g];if(g<l&&t===m||g>=l&&m.type===t)return g}if(r){const g=o[l];if(g&&va(g)&&g.type===t)return l}return null}function Cd(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof Vh}(r)){const o=r;o.resolving&&function(n,e){throw new Ze("200",`Circular dependency in DI detected for ${n}`)}(Yt(s[t]));const a=gp(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?_a(o.injectImpl):null;wd(n,i,bn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=sv(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&_a(l),gp(a),o.resolving=!1,Io()}}return r}function _p(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Gh(n,e){return!(n&bn.Self||n&bn.Host&&e)}class Ko{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Hh(this._tNode,this._lView,e,void 0,t)}}function or(n){return Me(()=>{const e=n.prototype.constructor,t=e[Rl]||Ss(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Rl]||Ss(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Ss(n){return ke(n)?()=>{const e=Ss(be(n));return e&&e()}:bc(n)}const Td="__parameters__";function Ta(n,e,t){return Me(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(Td)?l[Td]:Object.defineProperty(l,Td,{value:[]})[Td];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Ht{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Xo(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),Xo(i,e)):e!==n&&e.push(i)}return e}function Qo(n,e){n.forEach(t=>Array.isArray(t)?Qo(t,e):e(t))}function Wh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function kl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Oo(n,e,t){let i=xs(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function w_(n,e){const t=xs(n,e);if(t>=0)return n[1|t]}function xs(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const yu={},Ep="__NG_DI_FLAG__",Cc="ngTempTokenPath",Ac=/\n/gm,sl="__source",Sp=Zt({provide:String,useValue:Zt});let bu;function Id(n){const e=bu;return bu=n,e}function nA(n,e=bn.Default){if(void 0===bu)throw new Error("inject() must be called from an injection context");return null===bu?dd(n,void 0,e):bu.get(n,e&bn.Optional?null:void 0,e)}function Oe(n,e=bn.Default){return(co||nA)(be(n),e)}const Tc=Oe;function vu(n){const e=[];for(let t=0;t<n.length;t++){const i=be(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=bn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=vv(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Oe(r,s))}else e.push(Oe(i))}return e}function Od(n,e){return n[Ep]=e,n.prototype[Ep]=e,n}function vv(n){return n[Ep]}function Qs(n,e,t,i){const r=n[Cc];throw e[sl]&&r.unshift(e[sl]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=rt(e);if(Array.isArray(e))r=e.map(rt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):rt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Ac,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Cc]=null,n}const Rd=Od(Ta("Inject",n=>({token:n})),-1),Xr=Od(Ta("Optional"),8),ol=Od(Ta("SkipSelf"),4);const B_="__ngContext__";function Cs(n,e){n[B_]=e}function j_(n){const e=function(n){return n[B_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function Fp(n){return n.ngOriginalError}function AA(n,...e){n.error(...e)}class ta{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||AA}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(Fp(e)):null}_findOriginalError(e){let t=e&&Fp(e);for(;t&&Fp(t);)t=Fp(t);return t||null}}const qv=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ti))();function ll(n){return n instanceof Function?n():n}var Po=(()=>((Po=Po||{})[Po.Important=1]="Important",Po[Po.DashCase=2]="DashCase",Po))();function G_(n,e){return undefined(n,e)}function Jh(n){const e=n[3];return qo(e)?e[3]:e}function Bd(n){return Zv(n[13])}function W_(n){return Zv(n[4])}function Zv(n){for(;null!==n&&!qo(n);)n=n[4];return n}function jd(n,e,t,i,r){if(null!=i){let s,o=!1;qo(i)?s=i:Wo(i)&&(o=!0,i=i[0]);const a=wr(i);0===n&&null!==t?null==r?iw(e,t,a):cl(e,t,a,r||null,!0):1===n&&null!==t?cl(e,t,a,r||null,!0):2===n?function(n,e,t){const i=Bp(n,e);i&&function(n,e,t,i){ur(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==wr(t)&&jd(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Vd(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function Y_(n,e,t){return ur(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function ew(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,op(r,-1)),t.splice(i,1)}function K_(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&ew(r,i),e>0&&(n[t-1][4]=i[4]);const s=kl(n,10+e);!function(n,e){Vd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function X_(n,e){if(!(256&e[2])){const t=e[11];ur(t)&&t.destroyNode&&Vd(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return kp(n[1],n);for(;e;){let t=null;if(Wo(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Wo(e)&&kp(e[1],e),e=e[3];null===e&&(e=n),Wo(e)&&kp(e[1],e),t=e&&e[4]}e=t}}(e)}}function kp(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Vh)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):wr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&ur(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&qo(e[3])){t!==e[3]&&ew(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function tw(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Wt.None||r===Wt.Emulated)return null}return Ks(i,t)}(n,e.parent,t)}function cl(n,e,t,i,r){ur(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function iw(n,e,t){ur(n)?n.appendChild(e,t):e.appendChild(t)}function rw(n,e,t,i,r){null!==i?cl(n,e,t,i,r):iw(n,e,t)}function Bp(n,e){return ur(n)?n.parentNode(e):e.parentNode}let aw=function(n,e,t){return 40&n.type?Ks(n,t):null};function jp(n,e,t,i){const r=tw(n,i,e),s=e[11],a=function(n,e,t){return aw(n,e,t)}(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)rw(s,r,t[l],a,!1);else rw(s,r,t,a,!1)}function xu(n,e){if(null!==e){const t=e.type;if(3&t)return Ks(e,n);if(4&t)return Vp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return xu(n,i);{const r=n[e.index];return qo(r)?Vp(-1,r):wr(r)}}if(32&t)return G_(e,n)()||wr(n[e.index]);{const i=cw(n,e);return null!==i?Array.isArray(i)?i[0]:xu(Jh(n[16]),i):xu(n,e.next)}}return null}function cw(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Vp(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return xu(i,r)}return e[7]}function ef(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Cs(wr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)ef(n,e,t.child,i,r,s,!1),jd(e,n,r,a,s);else if(32&l){const c=G_(t,i);let u;for(;u=c();)jd(e,n,r,u,s);jd(e,n,r,a,s)}else 16&l?J_(n,e,i,t,r,s):jd(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Vd(n,e,t,i,r,s){ef(t,i,n.firstChild,e,r,s,!1)}function J_(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)jd(e,n,r,l[c],s);else ef(n,e,l,o[3],r,s,!0)}function hw(n,e,t){ur(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function ey(n,e,t){ur(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function tf(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const fw="ng-template";function QA(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==tf(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Up(n){return 4===n.type&&n.value!==fw}function pw(n,e,t){return e===(4!==n.type||t?n.value:fw)}function ZA(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(cv(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!pw(n,l,t)||""===l&&1===e.length){if(Da(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!QA(n.attrs,c,t)){if(Da(i))return!1;o=!0}continue}const h=JA(8&i?"class":l,r,Up(n),t);if(-1===h){if(Da(i))return!1;o=!0;continue}if(""!==c){let p;p=h>s?"":r[h+1].toLowerCase();const g=8&i?p:null;if(g&&-1!==tf(g,c,0)||2&i&&c!==p){if(Da(i))return!1;o=!0}}}}else{if(!o&&!Da(i)&&!Da(l))return!1;if(o&&Da(l))continue;o=!1,i=l|1&i}}return Da(i)||o}function Da(n){return 0==(1&n)}function JA(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function gw(n,e,t=!1){for(let i=0;i<e.length;i++)if(ZA(n,e[i],t))return!0;return!1}function mw(n,e){return n?":not("+e.trim()+")":e}function rT(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Da(o)&&(e+=mw(s,r),r=""),i=o,s=s||!Da(i);t++}return""!==r&&(e+=mw(s,r)),e}const Mn={};function ul(n,e){return n<<17|e<<2}function On(n){return n>>17&32767}function Er(n){return 2|n}function zl(n){return(131068&n)>>2}function dl(n,e){return-131069&n|e<<2}function ny(n){return 1|n}function Aw(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];a_(r),o.contentQueries(2,e[s],s)}}}function rf(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,i_(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function zd(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=r_(),o=Vr(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Bn.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Bn.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return el(s,!0),s}function Hd(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function sf(n,e,t){Bh(e);try{const i=n.viewQuery;null!==i&&yy(1,i,t);const r=n.template;null!==r&&Tw(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Aw(n,e),n.staticViewQueries&&yy(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)PT(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,li()}}function Gd(n,e,t,i){const r=e[2];if(256==(256&r))return;Bh(e);const s=Fh();try{i_(e),function(n){Bn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Tw(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&hp(e,c,null)}else{const c=n.preOrderHooks;null!==c&&fp(e,c,0,null),l_(e,0)}if(function(n){for(let e=Bd(n);null!==e;e=W_(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&op(s,1),r[2]|=1024}}}(e),function(n){for(let e=Bd(n);null!==e;e=W_(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];bd(i)&&Gd(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&Aw(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&hp(e,c)}else{const c=n.contentHooks;null!==c&&fp(e,c,1),l_(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)fo(~r);else{const s=r,o=t[++i],a=t[++i];vd(o,s),a(2,e[s])}}}finally{fo(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)NT(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&yy(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&hp(e,c)}else{const c=n.viewHooks;null!==c&&fp(e,c,2),l_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,op(e[3],-1))}finally{li()}}function _T(n,e,t,i){const r=e[10],s=!Fh(),o=Fl(e);try{s&&!o&&r.begin&&r.begin(),o&&sf(n,e,i),Gd(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function Tw(n,e,t,i,r){const s=Xs(),o=2&i;try{fo(-1),o&&e.length>20&&function(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&hp(e,s,t)}else{const s=n.preOrderHooks;null!==s&&fp(e,s,0,t)}fo(t)}(n,e,20,Fh()),t(i,r)}finally{fo(s)}}function of(n,e,t){!av()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||js(t,e),Cs(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=va(l);c&&MT(e,t,l);const u=Cd(e,n,a,t);Cs(u,e),null!==o&&DT(0,a-r,u,l,0,o),c&&(Bs(t.index,e)[8]=u)}}(n,e,t,Ks(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Bn.lFrame.currentDirectiveIndex;try{fo(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];s_(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&kw(c,u)}}finally{fo(-1),s_(a)}}(n,e,t))}function cy(n,e,t=Ks){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function $p(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Wp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Wp(n,e,t,i,r,s,o,a,l,c){const u=20+i,h=u+r,p=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Mn);return t}(u,h),g="function"==typeof c?c():c;return p[1]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function Iw(n,e,t,i){const r=Uw(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Yp(n).push(i,r.length-1))}function Ow(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function uy(n,e,t,i){let r=!1;if(av()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];gw(t,o.selectors,!1)&&(r||(r=[]),wc(js(t,e),n,o.type),va(o)?(Bw(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,dy(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=Hd(n,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=Uh(t.mergedAttrs,h.hostAttrs),hy(n,t,e,c,h),TT(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const p=h.type.prototype;!a&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],h=u.inputs,p=null===s||Up(e)?null:IT(h,s);o.push(p),a=Ow(h,c,a),l=Ow(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Ze("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Uh(t.mergedAttrs,t.attrs),r}function Lw(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function kw(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Bw(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function TT(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;va(e)&&(t[""]=n)}}function dy(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function hy(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=bc(r.type)),o=new Vh(s,va(r),null);n.blueprint[i]=o,t[i]=o,Lw(n,e,0,i,Hd(n,t,r.hostVars,Mn),r)}function MT(n,e,t){const i=Ks(e,n),r=$p(t),s=n[10],o=qp(n,rf(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function DT(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?i.setInput(t,h,c,u):t[u]=h}}}function IT(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function jw(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function NT(n,e){const t=Bs(e,n);if(bd(t)){const i=t[1];80&t[2]?Gd(i,t,i.template,t[8]):t[5]>0&&py(t)}}function py(n){for(let i=Bd(n);null!==i;i=W_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Gd(o,s,o.template,s[8])}else s[5]>0&&py(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Bs(t[i],n);bd(r)&&r[5]>0&&py(r)}}function PT(n,e){const t=Bs(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),sf(i,t,t[8])}function qp(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function gy(n){for(;n;){n[2]|=64;const e=Jh(n);if(nv(n)&&!e)return n;n=e}return null}function _y(n,e,t){const i=e[10];i.begin&&i.begin();try{Gd(n,e,n.template,t)}catch(r){throw vy(e,r),r}finally{i.end&&i.end()}}function Vw(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=j_(t),r=i[1];_T(r,i,r.template,t)}}(n[8])}function yy(n,e,t){a_(0),e(n,t)}const jT=(()=>Promise.resolve(null))();function Uw(n){return n[7]||(n[7]=[])}function Yp(n){return n.cleanup||(n.cleanup=[])}function vy(n,e){const t=n[9],i=t?t.get(ta,null):null;i&&i.handleError(e)}function zw(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Kp(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=lt(r,a):2==s&&(i=lt(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Wd=new Ht("INJECTOR",-1);class eo{get(e,t=yu){if(t===yu){const i=new Error(`NullInjectorError: No provider for ${rt(e)}!`);throw i.name="NullInjectorError",i}return t}}const Cu=new Ht("Set Injector scope."),af={},UT={};let Ey;function Hw(){return void 0===Ey&&(Ey=new eo),Ey}function Gw(n,e=null,t=null,i){return new xy(n,t,e||Hw(),i)}class xy{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Qo(t,a=>this.processProvider(a,e,t)),Qo([e],a=>this.processInjectorType(a,[],s)),this.records.set(Wd,Au(void 0,this));const o=this.records.get(Cu);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:rt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=yu,i=bn.Default){this.assertNotDestroyed();const r=Id(this),s=_a(void 0);try{if(!(i&bn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ht}(e)&&pn(e);a=l&&this.injectableDefInScope(l)?Au(Cy(e),af):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&bn.Self?Hw():this.parent).get(e,t=i&bn.Optional&&t===yu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Cc]=o[Cc]||[]).unshift(rt(e)),r)throw o;return Qs(o,e,"R3InjectorError",this.source)}throw o}finally{_a(s),Id(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(rt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=be(e)))return!1;let r=Il(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Il(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{Qo(r.imports,h=>{this.processInjectorType(h,t,i)&&(void 0===u&&(u=[]),u.push(h))})}finally{}if(void 0!==u)for(let h=0;h<u.length;h++){const{ngModule:p,providers:g}=u[h];Qo(g,m=>this.processProvider(m,p,g||Qi))}}this.injectorDefTypes.add(o);const l=bc(o)||(()=>new o);this.records.set(o,Au(l,af));const c=r.providers;if(null!=c&&!a){const u=e;Qo(c,h=>this.processProvider(h,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=Rc(e=be(e))?e:be(e&&e.provide);const s=function(n,e,t){return Ww(n)?Au(void 0,n.useValue):Au(function(n,e,t){let i;if(Rc(n)){const r=be(n);return bc(r)||Cy(r)}if(Ww(n))i=()=>be(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...vu(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>Oe(be(n.useExisting));else{const r=be(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return bc(r)||Cy(r);i=()=>new r(...vu(n.deps))}return i}(n),af)}(e);if(Rc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Au(void 0,af,!0),o.factory=()=>vu(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===af&&(t.value=UT,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=be(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function Cy(n){const e=pn(n),t=null!==e?e.factory:bc(n);if(null!==t)return t;if(n instanceof Ht)throw new Error(`Token ${rt(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=function(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?");throw new Error(`Can't resolve all parameters for ${rt(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[lo]||n[Fs]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function Au(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Ww(n){return null!==n&&"object"==typeof n&&Sp in n}function Rc(n){return"function"==typeof n}const qw=function(n,e,t){return function(n,e=null,t=null,i){const r=Gw(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class Gn{static create(e,t){return Array.isArray(e)?qw(e,t,""):qw(e.providers,e.parent,e.name||"")}}function iq(n,e){dp(j_(n)[1],ns())}function Fn(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(va(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=nM(n.inputs),o.declaredInputs=nM(n.declaredInputs),o.outputs=nM(n.outputs);const a=r.hostBindings;a&&aq(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&sq(n,l),c&&oq(n,c),Qa(n.inputs,r.inputs),Qa(n.declaredInputs,r.declaredInputs),Qa(n.outputs,r.outputs),va(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Fn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Uh(r.hostAttrs,t=Uh(t,r.hostAttrs))}}(i)}function nM(n){return n===hd?{}:n===Qi?[]:n}function sq(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function oq(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function aq(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}Gn.THROW_IF_NOT_FOUND=yu,Gn.NULL=new eo,Gn.\u0275prov=We({token:Gn,providedIn:"any",factory:()=>Oe(Wd)}),Gn.__NG_ELEMENT_ID__=-1;let Zw=null;function Xp(){if(!Zw){const n=ti.Symbol;if(n&&n.iterator)Zw=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Zw=i)}}}return Zw}class $l{constructor(e){this.wrapped=e}static wrap(e){return new $l(e)}static unwrap(e){return $l.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof $l}}function Iy(n){return!!iM(n)&&(Array.isArray(n)||!(n instanceof Map)&&Xp()in n)}function iM(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function _o(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function De(n,e=bn.Default){const t=Lt();return null===t?Oe(n,e):Hh(ns(),t,be(n),e)}function yn(n,e,t){const i=Lt();return _o(i,Bn.lFrame.bindingIndex++,e)&&function(n,e,t,i,r,s,o,a){const l=Ks(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(zw(n,t,u,i,r),md(e)&&function(n,e){const t=Bs(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,ur(s)?s.setProperty(l,i,r):u_(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}(mi(),function(){const n=Bn.lFrame;return n_(n.tView,n.selectedIndex)}(),i,n,e,i[11],t,!1),yn}function lM(n,e,t,i,r){const o=r?"class":"style";zw(n,t,e.inputs[o],o,i)}function Xt(n,e,t,i){const r=Lt(),s=mi(),o=20+n,a=r[11],l=r[o]=Y_(a,e,Bn.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=zd(e,n,2,r,Ea(a,s));return uy(e,t,c,Ea(a,o)),null!==c.attrs&&Kp(c,c.attrs,!1),null!==c.mergedAttrs&&Kp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];el(c,!0);const u=c.mergedAttrs;null!==u&&pp(a,l,u);const h=c.classes;null!==h&&ey(a,l,h);const p=c.styles;null!==p&&hw(a,l,p),64!=(64&c.flags)&&jp(s,r,l,c),0===Bn.lFrame.elementDepthCount&&Cs(l,r),Bn.lFrame.elementDepthCount++,_d(c)&&(of(s,r,c),function(n,e,t){if(Km(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&cy(r,c)}function Qt(){let n=ns();Vr()?Bn.lFrame.isParent=!1:(n=n.parent,el(n,!1));const e=n;Bn.lFrame.elementDepthCount--;const t=mi();t.firstCreatePass&&(dp(t,n),Km(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&lM(t,e,Lt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&lM(t,e,Lt(),e.stylesWithoutHost,!1)}function Ry(n){return!!n&&"function"==typeof n.then}function sL(n){return!!n&&"function"==typeof n.subscribe}const tE=sL;function hi(n,e,t,i){const r=Lt(),s=mi(),o=ns();return function(n,e,t,i,r,s,o,a){const l=_d(i),u=n.firstCreatePass&&Yp(n),h=e[8],p=Uw(e);let g=!0;if(3&i.type||a){const C=Ks(i,e),H=a?a(C):C,U=p.length,de=a?Ce=>a(wr(Ce[i.index])):i.index;if(ur(t)){let Ce=null;if(!a&&l&&(Ce=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Ce)(Ce.__ngLastListenerFn__||Ce).__ngNextListenerFn__=s,Ce.__ngLastListenerFn__=s,g=!1;else{s=cM(i,e,h,s,!1);const Pe=t.listen(H,r,s);p.push(s,Pe),u&&u.push(r,de,U,U+1)}}else s=cM(i,e,h,s,!0),H.addEventListener(r,s,o),p.push(s),u&&u.push(r,de,U,o)}else s=cM(i,e,h,s,!1);const m=i.outputs;let w;if(g&&null!==m&&(w=m[r])){const C=w.length;if(C)for(let H=0;H<C;H+=2){const Be=e[w[H]][w[H+1]].subscribe(s),et=p.length;p.push(s,Be),u&&u.push(r,i.index,et,-(et+1))}}}(s,r,r[11],o,n,e,!!t,i),hi}function aL(n,e,t,i){try{return!1!==t(i)}catch(r){return vy(n,r),!1}}function cM(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Bs(n.index,e):e;0==(32&e[2])&&gy(a);let l=aL(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=aL(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function yi(n=1){return function(n){return(Bn.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Bn.lFrame.contextLView))[8]}(n)}function mL(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?On(s):zl(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];Gq(n[a],e)&&(l=!0,n[a+1]=i?ny(u):Er(u)),a=i?On(u):zl(u)}l&&(n[t+1]=i?Er(s):ny(s))}function Gq(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&xs(n,e)>=0}const Ts={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function _L(n){return n.substring(Ts.key,Ts.keyEnd)}function yL(n,e){const t=Ts.textEnd;return t===e?-1:(e=Ts.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Ts.key=e,t),cg(n,e,t))}function cg(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Mu(n){!function(n,e,t,i){const r=mi(),s=function(n){const e=Bn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);r.firstUpdatePass&&function(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Xs()],o=SL(n,t);ML(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=function(n){const e=Bn.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Py(t=dM(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=dM(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==zl(i))return n[On(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=dM(null,n,e,l[1],i),l=Py(l,e.attrs,i),function(n,e,t,i){n[On(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=Py(i,n[s].hostAttrs,t);return Py(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=On(o),l=zl(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||xs(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const p=On(n[a+1]);n[i+1]=ul(p,a),0!==p&&(n[p+1]=dl(n[p+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=ul(a,0),0!==a&&(n[a+1]=dl(n[a+1],i)),a=i;else n[i+1]=ul(l,0),0===a?a=i:n[l+1]=dl(n[l+1],i),l=i;c&&(n[i+1]=Er(n[i+1])),mL(n,u,i,!0),mL(n,u,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&xs(s,e)>=0&&(t[i+1]=ny(t[i+1]))}(e,u,n,i,s),o=ul(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(r,null,s,i);const o=Lt();if(t!==Mn&&_o(o,s,t)){const a=r.data[Xs()];if(ML(a,i)&&!SL(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=lt(l,t||"")),lM(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===Mn&&(r=Qi);let l=0,c=0,u=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const p=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let w,m=null;u===h?(l+=2,c+=2,p!==g&&(m=h,w=g)):null===h||null!==u&&u<h?(l+=2,m=u):(c+=2,m=h,w=g),null!==m&&AL(n,e,t,i,m,w,o,a),u=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return Qi;const i=[],r=function(n){return n instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(Oo,Fc,n,!0)}function Fc(n,e){for(let t=function(n){return function(n){Ts.key=0,Ts.keyEnd=0,Ts.value=0,Ts.valueEnd=0,Ts.textEnd=n.length}(n),yL(n,cg(n,0,Ts.textEnd))}(e);t>=0;t=yL(e,t))Oo(n,_L(e),!0)}function SL(n,e){return e>=n.expandoStartIndex}function dM(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=Py(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Py(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Oo(n,o,!!t||e[++s]))}return void 0===n?null:n}function AL(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];rE(function(n){return 1==(1&n)}(c)?TL(l,e,t,r,zl(c),o):void 0)||(rE(s)||function(n){return 2==(2&n)}(c)&&(s=TL(l,null,t,r,a,o)),function(n,e,t,i,r){const s=ur(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Po.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Po.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,function(n,e){return wr(e[n])}(Xs(),t),r,s))}function TL(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let p=t[r+1];p===Mn&&(p=h?Qi:void 0);let g=h?w_(p,i):u===i?p:void 0;if(c&&!rE(g)&&(g=w_(l,i)),rE(g)&&(a=g,o))return a;const m=n[r+1];r=o?On(m):zl(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=w_(l,i))}return a}function rE(n){return void 0!==n}function ML(n,e){return 0!=(n.flags&(e?16:32))}const cf=void 0;var xY=["en",[["a","p"],["AM","PM"],cf],[["AM","PM"],cf,cf],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],cf,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],cf,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",cf,"{1} 'at' {0}",cf],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let ug={};function WL(n){return n in ug||(ug[n]=ti.ng&&ti.ng.common&&ti.ng.common.locales&&ti.ng.common.locales[n]),ug[n]}var rn=(()=>((rn=rn||{})[rn.LocaleId=0]="LocaleId",rn[rn.DayPeriodsFormat=1]="DayPeriodsFormat",rn[rn.DayPeriodsStandalone=2]="DayPeriodsStandalone",rn[rn.DaysFormat=3]="DaysFormat",rn[rn.DaysStandalone=4]="DaysStandalone",rn[rn.MonthsFormat=5]="MonthsFormat",rn[rn.MonthsStandalone=6]="MonthsStandalone",rn[rn.Eras=7]="Eras",rn[rn.FirstDayOfWeek=8]="FirstDayOfWeek",rn[rn.WeekendRange=9]="WeekendRange",rn[rn.DateFormat=10]="DateFormat",rn[rn.TimeFormat=11]="TimeFormat",rn[rn.DateTimeFormat=12]="DateTimeFormat",rn[rn.NumberSymbols=13]="NumberSymbols",rn[rn.NumberFormats=14]="NumberFormats",rn[rn.CurrencyCode=15]="CurrencyCode",rn[rn.CurrencySymbol=16]="CurrencySymbol",rn[rn.CurrencyName=17]="CurrencyName",rn[rn.Currencies=18]="Currencies",rn[rn.Directionality=19]="Directionality",rn[rn.PluralCase=20]="PluralCase",rn[rn.ExtraData=21]="ExtraData",rn))();const oE="en-US";let qL=oE;function fM(n){J(n,"Expected localeId to be defined"),"string"==typeof n&&(qL=n.toLowerCase().replace(/_/g,"-"))}class yk{}const vk="ngComponent";class xK{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${rt(n)}. Did you add it to @NgModule.entryComponents?`);return e[vk]=n,e}(e)}}class ml{}function dE(...n){}function hg(n,e){return new Dn(Ks(n,e))}ml.NULL=new xK;const TK=function(){return hg(ns(),Lt())};let Dn=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=TK,n})();function wk(n){return n instanceof Dn?n.nativeElement:n}class uf{}let wM=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>null}),n})();class Iu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Ek=new Iu("12.2.5");class Sk{constructor(){}supports(e){return Iy(e)}create(e){return new NK(e)}}const RK=(n,e)=>e;class NK{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||RK}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<Ck(i,r,s)?t:i,a=Ck(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let p=0;p<c;p++){const g=p<s.length?s[p]:s[p]=0,m=g+p;u<=m&&m<c&&(s[p]=g+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Iy(e))throw new Error(`Error trying to diff '${rt(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Xp()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new PK(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new xk),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new xk),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class PK{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class FK{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class xk{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new FK,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Ck(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class Ak{constructor(){}supports(e){return e instanceof Map||iM(e)}create(){return new LK}}class LK{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||iM(e)))throw new Error(`Error trying to diff '${rt(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new kK(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class kK{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Tk(){return new fg([new Sk])}let fg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||Tk()),deps:[[n,new ol,new Xr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:Tk}),n})();function Mk(){return new pg([new Ak])}let pg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||Mk()),deps:[[n,new ol,new Xr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:Mk}),n})();function hE(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(wr(s)),qo(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&hE(l[1],l,c,i)}const o=t.type;if(8&o)hE(n,e,t.child,i);else if(32&o){const a=G_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=cw(e,t);if(Array.isArray(a))i.push(...a);else{const l=Jh(e[16]);hE(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class jy{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return hE(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(qo(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(K_(e,i),kl(t,i))}this._attachedToViewContainer=!1}X_(this._lView[1],this._lView)}onDestroy(e){Iw(this._lView[1],this._lView,null,e)}markForCheck(){gy(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){_y(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){lp(!0);try{_y(n,e,t)}finally{lp(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){Vd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class jK extends jy{constructor(e){super(e),this._view=e}detectChanges(){Vw(this._view)}checkNoChanges(){!function(n){lp(!0);try{Vw(n)}finally{lp(!1)}}(this._view)}get context(){return null}}const UK=function(n){return function(n,e,t){if(md(n)&&!t){const i=Bs(n.index,e);return new jy(i,i)}return 47&n.type?new jy(e[16],e):null}(ns(),Lt(),16==(16&n))};let rs=(()=>{class n{}return n.__NG_ELEMENT_ID__=UK,n})();const GK=[new Ak],WK=new fg([new Sk]),qK=new pg(GK),KK=function(){return fE(ns(),Lt())};let ko=(()=>{class n{}return n.__NG_ELEMENT_ID__=KK,n})();const XK=ko,QK=class extends XK{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=rf(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),sf(t,i,e),new jy(i)}};function fE(n,e){return 4&n.type?new QK(e,n,hg(n,e)):null}class Lc{}const eX=function(){return Rk(ns(),Lt())};let Ms=(()=>{class n{}return n.__NG_ELEMENT_ID__=eX,n})();const nX=Ms,Ik=class extends nX{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return hg(this._hostTNode,this._hostLView)}get injector(){return new Ko(this._hostTNode,this._hostLView)}get parentInjector(){const e=zh(this._hostTNode,this._hostLView);if(uv(e)){const t=nl(e,this._hostLView),i=Ed(e);return new Ko(t[1].data[i+8],t)}return new Ko(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Ok(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(Lc,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return qo(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=i[3],p=new Ik(h,h[6],h[3]);p.detach(p.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Wh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Vp(s,o),l=i[11],c=Bp(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,Vd(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Wh(EM(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Ok(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=K_(this._lContainer,t);i&&(kl(EM(this._lContainer),t),X_(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=K_(this._lContainer,t);return i&&null!=kl(EM(this._lContainer),t)?new jy(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function Ok(n){return n[8]}function EM(n){return n[8]||(n[8]=[])}function Rk(n,e){let t;const i=e[n.index];if(qo(i))t=i;else{let r;if(8&n.type)r=wr(i);else{const s=e[11];r=s.createComment("");const o=Ks(n,e);cl(s,Bp(s,o),r,function(n,e){return ur(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=jw(i,e,r,n),qp(e,t)}return new Ik(t,n,e)}const yg={};class Zk extends ml{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Li(e);return new e3(t,this.ngModule)}}function Jk(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const ZX=new Ht("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>qv});class e3 extends yk{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map(rT).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Jk(this.componentDef.inputs)}get outputs(){return Jk(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,yg,r);return s!==yg||i===yg?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(uf,uu),a=s.get(wM,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function(n,e,t){if(ur(n))return n.selectRootElement(e,t===Wt.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):Y_(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),h=this.componentDef.onPush?576:528,p=function(n,e){return{components:[],scheduler:n||qv,clean:jT,playerHandler:e||null,flags:0}}(),g=Wp(0,null,null,1,0,null,null,null,null,null),m=rf(null,g,p,h,null,null,o,l,a,s);let w,C;Bh(m);try{const H=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=zd(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(Kp(l,c,!0),null!==n&&(pp(r,n,c),null!==l.classes&&ey(r,n,l.classes),null!==l.styles&&hw(r,n,l.styles)));const u=i.createRenderer(n,e),h=rf(t,$p(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(wc(js(l,t),o,e.type),Bw(o,l),dy(l,t.length,1)),qp(t,h),t[20]=h}(u,this.componentDef,m,o,l);if(u)if(i)pp(l,u,["ng-version",Ek.full]);else{const{attrs:U,classes:de}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Da(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);U&&pp(l,u,U),de&&de.length>0&&ey(l,u,de.join(" "))}if(C=n_(g,20),void 0!==t){const U=C.projection=[];for(let de=0;de<this.ngContentSelectors.length;de++){const Ce=t[de];U.push(null!=Ce?Array.from(Ce):null)}}w=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=ns();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),hy(n,i,e,Hd(n,e,1,null),t));const r=Cd(e,n,i.directiveStart,i);Cs(r,e);const s=Ks(i,e);return s&&Cs(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=ns();e.contentQueries(1,o,l.directiveStart)}const a=ns();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(fo(a.index),Lw(t[1],a,0,a.directiveStart,a.directiveEnd,e),kw(e,o)),o}(H,this.componentDef,m,p,[iq]),sf(g,m,null)}finally{li()}return new tQ(this.componentType,w,hg(C,m),m,C)}}class tQ extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new jK(r),this.componentType=e}get injector(){return new Ko(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const bg=new Map;class rQ extends Lc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Zk(this);const i=To(e),r=function(n){return n[yC]||null}(e);r&&fM(r),this._bootstrapComponents=ll(i.bootstrap),this._r3Injector=Gw(e,t,[{provide:Lc,useValue:this},{provide:ml,useValue:this.componentFactoryResolver}],rt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Gn.THROW_IF_NOT_FOUND,i=bn.Default){return e===Gn||e===Lc||e===Wd?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class FM extends class{}{constructor(e){super(),this.moduleType=e,null!==To(e)&&function(n){const e=new Set;!function t(i){const r=To(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${rt(e)} vs ${rt(e.name)}`)}(s,bg.get(s),i),bg.set(s,i));const o=ll(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new rQ(this.moduleType,e)}}function r3(n,e,t,i,r,s){const o=e+t;return _o(n,o,r)?function(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===Mn?void 0:t}(n,o+1)}function Ky(n,e,t){const i=n+20,r=Lt(),s=function(n,e){return n[e]}(r,i);return function(n,e){$l.isWrapped(e)&&(e=$l.unwrap(e),n[Bn.lFrame.bindingIndex]=Mn);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?r3(r,function(){const n=Bn.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),e,s.transform,t,s):s.transform(t))}function LM(n){return e=>{setTimeout(n,void 0,e)}}const cn=class extends oe{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const h=e;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),l=null===(s=h.error)||void 0===s?void 0:s.bind(h),c=null===(o=h.complete)||void 0===o?void 0:o.bind(h)}this.__isAsync&&(l=LM(l),a&&(a=LM(a)),c&&(c=LM(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof x&&e.add(u),u}};function wQ(){return this._results[Xp()]()}class ff{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Xp(),i=ff.prototype;i[t]||(i[t]=wQ)}get changes(){return this._changes||(this._changes=new cn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=Xo(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class kM{constructor(e){this.queryList=e,this.matches=null}clone(){return new kM(this.queryList)}setDirty(){this.queryList.setDirty()}}class BM{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new BM(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==f3(e,t).matches&&this.queries[t].setDirty()}}class c3{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class jM{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new jM(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class VM{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new VM(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,xQ(t,s)),this.matchTNodeWithReadOption(e,t,xd(t,e,s,!1,!1))}else i===ko?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,xd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Dn||r===Ms||r===ko&&4&t.type)this.addMatch(t.index,-2);else{const s=xd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function xQ(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function AQ(n,e,t,i){return-1===t?function(n,e){return 11&n.type?hg(n,e):4&n.type?fE(n,e):null}(e,n):-2===t?function(n,e,t){return t===Dn?hg(e,n):t===ko?fE(e,n):t===Ms?Rk(e,n):void 0}(n,e,i):Cd(n,n[1],t,e)}function u3(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:AQ(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function UM(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=u3(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const p=u[h];p[17]===p[3]&&UM(p[1],p,c,i)}if(null!==u[9]){const h=u[9];for(let p=0;p<h.length;p++){const g=h[p];UM(g[1],g,c,i)}}}}}return i}function Ni(n){const e=Lt(),t=mi(),i=lv();a_(i+1);const r=f3(t,i);if(n.dirty&&Fl(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?UM(t,e,i,[]):u3(t,e,r,i);n.reset(s,wk),n.notifyOnChanges()}return!0}return!1}function Ds(n,e,t){const i=mi();i.firstCreatePass&&(function(n,e,t){null===n.queries&&(n.queries=new jM),n.queries.track(new VM(e,t))}(i,new c3(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function(n,e,t){const i=new ff(4==(4&t));Iw(n,e,i,i.destroy),null===e[19]&&(e[19]=new BM),e[19].queries.push(new kM(i))}(i,Lt(),e)}function Pi(){return function(n,e){return n[19].queries[e].queryList}(Lt(),lv())}function f3(n,e){return n.queries.getByIndex(e)}const pf=new Ht("Application Initializer");let wg=(()=>{class n{constructor(t){this.appInits=t,this.resolve=dE,this.reject=dE,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Ry(s))t.push(s);else if(tE(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Oe(pf,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Jy=new Ht("AppId"),iZ={provide:Jy,useFactory:function(){return`${qM()}${qM()}${qM()}`},deps:[]};function qM(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const O3=new Ht("Platform Initializer"),kc=new Ht("Platform ID"),vE=new Ht("appBootstrapListener");let wE=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Ou=new Ht("LocaleId"),R3=new Ht("DefaultCurrencyCode");class sZ{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const YM=function(n){return new FM(n)},oZ=YM,aZ=function(n){return Promise.resolve(YM(n))},N3=function(n){const e=YM(n),i=ll(To(n).declarations).reduce((r,s)=>{const o=Li(s);return o&&r.push(new e3(o)),r},[]);return new sZ(e,i)},lZ=N3,cZ=function(n){return Promise.resolve(N3(n))};let gf=(()=>{class n{constructor(){this.compileModuleSync=oZ,this.compileModuleAsync=aZ,this.compileModuleAndAllComponentsSync=lZ,this.compileModuleAndAllComponentsAsync=cZ}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const P3=new Ht("compilerOptions"),dZ=(()=>Promise.resolve(0))();function KM(n){"undefined"==typeof Zone?dZ.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class mn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cn(!1),this.onMicrotaskEmpty=new cn(!1),this.onStable=new cn(!1),this.onError=new cn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=ti.requestAnimationFrame,e=ti.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ti,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,QM(n),n.isCheckStableRunning=!0,XM(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),QM(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return F3(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),L3(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return F3(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),L3(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,QM(n),XM(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!mn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(mn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,fZ,dE,dE);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const fZ={};function XM(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function QM(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function F3(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function L3(n){n._nesting--,XM(n)}class mZ{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cn,this.onMicrotaskEmpty=new cn,this.onStable=new cn,this.onError=new cn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let ZM=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{mn.assertNotInAngularZone(),KM(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())KM(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Oe(mn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),k3=(()=>{class n{constructor(){this._applications=new Map,JM.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return JM.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class _Z{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let JM=new _Z,B3=!0,j3=!1;function Na(){return j3=!0,B3}let Ql;const V3=new Ht("AllowMultipleToken");function U3(n,e,t=[]){const i=`Platform: ${e}`,r=new Ht(i);return(s=[])=>{let o=tD();if(!o||o.injector.get(V3,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:Cu,useValue:"platform"});!function(n){if(Ql&&!Ql.destroyed&&!Ql.injector.get(V3,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ql=n.get(z3);const e=n.get(O3,null);e&&e.forEach(t=>t())}(Gn.create({providers:a,name:i}))}return function(n){const e=tD();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function tD(){return Ql&&!Ql.destroyed?Ql:null}let z3=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new mZ:("zone.js"===n?void 0:n)||new mn({enableLongStackTrace:Na(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:mn,useValue:a}];return a.run(()=>{const c=Gn.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),h=u.injector.get(ta,null);if(!h)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const p=a.onError.subscribe({next:g=>{h.handleError(g)}});u.onDestroy(()=>{nD(this._modules,u),p.unsubscribe()})}),function(n,e,t){try{const i=t();return Ry(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(h,a,()=>{const p=u.injector.get(wg);return p.runInitializers(),p.donePromise.then(()=>(fM(u.injector.get(Ou,oE)||oE),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=H3({},i);return function(n,e,t){const i=new FM(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Xd);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${rt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Oe(Gn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function H3(n,e){return Array.isArray(e)?e.reduce(H3,n):Object.assign(Object.assign({},n),e)}let Xd=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new I(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new I(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{mn.assertNotInAngularZone(),KM(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{mn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=Ln(a,l.pipe(_s()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof yk?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Lc),a=r.create(Gn.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(ZM,null),u=c&&a.injector.get(k3);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),nD(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;nD(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(vE,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Oe(mn),Oe(Gn),Oe(ta),Oe(ml),Oe(wg))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function nD(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const GZ=U3(null,"core",[{provide:kc,useValue:"unknown"},{provide:z3,deps:[Gn]},{provide:k3,deps:[]},{provide:wE,deps:[]}]),KZ=[{provide:Xd,useClass:Xd,deps:[mn,Gn,ta,ml,wg]},{provide:ZX,deps:[mn],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:wg,useClass:wg,deps:[[new Xr,pf]]},{provide:gf,useClass:gf,deps:[]},iZ,{provide:fg,useFactory:function(){return WK},deps:[]},{provide:pg,useFactory:function(){return qK},deps:[]},{provide:Ou,useFactory:function(n){return fM(n=n||"undefined"!=typeof $localize&&$localize.locale||oE),n},deps:[[new Rd(Ou),new Xr,new ol]]},{provide:R3,useValue:"USD"}];let QZ=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Oe(Xd))},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({providers:KZ}),n})(),NE=null;function Bc(){return NE}const ln=new Ht("DocumentToken");let yf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:XJ,token:n,providedIn:"platform"}),n})();function XJ(){return Oe(_B)}let _B=(()=>{class n extends yf{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Bc().getBaseHref(this._doc)}onPopState(t){const i=Bc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Bc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){yB()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){yB()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Oe(ln))},n.\u0275prov=We({factory:ZJ,token:n,providedIn:"platform"}),n})();function yB(){return!!window.history.pushState}function ZJ(){return new _B(Oe(ln))}function Nu(n){return n&&"?"!==n[0]?"?"+n:n}let bf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:JJ,token:n,providedIn:"root"}),n})();function JJ(n){const e=Oe(ln).location;return new vB(Oe(yf),e&&e.origin||"")}const yD=new Ht("appBaseHref");let vB=(()=>{class n extends bf{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return function(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Nu(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Nu(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Nu(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(yf),Oe(yD,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();var hs=(()=>((hs=hs||{})[hs.Zero=0]="Zero",hs[hs.One=1]="One",hs[hs.Two=2]="Two",hs[hs.Few=3]="Few",hs[hs.Many=4]="Many",hs[hs.Other=5]="Other",hs))();const cee=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=WL(e);if(t)return t;const i=e.split("-")[0];if(t=WL(i),t)return t;if("en"===i)return xY;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[rn.PluralCase]};class HE{}let Bee=(()=>{class n extends HE{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(cee(i||this.locale)(t)){case hs.Zero:return"zero";case hs.One:return"one";case hs.Two:return"two";case hs.Few:return"few";case hs.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(Oe(Ou))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();let Fu=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new zee,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){RB("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){RB("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(Ms),De(ko))},n.\u0275dir=jt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class zee{constructor(){this.$implicit=null,this.ngIf=null}}function RB(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${rt(e)}'.`)}class Wee{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class qee{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const Yee=new qee,Kee=new Wee;let $E=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(Ry(t))return Yee;if(sL(t))return Kee;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${rt(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(De(rs,16))},n.\u0275pipe=Ls({name:"async",type:n,pure:!1}),n})(),Ws=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({providers:[{provide:HE,useClass:Bee}]}),n})();const BB="browser";class OD extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){NE||(NE=n)}(new OD)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(a0=a0||document.querySelector("base"),a0?a0.getAttribute("href"):null);return null==t?null:function(n){WE=WE||document.createElement("a"),WE.setAttribute("href",n);const e=WE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){a0=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let WE,a0=null;const zB=new Ht("TRANSITION_ID"),vte=[{provide:pf,useFactory:function(n,e,t){return()=>{t.get(wg).donePromise.then(()=>{const i=Bc(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[zB,ln,Gn],multi:!0}];class RD{static init(){!function(n){JM=n}(new RD)}addToWindow(e){ti.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},ti.getAllAngularTestabilities=()=>e.getAllTestabilities(),ti.getAllAngularRootElements=()=>e.getAllRootElements(),ti.frameworkStabilizers||(ti.frameworkStabilizers=[]),ti.frameworkStabilizers.push(i=>{const r=ti.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Bc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let wte=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const l0=new Ht("EventManagerPlugins");let YE=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Oe(l0),Oe(mn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class ND{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Bc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let GB=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),c0=(()=>{class n extends GB{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach($B),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach($B))}}return n.\u0275fac=function(t){return new(t||n)(Oe(ln))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function $B(n){Bc().remove(n)}const PD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},FD=/%COMP%/g;function KE(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?KE(n,r,t):(r=r.replace(FD,n),t.push(r))}return t}function YB(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let XE=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new LD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Wt.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new Lte(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Wt.ShadowDom:return new kte(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=KE(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Oe(YE),Oe(c0),Oe(Jy))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class LD{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(PD[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=PD[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=PD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Po.DashCase|Po.Important)?e.style.setProperty(t,i,r&Po.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Po.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,YB(i)):this.eventManager.addEventListener(e,t,YB(i))}}class Lte extends LD{constructor(e,t,i,r){super(e),this.component=i;const s=KE(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(FD,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(FD,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class kte extends LD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=KE(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Bte=(()=>{class n extends ND{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Oe(ln))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const QB=["alt","control","meta","shift"],$te={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ZB={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Wte={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let qte=(()=>{class n extends ND{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Bc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(QB.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&ZB.hasOwnProperty(e)&&(e=ZB[e]))}return $te[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),QB.forEach(s=>{s!=r&&Wte[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(Oe(ln))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const tne=U3(GZ,"browser",[{provide:kc,useValue:BB},{provide:O3,useValue:function(){OD.makeCurrent(),RD.init()},multi:!0},{provide:ln,useFactory:function(){return function(n){Gi=n}(document),document},deps:[]}]),nne=[[],{provide:Cu,useValue:"root"},{provide:ta,useFactory:function(){return new ta},deps:[]},{provide:l0,useClass:Bte,multi:!0,deps:[ln,mn,kc]},{provide:l0,useClass:qte,multi:!0,deps:[ln]},[],{provide:XE,useClass:XE,deps:[YE,c0,Jy]},{provide:uf,useExisting:XE},{provide:GB,useExisting:c0},{provide:c0,useClass:c0,deps:[ln]},{provide:ZM,useClass:ZM,deps:[mn]},{provide:YE,useClass:YE,deps:[l0,mn]},{provide:class{},useClass:wte,deps:[]},[]];let jD=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:Jy,useValue:t.appId},{provide:zB,useExisting:Jy},vte]}}}return n.\u0275fac=function(t){return new(t||n)(Oe(n,12))},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({providers:nne,imports:[Ws,QZ]}),n})();"undefined"!=typeof window&&window;class une extends x{constructor(e,t){super()}schedule(e,t=0){return this}}class QE extends une{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let ej=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class nc extends ej{constructor(e,t=ej.now){super(e,()=>nc.delegate&&nc.delegate!==this?nc.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return nc.delegate&&nc.delegate!==this?nc.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const fne=new class extends nc{}(class extends QE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),jc=new I(n=>n.complete());function ZE(n){return n?function(n){return new I(e=>n.schedule(()=>e.complete()))}(n):jc}function an(...n){let e=n[n.length-1];return xe(e)?(n.pop(),Ne(n,e)):In(n)}function Ag(n,e){return new I(e?t=>e.schedule(gne,0,{error:n,subscriber:t}):t=>t.error(n))}function gne({error:n,subscriber:e}){e.error(n)}class aa{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return an(this.value);case"E":return Ag(this.error);case"C":return ZE()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new aa("N",e):aa.undefinedValueNotification}static createError(e){return new aa("E",void 0,e)}static createComplete(){return aa.completeNotification}}aa.completeNotification=new aa("C"),aa.undefinedValueNotification=new aa("N",void 0);class JE extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(JE.dispatch,this.delay,new _ne(e,this.destination)))}_next(e){this.scheduleMessage(aa.createNext(e))}_error(e){this.scheduleMessage(aa.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(aa.createComplete()),this.unsubscribe()}}class _ne{constructor(e,t){this.notification=e,this.destination=t}}class Tg extends oe{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new yne(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new $;if(this.isStopped||this.hasError?o=x.EMPTY:(this.observers.push(e),o=new Z(this,e)),r&&e.add(e=new JE(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||fne).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class yne{constructor(e,t){this.time=e,this.value=t}}function Cr(n,e){return"function"==typeof e?t=>t.pipe(Cr((i,r)=>je(n(i,r)).pipe(ge((s,o)=>e(i,s,r,o))))):t=>t.lift(new bne(n))}class bne{constructor(e){this.project=e}call(e,t){return t.subscribe(new vne(e,this.project))}}class vne extends ve{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new _t(this),r=this.destination;r.add(i),this.innerSubscription=N(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const eS={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return eS.schedule(n,0);if(void 0===window.requestAnimationFrame)return eS.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let UD;function Ine(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!UD){const t=Element.prototype;UD=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&UD.call(n,e)}(n,r)||(i=s,0))),i}class Rne{constructor(e,t){this.componentFactory=t.get(ml).resolveComponentFactory(e)}create(e){return new Nne(this.componentFactory,e)}}class Nne{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new Tg(1),this.events=this.eventEmitters.pipe(Cr(i=>Ln(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(mn),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=eS.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=Gn.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=Ine(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(rs),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(Xd).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(ge(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=eS.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new Jm(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class Pne extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}const Lne={initialConfig:{},parse:{},rename:{}};class kne{constructor(e,t){this.configState=e,this.storedChanges={},this.options=Object.assign(Object.assign({},Lne),t)}addChanges(e){this.storedChanges=Object.assign(Object.assign({},this.storedChanges),e)}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,s=i.snapshot,o=Object.assign(Object.assign(Object.assign({},r),s),t);for(const[a,l]of Object.entries(e))this.processChange(a,l,o);i.setConfig(o)}processChange(e,t,i){var r,s;const{options:{parse:o,rename:a}}=this,l=null!==(r=a[e])&&void 0!==r?r:e,c=t.currentValue,u=null!==(s=o[e])&&void 0!==s?s:o[l];if(null==c)delete i[l];else if(u)try{i[l]=u(c)}catch(h){console.warn(`Failed to parse ${e} = ${c}`,h.message)}else i[l]=c}}let Bne=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new kne(this.configState,this.options)}ngOnInit(){var t;this._init=setTimeout(()=>this.initialize(),null!==(t=this.options.initialDelay)&&void 0!==t?t:0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}}return n.\u0275fac=function(t){!function(){throw new Error("invalid")}()},n.\u0275dir=jt({type:n,features:[Zi]}),n})();var zD;const u0={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org",hubmapToken:null!==(zD=localStorage.getItem("HUBMAP_TOKEN"))&&void 0!==zD?zD:""},googleAnalyticsToken:"portal.hubmapconsortium.org"===window.location.hostname?"G-1WRJHN9FM6":"G-J9HWV9QPJ4"};function Pa(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function nj(n,e){return function(t,i){e(t,i,n)}}function ic(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function Di(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function sj(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function GD(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||sj()}const oj="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",nS=GD();class zne{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function $D(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const aj={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function lj(n){return"string"==typeof n?aj[n.toUpperCase()]||aj.WHITE:n}function iS(n,e){if(!n)throw new Error(e||"Assertion failed")}const rc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},d0=rc.window||rc.self||rc.global,cj=rc.process||{};function Mg(){let n;if(nS&&d0.performance)n=d0.performance.now();else if(cj.hrtime){const e=cj.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const Dg={debug:nS&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Kne={enabled:!0,level:0};function wl(){}const uj={},dj={once:!0};function Xne(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let WD=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=oj,this._startTs=Mg(),this._deltaTs=Mg(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new zne("__probe-".concat(this.id,"__"),Kne),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Mg()-this._startTs).toPrecision(10))}getDelta(){return Number((Mg()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){iS(t,i)}warn(t){return this._getLogFunction(0,t,Dg.warn,arguments,dj)}error(t){return this._getLogFunction(0,t,Dg.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,Dg.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,Dg.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,Dg.debug||Dg.info,arguments,dj)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||wl,r&&[r],{tag:Xne(i)}):wl}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?nS?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=$D(r,e,t);console.log(...s)},r.src=n,wl}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...$D(n,e,t)),wl;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...$D(r,e,t)),r.src=n.toDataURL(),wl}return wl}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=Je(307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):wl}({image:r,message:s,scale:o}):wl}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||wl)}group(t,i,r={collapsed:!1}){r=fj({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||wl)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=hj(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=fj({logLevel:t,message:i,args:s,opts:o}),iS(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Mg();const a=o.tag||o.message;if(o.once){if(uj[a])return wl;uj[a]=Mg()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!nS&&"string"==typeof n&&(e&&(e=lj(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=lj(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return wl}}return n.VERSION=oj,n})();function hj(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return iS(Number.isFinite(e)&&e>=0),e}function fj(n){const{logLevel:e,message:t}=n;n.logLevel=hj(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return iS("string"===r||"object"===r),Object.assign(n,n.opts)}const xi=new WD({id:"deck"}),Fi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Fi,"IDENTITY",{get:()=>xi.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const Vc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},pj={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},un=new WD({id:"luma.gl"});function Vo(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function rS(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function _i(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function sS(n){return Vo(rS(n),"Invalid WebGLRenderingContext"),n}function wo(n){return Vo(_i(n),"Requires WebGL2"),n}const h0={};const f0=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(f0.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Ef=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(h0[i]=!0)}while(0!==i);for(i in h0)if(h0[i])return delete h0[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const h=t.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,s);const p=h.attribs[s];return p.buffer=t.currentArrayBuffer,p.size=o,p.type=a,p.normalized=l,p.stride=c,p.offset=u,p.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{globalThis.console&&globalThis.console.log&&globalThis.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};Ef.prototype.VERTEX_ARRAY_BINDING_OES=34229,Ef.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new f0(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Ef.prototype.createVertexArrayOES=function(){const e=new f0(this);return this.vertexArrayObjects.push(e),e},Ef.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Ef.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof f0&&e.hasBeenBound&&e.ext===this)},Ef.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){h0[n]=!0,void 0!==e&&function(n){globalThis.console&&globalThis.console.error&&globalThis.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=r?r.attribs[l]:null;if((!r||c.enabled!==u.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let h=!1;(!r||c.buffer!==u.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),h=!0),(h||c.cached!==u.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const gj="OES_element_index",mj="WEBGL_draw_buffers",_j="WEBGL_debug_renderer_info",mr=n=>_i(n)?void 0:0,_ie={3074:n=>_i(n)?void 0:36064,35723:n=>_i(n)?void 0:4352,35977:mr,32937:mr,36795:(n,e)=>{const t=_i(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(_j);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(_j);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:mr,35071:mr,37447:mr,36063:(n,e)=>{if(!_i(n)){const t=n.getExtension(mj);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:mr,35374:mr,35377:mr,34852:n=>{if(!_i(n)){const e=n.getExtension(mj);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(gj)?2147483647:65535,33001:n=>n.getExtension(gj)?16777216:65535,33e3:n=>16777216,37157:mr,35373:mr,35657:mr,36183:mr,37137:mr,34045:mr,35978:mr,35979:mr,35968:mr,35376:mr,35375:mr,35659:mr,37154:mr,35371:mr,35658:mr,35076:mr,35077:mr,35380:mr},yj="ANGLE_instanced_arrays",bj={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Vo(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[yj]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){Vo(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Vo(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Vo(!1)},deleteQuery:()=>{Vo(!1)},beginQuery:()=>{Vo(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},qD={readBuffer:(n,e,t)=>{_i(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:_i(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!_i(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!_i(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=_ie[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function Die(n,{extension:e,target:t,target2:i}){const r=bj[e];Vo(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let u=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?u=(...h)=>a[c](...h):"function"==typeof r[l]&&(u=r[l].bind(t))),u&&(t[l]=u,i[l]=u)}}globalThis.polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Ef(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&Die(n,{extension:t,target:n.luma,target2:n})}(n,bj),function(n,{target:e,target2:t}){Object.keys(qD).forEach(i=>{if("function"==typeof qD[i]){const r=n[i]?n[i].bind(n):()=>{},s=qD[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const YD={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Jd=(n,e,t)=>e?n.enable(t):n.disable(t),vj=(n,e,t)=>n.hint(t,e),Fa=(n,e,t)=>n.pixelStorei(t,e);function p0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const Rie={3042:Jd,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:Jd,2885:(n,e)=>n.cullFace(e),2929:Jd,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:Jd,35723:vj,36006:(n,e)=>{const t=_i(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:vj,2849:(n,e)=>n.lineWidth(e),32823:Jd,32824:"polygonOffset",10752:"polygonOffset",35977:Jd,32938:"sampleCoverage",32939:"sampleCoverage",3089:Jd,3088:(n,e)=>n.scissor(...e),2960:Jd,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Fa,3317:Fa,37440:Fa,37441:Fa,37443:Fa,3330:Fa,3332:Fa,3331:Fa,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Fa,32878:Fa,3316:Fa,3315:Fa,32877:Fa,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=p0(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=p0(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=p0(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=p0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=p0(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function Zr(n,e,t){return void 0!==e[n]?e[n]:t[n]}const Nie={blendEquation:(n,e,t)=>n.blendEquationSeparate(Zr(32777,e,t),Zr(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(Zr(32969,e,t),Zr(32968,e,t),Zr(32971,e,t),Zr(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(Zr(32824,e,t),Zr(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(Zr(32938,e,t),Zr(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,Zr(2962,e,t),Zr(2967,e,t),Zr(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,Zr(34816,e,t),Zr(36003,e,t),Zr(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,Zr(2964,e,t),Zr(2965,e,t),Zr(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,Zr(34817,e,t),Zr(34818,e,t),Zr(34819,e,t))},wj={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Uc=(n,e)=>n.isEnabled(e),Ej={3042:Uc,2884:Uc,2929:Uc,3024:Uc,32823:Uc,32926:Uc,32928:Uc,3089:Uc,2960:Uc,35977:Uc};function Sj(n){for(const e in n)return!1;return!0}function Pie(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function xj(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache&&n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function Fie(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class kie{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||YD)){const r=e,s=Ej[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=Ej[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},YD),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Vo(this.stateStack.length>0),Lu(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Vo(void 0!==s);const o=e[s],a=this.cache[s];Pie(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function Cj(n,e={}){const{enable:t=!0,copyState:i}=e;if(Vo(void 0!==i),!n.state){const{polyfillContext:r}=globalThis;r&&r(n),n.state=new kie(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const s in wj)Fie(n,s,wj[s]);xj(n,"getParameter"),xj(n,"isEnabled")}return n.state.enable=t,n}function Aj(n){Vo(n.state),n.state.pop()}function Lu(n,e){if(Vo(rS(n),"setParameters requires a WebGL context"),Sj(e))return;const t={};for(const r in e){const s=Number(r),o=Rie[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)Nie[r](n,e,i)}function sc(n,e,t){if(Sj(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||Cj(n,{copyState:!1}),n.state.push()}(n),Lu(n,e),i)r=t(n),Aj(n);else try{r=t(n)}finally{Aj(n)}return r}function oS(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||function(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent;return!!(e&&e.indexOf("Electron")>=0)}()}function Ig(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function KD(n,e,t=!0){return function(n,e,t,i,r){const s=Tj(n[0],e,t);let o=Mj(n[1],e,i,r),a=Tj(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=Mj(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,Ig(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function Tj(n,e,t){return Math.min(Math.round(n*e),t-1)}function Mj(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const XD=oS(),Gie=XD&&"undefined"!=typeof document,Dj={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Ij(n={}){Vo(XD,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},Dj,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(Gie&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=QD(r,n),function(n){const e=_i(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);un.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function QD(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},Dj,e);const{manageState:t,debug:i}=e;return t&&Cj(n,{copyState:!1,log:(...r)=>un.log(1,...r)()}),XD&&i&&(globalThis.makeDebugContext?(n=globalThis.makeDebugContext(n,e),un.level=Math.max(un.level,1)):un.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function Oj(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class Rj{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Oj(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Oj()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class ZD{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof Rj?e:new Rj(t,i)),this.stats[t]}}const g0="8.5.12",Sf=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new ZD({id:e})),this.stats.get(e)}};if(globalThis.luma&&globalThis.luma.VERSION!==g0)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${g0}`);function en(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function JD(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return en(void 0!==i,`Accessing undefined constant GL.${e}`),i}function eh(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}globalThis.luma||(oS()&&un.log(1,`luma.gl ${g0} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=globalThis.luma||{VERSION:g0,version:g0,log:un,stats:Sf,globals:{modules:{},nodeIO:{}}}),globalThis;const eI={};function la(n="id"){return eI[n]=eI[n]||1,`${n}-${eI[n]++}`}function Nj(n){return en("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function Og(n){let e=!0;for(const t in n){e=!1;break}return e}function Pj(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw un.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const Rg="Resource subclass must define virtual methods";class ku{get[Symbol.toStringTag](){return"Resource"}constructor(e,t={}){sS(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||la(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){en(e=JD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=_i(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=_i(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const h=i?eh(this.gl,l):l;o[h]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[h]=eh(this.gl,o[h]))}}return o}setParameter(e,t){en(e=JD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=_i(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=JD(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return Pj(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Rg)}_deleteHandle(){throw new Error(Rg)}_bindHandle(e){throw new Error(Rg)}_getOptsFromHandle(){throw new Error(Rg)}_getParameter(e,t){throw new Error(Rg)}_setParameter(e,t){throw new Error(Rg)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],t=Sf.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Sf.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const i=Sf.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=Sf.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function tI(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function m0(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function nre({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function nI(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&un.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&un.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];un.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const ire={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},rre={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ca{static getBytesPerElement(e){return m0(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return en(e.size),m0(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new ca(...[ire,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ca.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ca.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=nI("Accessor",e,rre)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const Lj={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},sre={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Lj},ore={removedProps:Lj};class lr extends ku{get[Symbol.toStringTag](){return"Buffer"}constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/ca.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/ca.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=nI("Buffer",e,sre),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=nI("Buffer",e,ore))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new ca(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;en(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(wo(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return wo(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){wo(this.gl);const s=m0(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const u=Math.min(o,l);return en((r=r||u)<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(en(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){en(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=tI(e);return en(s),this.setAccessor(new ca(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){en(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/m0(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new ca(this.accessor,{type:tI(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return un.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return un.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return un.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return un.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ca(this.accessor,e),this}}const iI={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},kj={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Bj={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},cre=[9729,9728],jj=globalThis.WebGLBuffer||function(){};class xf extends ku{get[Symbol.toStringTag](){return"Texture"}static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=iI[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=_i(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=iI[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=la("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(U=>this.initialize(Object.assign({},e,{pixels:U,data:U}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u}=e;t||(t=r);let{width:h,height:p,dataFormat:g,type:m,compressed:w=!1,mipmaps:C=!0}=e;const{depth:H=0}=e;return({width:h,height:p,compressed:w,dataFormat:g,type:m}=this._deduceParameters({format:s,type:m,dataFormat:g,compressed:w,data:t,width:h,height:p})),this.width=h,this.height=p,this.depth=H,this.format=s,this.type=m,this.dataFormat=g,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),C&&this._isNPOT()&&(un.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),C=!1,this._updateForNPOT(l)),this.mipmaps=C,this.setImageData({data:t,width:h,height:p,depth:H,format:s,type:m,dataFormat:g,border:o,mipmaps:C,parameters:c,compressed:w}),C&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(un.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),sc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:h=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=e;c||(c=i),({type:u,dataFormat:g,compressed:m,width:h,height:p}=this._deduceParameters({format:s,type:u,dataFormat:g,compressed:m,data:c,width:h,height:p}));const{gl:w}=this;w.bindTexture(this.target,this.handle);let C=null;({data:c,dataType:C}=this._getDataType({data:c,compressed:m}));let H,U=0;return sc(this.gl,l,()=>{switch(C){case"null":w.texImage2D(t,r,s,h,p,o,g,u,c);break;case"typed-array":w.texImage2D(t,r,s,h,p,o,g,u,c,a);break;case"buffer":H=wo(w),H.bindBuffer(35052,c.handle||c),H.texImage2D(t,r,s,h,p,o,g,u,a),H.bindBuffer(35052,null);break;case"browser-object":_i(w)?w.texImage2D(t,r,s,h,p,o,g,u,c):w.texImage2D(t,r,s,g,u,c);break;case"compressed":for(const[de,Ce]of c.entries())w.compressedTexImage2D(t,de,Ce.format,Ce.width,Ce.height,o,Ce.data),U+=Ce.levelSize;break;default:en(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===C?U:c&&c.byteLength?c.byteLength:this.width*this.height*(kj[this.dataFormat]||4)*(Bj[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:p=!1,offset:g=0,border:m=this.border,parameters:w={}}){if(({type:u,dataFormat:h,compressed:p,width:o,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:p,data:i,width:o,height:a})),en(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const C=i;i=C.data,o=C.shape[0],a=C.shape[1]}i instanceof lr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),sc(this.gl,w,()=>{if(p)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,h,u,i,g);else if(i instanceof jj){const C=wo(this.gl);C.bindBuffer(35052,i),C.texSubImage2D(e,l,r,s,o,a,h,u,g),C.bindBuffer(35052,null)}else _i(this.gl)?wo(this.gl).texSubImage2D(e,l,r,s,o,a,h,u,i):this.gl.texSubImage2D(e,l,r,s,h,u,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return un.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof lr?{data:e.handle,dataType:"buffer"}:e instanceof jj?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=iI[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},en(r,"Could not deduced texture size"),en(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),en(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:en(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(_i(this.gl)||!this.width||!this.height||Nj(this.width)&&Nj(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===cre.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function ure(n,e){return en("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class ua extends xf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return xf.isSupported(e,t)}constructor(e,t={}){sS(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:ure(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Cf="EXT_color_buffer_float",Vj={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Cf,bpp:2},33327:{gl2:Cf,bpp:4},34842:{gl2:Cf,bpp:8},33326:{gl2:Cf,bpp:4},33328:{gl2:Cf,bpp:8},34836:{gl2:Cf,bpp:16},35898:{gl2:Cf,bpp:4}};class Ng extends ku{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=_i(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,Vj)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return en(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&_i(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Vj[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const $j="clear: bad arguments";function sI(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),en(0!==o,$j),sc(n,s,()=>{n.clear(o)})}function Wj(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function ni(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){Wj(s,i,r,o,a,"next",l)}function a(l){Wj(s,i,r,o,a,"throw",l)}o(void 0)})}}const oI=[34069,34070,34071,34072,34073,34074];let _re=(()=>{class n extends xf{get[Symbol.toStringTag](){return"TextureCube"}constructor(t,i={}){sS(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return ni(function*(){const{gl:u}=c,h=r||s,p=yield Promise.all(oI.map(g=>{const m=h[g];return Promise.all(Array.isArray(m)?m:[m])}));c.bind(),oI.forEach((g,m)=>{p[m].length>1&&!1!==c.opts.mipmaps&&un.warn(`${c.id} has mipmap and multiple LODs.`)(),p[m].forEach((w,C)=>{t&&i?u.texImage2D(g,C,a,t,i,o,a,l,w):u.texImage2D(g,C,a,a,l,w)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:u=5121}=t,{gl:h}=this,p=o||a;return this.bind(),p instanceof Promise?p.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?h.texImage2D(i,0,c,r,s,l,c,u,p):h.texImage2D(i,0,c,c,u,p),this}}return n.FACES=oI,n})();class yre extends xf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return _i(e)}constructor(e,t={}){wo(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),sc(this.gl,h,()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,u),u instanceof lr&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(u&&u.byteLength?u.byteLength:this.width*this.height*this.depth*(kj[this.dataFormat]||4)*(Bj[this.type]||1),"Texture"),this.loaded=!0,this}}function qj(n,e){en(n instanceof ua||n instanceof _re||n instanceof yre);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},e))}function bre(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Os(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function aS(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=_0(n);en(u);const{gl:p,handle:g,attachments:m}=u;a=a||u.width,l=l||u.height,36064===s&&null===g&&(s=1028),en(m[s]),c=c||m[s].type,o=function(n,e,t,i,r){if(n)return n;return new(m0(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return en(!1),0}}(t))}(o,c,r,a,l),c=c||tI(o);const w=p.bindFramebuffer(36160,g);return p.readPixels(t,i,a,l,r,c,o),p.bindFramebuffer(36160,w||null),h&&u.delete(),o}function aI(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=aS(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=nre({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}function _0(n){return n instanceof Os?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:bre(n),deleteFramebuffer:!0}}const Yj="Multiple render targets not supported";class Os extends ku{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Os(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=wo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=wo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(en(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const u in i){const h=i[u];(Array.isArray(h)?h[0]:h).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return en(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&un.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){en(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof Ng)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,h=0,p=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:h,level:p})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(Os.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&sI(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){wo(n),sc(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:en(!1,$j)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return un.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return un.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return un.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return un.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return un.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return un.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=wo(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=eh(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?eh(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?eh(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(aI(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>un.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=aI(this,{targetMaxHeight:100});return un.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new ua(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new Ng(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new Ng(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&en(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof Ng?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:wo(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:en(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return _i(n)?n:null}(this.gl);t?t.readBuffer(e):en(36064===e||1029===e,Yj),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=wo(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):en(1===e.length&&(36064===e[0]||1029===e[0]),Yj)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in Kj)void 0===n.luma.caps[e]&&(n.luma.caps[e]=Qj(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Os.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Kj={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new ua(n,{format:6408,type:5126,dataFormat:6408}),t=new Os(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function lI(n,e){return Xj(n,e)}function Xj(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>Qj(n,t))}function Qj(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=Kj[e];let i;en(t,e);const r=_i(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:en(!1);return i}(n,e)),n.luma.caps[e]||un.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class cI{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return ot(ot({},this.source.getAccessor()),this.opts)}}const y0=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h;l&&(h=l*i+s);const p=this._allocate(c,u,a,h);return e&&o?p.set(e):a||p.fill(0,0,4),this._release(e),p}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},Ore=1/Math.PI*180,Rre=1/180*Math.PI,Ar={};function Pre(n,{precision:e=Ar.precision||4}={}){return n=function(n){return Math.round(n/Ar.EPSILON)*Ar.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function th(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Bu(n,e,t){if(th(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function Zj(n){return function(n,e){return Bu(n,t=>t*Rre,void 0)}(n)}function Lre(n){return function(n,e){return Bu(n,t=>t*Ore,void 0)}(n)}function La(n,e,t){return Bu(n,i=>Math.max(e,Math.min(t,i)))}function lS(n,e,t){return th(n)?n.map((i,r)=>lS(i,e[r],t)):t*e+(1-t)*n}function b0(n,e,t){const i=Ar.EPSILON;t&&(Ar.EPSILON=t);try{if(n===e)return!0;if(th(n)&&th(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!b0(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Ar.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Ar.EPSILON=i}}function ju(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}Ar.EPSILON=1e-12,Ar.debug=!1,Ar.precision=4,Ar.printTypes=!1,Ar.printDegrees=!1,Ar.printRowMajor=!0;class cS extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return ju(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:th(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ar)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+Pre(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!b0(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Ar.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function er(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function v0(n,e,t=""){if(Ar.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const Jj={};function Pg(n,e){Jj[n]||(Jj[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class zre extends cS{get ELEMENTS(){return ju(!1),0}copy(e){return ju(!1),this}get x(){return this[0]}set x(e){this[0]=er(e)}get y(){return this[1]}set y(e){this[1]=er(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return er(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return er(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return ju(e>=0&&e<this.ELEMENTS,"index is out of range"),er(this[e])}setComponent(e,t){return ju(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var zc=1e-6,da="undefined"!=typeof Float32Array?Float32Array:Array;function eV(){var n=new da(3);return da!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function tV(n,e,t){var i=new da(3);return i[0]=n,i[1]=e,i[2]=t,i}function nV(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function w0(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function uI(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function uS(n,e,t){var i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function iV(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],u=r*c-s*l,h=s*a-i*c,p=i*l-r*a,g=r*p-s*h,m=s*u-i*p,w=i*h-r*u,C=2*t[3];return h*=C,p*=C,m*=2,w*=2,n[0]=a+(u*=C)+(g*=2),n[1]=l+h+m,n[2]=c+p+w,n}function rV(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function sV(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function oV(n,e,t,i){var r=[],s=[];return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function aV(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),h=u&&nV(n,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function lV(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}eV();const dI=[0,0,0],cV={};class Eo extends zre{static get ZERO(){return cV.ZERO=cV.ZERO||Object.freeze(new Eo(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&th(e)?this.copy(e):(Ar.debug&&(er(e),er(t),er(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ar.debug&&(er(e.x),er(e.y),er(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=er(e)}angle(e){return aV(this,e)}cross(e){return w0(this,this,e),this.check()}rotateX({radians:e,origin:t=dI}){return rV(this,this,t,e),this.check()}rotateY({radians:e,origin:t=dI}){return sV(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=dI}){return oV(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return uI(this,this,e),this.check()}transformAsVector(e){return lV(this,this,e),this.check()}transformByMatrix3(e){return uS(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return iV(this,this,e),this.check()}}const uV=new Eo;function Fg(n,e,t,i){uV.set(n,e,t);const r=uV.len();return{distance:i/r,normal:new Eo(-n/r,-e/r,-t/r)}}function nse(n){return n-Math.fround(n)}let S0;function hI(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;S0=y0.allocate(S0,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];S0[o+a]=l,S0[o+a+e]=nse(l)}o+=2*e}return S0.subarray(0,r*e*2)}function dS(n){return n.stride||n.size*n.bytesPerElement}function dV(n,e){e.offset&&xi.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=dS(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return wn(ot({},e),{offset:s,stride:t})}function oc(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const hV=[],fV=[];function hS(n,e=0,t=1/0){let i=hV;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(fV.length=n.length,i=fV):i=hV,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function pV(n){return n&&n[Symbol.asyncIterator]}function fI(n,e=(()=>!0)){return Array.isArray(n)?gV(n,e,[]):e(n)?[n]:[]}function gV(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?gV(r,e,t):e(r)&&t.push(r)}return t}function ose({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const ase=[],fS=[[0,1/0]];function pI({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let u=0;u<r;u++)e[t+l]=c[u]||0,l++}}const use={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function mV(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",ot(ot(ot({},use[n.type]),e),n)):null}function _V(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function yV(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function bV(n){n.push(n.shift())}function gI(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function vV({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,u=r&&c,h=gI(t,e),p=t.state.constant;if(!u&&i>=h)return;const g=p?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!p){const H=s;s=(U,de)=>t._normalizeConstant(H(U,de))}const m=p?(H,U)=>s(g,U):(H,U)=>s(g.subarray(H,H+a),U),w=n.getData({length:i}),C=new Float32Array(h);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return pI({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((u,h)=>i(u+a,h)),c=Math.min(r.length,s.length);for(let u=1;u<c;u++){const h=r[u]*t,p=s[u]*t;pI({source:n.subarray(o,h),target:e,start:a,end:p,size:t,getData:l}),o=h,a=p}a<e.length&&pI({source:[],target:e,start:a,size:t,getData:l})})({source:w,target:C,sourceStartIndices:r,targetStartIndices:c,size:a,getData:m}),n.byteLength<C.byteLength+l&&n.reallocate(C.byteLength+l),n.subData({data:C,offset:l})}class mI extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&lI(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new lr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*dS(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),y0.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=dV(n,e);return{high:t,low:wn(ot({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new cI(this,s.high),i["".concat(e,"64Low")]=r?new cI(this,s.low):new Float32Array(this.size),i}if(t){const i=dV(this.getAccessor(),t);return{[e]:new cI(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof lr&&(e={buffer:e});const i=ot(ot({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=dS(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=dS(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=hI(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?hI(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=y0.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?hI(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&xi.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:fS,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return mV(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===fS||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=fS}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=ase}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==fS}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(r,this,{data:t,startRow:c,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,u]of s){const h=Number.isFinite(c)?this.getVertexOffset(c):0,p=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:p})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(oc(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(u,{index:h,target:p})=>{if(!r){const C=h*a+l;for(let H=0;H<e;H++)p[H]=n[C+H];return p}const g=r[h],m=r[h+1]||c;let w;if(s){w=new Array(m-g);for(let C=g;C<m;C++){const H=C*a+l;p=new Array(e);for(let U=0;U<e;U++)p[U]=n[H+U];w[C-g]=p}}else if(a===e)w=n.subarray(g*e+l,m*e+l);else{w=new n.constructor((m-g)*e);let C=0;for(let H=g;H<m;H++){const U=H*a+l;for(let de=0;de<e;de++)w[C++]=n[U+de]}}return w}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:p,transform:g}=a,m=l.binaryAccessor||("function"==typeof p?p:s[p]);oc("function"==typeof m,'accessor "'.concat(p,'" is not a function'));let w=e.getVertexOffset(i);const{iterable:C,objectInfo:H}=hS(t,i,r);for(const U of C){H.index++;let de=m(U,H);if(g&&(de=g.call(this,de)),h){const Ce=(H.index<h.length-1?h[H.index+1]:o)-h[H.index];if(de&&Array.isArray(de[0])){let Pe=w;for(const Be of de)e._normalizeValue(Be,c,Pe),Pe+=u}else de&&de.length>u?c.set(de,w):(e._normalizeValue(de,H.target,0),ose({target:c,source:H.target,start:w,count:Ce}));w+=Ce*u}else e._normalizeValue(de,c,w),w+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let _I={};function So(n){xi.level>0&&_I[n]&&_I[n].call(...arguments)}function ka(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const wV="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",fse=`#version 300 es\n${wV}`;function EV(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function SV(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?fse:e>300?`#version ${e}\n${wV}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return ka(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class xV extends ku{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return _i(e)}constructor(e,t={}){wo(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Og(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,un.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof lr?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class _se{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof lr?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&en(_i(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new xV(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],en(i[s]instanceof lr)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new lr(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function CV(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const x0="vs",vse={[x0]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},pS="__LUMA_INJECT_DECLARATIONS__",AV=/void\s+main\s*\([^)]*\)\s*\{\n?/,TV=/}\n?[^{}]*$/,bI=[];function MV(n,e,t,i=!1){const r=e===x0;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),bI.length=o.length;for(let l=0,c=o.length;l<c;++l)bI[l]=o[l].injection;const a=`${bI.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(pS,a));break;case"vs:#main-start":r&&(n=n.replace(AV,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(TV,l=>a+l));break;case"fs:#decl":r||(n=n.replace(pS,a));break;case"fs:#main-start":r||(n=n.replace(AV,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(TV,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(pS,""),i&&(n=n.replace(/\}\s*$/,s=>s+vse[e])),n}function vI(n){const e={};return ka(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const wse={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},gS="transform_uSize_",DV="transform_position";const Dse={10241:9728,10240:9728,10242:33071,10243:33071};class Ose{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const h in this.samplerTextureMap)a[h]=i[this.samplerTextureMap[h]];this._setSourceTextureParameters();const u=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${gS}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${gS}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=aS(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return ka(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof ua)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new lr(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Os(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(Dse)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=qj(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const u=l.split("\n"),h=u.slice();if(u.forEach((p,g,m)=>{if(s>0){const w=function(n,e){const t={},i=function(n){return EV(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${gS}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),h=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return ka(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":h},samplerTextureMap:t}}return null}(p,e);if(w){const{updatedLine:C,inject:H}=w;h[g]=C,c=vI([c,H]),Object.assign(a,w.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=EV(n,["varying","out"]);return t&&t.name===e?t.type:null}(p,t))}),t){en(i);const p=`${gS}${t}`;c=vI([c,{"vs:#decl":`uniform vec2 ${p};\n`,"vs:#main-start":`     vec2 ${DV} = transform_getPos(${p});\n     gl_Position = vec4(${DV}, 0, 1.);\n`}])}l=h.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=vI([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||SV({version:CV(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[wse].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const wI={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function Nse(n){let e=IV(n);return"object"===e?n?"type"in n?Object.assign({},n,wI[n.type]):"value"in n?(e=IV(n.value),Object.assign({type:e},n,wI[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},wI[e])}function IV(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class EI{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}){ka("string"==typeof e),this.name=e,this.vs=t||u,this.fs=i||h,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=Nse(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:ka(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&ka(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function kse(n){return function(n){const e={},t={};return SI({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(RV(n))}function SI({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&SI({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function RV(n,e){return n.map(t=>(t instanceof EI||(ka("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),ka(t.name,"shader module has no name"),(t=new EI(t)).dependencies=RV(t.dependencies)),t))}const xI={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Af={};function $se(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(xI).forEach(n=>{Af[n]=n});const CI={};function NV(n,e,t={}){const i=xI[e];if(ka(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in CI)return CI[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),CI[e]=l,l}function mS(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=xI[e];ka(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return ka(!1===r||!0===r),r}(n,t))}function Lg(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const PV=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Kse=[...PV,[Lg("attribute"),"in $1"],[Lg("varying"),"out $1"]],Xse=[...PV,[Lg("varying"),"in $1"]],FV=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Qse=[...FV,[Lg("in"),"attribute $1"],[Lg("out"),"varying $1"]],Zse=[...FV,[Lg("in"),"varying $1"]],AI="gl_FragColor",TI=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Jse=/void\s+main\s*\([^)]*\)\s*\{\n?/;function _S(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const ioe=`\n\n${pS}\n\n`,LV={[x0]:"vertex",fs:"fragment"};function kV(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:u}){ka("string"==typeof t,"shader source must be a string");const h=i===x0,p=t.split("\n");let g=100,m="",w=t;0===p[0].indexOf("#version ")?(g=300,m=p[0],w=p.slice(1).join("\n")):m=`#version ${g}`;const C={};r.forEach(Be=>{Object.assign(C,Be.getDefines())}),Object.assign(C,s);let H=c?`${m}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${LV[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${LV[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:$se(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return mS(n,Af.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),mS(n,Af.GLSL_DERIVATIVES)&&NV(n,Af.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),mS(n,Af.GLSL_FRAG_DATA)&&NV(n,Af.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),mS(n,Af.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(C)}\n${h?"":"precision highp float;\n\n"}\n`:`${m}\n`;const U=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),de={},Ce={},Pe={};for(const Be in a){const et="string"==typeof a[Be]?{injection:a[Be],order:0}:a[Be],wt=Be.match(/^(v|f)s:(#)?([\w-]+)$/);if(wt){const xt=wt[3];wt[2]?"decl"===xt?Ce[Be]=[et]:Pe[Be]=[et]:de[Be]=[et]}else Pe[Be]=[et]}for(const Be of r){u&&Be.checkDeprecations(w,u),H+=Be.getModuleSource(i,g);const wt=Be.injections[i];for(const vt in wt){const xt=vt.match(/^(v|f)s:#([\w-]+)$/);if(xt){const zt="decl"===xt[2]?Ce:Pe;zt[vt]=zt[vt]||[],zt[vt].push(wt[vt])}else de[vt]=de[vt]||[],de[vt].push(wt[vt])}}return H+=ioe,H=MV(H,i,Ce),H+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(U[i],de),H+=w,H=MV(H,i,Pe),H=function(n,e,t){switch(e){case 300:return t?_S(n,Kse):function(n){const e=(n=_S(n,Xse)).match(TI);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${AI}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace(Jse,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${AI}\\b`,"g"),t)}return n}(n);case 100:return t?_S(n,Qse):function(n){const e=(n=_S(n,Zse)).match(TI);if(e){const t=e[1];n=n.replace(TI,"").replace(new RegExp(`\\b${t}\\b`,"g"),AI)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(H,l?100:g,h),H}function ooe(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const hoe={5126:Tr.bind(null,"uniform1fv",Ba,1,xo),35664:Tr.bind(null,"uniform2fv",Ba,2,xo),35665:Tr.bind(null,"uniform3fv",Ba,3,xo),35666:Tr.bind(null,"uniform4fv",Ba,4,xo),5124:Tr.bind(null,"uniform1iv",nh,1,xo),35667:Tr.bind(null,"uniform2iv",nh,2,xo),35668:Tr.bind(null,"uniform3iv",nh,3,xo),35669:Tr.bind(null,"uniform4iv",nh,4,xo),35670:Tr.bind(null,"uniform1iv",nh,1,xo),35671:Tr.bind(null,"uniform2iv",nh,2,xo),35672:Tr.bind(null,"uniform3iv",nh,3,xo),35673:Tr.bind(null,"uniform4iv",nh,4,xo),35674:Tr.bind(null,"uniformMatrix2fv",Ba,4,Vu),35675:Tr.bind(null,"uniformMatrix3fv",Ba,9,Vu),35676:Tr.bind(null,"uniformMatrix4fv",Ba,16,Vu),35678:to,35680:to,5125:Tr.bind(null,"uniform1uiv",yS,1,xo),36294:Tr.bind(null,"uniform2uiv",yS,2,xo),36295:Tr.bind(null,"uniform3uiv",yS,3,xo),36296:Tr.bind(null,"uniform4uiv",yS,4,xo),35685:Tr.bind(null,"uniformMatrix2x3fv",Ba,6,Vu),35686:Tr.bind(null,"uniformMatrix2x4fv",Ba,8,Vu),35687:Tr.bind(null,"uniformMatrix3x2fv",Ba,6,Vu),35688:Tr.bind(null,"uniformMatrix3x4fv",Ba,12,Vu),35689:Tr.bind(null,"uniformMatrix4x2fv",Ba,8,Vu),35690:Tr.bind(null,"uniformMatrix4x3fv",Ba,12,Vu),35678:to,35680:to,35679:to,35682:to,36289:to,36292:to,36293:to,36298:to,36299:to,36300:to,36303:to,36306:to,36307:to,36308:to,36311:to},foe={},poe={},goe={},BV=[0];function MI(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(BV[0]=n,n=BV);const r=n.length;if(r%e&&un.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Ba(n,e){return MI(n,e,Float32Array,foe)}function nh(n,e){return MI(n,e,Int32Array,poe)}function yS(n,e){return MI(n,e,Uint32Array,goe)}function jV(n,e,t){const i=hoe[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function moe(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function yoe(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof xf||n instanceof Ng)||n instanceof Os&&Boolean(n.texture)}function boe(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function to(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Tr(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),s=u,h=!0;else{en(s===u,"Uniform length cannot change.");for(let p=0;p<u;++p)if(c[p]!==r[p]){h=!0;break}}return h&&(i(o,n,a,c),r.set(c)),h}}function xo(n,e,t,i){n[e](t,i)}function Vu(n,e,t,i){n[e](t,!1,i)}function bS(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function UV(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=zV(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function zV(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class C0 extends ku{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return en(!1),"unknown"}}constructor(e,t){sS(e),en("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:bS(t.source,null)||t.id||la(`unnamed ${C0.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=bS(e,null);t&&(this.id=la(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${C0.getTypeName(this.shaderType)}:${this.id}`}getName(){return bS(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||bS(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let u=0;u<r.length;u++){const h=r[u];if(h.length<=1)continue;const p=h.split(":"),g=p[0],m=parseInt(p[2],10);if(isNaN(m))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[m]=h:o[m]=h}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return zV(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:UV(s,c),warnings:UV(o,c)}}(i,this.source,this.shaderType,this.id);throw un.error(`GLSL compilation errors in ${r}\n${s}`)(),un.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class DI extends C0{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class II extends C0{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Rs=5126,A0=5124,T0=5125,OI={[Rs]:[Rs,1,"float"],35664:[Rs,2,"vec2"],35665:[Rs,3,"vec3"],35666:[Rs,4,"vec4"],[A0]:[A0,1,"int"],35667:[A0,2,"ivec2"],35668:[A0,3,"ivec3"],35669:[A0,4,"ivec4"],[T0]:[T0,1,"uint"],36294:[T0,2,"uvec2"],36295:[T0,3,"uvec3"],36296:[T0,4,"uvec4"],35670:[Rs,1,"bool"],35671:[Rs,2,"bvec2"],35672:[Rs,3,"bvec3"],35673:[Rs,4,"bvec4"],35674:[Rs,8,"mat2"],35685:[Rs,8,"mat2x3"],35686:[Rs,8,"mat2x4"],35675:[Rs,12,"mat3"],35687:[Rs,12,"mat3x2"],35688:[Rs,12,"mat3x4"],35676:[Rs,16,"mat4"],35689:[Rs,16,"mat4x2"],35690:[Rs,16,"mat4x3"]};function YV(n){const e=OI[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function KV(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Rs}for(const t in OI){const[i,r,s]=OI[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class Joe{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!_i(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=YV(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new ca(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=YV(i),l={location:e,name:t,accessor:new ca({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const eae=35981,tae=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class QV extends ku{get[Symbol.toStringTag](){return"Program"}constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",tae),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=eae}=e;return this.hash=t||"",this.vs="string"==typeof i?new DI(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new II(this.gl,{id:`${e.id}-fs`,source:r}):r,en(this.vs instanceof DI),en(this.fs instanceof II),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(wo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Joe(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:p,framebuffer:g,parameters:m={},uniforms:w,samplers:C}){if((w||C)&&(un.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(w||{})),un.priority>=e){const H=g?g.id:"default",U=`mode=${eh(this.gl,t)} verts=${i} instances=${c} indexType=${eh(this.gl,l)} isInstanced=${u} isIndexed=${a} Framebuffer=${H}`;un.log(e,U)()}return en(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c||(h.bindForDraw(i,c,()=>{if(void 0!==g&&(m=Object.assign({},m,{framebuffer:g})),p){const H=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return en(!1),0}}(t);p.begin(H)}this._bindTextures(),sc(this.gl,m,()=>{a&&u?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&_i(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):u?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),p&&p.end()}),0))}setUniforms(e={}){un.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!yoe(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Os&&(s=s.texture),s instanceof xf)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&boe(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new DI({handle:r});break;case 35632:i.fs=new II({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=la(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),un.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),un.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||un.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=moe(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=jV(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=jV(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class M0{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new M0(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(t),h=this._getHash(i),p=c.map(de=>this._getHash(de.name)).sort(),g=o.map(de=>this._getHash(de)),m=Object.keys(r).sort(),w=Object.keys(s).sort(),C=[],H=[];for(const de of m)C.push(this._getHash(de)),C.push(this._getHash(r[de]));for(const de of w)H.push(this._getHash(de)),H.push(this._getHash(s[de]));const U=`${u}/${h}D${C.join("/")}M${p.join("/")}I${H.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[U]){const de=function(n,e){const{vs:t,fs:i}=e,r=kse(e.modules||[]);return{gl:n,vs:kV(n,Object.assign({},e,{source:t,type:x0,modules:r})),fs:kV(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:ooe(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[U]=new QV(this.gl,{hash:U,vs:de.vs,fs:de.fs,varyings:o,bufferMode:a}),this._getUniforms[U]=de.getUniforms||(Ce=>{}),this._useCounts[U]=0}return this._useCounts[U]++,this._programCache[U]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let wS=null;class ja extends ku{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e,t={}){return!t.constantAttributeZero||_i(e)||"Chrome"===function(n){if(!GD())return"Node";if(sj(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":d0.chrome?"Chrome":d0.safari?"Safari":d0.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new ja(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return ja.MAX_ATTRIBUTES=ja.MAX_ATTRIBUTES||e.getParameter(34921),ja.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:ja._setConstantFloatArray(e,t,i);break;case Int32Array:ja._setConstantIntArray(e,t,i);break;case Uint32Array:ja._setConstantUintArray(e,t,i);break;default:en(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ja.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return en(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=i,{gl:h,gl2:p}=this;return e=Number(e),this.bind(()=>{h.bindBuffer(34962,t.handle),c?(en(_i(h)),p.vertexAttribIPointer(e,r,s,o,a)):h.vertexAttribPointer(e,r,s,l,o,a),h.enableVertexAttribArray(e),p.vertexAttribDivisor(e,u||0)}),this}enable(e,t=!0){return!t&&0===e&&!ja.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new lr(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!wS||wS.byteLength<n)&&(wS=new ArrayBuffer(n)),wS}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:en(!1)}}static _setConstantIntArray(e,t,i){switch(en(_i(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:en(!1)}}static _setConstantUintArray(e,t,i){switch(en(_i(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:en(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return en(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const lae=/^(.+)__LOCATION_([0-9]+)$/,cae=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class uae{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ja(e),Pj(this,"VertexArray","v6.0",cae),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new lr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof lr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof lr&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,un.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=ca.resolve(l.accessor,this.accessors[o]||{},i,r),{size:h,type:p}=u;return en(Number.isFinite(h)&&Number.isFinite(p)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=lae.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof lr)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof lr)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof lr))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(ja.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){ja.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof lr){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return un.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function D0(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=D0(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function ZV(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,u,h,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof lr){const p=e,{data:g,changed:m}=p.getDebugData();let w;return u=m?"*":"",h=g,l=p.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?w=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${eh(r,s)})`:(c=!0,w=`${l} bytes`),{[i]:`${u}${D0(h,{size:o,isInteger:c})}`,"Format ":w}}return h=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${D0(h,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function fae(n,e){const{type:t,size:i}=e,r=KV(t,i);return r?`${n} (${r.name})`:n}function JV({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){en(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const p of l)!p.match(".*_.*")&&!p.match(s)&&RI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)p.match(s)&&RI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)a[p]||RI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;let u=0;const h={};if(!i)for(const p in t){const g=t[p];a[p]||(u++,h[p]={Type:`NOT USED: ${g}`,[n]:D0(g)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function RI({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?D0(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function eU(n){const{type:e,size:t}=n.accessor,i=KV(e,t);return i?`${i.name} ${n.name}`:n.name}const mae={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function yae(n,e){const{attributeMap:t=mae}=e||{};return t&&t[n]||n}function bae(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}en(Number.isFinite(e.size),`attribute ${n} needs size`)}const tU=()=>{},Eae={};class Vg{constructor(e,t={}){const{id:i=la("model")}=t;en(rS(e)),this.id=i,this.gl=e,this.id=t.id||la("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||M0.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},en(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return en(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return en(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=yae(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=ot({},o);delete c.value,i[a]=[new lr(n,l),c],bae(s,c)}}if(r){const s=r.value||r;en(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new lr(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(Og(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return sI(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),un.priority>=2&&(c=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:h=u.isIndexed,indexType:p=u.indexType,indexOffset:g=u.indexOffset,vertexArrayInstanced:m=u.isInstanced}=this.props;m&&!this.isInstanced&&un.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:w,instanceCount:C}=this,{onBeforeRender:H=tU,onAfterRender:U=tU}=this.props;H(),this.program.setUniforms(this.uniforms);const de=this.program.draw(Object.assign(Eae,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:h,indexType:p,isInstanced:w,instanceCount:C,offset:h?g:0}));return U(),un.priority>=2&&this._logDrawCallEnd(c,l,i),de}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return un.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}en(t instanceof QV,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new uae(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof lr&&t.delete()}}_setAnimationProps(e){this.animated&&en(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(Og(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new xV(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),un.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:un.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=ZV(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${fae(s.name,a)}`),t[o]=ZV(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=JV({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:u}=JV({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&un.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&un.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${eU(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${eU(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);un.table(e,s)(),un.table(e,o)(),un.table(e+1,h)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),un.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class NI{static isSupported(e){return _i(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();en(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new Vg(t,Object.assign({},e,{fs:e.fs||SV({version:CV(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(Og(n.feedbackBuffers)&&Og(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new _se(e,t)),function(n){return!(Og(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new Ose(e,t)),en(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function ES(){}const Cae={onStart:ES,onUpdate:ES,onInterrupt:ES,onEnd:ES};class I0{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=ot(ot({},Cae),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Nae={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new I0(i),this.attribute=t,this.attributeInTransition=new mI(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=yV(e.size);return new NI(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new lr(e,r),new lr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;bV(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)vV(ot({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=gI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:_V(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new I0(i),this.attribute=t,this.attributeInTransition=new mI(e,wn(ot({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new ua(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new Os(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=yV(e.size);return new NI(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new lr(e,r),new lr(e,r),new lr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)vV(ot({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=gI(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:_V(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),bV(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),aS(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Pae{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=NI.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void xi.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=Nae[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(xi.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const nU="attributeManager.invalidate";class Vae{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Pae(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);So(nU,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);So(nU,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;So("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],h=u.settings.accessor;u.startIndices=i,s[c]&&xi.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue(o[h],e.startIndices)||!o[h]&&u.setConstantValue(s[h])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=u.needsRedraw()}l&&So("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=ot({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&xi.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=wn(ot({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new mI(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;So("attribute.updateStart",t),t.allocate(i)&&So("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,So("attribute.updateEnd",t,i))}}function rU(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function sU(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const Gae={interpolation:class extends I0{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=lS(t,i,o)}},spring:class extends I0{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=rU(n[o],e[o],t[o],i,r);return s}return rU(n,e,t,i,r)}(s,o,t,i,r);const l=sU(a,t),c=sU(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class $ae{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=mV(r)))return;const o=Gae[r.type];if(!o)return void xi.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(wn(ot({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const SS={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:Wae}=SS;function Kae(n,e){if(!n.transitions)return null;const t={},i=FI(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&PI(n[r],e[r],s)&&(t[r]=!0)}return t}function oU({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=PI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=PI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function PI(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Zae(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function aU(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,oU({oldProps:r,newProps:i,triggerName:t})}function FI(n){const e=n[Wae],t=e&&e.constructor;return t?t._propTypes:{}}function rle(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function xS(n){let t,e={};return i=>{for(const r in i)if(!rle(i[r],e[r])){t=n(i),e=i;break}return t}}function sle(n,e){if(!e)return n;const t=ot(ot({},n),e);if("defines"in e&&(t.defines=ot(ot({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=ot({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function LI(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],g=e[11],m=e[12],w=e[13],C=e[14],H=e[15],U=t*a-i*o,de=t*l-r*o,Ce=t*c-s*o,Pe=i*l-r*a,Be=i*c-s*a,et=r*c-s*l,wt=u*w-h*m,vt=u*C-p*m,xt=u*H-g*m,Ft=h*C-p*w,zt=h*H-g*w,gt=p*H-g*C,mt=U*gt-de*zt+Ce*Ft+Pe*xt-Be*vt+et*wt;return mt?(n[0]=(a*gt-l*zt+c*Ft)*(mt=1/mt),n[1]=(r*zt-i*gt-s*Ft)*mt,n[2]=(w*et-C*Be+H*Pe)*mt,n[3]=(p*Be-h*et-g*Pe)*mt,n[4]=(l*xt-o*gt-c*vt)*mt,n[5]=(t*gt-r*xt+s*vt)*mt,n[6]=(C*Ce-m*et-H*de)*mt,n[7]=(u*et-p*Ce+g*de)*mt,n[8]=(o*zt-a*xt+c*wt)*mt,n[9]=(i*xt-t*zt-s*wt)*mt,n[10]=(m*Be-w*Ce+H*U)*mt,n[11]=(h*Ce-u*Be-g*U)*mt,n[12]=(a*vt-o*Ft-l*wt)*mt,n[13]=(t*Ft-i*vt+r*wt)*mt,n[14]=(w*de-m*Pe-C*U)*mt,n[15]=(u*Pe-h*de+p*U)*mt,n):null}function Tf(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],g=e[10],m=e[11],w=e[12],C=e[13],H=e[14],U=e[15],de=t[0],Ce=t[1],Pe=t[2],Be=t[3];return n[0]=de*i+Ce*a+Pe*h+Be*w,n[1]=de*r+Ce*l+Pe*p+Be*C,n[2]=de*s+Ce*c+Pe*g+Be*H,n[3]=de*o+Ce*u+Pe*m+Be*U,n[4]=(de=t[4])*i+(Ce=t[5])*a+(Pe=t[6])*h+(Be=t[7])*w,n[5]=de*r+Ce*l+Pe*p+Be*C,n[6]=de*s+Ce*c+Pe*g+Be*H,n[7]=de*o+Ce*u+Pe*m+Be*U,n[8]=(de=t[8])*i+(Ce=t[9])*a+(Pe=t[10])*h+(Be=t[11])*w,n[9]=de*r+Ce*l+Pe*p+Be*C,n[10]=de*s+Ce*c+Pe*g+Be*H,n[11]=de*o+Ce*u+Pe*m+Be*U,n[12]=(de=t[12])*i+(Ce=t[13])*a+(Pe=t[14])*h+(Be=t[15])*w,n[13]=de*r+Ce*l+Pe*p+Be*C,n[14]=de*s+Ce*c+Pe*g+Be*H,n[15]=de*o+Ce*u+Pe*m+Be*U,n}function CS(n,e,t){var o,a,l,c,u,h,p,g,m,w,C,H,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],p=e[6],g=e[7],m=e[8],w=e[9],C=e[10],H=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=p,n[7]=g,n[8]=m,n[9]=w,n[10]=C,n[11]=H,n[12]=o*i+u*r+m*s+e[12],n[13]=a*i+h*r+w*s+e[13],n[14]=l*i+p*r+C*s+e[14],n[15]=c*i+g*r+H*s+e[15]),n}function AS(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function lU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],p=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+u*i,n[6]=a*r+h*i,n[7]=l*r+p*i,n[8]=c*r-s*i,n[9]=u*r-o*i,n[10]=h*r-a*i,n[11]=p*r-l*i,n}function cU(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],p=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+u*i,n[2]=a*r+h*i,n[3]=l*r+p*i,n[4]=c*r-s*i,n[5]=u*r-o*i,n[6]=h*r-a*i,n[7]=p*r-l*i,n}function dU(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function TS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}function hU(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],u=c*i+a*s-l*r,h=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return n[0]=u*c+g*-o+h*-l-p*-a,n[1]=h*c+g*-a+p*-o-u*-l,n[2]=p*c+g*-l+u*-a-h*-o,n[3]=e[3],n}!function(){var n=new da(4);da!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const fU=[0,0,0,0],Ile=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ole=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Rle=[0,0,0],Nle=[0,0,0],Ple=xS(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=fU,l=fU,c=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:p}=pU(n,e,t);return p&&(l=n.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=TS([],l,o),s=i||s,o=Tf([],r,s),o=Tf([],o,Ile)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(n,t,i),u=n.getDistanceScales(),h=[n.width*e,n.height*e],p=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:p,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Rle,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const m=n.getDistanceScales(c);switch(t){case Fi.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerMeter2;break;case Fi.LNGLAT:case Fi.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerDegree2;break;case Fi.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,m.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,m.unitsPerMeter2[2]]}}return g});function pU(n,e,t=Nle){let r,i=t,s=!0;switch(r=e===Fi.LNGLAT_OFFSETS||e===Fi.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case Vc.WEB_MERCATOR:(e===Fi.LNGLAT||e===Fi.CARTESIAN)&&(s=!1);break;case Vc.WEB_MERCATOR_AUTO_OFFSET:e===Fi.LNGLAT?i=r:e===Fi.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case Vc.IDENTITY:i=n.position.map(Math.fround);break;case Vc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class gU extends cS{get ELEMENTS(){return ju(!1),0}get RANK(){return ju(!1),0}toString(){let e="[";if(Ar.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=er(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function MS(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function mU(n,e){return n[0]=-e[0],n[1]=-e[1],n}function _U(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}function yU(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[3]*r+t[6],n[1]=t[1]*i+t[4]*r+t[7],n}!function(){var n=new da(2);da!=Float32Array&&(n[0]=0,n[1]=0)}();const bU=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Vle=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ule=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),zg={};class $n extends gU{static get IDENTITY(){return zg.IDENTITY=zg.IDENTITY||Object.freeze(new $n(bU)),zg.IDENTITY}static get ZERO(){return zg.ZERO=zg.ZERO||Object.freeze(new $n(Vle)),zg.ZERO}get INDICES(){return Ule}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,u,h,p,g,m,w,C){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=h,this[11]=p,this[12]=g,this[13]=m,this[14]=w,this[15]=C,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,u,h,p,g,m,w,C){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=u,this[7]=m,this[8]=i,this[9]=a,this[10]=h,this[11]=w,this[12]=r,this[13]=l,this[14]=p,this[15]=C,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(bU)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,p=r*o,g=r*a,m=r*l,w=s*o,C=s*a,H=s*l;n[0]=1-h-m,n[1]=u+H,n[2]=p-C,n[3]=0,n[4]=u-H,n[5]=1-c-m,n[6]=g+w,n[7]=0,n[8]=p+C,n[9]=g-w,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?$n._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),u=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=u,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,u,h,p,g,m=e[0],w=e[1],C=e[2],H=i[0],U=i[1],de=i[2],Ce=t[0],Pe=t[1],Be=t[2];Math.abs(m-Ce)<zc&&Math.abs(w-Pe)<zc&&Math.abs(C-Be)<zc?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=m-Ce,h=w-Pe,p=C-Be,r=U*(p*=g=1/Math.hypot(u,h,p))-de*(h*=g),s=de*(u*=g)-H*p,o=H*h-U*u,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=h*o-p*s,l=p*r-u*o,c=u*s-h*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=l,n[6]=h,n[7]=0,n[8]=o,n[9]=c,n[10]=p,n[11]=0,n[12]=-(r*m+s*w+o*C),n[13]=-(a*m+l*w+c*C),n[14]=-(u*m+h*w+p*C),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new $n).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return function(n,e,t,i,r){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i)}(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],u=n[9],h=n[10],p=n[11],g=n[12],m=n[13],w=n[14],C=n[15];return(e*o-t*s)*(h*C-p*w)-(e*a-i*s)*(u*C-p*m)+(e*l-r*s)*(u*w-h*m)+(t*a-i*o)*(c*C-p*g)-(t*l-r*o)*(c*w-h*g)+(i*l-r*a)*(c*m-u*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return LI(this,this),this.check()}multiplyLeft(e){return Tf(this,e,this),this.check()}multiplyRight(e){return Tf(this,this,e),this.check()}rotateX(e){return lU(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],p=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-u*i,n[2]=a*r-h*i,n[3]=l*r-p*i,n[8]=s*i+c*r,n[9]=o*i+u*r,n[10]=a*i+h*r,n[11]=l*i+p*r}(this,this,e),this.check()}rotateZ(e){return cU(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,u,h,p,g,m,w,C,H,U,de,Ce,Pe,Be,et,wt,vt,xt,Ft,zt,gt,mt,kt,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<zc||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),p=e[1],g=e[2],m=e[3],C=e[5],H=e[6],U=e[7],Ce=e[9],Pe=e[10],Be=e[11],xt=r*s*(u=1-c)-o*l,Ft=s*s*u+c,zt=o*s*u+r*l,gt=r*o*u+s*l,mt=s*o*u-r*l,kt=o*o*u+c,n[0]=(h=e[0])*(et=r*r*u+c)+(w=e[4])*(wt=s*r*u+o*l)+(de=e[8])*(vt=o*r*u-s*l),n[1]=p*et+C*wt+Ce*vt,n[2]=g*et+H*wt+Pe*vt,n[3]=m*et+U*wt+Be*vt,n[4]=h*xt+w*Ft+de*zt,n[5]=p*xt+C*Ft+Ce*zt,n[6]=g*xt+H*Ft+Pe*zt,n[7]=m*xt+U*Ft+Be*zt,n[8]=h*gt+w*mt+de*kt,n[9]=p*gt+C*mt+Ce*kt,n[10]=g*gt+H*mt+Pe*kt,n[11]=m*gt+U*mt+Be*kt,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?AS(this,this,e):AS(this,this,[e,e,e]),this.check()}translate(e){return CS(this,this,e),this.check()}transform(e,t){return 4===e.length?(v0(t=TS(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=uI(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return v0(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=lV(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return v0(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return Pg("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return Pg("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return Pg("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Hg(n,e){const t=TS([],e,n);return dU(t,t,1/t[3]),t}function vU(n,e){const t=n%e;return t<0?e+t:t}function wU(n,e,t){return n<e?e:n>t?t:n}const kI=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function Uu(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const ac=Math.PI,EU=ac/4,lc=ac/180,BI=180/ac,jI=4003e4,DS=85.051129;function IS([n,e]){return Uu(Number.isFinite(n)),Uu(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*lc+ac)/(2*ac),512*(ac+Math.log(Math.tan(EU+e*lc*.5)))/(2*ac)]}function Gg([n,e]){const t=n/512*(2*ac)-ac,i=2*(Math.atan(Math.exp(e/512*(2*ac)-ac))-EU);return[t*BI,i*BI]}function VI({latitude:n,longitude:e,highPrecision:t=!1}){Uu(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*lc),o=512/360,a=o/s,l=512/jI/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=lc*Math.tan(n*lc)/s,h=512/jI*c,p=h/a*l;i.unitsPerDegree2=[0,o*c/2,h],i.unitsPerMeter2=[p,0,p]}return i}function SU(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=VI({longitude:t,latitude:i,highPrecision:!0}),u=IS(n);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=Gg(u),p=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],p]:h}function CU(n){return 2*Math.atan(.5/n)*BI}function AU(n,e){const[t,i,r=0]=n;return Uu(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Hg(e,[t,i,r,1])}function R0(n,e,t=0){const[i,r,s]=n;if(Uu(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Hg(e,[i,r,s,1]);const o=Hg(e,[i,r,0,1]),a=Hg(e,[i,r,1,1]),l=o[2],c=a[2];return _U([],o,a,l===c?0:((t||0)-l)/(c-l))}const TU=Math.PI/180;function MU(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Hg(i,[e,0,1,1]),s=Hg(i,[e,n.height,1,1]),c=Gg(_U([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}const Jle=Math.PI/180,ece=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],zI=[0,0,0],nce={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let $g=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Vc.WEB_MERCATOR:Vc.WEB_MERCATOR_AUTO_OFFSET:Vc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&b0(t.projectionMatrix,this.projectionMatrix)&&b0(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=AU(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,u=R0([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[h,p,g]=this.unprojectPosition(u);return Number.isFinite(a)?[h,p,g]:Number.isFinite(r)?[h,p,r]:[h,p]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?IS(t):t}unprojectFlat(t){return this.isGeospatial?Gg(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?VI({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=Fg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=Fg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=Fg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=Fg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=Fg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=Fg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new $n).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new $n).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=ece,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){Uu(Number.isFinite(n));const e=Math.cos(n*lc);return function(n){return kI(n)}(jI*e)-9}({latitude:s})+Math.log2(c):0);const h=Math.pow(2,this.zoom);this.scale=h,this.distanceScales=this.isGeospatial?VI({latitude:s,longitude:r}):u||nce,this.focalDistance=c,this.distanceScales.metersPerUnit=new Eo(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new Eo(this.distanceScales.unitsPerMeter),this.position=zI,this.meterOffset=zI,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new $n).multiplyRight(this.viewMatrixUncentered).translate(new Eo(this.center||zI).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new Eo(this.projectPosition([t,i,0]));if(r){const a=new Eo(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*Jle,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Tf(t,t,this.projectionMatrix),Tf(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=LI([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];AS(i,i,[this.width/2,-this.height/2,1]),CS(i,i,[1,-1,0]),Tf(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=LI([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||xi.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),NU=(()=>{class n extends $g{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:u=!1,repeat:h=!1,worldOffset:p=0}=t;let{width:g,height:m,altitude:w=1.5}=t;const C=Math.pow(2,s);g=g||1,m=m||1,w=Math.max(.75,w);const{fov:H,aspect:U,focalDistance:de,near:Ce,far:Pe}=function({width:n,height:e,fovy:t=CU(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=CU(i));const a=.5*t*lc,l=function(n){return.5/Math.tan(.5*n*lc)}(t),c=r*lc,u=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*u+l)*o}}({width:g,height:m,pitch:o,altitude:w,nearZMultiplier:l,farZMultiplier:c});let Be=function({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return CS(o,o,[0,0,-i]),lU(o,o,-e*lc),cU(o,o,t*lc),AS(o,o,[r/=n,r,r]),s&&CS(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}({height:m,pitch:o,bearing:a,scale:C,altitude:w});p&&(Be=(new $n).translate([512*p,0,0]).multiplyLeft(Be)),super(wn(ot({},t),{width:g,height:m,viewMatrix:Be,longitude:r,latitude:i,zoom:s,orthographic:u,fovyRadians:H,aspect:U,focalDistance:de,near:Ce,far:Pe})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=w,this.orthographic=u,this._subViewports=h?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(wn(ot({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return SU(t,i)}panByPosition(t,i){const r=R0(i,this.pixelUnprojectionMatrix),o=MS([],this.projectFlat(t),mU([],r)),a=MS([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=function(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*TU:Math.atan(.5/n.altitude))>(90-n.pitch)*TU-.01?(l=MU(n,0,e),c=MU(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=function({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,u]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:Uu(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const h=IS([a,wU(u,-DS,DS)]),p=IS([c,wU(l,-DS,DS)]),g=[Math.max(Math.abs(p[0]-h[0]),i),Math.max(Math.abs(p[1]-h[1]),i)],m=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];Uu(m[0]>0&&m[1]>0);const w=m[0]/g[0],C=m[1]/g[1],Ce=Gg([(p[0]+h[0])/2+(s.right-s.left)/2/w,(p[1]+h[1])/2+(s.bottom-s.top)/2/C]),Pe=Math.min(r,kI(Math.abs(Math.min(w,C))));return Uu(Number.isFinite(Pe)),{longitude:Ce[0],latitude:Ce[1],zoom:Pe}}(ot({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function HI(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof NU){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function PU(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=TS([],[o,a,l,1],t)),i){case Fi.LNGLAT:return HI([o,a,l],e,s);case Fi.LNGLAT_OFFSETS:return HI([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Fi.METER_OFFSETS:return HI(SU(r,[o,a,l]),e,s);case Fi.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const sce={10241:9987,10240:9729,10242:33071,10243:33071},GI={},lce={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||P0(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>$I(n,e)},accessor:{validate(n,e){const t=OS(n);return"function"===t||t===OS(e.value)},equal:(n,e,t)=>"function"==typeof e||$I(n,e)},array:{validate:(n,e)=>e.optional&&!n||P0(n),equal:(n,e,t)=>t.compare?$I(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof ua)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new ua(t,wn(ot({},e),{parameters:ot(ot(ot({},sce),i),n.props.textureParameters)}));return GI[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof ua)||GI[n.id]&&(n.delete(),delete GI[n.id])}(n)}}};function $I(n,e){if(n===e)return!0;if(!P0(n)||!P0(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function uce(n,e){switch(OS(e)){case"object":return N0(n,e);case"array":return N0(n,{type:"array",value:e,compare:!1});case"boolean":return N0(n,{type:"boolean",value:e});case"number":return N0(n,{type:"number",value:e});case"function":return N0(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function N0(n,e){return"type"in e?ot(ot({name:n},lce[e.type]),e):"value"in e?ot({name:n,type:OS(e.value)},e):{name:n,type:"object",value:e}}function P0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function OS(n){return P0(n)?"array":null===n?"null":typeof n}const{COMPONENT:WI,ASYNC_ORIGINAL:RS,ASYNC_RESOLVED:F0,ASYNC_DEFAULTS:NS}=SS;function dce(){const n=this,e=FU(n.constructor),t=Object.create(e);t[WI]=n,t[RS]={},t[F0]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function FU(n){return PS(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=FU(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=uce(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(PS(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=PS(n,"layerName")||PS(n,"componentName");return e||xi.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=ot(ot({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=mce(o))}n[NS]=t,n[RS]={},Object.defineProperties(n,i)}(o,a);const l=ot(ot({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])LU(this,s)||(this[s]=i);xi.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function mce(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||pV(e)?this[RS][n]=e:this[F0][n]=e},get(){if(this[F0]){if(n in this[F0])return this[F0][n]||this[NS][n];if(n in this[RS]){const e=this[WI]&&this[WI].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[NS][n]}}return this[NS][n]}}}function LU(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function PS(n,e){return LU(n,e)&&n[e]}function qI(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:yce,ASYNC_RESOLVED:bce,ASYNC_DEFAULTS:vce}=SS,wce=Object.freeze({});class kU{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=wce,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[bce]||{},i=e[yce]||e,r=e[vce]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(pV(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return ni(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var h,c=!0,u=!1;try{for(var g,m,p=qI(t);c=(g=yield p.next()).done,m=yield g.value,!c;c=!0){const C=m,{dataTransform:H}=i.component?i.component.props:{};a=H?H(C,a):a.concat(C),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(C){u=!0,h=C}finally{try{!c&&null!=p.return&&(yield p.return())}finally{if(u)throw h}}const w=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;w&&w(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:BU,ASYNC_RESOLVED:jU,ASYNC_DEFAULTS:Ece}=SS,Sce={};let xce=0,Cce=(()=>{class n{constructor(){this.props=dce.apply(this,arguments),this.id=this.props.id,this.count=xce++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[Ece])s in i[jU]?r[s]=i[jU][s]:s in i[BU]&&(r[s]=i[BU][s]);return new this.constructor(ot(ot(ot({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new kU({})}}return n.componentName="Component",n.defaultProps=Sce,n})();class Ace extends kU{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const cc=n=>"function"==typeof n,ih=n=>null!==n&&"object"==typeof n,UU=n=>ih(n)&&n.constructor==={}.constructor,Tce=n=>n&&"function"==typeof n[Symbol.iterator],Mce=n=>n&&"function"==typeof n[Symbol.asyncIterator],L0=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Wg=n=>"undefined"!=typeof Blob&&n instanceof Blob,zU=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||ih(n)&&cc(n.tee)&&cc(n.cancel)&&cc(n.getReader))(n)||(n=>ih(n)&&cc(n.read)&&cc(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function Mf(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function YI(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function KI(n){var e,t;let i;return Mf(n,"null loader"),Mf(YI(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=wn(ot({},n=n[0]),{options:ot(ot({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const Hc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},XI=Hc.global||Hc.self||Hc.window||{},Pce="object"!=typeof process||"[object process]"!==String(process)||process.browser,HU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);HU&&parseFloat(HU[1]);const ZI={};function Fce(n){for(const e in ZI)n.startsWith(e)&&(n=n.replace(e,ZI[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const Lce=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,kce=/^([-\w.]+\/[-\w.+]+)/;function Bce(n){const e=kce.exec(n);return e?e[1]:n}function GU(n){const e=Lce.exec(n);return e?e[1]:""}const jce=/\?.*/;function FS(n){if(L0(n)){const e=JI(n.url||"");return{url:e,type:Bce(n.headers.get("content-type")||"")||GU(e)}}return Wg(n)?{url:JI(n.name||""),type:n.type||""}:"string"==typeof n?{url:JI(n),type:GU(n)}:{url:"",type:""}}function Vce(n){return L0(n)?n.headers["content-length"]||-1:Wg(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function JI(n){return n.replace(jce,"")}function $U(n){return eO.apply(this,arguments)}function eO(){return(eO=ni(function*(n){if(L0(n))return n;const e={},t=Vce(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=FS(n);r&&(e["content-type"]=r);const s=yield Hce(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function Uce(n){return tO.apply(this,arguments)}function tO(){return(tO=ni(function*(n){if(!n.ok){const e=yield zce(n);throw new Error(e)}})).apply(this,arguments)}function zce(n){return nO.apply(this,arguments)}function nO(){return(nO=ni(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function Hce(n){return iO.apply(this,arguments)}function iO(){return(iO=ni(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${Gce(n.slice(0,5))}`:null})).apply(this,arguments)}function Gce(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function WU(n,e){return rO.apply(this,arguments)}function rO(){return(rO=ni(function*(n,e){if("string"==typeof n){n=Fce(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield $U(n)})).apply(this,arguments)}function qn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const qU=new WD({id:"loaders.gl"});class $ce{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const YU={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){qn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},qce={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function sO(){XI.loaders=XI.loaders||{};const{loaders:n}=XI;return n._state=n._state||{},n._state}const oO=()=>{const n=sO();return n.globalOptions=n.globalOptions||ot({},YU),n.globalOptions};function Yce(n,e,t,i){return t=t||[],function(n,e){XU(n,null,YU,qce,e);for(const t of e)XU(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=ot({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new $ce),ZU(r,oO()),ZU(r,e),r}(e,n,i)}function KU(n,e){const t=oO(),i=n||t;return"function"==typeof i.fetch?i.fetch:ih(i.fetch)?r=>WU(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:WU}function XU(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&ih(n[a]),c="baseUri"===a&&!e,u="workerUrl"===a&&e;if(!(a in t)&&!c&&!u)if(a in i)qU.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const h=Xce(a,r);qU.warn(`${s} loader option '${o}${a}' not recognized. ${h}`)()}}}function Xce(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function ZU(n,e){for(const t in e)t in e&&(n[t]=UU(e[t])&&UU(n[t])?ot(ot({},n[t]),e[t]):e[t])}function Gc(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function Jce(n,e="3.0.12"){return Gc(n,"no worker provided"),!(!e||!n.version)}const $c={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},eue=$c.global||$c.self||$c.window||{},aO="object"!=typeof process||"[object process]"!==String(process)||process.browser,lO="function"==typeof importScripts,tue="undefined"!=typeof window&&void 0!==window.orientation,JU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),cO=(JU&&parseFloat(JU[1]),new Map);function ez(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function tz(n,e=!0,t){const i=t||new Set;if(n)if(nz(n))i.add(n);else if(nz(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)tz(n[r],e,i);return void 0===t?Array.from(i):[]}function nz(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const uO=()=>{};class iz{static isSupported(){return"undefined"!=typeof Worker}constructor(e){qn(this,"name",void 0),qn(this,"source",void 0),qn(this,"url",void 0),qn(this,"terminated",!1),qn(this,"worker",void 0),qn(this,"onMessage",void 0),qn(this,"onError",void 0),qn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;Gc(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=uO,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=uO,this.onError=uO,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||tz(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){Gc(n.source&&!n.url||!n.source&&n.url);let e=cO.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?ez(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),cO.set(n.url,e)),n.source&&(e=ez(n.source),cO.set(n.source,e))),Gc(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class sue{constructor(e,t){qn(this,"name",void 0),qn(this,"workerThread",void 0),qn(this,"isRunning",void 0),qn(this,"result",void 0),qn(this,"_resolve",void 0),qn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Gc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Gc(this.isRunning),this.isRunning=!1,this._reject(e)}}class oue{constructor(e){qn(this,"name","unnamed"),qn(this,"source",void 0),qn(this,"url",void 0),qn(this,"maxConcurrency",1),qn(this,"maxMobileConcurrency",1),qn(this,"onDebug",()=>{}),qn(this,"reuseWorkers",!0),qn(this,"props",{}),qn(this,"jobQueue",[]),qn(this,"idleQueue",[]),qn(this,"count",0),qn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=ot(ot({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return ni(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return ni(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new sue(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new iz({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return tue?this.maxMobileConcurrency:this.maxConcurrency}}const aue={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class zu{static isSupported(){return iz.isSupported()}static getWorkerFarm(e={}){return zu._workerFarm=zu._workerFarm||new zu({}),zu._workerFarm.setProps(e),zu._workerFarm}constructor(e){qn(this,"props",void 0),qn(this,"workerPools",new Map),this.props=ot({},aue),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=ot(ot({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new oue({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function cue(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return Gc(r),r}function uue(n,e){return!!zu.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function due(n,e,t,i,r){return dO.apply(this,arguments)}function dO(){return(dO=ni(function*(n,e,t,i,r){const s=n.id,o=cue(n,t),l=zu.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",hue.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function hue(n,e,t,i){return hO.apply(this,arguments)}function hO(){return(hO=ni(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}qn(zu,"_workerFarm",void 0);var sz=Je(521);function oz(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return sz.toArrayBuffer?sz.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function mue(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function az(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function _ue(n){return pO.apply(this,arguments)}function pO(){return(pO=ni(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=qI(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return mue(...e)})).apply(this,arguments)}const vue=262144;function lz(n){this.wrapped=n}function k0(n){return new lz(n)}function B0(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,u=c instanceof lz;Promise.resolve(u?c.wrapped:c).then(function(h){u?r("return"===o?"return":"next",h):s(l.done?"return":"normal",h)},function(h){r("throw",h)})}catch(h){s("throw",h)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var u={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=u:(e=t=u,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function mO(n){return function(){return new B0(n.apply(this,arguments))}}function _O(){return(_O=mO(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield k0(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function cz(n,e){return Pce?function(n,e){return yO.apply(this,arguments)}(n,e):function(n,e){return bO.apply(this,arguments)}(n,e)}function yO(){return(yO=mO(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield k0(r);if(s)return;yield oz(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function bO(){return(bO=mO(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=qI(n);t=(o=yield k0(s.next())).done,a=yield k0(o.value),!t;t=!0)yield oz(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield k0(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function Aue(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=vue}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(Wg(n))return function(n,e){return _O.apply(this,arguments)}(n,e);if(zU(n))return cz(n,e);if(L0(n))return cz(n.body,e);throw new Error("makeIterator")}B0.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},B0.prototype.next=function(n){return this._invoke("next",n)},B0.prototype.throw=function(n){return this._invoke("throw",n)},B0.prototype.return=function(n){return this._invoke("return",n)};const vO="Cannot convert supplied data type";function Tue(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(vO)}function Mue(n,e,t){return wO.apply(this,arguments)}function wO(){return(wO=ni(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return Tue(n,e);if(Wg(n)&&(n=yield $U(n)),L0(n)){const r=n;return yield Uce(r),e.binary?yield r.arrayBuffer():yield r.text()}if(zU(n)&&(n=Aue(n,t)),Tce(n)||Mce(n))return _ue(n);throw new Error(vO)})).apply(this,arguments)}function Iue(n,e,t=null){if(t)return t;const i=ot({fetch:KU(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function Oue(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const uz=()=>{const n=sO();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function dz(n){const e=uz();n=Array.isArray(n)?n:[n];for(const t of n){const i=KI(t);e.find(r=>i===r)||e.unshift(i)}}const Nue=/\.([^.]+)$/;function Pue(n){return xO.apply(this,arguments)}function xO(){return(xO=ni(function*(n,e=[],t,i){if(!fz(n))return null;let r=hz(n,e,wn(ot({},t),{nothrow:!0}),i);if(r)return r;if(Wg(n)&&(r=hz(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(pz(n));return r})).apply(this,arguments)}function hz(n,e=[],t,i){if(!fz(n))return null;if(e&&!Array.isArray(e))return KI(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...uz()),function(n){for(const e of n)KI(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=FS(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=CO(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&Nue.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||CO(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(Vue(e,t))return t}else if(ArrayBuffer.isView(e)){if(gz(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&gz(e,0,t))return t;return null}(e,n),a=a||CO(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(pz(n));return s}function fz(n){return!(n instanceof Response&&204===n.status)}function pz(n){const{url:e,type:t}=FS(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?AO(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?AO(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function CO(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function Vue(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function gz(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===AO(n,e,i.length);default:return!1}}(n,e,t,r))}function AO(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function LS(n,e,t,i){return TO.apply(this,arguments)}function TO(){return(TO=ni(function*(n,e,t,i){Gc(!i||"object"==typeof i),e&&!Array.isArray(e)&&!YI(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=FS(n),o=Oue(e,i),a=yield Pue(n,o,t);return a?(i=Iue({url:r,parse:LS,loaders:o},t=Yce(t,a,o,r),i),yield Hue(a,n,t,i)):null})).apply(this,arguments)}function Hue(n,e,t,i){return MO.apply(this,arguments)}function MO(){return(MO=ni(function*(n,e,t,i){if(Jce(n),e=yield Mue(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(uue(n,t))return yield due(n,e,t,i,LS);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw Gc(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function j0(n,e,t,i){return DO.apply(this,arguments)}function DO(){return(DO=ni(function*(n,e,t,i){!Array.isArray(e)&&!YI(e)&&(t=e,e=void 0);const r=KU(t);let s=n;return"string"==typeof n&&(s=yield r(n)),Wg(n)&&(s=yield r(n)),yield LS(s,e,t)})).apply(this,arguments)}const mz=br(2,24)-1,Kue=Object.freeze([]),Xue=xS(({oldViewport:n,viewport:e})=>n.equals(e));let Wc=new Uint8ClampedArray(0);const Que={data:{type:"data",value:Kue,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=wn(ot({},r),{fetch:wn(ot({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:j0(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):j0(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Fi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let V0=(()=>{class n extends Cce{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=PU(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=AU(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=ot({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Fi.DEFAULT&&(t=i.isGeospatial?Fi.LNGLAT:Fi.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=pU(t,i,r),h=PU(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(h,h,t.projectPosition(l||c));return h}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Fi.DEFAULT||t===Fi.LNGLAT||t===Fi.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){oc(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=sle(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const u of c)o.invalidateAll(u);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:u}=o.attributes,h=c||u;h&&(l&&h.constant&&(h.constant=!1,o.invalidate(h.id)),!h.value&&!l&&(h.constant=!0,h.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!Xue({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(Wc.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>mz&&xi.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Wc=y0.allocate(Wc,i,{size:3,copy:!0,maxCount:Math.max(i,mz)});const s=Math.floor(Wc.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),Wc[3*a+0]=o[0],Wc[3*a+1]=o[1],Wc[3*a+2]=o[2]}t.value=Wc.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==Wc.buffer&&(r.value=Wc.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){So("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();So("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){So("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];Lu(this.context.gl,{polygonOffset:l}),sc(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&So("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=oU({newProps:n,oldProps:e,propTypes:FI(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&aU(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&aU(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Zae(n,e),transitionsChanged:Kae(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=FI(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new Vae(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){oc(!this.internalState&&!this.state),oc(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Ace({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(xi.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new $ae(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){So("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=Que,n})(),_z=(()=>{class n extends V0{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:m,modelMatrix:w,extensions:C,fetch:H,_subLayerProps:U}=this.props,de={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:m,modelMatrix:w,extensions:C,fetch:H},Ce=U&&U[t.id],Pe=Ce&&Ce.updateTriggers,Be=t.id||"sublayer";if(Ce){const et=this.constructor._propTypes,wt=t.type?t.type._propTypes:{};for(const vt in Ce){const xt=wt[vt]||et[vt];xt&&"accessor"===xt.type&&(Ce[vt]=this.getSubLayerAccessor(Ce[vt]))}}Object.assign(de,t,Ce),de.id="".concat(this.props.id,"-").concat(Be),de.updateTriggers=ot(ot({all:this.props.updateTriggers.all},t.updateTriggers),Pe);for(const et of C){const wt=et.getSubLayerProps.call(this,et);wt&&Object.assign(de,wt,{updateTriggers:Object.assign(de.updateTriggers,wt.updateTriggers)})}return de}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=fI(t,Boolean),this.internalState.subLayers=t),So("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const Jue=/([0-9]+\.?[0-9]*)(%|px)/;function kS(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match(Jue);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function BS(n,e){return n.relative?Math.round(n.position*e):n.position}function U0(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&U0(i,r)))return!1}return!0}class IO{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:u=1e3,modelMatrix:h=null,viewportInstance:p=null,type:g=$g}=e;oc(!p||p instanceof $g),this.viewportInstance=p,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=wn(ot({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:u,modelMatrix:h}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):U0(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=ot({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:BS(this._x,e),y:BS(this._y,t),width:BS(this._width,e),height:BS(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),ot(ot({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(ot(ot(ot({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=kS(e),this._y=kS(t),this._width=kS(i),this._height=kS(r)}}const z0=()=>{},yz={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:z0,onTransitionInterrupt:z0,onTransitionEnd:z0};class ede{constructor(e,t={}){this.ControllerState=e,this.props=ot(ot({},yz),t),this.propsInTransition=null,this.transition=new I0(t.timeline),this.onViewStateChange=t.onViewStateChange||z0,this.onStateChange=t.onStateChange||z0,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=ot(ot({},yz),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=ot(ot({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(ot(ot({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const bz=["longitude","latitude","zoom","bearing","pitch"],nde=["longitude","latitude","zoom"];class vz extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!b0(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];oc(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:bz,extract:bz,required:nde}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=lS(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(ot(ot({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,lS(e.around,t.around,i)))}return r}}const rh={transitionDuration:0},ide={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},VS=n=>1-(1-n)*(1-n),qg_WHEEL=["wheel"],qg_PAN=["panstart","panmove","panend"],qg_PINCH=["pinchstart","pinchmove","pinchend"],qg_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],qg_DOUBLE_TAP=["doubletap"],qg_KEYBOARD=["keydown"];class OO{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new ede(e,wn(ot({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&wn(ot({},ide),{transitionInterpolator:new vz({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(ot(ot({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(qg_WHEEL,u&&i),this.toggleEvents(qg_PAN,u&&(r||s)),this.toggleEvents(qg_PINCH,u&&(a||l)),this.toggleEvents(qg_TRIPLE_PAN,u&&l),this.toggleEvents(qg_DOUBLE_TAP,u&&o),this.toggleEvents(qg_KEYBOARD,u&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=ot(ot({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,rh,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,rh,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,wn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:VS}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,rh,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,wn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:VS}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,wn(ot({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,rh,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,rh,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,wn(ot({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:VS}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,rh,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,rh,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,wn(ot({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:VS}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?wn(ot({},t),{transitionInterpolator:new vz(wn(ot({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:rh}}class wz{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const sh_target=[0,0,0];class US extends wz{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=sh_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-(1/0),maxZoom:h=Infinity,startPanPosition:p,startRotatePos:g,startRotationX:m,startRotationOrbit:w,startZoomPosition:C,startZoom:H}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:h}),this._state={startPanPosition:p,startRotatePos:g,startRotationX:m,startRotationOrbit:w,startZoomPosition:C,startZoom:H},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*u}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=ot({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(wn(ot({},this._viewportProps),{zoom:a}));return this._getUpdatedState(ot({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),La(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new US(ot(ot(ot({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=La(r,i,t),e.rotationX=La(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class sde extends OO{constructor(e){super(US,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class ode extends OO{constructor(e){e.dragMode=e.dragMode||"pan",super(US,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const ade=(new $n).lookAt({eye:[0,0,1]});function lde({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new $n).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class cde extends $g{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(wn(ot({},e),{longitude:null,position:a,viewMatrix:ade.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:lde({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=MS([],e,mU([],R0(t,this.pixelUnprojectionMatrix)));return{target:MS([],this.center,r)}}}let ude=(()=>{class n extends IO{constructor(t){super(wn(ot({},t),{type:cde}))}get controller(){return this._getControllerProps({type:ode})}}return n.displayName="OrthographicView",n})();const zS=Math.PI/180;function dde({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*zS/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new $n).lookAt({eye:l,up:a});c.rotateX(i*zS),"Z"===t?c.rotateZ(r*zS):c.rotateY(r*zS);const u=Math.pow(2,s)/(n||1);return c.scale(u),c}class hde extends $g{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(wn(ot({},e),{longitude:null,viewMatrix:dde({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=R0([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let fde=(()=>{class n extends IO{constructor(t={}){const{orbitAxis:i="Z"}=t;super(wn(ot({},t),{orbitAxis:i,type:hde}))}get controller(){return this._getControllerProps({type:sde})}}return n.displayName="OrbitView",n})();const pde=[255,255,255],gde=1;let mde=0;class Ez{constructor(e={}){const{color:t=pde}=e,{intensity:i=gde}=e;this.id=e.id||"ambient-".concat(mde++),this.color=t,this.intensity=i,this.type="ambient"}}const _de=[255,255,255],yde=1,bde=[0,0,-1];let vde=0;class Sz{constructor(e={}){const{color:t=_de}=e,{intensity:i=yde}=e,{direction:r=bde}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(vde++),this.color=t,this.intensity=i,this.type="directional",this.direction=new Eo(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class xz{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=ot({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class RO extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=ot({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return Lu(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){Lu(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,u=i&&i[c.id];r(c);const h=this._getDrawLayerParams(c,e);e.view=u;const p=c.subViewports||[c];for(const g of p){e.viewport=g;const m=this._drawLayersInViewport(o,e,h);a.push(m)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=Cz(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let u=0;u<t.length;u++){const h=t[u],p=this._shouldDrawLayer(h,c,r),m={shouldDrawLayer:p,layerRenderIndex:l(h,p)};p&&(m.moduleParameters=this._getModuleParameters(h,s,i,o),m.layerParameters=this.getLayerParameters(h,u)),a[u]=m}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=Ig(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;sc(e,{scissorTest:!0,scissor:a},()=>sI(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Lu(e,{viewport:a});for(let c=0;c<t.length;c++){const u=t[c],{shouldDrawLayer:h,layerRenderIndex:p,moduleParameters:g,layerParameters:m}=o[c];if(h&&u.props.pickable&&l.pickableCount++,u.isComposite)l.compositeCount++;else if(h){l.visibleCount++,g.viewport=r;try{u.drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:m})}catch(w){u.raiseError(w,"drawing ".concat(u," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Ig(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function Cz(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const u=t[l]=t[l]||Cz(e[l],e);c=u(r,s),t[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class xde extends RO{constructor(e,t){super(e,t),this.shadowMap=new ua(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Ng(e,{format:33189,width:1,height:1}),this.fbo=new Os(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;sc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=Ig(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(wn(ot({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Ade=Object.keys(Fi).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Fi[n],";")).join(""),Tde=Object.keys(Vc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(Vc[n],";")).join(""),Mde="".concat(Ade,"\n").concat(Tde,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),Dde={},NO={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:Mde,getUniforms:function(n=Dde){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Fi.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Fi.DEFAULT&&(i=n.isGeospatial?Fi.LNGLAT:Fi.CARTESIAN);const o=Ple({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||Ole,o}(n):{}}},Nde=xS(function({viewport:n,center:e}){return new $n(n.viewProjectionMatrix).invert().transform(e)}),Pde=xS(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=R0([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new Eo(n.center).negate()),l=s.map(u=>a.transform(u)),c=(new $n).ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});t.push(c.multiplyRight(o))}return t}),Fde=[0,0,0,1],Lde=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],PO={name:"shadow",dependencies:[NO],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Fde,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=Nde({viewport:n.viewport,center:e.project_uCenter}),r=[],s=Pde({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new Eo(n.viewport.center).negate());e.project_uCoordinateSystem===Fi.LNGLAT&&e.project_uProjectionMode===Vc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(Lde),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},Ude={color:[255,255,255],intensity:1},Az=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],zde=[0,0,0,200/255];class FO extends xz{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=zde,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=M0.getDefaultProgramManager(e),PO&&this.programManager.addDefaultModule(PO)),this.dummyShadowMap||(this.dummyShadowMap=new ua(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(PO),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new $n).lookAt({eye:new Eo(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new xde(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new Ez(Ude),this.directionalLights.push(new Sz(Az[0]),new Sz(Az[1])))}}let Hde=1,Gde=1;class Tz{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=Hde++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=Gde++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class $de{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=j0(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class Wde{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new $de(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const qde=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},NO],Yde=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Kde(n){const e=M0.getDefaultProgramManager(n);for(const t of qde)e.addDefaultModule(t);for(const t of Yde)e.addShaderHook(t);return e}const Zde=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class Jde{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new Wde({gl:e,protocol:"deck://"}),this.context=wn(ot({},Zde),{layerManager:this,gl:e,deck:t,programManager:e&&Kde(e),stats:i||new ZD({id:"deck.gl"}),viewport:r||new $g({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new Tz,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){So("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=fI(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return So("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?xi.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&xi.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class ehe{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=fI(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!U0(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):xi.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(ot({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=wn(ot(ot(ot({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let u=r[a.id];a.controller&&!u&&(s=!0),(s||!a.controller)&&u&&(u.finalize(),u=null),this.controllers[a.id]=this._updateController(a,l,c,u),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class nhe extends wz{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:u=20,minZoom:h=0,maxPitch:p=60,minPitch:g=0,startPanLngLat:m,startZoomLngLat:w,startRotatePos:C,startBearing:H,startPitch:U,startZoom:de,normalize:Ce}={}){oc(Number.isFinite(s)),oc(Number.isFinite(r)),oc(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:u,minZoom:h,maxPitch:p,minPitch:g,normalize:Ce}),this._state={startPanLngLat:m,startZoomLngLat:w,startRotatePos:C,startBearing:H,startPitch:U,startZoom:de},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(wn(ot({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(wn(ot({},this._viewportProps),{zoom:o}));return this._getUpdatedState(ot({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=ot({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(ot(ot(ot({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=La(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=La(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=vU(t+180,360)-180),(o<-180||o>180)&&(o=vU(o+180,360)-180);const a=kI(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=Gg([0,l])[1];if(i<c)i=c;else{const u=Gg([0,512-l])[1];i>u&&(i=u)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return La(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=La(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let u=0;return r>0?Math.abs(l-o)>5&&(u=r/(o-l)*1.2):r<0&&o>5&&(u=1-s/o),u=Math.min(1,Math.max(-1,u)),{deltaScaleX:c,deltaScaleY:u}}}class ihe extends OO{constructor(e){e.dragMode=e.dragMode||"pan",super(nhe,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(ot(ot({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let rhe=(()=>{class n extends IO{constructor(t){super(wn(ot({},t),{type:NU}))}get controller(){return this._getControllerProps({type:ihe})}}return n.displayName="MapView",n})();const she=new FO;class ohe{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!U0(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof FO)||this._internalEffects.push(she)}}class ahe extends RO{}const Dz={blendFunc:[1,0,32771,0],blendEquation:32774};class Iz extends RO{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},pass:h="picking",redrawReason:p,pickZ:g}){const m=this.gl;return this.pickZ=g,sc(m,wn(ot({scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},Dz),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:h,redrawReason:p})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:wn(ot({},Dz),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return ot(ot({},e.props.parameters),i)}}class che{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new ahe(e),this.pickLayersPass=new Iz(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||Os.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(wn(ot({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,So("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Os(this.gl),new Os(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const uhe={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function dhe({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let u=r*r,h=-1,p=0;for(let g=0;g<c;g++){const m=g+a-i,w=m*m;if(w>u)p+=4*l;else for(let C=0;C<l;C++){if(n[p+3]-1>=0){const U=C+o-t,de=U*U+w;de<=u&&(u=de,h=p)}p+=4}}if(h>=0){const g=n[h+3]-1,m=n.slice(h,h+4),w=e[g];if(w){const C=w.decodePickingColor(m),H=Math.floor(h/4/l);return{pickedColor:m,pickedLayer:w,pickedObjectIndex:C,pickedX:o+(h/4-H*l),pickedY:a+H}}xi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return uhe}function Oz({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,u=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(p=>i({layer:l,viewport:p,isPicking:!0,renderPass:"picking:".concat(e)}))),h=u&&u.unproject([s-u.x,o-u.y],{targetZ:a});return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:h,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function fhe(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const h=t.index,p=t.layerId,g=o&&o.props.id;if(g!==p||a!==h){if(g!==p){const m=r.find(w=>w.props.id===p);m&&l.unshift(m)}t.layerId=g,t.index=a,t.info=null}}const c=Oz(n),u=new Map;return u.set(null,c),l.forEach(h=>{let p=ot({},c);h===o&&(p.color=s,p.index=a,p.picked=!0),p=Rz({layer:h,info:p,mode:i}),h===o&&"hover"===i&&(t.info=p),u.set(p.layer.id,p),"hover"===i&&p.layer.updateAutoHighlight(p)}),u}function Rz({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class ghe{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new Iz(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(p=>p.id===o):null,c=a&&r.find(p=>p.id===a)||r[0],u=c&&c.unproject([e-c.x,t-c.y]),h={x:e,y:t,viewport:c,coordinate:u,layer:l};return l?ot(ot({},s),h):Object.assign(h,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Os(e),Os.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Os(e),this.depthFBO.attach({36064:new ua(e,{format:_i(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(xi.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:Oz({viewports:i,x:r,y:s})};this._resizeBuffer();const h=Ig(this.gl),p=KD(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*h),{width:w,height:C}=this.pickingFBO,H=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:w,deviceHeight:C});let U;const de=[],Ce={};for(let Pe=0;Pe<a;Pe++){const et=dhe({pickedColors:H&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:H,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:H});let wt;if(et.pickedLayer&&c&&this.depthFBO&&(wt=this._drawAndSample({layers:[et.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:et.pickedX,y:et.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),et.pickedColor&&Pe+1<a){const vt=et.pickedColor[3]-1;Ce[vt]=!0,e[vt].disablePickingIndex(et.pickedObjectIndex)}U=fhe({pickInfo:et,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:wt,pixelRatio:h});for(const vt of U.values())vt.layer&&de.push(vt);if(!et.pickedColor)break}for(const Pe in Ce)e[Pe].restorePickingColors();return{result:de,emptyInfo:U&&U.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const h=Ig(this.gl),p=KD(this.gl,[r,s],!0),g=p.x,m=p.y+p.height,w=KD(this.gl,[r+o,s+a],!0),H=w.y,Ce=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):xi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:{x:g,y:H,width:w.x+w.width-g,height:m-H},pass:"picking:".concat(l),redrawReason:l}),layers:e}),Pe=new Map,Be=Number.isFinite(c);for(let et=0;et<Ce.length&&!(Be&&Pe.size>=c);et++){const wt=Ce[et];let vt={color:wt.pickedColor,layer:null,index:wt.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:h};vt=Rz({layer:wt.pickedLayer,info:vt,mode:l}),Pe.has(vt.object)||Pe.set(vt.object,vt)}return Array.from(Pe.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:u,y:h,width:p,height:g}=s,m=new(l?Float32Array:Uint8Array)(p*g*4);return aS(c,{sourceX:u,sourceY:h,sourceWidth:p,sourceHeight:g,target:m}),m}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const mhe={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class _he{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,mhe),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function Nz(n,e){if(!n)throw new Error(e)}const qc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Pz=qc.global||qc.self||qc.window,bhe="object"!=typeof process||"[object process]"!==String(process)||process.browser,Fz="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:vhe}=(Fz&&parseFloat(Fz[1]),Pz),LO="undefined"!=typeof Image,kO="undefined"!=typeof ImageBitmap,whe=Boolean(vhe),BO=!!bhe||whe;function Lz(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function kz(n){switch(Lz(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const xhe=/^data:image\/svg\+xml/,Che=/\.svg((\?|#).*)?$/;function jO(n){return n&&(xhe.test(n)||Che.test(n))}function Ahe(n,e){if(jO(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return jz(n,e)}function jz(n,e){if(jO(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function Vz(n,e,t){return VO.apply(this,arguments)}function VO(){return(VO=ni(function*(n,e,t){const i=Ahe(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield The(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function The(n,e){return UO.apply(this,arguments)}function UO(){return(UO=ni(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const Mhe={};let Uz=!0;function Dhe(n,e,t){return zO.apply(this,arguments)}function zO(){return(zO=ni(function*(n,e,t){let i;i=jO(t)?yield Vz(n,e,t):jz(n,t);const r=e&&e.imagebitmap;return yield Ihe(i,r)})).apply(this,arguments)}function Ihe(n){return HO.apply(this,arguments)}function HO(){return(HO=ni(function*(n,e=null){if((Ohe(e)||!Uz)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),Uz=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function Ohe(n){for(const e in n||Mhe)return!1;return!0}const Yc=!1,H0=!0;function GO(n){const e=G0(n);return function(n){const e=G0(n);return e.byteLength>=24&&2303741511===e.getUint32(0,Yc)?{mimeType:"image/png",width:e.getUint32(16,Yc),height:e.getUint32(20,Yc)}:null}(e)||function(n){const e=G0(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,Yc)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Yc);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Yc),width:e.getUint16(s+7,Yc)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,Yc)}return null}(e)||function(n){const e=G0(n);return e.byteLength>=10&&1195984440===e.getUint32(0,Yc)?{mimeType:"image/gif",width:e.getUint16(6,H0),height:e.getUint16(8,H0)}:null}(e)||function(n){const e=G0(n);return e.byteLength>=14&&16973===e.getUint16(0,Yc)&&e.getUint32(2,H0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,H0),height:e.getUint32(22,H0)}:null}(e)}function G0(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function khe(n,e){const{mimeType:t}=GO(n)||{},{_parseImageNode:i}=Pz;return Nz(i),i(n,t,e)}function $O(){return($O=ni(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(jhe(r)){case"imagebitmap":a=yield Dhe(n,e,s);break;case"image":a=yield Vz(n,e,s);break;case"data":a=yield khe(n,e);break;default:Nz(!1)}return"data"===r&&(a=kz(a)),a})).apply(this,arguments)}function jhe(n){switch(n){case"auto":case"data":return function(){if(kO)return"imagebitmap";if(LO)return"image";if(BO)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return kO||LO||BO;case"imagebitmap":return kO;case"image":return LO;case"data":return BO;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const WO={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return $O.apply(this,arguments)},tests:[n=>Boolean(GO(new DataView(n)))],options:{image:{type:"auto",decode:!0}}};var Yg=Je(761);const Uhe={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},$0="8.5.8",HS=Yg.CO.deck&&Yg.CO.deck.VERSION;if(HS&&HS!==$0)throw new Error("deck.gl - multiple versions detected: ".concat(HS," vs ").concat($0));HS||(xi.log(1,"deck.gl ".concat($0))(),Yg.CO.deck=Object.assign(Yg.CO.deck||{},{VERSION:$0,version:$0,log:xi,_registerLoggers:function(n){_I=n}}),dz([Uhe,[WO,{imagebitmap:{premultiplyAlpha:"none"}}]]));const zhe=Yg.CO.deck;class GS extends ku{get[Symbol.toStringTag](){return"Query"}static isSupported(e,t=[]){const i=_i(e),r=Xj(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:en(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return GS.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const zz=oS()&&"undefined"!=typeof document;let Zhe=0;class Jhe{constructor(e={}){const{onCreateContext:t=(C=>Ij(C)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:h=!1,autoResizeViewport:p=!0,autoResizeDrawingBuffer:g=!0,stats:m=Sf.get("animation-loop-"+Zhe++)}=e;let{useDevicePixels:w=!0}=e;"useDevicePixelRatio"in e&&(un.deprecated("useDevicePixelRatio","useDevicePixels")(),w=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:h},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=m,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:p,autoResizeDrawingBuffer:g,useDevicePixels:w}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return en("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=GS.isSupported(this.gl,["timers"])?new GS(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return ni(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return un.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=zz?new Promise((e,t)=>{zz&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?QD(this.props.gl,e):this.onCreateContext(e),!rS(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){Lu(n,YD)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(un.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(un.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Os(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var efe=Je(524),$S=Je.n(efe);const tfe={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})($S().PointerEventInput),function(n){n.prototype.handler=function(t){let i=tfe[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}($S().MouseInput);const sfe=$S().Manager,Kc=$S(),ofe=Kc?[[Kc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Kc.Rotate,{enable:!1}],[Kc.Pinch,{enable:!1}],[Kc.Swipe,{enable:!1}],[Kc.Pan,{threshold:0,enable:!1}],[Kc.Press,{enable:!1}],[Kc.Tap,{event:"doubletap",taps:2,enable:!1}],[Kc.Tap,{event:"anytap",enable:!1}],[Kc.Tap,{enable:!1}]]:null,$z={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},afe={doubletap:["tap"]},lfe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},YO={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},cfe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Wz={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},ufe="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Kg="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let qz=!1;try{const n={get passive(){return qz=!0,!0}};Kg.addEventListener("test",n,n),Kg.removeEventListener("test",n,n)}catch(n){}const dfe=-1!==ufe.indexOf("firefox"),{WHEEL_EVENTS:hfe}=YO,Kz=4.000244140625;class gfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=hfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!qz&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;Kg.WheelEvent&&(dfe&&e.deltaMode===Kg.WheelEvent.DOM_DELTA_PIXEL&&(t/=Kg.devicePixelRatio),e.deltaMode===Kg.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%Kz==0&&(t=Math.floor(t/Kz)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:mfe}=YO,Xz="pointermove",Qz="pointerover",Zz="pointerout",Jz="pointerleave";class _fe{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=mfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Xz&&(this.enableMoveEvent=t),e===Qz&&(this.enableOverEvent=t),e===Zz&&(this.enableOutEvent=t),e===Jz&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:Qz,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:Zz,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:Jz,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:Xz,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:yfe}=YO,e4="keydown";class bfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=yfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===e4&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:e4,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const n4="contextmenu";class vfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===n4&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:n4,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const wfe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},i4={srcElement:"root",priority:0};class Nfe{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},i4,i):i4;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:u,once:h}=i[l];if(u(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),h&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=wfe[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const Pfe={events:null,recognizers:null,recognizerOptions:{},Manager:sfe,touchAction:"none",tabIndex:0};class Ffe{constructor(e=null,t={}){this.options=Object.assign({},Pfe,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||ofe}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys($z).forEach(r=>{const s=this.manager.get(r);s&&$z[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new gfe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new _fe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new bfe(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new vfe(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=afe[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,l=Wz[e]||e;let c=a.get(l);c||(c=new Nfe(this),a.set(l,c),c.recognizerName=cfe[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(Wz[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=lfe[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function If(){}const r4={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:If,onResize:If,onViewStateChange:If,onInteractionStateChange:If,onBeforeRender:If,onAfterRender:If,onLoad:If,onError:(n,e)=>xi.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class qS{constructor(e){e=ot(ot({},r4),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&xi.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Yg.qs)()&&xi.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new ZD({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&y0.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&xi.removed("onLayerHover","onHover")(),"onLayerClick"in e&&xi.removed("onLayerClick","onClick")(),e.initialViewState&&!U0(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](ot({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),oc(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u,autoResizeDrawingBuffer:h}=e;return new Jhe({width:t,height:i,useDevicePixels:u,autoResizeDrawingBuffer:h,autoResizeViewport:!1,gl:r,onCreateContext:p=>Ij(wn(ot(ot({},s),p),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:p=>this._setGLContext(p.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new rhe({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,QD(e,{enable:!0,copyState:!0})),this.tooltip=new _he(this.canvas),Lu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new Tz;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Ffe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in pj)this.eventManager.on(r,this._onEvent);this.viewManager=new ehe({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new Jde(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new ohe,this.deckRenderer=new che(e),this.deckPicker=new ghe(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;Lu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(ot({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),xi.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=wn(ot({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=pj[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=Sf.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}qS.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(xz)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},qS.defaultProps=r4,qS.VERSION=zhe.VERSION;const YS={name:"project32",dependencies:[NO],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},jfe={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},KS=ot({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=jfe){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),s4={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class oh{static get DRAW_MODE(){return s4}constructor(e={}){const{id:t=la("geometry"),drawMode:i=s4.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?ot({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,en(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(en(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return en(Number.isFinite(i)),i}}const o4=()=>{},$fe={10241:9987,10240:9729,10242:33071,10243:33071};function Wfe(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function qfe(n,e,t,i){return t===e.width&&i===e.height?e:(n.canvas.height=i,n.canvas.width=t,n.clearRect(0,0,n.canvas.width,n.canvas.height),n.drawImage(e,0,0,e.width,e.height,0,0,t,i),n.canvas)}function W0(n){return n&&(n.id||n.url)}function a4(n,e,t){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i];n[W0(r)]=wn(ot({},r),{x:s,y:t})}}class Qfe{constructor(e,{onUpdate:t=o4,onError:i=o4}){this.gl=e,this.onUpdate=t,this.onError=i,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?W0(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:r,data:s,getIcon:o}){e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),o&&(this._getIcon=o),r&&(this._mapping=r),i&&this._updateIconAtlas(i),this._autoPacking&&(s||o)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(s))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(e){var t;null===(t=this._texture)||void 0===t||t.delete(),this._texture=null,this._externalTexture=e,this.onUpdate()}_updateAutoPacking(e){const t=Object.values(function(n,e,t){if(!n||!e)return null;t=t||{};const i={},{iterable:r,objectInfo:s}=hS(n);for(const o of r){s.index++;const a=e(o,s),l=W0(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[l]&&(!t[l]||a.url!==t[l].url)&&(i[l]=wn(ot({},a),{source:o,sourceIndex:s.index}))}return i}(e,this._getIcon,this._mapping)||{});if(t.length>0){const{mapping:i,xOffset:r,yOffset:s,rowHeight:o,canvasHeight:a}=function({icons:n,buffer:e,mapping:t={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<n.length;l++){const c=n[l];if(!t[W0(c)]){const{height:h,width:p}=c;i+p+e>o&&(a4(t,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:c,xOffset:i}),i=i+p+e,s=Math.max(s,h)}}return a.length>0&&a4(t,a,r),{mapping:t,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:Wfe(s+r+e)}}({icons:t,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=r,this._yOffset=s,this._canvasHeight=a,this._texture||(this._texture=new ua(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:$fe})),this._texture.height!==this._canvasHeight&&(this._texture=function(n,e,t,i){const r=e.width,s=e.height,o=qj(e,{width:t,height:i});return function(n,e,t={}){const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=t;let{targetX:a,targetY:l,targetZ:c,width:u,height:h}=t;const{framebuffer:p,deleteFramebuffer:g}=_0(n);en(p);const{gl:m,handle:w}=p,C=void 0!==a||void 0!==l||void 0!==c;a=a||0,l=l||0,c=c||0;const H=m.bindFramebuffer(36160,w);en(e);let U=null;if(e instanceof xf&&(U=e,u=Number.isFinite(u)?u:U.width,h=Number.isFinite(h)?h:U.height,U.bind(0),e=U.target),C)switch(e){case 3553:case 34067:m.copyTexSubImage2D(e,s,a,l,i,r,u,h);break;case 35866:case 32879:wo(m).copyTexSubImage3D(e,s,a,l,c,i,r,u,h)}else m.copyTexImage2D(e,s,o,i,r,u,h,0);U&&U.unbind(),m.bindFramebuffer(36160,H||null),g&&p.delete()}(e,o,{targetY:0,width:r,height:s}),e.delete(),o}(0,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(t)}}_loadIcons(e){const t=this._canvas.getContext("2d");for(const i of e)this._pendingCount++,j0(i.url,WO,this._loadOptions).then(r=>{const s=W0(i),{x:o,y:a,width:l,height:c}=this._mapping[s],u=qfe(t,r,l,c);this._texture.setSubImageData({data:u,x:o,y:a,width:l,height:c}),this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const l4=[0,0,0,255],Zfe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:l4},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};let Jfe=(()=>{class n extends V0{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[YS,KS]})}initializeState(){this.state={iconManager:new Qfe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:l4},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:t,props:i,changeFlags:r}){super.updateState({props:i,oldProps:t,changeFlags:r});const s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c}=i,{iconManager:u}=this.state;u.setProps({loadOptions:i.loadOptions});let h=!1;if(o||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==i.iconAtlas&&u.setProps({iconAtlas:o,autoPacking:!1}),t.iconMapping!==i.iconMapping&&(u.setProps({iconMapping:a}),h=!0)):u.setProps({autoPacking:!0}),(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&u.setProps({data:l,getIcon:c}),h&&(s.invalidate("instanceOffsets"),s.invalidate("instanceIconFrames"),s.invalidate("instanceColorModes")),r.extensionsChanged){var g;const{gl:m}=this.context;null===(g=this.state.model)||void 0===g||g.delete(),this.state.model=this._getModel(m),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:i,sizeMinPixels:r,sizeMaxPixels:s,sizeUnits:o,billboard:a,alphaCutoff:l}=this.props,{iconManager:c}=this.state,{viewport:u}=this.context,h=c.getTexture();h&&this.state.model.setUniforms(t).setUniforms({iconsTexture:h,iconsTextureDim:[h.width,h.height],sizeScale:i*("pixels"===o?u.metersPerPixel:1),sizeMinPixels:r,sizeMaxPixels:s,billboard:a,alphaCutoff:l}).draw()}_getModel(t){return new Vg(t,wn(ot({},this.getShaders()),{id:this.props.id,geometry:new oh({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:i}=this.getCurrentLayer().props;i?i(t):xi.error(t.error)()}getInstanceOffset(t){const i=this.state.iconManager.getIconMapping(t);return[i.width/2-i.anchorX||0,i.height/2-i.anchorY||0]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const i=this.state.iconManager.getIconMapping(t);return[i.x||0,i.y||0,i.width||0,i.height||0]}}return n.layerName="IconLayer",n.defaultProps=Zfe,n})();const u4=[],tpe={getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};let npe=(()=>{class n extends Jfe{getShaders(){return wn(ot({},super.getShaders()),{fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(i,{index:r,target:s})=>this.encodePickingColor(r,s)}})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;let{outlineColor:s}=i;s!==r.outlineColor&&(s=s.map(o=>o/255),s[3]=Number.isFinite(s[3])?s[3]:1,this.setState({outlineColor:s})),!i.sdf&&i.outlineWidth&&xi.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:i,smoothing:r,outlineWidth:s}=this.props,{outlineColor:o}=this.state;t.uniforms=wn(ot({},t.uniforms),{buffer:.75,outlineBuffer:s?Math.max(r,.75*(1-s)):-1,gamma:r,sdf:Boolean(i),outlineColor:o}),super.draw(t)}getInstanceOffset(t){return t?Array.from(t).map(i=>super.getInstanceOffset(i)):u4}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).map(i=>super.getInstanceIconFrame(i)):u4}}return n.layerName="MultiIconLayer",n.defaultProps=tpe,n})();var ipe=Je(2),rpe=Je.n(ipe);const ope=[];function ape(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function d4(n,e,t,i){let r=0;for(let s=e;s<t;s++){const o=n[s];let a=null;const l=i&&i[o];l&&(a=l.width),r+=a}return r}function h4(n,e,t,i,r,s){let o=e,a=0;for(let l=e;l<t;l++){const c=d4(n,l,l+1,r);a+c>i&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function upe(n,e,t,i,r=0,s){void 0===s&&(s=n.length);const o=[];return"break-all"===e?h4(n,r,s,t,i,o):function(n,e,t,i,r,s){let o=e,a=e,l=e,c=0;for(let u=e;u<t;u++)if((" "===n[u]||" "===n[u+1]||u+1===t)&&(l=u+1),l>a){let h=d4(n,a,l,r);c+h>i&&(o<a&&(s.push(a),o=a,c=0),h>i&&(h=h4(n,a,l,i,r,s),o=s[s.length-1])),a=l,c+=h}}(n,r,s,t,i,o),o}function dpe(n,e,t,i,r,s){let o=0,a=0;for(let l=e;l<t;l++){const c=n[l],u=i[c];u?(a||(a=u.height),r[l]=o+u.width/2,o+=u.width):(xi.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),r[l]=o,o+=32)}s[0]=o,s[1]=a}function f4(n,e,t,i,r){const s=(n=Array.from(n)).length,o=new Array(s),a=new Array(s),l=new Array(s),c=("break-word"===t||"break-all"===t)&&isFinite(i)&&i>0,u=[0,0],h=[];let p=0,g=0,m=0;for(let w=0;w<=s;w++){const C=n[w];if(("\n"===C||w===s)&&(m=w),m>g){const H=c?upe(n,t,i,r,g,m):ope;for(let U=0;U<=H.length;U++){const de=0===U?g:H[U-1],Ce=U<H.length?H[U]:m;dpe(n,de,Ce,r,o,h);for(let Pe=de;Pe<Ce;Pe++)a[Pe]=p+h[1]/2,l[Pe]=h[0];p+=h[1]*e,u[0]=Math.max(u[0],h[0])}g=m}"\n"===C&&(o[g]=0,a[g]=0,l[g]=0,g++)}return u[1]=p,{x:o,y:a,rowWidth:l,size:u}}const p4=function(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}(),g4="Monaco, monospace",QO=new class{constructor(e=5){this.limit=e,this.clear()}clear(){this._cache={},this._order=[]}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(this._deleteCache(e),this._deleteOrder(e))}_deleteCache(e){delete this._cache[e]}_deleteOrder(e){const t=this._order.findIndex(i=>i===e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}(3),_pe=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function bpe(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function S4(n,e,t,i){n.font="".concat(i," ").concat(t,"px ").concat(e),n.fillStyle="#000",n.textBaseline="baseline",n.textAlign="left"}class vpe{constructor(){this.props={fontFamily:g4,fontWeight:"normal",characterSet:p4,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){_pe.forEach(o=>{o in e&&(this.props[o]=e[o])});const t=this._key;this._key=this._getKey();const i=function(n,e){const t=QO.get(n);if(!t)return e;const i=[];let s=Object.keys(t.mapping);s=new Set(s);let o=e;return o instanceof Array&&(o=new Set(o)),o.forEach(a=>{s.has(a)||i.push(a)}),i}(this._key,this.props.characterSet),r=QO.get(this._key);if(r&&0===i.length)return void(this._key!==t&&(this._atlas=r));const s=this._generateFontAtlas(this._key,i,r);this._atlas=s,QO.set(this._key,s)}_generateFontAtlas(e,t,i){const{fontFamily:r,fontWeight:s,fontSize:o,buffer:a,sdf:l,radius:c,cutoff:u}=this.props;let h=i&&i.data;h||(h=document.createElement("canvas"),h.width=1024);const p=h.getContext("2d");S4(p,r,o,s);const{mapping:g,canvasHeight:m,xOffset:w,yOffset:C}=function({characterSet:n,getFontWidth:e,fontHeight:t,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o,u=0;for(const p of n)if(!s[p]){const g=e(p,u++);c+g+2*i>r&&(c=0,l++),s[p]={x:c+i,y:a+l*(t+2*i)+i,width:g,height:t},c+=g+2*i}const h=t+2*i;return{mapping:s,xOffset:c,yOffset:a+l*h,canvasHeight:ape(a+(l+1)*h)}}(ot({getFontWidth:H=>p.measureText(H).width,fontHeight:1.2*o,buffer:a,characterSet:t,maxCanvasWidth:1024},i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset}));if(h.height!==m){const H=p.getImageData(0,0,h.width,h.height);h.height=m,p.putImageData(H,0,0)}if(S4(p,r,o,s),l){const H=new(rpe())(o,a,c,u,r,s),U=p.getImageData(0,0,H.size,H.size);for(const de of t)bpe(H.draw(de),U),p.putImageData(U,g[de].x-a,g[de].y+a)}else for(const H of t)p.fillText(H,g[H].x,g[H].y+.9*o);return{xOffset:w,yOffset:C,mapping:g,data:h,width:h.width,height:h.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:i,buffer:r,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(t," ").concat(i," ").concat(r," ").concat(o," ").concat(a):"".concat(e," ").concat(t," ").concat(i," ").concat(r)}}const Spe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};let xpe=(()=>{class n extends V0{getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[YS,KS]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),r.extensionsChanged){var s;const{gl:o}=this.context;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(o),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:i}=this.context,{billboard:r,sizeScale:s,sizeUnits:o,sizeMinPixels:a,sizeMaxPixels:l,getLineWidth:c}=this.props;let{padding:u}=this.props;const h="pixels"===o?i.metersPerPixel:1;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),this.state.model.setUniforms(t).setUniforms({billboard:r,stroked:Boolean(c),padding:u,sizeScale:s*h,sizeMinPixels:a,sizeMaxPixels:l}).draw()}_getModel(t){return new Vg(t,wn(ot({},this.getShaders()),{id:this.props.id,geometry:new oh({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}return n.layerName="TextBackgroundLayer",n.defaultProps=Spe,n})();const x4={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},C4={start:1,middle:0,end:-1},A4={top:1,center:0,bottom:-1},ZO=[0,0,0,255],Ape=["fontSize","buffer","sdf","radius","cutoff"],Tpe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:ZO},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:p4},fontFamily:g4,fontWeight:"normal",lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:ZO},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:ZO},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};let Mpe=(()=>{class n extends _z{initializeState(){this.state={styleVersion:0,fontAtlasManager:new vpe}}updateState({props:t,oldProps:i,changeFlags:r}){const o=this.state.characterSet;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText();const a=o!==this.state.characterSet||this._fontChanged(i,t);a&&this._updateFontAtlas(i,t),(a||t.lineHeight!==i.lineHeight||t.wordBreak!==i.wordBreak||t.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(t,i){const{fontSettings:r,fontFamily:s,fontWeight:o}=i,{fontAtlasManager:a,characterSet:l}=this.state;a.setProps(wn(ot(ot({},x4),r),{characterSet:l,fontFamily:s,fontWeight:o}))}_fontChanged(t,i){if(t.fontFamily!==i.fontFamily||t.fontWeight!==i.fontWeight)return!0;if(t.fontSettings===i.fontSettings)return!1;const r=t.fontSettings||{},s=i.fontSettings||{};return Ape.some(o=>r[o]!==s[o])}_updateText(){const{data:t,characterSet:i}=this.props,r=t.attributes&&t.attributes.getText;let a,{getText:s}=this.props,{startIndices:o}=t;const l="auto"===i&&new Set;if(r&&o){const{texts:c,characterCount:u}=function({value:n,length:e,stride:t,offset:i,startIndices:r,characterSet:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:1,l=i?i/o:0,c=r[e]||Math.ceil((n.length-l)/a),u=s&&new Set,h=new Array(e);let p=n;if(a>1||l>0){p=new n.constructor(c);for(let g=0;g<c;g++)p[g]=n[g*a+l]}for(let g=0;g<e;g++){const C=p.subarray(r[g],r[g+1]||c);h[g]=String.fromCodePoint.apply(null,C),u&&C.forEach(u.add,u)}if(u)for(const g of u)s.add(String.fromCodePoint(g));return{texts:h,characterCount:c}}(wn(ot({},ArrayBuffer.isView(r)?{value:r}:r),{length:t.length,startIndices:o,characterSet:l}));a=u,s=(h,{index:p})=>c[p]}else{const{iterable:c,objectInfo:u}=hS(t);o=[0],a=0;for(const h of c){u.index++;const p=Array.from(s(h,u)||"");l&&p.forEach(l.add,l),a+=p.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||i})}getBoundingRect(t,i){const r=this.state.fontAtlasManager.mapping,{getText:s}=this.state,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,h=s(t,i)||"",{size:[p,g]}=f4(h,l,o,a,r);return[(C4["function"==typeof c?c(t,i):c]-1)*p/2,(A4["function"==typeof u?u(t,i):u]-1)*g/2,p,g]}getIconOffsets(t,i){const r=this.state.fontAtlasManager.mapping,{getText:s}=this.state,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,h=s(t,i)||"",{x:p,y:g,rowWidth:m,size:[w,C]}=f4(h,l,o,a,r),H=C4["function"==typeof c?c(t,i):c],U=A4["function"==typeof u?u(t,i):u],de=p.length,Ce=new Array(2*de);let Pe=0;for(let Be=0;Be<de;Be++)Ce[Pe++]=(H-1)*w/2+(1-H)*(w-m[Be])/2+p[Be],Ce[Pe++]=(U-1)*C/2+g[Be];return Ce}renderLayers(){const{startIndices:t,numInstances:i,getText:r,fontAtlasManager:{scale:s,texture:o,mapping:a},styleVersion:l}=this.state,{data:c,_dataDiff:u,getPosition:h,getColor:p,getSize:g,getAngle:m,getPixelOffset:w,getBackgroundColor:C,getBorderColor:H,getBorderWidth:U,backgroundPadding:de,background:Ce,billboard:Pe,fontSettings:Be,outlineWidth:et,outlineColor:wt,sizeScale:vt,sizeUnits:xt,sizeMinPixels:Ft,sizeMaxPixels:zt,transitions:gt,updateTriggers:mt}=this.props,kt=this.getSubLayerClass("characters",npe),ft=this.getSubLayerClass("background",xpe);return[Ce&&new ft({getFillColor:C,getLineColor:H,getLineWidth:U,padding:de,getPosition:h,getSize:g,getAngle:m,getPixelOffset:w,billboard:Pe,sizeScale:vt/this.state.fontAtlasManager.props.fontSize,sizeUnits:xt,sizeMinPixels:Ft,sizeMaxPixels:zt,transitions:gt&&{getPosition:gt.getPosition,getAngle:gt.getAngle,getSize:gt.getSize,getFillColor:gt.getBackgroundColor,getLineColor:gt.getBorderColor,getLineWidth:gt.getBorderWidth,getPixelOffset:gt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:mt.getPosition,getAngle:mt.getAngle,getSize:mt.getSize,getFillColor:mt.getBackgroundColor,getLineColor:mt.getBorderColor,getLineWidth:mt.getBorderWidth,getPixelOffset:mt.getPixelOffset,getBoundingRect:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:l}}}),{data:c.attributes?{length:c.length,attributes:c.attributes.background||{}}:c,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new kt({sdf:Be.sdf,smoothing:Number.isFinite(Be.smoothing)?Be.smoothing:x4.smoothing,outlineWidth:et,outlineColor:wt,iconAtlas:o,iconMapping:a,getPosition:h,getColor:p,getSize:g,getAngle:m,getPixelOffset:w,billboard:Pe,sizeScale:vt*s,sizeUnits:xt,sizeMinPixels:Ft*s,sizeMaxPixels:zt*s,transitions:gt&&{getPosition:gt.getPosition,getAngle:gt.getAngle,getColor:gt.getColor,getSize:gt.getSize,getPixelOffset:gt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:mt.getText,getPosition:mt.getPosition,getAngle:mt.getAngle,getColor:mt.getColor,getSize:mt.getSize,getPixelOffset:mt.getPixelOffset,getIconOffsets:{getText:mt.getText,getTextAnchor:mt.getTextAnchor,getAlignmentBaseline:mt.getAlignmentBaseline,styleVersion:l}}}),{data:c,_dataDiff:u,startIndices:t,numInstances:i,getIconOffsets:this.getIconOffsets.bind(this),getIcon:r})]}}return n.layerName="TextLayer",n.defaultProps=Tpe,n})();const T4="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Dpe={lightSources:{}};function JO({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const eR={name:"lights",vs:T4,fs:T4,getUniforms:function M4(n=Dpe){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?JO(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=JO(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=JO(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return M4({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Ope={};const Npe={name:"phong-lighting",dependencies:[eR],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=Ope){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},tR=Math.PI/180,XS=new Float32Array(16),O4=new Float32Array(12);function R4(n,e,t){const i=e[0]*tR,r=e[1]*tR,s=e[2]*tR,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),u=Math.cos(i),h=Math.cos(r),p=t[0],g=t[1],m=t[2];n[0]=p*h*u,n[1]=p*l*u,n[2]=p*-a,n[3]=g*(-l*c+h*a*o),n[4]=g*(h*c+l*a*o),n[5]=g*u*o,n[6]=m*(l*o+h*a*c),n[7]=m*(-h*o+l*a*c),n[8]=m*u*c}function N4(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const P4={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,u=Array.isArray(s),h=Array.isArray(r),p=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:h&&u&&p;const m=n.value;if(n.constant){let w;g?(XS.set(a),w=N4(XS)):(w=O4,R4(w,r,s),w.set(o,9)),n.value=new Float32Array(w)}else{let w=e*n.size;const{iterable:C,objectInfo:H}=hS(i,e,t);for(const U of C){let de;H.index++,g?(XS.set(c?a:a(U,H)),de=N4(XS)):(de=O4,R4(de,h?r:r(U,H),u?s:s(U,H)),de.set(p?o:o(U,H),9)),m[w++]=de[0],m[w++]=de[1],m[w++]=de[2],m[w++]=de[3],m[w++]=de[4],m[w++]=de[5],m[w++]=de[6],m[w++]=de[7],m[w++]=de[8],m[w++]=de[9],m[w++]=de[10],m[w++]=de[11]}}}};function F4(n,e){return e===Fi.CARTESIAN||e===Fi.METER_OFFSETS||e===Fi.DEFAULT&&!n.isGeospatial}function L4(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),xi.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Lpe(n,e){if(n.attributes)return L4(n.attributes,e),n instanceof oh?n:new oh(n);if(n.positions||n.POSITION)return L4(n,e),new oh({attributes:n});throw Error("Invalid mesh")}const kpe={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let Bpe=(()=>{class n extends V0{getShaders(){const t=!_i(this.context.gl),i={};return lI(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[YS,Npe,KS],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:P4}),this.setState({emptyTexture:new ua(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||F4(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new Vg(this.context.gl,wn(ot({},this.getShaders()),{id:this.props.id,geometry:Lpe(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=kpe,n})();const k4={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[eR]};class Xg{constructor(e={}){const{id:t}=e;this.id=t||la(this.constructor.name),this.display=!0,this.position=new Eo,this.rotation=new Eo,this.scale=new Eo(1,1,1),this.matrix=new $n,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return en(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return en(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return en(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){en(e),t=t||this.matrix;const i=new $n(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class q0 extends Xg{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;un.assert(t.every(i=>i instanceof Xg),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new $n}={}){const i=new $n(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof q0?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function B4(n,e){if(n===e){var t=e[1],i=e[2],r=e[5];n[1]=e[3],n[2]=e[6],n[3]=t,n[5]=e[7],n[6]=i,n[7]=r}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n}function j4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,p=-u*s+a*l,g=c*s-o*l,m=t*h+i*p+r*g;return m?(n[0]=h*(m=1/m),n[1]=(-u*i+r*c)*m,n[2]=(a*i-r*o)*m,n[3]=p*m,n[4]=(u*t-r*l)*m,n[5]=(-a*t+r*s)*m,n[6]=g*m,n[7]=(-c*t+i*l)*m,n[8]=(o*t-i*s)*m,n):null}function V4(n){var r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8];return n[0]*(c*s-o*l)+n[1]*(-c*r+o*a)+n[2]*(l*r-s*a)}function QS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=t[0],g=t[1],m=t[2],w=t[3],C=t[4],H=t[5],U=t[6],de=t[7],Ce=t[8];return n[0]=p*i+g*o+m*c,n[1]=p*r+g*a+m*u,n[2]=p*s+g*l+m*h,n[3]=w*i+C*o+H*c,n[4]=w*r+C*a+H*u,n[5]=w*s+C*l+H*h,n[6]=U*i+de*o+Ce*c,n[7]=U*r+de*a+Ce*u,n[8]=U*s+de*l+Ce*h,n}function U4(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=t[0],g=t[1];return n[0]=i,n[1]=r,n[2]=s,n[3]=o,n[4]=a,n[5]=l,n[6]=p*i+g*o+c,n[7]=p*r+g*a+u,n[8]=p*s+g*l+h,n}function z4(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=Math.sin(t),g=Math.cos(t);return n[0]=g*i+p*o,n[1]=g*r+p*a,n[2]=g*s+p*l,n[3]=g*o-p*i,n[4]=g*a-p*r,n[5]=g*l-p*s,n[6]=c,n[7]=u,n[8]=h,n}function ZS(n,e,t){var i=t[0],r=t[1];return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=r*e[3],n[4]=r*e[4],n[5]=r*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function H4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,p=r*o,g=r*a,m=r*l,w=s*o,C=s*a,H=s*l;return n[0]=1-h-m,n[3]=u-H,n[6]=p+C,n[1]=u+H,n[4]=1-c-m,n[7]=g-w,n[2]=p-C,n[5]=g+w,n[8]=1-c-h,n}function G4(){var n=new da(4);return da!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function $4(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function nR(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function JS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return n[0]=i*u+o*a+r*c-s*l,n[1]=r*u+o*l+s*a-i*c,n[2]=s*u+o*c+i*l-r*a,n[3]=o*u-i*a-r*l-s*c,n}function W4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a,n}function q4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a,n}function Y4(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);return n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a,n}function K4(n,e){var t=e[0],i=e[1],r=e[2];return n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r)),n}function Y0(n,e,t,i){var p,g,m,w,C,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],u=t[2],h=t[3];return(g=r*l+s*c+o*u+a*h)<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>zc?(p=Math.acos(g),m=Math.sin(p),w=Math.sin((1-i)*p)/m,C=Math.sin(i*p)/m):(w=1-i,C=i),n[0]=w*r+C*l,n[1]=w*s+C*c,n[2]=w*o+C*u,n[3]=w*a+C*h,n}function X4(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;return n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a,n}function Q4(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function iR(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}return n}var Z4=function(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},rR=dU,sR=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},J4=function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a),n},e8=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},t8=function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r},i8=function(){var n=eV(),e=tV(1,0,0),t=tV(0,1,0);return function(i,r,s){var o=nV(r,s);return o<-.999999?(w0(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&w0(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),nR(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(w0(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();G4(),G4(),function(){var n=new da(9);da!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const zpe=[0,0,0,1];class oR extends cS{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return iR(this,e),this.check()}identity(){return $4(this),this.check()}fromAxisRotation(e,t){return nR(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=er(e)}get y(){return this[1]}set y(e){this[1]=er(e)}get z(){return this[2]}set z(e){this[2]=er(e)}get w(){return this[3]}set w(e){this[3]=er(e)}len(){return e8(this)}lengthSquared(){return t8(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return sR(this,e)}rotationTo(e,t){return i8(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return Z4(this,this,e),this.check()}calculateW(){return K4(this,this),this.check()}conjugate(){return Q4(this,this),this.check()}invert(){return X4(this,this),this.check()}lerp(e,t,i){return J4(this,e,t,i),this.check()}multiplyRight(e,t){return ju(!t),JS(this,this,e),this.check()}multiplyLeft(e,t){return ju(!t),JS(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return W4(this,this,e),this.check()}rotateY(e){return q4(this,this,e),this.check()}rotateZ(e){return Y4(this,this,e),this.check()}scale(e){return rR(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=zpe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return Y0(this,e,t,i),this.check()}transformVector4(e,t=e){return hU(t,e,this),v0(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const Hpe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Gpe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function r8(n){if(!n._animation){const e=Gpe[n.componentType],t=Hpe[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const $pe=new $n,aR=new oR;class Qpe{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(p=>p>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:un.warn(`Bad animation path ${s}`)()}en(r[s].length===i[c].length);const u=e[c],h=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":h>u&&function(n,e,t,i,r){if("rotation"===e){aR.slerp({start:t,target:i,ratio:r});for(let s=0;s<aR.length;s++)n[e][s]=aR[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-u)/(h-u));break;case"CUBICSPLINE":h>u&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,u=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*u}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:h-u,ratio:(a-u)/(h-u)});break;default:un.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=$pe.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class Zpe{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:r8(e.accessors[a]),interpolation:l,output:r8(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new Qpe({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class Jpe extends Xg{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof Vg?(this.model=e,this._setModelNodeProps(t)):this.model=new Vg(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class ege{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},lI(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new ua(this.gl,ot({id:e.name||e.id,parameters:ot(ot({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(un.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function s8(n,e){return _i(n)?`#version 300 es\n${e}`:e}const rge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sge={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class oge{constructor(e,t={}){this.gl=e,this.options=Object.assign({},sge,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new Zpe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new q0({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new q0({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new $n).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new q0({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){un.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new ege(n,e);un.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(u=>u.buffer));const c=new Jpe(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[k4],defines:a.defines,parameters:a.parameters,vs:s8(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:s8(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),un.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new lr(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new ca({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:rge[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function o8(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Va(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function a8(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function l8(n,e,t){const i=n.bufferViews[t];Va(i);const s=e[i.buffer];return Va(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const c8={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class Qg{constructor(e,t){qn(this,"fields",void 0),qn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new Qg(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new Qg(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof Qg){const o=e;t=o.fields,i=u8(u8(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new Qg(s,i)}}function u8(n,e){return new Map([...n||new Map,...e||new Map])}let Rr,d8,h8,f8,p8,g8,m8,_8;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(Rr||(Rr={}));class lR{static isNull(e){return e&&e.typeId===Rr.Null}static isInt(e){return e&&e.typeId===Rr.Int}static isFloat(e){return e&&e.typeId===Rr.Float}static isBinary(e){return e&&e.typeId===Rr.Binary}static isUtf8(e){return e&&e.typeId===Rr.Utf8}static isBool(e){return e&&e.typeId===Rr.Bool}static isDecimal(e){return e&&e.typeId===Rr.Decimal}static isDate(e){return e&&e.typeId===Rr.Date}static isTime(e){return e&&e.typeId===Rr.Time}static isTimestamp(e){return e&&e.typeId===Rr.Timestamp}static isInterval(e){return e&&e.typeId===Rr.Interval}static isList(e){return e&&e.typeId===Rr.List}static isStruct(e){return e&&e.typeId===Rr.Struct}static isUnion(e){return e&&e.typeId===Rr.Union}static isFixedSizeBinary(e){return e&&e.typeId===Rr.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Rr.FixedSizeList}static isMap(e){return e&&e.typeId===Rr.Map}static isDictionary(e){return e&&e.typeId===Rr.Dictionary}get typeId(){return Rr.NONE}compareTo(e){return this===e}}Symbol,Symbol,d8=Symbol.toStringTag;class Zg extends lR{constructor(e,t){super(),qn(this,"isSigned",void 0),qn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Rr.Int}get[d8](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class mge extends Zg{constructor(){super(!0,8)}}class _ge extends Zg{constructor(){super(!0,16)}}class yge extends Zg{constructor(){super(!0,32)}}class bge extends Zg{constructor(){super(!1,8)}}class vge extends Zg{constructor(){super(!1,16)}}class wge extends Zg{constructor(){super(!1,32)}}h8=Symbol.toStringTag;class y8 extends lR{constructor(e){super(),qn(this,"precision",void 0),this.precision=e}get typeId(){return Rr.Float}get[h8](){return"Float"}toString(){return`Float${this.precision}`}}class Ege extends y8{constructor(){super(32)}}class Sge extends y8{constructor(){super(64)}}Symbol,Symbol,f8=Symbol.toStringTag,p8=Symbol.toStringTag,g8=Symbol.toStringTag,m8=Symbol.toStringTag,_8=Symbol.toStringTag;class xge extends lR{constructor(e,t){super(),qn(this,"listSize",void 0),qn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Rr.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[_8](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class ex{constructor(e,t,i=!1,r=new Map){qn(this,"name",void 0),qn(this,"type",void 0),qn(this,"nullable",void 0),qn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new ex(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function b8(n,e,t){const i=t?v8(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new mge;case Uint8Array:return new bge;case Int16Array:return new _ge;case Uint16Array:return new vge;case Int32Array:return new yge;case Uint32Array:return new wge;case Float32Array:return new Ege;case Float64Array:return new Sge;default:throw new Error("array type not supported")}}(e.value);return new ex(n,new xge(e.size,new ex("value",r)),!1,i)}function v8(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const w8={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Mge={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class Ige{constructor(e){qn(this,"draco",void 0),qn(this,"decoder",void 0),qn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const p=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(p)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const u=a[c],h=a[c+1],p=a[c+2];e=u<e?u:e,t=h<t?h:t,i=p<i?p:i,r=u>r?u:r,s=h>s?h:s,o=p>o?p:o}return[[e,t,i],[r,s,o]]}(l.attributes),u=function(n,e,t){const i=v8(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=b8(o,n[o],s[o]);r.push(l)}if(t){const o=b8("indices",t);r.push(o)}return new Qg(r,i)}(l.attributes,a,l.indices);return wn(ot({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:u})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=Mge[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const u=this.draco._malloc(a);try{const h=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,h,l,a,u),c=new i(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in w8)if(this.draco[o]===r)return w8[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var tx=Je(125);const hR={};function fR(n){return pR.apply(this,arguments)}function pR(){return(pR=ni(function*(n,e=null,t={}){return e&&(n=Fge(n,e,t)),hR[n]=hR[n]||Lge(n),yield hR[n]})).apply(this,arguments)}function Fge(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:aO?t.CDN?(Gc(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):lO?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function Lge(n){return gR.apply(this,arguments)}function gR(){return(gR=ni(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():aO?lO?importScripts(n):kge(yield(yield fetch(n)).text(),n):tx.requireFromFile&&(yield tx.requireFromFile(n))})).apply(this,arguments)}function kge(n,e){if(!aO)return tx.requireFromString&&tx.requireFromString(n,e);if(lO)return eval.call(eue,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const Bge="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",jge="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",Vge="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let K0;function zge(n){return mR.apply(this,arguments)}function mR(){return(mR=ni(function*(n){const e=n.modules||{};return K0=e.draco3d?K0||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):K0||Hge(n),yield K0})).apply(this,arguments)}function Hge(n){return yR.apply(this,arguments)}function yR(){return(yR=ni(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield fR(Bge,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield fR(jge,"draco",n),yield fR(Vge,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield Gge(e,t)})).apply(this,arguments)}function Gge(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(wn(ot({},t),{onModuleLoaded:r=>i({draco:r})}))})}const vR=wn(ot({},c8),{parse:function(n,e){return wR.apply(this,arguments)}});function wR(){return(wR=ni(function*(n,e){const{draco:t}=yield zge(e),i=new Ige(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function Q0(n,e){return Mf(n>=0),Mf(e>0),n+(e-1)&~(e-1)}function qge(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+Q0(i.byteLength,4)}const E8=["SCALAR","VEC2","VEC3","VEC4"],Yge=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Kge=new Map(Yge),Xge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Qge={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Zge={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function S8(n){return E8[n-1]||E8[0]}function x8(n){const e=Kge.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function C8(n,e){const t=Zge[n.componentType],i=Xge[n.type],s=n.count*i,o=n.count*i*Qge[n.componentType];return Va(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const Jge={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class lh{constructor(e){qn(this,"gltf",void 0),qn(this,"sourceBuffers",void 0),qn(this,"byteLength",void 0),this.gltf=e||{json:ot({},Jge),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return Va(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=C8(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return Va(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Va(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=GO(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Va(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Q0(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:S8(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:x8(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=qge(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const A8="KHR_binary_glTF",Z0="KHR_draco_mesh_compression",Jg="KHR_lights_punctual",ix="KHR_materials_unlit",rx="KHR_techniques_webgl";function nme(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=T8(i);e[t]=r}}return e}function T8(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:S8(t),componentType:x8(e)}}function sme(n,e,t){return ER.apply(this,arguments)}function ER(){return(ER=ni(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new lh(n),s=[];for(const o of ume(r))r.getObjectExtension(o,Z0)&&s.push(ame(r,o,e,t));yield Promise.all(s),r.removeExtension(Z0)})).apply(this,arguments)}function ome(n,e={}){const t=new lh(n);for(const i of t.json.meshes||[])lme(i),t.addRequiredExtension(Z0)}function ame(n,e,t,i){return SR.apply(this,arguments)}function SR(){return(SR=ni(function*(n,e,t,i){const r=n.getObjectExtension(e,Z0);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=az(s.buffer,s.byteOffset),{parse:a}=i,l=ot({},t);delete l["3d-tiles"];const c=yield a(o,vR,l,i),u=nme(c.attributes);for(const[h,p]of Object.entries(u))if(h in e.attributes){const m=n.getAccessor(e.attributes[h]);null!=m&&m.min&&null!=m&&m.max&&(p.min=m.min,p.max=m.max)}e.attributes=u,c.indices&&(e.indices=T8(c.indices)),cme(e)})).apply(this,arguments)}function lme(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[Z0]:{bufferView:c,attributes:l}}}]}}function cme(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*ume(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function dme(n){return xR.apply(this,arguments)}function xR(){return(xR=ni(function*(n){const e=new lh(n),{json:t}=e;e.removeExtension(ix);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,ix)})).apply(this,arguments)}function hme(n){const e=new lh(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,ix,{}),e.addExtension(ix))}function fme(n){return CR.apply(this,arguments)}function CR(){return(CR=ni(function*(n){const e=new lh(n),{json:t}=e,i=e.getExtension(Jg);i&&(e.json.lights=i.lights,e.removeExtension(Jg));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,Jg);s&&(r.light=s.light),e.removeObjectExtension(r,Jg)}})).apply(this,arguments)}function pme(n){return AR.apply(this,arguments)}function AR(){return(AR=ni(function*(n){const e=new lh(n),{json:t}=e;if(t.lights){const i=e.addExtension(Jg);Va(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,Jg,i);delete e.json.lights}})).apply(this,arguments)}function gme(n){return TR.apply(this,arguments)}function TR(){return(TR=ni(function*(n){const e=new lh(n),{json:t}=e,i=e.getExtension(rx);if(i){const r=_me(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,rx);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=yme(s.technique,e)),e.removeObjectExtension(s,rx)}e.removeExtension(rx)}})).apply(this,arguments)}function mme(n,e){return MR.apply(this,arguments)}function MR(){return(MR=ni(function*(n,e){})).apply(this,arguments)}function _me(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function yme(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const M8={KHR_draco_mesh_compression:yt,KHR_materials_unlit:ee,KHR_lights_punctual:At,KHR_techniques_webgl:dt};function bme(n){return DR.apply(this,arguments)}function DR(){return(DR=ni(function*(n,e={},t){for(const r in M8){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield M8[r].decode(n,e,t))}})).apply(this,arguments)}const D8={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},wme={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Eme{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new lh(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,A8);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(A8)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in D8)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in D8)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=wme[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function Sme(n,e={}){return(new Eme).normalize(n,e)}const xme={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Cme={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},El={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Ame={magFilter:El.TEXTURE_MAG_FILTER,minFilter:El.TEXTURE_MIN_FILTER,wrapS:El.TEXTURE_WRAP_S,wrapT:El.TEXTURE_WRAP_T},Tme={[El.TEXTURE_MAG_FILTER]:El.LINEAR,[El.TEXTURE_MIN_FILTER]:El.NEAREST_MIPMAP_LINEAR,[El.TEXTURE_WRAP_S]:El.REPEAT,[El.TEXTURE_WRAP_]:El.REPEAT};class Ime{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return Va(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=ot({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=ot({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ot({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ot({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ot({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=ot({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=ot({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return Cme[n]}(e.componentType),e.components=function(n){return xme[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=C8(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):Tme,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return Ame[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function Ome(n,e){return(new Ime).postProcess(n,e)}const I8=1735152710,em=!0;function OR(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),Q0(i,4)}function RR(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),Q0(i,4)}function Hme(n,e){return NR.apply(this,arguments)}function NR(){return(NR=ni(function*(n,e,t=0,i,r){var s,o,a,l;Gme(n,e,t,i),Sme(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield $me(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const h=Wme(n,i,r);c.push(h)}const u=bme(n,i,r);return c.push(u),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?Ome(n,i):n})).apply(this,arguments)}function Gme(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=I8}=t,s=i.getUint32(e,!1);return s===r||s===I8}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?o8(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?o8(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,em),a=r.getUint32(t+8,em);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){Mf(n.header.byteLength>20);const i=e.getUint32(t+0,em),r=e.getUint32(t+4,em);return t+=8,Mf(0===r),OR(n,e,t,i),(t+=i)+RR(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return Mf(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,em),s=e.getUint32(t+4,em);switch(t+=8,s){case 1313821514:OR(n,e,t,r);break;case 5130562:RR(n,e,t,r);break;case 0:i.strict||OR(n,e,t,r);break;case 1:i.strict||RR(n,e,t,r)}t+=Q0(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),Va("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else Va(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function $me(n,e,t){return PR.apply(this,arguments)}function PR(){return(PR=ni(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;Va(a);const l=a8(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),u=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete o.uri}}})).apply(this,arguments)}function Wme(n,e,t){return FR.apply(this,arguments)}function FR(){return(FR=ni(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(qme(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function qme(n,e,t,i,r){return LR.apply(this,arguments)}function LR(){return(LR=ni(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=a8(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=l8(n.json,n.buffers,e.bufferView);a=az(c.buffer,c.byteOffset,c.byteLength)}Va(a,"glTF image has no data");const l=yield o(a,WO,{},r);n.images[t]=l})).apply(this,arguments)}const tm={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return kR.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function kR(){return(kR=ni(function*(n,e={},t){(e=ot(ot({},tm.options),e)).gltf=ot(ot({},tm.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield Hme({},n,i,e,t)})).apply(this,arguments)}function BR(){return(BR=ni(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield Xme(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function Xme(n){return jR.apply(this,arguments)}function jR(){return(jR=ni(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const O8=[255,255,255,255],Jme={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:O8},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[tm]};let e_e=(()=>{class n extends V0{getShaders(){const t=[YS,KS];return"pbr"===this.props._lighting&&t.push(k4),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:O8,transition:!0},instanceModelMatrix:P4})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof Xg)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new oge(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=ot({gltf:l},c),function(n){return BR.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(xi.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof Xg?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&xi.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):xi.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):xi.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof Xg&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:ot({isInstanced:!0,transpileToGLSL100:!_i(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:u}=this.props,h=this.getNumInstances();this.state.scenegraph.traverse((p,{worldMatrix:g})=>{p.model.setInstanceCount(h),p.updateModuleSettings(t),p.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:F4(s,u),sceneModelMatrix:g,u_Camera:p.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=Jme,n})();class t_e extends oh{constructor(e={}){const{id:t=la("sphere-geometry")}=e,{indices:i,attributes:r}=function(n){const{nlat:e=10,nlong:t=10}=n;let{radius:i=1}=n;const o=Math.PI-0,c=2*Math.PI-0,u=(e+1)*(t+1);if("number"==typeof i){const H=i;i=(U,de,Ce,Pe,Be)=>H}const h=new Float32Array(3*u),p=new Float32Array(3*u),g=new Float32Array(2*u),w=new(u>65535?Uint32Array:Uint16Array)(e*t*6);for(let H=0;H<=e;H++)for(let U=0;U<=t;U++){const de=U/t,Ce=H/e,Pe=U+H*(t+1),Be=2*Pe,et=3*Pe,wt=c*de,vt=o*Ce,xt=Math.sin(wt),Ft=Math.cos(wt),zt=Math.sin(vt),mt=Ft*zt,kt=Math.cos(vt),ft=xt*zt,$t=i(mt,kt,ft,de,Ce);h[et+0]=$t*mt,h[et+1]=$t*kt,h[et+2]=$t*ft,p[et+0]=mt,p[et+1]=kt,p[et+2]=ft,g[Be+0]=de,g[Be+1]=1-Ce}const C=t+1;for(let H=0;H<t;H++)for(let U=0;U<e;U++){const de=6*(H*e+U);w[de+0]=U*C+H,w[de+1]=U*C+H+1,w[de+2]=(U+1)*C+H,w[de+3]=(U+1)*C+H,w[de+4]=U*C+H+1,w[de+5]=(U+1)*C+H+1}return{indices:{size:1,value:w},attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:p},TEXCOORD_0:{size:2,value:g}}}}(e);super(wn(ot({},e),{id:t,indices:i,attributes:ot(ot({},r),e.attributes)}))}}const i_e={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class R8 extends oh{constructor(e={}){const{id:t=la("truncated-code-geometry")}=e,{indices:i,attributes:r}=function(n){const{bottomRadius:e=0,topRadius:t=0,height:i=1,nradial:r=10,nvertical:s=10,verticalAxis:o="y",topCap:a=!1,bottomCap:l=!1}=n,c=(a?2:0)+(l?2:0),u=(r+1)*(s+1+c),h=Math.atan2(e-t,i),p=Math.sin,g=Math.cos,m=Math.PI,w=g(h),C=p(h),H=a?-2:0,U=s+(l?2:0),de=r+1,Ce=new Uint16Array(r*(s+c)*6),Pe=i_e[o],Be=new Float32Array(3*u),et=new Float32Array(3*u),wt=new Float32Array(2*u);let vt=0,xt=0;for(let Ft=H;Ft<=U;Ft++){let mt,zt=Ft/s,gt=i*zt;Ft<0?(gt=0,zt=1,mt=e):Ft>s?(gt=i,zt=1,mt=t):mt=e+Ft/s*(t-e),(-2===Ft||Ft===s+2)&&(mt=0,zt=0),gt-=i/2;for(let kt=0;kt<de;kt++){const ft=p(kt*m*2/r),$t=g(kt*m*2/r);Be[vt+Pe[0]]=ft*mt,Be[vt+Pe[1]]=gt,Be[vt+Pe[2]]=$t*mt,et[vt+Pe[0]]=Ft<0||Ft>s?0:ft*w,et[vt+Pe[1]]=Ft<0?-1:Ft>s?1:C,et[vt+Pe[2]]=Ft<0||Ft>s?0:$t*w,wt[xt+0]=kt/r,wt[xt+1]=zt,xt+=2,vt+=3}}for(let Ft=0;Ft<s+c;Ft++)for(let zt=0;zt<r;zt++){const gt=6*(Ft*r+zt);Ce[gt+0]=de*(Ft+0)+0+zt,Ce[gt+1]=de*(Ft+0)+1+zt,Ce[gt+2]=de*(Ft+1)+1+zt,Ce[gt+3]=de*(Ft+0)+0+zt,Ce[gt+4]=de*(Ft+1)+1+zt,Ce[gt+5]=de*(Ft+1)+0+zt}return{indices:Ce,attributes:{POSITION:{size:3,value:Be},NORMAL:{size:3,value:et},TEXCOORD_0:{size:2,value:wt}}}}(e);super(wn(ot({},e),{id:t,indices:i,attributes:ot(ot({},r),e.attributes)}))}}class s_e extends R8{constructor(e={}){const{id:t=la("cone-geometry"),radius:i=1,cap:r=!0}=e;super(wn(ot({},e),{id:t,topRadius:0,topCap:Boolean(r),bottomCap:Boolean(r),bottomRadius:i}))}}class o_e extends R8{constructor(e={}){const{id:t=la("cylinder-geometry"),radius:i=1}=e;super(wn(ot({},e),{id:t,bottomRadius:i,topRadius:i}))}}const a_e=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),l_e=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),c_e=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),u_e=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),d_e={POSITION:{size:3,value:new Float32Array(l_e)},NORMAL:{size:3,value:new Float32Array(c_e)},TEXCOORD_0:{size:2,value:new Float32Array(u_e)}};class h_e extends oh{constructor(e={}){const{id:t=la("cube-geometry")}=e;super(wn(ot({},e),{id:t,indices:{size:1,value:new Uint16Array(a_e)},attributes:ot(ot({},d_e),e.attributes)}))}}class Xc{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new le){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new le){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new Xc){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],h=i[5],p=i[6],g=i[7],m=i[8],w=r[0],C=r[1],H=r[2],U=r[3],de=r[4],Ce=r[5],Pe=r[6],Be=r[7],et=r[8];return s[0]=o*w+a*U+l*Pe,s[1]=o*C+a*de+l*Be,s[2]=o*H+a*Ce+l*et,s[3]=c*w+u*U+h*Pe,s[4]=c*C+u*de+h*Be,s[5]=c*H+u*Ce+h*et,s[6]=p*w+g*U+m*Pe,s[7]=p*C+g*de+m*Be,s[8]=p*H+g*Ce+m*et,t}scale(e,t=new Xc){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new le){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let u,p;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){u=4;do{p=4-u,s[p+4*o]+=s[p+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];u=4;do{p=4-u,s[p+4*a]=p<=o?0:s[p+4*a]-s[p+4*o]*g}while(--u)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new Xc){const r=f_e;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,h;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{h=6-c,r[h+6*s]+=r[h+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const p=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=h<=s?0:r[h+6*o]-r[h+6*s]*p}while(--c)}}while(--a);s=2;do{o=s-1;do{const p=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=r[h+6*o]-r[h+6*s]*p}while(--c)}while(o--)}while(--s);s=2;do{const p=1/r[s+6*s];c=6;do{h=6-c,r[h+6*s]=r[h+6*s]*p}while(--c)}while(s--);s=2;do{o=2;do{if(h=r[3+o+6*s],isNaN(h)||h===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,h)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,u=t*a,h=t*l,p=i*a,g=i*l,m=r*l,w=s*o,C=s*a,H=s*l,U=this.elements;return U[0]=1-(p+m),U[1]=u-H,U[2]=h+C,U[3]=u+H,U[4]=1-(c+m),U[5]=g-w,U[6]=h-C,U[7]=g+w,U[8]=1-(c+p),this}transpose(e=new Xc){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const f_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class le{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new le(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new le(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new Xc([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new le){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new le){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new le){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new le){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new le){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=p_e,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=g_e;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(N8),N8.almostEquals(e,t)}clone(){return new le(this.x,this.y,this.z)}}le.ZERO=void 0,le.UNIT_X=void 0,le.UNIT_Y=void 0,le.UNIT_Z=void 0,le.ZERO=new le(0,0,0),le.UNIT_X=new le(1,0,0),le.UNIT_Y=new le(0,1,0),le.UNIT_Z=new le(0,0,1);const p_e=new le,g_e=new le,N8=new le;class dr{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new le,this.upperBound=new le,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,P8),c=P8),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new dr).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),t.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),r.set(c.x,u.y,u.z),s.set(u.x,c.y,u.z),o.set(c.x,u.y,c.z),a.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,t){const i=F8;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=F8;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,h=(this.lowerBound.z-i.z)*o,p=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,u)),Math.min(h,p)),m=Math.min(Math.min(Math.max(a,l),Math.max(c,u)),Math.max(h,p));return!(m<0||g>m)}}const P8=new le,F8=[new le,new le,new le,new le,new le,new le,new le,new le];class os{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new le){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=__e;e.tangents(i,y_e),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(br(e.length(),2)*br(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new os){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return t.x=i*u+o*a+r*c-s*l,t.y=r*u+o*l+s*a-i*c,t.z=s*u+o*c+i*l-r*a,t.w=o*u-i*a-r*l-s*c,t}inverse(e=new os){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new os){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,u=c*i+a*s-l*r,h=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=u*c+g*-o+h*-l-p*-a,t.y=h*c+g*-a+p*-o-u*-l,t.z=p*c+g*-l+u*-a-h*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const u=o*a+l*c;if(u>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const h=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*u),s=Math.atan2(2*o*c-2*a*l,1-2*h-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),u=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"YXZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"ZXY"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"ZYX"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"YZX"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a-l*c*u):"XZY"===r&&(this.x=l*o*a-s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a+l*c*u),this}clone(){return new os(this.x,this.y,this.z,this.w)}slerp(e,t,i=new os){const r=this.x,s=this.y,o=this.z,a=this.w;let p,g,m,w,C,l=e.x,c=e.y,u=e.z,h=e.w;return g=r*l+s*c+o*u+a*h,g<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>1e-6?(p=Math.acos(g),m=Math.sin(p),w=Math.sin((1-t)*p)/m,C=Math.sin(t*p)/m):(w=1-t,C=t),i.x=w*r+C*l,i.y=w*s+C*c,i.z=w*o+C*u,i.w=w*a+C*h,i}integrate(e,t,i,r=new os){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,u=this.z,h=this.w,p=.5*t;return r.x+=p*(s*h+o*u-a*c),r.y+=p*(o*h+a*l-s*u),r.z+=p*(a*h+s*c-o*l),r.w+=p*(-s*l-o*c-a*u),r}}const __e=new le,y_e=new le,b_e={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let dn=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=b_e,n})();class ji{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new le,this.quaternion=new os,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return ji.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return ji.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new le){return i.vsub(e,r),t.conjugate(k8),k8.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new le){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new le){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new le){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const k8=new os;class Of extends dn{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:dn.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new le;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let u=!1;for(let h=0;h!==i.length;h++)if(i[h].almostEquals(r)||i[h].almostEquals(r)){u=!0;break}u||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new le;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];Of.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new le,o=new le;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const u=new le;let h=-1,p=-Number.MAX_VALUE;for(let m=0;m<i.faces.length;m++){u.copy(i.faceNormals[m]),s.vmult(u,u);const w=u.dot(o);w>p&&(p=w,h=m)}const g=[];for(let m=0;m<i.faces[h].length;m++){const w=i.vertices[i.faces[h][m]],C=new le;C.copy(w),s.vmult(C,C),r.vadd(C,C),g.push(C)}h>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new le,u=new le,h=new le,p=new le,g=new le,m=new le;let w=Number.MAX_VALUE;const C=this;if(C.uniqueAxes)for(let H=0;H!==C.uniqueAxes.length;H++){i.vmult(C.uniqueAxes[H],c);const U=C.testSepAxis(c,e,t,i,r,s);if(!1===U)return!1;U<w&&(w=U,o.copy(c))}else{const H=a?a.length:C.faces.length;for(let U=0;U<H;U++){c.copy(C.faceNormals[a?a[U]:U]),i.vmult(c,c);const Ce=C.testSepAxis(c,e,t,i,r,s);if(!1===Ce)return!1;Ce<w&&(w=Ce,o.copy(c))}}if(e.uniqueAxes)for(let H=0;H!==e.uniqueAxes.length;H++){s.vmult(e.uniqueAxes[H],u);const U=C.testSepAxis(u,e,t,i,r,s);if(!1===U)return!1;U<w&&(w=U,o.copy(u))}else{const H=l?l.length:e.faces.length;for(let U=0;U<H;U++){u.copy(e.faceNormals[l?l[U]:U]),s.vmult(u,u);const Ce=C.testSepAxis(u,e,t,i,r,s);if(!1===Ce)return!1;Ce<w&&(w=Ce,o.copy(u))}}for(let H=0;H!==C.uniqueEdges.length;H++){i.vmult(C.uniqueEdges[H],p);for(let U=0;U!==e.uniqueEdges.length;U++)if(s.vmult(e.uniqueEdges[U],g),p.cross(g,m),!m.almostZero()){m.normalize();const de=C.testSepAxis(m,e,t,i,r,s);if(!1===de)return!1;de<w&&(w=de,o.copy(m))}}return r.vsub(t,h),h.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){Of.project(this,e,i,r,VR),Of.project(t,e,s,o,UR);const l=VR[0],c=VR[1],u=UR[0],h=UR[1];if(l<h||u<c)return!1;const p=l-h,g=u-c;return p<g?p:g}calculateLocalInertia(e,t){const i=new le,r=new le;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new le,c=new le,u=new le,h=new le,p=new le,g=new le,m=new le,w=new le,C=this,U=r,de=[];let Ce=-1,Pe=Number.MAX_VALUE;for(let xt=0;xt<C.faces.length;xt++){l.copy(C.faceNormals[xt]),i.vmult(l,l);const Ft=l.dot(e);Ft<Pe&&(Pe=Ft,Ce=xt)}if(Ce<0)return;const Be=C.faces[Ce];Be.connectedFaces=[];for(let xt=0;xt<C.faces.length;xt++)for(let Ft=0;Ft<C.faces[xt].length;Ft++)-1!==Be.indexOf(C.faces[xt][Ft])&&xt!==Ce&&-1===Be.connectedFaces.indexOf(xt)&&Be.connectedFaces.push(xt);const et=Be.length;for(let xt=0;xt<et;xt++){const Ft=C.vertices[Be[xt]];Ft.vsub(C.vertices[Be[(xt+1)%et]],c),u.copy(c),i.vmult(u,u),t.vadd(u,u),h.copy(this.faceNormals[Ce]),i.vmult(h,h),t.vadd(h,h),u.cross(h,p),p.negate(p),g.copy(Ft),i.vmult(g,g),t.vadd(g,g);const gt=Be.connectedFaces[xt];m.copy(this.faceNormals[gt]);const mt=this.getPlaneConstantOfFace(gt);w.copy(m),i.vmult(w,w);const kt=mt-w.dot(t);for(this.clipFaceAgainstPlane(U,de,w,kt);U.length;)U.shift();for(;de.length;)U.push(de.shift())}m.copy(this.faceNormals[Ce]);const wt=this.getPlaneConstantOfFace(Ce);w.copy(m),i.vmult(w,w);const vt=wt-w.dot(t);for(let xt=0;xt<U.length;xt++){let Ft=w.dot(U[xt])+vt;if(Ft<=s&&(console.log("clamped: depth="+Ft+" to minDist="+s),Ft=s),Ft<=o){const zt=U[xt];Ft<=1e-6&&a.push({point:zt,normal:w,depth:Ft})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let u=0;u<a;u++){if(c=e[u],o=i.dot(c)+r,s<0)if(o<0){const h=new le;h.copy(c),t.push(h)}else{const h=new le;l.lerp(c,s/(s-o),h),t.push(h)}else if(o<0){const h=new le;l.lerp(c,s/(s-o),h),t.push(h),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new le);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new le);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,u,h,p=new le;for(let g=0;g<s.length;g++){p.copy(s[g]),t.vmult(p,p),e.vadd(p,p);const m=p;(void 0===o||m.x<o)&&(o=m.x),(void 0===c||m.x>c)&&(c=m.x),(void 0===a||m.y<a)&&(a=m.y),(void 0===u||m.y>u)&&(u=m.y),(void 0===l||m.z<l)&&(l=m.z),(void 0===h||m.z>h)&&(h=m.z)}i.set(o,a,l),r.set(c,u,h)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new le){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new le;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new le;e.vsub(l,c);const u=a.dot(c),h=new le;s.vsub(l,h);const p=a.dot(h);if(u<0&&p>0||u>0&&p<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=v_e;let l=0,c=0;const u=w_e,h=e.vertices;u.setZero(),ji.vectorToLocalFrame(i,r,t,a),ji.pointToLocalFrame(i,r,u,u);const p=u.dot(a);c=l=h[0].dot(a);for(let g=1;g<o;g++){const m=h[g].dot(a);m>l&&(l=m),m<c&&(c=m)}if(c-=p,l-=p,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const VR=[],UR=[],v_e=new le,w_e=new le;class ox extends dn{constructor(e){super({type:dn.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=le,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new Of({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new le){return ox.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)ch.set(s[o][0],s[o][1],s[o][2]),t.vmult(ch,ch),e.vadd(ch,ch),i(ch.x,ch.y,ch.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;Qc[0].set(s.x,s.y,s.z),Qc[1].set(-s.x,s.y,s.z),Qc[2].set(-s.x,-s.y,s.z),Qc[3].set(-s.x,-s.y,-s.z),Qc[4].set(s.x,-s.y,-s.z),Qc[5].set(s.x,s.y,-s.z),Qc[6].set(-s.x,s.y,-s.z),Qc[7].set(s.x,-s.y,s.z);const o=Qc[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=Qc[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,u=l.y,h=l.z;c>r.x&&(r.x=c),u>r.y&&(r.y=u),h>r.z&&(r.z=h),c<i.x&&(i.x=c),u<i.y&&(i.y=u),h<i.z&&(i.z=h)}}}const ch=new le,Qc=[new le,new le,new le,new le,new le,new le,new le,new le];class hn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=hn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new le,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new le,this.previousPosition=new le,this.interpolatedPosition=new le,this.initPosition=new le,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new le,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new le,this.force=new le;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?hn.STATIC:hn.DYNAMIC,typeof e.type==typeof hn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=hn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new le,this.quaternion=new os,this.initQuaternion=new os,this.previousQuaternion=new os,this.interpolatedQuaternion=new os,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new le,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new le,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new le,this.invInertia=new le,this.invInertiaWorld=new Xc,this.invMassSolve=0,this.invInertiaSolve=new le,this.invInertiaWorldSolve=new Xc,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new le(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new le(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new dr,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new le,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=hn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===hn.SLEEPING&&this.dispatchEvent(hn.wakeupEvent)}sleep(){this.sleepState=hn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=br(this.sleepSpeedLimit,2);t===hn.AWAKE&&i<r?(this.sleepState=hn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(hn.sleepyEvent)):t===hn.SLEEPY&&i>r?this.wakeUp():t===hn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(hn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===hn.SLEEPING||this.type===hn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new le){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new le){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new le,s=new os;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=E_e,o=S_e,a=this.quaternion,l=this.aabb,c=x_e;for(let u=0;u!==r;u++){const h=e[u];a.vmult(t[u],s),s.vadd(this.position,s),a.mult(i[u],o),h.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===u?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=C_e,r=A_e;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new le){if(this.type!==hn.DYNAMIC)return;this.sleepState===hn.SLEEPING&&this.wakeUp();const i=T_e;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new le){if(this.type!==hn.DYNAMIC)return;const i=M_e,r=D_e;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===hn.DYNAMIC&&(this.sleepState===hn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new le){if(this.type!==hn.DYNAMIC)return;this.sleepState===hn.SLEEPING&&this.wakeUp();const i=t,r=I_e;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=O_e;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new le){if(this.type!==hn.DYNAMIC)return;const i=R_e,r=N_e;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=P_e;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),ox.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new le;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==hn.DYNAMIC&&this.type!==hn.KINEMATIC||this.sleepState===hn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,h=this.invInertiaWorld,p=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*p.x,r.y+=a.y*g*p.y,r.z+=a.z*g*p.z;const m=h.elements,w=this.angularFactor,C=l.x*w.x,H=l.y*w.y,U=l.z*w.z;s.x+=e*(m[0]*C+m[1]*H+m[2]*U),s.y+=e*(m[3]*C+m[4]*H+m[5]*U),s.z+=e*(m[6]*C+m[7]*H+m[8]*U),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}hn.idCounter=0,hn.COLLIDE_EVENT_NAME="collide",hn.DYNAMIC=1,hn.STATIC=2,hn.KINEMATIC=4,hn.AWAKE=0,hn.SLEEPY=1,hn.SLEEPING=2,hn.wakeupEvent={type:"wakeup"},hn.sleepyEvent={type:"sleepy"},hn.sleepEvent={type:"sleep"};const E_e=new le,S_e=new os,x_e=new dr,C_e=new Xc,A_e=new Xc,T_e=new le,M_e=new le,D_e=new le,I_e=new le,O_e=new le,R_e=new le,N_e=new le,P_e=new le;new le,new le;class ax{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new le,this.rayToWorld=new le,this.hitNormalWorld=new le,this.hitPointWorld=new le,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let B8,j8,V8,U8,z8,H8,G8;B8=dn.types.SPHERE,j8=dn.types.PLANE,V8=dn.types.BOX,U8=dn.types.CYLINDER,z8=dn.types.CONVEXPOLYHEDRON,H8=dn.types.HEIGHTFIELD,G8=dn.types.TRIMESH;class ps{get[B8](){return this._intersectSphere}get[j8](){return this._intersectPlane}get[V8](){return this._intersectBox}get[U8](){return this._intersectConvex}get[z8](){return this._intersectConvex}get[H8](){return this._intersectHeightfield}get[G8](){return this._intersectTrimesh}constructor(e=new le,t=new le){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new le,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=ps.ANY,this.result=new ax,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||ps.ANY,this.result=t.result||new ax,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB($8),$R.length=0,e.broadphase.aabbQuery(e,$8,$R),this.intersectBodies($R),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=U_e,s=z_e;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,Rf);const i=Rf.dot(e);return e.scale(i,cx),cx.vadd(n,cx),t.distanceTo(cx)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new le(0,0,1);t.vmult(c,c);const u=new le;o.vsub(i,u);const h=u.dot(c);if(a.vsub(i,u),h*u.dot(c)>0||o.distanceTo(a)<h)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const m=new le,w=new le,C=new le;o.vsub(i,m);const H=-c.dot(m)/g;l.scale(H,w),o.vadd(w,C),this.reportIntersection(c,C,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=H_e;o.from.copy(this.from),o.to.copy(this.to),ji.pointToLocalFrame(i,t,o.from,o.from),ji.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=G_e;let l,c,u,h;l=c=0,u=h=e.data.length-1;const p=new dr;o.getAABB(p),e.getIndexOfPosition(p.lowerBound.x,p.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(p.upperBound.x,p.upperBound.y,a,!0),u=Math.min(u,a[0]+1),h=Math.min(h,a[1]+1);for(let g=l;g<u;g++)for(let m=c;m<h;m++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,m,p),p.overlapsRay(o)){if(e.getConvexTrianglePillar(g,m,!1),ji.pointToWorldFrame(i,t,e.pillarOffset,lx),this._intersectConvex(e.pillarConvex,t,lx,r,s,W8),this.result.shouldStop)return;e.getConvexTrianglePillar(g,m,!0),ji.pointToWorldFrame(i,t,e.pillarOffset,lx),this._intersectConvex(e.pillarConvex,t,lx,r,s,W8)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=br(a.x-o.x,2)+br(a.y-o.y,2)+br(a.z-o.z,2),u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),h=br(o.x-i.x,2)+br(o.y-i.y,2)+br(o.z-i.z,2)-br(l,2),p=br(u,2)-4*c*h,g=$_e,m=W_e;if(!(p<0))if(0===p)o.lerp(a,p,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1);else{const w=(-u-Math.sqrt(p))/(2*c),C=(-u+Math.sqrt(p))/(2*c);if(w>=0&&w<=1&&(o.lerp(a,w,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1)),this.result.shouldStop)return;C>=0&&C<=1&&(o.lerp(a,C,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=q_e,l=q8,c=o&&o.faceList||null,u=e.faces,h=e.vertices,p=e.faceNormals,g=this.direction,m=this.from,C=m.distanceTo(this.to),H=c?c.length:u.length,U=this.result;for(let de=0;!U.shouldStop&&de<H;de++){const Ce=c?c[de]:de,Pe=u[Ce],Be=p[Ce],et=t,wt=i;l.copy(h[Pe[0]]),et.vmult(l,l),l.vadd(wt,l),l.vsub(m,l),et.vmult(Be,a);const vt=g.dot(a);if(Math.abs(vt)<this.precision)continue;const xt=a.dot(l)/vt;if(!(xt<0)){g.scale(xt,ha),ha.vadd(m,ha),uc.copy(h[Pe[0]]),et.vmult(uc,uc),wt.vadd(uc,uc);for(let Ft=1;!U.shouldStop&&Ft<Pe.length-1;Ft++){Zc.copy(h[Pe[Ft]]),Jc.copy(h[Pe[Ft+1]]),et.vmult(Zc,Zc),et.vmult(Jc,Jc),wt.vadd(Zc,Zc),wt.vadd(Jc,Jc);const zt=ha.distanceTo(m);!ps.pointInTriangle(ha,uc,Zc,Jc)&&!ps.pointInTriangle(ha,Zc,uc,Jc)||zt>C||this.reportIntersection(a,ha,s,r,Ce)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=Y_e,l=eye,c=tye,u=q8,h=K_e,p=X_e,g=Q_e,m=J_e,w=Z_e,C=e.indices,H=this.from,U=this.to,de=this.direction;c.position.copy(i),c.quaternion.copy(t),ji.vectorToLocalFrame(i,t,de,h),ji.pointToLocalFrame(i,t,H,p),ji.pointToLocalFrame(i,t,U,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,p.x*=e.scale.x,p.y*=e.scale.y,p.z*=e.scale.z,g.vsub(p,h),h.normalize();const Ce=p.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let Pe=0,Be=l.length;!this.result.shouldStop&&Pe!==Be;Pe++){const et=l[Pe];e.getNormal(et,a),e.getVertex(C[3*et],uc),uc.vsub(p,u);const wt=h.dot(a),vt=a.dot(u)/wt;if(vt<0)continue;h.scale(vt,ha),ha.vadd(p,ha),e.getVertex(C[3*et+1],Zc),e.getVertex(C[3*et+2],Jc);const xt=ha.distanceSquared(p);!ps.pointInTriangle(ha,Zc,uc,Jc)&&!ps.pointInTriangle(ha,uc,Zc,Jc)||xt>Ce||(ji.vectorToWorldFrame(t,a,w),ji.pointToWorldFrame(i,t,ha,m),this.reportIntersection(w,m,s,r,et))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case ps.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case ps.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case ps.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,Rf),i.vsub(t,J0),e.vsub(t,WR);const s=Rf.dot(Rf),o=Rf.dot(J0),a=Rf.dot(WR),l=J0.dot(J0),c=J0.dot(WR);let u,h;return(u=l*a-o*c)>=0&&(h=s*c-o*a)>=0&&u+h<s*l-o*o}}ps.CLOSEST=1,ps.ANY=2,ps.ALL=4;const $8=new dr,$R=[],J0=new le,WR=new le,U_e=new le,z_e=new os,ha=new le,uc=new le,Zc=new le,Jc=new le,W8={faceList:[0]},lx=new le,H_e=new ps,G_e=[],$_e=new le,W_e=new le,q_e=new le,q8=new le,Y_e=new le,K_e=new le,X_e=new le,Q_e=new le,Z_e=new le,J_e=new le;new dr;const eye=[],tye=new ji,Rf=new le,cx=new le;let l5,c5,u5,d5,h5,f5,p5,g5,m5,_5,y5,b5,v5,w5,E5,S5,x5,C5,A5,T5,M5,D5,I5,O5,R5;new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new ps,new le,new le,new le(1,0,0),new le(0,1,0),new le(0,0,1),new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new dr,new le,new dr,new le,new le,new le,new le,new le,new le,new le,new dr,new le,new ji,new dr;const Mr={sphereSphere:dn.types.SPHERE,spherePlane:dn.types.SPHERE|dn.types.PLANE,boxBox:dn.types.BOX|dn.types.BOX,sphereBox:dn.types.SPHERE|dn.types.BOX,planeBox:dn.types.PLANE|dn.types.BOX,convexConvex:dn.types.CONVEXPOLYHEDRON,sphereConvex:dn.types.SPHERE|dn.types.CONVEXPOLYHEDRON,planeConvex:dn.types.PLANE|dn.types.CONVEXPOLYHEDRON,boxConvex:dn.types.BOX|dn.types.CONVEXPOLYHEDRON,sphereHeightfield:dn.types.SPHERE|dn.types.HEIGHTFIELD,boxHeightfield:dn.types.BOX|dn.types.HEIGHTFIELD,convexHeightfield:dn.types.CONVEXPOLYHEDRON|dn.types.HEIGHTFIELD,sphereParticle:dn.types.PARTICLE|dn.types.SPHERE,planeParticle:dn.types.PLANE|dn.types.PARTICLE,boxParticle:dn.types.BOX|dn.types.PARTICLE,convexParticle:dn.types.PARTICLE|dn.types.CONVEXPOLYHEDRON,cylinderCylinder:dn.types.CYLINDER,sphereCylinder:dn.types.SPHERE|dn.types.CYLINDER,planeCylinder:dn.types.PLANE|dn.types.CYLINDER,boxCylinder:dn.types.BOX|dn.types.CYLINDER,convexCylinder:dn.types.CONVEXPOLYHEDRON|dn.types.CYLINDER,heightfieldCylinder:dn.types.HEIGHTFIELD|dn.types.CYLINDER,particleCylinder:dn.types.PARTICLE|dn.types.CYLINDER,sphereTrimesh:dn.types.SPHERE|dn.types.TRIMESH,planeTrimesh:dn.types.PLANE|dn.types.TRIMESH};l5=Mr.sphereSphere,c5=Mr.spherePlane,u5=Mr.boxBox,d5=Mr.sphereBox,h5=Mr.planeBox,f5=Mr.convexConvex,p5=Mr.sphereConvex,g5=Mr.planeConvex,m5=Mr.boxConvex,_5=Mr.sphereHeightfield,y5=Mr.boxHeightfield,b5=Mr.convexHeightfield,v5=Mr.sphereParticle,w5=Mr.planeParticle,E5=Mr.boxParticle,S5=Mr.convexParticle,x5=Mr.cylinderCylinder,C5=Mr.sphereCylinder,A5=Mr.planeCylinder,T5=Mr.boxCylinder,M5=Mr.convexCylinder,D5=Mr.heightfieldCylinder,I5=Mr.particleCylinder,O5=Mr.sphereTrimesh,R5=Mr.planeTrimesh,new le,new le,new le,new le,new le,new os,new os,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new dr,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new os,new le,new le,new le,new le,new le,new le,new le,new le,new dr,new ps;const qs=globalThis.performance||{};if(!qs.now){let n=Date.now();qs.timing&&qs.timing.navigationStart&&(n=qs.timing.navigationStart),qs.now=()=>Date.now()-n}var Lf=Je(517);class Nr extends oe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new $;return this._value}next(e){super.next(this._value=e)}}function sm(n,e,t){e||(e=new $n($n.IDENTITY));const i=new $n($n.IDENTITY);if(!n)return!0;if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new $n($n.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new $n(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===sm(s,r,t))return!1;return!0}function B5(){dz([c8,tm])}function j5(n,e){var t;const i=null===(t=e.nodes)||void 0===t?void 0:t.find(r=>r.name===n);if(i){let r=!1;for(const s of e.scenes)r||sm(s,new $n($n.IDENTITY),(o,a)=>o!==i||(o.matrix=a,o.translation=void 0,o.rotation=void 0,o.scale=void 0,r=!0,!1));return e.scene={id:n,name:n,nodes:[i]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function KR(n,e){return Di(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield LS(i,tm,{DracoLoader:vR,gltf:{decompressMeshes:!0,postProcess:!0}});return r.nodes||console.log("WARNING: Empty Scene",t,r),j5(n.scenegraphNode,r)})}function nve(n,e){return Di(this,void 0,void 0,function*(){return j5(n,yield e)})}function XR(n,e,t){if(e&&0!==e.length){let i;switch(t.geometry){case"sphere":i=new t_e;break;case"cone":i=new s_e;break;case"cylinder":i=new o_e;break;case"cube":default:i=new h_e}return new Bpe(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Fi.CARTESIAN,data:e,mesh:i,wireframe:!1,getTransformMatrix:r=>r.transformMatrix,getColor:r=>r.color||[255,255,255,229.5]},t))}}function V5(n,e,t){if(e&&0!==e.length)return new Mpe(Object.assign({id:n,pickable:!0,data:e.map(i=>Object.assign(Object.assign({},i),{position:new $n(i.transformMatrix).getTranslation()})),getText:i=>i.text,getPosition:i=>i.position,getColor:i=>i.color},t))}let rve=(()=>{class n extends _z{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),B5()}renderLayers(){var t,i;const r=this.state,s={sphere:[],cone:[],cylinder:[],cube:[],text:[],wireframe:[],scenegraph:[]};for(const l of r.data){const c=null!==(t=l.geometry)&&void 0!==t?t:"cube";l.scenegraph?s.scenegraph.push(l):void 0!==s[c]&&s[c].push(l)}const o={};for(const l of s.scenegraph)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(o,l.scenegraph)&&(o[l.scenegraph]=KR({scenegraph:l.scenegraph},n.gltfCache));const a=[];for(const[l,c]of Object.entries(s))if("scenegraph"===l)for(const u of c)a.push(new e_e({id:"models-"+u["@id"],opacity:u.zoomBasedOpacity?r.zoomOpacity:void 0!==u.opacity?u.opacity:1,pickable:!u.unpickable,coordinateSystem:Fi.CARTESIAN,data:[u],scenegraph:u.scenegraphNode?nve(u.scenegraphNode,o[u.scenegraph]):u.scenegraph,_lighting:u._lighting,getTransformMatrix:u.transformMatrix,getColor:null!==(i=u.color)&&void 0!==i?i:[0,255,0,127.5],parameters:{depthMask:!u.zoomBasedOpacity&&(void 0===u.opacity||1===u.opacity)}}));else"text"===l?(a.push(V5("text",c.filter(u=>u.unpickable),{pickable:!1})),a.push(V5("textPickable",c.filter(u=>!u.unpickable),{pickable:!0}))):"wireframe"===l?a.push(XR(l,c,{wireframe:!0,pickable:!1,geometry:l})):(a.push(XR(l,c.filter(u=>u.unpickable),{wireframe:!1,pickable:!1,geometry:l})),a.push(XR(`${l}Pickable`,c.filter(u=>!u.unpickable),{wireframe:!1,pickable:!0,geometry:l})));return r.doCollisions&&function(n){Di(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&"wireframe"!==o.geometry).map(o=>{const a=new $n(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new dr({lowerBound:new le(...l.map((u,h)=>Math.min(u,c[h]))),upperBound:new le(...c.map((u,h)=>Math.max(u,l[h])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield j0(o.scenegraph,tm,{DracoLoader:vR,decompress:!0,postProcess:!0});for(const l of a.scenes)sm(l,new $n(o.transformMatrix),(c,u)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const h of c.mesh.primitives)if(h.attributes.POSITION&&h.attributes.POSITION.min){const p=u.transformAsPoint(h.attributes.POSITION.min,[]),g=u.transformAsPoint(h.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new dr({lowerBound:new le(...p.map((m,w)=>Math.min(m,g[w]))),upperBound:new le(...g.map((m,w)=>Math.max(m,p[w])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(r.data),a.filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function U5(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),U5(t,e);return e}let ove=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new rve({}),this.nodeClickSubject=new oe,this.nodeHoverStartSubject=new oe,this.nodeHoverStopSubject=new oe,this.sceneRotationSubject=new Nr([0,0]),this.nodeDragStartSubject=new oe,this.nodeDragSubject=new oe,this.nodeDragEndSubject=new oe,this.nodeClick$=this.nodeClickSubject.pipe(_s()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(_s()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(_s()),this.sceneRotation$=this.sceneRotationSubject.pipe(_s()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(_s()),this.nodeDrag$=this.nodeDragSubject.pipe(_s()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(_s());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new ude({flipY:!1,near:-1e3}):new fde({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var u;return null!==(u=this.cursor)&&void 0!==u?u:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new FO({ambientLight:new Ez({color:[255,255,255],intensity:10})})]),this.deck=new qS(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return Di(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new $n([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t){return Di(this,void 0,void 0,function*(){B5();const i=yield KR({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},s=[];for(const o of i.scenes)sm(o,e=new $n(e||$n.IDENTITY),(a,l)=>{const c={"@id":a.name||a.id,"@type":"ProcessedNode",transformMatrix:new $n(l),geometry:"wireframe",node:a};if(s.push({"@id":`GLTF:${c["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:c["@id"],transformMatrix:new $n(e||$n.IDENTITY),tooltip:a.name||a.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:a}),a.mesh&&a.mesh.primitives&&a.mesh.primitives.length>0)for(const u of a.mesh.primitives)if(u.attributes.POSITION&&u.attributes.POSITION.min){const h=l.transformAsPoint(u.attributes.POSITION.min,[]),p=l.transformAsPoint(u.attributes.POSITION.max,[]);c.bbox=new dr({lowerBound:new le(...h.map((g,m)=>Math.min(g,p[m]))),upperBound:new le(...p.map((g,m)=>Math.max(g,h[m])))})}return r[c["@id"]]=c,!0});for(const o of Object.values(r).filter(a=>!a.bbox)){for(const a of U5(o.node).map(l=>r[l]).filter(l=>l.bbox))o.bbox?o.bbox.extend(a.bbox):o.bbox=a.bbox.clone();o.bbox||delete r[o["@id"]]}for(const o of Object.values(r)){const a=o.bbox.lowerBound,u=(o.size=o.bbox.upperBound.clone().vsub(a)).clone().vmul(new le(.5,.5,.5)),h=o.center=a.clone().vadd(u);o.transformMatrix=new $n($n.IDENTITY).translate(h.toArray()).scale(u.toArray())}for(const o of s)r[o["@id"]]=o;return r})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new $n(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return Pa([Lf.ZP],n.prototype,"_onHover",null),Pa([Lf.ZP],n.prototype,"_onClick",null),Pa([Lf.ZP],n.prototype,"_onViewStateChange",null),Pa([Lf.ZP],n.prototype,"_onDragStart",null),Pa([Lf.ZP],n.prototype,"_onDrag",null),Pa([Lf.ZP],n.prototype,"_onDragEnd",null),n})();function ave(n,e){return n===e}function lve(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function z5(n,e=ave){let t=null,i=null;function r(){return lve(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const uve=z5(function(){const n=tD();if(!n)return!1;const e=n.injector.get(P3,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let QR=(()=>{class n{constructor(){this.bootstrap$=new Tg(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const ZR=new Ht("INITIAL_STATE_TOKEN");let dve=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const H5=new Ht("Internals.StateContextFactory"),G5=new Ht("Internals.StateFactory");function sb(...n){if(1===n.length){const e=n[0];if(P(e))return mx(e,null);if(Q(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return mx(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return mx(n=1===n.length&&P(n[0])?n[0]:n,null).pipe(ge(t=>e(...t)))}return mx(n,null)}function mx(n,e){return new I(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=je(n[a]);let c=!1;t.add(l.subscribe({next:u=>{c||(c=!0,o++),r[a]=u},error:u=>t.error(u),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((u,h,p)=>(u[h]=r[p],u),{}):r),t.complete())}}))}})}function qi(n,e){return function(i){return i.lift(new hve(n,e))}}class hve{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new fve(e,this.predicate,this.thisArg))}}class fve extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function Ua(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(u){let h;s++,!r||a?(a=!1,r=new Tg(n,e,i),h=r.subscribe(this),o=u.subscribe({next(p){r.next(p)},error(p){a=!0,r.error(p)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):h=r.subscribe(this),this.add(()=>{s--,h.unsubscribe(),h=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}const $5=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function zi(n){return e=>0===n?ZE():e.lift(new gve(n))}class gve{constructor(e){if(this.total=e,this.total<0)throw new $5}call(e,t){return t.subscribe(new mve(e,this.total))}}class mve extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function W5(n,e){return e?t=>t.pipe(W5((i,r)=>je(n(i,r)).pipe(ge((s,o)=>e(i,s,r,o))))):t=>t.lift(new _ve(n))}class _ve{constructor(e){this.project=e}call(e,t){return t.subscribe(new yve(e,this.project))}}class yve extends ve{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new _t(this),i=this.destination;i.add(t);const r=N(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function _x(n=null){return e=>e.lift(new bve(n))}class bve{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new vve(e,this.defaultValue))}}class vve extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function dc(n){return function(t){const i=new wve(n),r=t.lift(i);return i.caught=r}}class wve{constructor(e){this.selector=e}call(e,t){return t.subscribe(new Eve(e,this.selector,this.caught))}}class Eve extends ve{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new _t(this);this.add(i);const r=N(t,i);r!==i&&this.add(r)}}}function as(n){return e=>e.lift(new Sve(n))}class Sve{constructor(e){this.notifier=e}call(e,t){const i=new xve(e),r=N(this.notifier,new _t(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class xve extends ve{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function uh(){}function Jr(n,e,t){return function(r){return r.lift(new Cve(n,e,t))}}class Cve{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new Ave(e,this.nextOrObserver,this.error,this.complete))}}class Ave extends y{constructor(e,t,i,r){super(e),this._tapNext=uh,this._tapError=uh,this._tapComplete=uh,this._tapError=i||uh,this._tapComplete=r||uh,Y(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||uh,this._tapError=t.error||uh,this._tapComplete=t.complete||uh)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function Ku(n,e){return t=>t.lift(new Tve(n,e))}class Tve{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new Mve(e,this.compare,this.keySelector))}}class Mve extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const za={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let q5=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return mn.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return mn.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof mn||console.warn(za.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(Oe(mn),Oe(kc))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Y5=new Ht("ROOT_STATE_TOKEN"),K5=new Ht("FEATURE_STATE_TOKEN"),X5=new Ht("NGXS_PLUGINS"),Q5=new Ht("NG_TEST_MODE"),Z5=new Ht("NG_DEV_MODE"),Xu="NGXS_META",J5="NGXS_OPTIONS_META";let kf=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=q5}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Dve{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const eH=new Ht("NGXS_EXECUTION_STRATEGY");function Bf(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const tH=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},yx=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),eN=n=>n&&"object"==typeof n&&!Array.isArray(n),tN=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(eN(n)&&eN(t))for(const i in t)eN(t[i])?(n[i]||Object.assign(n,{[i]:{}}),tN(n[i],t[i])):Object.assign(n,{[i]:t[i]});return tN(n,...e)};function ob(n){return n[Xu]}function iH(n,e){const t=yx(e.currentAppState,n.path),i=yx(e.newAppState,n.path);return new Dve(t,i,!n.isInitialised)}function kve(...n){return function(n,e,t=Vve){const i=function(n){return n.reduce((e,t)=>(e[Bf(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return qi(t=>{const i=Bf(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function Vve(){return ge(n=>n.action)}function bx(n){return e=>new I(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let vx=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(eH))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Hve extends oe{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let wx=(()=>{class n extends Hve{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=or(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Gve=(()=>{class n extends I{constructor(t,i){super(r=>{const s=t.pipe(bx(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(Oe(wx),Oe(vx))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const rH=n=>(...e)=>n.shift()(...e,(...i)=>rH(n)(...i));let Ex=(()=>{class n extends Nr{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),sN=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(Oe(n,12),Oe(X5,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),oN=(()=>{class n extends oe{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=or(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),sH=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(ta),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(bx(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?an(this._stateStream.getValue()):sb(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!Bf(t))return Ag(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return rH([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(Ua())}getActionResultStream(t){return this._actionResults.pipe(qi(i=>i.action===t&&"DISPATCHED"!==i.status),zi(1),Ua())}createDispatchObservable(t){return t.pipe(W5(i=>{switch(i.status){case"SUCCESSFUL":return an(this._stateStream.getValue());case"ERRORED":return Ag(i.error);default:return jc}})).pipe(Ua())}}return n.\u0275fac=function(t){return new(t||n)(Oe(Gn),Oe(wx),Oe(oN),Oe(sN),Oe(Ex),Oe(vx))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const oH=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&oH(n[i])}),n};let aH=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(Oe(Z5),Oe(Q5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),lH=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(za.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(za.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(Oe(aH),Oe(kf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),am=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=oH(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(Oe(Ex),Oe(sH),Oe(kf),Oe(lH))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Sx=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return yx(l,t.path)}function s(l,c){const u=tH(l,t.path,c),h=t.instance;if(h.ngxsOnChanges){const p=iH(t,{currentAppState:l,newAppState:u});h.ngxsOnChanges(p)}return i.setState(u),u}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error(za.PATCHING_ARRAY());if("object"!=typeof n)throw new Error(za.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(Oe(am))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class xx{static stateNameErrorMessage(e){return za.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(za.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error(za.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=ob(e);if(!t)throw new Error(za.STATE_DECORATOR());return t}}xx.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let lm=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=z5(()=>{const c=this;function u(p){const g=c.statePaths[p];return g?function(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(p){let g=u(p);return g||((...m)=>(g||(g=u(p)),g?g(...m):void 0))},getSelectorOptions:p=>Object.assign({},c._config.selectorOptions,p||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach(xx.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[Xu].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[Xu];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[Xu].name]=t,e),{})}(i),l=[];for(const c of s){const u=a[c],h=o[c],p=u[Xu];this.addRuntimeInfoToMeta(p,h);const g={name:c,path:h,isInitialised:!1,actions:p.actions,instance:this._injector.get(u),defaults:n.cloneDefaults(p.defaults)};this.hasBeenMountedAndBootstrapped(c,h)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>tH(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(qi(t=>"DISPATCHED"===t.status),B(({action:t})=>this.invokeActions(this._actions,t).pipe(ge(()=>({action:t,status:"SUCCESSFUL"})),_x({action:t,status:"CANCELED"}),dc(i=>an({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=Bf(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let u=o.instance[l.fn](c,i);u instanceof Promise&&(u=je(u)),u instanceof I?(u=u.pipe(_x({})),l.options.cancelUncompleted&&(u=u.pipe(as(t.pipe(kve(i)))))):u=an({}).pipe(Ua()),s.push(u)}catch(u){s.push(Ag(u))}}}return s.length||s.push(an({})),sb(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=xx.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==yx(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(Oe(Gn),Oe(kf),Oe(n,12),Oe(wx),Oe(oN),Oe(Sx),Oe(ZR,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),aN=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(qi(()=>!!i),Jr(()=>this.invokeInit(i.states)),B(()=>this.bootstrapper.appBootstrapped$),qi(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=iH(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(am),Oe(Sx),Oe(QR))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();let dh=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(ge(i),dc(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?an(void 0):Ag(r)}),Ku(),bx(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(zi(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(bx(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return function(n){const e=function(n){return n.NGXS_SELECTOR_META}(n)||ob(n);return e&&e.makeRootSelector||(()=>n)}(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(Oe(Ex),Oe(am),Oe(kf),Oe(vx),Oe(lm),Oe(ZR,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),ab=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(Oe(dh),Oe(kf))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class Qve{static get type(){return"@@INIT"}}class Zve{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const Ax=new Tg(1);let RN,ewe=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&Na();Ax.next(t)}catch(n){Ax.next(!1)}finally{Ax.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new Qve,l)}}return n.\u0275fac=function(t){return new(t||n)(Oe(lm),Oe(am),Oe(dh),Oe(ab),Oe(Y5,8),Oe(aN))},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({}),n})(),twe=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new Zve(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(Oe(dh),Oe(am),Oe(lm),Oe(K5,8),Oe(aN))},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({}),n})();class fa{static forRoot(e=[],t={}){return{ngModule:ewe,providers:[lm,Sx,Gve,wx,QR,lH,aH,aN,sH,oN,am,vx,dh,Ex,ab,sN,...e,...fa.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:twe,providers:[lm,sN,...e,{provide:K5,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:Q5,useValue:uve},{provide:Z5,useValue:Na},{provide:eH,useClass:t.executionStrategy||q5},{provide:Y5,useValue:e},{provide:fa.ROOT_OPTIONS,useValue:t},{provide:kf,useFactory:fa.ngxsConfigFactory,deps:[fa.ROOT_OPTIONS]},{provide:vE,useFactory:fa.appBootstrapListenerFactory,multi:!0,deps:[QR]},{provide:ZR,useFactory:fa.getInitialState},{provide:H5,useExisting:Sx},{provide:G5,useExisting:lm}]}static ngxsConfigFactory(e){return tN(new kf,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return dve.pop()}}function iwe(n){return i=>{!function(n){Ax.subscribe(e=>{e&&(n.\u0275prov||console.warn(za.UNDECORATED_STATE_IN_IVY(n.name)))})}(i);const r=i,s=function(n){if(!n.hasOwnProperty(Xu)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,Xu,{value:e})}return ob(n)}(r),o=Object.getPrototypeOf(r),a=function(i){return Object.assign({},i[J5]||{},n)}(o);(function(i){const{meta:r,inheritedStateClass:s,optionsWithInheritance:o}=i,{children:a,defaults:l,name:c}=o,u="string"==typeof c?c:c&&c.getName()||null;xx.checkCorrectStateName(u),s.hasOwnProperty(Xu)&&(r.actions=Object.assign({},r.actions,(s[Xu]||{}).actions)),r.children=a,r.defaults=l,r.name=u})({meta:s,inheritedStateClass:o,optionsWithInheritance:a}),r[J5]=a}}fa.\u0275fac=function(e){return new(e||fa)},fa.\u0275mod=gn({type:fa}),fa.\u0275inj=Tt({}),fa.ROOT_OPTIONS=new Ht("ROOT_OPTIONS"),new nc(QE);try{RN="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){RN=!1}"undefined"!=typeof Element&&Element;function Y6(n){Promise.resolve(null).then(n)}class pm{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Y6(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function X6(){return"undefined"!=typeof window&&void 0!==window.document}function BN(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let zN=(n,e)=>!1,HN=(n,e)=>!1,J6=(n,e,t)=>[];const eG=BN();(eG||"undefined"!=typeof Element)&&(zN=X6()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),HN=(()=>{if(eG||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):HN}})(),J6=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let zf=null,tG=!1;function GN(n){zf||(zf=("undefined"!=typeof document?document.body:null)||{},tG=!!zf.style&&"WebkitAppearance"in zf.style);let e=!0;return zf.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in zf.style,!e&&tG&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in zf.style)),e}const $N=HN,WN=zN,qN=J6;let iG=(()=>{class n{validateStyleProperty(t){return GN(t)}matchesElement(t,i){return $N(t,i)}containsElement(t,i){return WN(t,i)}query(t,i,r){return qN(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new pm(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class $x{}$x.NOOP=new iG;function aG(n,e,t){return t?e+":"+t+";":""}function lG(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=aG(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=aG(0,nSe(t),n.style[t]));n.setAttribute("style",e)}function nu(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=ZN(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),BN()&&lG(n))}function Gf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=ZN(t);n.style[i]=""}),BN()&&lG(n))}const tSe=/-+([a-z0-9])/g;function ZN(n){return n.replace(tSe,(...e)=>e[1].toUpperCase())}function nSe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class _m{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=_m.initialStylesByElement.get(e);r||_m.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&nu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(nu(this._element,this._initialStyles),this._endStyles&&(nu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(_m.initialStylesByElement.delete(this._element),this._startStyles&&(Gf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Gf(this._element,this._endStyles),this._endStyles=null),nu(this._element,this._initialStyles),this._state=3)}}_m.initialStylesByElement=new WeakMap;let Wf;try{Wf="undefined"!=typeof Intl}catch(n){Wf=!1}new class extends nc{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends QE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let n1e=1;const i1e=Promise.resolve(),p1={};function s$(n){return n in p1&&(delete p1[n],!0)}const o$={setImmediate(n){const e=n1e++;return p1[e]=!0,i1e.then(()=>s$(e)&&n()),e},clearImmediate(n){s$(n)}};new class extends nc{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends QE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=o$.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(o$.clearImmediate(t),e.scheduled=void 0)}});function Sb(n){return!!n&&(n instanceof I||"function"==typeof n.lift&&"function"==typeof n.subscribe)}function m1(...n){return Rt(1)(an(...n))}function zo(...n){const e=n[n.length-1];return xe(e)?(n.pop(),t=>m1(n,t,e)):t=>m1(n,t)}function j$(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return t=>ge(function(n,e){return i=>{let r=i;for(let s=0;s<e;s++){const o=null!=r?r[n[s]]:void 0;if(void 0===o)return;r=o}return r}}(n,e))(t)}"undefined"!=typeof window&&window,Je(266);class V$ extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class ZCe extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function U$(n,e,t,i,r=new ZCe(n,t,i)){if(!r.closed)return e instanceof I?e.subscribe(r):Te(e)(r)}const z$={};function Ho(...n){let e,t;return xe(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&P(n[0])&&(n=n[0]),In(n,t).lift(new H$(e))}class H${constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new JCe(e,this.resultSelector))}}class JCe extends V${constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(z$),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(U$(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===z$?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function Mb(n){return!0===n}function Wa(n){return null==n}function qa(n){return!Wa(n)}function jP(n){return Boolean(n)}function L7(n){return Wa(n)?n:JSON.parse(JSON.stringify(n))}Je(478),Object.create(Error.prototype),new Ht("SECURITY_CONTEXT");const N1=n=>{const t=n instanceof Date;if("object"!=typeof n||null===n||t)return n;Object.freeze(n);const r="function"==typeof n,s=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(o=>{s.call(n,o)&&(!r||"caller"!==o&&"callee"!==o&&"arguments"!==o)&&null!==n[o]&&("object"==typeof n[o]||"function"==typeof n[o])&&!Object.isFrozen(n[o])&&N1(n[o])}),n};function k7(n){return qa(n)&&"object"==typeof n&&function(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}const V7="NGXS_DATA_META",UP="NGXS_META",U7="NGXS_ARGUMENT_REGISTRY_META";let z7=(()=>{class n{constructor(t){this.sequence$=new Nr(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(Oe(dh,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function Db(n){return n[V7]}let Ya=(()=>{class n{constructor(t,i,r){n.store=t.get(dh),n.ngZone=t.get(mn),n.factory=i,n.context=r,n.computed=t.get(z7)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(Oe(Gn),Oe(G5),Oe(H5))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class cs{constructor(){cs.statesCachedMeta.clear()}static createStateContext(e){return Ya.context.createStateContext(e)}static ensureMappedState(e){if(Wa(Ya.factory)||Wa(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(qa(e.name)?cs.statesCachedMeta.get(e.name):null)||cs.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=Db(cs.getStateClassByInstance(e)))&&void 0!==t?t:null;if(Wa(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=cs.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);qa(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=cs.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=qa(e.name)?null===(t=Ya.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return qa(i)&&qa(e.name)&&cs.statesCachedMeta.set(e.name,i),i}}cs.statesCachedMeta=new Map,cs.\u0275fac=function(e){return new(e||cs)},cs.\u0275prov=We({token:cs,factory:cs.\u0275fac}),new Tg(1);class TMe extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${qa(null==e?void 0:e.constructor)?e.constructor.name:e} to PlainObject`)}}function H7(n){var e;return null!==(e=n.NGXS_OPTIONS_META)&&void 0!==e?e:{name:""}}function G7(n){var e;const t=H7(n),i=null!==(e=t.children)&&void 0!==e?e:[],s=L7(void 0===t.defaults?{}:t.defaults);if(i.length){if(k7(s))return function(n,e){return e.reduce((t,i)=>{const r=H7(i);if(function(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=G7(i),t},null!=n?n:{})}(s,i);throw new TMe(s)}return s}function W7(n){var e;return null!==(e=n.__NGXS_COMPUTED_OPTION__)&&void 0!==e?e:null}function q7(){var n,e;return null!==(e=null===(n=null==Ya?void 0:Ya.computed)||void 0===n?void 0:n.sequenceValue)&&void 0!==e?e:0}function OMe(n){let e=!1;return Sb(n)&&(e=!0),e}function zP(n){return n[U7]}class RMe extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class NMe{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){var t;return null!==(t=this.payloadMap.get(e))&&void 0!==t?t:null}getArgumentNameByIndex(e){var t;return null!==(t=this.argumentMap.get(e))&&void 0!==t?t:null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(jP(this.argumentMap.has(e))||jP(this.payloadMap.has(e)))throw new RMe(e,t)}}function jMe(n){return{enumerable:!0,configurable:!0,get(){const e=Db(n),t=cs.ensureMappedState(e.stateMeta);return cs.createStateContext(t)}}}function Y7(){return(n,e,t)=>{!function(n,e){if(!function(n,e){var t;let i=n,r=!1;if(k7(i))for(;null!==i;){if(Mb(null==i?void 0:i.hasOwnProperty(e))){r=!!(null===(t=Object.getOwnPropertyDescriptor(i,e))||void 0===t?void 0:t.get);break}i=Object.getPrototypeOf(i)}return r}(n,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function(n){return Wa(W7(n))&&Object.defineProperties(n,{__NGXS_COMPUTED_OPTION__:{enumerable:!0,configurable:!0,value:new WeakMap}}),W7(n)}(this),o=null==s?void 0:s.get(i);if(Mb(null==o?void 0:o.isObservable))return null==o?void 0:o.value;if(Wa(o)||o.sequenceId!==q7()){s.delete(i);const l=i.apply(this,r);return s.set(i,{value:l,sequenceId:q7(),isObservable:OMe(l)}),l}return o.value},t}}const $Me={cancelUncompleted:!0,insideZone:!1};function HP(n=$Me){return(e,t,i)=>{!function(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(e,i);const r=i.value,s=t.toString();return i.value=function(...o){const a=this;let l=null;const c=cs.getRepositoryByInstance(a),u=c.operations;let h=u[s];const p=c.stateMeta,g=zP(r);if(Wa(h)){const U=function(n){var e,t,i;return null!==(i=null===(t=null===(e=(n+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1))||void 0===e?void 0:e[0])||void 0===t?void 0:t.replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean))&&void 0!==i?i:[]}(r),de=function(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)qa(null==r?void 0:r.getArgumentNameByIndex(o))?s+=null==r?void 0:r.getArgumentNameByIndex(o):qa(null==r?void 0:r.getPayloadTypeByIndex(o))?s+=null==r?void 0:r.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replace(/\./g,"/")}.${i}(${s})`}({statePath:p.path,methodName:s,argumentsNames:U,argumentRegistry:g});h=u[s]={type:de,options:{cancelUncompleted:n.cancelUncompleted}},p.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}]}cs.ensureMappedState(p).instance[h.type]=()=>{var U;return Mb(n.insideZone)?null===(U=Ya.ngZone)||void 0===U||U.run(()=>{l=r.apply(a,o)}):l=r.apply(a,o),Sb(l)?an(null).pipe(ge(()=>l)):l};const C=cs.createAction(h,o,g),H=Ya.store.dispatch(C);return Sb(l)?function(n,e){return sb([n,e]).pipe(ge(t=>t.pop()))}(H,l):l},i}}function K7(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function(n,e){const t=n[e];return Wa(zP(t))&&Object.defineProperties(t,{[U7]:{enumerable:!0,configurable:!0,value:new NMe}}),zP(t)})(e,t).createPayloadType(r,t,i)}}function qMe(){return n=>{const e=function(n){if(function(n){return!jP(n)}(n.hasOwnProperty(UP))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,UP,{value:e})}return function(n){var e;return null===(e=n)||void 0===e?void 0:e[UP]}(n)}(n);if(Wa(e.name))throw new Error("@StateRepository should be add before decorator @State");!function(n,e){(function(n){var e;const t=null!==(e=Db(n))&&void 0!==e?e:null;return(Wa(t)||(null==t?void 0:t.stateClass)!==n)&&function(n){Object.defineProperty(n,V7,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),Db(n)}(n)).stateMeta=e}(n,e),function(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>L7(t)},context:jMe(n)})}(n,e,G7(n)),function(n){var e,t;const i=Db(n),r=null!==(t=null===(e=null==i?void 0:i.stateMeta)||void 0===e?void 0:e.name)&&void 0!==t?t:null;if(qa(r)){const s=`__${r}__selector`;Object.defineProperties(n.prototype,{[s]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(qa(this[s]))return this[s];if(Wa(Ya.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[s]=Ya.store.select(n).pipe(ge(o=>Na()?N1(o):o),Ua({refCount:!0,bufferSize:1})),this[s]}}})}}(n)}}let KMe=(()=>{class n{constructor(){this.browserStorageEvents$=new oe,this.isInitialised=!1,this.isBootstrapped=!1,this._dirty=!0}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){var r;this.dirty&&this.isBootstrapped&&(this.dirty=!1,null===(r=this.ngxsDataDoCheck)||void 0===r||r.call(this))}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){var i;this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,null===(i=this.ngxsDataDoCheck)||void 0===i||i.call(this))}markAsDirtyAfterReset(){var i;this.dirty=!0,null===(i=this.ngxsDataAfterReset)||void 0===i||i.call(this)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),XMe=(()=>{class n extends KMe{get snapshot(){return function(n){return Na()?N1(n):n}(this.getState())}get ctx(){return function(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},n),{getState:()=>Na()?N1(n.getState()):n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}})}(this.context)}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=or(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Pa([Y7(),ic("design:type",Object),ic("design:paramtypes",[])],n.prototype,"snapshot",null),Pa([HP(),nj(0,K7("patchValue")),ic("design:type",Function),ic("design:paramtypes",[Object]),ic("design:returntype",void 0)],n.prototype,"patchState",null),Pa([HP(),nj(0,K7("stateValue")),ic("design:type",Function),ic("design:paramtypes",[Object]),ic("design:returntype",void 0)],n.prototype,"setState",null),Pa([HP(),ic("design:type",Function),ic("design:paramtypes",[]),ic("design:returntype",void 0)],n.prototype,"reset",null),n})();new Ht("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})});const fF=new Ht("ngx-window",{providedIn:"root",factory:()=>function(n){return function(n){return n===BB}(n)?window:null}(Tc(kc))}),yOe=new Ht("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(Tc(fF))});new Ht("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(Tc(fF),Tc(yOe))}),new Ht("ngx-google-analytics-routing-settings",{factory:()=>({})}),new Ht("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"});const IOe=["bodyCanvas"];let OOe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new cn,this.nodeDrag=new cn,this.nodeClick=new cn,this.nodeHoverStart=new cn,this.nodeHoverStop=new cn,this.initialized=new cn,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return Di(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new ove({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))],this.initialized.emit()})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Sn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&Ds(IOe,5,Dn),2&t){let r;Ni(r=Pi())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&Mu(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&function(n,e,t,i){Xt(n,e,t,i),Qt()}(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),ROe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({imports:[[Ws]]}),n})();new Ht("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10}),[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004549"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7214"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7213"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:placenta",organ:"Placenta",name:"Placenta",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001987"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spinal-cord",organ:"Spinal Cord",name:"Spinal Cord",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002240"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name)).filter(n=>!0!==n.disabled);let jb=(()=>{let n=class extends XMe{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(qi(n=>null!=n),Ua(1))}setConfig(t){this.setState(t)}patchConfig(t){this.patchState(t)}getProperty(t){return this.config$.pipe(j$(...t),Ku(),Ua(1))}getOption(...t){const i=this.getPathKey(t);if(this.optionCache.has(i))return this.optionCache.get(i);const r=this.config$.pipe(j$(...t),Ku(),Ua(1));return this.optionCache.set(i,r),r}getPathKey(t){return`${t.length}:${t.join(".")}`}};return n.\u0275fac=function(){let e;return function(i){return(e||(e=or(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Pa([Y7()],n.prototype,"config$",null),n=Pa([qMe(),iwe({name:"globalConfig",defaults:null})],n),n})();!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}(),new oe;const c9="http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity",uRe=[173,255,47,229.5];var vn=Je(440),gRe=Je(698),mRe=Je(445),_Re=Je.n(mRe),hr=Je(815),Vb=Je(609);const Ai=vn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},vn.DataFactory),Im=(Ai("rdf"),Ai("rdf")("type"),{x:Ai("rdfs"),label:Ai("rdfs")("label"),comment:Ai("rdfs")("comment"),isDefinedBy:Ai("rdfs")("isDefinedBy"),seeAlso:Ai("rdfs")("seeAlso")}),ro_label=(Ai("entity"),Ai("entity")("id"),Im.label),ro_description=Im.comment,ro_link=Im.seeAlso,ro_providerName=(Ai("entity")("sex"),Ai("entity")("age"),Ai("entity")("bmi"),vn.DataFactory.literal("Male"),vn.DataFactory.literal("Female"),Ai("entity")("consortium_name"),Ai("entity")("provider_name")),ro_donor=(Ai("entity")("provider_uuid"),Ai("entity")("has_donor")),ro_sections=Ai("entity")("has_tissue_section"),ro_datasets=Ai("entity")("has_dataset"),ro_sampleType=Ai("entity")("sample_type"),ro_sectionCount=(vn.DataFactory.literal("Tissue Block"),vn.DataFactory.literal("Tissue Section"),vn.DataFactory.literal("Non-standard"),Ai("entity")("section_count")),ro_sectionSize=Ai("entity")("section_size"),ro_sectionUnits=Ai("entity")("section_units"),ro_sectionNumber=Ai("entity")("section_number"),ro_spatialEntity=Ai("entity")("has_spatial_entity"),ro_technology=(Ai("entity")("has_ontology_term"),Ai("entity")("has_cell_type_term"),Ai("entity")("technology")),ro_thumbnail=Ai("entity")("has_thumbnail"),xn=Ai("ccf"),od={x:xn,ontologyNode:{label:xn("ccf_preferred_label"),parent:xn("ccf_part_of"),children:xn("ccf_part_of"),rui_rank:xn("ccf_rui_rank"),synonymLabels:vn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:xn("ccf_part_of"),ct_is_a:xn("ct_is_a"),located_in:xn("located_in"),characterizes:xn("characterizes")},spatial:{Female:xn("VHFemale"),Male:xn("VHMale"),BothSexes:xn("VHBothSexes"),FemaleOrgans:xn("VHFemaleOrgans"),MaleOrgans:xn("VHMaleOrgans")},SpatialObjectReference:xn("SpatialObjectReference"),SpatialEntity:xn("SpatialEntity"),SpatialPlacement:xn("SpatialPlacement"),spatialObjectReference:{file:xn("has_object_file"),file_format:xn("has_object_file_format"),file_subpath:xn("has_object_file_subpath")},extractionSet:{label:Im.label,rui_rank:xn("ccf_rui_rank")},spatialEntity:{label:Im.label,comment:Im.comment,creator:Ai("dc")("creator"),creator_first_name:xn("creator_first_name"),creator_last_name:xn("creator_last_name"),creator_orcid:xn("creator_orcid"),creation_date:xn("creation_date"),updated_date:xn("updated_date"),ccf_annotations:xn("ccf_annotation"),representation_of:xn("ccf_representation_of"),reference_organ:xn("anatomical_structure_of"),extraction_set_for:xn("extraction_set_for"),extraction_set:xn("extraction_site_for"),sex:xn("has_sex"),side:xn("has_side"),rui_rank:xn("ccf_rui_rank"),slice_thickness:xn("ccf_slice_thickness"),slice_count:xn("ccf_slice_count"),x_dimension:xn("has_x_dimension"),y_dimension:xn("has_y_dimension"),z_dimension:xn("has_z_dimension"),dimension_units:xn("has_dimension_units"),object:xn("has_object_reference")},spatialPlacement:{source:xn("has_placement_source"),target:xn("has_placement_target"),placement_date:xn("has_placement_date"),x_scaling:xn("has_x_scaling"),y_scaling:xn("has_y_scaling"),z_scaling:xn("has_z_scaling"),scaling_units:xn("has_scaling_units"),x_rotation:xn("has_x_rotation"),y_rotation:xn("has_y_rotation"),z_rotation:xn("has_z_rotation"),w_rotation:xn("has_theta_rotation"),rotation_order:xn("has_rotation_order"),rotation_units:xn("has_rotation_units"),x_translation:xn("has_x_translation"),y_translation:xn("has_y_translation"),z_translation:xn("has_z_translation"),translation_units:xn("has_translation_units")}},si={x:Ai("uberon"),body:Ai("uberon")("0013702")},vRe={x:Ai("cl"),cell:Ai("cl")("0000000")},Ub={x:Ai("fma")},u9=(Ai("lmha"),{body:si.body,cell:vRe.cell,respiratory_system:si.x("0001004"),colon:si.x("0001155"),left_lung:si.x("0002168"),right_lung:si.x("0002167"),left_bronchus:si.x("0002178"),right_bronchus:si.x("0002177"),kidney:si.x("0002113"),ureter:si.x("0000056"),eye:si.x("0000970"),fallopian_tube:si.x("0003889"),knee:si.x("0001465"),ovary:si.x("0000992"),trachea:si.x("0003126"),aorta:si.x("0000947"),blood:si.x("0000178"),bone_marrow:si.x("0002371"),male_reproductive_system:si.x("0000079"),lymph_node:si.x("0000029"),blood_vasculature:si.x("0004537"),brain:si.x("0000955"),eye_left:si.x("0004548"),eye_right:Ub.x("54449"),fallopian_tube_left:si.x("0001303"),fallopian_tube_right:si.x("0001302"),heart:si.x("0000948"),kidney_left:si.x("0004538"),kidney_right:si.x("0004539"),knee_left:Ub.x("24978"),knee_right:Ub.x("24977"),large_intestine:si.x("0000059"),liver:si.x("0002107"),lungs:si.x("0002048"),mesenteric_lymph_node:si.x("0002509"),ovary_left:Ub.x("7214"),ovary_right:Ub.x("7213"),pancreas:si.x("0001264"),pelvis:si.x("0001270"),prostate_gland:si.x("0002367"),skin:si.x("0002097"),small_intestine:si.x("0002108"),spleen:si.x("0002106"),thymus:si.x("0002370"),ureter_left:si.x("0001223"),ureter_right:si.x("0001222"),urinary_bladder:si.x("0001255"),uterus:si.x("0000995")});function mF(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}mF(od.spatialObjectReference),mF(od.spatialEntity),mF(od.spatialPlacement),new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]);const Nm=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),Dr=(Math,Math,{});function FRe(n,{precision:e=Dr.precision||4}={}){return n=function(n){return Math.round(n/Dr.EPSILON)*Dr.EPSILON}(n),"".concat(parseFloat(n.toPrecision(e)))}function wh(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Hb(n,e,t){const i=Dr.EPSILON;t&&(Dr.EPSILON=t);try{if(n===e)return!0;if(wh(n)&&wh(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!Hb(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Dr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Dr.EPSILON=i}}function pc(n,e){if(!n)throw new Error("math.gl assertion ".concat(e))}Dr.EPSILON=1e-12,Dr.debug=!1,Dr.precision=4,Dr.printTypes=!1,Dr.printDegrees=!1,Dr.printRowMajor=!0;class yF extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return pc(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:wh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Dr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+FRe(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Hb(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Dr.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function so(n){if(!Number.isFinite(n))throw new Error("Invalid number ".concat(n));return n}function g9(n,e,t=""){if(Dr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return n}const m9={};function bF(n,e){m9[n]||(m9[n]=!0,console.warn("".concat(n," has been removed in version ").concat(e,", see upgrade guide for more information")))}class HRe extends yF{get ELEMENTS(){return pc(!1),0}copy(e){return pc(!1),this}get x(){return this[0]}set x(e){this[0]=so(e)}get y(){return this[1]}set y(e){this[1]=so(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return so(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return so(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return pc(e>=0&&e<this.ELEMENTS,"index is out of range"),so(this[e])}setComponent(e,t){return pc(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const vF=[0,0,0],_9={};class Nn extends HRe{static get ZERO(){return _9.ZERO=_9.ZERO||Object.freeze(new Nn(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&wh(e)?this.copy(e):(Dr.debug&&(so(e),so(t),so(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Dr.debug&&(so(e.x),so(e.y),so(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=so(e)}angle(e){return aV(this,e)}cross(e){return w0(this,this,e),this.check()}rotateX({radians:e,origin:t=vF}){return rV(this,this,t,e),this.check()}rotateY({radians:e,origin:t=vF}){return sV(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=vF}){return oV(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return uI(this,this,e),this.check()}transformAsVector(e){return function(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o}(this,this,e),this.check()}transformByMatrix3(e){return uS(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return iV(this,this,e),this.check()}}new Nn,new Nn;const Gb=new Nn,v9=new Nn;class wF{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new Nn,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=Gb.from(t),this.center=(new Nn).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new wF(this.center,this.radius)}union(e){const t=this.center,i=this.radius,s=e.radius,o=Gb.copy(e.center).subtract(t),a=o.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const l=.5*(i+a+s);return v9.copy(o).scale((-i+l)/a).add(t),this.center.copy(v9),this.radius=l,this}expand(e){const t=(e=Gb.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=function(n,e){var s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(e[0],e[1],e[2]),n[1]=Math.hypot(s,o,a),n[2]=Math.hypot(l,c,u),n}(Gb,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=(e=Gb.from(e)).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const i=this.radius,s=e.normal.dot(this.center)+e.distance;return s<-i?Nm.OUTSIDE:s<i?Nm.INTERSECTING:Nm.INSIDE}}class YRe extends yF{get ELEMENTS(){return pc(!1),0}get RANK(){return pc(!1),0}toString(){let e="[";if(Dr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=so(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}const w9=Object.freeze([1,0,0,0,1,0,0,0,1]),KRe=Object.freeze([0,0,0,0,0,0,0,0,0]),XRe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Pm={};class $o extends YRe{static get IDENTITY(){return Pm.IDENTITY=Pm.IDENTITY||Object.freeze(new $o(w9)),Pm.IDENTITY}static get ZERO(){return Pm.ZERO=Pm.ZERO||Object.freeze(new $o(KRe)),Pm.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return XRe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return V4(this)}identity(){return this.copy(w9)}fromQuaternion(e){return H4(this,e),this.check()}transpose(){return B4(this,this),this.check()}invert(){return j4(this,this),this.check()}multiplyLeft(e){return QS(this,e,this),this.check()}multiplyRight(e){return QS(this,this,e),this.check()}rotate(e){return z4(this,this,e),this.check()}scale(e){return Array.isArray(e)?ZS(this,this,e):ZS(this,this,[e,e,e]),this.check()}translate(e){return U4(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=yU(t||[-0,-0],e,this);break;case 3:t=uS(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return g9(t,e.length),t}transformVector(e,t){return bF("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return bF("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return bF("Matrix3.transformVector"),this.transform(e,t)}}const QRe=[0,0,0,1];class E9 extends yF{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return iR(this,e),this.check()}identity(){return $4(this),this.check()}fromAxisRotation(e,t){return nR(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=so(e)}get y(){return this[1]}set y(e){this[1]=so(e)}get z(){return this[2]}set z(e){this[2]=so(e)}get w(){return this[3]}set w(e){this[3]=so(e)}len(){return e8(this)}lengthSquared(){return t8(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return sR(this,e)}rotationTo(e,t){return i8(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return Z4(this,this,e),this.check()}calculateW(){return K4(this,this),this.check()}conjugate(){return Q4(this,this),this.check()}invert(){return X4(this,this),this.check()}lerp(e,t,i){return J4(this,e,t,i),this.check()}multiplyRight(e,t){return pc(!t),JS(this,this,e),this.check()}multiplyLeft(e,t){return pc(!t),JS(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return W4(this,this,e),this.check()}rotateY(e){return q4(this,this,e),this.check()}rotateZ(e){return Y4(this,this,e),this.check()}scale(e){return rR(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=QRe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return Y0(this,e,t,i),this.check()}transformVector4(e,t=e){return hU(t,e,this),g9(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const ZRe=new Nn,JRe=new Nn,eC=new Nn,tC=new Nn,nC=new Nn,eNe=new Nn,tNe=new Nn;class EF{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=(new Nn).from(e),this.halfAxes=new $o(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new Nn(e).len(),new Nn(t).len(),new Nn(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new Nn(e).normalize(),s=new Nn(t).normalize(),o=new Nn(i).normalize();return(new E9).fromMatrix3(new $o([...r,...s,...o]))}fromCenterHalfSizeQuaternion(e,t,i){const r=new E9(i),s=(new $o).fromQuaternion(r);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=(new Nn).from(e),this.halfAxes=s,this}clone(){return new EF(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new wF){const t=this.halfAxes,i=t.getColumn(0,eC),r=t.getColumn(1,tC),s=t.getColumn(2,nC),o=ZRe.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const t=this.center,i=e.normal,r=this.halfAxes,s=i.x,o=i.y,a=i.z,l=Math.abs(s*r[0]+o*r[1]+a*r[2])+Math.abs(s*r[3]+o*r[4]+a*r[5])+Math.abs(s*r[6]+o*r[7]+a*r[8]),c=i.dot(t)+e.distance;return c<=-l?Nm.OUTSIDE:c>=l?Nm.INSIDE:Nm.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=JRe.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,eC),s=i.getColumn(1,tC),o=i.getColumn(2,nC),a=r.magnitude(),l=s.magnitude(),c=o.magnitude();r.normalize(),s.normalize(),o.normalize();let h,u=0;return h=Math.abs(t.dot(r))-a,h>0&&(u+=h*h),h=Math.abs(t.dot(s))-l,h>0&&(u+=h*h),h=Math.abs(t.dot(o))-c,h>0&&(u+=h*h),u}computePlaneDistances(e,t,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,l=a.getColumn(0,eC),c=a.getColumn(1,tC),u=a.getColumn(2,nC),h=eNe.copy(l).add(c).add(u).add(o),p=tNe.copy(h).subtract(e);let g=t.dot(p);return r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).add(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),h.copy(o).add(l).subtract(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).add(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).add(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),o.copy(h).subtract(l).subtract(c).subtract(u),p.copy(h).subtract(e),g=t.dot(p),r=Math.min(g,r),s=Math.max(g,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,eC);t.transformAsPoint(e);const i=this.halfAxes.getColumn(1,tC);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,nC);return r.transformAsPoint(e),this.halfAxes=new $o([...t,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const S9=new Nn,x9=new Nn;class SF{constructor(e=[0,0,1],t=0){this.normal=new Nn,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return pc(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=S9.from(e),this.normal.from(t).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,t,i,r){return this.normal.set(e,t,i),pc(Hb(this.normal.len(),1)),this.distance=r,this}clone(e){return new SF(this.normal,this.distance)}equals(e){return Hb(this.distance,e.distance)&&Hb(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=x9.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,t)}projectPointOntoPlane(e,t=[0,0,0]){e=S9.from(e);const i=this.getPointDistance(e),r=x9.copy(this.normal).scale(i);return e.subtract(r).to(t)}}function $Ne(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[od.ontologyNode.label.id]:"label",[t]:"parent",[od.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of function*(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,vn.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,Vb.fromRdf)(s.object):s.object.id;yield[r,o]}}(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}new Nn([1,0,0]),new Nn([0,1,0]),new Nn([0,0,1]),new Nn,new Nn,new SF(new Nn(1,0,0),0),new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,new Nn,Math,new $o,new $o,new $o,new $o,new $o,new Nn,new Nn,new Nn,new Nn,new Nn,new $o,new $o,new $o,(0,hr.memoize)(function(n){const e=function(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,vn.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=$Ne(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,r}(n,u9.body.id,"body",od.asctb.part_of.id);return e.nodes[u9.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0001987","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0002240","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e},()=>"");const sC={[ro_label.id]:"label",[ro_description.id]:"description",[ro_link.id]:"link"};Object.assign(Object.assign({},sC),{[ro_providerName.id]:"providerName"}),Object.assign(Object.assign({},sC),{[ro_technology.id]:"technology",[ro_thumbnail.id]:"thumbnail"}),Object.assign(Object.assign({},sC),{[ro_sampleType.id]:"sampleType",[ro_sectionNumber.id]:"sectionNumber",[ro_datasets.id]:"datasets"}),Object.assign(Object.assign({},sC),{[ro_sampleType.id]:"sampleType",[ro_sectionCount.id]:"sectionCount",[ro_sectionSize.id]:"sectionSize",[ro_sectionUnits.id]:"sectionUnits",[ro_donor.id]:"donor",[ro_spatialEntity.id]:"spatialEntityId",[ro_sections.id]:"sections",[ro_datasets.id]:"datasets"});const R9={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};function au(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let IF;function gc(){return IF||(IF=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),au(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),IF}function N9(n,e=gc()){return e("readonly",t=>au(t.get(n)))}const oC="Unknown Euler angle order",Lm=.99999;class Ki extends cS{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return Ki.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(e){return Ki.RotationOrders[e]}get ELEMENTS(){return 4}constructor(e=0,t=0,i=0,r=Ki.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(e,t,i,r)}fromQuaternion(e){const[t,i,r,s]=e,o=i*i,a=-2*(o+r*r)+1,l=2*(t*i+s*r);let c=-2*(t*r-s*i);c=c>1?1:c,c=c<-1?-1:c;const p=Math.atan2(2*(i*r+s*t),-2*(t*t+o)+1),g=Math.asin(c),m=Math.atan2(l,a);return new Ki(p,g,m,Ki.RollPitchYaw)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=Number.isFinite(e[3])||this.order,this.check()}set(e=0,t=0,i=0,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return function(n){return n>=0&&n<6}(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}toArray4(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}toVector3(e=[-0,-0,-0]){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e}get x(){return this[0]}set x(e){this[0]=er(e)}get y(){return this[1]}set y(e){this[1]=er(e)}get z(){return this[2]}set z(e){this[2]=er(e)}get alpha(){return this[0]}set alpha(e){this[0]=er(e)}get beta(){return this[1]}set beta(e){this[1]=er(e)}get gamma(){return this[2]}set gamma(e){this[2]=er(e)}get phi(){return this[0]}set phi(e){this[0]=er(e)}get theta(){return this[1]}set theta(e){this[1]=er(e)}get psi(){return this[2]}set psi(e){this[2]=er(e)}get roll(){return this[0]}set roll(e){this[0]=er(e)}get pitch(){return this[1]}set pitch(e){this[1]=er(e)}get yaw(){return this[2]}set yaw(e){this[2]=er(e)}get order(){return this[3]}set order(e){this[3]=function(n){if(n<0&&n>=6)throw new Error(oC);return n}(e)}fromVector3(e,t){return this.set(e[0],e[1],e[2],Number.isFinite(t)?t:this[3])}fromArray(e,t=0){return this[0]=e[0+t],this[1]=e[1+t],this[2]=e[2+t],void 0!==e[3]&&(this[3]=e[3]),this.check()}fromRollPitchYaw(e,t,i){return this.set(e,t,i,Ki.ZYX)}fromRotationMatrix(e,t=Ki.DefaultOrder){return this._fromRotationMatrix(e,t),this.check()}getRotationMatrix(e){return this._getRotationMatrix(e)}getQuaternion(){const e=new oR;switch(this[4]){case Ki.XYZ:return e.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case Ki.YXZ:return e.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case Ki.ZXY:return e.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case Ki.ZYX:return e.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case Ki.YZX:return e.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case Ki.XZY:return e.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(oC)}}_fromRotationMatrix(e,t=Ki.DefaultOrder){const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],p=i[10];switch(t=t||this[3]){case Ki.XYZ:this[1]=Math.asin(La(o,-1,1)),Math.abs(o)<Lm?(this[0]=Math.atan2(-c,p),this[2]=Math.atan2(-s,r)):(this[0]=Math.atan2(h,l),this[2]=0);break;case Ki.YXZ:this[0]=Math.asin(-La(c,-1,1)),Math.abs(c)<Lm?(this[1]=Math.atan2(o,p),this[2]=Math.atan2(a,l)):(this[1]=Math.atan2(-u,r),this[2]=0);break;case Ki.ZXY:this[0]=Math.asin(La(h,-1,1)),Math.abs(h)<Lm?(this[1]=Math.atan2(-u,p),this[2]=Math.atan2(-s,l)):(this[1]=0,this[2]=Math.atan2(a,r));break;case Ki.ZYX:this[1]=Math.asin(-La(u,-1,1)),Math.abs(u)<Lm?(this[0]=Math.atan2(h,p),this[2]=Math.atan2(a,r)):(this[0]=0,this[2]=Math.atan2(-s,l));break;case Ki.YZX:this[2]=Math.asin(La(a,-1,1)),Math.abs(a)<Lm?(this[0]=Math.atan2(-c,l),this[1]=Math.atan2(-u,r)):(this[0]=0,this[1]=Math.atan2(o,p));break;case Ki.XZY:this[2]=Math.asin(-La(s,-1,1)),Math.abs(s)<Lm?(this[0]=Math.atan2(h,l),this[1]=Math.atan2(o,r)):(this[0]=Math.atan2(-c,p),this[1]=0);break;default:throw new Error(oC)}return this[3]=t,this}_getRotationMatrix(e){const t=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=this.x,r=this.y,s=this.z,o=Math.cos(i),a=Math.cos(r),l=Math.cos(s),c=Math.sin(i),u=Math.sin(r),h=Math.sin(s);switch(this[3]){case Ki.XYZ:{const p=o*l,g=o*h,m=c*l,w=c*h;t[0]=a*l,t[4]=-a*h,t[8]=u,t[1]=g+m*u,t[5]=p-w*u,t[9]=-c*a,t[2]=w-p*u,t[6]=m+g*u,t[10]=o*a;break}case Ki.YXZ:{const p=a*l,g=a*h,m=u*l,w=u*h;t[0]=p+w*c,t[4]=m*c-g,t[8]=o*u,t[1]=o*h,t[5]=o*l,t[9]=-c,t[2]=g*c-m,t[6]=w+p*c,t[10]=o*a;break}case Ki.ZXY:{const p=a*l,g=a*h,m=u*l,w=u*h;t[0]=p-w*c,t[4]=-o*h,t[8]=m+g*c,t[1]=g+m*c,t[5]=o*l,t[9]=w-p*c,t[2]=-o*u,t[6]=c,t[10]=o*a;break}case Ki.ZYX:{const p=o*l,g=o*h,m=c*l,w=c*h;t[0]=a*l,t[4]=m*u-g,t[8]=p*u+w,t[1]=a*h,t[5]=w*u+p,t[9]=g*u-m,t[2]=-u,t[6]=c*a,t[10]=o*a;break}case Ki.YZX:{const p=o*a,g=o*u,m=c*a,w=c*u;t[0]=a*l,t[4]=w-p*h,t[8]=m*h+g,t[1]=h,t[5]=o*l,t[9]=-c*l,t[2]=-u*l,t[6]=g*h+m,t[10]=p-w*h;break}case Ki.XZY:{const p=o*a,g=o*u,m=c*a,w=c*u;t[0]=a*l,t[4]=-h,t[8]=u*l,t[1]=p*h+w,t[5]=o*l,t[9]=g*h-m,t[2]=m*h-g,t[6]=c*l,t[10]=w*h+p;break}default:throw new Error(oC)}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}toQuaternion(){const e=Math.cos(.5*this.yaw),t=Math.sin(.5*this.yaw),i=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),s=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch);return new oR(e*r*s-t*i*o,e*i*o+t*r*s,t*i*s-e*r*o,e*i*s+t*r*o)}}const P9=Object.freeze([1,0,0,0,1,0,0,0,1]),oPe=Object.freeze([0,0,0,0,0,0,0,0,0]),aPe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),km={};class qb extends gU{static get IDENTITY(){return km.IDENTITY=km.IDENTITY||Object.freeze(new qb(P9)),km.IDENTITY}static get ZERO(){return km.ZERO=km.ZERO||Object.freeze(new qb(oPe)),km.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return aPe}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return V4(this)}identity(){return this.copy(P9)}fromQuaternion(e){return H4(this,e),this.check()}transpose(){return B4(this,this),this.check()}invert(){return j4(this,this),this.check()}multiplyLeft(e){return QS(this,e,this),this.check()}multiplyRight(e){return QS(this,this,e),this.check()}rotate(e){return z4(this,this,e),this.check()}scale(e){return Array.isArray(e)?ZS(this,this,e):ZS(this,this,[e,e,e]),this.check()}translate(e){return U4(this,this,e),this.check()}transform(e,t){switch(e.length){case 2:t=yU(t||[-0,-0],e,this);break;case 3:t=uS(t||[-0,-0,-0],e,this);break;case 4:t=function(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return v0(t,e.length),t}transformVector(e,t){return Pg("Matrix3.transformVector"),this.transform(e,t)}transformVector2(e,t){return Pg("Matrix3.transformVector"),this.transform(e,t)}transformVector3(e,t){return Pg("Matrix3.transformVector"),this.transform(e,t)}}var aC,lPe=new Uint8Array(16);function cPe(){if(!aC&&!(aC="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return aC(lPe)}const uPe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,hPe=function(n){return"string"==typeof n&&uPe.test(n)};for(var oo=[],RF=0;RF<256;++RF)oo.push((RF+256).toString(16).substr(1));const mPe=function(n,e,t){var i=(n=n||{}).random||(n.rng||cPe)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=i[r];return e}return function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(oo[n[e+0]]+oo[n[e+1]]+oo[n[e+2]]+oo[n[e+3]]+"-"+oo[n[e+4]]+oo[n[e+5]]+"-"+oo[n[e+6]]+oo[n[e+7]]+"-"+oo[n[e+8]]+oo[n[e+9]]+"-"+oo[n[e+10]]+oo[n[e+11]]+oo[n[e+12]]+oo[n[e+13]]+oo[n[e+14]]+oo[n[e+15]]).toLowerCase();if(!hPe(t))throw TypeError("Stringified UUID is invalid");return t}(i)};function*NF(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,vn.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,Vb.fromRdf)(s.object):s.object.id;yield[r,o]}}function tp(n,e,t,i){const r={"@id":e,"@type":t};for(const[s,o]of Object.entries(i))for(const a of(0,vn.readQuads)(n,r["@id"],s,null,null)){const l="Literal"===a.object.termType?(0,Vb.fromRdf)(a.object):a.object.id;r[o]=l}return r}const Ti=vn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},vn.DataFactory),F9={x:Ti("rdf"),type:Ti("rdf")("type")},Bm={x:Ti("rdfs"),label:Ti("rdfs")("label"),comment:Ti("rdfs")("comment"),isDefinedBy:Ti("rdfs")("isDefinedBy"),seeAlso:Ti("rdfs")("seeAlso")},pi={x:Ti("entity"),id:Ti("entity")("id"),label:Bm.label,description:Bm.comment,link:Bm.seeAlso,sex:Ti("entity")("sex"),age:Ti("entity")("age"),bmi:Ti("entity")("bmi"),Male:vn.DataFactory.literal("Male"),Female:vn.DataFactory.literal("Female"),consortiumName:Ti("entity")("consortium_name"),providerName:Ti("entity")("provider_name"),providerUUID:Ti("entity")("provider_uuid"),donor:Ti("entity")("has_donor"),sections:Ti("entity")("has_tissue_section"),datasets:Ti("entity")("has_dataset"),sampleType:Ti("entity")("sample_type"),TissueBlock:vn.DataFactory.literal("Tissue Block"),TissueSection:vn.DataFactory.literal("Tissue Section"),NonStandard:vn.DataFactory.literal("Non-standard"),sectionCount:Ti("entity")("section_count"),sectionSize:Ti("entity")("section_size"),sectionUnits:Ti("entity")("section_units"),sectionNumber:Ti("entity")("section_number"),spatialEntity:Ti("entity")("has_spatial_entity"),ontologyTerms:Ti("entity")("has_ontology_term"),cellTypeTerms:Ti("entity")("has_cell_type_term"),technology:Ti("entity")("technology"),thumbnail:Ti("entity")("has_thumbnail")},Cn=Ti("ccf"),Ii={x:Cn,ontologyNode:{label:Cn("ccf_preferred_label"),parent:Cn("ccf_part_of"),children:Cn("ccf_part_of"),rui_rank:Cn("ccf_rui_rank"),synonymLabels:vn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:Cn("ccf_part_of"),ct_is_a:Cn("ct_is_a"),located_in:Cn("located_in"),characterizes:Cn("characterizes")},spatial:{Female:Cn("VHFemale"),Male:Cn("VHMale"),BothSexes:Cn("VHBothSexes"),FemaleOrgans:Cn("VHFemaleOrgans"),MaleOrgans:Cn("VHMaleOrgans")},SpatialObjectReference:Cn("SpatialObjectReference"),SpatialEntity:Cn("SpatialEntity"),SpatialPlacement:Cn("SpatialPlacement"),spatialObjectReference:{file:Cn("has_object_file"),file_format:Cn("has_object_file_format"),file_subpath:Cn("has_object_file_subpath")},extractionSet:{label:Bm.label,rui_rank:Cn("ccf_rui_rank")},spatialEntity:{label:Bm.label,comment:Bm.comment,creator:Ti("dc")("creator"),creator_first_name:Cn("creator_first_name"),creator_last_name:Cn("creator_last_name"),creator_orcid:Cn("creator_orcid"),creation_date:Cn("creation_date"),updated_date:Cn("updated_date"),ccf_annotations:Cn("ccf_annotation"),representation_of:Cn("ccf_representation_of"),reference_organ:Cn("anatomical_structure_of"),extraction_set_for:Cn("extraction_set_for"),extraction_set:Cn("extraction_site_for"),sex:Cn("has_sex"),side:Cn("has_side"),rui_rank:Cn("ccf_rui_rank"),slice_thickness:Cn("ccf_slice_thickness"),slice_count:Cn("ccf_slice_count"),x_dimension:Cn("has_x_dimension"),y_dimension:Cn("has_y_dimension"),z_dimension:Cn("has_z_dimension"),dimension_units:Cn("has_dimension_units"),object:Cn("has_object_reference")},spatialPlacement:{source:Cn("has_placement_source"),target:Cn("has_placement_target"),placement_date:Cn("has_placement_date"),x_scaling:Cn("has_x_scaling"),y_scaling:Cn("has_y_scaling"),z_scaling:Cn("has_z_scaling"),scaling_units:Cn("has_scaling_units"),x_rotation:Cn("has_x_rotation"),y_rotation:Cn("has_y_rotation"),z_rotation:Cn("has_z_rotation"),w_rotation:Cn("has_theta_rotation"),rotation_order:Cn("has_rotation_order"),rotation_units:Cn("has_rotation_units"),x_translation:Cn("has_x_translation"),y_translation:Cn("has_y_translation"),z_translation:Cn("has_z_translation"),translation_units:Cn("has_translation_units")}},oi={x:Ti("uberon"),body:Ti("uberon")("0013702")},yPe={x:Ti("cl"),cell:Ti("cl")("0000000")},Yb={x:Ti("fma")},cd=(Ti("lmha"),{body:oi.body,cell:yPe.cell,respiratory_system:oi.x("0001004"),colon:oi.x("0001155"),left_lung:oi.x("0002168"),right_lung:oi.x("0002167"),left_bronchus:oi.x("0002178"),right_bronchus:oi.x("0002177"),kidney:oi.x("0002113"),ureter:oi.x("0000056"),eye:oi.x("0000970"),fallopian_tube:oi.x("0003889"),knee:oi.x("0001465"),ovary:oi.x("0000992"),trachea:oi.x("0003126"),aorta:oi.x("0000947"),blood:oi.x("0000178"),bone_marrow:oi.x("0002371"),male_reproductive_system:oi.x("0000079"),lymph_node:oi.x("0000029"),blood_vasculature:oi.x("0004537"),brain:oi.x("0000955"),eye_left:oi.x("0004548"),eye_right:Yb.x("54449"),fallopian_tube_left:oi.x("0001303"),fallopian_tube_right:oi.x("0001302"),heart:oi.x("0000948"),kidney_left:oi.x("0004538"),kidney_right:oi.x("0004539"),knee_left:Yb.x("24978"),knee_right:Yb.x("24977"),large_intestine:oi.x("0000059"),liver:oi.x("0002107"),lungs:oi.x("0002048"),mesenteric_lymph_node:oi.x("0002509"),ovary_left:Yb.x("7214"),ovary_right:Yb.x("7213"),pancreas:oi.x("0001264"),pelvis:oi.x("0001270"),prostate_gland:oi.x("0002367"),skin:oi.x("0002097"),small_intestine:oi.x("0002108"),spleen:oi.x("0002106"),thymus:oi.x("0002370"),ureter_left:oi.x("0001223"),ureter_right:oi.x("0001222"),urinary_bladder:oi.x("0001255"),uterus:oi.x("0000995")});function PF(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const lC={spatialObjectReference:PF(Ii.spatialObjectReference),spatialEntity:PF(Ii.spatialEntity),spatialPlacement:PF(Ii.spatialPlacement)};function L9(n,e){const t=tp(n,e,"ExtractionSet",lC.spatialEntity);return t.extractionSites=(0,hr.sortBy)(n.getSubjects(Ii.spatialEntity.extraction_set,e,null).map(i=>np(n,i.id)),["rui_rank"]),t}function np(n,e){const t=tp(n,e,"SpatialEntity",lC.spatialEntity);return t.object&&(t.object=function(n,e){return tp(n,e,"SpatialObjectReference",lC.spatialObjectReference)}(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,Ii.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,pi.spatialEntity,e,null),t}function SPe(n,e){const t=tp(n,e,"SpatialPlacement",lC.spatialPlacement);return t.source&&(t.source=np(n,t.source)),t.target&&(t.target=np(n,t.target)),t}function k9(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(Zj),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class B9{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new gRe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},F9.type,Ii.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},F9.type,Ii.SpatialEntity,null);const t={};for(const i of(0,vn.readQuads)(e,null,Ii.spatialPlacement.source,null,null))t[i.subject.id]=i.object.id;for(const i of(0,vn.readQuads)(e,null,Ii.spatialPlacement.target,null,null)){const r=t[i.subject.id];r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement")}}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new $n($n.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new $n($n.IDENTITY),s=_Re()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s)o&&k9(r,SPe(i,this.graph.getEdgeAttribute(a,o,"id"))),o=a;return r}}getSpatialPlacement(e,t){const i=this.graph.hasNode(e["@id"])?e["@id"]:void 0,r=(0,hr.get)(e,"placement[0]",(0,hr.get)(e,"placement",void 0));let s;if(r&&this.graph.hasNode(r.target)?(s=this.getTransformationMatrix(r.target,t),s&&(s=k9(s,r))):i&&(s=this.getTransformationMatrix(i,t)),s){const o=(new Ki).fromRotationMatrix(s,Ki.XYZ),a=s.getTranslation().map(u=>1e3*u),l=o.toVector3().map(Lre),c=s.getScale().map(u=>u<1&&u>.999999?1:u);return{"@context":"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld","@id":`http://purl.org/ccf/1.5/${mPe()}_placement`,"@type":"SpatialPlacement",source:e["@id"],target:t,placement_date:(new Date).toISOString().split("T")[0],x_scaling:c[0],y_scaling:c[1],z_scaling:c[2],scaling_units:"ratio",x_rotation:l[0],y_rotation:l[1],z_rotation:l[2],rotation_order:"XYZ",rotation_units:"degree",x_translation:a[0],y_translation:a[1],z_translation:a[2],translation_units:"millimeter"}}}}class j9{constructor(e){this.db=e}getSpatialEntity(e){return np(this.db.store,e)}getExtractionSets(e){return function(n,e){return(0,hr.sortBy)(n.getSubjects(Ii.spatialEntity.extraction_set_for,e,null).map(t=>L9(n,t.id)),["rui_rank"])}(this.db.store,e)}getExtractionSet(e){return L9(this.db.store,e)}getAnatomicalStructures(e){return function(n,e){return(0,hr.sortBy)(n.getSubjects(Ii.spatialEntity.reference_organ,e,null).map(t=>np(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])}(this.db.store,e)}getReferenceOrgans(){return function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(np(n,t.subject.id))},null,Ii.spatialEntity.reference_organ,null,null),(0,hr.sortBy)(e,["rui_rank"])}(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=Ii.spatial.Male.id;break;case"Female":t=Ii.spatial.Female.id;break;case"Both":default:t=Ii.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e),i=[];let r=[...this.getReferenceOrganSets(e).map(s=>{const o="http://purl.obolibrary.org/obo/UBERON_0002097"===s.representation_of,a=this.getSceneNode(s,t,{color:[255,255,255,255],opacity:o?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!o});return o&&a?void i.push(a):a})];return i.length>0&&(r=[...i,...r]),(null==e?void 0:e.debug)&&(r=r.concat([this.getSceneNode(this.getSpatialEntity(Ii.x("VHRightKidney").id),t,{color:[0,0,255,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Ii.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Ii.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Ii.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],geometry:"wireframe"}),this.getSceneNode(this.getSpatialEntity(Ii.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],geometry:"wireframe"})])),r.filter(s=>void 0!==s)}getReferenceOrganScene(e,t){var i,r;const s=void 0!==(null==t?void 0:t.sex)&&"both"!==(null===(i=null==t?void 0:t.sex)||void 0===i?void 0:i.toLowerCase()),o=this.getReferenceOrgans().filter(a=>a.representation_of===e&&(!s||a.sex===(null==t?void 0:t.sex)));if(o.length>0){const a=o[0],c=this.getSceneNode(a,a,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===a.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),u=(null!==(r=this.db.getSpatialEntities(t))&&void 0!==r?r:[]).map(h=>this.getSceneNode(h,a,{color:[255,255,255,229.5]}));return[c].concat(u).filter(h=>void 0!==h)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let u=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(u){if(l)u=new $n($n.IDENTITY).rotateX(Zj(90)).multiplyLeft(u);else{let h;switch(e.dimension_units){case"centimeter":h=.01;break;case"millimeter":h=.001;break;case"meter":default:h=1}const p=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*h/2);u.scale(p)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:u,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const cC="https://entity.api.hubmapconsortium.org/entities/",V9=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),CPe={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},jm={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford","5c106f29-ea2d-11e9-85e8-0efb3ba9a670":"RTI-General Electric","301615f9-c870-11eb-a8dc-35ce3d8786fe":"TMC-UConn"},U9={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},cellTypeTerms:{"@id":"has_cell_type_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class MPe{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],u=(this.data.ancestors||[]).find(Be=>"Donor"===Be.entity_type);this.donor=this.getDonor(u,i);const h=this.getRuiLocation(e,this.donor);h?this.rui_location=h:this.bad=!0,jm[e.group_uuid]||(jm[e.group_uuid]=e.group_name);const p=new Date(e.last_modified_timestamp).toLocaleDateString(),g=jm[e.group_uuid]||e.group_name,m=e.created_by_user_displayname;this["@id"]=cC+e.uuid,this.label=`Registered ${p}, ${m}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const w={},C=[];this.sections=C;const H=[];this.datasets=H;for(const Be of c.filter(et=>"Sample"===et.entity_type)){const et=this.getSection(Be,e,i);w[Be.submission_id]=et,C.push(et),et.section_number=null!==(s=et.section_number)&&void 0!==s?s:C.length}for(const Be of c)if("Dataset"===Be.entity_type){const et=this.getDataset(Be,t,i,r),wt=(0,hr.get)(Be,["ingest_metadata","metadata","tissue_id"]);w[wt]?null===(o=w[wt].datasets)||void 0===o||o.push(et):H.push(et)}const U=null!=h?h:{},de=`${U.x_dimension} x ${U.y_dimension} x ${U.z_dimension} ${U.dimension_units}`;this.section_count=U.slice_count||C.length;const Ce=parseFloat((U.slice_thickness||(U.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=Ce;const Pe=U.dimension_units||"millimeter";this.section_units=Pe,this.description=`${de}, ${Ce} ${Pe}, ${e.specimen_type}, ${this.section_count} Sections`,C.forEach((Be,et)=>{Be.description=`${U.x_dimension} x ${U.y_dimension} x ${Ce} ${Pe}, ${Ce} ${Pe}, ${Be.description}`,Be.section_number=et+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":cC+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${jm[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=jm[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,hr.get)(e,["ingest_metadata","metadata","assay_type"],"")],u=c.join("|").toLowerCase();let h,p="assets/icons/ico-unknown.svg";return-1!==u.indexOf("10x")?(h="10x",p="assets/icons/ico-bulk-10x.svg"):-1!==u.indexOf("af")?(h="AF",p="assets/icons/ico-spatial-af.svg"):-1!==u.indexOf("codex")?(h="CODEX",p="assets/icons/ico-spatial-codex.svg"):-1!==u.indexOf("imc")?(h="IMC",p="assets/icons/ico-spatial-imc.svg"):-1!==u.indexOf("lc")&&-1===u.indexOf("af")?(h="LC",p="assets/icons/ico-bulk-lc.svg"):h=-1!==u.indexOf("maldi")?"MALDI":-1!==u.indexOf("pas")?"PAS":"OTHER",p=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:p,{"@id":cC+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:h,thumbnail:p}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,hr.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>V9.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(V9.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=CPe[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,hr.toNumber)(s[1]));for(const p of(0,hr.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===p.preferred_term||"Female"===p.preferred_term?r="Female":"Masculine gender"===p.preferred_term||"Male"===p.preferred_term?r="Male":"Current chronological age"===p.preferred_term||"Age"===p.preferred_term?o=(0,hr.toNumber)(p.data_value):"Body mass index"===p.preferred_term&&(a=(0,hr.toNumber)(p.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),u=jm[e.group_uuid]||e.group_name;return{"@id":cC+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${u}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:u,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;let r,s=e.rui_location;if(s&&("string"==typeof s&&(s=JSON.parse(s)),s.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):s["@id"]&&(r=s)),r){const o=null!==(i=(0,hr.get)(r,["placement","target"]))&&void 0!==i?i:"";o.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")?(0,hr.set)(r,["placement","target"],o.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")):("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===o||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===o)&&(0,hr.set)(r,["placement","target"],"Male"===t.sex?o.replace("#VH","#VHM")+"_Patch":o.replace("#VH","#VHF")+"_Patch")}return r}getTissueBlock(){return(0,hr.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}const IPe=["uuid","entity_type","group_uuid","group_name","last_modified_timestamp","created_by_user_displayname","ancestors","descendants","rui_location","specimen_type"],OPe={exists:{field:"rui_location"}};function z9(n,e,t){return JSON.stringify({version:!0,from:n,size:e,stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:OPe,_source:{includes:IPe}})}function FF(n,e){return Di(this,void 0,void 0,function*(){try{const t=yield fetch(n,e);return t.ok?yield t.json():void 0}catch(t){return}})}function H9(n,e,t,i,r="",s=""){return Di(this,void 0,void 0,function*(){let o;if("static"===e?o=yield FF(n):"search-api"===e&&(o=yield function(n,e,t){return Di(this,void 0,void 0,function*(){const r=function(n){const e=new Headers;return e.append("Content-type","application/json"),n&&e.append("Authorization",`Bearer ${n}`),e}(e),s=z9(0,50,t),o=yield FF(n,{method:"POST",headers:r,body:s});if(!o)return;const a=o.hits.total.value;if(a<=50)return o;const l=[];for(let h=50;h<a;h+=50)l.push(FF(n,{method:"POST",headers:r,body:z9(h,50,t)}));const c=yield Promise.all(l);if(c.some(h=>!h))return;const u=c.map(h=>h.hits.hits);return Object.assign(Object.assign({},o),{hits:Object.assign(Object.assign({},o.hits),{hits:o.hits.hits.concat(...u)})})})}(n,i,t)),o)return function(n,e="",t="",i,r=!1){const o={},a=(0,hr.get)(n,"hits.hits",[]).map(c=>(0,hr.get)(c,"_source",{})).map(c=>new MPe(c,e,t,i).toJsonLd());for(const c of a){const u=c["@id"];o[u]?o[u].samples.push(c.samples[0]):o[u]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":U9},c)))),{"@context":U9,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function Kb(n,e,t){const i=new Set;for(const r of e)for(const s of(0,vn.readQuads)(n,r,t,null,null))i.add(s.object.id);return i}const kPe={[Ii.spatialEntity.x_dimension.id]:"x",[Ii.spatialEntity.y_dimension.id]:"y",[Ii.spatialEntity.z_dimension.id]:"z"};function jPe(n,e,t,i){const r=e.getTransformationMatrix(t,i);let s;if(r){const o=function(n,e){const t=tp(n,e,"Dimensions",kPe);return[t.x,t.y,t.z]}(n,t),a=r.getTranslation(),l=(new Ki).fromRotationMatrix(r,Ki.XYZ),c=new qb(qb.IDENTITY).fromQuaternion(l.toQuaternion()).scale(o.map(u=>u/1e3/1e3));s=new EF(a,c)}return s}function VPe(n,e,t,i){const{x:r,y:s,z:o,radius:a,target:l}=i,c=new Set,u=a/1e3*(a/1e3);for(const h of t){const p=jPe(n,e,h,l);p&&p.distanceSquaredTo([r,s,o].map(m=>m/1e3))<u&&c.add(h)}return c}function uC(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,vn.readQuads)(n,c,pi.donor,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function LF(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,vn.readQuads)(n,c,pi.spatialEntity,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function Xb(n,e){return function(t){n.has(t.id)&&e.add(t.id)}}function G9(n,e,t){const i=new Set;for(const r of t){const s=vn.DataFactory.namedNode(r);n.forSubjects(Xb(e,i),Ii.spatialEntity.ccf_annotations,s,null)}return i}function $9(n,e){const t=function(n,e){const t=new Map;for(const i of n)for(const r of(0,vn.readQuads)(e,i,pi.spatialEntity,null,null))t.has(r.object.id)?t.get(r.object.id).add(i):t.set(r.object.id,new Set([i]));return t}(n,e),i=new Map;for(const r of t.keys()){const s=t.get(r);for(const o of(0,vn.readQuads)(e,r,Ii.spatialEntity.ccf_annotations,null,null))if(i.has(o.object.id)){const a=i.get(o.object.id);s.forEach(l=>a.add(l))}else i.set(o.object.id,new Set(s))}return i}function tFe(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[Ii.ontologyNode.label.id]:"label",[t]:"parent",[Ii.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of NF(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}function W9(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,vn.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=tFe(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,r}const q9=(0,hr.memoize)(function(n){const e=W9(n,cd.body.id,"body",Ii.asctb.part_of.id);return e.nodes[cd.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0001987","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0002240","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e},()=>""),dC={[pi.label.id]:"label",[pi.description.id]:"description",[pi.link.id]:"link"},rFe=Object.assign(Object.assign({},dC),{[pi.providerName.id]:"providerName"}),sFe=Object.assign(Object.assign({},dC),{[pi.technology.id]:"technology",[pi.thumbnail.id]:"thumbnail"}),oFe=Object.assign(Object.assign({},dC),{[pi.sampleType.id]:"sampleType",[pi.sectionNumber.id]:"sectionNumber",[pi.datasets.id]:"datasets"}),aFe=Object.assign(Object.assign({},dC),{[pi.sampleType.id]:"sampleType",[pi.sectionCount.id]:"sectionCount",[pi.sectionSize.id]:"sectionSize",[pi.sectionUnits.id]:"sectionUnits",[pi.donor.id]:"donor",[pi.spatialEntity.id]:"spatialEntityId",[pi.sections.id]:"sections",[pi.datasets.id]:"datasets"});function lFe(n,e){return tp(n,e,"Donor",rFe)}function Y9(n,e){return tp(n,e,"Dataset",sFe)}function cFe(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};for(const[i,r]of NF(n,e,oFe))if("datasets"===i){const s=Y9(n,r);t[i].push(s)}else t[i]=r;return t}class dFe{constructor(e){this.database=e,this.connect()}toJson(){return{status:this.status,message:this.message,checkback:"Ready"===this.status||"Error"===this.status?36e5:2e3,loadTime:this.loadTime}}connect(){this.status="Loading",this.message="Loading database";const e=Date.now();return this.database.connect().then(t=>Di(this,void 0,void 0,function*(){t?(this.message="Building scene",yield this.database.getScene(),this.message="Building tissue block results",yield this.database.getTissueBlockResults(),this.message="Aggregating results",yield this.database.getAggregateResults(),this.status="Ready",this.message="Database successfully loaded"):(this.status="Error",this.message="Unknown error while loading database")})).catch(t=>{var i;this.status="Error",this.message=null!==(i=null==t?void 0:t.message)&&void 0!==i?i:"Unknown error while loading database"}).finally(()=>{this.loadTime=Date.now()-e})}}const fFe={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class pFe{constructor(e=fFe){this.options=e,this.store=new vn.Store(void 0,{factory:vn.DataFactory}),this.graph=new B9(this),this.scene=new j9(this)}connect(e,t=!1){return Di(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return Di(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield N9(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=gc()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),au(t.transaction)))}([i,t]).catch(()=>{}):s=yield N9(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=gc()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),au(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return Di(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.startsWith("{"))this.store=(0,vn.deserializeN3Store)(s,vn.DataFactory);else if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,vn.deserializeN3Store)(o,vn.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(H9(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return Di(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>Di(this,void 0,void 0,function*(){"string"==typeof r?r.endsWith("jsonld")?yield(0,vn.addJsonLdToStore)(r,i):r.endsWith("n3")?yield(0,vn.addN3ToStore)(r,i):r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml")?yield(0,vn.addRdfXmlToStore)(r,i):yield(0,vn.addJsonLdToStore)(r,i):yield(0,vn.addJsonLdToStore)(r,i)}))),this})}synchronize(){return Di(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),function(n){var e,t,i;const r=q9(n),s=new Map;for(const{subject:o,object:a}of(0,vn.readQuads)(n,null,Ii.spatialEntity.representation_of,null,null)){const l=new Set([a.id]);let c=null===(e=r.nodes[a.id])||void 0===e?void 0:e.parent;for(;c&&!l.has(c);)l.add(c),c=null===(t=r.nodes[c])||void 0===t?void 0:t.parent;s.set(o.id,[...l].map(u=>vn.DataFactory.namedNode(u)))}for(const{object:o}of(0,vn.readQuads)(n,null,pi.spatialEntity,null,null))for(const{subject:a}of(0,vn.readQuads)(n,null,Ii.spatialPlacement.source,o,null))for(const{object:l}of(0,vn.readQuads)(n,a,Ii.spatialPlacement.target,null,null))for(const c of null!==(i=s.get(l.id))&&void 0!==i?i:[])n.addQuad(vn.DataFactory.namedNode(o.id),Ii.spatialEntity.ccf_annotations,c)}(this.store),this})}serialize(){return(0,vn.serializeN3Store)(this.store)}deserialize(e){return Di(this,void 0,void 0,function*(){this.store=(0,vn.deserializeN3Store)(e,vn.DataFactory),this.graph=new B9(this),this.scene=new j9(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e,t){var i,r,s,o,a,l,c;let u=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),pi.spatialEntity,null,null),e}(n);if(u.size>0&&(u=function(n,e,t=!0){const i=new Set;if(n.forSubjects(Xb(e,i),pi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,u)),u.size>0&&("Male"===t.sex||"Female"===t.sex)){const h=t.sex;u=uC(n,u,p=>function(n,e,t){const i=new Set;return n.forSubjects(Xb(e,i),pi.sex,pi[t],null),i}(n,p,h))}if(u.size>0&&(null===(i=t.tmc)||void 0===i?void 0:i.length)>0&&(u=uC(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=vn.DataFactory.literal(r);n.forSubjects(Xb(e,i),pi.providerName,s,null)}return i}(n,h,t.tmc))),u.size>0&&(null===(r=t.technologies)||void 0===r?void 0:r.length)>0&&(u=function(n,e,t){var i,r;const s=new Map,o=new Set,a=new Set(e);for(const u of e)for(const h of(0,vn.readQuads)(n,u,pi.sections,null,null))a.add(h.object.id);for(const u of a)for(const h of(0,vn.readQuads)(n,u,pi.datasets,null,null))o.add(h.object.id),s.has(h.object.id)?null===(i=s.get(h.object.id))||void 0===i||i.push(u):s.set(h.object.id,[u]);const l=t(o),c=new Set;for(const u of l)for(const h of null!==(r=s.get(u))&&void 0!==r?r:[])c.add(h);return c}(n,u,h=>function(n,e,t){const i=new Set;for(const r of t){const s=vn.DataFactory.literal(r);n.forSubjects(Xb(e,i),pi.technology,s,null)}return i}(n,h,t.technologies))),u.size>0&&(null===(s=t.spatialSearches)||void 0===s?void 0:s.length)>0&&(u=LF(n,u,h=>function(n,e,t,i){const r=new Set;for(const s of i)VPe(n,e,t,s).forEach(a=>r.add(a));return r}(n,e,h,t.spatialSearches))),u.size>0&&(null===(o=t.ontologyTerms)||void 0===o?void 0:o.length)>0){const h=t.ontologyTerms;-1===h.indexOf(cd.body.id)&&(u=LF(n,u,p=>G9(n,p,h)))}if(u.size>0&&(null===(a=t.cellTypeTerms)||void 0===a?void 0:a.length)>0){const h=t.cellTypeTerms;-1===h.indexOf(cd.cell.id)&&(u=LF(n,u,p=>function(n,e,t){const i=new Set;for(const r of t)n.forObjects(s=>{i.add(s.id)},r,Ii.asctb.located_in,null),r===cd.cell.id&&i.add(cd.body.id);return G9(n,e,[...i])}(n,p,h)))}if(u.size>0&&2===(null===(l=t.ageRange)||void 0===l?void 0:l.length)&&(0,hr.isFinite)(t.ageRange[0])&&(0,hr.isFinite)(t.ageRange[1])){const h=Math.max(...t.ageRange),p=Math.min(...t.ageRange);1===p&&110===h||(u=uC(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,vn.readQuads)(n,s,pi.age,null,null)){const a=(0,Vb.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,p,h)))}if(u.size>0&&2===(null===(c=t.bmiRange)||void 0===c?void 0:c.length)&&(0,hr.isFinite)(t.bmiRange[0])&&(0,hr.isFinite)(t.bmiRange[1])){const h=Math.max(...t.bmiRange),p=Math.min(...t.bmiRange);13===p&&83===h||(u=uC(n,u,g=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,vn.readQuads)(n,s,pi.bmi,null,null)){const a=(0,Vb.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,g,p,h)))}return u}(this.store,this.graph,e)}get(e){return this.store.getQuads(vn.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t=n.getObjects(vn.DataFactory.namedNode(e),pi.spatialEntity,null);if(t.length>0)return np(n,t[0].id)}(this.store,t))}getDatabaseStatus(){return Di(this,void 0,void 0,function*(){return this.status||(this.status=new dFe(this)),this.status.toJson()})}getDatasetTechnologyNames(){return Di(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,vn.readQuads)(n,null,pi.technology,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getProviderNames(){return Di(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,vn.readQuads)(n,null,pi.providerName,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getTissueBlockResults(e){return Di(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};for(const[i,r]of NF(n,e,aFe))if("sections"===i){const s=cFe(n,r);t[i].push(s)}else if("datasets"===i){const s=Y9(n,r);t[i].push(s)}else t[i]="donor"===i?lFe(n,r):r;return t}(this.store,t))})}getAggregateResults(e){return Di(this,void 0,void 0,function*(){return function(n,e){const t=Kb(e,n,pi.donor.id),i=Kb(e,t,pi.providerUUID.id),r=new Set;for(const l of n)for(const c of(0,vn.readQuads)(e,l,pi.spatialEntity,null,null))r.add(c.subject.id);const s=Kb(e,r,pi.sections.id),o=new Set([...Kb(e,r,pi.datasets.id),...Kb(e,s,pi.datasets.id)]);return Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return Di(this,void 0,void 0,function*(){return function(n,e){const t={};return $9(n,e).forEach((r,s)=>{t[s]=r.size}),t}(this.getIds(e),this.store)})}getCellTypeTermOccurences(e){return Di(this,void 0,void 0,function*(){return function(n,e){var t,i;const r=$9(n,e),s=new Map;for(const a of r.keys()){const l=r.get(a);for(const c of(0,vn.readQuads)(e,null,Ii.asctb.located_in,a,null)){const u=c.subject.id;if(s.has(u)){const h=s.get(u);l.forEach(p=>h.add(p))}else s.set(u,new Set(l))}}const o={};return s.forEach((a,l)=>{o[l]=a.size}),o[cd.cell.id]=null!==(i=null===(t=r.get(cd.body.id))||void 0===t?void 0:t.size)&&void 0!==i?i:0,o}(this.getIds(e),this.store)})}getOntologyTreeModel(){return Di(this,void 0,void 0,function*(){return q9(this.store)})}getCellTypeTreeModel(){return Di(this,void 0,void 0,function*(){return function(n){return W9(n,cd.cell.id,"cell",Ii.asctb.ct_is_a.id)}(this.store)})}getReferenceOrgans(){return Di(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return Di(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return Di(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}getSpatialPlacement(e,t){return Di(this,void 0,void 0,function*(){return this.graph.getSpatialPlacement(e,t)})}}function yFe(n,e){return n===e}let bFe=(()=>{class n{constructor(t,i){this.locator=t,this.globalConfig=i,this.subscriptions=new x,this.dataSource=i.getOption("data").pipe(ge(r=>Object.assign(Object.assign({},R9),{dataSources:r})),qi(r=>Object.keys(r).length>0),ge(r=>r),Ku(yFe),Cr(r=>function(n,e){return new I(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?je(r):jc).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDataSource(),s=>this.connectDataSource(s.source,r))),Ua(1)),this.subscriptions.add(this.dataSource.subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}getTissueBlockResults(t){return this.dataSource.pipe(Cr(i=>i.getTissueBlockResults(t)),zi(1))}getAggregateResults(t){return this.dataSource.pipe(Cr(i=>i.getAggregateResults(t)),zi(1))}getOntologyTermOccurences(t){return this.dataSource.pipe(Cr(i=>i.getOntologyTermOccurences(t)),zi(1))}getCellTypeTermOccurences(t){return this.dataSource.pipe(Cr(i=>i.getCellTypeTermOccurences(t)),zi(1))}getOntologyTreeModel(){return this.dataSource.pipe(Cr(t=>t.getOntologyTreeModel()),zi(1))}getCellTypeTreeModel(){return this.dataSource.pipe(Cr(t=>t.getCellTypeTreeModel()),zi(1))}getReferenceOrgans(){return this.dataSource.pipe(Cr(t=>t.getReferenceOrgans()),zi(1))}getScene(t){return this.dataSource.pipe(Cr(i=>i.getScene(t)),zi(1))}getOrganScene(t,i){return this.dataSource.pipe(Cr(r=>r.getReferenceOrganScene(t,i)),zi(1))}createDataSource(){return{source:new pFe,unsubscribe:()=>{}}}connectDataSource(t,i){return Di(this,void 0,void 0,function*(){const r=(new Date).getTime();return yield t.connect(i,!1),u0.production||(console.info(`Loaded CCF database in ${((new Date).getTime()-r)/1e3}s`),console.log(t)),t})}}return n.\u0275fac=function(t){return new(t||n)(Oe(bf),Oe(jb))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vFe=(()=>{class n{constructor(t,i){this.configState=t,this.source=i,this.data$=this.configState.getOption("data"),this.zoomToID$=this.configState.getOption("zoomToID").pipe(ge(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.highlightID$=this.configState.getOption("highlightID").pipe(ge(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.referenceOrgans$=this.source.getReferenceOrgans(),this.scene$=Ho([this.data$,this.referenceOrgans$,this.source.dataSource]).pipe(Cr(([r,s,o])=>this.chooseScene(r,s))),this.organs$=this.configState.getOption("data").pipe(ge(r=>this.selectOrgans(r)),Ua(1)),this.filteredOrgans$=Ho([this.organs$,this.referenceOrgans$]).pipe(ge(([r,s])=>this.getNeededReferenceOrgans(s,r)),Ua(1)),this.filteredScene$=Ho([this.scene$,this.organs$,this.referenceOrgans$]).pipe(ge(([r,s,o])=>this.filterSceneNodes(r,s,o)),function(n,e){const t=n.pipe(zo(""));return i=>Ho([i,t]).pipe(ge(([r,s])=>r.map(o=>function(n,e,t){return n.entityId!==e?n:Object.assign(Object.assign({},n),{color:t})}(o,s,e))))}(this.highlightID$,uRe),function(n){const e=n.pipe(zo(""));return t=>Ho([t,e]).pipe(ge(([i,r])=>i.map(s=>function(n,e){return n.entityId!==e?n:Object.assign(Object.assign({},n),{zoomToOnLoad:!0})}(s,r))))}(this.zoomToID$),Ua(1))}chooseScene(t,i){var r;const s=null!==(r=null==t?void 0:t.map(a=>{const l=a[c9];return null==l?void 0:l.placement.target}))&&void 0!==r?r:[];if(new Set(s).size>1)return this.source.getScene();if(i){const a=i.find(l=>l["@id"]===s[0]);if(a)return this.source.getOrganScene(a.representation_of,{ontologyTerms:[a.reference_organ],sex:a.sex})}return an([])}selectOrgans(t){const r=(null!=t?t:[]).map(s=>s[c9].placement.target);return new Set(r)}filterSceneNodes(t,i,r){const s=this.getNeededReferenceOrgans(r,i),o=this.getNeededSkins(s),a=new Set([...i,...o]);return t.filter(c=>!c.reference_organ||a.has(c.reference_organ))}getNeededReferenceOrgans(t,i){return t.filter(r=>{var s;return i.has(null!==(s=r.reference_organ)&&void 0!==s?s:"")})}getNeededSkins(t){if(1===t.length)return[];const i=new Set;return t.forEach(r=>{"Female"===r.sex?i.add("http://purl.org/ccf/latest/ccf.owl#VHFSkin"):"Male"===r.sex&&i.add("http://purl.org/ccf/latest/ccf.owl#VHMSkin")}),[...i]}}return n.\u0275fac=function(t){return new(t||n)(Oe(jb),Oe(bFe))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const wFe=["bodyUI"];let EFe=(()=>{class n{constructor(t,i,r){this.configState=t,this.sceneSource=i,this.cdr=r,this.onMouseEnter=new cn,this.onMouseLeave=new cn,this.onClick=new cn,this.data$=this.configState.getOption("data"),this.organs$=this.sceneSource.filteredOrgans$,this.scene$=this.sceneSource.filteredScene$.pipe(Jr(s=>this.reset()))}reset(){var t,i;return Di(this,void 0,void 0,function*(){const{bodyUI:r}=this;yield new Promise(a=>setTimeout(a,200));const s=yield this.organs$.pipe(zi(1)).toPromise(),o=null!==(i=!!(null===(t=r.scene)||void 0===t?void 0:t.find(a=>a.zoomToOnLoad)))&&void 0!==i&&i;if(r.rotation=0,r.rotationX=0,!o)if(1===s.length){const{x_dimension:a,y_dimension:l,z_dimension:c}=s[0];r.bounds={x:1.25*a/1e3,y:1.25*l/1e3,z:1.25*c/1e3},r.target=[a/1e3/2,l/1e3/2,c/1e3/2]}else r.bounds={x:2.2,y:2,z:.4},r.target=[0,0,0];this.cdr.detectChanges()})}}return n.\u0275fac=function(t){return new(t||n)(De(jb),De(vFe),De(rs))},n.\u0275cmp=Sn({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&Ds(wFe,7),2&t){let r;Ni(r=Pi())&&(i.bodyUI=r.first)}},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},decls:3,vars:4,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick","nodeHoverStart","nodeHoverStop"],["bodyUI",""]],template:function(t,i){1&t&&(Xt(0,"ccf-body-ui",0,1),hi("nodeClick",function(s){return i.onClick.emit(s)})("nodeHoverStart",function(s){return i.onMouseEnter.emit(s)})("nodeHoverStop",function(s){return i.onMouseLeave.emit(s)}),function(n,e){const t=mi();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Ze("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=bc(i.type)),o=_a(De);try{const a=gp(!1),l=s();gp(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,Lt(),r,l)}finally{_a(o)}}(2,"async"),Qt()),2&t&&yn("scene",Ky(2,2,i.scene$))("interactive",!0)},directives:[OOe],pipes:[$E],styles:[".body-ui[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),n})();function SFe(n,e){if(1&n){const t=Lt();Xt(0,"ccf-root",1),hi("onMouseEnter",function(r){return jr(t),yi().onMouseEnter.emit(r)})("onMouseLeave",function(r){return jr(t),yi().onMouseLeave.emit(r)})("onClick",function(r){return jr(t),yi().onClick.emit(r)}),Qt()}}function xFe(n){return n.map(e=>({"@id":`http://purl.org/ccf/1.5/entity/${e.id}`,"@type":"http://purl.org/ccf/latest/ccf-entity.owl#Sample","http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity":e.rui_location}))}let CFe=(()=>{class n extends Bne{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:Object.assign(Object.assign({},u0.dbOptions),globalThis.dbOptions),parse:{data:xFe}}),this.onMouseEnter=new cn,this.onMouseLeave=new cn,this.onClick=new cn}}return n.\u0275fac=function(t){return new(t||n)(De(jb),De(rs))},n.\u0275cmp=Sn({type:n,selectors:[["ccf-root-wc"]],inputs:{data:"data",highlightID:"highlightID",zoomToID:"zoomToID"},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},features:[Fn],decls:1,vars:1,consts:[[3,"onMouseEnter","onMouseLeave","onClick",4,"ngIf"],[3,"onMouseEnter","onMouseLeave","onClick"]],template:function(t,i){1&t&&function(n,e,t,i,r,s,o,a){const l=Lt(),c=mi(),u=n+20,h=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,u=zd(e,n,4,o||null,Ea(c,a));uy(e,t,u,Ea(c,l)),dp(e,u);const h=u.tViews=Wp(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];el(h,!1);const p=l[11].createComment("");jp(c,l,p,h),Cs(p,l),qp(l,l[u]=jw(p,l,p,h)),_d(h)&&of(c,l,h),null!=o&&cy(l,h,a)}(0,SFe,1,0,"ccf-root",0),2&t&&yn("ngIf",i.initialized)},directives:[Fu,EFe],encapsulation:2,changeDetection:0}),n})(),AFe=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[cs,Ya,z7,...t]}}}return n.\u0275fac=function(t){return new(t||n)(Oe(cs,2),Oe(Ya,2))},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({}),n})();const gC=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class DFe{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=Bf(this.action),i=function(n){return gC(n.getHours(),2)+":"+gC(n.getMinutes(),2)+":"+gC(n.getSeconds(),2)+"."+gC(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",Object.assign({},this.action)),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class IFe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch(i){console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch(e){this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,t,i)}isIE(){const e="undefined"!=typeof window&&window.navigator.userAgent?window.navigator.userAgent:"";let t=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(t=!0),t}}const K9=new Ht("NGXS_LOGGER_PLUGIN_OPTIONS");let OFe=(()=>{class n{constructor(t,i){this._options=t,this._injector=i}handle(t,i,r){if(this._options.disabled||!this._options.filter(i,t))return r(t,i);this._logWriter=this._logWriter||new IFe(this._options),this._store=this._store||this._injector.get(dh);const s=new DFe(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(Jr(o=>{s.completed(o)}),dc(o=>{throw s.errored(o),o}))}}return n.\u0275fac=function(t){return new(t||n)(Oe(K9),Oe(Gn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const X9=new Ht("LOGGER_USER_OPTIONS");function RFe(n){return Object.assign({},{logger:console,collapsed:!1,disabled:!1,filter:()=>!0},n)}let NFe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:X5,useClass:OFe,multi:!0},{provide:X9,useValue:t},{provide:K9,useFactory:RFe,deps:[X9]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({}),n})();const PFe=[jb];let FFe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({imports:[[AFe.forRoot(),fa.forRoot(PFe,{developmentMode:!u0.production}),NFe.forRoot({disabled:u0.production})]]}),n})(),LFe=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(ml).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new Rne(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends Pne{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,u){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(CFe,{injector:this.injector});customElements.define("ccf-body-ui-wc",t)}}return n.\u0275fac=function(t){return new(t||n)(Oe(Gn))},n.\u0275mod=gn({type:n}),n.\u0275inj=Tt({providers:[],imports:[[jD,FFe,ROe]]}),n})();u0.production&&function(){if(j3)throw new Error("Cannot enable prod mode after platform setup.");B3=!1}(),tne().bootstrapModule(LFe).catch(n=>console.error(n))},52:Bt=>{function it(yt,ee,At,dt,Y,Se,he){try{var W=yt[Se](he),j=W.value}catch(P){return void At(P)}W.done?ee(j):Promise.resolve(j).then(dt,Y)}Bt.exports=function(yt){return function(){var ee=this,At=arguments;return new Promise(function(dt,Y){var Se=yt.apply(ee,At);function he(j){it(Se,dt,Y,he,W,"next",j)}function W(j){it(Se,dt,Y,he,W,"throw",j)}he(void 0)})}},Bt.exports.default=Bt.exports,Bt.exports.__esModule=!0},948:Bt=>{Bt.exports=function(Je){return Je&&Je.__esModule?Je:{default:Je}},Bt.exports.default=Bt.exports,Bt.exports.__esModule=!0},321:Bt=>{function it(Je){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(Bt.exports=it=function(ee){return typeof ee},Bt.exports.default=Bt.exports,Bt.exports.__esModule=!0):(Bt.exports=it=function(ee){return ee&&"function"==typeof Symbol&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},Bt.exports.default=Bt.exports,Bt.exports.__esModule=!0),it(Je)}Bt.exports=it,Bt.exports.default=Bt.exports,Bt.exports.__esModule=!0},380:Bt=>{function it(Je){return Promise.resolve().then(()=>{var yt=new Error("Cannot find module '"+Je+"'");throw yt.code="MODULE_NOT_FOUND",yt})}it.keys=()=>[],it.resolve=it,it.id=380,Bt.exports=it},521:()=>{},125:()=>{},307:()=>{}},Bt=>{Bt(Bt.s=630)}]);