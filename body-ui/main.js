var FOe=Object.defineProperty,LOe=Object.defineProperties,kOe=Object.getOwnPropertyDescriptors,MC=Object.getOwnPropertySymbols,G7=Object.prototype.hasOwnProperty,$7=Object.prototype.propertyIsEnumerable,yr=Math.pow,W7=(kt,nt,tt)=>nt in kt?FOe(kt,nt,{enumerable:!0,configurable:!0,writable:!0,value:tt}):kt[nt]=tt,ht=(kt,nt)=>{for(var tt in nt||(nt={}))G7.call(nt,tt)&&W7(kt,tt,nt[tt]);if(MC)for(var tt of MC(nt))$7.call(nt,tt)&&W7(kt,tt,nt[tt]);return kt},Hn=(kt,nt)=>LOe(kt,kOe(nt)),q7=(kt,nt)=>{var tt={};for(var mt in kt)G7.call(kt,mt)&&nt.indexOf(mt)<0&&(tt[mt]=kt[mt]);if(null!=kt&&MC)for(var mt of MC(kt))nt.indexOf(mt)<0&&$7.call(kt,mt)&&(tt[mt]=kt[mt]);return tt};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:(kt,nt,tt)=>{var mt=tt(52).default;kt.exports=function Y(Te,fe,K){function V($,v){if(!fe[$]){if(!Te[$]){if(L)return L($,!0);var N=new Error("Cannot find module '"+$+"'");throw N.code="MODULE_NOT_FOUND",N}var M=fe[$]={exports:{}};Te[$][0].call(M.exports,function(b){return V(Te[$][1][b]||b)},M,M.exports,Y,Te,fe,K)}return fe[$].exports}for(var L=void 0,ie=0;ie<K.length;ie++)V(K[ie]);return V}({1:[function(Y,Te,fe){var K,V;K=this,V=function(K,V,L,ie,$){"use strict";function x(Ce,Be,$e,Ne){return new($e||($e=Promise))(function(U,he){function ue(ft){try{gt(Ne.next(ft))}catch(ve){he(ve)}}function ke(ft){try{gt(Ne.throw(ft))}catch(ve){he(ve)}}function gt(ft){ft.done?U(ft.value):function(U){return U instanceof $e?U:new $e(function(he){he(U)})}(ft.value).then(ue,ke)}gt((Ne=Ne.apply(Ce,Be||[])).next())})}function j(Ce,Be){var Ne,G,U,he,$e={label:0,sent:function(){if(1&U[0])throw U[1];return U[1]},trys:[],ops:[]};return he={next:ue(0),throw:ue(1),return:ue(2)},"function"==typeof Symbol&&(he[Symbol.iterator]=function(){return this}),he;function ue(gt){return function(ft){return function(gt){if(Ne)throw new TypeError("Generator is already executing.");for(;$e;)try{if(Ne=1,G&&(U=2&gt[0]?G.return:gt[0]?G.throw||((U=G.return)&&U.call(G),0):G.next)&&!(U=U.call(G,gt[1])).done)return U;switch(G=0,U&&(gt=[2&gt[0],U.value]),gt[0]){case 0:case 1:U=gt;break;case 4:return $e.label++,{value:gt[1],done:!1};case 5:$e.label++,G=gt[1],gt=[0];continue;case 7:gt=$e.ops.pop(),$e.trys.pop();continue;default:if(!(U=(U=$e.trys).length>0&&U[U.length-1])&&(6===gt[0]||2===gt[0])){$e=0;continue}if(3===gt[0]&&(!U||gt[1]>U[0]&&gt[1]<U[3])){$e.label=gt[1];break}if(6===gt[0]&&$e.label<U[1]){$e.label=U[1],U=gt;break}if(U&&$e.label<U[2]){$e.label=U[2],$e.ops.push(gt);break}U[2]&&$e.ops.pop(),$e.trys.pop();continue}gt=Be.call(Ce,$e)}catch(ft){gt=[6,ft],G=0}finally{Ne=U=0}if(5&gt[0])throw gt[1];return{value:gt[0]?gt[1]:void 0,done:!0}}([gt,ft])}}}function Xe(Ce){var Be=Ce.length,$e=0;return new $.Readable({objectMode:!0,read:function(){this.push($e<Be?Ce[$e++]:null)}})}K.addJsonLdToStore=function(Ce,Be){return x(this,void 0,void 0,function(){var $e,Ne,G;return j(this,function(U){switch(U.label){case 0:return"string"!=typeof Ce?[3,4]:[4,fetch(Ce,{redirect:"follow"})];case 1:return(Ne=U.sent()).ok?[4,Ne.json()]:[3,3];case 2:$e=U.sent(),U.label=3;case 3:return[3,5];case 4:$e=Ce,U.label=5;case 5:return $e?[4,V.toRDF($e)]:[3,7];case 6:G=U.sent(),Be.import(Xe(G)),U.label=7;case 7:return[2,Be]}})})},K.addN3ToStore=function(Ce,Be){return x(this,void 0,void 0,function(){var $e,Ne,G;return j(this,function(U){switch(U.label){case 0:return"string"==typeof Ce&&(null==Ce?void 0:Ce.startsWith("http"))?[4,fetch(Ce,{redirect:"follow"})]:[3,4];case 1:return(Ne=U.sent()).ok?[4,Ne.text()]:[3,3];case 2:$e=U.sent(),U.label=3;case 3:return[3,5];case 4:$e=Ce,U.label=5;case 5:return $e&&(G=new L.Parser({format:"n3"}).parse($e),Be.import(Xe(G))),[2,Be]}})})},K.addRdfXmlToStore=function(Ce,Be){return x(this,void 0,void 0,function(){var $e,Ne,G,U;return j(this,function(he){switch(he.label){case 0:return"string"==typeof Ce&&(null==Ce?void 0:Ce.startsWith("http"))?[4,fetch(Ce,{redirect:"follow"})]:[3,4];case 1:return(Ne=he.sent()).ok?[4,Ne.text()]:[3,3];case 2:$e=he.sent(),he.label=3;case 3:return[3,5];case 4:$e=Ce,he.label=5;case 5:return $e?(G=new ie.RdfXmlParser({dataFactory:L.DataFactory,strict:!0}),U=new Promise(function(ue){G.once("end",function(){return ue(Be)})}),Be.import(G),G.write($e),G.end(),[2,U]):[2,Be]}})})},K.arrayToStream=Xe,K.deserializeN3Store=function(Ce,Be){var $e=JSON.parse(Ce),Ne=new L.Store;return Object.assign(Ne,$e,{_factory:null!=Be?Be:L.DataFactory}),Ne},K.readQuads=function(Ce,Be,$e,Ne,G){return Ce.readQuads(Be,$e,Ne,G)},K.serializeN3Store=function(Ce){var Be=Object.assign({},Ce);return delete Be._factory,JSON.stringify(Be)},K.streamToArray=function(Ce){return new Promise(function(Be,$e){var Ne=[];Ce.on("data",function(G){Ne.push(G)}).once("end",function(){Be(Ne)}).once("error",function(G){$e(G)})})},Object.keys(L).forEach(function(Ce){"default"!==Ce&&!K.hasOwnProperty(Ce)&&Object.defineProperty(K,Ce,{enumerable:!0,get:function(){return L[Ce]}})}),Object.defineProperty(K,"__esModule",{value:!0})},"object"==typeof fe&&void 0!==Te?V(fe,Y("jsonld"),Y("n3"),Y("rdfxml-streaming-parser"),Y("readable-stream")):V((K="undefined"!=typeof globalThis?globalThis:K||self).tripleStoreUtils={},K.jsonld,K.n3,K.rdfxmlStreamingParser,K.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(Y,Te,fe){"use strict";fe.byteLength=function(j){var O=S(j),ce=O[1];return 3*(O[0]+ce)/4-ce},fe.toByteArray=function(j){var O,z,q=S(j),ce=q[0],D=q[1],I=new L(function(j,O,q){return 3*(O+q)/4-q}(0,ce,D)),X=0,w=D>0?ce-4:ce;for(z=0;z<w;z+=4)O=V[j.charCodeAt(z)]<<18|V[j.charCodeAt(z+1)]<<12|V[j.charCodeAt(z+2)]<<6|V[j.charCodeAt(z+3)],I[X++]=O>>16&255,I[X++]=O>>8&255,I[X++]=255&O;return 2===D&&(O=V[j.charCodeAt(z)]<<2|V[j.charCodeAt(z+1)]>>4,I[X++]=255&O),1===D&&(O=V[j.charCodeAt(z)]<<10|V[j.charCodeAt(z+1)]<<4|V[j.charCodeAt(z+2)]>>2,I[X++]=O>>8&255,I[X++]=255&O),I},fe.fromByteArray=function(j){for(var O,q=j.length,ce=q%3,D=[],I=16383,X=0,w=q-ce;X<w;X+=I)D.push(E(j,X,X+I>w?w:X+I));return 1===ce?D.push(K[(O=j[q-1])>>2]+K[O<<4&63]+"=="):2===ce&&D.push(K[(O=(j[q-2]<<8)+j[q-1])>>10]+K[O>>4&63]+K[O<<2&63]+"="),D.join("")};for(var K=[],V=[],L="undefined"!=typeof Uint8Array?Uint8Array:Array,ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$=0,v=ie.length;$<v;++$)K[$]=ie[$],V[ie.charCodeAt($)]=$;function S(j){var O=j.length;if(O%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var q=j.indexOf("=");return-1===q&&(q=O),[q,q===O?0:4-q%4]}function y(j){return K[j>>18&63]+K[j>>12&63]+K[j>>6&63]+K[63&j]}function E(j,O,q){for(var D=[],I=O;I<q;I+=3)D.push(y((j[I]<<16&16711680)+(j[I+1]<<8&65280)+(255&j[I+2])));return D.join("")}V["-".charCodeAt(0)]=62,V["_".charCodeAt(0)]=63},{}],3:[function(Y,Te,fe){},{}],4:[function(Y,Te,fe){var K=Y("buffer"),V=K.Buffer;function L($,v){for(var S in $)v[S]=$[S]}function ie($,v,S){return V($,v,S)}V.from&&V.alloc&&V.allocUnsafe&&V.allocUnsafeSlow?Te.exports=K:(L(K,fe),fe.Buffer=ie),L(V,ie),ie.from=function($,v,S){if("number"==typeof $)throw new TypeError("Argument must not be a number");return V($,v,S)},ie.alloc=function($,v,S){if("number"!=typeof $)throw new TypeError("Argument must be a number");var N=V($);return void 0!==v?"string"==typeof S?N.fill(v,S):N.fill(v):N.fill(0),N},ie.allocUnsafe=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return V($)},ie.allocUnsafeSlow=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return K.SlowBuffer($)}},{buffer:6}],5:[function(Y,Te,fe){"use strict";var K=Y("safe-buffer").Buffer,V=K.isEncoding||function(D){switch((D=""+D)&&D.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function $(D){var I;switch(this.encoding=function(D){var I=function(D){if(!D)return"utf8";for(var I;;)switch(D){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return D;default:if(I)return;D=(""+D).toLowerCase(),I=!0}}(D);if("string"!=typeof I&&(K.isEncoding===V||!V(D)))throw new Error("Unknown encoding: "+D);return I||D}(D),this.encoding){case"utf16le":this.text=E,this.end=x,I=4;break;case"utf8":this.fillLast=M,I=4;break;case"base64":this.text=j,this.end=O,I=3;break;default:return this.write=q,void(this.end=ce)}this.lastNeed=0,this.lastTotal=0,this.lastChar=K.allocUnsafe(I)}function v(D){return D<=127?0:D>>5==6?2:D>>4==14?3:D>>3==30?4:D>>6==2?-1:-2}function M(D){var I=this.lastTotal-this.lastNeed,X=function(D,I,X){if(128!=(192&I[0]))return D.lastNeed=0,"\ufffd";if(D.lastNeed>1&&I.length>1){if(128!=(192&I[1]))return D.lastNeed=1,"\ufffd";if(D.lastNeed>2&&I.length>2&&128!=(192&I[2]))return D.lastNeed=2,"\ufffd"}}(this,D);return void 0!==X?X:this.lastNeed<=D.length?(D.copy(this.lastChar,I,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(D.copy(this.lastChar,I,0,D.length),void(this.lastNeed-=D.length))}function E(D,I){if((D.length-I)%2==0){var X=D.toString("utf16le",I);if(X){var w=X.charCodeAt(X.length-1);if(w>=55296&&w<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1],X.slice(0,-1)}return X}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=D[D.length-1],D.toString("utf16le",I,D.length-1)}function x(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):I}function j(D,I){var X=(D.length-I)%3;return 0===X?D.toString("base64",I):(this.lastNeed=3-X,this.lastTotal=3,1===X?this.lastChar[0]=D[D.length-1]:(this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1]),D.toString("base64",I,D.length-X))}function O(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+this.lastChar.toString("base64",0,3-this.lastNeed):I}function q(D){return D.toString(this.encoding)}function ce(D){return D&&D.length?this.write(D):""}fe.StringDecoder=$,$.prototype.write=function(D){if(0===D.length)return"";var I,X;if(this.lastNeed){if(void 0===(I=this.fillLast(D)))return"";X=this.lastNeed,this.lastNeed=0}else X=0;return X<D.length?I?I+this.text(D,X):this.text(D,X):I||""},$.prototype.end=function(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+"\ufffd":I},$.prototype.text=function(D,I){var X=function(D,I,X){var w=I.length-1;if(w<X)return 0;var z=v(I[w]);return z>=0?(z>0&&(D.lastNeed=z-1),z):--w<X||-2===z?0:(z=v(I[w]))>=0?(z>0&&(D.lastNeed=z-2),z):--w<X||-2===z?0:(z=v(I[w]))>=0?(z>0&&(2===z?z=0:D.lastNeed=z-3),z):0}(this,D,I);if(!this.lastNeed)return D.toString("utf8",I);this.lastTotal=X;var w=D.length-(X-this.lastNeed);return D.copy(this.lastChar,0,w),D.toString("utf8",I,w)},$.prototype.fillLast=function(D){if(this.lastNeed<=D.length)return D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,D.length),this.lastNeed-=D.length}},{"safe-buffer":4}],6:[function(Y,Te,fe){(function(K){(function(){"use strict";var V=Y("base64-js"),L=Y("ieee754");fe.Buffer=S,fe.SlowBuffer=function(k){return+k!=k&&(k=0),S.alloc(+k)},fe.INSPECT_MAX_BYTES=50;var ie=2147483647;function v(k){if(k>ie)throw new RangeError('The value "'+k+'" is invalid for option "size"');var R=new Uint8Array(k);return R.__proto__=S.prototype,R}function S(k,R,B){if("number"==typeof k){if("string"==typeof R)throw new TypeError('The "string" argument must be of type string. Received type number');return y(k)}return N(k,R,B)}function N(k,R,B){if("string"==typeof k)return function(k,R){if(("string"!=typeof R||""===R)&&(R="utf8"),!S.isEncoding(R))throw new TypeError("Unknown encoding: "+R);var B=0|D(k,R),Oe=v(B),Qe=Oe.write(k,R);return Qe!==B&&(Oe=Oe.slice(0,Qe)),Oe}(k,R);if(ArrayBuffer.isView(k))return x(k);if(null==k)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k);if(ft(k,ArrayBuffer)||k&&ft(k.buffer,ArrayBuffer))return function(k,R,B){if(R<0||k.byteLength<R)throw new RangeError('"offset" is outside of buffer bounds');if(k.byteLength<R+(B||0))throw new RangeError('"length" is outside of buffer bounds');var Oe;return(Oe=void 0===R&&void 0===B?new Uint8Array(k):void 0===B?new Uint8Array(k,R):new Uint8Array(k,R,B)).__proto__=S.prototype,Oe}(k,R,B);if("number"==typeof k)throw new TypeError('The "value" argument must not be of type number. Received type number');var Oe=k.valueOf&&k.valueOf();if(null!=Oe&&Oe!==k)return S.from(Oe,R,B);var Qe=function(k){if(S.isBuffer(k)){var R=0|q(k.length),B=v(R);return 0===B.length||k.copy(B,0,0,R),B}return void 0!==k.length?"number"!=typeof k.length||ve(k.length)?v(0):x(k):"Buffer"===k.type&&Array.isArray(k.data)?x(k.data):void 0}(k);if(Qe)return Qe;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof k[Symbol.toPrimitive])return S.from(k[Symbol.toPrimitive]("string"),R,B);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k)}function M(k){if("number"!=typeof k)throw new TypeError('"size" argument must be of type number');if(k<0)throw new RangeError('The value "'+k+'" is invalid for option "size"')}function y(k){return M(k),v(k<0?0:0|q(k))}function x(k){for(var R=k.length<0?0:0|q(k.length),B=v(R),Oe=0;Oe<R;Oe+=1)B[Oe]=255&k[Oe];return B}function q(k){if(k>=ie)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ie.toString(16)+" bytes");return 0|k}function D(k,R){if(S.isBuffer(k))return k.length;if(ArrayBuffer.isView(k)||ft(k,ArrayBuffer))return k.byteLength;if("string"!=typeof k)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof k);var B=k.length,Oe=arguments.length>2&&!0===arguments[2];if(!Oe&&0===B)return 0;for(var Qe=!1;;)switch(R){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":return U(k).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*B;case"hex":return B>>>1;case"base64":return ke(k).length;default:if(Qe)return Oe?-1:U(k).length;R=(""+R).toLowerCase(),Qe=!0}}function I(k,R,B){var Oe=!1;if((void 0===R||R<0)&&(R=0),R>this.length||((void 0===B||B>this.length)&&(B=this.length),B<=0)||(B>>>=0)<=(R>>>=0))return"";for(k||(k="utf8");;)switch(k){case"hex":return Je(this,R,B);case"utf8":case"utf-8":return _e(this,R,B);case"ascii":return rt(this,R,B);case"latin1":case"binary":return Xe(this,R,B);case"base64":return te(this,R,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ke(this,R,B);default:if(Oe)throw new TypeError("Unknown encoding: "+k);k=(k+"").toLowerCase(),Oe=!0}}function X(k,R,B){var Oe=k[R];k[R]=k[B],k[B]=Oe}function w(k,R,B,Oe,Qe){if(0===k.length)return-1;if("string"==typeof B?(Oe=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),ve(B=+B)&&(B=Qe?0:k.length-1),B<0&&(B=k.length+B),B>=k.length){if(Qe)return-1;B=k.length-1}else if(B<0){if(!Qe)return-1;B=0}if("string"==typeof R&&(R=S.from(R,Oe)),S.isBuffer(R))return 0===R.length?-1:z(k,R,B,Oe,Qe);if("number"==typeof R)return R&=255,"function"==typeof Uint8Array.prototype.indexOf?Qe?Uint8Array.prototype.indexOf.call(k,R,B):Uint8Array.prototype.lastIndexOf.call(k,R,B):z(k,[R],B,Oe,Qe);throw new TypeError("val must be string, number or Buffer")}function z(k,R,B,Oe,Qe){var Wn,bt=1,It=k.length,In=R.length;if(void 0!==Oe&&("ucs2"===(Oe=String(Oe).toLowerCase())||"ucs-2"===Oe||"utf16le"===Oe||"utf-16le"===Oe)){if(k.length<2||R.length<2)return-1;bt=2,It/=2,In/=2,B/=2}function Ln(Ns,us){return 1===bt?Ns[us]:Ns.readUInt16BE(us*bt)}if(Qe){var Ei=-1;for(Wn=B;Wn<It;Wn++)if(Ln(k,Wn)===Ln(R,-1===Ei?0:Wn-Ei)){if(-1===Ei&&(Ei=Wn),Wn-Ei+1===In)return Ei*bt}else-1!==Ei&&(Wn-=Wn-Ei),Ei=-1}else for(B+In>It&&(B=It-In),Wn=B;Wn>=0;Wn--){for(var mi=!0,Gr=0;Gr<In;Gr++)if(Ln(k,Wn+Gr)!==Ln(R,Gr)){mi=!1;break}if(mi)return Wn}return-1}function Q(k,R,B,Oe){B=Number(B)||0;var Qe=k.length-B;Oe?(Oe=Number(Oe))>Qe&&(Oe=Qe):Oe=Qe;var bt=R.length;Oe>bt/2&&(Oe=bt/2);for(var It=0;It<Oe;++It){var In=parseInt(R.substr(2*It,2),16);if(ve(In))return It;k[B+It]=In}return It}function se(k,R,B,Oe){return gt(U(R,k.length-B),k,B,Oe)}function oe(k,R,B,Oe){return gt(function(k){for(var R=[],B=0;B<k.length;++B)R.push(255&k.charCodeAt(B));return R}(R),k,B,Oe)}function ee(k,R,B,Oe){return oe(k,R,B,Oe)}function Se(k,R,B,Oe){return gt(ke(R),k,B,Oe)}function pe(k,R,B,Oe){return gt(function(k,R){for(var B,Oe,bt=[],It=0;It<k.length&&!((R-=2)<0);++It)Oe=(B=k.charCodeAt(It))>>8,bt.push(B%256),bt.push(Oe);return bt}(R,k.length-B),k,B,Oe)}function te(k,R,B){return V.fromByteArray(0===R&&B===k.length?k:k.slice(R,B))}function _e(k,R,B){B=Math.min(k.length,B);for(var Oe=[],Qe=R;Qe<B;){var Ln,Wn,Ei,mi,bt=k[Qe],It=null,In=bt>239?4:bt>223?3:bt>191?2:1;if(Qe+In<=B)switch(In){case 1:bt<128&&(It=bt);break;case 2:128==(192&(Ln=k[Qe+1]))&&(mi=(31&bt)<<6|63&Ln)>127&&(It=mi);break;case 3:Wn=k[Qe+2],128==(192&(Ln=k[Qe+1]))&&128==(192&Wn)&&(mi=(15&bt)<<12|(63&Ln)<<6|63&Wn)>2047&&(mi<55296||mi>57343)&&(It=mi);break;case 4:Wn=k[Qe+2],Ei=k[Qe+3],128==(192&(Ln=k[Qe+1]))&&128==(192&Wn)&&128==(192&Ei)&&(mi=(15&bt)<<18|(63&Ln)<<12|(63&Wn)<<6|63&Ei)>65535&&mi<1114112&&(It=mi)}null===It?(It=65533,In=1):It>65535&&(Oe.push((It-=65536)>>>10&1023|55296),It=56320|1023&It),Oe.push(It),Qe+=In}return function(k){var R=k.length;if(R<=4096)return String.fromCharCode.apply(String,k);for(var B="",Oe=0;Oe<R;)B+=String.fromCharCode.apply(String,k.slice(Oe,Oe+=4096));return B}(Oe)}fe.kMaxLength=ie,!(S.TYPED_ARRAY_SUPPORT=function(){try{var k=new Uint8Array(1);return k.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===k.foo()}catch(R){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(S.prototype,"parent",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.buffer}}),Object.defineProperty(S.prototype,"offset",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&S[Symbol.species]===S&&Object.defineProperty(S,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),S.poolSize=8192,S.from=function(k,R,B){return N(k,R,B)},S.prototype.__proto__=Uint8Array.prototype,S.__proto__=Uint8Array,S.alloc=function(k,R,B){return function(k,R,B){return M(k),k<=0?v(k):void 0!==R?"string"==typeof B?v(k).fill(R,B):v(k).fill(R):v(k)}(k,R,B)},S.allocUnsafe=function(k){return y(k)},S.allocUnsafeSlow=function(k){return y(k)},S.isBuffer=function(R){return null!=R&&!0===R._isBuffer&&R!==S.prototype},S.compare=function(R,B){if(ft(R,Uint8Array)&&(R=S.from(R,R.offset,R.byteLength)),ft(B,Uint8Array)&&(B=S.from(B,B.offset,B.byteLength)),!S.isBuffer(R)||!S.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(R===B)return 0;for(var Oe=R.length,Qe=B.length,bt=0,It=Math.min(Oe,Qe);bt<It;++bt)if(R[bt]!==B[bt]){Oe=R[bt],Qe=B[bt];break}return Oe<Qe?-1:Qe<Oe?1:0},S.isEncoding=function(R){switch(String(R).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},S.concat=function(R,B){if(!Array.isArray(R))throw new TypeError('"list" argument must be an Array of Buffers');if(0===R.length)return S.alloc(0);var Oe;if(void 0===B)for(B=0,Oe=0;Oe<R.length;++Oe)B+=R[Oe].length;var Qe=S.allocUnsafe(B),bt=0;for(Oe=0;Oe<R.length;++Oe){var It=R[Oe];if(ft(It,Uint8Array)&&(It=S.from(It)),!S.isBuffer(It))throw new TypeError('"list" argument must be an Array of Buffers');It.copy(Qe,bt),bt+=It.length}return Qe},S.byteLength=D,S.prototype._isBuffer=!0,S.prototype.swap16=function(){var R=this.length;if(R%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<R;B+=2)X(this,B,B+1);return this},S.prototype.swap32=function(){var R=this.length;if(R%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<R;B+=4)X(this,B,B+3),X(this,B+1,B+2);return this},S.prototype.swap64=function(){var R=this.length;if(R%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<R;B+=8)X(this,B,B+7),X(this,B+1,B+6),X(this,B+2,B+5),X(this,B+3,B+4);return this},S.prototype.toLocaleString=S.prototype.toString=function(){var R=this.length;return 0===R?"":0===arguments.length?_e(this,0,R):I.apply(this,arguments)},S.prototype.equals=function(R){if(!S.isBuffer(R))throw new TypeError("Argument must be a Buffer");return this===R||0===S.compare(this,R)},S.prototype.inspect=function(){var R="",B=fe.INSPECT_MAX_BYTES;return R=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(R+=" ... "),"<Buffer "+R+">"},S.prototype.compare=function(R,B,Oe,Qe,bt){if(ft(R,Uint8Array)&&(R=S.from(R,R.offset,R.byteLength)),!S.isBuffer(R))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof R);if(void 0===B&&(B=0),void 0===Oe&&(Oe=R?R.length:0),void 0===Qe&&(Qe=0),void 0===bt&&(bt=this.length),B<0||Oe>R.length||Qe<0||bt>this.length)throw new RangeError("out of range index");if(Qe>=bt&&B>=Oe)return 0;if(Qe>=bt)return-1;if(B>=Oe)return 1;if(this===R)return 0;for(var It=(bt>>>=0)-(Qe>>>=0),In=(Oe>>>=0)-(B>>>=0),Ln=Math.min(It,In),Wn=this.slice(Qe,bt),Ei=R.slice(B,Oe),mi=0;mi<Ln;++mi)if(Wn[mi]!==Ei[mi]){It=Wn[mi],In=Ei[mi];break}return It<In?-1:In<It?1:0},S.prototype.includes=function(R,B,Oe){return-1!==this.indexOf(R,B,Oe)},S.prototype.indexOf=function(R,B,Oe){return w(this,R,B,Oe,!0)},S.prototype.lastIndexOf=function(R,B,Oe){return w(this,R,B,Oe,!1)},S.prototype.write=function(R,B,Oe,Qe){if(void 0===B)Qe="utf8",Oe=this.length,B=0;else if(void 0===Oe&&"string"==typeof B)Qe=B,Oe=this.length,B=0;else{if(!isFinite(B))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");B>>>=0,isFinite(Oe)?(Oe>>>=0,void 0===Qe&&(Qe="utf8")):(Qe=Oe,Oe=void 0)}var bt=this.length-B;if((void 0===Oe||Oe>bt)&&(Oe=bt),R.length>0&&(Oe<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");Qe||(Qe="utf8");for(var It=!1;;)switch(Qe){case"hex":return Q(this,R,B,Oe);case"utf8":case"utf-8":return se(this,R,B,Oe);case"ascii":return oe(this,R,B,Oe);case"latin1":case"binary":return ee(this,R,B,Oe);case"base64":return Se(this,R,B,Oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pe(this,R,B,Oe);default:if(It)throw new TypeError("Unknown encoding: "+Qe);Qe=(""+Qe).toLowerCase(),It=!0}},S.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function rt(k,R,B){var Oe="";B=Math.min(k.length,B);for(var Qe=R;Qe<B;++Qe)Oe+=String.fromCharCode(127&k[Qe]);return Oe}function Xe(k,R,B){var Oe="";B=Math.min(k.length,B);for(var Qe=R;Qe<B;++Qe)Oe+=String.fromCharCode(k[Qe]);return Oe}function Je(k,R,B){var Oe=k.length;(!R||R<0)&&(R=0),(!B||B<0||B>Oe)&&(B=Oe);for(var Qe="",bt=R;bt<B;++bt)Qe+=G(k[bt]);return Qe}function Ke(k,R,B){for(var Oe=k.slice(R,B),Qe="",bt=0;bt<Oe.length;bt+=2)Qe+=String.fromCharCode(Oe[bt]+256*Oe[bt+1]);return Qe}function je(k,R,B){if(k%1!=0||k<0)throw new RangeError("offset is not uint");if(k+R>B)throw new RangeError("Trying to access beyond buffer length")}function Fe(k,R,B,Oe,Qe,bt){if(!S.isBuffer(k))throw new TypeError('"buffer" argument must be a Buffer instance');if(R>Qe||R<bt)throw new RangeError('"value" argument is out of bounds');if(B+Oe>k.length)throw new RangeError("Index out of range")}function Ye(k,R,B,Oe,Qe,bt){if(B+Oe>k.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function Ce(k,R,B,Oe,Qe){return R=+R,B>>>=0,Qe||Ye(k,0,B,4),L.write(k,R,B,Oe,23,4),B+4}function Be(k,R,B,Oe,Qe){return R=+R,B>>>=0,Qe||Ye(k,0,B,8),L.write(k,R,B,Oe,52,8),B+8}S.prototype.slice=function(R,B){var Oe=this.length;(R=~~R)<0?(R+=Oe)<0&&(R=0):R>Oe&&(R=Oe),(B=void 0===B?Oe:~~B)<0?(B+=Oe)<0&&(B=0):B>Oe&&(B=Oe),B<R&&(B=R);var Qe=this.subarray(R,B);return Qe.__proto__=S.prototype,Qe},S.prototype.readUIntLE=function(R,B,Oe){R>>>=0,B>>>=0,Oe||je(R,B,this.length);for(var Qe=this[R],bt=1,It=0;++It<B&&(bt*=256);)Qe+=this[R+It]*bt;return Qe},S.prototype.readUIntBE=function(R,B,Oe){R>>>=0,B>>>=0,Oe||je(R,B,this.length);for(var Qe=this[R+--B],bt=1;B>0&&(bt*=256);)Qe+=this[R+--B]*bt;return Qe},S.prototype.readUInt8=function(R,B){return R>>>=0,B||je(R,1,this.length),this[R]},S.prototype.readUInt16LE=function(R,B){return R>>>=0,B||je(R,2,this.length),this[R]|this[R+1]<<8},S.prototype.readUInt16BE=function(R,B){return R>>>=0,B||je(R,2,this.length),this[R]<<8|this[R+1]},S.prototype.readUInt32LE=function(R,B){return R>>>=0,B||je(R,4,this.length),(this[R]|this[R+1]<<8|this[R+2]<<16)+16777216*this[R+3]},S.prototype.readUInt32BE=function(R,B){return R>>>=0,B||je(R,4,this.length),16777216*this[R]+(this[R+1]<<16|this[R+2]<<8|this[R+3])},S.prototype.readIntLE=function(R,B,Oe){R>>>=0,B>>>=0,Oe||je(R,B,this.length);for(var Qe=this[R],bt=1,It=0;++It<B&&(bt*=256);)Qe+=this[R+It]*bt;return Qe>=(bt*=128)&&(Qe-=Math.pow(2,8*B)),Qe},S.prototype.readIntBE=function(R,B,Oe){R>>>=0,B>>>=0,Oe||je(R,B,this.length);for(var Qe=B,bt=1,It=this[R+--Qe];Qe>0&&(bt*=256);)It+=this[R+--Qe]*bt;return It>=(bt*=128)&&(It-=Math.pow(2,8*B)),It},S.prototype.readInt8=function(R,B){return R>>>=0,B||je(R,1,this.length),128&this[R]?-1*(255-this[R]+1):this[R]},S.prototype.readInt16LE=function(R,B){R>>>=0,B||je(R,2,this.length);var Oe=this[R]|this[R+1]<<8;return 32768&Oe?4294901760|Oe:Oe},S.prototype.readInt16BE=function(R,B){R>>>=0,B||je(R,2,this.length);var Oe=this[R+1]|this[R]<<8;return 32768&Oe?4294901760|Oe:Oe},S.prototype.readInt32LE=function(R,B){return R>>>=0,B||je(R,4,this.length),this[R]|this[R+1]<<8|this[R+2]<<16|this[R+3]<<24},S.prototype.readInt32BE=function(R,B){return R>>>=0,B||je(R,4,this.length),this[R]<<24|this[R+1]<<16|this[R+2]<<8|this[R+3]},S.prototype.readFloatLE=function(R,B){return R>>>=0,B||je(R,4,this.length),L.read(this,R,!0,23,4)},S.prototype.readFloatBE=function(R,B){return R>>>=0,B||je(R,4,this.length),L.read(this,R,!1,23,4)},S.prototype.readDoubleLE=function(R,B){return R>>>=0,B||je(R,8,this.length),L.read(this,R,!0,52,8)},S.prototype.readDoubleBE=function(R,B){return R>>>=0,B||je(R,8,this.length),L.read(this,R,!1,52,8)},S.prototype.writeUIntLE=function(R,B,Oe,Qe){R=+R,B>>>=0,Oe>>>=0,Qe||Fe(this,R,B,Oe,Math.pow(2,8*Oe)-1,0);var It=1,In=0;for(this[B]=255&R;++In<Oe&&(It*=256);)this[B+In]=R/It&255;return B+Oe},S.prototype.writeUIntBE=function(R,B,Oe,Qe){R=+R,B>>>=0,Oe>>>=0,Qe||Fe(this,R,B,Oe,Math.pow(2,8*Oe)-1,0);var It=Oe-1,In=1;for(this[B+It]=255&R;--It>=0&&(In*=256);)this[B+It]=R/In&255;return B+Oe},S.prototype.writeUInt8=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,1,255,0),this[B]=255&R,B+1},S.prototype.writeUInt16LE=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,2,65535,0),this[B]=255&R,this[B+1]=R>>>8,B+2},S.prototype.writeUInt16BE=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,2,65535,0),this[B]=R>>>8,this[B+1]=255&R,B+2},S.prototype.writeUInt32LE=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,4,4294967295,0),this[B+3]=R>>>24,this[B+2]=R>>>16,this[B+1]=R>>>8,this[B]=255&R,B+4},S.prototype.writeUInt32BE=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,4,4294967295,0),this[B]=R>>>24,this[B+1]=R>>>16,this[B+2]=R>>>8,this[B+3]=255&R,B+4},S.prototype.writeIntLE=function(R,B,Oe,Qe){if(R=+R,B>>>=0,!Qe){var bt=Math.pow(2,8*Oe-1);Fe(this,R,B,Oe,bt-1,-bt)}var It=0,In=1,Ln=0;for(this[B]=255&R;++It<Oe&&(In*=256);)R<0&&0===Ln&&0!==this[B+It-1]&&(Ln=1),this[B+It]=(R/In>>0)-Ln&255;return B+Oe},S.prototype.writeIntBE=function(R,B,Oe,Qe){if(R=+R,B>>>=0,!Qe){var bt=Math.pow(2,8*Oe-1);Fe(this,R,B,Oe,bt-1,-bt)}var It=Oe-1,In=1,Ln=0;for(this[B+It]=255&R;--It>=0&&(In*=256);)R<0&&0===Ln&&0!==this[B+It+1]&&(Ln=1),this[B+It]=(R/In>>0)-Ln&255;return B+Oe},S.prototype.writeInt8=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,1,127,-128),R<0&&(R=255+R+1),this[B]=255&R,B+1},S.prototype.writeInt16LE=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,2,32767,-32768),this[B]=255&R,this[B+1]=R>>>8,B+2},S.prototype.writeInt16BE=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,2,32767,-32768),this[B]=R>>>8,this[B+1]=255&R,B+2},S.prototype.writeInt32LE=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,4,2147483647,-2147483648),this[B]=255&R,this[B+1]=R>>>8,this[B+2]=R>>>16,this[B+3]=R>>>24,B+4},S.prototype.writeInt32BE=function(R,B,Oe){return R=+R,B>>>=0,Oe||Fe(this,R,B,4,2147483647,-2147483648),R<0&&(R=4294967295+R+1),this[B]=R>>>24,this[B+1]=R>>>16,this[B+2]=R>>>8,this[B+3]=255&R,B+4},S.prototype.writeFloatLE=function(R,B,Oe){return Ce(this,R,B,!0,Oe)},S.prototype.writeFloatBE=function(R,B,Oe){return Ce(this,R,B,!1,Oe)},S.prototype.writeDoubleLE=function(R,B,Oe){return Be(this,R,B,!0,Oe)},S.prototype.writeDoubleBE=function(R,B,Oe){return Be(this,R,B,!1,Oe)},S.prototype.copy=function(R,B,Oe,Qe){if(!S.isBuffer(R))throw new TypeError("argument should be a Buffer");if(Oe||(Oe=0),!Qe&&0!==Qe&&(Qe=this.length),B>=R.length&&(B=R.length),B||(B=0),Qe>0&&Qe<Oe&&(Qe=Oe),Qe===Oe||0===R.length||0===this.length)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(Oe<0||Oe>=this.length)throw new RangeError("Index out of range");if(Qe<0)throw new RangeError("sourceEnd out of bounds");Qe>this.length&&(Qe=this.length),R.length-B<Qe-Oe&&(Qe=R.length-B+Oe);var bt=Qe-Oe;if(this===R&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(B,Oe,Qe);else if(this===R&&Oe<B&&B<Qe)for(var It=bt-1;It>=0;--It)R[It+B]=this[It+Oe];else Uint8Array.prototype.set.call(R,this.subarray(Oe,Qe),B);return bt},S.prototype.fill=function(R,B,Oe,Qe){if("string"==typeof R){if("string"==typeof B?(Qe=B,B=0,Oe=this.length):"string"==typeof Oe&&(Qe=Oe,Oe=this.length),void 0!==Qe&&"string"!=typeof Qe)throw new TypeError("encoding must be a string");if("string"==typeof Qe&&!S.isEncoding(Qe))throw new TypeError("Unknown encoding: "+Qe);if(1===R.length){var bt=R.charCodeAt(0);("utf8"===Qe&&bt<128||"latin1"===Qe)&&(R=bt)}}else"number"==typeof R&&(R&=255);if(B<0||this.length<B||this.length<Oe)throw new RangeError("Out of range index");if(Oe<=B)return this;var It;if(B>>>=0,Oe=void 0===Oe?this.length:Oe>>>0,R||(R=0),"number"==typeof R)for(It=B;It<Oe;++It)this[It]=R;else{var In=S.isBuffer(R)?R:S.from(R,Qe),Ln=In.length;if(0===Ln)throw new TypeError('The value "'+R+'" is invalid for argument "value"');for(It=0;It<Oe-B;++It)this[It+B]=In[It%Ln]}return this};var $e=/[^+/0-9A-Za-z-_]/g;function G(k){return k<16?"0"+k.toString(16):k.toString(16)}function U(k,R){R=R||1/0;for(var B,Oe=k.length,Qe=null,bt=[],It=0;It<Oe;++It){if((B=k.charCodeAt(It))>55295&&B<57344){if(!Qe){if(B>56319){(R-=3)>-1&&bt.push(239,191,189);continue}if(It+1===Oe){(R-=3)>-1&&bt.push(239,191,189);continue}Qe=B;continue}if(B<56320){(R-=3)>-1&&bt.push(239,191,189),Qe=B;continue}B=65536+(Qe-55296<<10|B-56320)}else Qe&&(R-=3)>-1&&bt.push(239,191,189);if(Qe=null,B<128){if((R-=1)<0)break;bt.push(B)}else if(B<2048){if((R-=2)<0)break;bt.push(B>>6|192,63&B|128)}else if(B<65536){if((R-=3)<0)break;bt.push(B>>12|224,B>>6&63|128,63&B|128)}else{if(!(B<1114112))throw new Error("Invalid code point");if((R-=4)<0)break;bt.push(B>>18|240,B>>12&63|128,B>>6&63|128,63&B|128)}}return bt}function ke(k){return V.toByteArray(function(k){if((k=(k=k.split("=")[0]).trim().replace($e,"")).length<2)return"";for(;k.length%4!=0;)k+="=";return k}(k))}function gt(k,R,B,Oe){for(var Qe=0;Qe<Oe&&!(Qe+B>=R.length||Qe>=k.length);++Qe)R[Qe+B]=k[Qe];return Qe}function ft(k,R){return k instanceof R||null!=k&&null!=k.constructor&&null!=k.constructor.name&&k.constructor.name===R.name}function ve(k){return k!=k}}).call(this)}).call(this,Y("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(Y,Te,fe){"use strict";Te.exports=function K(V){return null===V||"object"!=typeof V||null!=V.toJSON?JSON.stringify(V):Array.isArray(V)?"["+V.reduce((L,ie,$)=>L+(0===$?"":",")+K(void 0===ie||"symbol"==typeof ie?null:ie),"")+"]":"{"+Object.keys(V).sort().reduce((L,ie,$)=>void 0===V[ie]||"symbol"==typeof V[ie]?L:L+(0===L.length?"":",")+K(ie)+":"+K(V[ie]),"")+"}"}},{}],8:[function(Y,Te,fe){"use strict";var L,K="object"==typeof Reflect?Reflect:null,V=K&&"function"==typeof K.apply?K.apply:function(z,Q,se){return Function.prototype.apply.call(z,Q,se)};L=K&&"function"==typeof K.ownKeys?K.ownKeys:Object.getOwnPropertySymbols?function(z){return Object.getOwnPropertyNames(z).concat(Object.getOwnPropertySymbols(z))}:function(z){return Object.getOwnPropertyNames(z)};var $=Number.isNaN||function(z){return z!=z};function v(){v.init.call(this)}Te.exports=v,Te.exports.once=function(w,z){return new Promise(function(Q,se){function oe(Se){w.removeListener(z,ee),se(Se)}function ee(){"function"==typeof w.removeListener&&w.removeListener("error",oe),Q([].slice.call(arguments))}X(w,z,ee,{once:!0}),"error"!==z&&function(w,z,Q){"function"==typeof w.on&&X(w,"error",z,Q)}(w,oe,{once:!0})})},v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var S=10;function N(w){if("function"!=typeof w)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof w)}function M(w){return void 0===w._maxListeners?v.defaultMaxListeners:w._maxListeners}function b(w,z,Q,se){var oe,ee,Se;if(N(Q),void 0===(ee=w._events)?(ee=w._events=Object.create(null),w._eventsCount=0):(void 0!==ee.newListener&&(w.emit("newListener",z,Q.listener?Q.listener:Q),ee=w._events),Se=ee[z]),void 0===Se)Se=ee[z]=Q,++w._eventsCount;else if("function"==typeof Se?Se=ee[z]=se?[Q,Se]:[Se,Q]:se?Se.unshift(Q):Se.push(Q),(oe=M(w))>0&&Se.length>oe&&!Se.warned){Se.warned=!0;var pe=new Error("Possible EventEmitter memory leak detected. "+Se.length+" "+String(z)+" listeners added. Use emitter.setMaxListeners() to increase limit");pe.name="MaxListenersExceededWarning",pe.emitter=w,pe.type=z,pe.count=Se.length,function(w){console&&console.warn&&console.warn(w)}(pe)}return w}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function E(w,z,Q){var se={fired:!1,wrapFn:void 0,target:w,type:z,listener:Q},oe=y.bind(se);return oe.listener=Q,se.wrapFn=oe,oe}function x(w,z,Q){var se=w._events;if(void 0===se)return[];var oe=se[z];return void 0===oe?[]:"function"==typeof oe?Q?[oe.listener||oe]:[oe]:Q?function(w){for(var z=new Array(w.length),Q=0;Q<z.length;++Q)z[Q]=w[Q].listener||w[Q];return z}(oe):O(oe,oe.length)}function j(w){var z=this._events;if(void 0!==z){var Q=z[w];if("function"==typeof Q)return 1;if(void 0!==Q)return Q.length}return 0}function O(w,z){for(var Q=new Array(z),se=0;se<z;++se)Q[se]=w[se];return Q}function X(w,z,Q,se){if("function"==typeof w.on)se.once?w.once(z,Q):w.on(z,Q);else{if("function"!=typeof w.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof w);w.addEventListener(z,function oe(ee){se.once&&w.removeEventListener(z,oe),Q(ee)})}}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return S},set:function(w){if("number"!=typeof w||w<0||$(w))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+w+".");S=w}}),v.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function(z){if("number"!=typeof z||z<0||$(z))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+z+".");return this._maxListeners=z,this},v.prototype.getMaxListeners=function(){return M(this)},v.prototype.emit=function(z){for(var Q=[],se=1;se<arguments.length;se++)Q.push(arguments[se]);var oe="error"===z,ee=this._events;if(void 0!==ee)oe=oe&&void 0===ee.error;else if(!oe)return!1;if(oe){var Se;if(Q.length>0&&(Se=Q[0]),Se instanceof Error)throw Se;var pe=new Error("Unhandled error."+(Se?" ("+Se.message+")":""));throw pe.context=Se,pe}var te=ee[z];if(void 0===te)return!1;if("function"==typeof te)V(te,this,Q);else{var _e=te.length,De=O(te,_e);for(se=0;se<_e;++se)V(De[se],this,Q)}return!0},v.prototype.on=v.prototype.addListener=function(z,Q){return b(this,z,Q,!1)},v.prototype.prependListener=function(z,Q){return b(this,z,Q,!0)},v.prototype.once=function(z,Q){return N(Q),this.on(z,E(this,z,Q)),this},v.prototype.prependOnceListener=function(z,Q){return N(Q),this.prependListener(z,E(this,z,Q)),this},v.prototype.off=v.prototype.removeListener=function(z,Q){var se,oe,ee,Se,pe;if(N(Q),void 0===(oe=this._events))return this;if(void 0===(se=oe[z]))return this;if(se===Q||se.listener===Q)0==--this._eventsCount?this._events=Object.create(null):(delete oe[z],oe.removeListener&&this.emit("removeListener",z,se.listener||Q));else if("function"!=typeof se){for(ee=-1,Se=se.length-1;Se>=0;Se--)if(se[Se]===Q||se[Se].listener===Q){pe=se[Se].listener,ee=Se;break}if(ee<0)return this;0===ee?se.shift():function(w,z){for(;z+1<w.length;z++)w[z]=w[z+1];w.pop()}(se,ee),1===se.length&&(oe[z]=se[0]),void 0!==oe.removeListener&&this.emit("removeListener",z,pe||Q)}return this},v.prototype.removeAllListeners=function(z){var Q,se,oe;if(void 0===(se=this._events))return this;if(void 0===se.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==se[z]&&(0==--this._eventsCount?this._events=Object.create(null):delete se[z]),this;if(0===arguments.length){var Se,ee=Object.keys(se);for(oe=0;oe<ee.length;++oe)"removeListener"!==(Se=ee[oe])&&this.removeAllListeners(Se);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Q=se[z]))this.removeListener(z,Q);else if(void 0!==Q)for(oe=Q.length-1;oe>=0;oe--)this.removeListener(z,Q[oe]);return this},v.prototype.listeners=function(z){return x(this,z,!0)},v.prototype.rawListeners=function(z){return x(this,z,!1)},v.listenerCount=function(w,z){return"function"==typeof w.listenerCount?w.listenerCount(z):j.call(w,z)},v.prototype.listenerCount=j,v.prototype.eventNames=function(){return this._eventsCount>0?L(this._events):[]}},{}],9:[function(Y,Te,fe){fe.read=function(K,V,L,ie,$){var v,S,N=8*$-ie-1,M=(1<<N)-1,b=M>>1,y=-7,E=L?$-1:0,x=L?-1:1,j=K[V+E];for(E+=x,v=j&(1<<-y)-1,j>>=-y,y+=N;y>0;v=256*v+K[V+E],E+=x,y-=8);for(S=v&(1<<-y)-1,v>>=-y,y+=ie;y>0;S=256*S+K[V+E],E+=x,y-=8);if(0===v)v=1-b;else{if(v===M)return S?NaN:1/0*(j?-1:1);S+=Math.pow(2,ie),v-=b}return(j?-1:1)*S*Math.pow(2,v-ie)},fe.write=function(K,V,L,ie,$,v){var S,N,M,b=8*v-$-1,y=(1<<b)-1,E=y>>1,x=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,j=ie?0:v-1,O=ie?1:-1,q=V<0||0===V&&1/V<0?1:0;for(V=Math.abs(V),isNaN(V)||V===1/0?(N=isNaN(V)?1:0,S=y):(S=Math.floor(Math.log(V)/Math.LN2),V*(M=Math.pow(2,-S))<1&&(S--,M*=2),(V+=S+E>=1?x/M:x*Math.pow(2,1-E))*M>=2&&(S++,M/=2),S+E>=y?(N=0,S=y):S+E>=1?(N=(V*M-1)*Math.pow(2,$),S+=E):(N=V*Math.pow(2,E-1)*Math.pow(2,$),S=0));$>=8;K[L+j]=255&N,j+=O,N/=256,$-=8);for(S=S<<$|N,b+=$;b>0;K[L+j]=255&S,j+=O,S/=256,b-=8);K[L+j-O]|=128*q}},{}],10:[function(Y,Te,fe){Te.exports="function"==typeof Object.create?function(V,L){L&&(V.super_=L,V.prototype=Object.create(L.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}))}:function(V,L){if(L){V.super_=L;var ie=function(){};ie.prototype=L.prototype,V.prototype=new ie,V.prototype.constructor=V}}},{}],11:[function(Y,Te,fe){"use strict";const{isArray:K,isObject:V,isString:L}=Y("./types"),{asArray:ie}=Y("./util"),{prependBase:$}=Y("./url"),v=Y("./JsonLdError"),S=Y("./ResolvedContext");function M(y){throw new v("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function b({context:y,base:E}){if(!y)return;const x=y["@context"];if(L(x))y["@context"]=$(E,x);else if(K(x))for(let j=0;j<x.length;++j){const O=x[j];L(O)?x[j]=$(E,O):V(O)&&b({context:{"@context":O},base:E})}else if(V(x))for(const j in x)b({context:x[j],base:E})}Te.exports=class{constructor({sharedCache:E}){this.perOpCache=new Map,this.sharedCache=E}resolve({activeCtx:E,context:x,documentLoader:j,base:O,cycles:q=new Set}){var ce=this;return mt(function*(){x&&V(x)&&x["@context"]&&(x=x["@context"]),x=ie(x);const D=[];for(const I of x){if(L(I)){let z=ce._get(I);z||(z=yield ce._resolveRemoteContext({activeCtx:E,url:I,documentLoader:j,base:O,cycles:q})),K(z)?D.push(...z):D.push(z);continue}if(null===I){D.push(new S({document:null}));continue}V(I)||M(x);const X=JSON.stringify(I);let w=ce._get(X);w||(w=new S({document:I}),ce._cacheResolvedContext({key:X,resolved:w,tag:"static"})),D.push(w)}return D})()}_get(E){let x=this.perOpCache.get(E);if(!x){const j=this.sharedCache.get(E);j&&(x=j.get("static"),x&&this.perOpCache.set(E,x))}return x}_cacheResolvedContext({key:E,resolved:x,tag:j}){if(this.perOpCache.set(E,x),void 0!==j){let O=this.sharedCache.get(E);O||(O=new Map,this.sharedCache.set(E,O)),O.set(j,x)}return x}_resolveRemoteContext({activeCtx:E,url:x,documentLoader:j,base:O,cycles:q}){var ce=this;return mt(function*(){x=$(O,x);const{context:D,remoteDoc:I}=yield ce._fetchContext({activeCtx:E,url:x,documentLoader:j,cycles:q});b({context:D,base:O=I.documentUrl||x});const X=yield ce.resolve({activeCtx:E,context:D,documentLoader:j,base:O,cycles:q});return ce._cacheResolvedContext({key:x,resolved:X,tag:I.tag}),X})()}_fetchContext({activeCtx:E,url:x,documentLoader:j,cycles:O}){return mt(function*(){if(O.size>10)throw new v("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===E.processingMode?"loading remote context failed":"context overflow",max:10});if(O.has(x))throw new v("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===E.processingMode?"recursive context inclusion":"context overflow",url:x});let q,ce;O.add(x);try{ce=yield j(x),q=ce.document||null,L(q)&&(q=JSON.parse(q))}catch(D){throw new v("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:x,cause:D})}if(!V(q))throw new v("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:x});return q="@context"in q?{"@context":q["@context"]}:{"@context":{}},ce.contextUrl&&(K(q["@context"])||(q["@context"]=[q["@context"]]),q["@context"].push(ce.contextUrl)),{context:q,remoteDoc:ce}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(Y,Te,fe){"use strict";Te.exports=class extends Error{constructor(V="An unspecified JSON-LD error occurred.",L="jsonld.Error",ie={}){super(V),this.name=L,this.message=V,this.details=ie}}},{}],13:[function(Y,Te,fe){"use strict";Te.exports=K=>{class V{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(V,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(V.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:V}),V.compact=function(L,ie){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):K.compact(L,ie)},V.expand=function(L){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):K.expand(L)},V.flatten=function(L){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):K.flatten(L)},V}},{}],14:[function(Y,Te,fe){"use strict";Te.exports=Y("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(Y,Te,fe){"use strict";Te.exports=class{constructor(){this._requests={}}wrapLoader(V){const L=this;return L._loader=V,function(){return L.add.apply(L,arguments)}}add(V){var L=this;return mt(function*(){let ie=L._requests[V];if(ie)return Promise.resolve(ie);ie=L._requests[V]=L._loader(V);try{return yield ie}finally{delete L._requests[V]}})()}}},{}],16:[function(Y,Te,fe){"use strict";const K=Y("lru-cache");Te.exports=class{constructor({document:ie}){this.document=ie,this.cache=new K({max:10})}getProcessed(ie){return this.cache.get(ie)}setProcessed(ie,$){this.cache.set(ie,$)}}},{"lru-cache":33}],17:[function(Y,Te,fe){"use strict";const K=Y("./JsonLdError"),{isArray:V,isObject:L,isString:ie,isUndefined:$}=Y("./types"),{isList:v,isValue:S,isGraph:N,isSimpleGraph:M,isSubjectReference:b}=Y("./graphTypes"),{expandIri:y,getContextValue:E,isKeyword:x,process:j,processingMode:O}=Y("./context"),{removeBase:q,prependBase:ce}=Y("./url"),{addValue:D,asArray:I,compareShortestLeast:X}=Y("./util"),w={};function Q(se,oe,ee){if("@nest"!==y(se,oe,{vocab:!0},ee))throw new K("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}Te.exports=w,w.compact=function(){var se=mt(function*({activeCtx:oe,activeProperty:ee=null,element:Se,options:pe={},compactionMap:te=(()=>{})}){if(V(Se)){let De=[];for(let He=0;He<Se.length;++He){let rt=yield w.compact({activeCtx:oe,activeProperty:ee,element:Se[He],options:pe,compactionMap:te});null===rt&&(rt=yield te({unmappedValue:Se[He],activeCtx:oe,activeProperty:ee,parent:Se,index:He,options:pe}),void 0===rt)||De.push(rt)}return pe.compactArrays&&1===De.length&&0===(E(oe,ee,"@container")||[]).length&&(De=De[0]),De}const _e=E(oe,ee,"@context");if($(_e)||(oe=yield j({activeCtx:oe,localCtx:_e,propagate:!0,overrideProtected:!0,options:pe})),L(Se)){if(pe.link&&"@id"in Se&&pe.link.hasOwnProperty(Se["@id"])){const Fe=pe.link[Se["@id"]];for(let Ye=0;Ye<Fe.length;++Ye)if(Fe[Ye].expanded===Se)return Fe[Ye].compacted}if(S(Se)||b(Se)){const Fe=w.compactValue({activeCtx:oe,activeProperty:ee,value:Se,options:pe});return pe.link&&b(Se)&&(pe.link.hasOwnProperty(Se["@id"])||(pe.link[Se["@id"]]=[]),pe.link[Se["@id"]].push({expanded:Se,compacted:Fe})),Fe}if(v(Se)&&(E(oe,ee,"@container")||[]).includes("@list"))return w.compact({activeCtx:oe,activeProperty:ee,element:Se["@list"],options:pe,compactionMap:te});const De="@reverse"===ee,He={},rt=oe;!S(Se)&&!b(Se)&&(oe=oe.revertToPreviousContext());const Xe=E(rt,ee,"@context");$(Xe)||(oe=yield j({activeCtx:oe,localCtx:Xe,propagate:!0,overrideProtected:!0,options:pe})),pe.link&&"@id"in Se&&(pe.link.hasOwnProperty(Se["@id"])||(pe.link[Se["@id"]]=[]),pe.link[Se["@id"]].push({expanded:Se,compacted:He}));let Je=Se["@type"]||[];Je.length>1&&(Je=Array.from(Je).sort());const Ke=oe;for(const Fe of Je){const Ye=w.compactIri({activeCtx:Ke,iri:Fe,relativeTo:{vocab:!0}}),Ce=E(rt,Ye,"@context");$(Ce)||(oe=yield j({activeCtx:oe,localCtx:Ce,options:pe,propagate:!1}))}const je=Object.keys(Se).sort();for(const Fe of je){const Ye=Se[Fe];if("@id"!==Fe)if("@type"!==Fe)if("@reverse"!==Fe)if("@preserve"!==Fe)if("@index"!==Fe)if("@graph"!==Fe&&"@list"!==Fe&&"@included"!==Fe&&x(Fe)){const Ce=w.compactIri({activeCtx:oe,iri:Fe,relativeTo:{vocab:!0}});D(He,Ce,Ye)}else{if(!V(Ye))throw new K("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Ye.length){const Ce=w.compactIri({activeCtx:oe,iri:Fe,value:Ye,relativeTo:{vocab:!0},reverse:De}),Be=oe.mappings.has(Ce)?oe.mappings.get(Ce)["@nest"]:null;let $e=He;Be&&(Q(oe,Be,pe),L(He[Be])||(He[Be]={}),$e=He[Be]),D($e,Ce,Ye,{propertyIsArray:!0})}for(const Ce of Ye){const Be=w.compactIri({activeCtx:oe,iri:Fe,value:Ce,relativeTo:{vocab:!0},reverse:De}),$e=oe.mappings.has(Be)?oe.mappings.get(Be)["@nest"]:null;let Ne=He;$e&&(Q(oe,$e,pe),L(He[$e])||(He[$e]={}),Ne=He[$e]);const G=E(oe,Be,"@container")||[],U=N(Ce),he=v(Ce);let ue;he?ue=Ce["@list"]:U&&(ue=Ce["@graph"]);let ke=yield w.compact({activeCtx:oe,activeProperty:Be,element:he||U?ue:Ce,options:pe,compactionMap:te});if(he){if(V(ke)||(ke=[ke]),G.includes("@list")){D(Ne,Be,ke,{valueIsArray:!0,allowDuplicate:!0});continue}ke={[w.compactIri({activeCtx:oe,iri:"@list",relativeTo:{vocab:!0}})]:ke},"@index"in Ce&&(ke[w.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=Ce["@index"])}if(U)if(G.includes("@graph")&&(G.includes("@id")||G.includes("@index")&&M(Ce))){let gt;Ne.hasOwnProperty(Be)?gt=Ne[Be]:Ne[Be]=gt={};const ft=(G.includes("@id")?Ce["@id"]:Ce["@index"])||w.compactIri({activeCtx:oe,iri:"@none",relativeTo:{vocab:!0}});D(gt,ft,ke,{propertyIsArray:!pe.compactArrays||G.includes("@set")})}else G.includes("@graph")&&M(Ce)?(V(ke)&&ke.length>1&&(ke={"@included":ke}),D(Ne,Be,ke,{propertyIsArray:!pe.compactArrays||G.includes("@set")})):(V(ke)&&1===ke.length&&pe.compactArrays&&(ke=ke[0]),ke={[w.compactIri({activeCtx:oe,iri:"@graph",relativeTo:{vocab:!0}})]:ke},"@id"in Ce&&(ke[w.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]=Ce["@id"]),"@index"in Ce&&(ke[w.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=Ce["@index"]),D(Ne,Be,ke,{propertyIsArray:!pe.compactArrays||G.includes("@set")}));else if(G.includes("@language")||G.includes("@index")||G.includes("@id")||G.includes("@type")){let gt,ft;if(Ne.hasOwnProperty(Be)?gt=Ne[Be]:Ne[Be]=gt={},G.includes("@language"))S(ke)&&(ke=ke["@value"]),ft=Ce["@language"];else if(G.includes("@index")){const ve=E(oe,Be,"@index")||"@index",k=w.compactIri({activeCtx:oe,iri:ve,relativeTo:{vocab:!0}});if("@index"===ve)ft=Ce["@index"],delete ke[k];else{let R;if([ft,...R]=I(ke[ve]||[]),ie(ft))switch(R.length){case 0:delete ke[ve];break;case 1:ke[ve]=R[0];break;default:ke[ve]=R}else ft=null}}else if(G.includes("@id")){const ve=w.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}});ft=ke[ve],delete ke[ve]}else if(G.includes("@type")){const ve=w.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}});let k;switch([ft,...k]=I(ke[ve]||[]),k.length){case 0:delete ke[ve];break;case 1:ke[ve]=k[0];break;default:ke[ve]=k}1===Object.keys(ke).length&&"@id"in Ce&&(ke=yield w.compact({activeCtx:oe,activeProperty:Be,element:{"@id":Ce["@id"]},options:pe,compactionMap:te}))}ft||(ft=w.compactIri({activeCtx:oe,iri:"@none",relativeTo:{vocab:!0}})),D(gt,ft,ke,{propertyIsArray:G.includes("@set")})}else{const gt=!pe.compactArrays||G.includes("@set")||G.includes("@list")||V(ke)&&0===ke.length||"@list"===Fe||"@graph"===Fe;D(Ne,Be,ke,{propertyIsArray:gt})}}}else{if((E(oe,ee,"@container")||[]).includes("@index"))continue;const Be=w.compactIri({activeCtx:oe,iri:Fe,relativeTo:{vocab:!0}});D(He,Be,Ye)}else{const Ce=yield w.compact({activeCtx:oe,activeProperty:ee,element:Ye,options:pe,compactionMap:te});V(Ce)&&0===Ce.length||D(He,Fe,Ce)}else{const Ce=yield w.compact({activeCtx:oe,activeProperty:"@reverse",element:Ye,options:pe,compactionMap:te});for(const Be in Ce)if(oe.mappings.has(Be)&&oe.mappings.get(Be).reverse){const $e=Ce[Be],G=(E(oe,Be,"@container")||[]).includes("@set")||!pe.compactArrays;D(He,Be,$e,{propertyIsArray:G}),delete Ce[Be]}if(Object.keys(Ce).length>0){const Be=w.compactIri({activeCtx:oe,iri:Fe,relativeTo:{vocab:!0}});D(He,Be,Ce)}}else{let Ce=I(Ye).map(U=>w.compactIri({activeCtx:rt,iri:U,relativeTo:{vocab:!0}}));1===Ce.length&&(Ce=Ce[0]);const Be=w.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}}),G=(E(oe,Be,"@container")||[]).includes("@set")&&O(oe,1.1)||V(Ce)&&0===Ye.length;D(He,Be,Ce,{propertyIsArray:G})}else{let Ce=I(Ye).map($e=>w.compactIri({activeCtx:oe,iri:$e,relativeTo:{vocab:!1},base:pe.base}));1===Ce.length&&(Ce=Ce[0]),He[w.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]=Ce}}return He}return Se});return function(oe){return se.apply(this,arguments)}}(),w.compactIri=({activeCtx:se,iri:oe,value:ee=null,relativeTo:Se={vocab:!1},reverse:pe=!1,base:te=null})=>{if(null===oe)return oe;se.isPropertyTermScoped&&se.previousContext&&(se=se.previousContext);const _e=se.getInverse();if(x(oe)&&oe in _e&&"@none"in _e[oe]&&"@type"in _e[oe]["@none"]&&"@none"in _e[oe]["@none"]["@type"])return _e[oe]["@none"]["@type"]["@none"];if(Se.vocab&&oe in _e){const Je=se["@language"]||"@none",Ke=[];L(ee)&&"@index"in ee&&!("@graph"in ee)&&Ke.push("@index","@index@set"),L(ee)&&"@preserve"in ee&&(ee=ee["@preserve"][0]),N(ee)?("@index"in ee&&Ke.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in ee&&Ke.push("@graph@id","@graph@id@set"),Ke.push("@graph","@graph@set","@set"),"@index"in ee||Ke.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in ee||Ke.push("@graph@id","@graph@id@set")):L(ee)&&!S(ee)&&Ke.push("@id","@id@set","@type","@set@type");let je="@language",Fe="@null";if(pe)je="@type",Fe="@reverse",Ke.push("@set");else if(v(ee)){"@index"in ee||Ke.push("@list");const Ce=ee["@list"];if(0===Ce.length)je="@any",Fe="@none";else{let Be=0===Ce.length?Je:null,$e=null;for(let Ne=0;Ne<Ce.length;++Ne){const G=Ce[Ne];let U="@none",he="@none";if(S(G)?"@direction"in G?U=`${(G["@language"]||"").toLowerCase()}_${G["@direction"]}`:"@language"in G?U=G["@language"].toLowerCase():"@type"in G?he=G["@type"]:U="@null":he="@id",null===Be?Be=U:U!==Be&&S(G)&&(Be="@none"),null===$e?$e=he:he!==$e&&($e="@none"),"@none"===Be&&"@none"===$e)break}Be=Be||"@none",$e=$e||"@none","@none"!==$e?(je="@type",Fe=$e):Fe=Be}}else{if(S(ee))if("@language"in ee&&!("@index"in ee)){Ke.push("@language","@language@set"),Fe=ee["@language"];const Ce=ee["@direction"];Ce&&(Fe=`${Fe}_${Ce}`)}else"@direction"in ee&&!("@index"in ee)?Fe=`_${ee["@direction"]}`:"@type"in ee&&(je="@type",Fe=ee["@type"]);else je="@type",Fe="@id";Ke.push("@set")}Ke.push("@none"),L(ee)&&!("@index"in ee)&&Ke.push("@index","@index@set"),S(ee)&&1===Object.keys(ee).length&&Ke.push("@language","@language@set");const Ye=function(se,oe,ee,Se,pe,te){null===te&&(te="@null");const _e=[];if(("@id"===te||"@reverse"===te)&&L(ee)&&"@id"in ee){"@reverse"===te&&_e.push("@reverse");const He=w.compactIri({activeCtx:se,iri:ee["@id"],relativeTo:{vocab:!0}});se.mappings.has(He)&&se.mappings.get(He)&&se.mappings.get(He)["@id"]===ee["@id"]?_e.push.apply(_e,["@vocab","@id"]):_e.push.apply(_e,["@id","@vocab"])}else{_e.push(te);const He=_e.find(rt=>rt.includes("_"));He&&_e.push(He.replace(/^[^_]+_/,"_"))}_e.push("@none");const De=se.inverse[oe];for(const He of Se){if(!(He in De))continue;const rt=De[He][pe];for(const Xe of _e)if(Xe in rt)return rt[Xe]}return null}(se,oe,ee,Ke,je,Fe);if(null!==Ye)return Ye}if(Se.vocab&&"@vocab"in se){const Je=se["@vocab"];if(0===oe.indexOf(Je)&&oe!==Je){const Ke=oe.substr(Je.length);if(!se.mappings.has(Ke))return Ke}}let De=null;const He=[];let rt=se.fastCurieMap;const Xe=oe.length-1;for(let Je=0;Je<Xe&&oe[Je]in rt;++Je)rt=rt[oe[Je]],""in rt&&He.push(rt[""][0]);for(let Je=He.length-1;Je>=0;--Je){const Ke=He[Je],je=Ke.terms;for(const Fe of je){const Ye=Fe+":"+oe.substr(Ke.iri.length);se.mappings.get(Fe)._prefix&&(!se.mappings.has(Ye)||null===ee&&se.mappings.get(Ye)["@id"]===oe)&&(null===De||X(Ye,De)<0)&&(De=Ye)}}if(null!==De)return De;for(const[Je,Ke]of se.mappings)if(Ke&&Ke._prefix&&oe.startsWith(Je+":"))throw new K(`Absolute IRI "${oe}" confused with prefix "${Je}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:se});return Se.vocab?oe:"@base"in se?se["@base"]?q(ce(te,se["@base"]),oe):oe:q(te,oe)},w.compactValue=({activeCtx:se,activeProperty:oe,value:ee,options:Se})=>{if(S(ee)){const De=E(se,oe,"@type"),He=E(se,oe,"@language"),rt=E(se,oe,"@direction"),Xe=E(se,oe,"@container")||[],Je="@index"in ee&&!Xe.includes("@index");if(!Je&&"@none"!==De&&(ee["@type"]===De||"@language"in ee&&ee["@language"]===He&&"@direction"in ee&&ee["@direction"]===rt||"@language"in ee&&ee["@language"]===He||"@direction"in ee&&ee["@direction"]===rt))return ee["@value"];const Ke=Object.keys(ee).length,je=1===Ke||2===Ke&&"@index"in ee&&!Je,Fe="@language"in se,Ye=ie(ee["@value"]),Ce=se.mappings.has(oe)&&null===se.mappings.get(oe)["@language"];if(je&&"@none"!==De&&(!Fe||!Ye||Ce))return ee["@value"];const Be={};return Je&&(Be[w.compactIri({activeCtx:se,iri:"@index",relativeTo:{vocab:!0}})]=ee["@index"]),"@type"in ee?Be[w.compactIri({activeCtx:se,iri:"@type",relativeTo:{vocab:!0}})]=w.compactIri({activeCtx:se,iri:ee["@type"],relativeTo:{vocab:!0}}):"@language"in ee&&(Be[w.compactIri({activeCtx:se,iri:"@language",relativeTo:{vocab:!0}})]=ee["@language"]),"@direction"in ee&&(Be[w.compactIri({activeCtx:se,iri:"@direction",relativeTo:{vocab:!0}})]=ee["@direction"]),Be[w.compactIri({activeCtx:se,iri:"@value",relativeTo:{vocab:!0}})]=ee["@value"],Be}const pe=y(se,oe,{vocab:!0},Se),te=E(se,oe,"@type"),_e=w.compactIri({activeCtx:se,iri:ee["@id"],relativeTo:{vocab:"@vocab"===te},base:Se.base});return"@id"===te||"@vocab"===te||"@graph"===pe?_e:{[w.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}})]:_e}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(Y,Te,fe){"use strict";const K="http://www.w3.org/1999/02/22-rdf-syntax-ns#",V="http://www.w3.org/2001/XMLSchema#";Te.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:K,RDF_LIST:K+"List",RDF_FIRST:K+"first",RDF_REST:K+"rest",RDF_NIL:K+"nil",RDF_TYPE:K+"type",RDF_PLAIN_LITERAL:K+"PlainLiteral",RDF_XML_LITERAL:K+"XMLLiteral",RDF_JSON_LITERAL:K+"JSON",RDF_OBJECT:K+"object",RDF_LANGSTRING:K+"langString",XSD:V,XSD_BOOLEAN:V+"boolean",XSD_DOUBLE:V+"double",XSD_INTEGER:V+"integer",XSD_STRING:V+"string"}},{}],19:[function(Y,Te,fe){"use strict";const K=Y("./util"),V=Y("./JsonLdError"),{isArray:L,isObject:ie,isString:$,isUndefined:v}=Y("./types"),{isAbsolute:S,isRelative:N,prependBase:M}=Y("./url"),{asArray:b,compareShortestLeast:y}=Y("./util"),E=new Map,j=/^@[a-zA-Z]+$/,O={};function q(D,I,X,w,z,Q){if(null===I||!$(I)||O.isKeyword(I))return I;if(I.match(j))return null;if(w&&w.hasOwnProperty(I)&&!0!==z.get(I)&&O.createTermDefinition({activeCtx:D,localCtx:w,term:I,defined:z,options:Q}),(X=X||{}).vocab){const oe=D.mappings.get(I);if(null===oe)return null;if(ie(oe)&&"@id"in oe)return oe["@id"]}const se=I.indexOf(":");if(se>0){const oe=I.substr(0,se),ee=I.substr(se+1);if("_"===oe||0===ee.indexOf("//"))return I;w&&w.hasOwnProperty(oe)&&O.createTermDefinition({activeCtx:D,localCtx:w,term:oe,defined:z,options:Q});const Se=D.mappings.get(oe);if(Se&&Se._prefix)return Se["@id"]+ee;if(S(I))return I}if(X.vocab&&"@vocab"in D)return D["@vocab"]+I;if(X.base&&"@base"in D){if(D["@base"])return M(M(Q.base,D["@base"]),I)}else if(X.base)return M(Q.base,I);return I}function ce(D,I){if(!D||"object"!=typeof D||!I||"object"!=typeof I)return D===I;const X=Array.isArray(D);if(X!==Array.isArray(I))return!1;if(X){if(D.length!==I.length)return!1;for(let Q=0;Q<D.length;++Q)if(!ce(D[Q],I[Q]))return!1;return!0}const w=Object.keys(D),z=Object.keys(I);if(w.length!==z.length)return!1;for(const Q in D){let se=D[Q],oe=I[Q];if("@container"===Q&&Array.isArray(se)&&Array.isArray(oe)&&(se=se.slice().sort(),oe=oe.slice().sort()),!ce(se,oe))return!1}return!0}Te.exports=O,O.process=function(){var D=mt(function*({activeCtx:I,localCtx:X,options:w,propagate:z=!0,overrideProtected:Q=!1,cycles:se=new Set}){if(ie(X)&&"@context"in X&&L(X["@context"])&&(X=X["@context"]),0===b(X).length)return I;const ee=yield w.contextResolver.resolve({activeCtx:I,context:X,documentLoader:w.documentLoader,base:w.base});ie(ee[0].document)&&"boolean"==typeof ee[0].document["@propagate"]&&(z=ee[0].document["@propagate"]);let Se=I;!z&&!Se.previousContext&&(Se=Se.clone(),Se.previousContext=I);for(const pe of ee){let{document:te}=pe;if(I=Se,null===te){if(!Q&&0!==Object.keys(I.protected).length){const He=w&&w.protectedMode||"error";if("error"===He)throw new V("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===He){console.warn("WARNING: invalid context nullification");const rt=pe.getProcessed(I);if(rt){Se=I=rt;continue}const Xe=I;Se=I=O.getInitialContext(w).clone();for(const[Je,Ke]of Object.entries(Xe.protected))Ke&&(I.mappings[Je]=K.clone(Xe.mappings[Je]));I.protected=K.clone(Xe.protected),pe.setProcessed(Xe,Se);continue}throw new V("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:X,protectedMode:He})}Se=I=O.getInitialContext(w).clone();continue}const _e=pe.getProcessed(I);if(_e){Se=I=_e;continue}if(ie(te)&&"@context"in te&&(te=te["@context"]),!ie(te))throw new V("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:te});Se=Se.clone();const De=new Map;if("@version"in te){if(1.1!==te["@version"])throw new V("Unsupported JSON-LD version: "+te["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:te});if(I.processingMode&&"json-ld-1.0"===I.processingMode)throw new V("@version: "+te["@version"]+" not compatible with "+I.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:te});Se.processingMode="json-ld-1.1",Se["@version"]=te["@version"],De.set("@version",!0)}if(Se.processingMode=Se.processingMode||I.processingMode,"@base"in te){let He=te["@base"];if(null!==He&&!S(He)){if(!N(He))throw new V('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:te});He=M(Se["@base"],He)}Se["@base"]=He,De.set("@base",!0)}if("@vocab"in te){const He=te["@vocab"];if(null===He)delete Se["@vocab"];else{if(!$(He))throw new V('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});if(!S(He)&&O.processingMode(Se,1))throw new V('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});Se["@vocab"]=q(Se,He,{vocab:!0,base:!0},void 0,void 0,w)}De.set("@vocab",!0)}if("@language"in te){const He=te["@language"];if(null===He)delete Se["@language"];else{if(!$(He))throw new V('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:te});Se["@language"]=He.toLowerCase()}De.set("@language",!0)}if("@direction"in te){const He=te["@direction"];if("json-ld-1.0"===I.processingMode)throw new V("Invalid JSON-LD syntax; @direction not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:te});if(null===He)delete Se["@direction"];else{if("ltr"!==He&&"rtl"!==He)throw new V('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:te});Se["@direction"]=He}De.set("@direction",!0)}if("@propagate"in te){const He=te["@propagate"];if("json-ld-1.0"===I.processingMode)throw new V("Invalid JSON-LD syntax; @propagate not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if("boolean"!=typeof He)throw new V("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:X});De.set("@propagate",!0)}if("@import"in te){const He=te["@import"];if("json-ld-1.0"===I.processingMode)throw new V("Invalid JSON-LD syntax; @import not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if(!$(He))throw new V("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:X});const rt=yield w.contextResolver.resolve({activeCtx:I,context:He,documentLoader:w.documentLoader,base:w.base});if(1!==rt.length)throw new V("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:X});const Xe=rt[0].getProcessed(I);if(Xe)te=Xe;else{const Je=rt[0].document;if("@import"in Je)throw new V("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:X});for(const Ke in Je)te.hasOwnProperty(Ke)||(te[Ke]=Je[Ke]);rt[0].setProcessed(I,te)}De.set("@import",!0)}De.set("@protected",te["@protected"]||!1);for(const He in te)if(O.createTermDefinition({activeCtx:Se,localCtx:te,term:He,defined:De,options:w,overrideProtected:Q}),ie(te[He])&&"@context"in te[He]){const rt=te[He]["@context"];let Xe=!0;if($(rt)){const Je=M(w.base,rt);se.has(Je)?Xe=!1:se.add(Je)}if(Xe)try{yield O.process({activeCtx:Se.clone(),localCtx:te[He]["@context"],overrideProtected:!0,options:w,cycles:se})}catch(Je){throw new V("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:te[He]["@context"],term:He})}}pe.setProcessed(I,Se)}return Se});return function(I){return D.apply(this,arguments)}}(),O.createTermDefinition=({activeCtx:D,localCtx:I,term:X,defined:w,options:z,overrideProtected:Q=!1})=>{if(w.has(X)){if(w.get(X))return;throw new V("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:I,term:X})}let se;if(w.set(X,!1),I.hasOwnProperty(X)&&(se=I[X]),"@type"===X&&ie(se)&&"@set"===(se["@container"]||"@set")&&O.processingMode(D,1.1)){const De=["@container","@id","@protected"],He=Object.keys(se);if(0===He.length||He.some(rt=>!De.includes(rt)))throw new V("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:I,term:X})}else{if(O.isKeyword(X))throw new V("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:I,term:X});if(X.match(j))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:X});if(""===X)throw new V("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:I})}const oe=D.mappings.get(X);D.mappings.has(X)&&D.mappings.delete(X);let ee=!1;if(($(se)||null===se)&&(ee=!0,se={"@id":se}),!ie(se))throw new V("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:I});const Se={};D.mappings.set(X,Se),Se.reverse=!1;const pe=["@container","@id","@language","@reverse","@type"];O.processingMode(D,1.1)&&pe.push("@context","@direction","@index","@nest","@prefix","@protected");for(const De in se)if(!pe.includes(De))throw new V("Invalid JSON-LD syntax; a term definition must not contain "+De,"jsonld.SyntaxError",{code:"invalid term definition",context:I});const te=X.indexOf(":");if(Se._termHasColon=te>0,"@reverse"in se){if("@id"in se)throw new V("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});if("@nest"in se)throw new V("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});const De=se["@reverse"];if(!$(De))throw new V("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(!O.isKeyword(De)&&De.match(j))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:De}),void(oe?D.mappings.set(X,oe):D.mappings.delete(X));const He=q(D,De,{vocab:!0,base:!1},I,w,z);if(!S(He))throw new V("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});Se["@id"]=He,Se.reverse=!0}else if("@id"in se){let De=se["@id"];if(De&&!$(De))throw new V("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(null===De)Se["@id"]=null;else{if(!O.isKeyword(De)&&De.match(j))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:De}),void(oe?D.mappings.set(X,oe):D.mappings.delete(X));if(De!==X){if(De=q(D,De,{vocab:!0,base:!1},I,w,z),!S(De)&&!O.isKeyword(De))throw new V("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(X.match(/(?::[^:])|\//)&&q(D,X,{vocab:!0,base:!1},I,new Map(w).set(X,!0),z)!==De)throw new V("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});Se["@id"]=De,Se._prefix=ee&&!Se._termHasColon&&De.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in Se))if(Se._termHasColon){const De=X.substr(0,te);if(I.hasOwnProperty(De)&&O.createTermDefinition({activeCtx:D,localCtx:I,term:De,defined:w,options:z}),D.mappings.has(De)){const He=X.substr(te+1);Se["@id"]=D.mappings.get(De)["@id"]+He}else Se["@id"]=X}else if("@type"===X)Se["@id"]=X;else{if(!("@vocab"in D))throw new V("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I,term:X});Se["@id"]=D["@vocab"]+X}if((!0===se["@protected"]||!0===w.get("@protected")&&!1!==se["@protected"])&&(D.protected[X]=!0,Se.protected=!0),w.set(X,!0),"@type"in se){let De=se["@type"];if(!$(De))throw new V("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:I});if("@json"===De||"@none"===De){if(O.processingMode(D,1))throw new V(`Invalid JSON-LD syntax; an @context @type value must not be "${De}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:I})}else if("@id"!==De&&"@vocab"!==De){if(De=q(D,De,{vocab:!0,base:!1},I,w,z),!S(De))throw new V("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:I});if(0===De.indexOf("_:"))throw new V("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:I})}Se["@type"]=De}if("@container"in se){const De=$(se["@container"])?[se["@container"]]:se["@container"]||[],He=["@list","@set","@index","@language"];let rt=!0;const Xe=De.includes("@set");if(O.processingMode(D,1.1)){if(He.push("@graph","@id","@type"),De.includes("@list")){if(1!==De.length)throw new V("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:I})}else if(De.includes("@graph")){if(De.some(Je=>"@graph"!==Je&&"@id"!==Je&&"@index"!==Je&&"@set"!==Je))throw new V("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:I})}else rt&=De.length<=(Xe?2:1);if(De.includes("@type")&&(Se["@type"]=Se["@type"]||"@id",!["@id","@vocab"].includes(Se["@type"])))throw new V("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:I})}else rt&=!L(se["@container"]),rt&=De.length<=1;if(rt&=De.every(Je=>He.includes(Je)),rt&=!(Xe&&De.includes("@list")),!rt)throw new V("Invalid JSON-LD syntax; @context @container value must be one of the following: "+He.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:I});if(Se.reverse&&!De.every(Je=>["@index","@set"].includes(Je)))throw new V("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});Se["@container"]=De}if("@index"in se){if(!("@container"in se)||!Se["@container"].includes("@index"))throw new V(`Invalid JSON-LD syntax; @index without @index in @container: "${se["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:I});if(!$(se["@index"])||0===se["@index"].indexOf("@"))throw new V(`Invalid JSON-LD syntax; @index must expand to an IRI: "${se["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:I});Se["@index"]=se["@index"]}if("@context"in se&&(Se["@context"]=se["@context"]),"@language"in se&&!("@type"in se)){let De=se["@language"];if(null!==De&&!$(De))throw new V("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:I});null!==De&&(De=De.toLowerCase()),Se["@language"]=De}if("@prefix"in se){if(X.match(/:|\//))throw new V("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:I});if(O.isKeyword(Se["@id"]))throw new V("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:I});if("boolean"!=typeof se["@prefix"])throw new V("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:I});Se._prefix=!0===se["@prefix"]}if("@direction"in se){const De=se["@direction"];if(null!==De&&"ltr"!==De&&"rtl"!==De)throw new V('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:I});Se["@direction"]=De}if("@nest"in se){const De=se["@nest"];if(!$(De)||"@nest"!==De&&0===De.indexOf("@"))throw new V("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:I});Se["@nest"]=De}const _e=Se["@id"];if("@context"===_e||"@preserve"===_e)throw new V("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:I});if(oe&&oe.protected&&!Q&&(D.protected[X]=!0,Se.protected=!0,!ce(oe,Se))){const De=z&&z.protectedMode||"error";if("error"===De)throw new V(`Invalid JSON-LD syntax; tried to redefine "${X}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:I,term:X});if("warn"===De)return void console.warn("WARNING: protected term redefinition",{term:X});throw new V("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:I,term:X,protectedMode:De})}},O.expandIri=(D,I,X,w)=>q(D,I,X,void 0,void 0,w),O.getInitialContext=D=>{const I=JSON.stringify({processingMode:D.processingMode}),X=E.get(I);if(X)return X;const w={processingMode:D.processingMode,mappings:new Map,inverse:null,getInverse:function(){const Se=this;if(Se.inverse)return Se.inverse;const pe=Se.inverse={},te=Se.fastCurieMap={},_e={},De=(Se["@language"]||"@none").toLowerCase(),He=Se["@direction"],rt=Se.mappings,Xe=[...rt.keys()].sort(y);for(const Je of Xe){const Ke=rt.get(Je);if(null===Ke)continue;let je=Ke["@container"]||"@none";if(je=[].concat(je).sort().join(""),null===Ke["@id"])continue;const Fe=b(Ke["@id"]);for(const Ye of Fe){let Ce=pe[Ye];const Be=O.isKeyword(Ye);if(Ce)!Be&&!Ke._termHasColon&&_e[Ye].push(Je);else if(pe[Ye]=Ce={},!Be&&!Ke._termHasColon){_e[Ye]=[Je];const $e={iri:Ye,terms:_e[Ye]};Ye[0]in te?te[Ye[0]].push($e):te[Ye[0]]=[$e]}if(Ce[je]||(Ce[je]={"@language":{},"@type":{},"@any":{}}),Ce=Ce[je],se(Je,Ce["@any"],"@none"),Ke.reverse)se(Je,Ce["@type"],"@reverse");else if("@none"===Ke["@type"])se(Je,Ce["@any"],"@none"),se(Je,Ce["@language"],"@none"),se(Je,Ce["@type"],"@none");else if("@type"in Ke)se(Je,Ce["@type"],Ke["@type"]);else if("@language"in Ke&&"@direction"in Ke){const $e=Ke["@language"],Ne=Ke["@direction"];se(Je,Ce["@language"],$e&&Ne?`${$e}_${Ne}`.toLowerCase():$e?$e.toLowerCase():Ne?`_${Ne}`:"@null")}else"@language"in Ke?se(Je,Ce["@language"],(Ke["@language"]||"@null").toLowerCase()):"@direction"in Ke?se(Je,Ce["@language"],Ke["@direction"]?`_${Ke["@direction"]}`:"@none"):He?(se(Je,Ce["@language"],`_${He}`),se(Je,Ce["@language"],"@none"),se(Je,Ce["@type"],"@none")):(se(Je,Ce["@language"],De),se(Je,Ce["@language"],"@none"),se(Je,Ce["@type"],"@none"))}}for(const Je in te)Q(te,Je,1);return pe},clone:function(){const Se={};return Se.mappings=K.clone(this.mappings),Se.clone=this.clone,Se.inverse=null,Se.getInverse=this.getInverse,Se.protected=K.clone(this.protected),this.previousContext&&(Se.previousContext=this.previousContext.clone()),Se.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(Se["@base"]=this["@base"]),"@language"in this&&(Se["@language"]=this["@language"]),"@vocab"in this&&(Se["@vocab"]=this["@vocab"]),Se},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===E.size&&E.clear(),E.set(I,w),w;function Q(Se,pe,te){const _e=Se[pe],De=Se[pe]={};let He,rt;for(const Xe of _e)He=Xe.iri,rt=te>=He.length?"":He[te],rt in De?De[rt].push(Xe):De[rt]=[Xe];for(const Xe in De)""!==Xe&&Q(De,Xe,te+1)}function se(Se,pe,te){pe.hasOwnProperty(te)||(pe[te]=Se)}},O.getContextValue=(D,I,X)=>{if(null===I)return"@context"===X?void 0:null;if(D.mappings.has(I)){const w=D.mappings.get(I);if(v(X))return w;if(w.hasOwnProperty(X))return w[X]}return"@language"===X&&X in D||"@direction"===X&&X in D?D[X]:"@context"!==X?null:void 0},O.processingMode=(D,I)=>I.toString()>="1.1"?!D.processingMode||D.processingMode>="json-ld-"+I.toString():"json-ld-1.0"===D.processingMode,O.isKeyword=D=>{if(!$(D)||"@"!==D[0])return!1;switch(D){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(Y,Te,fe){"use strict";const{parseLinkHeader:K,buildHeaders:V}=Y("../util"),{LINK_HEADER_CONTEXT:L}=Y("../constants"),ie=Y("../JsonLdError"),$=Y("../RequestQueue"),{prependBase:v}=Y("../url"),S=/(^|(\r\n))link:/i;function N(M,b,y){const E=new(M=M||XMLHttpRequest);return new Promise((x,j)=>{E.onload=()=>x(E),E.onerror=O=>j(O),E.open("GET",b,!0);for(const O in y)E.setRequestHeader(O,y[O]);E.send()})}Te.exports=({secure:M,headers:b={},xhr:y}={headers:{}})=>{return b=V(b),(new $).wrapLoader(x);function x(O){return j.apply(this,arguments)}function j(){return(j=mt(function*(O){if(0!==O.indexOf("http:")&&0!==O.indexOf("https:"))throw new ie('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:O});if(M&&0!==O.indexOf("https"))throw new ie('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:O});let q;try{q=yield N(y,O,b)}catch(w){throw new ie("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:O,cause:w})}if(q.status>=400)throw new ie("URL could not be dereferenced: "+q.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:O,httpStatusCode:q.status});let ce={contextUrl:null,documentUrl:O,document:q.response},D=null;const I=q.getResponseHeader("Content-Type");let X;if(S.test(q.getAllResponseHeaders())&&(X=q.getResponseHeader("Link")),X&&"application/ld+json"!==I){const w=K(X),z=w[L];if(Array.isArray(z))throw new ie("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:O});z&&(ce.contextUrl=z.target),D=w.alternate,D&&"application/ld+json"==D.type&&!(I||"").match(/^application\/(\w*\+)?json$/)&&(ce=yield x(v(O,D.target)))}return ce})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(Y,Te,fe){"use strict";const K=Y("./JsonLdError"),{isArray:V,isObject:L,isEmptyObject:ie,isString:$,isUndefined:v}=Y("./types"),{isList:S,isValue:N,isGraph:M,isSubject:b}=Y("./graphTypes"),{expandIri:y,getContextValue:E,isKeyword:x,process:j,processingMode:O}=Y("./context"),{isAbsolute:q}=Y("./url"),{addValue:ce,asArray:D,getValues:I,validateTypeValue:X}=Y("./util"),w={};Te.exports=w;const z=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function Q(te){return se.apply(this,arguments)}function se(){return(se=mt(function*({activeCtx:te,activeProperty:_e,expandedActiveProperty:De,element:He,expandedParent:rt,options:Xe={},insideList:Je,typeKey:Ke,typeScopedContext:je,expansionMap:Fe}){const Ye=Object.keys(He).sort(),Ce=[];let Be;const $e=He[Ke]&&"@json"===y(te,V(He[Ke])?He[Ke][0]:He[Ke],{vocab:!0},Xe);for(const Ne of Ye){let U,G=He[Ne];if("@context"===Ne)continue;let he=y(te,Ne,{vocab:!0},Xe);if((null===he||!q(he)&&!x(he))&&(he=Fe({unmappedProperty:Ne,activeCtx:te,activeProperty:_e,parent:He,options:Xe,insideList:Je,value:G,expandedParent:rt}),void 0===he))continue;if(x(he)){if("@reverse"===De)throw new K("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:G});if(he in rt&&"@included"!==he&&"@type"!==he)throw new K("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:he})}if("@id"===he){if(!$(G)){if(!Xe.isFrame)throw new K('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:G});if(L(G)){if(!ie(G))throw new K('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:G})}else{if(!V(G))throw new K('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:G});if(!G.every(ft=>$(ft)))throw new K('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:G})}}ce(rt,"@id",D(G).map(ft=>$(ft)?y(te,ft,{base:!0},Xe):ft),{propertyIsArray:Xe.isFrame});continue}if("@type"===he){L(G)&&(G=Object.fromEntries(Object.entries(G).map(([ft,ve])=>[y(je,ft,{vocab:!0}),D(ve).map(k=>y(je,k,{base:!0,vocab:!0}))]))),X(G,Xe.isFrame),ce(rt,"@type",D(G).map(ft=>$(ft)?y(je,ft,{base:!0,vocab:!0},Xe):ft),{propertyIsArray:Xe.isFrame});continue}if("@included"===he&&O(te,1.1)){const ft=D(yield w.expand({activeCtx:te,activeProperty:_e,element:G,options:Xe,expansionMap:Fe}));if(!ft.every(ve=>b(ve)))throw new K("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:G});ce(rt,"@included",ft,{propertyIsArray:!0});continue}if("@graph"===he&&!L(G)&&!V(G))throw new K('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:G});if("@value"===he){Be=G,$e&&O(te,1.1)?rt["@value"]=G:ce(rt,"@value",G,{propertyIsArray:Xe.isFrame});continue}if("@language"===he){if(null===G)continue;if(!$(G)&&!Xe.isFrame)throw new K('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:G});G=D(G).map(ft=>$(ft)?ft.toLowerCase():ft);for(const ft of G)$(ft)&&!ft.match(z)&&console.warn(`@language must be valid BCP47: ${ft}`);ce(rt,"@language",G,{propertyIsArray:Xe.isFrame});continue}if("@direction"===he){if(!$(G)&&!Xe.isFrame)throw new K('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:G});G=D(G);for(const ft of G)if($(ft)&&"ltr"!==ft&&"rtl"!==ft)throw new K('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:G});ce(rt,"@direction",G,{propertyIsArray:Xe.isFrame});continue}if("@index"===he){if(!$(G))throw new K('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:G});ce(rt,"@index",G);continue}if("@reverse"===he){if(!L(G))throw new K('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:G});if(U=yield w.expand({activeCtx:te,activeProperty:"@reverse",element:G,options:Xe,expansionMap:Fe}),"@reverse"in U)for(const ve in U["@reverse"])ce(rt,ve,U["@reverse"][ve],{propertyIsArray:!0});let ft=rt["@reverse"]||null;for(const ve in U){if("@reverse"===ve)continue;null===ft&&(ft=rt["@reverse"]={}),ce(ft,ve,[],{propertyIsArray:!0});const k=U[ve];for(let R=0;R<k.length;++R){const B=k[R];if(N(B)||S(B))throw new K('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:U});ce(ft,ve,B,{propertyIsArray:!0})}}continue}if("@nest"===he){Ce.push(Ne);continue}let ue=te;const ke=E(te,Ne,"@context");v(ke)||(ue=yield j({activeCtx:te,localCtx:ke,propagate:!0,overrideProtected:!0,options:Xe}));const gt=E(ue,Ne,"@container")||[];if(gt.includes("@language")&&L(G))U=ee(ue,G,E(ue,Ne,"@direction"),Xe);else if(gt.includes("@index")&&L(G)){const ft=gt.includes("@graph"),ve=E(ue,Ne,"@index")||"@index",k="@index"!==ve&&y(te,ve,{vocab:!0},Xe);U=yield Se({activeCtx:ue,options:Xe,activeProperty:Ne,value:G,expansionMap:Fe,asGraph:ft,indexKey:ve,propertyIndex:k})}else if(gt.includes("@id")&&L(G)){const ft=gt.includes("@graph");U=yield Se({activeCtx:ue,options:Xe,activeProperty:Ne,value:G,expansionMap:Fe,asGraph:ft,indexKey:"@id"})}else if(gt.includes("@type")&&L(G))U=yield Se({activeCtx:ue.revertToPreviousContext(),options:Xe,activeProperty:Ne,value:G,expansionMap:Fe,asGraph:!1,indexKey:"@type"});else{const ft="@list"===he;if(ft||"@set"===he){let ve=_e;ft&&"@graph"===De&&(ve=null),U=yield w.expand({activeCtx:ue,activeProperty:ve,element:G,options:Xe,insideList:ft,expansionMap:Fe})}else U="@json"===E(te,Ne,"@type")?{"@type":"@json","@value":G}:yield w.expand({activeCtx:ue,activeProperty:Ne,element:G,options:Xe,insideList:!1,expansionMap:Fe})}if(null!==U||"@value"===he||(U=Fe({unmappedValue:G,expandedProperty:he,activeCtx:ue,activeProperty:_e,parent:He,options:Xe,insideList:Je,key:Ne,expandedParent:rt}),void 0!==U)){if("@list"!==he&&!S(U)&&gt.includes("@list")&&(U={"@list":D(U)}),gt.includes("@graph")&&!gt.some(ft=>"@id"===ft||"@index"===ft)&&(U=D(U).map(ft=>({"@graph":D(ft)}))),ue.mappings.has(Ne)&&ue.mappings.get(Ne).reverse){const ft=rt["@reverse"]=rt["@reverse"]||{};U=D(U);for(let ve=0;ve<U.length;++ve){const k=U[ve];if(N(k)||S(k))throw new K('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:U});ce(ft,he,k,{propertyIsArray:!0})}continue}ce(rt,he,U,{propertyIsArray:!0})}}if("@value"in rt&&("@json"!==rt["@type"]||!O(te,1.1))&&(L(Be)||V(Be))&&!Xe.isFrame)throw new K('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:Be});for(const Ne of Ce){const G=V(He[Ne])?He[Ne]:[He[Ne]];for(const U of G){if(!L(U)||Object.keys(U).some(he=>"@value"===y(te,he,{vocab:!0},Xe)))throw new K("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:U});yield Q({activeCtx:te,activeProperty:_e,expandedActiveProperty:De,element:U,expandedParent:rt,options:Xe,insideList:Je,typeScopedContext:je,typeKey:Ke,expansionMap:Fe})}}})).apply(this,arguments)}function oe({activeCtx:te,activeProperty:_e,value:De,options:He}){if(null==De)return null;const rt=y(te,_e,{vocab:!0},He);if("@id"===rt)return y(te,De,{base:!0},He);if("@type"===rt)return y(te,De,{vocab:!0,base:!0},He);const Xe=E(te,_e,"@type");if(("@id"===Xe||"@graph"===rt)&&$(De))return{"@id":y(te,De,{base:!0},He)};if("@vocab"===Xe&&$(De))return{"@id":y(te,De,{vocab:!0,base:!0},He)};if(x(rt))return De;const Je={};if(Xe&&!["@id","@vocab","@none"].includes(Xe))Je["@type"]=Xe;else if($(De)){const Ke=E(te,_e,"@language");null!==Ke&&(Je["@language"]=Ke);const je=E(te,_e,"@direction");null!==je&&(Je["@direction"]=je)}return["boolean","number","string"].includes(typeof De)||(De=De.toString()),Je["@value"]=De,Je}function ee(te,_e,De,He){const rt=[],Xe=Object.keys(_e).sort();for(const Je of Xe){const Ke=y(te,Je,{vocab:!0},He);let je=_e[Je];V(je)||(je=[je]);for(const Fe of je){if(null===Fe)continue;if(!$(Fe))throw new K("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:_e});const Ye={"@value":Fe};"@none"!==Ke&&(Ye["@language"]=Je.toLowerCase()),De&&(Ye["@direction"]=De),rt.push(Ye)}}return rt}function Se(te){return pe.apply(this,arguments)}function pe(){return(pe=mt(function*({activeCtx:te,options:_e,activeProperty:De,value:He,expansionMap:rt,asGraph:Xe,indexKey:Je,propertyIndex:Ke}){const je=[],Fe=Object.keys(He).sort(),Ye="@type"===Je;for(let Ce of Fe){if(Ye){const Ne=E(te,Ce,"@context");v(Ne)||(te=yield j({activeCtx:te,localCtx:Ne,propagate:!1,options:_e}))}let $e,Be=He[Ce];V(Be)||(Be=[Be]),Be=yield w.expand({activeCtx:te,activeProperty:De,element:Be,options:_e,insideList:!1,insideIndex:!0,expansionMap:rt}),$e=Ke?"@none"===Ce?"@none":oe({activeCtx:te,activeProperty:Je,value:Ce,options:_e}):y(te,Ce,{vocab:!0},_e),"@id"===Je?Ce=y(te,Ce,{base:!0},_e):Ye&&(Ce=$e);for(let Ne of Be){if(Xe&&!M(Ne)&&(Ne={"@graph":[Ne]}),"@type"===Je)"@none"===$e||(Ne["@type"]=Ne["@type"]?[Ce].concat(Ne["@type"]):[Ce]);else{if(N(Ne)&&!["@language","@type","@index"].includes(Je))throw new K(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${Je}".`,"jsonld.SyntaxError",{code:"invalid value object",value:Ne});Ke?"@none"!==$e&&ce(Ne,Ke,$e,{propertyIsArray:!0,prependValue:!0}):"@none"!==$e&&!(Je in Ne)&&(Ne[Je]=Ce)}je.push(Ne)}}return je})).apply(this,arguments)}w.expand=function(){var te=mt(function*({activeCtx:_e,activeProperty:De=null,element:He,options:rt={},insideList:Xe=!1,insideIndex:Je=!1,typeScopedContext:Ke=null,expansionMap:je=(()=>{})}){if(null==He)return null;if("@default"===De&&(rt=Object.assign({},rt,{isFrame:!1})),!V(He)&&!L(He)){if(!Xe&&(null===De||"@graph"===y(_e,De,{vocab:!0},rt))){const U=yield je({unmappedValue:He,activeCtx:_e,activeProperty:De,options:rt,insideList:Xe});return void 0===U?null:U}return oe({activeCtx:_e,activeProperty:De,value:He,options:rt})}if(V(He)){let U=[];const he=E(_e,De,"@container")||[];Xe=Xe||he.includes("@list");for(let ue=0;ue<He.length;++ue){let ke=yield w.expand({activeCtx:_e,activeProperty:De,element:He[ue],options:rt,expansionMap:je,insideIndex:Je,typeScopedContext:Ke});Xe&&V(ke)&&(ke={"@list":ke}),(null!==ke||(ke=yield je({unmappedValue:He[ue],activeCtx:_e,activeProperty:De,parent:He,index:ue,options:rt,expandedParent:U,insideList:Xe}),void 0!==ke))&&(V(ke)?U=U.concat(ke):U.push(ke))}return U}const Fe=y(_e,De,{vocab:!0},rt),Ye=E(_e,De,"@context");Ke=Ke||(_e.previousContext?_e:null);let Ce=Object.keys(He).sort(),Be=!Je;if(Be&&Ke&&Ce.length<=2&&!Ce.includes("@context"))for(const U of Ce){const he=y(Ke,U,{vocab:!0},rt);if("@value"===he){Be=!1,_e=Ke;break}if("@id"===he&&1===Ce.length){Be=!1;break}}Be&&(_e=_e.revertToPreviousContext()),v(Ye)||(_e=yield j({activeCtx:_e,localCtx:Ye,propagate:!0,overrideProtected:!0,options:rt})),"@context"in He&&(_e=yield j({activeCtx:_e,localCtx:He["@context"],options:rt})),Ke=_e;let $e=null;for(const U of Ce)if("@type"===y(_e,U,{vocab:!0},rt)){$e=$e||U;const ue=He[U],ke=Array.isArray(ue)?ue.length>1?ue.slice().sort():ue:[ue];for(const gt of ke){const ft=E(Ke,gt,"@context");v(ft)||(_e=yield j({activeCtx:_e,localCtx:ft,options:rt,propagate:!1}))}}let Ne={};yield Q({activeCtx:_e,activeProperty:De,expandedActiveProperty:Fe,element:He,expandedParent:Ne,options:rt,insideList:Xe,typeKey:$e,typeScopedContext:Ke,expansionMap:je}),Ce=Object.keys(Ne);let G=Ce.length;if("@value"in Ne){if("@type"in Ne&&("@language"in Ne||"@direction"in Ne))throw new K('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Ne});let U=G-1;if("@type"in Ne&&(U-=1),"@index"in Ne&&(U-=1),"@language"in Ne&&(U-=1),"@direction"in Ne&&(U-=1),0!==U)throw new K('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Ne});const he=null===Ne["@value"]?[]:D(Ne["@value"]),ue=I(Ne,"@type");if(!O(_e,1.1)||!ue.includes("@json")||1!==ue.length)if(0===he.length){const ke=yield je({unmappedValue:Ne,activeCtx:_e,activeProperty:De,element:He,options:rt,insideList:Xe});Ne=void 0!==ke?ke:null}else{if(!he.every(ke=>$(ke)||ie(ke))&&"@language"in Ne)throw new K("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:Ne});if(!ue.every(ke=>q(ke)&&!($(ke)&&0===ke.indexOf("_:"))||ie(ke)))throw new K('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:Ne})}}else if("@type"in Ne&&!V(Ne["@type"]))Ne["@type"]=[Ne["@type"]];else if("@set"in Ne||"@list"in Ne){if(G>1&&(2!==G||!("@index"in Ne)))throw new K('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:Ne});"@set"in Ne&&(Ne=Ne["@set"],Ce=Object.keys(Ne),G=Ce.length)}else if(1===G&&"@language"in Ne){const U=yield je(Ne,{unmappedValue:Ne,activeCtx:_e,activeProperty:De,element:He,options:rt,insideList:Xe});Ne=void 0!==U?U:null}if(L(Ne)&&!rt.keepFreeFloatingNodes&&!Xe&&(null===De||"@graph"===Fe)&&(0===G||"@value"in Ne||"@list"in Ne||1===G&&"@id"in Ne)){const U=yield je({unmappedValue:Ne,activeCtx:_e,activeProperty:De,element:He,options:rt,insideList:Xe});Ne=void 0!==U?U:null}return Ne});return function(_e){return te.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(Y,Te,fe){"use strict";const{isSubjectReference:K}=Y("./graphTypes"),{createMergedNodeMap:V}=Y("./nodeMap"),L={};Te.exports=L,L.flatten=ie=>{const $=V(ie),v=[],S=Object.keys($).sort();for(let N=0;N<S.length;++N){const M=$[S[N]];K(M)||v.push(M)}return v}},{"./graphTypes":25,"./nodeMap":27}],23:[function(Y,Te,fe){"use strict";const{isKeyword:K}=Y("./context"),V=Y("./graphTypes"),L=Y("./types"),ie=Y("./util"),$=Y("./url"),v=Y("./JsonLdError"),{createNodeMap:S,mergeNodeMapGraphs:N}=Y("./nodeMap"),M={};function b(w){const z={};for(const Q in w)void 0!==w[Q]&&(z["@"+Q]=[w[Q]]);return[z]}function y(w,z,Q){for(let se=Q.length-1;se>=0;--se){const oe=Q[se];if(oe.graph===z&&oe.subject["@id"]===w["@id"])return!0}return!1}function E(w,z,Q){const se="@"+Q;let oe=se in w?w[se][0]:z[Q];if("embed"===Q)if(!0===oe)oe="@once";else if(!1===oe)oe="@never";else if("@always"!==oe&&"@never"!==oe&&"@link"!==oe&&"@first"!==oe&&"@last"!==oe&&"@once"!==oe)throw new v("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:w});return oe}function x(w){if(!L.isArray(w)||1!==w.length||!L.isObject(w[0]))throw new v("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:w});if("@id"in w[0])for(const z of ie.asArray(w[0]["@id"]))if(!L.isObject(z)&&!$.isAbsolute(z)||L.isString(z)&&0===z.indexOf("_:"))throw new v("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:w});if("@type"in w[0])for(const z of ie.asArray(w[0]["@type"]))if(!L.isObject(z)&&!$.isAbsolute(z)||L.isString(z)&&0===z.indexOf("_:"))throw new v("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:w})}function O(w,z,Q,se){let oe=!0,ee=!1;for(const Se in Q){let pe=!1;const te=ie.getValues(z,Se),_e=0===ie.getValues(Q,Se).length;if("@id"===Se){if(L.isEmptyObject(Q["@id"][0]||{})?pe=!0:Q["@id"].length>=0&&(pe=Q["@id"].includes(te[0])),!se.requireAll)return pe}else if("@type"===Se){if(oe=!1,_e){if(te.length>0)return!1;pe=!0}else if(1===Q["@type"].length&&L.isEmptyObject(Q["@type"][0]))pe=te.length>0;else for(const De of Q["@type"])pe=!(!L.isObject(De)||!("@default"in De))||pe||te.some(He=>He===De);if(!se.requireAll)return pe}else{if(K(Se))continue;{const De=ie.getValues(Q,Se)[0];let He=!1;if(De&&(x([De]),He="@default"in De),oe=!1,0===te.length&&He)continue;if(te.length>0&&_e)return!1;if(void 0===De){if(te.length>0)return!1;pe=!0}else if(V.isList(De)){const rt=De["@list"][0];if(V.isList(te[0])){const Xe=te[0]["@list"];V.isValue(rt)?pe=Xe.some(Je=>X(rt,Je)):(V.isSubject(rt)||V.isSubjectReference(rt))&&(pe=Xe.some(Je=>I(w,rt,Je,se)))}}else pe=V.isValue(De)?te.some(rt=>X(De,rt)):V.isSubjectReference(De)?te.some(rt=>I(w,De,rt,se)):!!L.isObject(De)&&te.length>0}}if(!pe&&se.requireAll)return!1;ee=ee||pe}return oe||ee}function q(w,z){const Q=w.uniqueEmbeds[w.graph],se=Q[z],oe=se.parent,ee=se.property,Se={"@id":z};if(L.isArray(oe)){for(let te=0;te<oe.length;++te)if(ie.compareValues(oe[te],Se)){oe[te]=Se;break}}else{const te=L.isArray(oe[ee]);ie.removeValue(oe,ee,Se,{propertyIsArray:te}),ie.addValue(oe,ee,Se,{propertyIsArray:te})}const pe=te=>{const _e=Object.keys(Q);for(const De of _e)De in Q&&L.isObject(Q[De].parent)&&Q[De].parent["@id"]===te&&(delete Q[De],pe(De))};pe(z)}function ce(w,z){if(L.isArray(w))return w.map(Q=>ce(Q,z));if(L.isObject(w)){if("@preserve"in w)return w["@preserve"][0];if(V.isValue(w))return w;if(V.isList(w))return w["@list"]=ce(w["@list"],z),w;if("@id"in w){const Q=w["@id"];if(z.link.hasOwnProperty(Q)){const se=z.link[Q].indexOf(w);if(-1!==se)return z.link[Q][se];z.link[Q].push(w)}else z.link[Q]=[w]}for(const Q in w)"@id"===Q&&z.bnodesToClear.includes(w[Q])?delete w["@id"]:w[Q]=ce(w[Q],z)}return w}function D(w,z,Q){L.isObject(w)?ie.addValue(w,z,Q,{propertyIsArray:!0}):w.push(Q)}function I(w,z,Q,se){if(!("@id"in Q))return!1;const oe=w.subjects[Q["@id"]];return oe&&O(w,oe,z,se)}function X(w,z){const Q=z["@value"],se=z["@type"],oe=z["@language"],ee=w["@value"]?L.isArray(w["@value"])?w["@value"]:[w["@value"]]:[],Se=w["@type"]?L.isArray(w["@type"])?w["@type"]:[w["@type"]]:[],pe=w["@language"]?L.isArray(w["@language"])?w["@language"]:[w["@language"]]:[];return 0===ee.length&&0===Se.length&&0===pe.length||!(!ee.includes(Q)&&!L.isEmptyObject(ee[0])||!(!se&&0===Se.length||Se.includes(se)||se&&L.isEmptyObject(Se[0]))||!(!oe&&0===pe.length||pe.includes(oe)||oe&&L.isEmptyObject(pe[0])))}Te.exports=M,M.frameMergedOrDefault=(w,z,Q)=>{const se={options:Q,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},oe=new ie.IdentifierIssuer("_:b");S(w,se.graphMap,"@default",oe),Q.merged&&(se.graphMap["@merged"]=N(se.graphMap),se.graph="@merged"),se.subjects=se.graphMap[se.graph];const ee=[];return M.frame(se,Object.keys(se.subjects).sort(),z,ee),Q.pruneBlankNodeIdentifiers&&(Q.bnodesToClear=Object.keys(se.bnodeMap).filter(Se=>1===se.bnodeMap[Se].length)),Q.link={},ce(ee,Q)},M.frame=(w,z,Q,se,oe=null)=>{x(Q);const ee=w.options,Se={embed:E(Q=Q[0],ee,"embed"),explicit:E(Q,ee,"explicit"),requireAll:E(Q,ee,"requireAll")};w.link.hasOwnProperty(w.graph)||(w.link[w.graph]={});const pe=w.link[w.graph],te=function(w,z,Q,se){const oe={};for(const ee of z){const Se=w.graphMap[w.graph][ee];O(w,Se,Q,se)&&(oe[ee]=Se)}return oe}(w,z,Q,Se),_e=Object.keys(te).sort();for(const De of _e){const He=te[De];if(null===oe?w.uniqueEmbeds={[w.graph]:{}}:w.uniqueEmbeds[w.graph]=w.uniqueEmbeds[w.graph]||{},"@link"===Se.embed&&De in pe){D(se,oe,pe[De]);continue}const rt={"@id":De};if(0===De.indexOf("_:")&&ie.addValue(w.bnodeMap,De,rt,{propertyIsArray:!0}),pe[De]=rt,("@first"===Se.embed||"@last"===Se.embed)&&w.is11)throw new v("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:Q});if(w.embedded||!w.uniqueEmbeds[w.graph].hasOwnProperty(De)){if(w.embedded&&("@never"===Se.embed||y(He,w.graph,w.subjectStack))){D(se,oe,rt);continue}if(w.embedded&&("@first"==Se.embed||"@once"==Se.embed)&&w.uniqueEmbeds[w.graph].hasOwnProperty(De)){D(se,oe,rt);continue}if("@last"===Se.embed&&De in w.uniqueEmbeds[w.graph]&&q(w,De),w.uniqueEmbeds[w.graph][De]={parent:se,property:oe},w.subjectStack.push({subject:He,graph:w.graph}),De in w.graphMap){let Xe=!1,Je=null;"@graph"in Q?(Je=Q["@graph"][0],Xe=!("@merged"===De||"@default"===De),L.isObject(Je)||(Je={})):(Xe="@merged"!==w.graph,Je={}),Xe&&M.frame(Hn(ht({},w),{graph:De,embedded:!1}),Object.keys(w.graphMap[De]).sort(),[Je],rt,"@graph")}"@included"in Q&&M.frame(Hn(ht({},w),{embedded:!1}),z,Q["@included"],rt,"@included");for(const Xe of Object.keys(He).sort())if(K(Xe)){if(rt[Xe]=ie.clone(He[Xe]),"@type"===Xe)for(const Je of He["@type"])0===Je.indexOf("_:")&&ie.addValue(w.bnodeMap,Je,rt,{propertyIsArray:!0})}else if(!Se.explicit||Xe in Q)for(const Je of He[Xe]){const Ke=Xe in Q?Q[Xe]:b(Se);if(V.isList(Je)){const je=Q[Xe]&&Q[Xe][0]&&Q[Xe][0]["@list"]?Q[Xe][0]["@list"]:b(Se),Fe={"@list":[]};D(rt,Xe,Fe);const Ye=Je["@list"];for(const Ce of Ye)V.isSubjectReference(Ce)?M.frame(Hn(ht({},w),{embedded:!0}),[Ce["@id"]],je,Fe,"@list"):D(Fe,"@list",ie.clone(Ce))}else V.isSubjectReference(Je)?M.frame(Hn(ht({},w),{embedded:!0}),[Je["@id"]],Ke,rt,Xe):X(Ke[0],Je)&&D(rt,Xe,ie.clone(Je))}for(const Xe of Object.keys(Q).sort()){if("@type"===Xe){if(!L.isObject(Q[Xe][0])||!("@default"in Q[Xe][0]))continue}else if(K(Xe))continue;const Je=Q[Xe][0]||{};if(!E(Je,ee,"omitDefault")&&!(Xe in rt)){let je="@null";"@default"in Je&&(je=ie.clone(Je["@default"])),L.isArray(je)||(je=[je]),rt[Xe]=[{"@preserve":je}]}}for(const Xe of Object.keys(Q["@reverse"]||{}).sort()){const Je=Q["@reverse"][Xe];for(const Ke of Object.keys(w.subjects))ie.getValues(w.subjects[Ke],Xe).some(Fe=>Fe["@id"]===De)&&(rt["@reverse"]=rt["@reverse"]||{},ie.addValue(rt["@reverse"],Xe,[],{propertyIsArray:!0}),M.frame(Hn(ht({},w),{embedded:!0}),[Ke],Je,rt["@reverse"][Xe],oe))}D(se,oe,rt),w.subjectStack.pop()}}},M.cleanupNull=(w,z)=>{if(L.isArray(w))return w.map(se=>M.cleanupNull(se,z)).filter(se=>se);if("@null"===w)return null;if(L.isObject(w)){if("@id"in w){const Q=w["@id"];if(z.link.hasOwnProperty(Q)){const se=z.link[Q].indexOf(w);if(-1!==se)return z.link[Q][se];z.link[Q].push(w)}else z.link[Q]=[w]}for(const Q in w)w[Q]=M.cleanupNull(w[Q],z)}return w}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(Y,Te,fe){"use strict";const K=Y("./JsonLdError"),V=Y("./graphTypes"),L=Y("./types"),ie=Y("./util"),{RDF_LIST:$,RDF_FIRST:v,RDF_REST:S,RDF_NIL:N,RDF_TYPE:M,RDF_JSON_LITERAL:b,XSD_BOOLEAN:y,XSD_DOUBLE:E,XSD_INTEGER:x,XSD_STRING:j}=Y("./constants"),O=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,q={};function ce(D,I,X){if(D.termType.endsWith("Node"))return{"@id":D.value};const w={"@value":D.value};if(D.language)w["@language"]=D.language;else{let z=D.datatype.value;if(z||(z=j),z===b){z="@json";try{w["@value"]=JSON.parse(w["@value"])}catch(Q){throw new K("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:w["@value"],cause:Q})}}if(I){if(z===y)"true"===w["@value"]?w["@value"]=!0:"false"===w["@value"]&&(w["@value"]=!1);else if(L.isNumeric(w["@value"]))if(z===x){const Q=parseInt(w["@value"],10);Q.toFixed(0)===w["@value"]&&(w["@value"]=Q)}else z===E&&(w["@value"]=parseFloat(w["@value"]));[y,x,E,j].includes(z)||(w["@type"]=z)}else if("i18n-datatype"===X&&z.startsWith("https://www.w3.org/ns/i18n#")){const[,Q,se]=z.split(/[#_]/);Q.length>0&&(w["@language"]=Q,Q.match(O)||console.warn(`@language must be valid BCP47: ${Q}`)),w["@direction"]=se}else z!==j&&(w["@type"]=z)}return w}Te.exports=q,q.fromRDF=function(){var D=mt(function*(I,{useRdfType:X=!1,useNativeTypes:w=!1,rdfDirection:z=null}){const Q={},se={"@default":Q},oe={};for(const pe of I){const te="DefaultGraph"===pe.graph.termType?"@default":pe.graph.value;te in se||(se[te]={}),"@default"!==te&&!(te in Q)&&(Q[te]={"@id":te});const _e=se[te],De=pe.subject.value,He=pe.predicate.value,rt=pe.object;De in _e||(_e[De]={"@id":De});const Xe=_e[De],Je=rt.termType.endsWith("Node");if(Je&&!(rt.value in _e)&&(_e[rt.value]={"@id":rt.value}),He===M&&!X&&Je){ie.addValue(Xe,"@type",rt.value,{propertyIsArray:!0});continue}const Ke=ce(rt,w,z);if(ie.addValue(Xe,He,Ke,{propertyIsArray:!0}),Je)if(rt.value===N){const je=_e[rt.value];"usages"in je||(je.usages=[]),je.usages.push({node:Xe,property:He,value:Ke})}else oe[rt.value]=!(rt.value in oe)&&{node:Xe,property:He,value:Ke}}for(const pe in se){const te=se[pe];if(!(N in te))continue;const _e=te[N];if(_e.usages){for(let De of _e.usages){let He=De.node,rt=De.property,Xe=De.value;const Je=[],Ke=[];let je=Object.keys(He).length;for(;rt===S&&L.isObject(oe[He["@id"]])&&L.isArray(He[v])&&1===He[v].length&&L.isArray(He[S])&&1===He[S].length&&(3===je||4===je&&L.isArray(He["@type"])&&1===He["@type"].length&&He["@type"][0]===$)&&(Je.push(He[v][0]),Ke.push(He["@id"]),De=oe[He["@id"]],He=De.node,rt=De.property,Xe=De.value,je=Object.keys(He).length,V.isBlankNode(He)););delete Xe["@id"],Xe["@list"]=Je.reverse();for(const Fe of Ke)delete te[Fe]}delete _e.usages}}const ee=[],Se=Object.keys(Q).sort();for(const pe of Se){const te=Q[pe];if(pe in se){const _e=te["@graph"]=[],De=se[pe],He=Object.keys(De).sort();for(const rt of He){const Xe=De[rt];V.isSubjectReference(Xe)||_e.push(Xe)}}V.isSubjectReference(te)||ee.push(te)}return ee});return function(I,X){return D.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(Y,Te,fe){"use strict";const K=Y("./types"),V={};Te.exports=V,V.isSubject=L=>!(!K.isObject(L)||"@value"in L||"@set"in L||"@list"in L)&&(Object.keys(L).length>1||!("@id"in L)),V.isSubjectReference=L=>K.isObject(L)&&1===Object.keys(L).length&&"@id"in L,V.isValue=L=>K.isObject(L)&&"@value"in L,V.isList=L=>K.isObject(L)&&"@list"in L,V.isGraph=L=>K.isObject(L)&&"@graph"in L&&1===Object.keys(L).filter(ie=>"@id"!==ie&&"@index"!==ie).length,V.isSimpleGraph=L=>V.isGraph(L)&&!("@id"in L),V.isBlankNode=L=>!!K.isObject(L)&&("@id"in L?0===L["@id"].indexOf("_:"):0===Object.keys(L).length||!("@value"in L||"@set"in L||"@list"in L))},{"./types":30}],26:[function(Y,Te,fe){const K=Y("rdf-canonize"),V=Y("./platform"),L=Y("./util"),ie=Y("./ContextResolver"),$=L.IdentifierIssuer,v=Y("./JsonLdError"),S=Y("lru-cache"),N=Y("./NQuads"),{expand:M}=Y("./expand"),{flatten:b}=Y("./flatten"),{fromRDF:y}=Y("./fromRdf"),{toRDF:E}=Y("./toRdf"),{frameMergedOrDefault:x,cleanupNull:j}=Y("./frame"),{isArray:O,isObject:q,isString:ce}=Y("./types"),{isSubjectReference:D}=Y("./graphTypes"),{expandIri:I,getInitialContext:X,process:w,processingMode:z}=Y("./context"),{compact:Q,compactIri:se}=Y("./compact"),{createNodeMap:oe,createMergedNodeMap:ee,mergeNodeMaps:Se}=Y("./nodeMap"),pe=function(_e){const De={},rt=new S({max:100});function Xe(Je,Fe){var Ye=Fe,{documentLoader:Ke=_e.documentLoader}=Ye,je=q7(Ye,["documentLoader"]);return Object.assign({},{documentLoader:Ke},je,Je)}return _e.compact=function(){var Je=mt(function*(Ke,je,Fe){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===je)throw new v("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Ke)return null;let Ye;(Fe=Xe(Fe,{base:ce(Ke)?Ke:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new $("_:b"),contextResolver:new ie({sharedCache:rt})})).link&&(Fe.skipExpansion=!0),Fe.compactToRelative||delete Fe.base,Ye=Fe.skipExpansion?Ke:yield _e.expand(Ke,Fe);const Ce=yield _e.processContext(X(Fe),je,Fe);let Be=yield Q({activeCtx:Ce,element:Ye,options:Fe,compactionMap:Fe.compactionMap});Fe.compactArrays&&!Fe.graph&&O(Be)?1===Be.length?Be=Be[0]:0===Be.length&&(Be={}):Fe.graph&&q(Be)&&(Be=[Be]),q(je)&&"@context"in je&&(je=je["@context"]),je=L.clone(je),O(je)||(je=[je]);const $e=je;je=[];for(let G=0;G<$e.length;++G)(!q($e[G])||Object.keys($e[G]).length>0)&&je.push($e[G]);const Ne=je.length>0;if(1===je.length&&(je=je[0]),O(Be)){const G=se({activeCtx:Ce,iri:"@graph",relativeTo:{vocab:!0}}),U=Be;Be={},Ne&&(Be["@context"]=je),Be[G]=U}else if(q(Be)&&Ne){const G=Be;Be={"@context":je};for(const U in G)Be[U]=G[U]}return Be});return function(Ke,je,Fe){return Je.apply(this,arguments)}}(),_e.expand=function(){var Je=mt(function*(Ke,je){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(je=Xe(je,{keepFreeFloatingNodes:!1,contextResolver:new ie({sharedCache:rt})})).expansionMap&&(je.expansionMap=void 0);const Fe={},Ye=[];if("expandContext"in je){const Ne=L.clone(je.expandContext);Fe.expandContext=q(Ne)&&"@context"in Ne?Ne:{"@context":Ne},Ye.push(Fe.expandContext)}let Ce;if(ce(Ke)){const Ne=yield _e.get(Ke,je);Ce=Ne.documentUrl,Fe.input=Ne.document,Ne.contextUrl&&(Fe.remoteContext={"@context":Ne.contextUrl},Ye.push(Fe.remoteContext))}else Fe.input=L.clone(Ke);"base"in je||(je.base=Ce||"");let Be=X(je);for(const Ne of Ye)Be=yield w({activeCtx:Be,localCtx:Ne,options:je});let $e=yield M({activeCtx:Be,element:Fe.input,options:je,expansionMap:je.expansionMap});return q($e)&&"@graph"in $e&&1===Object.keys($e).length?$e=$e["@graph"]:null===$e&&($e=[]),O($e)||($e=[$e]),$e});return function(Ke,je){return Je.apply(this,arguments)}}(),_e.flatten=function(){var Je=mt(function*(Ke,je,Fe){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");je="function"==typeof je?null:je||null,Fe=Xe(Fe,{base:ce(Ke)?Ke:"",contextResolver:new ie({sharedCache:rt})});const Ye=yield _e.expand(Ke,Fe),Ce=b(Ye);return null===je?Ce:(Fe.graph=!0,Fe.skipExpansion=!0,yield _e.compact(Ce,je,Fe))});return function(Ke,je,Fe){return Je.apply(this,arguments)}}(),_e.frame=function(){var Je=mt(function*(Ke,je,Fe){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(Fe=Xe(Fe,{base:ce(Ke)?Ke:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new ie({sharedCache:rt})}),ce(je)){const ue=yield _e.get(je,Fe);if(je=ue.document,ue.contextUrl){let ke=je["@context"];ke?O(ke)?ke.push(ue.contextUrl):ke=[ke,ue.contextUrl]:ke=ue.contextUrl,je["@context"]=ke}}const Ye=je&&je["@context"]||{},Ce=yield _e.processContext(X(Fe),Ye,Fe);Fe.hasOwnProperty("omitGraph")||(Fe.omitGraph=z(Ce,1.1)),Fe.hasOwnProperty("pruneBlankNodeIdentifiers")||(Fe.pruneBlankNodeIdentifiers=z(Ce,1.1));const Be=yield _e.expand(Ke,Fe),$e=ht({},Fe);$e.isFrame=!0,$e.keepFreeFloatingNodes=!0;const Ne=yield _e.expand(je,$e),G=Object.keys(je).map(ue=>I(Ce,ue,{vocab:!0}));$e.merged=!G.includes("@graph"),$e.is11=z(Ce,1.1);const U=x(Be,Ne,$e);$e.graph=!Fe.omitGraph,$e.skipExpansion=!0,$e.link={},$e.framing=!0;let he=yield _e.compact(U,Ye,$e);return $e.link={},he=j(he,$e),he});return function(Ke,je,Fe){return Je.apply(this,arguments)}}(),_e.link=function(){var Je=mt(function*(Ke,je,Fe){const Ye={};return je&&(Ye["@context"]=je),Ye["@embed"]="@link",_e.frame(Ke,Ye,Fe)});return function(Ke,je,Fe){return Je.apply(this,arguments)}}(),_e.normalize=_e.canonize=function(){var Je=mt(function*(Ke,je){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(je=Xe(je,{base:ce(Ke)?Ke:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new ie({sharedCache:rt})}))){if("application/n-quads"!==je.inputFormat&&"application/nquads"!==je.inputFormat)throw new v("Unknown canonicalization input format.","jsonld.CanonizeError");const Ce=N.parse(Ke);return K.canonize(Ce,je)}const Fe=ht({},je);delete Fe.format,Fe.produceGeneralizedRdf=!1;const Ye=yield _e.toRDF(Ke,Fe);return K.canonize(Ye,je)});return function(Ke,je){return Je.apply(this,arguments)}}(),_e.fromRDF=function(){var Je=mt(function*(Ke,je){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");je=Xe(je,{format:ce(Ke)?"application/n-quads":void 0});const{format:Fe}=je;let{rdfParser:Ye}=je;if(Fe){if(Ye=Ye||De[Fe],!Ye)throw new v("Unknown input format.","jsonld.UnknownFormat",{format:Fe})}else Ye=()=>Ke;const Ce=yield Ye(Ke);return y(Ce,je)});return function(Ke,je){return Je.apply(this,arguments)}}(),_e.toRDF=function(){var Je=mt(function*(Ke,je){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let Fe;Fe=(je=Xe(je,{base:ce(Ke)?Ke:"",skipExpansion:!1,contextResolver:new ie({sharedCache:rt})})).skipExpansion?Ke:yield _e.expand(Ke,je);const Ye=E(Fe,je);if(je.format){if("application/n-quads"===je.format||"application/nquads"===je.format)return N.serialize(Ye);throw new v("Unknown output format.","jsonld.UnknownFormat",{format:je.format})}return Ye});return function(Ke,je){return Je.apply(this,arguments)}}(),_e.createNodeMap=function(){var Je=mt(function*(Ke,je){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");je=Xe(je,{base:ce(Ke)?Ke:"",contextResolver:new ie({sharedCache:rt})});const Fe=yield _e.expand(Ke,je);return ee(Fe,je)});return function(Ke,je){return Je.apply(this,arguments)}}(),_e.merge=function(){var Je=mt(function*(Ke,je,Fe){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!O(Ke))throw new TypeError('Could not merge, "docs" must be an array.');je="function"==typeof je?null:je||null,Fe=Xe(Fe,{contextResolver:new ie({sharedCache:rt})});const Ye=yield Promise.all(Ke.map(ue=>{const ke=ht({},Fe);return _e.expand(ue,ke)}));let Ce=!0;"mergeNodes"in Fe&&(Ce=Fe.mergeNodes);const Be=Fe.issuer||new $("_:b"),$e={"@default":{}};for(let ue=0;ue<Ye.length;++ue){const ke=L.relabelBlankNodes(Ye[ue],{issuer:new $("_:b"+ue+"-")}),gt=Ce||0===ue?$e:{"@default":{}};if(oe(ke,gt,"@default",Be),gt!==$e)for(const ft in gt){const ve=gt[ft];if(!(ft in $e)){$e[ft]=ve;continue}const k=$e[ft];for(const R in ve)R in k||(k[R]=ve[R])}}const Ne=Se($e),G=[],U=Object.keys(Ne).sort();for(let ue=0;ue<U.length;++ue){const ke=Ne[U[ue]];D(ke)||G.push(ke)}return null===je?G:(Fe.graph=!0,Fe.skipExpansion=!0,yield _e.compact(G,je,Fe))});return function(Ke,je,Fe){return Je.apply(this,arguments)}}(),Object.defineProperty(_e,"documentLoader",{get:()=>_e._documentLoader,set:Je=>_e._documentLoader=Je}),_e.documentLoader=function(){var Je=mt(function*(Ke){throw new v("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Ke})});return function(Ke){return Je.apply(this,arguments)}}(),_e.get=function(){var Je=mt(function*(Ke,je){let Fe;Fe="function"==typeof je.documentLoader?je.documentLoader:_e.documentLoader;const Ye=yield Fe(Ke);try{if(!Ye.document)throw new v("No remote document found at the given URL.","jsonld.NullRemoteDocument");ce(Ye.document)&&(Ye.document=JSON.parse(Ye.document))}catch(Ce){throw new v("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:Ce,remoteDoc:Ye})}return Ye});return function(Ke,je){return Je.apply(this,arguments)}}(),_e.processContext=function(){var Je=mt(function*(Ke,je,Fe){return Fe=Xe(Fe,{base:"",contextResolver:new ie({sharedCache:rt})}),null===je?X(Fe):(je=L.clone(je),q(je)&&"@context"in je||(je={"@context":je}),w({activeCtx:Ke,localCtx:je,options:Fe}))});return function(Ke,je,Fe){return Je.apply(this,arguments)}}(),_e.getContextValue=Y("./context").getContextValue,_e.documentLoaders={},_e.useDocumentLoader=function(Je){if(!(Je in _e.documentLoaders))throw new v('Unknown document loader type: "'+Je+'"',"jsonld.UnknownDocumentLoader",{type:Je});_e.documentLoader=_e.documentLoaders[Je].apply(_e,Array.prototype.slice.call(arguments,1))},_e.registerRDFParser=function(Je,Ke){De[Je]=Ke},_e.unregisterRDFParser=function(Je){delete De[Je]},_e.registerRDFParser("application/n-quads",N.parse),_e.registerRDFParser("application/nquads",N.parse),_e.url=Y("./url"),_e.util=L,Object.assign(_e,L),_e.promises=_e,_e.RequestQueue=Y("./RequestQueue"),_e.JsonLdProcessor=Y("./JsonLdProcessor")(_e),V.setupGlobals(_e),V.setupDocumentLoaders(_e),_e},te=function(){return pe(function(){return te()})};pe(te),Te.exports=te},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(Y,Te,fe){"use strict";const{isKeyword:K}=Y("./context"),V=Y("./graphTypes"),L=Y("./types"),ie=Y("./util"),$=Y("./JsonLdError"),v={};Te.exports=v,v.createMergedNodeMap=(S,N)=>{const M=(N=N||{}).issuer||new ie.IdentifierIssuer("_:b"),b={"@default":{}};return v.createNodeMap(S,b,"@default",M),v.mergeNodeMaps(b)},v.createNodeMap=(S,N,M,b,y,E)=>{if(L.isArray(S)){for(const q of S)v.createNodeMap(q,N,M,b,void 0,E);return}if(!L.isObject(S))return void(E&&E.push(S));if(V.isValue(S)){if("@type"in S){let q=S["@type"];0===q.indexOf("_:")&&(S["@type"]=q=b.getId(q))}return void(E&&E.push(S))}if(E&&V.isList(S)){const q=[];return v.createNodeMap(S["@list"],N,M,b,y,q),void E.push({"@list":q})}if("@type"in S){const q=S["@type"];for(const ce of q)0===ce.indexOf("_:")&&b.getId(ce)}L.isUndefined(y)&&(y=V.isBlankNode(S)?b.getId(S["@id"]):S["@id"]),E&&E.push({"@id":y});const x=N[M],j=x[y]=x[y]||{};j["@id"]=y;const O=Object.keys(S).sort();for(let q of O){if("@id"===q)continue;if("@reverse"===q){const D={"@id":y},I=S["@reverse"];for(const X in I){const w=I[X];for(const z of w){let Q=z["@id"];V.isBlankNode(z)&&(Q=b.getId(Q)),v.createNodeMap(z,N,M,b,Q),ie.addValue(x[Q],X,D,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===q){y in N||(N[y]={}),v.createNodeMap(S[q],N,y,b);continue}if("@included"===q){v.createNodeMap(S[q],N,M,b);continue}if("@type"!==q&&K(q)){if("@index"===q&&q in j&&(S[q]!==j[q]||S[q]["@id"]!==j[q]["@id"]))throw new $("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:j});j[q]=S[q];continue}const ce=S[q];if(0===q.indexOf("_:")&&(q=b.getId(q)),0!==ce.length)for(let D of ce)if("@type"===q&&(D=0===D.indexOf("_:")?b.getId(D):D),V.isSubject(D)||V.isSubjectReference(D)){if("@id"in D&&!D["@id"])continue;const I=V.isBlankNode(D)?b.getId(D["@id"]):D["@id"];ie.addValue(j,q,{"@id":I},{propertyIsArray:!0,allowDuplicate:!1}),v.createNodeMap(D,N,M,b,I)}else if(V.isValue(D))ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1});else if(V.isList(D)){const I=[];v.createNodeMap(D["@list"],N,M,b,y,I),D={"@list":I},ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1})}else v.createNodeMap(D,N,M,b,y),ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1});else ie.addValue(j,q,[],{propertyIsArray:!0})}},v.mergeNodeMapGraphs=S=>{const N={};for(const M of Object.keys(S).sort())for(const b of Object.keys(S[M]).sort()){const y=S[M][b];b in N||(N[b]={"@id":b});const E=N[b];for(const x of Object.keys(y).sort())if(K(x)&&"@type"!==x)E[x]=ie.clone(y[x]);else for(const j of y[x])ie.addValue(E,x,ie.clone(j),{propertyIsArray:!0,allowDuplicate:!1})}return N},v.mergeNodeMaps=S=>{const N=S["@default"],M=Object.keys(S).sort();for(const b of M){if("@default"===b)continue;const y=S[b];let E=N[b];E?"@graph"in E||(E["@graph"]=[]):N[b]=E={"@id":b,"@graph":[]};const x=E["@graph"];for(const j of Object.keys(y).sort()){const O=y[j];V.isSubjectReference(O)||x.push(O)}}return N}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(Y,Te,fe){"use strict";const K=Y("./documentLoaders/xhr"),V={};Te.exports=V,V.setupDocumentLoaders=function(L){"undefined"!=typeof XMLHttpRequest&&(L.documentLoaders.xhr=K,L.useDocumentLoader("xhr"))},V.setupGlobals=function(L){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:L.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(Y,Te,fe){"use strict";const{createNodeMap:K}=Y("./nodeMap"),{isKeyword:V}=Y("./context"),L=Y("./graphTypes"),ie=Y("canonicalize"),$=Y("./types"),v=Y("./util"),{RDF_FIRST:S,RDF_REST:N,RDF_NIL:M,RDF_TYPE:b,RDF_JSON_LITERAL:y,RDF_LANGSTRING:E,XSD_BOOLEAN:x,XSD_DOUBLE:j,XSD_INTEGER:O,XSD_STRING:q}=Y("./constants"),{isAbsolute:ce}=Y("./url"),D={};function I(z,Q,se,oe,ee){const Se=Object.keys(Q).sort();for(const pe of Se){const te=Q[pe],_e=Object.keys(te).sort();for(let De of _e){const He=te[De];if("@type"===De)De=b;else if(V(De))continue;for(const rt of He){const Xe={termType:pe.startsWith("_:")?"BlankNode":"NamedNode",value:pe};if(!ce(pe))continue;const Je={termType:De.startsWith("_:")?"BlankNode":"NamedNode",value:De};if(!ce(De)||"BlankNode"===Je.termType&&!ee.produceGeneralizedRdf)continue;const Ke=w(rt,oe,z,se,ee.rdfDirection);Ke&&z.push({subject:Xe,predicate:Je,object:Ke,graph:se})}}}}function w(z,Q,se,oe,ee){const Se={};if(L.isValue(z)){Se.termType="Literal",Se.value=void 0,Se.datatype={termType:"NamedNode"};let pe=z["@value"];const te=z["@type"]||null;"@json"===te?(Se.value=ie(pe),Se.datatype.value=y):$.isBoolean(pe)?(Se.value=pe.toString(),Se.datatype.value=te||x):$.isDouble(pe)||te===j?($.isDouble(pe)||(pe=parseFloat(pe)),Se.value=pe.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Se.datatype.value=te||j):$.isNumber(pe)?(Se.value=pe.toFixed(0),Se.datatype.value=te||O):"i18n-datatype"===ee&&"@direction"in z?(Se.datatype.value="https://www.w3.org/ns/i18n#"+(z["@language"]||"")+`_${z["@direction"]}`,Se.value=pe):"@language"in z?(Se.value=pe,Se.datatype.value=te||E,Se.language=z["@language"]):(Se.value=pe,Se.datatype.value=te||q)}else if(L.isList(z)){const pe=function(z,Q,se,oe,ee){const Se={termType:"NamedNode",value:S},pe={termType:"NamedNode",value:N},te={termType:"NamedNode",value:M},_e=z.pop(),De=_e?{termType:"BlankNode",value:Q.getId()}:te;let He=De;for(const rt of z){const Xe=w(rt,Q,se,oe,ee),Je={termType:"BlankNode",value:Q.getId()};se.push({subject:He,predicate:Se,object:Xe,graph:oe}),se.push({subject:He,predicate:pe,object:Je,graph:oe}),He=Je}if(_e){const rt=w(_e,Q,se,oe,ee);se.push({subject:He,predicate:Se,object:rt,graph:oe}),se.push({subject:He,predicate:pe,object:te,graph:oe})}return De}(z["@list"],Q,se,oe,ee);Se.termType=pe.termType,Se.value=pe.value}else{const pe=$.isObject(z)?z["@id"]:z;Se.termType=pe.startsWith("_:")?"BlankNode":"NamedNode",Se.value=pe}return"NamedNode"!==Se.termType||ce(Se.value)?Se:null}Te.exports=D,D.toRDF=(z,Q)=>{const se=new v.IdentifierIssuer("_:b"),oe={"@default":{}};K(z,oe,"@default",se);const ee=[],Se=Object.keys(oe).sort();for(const pe of Se){let te;if("@default"===pe)te={termType:"DefaultGraph",value:""};else{if(!ce(pe))continue;te=pe.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},te.value=pe}I(ee,oe[pe],te,se,Q)}return ee}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(Y,Te,fe){"use strict";const K={};Te.exports=K,K.isArray=Array.isArray,K.isBoolean=V=>"boolean"==typeof V||"[object Boolean]"===Object.prototype.toString.call(V),K.isDouble=V=>K.isNumber(V)&&(-1!==String(V).indexOf(".")||Math.abs(V)>=1e21),K.isEmptyObject=V=>K.isObject(V)&&0===Object.keys(V).length,K.isNumber=V=>"number"==typeof V||"[object Number]"===Object.prototype.toString.call(V),K.isNumeric=V=>!isNaN(parseFloat(V))&&isFinite(V),K.isObject=V=>"[object Object]"===Object.prototype.toString.call(V),K.isString=V=>"string"==typeof V||"[object String]"===Object.prototype.toString.call(V),K.isUndefined=V=>void 0===V},{}],31:[function(Y,Te,fe){"use strict";const K=Y("./types"),V={};Te.exports=V,V.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},V.parse=(ie,$)=>{const v={},S=V.parsers[$||"full"],N=S.regex.exec(ie);let M=S.keys.length;for(;M--;)v[S.keys[M]]=void 0===N[M]?null:N[M];return("https"===v.scheme&&"443"===v.port||"http"===v.scheme&&"80"===v.port)&&(v.href=v.href.replace(":"+v.port,""),v.authority=v.authority.replace(":"+v.port,""),v.port=null),v.normalizedPath=V.removeDotSegments(v.path),v},V.prependBase=(ie,$)=>{if(null===ie||V.isAbsolute($))return $;(!ie||K.isString(ie))&&(ie=V.parse(ie||""));const v=V.parse($),S={protocol:ie.protocol||""};if(null!==v.authority)S.authority=v.authority,S.path=v.path,S.query=v.query;else if(S.authority=ie.authority,""===v.path)S.path=ie.path,S.query=null!==v.query?v.query:ie.query;else{if(0===v.path.indexOf("/"))S.path=v.path;else{let M=ie.path;M=M.substr(0,M.lastIndexOf("/")+1),(M.length>0||ie.authority)&&"/"!==M.substr(-1)&&(M+="/"),M+=v.path,S.path=M}S.query=v.query}""!==v.path&&(S.path=V.removeDotSegments(S.path));let N=S.protocol;return null!==S.authority&&(N+="//"+S.authority),N+=S.path,null!==S.query&&(N+="?"+S.query),null!==v.fragment&&(N+="#"+v.fragment),""===N&&(N="./"),N},V.removeBase=(ie,$)=>{if(null===ie)return $;(!ie||K.isString(ie))&&(ie=V.parse(ie||""));let v="";if(""!==ie.href?v+=(ie.protocol||"")+"//"+(ie.authority||""):$.indexOf("//")&&(v+="//"),0!==$.indexOf(v))return $;const S=V.parse($.substr(v.length)),N=ie.normalizedPath.split("/"),M=S.normalizedPath.split("/"),b=S.fragment||S.query?0:1;for(;N.length>0&&M.length>b&&N[0]===M[0];)N.shift(),M.shift();let y="";if(N.length>0){N.pop();for(let E=0;E<N.length;++E)y+="../"}return y+=M.join("/"),null!==S.query&&(y+="?"+S.query),null!==S.fragment&&(y+="#"+S.fragment),""===y&&(y="./"),y},V.removeDotSegments=ie=>{if(0===ie.length)return"";const $=ie.split("/"),v=[];for(;$.length>0;){const S=$.shift(),N=0===$.length;"."!==S?".."!==S?v.push(S):(v.pop(),N&&v.push("")):N&&v.push("")}return"/"===ie[0]&&v.length>0&&""!==v[0]&&v.unshift(""),1===v.length&&""===v[0]?"/":v.join("/")};const L=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;V.isAbsolute=ie=>K.isString(ie)&&L.test(ie),V.isRelative=ie=>K.isString(ie)},{"./types":30}],32:[function(Y,Te,fe){"use strict";const K=Y("./graphTypes"),V=Y("./types"),L=Y("rdf-canonize").IdentifierIssuer,ie=Y("./JsonLdError"),$=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,v=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,S=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,N_headers={accept:"application/ld+json, application/json"},M={};function b(y,E){if(V.isArray(E))for(let x=0;x<E.length;++x)E[x]=b(y,E[x]);else if(K.isList(E))E["@list"]=b(y,E["@list"]);else if(V.isObject(E)){K.isBlankNode(E)&&(E["@id"]=y.getId(E["@id"]));const x=Object.keys(E).sort();for(let j=0;j<x.length;++j){const O=x[j];"@id"!==O&&(E[O]=b(y,E[O]))}}return E}Te.exports=M,M.IdentifierIssuer=L,M.clone=function(y){if(y&&"object"==typeof y){let E;if(V.isArray(y)){E=[];for(let x=0;x<y.length;++x)E[x]=M.clone(y[x])}else if(y instanceof Map){E=new Map;for(const[x,j]of y)E.set(x,M.clone(j))}else if(y instanceof Set){E=new Set;for(const x of y)E.add(M.clone(x))}else if(V.isObject(y)){E={};for(const x in y)E[x]=M.clone(y[x])}else E=y.toString();return E}return y},M.asArray=function(y){return Array.isArray(y)?y:[y]},M.buildHeaders=(y={})=>{if(Object.keys(y).some(x=>"accept"===x.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+N_headers.accept+'" is supported.');return Object.assign({Accept:N_headers.accept},y)},M.parseLinkHeader=y=>{const E={},x=y.match($);for(let j=0;j<x.length;++j){let O=x[j].match(v);if(!O)continue;const q={target:O[1]},ce=O[2];for(;O=S.exec(ce);)q[O[1]]=void 0===O[2]?O[3]:O[2];const D=q.rel||"";Array.isArray(E[D])?E[D].push(q):E[D]=E.hasOwnProperty(D)?[E[D],q]:q}return E},M.validateTypeValue=(y,E)=>{if(!(V.isString(y)||V.isArray(y)&&y.every(x=>V.isString(x)))){if(E&&V.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&M.asArray(y["@default"]).every(x=>V.isString(x)))return}throw new ie('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},M.hasProperty=(y,E)=>{if(y.hasOwnProperty(E)){const x=y[E];return!V.isArray(x)||x.length>0}return!1},M.hasValue=(y,E,x)=>{if(M.hasProperty(y,E)){let j=y[E];const O=K.isList(j);if(V.isArray(j)||O){O&&(j=j["@list"]);for(let q=0;q<j.length;++q)if(M.compareValues(x,j[q]))return!0}else if(!V.isArray(x))return M.compareValues(x,j)}return!1},M.addValue=(y,E,x,j)=>{if("propertyIsArray"in(j=j||{})||(j.propertyIsArray=!1),"valueIsArray"in j||(j.valueIsArray=!1),"allowDuplicate"in j||(j.allowDuplicate=!0),"prependValue"in j||(j.prependValue=!1),j.valueIsArray)y[E]=x;else if(V.isArray(x)){0===x.length&&j.propertyIsArray&&!y.hasOwnProperty(E)&&(y[E]=[]),j.prependValue&&(x=x.concat(y[E]),y[E]=[]);for(let O=0;O<x.length;++O)M.addValue(y,E,x[O],j)}else if(y.hasOwnProperty(E)){const O=!j.allowDuplicate&&M.hasValue(y,E,x);!V.isArray(y[E])&&(!O||j.propertyIsArray)&&(y[E]=[y[E]]),O||(j.prependValue?y[E].unshift(x):y[E].push(x))}else y[E]=j.propertyIsArray?[x]:x},M.getValues=(y,E)=>[].concat(y[E]||[]),M.removeProperty=(y,E)=>{delete y[E]},M.removeValue=(y,E,x,j)=>{"propertyIsArray"in(j=j||{})||(j.propertyIsArray=!1);const O=M.getValues(y,E).filter(q=>!M.compareValues(q,x));0===O.length?M.removeProperty(y,E):y[E]=1!==O.length||j.propertyIsArray?O:O[0]},M.relabelBlankNodes=(y,E)=>b((E=E||{}).issuer||new L("_:b"),y),M.compareValues=(y,E)=>!!(y===E||K.isValue(y)&&K.isValue(E)&&y["@value"]===E["@value"]&&y["@type"]===E["@type"]&&y["@language"]===E["@language"]&&y["@index"]===E["@index"])||!!(V.isObject(y)&&"@id"in y&&V.isObject(E)&&"@id"in E)&&y["@id"]===E["@id"],M.compareShortestLeast=(y,E)=>y.length<E.length?-1:E.length<y.length?1:y===E?0:y<E?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(Y,Te,fe){"use strict";const K=Y("yallist"),V=Symbol("max"),L=Symbol("length"),ie=Symbol("lengthCalculator"),$=Symbol("allowStale"),v=Symbol("maxAge"),S=Symbol("dispose"),N=Symbol("noDisposeOnSet"),M=Symbol("lruList"),b=Symbol("cache"),y=Symbol("updateAgeOnGet"),E=()=>1;const j=(X,w,z)=>{const Q=X[b].get(w);if(Q){const se=Q.value;if(O(X,se)){if(ce(X,Q),!X[$])return}else z&&(X[y]&&(Q.value.now=Date.now()),X[M].unshiftNode(Q));return se.value}},O=(X,w)=>{if(!w||!w.maxAge&&!X[v])return!1;const z=Date.now()-w.now;return w.maxAge?z>w.maxAge:X[v]&&z>X[v]},q=X=>{if(X[L]>X[V])for(let w=X[M].tail;X[L]>X[V]&&null!==w;){const z=w.prev;ce(X,w),w=z}},ce=(X,w)=>{if(w){const z=w.value;X[S]&&X[S](z.key,z.value),X[L]-=z.length,X[b].delete(z.key),X[M].removeNode(w)}};class D{constructor(w,z,Q,se,oe){this.key=w,this.value=z,this.length=Q,this.now=se,this.maxAge=oe||0}}const I=(X,w,z,Q)=>{let se=z.value;O(X,se)&&(ce(X,z),X[$]||(se=void 0)),se&&w.call(Q,se.value,se.key,X)};Te.exports=class{constructor(w){if("number"==typeof w&&(w={max:w}),w||(w={}),w.max&&("number"!=typeof w.max||w.max<0))throw new TypeError("max must be a non-negative number");this[V]=w.max||1/0;const Q=w.length||E;if(this[ie]="function"!=typeof Q?E:Q,this[$]=w.stale||!1,w.maxAge&&"number"!=typeof w.maxAge)throw new TypeError("maxAge must be a number");this[v]=w.maxAge||0,this[S]=w.dispose,this[N]=w.noDisposeOnSet||!1,this[y]=w.updateAgeOnGet||!1,this.reset()}set max(w){if("number"!=typeof w||w<0)throw new TypeError("max must be a non-negative number");this[V]=w||1/0,q(this)}get max(){return this[V]}set allowStale(w){this[$]=!!w}get allowStale(){return this[$]}set maxAge(w){if("number"!=typeof w)throw new TypeError("maxAge must be a non-negative number");this[v]=w,q(this)}get maxAge(){return this[v]}set lengthCalculator(w){"function"!=typeof w&&(w=E),w!==this[ie]&&(this[ie]=w,this[L]=0,this[M].forEach(z=>{z.length=this[ie](z.value,z.key),this[L]+=z.length})),q(this)}get lengthCalculator(){return this[ie]}get length(){return this[L]}get itemCount(){return this[M].length}rforEach(w,z){z=z||this;for(let Q=this[M].tail;null!==Q;){const se=Q.prev;I(this,w,Q,z),Q=se}}forEach(w,z){z=z||this;for(let Q=this[M].head;null!==Q;){const se=Q.next;I(this,w,Q,z),Q=se}}keys(){return this[M].toArray().map(w=>w.key)}values(){return this[M].toArray().map(w=>w.value)}reset(){this[S]&&this[M]&&this[M].length&&this[M].forEach(w=>this[S](w.key,w.value)),this[b]=new Map,this[M]=new K,this[L]=0}dump(){return this[M].map(w=>!O(this,w)&&{k:w.key,v:w.value,e:w.now+(w.maxAge||0)}).toArray().filter(w=>w)}dumpLru(){return this[M]}set(w,z,Q){if((Q=Q||this[v])&&"number"!=typeof Q)throw new TypeError("maxAge must be a number");const se=Q?Date.now():0,oe=this[ie](z,w);if(this[b].has(w)){if(oe>this[V])return ce(this,this[b].get(w)),!1;const pe=this[b].get(w).value;return this[S]&&(this[N]||this[S](w,pe.value)),pe.now=se,pe.maxAge=Q,pe.value=z,this[L]+=oe-pe.length,pe.length=oe,this.get(w),q(this),!0}const ee=new D(w,z,oe,se,Q);return ee.length>this[V]?(this[S]&&this[S](w,z),!1):(this[L]+=ee.length,this[M].unshift(ee),this[b].set(w,this[M].head),q(this),!0)}has(w){if(!this[b].has(w))return!1;const z=this[b].get(w).value;return!O(this,z)}get(w){return j(this,w,!0)}peek(w){return j(this,w,!1)}pop(){const w=this[M].tail;return w?(ce(this,w),w.value):null}del(w){ce(this,this[b].get(w))}load(w){this.reset();const z=Date.now();for(let Q=w.length-1;Q>=0;Q--){const se=w[Q],oe=se.e||0;if(0===oe)this.set(se.k,se.v);else{const ee=oe-z;ee>0&&this.set(se.k,se.v,ee)}}}prune(){this[b].forEach((w,z)=>j(this,z,!1))}}},{yallist:92}],34:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;const K="http://www.w3.org/1999/02/22-rdf-syntax-ns#",V="http://www.w3.org/2001/XMLSchema#",L="http://www.w3.org/2000/10/swap/";fe.default={xsd:{decimal:`${V}decimal`,boolean:`${V}boolean`,double:`${V}double`,integer:`${V}integer`,string:`${V}string`},rdf:{type:`${K}type`,nil:`${K}nil`,first:`${K}first`,rest:`${K}rest`,langString:`${K}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${L}reify#forSome`,forAll:`${L}reify#forAll`},log:{implies:`${L}log#implies`}}},{}],35:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=fe.Variable=fe.Triple=fe.Term=fe.Quad=fe.NamedNode=fe.Literal=fe.DefaultGraph=fe.BlankNode=void 0,fe.escapeQuotes=w,fe.termFromId=function D(te,_e){if(_e=_e||b,!te)return _e.defaultGraph();switch(te[0]){case"?":return _e.variable(te.substr(1));case"_":return _e.blankNode(te.substr(2));case'"':if(_e===b)return new j(te);if('"'===te[te.length-1])return _e.literal(te.substr(1,te.length-2));const De=te.lastIndexOf('"',te.length-1);return _e.literal(te.substr(1,De-1),"@"===te[De+1]?te.substr(De+2):_e.namedNode(te.substr(De+3)));case"<":const He=M.exec(te);return _e.quad(D(z(He[1]),_e),D(z(He[2]),_e),D(z(He[3]),_e),He[4]&&D(z(He[4]),_e));default:return _e.namedNode(te)}},fe.termToId=function I(te){if("string"==typeof te)return te;if(te instanceof E&&"Quad"!==te.termType)return te.id;if(!te)return v.id;switch(te.termType){case"NamedNode":return te.value;case"BlankNode":return`_:${te.value}`;case"Variable":return`?${te.value}`;case"DefaultGraph":return"";case"Literal":return`"${te.value}"${te.language?`@${te.language}`:te.datatype&&te.datatype.value!==$.string?`^^${te.datatype.value}`:""}`;case"Quad":return`<<${w(I(te.subject))} ${w(I(te.predicate))} ${w(I(te.object))}${(0,V.isDefaultGraph)(te.graph)?"":` ${I(te.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${te.termType}`)}},fe.unescapeQuotes=z;var te,K=(te=Y("./IRIs"))&&te.__esModule?te:{default:te},V=Y("./N3Util");const{rdf:ie,xsd:$}=K.default;let v,S=0;const N=/^"(.*".*)(?="[^"]*$)/,M=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,b={namedNode:function(te){return new x(te)},blankNode:function(te){return new O(te||"n3-"+S++)},variable:function(te){return new q(te)},literal:function(te,_e){if("string"==typeof _e)return new j(`"${te}"@${_e.toLowerCase()}`);let De=_e?_e.value:"";return""===De&&("boolean"==typeof te?De=$.boolean:"number"==typeof te&&(Number.isFinite(te)?De=Number.isInteger(te)?$.integer:$.double:(De=$.double,Number.isNaN(te)||(te=te>0?"INF":"-INF")))),new j(""===De||De===$.string?`"${te}"`:`"${te}"^^${De}`)},defaultGraph:function(){return v},quad:pe,triple:pe};fe.default=b;class E{constructor(_e){this.id=_e}get value(){return this.id}equals(_e){return _e instanceof E?this.id===_e.id:!!_e&&this.termType===_e.termType&&this.value===_e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}fe.Term=E;class x extends E{get termType(){return"NamedNode"}}fe.NamedNode=x;class j extends E{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const _e=this.id;let De=_e.lastIndexOf('"')+1;return De<_e.length&&"@"===_e[De++]?_e.substr(De).toLowerCase():""}get datatype(){return new x(this.datatypeString)}get datatypeString(){const _e=this.id,De=_e.lastIndexOf('"')+1,He=De<_e.length?_e[De]:"";return"^"===He?_e.substr(De+2):"@"!==He?$.string:ie.langString}equals(_e){return _e instanceof j?this.id===_e.id:!!_e&&!!_e.datatype&&this.termType===_e.termType&&this.value===_e.value&&this.language===_e.language&&this.datatype.value===_e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}fe.Literal=j;class O extends E{constructor(_e){super(`_:${_e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}fe.BlankNode=O;class q extends E{constructor(_e){super(`?${_e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}fe.Variable=q;class ce extends E{constructor(){return super(""),v||this}get termType(){return"DefaultGraph"}equals(_e){return this===_e||!!_e&&this.termType===_e.termType}}fe.DefaultGraph=ce,v=new ce;class X extends E{constructor(_e,De,He,rt){super(""),this._subject=_e,this._predicate=De,this._object=He,this._graph=rt||v}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(_e){return!!_e&&this._subject.equals(_e.subject)&&this._predicate.equals(_e.predicate)&&this._object.equals(_e.object)&&this._graph.equals(_e.graph)}}function w(te){return te.replace(N,(_e,De)=>`"${De.replace(/"/g,'""')}`)}function z(te){return te.replace(N,(_e,De)=>`"${De.replace(/""/g,'"')}`)}function pe(te,_e,De,He){return new X(te,_e,De,He)}fe.Triple=fe.Quad=X},{"./IRIs":34,"./N3Util":41}],36:[function(Y,Te,fe){(function(K){(function(){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var V=ie(Y("./IRIs")),L=ie(Y("queue-microtask"));function ie(E){return E&&E.__esModule?E:{default:E}}const{xsd:$}=V.default,v=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,S={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},N=/[\x00-\x20<>\\"\{\}\|\^\`]/,M={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},b=/$0^/;fe.default=class{constructor(x){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(x=x||{}).lineMode){this._n3Mode=!1;for(const j in this)!(j in M)&&this[j]instanceof RegExp&&(this[j]=b)}else this._n3Mode=!1!==x.n3;this._comments=!!x.comments,this._literalClosingPos=0}_tokenizeToEnd(x,j){let O=this._input,q=O.length;for(;;){let I,X;for(;I=this._newline.exec(O);)this._comments&&(X=this._comment.exec(I[0]))&&ce("comment",X[1],"",this._line,I[0].length),O=O.substr(I[0].length,O.length),q=O.length,this._line++;if(!I&&(I=this._whitespace.exec(O))&&(O=O.substr(I[0].length,O.length)),this._endOfFile.test(O))return j&&(this._comments&&(X=this._comment.exec(O))&&ce("comment",X[1],"",this._line,O.length),O=null,ce("eof","","",this._line,0)),this._input=O;const w=this._line,z=O[0];let Q="",se="",oe="",ee=null,Se=0,pe=!1;switch(z){case"^":if(O.length<3)break;if("^"!==O[1]){this._n3Mode&&(Se=1,Q="^");break}if(this._previousMarker="^^",O=O.substr(2),"<"!==O[0]){pe=!0;break}case"<":if(ee=this._unescapedIri.exec(O))Q="IRI",se=ee[1];else if(ee=this._iri.exec(O)){if(se=this._unescape(ee[1]),null===se||N.test(se))return D(this);Q="IRI"}else O.length>1&&"<"===O[1]?(Q="<<",Se=2):this._n3Mode&&O.length>1&&"="===O[1]&&(Q="inverse",Se=2,se=">");break;case">":O.length>1&&">"===O[1]&&(Q=">>",Se=2);break;case"_":((ee=this._blank.exec(O))||j&&(ee=this._blank.exec(`${O} `)))&&(Q="blank",oe="_",se=ee[1]);break;case'"':if(ee=this._simpleQuotedString.exec(O))se=ee[1];else if(({value:se,matchLength:Se}=this._parseLiteral(O)),null===se)return D(this);(null!==ee||0!==Se)&&(Q="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(ee=this._simpleApostropheString.exec(O))se=ee[1];else if(({value:se,matchLength:Se}=this._parseLiteral(O)),null===se)return D(this);(null!==ee||0!==Se)&&(Q="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(ee=this._variable.exec(O))&&(Q="var",se=ee[0]);break;case"@":"literal"===this._previousMarker&&(ee=this._langcode.exec(O))?(Q="langcode",se=ee[1]):(ee=this._keyword.exec(O))&&(Q=ee[0]);break;case".":if(1===O.length?j:O[1]<"0"||O[1]>"9"){Q=".",Se=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(ee=this._number.exec(O)||j&&(ee=this._number.exec(`${O} `)))&&(Q="literal",se=ee[0],oe="string"==typeof ee[1]?$.double:"string"==typeof ee[2]?$.decimal:$.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(ee=this._sparqlKeyword.exec(O))?Q=ee[0].toUpperCase():pe=!0;break;case"f":case"t":(ee=this._boolean.exec(O))?(Q="literal",se=ee[0],oe=$.boolean):pe=!0;break;case"a":(ee=this._shortPredicates.exec(O))?(Q="abbreviation",se="a"):pe=!0;break;case"=":this._n3Mode&&O.length>1&&(Q="abbreviation",">"!==O[1]?(Se=1,se="="):(Se=2,se=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(Se=1,Q=z);break;default:pe=!0}if(pe&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(ee=this._prefix.exec(O))?((ee=this._prefixed.exec(O))||j&&(ee=this._prefixed.exec(`${O} `)))&&(Q="prefixed",oe=ee[1]||"",se=this._unescape(ee[2])):(Q="prefix",se=ee[1]||"")),"^^"===this._previousMarker)switch(Q){case"prefixed":Q="type";break;case"IRI":Q="typeIRI";break;default:Q=""}if(!Q)return j||!/^'''|^"""/.test(O)&&/\n|\r/.test(O)?D(this):this._input=O;const te=Se||ee[0].length,_e=ce(Q,se,oe,w,te);this.previousToken=_e,this._previousMarker=Q,O=O.substr(te,O.length)}function ce(I,X,w,z,Q){const se=O?q-O.length:q,ee={type:I,value:X,prefix:w,line:z,start:se,end:se+Q};return x(null,ee),ee}function D(I){x(I._syntaxError(/^\S*/.exec(O)[0]))}}_unescape(x){let j=!1;const O=x.replace(v,(q,ce,D,I)=>{if("string"==typeof ce)return String.fromCharCode(Number.parseInt(ce,16));if("string"==typeof D){let X=Number.parseInt(D,16);return X<=65535?String.fromCharCode(Number.parseInt(D,16)):String.fromCharCode(55296+((X-=65536)>>10),56320+(1023&X))}return I in S?S[I]:(j=!0,"")});return j?null:O}_parseLiteral(x){if(x.length>=3){const j=x.match(/^(?:"""|"|'''|'|)/)[0],O=j.length;let q=Math.max(this._literalClosingPos,O);for(;(q=x.indexOf(j,q))>0;){let ce=0;for(;"\\"===x[q-ce-1];)ce++;if(ce%2==0){const D=x.substring(O,q),I=D.split(/\r\n|\r|\n/).length-1,X=q+O;if(1===O&&0!==I||3===O&&this._lineMode)break;return this._line+=I,{value:this._unescape(D),matchLength:X}}q++}this._literalClosingPos=x.length-O+1}return{value:"",matchLength:0}}_syntaxError(x){this._input=null;const j=new Error(`Unexpected "${x}" on line ${this._line}.`);return j.context={token:void 0,line:this._line,previousToken:this.previousToken},j}_readStartingBom(x){return x.startsWith("\ufeff")?x.substr(1):x}tokenize(x,j){if(this._line=1,"string"==typeof x){if(this._input=this._readStartingBom(x),"function"!=typeof j){const O=[];let q;if(this._tokenizeToEnd((ce,D)=>ce?q=ce:O.push(D),!0),q)throw q;return O}(0,L.default)(()=>this._tokenizeToEnd(j,!0))}else this._pendingBuffer=null,"function"==typeof x.setEncoding&&x.setEncoding("utf8"),x.on("data",O=>{null!==this._input&&0!==O.length&&(this._pendingBuffer&&(O=K.concat([this._pendingBuffer,O]),this._pendingBuffer=null),128&O[O.length-1]?this._pendingBuffer=O:(void 0===this._input?this._input=this._readStartingBom("string"==typeof O?O:O.toString()):this._input+=O,this._tokenizeToEnd(j,!1)))}),x.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(j,!0)}),x.on("error",j)}}}).call(this)}).call(this,Y("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var K=ie(Y("./N3Lexer")),V=ie(Y("./N3DataFactory")),L=ie(Y("./IRIs"));function ie(M){return M&&M.__esModule?M:{default:M}}let $=0;class v{constructor(b){this._contextStack=[],this._graph=null,this._setBase((b=b||{}).baseIRI),b.factory&&N(this,b.factory);const y="string"==typeof b.format?b.format.match(/\w*$/)[0].toLowerCase():"",E=/turtle/.test(y),x=/trig/.test(y),j=/triple/.test(y),O=/quad/.test(y),q=this._n3Mode=/n3/.test(y),ce=j||O;(this._supportsNamedGraphs=!(E||q))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(E||x||j||q),this._supportsRDFStar=""===y||/star|\*$/.test(y),ce&&(this._resolveRelativeIRI=D=>null),this._blankNodePrefix="string"!=typeof b.blankNodePrefix?"":b.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=b.lexer||new K.default({lineMode:ce,n3:q}),this._explicitQuantifiers=!!b.explicitQuantifiers}static _resetBlankNodePrefix(){$=0}_setBase(b){if(b){const y=b.indexOf("#");y>=0&&(b=b.substr(0,y)),this._base=b,this._basePath=b.indexOf("/")<0?b:b.replace(/[^\/?]*(?:\?.*)?$/,""),b=b.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=b[0],this._baseScheme=b[1]}else this._base="",this._basePath=""}_saveContext(b,y,E,x,j){const O=this._n3Mode;this._contextStack.push({subject:E,predicate:x,object:j,graph:y,type:b,inverse:!!O&&this._inversePredicate,blankPrefix:O?this._prefixes._:"",quantified:O?this._quantified:null}),O&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const b=this._contextStack.pop(),y=this._n3Mode;this._subject=b.subject,this._predicate=b.predicate,this._object=b.object,this._graph=b.graph,y&&(this._inversePredicate=b.inverse,this._prefixes._=b.blankPrefix,this._quantified=b.quantified)}_readInTopContext(b){switch(b.type){case"eof":return null!==this._graph?this._error("Unclosed graph",b):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(b)}}_readEntity(b,y){let E;switch(b.type){case"IRI":case"typeIRI":const x=this._resolveIRI(b.value);if(null===x)return this._error("Invalid IRI",b);E=this._namedNode(x);break;case"type":case"prefixed":const j=this._prefixes[b.prefix];if(void 0===j)return this._error(`Undefined prefix "${b.prefix}:"`,b);E=this._namedNode(j+b.value);break;case"blank":E=this._blankNode(this._prefixes[b.prefix]+b.value);break;case"var":E=this._variable(b.value.substr(1));break;default:return this._error(`Expected entity but got ${b.type}`,b)}return!y&&this._n3Mode&&E.id in this._quantified&&(E=this._quantified[E.id]),E}_readSubject(b){switch(this._predicate=null,b.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",b);case"}":return this._readPunctuation(b);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',b);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',b);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",b);if(0===b.prefix.length)return this._literalValue=b.value,this._completeSubjectLiteral;this._subject=this._literal(b.value,this._namedNode(b.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",b);default:if(void 0===(this._subject=this._readEntity(b)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(b){const y=b.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[b.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,b):(this._subject=null,"]"===y?this._readBlankNodeTail(b):this._readPunctuation(b));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",b);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",b);default:if(void 0===(this._predicate=this._readEntity(b)))return}return this._readObject}_readObject(b){switch(b.type){case"literal":if(0===b.prefix.length)return this._literalValue=b.value,this._readDataTypeOrLang;this._object=this._literal(b.value,this._namedNode(b.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",b);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",b);default:if(void 0===(this._object=this._readEntity(b)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(b){return"{"===b.type?this._readGraph(b):this._readPredicate(b)}_readGraph(b){return"{"!==b.type?this._error(`Expected graph but got ${b.type}`,b):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(b){return"]"===b.type?(this._subject=null,this._readBlankNodeTail(b)):(this._predicate=null,this._readPredicate(b))}_readBlankNodeTail(b){if("]"!==b.type)return this._readBlankNodePunctuation(b);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(b){switch(b.type){case".":case"}":return this._subject=null,this._readPunctuation(b);default:return this._readPredicate(b)}}_readListItem(b){let y=null,E=null,x=this._readListItem;const j=this._subject,O=this._contextStack,q=O[O.length-1];switch(b.type){case"[":this._saveContext("blank",this._graph,E=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),x=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,E=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==O.length&&"list"===O[O.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(x=this._readPredicate,this._subject===this.RDF_NIL)return x}else if(x=this._getContextEndReader(),this._object===this.RDF_NIL)return x;E=this.RDF_NIL;break;case"literal":0===b.prefix.length?(this._literalValue=b.value,x=this._readListItemDataTypeOrLang):(y=this._literal(b.value,this._namedNode(b.prefix)),x=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",b);default:if(void 0===(y=this._readEntity(b)))return}if(null===E&&(this._subject=E=this._blankNode()),null===j?null===q.predicate?q.subject=E:q.object=E:this._emit(j,this.RDF_REST,E,this._graph),null!==y){if(this._n3Mode&&("IRI"===b.type||"prefixed"===b.type))return this._saveContext("item",this._graph,E,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(E,this.RDF_FIRST,y,this._graph)}return x}_readDataTypeOrLang(b){return this._completeObjectLiteral(b,!1)}_readListItemDataTypeOrLang(b){return this._completeObjectLiteral(b,!0)}_completeLiteral(b){let y=this._literal(this._literalValue);switch(b.type){case"type":case"typeIRI":const E=this._readEntity(b);if(void 0===E)return;y=this._literal(this._literalValue,E),b=null;break;case"langcode":y=this._literal(this._literalValue,b.value),b=null}return{token:b,literal:y}}_completeSubjectLiteral(b){return this._subject=this._completeLiteral(b).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(b,y){const E=this._completeLiteral(b);if(E)return this._object=E.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===E.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(E.token))}_readFormulaTail(b){return"}"!==b.type?this._readPunctuation(b):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(b){let y,E=this._graph;const x=this._subject,j=this._inversePredicate;switch(b.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",b);if(this._n3Mode)return this._readFormulaTail(b);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,j&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(E=this._readEntity(b))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,b)}if(null!==x){const O=this._predicate,q=this._object;j?this._emit(q,O,x,E):this._emit(x,O,q,E)}return y}_readBlankNodePunctuation(b){let y;switch(b.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,b)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(b){return"."!==b.type?this._error("Expected dot to follow quad",b):this._readInTopContext}_readPrefix(b){return"prefix"!==b.type?this._error("Expected prefix to follow @prefix",b):(this._prefix=b.value,this._readPrefixIRI)}_readPrefixIRI(b){if("IRI"!==b.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,b);const y=this._readEntity(b);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(b){const y="IRI"===b.type&&this._resolveIRI(b.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",b)}_readNamedGraphLabel(b){switch(b.type){case"IRI":case"blank":case"prefixed":return this._readSubject(b),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",b)}}_readNamedGraphBlankLabel(b){return"]"!==b.type?this._error("Invalid graph label",b):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(b){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(b)):"."!==b.type?this._error("Expected declaration to end with a dot",b):this._readInTopContext}_readQuantifierList(b){let y;switch(b.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(b,!0)))break;default:return this._error(`Unexpected ${b.type}`,b)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(b){return","===b.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(b))}_getPathReader(b){return this._afterPath=b,this._readPath}_readPath(b){switch(b.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,E=y.length&&y[y.length-1];if(E&&"item"===E.type){const x=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,x,this._graph)}return this._afterPath(b)}}_readForwardPath(b){let y,E;const x=this._blankNode();if(void 0!==(E=this._readEntity(b)))return null===this._predicate?(y=this._subject,this._subject=x):(y=this._object,this._object=x),this._emit(y,E,x,this._graph),this._readPath}_readBackwardPath(b){const y=this._blankNode();let E,x;if(void 0!==(E=this._readEntity(b)))return null===this._predicate?(x=this._subject,this._subject=y):(x=this._object,this._object=y),this._emit(y,E,x,this._graph),this._readPath}_readRDFStarTailOrGraph(b){return">>"!==b.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(b))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,b):this._readRDFStarTail(b)}_readRDFStarTail(b){if(">>"!==b.type)return this._error(`Expected >> but got ${b.type}`,b);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const b=this._contextStack;if(!b.length)return this._readPunctuation;switch(b[b.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(b,y,E,x){this._callback(null,this._quad(b,y,E,x||this.DEFAULTGRAPH))}_error(b,y){const E=new Error(`${b} on line ${y.line}.`);E.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(E),this._callback=S}_resolveIRI(b){return/^[a-z][a-z0-9+.-]*:/i.test(b)?b:this._resolveRelativeIRI(b)}_resolveRelativeIRI(b){if(!b.length)return this._base;switch(b[0]){case"#":return this._base+b;case"?":return this._base.replace(/(?:\?.*)?$/,b);case"/":return("/"===b[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(b);default:return/^[^/:]*:/.test(b)?null:this._removeDotSegments(this._basePath+b)}}_removeDotSegments(b){if(!/(^|\/)\.\.?($|[/#?])/.test(b))return b;const y=b.length;let E="",x=-1,j=-1,O=0,q="/";for(;x<y;){switch(q){case":":if(j<0&&"/"===b[++x]&&"/"===b[++x])for(;(j=x+1)<y&&"/"!==b[j];)x=j;break;case"?":case"#":x=y;break;case"/":if("."===b[x+1])switch(q=b[1+ ++x],q){case"/":E+=b.substring(O,x-1),O=x+1;break;case void 0:case"?":case"#":return E+b.substring(O,x)+b.substr(x+1);case".":if(q=b[1+ ++x],void 0===q||"/"===q||"?"===q||"#"===q){if(E+=b.substring(O,x-2),(O=E.lastIndexOf("/"))>=j&&(E=E.substr(0,O)),"/"!==q)return`${E}/${b.substr(x+1)}`;O=x+1}}}q=b[++x]}return E+b.substring(O)}parse(b,y,E){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${$++}_`,this._prefixCallback=E||S,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const x=[];let j;if(this._callback=(O,q)=>{O?j=O:q&&x.push(q)},this._lexer.tokenize(b).every(O=>this._readCallback=this._readCallback(O)),j)throw j;return x}this._callback=y,this._lexer.tokenize(b,(x,j)=>{null!==x?(this._callback(x),this._callback=S):this._readCallback&&(this._readCallback=this._readCallback(j))})}}function S(){}function N(M,b){const y=b.namedNode;M._namedNode=y,M._blankNode=b.blankNode,M._literal=b.literal,M._variable=b.variable,M._quad=b.quad,M.DEFAULTGRAPH=b.defaultGraph(),M.RDF_FIRST=y(L.default.rdf.first),M.RDF_REST=y(L.default.rdf.rest),M.RDF_NIL=y(L.default.rdf.nil),M.N3_FORALL=y(L.default.r.forAll),M.N3_FORSOME=y(L.default.r.forSome),M.ABBREVIATIONS={a:y(L.default.rdf.type),"=":y(L.default.owl.sameAs),">":y(L.default.log.implies)},M.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}fe.default=v,N(v.prototype,V.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var b,K=function(b,y){if(!y&&b&&b.__esModule)return b;if(null===b||"object"!=typeof b&&"function"!=typeof b)return{default:b};var E=$(y);if(E&&E.has(b))return E.get(b);var x={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in b)if("default"!==O&&Object.prototype.hasOwnProperty.call(b,O)){var q=j?Object.getOwnPropertyDescriptor(b,O):null;q&&(q.get||q.set)?Object.defineProperty(x,O,q):x[O]=b[O]}return x.default=b,E&&E.set(b,x),x}(Y("./N3DataFactory")),V=Y("readable-stream"),L=(b=Y("./IRIs"))&&b.__esModule?b:{default:b};function $(b){if("function"!=typeof WeakMap)return null;var y=new WeakMap,E=new WeakMap;return($=function(x){return x?E:y})(b)}class S{constructor(y,E){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!E&&y&&!y[0]&&(E=y,y=null),this._factory=(E=E||{}).factory||K.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const E=this._graphs;let x,j;for(const O in E)for(const q in x=E[O].subjects)for(const ce in j=x[q])y+=Object.keys(j[ce]).length;return this._size=y}_addToIndex(y,E,x,j){const O=y[E]||(y[E]={}),q=O[x]||(O[x]={}),ce=j in q;return ce||(q[j]=null),!ce}_removeFromIndex(y,E,x,j){const O=y[E],q=O[x];delete q[j];for(const ce in q)return;delete O[x];for(const ce in O)return;delete y[E]}*_findInIndex(y,E,x,j,O,q,ce,D){let I,X,w;const Q=!E+!x+!j>1?Object.keys(this._ids):this._entities,se=(0,K.termFromId)(D,this._factory);E&&((I=y,y={})[E]=I[E]);for(const oe in y){const ee=Q[oe];if(X=y[oe]){x&&((I=X,X={})[x]=I[x]);for(const Se in X){const pe=Q[Se];if(w=X[Se]){const te=j?j in w?[j]:[]:Object.keys(w);for(let _e=0;_e<te.length;_e++){const De={subject:null,predicate:null,object:null};De[O]=(0,K.termFromId)(ee,this._factory),De[q]=(0,K.termFromId)(pe,this._factory),De[ce]=(0,K.termFromId)(Q[te[_e]],this._factory),yield this._factory.quad(De.subject,De.predicate,De.object,se)}}}}}}_loop(y,E){for(const x in y)E(x)}_loopByKey0(y,E,x){let j,O;if(j=y[E])for(O in j)x(O)}_loopByKey1(y,E,x){let j,O;for(j in y)O=y[j],O[E]&&x(j)}_loopBy2Keys(y,E,x,j){let O,q,ce;if((O=y[E])&&(q=O[x]))for(ce in q)j(ce)}_countInIndex(y,E,x,j){let q,ce,D,O=0;E&&((q=y,y={})[E]=q[E]);for(const I in y)if(ce=y[I]){x&&((q=ce,ce={})[x]=q[x]);for(const X in ce)(D=ce[X])&&(j?j in D&&O++:O+=Object.keys(D).length)}return O}_getGraphs(y){if(!N(y))return this._graphs;const E={};return E[y]=this._graphs[y],E}_uniqueEntities(y){const E=Object.create(null);return x=>{x in E||(E[x]=!0,y((0,K.termFromId)(this._entities[x],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,E,x,j){E||(j=y.graph,x=y.object,E=y.predicate,y=y.subject),y=(0,K.termToId)(y),E=(0,K.termToId)(E),x=(0,K.termToId)(x),j=(0,K.termToId)(j);let O=this._graphs[j];O||(O=this._graphs[j]={subjects:{},predicates:{},objects:{}},Object.freeze(O));const q=this._ids,ce=this._entities;y=q[y]||(q[ce[++this._id]=y]=this._id),E=q[E]||(q[ce[++this._id]=E]=this._id),x=q[x]||(q[ce[++this._id]=x]=this._id);const D=this._addToIndex(O.subjects,y,E,x);return this._addToIndex(O.predicates,E,x,y),this._addToIndex(O.objects,x,y,E),this._size=null,D}addQuads(y){for(let E=0;E<y.length;E++)this.addQuad(y[E])}delete(y){return this.removeQuad(y),this}has(y,E,x,j){return y&&y.subject&&({subject:y,predicate:E,object:x,graph:j}=y),!this.readQuads(y,E,x,j).next().done}import(y){return y.on("data",E=>{this.addQuad(E)}),y}removeQuad(y,E,x,j){E||(j=y.graph,x=y.object,E=y.predicate,y=y.subject),y=(0,K.termToId)(y),E=(0,K.termToId)(E),x=(0,K.termToId)(x),j=(0,K.termToId)(j);const O=this._ids,q=this._graphs;let ce,D,I;if(!((y=O[y])&&(E=O[E])&&(x=O[x])&&(ce=q[j])&&(D=ce.subjects[y])&&(I=D[E])&&x in I))return!1;for(y in this._removeFromIndex(ce.subjects,y,E,x),this._removeFromIndex(ce.predicates,E,x,y),this._removeFromIndex(ce.objects,x,y,E),null!==this._size&&this._size--,ce.subjects)return!0;return delete q[j],!0}removeQuads(y){for(let E=0;E<y.length;E++)this.removeQuad(y[E])}remove(y){return y.on("data",E=>{this.removeQuad(E)}),y}removeMatches(y,E,x,j){const O=new V.Readable({objectMode:!0});return O._read=()=>{for(const q of this.readQuads(y,E,x,j))O.push(q);O.push(null)},this.remove(O)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,E,x,j){return[...this.readQuads(y,E,x,j)]}*readQuads(y,E,x,j){y=y&&(0,K.termToId)(y),E=E&&(0,K.termToId)(E),x=x&&(0,K.termToId)(x),j=j&&(0,K.termToId)(j);const O=this._getGraphs(j),q=this._ids;let ce,D,I,X;if(!(N(y)&&!(D=q[y])||N(E)&&!(I=q[E])||N(x)&&!(X=q[x])))for(const w in O)(ce=O[w])&&(D?X?yield*this._findInIndex(ce.objects,X,D,I,"object","subject","predicate",w,null,!0):yield*this._findInIndex(ce.subjects,D,I,null,"subject","predicate","object",w,null,!0):I?yield*this._findInIndex(ce.predicates,I,X,null,"predicate","object","subject",w,null,!0):X?yield*this._findInIndex(ce.objects,X,null,null,"object","subject","predicate",w,null,!0):yield*this._findInIndex(ce.subjects,null,null,null,"subject","predicate","object",w,null,!0))}match(y,E,x,j){return new M(this,y,E,x,j)}countQuads(y,E,x,j){y=y&&(0,K.termToId)(y),E=E&&(0,K.termToId)(E),x=x&&(0,K.termToId)(x),j=j&&(0,K.termToId)(j);const O=this._getGraphs(j),q=this._ids;let D,I,X,w,ce=0;if(N(y)&&!(I=q[y])||N(E)&&!(X=q[E])||N(x)&&!(w=q[x]))return 0;for(const z in O)(D=O[z])&&(ce+=y?x?this._countInIndex(D.objects,w,I,X):this._countInIndex(D.subjects,I,X,w):E?this._countInIndex(D.predicates,X,w,I):this._countInIndex(D.objects,w,I,X));return ce}forEach(y,E,x,j,O){this.some(q=>(y(q),!1),E,x,j,O)}every(y,E,x,j,O){let q=!1;const ce=!this.some(D=>(q=!0,!y(D)),E,x,j,O);return q&&ce}some(y,E,x,j,O){for(const q of this.readQuads(E,x,j,O))if(y(q))return!0;return!1}getSubjects(y,E,x){const j=[];return this.forSubjects(O=>{j.push(O)},y,E,x),j}forSubjects(y,E,x,j){E=E&&(0,K.termToId)(E),x=x&&(0,K.termToId)(x),j=j&&(0,K.termToId)(j);const O=this._ids,q=this._getGraphs(j);let ce,D,I;if(y=this._uniqueEntities(y),!(N(E)&&!(D=O[E])||N(x)&&!(I=O[x])))for(j in q)(ce=q[j])&&(D?I?this._loopBy2Keys(ce.predicates,D,I,y):this._loopByKey1(ce.subjects,D,y):I?this._loopByKey0(ce.objects,I,y):this._loop(ce.subjects,y))}getPredicates(y,E,x){const j=[];return this.forPredicates(O=>{j.push(O)},y,E,x),j}forPredicates(y,E,x,j){E=E&&(0,K.termToId)(E),x=x&&(0,K.termToId)(x),j=j&&(0,K.termToId)(j);const O=this._ids,q=this._getGraphs(j);let ce,D,I;if(y=this._uniqueEntities(y),!(N(E)&&!(D=O[E])||N(x)&&!(I=O[x])))for(j in q)(ce=q[j])&&(D?I?this._loopBy2Keys(ce.objects,I,D,y):this._loopByKey0(ce.subjects,D,y):I?this._loopByKey1(ce.predicates,I,y):this._loop(ce.predicates,y))}getObjects(y,E,x){const j=[];return this.forObjects(O=>{j.push(O)},y,E,x),j}forObjects(y,E,x,j){E=E&&(0,K.termToId)(E),x=x&&(0,K.termToId)(x),j=j&&(0,K.termToId)(j);const O=this._ids,q=this._getGraphs(j);let ce,D,I;if(y=this._uniqueEntities(y),!(N(E)&&!(D=O[E])||N(x)&&!(I=O[x])))for(j in q)(ce=q[j])&&(D?I?this._loopBy2Keys(ce.subjects,D,I,y):this._loopByKey1(ce.objects,D,y):I?this._loopByKey0(ce.predicates,I,y):this._loop(ce.objects,y))}getGraphs(y,E,x){const j=[];return this.forGraphs(O=>{j.push(O)},y,E,x),j}forGraphs(y,E,x,j){for(const O in this._graphs)this.some(q=>(y(q.graph),!0),E,x,j,O)}createBlankNode(y){let E,x;if(y)for(E=y=`_:${y}`,x=1;this._ids[E];)E=y+x++;else do{E="_:b"+this._blankNodeIndex++}while(this._ids[E]);return this._ids[E]=++this._id,this._entities[this._id]=E,this._factory.blankNode(E.substr(2))}extractLists({remove:y=!1,ignoreErrors:E=!1}={}){const x={},j=E?()=>!0:(ce,D)=>{throw new Error(`${ce.value} ${D}`)},O=this.getQuads(null,L.default.rdf.rest,L.default.rdf.nil,null),q=y?[...O]:[];return O.forEach(ce=>{const D=[];let X,w,I=!1;const z=ce.graph;let Q=ce.subject;for(;Q&&!I;){const se=this.getQuads(null,null,Q,null),oe=this.getQuads(Q,null,null,null);let ee,Se=null,pe=null,te=null;for(let _e=0;_e<oe.length&&!I;_e++)ee=oe[_e],ee.graph.equals(z)?X?I=j(Q,"has non-list arcs out"):ee.predicate.value===L.default.rdf.first?Se?I=j(Q,"has multiple rdf:first arcs"):q.push(Se=ee):ee.predicate.value===L.default.rdf.rest?pe?I=j(Q,"has multiple rdf:rest arcs"):q.push(pe=ee):se.length?I=j(Q,"can't be subject and object"):(X=ee,w="subject"):I=j(Q,"not confined to single graph");for(let _e=0;_e<se.length&&!I;++_e)ee=se[_e],X?I=j(Q,"can't have coreferences"):ee.predicate.value===L.default.rdf.rest?te?I=j(Q,"has incoming rdf:rest arcs"):te=ee:(X=ee,w="object");Se?D.unshift(Se.object):I=j(Q,"has no list head"),Q=te&&te.subject}I?y=!1:X&&(x[X[w].value]=D)}),y&&this.removeQuads(q),x}*[Symbol.iterator](){yield*this.readQuads()}}function N(b){return"string"==typeof b||b instanceof String}fe.default=S;class M extends V.Readable{constructor(y,E,x,j,O){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:E,predicate:x,object:j,graph:O})}get filtered(){if(!this._filtered){const{n3Store:y,graph:E,object:x,predicate:j,subject:O}=this,q=y.getQuads(O,j,x,E);this._filtered=new S(q,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this)this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,E,x,j){return new M(this.filtered,y,E,x,j)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var $,K=($=Y("./N3Parser"))&&$.__esModule?$:{default:$},V=Y("readable-stream");fe.default=class extends V.Transform{constructor(v){let N,M;super({decodeStrings:!0}),this._readableState.objectMode=!0,new K.default(v).parse({on:(b,y)=>{switch(b){case"data":N=y;break;case"end":M=y}}},(b,y)=>{b&&this.emit("error",b)||y&&this.push(y)},(b,y)=>{this.emit("prefix",b,y)}),this._transform=(b,y,E)=>{N(b),E()},this._flush=b=>{M(),b()}}import(v){return v.on("data",S=>{this.write(S)}),v.on("end",()=>{this.end()}),v.on("error",S=>{this.emit("error",S)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var $,K=Y("readable-stream"),V=($=Y("./N3Writer"))&&$.__esModule?$:{default:$};fe.default=class extends K.Transform{constructor(v){super({encoding:"utf8",writableObjectMode:!0});const S=this._writer=new V.default({write:(N,M,b)=>{this.push(N),b&&b()},end:N=>{this.push(null),N&&N()}},v);this._transform=(N,M,b)=>{S.addQuad(N,b)},this._flush=N=>{S.end(N)}}import(v){return v.on("data",S=>{this.write(S)}),v.on("end",()=>{this.end()}),v.on("error",S=>{this.emit("error",S)}),v.on("prefix",(S,N)=>{this._writer.addPrefix(S,N)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.inDefaultGraph=function(y){return S(y.graph)},fe.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},fe.isDefaultGraph=S,fe.isLiteral=function(y){return!!y&&"Literal"===y.termType},fe.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},fe.isVariable=function(y){return!!y&&"Variable"===y.termType},fe.prefix=function(y,E){return b({"":y.value||y},E)("")},fe.prefixes=b;var y,K=(y=Y("./N3DataFactory"))&&y.__esModule?y:{default:y};function S(y){return!!y&&"DefaultGraph"===y.termType}function b(y,E){const x=Object.create(null);for(const O in y)j(O,y[O]);function j(O,q){if("string"==typeof q){const ce=Object.create(null);x[O]=D=>ce[D]||(ce[D]=E.namedNode(q+D))}else if(!(O in x))throw new Error(`Unknown prefix: ${O}`);return x[O]}return E=E||K.default,j}},{"./N3DataFactory":35}],42:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.default=void 0;var ce,K=(ce=Y("./IRIs"))&&ce.__esModule?ce:{default:ce},V=function(ce,D){if(!D&&ce&&ce.__esModule)return ce;if(null===ce||"object"!=typeof ce&&"function"!=typeof ce)return{default:ce};var I=ie(D);if(I&&I.has(ce))return I.get(ce);var X={},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var z in ce)if("default"!==z&&Object.prototype.hasOwnProperty.call(ce,z)){var Q=w?Object.getOwnPropertyDescriptor(ce,z):null;Q&&(Q.get||Q.set)?Object.defineProperty(X,z,Q):X[z]=ce[z]}return X.default=ce,I&&I.set(ce,X),X}(Y("./N3DataFactory")),L=Y("./N3Util");function ie(ce){if("function"!=typeof WeakMap)return null;var D=new WeakMap,I=new WeakMap;return(ie=function(X){return X?I:D})(ce)}const S=V.default.defaultGraph(),{rdf:N,xsd:M}=K.default,b=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,E={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class x extends V.Term{equals(){return!1}}function O(ce){let D=E[ce];return void 0===D&&(1===ce.length?(D=ce.charCodeAt(0).toString(16),D="\\u0000".substr(0,6-D.length)+D):(D=(1024*(ce.charCodeAt(0)-55296)+ce.charCodeAt(1)+9216).toString(16),D="\\U00000000".substr(0,10-D.length)+D)),D}function q(ce){return ce.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}fe.default=class{constructor(D,I){if(this._prefixRegex=/$0^/,D&&"function"!=typeof D.write&&(I=D,D=null),this._lists=(I=I||{}).lists,D)this._outputStream=D,this._endStream=void 0===I.end||!!I.end;else{let X="";this._outputStream={write(w,z,Q){X+=w,Q&&Q()},end:w=>{w&&w(null,X)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(I.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=S,this._prefixIRIs=Object.create(null),I.prefixes&&this.addPrefixes(I.prefixes),I.baseIRI&&(this._baseMatcher=new RegExp(`^${q(I.baseIRI)}${I.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=I.baseIRI.length))}get _inDefaultGraph(){return S.equals(this._graph)}_write(D,I){this._outputStream.write(D,"utf8",I)}_writeQuad(D,I,X,w,z){try{w.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(S.equals(w)?"":`${this._encodeIriOrBlank(w)} {\n`)),this._graph=w,this._subject=null),D.equals(this._subject)?I.equals(this._predicate)?this._write(`, ${this._encodeObject(X)}`,z):this._write(`;\n    ${this._encodePredicate(this._predicate=I)} ${this._encodeObject(X)}`,z):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=D)} ${this._encodePredicate(this._predicate=I)} ${this._encodeObject(X)}`,z)}catch(Q){z&&z(Q)}}_writeQuadLine(D,I,X,w,z){delete this._prefixMatch,this._write(this.quadToString(D,I,X,w),z)}quadToString(D,I,X,w){return`${this._encodeSubject(D)} ${this._encodeIriOrBlank(I)} ${this._encodeObject(X)}${w&&w.value?` ${this._encodeIriOrBlank(w)} .\n`:" .\n"}`}quadsToString(D){return D.map(I=>this.quadToString(I.subject,I.predicate,I.object,I.graph)).join("")}_encodeSubject(D){return"Quad"===D.termType?this._encodeQuad(D):this._encodeIriOrBlank(D)}_encodeIriOrBlank(D){if("NamedNode"!==D.termType)return this._lists&&D.value in this._lists&&(D=this.list(this._lists[D.value])),"id"in D?D.id:`_:${D.value}`;let I=D.value;this._baseMatcher&&this._baseMatcher.test(I)&&(I=I.substr(this._baseLength)),b.test(I)&&(I=I.replace(y,O));const X=this._prefixRegex.exec(I);return X?X[1]?this._prefixIRIs[X[1]]+X[2]:I:`<${I}>`}_encodeLiteral(D){let I=D.value;if(b.test(I)&&(I=I.replace(y,O)),D.language)return`"${I}"@${D.language}`;if(this._lineMode){if(D.datatype.value===M.string)return`"${I}"`}else switch(D.datatype.value){case M.string:return`"${I}"`;case M.boolean:if("true"===I||"false"===I)return I;break;case M.integer:if(/^[+-]?\d+$/.test(I))return I;break;case M.decimal:if(/^[+-]?\d*\.\d+$/.test(I))return I;break;case M.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(I))return I}return`"${I}"^^${this._encodeIriOrBlank(D.datatype)}`}_encodePredicate(D){return D.value===N.type?"a":this._encodeIriOrBlank(D)}_encodeObject(D){switch(D.termType){case"Quad":return this._encodeQuad(D);case"Literal":return this._encodeLiteral(D);default:return this._encodeIriOrBlank(D)}}_encodeQuad({subject:D,predicate:I,object:X,graph:w}){return`<<${this._encodeSubject(D)} ${this._encodePredicate(I)} ${this._encodeObject(X)}${(0,L.isDefaultGraph)(w)?"":` ${this._encodeIriOrBlank(w)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(D,I,X,w,z){void 0===X?this._writeQuad(D.subject,D.predicate,D.object,D.graph,I):"function"==typeof w?this._writeQuad(D,I,X,S,w):this._writeQuad(D,I,X,w||S,z)}addQuads(D){for(let I=0;I<D.length;I++)this.addQuad(D[I])}addPrefix(D,I,X){const w={};w[D]=I,this.addPrefixes(w,X)}addPrefixes(D,I){if(!this._prefixIRIs)return I&&I();let X=!1;for(let w in D){let z=D[w];"string"!=typeof z&&(z=z.value),X=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[z]=w+=":",this._write(`@prefix ${w} <${z}>.\n`)}if(X){let w="",z="";for(const Q in this._prefixIRIs)w+=w?`|${Q}`:Q,z+=(z?"|":"")+this._prefixIRIs[Q];w=q(w),this._prefixRegex=new RegExp(`^(?:${z})[^/]*$|^(${w})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(X?"\n":"",I)}blank(D,I){let w,z,X=D;switch(void 0===D?X=[]:D.termType?X=[{predicate:D,object:I}]:"length"in D||(X=[D]),z=X.length){case 0:return new x("[]");case 1:if(w=X[0],!(w.object instanceof x))return new x(`[ ${this._encodePredicate(w.predicate)} ${this._encodeObject(w.object)} ]`);default:let Q="[";for(let se=0;se<z;se++)w=X[se],w.predicate.equals(D)?Q+=`, ${this._encodeObject(w.object)}`:(Q+=`${(se?";\n  ":"\n  ")+this._encodePredicate(w.predicate)} ${this._encodeObject(w.object)}`,D=w.predicate);return new x(`${Q}\n]`)}}list(D){const I=D&&D.length||0,X=new Array(I);for(let w=0;w<I;w++)X[w]=this._encodeObject(D[w]);return new x(`(${X.join(" ")})`)}end(D){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let I=D&&((X,w)=>{I=null,D(X,w)});if(this._endStream)try{return this._outputStream.end(I)}catch(X){}I&&I()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),Object.defineProperty(fe,"BlankNode",{enumerable:!0,get:function(){return N.BlankNode}}),Object.defineProperty(fe,"DataFactory",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(fe,"DefaultGraph",{enumerable:!0,get:function(){return N.DefaultGraph}}),Object.defineProperty(fe,"Lexer",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(fe,"Literal",{enumerable:!0,get:function(){return N.Literal}}),Object.defineProperty(fe,"NamedNode",{enumerable:!0,get:function(){return N.NamedNode}}),Object.defineProperty(fe,"Parser",{enumerable:!0,get:function(){return V.default}}),Object.defineProperty(fe,"Quad",{enumerable:!0,get:function(){return N.Quad}}),Object.defineProperty(fe,"Store",{enumerable:!0,get:function(){return ie.default}}),Object.defineProperty(fe,"StreamParser",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(fe,"StreamWriter",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(fe,"Term",{enumerable:!0,get:function(){return N.Term}}),Object.defineProperty(fe,"Triple",{enumerable:!0,get:function(){return N.Triple}}),fe.Util=void 0,Object.defineProperty(fe,"Variable",{enumerable:!0,get:function(){return N.Variable}}),Object.defineProperty(fe,"Writer",{enumerable:!0,get:function(){return L.default}}),fe.default=void 0,Object.defineProperty(fe,"termFromId",{enumerable:!0,get:function(){return N.termFromId}}),Object.defineProperty(fe,"termToId",{enumerable:!0,get:function(){return N.termToId}});var K=y(Y("./N3Lexer")),V=y(Y("./N3Parser")),L=y(Y("./N3Writer")),ie=y(Y("./N3Store")),$=y(Y("./N3StreamParser")),v=y(Y("./N3StreamWriter")),S=b(Y("./N3Util"));fe.Util=S;var N=b(Y("./N3DataFactory"));function M(x){if("function"!=typeof WeakMap)return null;var j=new WeakMap,O=new WeakMap;return(M=function(q){return q?O:j})(x)}function b(x,j){if(!j&&x&&x.__esModule)return x;if(null===x||"object"!=typeof x&&"function"!=typeof x)return{default:x};var O=M(j);if(O&&O.has(x))return O.get(x);var q={},ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in x)if("default"!==D&&Object.prototype.hasOwnProperty.call(x,D)){var I=ce?Object.getOwnPropertyDescriptor(x,D):null;I&&(I.get||I.set)?Object.defineProperty(q,D,I):q[D]=x[D]}return q.default=x,O&&O.set(x,q),q}function y(x){return x&&x.__esModule?x:{default:x}}fe.default={Lexer:K.default,Parser:V.default,Writer:L.default,Store:ie.default,StreamParser:$.default,StreamWriter:v.default,Util:S,DataFactory:N.default,Term:N.Term,NamedNode:N.NamedNode,Literal:N.Literal,BlankNode:N.BlankNode,Variable:N.Variable,DefaultGraph:N.DefaultGraph,Quad:N.Quad,Triple:N.Triple,termFromId:N.termFromId,termToId:N.termToId}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(Y,Te,fe){var V,L,K=Te.exports={};function ie(){throw new Error("setTimeout has not been defined")}function $(){throw new Error("clearTimeout has not been defined")}function v(q){if(V===setTimeout)return setTimeout(q,0);if((V===ie||!V)&&setTimeout)return V=setTimeout,setTimeout(q,0);try{return V(q,0)}catch(ce){try{return V.call(null,q,0)}catch(D){return V.call(this,q,0)}}}!function(){try{V="function"==typeof setTimeout?setTimeout:ie}catch(q){V=ie}try{L="function"==typeof clearTimeout?clearTimeout:$}catch(q){L=$}}();var b,N=[],M=!1,y=-1;function E(){!M||!b||(M=!1,b.length?N=b.concat(N):y=-1,N.length&&x())}function x(){if(!M){var q=v(E);M=!0;for(var ce=N.length;ce;){for(b=N,N=[];++y<ce;)b&&b[y].run();y=-1,ce=N.length}b=null,M=!1,function(q){if(L===clearTimeout)return clearTimeout(q);if((L===$||!L)&&clearTimeout)return L=clearTimeout,clearTimeout(q);try{L(q)}catch(ce){try{return L.call(null,q)}catch(D){return L.call(this,q)}}}(q)}}function j(q,ce){this.fun=q,this.array=ce}function O(){}K.nextTick=function(q){var ce=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)ce[D-1]=arguments[D];N.push(new j(q,ce)),1===N.length&&!M&&v(x)},j.prototype.run=function(){this.fun.apply(null,this.array)},K.title="browser",K.browser=!0,K.env={},K.argv=[],K.version="",K.versions={},K.on=O,K.addListener=O,K.once=O,K.off=O,K.removeListener=O,K.removeAllListeners=O,K.emit=O,K.prependListener=O,K.prependOnceListener=O,K.listeners=function(q){return[]},K.binding=function(q){throw new Error("process.binding is not supported")},K.cwd=function(){return"/"},K.chdir=function(q){throw new Error("process.chdir is not supported")},K.umask=function(){return 0}},{}],45:[function(Y,Te,fe){(function(K){(function(){let V;Te.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:K):L=>(V||(V=Promise.resolve())).then(L).catch(ie=>setTimeout(()=>{throw ie},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(Y,Te,fe){Te.exports=Y("./lib")},{"./lib":55}],47:[function(Y,Te,fe){"use strict";Te.exports=class K7{constructor(V,L=new Map,ie=0){this.prefix=V,this._existing=L,this.counter=ie}clone(){const{prefix:V,_existing:L,counter:ie}=this;return new K7(V,new Map(L),ie)}getId(V){const L=V&&this._existing.get(V);if(L)return L;const ie=this.prefix+this.counter;return this.counter++,V&&this._existing.set(V,ie),ie}hasId(V){return this._existing.has(V)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(Y,Te,fe){"use strict";Y("setimmediate");const K=self.crypto||self.msCrypto;Te.exports=class{constructor(L){if(!K||!K.subtle)throw new Error("crypto.subtle not found.");if("sha256"===L)this.algorithm={name:"SHA-256"};else{if("sha1"!==L)throw new Error(`Unsupport algorithm "${L}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(L){this._content+=L}digest(){var L=this;return mt(function*(){const ie=(new TextEncoder).encode(L._content),$=new Uint8Array(yield K.subtle.digest(L.algorithm,ie));let v="";for(let S=0;S<$.length;++S)v+=$[S].toString(16).padStart(2,"0");return v})()}}},{setimmediate:86}],49:[function(Y,Te,fe){"use strict";const L="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",ie="http://www.w3.org/2001/XMLSchema#string",$="NamedNode",v="BlankNode",S="Literal",N="DefaultGraph",M={};function b(O,q){return O.subject.termType===q.subject.termType&&O.object.termType===q.object.termType&&O.subject.value===q.subject.value&&O.predicate.value===q.predicate.value&&O.object.value===q.object.value&&(O.object.termType!==S||O.object.datatype.termType===q.object.datatype.termType&&O.object.language===q.object.language&&O.object.datatype.value===q.object.datatype.value)}M.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,M.empty=new RegExp("^[ \\t]*$"),M.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),Te.exports=class IP{static parse(q){const ce=[],D={},I=q.split(M.eoln);let X=0;for(const w of I){if(X++,M.empty.test(w))continue;const z=w.match(M.quad);if(null===z)throw new Error("N-Quads parse error on line "+X+".");const Q={subject:null,predicate:null,object:null,graph:null};if(Q.subject=void 0!==z[1]?{termType:$,value:z[1]}:{termType:v,value:z[2]},Q.predicate={termType:$,value:z[3]},void 0!==z[4]?Q.object={termType:$,value:z[4]}:void 0!==z[5]?Q.object={termType:v,value:z[5]}:(Q.object={termType:S,value:void 0,datatype:{termType:$}},void 0!==z[7]?Q.object.datatype.value=z[7]:void 0!==z[8]?(Q.object.datatype.value=L,Q.object.language=z[8]):Q.object.datatype.value=ie,Q.object.value=z[6].replace(x,function(q,ce,D,I){if(ce)switch(ce){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(D)return String.fromCharCode(parseInt(D,16));if(I)throw new Error("Unsupported U escape")})),Q.graph=void 0!==z[9]?{termType:$,value:z[9]}:void 0!==z[10]?{termType:v,value:z[10]}:{termType:N,value:""},Q.graph.value in D){let se=!0;const oe=D[Q.graph.value];for(const ee of oe)if(b(ee,Q)){se=!1;break}se&&(oe.push(Q),ce.push(Q))}else D[Q.graph.value]=[Q],ce.push(Q)}return ce}static serialize(q){Array.isArray(q)||(q=IP.legacyDatasetToQuads(q));const ce=[];for(const D of q)ce.push(IP.serializeQuad(D));return ce.sort().join("")}static serializeQuad(q){const ce=q.subject,I=q.object,X=q.graph;let w="";return w+=ce.termType===$?`<${ce.value}>`:`${ce.value}`,w+=` <${q.predicate.value}> `,I.termType===$?w+=`<${I.value}>`:I.termType===v?w+=I.value:(w+=`"${O=I.value,O.replace(y,function(q){switch(q){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,I.datatype.value===L?I.language&&(w+=`@${I.language}`):I.datatype.value!==ie&&(w+=`^^<${I.datatype.value}>`)),X.termType===$?w+=` <${X.value}>`:X.termType===v&&(w+=` ${X.value}`),w+=" .\n",w;var O}static legacyDatasetToQuads(q){const ce=[],D={"blank node":v,IRI:$,literal:S};for(const I in q)q[I].forEach(w=>{const z={};for(const Q in w){const se=w[Q],oe={termType:D[se.type],value:se.value};oe.termType===S&&(oe.datatype={termType:$},"datatype"in se&&(oe.datatype.value=se.datatype),"language"in se?("datatype"in se||(oe.datatype.value=L),oe.language=se.language):"datatype"in se||(oe.datatype.value=ie)),z[Q]=oe}z.graph="@default"===I?{termType:N,value:""}:{termType:I.startsWith("_:")?v:$,value:I},ce.push(z)});return ce}};const y=/["\\\n\r]/g;const x=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(Y,Te,fe){"use strict";Te.exports=class{constructor(V){this.current=V.sort(),this.done=!1,this.dir=new Map;for(let L=0;L<V.length;++L)this.dir.set(V[L],!0)}hasNext(){return!this.done}next(){const{current:V,dir:L}=this,ie=V.slice();let $=null,v=0;const S=V.length;for(let N=0;N<S;++N){const M=V[N],b=L.get(M);(null===$||M>$)&&(b&&N>0&&M>V[N-1]||!b&&N<S-1&&M>V[N+1])&&($=M,v=N)}if(null===$)this.done=!0;else{const N=L.get($)?v-1:v+1;V[v]=V[N],V[N]=$;for(const M of V)M>$&&L.set(M,!L.get(M))}return ie}}},{}],51:[function(Y,Te,fe){(function(K){(function(){"use strict";const V=Y("./IdentifierIssuer"),L=Y("./MessageDigest"),ie=Y("./Permuter"),$=Y("./NQuads");function v(S,N){return S.hash<N.hash?-1:S.hash>N.hash?1:0}Te.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new V("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(N){var M=this;return mt(function*(){M.quads=N;for(const q of N)M._addBlankNodeQuadInfo({quad:q,component:q.subject}),M._addBlankNodeQuadInfo({quad:q,component:q.object}),M._addBlankNodeQuadInfo({quad:q,component:q.graph});const b=new Map,y=[...M.blankNodeInfo.keys()];let E=0;for(const q of y)++E%100==0&&(yield M._yield()),yield M._hashAndTrackBlankNode({id:q,hashToBlankNodes:b});const x=[...b.keys()].sort(),j=[];for(const q of x){const ce=b.get(q);ce.length>1?j.push(ce):M.canonicalIssuer.getId(ce[0])}for(const q of j){const ce=[];for(const D of q){if(M.canonicalIssuer.hasId(D))continue;const I=new V("_:b");I.getId(D);const X=yield M.hashNDegreeQuads(D,I);ce.push(X)}ce.sort(v);for(const D of ce){const I=D.issuer.getOldIds();for(const X of I)M.canonicalIssuer.getId(X)}}const O=[];for(const q of M.quads){const ce=ht({},q);ce.subject=M._useCanonicalId({component:ce.subject}),ce.object=M._useCanonicalId({component:ce.object}),ce.graph=M._useCanonicalId({component:ce.graph}),O.push($.serializeQuad(ce))}return O.sort(),O.join("")})()}hashFirstDegreeQuads(N){var M=this;return mt(function*(){const b=[],y=M.blankNodeInfo.get(N),E=y.quads;for(const j of E){const O={subject:null,predicate:j.predicate,object:null,graph:null};O.subject=M.modifyFirstDegreeComponent(N,j.subject,"subject"),O.object=M.modifyFirstDegreeComponent(N,j.object,"object"),O.graph=M.modifyFirstDegreeComponent(N,j.graph,"graph"),b.push($.serializeQuad(O))}b.sort();const x=new L(M.hashAlgorithm);for(const j of b)x.update(j);return y.hash=yield x.digest(),y.hash})()}hashRelatedBlankNode(N,M,b,y){var E=this;return mt(function*(){let x;x=E.canonicalIssuer.hasId(N)?E.canonicalIssuer.getId(N):b.hasId(N)?b.getId(N):E.blankNodeInfo.get(N).hash;const j=new L(E.hashAlgorithm);return j.update(y),"g"!==y&&j.update(E.getRelatedPredicate(M)),j.update(x),j.digest()})()}hashNDegreeQuads(N,M){var b=this;return mt(function*(){const y=new L(b.hashAlgorithm),E=yield b.createHashToRelated(N,M),x=[...E.keys()].sort();for(const j of x){y.update(j);let q,O="";const ce=new ie(E.get(j));let D=0;for(;ce.hasNext();){const I=ce.next();++D%3==0&&(yield b._yield());let X=M.clone(),w="";const z=[];let Q=!1;for(const se of I)if(b.canonicalIssuer.hasId(se)?w+=b.canonicalIssuer.getId(se):(X.hasId(se)||z.push(se),w+=X.getId(se)),0!==O.length&&w>O){Q=!0;break}if(!Q){for(const se of z){const oe=yield b.hashNDegreeQuads(se,X);if(w+=X.getId(se),w+=`<${oe.hash}>`,X=oe.issuer,0!==O.length&&w>O){Q=!0;break}}Q||(0===O.length||w<O)&&(O=w,q=X)}}y.update(O),M=q}return{hash:yield y.digest(),issuer:M}})()}modifyFirstDegreeComponent(N,M){return"BlankNode"!==M.termType?M:{termType:"BlankNode",value:M.value===N?"_:a":"_:z"}}getRelatedPredicate(N){return`<${N.predicate.value}>`}createHashToRelated(N,M){var b=this;return mt(function*(){const y=new Map,E=b.blankNodeInfo.get(N).quads;let x=0;for(const j of E)++x%100==0&&(yield b._yield()),yield Promise.all([b._addRelatedBlankNodeHash({quad:j,component:j.subject,position:"s",id:N,issuer:M,hashToRelated:y}),b._addRelatedBlankNodeHash({quad:j,component:j.object,position:"o",id:N,issuer:M,hashToRelated:y}),b._addRelatedBlankNodeHash({quad:j,component:j.graph,position:"g",id:N,issuer:M,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:N,hashToBlankNodes:M}){var b=this;return mt(function*(){const y=yield b.hashFirstDegreeQuads(N),E=M.get(y);E?E.push(N):M.set(y,[N])})()}_addBlankNodeQuadInfo({quad:N,component:M}){if("BlankNode"!==M.termType)return;const b=M.value,y=this.blankNodeInfo.get(b);y?y.quads.add(N):this.blankNodeInfo.set(b,{quads:new Set([N]),hash:null})}_addRelatedBlankNodeHash({quad:N,component:M,position:b,id:y,issuer:E,hashToRelated:x}){var j=this;return mt(function*(){if("BlankNode"!==M.termType||M.value===y)return;const O=M.value,q=yield j.hashRelatedBlankNode(O,N,E,b),ce=x.get(q);ce?ce.push(O):x.set(q,[O])})()}_useCanonicalId({component:N}){return"BlankNode"!==N.termType||N.value.startsWith(this.canonicalIssuer.prefix)?N:{termType:"BlankNode",value:this.canonicalIssuer.getId(N.value)}}_yield(){return mt(function*(){return new Promise(N=>K(N))})()}}}).call(this)}).call(this,Y("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(Y,Te,fe){"use strict";const K=Y("./IdentifierIssuer"),V=Y("./MessageDigest"),L=Y("./Permuter"),ie=Y("./NQuads");function $(v,S){return v.hash<S.hash?-1:v.hash>S.hash?1:0}Te.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new K("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(S){this.quads=S;for(const x of S)this._addBlankNodeQuadInfo({quad:x,component:x.subject}),this._addBlankNodeQuadInfo({quad:x,component:x.object}),this._addBlankNodeQuadInfo({quad:x,component:x.graph});const N=new Map,M=[...this.blankNodeInfo.keys()];for(const x of M)this._hashAndTrackBlankNode({id:x,hashToBlankNodes:N});const b=[...N.keys()].sort(),y=[];for(const x of b){const j=N.get(x);j.length>1?y.push(j):this.canonicalIssuer.getId(j[0])}for(const x of y){const j=[];for(const O of x){if(this.canonicalIssuer.hasId(O))continue;const q=new K("_:b");q.getId(O);const ce=this.hashNDegreeQuads(O,q);j.push(ce)}j.sort($);for(const O of j){const q=O.issuer.getOldIds();for(const ce of q)this.canonicalIssuer.getId(ce)}}const E=[];for(const x of this.quads){const j=ht({},x);j.subject=this._useCanonicalId({component:j.subject}),j.object=this._useCanonicalId({component:j.object}),j.graph=this._useCanonicalId({component:j.graph}),E.push(ie.serializeQuad(j))}return E.sort(),E.join("")}hashFirstDegreeQuads(S){const N=[],M=this.blankNodeInfo.get(S),b=M.quads;for(const E of b){const x={subject:null,predicate:E.predicate,object:null,graph:null};x.subject=this.modifyFirstDegreeComponent(S,E.subject,"subject"),x.object=this.modifyFirstDegreeComponent(S,E.object,"object"),x.graph=this.modifyFirstDegreeComponent(S,E.graph,"graph"),N.push(ie.serializeQuad(x))}N.sort();const y=new V(this.hashAlgorithm);for(const E of N)y.update(E);return M.hash=y.digest(),M.hash}hashRelatedBlankNode(S,N,M,b){let y;y=this.canonicalIssuer.hasId(S)?this.canonicalIssuer.getId(S):M.hasId(S)?M.getId(S):this.blankNodeInfo.get(S).hash;const E=new V(this.hashAlgorithm);return E.update(b),"g"!==b&&E.update(this.getRelatedPredicate(N)),E.update(y),E.digest()}hashNDegreeQuads(S,N){const M=new V(this.hashAlgorithm),b=this.createHashToRelated(S,N),y=[...b.keys()].sort();for(const E of y){M.update(E);let j,x="";const O=new L(b.get(E));for(;O.hasNext();){const q=O.next();let ce=N.clone(),D="";const I=[];let X=!1;for(const w of q)if(this.canonicalIssuer.hasId(w)?D+=this.canonicalIssuer.getId(w):(ce.hasId(w)||I.push(w),D+=ce.getId(w)),0!==x.length&&D>x){X=!0;break}if(!X){for(const w of I){const z=this.hashNDegreeQuads(w,ce);if(D+=ce.getId(w),D+=`<${z.hash}>`,ce=z.issuer,0!==x.length&&D>x){X=!0;break}}X||(0===x.length||D<x)&&(x=D,j=ce)}}M.update(x),N=j}return{hash:M.digest(),issuer:N}}modifyFirstDegreeComponent(S,N){return"BlankNode"!==N.termType?N:{termType:"BlankNode",value:N.value===S?"_:a":"_:z"}}getRelatedPredicate(S){return`<${S.predicate.value}>`}createHashToRelated(S,N){const M=new Map,b=this.blankNodeInfo.get(S).quads;for(const y of b)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:S,issuer:N,hashToRelated:M}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:S,issuer:N,hashToRelated:M}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:S,issuer:N,hashToRelated:M});return M}_hashAndTrackBlankNode({id:S,hashToBlankNodes:N}){const M=this.hashFirstDegreeQuads(S),b=N.get(M);b?b.push(S):N.set(M,[S])}_addBlankNodeQuadInfo({quad:S,component:N}){if("BlankNode"!==N.termType)return;const M=N.value,b=this.blankNodeInfo.get(M);b?b.quads.add(S):this.blankNodeInfo.set(M,{quads:new Set([S]),hash:null})}_addRelatedBlankNodeHash({quad:S,component:N,position:M,id:b,issuer:y,hashToRelated:E}){if("BlankNode"!==N.termType||N.value===b)return;const x=N.value,j=this.hashRelatedBlankNode(x,S,y,M),O=E.get(j);O?O.push(x):E.set(j,[x])}_useCanonicalId({component:S}){return"BlankNode"!==S.termType||S.value.startsWith(this.canonicalIssuer.prefix)?S:{termType:"BlankNode",value:this.canonicalIssuer.getId(S.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(Y,Te,fe){"use strict";const K=Y("./URDNA2015");Te.exports=class extends K{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(L,ie,$){return"BlankNode"!==ie.termType?ie:"graph"===$?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:ie.value===L?"_:a":"_:z"}}getRelatedPredicate(L){return L.predicate.value}createHashToRelated(L,ie){var $=this;return mt(function*(){const v=new Map,S=$.blankNodeInfo.get(L).quads;let N=0;for(const M of S){let b,y;if("BlankNode"===M.subject.termType&&M.subject.value!==L)y=M.subject.value,b="p";else{if("BlankNode"!==M.object.termType||M.object.value===L)continue;y=M.object.value,b="r"}++N%100==0&&(yield $._yield());const E=yield $.hashRelatedBlankNode(y,M,ie,b),x=v.get(E);x?x.push(y):v.set(E,[y])}return v})()}}},{"./URDNA2015":51}],54:[function(Y,Te,fe){"use strict";const K=Y("./URDNA2015Sync");Te.exports=class extends K{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(L,ie,$){return"BlankNode"!==ie.termType?ie:"graph"===$?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:ie.value===L?"_:a":"_:z"}}getRelatedPredicate(L){return L.predicate.value}createHashToRelated(L,ie){const $=new Map,v=this.blankNodeInfo.get(L).quads;for(const S of v){let N,M;if("BlankNode"===S.subject.termType&&S.subject.value!==L)M=S.subject.value,N="p";else{if("BlankNode"!==S.object.termType||S.object.value===L)continue;M=S.object.value,N="r"}const b=this.hashRelatedBlankNode(M,S,ie,N),y=$.get(b);y?y.push(M):$.set(b,[M])}return $}}},{"./URDNA2015Sync":52}],55:[function(Y,Te,fe){"use strict";const K=Y("./URDNA2015"),V=Y("./URGNA2012"),L=Y("./URDNA2015Sync"),ie=Y("./URGNA2012Sync");let $;try{$=Y("rdf-canonize-native")}catch(S){}const v={};Te.exports=v,v.NQuads=Y("./NQuads"),v.IdentifierIssuer=Y("./IdentifierIssuer"),v._rdfCanonizeNative=function(S){return S&&($=S),$},v.canonize=function(){var S=mt(function*(N,M){if(Array.isArray(N)||(N=v.NQuads.legacyDatasetToQuads(N)),M.useNative){if(!$)throw new Error("rdf-canonize-native not available");return new Promise((b,y)=>$.canonize(N,M,(E,x)=>E?y(E):b(x)))}if("URDNA2015"===M.algorithm)return new K(M).main(N);if("URGNA2012"===M.algorithm)return new V(M).main(N);throw"algorithm"in M?new Error("Invalid RDF Dataset Canonicalization algorithm: "+M.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(N,M){return S.apply(this,arguments)}}(),v._canonizeSync=function(S,N){if(Array.isArray(S)||(S=v.NQuads.legacyDatasetToQuads(S)),N.useNative){if($)return $.canonizeSync(S,N);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===N.algorithm)return new L(N).main(S);if("URGNA2012"===N.algorithm)return new ie(N).main(S);throw"algorithm"in N?new Error("Invalid RDF Dataset Canonicalization algorithm: "+N.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(Y,Te,fe){"use strict";var K=this&&this.__createBinding||(Object.create?function(L,ie,$,v){void 0===v&&(v=$),Object.defineProperty(L,v,{enumerable:!0,get:function(){return ie[$]}})}:function(L,ie,$,v){void 0===v&&(v=$),L[v]=ie[$]}),V=this&&this.__exportStar||function(L,ie){for(var $ in L)"default"!==$&&!Object.prototype.hasOwnProperty.call(ie,$)&&K(ie,L,$)};Object.defineProperty(fe,"__esModule",{value:!0}),V(Y("./lib/BlankNode"),fe),V(Y("./lib/DataFactory"),fe),V(Y("./lib/DefaultGraph"),fe),V(Y("./lib/Literal"),fe),V(Y("./lib/NamedNode"),fe),V(Y("./lib/Quad"),fe),V(Y("./lib/Variable"),fe)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.BlankNode=void 0;fe.BlankNode=class{constructor(L){this.termType="BlankNode",this.value=L}equals(L){return!!L&&"BlankNode"===L.termType&&L.value===this.value}}},{}],58:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.DataFactory=void 0;const K=Y("./BlankNode"),V=Y("./DefaultGraph"),L=Y("./Literal"),ie=Y("./NamedNode"),$=Y("./Quad"),v=Y("./Variable");let S=0;fe.DataFactory=class{constructor(b){this.blankNodeCounter=0,this.blankNodePrefix=(b=b||{}).blankNodePrefix||`df_${S++}_`}namedNode(b){return new ie.NamedNode(b)}blankNode(b){return new K.BlankNode(b||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(b,y){return new L.Literal(b,y)}variable(b){return new v.Variable(b)}defaultGraph(){return V.DefaultGraph.INSTANCE}quad(b,y,E,x){return new $.Quad(b,y,E,x||this.defaultGraph())}fromTerm(b){switch(b.termType){case"NamedNode":return this.namedNode(b.value);case"BlankNode":return this.blankNode(b.value);case"Literal":return b.language?this.literal(b.value,b.language):b.datatype.equals(L.Literal.XSD_STRING)?this.literal(b.value):this.literal(b.value,this.fromTerm(b.datatype));case"Variable":return this.variable(b.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(b.subject),this.fromTerm(b.predicate),this.fromTerm(b.object),this.fromTerm(b.graph))}}fromQuad(b){return this.fromTerm(b)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.DefaultGraph=void 0;class K{constructor(){this.termType="DefaultGraph",this.value=""}equals(L){return!!L&&"DefaultGraph"===L.termType}}fe.DefaultGraph=K,K.INSTANCE=new K},{}],60:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Literal=void 0;const K=Y("./NamedNode");class V{constructor(ie,$){this.termType="Literal",this.value=ie,"string"==typeof $?(this.language=$,this.datatype=V.RDF_LANGUAGE_STRING):$?(this.language="",this.datatype=$):(this.language="",this.datatype=V.XSD_STRING)}equals(ie){return!!ie&&"Literal"===ie.termType&&ie.value===this.value&&ie.language===this.language&&ie.datatype.equals(this.datatype)}}fe.Literal=V,V.RDF_LANGUAGE_STRING=new K.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),V.XSD_STRING=new K.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.NamedNode=void 0;fe.NamedNode=class{constructor(L){this.termType="NamedNode",this.value=L}equals(L){return!!L&&"NamedNode"===L.termType&&L.value===this.value}}},{}],62:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Quad=void 0;fe.Quad=class{constructor(L,ie,$,v){this.termType="Quad",this.value="",this.subject=L,this.predicate=ie,this.object=$,this.graph=v}equals(L){return!!L&&("Quad"===L.termType||!L.termType)&&this.subject.equals(L.subject)&&this.predicate.equals(L.predicate)&&this.object.equals(L.object)&&this.graph.equals(L.graph)}}},{}],63:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.Variable=void 0;fe.Variable=class{constructor(L){this.termType="Variable",this.value=L}equals(L){return!!L&&"Variable"===L.termType&&L.value===this.value}}},{}],64:[function(Y,Te,fe){"use strict";var K=this&&this.__createBinding||(Object.create?function(L,ie,$,v){void 0===v&&(v=$),Object.defineProperty(L,v,{enumerable:!0,get:function(){return ie[$]}})}:function(L,ie,$,v){void 0===v&&(v=$),L[v]=ie[$]}),V=this&&this.__exportStar||function(L,ie){for(var $ in L)"default"!==$&&!Object.prototype.hasOwnProperty.call(ie,$)&&K(ie,L,$)};Object.defineProperty(fe,"__esModule",{value:!0}),V(Y("./lib/RdfXmlParser"),fe)},{"./lib/RdfXmlParser":66}],65:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.ParseError=void 0;class K extends Error{constructor(L,ie){const $=L.saxStream._parser;super(L.trackPosition?`Line ${$.line+1} column ${$.column+1}: ${ie}`:ie)}}fe.ParseError=K},{}],66:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),fe.ParseType=fe.RdfXmlParser=void 0;const K=Y("relative-to-absolute-iri"),V=Y("sax"),L=Y("stream"),ie=Y("./ParseError"),$=Y("rdf-data-factory");class v extends L.Transform{constructor(M){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},M&&(Object.assign(this,M),this.options=M),this.dataFactory||(this.dataFactory=new $.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=V.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(M,b){const y={};let E=!1;for(const j in M.attributes)j.startsWith("xmlns")&&(5===j.length?(E=!0,y[""]=M.attributes[j]):":"===j.charAt(5)&&(E=!0,y[j.substr(6)]=M.attributes[j]));const x=b&&b.ns?b.ns:[v.DEFAULT_NS];return E?x.concat([y]):x}static expandPrefixedTerm(M,b,y){const E=M.indexOf(":");let x,j;E>=0?(x=M.substr(0,E),j=M.substr(E+1)):(x="",j=M);let O=null,q=null;for(let ce=b.length-1;ce>=0;ce--){const D=b[ce][x];if(D){O=D;break}q||(q=b[ce][""])}if(!O){if(x&&"xmlns"!==x)throw new ie.ParseError(y,`The prefix '${x}' in term '${M}' was not bound.`);O=q||""}return{prefix:x,local:j,uri:O}}static isValidIri(M){return v.IRI_REGEX.test(M)}import(M){const b=new L.PassThrough({readableObjectMode:!0});M.on("error",E=>y.emit("error",E)),M.on("data",E=>b.push(E)),M.on("end",()=>b.push(null));const y=b.pipe(new v(this.options));return y}_transform(M,b,y){try{this.saxStream.write(M,b)}catch(E){return y(E)}y()}newParseError(M){return new ie.ParseError(this,M)}valueToUri(M,b){return this.uriToNamedNode(K.resolve(M,b.baseIRI))}uriToNamedNode(M){if(!v.isValidIri(M))throw this.newParseError(`Invalid URI: ${M}`);return this.dataFactory.namedNode(M)}validateNcname(M){if(!v.NCNAME_MATCHER.test(M))throw this.newParseError(`Not a valid NCName: ${M}`)}attachSaxListeners(){this.saxStream.on("error",M=>this.emit("error",M)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(M){const b=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=S.RESOURCE;if(b&&(b.hadChildren=!0,y=b.childrenParseType),b&&b.childrenStringTags){const x=M.name;let j="";for(const D in M.attributes)j+=` ${D}="${M.attributes[D]}"`;b.childrenStringTags.push(`<${x}${j}>`);const ce={childrenStringTags:b.childrenStringTags};return ce.childrenStringEmitClosingTag=`</${x}>`,void this.activeTagStack.push(ce)}const E={};b?(E.language=b.language,E.baseIRI=b.baseIRI):E.baseIRI=this.baseIRI,this.activeTagStack.push(E),E.ns=v.parseNamespace(M,b),y===S.RESOURCE?this.onTagResource(M,E,b,!b):this.onTagProperty(M,E,b)}onTagResource(M,b,y,E){const x=v.expandPrefixedTerm(M.name,b.ns,this);b.childrenParseType=S.PROPERTY;let j=!0;if(x.uri===v.RDF){if(!E&&v.FORBIDDEN_NODE_ELEMENTS.indexOf(x.local)>=0)throw this.newParseError(`Illegal node element name: ${x.local}`);switch(x.local){case"RDF":b.childrenParseType=S.RESOURCE;case"Description":j=!1}}const O=[],q=[];let ce=null,D=!1,I=!1,X=null;for(const w in M.attributes){const z=M.attributes[w],Q=v.expandPrefixedTerm(w,b.ns,this);if(y&&Q.uri===v.RDF)switch(Q.local){case"about":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${z} and ${ce} where found.`);ce=z;continue;case"ID":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${z} and ${ce} where found.`);this.validateNcname(z),ce="#"+z,D=!0;continue;case"nodeID":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${z} and ${ce} where found.`);this.validateNcname(z),ce=z,I=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":X=z;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(Q.uri===v.XML){if("lang"===Q.local){b.language=""===z?null:z.toLowerCase();continue}if("base"===Q.local){b.baseIRI=K.resolve(z,b.baseIRI);continue}}"xml"!==Q.prefix&&Q.uri&&(O.push(this.uriToNamedNode(Q.uri+Q.local)),q.push(z))}if(null!==ce&&(b.subject=I?this.dataFactory.blankNode(ce):this.valueToUri(ce,b),D&&this.claimNodeId(b.subject)),b.subject||(b.subject=this.dataFactory.blankNode()),j){const w=this.uriToNamedNode(x.uri+x.local);this.emitTriple(b.subject,this.dataFactory.namedNode(v.RDF+"type"),w,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const w=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,w,y.reifiedStatementId),this.emitTriple(w,this.dataFactory.namedNode(v.RDF+"first"),b.subject,b.reifiedStatementId),y.childrenCollectionSubject=w,y.childrenCollectionPredicate=this.dataFactory.namedNode(v.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,b.subject,y.reifiedStatementId);for(let w=0;w<y.predicateSubPredicates.length;w++)this.emitTriple(b.subject,y.predicateSubPredicates[w],y.predicateSubObjects[w],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let w=0;w<O.length;w++){const z=this.dataFactory.literal(q[w],b.datatype||b.language);this.emitTriple(b.subject,O[w],z,y.reifiedStatementId)}X&&this.emitTriple(b.subject,this.dataFactory.namedNode(v.RDF+"type"),this.uriToNamedNode(X),null)}}onTagProperty(M,b,y){const E=v.expandPrefixedTerm(M.name,b.ns,this);if(b.childrenParseType=S.RESOURCE,b.subject=y.subject,E.uri===v.RDF&&"li"===E.local?(y.listItemCounter||(y.listItemCounter=1),b.predicate=this.uriToNamedNode(E.uri+"_"+y.listItemCounter++)):b.predicate=this.uriToNamedNode(E.uri+E.local),E.uri===v.RDF&&v.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(E.local)>=0)throw this.newParseError(`Illegal property element name: ${E.local}`);b.predicateSubPredicates=[],b.predicateSubObjects=[];let x=!1,j=!1,O=null,q=!0;const ce=[],D=[];for(const I in M.attributes){const X=M.attributes[I],w=v.expandPrefixedTerm(I,b.ns,this);if(w.uri===v.RDF)switch(w.local){case"resource":if(O)throw this.newParseError(`Found both rdf:resource (${X}) and rdf:nodeID (${O}).`);if(x)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${X})`);b.hadChildren=!0,O=X,q=!1;continue;case"datatype":if(j)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${X}).`);if(x)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${X})`);b.datatype=this.valueToUri(X,b);continue;case"nodeID":if(j)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${X}).`);if(b.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${X}).`);if(x)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${X})`);this.validateNcname(X),b.hadChildren=!0,O=X,q=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(j)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(b.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${b.datatype.value})`);if(O)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${O})`);if("Resource"===X){x=!0,b.childrenParseType=S.PROPERTY;const z=this.dataFactory.blankNode();this.emitTriple(b.subject,b.predicate,z,b.reifiedStatementId),b.subject=z,b.predicate=null}else"Collection"===X?(x=!0,b.hadChildren=!0,b.childrenCollectionSubject=b.subject,b.childrenCollectionPredicate=b.predicate,q=!1):"Literal"===X&&(x=!0,b.childrenTagsToString=!0,b.childrenStringTags=[]);continue;case"ID":this.validateNcname(X),b.reifiedStatementId=this.valueToUri("#"+X,b),this.claimNodeId(b.reifiedStatementId);continue}else if(w.uri===v.XML&&"lang"===w.local){b.language=""===X?null:X.toLowerCase();continue}if("xml"!==w.prefix&&"xmlns"!==w.prefix&&w.uri){if(x||b.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${X}`);b.hadChildren=!0,j=!0,ce.push(this.uriToNamedNode(w.uri+w.local)),D.push(this.dataFactory.literal(X,b.datatype||b.language))}}if(null!==O){const I=b.subject;b.subject=q?this.dataFactory.blankNode(O):this.valueToUri(O,b),this.emitTriple(I,b.predicate,b.subject,b.reifiedStatementId);for(let X=0;X<ce.length;X++)this.emitTriple(b.subject,ce[X],D[X],null);b.predicateEmitted=!0}else q&&(b.predicateSubPredicates=ce,b.predicateSubObjects=D,b.predicateEmitted=!1)}emitTriple(M,b,y,E){this.push(this.dataFactory.quad(M,b,y,this.defaultGraph)),E&&(this.push(this.dataFactory.quad(E,this.dataFactory.namedNode(v.RDF+"type"),this.dataFactory.namedNode(v.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(E,this.dataFactory.namedNode(v.RDF+"subject"),M,this.defaultGraph)),this.push(this.dataFactory.quad(E,this.dataFactory.namedNode(v.RDF+"predicate"),b,this.defaultGraph)),this.push(this.dataFactory.quad(E,this.dataFactory.namedNode(v.RDF+"object"),y,this.defaultGraph)))}claimNodeId(M){if(!this.allowDuplicateRdfIds){if(this.nodeIds[M.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${M.value}'.`);this.nodeIds[M.value]=!0}}onText(M){const b=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;b&&(b.childrenStringTags?b.childrenStringTags.push(M):b.predicate&&(b.text=M))}onCloseTag(){const M=this.activeTagStack.pop();if(M.childrenStringEmitClosingTag&&M.childrenStringTags.push(M.childrenStringEmitClosingTag),M.childrenTagsToString&&(M.datatype=this.dataFactory.namedNode(v.RDF+"XMLLiteral"),M.text=M.childrenStringTags.join(""),M.hadChildren=!1),M.childrenCollectionSubject)this.emitTriple(M.childrenCollectionSubject,M.childrenCollectionPredicate,this.dataFactory.namedNode(v.RDF+"nil"),M.reifiedStatementId);else if(M.predicate)if(M.hadChildren||M.childrenParseType===S.PROPERTY){if(!M.predicateEmitted){const b=this.dataFactory.blankNode();this.emitTriple(M.subject,M.predicate,b,M.reifiedStatementId);for(let y=0;y<M.predicateSubPredicates.length;y++)this.emitTriple(b,M.predicateSubPredicates[y],M.predicateSubObjects[y],null)}}else this.emitTriple(M.subject,M.predicate,this.dataFactory.literal(M.text||"",M.datatype||M.language),M.reifiedStatementId)}onDoctype(M){M.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(b,y,E)=>(this.saxStream._parser.ENTITIES[y]=E,""))}}var S,N;fe.RdfXmlParser=v,v.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,v.MIME_TYPE="application/rdf+xml",v.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",v.XML="http://www.w3.org/XML/1998/namespace",v.XMLNS="http://www.w3.org/2000/xmlns/",v.DEFAULT_NS={xml:v.XML},v.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],v.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],v.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(N=S=fe.ParseType||(fe.ParseType={}))[N.RESOURCE=0]="RESOURCE",N[N.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(Y,Te,fe){"use strict";var V={};function L(N,M,b){b||(b=Error);var E=function(x){function j(O,q,ce){return x.call(this,function(x,j,O){return"string"==typeof M?M:M(x,j,O)}(O,q,ce))||this}return function(N,M){N.prototype=Object.create(M.prototype),N.prototype.constructor=N,N.__proto__=M}(j,x),j}(b);E.prototype.name=b.name,E.prototype.code=N,V[N]=E}function ie(N,M){if(Array.isArray(N)){var b=N.length;return N=N.map(function(y){return String(y)}),b>2?"one of ".concat(M," ").concat(N.slice(0,b-1).join(", "),", or ")+N[b-1]:2===b?"one of ".concat(M," ").concat(N[0]," or ").concat(N[1]):"of ".concat(M," ").concat(N[0])}return"of ".concat(M," ").concat(String(N))}L("ERR_INVALID_OPT_VALUE",function(N,M){return'The value "'+M+'" is invalid for option "'+N+'"'},TypeError),L("ERR_INVALID_ARG_TYPE",function(N,M,b){var y,E;if("string"==typeof M&&function(N,M,b){return N.substr(!b||b<0?0:+b,M.length)===M}(M,"not ")?(y="must not be",M=M.replace(/^not /,"")):y="must be",function(N,M,b){return(void 0===b||b>N.length)&&(b=N.length),N.substring(b-M.length,b)===M}(N," argument"))E="The ".concat(N," ").concat(y," ").concat(ie(M,"type"));else{var x=function(N,M,b){return"number"!=typeof b&&(b=0),!(b+M.length>N.length)&&-1!==N.indexOf(M,b)}(N,".")?"property":"argument";E='The "'.concat(N,'" ').concat(x," ").concat(y," ").concat(ie(M,"type"))}return E+". Received type ".concat(typeof b)},TypeError),L("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),L("ERR_METHOD_NOT_IMPLEMENTED",function(N){return"The "+N+" method is not implemented"}),L("ERR_STREAM_PREMATURE_CLOSE","Premature close"),L("ERR_STREAM_DESTROYED",function(N){return"Cannot call "+N+" after a stream was destroyed"}),L("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),L("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),L("ERR_STREAM_WRITE_AFTER_END","write after end"),L("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),L("ERR_UNKNOWN_ENCODING",function(N){return"Unknown encoding: "+N},TypeError),L("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Te.exports.codes=V},{}],68:[function(Y,Te,fe){(function(K){(function(){"use strict";var V=Object.keys||function(y){var E=[];for(var x in y)E.push(x);return E};Te.exports=N;var L=Y("./_stream_readable"),ie=Y("./_stream_writable");Y("inherits")(N,L);for(var $=V(ie.prototype),v=0;v<$.length;v++){var S=$[v];N.prototype[S]||(N.prototype[S]=ie.prototype[S])}function N(y){if(!(this instanceof N))return new N(y);L.call(this,y),ie.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",M)))}function M(){this._writableState.ended||K.nextTick(b,this)}function b(y){y.end()}Object.defineProperty(N.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(N.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(N.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(E){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=E,this._writableState.destroyed=E)}})}).call(this)}).call(this,Y("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(Y,Te,fe){"use strict";Te.exports=V;var K=Y("./_stream_transform");function V(L){if(!(this instanceof V))return new V(L);K.call(this,L)}Y("inherits")(V,K),V.prototype._transform=function(L,ie,$){$(null,L)}},{"./_stream_transform":71,inherits:10}],70:[function(Y,Te,fe){(function(K,V){(function(){"use strict";var L;Te.exports=te,te.ReadableState=pe,Y("events");var $=function(k,R){return k.listeners(R).length},v=Y("./internal/streams/stream"),S=Y("buffer").Buffer,N=V.Uint8Array||function(){};var E,y=Y("util");E=y&&y.debuglog?y.debuglog("stream"):function(){};var z,Q,se,x=Y("./internal/streams/buffer_list"),j=Y("./internal/streams/destroy"),q=Y("./internal/streams/state").getHighWaterMark,ce=Y("../errors").codes,D=ce.ERR_INVALID_ARG_TYPE,I=ce.ERR_STREAM_PUSH_AFTER_EOF,X=ce.ERR_METHOD_NOT_IMPLEMENTED,w=ce.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;Y("inherits")(te,v);var oe=j.errorOrDestroy,ee=["error","close","destroy","pause","resume"];function pe(ve,k,R){L=L||Y("./_stream_duplex"),"boolean"!=typeof R&&(R=k instanceof L),this.objectMode=!!(ve=ve||{}).objectMode,R&&(this.objectMode=this.objectMode||!!ve.readableObjectMode),this.highWaterMark=q(this,ve,"readableHighWaterMark",R),this.buffer=new x,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==ve.emitClose,this.autoDestroy=!!ve.autoDestroy,this.destroyed=!1,this.defaultEncoding=ve.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ve.encoding&&(z||(z=Y("string_decoder/").StringDecoder),this.decoder=new z(ve.encoding),this.encoding=ve.encoding)}function te(ve){if(L=L||Y("./_stream_duplex"),!(this instanceof te))return new te(ve);this._readableState=new pe(ve,this,this instanceof L),this.readable=!0,ve&&("function"==typeof ve.read&&(this._read=ve.read),"function"==typeof ve.destroy&&(this._destroy=ve.destroy)),v.call(this)}function _e(ve,k,R,B,Oe){E("readableAddChunk",k);var bt,Qe=ve._readableState;if(null===k)Qe.reading=!1,function(ve,k){if(E("onEofChunk"),!k.ended){if(k.decoder){var R=k.decoder.end();R&&R.length&&(k.buffer.push(R),k.length+=k.objectMode?1:R.length)}k.ended=!0,k.sync?je(ve):(k.needReadable=!1,k.emittedReadable||(k.emittedReadable=!0,Fe(ve)))}}(ve,Qe);else if(Oe||(bt=function(ve,k){var R;return!function(ve){return S.isBuffer(ve)||ve instanceof N}(k)&&"string"!=typeof k&&void 0!==k&&!ve.objectMode&&(R=new D("chunk",["string","Buffer","Uint8Array"],k)),R}(Qe,k)),bt)oe(ve,bt);else if(Qe.objectMode||k&&k.length>0)if("string"!=typeof k&&!Qe.objectMode&&Object.getPrototypeOf(k)!==S.prototype&&(k=function(ve){return S.from(ve)}(k)),B)Qe.endEmitted?oe(ve,new w):De(ve,Qe,k,!0);else if(Qe.ended)oe(ve,new I);else{if(Qe.destroyed)return!1;Qe.reading=!1,Qe.decoder&&!R?(k=Qe.decoder.write(k),Qe.objectMode||0!==k.length?De(ve,Qe,k,!1):Ye(ve,Qe)):De(ve,Qe,k,!1)}else B||(Qe.reading=!1,Ye(ve,Qe));return!Qe.ended&&(Qe.length<Qe.highWaterMark||0===Qe.length)}function De(ve,k,R,B){k.flowing&&0===k.length&&!k.sync?(k.awaitDrain=0,ve.emit("data",R)):(k.length+=k.objectMode?1:R.length,B?k.buffer.unshift(R):k.buffer.push(R),k.needReadable&&je(ve)),Ye(ve,k)}Object.defineProperty(te.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(k){!this._readableState||(this._readableState.destroyed=k)}}),te.prototype.destroy=j.destroy,te.prototype._undestroy=j.undestroy,te.prototype._destroy=function(ve,k){k(ve)},te.prototype.push=function(ve,k){var B,R=this._readableState;return R.objectMode?B=!0:"string"==typeof ve&&((k=k||R.defaultEncoding)!==R.encoding&&(ve=S.from(ve,k),k=""),B=!0),_e(this,ve,k,!1,B)},te.prototype.unshift=function(ve){return _e(this,ve,null,!0,!1)},te.prototype.isPaused=function(){return!1===this._readableState.flowing},te.prototype.setEncoding=function(ve){z||(z=Y("string_decoder/").StringDecoder);var k=new z(ve);this._readableState.decoder=k,this._readableState.encoding=this._readableState.decoder.encoding;for(var R=this._readableState.buffer.head,B="";null!==R;)B+=k.write(R.data),R=R.next;return this._readableState.buffer.clear(),""!==B&&this._readableState.buffer.push(B),this._readableState.length=B.length,this};var rt=1073741824;function Je(ve,k){return ve<=0||0===k.length&&k.ended?0:k.objectMode?1:ve!=ve?k.flowing&&k.length?k.buffer.head.data.length:k.length:(ve>k.highWaterMark&&(k.highWaterMark=function(ve){return ve>=rt?ve=rt:(ve--,ve|=ve>>>1,ve|=ve>>>2,ve|=ve>>>4,ve|=ve>>>8,ve|=ve>>>16,ve++),ve}(ve)),ve<=k.length?ve:k.ended?k.length:(k.needReadable=!0,0))}function je(ve){var k=ve._readableState;E("emitReadable",k.needReadable,k.emittedReadable),k.needReadable=!1,k.emittedReadable||(E("emitReadable",k.flowing),k.emittedReadable=!0,K.nextTick(Fe,ve))}function Fe(ve){var k=ve._readableState;E("emitReadable_",k.destroyed,k.length,k.ended),!k.destroyed&&(k.length||k.ended)&&(ve.emit("readable"),k.emittedReadable=!1),k.needReadable=!k.flowing&&!k.ended&&k.length<=k.highWaterMark,he(ve)}function Ye(ve,k){k.readingMore||(k.readingMore=!0,K.nextTick(Ce,ve,k))}function Ce(ve,k){for(;!k.reading&&!k.ended&&(k.length<k.highWaterMark||k.flowing&&0===k.length);){var R=k.length;if(E("maybeReadMore read 0"),ve.read(0),R===k.length)break}k.readingMore=!1}function $e(ve){var k=ve._readableState;k.readableListening=ve.listenerCount("readable")>0,k.resumeScheduled&&!k.paused?k.flowing=!0:ve.listenerCount("data")>0&&ve.resume()}function Ne(ve){E("readable nexttick read 0"),ve.read(0)}function U(ve,k){E("resume",k.reading),k.reading||ve.read(0),k.resumeScheduled=!1,ve.emit("resume"),he(ve),k.flowing&&!k.reading&&ve.read(0)}function he(ve){var k=ve._readableState;for(E("flow",k.flowing);k.flowing&&null!==ve.read(););}function ue(ve,k){return 0===k.length?null:(k.objectMode?R=k.buffer.shift():!ve||ve>=k.length?(R=k.decoder?k.buffer.join(""):1===k.buffer.length?k.buffer.first():k.buffer.concat(k.length),k.buffer.clear()):R=k.buffer.consume(ve,k.decoder),R);var R}function ke(ve){var k=ve._readableState;E("endReadable",k.endEmitted),k.endEmitted||(k.ended=!0,K.nextTick(gt,k,ve))}function gt(ve,k){if(E("endReadableNT",ve.endEmitted,ve.length),!ve.endEmitted&&0===ve.length&&(ve.endEmitted=!0,k.readable=!1,k.emit("end"),ve.autoDestroy)){var R=k._writableState;(!R||R.autoDestroy&&R.finished)&&k.destroy()}}function ft(ve,k){for(var R=0,B=ve.length;R<B;R++)if(ve[R]===k)return R;return-1}te.prototype.read=function(ve){E("read",ve),ve=parseInt(ve,10);var k=this._readableState,R=ve;if(0!==ve&&(k.emittedReadable=!1),0===ve&&k.needReadable&&((0!==k.highWaterMark?k.length>=k.highWaterMark:k.length>0)||k.ended))return E("read: emitReadable",k.length,k.ended),0===k.length&&k.ended?ke(this):je(this),null;if(0===(ve=Je(ve,k))&&k.ended)return 0===k.length&&ke(this),null;var Oe,B=k.needReadable;return E("need readable",B),(0===k.length||k.length-ve<k.highWaterMark)&&E("length less than watermark",B=!0),k.ended||k.reading?E("reading or ended",B=!1):B&&(E("do read"),k.reading=!0,k.sync=!0,0===k.length&&(k.needReadable=!0),this._read(k.highWaterMark),k.sync=!1,k.reading||(ve=Je(R,k))),null===(Oe=ve>0?ue(ve,k):null)?(k.needReadable=k.length<=k.highWaterMark,ve=0):(k.length-=ve,k.awaitDrain=0),0===k.length&&(k.ended||(k.needReadable=!0),R!==ve&&k.ended&&ke(this)),null!==Oe&&this.emit("data",Oe),Oe},te.prototype._read=function(ve){oe(this,new X("_read()"))},te.prototype.pipe=function(ve,k){var R=this,B=this._readableState;switch(B.pipesCount){case 0:B.pipes=ve;break;case 1:B.pipes=[B.pipes,ve];break;default:B.pipes.push(ve)}B.pipesCount+=1,E("pipe count=%d opts=%j",B.pipesCount,k);var Qe=k&&!1===k.end||ve===K.stdout||ve===K.stderr?us:It;function bt(Ps,$r){E("onunpipe"),Ps===R&&$r&&!1===$r.hasUnpiped&&($r.hasUnpiped=!0,E("cleanup"),ve.removeListener("close",Gr),ve.removeListener("finish",Ns),ve.removeListener("drain",In),ve.removeListener("error",mi),ve.removeListener("unpipe",bt),R.removeListener("end",It),R.removeListener("end",us),R.removeListener("data",Ei),Ln=!0,B.awaitDrain&&(!ve._writableState||ve._writableState.needDrain)&&In())}function It(){E("onend"),ve.end()}B.endEmitted?K.nextTick(Qe):R.once("end",Qe),ve.on("unpipe",bt);var In=function(ve){return function(){var R=ve._readableState;E("pipeOnDrain",R.awaitDrain),R.awaitDrain&&R.awaitDrain--,0===R.awaitDrain&&$(ve,"data")&&(R.flowing=!0,he(ve))}}(R);ve.on("drain",In);var Ln=!1;function Ei(Ps){E("ondata");var $r=ve.write(Ps);E("dest.write",$r),!1===$r&&((1===B.pipesCount&&B.pipes===ve||B.pipesCount>1&&-1!==ft(B.pipes,ve))&&!Ln&&(E("false write response, pause",B.awaitDrain),B.awaitDrain++),R.pause())}function mi(Ps){E("onerror",Ps),us(),ve.removeListener("error",mi),0===$(ve,"error")&&oe(ve,Ps)}function Gr(){ve.removeListener("finish",Ns),us()}function Ns(){E("onfinish"),ve.removeListener("close",Gr),us()}function us(){E("unpipe"),R.unpipe(ve)}return R.on("data",Ei),function(ve,k,R){if("function"==typeof ve.prependListener)return ve.prependListener(k,R);ve._events&&ve._events[k]?Array.isArray(ve._events[k])?ve._events[k].unshift(R):ve._events[k]=[R,ve._events[k]]:ve.on(k,R)}(ve,"error",mi),ve.once("close",Gr),ve.once("finish",Ns),ve.emit("pipe",R),B.flowing||(E("pipe resume"),R.resume()),ve},te.prototype.unpipe=function(ve){var k=this._readableState,R={hasUnpiped:!1};if(0===k.pipesCount)return this;if(1===k.pipesCount)return ve&&ve!==k.pipes||(ve||(ve=k.pipes),k.pipes=null,k.pipesCount=0,k.flowing=!1,ve&&ve.emit("unpipe",this,R)),this;if(!ve){var B=k.pipes,Oe=k.pipesCount;k.pipes=null,k.pipesCount=0,k.flowing=!1;for(var Qe=0;Qe<Oe;Qe++)B[Qe].emit("unpipe",this,{hasUnpiped:!1});return this}var bt=ft(k.pipes,ve);return-1===bt||(k.pipes.splice(bt,1),k.pipesCount-=1,1===k.pipesCount&&(k.pipes=k.pipes[0]),ve.emit("unpipe",this,R)),this},te.prototype.addListener=te.prototype.on=function(ve,k){var R=v.prototype.on.call(this,ve,k),B=this._readableState;return"data"===ve?(B.readableListening=this.listenerCount("readable")>0,!1!==B.flowing&&this.resume()):"readable"===ve&&!B.endEmitted&&!B.readableListening&&(B.readableListening=B.needReadable=!0,B.flowing=!1,B.emittedReadable=!1,E("on readable",B.length,B.reading),B.length?je(this):B.reading||K.nextTick(Ne,this)),R},te.prototype.removeListener=function(ve,k){var R=v.prototype.removeListener.call(this,ve,k);return"readable"===ve&&K.nextTick($e,this),R},te.prototype.removeAllListeners=function(ve){var k=v.prototype.removeAllListeners.apply(this,arguments);return("readable"===ve||void 0===ve)&&K.nextTick($e,this),k},te.prototype.resume=function(){var ve=this._readableState;return ve.flowing||(E("resume"),ve.flowing=!ve.readableListening,function(ve,k){k.resumeScheduled||(k.resumeScheduled=!0,K.nextTick(U,ve,k))}(this,ve)),ve.paused=!1,this},te.prototype.pause=function(){return E("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(E("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},te.prototype.wrap=function(ve){var k=this,R=this._readableState,B=!1;for(var Oe in ve.on("end",function(){if(E("wrapped end"),R.decoder&&!R.ended){var bt=R.decoder.end();bt&&bt.length&&k.push(bt)}k.push(null)}),ve.on("data",function(bt){E("wrapped data"),R.decoder&&(bt=R.decoder.write(bt)),R.objectMode&&null==bt||!(R.objectMode||bt&&bt.length)||k.push(bt)||(B=!0,ve.pause())}),ve)void 0===this[Oe]&&"function"==typeof ve[Oe]&&(this[Oe]=function(It){return function(){return ve[It].apply(ve,arguments)}}(Oe));for(var Qe=0;Qe<ee.length;Qe++)ve.on(ee[Qe],this.emit.bind(this,ee[Qe]));return this._read=function(bt){E("wrapped _read",bt),B&&(B=!1,ve.resume())},this},"function"==typeof Symbol&&(te.prototype[Symbol.asyncIterator]=function(){return void 0===Q&&(Q=Y("./internal/streams/async_iterator")),Q(this)}),Object.defineProperty(te.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(te.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(te.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(k){this._readableState&&(this._readableState.flowing=k)}}),te._fromList=ue,Object.defineProperty(te.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(te.from=function(ve,k){return void 0===se&&(se=Y("./internal/streams/from")),se(te,ve,k)})}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(Y,Te,fe){"use strict";Te.exports=N;var K=Y("../errors").codes,V=K.ERR_METHOD_NOT_IMPLEMENTED,L=K.ERR_MULTIPLE_CALLBACK,ie=K.ERR_TRANSFORM_ALREADY_TRANSFORMING,$=K.ERR_TRANSFORM_WITH_LENGTH_0,v=Y("./_stream_duplex");function S(y,E){var x=this._transformState;x.transforming=!1;var j=x.writecb;if(null===j)return this.emit("error",new L);x.writechunk=null,x.writecb=null,null!=E&&this.push(E),j(y);var O=this._readableState;O.reading=!1,(O.needReadable||O.length<O.highWaterMark)&&this._read(O.highWaterMark)}function N(y){if(!(this instanceof N))return new N(y);v.call(this,y),this._transformState={afterTransform:S.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",M)}function M(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?b(this,null,null):this._flush(function(E,x){b(y,E,x)})}function b(y,E,x){if(E)return y.emit("error",E);if(null!=x&&y.push(x),y._writableState.length)throw new $;if(y._transformState.transforming)throw new ie;return y.push(null)}Y("inherits")(N,v),N.prototype.push=function(y,E){return this._transformState.needTransform=!1,v.prototype.push.call(this,y,E)},N.prototype._transform=function(y,E,x){x(new V("_transform()"))},N.prototype._write=function(y,E,x){var j=this._transformState;if(j.writecb=x,j.writechunk=y,j.writeencoding=E,!j.transforming){var O=this._readableState;(j.needTransform||O.needReadable||O.length<O.highWaterMark)&&this._read(O.highWaterMark)}},N.prototype._read=function(y){var E=this._transformState;null===E.writechunk||E.transforming?E.needTransform=!0:(E.transforming=!0,this._transform(E.writechunk,E.writeencoding,E.afterTransform))},N.prototype._destroy=function(y,E){v.prototype._destroy.call(this,y,function(x){E(x)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(Y,Te,fe){(function(K,V){(function(){"use strict";function ie(he){var ue=this;this.next=null,this.entry=null,this.finish=function(){!function(he,ue,ke){var gt=he.entry;for(he.entry=null;gt;){var ft=gt.callback;ue.pendingcb--,ft(ke),gt=gt.next}ue.corkedRequestsFree.next=he}(ue,he)}}var $;Te.exports=pe,pe.WritableState=ee;var v={deprecate:Y("util-deprecate")},S=Y("./internal/streams/stream"),N=Y("buffer").Buffer,M=V.Uint8Array||function(){};var Se,E=Y("./internal/streams/destroy"),j=Y("./internal/streams/state").getHighWaterMark,O=Y("../errors").codes,q=O.ERR_INVALID_ARG_TYPE,ce=O.ERR_METHOD_NOT_IMPLEMENTED,D=O.ERR_MULTIPLE_CALLBACK,I=O.ERR_STREAM_CANNOT_PIPE,X=O.ERR_STREAM_DESTROYED,w=O.ERR_STREAM_NULL_VALUES,z=O.ERR_STREAM_WRITE_AFTER_END,Q=O.ERR_UNKNOWN_ENCODING,se=E.errorOrDestroy;function oe(){}function ee(he,ue,ke){$=$||Y("./_stream_duplex"),"boolean"!=typeof ke&&(ke=ue instanceof $),this.objectMode=!!(he=he||{}).objectMode,ke&&(this.objectMode=this.objectMode||!!he.writableObjectMode),this.highWaterMark=j(this,he,"writableHighWaterMark",ke),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===he.decodeStrings),this.defaultEncoding=he.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ft){!function(he,ue){var ke=he._writableState,gt=ke.sync,ft=ke.writecb;if("function"!=typeof ft)throw new D;if(function(he){he.writing=!1,he.writecb=null,he.length-=he.writelen,he.writelen=0}(ke),ue)!function(he,ue,ke,gt,ft){--ue.pendingcb,ke?(K.nextTick(ft,gt),K.nextTick(Ne,he,ue),he._writableState.errorEmitted=!0,se(he,gt)):(ft(gt),he._writableState.errorEmitted=!0,se(he,gt),Ne(he,ue))}(he,ke,gt,ue,ft);else{var ve=Ce(ke)||he.destroyed;!ve&&!ke.corked&&!ke.bufferProcessing&&ke.bufferedRequest&&Ye(he,ke),gt?K.nextTick(je,he,ke,ve,ft):je(he,ke,ve,ft)}}(ue,ft)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==he.emitClose,this.autoDestroy=!!he.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new ie(this)}function pe(he){var ue=this instanceof($=$||Y("./_stream_duplex"));if(!ue&&!Se.call(pe,this))return new pe(he);this._writableState=new ee(he,this,ue),this.writable=!0,he&&("function"==typeof he.write&&(this._write=he.write),"function"==typeof he.writev&&(this._writev=he.writev),"function"==typeof he.destroy&&(this._destroy=he.destroy),"function"==typeof he.final&&(this._final=he.final)),S.call(this)}function He(he,ue,ke,gt,ft,ve){if(!ke){var k=function(he,ue,ke){return!he.objectMode&&!1!==he.decodeStrings&&"string"==typeof ue&&(ue=N.from(ue,ke)),ue}(ue,gt,ft);gt!==k&&(ke=!0,ft="buffer",gt=k)}var R=ue.objectMode?1:gt.length;ue.length+=R;var B=ue.length<ue.highWaterMark;if(B||(ue.needDrain=!0),ue.writing||ue.corked){var Oe=ue.lastBufferedRequest;ue.lastBufferedRequest={chunk:gt,encoding:ft,isBuf:ke,callback:ve,next:null},Oe?Oe.next=ue.lastBufferedRequest:ue.bufferedRequest=ue.lastBufferedRequest,ue.bufferedRequestCount+=1}else rt(he,ue,!1,R,gt,ft,ve);return B}function rt(he,ue,ke,gt,ft,ve,k){ue.writelen=gt,ue.writecb=k,ue.writing=!0,ue.sync=!0,ue.destroyed?ue.onwrite(new X("write")):ke?he._writev(ft,ue.onwrite):he._write(ft,ve,ue.onwrite),ue.sync=!1}function je(he,ue,ke,gt){ke||function(he,ue){0===ue.length&&ue.needDrain&&(ue.needDrain=!1,he.emit("drain"))}(he,ue),ue.pendingcb--,gt(),Ne(he,ue)}function Ye(he,ue){ue.bufferProcessing=!0;var ke=ue.bufferedRequest;if(he._writev&&ke&&ke.next){var ft=new Array(ue.bufferedRequestCount),ve=ue.corkedRequestsFree;ve.entry=ke;for(var k=0,R=!0;ke;)ft[k]=ke,ke.isBuf||(R=!1),ke=ke.next,k+=1;ft.allBuffers=R,rt(he,ue,!0,ue.length,ft,"",ve.finish),ue.pendingcb++,ue.lastBufferedRequest=null,ve.next?(ue.corkedRequestsFree=ve.next,ve.next=null):ue.corkedRequestsFree=new ie(ue),ue.bufferedRequestCount=0}else{for(;ke;){var B=ke.chunk;if(rt(he,ue,!1,ue.objectMode?1:B.length,B,ke.encoding,ke.callback),ke=ke.next,ue.bufferedRequestCount--,ue.writing)break}null===ke&&(ue.lastBufferedRequest=null)}ue.bufferedRequest=ke,ue.bufferProcessing=!1}function Ce(he){return he.ending&&0===he.length&&null===he.bufferedRequest&&!he.finished&&!he.writing}function Be(he,ue){he._final(function(ke){ue.pendingcb--,ke&&se(he,ke),ue.prefinished=!0,he.emit("prefinish"),Ne(he,ue)})}function Ne(he,ue){var ke=Ce(ue);if(ke&&(function(he,ue){!ue.prefinished&&!ue.finalCalled&&("function"!=typeof he._final||ue.destroyed?(ue.prefinished=!0,he.emit("prefinish")):(ue.pendingcb++,ue.finalCalled=!0,K.nextTick(Be,he,ue)))}(he,ue),0===ue.pendingcb&&(ue.finished=!0,he.emit("finish"),ue.autoDestroy))){var gt=he._readableState;(!gt||gt.autoDestroy&&gt.endEmitted)&&he.destroy()}return ke}Y("inherits")(pe,S),ee.prototype.getBuffer=function(){for(var ue=this.bufferedRequest,ke=[];ue;)ke.push(ue),ue=ue.next;return ke},function(){try{Object.defineProperty(ee.prototype,"buffer",{get:v.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(he){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Se=Function.prototype[Symbol.hasInstance],Object.defineProperty(pe,Symbol.hasInstance,{value:function(ue){return!!Se.call(this,ue)||this===pe&&ue&&ue._writableState instanceof ee}})):Se=function(ue){return ue instanceof this},pe.prototype.pipe=function(){se(this,new I)},pe.prototype.write=function(he,ue,ke){var gt=this._writableState,ft=!1,ve=!gt.objectMode&&function(he){return N.isBuffer(he)||he instanceof M}(he);return ve&&!N.isBuffer(he)&&(he=function(he){return N.from(he)}(he)),"function"==typeof ue&&(ke=ue,ue=null),ve?ue="buffer":ue||(ue=gt.defaultEncoding),"function"!=typeof ke&&(ke=oe),gt.ending?function(he,ue){var ke=new z;se(he,ke),K.nextTick(ue,ke)}(this,ke):(ve||function(he,ue,ke,gt){var ft;return null===ke?ft=new w:"string"!=typeof ke&&!ue.objectMode&&(ft=new q("chunk",["string","Buffer"],ke)),!ft||(se(he,ft),K.nextTick(gt,ft),!1)}(this,gt,he,ke))&&(gt.pendingcb++,ft=He(this,gt,ve,he,ue,ke)),ft},pe.prototype.cork=function(){this._writableState.corked++},pe.prototype.uncork=function(){var he=this._writableState;he.corked&&(he.corked--,!he.writing&&!he.corked&&!he.bufferProcessing&&he.bufferedRequest&&Ye(this,he))},pe.prototype.setDefaultEncoding=function(ue){if("string"==typeof ue&&(ue=ue.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ue+"").toLowerCase())>-1))throw new Q(ue);return this._writableState.defaultEncoding=ue,this},Object.defineProperty(pe.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(pe.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),pe.prototype._write=function(he,ue,ke){ke(new ce("_write()"))},pe.prototype._writev=null,pe.prototype.end=function(he,ue,ke){var gt=this._writableState;return"function"==typeof he?(ke=he,he=null,ue=null):"function"==typeof ue&&(ke=ue,ue=null),null!=he&&this.write(he,ue),gt.corked&&(gt.corked=1,this.uncork()),gt.ending||function(he,ue,ke){ue.ending=!0,Ne(he,ue),ke&&(ue.finished?K.nextTick(ke):he.once("finish",ke)),ue.ended=!0,he.writable=!1}(this,gt,ke),this},Object.defineProperty(pe.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(pe.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(ue){!this._writableState||(this._writableState.destroyed=ue)}}),pe.prototype.destroy=E.destroy,pe.prototype._undestroy=E.undestroy,pe.prototype._destroy=function(he,ue){ue(he)}}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(Y,Te,fe){(function(K){(function(){"use strict";var V;function L(I,X,w){return X in I?Object.defineProperty(I,X,{value:w,enumerable:!0,configurable:!0,writable:!0}):I[X]=w,I}var ie=Y("./end-of-stream"),$=Symbol("lastResolve"),v=Symbol("lastReject"),S=Symbol("error"),N=Symbol("ended"),M=Symbol("lastPromise"),b=Symbol("handlePromise"),y=Symbol("stream");function E(I,X){return{value:I,done:X}}function x(I){var X=I[$];if(null!==X){var w=I[y].read();null!==w&&(I[M]=null,I[$]=null,I[v]=null,X(E(w,!1)))}}function j(I){K.nextTick(x,I)}var q=Object.getPrototypeOf(function(){}),ce=Object.setPrototypeOf((L(V={get stream(){return this[y]},next:function(){var X=this,w=this[S];if(null!==w)return Promise.reject(w);if(this[N])return Promise.resolve(E(void 0,!0));if(this[y].destroyed)return new Promise(function(oe,ee){K.nextTick(function(){X[S]?ee(X[S]):oe(E(void 0,!0))})});var Q,z=this[M];if(z)Q=new Promise(function(I,X){return function(w,z){I.then(function(){X[N]?w(E(void 0,!0)):X[b](w,z)},z)}}(z,this));else{var se=this[y].read();if(null!==se)return Promise.resolve(E(se,!1));Q=new Promise(this[b])}return this[M]=Q,Q}},Symbol.asyncIterator,function(){return this}),L(V,"return",function(){var X=this;return new Promise(function(w,z){X[y].destroy(null,function(Q){Q?z(Q):w(E(void 0,!0))})})}),V),q);Te.exports=function(X){var w,z=Object.create(ce,(L(w={},y,{value:X,writable:!0}),L(w,$,{value:null,writable:!0}),L(w,v,{value:null,writable:!0}),L(w,S,{value:null,writable:!0}),L(w,N,{value:X._readableState.endEmitted,writable:!0}),L(w,b,{value:function(se,oe){var ee=z[y].read();ee?(z[M]=null,z[$]=null,z[v]=null,se(E(ee,!1))):(z[$]=se,z[v]=oe)},writable:!0}),w));return z[M]=null,ie(X,function(Q){if(Q&&"ERR_STREAM_PREMATURE_CLOSE"!==Q.code){var se=z[v];return null!==se&&(z[M]=null,z[$]=null,z[v]=null,se(Q)),void(z[S]=Q)}var oe=z[$];null!==oe&&(z[M]=null,z[$]=null,z[v]=null,oe(E(void 0,!0))),z[N]=!0}),X.on("readable",j.bind(null,z)),z}}).call(this)}).call(this,Y("_process"))},{"./end-of-stream":76,_process:44}],74:[function(Y,Te,fe){"use strict";function K(x,j){var O=Object.keys(x);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(x);j&&(q=q.filter(function(ce){return Object.getOwnPropertyDescriptor(x,ce).enumerable})),O.push.apply(O,q)}return O}function L(x,j,O){return j in x?Object.defineProperty(x,j,{value:O,enumerable:!0,configurable:!0,writable:!0}):x[j]=O,x}function $(x,j){for(var O=0;O<j.length;O++){var q=j[O];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(x,q.key,q)}}var N=Y("buffer").Buffer,b=Y("util").inspect,y=b&&b.custom||"inspect";function E(x,j,O){N.prototype.copy.call(x,j,O)}Te.exports=function(){function x(){(function(x,j){if(!(x instanceof j))throw new TypeError("Cannot call a class as a function")})(this,x),this.head=null,this.tail=null,this.length=0}return function(x,j,O){j&&$(x.prototype,j),O&&$(x,O)}(x,[{key:"push",value:function(O){var q={data:O,next:null};this.length>0?this.tail.next=q:this.head=q,this.tail=q,++this.length}},{key:"unshift",value:function(O){var q={data:O,next:this.head};0===this.length&&(this.tail=q),this.head=q,++this.length}},{key:"shift",value:function(){if(0!==this.length){var O=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,O}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(O){if(0===this.length)return"";for(var q=this.head,ce=""+q.data;q=q.next;)ce+=O+q.data;return ce}},{key:"concat",value:function(O){if(0===this.length)return N.alloc(0);for(var q=N.allocUnsafe(O>>>0),ce=this.head,D=0;ce;)E(ce.data,q,D),D+=ce.data.length,ce=ce.next;return q}},{key:"consume",value:function(O,q){var ce;return O<this.head.data.length?(ce=this.head.data.slice(0,O),this.head.data=this.head.data.slice(O)):ce=O===this.head.data.length?this.shift():q?this._getString(O):this._getBuffer(O),ce}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(O){var q=this.head,ce=1,D=q.data;for(O-=D.length;q=q.next;){var I=q.data,X=O>I.length?I.length:O;if(D+=X===I.length?I:I.slice(0,O),0==(O-=X)){X===I.length?(++ce,this.head=q.next?q.next:this.tail=null):(this.head=q,q.data=I.slice(X));break}++ce}return this.length-=ce,D}},{key:"_getBuffer",value:function(O){var q=N.allocUnsafe(O),ce=this.head,D=1;for(ce.data.copy(q),O-=ce.data.length;ce=ce.next;){var I=ce.data,X=O>I.length?I.length:O;if(I.copy(q,q.length-O,0,X),0==(O-=X)){X===I.length?(++D,this.head=ce.next?ce.next:this.tail=null):(this.head=ce,ce.data=I.slice(X));break}++D}return this.length-=D,q}},{key:y,value:function(O,q){return b(this,function(x){for(var j=1;j<arguments.length;j++){var O=null!=arguments[j]?arguments[j]:{};j%2?K(Object(O),!0).forEach(function(q){L(x,q,O[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(O)):K(Object(O)).forEach(function(q){Object.defineProperty(x,q,Object.getOwnPropertyDescriptor(O,q))})}return x}({},q,{depth:0,customInspect:!1}))}}]),x}()},{buffer:6,util:3}],75:[function(Y,Te,fe){(function(K){(function(){"use strict";function L(N,M){v(N,M),ie(N)}function ie(N){N._writableState&&!N._writableState.emitClose||N._readableState&&!N._readableState.emitClose||N.emit("close")}function v(N,M){N.emit("error",M)}Te.exports={destroy:function(N,M){var b=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(M?M(N):N&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,K.nextTick(v,this,N)):K.nextTick(v,this,N)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(N||null,function(x){!M&&x?b._writableState?b._writableState.errorEmitted?K.nextTick(ie,b):(b._writableState.errorEmitted=!0,K.nextTick(L,b,x)):K.nextTick(L,b,x):M?(K.nextTick(ie,b),M(x)):K.nextTick(ie,b)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(N,M){var b=N._readableState,y=N._writableState;b&&b.autoDestroy||y&&y.autoDestroy?N.destroy(M):N.emit("error",M)}}}).call(this)}).call(this,Y("_process"))},{_process:44}],76:[function(Y,Te,fe){"use strict";var K=Y("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function L(){}Te.exports=function $(v,S,N){if("function"==typeof S)return $(v,null,S);S||(S={}),N=function(v){var S=!1;return function(){if(!S){S=!0;for(var N=arguments.length,M=new Array(N),b=0;b<N;b++)M[b]=arguments[b];v.apply(this,M)}}}(N||L);var M=S.readable||!1!==S.readable&&v.readable,b=S.writable||!1!==S.writable&&v.writable,y=function(){v.writable||x()},E=v._writableState&&v._writableState.finished,x=function(){b=!1,E=!0,M||N.call(v)},j=v._readableState&&v._readableState.endEmitted,O=function(){M=!1,j=!0,b||N.call(v)},q=function(X){N.call(v,X)},ce=function(){var X;return M&&!j?((!v._readableState||!v._readableState.ended)&&(X=new K),N.call(v,X)):b&&!E?((!v._writableState||!v._writableState.ended)&&(X=new K),N.call(v,X)):void 0},D=function(){v.req.on("finish",x)};return function(v){return v.setHeader&&"function"==typeof v.abort}(v)?(v.on("complete",x),v.on("abort",ce),v.req?D():v.on("request",D)):b&&!v._writableState&&(v.on("end",y),v.on("close",y)),v.on("end",O),v.on("finish",x),!1!==S.error&&v.on("error",q),v.on("close",ce),function(){v.removeListener("complete",x),v.removeListener("abort",ce),v.removeListener("request",D),v.req&&v.req.removeListener("finish",x),v.removeListener("end",y),v.removeListener("close",y),v.removeListener("finish",x),v.removeListener("end",O),v.removeListener("error",q),v.removeListener("close",ce)}}},{"../../../errors":67}],77:[function(Y,Te,fe){Te.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(Y,Te,fe){"use strict";var K;var L=Y("../../../errors").codes,ie=L.ERR_MISSING_ARGS,$=L.ERR_STREAM_DESTROYED;function v(x){if(x)throw x}function N(x,j,O,q){q=function(x){var j=!1;return function(){j||(j=!0,x.apply(void 0,arguments))}}(q);var ce=!1;x.on("close",function(){ce=!0}),void 0===K&&(K=Y("./end-of-stream")),K(x,{readable:j,writable:O},function(I){if(I)return q(I);ce=!0,q()});var D=!1;return function(I){if(!ce&&!D){if(D=!0,function(x){return x.setHeader&&"function"==typeof x.abort}(x))return x.abort();if("function"==typeof x.destroy)return x.destroy();q(I||new $("pipe"))}}}function M(x){x()}function b(x,j){return x.pipe(j)}function y(x){return x.length&&"function"==typeof x[x.length-1]?x.pop():v}Te.exports=function(){for(var x=arguments.length,j=new Array(x),O=0;O<x;O++)j[O]=arguments[O];var q=y(j);if(Array.isArray(j[0])&&(j=j[0]),j.length<2)throw new ie("streams");var ce,D=j.map(function(I,X){var w=X<j.length-1;return N(I,w,X>0,function(Q){ce||(ce=Q),Q&&D.forEach(M),!w&&(D.forEach(M),q(ce))})});return j.reduce(b)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(Y,Te,fe){"use strict";var K=Y("../../../errors").codes.ERR_INVALID_OPT_VALUE;Te.exports={getHighWaterMark:function(ie,$,v,S){var N=function(ie,$,v){return null!=ie.highWaterMark?ie.highWaterMark:$?ie[v]:null}($,S,v);if(null!=N){if(!isFinite(N)||Math.floor(N)!==N||N<0)throw new K(S?v:"highWaterMark",N);return Math.floor(N)}return ie.objectMode?16:16384}}},{"../../../errors":67}],80:[function(Y,Te,fe){Te.exports=Y("events").EventEmitter},{events:8}],81:[function(Y,Te,fe){(fe=Te.exports=Y("./lib/_stream_readable.js")).Stream=fe,fe.Readable=fe,fe.Writable=Y("./lib/_stream_writable.js"),fe.Duplex=Y("./lib/_stream_duplex.js"),fe.Transform=Y("./lib/_stream_transform.js"),fe.PassThrough=Y("./lib/_stream_passthrough.js"),fe.finished=Y("./lib/internal/streams/end-of-stream.js"),fe.pipeline=Y("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(Y,Te,fe){"use strict";Object.defineProperty(fe,"__esModule",{value:!0}),function(V){for(var L in V)fe.hasOwnProperty(L)||(fe[L]=V[L])}(Y("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(Y,Te,fe){"use strict";function V($){const v=[];let S=0;for(;S<$.length;)switch($[S]){case"/":if("."===$[S+1])if("."===$[S+2]){if(!ie($[S+3])){v.push([]),S++;break}v.pop(),$[S+3]||v.push([]),S+=3}else{if(!ie($[S+2])){v.push([]),S++;break}$[S+2]||v.push([]),S+=2}else v.push([]),S++;break;case"#":case"?":v.length||v.push([]),v[v.length-1].push($.substr(S)),S=$.length;break;default:v.length||v.push([]),v[v.length-1].push($[S]),S++}return"/"+v.map(N=>N.join("")).join("/")}function L($,v){let S=v+1;v>=0?"/"===$[v+1]&&"/"===$[v+2]&&(S=v+3):"/"===$[0]&&"/"===$[1]&&(S=2);const N=$.indexOf("/",S);return N<0?$:$.substr(0,N)+V($.substr(N))}function ie($){return!$||"#"===$||"?"===$||"/"===$}Object.defineProperty(fe,"__esModule",{value:!0}),fe.resolve=function($,v){const S=(v=v||"").indexOf("#");if(S>0&&(v=v.substr(0,S)),!$.length){if(v.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${v}' for value '${$}'`);return v}if($.startsWith("?")){const j=v.indexOf("?");return j>0&&(v=v.substr(0,j)),v+$}if($.startsWith("#"))return v+$;if(!v.length){const j=$.indexOf(":");if(j<0)throw new Error(`Found invalid relative IRI '${$}' for a missing baseIRI`);return L($,j)}const N=$.indexOf(":");if(N>=0)return L($,N);const M=v.indexOf(":");if(M<0)throw new Error(`Found invalid baseIRI '${v}' for value '${$}'`);const b=v.substr(0,M+1);if(0===$.indexOf("//"))return b+L($,N);let y;if(v.indexOf("//",M)===M+1){if(y=v.indexOf("/",M+3),y<0)return v.length>M+3?v+"/"+L($,N):b+L($,N)}else if(y=v.indexOf("/",M+1),y<0)return b+L($,N);if(0===$.indexOf("/"))return v.substr(0,y)+V($);let E=v.substr(y);const x=E.lastIndexOf("/");return x>=0&&x<E.length-1&&(E=E.substr(0,x+1),"."===$[0]&&"."!==$[1]&&"/"!==$[1]&&$[2]&&($=$.substr(1))),$=V($=E+$),v.substr(0,y)+$},fe.removeDotSegments=V,fe.removeDotSegmentsOfPath=L},{}],84:[function(Y,Te,fe){var K=Y("buffer"),V=K.Buffer;function L($,v){for(var S in $)v[S]=$[S]}function ie($,v,S){return V($,v,S)}V.from&&V.alloc&&V.allocUnsafe&&V.allocUnsafeSlow?Te.exports=K:(L(K,fe),fe.Buffer=ie),ie.prototype=Object.create(V.prototype),L(V,ie),ie.from=function($,v,S){if("number"==typeof $)throw new TypeError("Argument must not be a number");return V($,v,S)},ie.alloc=function($,v,S){if("number"!=typeof $)throw new TypeError("Argument must be a number");var N=V($);return void 0!==v?"string"==typeof S?N.fill(v,S):N.fill(v):N.fill(0),N},ie.allocUnsafe=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return V($)},ie.allocUnsafeSlow=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return K.SlowBuffer($)}},{buffer:6}],85:[function(Y,Te,fe){(function(K){(function(){!function(V){V.parser=function(G,U){return new ie(G,U)},V.SAXParser=ie,V.SAXStream=y,V.createStream=function(G,U){return new y(G,U)},V.MAX_BUFFER_LENGTH=65536;var N,L=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function ie(G,U){if(!(this instanceof ie))return new ie(G,U);var he=this;(function(G){for(var U=0,he=L.length;U<he;U++)G[L[U]]=""})(he),he.q=he.c="",he.bufferCheckPosition=V.MAX_BUFFER_LENGTH,he.opt=U||{},he.opt.lowercase=he.opt.lowercase||he.opt.lowercasetags,he.looseCase=he.opt.lowercase?"toLowerCase":"toUpperCase",he.tags=[],he.closed=he.closedRoot=he.sawRoot=!1,he.tag=he.error=null,he.strict=!!G,he.noscript=!(!G&&!he.opt.noscript),he.state=ee.BEGIN,he.strictEntities=he.opt.strictEntities,he.ENTITIES=Object.create(he.strictEntities?V.XML_ENTITIES:V.ENTITIES),he.attribList=[],he.opt.xmlns&&(he.ns=Object.create(q)),he.trackPosition=!1!==he.opt.position,he.trackPosition&&(he.position=he.line=he.column=0),pe(he,"onready")}V.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(G){function U(){}return U.prototype=G,new U}),Object.keys||(Object.keys=function(G){var U=[];for(var he in G)G.hasOwnProperty(he)&&U.push(he);return U}),ie.prototype={end:function(){rt(this)},write:function(G){var U=this;if(this.error)throw this.error;if(U.closed)return He(U,"Cannot write after close. Assign an onready handler.");if(null===G)return rt(U);"object"==typeof G&&(G=G.toString());for(var he=0,ue="";ue=$e(G,he++),U.c=ue,ue;)switch(U.trackPosition&&(U.position++,"\n"===ue?(U.line++,U.column=0):U.column++),U.state){case ee.BEGIN:if(U.state=ee.BEGIN_WHITESPACE,"\ufeff"===ue)continue;Be(U,ue);continue;case ee.BEGIN_WHITESPACE:Be(U,ue);continue;case ee.TEXT:if(U.sawRoot&&!U.closedRoot){for(var ke=he-1;ue&&"<"!==ue&&"&"!==ue;)(ue=$e(G,he++))&&U.trackPosition&&(U.position++,"\n"===ue?(U.line++,U.column=0):U.column++);U.textNode+=G.substring(ke,he-1)}"<"!==ue||U.sawRoot&&U.closedRoot&&!U.strict?(!w(ue)&&(!U.sawRoot||U.closedRoot)&&Xe(U,"Text data outside of root node."),"&"===ue?U.state=ee.TEXT_ENTITY:U.textNode+=ue):(U.state=ee.OPEN_WAKA,U.startTagPosition=U.position);continue;case ee.SCRIPT:"<"===ue?U.state=ee.SCRIPT_ENDING:U.script+=ue;continue;case ee.SCRIPT_ENDING:"/"===ue?U.state=ee.CLOSE_TAG:(U.script+="<"+ue,U.state=ee.SCRIPT);continue;case ee.OPEN_WAKA:"!"===ue?(U.state=ee.SGML_DECL,U.sgmlDecl=""):w(ue)||(se(ce,ue)?(U.state=ee.OPEN_TAG,U.tagName=ue):"/"===ue?(U.state=ee.CLOSE_TAG,U.tagName=""):"?"===ue?(U.state=ee.PROC_INST,U.procInstName=U.procInstBody=""):(Xe(U,"Unencoded <"),U.startTagPosition+1<U.position&&(ue=new Array(U.position-U.startTagPosition).join(" ")+ue),U.textNode+="<"+ue,U.state=ee.TEXT));continue;case ee.SGML_DECL:"[CDATA["===(U.sgmlDecl+ue).toUpperCase()?(te(U,"onopencdata"),U.state=ee.CDATA,U.sgmlDecl="",U.cdata=""):U.sgmlDecl+ue==="--"?(U.state=ee.COMMENT,U.comment="",U.sgmlDecl=""):"DOCTYPE"===(U.sgmlDecl+ue).toUpperCase()?(U.state=ee.DOCTYPE,(U.doctype||U.sawRoot)&&Xe(U,"Inappropriately located doctype declaration"),U.doctype="",U.sgmlDecl=""):">"===ue?(te(U,"onsgmldeclaration",U.sgmlDecl),U.sgmlDecl="",U.state=ee.TEXT):(z(ue)&&(U.state=ee.SGML_DECL_QUOTED),U.sgmlDecl+=ue);continue;case ee.SGML_DECL_QUOTED:ue===U.q&&(U.state=ee.SGML_DECL,U.q=""),U.sgmlDecl+=ue;continue;case ee.DOCTYPE:">"===ue?(U.state=ee.TEXT,te(U,"ondoctype",U.doctype),U.doctype=!0):(U.doctype+=ue,"["===ue?U.state=ee.DOCTYPE_DTD:z(ue)&&(U.state=ee.DOCTYPE_QUOTED,U.q=ue));continue;case ee.DOCTYPE_QUOTED:U.doctype+=ue,ue===U.q&&(U.q="",U.state=ee.DOCTYPE);continue;case ee.DOCTYPE_DTD:U.doctype+=ue,"]"===ue?U.state=ee.DOCTYPE:z(ue)&&(U.state=ee.DOCTYPE_DTD_QUOTED,U.q=ue);continue;case ee.DOCTYPE_DTD_QUOTED:U.doctype+=ue,ue===U.q&&(U.state=ee.DOCTYPE_DTD,U.q="");continue;case ee.COMMENT:"-"===ue?U.state=ee.COMMENT_ENDING:U.comment+=ue;continue;case ee.COMMENT_ENDING:"-"===ue?(U.state=ee.COMMENT_ENDED,U.comment=De(U.opt,U.comment),U.comment&&te(U,"oncomment",U.comment),U.comment=""):(U.comment+="-"+ue,U.state=ee.COMMENT);continue;case ee.COMMENT_ENDED:">"!==ue?(Xe(U,"Malformed comment"),U.comment+="--"+ue,U.state=ee.COMMENT):U.state=ee.TEXT;continue;case ee.CDATA:"]"===ue?U.state=ee.CDATA_ENDING:U.cdata+=ue;continue;case ee.CDATA_ENDING:"]"===ue?U.state=ee.CDATA_ENDING_2:(U.cdata+="]"+ue,U.state=ee.CDATA);continue;case ee.CDATA_ENDING_2:">"===ue?(U.cdata&&te(U,"oncdata",U.cdata),te(U,"onclosecdata"),U.cdata="",U.state=ee.TEXT):"]"===ue?U.cdata+="]":(U.cdata+="]]"+ue,U.state=ee.CDATA);continue;case ee.PROC_INST:"?"===ue?U.state=ee.PROC_INST_ENDING:w(ue)?U.state=ee.PROC_INST_BODY:U.procInstName+=ue;continue;case ee.PROC_INST_BODY:if(!U.procInstBody&&w(ue))continue;"?"===ue?U.state=ee.PROC_INST_ENDING:U.procInstBody+=ue;continue;case ee.PROC_INST_ENDING:">"===ue?(te(U,"onprocessinginstruction",{name:U.procInstName,body:U.procInstBody}),U.procInstName=U.procInstBody="",U.state=ee.TEXT):(U.procInstBody+="?"+ue,U.state=ee.PROC_INST_BODY);continue;case ee.OPEN_TAG:se(D,ue)?U.tagName+=ue:(Je(U),">"===ue?Fe(U):"/"===ue?U.state=ee.OPEN_TAG_SLASH:(w(ue)||Xe(U,"Invalid character in tag name"),U.state=ee.ATTRIB));continue;case ee.OPEN_TAG_SLASH:">"===ue?(Fe(U,!0),Ye(U)):(Xe(U,"Forward-slash in opening tag not followed by >"),U.state=ee.ATTRIB);continue;case ee.ATTRIB:if(w(ue))continue;">"===ue?Fe(U):"/"===ue?U.state=ee.OPEN_TAG_SLASH:se(ce,ue)?(U.attribName=ue,U.attribValue="",U.state=ee.ATTRIB_NAME):Xe(U,"Invalid attribute name");continue;case ee.ATTRIB_NAME:"="===ue?U.state=ee.ATTRIB_VALUE:">"===ue?(Xe(U,"Attribute without value"),U.attribValue=U.attribName,je(U),Fe(U)):w(ue)?U.state=ee.ATTRIB_NAME_SAW_WHITE:se(D,ue)?U.attribName+=ue:Xe(U,"Invalid attribute name");continue;case ee.ATTRIB_NAME_SAW_WHITE:if("="===ue)U.state=ee.ATTRIB_VALUE;else{if(w(ue))continue;Xe(U,"Attribute without value"),U.tag.attributes[U.attribName]="",U.attribValue="",te(U,"onattribute",{name:U.attribName,value:""}),U.attribName="",">"===ue?Fe(U):se(ce,ue)?(U.attribName=ue,U.state=ee.ATTRIB_NAME):(Xe(U,"Invalid attribute name"),U.state=ee.ATTRIB)}continue;case ee.ATTRIB_VALUE:if(w(ue))continue;z(ue)?(U.q=ue,U.state=ee.ATTRIB_VALUE_QUOTED):(Xe(U,"Unquoted attribute value"),U.state=ee.ATTRIB_VALUE_UNQUOTED,U.attribValue=ue);continue;case ee.ATTRIB_VALUE_QUOTED:if(ue!==U.q){"&"===ue?U.state=ee.ATTRIB_VALUE_ENTITY_Q:U.attribValue+=ue;continue}je(U),U.q="",U.state=ee.ATTRIB_VALUE_CLOSED;continue;case ee.ATTRIB_VALUE_CLOSED:w(ue)?U.state=ee.ATTRIB:">"===ue?Fe(U):"/"===ue?U.state=ee.OPEN_TAG_SLASH:se(ce,ue)?(Xe(U,"No whitespace between attributes"),U.attribName=ue,U.attribValue="",U.state=ee.ATTRIB_NAME):Xe(U,"Invalid attribute name");continue;case ee.ATTRIB_VALUE_UNQUOTED:if(!Q(ue)){"&"===ue?U.state=ee.ATTRIB_VALUE_ENTITY_U:U.attribValue+=ue;continue}je(U),">"===ue?Fe(U):U.state=ee.ATTRIB;continue;case ee.CLOSE_TAG:if(U.tagName)">"===ue?Ye(U):se(D,ue)?U.tagName+=ue:U.script?(U.script+="</"+U.tagName,U.tagName="",U.state=ee.SCRIPT):(w(ue)||Xe(U,"Invalid tagname in closing tag"),U.state=ee.CLOSE_TAG_SAW_WHITE);else{if(w(ue))continue;oe(ce,ue)?U.script?(U.script+="</"+ue,U.state=ee.SCRIPT):Xe(U,"Invalid tagname in closing tag."):U.tagName=ue}continue;case ee.CLOSE_TAG_SAW_WHITE:if(w(ue))continue;">"===ue?Ye(U):Xe(U,"Invalid characters in closing tag");continue;case ee.TEXT_ENTITY:case ee.ATTRIB_VALUE_ENTITY_Q:case ee.ATTRIB_VALUE_ENTITY_U:var ft,ve;switch(U.state){case ee.TEXT_ENTITY:ft=ee.TEXT,ve="textNode";break;case ee.ATTRIB_VALUE_ENTITY_Q:ft=ee.ATTRIB_VALUE_QUOTED,ve="attribValue";break;case ee.ATTRIB_VALUE_ENTITY_U:ft=ee.ATTRIB_VALUE_UNQUOTED,ve="attribValue"}";"===ue?(U[ve]+=Ce(U),U.entity="",U.state=ft):se(U.entity.length?X:I,ue)?U.entity+=ue:(Xe(U,"Invalid character in entity name"),U[ve]+="&"+U.entity+ue,U.entity="",U.state=ft);continue;default:throw new Error(U,"Unknown state: "+U.state)}return U.position>=U.bufferCheckPosition&&function(G){for(var U=Math.max(V.MAX_BUFFER_LENGTH,10),he=0,ue=0,ke=L.length;ue<ke;ue++){var gt=G[L[ue]].length;if(gt>U)switch(L[ue]){case"textNode":_e(G);break;case"cdata":te(G,"oncdata",G.cdata),G.cdata="";break;case"script":te(G,"onscript",G.script),G.script="";break;default:He(G,"Max buffer length exceeded: "+L[ue])}he=Math.max(he,gt)}G.bufferCheckPosition=V.MAX_BUFFER_LENGTH-he+G.position}(U),U},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(G){_e(G),""!==G.cdata&&(te(G,"oncdata",G.cdata),G.cdata=""),""!==G.script&&(te(G,"onscript",G.script),G.script="")}(this)}};try{N=Y("stream").Stream}catch(G){N=function(){}}var M=V.EVENTS.filter(function(G){return"error"!==G&&"end"!==G});function y(G,U){if(!(this instanceof y))return new y(G,U);N.apply(this),this._parser=new ie(G,U),this.writable=!0,this.readable=!0;var he=this;this._parser.onend=function(){he.emit("end")},this._parser.onerror=function(ue){he.emit("error",ue),he._parser.error=null},this._decoder=null,M.forEach(function(ue){Object.defineProperty(he,"on"+ue,{get:function(){return he._parser["on"+ue]},set:function(ke){if(!ke)return he.removeAllListeners(ue),he._parser["on"+ue]=ke,ke;he.on(ue,ke)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(N.prototype,{constructor:{value:y}})).write=function(G){if("function"==typeof K&&"function"==typeof K.isBuffer&&K.isBuffer(G)){if(!this._decoder){var U=Y("string_decoder").StringDecoder;this._decoder=new U("utf8")}G=this._decoder.write(G)}return this._parser.write(G.toString()),this.emit("data",G),!0},y.prototype.end=function(G){return G&&G.length&&this.write(G),this._parser.end(),!0},y.prototype.on=function(G,U){var he=this;return!he._parser["on"+G]&&-1!==M.indexOf(G)&&(he._parser["on"+G]=function(){var ue=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);ue.splice(0,0,G),he.emit.apply(he,ue)}),N.prototype.on.call(he,G,U)};var j="http://www.w3.org/XML/1998/namespace",O="http://www.w3.org/2000/xmlns/",q={xml:j,xmlns:O},ce=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,D=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,I=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,X=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function w(G){return" "===G||"\n"===G||"\r"===G||"\t"===G}function z(G){return'"'===G||"'"===G}function Q(G){return">"===G||w(G)}function se(G,U){return G.test(U)}function oe(G,U){return!se(G,U)}var G,U,he,ee=0;for(var Se in V.STATE={BEGIN:ee++,BEGIN_WHITESPACE:ee++,TEXT:ee++,TEXT_ENTITY:ee++,OPEN_WAKA:ee++,SGML_DECL:ee++,SGML_DECL_QUOTED:ee++,DOCTYPE:ee++,DOCTYPE_QUOTED:ee++,DOCTYPE_DTD:ee++,DOCTYPE_DTD_QUOTED:ee++,COMMENT_STARTING:ee++,COMMENT:ee++,COMMENT_ENDING:ee++,COMMENT_ENDED:ee++,CDATA:ee++,CDATA_ENDING:ee++,CDATA_ENDING_2:ee++,PROC_INST:ee++,PROC_INST_BODY:ee++,PROC_INST_ENDING:ee++,OPEN_TAG:ee++,OPEN_TAG_SLASH:ee++,ATTRIB:ee++,ATTRIB_NAME:ee++,ATTRIB_NAME_SAW_WHITE:ee++,ATTRIB_VALUE:ee++,ATTRIB_VALUE_QUOTED:ee++,ATTRIB_VALUE_CLOSED:ee++,ATTRIB_VALUE_UNQUOTED:ee++,ATTRIB_VALUE_ENTITY_Q:ee++,ATTRIB_VALUE_ENTITY_U:ee++,CLOSE_TAG:ee++,CLOSE_TAG_SAW_WHITE:ee++,SCRIPT:ee++,SCRIPT_ENDING:ee++},V.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},V.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(V.ENTITIES).forEach(function(G){var U=V.ENTITIES[G],he="number"==typeof U?String.fromCharCode(U):U;V.ENTITIES[G]=he}),V.STATE)V.STATE[V.STATE[Se]]=Se;function pe(G,U,he){G[U]&&G[U](he)}function te(G,U,he){G.textNode&&_e(G),pe(G,U,he)}function _e(G){G.textNode=De(G.opt,G.textNode),G.textNode&&pe(G,"ontext",G.textNode),G.textNode=""}function De(G,U){return G.trim&&(U=U.trim()),G.normalize&&(U=U.replace(/\s+/g," ")),U}function He(G,U){return _e(G),G.trackPosition&&(U+="\nLine: "+G.line+"\nColumn: "+G.column+"\nChar: "+G.c),U=new Error(U),G.error=U,pe(G,"onerror",U),G}function rt(G){return G.sawRoot&&!G.closedRoot&&Xe(G,"Unclosed root tag"),G.state!==ee.BEGIN&&G.state!==ee.BEGIN_WHITESPACE&&G.state!==ee.TEXT&&He(G,"Unexpected end"),_e(G),G.c="",G.closed=!0,pe(G,"onend"),ie.call(G,G.strict,G.opt),G}function Xe(G,U){if("object"!=typeof G||!(G instanceof ie))throw new Error("bad call to strictFail");G.strict&&He(G,U)}function Je(G){G.strict||(G.tagName=G.tagName[G.looseCase]());var U=G.tags[G.tags.length-1]||G,he=G.tag={name:G.tagName,attributes:{}};G.opt.xmlns&&(he.ns=U.ns),G.attribList.length=0,te(G,"onopentagstart",he)}function Ke(G,U){var ue=G.indexOf(":")<0?["",G]:G.split(":"),ke=ue[0],gt=ue[1];return U&&"xmlns"===G&&(ke="xmlns",gt=""),{prefix:ke,local:gt}}function je(G){if(G.strict||(G.attribName=G.attribName[G.looseCase]()),-1!==G.attribList.indexOf(G.attribName)||G.tag.attributes.hasOwnProperty(G.attribName))G.attribName=G.attribValue="";else{if(G.opt.xmlns){var U=Ke(G.attribName,!0),ue=U.local;if("xmlns"===U.prefix)if("xml"===ue&&G.attribValue!==j)Xe(G,"xml: prefix must be bound to "+j+"\nActual: "+G.attribValue);else if("xmlns"===ue&&G.attribValue!==O)Xe(G,"xmlns: prefix must be bound to "+O+"\nActual: "+G.attribValue);else{var ke=G.tag,gt=G.tags[G.tags.length-1]||G;ke.ns===gt.ns&&(ke.ns=Object.create(gt.ns)),ke.ns[ue]=G.attribValue}G.attribList.push([G.attribName,G.attribValue])}else G.tag.attributes[G.attribName]=G.attribValue,te(G,"onattribute",{name:G.attribName,value:G.attribValue});G.attribName=G.attribValue=""}}function Fe(G,U){if(G.opt.xmlns){var he=G.tag,ue=Ke(G.tagName);he.prefix=ue.prefix,he.local=ue.local,he.uri=he.ns[ue.prefix]||"",he.prefix&&!he.uri&&(Xe(G,"Unbound namespace prefix: "+JSON.stringify(G.tagName)),he.uri=ue.prefix),he.ns&&(G.tags[G.tags.length-1]||G).ns!==he.ns&&Object.keys(he.ns).forEach(function(In){te(G,"onopennamespace",{prefix:In,uri:he.ns[In]})});for(var gt=0,ft=G.attribList.length;gt<ft;gt++){var ve=G.attribList[gt],k=ve[0],R=ve[1],B=Ke(k,!0),Oe=B.prefix,bt=""===Oe?"":he.ns[Oe]||"",It={name:k,value:R,prefix:Oe,local:B.local,uri:bt};Oe&&"xmlns"!==Oe&&!bt&&(Xe(G,"Unbound namespace prefix: "+JSON.stringify(Oe)),It.uri=Oe),G.tag.attributes[k]=It,te(G,"onattribute",It)}G.attribList.length=0}G.tag.isSelfClosing=!!U,G.sawRoot=!0,G.tags.push(G.tag),te(G,"onopentag",G.tag),U||(G.state=G.noscript||"script"!==G.tagName.toLowerCase()?ee.TEXT:ee.SCRIPT,G.tag=null,G.tagName=""),G.attribName=G.attribValue="",G.attribList.length=0}function Ye(G){if(!G.tagName)return Xe(G,"Weird empty close tag."),G.textNode+="</>",void(G.state=ee.TEXT);if(G.script){if("script"!==G.tagName)return G.script+="</"+G.tagName+">",G.tagName="",void(G.state=ee.SCRIPT);te(G,"onscript",G.script),G.script=""}var U=G.tags.length,he=G.tagName;G.strict||(he=he[G.looseCase]());for(var ue=he;U--&&G.tags[U].name!==ue;)Xe(G,"Unexpected close tag");if(U<0)return Xe(G,"Unmatched closing tag: "+G.tagName),G.textNode+="</"+G.tagName+">",void(G.state=ee.TEXT);G.tagName=he;for(var gt=G.tags.length;gt-- >U;){var ft=G.tag=G.tags.pop();G.tagName=G.tag.name,te(G,"onclosetag",G.tagName);var ve={};for(var k in ft.ns)ve[k]=ft.ns[k];G.opt.xmlns&&ft.ns!==(G.tags[G.tags.length-1]||G).ns&&Object.keys(ft.ns).forEach(function(B){te(G,"onclosenamespace",{prefix:B,uri:ft.ns[B]})})}0===U&&(G.closedRoot=!0),G.tagName=G.attribValue=G.attribName="",G.attribList.length=0,G.state=ee.TEXT}function Ce(G){var ue,U=G.entity,he=U.toLowerCase(),ke="";return G.ENTITIES[U]?G.ENTITIES[U]:G.ENTITIES[he]?G.ENTITIES[he]:("#"===(U=he).charAt(0)&&("x"===U.charAt(1)?(U=U.slice(2),ke=(ue=parseInt(U,16)).toString(16)):(U=U.slice(1),ke=(ue=parseInt(U,10)).toString(10))),U=U.replace(/^0+/,""),isNaN(ue)||ke.toLowerCase()!==U?(Xe(G,"Invalid character entity"),"&"+G.entity+";"):String.fromCodePoint(ue))}function Be(G,U){"<"===U?(G.state=ee.OPEN_WAKA,G.startTagPosition=G.position):w(U)||(Xe(G,"Non-whitespace before first tag."),G.textNode=U,G.state=ee.TEXT)}function $e(G,U){var he="";return U<G.length&&(he=G.charAt(U)),he}ee=V.STATE,String.fromCodePoint||(G=String.fromCharCode,U=Math.floor,he=function(){var ue=16384,ke=[],ve=-1,k=arguments.length;if(!k)return"";for(var R="";++ve<k;){var B=Number(arguments[ve]);if(!isFinite(B)||B<0||B>1114111||U(B)!==B)throw RangeError("Invalid code point: "+B);B<=65535?ke.push(B):ke.push(55296+((B-=65536)>>10),B%1024+56320),(ve+1===k||ke.length>ue)&&(R+=G.apply(null,ke),ke.length=0)}return R},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:he,configurable:!0,writable:!0}):String.fromCodePoint=he)}(void 0===fe?this.sax={}:fe)}).call(this)}).call(this,Y("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(Y,Te,fe){(function(K,V){(function(){!function(L,ie){"use strict";if(!L.setImmediate){var M,$=1,v={},S=!1,N=L.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(L);X=X&&X.setTimeout?X:L,"[object process]"==={}.toString.call(L.process)?M=function(w){K.nextTick(function(){x(w)})}:function(){if(L.postMessage&&!L.importScripts){var w=!0,z=L.onmessage;return L.onmessage=function(){w=!1},L.postMessage("","*"),L.onmessage=z,w}}()?(w="setImmediate$"+Math.random()+"$",z=function(Q){Q.source===L&&"string"==typeof Q.data&&0===Q.data.indexOf(w)&&x(+Q.data.slice(w.length))},L.addEventListener?L.addEventListener("message",z,!1):L.attachEvent("onmessage",z),M=function(Q){L.postMessage(w+Q,"*")}):L.MessageChannel?function(){var w=new MessageChannel;w.port1.onmessage=function(z){x(z.data)},M=function(z){w.port2.postMessage(z)}}():N&&"onreadystatechange"in N.createElement("script")?function(){var w=N.documentElement;M=function(z){var Q=N.createElement("script");Q.onreadystatechange=function(){x(z),Q.onreadystatechange=null,w.removeChild(Q),Q=null},w.appendChild(Q)}}():M=function(w){setTimeout(x,0,w)},X.setImmediate=function(w){"function"!=typeof w&&(w=new Function(""+w));for(var z=new Array(arguments.length-1),Q=0;Q<z.length;Q++)z[Q]=arguments[Q+1];return v[$]={callback:w,args:z},M($),$++},X.clearImmediate=y}var w,z;function y(w){delete v[w]}function x(w){if(S)setTimeout(x,0,w);else{var z=v[w];if(z){S=!0;try{!function(w){var z=w.callback,Q=w.args;switch(Q.length){case 0:z();break;case 1:z(Q[0]);break;case 2:z(Q[0],Q[1]);break;case 3:z(Q[0],Q[1],Q[2]);break;default:z.apply(void 0,Q)}}(z)}finally{y(w),S=!1}}}}}("undefined"==typeof self?void 0===V?this:V:self)}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(Y,Te,fe){Te.exports=L;var K=Y("events").EventEmitter;function L(){K.call(this)}Y("inherits")(L,K),L.Readable=Y("readable-stream/lib/_stream_readable.js"),L.Writable=Y("readable-stream/lib/_stream_writable.js"),L.Duplex=Y("readable-stream/lib/_stream_duplex.js"),L.Transform=Y("readable-stream/lib/_stream_transform.js"),L.PassThrough=Y("readable-stream/lib/_stream_passthrough.js"),L.finished=Y("readable-stream/lib/internal/streams/end-of-stream.js"),L.pipeline=Y("readable-stream/lib/internal/streams/pipeline.js"),L.Stream=L,L.prototype.pipe=function(ie,$){var v=this;function S(j){ie.writable&&!1===ie.write(j)&&v.pause&&v.pause()}function N(){v.readable&&v.resume&&v.resume()}v.on("data",S),ie.on("drain",N),!ie._isStdio&&(!$||!1!==$.end)&&(v.on("end",b),v.on("close",y));var M=!1;function b(){M||(M=!0,ie.end())}function y(){M||(M=!0,"function"==typeof ie.destroy&&ie.destroy())}function E(j){if(x(),0===K.listenerCount(this,"error"))throw j}function x(){v.removeListener("data",S),ie.removeListener("drain",N),v.removeListener("end",b),v.removeListener("close",y),v.removeListener("error",E),ie.removeListener("error",E),v.removeListener("end",x),v.removeListener("close",x),ie.removeListener("close",x)}return v.on("error",E),ie.on("error",E),v.on("end",x),v.on("close",x),ie.on("close",x),ie.emit("pipe",v),ie}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(Y,Te,fe){arguments[4][5][0].apply(fe,arguments)},{dup:5,"safe-buffer":84}],89:[function(Y,Te,fe){(function(K,V){(function(){var L=Y("process/browser.js").nextTick,ie=Function.prototype.apply,$=Array.prototype.slice,v={},S=0;function N(M,b){this._id=M,this._clearFn=b}fe.setTimeout=function(){return new N(ie.call(setTimeout,window,arguments),clearTimeout)},fe.setInterval=function(){return new N(ie.call(setInterval,window,arguments),clearInterval)},fe.clearTimeout=fe.clearInterval=function(M){M.close()},N.prototype.unref=N.prototype.ref=function(){},N.prototype.close=function(){this._clearFn.call(window,this._id)},fe.enroll=function(M,b){clearTimeout(M._idleTimeoutId),M._idleTimeout=b},fe.unenroll=function(M){clearTimeout(M._idleTimeoutId),M._idleTimeout=-1},fe._unrefActive=fe.active=function(M){clearTimeout(M._idleTimeoutId);var b=M._idleTimeout;b>=0&&(M._idleTimeoutId=setTimeout(function(){M._onTimeout&&M._onTimeout()},b))},fe.setImmediate="function"==typeof K?K:function(M){var b=S++,y=!(arguments.length<2)&&$.call(arguments,1);return v[b]=!0,L(function(){v[b]&&(y?M.apply(null,y):M.call(null),fe.clearImmediate(b))}),b},fe.clearImmediate="function"==typeof V?V:function(M){delete v[M]}}).call(this)}).call(this,Y("timers").setImmediate,Y("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(Y,Te,fe){(function(K){(function(){function L(ie){try{if(!K.localStorage)return!1}catch(v){return!1}var $=K.localStorage[ie];return null!=$&&"true"===String($).toLowerCase()}Te.exports=function(ie,$){if(L("noDeprecation"))return ie;var v=!1;return function(){if(!v){if(L("throwDeprecation"))throw new Error($);L("traceDeprecation")?console.trace($):console.warn($),v=!0}return ie.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(Y,Te,fe){"use strict";Te.exports=function(K){K.prototype[Symbol.iterator]=function*(){for(let V=this.head;V;V=V.next)yield V.value}}},{}],92:[function(Y,Te,fe){"use strict";function K(v){var S=this;if(S instanceof K||(S=new K),S.tail=null,S.head=null,S.length=0,v&&"function"==typeof v.forEach)v.forEach(function(b){S.push(b)});else if(arguments.length>0)for(var N=0,M=arguments.length;N<M;N++)S.push(arguments[N]);return S}function V(v,S,N){var M=S===v.head?new $(N,null,S,v):new $(N,S,S.next,v);return null===M.next&&(v.tail=M),null===M.prev&&(v.head=M),v.length++,M}function L(v,S){v.tail=new $(S,v.tail,null,v),v.head||(v.head=v.tail),v.length++}function ie(v,S){v.head=new $(S,null,v.head,v),v.tail||(v.tail=v.head),v.length++}function $(v,S,N,M){if(!(this instanceof $))return new $(v,S,N,M);this.list=M,this.value=v,S?(S.next=this,this.prev=S):this.prev=null,N?(N.prev=this,this.next=N):this.next=null}Te.exports=K,K.Node=$,K.create=K,K.prototype.removeNode=function(v){if(v.list!==this)throw new Error("removing node which does not belong to this list");var S=v.next,N=v.prev;return S&&(S.prev=N),N&&(N.next=S),v===this.head&&(this.head=S),v===this.tail&&(this.tail=N),v.list.length--,v.next=null,v.prev=null,v.list=null,S},K.prototype.unshiftNode=function(v){if(v!==this.head){v.list&&v.list.removeNode(v);var S=this.head;v.list=this,v.next=S,S&&(S.prev=v),this.head=v,this.tail||(this.tail=v),this.length++}},K.prototype.pushNode=function(v){if(v!==this.tail){v.list&&v.list.removeNode(v);var S=this.tail;v.list=this,v.prev=S,S&&(S.next=v),this.tail=v,this.head||(this.head=v),this.length++}},K.prototype.push=function(){for(var v=0,S=arguments.length;v<S;v++)L(this,arguments[v]);return this.length},K.prototype.unshift=function(){for(var v=0,S=arguments.length;v<S;v++)ie(this,arguments[v]);return this.length},K.prototype.pop=function(){if(this.tail){var v=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,v}},K.prototype.shift=function(){if(this.head){var v=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,v}},K.prototype.forEach=function(v,S){S=S||this;for(var N=this.head,M=0;null!==N;M++)v.call(S,N.value,M,this),N=N.next},K.prototype.forEachReverse=function(v,S){S=S||this;for(var N=this.tail,M=this.length-1;null!==N;M--)v.call(S,N.value,M,this),N=N.prev},K.prototype.get=function(v){for(var S=0,N=this.head;null!==N&&S<v;S++)N=N.next;if(S===v&&null!==N)return N.value},K.prototype.getReverse=function(v){for(var S=0,N=this.tail;null!==N&&S<v;S++)N=N.prev;if(S===v&&null!==N)return N.value},K.prototype.map=function(v,S){S=S||this;for(var N=new K,M=this.head;null!==M;)N.push(v.call(S,M.value,this)),M=M.next;return N},K.prototype.mapReverse=function(v,S){S=S||this;for(var N=new K,M=this.tail;null!==M;)N.push(v.call(S,M.value,this)),M=M.prev;return N},K.prototype.reduce=function(v,S){var N,M=this.head;if(arguments.length>1)N=S;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");M=this.head.next,N=this.head.value}for(var b=0;null!==M;b++)N=v(N,M.value,b),M=M.next;return N},K.prototype.reduceReverse=function(v,S){var N,M=this.tail;if(arguments.length>1)N=S;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");M=this.tail.prev,N=this.tail.value}for(var b=this.length-1;null!==M;b--)N=v(N,M.value,b),M=M.prev;return N},K.prototype.toArray=function(){for(var v=new Array(this.length),S=0,N=this.head;null!==N;S++)v[S]=N.value,N=N.next;return v},K.prototype.toArrayReverse=function(){for(var v=new Array(this.length),S=0,N=this.tail;null!==N;S++)v[S]=N.value,N=N.prev;return v},K.prototype.slice=function(v,S){(S=S||this.length)<0&&(S+=this.length),(v=v||0)<0&&(v+=this.length);var N=new K;if(S<v||S<0)return N;v<0&&(v=0),S>this.length&&(S=this.length);for(var M=0,b=this.head;null!==b&&M<v;M++)b=b.next;for(;null!==b&&M<S;M++,b=b.next)N.push(b.value);return N},K.prototype.sliceReverse=function(v,S){(S=S||this.length)<0&&(S+=this.length),(v=v||0)<0&&(v+=this.length);var N=new K;if(S<v||S<0)return N;v<0&&(v=0),S>this.length&&(S=this.length);for(var M=this.length,b=this.tail;null!==b&&M>S;M--)b=b.prev;for(;null!==b&&M>v;M--,b=b.prev)N.push(b.value);return N},K.prototype.splice=function(v,S,...N){v>this.length&&(v=this.length-1),v<0&&(v=this.length+v);for(var M=0,b=this.head;null!==b&&M<v;M++)b=b.next;var y=[];for(M=0;b&&M<S;M++)y.push(b.value),b=this.removeNode(b);for(null===b&&(b=this.tail),b!==this.head&&b!==this.tail&&(b=b.prev),M=0;M<N.length;M++)b=V(this,b,N[M]);return y},K.prototype.reverse=function(){for(var v=this.head,S=this.tail,N=v;null!==N;N=N.prev){var M=N.prev;N.prev=N.next,N.next=M}return this.head=S,this.tail=v,this};try{Y("./iterator.js")(K)}catch(v){}},{"./iterator.js":91}]},{},[1])(1)},322:kt=>{kt.exports=function(tt,mt){var J=mt.length;if(0!==J){var At=tt.length;tt.length+=J;for(var dt=0;dt<J;dt++)tt[At+dt]=mt[dt]}}},517:(kt,nt)=>{"use strict";var mt=(()=>{return(At=mt||(mt={})).typeOfFunction="function",At.boolTrue=!0,mt;var At})();function J(At,dt,Y){if(!Y||typeof Y.value!==mt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+dt+"> is not a method!");return{configurable:mt.boolTrue,get:function(){var Te=Y.value.bind(this);return Object.defineProperty(this,dt,{value:Te,configurable:mt.boolTrue,writable:mt.boolTrue}),Te}}}nt.ak=J,nt.ZP=J},266:(kt,nt,tt)=>{kt.exports={ResizeSensor:tt(835),ElementQueries:tt(845)}},845:function(kt,nt,tt){"use strict";var mt,J,At;"undefined"!=typeof window&&window,J=[tt(835)],void 0!==(At="function"==typeof(mt=function(dt){var Y=function(){var fe,K={},V=[];function L(D){D||(D=document.documentElement);var I=window.getComputedStyle(D,null).fontSize;return parseFloat(I)||16}function $(D,I){var X=I.split(/\d/),w=X[X.length-1];switch(I=parseFloat(I),w){case"px":return I;case"em":return I*L(D);case"rem":return I*L();case"vw":return I*document.documentElement.clientWidth/100;case"vh":return I*document.documentElement.clientHeight/100;case"vmin":case"vmax":var z=document.documentElement.clientWidth/100,Q=document.documentElement.clientHeight/100;return I*(0,Math["vmin"===w?"min":"max"])(z,Q);default:return I}}function v(D,I){this.element=D;var X,w,z,Q,se,oe,ee,Se,pe=["min-width","min-height","max-width","max-height"];this.call=function(){for(X in z=function(D){if(!D.getBoundingClientRect)return{width:D.offsetWidth,height:D.offsetHeight};var I=D.getBoundingClientRect();return{width:Math.round(I.width),height:Math.round(I.height)}}(this.element),oe={},K[I])!K[I].hasOwnProperty(X)||(Q=$(this.element,(w=K[I][X]).value),se="width"===w.property?z.width:z.height,ee="","min"===w.mode&&se>=Q&&(ee+=w.value),"max"===w.mode&&se<=Q&&(ee+=w.value),oe[Se=w.mode+"-"+w.property]||(oe[Se]=""),ee&&-1===(" "+oe[Se]+" ").indexOf(" "+ee+" ")&&(oe[Se]+=" "+ee));for(var te in pe)!pe.hasOwnProperty(te)||(oe[pe[te]]?this.element.setAttribute(pe[te],oe[pe[te]].substr(1)):this.element.removeAttribute(pe[te]))}}function S(D,I){D.elementQueriesSetupInformation||(D.elementQueriesSetupInformation=new v(D,I)),D.elementQueriesSensor||(D.elementQueriesSensor=new dt(D,function(){D.elementQueriesSetupInformation.call()}))}function N(D,I,X,w){if(void 0===K[D]){K[D]=[];var z=V.length;fe.innerHTML+="\n"+D+" {animation: 0.1s element-queries;}",fe.innerHTML+="\n"+D+" > .resize-sensor {min-width: "+z+"px;}",V.push(D)}K[D].push({mode:I,property:X,value:w})}function M(D){var I;if(document.querySelectorAll&&(I=D?D.querySelectorAll.bind(D):document.querySelectorAll.bind(document)),!I&&"undefined"!=typeof $$&&(I=$$),!I&&"undefined"!=typeof jQuery&&(I=jQuery),!I)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return I}function y(D){var I=[],X=[],w=[],z=0,Q=-1,se=[];for(var oe in D.children)if(D.children.hasOwnProperty(oe)&&D.children[oe].tagName&&"img"===D.children[oe].tagName.toLowerCase()){I.push(D.children[oe]);var ee=D.children[oe].getAttribute("min-width")||D.children[oe].getAttribute("data-min-width"),Se=D.children[oe].getAttribute("data-src")||D.children[oe].getAttribute("url");w.push(Se),X.push({minWidth:ee}),ee?D.children[oe].style.display="none":(z=I.length-1,D.children[oe].style.display="block")}function te(){var De,_e=!1;for(De in I)!I.hasOwnProperty(De)||X[De].minWidth&&D.offsetWidth>X[De].minWidth&&(_e=De);if(_e||(_e=z),Q!==_e)if(se[_e])I[Q].style.display="none",I[_e].style.display="block",Q=_e;else{var He=new Image;He.onload=function(){I[_e].src=w[_e],I[Q].style.display="none",I[_e].style.display="block",se[_e]=!0,Q=_e},He.src=w[_e]}else I[_e].src=w[_e]}Q=z,D.resizeSensorInstance=new dt(D,te),te()}var x=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,j=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function O(D){var I,X,w,z;for(D=D.replace(/'/g,'"');null!==(I=x.exec(D));)for(X=I[1]+I[3],w=I[2];null!==(z=j.exec(w));)N(X,z[1],z[2],z[3])}function q(D){var I="";if(D)if("string"==typeof D)(-1!==(D=D.toLowerCase()).indexOf("min-width")||-1!==D.indexOf("max-width"))&&O(D);else for(var X=0,w=D.length;X<w;X++)1===D[X].type?(-1!==(I=D[X].selectorText||D[X].cssText).indexOf("min-height")||-1!==I.indexOf("max-height")||-1!==I.indexOf("min-width")||-1!==I.indexOf("max-width"))&&O(I):4===D[X].type?q(D[X].cssRules||D[X].rules):3===D[X].type&&D[X].styleSheet.hasOwnProperty("cssRules")&&q(D[X].styleSheet.cssRules)}var ce=!1;this.init=function(){var D="animationstart";void 0!==document.documentElement.style.webkitAnimationName?D="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?D="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(D="oanimationstart"),document.body.addEventListener(D,function(w){var z=w.target,Q=z&&window.getComputedStyle(z,null),se=Q&&Q.getPropertyValue("animation-name");if(se&&-1!==se.indexOf("element-queries")){z.elementQueriesSensor=new dt(z,function(){z.elementQueriesSetupInformation&&z.elementQueriesSetupInformation.call()});var Se=window.getComputedStyle(z.resizeSensor,null).getPropertyValue("min-width");Se=parseInt(Se.replace("px","")),S(w.target,V[Se])}}),ce||((fe=document.createElement("style")).type="text/css",fe.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",fe.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(fe),ce=!0);for(var I=0,X=document.styleSheets.length;I<X;I++)try{document.styleSheets[I].href&&0===document.styleSheets[I].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[I].href),q(document.styleSheets[I].cssRules||document.styleSheets[I].rules||document.styleSheets[I].cssText)}catch(w){}!function(){for(var I=M()("[data-responsive-image],[responsive-image]"),X=0,w=I.length;X<w;X++)y(I[X])}()},this.findElementQueriesElements=function(D){!function(D){var I=M(D);for(var X in K)if(K.hasOwnProperty(X))for(var w=I(X,D),z=0,Q=w.length;z<Q;z++)S(w[z],X)}(D)},this.update=function(){this.init()}};Y.update=function(){Y.instance.update()},Y.detach=function(fe){fe.elementQueriesSetupInformation?(fe.elementQueriesSensor.detach(),delete fe.elementQueriesSetupInformation,delete fe.elementQueriesSensor):fe.resizeSensorInstance&&(fe.resizeSensorInstance.detach(),delete fe.resizeSensorInstance)},Y.init=function(){Y.instance||(Y.instance=new Y),Y.instance.init()};return Y.findElementQueriesElements=function(fe){Y.instance.findElementQueriesElements(fe)},Y.listen=function(){!function(fe){if(document.addEventListener)document.addEventListener("DOMContentLoaded",fe,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var K=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(fe(),clearInterval(K))},10);else window.onload=fe}(Y.init)},Y})?mt.apply(nt,J):mt)&&(kt.exports=At)},835:function(kt,nt,tt){"use strict";var mt,J;"undefined"!=typeof window&&window,void 0!==(J="function"==typeof(mt=function(){if("undefined"==typeof window)return null;var At="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),dt=At.requestAnimationFrame||At.mozRequestAnimationFrame||At.webkitRequestAnimationFrame||function(ie){return At.setTimeout(ie,20)},Y=At.cancelAnimationFrame||At.mozCancelAnimationFrame||At.webkitCancelAnimationFrame||function(ie){At.clearTimeout(ie)};function Te(ie,$){var v=Object.prototype.toString.call(ie),S="[object Array]"===v||"[object NodeList]"===v||"[object HTMLCollection]"===v||"[object Object]"===v||"undefined"!=typeof jQuery&&ie instanceof jQuery||"undefined"!=typeof Elements&&ie instanceof Elements,N=0,M=ie.length;if(S)for(;N<M;N++)$(ie[N]);else $(ie)}function fe(ie){if(!ie.getBoundingClientRect)return{width:ie.offsetWidth,height:ie.offsetHeight};var $=ie.getBoundingClientRect();return{width:Math.round($.width),height:Math.round($.height)}}function K(ie,$){Object.keys($).forEach(function(v){ie.style[v]=$[v]})}var V=function(ie,$){var v=0;function S(){var b,y,M=[];this.add=function(E){M.push(E)},this.call=function(E){for(b=0,y=M.length;b<y;b++)M[b].call(this,E)},this.remove=function(E){var x=[];for(b=0,y=M.length;b<y;b++)M[b]!==E&&x.push(M[b]);M=x},this.length=function(){return M.length}}function N(M,b){if(M){if(M.resizedAttached)return void M.resizedAttached.add(b);M.resizedAttached=new S,M.resizedAttached.add(b),M.resizeSensor=document.createElement("div"),M.resizeSensor.dir="ltr",M.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},E={position:"absolute",left:"0px",top:"0px",transition:"0s"};K(M.resizeSensor,y);var x=document.createElement("div");x.className="resize-sensor-expand",K(x,y);var j=document.createElement("div");K(j,E),x.appendChild(j);var O=document.createElement("div");O.className="resize-sensor-shrink",K(O,y);var q=document.createElement("div");K(q,E),K(q,{width:"200%",height:"200%"}),O.appendChild(q),M.resizeSensor.appendChild(x),M.resizeSensor.appendChild(O),M.appendChild(M.resizeSensor);var ce=window.getComputedStyle(M),D=ce?ce.getPropertyValue("position"):null;"absolute"!==D&&"relative"!==D&&"fixed"!==D&&"sticky"!==D&&(M.style.position="relative");var I=!1,X=0,w=fe(M),z=0,Q=0,se=!0;v=0;var ee=function(){if(se){if(0===M.offsetWidth&&0===M.offsetHeight)return void(v||(v=dt(function(){v=0,ee()})));se=!1}var _e,De;De=M.offsetHeight,j.style.width=(_e=M.offsetWidth)+10+"px",j.style.height=De+10+"px",x.scrollLeft=_e+10,x.scrollTop=De+10,O.scrollLeft=_e+10,O.scrollTop=De+10};M.resizeSensor.resetSensor=ee;var Se=function(){X=0,I&&(z=w.width,Q=w.height,M.resizedAttached&&M.resizedAttached.call(w))},pe=function(){w=fe(M),(I=w.width!==z||w.height!==Q)&&!X&&(X=dt(Se)),ee()},te=function(_e,De,He){_e.attachEvent?_e.attachEvent("on"+De,He):_e.addEventListener(De,He)};te(x,"scroll",pe),te(O,"scroll",pe),v=dt(function(){v=0,ee()})}}Te(ie,function(M){N(M,$)}),this.detach=function(M){v||(Y(v),v=0),V.detach(ie,M)},this.reset=function(){ie.resizeSensor.resetSensor()}};if(V.reset=function(ie){Te(ie,function($){$.resizeSensor.resetSensor()})},V.detach=function(ie,$){Te(ie,function(v){!v||v.resizedAttached&&"function"==typeof $&&(v.resizedAttached.remove($),v.resizedAttached.length())||v.resizeSensor&&(v.contains(v.resizeSensor)&&v.removeChild(v.resizeSensor),delete v.resizeSensor,delete v.resizedAttached)})},"undefined"!=typeof MutationObserver){var L=new MutationObserver(function(ie){for(var $ in ie)if(ie.hasOwnProperty($))for(var v=ie[$].addedNodes,S=0;S<v.length;S++)v[S].resizeSensor&&V.reset(v[S])});document.addEventListener("DOMContentLoaded",function(ie){L.observe(document.body,{childList:!0,subtree:!0})})}return V})?mt.call(nt,tt,nt,kt):mt)&&(kt.exports=J)},445:(kt,nt,tt)=>{var mt=tt(910),J=tt(369),At=tt(322);function dt(ie,$,v){if(!mt(ie))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!ie.hasNode($))throw new Error('graphology-shortest-path: the "'+$+'" source node does not exist in the given graph.');if(!ie.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" target node does not exist in the given graph.');if(($=""+$)==(v=""+v))return[$];var S=ie.inboundNeighbors.bind(ie),N=ie.outboundNeighbors.bind(ie),M={},b={};M[$]=null,b[v]=null;var x,j,O,q,ce,D,I,X,y=[$],E=[v],w=!1;e:for(;y.length&&E.length;)if(y.length<=E.length){for(x=y,y=[],ce=0,I=x.length;ce<I;ce++)for(D=0,X=(O=N(j=x[ce])).length;D<X;D++)if((q=O[D])in M||(y.push(q),M[q]=j),q in b){w=!0;break e}}else for(x=E,E=[],ce=0,I=x.length;ce<I;ce++)for(j=x[ce],O=S(j),D=0,X=O.length;D<X;D++)if(q=O[D],q in b||(E.push(q),b[q]=j),q in M){w=!0;break e}if(!w)return null;for(var z=[];q;)z.unshift(q),q=M[q];for(q=b[z[z.length-1]];q;)z.push(q),q=b[q];return z.length?z:null}function Y(ie,$){if(!mt(ie))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!ie.hasNode($))throw new Error('graphology-shortest-path: the "'+$+'" source node does not exist in the given graph.');var N,M,b,y,E,x,v={},S={};for(v[$=""+$]=!0,S[$]=[$];Object.keys(v).length;)for(b in N=v,v={},N)for(E=0,x=(M=ie.outboundNeighbors(b)).length;E<x;E++)S[y=M[E]]||(S[y]=S[b].concat(y),v[y]=!0);return S}function Te(ie,$,v){if(!mt($))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!$.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" source node does not exist in the given graph.');v=""+v;var S=new Set,N={},M=0;N[v]=0;for(var y,E,x,b=[v];0!==b.length;){var j=[];for(y=0,E=b.length;y<E;y++)!S.has(x=b[y])&&(S.add(x),At(j,$[ie](x)),N[x]=M);M++,b=j}return N}var fe=Te.bind(null,"outboundNeighbors"),K=Te.bind(null,"neighbors");function V(ie,$,v){return arguments.length<3?Y(ie,$):dt(ie,$,v)}V.bidirectional=dt,V.singleSource=Y,V.singleSourceLength=fe,V.undirectedSingleSourceLength=K,V.brandes=function(ie,$){$=""+$;var b,y,E,x,j,O,q,ce,D,v=[],S={},N={},M=ie.nodes();for(O=0,ce=M.length;O<ce;O++)S[x=M[O]]=[],N[x]=0;var I={};N[$]=1,I[$]=0;for(var X=J.of($);X.size;)for(x=X.dequeue(),v.push(x),b=I[x],y=N[x],q=0,D=(E=ie.outboundNeighbors(x)).length;q<D;q++)(j=E[q])in I||(X.enqueue(j),I[j]=b+1),I[j]===b+1&&(N[j]+=y,S[j].push(x));return[v,S,N]},kt.exports=V},910:kt=>{kt.exports=function(tt){return null!==tt&&"object"==typeof tt&&"function"==typeof tt.addUndirectedEdgeWithKey&&"function"==typeof tt.dropNode&&"boolean"==typeof tt.multi}},698:function(kt){kt.exports=function(){"use strict";function nt(ne){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(de){return typeof de}:function(de){return de&&"function"==typeof Symbol&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de})(ne)}function tt(ne,de){ne.prototype=Object.create(de.prototype),ne.prototype.constructor=ne,J(ne,de)}function mt(ne){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(de){return de.__proto__||Object.getPrototypeOf(de)})(ne)}function J(ne,de){return(J=Object.setPrototypeOf||function(re,A){return re.__proto__=A,re})(ne,de)}function At(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ne){return!1}}function dt(ne,de,re){return(dt=At()?Reflect.construct:function(A,F,Z){var we=[null];we.push.apply(we,F);var Pe=new(Function.bind.apply(A,we));return Z&&J(Pe,Z.prototype),Pe}).apply(null,arguments)}function Y(ne){var de="function"==typeof Map?new Map:void 0;return(Y=function(re){if(null===re||-1===Function.toString.call(re).indexOf("[native code]"))return re;if("function"!=typeof re)throw new TypeError("Super expression must either be null or a function");if(void 0!==de){if(de.has(re))return de.get(re);de.set(re,F)}function F(){return dt(re,arguments,mt(this).constructor)}return F.prototype=Object.create(re.prototype,{constructor:{value:F,enumerable:!1,writable:!0,configurable:!0}}),J(F,re)})(ne)}function Te(ne){if(void 0===ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne}var fe=function(){for(var ne=arguments[0],de=1,re=arguments.length;de<re;de++)if(arguments[de])for(var A in arguments[de])ne[A]=arguments[de][A];return ne};function K(ne,de,re,A){var F=ne._nodes.get(de),Z=null;return F?Z="mixed"===A?F.out&&F.out[re]||F.undirected&&F.undirected[re]:"directed"===A?F.out&&F.out[re]:F.undirected&&F.undirected[re]:Z}function V(ne){return null!==ne&&"object"===nt(ne)&&"function"==typeof ne.addUndirectedEdgeWithKey&&"function"==typeof ne.dropNode}function L(ne){return"object"===nt(ne)&&null!==ne&&ne.constructor===Object}function ie(ne){var de;for(de in ne)return!1;return!0}function $(ne,de,re){Object.defineProperty(ne,de,{enumerable:!1,configurable:!1,writable:!0,value:re})}function v(ne,de,re){var A={enumerable:!0,configurable:!0};"function"==typeof re?A.get=re:(A.value=re,A.writable=!1),Object.defineProperty(ne,de,A)}function S(ne){return!(!L(ne)||ne.attributes&&!Array.isArray(ne.attributes))}"function"==typeof Object.assign&&(fe=Object.assign);var N,M={exports:{}},b="object"==typeof Reflect?Reflect:null,y=b&&"function"==typeof b.apply?b.apply:function(ne,de,re){return Function.prototype.apply.call(ne,de,re)};N=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(ne){return Object.getOwnPropertyNames(ne).concat(Object.getOwnPropertySymbols(ne))}:function(ne){return Object.getOwnPropertyNames(ne)};var E=Number.isNaN||function(ne){return ne!=ne};function x(){x.init.call(this)}M.exports=x,M.exports.once=function(ne,de){return new Promise(function(re,A){function F(we){ne.removeListener(de,Z),A(we)}function Z(){"function"==typeof ne.removeListener&&ne.removeListener("error",F),re([].slice.call(arguments))}var we;Q(ne,de,Z,{once:!0}),"error"!==de&&("function"==typeof(we=ne).on&&Q(we,"error",F,{once:!0}))})},x.EventEmitter=x,x.prototype._events=void 0,x.prototype._eventsCount=0,x.prototype._maxListeners=void 0;var j=10;function O(ne){if("function"!=typeof ne)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ne)}function q(ne){return void 0===ne._maxListeners?x.defaultMaxListeners:ne._maxListeners}function ce(ne,de,re,A){var F,Z,we;if(O(re),void 0===(Z=ne._events)?(Z=ne._events=Object.create(null),ne._eventsCount=0):(void 0!==Z.newListener&&(ne.emit("newListener",de,re.listener?re.listener:re),Z=ne._events),we=Z[de]),void 0===we)we=Z[de]=re,++ne._eventsCount;else if("function"==typeof we?we=Z[de]=A?[re,we]:[we,re]:A?we.unshift(re):we.push(re),(F=q(ne))>0&&we.length>F&&!we.warned){we.warned=!0;var et=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+String(de)+" listeners added. Use emitter.setMaxListeners() to increase limit");et.name="MaxListenersExceededWarning",et.emitter=ne,et.type=de,et.count=we.length,console&&console.warn&&console.warn(et)}return ne}function D(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function I(ne,de,re){var A={fired:!1,wrapFn:void 0,target:ne,type:de,listener:re},F=D.bind(A);return F.listener=re,A.wrapFn=F,F}function X(ne,de,re){var A=ne._events;if(void 0===A)return[];var F=A[de];return void 0===F?[]:"function"==typeof F?re?[F.listener||F]:[F]:re?function(Z){for(var we=new Array(Z.length),Pe=0;Pe<we.length;++Pe)we[Pe]=Z[Pe].listener||Z[Pe];return we}(F):z(F,F.length)}function w(ne){var de=this._events;if(void 0!==de){var re=de[ne];if("function"==typeof re)return 1;if(void 0!==re)return re.length}return 0}function z(ne,de){for(var re=new Array(de),A=0;A<de;++A)re[A]=ne[A];return re}function Q(ne,de,re,A){if("function"==typeof ne.on)A.once?ne.once(de,re):ne.on(de,re);else{if("function"!=typeof ne.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ne);ne.addEventListener(de,function F(Z){A.once&&ne.removeEventListener(de,F),re(Z)})}}function se(ne){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:ne}),this.done=!1}Object.defineProperty(x,"defaultMaxListeners",{enumerable:!0,get:function(){return j},set:function(ne){if("number"!=typeof ne||ne<0||E(ne))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ne+".");j=ne}}),x.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},x.prototype.setMaxListeners=function(ne){if("number"!=typeof ne||ne<0||E(ne))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ne+".");return this._maxListeners=ne,this},x.prototype.getMaxListeners=function(){return q(this)},x.prototype.emit=function(ne){for(var de=[],re=1;re<arguments.length;re++)de.push(arguments[re]);var A="error"===ne,F=this._events;if(void 0!==F)A=A&&void 0===F.error;else if(!A)return!1;if(A){var Z;if(de.length>0&&(Z=de[0]),Z instanceof Error)throw Z;var we=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw we.context=Z,we}var Pe=F[ne];if(void 0===Pe)return!1;if("function"==typeof Pe)y(Pe,this,de);else{var et=Pe.length,Dt=z(Pe,et);for(re=0;re<et;++re)y(Dt[re],this,de)}return!0},x.prototype.on=x.prototype.addListener=function(ne,de){return ce(this,ne,de,!1)},x.prototype.prependListener=function(ne,de){return ce(this,ne,de,!0)},x.prototype.once=function(ne,de){return O(de),this.on(ne,I(this,ne,de)),this},x.prototype.prependOnceListener=function(ne,de){return O(de),this.prependListener(ne,I(this,ne,de)),this},x.prototype.off=x.prototype.removeListener=function(ne,de){var re,A,F,Z,we;if(O(de),void 0===(A=this._events))return this;if(void 0===(re=A[ne]))return this;if(re===de||re.listener===de)0==--this._eventsCount?this._events=Object.create(null):(delete A[ne],A.removeListener&&this.emit("removeListener",ne,re.listener||de));else if("function"!=typeof re){for(F=-1,Z=re.length-1;Z>=0;Z--)if(re[Z]===de||re[Z].listener===de){we=re[Z].listener,F=Z;break}if(F<0)return this;0===F?re.shift():function(Pe,et){for(;et+1<Pe.length;et++)Pe[et]=Pe[et+1];Pe.pop()}(re,F),1===re.length&&(A[ne]=re[0]),void 0!==A.removeListener&&this.emit("removeListener",ne,we||de)}return this},x.prototype.removeAllListeners=function(ne){var de,re,A;if(void 0===(re=this._events))return this;if(void 0===re.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==re[ne]&&(0==--this._eventsCount?this._events=Object.create(null):delete re[ne]),this;if(0===arguments.length){var F,Z=Object.keys(re);for(A=0;A<Z.length;++A)"removeListener"!==(F=Z[A])&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(de=re[ne]))this.removeListener(ne,de);else if(void 0!==de)for(A=de.length-1;A>=0;A--)this.removeListener(ne,de[A]);return this},x.prototype.listeners=function(ne){return X(this,ne,!0)},x.prototype.rawListeners=function(ne){return X(this,ne,!1)},x.listenerCount=function(ne,de){return"function"==typeof ne.listenerCount?ne.listenerCount(de):w.call(ne,de)},x.prototype.listenerCount=w,x.prototype.eventNames=function(){return this._eventsCount>0?N(this._events):[]},se.prototype.next=function(){if(this.done)return{done:!0};var ne=this._next();return ne.done&&(this.done=!0),ne},"undefined"!=typeof Symbol&&(se.prototype[Symbol.iterator]=function(){return this}),se.of=function(){var ne=arguments,de=ne.length,re=0;return new se(function(){return re>=de?{done:!0}:{done:!1,value:ne[re++]}})},se.empty=function(){var ne=new se(null);return ne.done=!0,ne},se.is=function(ne){return ne instanceof se||"object"==typeof ne&&null!==ne&&"function"==typeof ne.next};var oe=se,ee=function(ne,de){for(var re,A=arguments.length>1?de:1/0,F=A!==1/0?new Array(A):[],Z=0;;){if(Z===A)return F;if((re=ne.next()).done)return Z!==de?F.slice(0,Z):F;F[Z++]=re.value}},Se=function(ne){function de(re,A){var F;return(F=ne.call(this)||this).name="GraphError",F.message=re||"",F.data=A||{},F}return tt(de,ne),de}(Y(Error)),pe=function(ne){function de(re,A){var F;return(F=ne.call(this,re,A)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Te(F),de.prototype.constructor),F}return tt(de,ne),de}(Se),te=function(ne){function de(re,A){var F;return(F=ne.call(this,re,A)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Te(F),de.prototype.constructor),F}return tt(de,ne),de}(Se),_e=function(ne){function de(re,A){var F;return(F=ne.call(this,re,A)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Te(F),de.prototype.constructor),F}return tt(de,ne),de}(Se);function De(ne,de){this.key=ne,this.attributes=de,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function He(ne,de){this.key=ne,this.attributes=de,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function rt(ne,de){this.key=ne,this.attributes=de,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Xe(ne,de,re,A,F,Z){this.key=de,this.attributes=Z,this.undirected=ne,this.source=A,this.target=F,this.generatedKey=re}function Je(ne,de,re,A,F,Z,we){var Pe,et,Dt="out",We="in";if(de&&(Dt=We="undirected"),ne.multi){if(void 0===(et=(Pe=Z[Dt])[F])&&(et=new Set,Pe[F]=et),et.add(re),A===F&&de)return;void 0===(Pe=we[We])[A]&&(Pe[A]=et)}else{if(Z[Dt][F]=re,A===F&&de)return;we[We][A]=re}}function Ke(ne,de,re){var A=ne.multi,F=re.source,Z=re.target,we=F.key,Pe=Z.key,et=F[de?"undirected":"out"],Dt=de?"undirected":"in";if(Pe in et)if(A){var We=et[Pe];1===We.size?(delete et[Pe],delete Z[Dt][we]):We.delete(re)}else delete et[Pe];A||delete Z[Dt][we]}He.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},rt.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var je=[{name:function(ne){return"get".concat(ne,"Attribute")},attacher:function(ne,de,re){ne.prototype[de]=function(A,F){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Pe=""+F;if(F=arguments[2],!(Z=K(this,we,Pe,re)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Pe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes[F]}}},{name:function(ne){return"get".concat(ne,"Attributes")},attacher:function(ne,de,re){ne.prototype[de]=function(A){var F;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Z=""+A,we=""+arguments[1];if(!(F=K(this,Z,we,re)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Z,'" - "').concat(we,'").'))}else if(!(F=this._edges.get(A=""+A)))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&F.undirected!==("undirected"===re))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return F.attributes}}},{name:function(ne){return"has".concat(ne,"Attribute")},attacher:function(ne,de,re){ne.prototype[de]=function(A,F){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Pe=""+F;if(F=arguments[2],!(Z=K(this,we,Pe,re)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Pe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes.hasOwnProperty(F)}}},{name:function(ne){return"set".concat(ne,"Attribute")},attacher:function(ne,de,re){ne.prototype[de]=function(A,F,Z){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Pe=""+A,et=""+F;if(F=arguments[2],Z=arguments[3],!(we=K(this,Pe,et,re)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Pe,'" - "').concat(et,'").'))}else if(!(we=this._edges.get(A=""+A)))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return we.attributes[F]=Z,this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:F}),this}}},{name:function(ne){return"update".concat(ne,"Attribute")},attacher:function(ne,de,re){ne.prototype[de]=function(A,F,Z){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Pe=""+A,et=""+F;if(F=arguments[2],Z=arguments[3],!(we=K(this,Pe,et,re)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Pe,'" - "').concat(et,'").'))}else if(!(we=this._edges.get(A=""+A)))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" edge in the graph.'));if("function"!=typeof Z)throw new pe("Graph.".concat(de,": updater should be a function."));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return we.attributes[F]=Z(we.attributes[F]),this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:F}),this}}},{name:function(ne){return"remove".concat(ne,"Attribute")},attacher:function(ne,de,re){ne.prototype[de]=function(A,F){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Pe=""+F;if(F=arguments[2],!(Z=K(this,we,Pe,re)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Pe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return delete Z.attributes[F],this.emit("edgeAttributesUpdated",{key:Z.key,type:"remove",attributes:Z.attributes,name:F}),this}}},{name:function(ne){return"replace".concat(ne,"Attributes")},attacher:function(ne,de,re){ne.prototype[de]=function(A,F){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Pe=""+F;if(F=arguments[2],!(Z=K(this,we,Pe,re)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Pe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" edge in the graph.'));if(!L(F))throw new pe("Graph.".concat(de,": provided attributes are not a plain object."));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes=F,this.emit("edgeAttributesUpdated",{key:Z.key,type:"replace",attributes:Z.attributes}),this}}},{name:function(ne){return"merge".concat(ne,"Attributes")},attacher:function(ne,de,re){ne.prototype[de]=function(A,F){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Pe=""+F;if(F=arguments[2],!(Z=K(this,we,Pe,re)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Pe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" edge in the graph.'));if(!L(F))throw new pe("Graph.".concat(de,": provided attributes are not a plain object."));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(de,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return fe(Z.attributes,F),this.emit("edgeAttributesUpdated",{key:Z.key,type:"merge",attributes:Z.attributes,data:F}),this}}}],Fe=oe,Ye=function(){var ne,de=arguments,re=-1;return new Fe(function A(){if(!ne){if(++re>=de.length)return{done:!0};ne=de[re]}var F=ne.next();return F.done?(ne=null,A()):F})},Ce=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Be(ne,de){for(var re in de)ne.push(de[re].key)}function $e(ne,de){for(var re in de)de[re].forEach(function(A){return ne.push(A.key)})}function Ne(ne,de,re){for(var A in ne)if(A!==re){var F=ne[A];de(F.key,F.attributes,F.source.key,F.target.key,F.source.attributes,F.target.attributes,F.undirected,F.generatedKey)}}function G(ne,de,re){for(var A in ne)A!==re&&ne[A].forEach(function(F){return de(F.key,F.attributes,F.source.key,F.target.key,F.source.attributes,F.target.attributes,F.undirected,F.generatedKey)})}function U(ne,de,re){for(var A in ne)if(A!==re){var F=ne[A];if(de(F.key,F.attributes,F.source.key,F.target.key,F.source.attributes,F.target.attributes,F.undirected,F.generatedKey))return!0}return!1}function he(ne,de,re){var A,F,Z,we,Pe;for(var et in ne)if(et!==re)for(A=ne[et].values();!0!==(F=A.next()).done;)if(we=(Z=F.value).source,de(Z.key,Z.attributes,we.key,(Pe=Z.target).key,we.attributes,Pe.attributes,Z.undirected,Z.generatedKey))return!0;return!1}function ue(ne,de){var re=Object.keys(ne),A=re.length,F=null,Z=0;return new oe(function we(){var Pe;if(F){var et=F.next();if(et.done)return F=null,Z++,we();Pe=et.value}else{if(Z>=A)return{done:!0};var Dt=re[Z];if(Dt===de)return Z++,we();if((Pe=ne[Dt])instanceof Set)return F=Pe.values(),we();Z++}return{done:!1,value:[Pe.key,Pe.attributes,Pe.source.key,Pe.target.key,Pe.source.attributes,Pe.target.attributes]}})}function ke(ne,de,re){var A=de[re];A&&ne.push(A.key)}function gt(ne,de,re){var A=de[re];A&&A.forEach(function(F){return ne.push(F.key)})}function ft(ne,de,re){var A=ne[de];if(A){var F=A.source,Z=A.target;re(A.key,A.attributes,F.key,Z.key,F.attributes,Z.attributes,A.undirected,A.generatedKey)}}function ve(ne,de,re){var A=ne[de];A&&A.forEach(function(F){return re(F.key,F.attributes,F.source.key,F.target.key,F.source.attributes,F.target.attributes,F.undirected,F.generatedKey)})}function k(ne,de,re){var A=ne[de];if(A){var F=A.source,Z=A.target;return re(A.key,A.attributes,F.key,Z.key,F.attributes,Z.attributes,A.undirected,A.generatedKey)}}function R(ne,de,re){var A=ne[de];if(A){for(var F,Z,we=A.values();!0!==(F=we.next()).done;)if(re((Z=F.value).key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes,Z.undirected,Z.generatedKey))return!0;return!1}}function B(ne,de){var re=ne[de];if(re instanceof Set){var A=re.values();return new oe(function(){var F=A.next();if(F.done)return F;var Z=F.value;return{done:!1,value:[Z.key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes]}})}return oe.of([re.key,re.attributes,re.source.key,re.target.key,re.source.attributes,re.target.attributes])}function Oe(ne,de){if(0===ne.size)return[];if("mixed"===de||de===ne.type)return"function"==typeof Array.from?Array.from(ne._edges.keys()):ee(ne._edges.keys(),ne._edges.size);for(var re,A,Z=new Array("undirected"===de?ne.undirectedSize:ne.directedSize),we="undirected"===de,Pe=ne._edges.values(),et=0;!0!==(re=Pe.next()).done;)(A=re.value).undirected===we&&(Z[et++]=A.key);return Z}function Qe(ne,de,re){if(0!==ne.size)for(var A,F,Z="mixed"!==de&&de!==ne.type,we="undirected"===de,Pe=ne._edges.values();!0!==(A=Pe.next()).done;)if(F=A.value,!Z||F.undirected===we){var zt=F.source,Et=F.target;re(F.key,F.attributes,zt.key,Et.key,zt.attributes,Et.attributes,F.undirected,F.generatedKey)}}function bt(ne,de,re){if(0!==ne.size)for(var A,F,Z="mixed"!==de&&de!==ne.type,we="undirected"===de,Pe=ne._edges.values();!0!==(A=Pe.next()).done;)if(F=A.value,!Z||F.undirected===we){var zt=F.source,Et=F.target;if(re(F.key,F.attributes,zt.key,Et.key,zt.attributes,Et.attributes,F.undirected,F.generatedKey))break}}function It(ne,de){if(0===ne.size)return oe.empty();var re="mixed"!==de&&de!==ne.type,A="undirected"===de,F=ne._edges.values();return new oe(function(){for(var Z,we;;){if((Z=F.next()).done)return Z;if(we=Z.value,!re||we.undirected===A)break}return{value:[we.key,we.attributes,we.source.key,we.target.key,we.source.attributes,we.target.attributes],done:!1}})}function In(ne,de,re,A){var F=[],Z=ne?$e:Be;return"undirected"!==de&&("out"!==re&&Z(F,A.in),"in"!==re&&Z(F,A.out),!re&&A.directedSelfLoops>0&&F.splice(F.lastIndexOf(A.key),1)),"directed"!==de&&Z(F,A.undirected),F}function Ln(ne,de,re,A,F){var Z=ne?G:Ne;"undirected"!==de&&("out"!==re&&Z(A.in,F),"in"!==re&&Z(A.out,F,re?null:A.key)),"directed"!==de&&Z(A.undirected,F)}function Wn(ne,de,re,A,F){var Z=ne?he:U;"undirected"!==de&&("out"!==re&&Z(A.in,F)||"in"!==re&&Z(A.out,F,re?null:A.key))||"directed"===de||Z(A.undirected,F)}function Ei(ne,de,re){var A=oe.empty();return"undirected"!==ne&&("out"!==de&&void 0!==re.in&&(A=Ye(A,ue(re.in))),"in"!==de&&void 0!==re.out&&(A=Ye(A,ue(re.out,de?null:re.key)))),"directed"!==ne&&void 0!==re.undirected&&(A=Ye(A,ue(re.undirected))),A}function mi(ne,de,re,A,F){var Z=de?gt:ke,we=[];return"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&Z(we,A.in,F),void 0!==A.out&&"in"!==re&&Z(we,A.out,F),!re&&A.directedSelfLoops>0&&we.splice(we.lastIndexOf(A.key),1)),"directed"!==ne&&void 0!==A.undirected&&Z(we,A.undirected,F),we}function Gr(ne,de,re,A,F,Z){var we=de?ve:ft;"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&we(A.in,F,Z),A.key!==F&&void 0!==A.out&&"in"!==re&&we(A.out,F,Z)),"directed"!==ne&&void 0!==A.undirected&&we(A.undirected,F,Z)}function Ns(ne,de,re,A,F,Z){var we=de?R:k;"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&we(A.in,F,Z)||A.key!==F&&void 0!==A.out&&"in"!==re&&we(A.out,F,Z,re?null:A.key))||"directed"===ne||void 0===A.undirected||we(A.undirected,F,Z)}function us(ne,de,re,A){var F=oe.empty();return"undirected"!==ne&&(void 0!==re.in&&"out"!==de&&A in re.in&&(F=Ye(F,B(re.in,A))),void 0!==re.out&&"in"!==de&&A in re.out&&(F=Ye(F,B(re.out,A)))),"directed"!==ne&&void 0!==re.undirected&&A in re.undirected&&(F=Ye(F,B(re.undirected,A))),F}var Ps=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function $r(ne,de){if(void 0!==de)for(var re in de)ne.add(re)}function Wa(ne,de,re){if("mixed"!==ne){if("undirected"===ne)return Object.keys(re.undirected);if("string"==typeof de)return Object.keys(re[de])}var A=new Set;return"undirected"!==ne&&("out"!==de&&$r(A,re.in),"in"!==de&&$r(A,re.out)),"directed"!==ne&&$r(A,re.undirected),ee(A.values(),A.size)}function Cl(ne,de,re){for(var A in de){var F=de[A];F instanceof Set&&(F=F.values().next().value);var Z=F.source,Pe=Z===ne?F.target:Z;re(Pe.key,Pe.attributes)}}function da(ne,de,re,A){for(var F in re){var Z=re[F];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===de?Z.target:we;ne.has(et.key)||(ne.add(et.key),A(et.key,et.attributes))}}function _s(ne,de,re){for(var A in de){var F=de[A];F instanceof Set&&(F=F.values().next().value);var Z=F.source,Pe=Z===ne?F.target:Z;if(re(Pe.key,Pe.attributes))return!0}return!1}function Jt(ne,de,re,A){for(var F in re){var Z=re[F];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===de?Z.target:we;if(!ne.has(et.key)&&(ne.add(et.key),A(et.key,et.attributes)))return!0}return!1}function qa(ne,de){var re=Object.keys(de),A=re.length,F=0;return new oe(function(){if(F>=A)return{done:!0};var Z=de[re[F++]];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===ne?Z.target:we;return{done:!1,value:[et.key,et.attributes]}})}function it(ne,de,re){var A=Object.keys(re),F=A.length,Z=0;return new oe(function we(){if(Z>=F)return{done:!0};var Pe=re[A[Z++]];Pe instanceof Set&&(Pe=Pe.values().next().value);var et=Pe.source,We=et===de?Pe.target:et;return ne.has(We.key)?we():(ne.add(We.key),{done:!1,value:[We.key,We.attributes]})})}function ot(ne,de,re,A,F){var Z=ne._nodes.get(A);if("undirected"!==de){if("out"!==re&&void 0!==Z.in)for(var we in Z.in)if(we===F)return!0;if("in"!==re&&void 0!==Z.out)for(var Pe in Z.out)if(Pe===F)return!0}if("directed"!==de&&void 0!==Z.undirected)for(var et in Z.undirected)if(et===F)return!0;return!1}function Le(ne,de,re){for(var A,F,Z,we,Pe,et,Dt,We=de._nodes.values(),zt=de.type;!0!==(A=We.next()).done;){if(F=A.value,"undirected"!==zt)for(Z in we=F.out)if(et=(Pe=we[Z]).target,Dt=re(F.key,et.key,F.attributes,et.attributes,Pe.key,Pe.attributes,Pe.undirected,Pe.generatedKey),ne&&Dt)return;if("directed"!==zt)for(Z in we=F.undirected)if((et=(Pe=we[Z]).target).key!==Z&&(et=Pe.source),Dt=re(F.key,et.key,F.attributes,et.attributes,Pe.key,Pe.attributes,Pe.undirected,Pe.generatedKey),ne&&Dt)return}}function ct(ne,de,re){for(var A,F,Z,we,Pe,et,Dt,We,zt,Et=de._nodes.values(),mn=de.type;!0!==(A=Et.next()).done;){if(F=A.value,"undirected"!==mn)for(Z in et=F.out)for(we=et[Z].values();!0!==(Pe=we.next()).done;)if(We=(Dt=Pe.value).target,zt=re(F.key,We.key,F.attributes,We.attributes,Dt.key,Dt.attributes,Dt.undirected,Dt.generatedKey),ne&&zt)return;if("directed"!==mn)for(Z in et=F.undirected)for(we=et[Z].values();!0!==(Pe=we.next()).done;)if((We=(Dt=Pe.value).target).key!==Z&&(We=Dt.source),zt=re(F.key,We.key,F.attributes,We.attributes,Dt.key,Dt.attributes,Dt.undirected,Dt.generatedKey),ne&&zt)return}}function Ze(ne,de){var re={key:ne};return ie(de.attributes)||(re.attributes=fe({},de.attributes)),re}function vt(ne,de){var re={source:de.source.key,target:de.target.key};return de.generatedKey||(re.key=ne),ie(de.attributes)||(re.attributes=fe({},de.attributes)),de.undirected&&(re.undirected=!0),re}function xt(ne){return L(ne)?"key"in ne?!("attributes"in ne)||L(ne.attributes)&&null!==ne.attributes?null:"invalid-attributes":"no-key":"not-object"}function Tt(ne){return L(ne)?"source"in ne?"target"in ne?!("attributes"in ne)||L(ne.attributes)&&null!==ne.attributes?"undirected"in ne&&"boolean"!=typeof ne.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var qt=new Set(["directed","undirected","mixed"]),Un=new Set(["domain","_events","_eventsCount","_maxListeners"]),ri={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function Rn(ne,de,re){var A=new ne.NodeDataClass(de,re);return ne._nodes.set(de,A),ne.emit("nodeAdded",{key:de,attributes:re}),A}function gn(ne,de,re,A,F,Z,we,Pe){if(!A&&"undirected"===ne.type)throw new _e("Graph.".concat(de,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(A&&"directed"===ne.type)throw new _e("Graph.".concat(de,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Pe&&!L(Pe))throw new pe("Graph.".concat(de,': invalid attributes. Expecting an object but got "').concat(Pe,'"'));if(Z=""+Z,we=""+we,Pe=Pe||{},!ne.allowSelfLoops&&Z===we)throw new _e("Graph.".concat(de,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var et=ne._nodes.get(Z),Dt=ne._nodes.get(we);if(!et)throw new te("Graph.".concat(de,': source node "').concat(Z,'" not found.'));if(!Dt)throw new te("Graph.".concat(de,': target node "').concat(we,'" not found.'));var We={key:null,undirected:A,source:Z,target:we,attributes:Pe};if(re&&(F=ne._edgeKeyGenerator(We)),ne._edges.has(F=""+F))throw new _e("Graph.".concat(de,': the "').concat(F,'" edge already exists in the graph.'));if(!ne.multi&&(A?void 0!==et.undirected[we]:void 0!==et.out[we]))throw new _e("Graph.".concat(de,': an edge linking "').concat(Z,'" to "').concat(we,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var zt=new Xe(A,F,re,et,Dt,Pe);return ne._edges.set(F,zt),Z===we?A?(et.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(et.directedSelfLoops++,ne._directedSelfLoopCount++):A?(et.undirectedDegree++,Dt.undirectedDegree++):(et.outDegree++,Dt.inDegree++),Je(ne,A,zt,Z,we,et,Dt),A?ne._undirectedSize++:ne._directedSize++,We.key=F,ne.emit("edgeAdded",We),F}function Gn(ne,de,re,A,F,Z,we,Pe,et){if(!A&&"undirected"===ne.type)throw new _e("Graph.".concat(de,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(A&&"directed"===ne.type)throw new _e("Graph.".concat(de,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Pe)if(et){if("function"!=typeof Pe)throw new pe("Graph.".concat(de,': invalid updater function. Expecting a function but got "').concat(Pe,'"'))}else if(!L(Pe))throw new pe("Graph.".concat(de,': invalid attributes. Expecting an object but got "').concat(Pe,'"'));var Dt;if(Z=""+Z,we=""+we,et&&(Dt=Pe,Pe=void 0),!ne.allowSelfLoops&&Z===we)throw new _e("Graph.".concat(de,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var We,zt,Et=ne._nodes.get(Z),mn=ne._nodes.get(we);if(!re&&(We=ne._edges.get(F))){if(We.source.key!==Z||We.target.key!==we||A&&(We.source.key!==we||We.target.key!==Z))throw new _e("Graph.".concat(de,': inconsistency detected when attempting to merge the "').concat(F,'" edge with "').concat(Z,'" source & "').concat(we,'" target vs. ("').concat(We.source.key,'", "').concat(We.target.key,'").'));zt=We}if(zt||ne.multi||!Et||(zt=A?Et.undirected[we]:Et.out[we]),zt)return(et?Dt:Pe)?(et?(zt.attributes=Dt(zt.attributes),ne.emit("edgeAttributesUpdated",{type:"replace",key:zt.key,attributes:zt.attributes})):(fe(zt.attributes,Pe),ne.emit("edgeAttributesUpdated",{type:"merge",key:zt.key,attributes:zt.attributes,data:Pe})),zt.key):zt.key;Pe=Pe||{},et&&Dt&&(Pe=Dt(Pe));var qr={key:null,undirected:A,source:Z,target:we,attributes:Pe};if(re&&(F=ne._edgeKeyGenerator(qr)),ne._edges.has(F=""+F))throw new _e("Graph.".concat(de,': the "').concat(F,'" edge already exists in the graph.'));return Et||(Et=Rn(ne,Z,{}),Z===we&&(mn=Et)),mn||(mn=Rn(ne,we,{})),We=new Xe(A,F,re,Et,mn,Pe),ne._edges.set(F,We),Z===we?A?(Et.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(Et.directedSelfLoops++,ne._directedSelfLoopCount++):A?(Et.undirectedDegree++,mn.undirectedDegree++):(Et.outDegree++,mn.inDegree++),Je(ne,A,We,Z,we,Et,mn),A?ne._undirectedSize++:ne._directedSize++,qr.key=F,ne.emit("edgeAdded",qr),F}var ne,En=function(ne){function de(A){var F;if(F=ne.call(this)||this,(A=fe({},ri,A)).edgeKeyGenerator&&"function"!=typeof A.edgeKeyGenerator)throw new pe("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(A.edgeKeyGenerator,'".'));if("boolean"!=typeof A.multi)throw new pe("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(A.multi,'".'));if(!qt.has(A.type))throw new pe('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(A.type,'".'));if("boolean"!=typeof A.allowSelfLoops)throw new pe("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(A.allowSelfLoops,'".'));var Z,we="mixed"===A.type?De:"directed"===A.type?He:rt;return $(Te(F),"NodeDataClass",we),$(Te(F),"_attributes",{}),$(Te(F),"_nodes",new Map),$(Te(F),"_edges",new Map),$(Te(F),"_directedSize",0),$(Te(F),"_undirectedSize",0),$(Te(F),"_directedSelfLoopCount",0),$(Te(F),"_undirectedSelfLoopCount",0),$(Te(F),"_edgeKeyGenerator",A.edgeKeyGenerator||(Z=0,function(){return Z++})),$(Te(F),"_options",A),Un.forEach(function(Pe){return $(Te(F),Pe,F[Pe])}),v(Te(F),"order",function(){return F._nodes.size}),v(Te(F),"size",function(){return F._edges.size}),v(Te(F),"directedSize",function(){return F._directedSize}),v(Te(F),"undirectedSize",function(){return F._undirectedSize}),v(Te(F),"selfLoopCount",function(){return F._directedSelfLoopCount+F._undirectedSelfLoopCount}),v(Te(F),"directedSelfLoopCount",function(){return F._directedSelfLoopCount}),v(Te(F),"undirectedSelfLoopCount",function(){return F._undirectedSelfLoopCount}),v(Te(F),"multi",F._options.multi),v(Te(F),"type",F._options.type),v(Te(F),"allowSelfLoops",F._options.allowSelfLoops),v(Te(F),"implementation",function(){return"graphology"}),F}tt(de,ne);var re=de.prototype;return re.hasNode=function(A){return this._nodes.has(""+A)},re.hasDirectedEdge=function(A,F){if("undirected"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+A);return!!we&&!we.undirected}if(2===arguments.length){F=""+F;var Pe=this._nodes.get(A=""+A);if(!Pe)return!1;var et=Pe.out[F];return!(!et||this.multi&&!et.size)}throw new pe("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasUndirectedEdge=function(A,F){if("directed"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+A);return!!we&&we.undirected}if(2===arguments.length){F=""+F;var Pe=this._nodes.get(A=""+A);if(!Pe)return!1;var et=Pe.undirected[F];return!(!et||this.multi&&!et.size)}throw new pe("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasEdge=function(A,F){if(1===arguments.length)return this._edges.has(""+A);if(2===arguments.length){F=""+F;var we=this._nodes.get(A=""+A);if(!we)return!1;var Pe=void 0!==we.out&&we.out[F];return Pe||(Pe=void 0!==we.undirected&&we.undirected[F]),!(!Pe||this.multi&&!Pe.size)}throw new pe("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.directedEdge=function(A,F){if("undirected"!==this.type){if(A=""+A,F=""+F,this.multi)throw new _e("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var Z=this._nodes.get(A);if(!Z)throw new te('Graph.directedEdge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(F))throw new te('Graph.directedEdge: could not find the "'.concat(F,'" target node in the graph.'));var we=Z.out&&Z.out[F]||void 0;return we?we.key:void 0}},re.undirectedEdge=function(A,F){if("directed"!==this.type){if(A=""+A,F=""+F,this.multi)throw new _e("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var Z=this._nodes.get(A);if(!Z)throw new te('Graph.undirectedEdge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(F))throw new te('Graph.undirectedEdge: could not find the "'.concat(F,'" target node in the graph.'));var we=Z.undirected&&Z.undirected[F]||void 0;return we?we.key:void 0}},re.edge=function(A,F){if(this.multi)throw new _e("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");F=""+F;var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.edge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(F))throw new te('Graph.edge: could not find the "'.concat(F,'" target node in the graph.'));var we=Z.out&&Z.out[F]||Z.undirected&&Z.undirected[F]||void 0;if(we)return we.key},re.inDegree=function(A){var F=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof F)throw new pe('Graph.inDegree: Expecting a boolean but got "'.concat(F,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.inDegree: could not find the "'.concat(A,'" node in the graph.'));return"undirected"===this.type?0:Z.inDegree+(F?Z.directedSelfLoops:0)},re.outDegree=function(A){var F=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof F)throw new pe('Graph.outDegree: Expecting a boolean but got "'.concat(F,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.outDegree: could not find the "'.concat(A,'" node in the graph.'));return"undirected"===this.type?0:Z.outDegree+(F?Z.directedSelfLoops:0)},re.directedDegree=function(A){var F=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof F)throw new pe('Graph.directedDegree: Expecting a boolean but got "'.concat(F,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.directedDegree: could not find the "'.concat(A,'" node in the graph.'));if("undirected"===this.type)return 0;var we=F?Z.directedSelfLoops:0;return Z.inDegree+we+(Z.outDegree+we)},re.undirectedDegree=function(A){var F=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof F)throw new pe('Graph.undirectedDegree: Expecting a boolean but got "'.concat(F,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.undirectedDegree: could not find the "'.concat(A,'" node in the graph.'));return"directed"===this.type?0:Z.undirectedDegree+2*(F?Z.undirectedSelfLoops:0)},re.degree=function(A){var F=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof F)throw new pe('Graph.degree: Expecting a boolean but got "'.concat(F,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.degree: could not find the "'.concat(A,'" node in the graph.'));var we=0,Pe=0;return"directed"!==this.type&&(F&&(Pe=Z.undirectedSelfLoops),we+=Z.undirectedDegree+2*Pe),"undirected"!==this.type&&(F&&(Pe=Z.directedSelfLoops),we+=Z.inDegree+Z.outDegree+2*Pe),we},re.source=function(A){var F=this._edges.get(A=""+A);if(!F)throw new te('Graph.source: could not find the "'.concat(A,'" edge in the graph.'));return F.source.key},re.target=function(A){var F=this._edges.get(A=""+A);if(!F)throw new te('Graph.target: could not find the "'.concat(A,'" edge in the graph.'));return F.target.key},re.extremities=function(A){var F=this._edges.get(A=""+A);if(!F)throw new te('Graph.extremities: could not find the "'.concat(A,'" edge in the graph.'));return[F.source.key,F.target.key]},re.opposite=function(A,F){A=""+A;var Z=this._edges.get(F=""+F);if(!Z)throw new te('Graph.opposite: could not find the "'.concat(F,'" edge in the graph.'));var we=Z.source.key,Pe=Z.target.key;if(A!==we&&A!==Pe)throw new te('Graph.opposite: the "'.concat(A,'" node is not attached to the "').concat(F,'" edge (').concat(we,", ").concat(Pe,")."));return A===we?Pe:we},re.hasExtremity=function(A,F){F=""+F;var Z=this._edges.get(A=""+A);if(!Z)throw new te('Graph.hasExtremity: could not find the "'.concat(A,'" edge in the graph.'));return Z.source.key===F||Z.target.key===F},re.isUndirected=function(A){var F=this._edges.get(A=""+A);if(!F)throw new te('Graph.isUndirected: could not find the "'.concat(A,'" edge in the graph.'));return F.undirected},re.isDirected=function(A){var F=this._edges.get(A=""+A);if(!F)throw new te('Graph.isDirected: could not find the "'.concat(A,'" edge in the graph.'));return!F.undirected},re.isSelfLoop=function(A){var F=this._edges.get(A=""+A);if(!F)throw new te('Graph.isSelfLoop: could not find the "'.concat(A,'" edge in the graph.'));return F.source===F.target},re.hasGeneratedKey=function(A){var F=this._edges.get(A=""+A);if(!F)throw new te('Graph.hasGeneratedKey: could not find the "'.concat(A,'" edge in the graph.'));return F.generatedKey},re.addNode=function(A,F){return function(Z,we,Pe){if(Pe&&!L(Pe))throw new pe('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Pe,'"'));if(Pe=Pe||{},Z._nodes.has(we=""+we))throw new _e('Graph.addNode: the "'.concat(we,'" node already exist in the graph.'));var et=new Z.NodeDataClass(we,Pe);return Z._nodes.set(we,et),Z.emit("nodeAdded",{key:we,attributes:Pe}),et}(this,A,F).key},re.mergeNode=function(A,F){if(F&&!L(F))throw new pe('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(F,'"'));F=F||{};var Z=this._nodes.get(A=""+A);return Z?(F&&(fe(Z.attributes,F),this.emit("nodeAttributesUpdated",{type:"merge",key:A,attributes:Z.attributes,data:F})),A):(Z=new this.NodeDataClass(A,F),this._nodes.set(A,Z),this.emit("nodeAdded",{key:A,attributes:F}),A)},re.updateNode=function(A,F){if(F&&"function"!=typeof F)throw new pe('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(F,'"'));var Z=this._nodes.get(A=""+A);if(Z)return F&&(Z.attributes=F(Z.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:A,attributes:Z.attributes})),A;var Pe=F?F({}):{};return Z=new this.NodeDataClass(A,Pe),this._nodes.set(A,Z),this.emit("nodeAdded",{key:A,attributes:Pe}),A},re.dropNode=function(A){var F=this,Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.dropNode: could not find the "'.concat(A,'" node in the graph.'));this.forEachEdge(A,function(we){F.dropEdge(we)}),this._nodes.delete(A),this.emit("nodeDropped",{key:A,attributes:Z.attributes})},re.dropEdge=function(A){var F;if(arguments.length>1){var Z=""+arguments[0],we=""+arguments[1];if(!(F=K(this,Z,we,this.type)))throw new te('Graph.dropEdge: could not find the "'.concat(Z,'" -> "').concat(we,'" edge in the graph.'))}else if(!(F=this._edges.get(A=""+A)))throw new te('Graph.dropEdge: could not find the "'.concat(A,'" edge in the graph.'));this._edges.delete(F.key);var et=F.source,Dt=F.target,We=F.attributes,zt=F.undirected;return et===Dt?zt?(et.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(et.directedSelfLoops--,this._directedSelfLoopCount--):zt?(et.undirectedDegree--,Dt.undirectedDegree--):(et.outDegree--,Dt.inDegree--),Ke(this,zt,F),zt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:A,attributes:We,source:et.key,target:Dt.key,undirected:zt}),this},re.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},re.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},re.getAttribute=function(A){return this._attributes[A]},re.getAttributes=function(){return this._attributes},re.hasAttribute=function(A){return this._attributes.hasOwnProperty(A)},re.setAttribute=function(A,F){return this._attributes[A]=F,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:A}),this},re.updateAttribute=function(A,F){if("function"!=typeof F)throw new pe("Graph.updateAttribute: updater should be a function.");return this._attributes[A]=F(this._attributes[A]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:A}),this},re.removeAttribute=function(A){return delete this._attributes[A],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:A}),this},re.replaceAttributes=function(A){if(!L(A))throw new pe("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=A,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},re.mergeAttributes=function(A){if(!L(A))throw new pe("Graph.mergeAttributes: provided attributes are not a plain object.");return fe(this._attributes,A),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:A}),this},re.getNodeAttribute=function(A,F){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.getNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return Z.attributes[F]},re.getNodeAttributes=function(A){var F=this._nodes.get(A=""+A);if(!F)throw new te('Graph.getNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));return F.attributes},re.hasNodeAttribute=function(A,F){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return Z.attributes.hasOwnProperty(F)},re.setNodeAttribute=function(A,F,Z){var we=this._nodes.get(A=""+A);if(!we)throw new te('Graph.setNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));if(arguments.length<3)throw new pe("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return we.attributes[F]=Z,this.emit("nodeAttributesUpdated",{key:A,type:"set",attributes:we.attributes,name:F}),this},re.updateNodeAttribute=function(A,F,Z){var we=this._nodes.get(A=""+A);if(!we)throw new te('Graph.updateNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));if(arguments.length<3)throw new pe("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof Z)throw new pe("Graph.updateAttribute: updater should be a function.");var Pe=we.attributes,et=Z(Pe[F]);return Pe[F]=et,this.emit("nodeAttributesUpdated",{key:A,type:"set",attributes:we.attributes,name:F}),this},re.removeNodeAttribute=function(A,F){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return delete Z.attributes[F],this.emit("nodeAttributesUpdated",{key:A,type:"remove",attributes:Z.attributes,name:F}),this},re.replaceNodeAttributes=function(A,F){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.replaceNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));if(!L(F))throw new pe("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return Z.attributes=F,this.emit("nodeAttributesUpdated",{key:A,type:"replace",attributes:Z.attributes}),this},re.mergeNodeAttributes=function(A,F){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.mergeNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));if(!L(F))throw new pe("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return fe(Z.attributes,F),this.emit("nodeAttributesUpdated",{key:A,type:"merge",attributes:Z.attributes,data:F}),this},re.updateEachNodeAttributes=function(A,F){if("function"!=typeof A)throw new pe("Graph.updateEachNodeAttributes: expecting an updater function.");if(F&&!S(F))throw new pe("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Pe=this._nodes.values();!0!==(Z=Pe.next()).done;)(we=Z.value).attributes=A(we.key,we.attributes);this.emit("eachNodeAttributesUpdated",{hints:F||null})},re.updateEachEdgeAttributes=function(A,F){if("function"!=typeof A)throw new pe("Graph.updateEachEdgeAttributes: expecting an updater function.");if(F&&!S(F))throw new pe("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Pe=this._edges.values();!0!==(Z=Pe.next()).done;)(we=Z.value).attributes=A(we.key,we.attributes);this.emit("eachEdgeAttributesUpdated",{hints:F||null})},re.forEach=function(A){if("function"!=typeof A)throw new pe("Graph.forEach: expecting a callback.");this.multi?ct(!1,this,A):Le(!1,this,A)},re.forEachUntil=function(A){if("function"!=typeof A)throw new pe("Graph.forEach: expecting a callback.");this.multi?ct(!0,this,A):Le(!0,this,A)},re.adjacency=function(){return this.multi?(et=(A=this)._nodes.values(),Dt=A.type,We="outer",zt=null,new oe(function Et(){var mn;if("outer"===We)return!0===(mn=et.next()).done?mn:(F=mn.value,We="directed",Et());if("directed"===We)return"undirected"===Dt?(We="undirected",Et()):(we=F.out,Z=Object.keys(F.out),Pe=0,We="inner-directed",Et());if("undirected"===We){if("directed"===Dt)return We="outer",Et();we=F.undirected,Z=Object.keys(F.undirected),Pe=0,We="inner-undirected"}if(!zt&&Pe>=Z.length)return We="inner-undirected"===We?"outer":"undirected",Et();if(!zt){var ys=Z[Pe++];return zt=we[ys].values(),Et()}if((mn=zt.next()).done)return zt=null,Et();var qr=mn.value,Ks=qr.target;return"inner-undirected"===We&&Ks.key===F.key&&(Ks=qr.source),{done:!1,value:[F.key,Ks.key,F.attributes,Ks.attributes,qr.key,qr.attributes]}})):(Al=(Et=this)._nodes.values(),ao=Et.type,Pr="outer",new oe(function Fs(){var dc;if("outer"===Pr)return!0===(dc=Al.next()).done?dc:(mn=dc.value,Pr="directed",Fs());if("directed"===Pr)return"undirected"===ao?(Pr="undirected",Fs()):(qr=mn.out,ys=Object.keys(mn.out),Ks=0,Pr="inner-directed",Fs());if("undirected"===Pr){if("directed"===ao)return Pr="outer",Fs();qr=mn.undirected,ys=Object.keys(mn.undirected),Ks=0,Pr="inner-undirected"}if(Ks>=ys.length)return Pr="inner-undirected"===Pr?"outer":"undirected",Fs();var wn=ys[Ks++],lo=qr[wn],Tl=lo.target;return"inner-undirected"===Pr&&Tl.key===mn.key&&(Tl=lo.source),{done:!1,value:[mn.key,Tl.key,mn.attributes,Tl.attributes,lo.key,lo.attributes]}}));var Et,mn,ys,qr,Ks,Al,ao,Pr,A,F,Z,we,Pe,et,Dt,We,zt},re.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):ee(this._nodes.keys(),this._nodes.size)},re.forEachNode=function(A){if("function"!=typeof A)throw new pe("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(F,Z){A(Z,F.attributes)})},re.forEachNodeUntil=function(A){if("function"!=typeof A)throw new pe("Graph.forEachNode: expecting a callback.");for(var F,Z,we=this._nodes.values();!0!==(F=we.next())&&!A((Z=F.value).key,Z.attributes););},re.nodeEntries=function(){var A=this._nodes.values();return new oe(function(){var F=A.next();if(F.done)return F;var Z=F.value;return{value:[Z.key,Z.attributes],done:!1}})},re.exportNode=function(A){var F=this._nodes.get(A=""+A);if(!F)throw new te('Graph.exportNode: could not find the "'.concat(A,'" node in the graph.'));return Ze(A,F)},re.exportEdge=function(A){var F=this._edges.get(A=""+A);if(!F)throw new te('Graph.exportEdge: could not find the "'.concat(A,'" edge in the graph.'));return vt(A,F)},re.export=function(){var A=new Array(this._nodes.size),F=0;this._nodes.forEach(function(we,Pe){A[F++]=Ze(Pe,we)});var Z=new Array(this._edges.size);return F=0,this._edges.forEach(function(we,Pe){Z[F++]=vt(Pe,we)}),{attributes:this.getAttributes(),nodes:A,edges:Z,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},re.importNode=function(A){var F=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=xt(A);if(Z){if("not-object"===Z)throw new pe('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===Z)throw new pe("Graph.importNode: no key provided.");if("invalid-attributes"===Z)throw new pe("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var we=A.key,Pe=A.attributes,et=void 0===Pe?{}:Pe;return F?this.mergeNode(we,et):this.addNode(we,et),this},re.importEdge=function(A){var F=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=Tt(A);if(Z){if("not-object"===Z)throw new pe('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===Z)throw new pe("Graph.importEdge: missing souce.");if("no-target"===Z)throw new pe("Graph.importEdge: missing target.");if("invalid-attributes"===Z)throw new pe("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===Z)throw new pe("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var we=A.source,Pe=A.target,et=A.attributes,Dt=void 0===et?{}:et,We=A.undirected,zt=void 0!==We&&We;return"key"in A?(F?zt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:zt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,A.key,we,Pe,Dt):(F?zt?this.mergeUndirectedEdge:this.mergeDirectedEdge:zt?this.addUndirectedEdge:this.addDirectedEdge).call(this,we,Pe,Dt),this},re.import=function(A){var F,Z,we,Pe=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(V(A))return this.import(A.export(),Pe),this;if(!L(A))throw new pe("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(A.attributes){if(!L(A.attributes))throw new pe("Graph.import: invalid attributes. Expecting a plain object.");Pe?this.mergeAttributes(A.attributes):this.replaceAttributes(A.attributes)}if(A.nodes){if(we=A.nodes,!Array.isArray(we))throw new pe("Graph.import: invalid nodes. Expecting an array.");for(F=0,Z=we.length;F<Z;F++)this.importNode(we[F],Pe)}if(A.edges){if(we=A.edges,!Array.isArray(we))throw new pe("Graph.import: invalid edges. Expecting an array.");for(F=0,Z=we.length;F<Z;F++)this.importEdge(we[F],Pe)}return this},re.nullCopy=function(A){return new de(fe({},this._options,A))},re.emptyCopy=function(A){var F=this.nullCopy(A);return this._nodes.forEach(function(Z,we){var Pe=fe({},Z.attributes);Z=new F.NodeDataClass(we,Pe),F._nodes.set(we,Z)}),F},re.copy=function(){var A=new de(this._options);return A.import(this),A},re.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(A){return A.upgradeToMixed()}),this._options.type="mixed",v(this,"type",this._options.type),$(this,"NodeDataClass",De)),this},re.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,v(this,"multi",!0),(A=this)._nodes.forEach(function(F,Z){if(F.out)for(var we in F.out){var Pe=new Set;Pe.add(F.out[we]),F.out[we]=Pe,A._nodes.get(we).in[Z]=Pe}if(F.undirected)for(var et in F.undirected)if(!(et>Z)){var Dt=new Set;Dt.add(F.undirected[et]),F.undirected[et]=Dt,A._nodes.get(et).undirected[Z]=Dt}})),this;var A},re.clearIndex=function(){return this._nodes.forEach(function(A){void 0!==A.in&&(A.in={},A.out={}),void 0!==A.undirected&&(A.undirected={})}),this},re.toJSON=function(){return this.export()},re.toString=function(){return"[object Graph]"},re.inspect=function(){var A=this,F={};this._nodes.forEach(function(Dt,We){F[We]=Dt.attributes});var Z={},we={};this._edges.forEach(function(Dt,We){var zt=Dt.undirected?"--":"->",Et="",mn="(".concat(Dt.source.key,")").concat(zt,"(").concat(Dt.target.key,")");Dt.generatedKey?A.multi&&(void 0===we[mn]?we[mn]=0:we[mn]++,Et+="".concat(we[mn],". ")):Et+="[".concat(We,"]: "),Z[Et+=mn]=Dt.attributes});var Pe={};for(var et in this)this.hasOwnProperty(et)&&!Un.has(et)&&"function"!=typeof this[et]&&(Pe[et]=this[et]);return Pe.attributes=this._attributes,Pe.nodes=F,Pe.edges=Z,$(Pe,"constructor",this.constructor),Pe},de}(M.exports.EventEmitter);"undefined"!=typeof Symbol&&(En.prototype[Symbol.for("nodejs.util.inspect.custom")]=En.prototype.inspect),[{name:function(ne){return"".concat(ne,"Edge")},generateKey:!0},{name:function(ne){return"".concat(ne,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(ne){return"".concat(ne,"EdgeWithKey")}},{name:function(ne){return"".concat(ne,"DirectedEdgeWithKey")},type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(ne){["add","merge","update"].forEach(function(de){var re=ne.name(de),A="add"===de?gn:Gn;En.prototype[re]=ne.generateKey?function(F,Z,we){return A(this,re,!0,"undirected"===(ne.type||this.type),null,F,Z,we,"update"===de)}:function(F,Z,we,Pe){return A(this,re,!1,"undirected"===(ne.type||this.type),F,Z,we,Pe,"update"===de)}})}),"undefined"!=typeof Symbol&&(En.prototype[Symbol.iterator]=En.prototype.adjacency),ne=En,je.forEach(function(de){var re=de.name,A=de.attacher;A(ne,re("Edge"),"mixed"),A(ne,re("DirectedEdge"),"directed"),A(ne,re("UndirectedEdge"),"undirected")}),function(ne){Ce.forEach(function(de){var A,F,Z,we;Z=(A=de).type,we=A.direction,ne.prototype[F=A.name]=function(Pe,et){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(!arguments.length)return Oe(this,Z);if(1===arguments.length){var Dt=this._nodes.get(Pe=""+Pe);if(void 0===Dt)throw new te("Graph.".concat(F,': could not find the "').concat(Pe,'" node in the graph.'));return In(this.multi,"mixed"===Z?this.type:Z,we,Dt)}if(2===arguments.length){et=""+et;var We=this._nodes.get(Pe=""+Pe);if(!We)throw new te("Graph.".concat(F,':  could not find the "').concat(Pe,'" source node in the graph.'));if(!this._nodes.has(et))throw new te("Graph.".concat(F,':  could not find the "').concat(et,'" target node in the graph.'));return mi(Z,this.multi,we,We,et)}throw new pe("Graph.".concat(F,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(re,A){var F=A.name,Z=A.type,we=A.direction,Pe="forEach"+F[0].toUpperCase()+F.slice(1,-1);re.prototype[Pe]=function(et,Dt,We){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return Qe(this,Z,We=et);if(2===arguments.length){We=Dt;var zt=this._nodes.get(et=""+et);if(void 0===zt)throw new te("Graph.".concat(Pe,': could not find the "').concat(et,'" node in the graph.'));return Ln(this.multi,"mixed"===Z?this.type:Z,we,zt,We)}if(3===arguments.length){Dt=""+Dt;var Et=this._nodes.get(et=""+et);if(!Et)throw new te("Graph.".concat(Pe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Dt))throw new te("Graph.".concat(Pe,':  could not find the "').concat(Dt,'" target node in the graph.'));return Gr(Z,this.multi,we,Et,Dt,We)}throw new pe("Graph.".concat(Pe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,de),function(re,A){var F=A.name,Z=A.type,we=A.direction,Pe="forEach"+F[0].toUpperCase()+F.slice(1,-1)+"Until";re.prototype[Pe]=function(et,Dt,We){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return bt(this,Z,We=et);if(2===arguments.length){We=Dt;var zt=this._nodes.get(et=""+et);if(void 0===zt)throw new te("Graph.".concat(Pe,': could not find the "').concat(et,'" node in the graph.'));return Wn(this.multi,"mixed"===Z?this.type:Z,we,zt,We)}if(3===arguments.length){Dt=""+Dt;var Et=this._nodes.get(et=""+et);if(!Et)throw new te("Graph.".concat(Pe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Dt))throw new te("Graph.".concat(Pe,':  could not find the "').concat(Dt,'" target node in the graph.'));return Ns(Z,this.multi,we,Et,Dt,We)}throw new pe("Graph.".concat(Pe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,de),function(re,A){var Z=A.type,we=A.direction,Pe=A.name.slice(0,-1)+"Entries";re.prototype[Pe]=function(et,Dt){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return oe.empty();if(!arguments.length)return It(this,Z);if(1===arguments.length){var We=this._nodes.get(et=""+et);if(!We)throw new te("Graph.".concat(Pe,': could not find the "').concat(et,'" node in the graph.'));return Ei(Z,we,We)}if(2===arguments.length){Dt=""+Dt;var zt=this._nodes.get(et=""+et);if(!zt)throw new te("Graph.".concat(Pe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Dt))throw new te("Graph.".concat(Pe,':  could not find the "').concat(Dt,'" target node in the graph.'));return us(Z,we,zt,Dt)}throw new pe("Graph.".concat(Pe,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(ne,de)})}(En),function(ne){Ps.forEach(function(de){var A,F,Z,we;Z=(A=de).type,we=A.direction,ne.prototype[F=A.name]=function(Pe){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(2===arguments.length){var et=""+arguments[0],Dt=""+arguments[1];if(!this._nodes.has(et))throw new te("Graph.".concat(F,': could not find the "').concat(et,'" node in the graph.'));if(!this._nodes.has(Dt))throw new te("Graph.".concat(F,': could not find the "').concat(Dt,'" node in the graph.'));return ot(this,Z,we,et,Dt)}if(1===arguments.length){var We=this._nodes.get(Pe=""+Pe);if(void 0===We)throw new te("Graph.".concat(F,': could not find the "').concat(Pe,'" node in the graph.'));return Wa("mixed"===Z?this.type:Z,we,We)}throw new pe("Graph.".concat(F,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(ne,de){var re=de.name,A=de.type,F=de.direction,Z="forEach"+re[0].toUpperCase()+re.slice(1,-1);ne.prototype[Z]=function(we,Pe){if("mixed"===A||"mixed"===this.type||A===this.type){var et=this._nodes.get(we=""+we);if(void 0===et)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Dt,We,zt,Et){if("mixed"!==Dt){if("undirected"===Dt)return Cl(zt,zt.undirected,Et);if("string"==typeof We)return Cl(zt,zt[We],Et)}var mn=new Set;"undirected"!==Dt&&("out"!==We&&da(mn,zt,zt.in,Et),"in"!==We&&da(mn,zt,zt.out,Et)),"directed"!==Dt&&da(mn,zt,zt.undirected,Et)}("mixed"===A?this.type:A,F,et,Pe)}}}(ne,de),function(ne,de){var re=de.name,A=de.type,F=de.direction,Z="forEach"+re[0].toUpperCase()+re.slice(1,-1)+"Until";ne.prototype[Z]=function(we,Pe){if("mixed"===A||"mixed"===this.type||A===this.type){var et=this._nodes.get(we=""+we);if(void 0===et)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Dt,We,zt,Et){if("mixed"!==Dt){if("undirected"===Dt)return _s(zt,zt.undirected,Et);if("string"==typeof We)return _s(zt,zt[We],Et)}var mn=new Set;"undirected"!==Dt&&("out"!==We&&Jt(mn,zt,zt.in,Et)||"in"!==We&&Jt(mn,zt,zt.out,Et))||"directed"===Dt||Jt(mn,zt,zt.undirected,Et)}("mixed"===A?this.type:A,F,et,Pe)}}}(ne,de),function(ne,de){var A=de.type,F=de.direction,Z=de.name.slice(0,-1)+"Entries";ne.prototype[Z]=function(we){if("mixed"!==A&&"mixed"!==this.type&&A!==this.type)return oe.empty();var Pe=this._nodes.get(we=""+we);if(void 0===Pe)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));return function(et,Dt,We){if("mixed"!==et){if("undirected"===et)return qa(We,We.undirected);if("string"==typeof Dt)return qa(We,We[Dt])}var zt=oe.empty(),Et=new Set;return"undirected"!==et&&("out"!==Dt&&(zt=Ye(zt,it(Et,We,We.in))),"in"!==Dt&&(zt=Ye(zt,it(Et,We,We.out)))),"directed"!==et&&(zt=Ye(zt,it(Et,We,We.undirected))),zt}("mixed"===A?this.type:A,F,Pe)}}(ne,de)})}(En);var er=function(ne){function de(re){var A=fe({type:"directed"},re);if("multi"in A&&!1!==A.multi)throw new pe("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==A.type)throw new pe('DirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return tt(de,ne),de}(En),tr=function(ne){function de(re){var A=fe({type:"undirected"},re);if("multi"in A&&!1!==A.multi)throw new pe("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==A.type)throw new pe('UndirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return tt(de,ne),de}(En),Yn=function(ne){function de(re){var A=fe({multi:!0},re);if("multi"in A&&!0!==A.multi)throw new pe("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return ne.call(this,A)||this}return tt(de,ne),de}(En),Vi=function(ne){function de(re){var A=fe({type:"directed",multi:!0},re);if("multi"in A&&!0!==A.multi)throw new pe("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==A.type)throw new pe('MultiDirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return tt(de,ne),de}(En),ha=function(ne){function de(re){var A=fe({type:"undirected",multi:!0},re);if("multi"in A&&!0!==A.multi)throw new pe("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==A.type)throw new pe('MultiUndirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return tt(de,ne),de}(En);function Wr(ne){ne.from=function(de,re){var A=fe({},de.options,re),F=new ne(A);return F.import(de),F}}return Wr(En),Wr(er),Wr(tr),Wr(Yn),Wr(Vi),Wr(ha),En.Graph=En,En.DirectedGraph=er,En.UndirectedGraph=tr,En.MultiGraph=Yn,En.MultiDirectedGraph=Vi,En.MultiUndirectedGraph=ha,En.InvalidArgumentsGraphError=pe,En.NotFoundGraphError=te,En.UsageGraphError=_e,En}()},524:(kt,nt,tt)=>{var mt;!function(J,At,dt,Y){"use strict";var M,Te=["","webkit","Moz","MS","ms","o"],fe=At.createElement("div"),V=Math.round,L=Math.abs,ie=Date.now;function $(ye,Ae,Ue){return setTimeout(x(ye,Ue),Ae)}function v(ye,Ae,Ue){return!!Array.isArray(ye)&&(S(ye,Ue[Ae],Ue),!0)}function S(ye,Ae,Ue){var _t;if(ye)if(ye.forEach)ye.forEach(Ae,Ue);else if(ye.length!==Y)for(_t=0;_t<ye.length;)Ae.call(Ue,ye[_t],_t,ye),_t++;else for(_t in ye)ye.hasOwnProperty(_t)&&Ae.call(Ue,ye[_t],_t,ye)}function N(ye,Ae,Ue){var _t="DEPRECATED METHOD: "+Ae+"\n"+Ue+" AT \n";return function(){var jt=new Error("get-stack-trace"),Ht=jt&&jt.stack?jt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",si=J.console&&(J.console.warn||J.console.log);return si&&si.call(J.console,_t,Ht),ye.apply(this,arguments)}}M="function"!=typeof Object.assign?function(Ae){if(Ae===Y||null===Ae)throw new TypeError("Cannot convert undefined or null to object");for(var Ue=Object(Ae),_t=1;_t<arguments.length;_t++){var jt=arguments[_t];if(jt!==Y&&null!==jt)for(var Ht in jt)jt.hasOwnProperty(Ht)&&(Ue[Ht]=jt[Ht])}return Ue}:Object.assign;var b=N(function(Ae,Ue,_t){for(var jt=Object.keys(Ue),Ht=0;Ht<jt.length;)(!_t||_t&&Ae[jt[Ht]]===Y)&&(Ae[jt[Ht]]=Ue[jt[Ht]]),Ht++;return Ae},"extend","Use `assign`."),y=N(function(Ae,Ue){return b(Ae,Ue,!0)},"merge","Use `assign`.");function E(ye,Ae,Ue){var jt,_t=Ae.prototype;(jt=ye.prototype=Object.create(_t)).constructor=ye,jt._super=_t,Ue&&M(jt,Ue)}function x(ye,Ae){return function(){return ye.apply(Ae,arguments)}}function j(ye,Ae){return"function"==typeof ye?ye.apply(Ae&&Ae[0]||Y,Ae):ye}function O(ye,Ae){return ye===Y?Ae:ye}function q(ye,Ae,Ue){S(X(Ae),function(_t){ye.addEventListener(_t,Ue,!1)})}function ce(ye,Ae,Ue){S(X(Ae),function(_t){ye.removeEventListener(_t,Ue,!1)})}function D(ye,Ae){for(;ye;){if(ye==Ae)return!0;ye=ye.parentNode}return!1}function I(ye,Ae){return ye.indexOf(Ae)>-1}function X(ye){return ye.trim().split(/\s+/g)}function w(ye,Ae,Ue){if(ye.indexOf&&!Ue)return ye.indexOf(Ae);for(var _t=0;_t<ye.length;){if(Ue&&ye[_t][Ue]==Ae||!Ue&&ye[_t]===Ae)return _t;_t++}return-1}function z(ye){return Array.prototype.slice.call(ye,0)}function Q(ye,Ae,Ue){for(var _t=[],jt=[],Ht=0;Ht<ye.length;){var si=Ae?ye[Ht][Ae]:ye[Ht];w(jt,si)<0&&_t.push(ye[Ht]),jt[Ht]=si,Ht++}return Ue&&(_t=Ae?_t.sort(function(Kr,bs){return Kr[Ae]>bs[Ae]}):_t.sort()),_t}function se(ye,Ae){for(var Ue,_t,jt=Ae[0].toUpperCase()+Ae.slice(1),Ht=0;Ht<Te.length;){if((_t=(Ue=Te[Ht])?Ue+jt:Ae)in ye)return _t;Ht++}return Y}var oe=1;function Se(ye){var Ae=ye.ownerDocument||ye;return Ae.defaultView||Ae.parentWindow||J}var te="ontouchstart"in J,_e=se(J,"PointerEvent")!==Y,De=te&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),He="touch",Xe="mouse",gt=["x","y"],ft=["clientX","clientY"];function ve(ye,Ae){var Ue=this;this.manager=ye,this.callback=Ae,this.element=ye.element,this.target=ye.options.inputTarget,this.domHandler=function(_t){j(ye.options.enable,[ye])&&Ue.handler(_t)},this.init()}function R(ye,Ae,Ue){var _t=Ue.pointers.length,jt=Ue.changedPointers.length,Ht=1&Ae&&_t-jt==0,si=12&Ae&&_t-jt==0;Ue.isFirst=!!Ht,Ue.isFinal=!!si,Ht&&(ye.session={}),Ue.eventType=Ae,function(ye,Ae){var Ue=ye.session,_t=Ae.pointers,jt=_t.length;Ue.firstInput||(Ue.firstInput=bt(Ae)),jt>1&&!Ue.firstMultiple?Ue.firstMultiple=bt(Ae):1===jt&&(Ue.firstMultiple=!1);var Ht=Ue.firstInput,si=Ue.firstMultiple,Fr=si?si.center:Ht.center,Kr=Ae.center=It(_t);Ae.timeStamp=ie(),Ae.deltaTime=Ae.timeStamp-Ht.timeStamp,Ae.angle=Ei(Fr,Kr),Ae.distance=Wn(Fr,Kr),function(ye,Ae){var Ue=Ae.center,_t=ye.offsetDelta||{},jt=ye.prevDelta||{},Ht=ye.prevInput||{};(1===Ae.eventType||4===Ht.eventType)&&(jt=ye.prevDelta={x:Ht.deltaX||0,y:Ht.deltaY||0},_t=ye.offsetDelta={x:Ue.x,y:Ue.y}),Ae.deltaX=jt.x+(Ue.x-_t.x),Ae.deltaY=jt.y+(Ue.y-_t.y)}(Ue,Ae),Ae.offsetDirection=Ln(Ae.deltaX,Ae.deltaY);var bs=In(Ae.deltaTime,Ae.deltaX,Ae.deltaY);Ae.overallVelocityX=bs.x,Ae.overallVelocityY=bs.y,Ae.overallVelocity=L(bs.x)>L(bs.y)?bs.x:bs.y,Ae.scale=si?function(ye,Ae){return Wn(Ae[0],Ae[1],ft)/Wn(ye[0],ye[1],ft)}(si.pointers,_t):1,Ae.rotation=si?function(ye,Ae){return Ei(Ae[1],Ae[0],ft)+Ei(ye[1],ye[0],ft)}(si.pointers,_t):0,Ae.maxPointers=Ue.prevInput?Ae.pointers.length>Ue.prevInput.maxPointers?Ae.pointers.length:Ue.prevInput.maxPointers:Ae.pointers.length,function(ye,Ae){var jt,Ht,si,Fr,Ue=ye.lastInterval||Ae,_t=Ae.timeStamp-Ue.timeStamp;if(8!=Ae.eventType&&(_t>25||Ue.velocity===Y)){var Kr=Ae.deltaX-Ue.deltaX,bs=Ae.deltaY-Ue.deltaY,ni=In(_t,Kr,bs);Ht=ni.x,si=ni.y,jt=L(ni.x)>L(ni.y)?ni.x:ni.y,Fr=Ln(Kr,bs),ye.lastInterval=Ae}else jt=Ue.velocity,Ht=Ue.velocityX,si=Ue.velocityY,Fr=Ue.direction;Ae.velocity=jt,Ae.velocityX=Ht,Ae.velocityY=si,Ae.direction=Fr}(Ue,Ae);var ni=ye.element;D(Ae.srcEvent.target,ni)&&(ni=Ae.srcEvent.target),Ae.target=ni}(ye,Ue),ye.emit("hammer.input",Ue),ye.recognize(Ue),ye.session.prevInput=Ue}function bt(ye){for(var Ae=[],Ue=0;Ue<ye.pointers.length;)Ae[Ue]={clientX:V(ye.pointers[Ue].clientX),clientY:V(ye.pointers[Ue].clientY)},Ue++;return{timeStamp:ie(),pointers:Ae,center:It(Ae),deltaX:ye.deltaX,deltaY:ye.deltaY}}function It(ye){var Ae=ye.length;if(1===Ae)return{x:V(ye[0].clientX),y:V(ye[0].clientY)};for(var Ue=0,_t=0,jt=0;jt<Ae;)Ue+=ye[jt].clientX,_t+=ye[jt].clientY,jt++;return{x:V(Ue/Ae),y:V(_t/Ae)}}function In(ye,Ae,Ue){return{x:Ae/ye||0,y:Ue/ye||0}}function Ln(ye,Ae){return ye===Ae?1:L(ye)>=L(Ae)?ye<0?2:4:Ae<0?8:16}function Wn(ye,Ae,Ue){Ue||(Ue=gt);var _t=Ae[Ue[0]]-ye[Ue[0]],jt=Ae[Ue[1]]-ye[Ue[1]];return Math.sqrt(_t*_t+jt*jt)}function Ei(ye,Ae,Ue){return Ue||(Ue=gt),180*Math.atan2(Ae[Ue[1]]-ye[Ue[1]],Ae[Ue[0]]-ye[Ue[0]])/Math.PI}ve.prototype={handler:function(){},init:function(){this.evEl&&q(this.element,this.evEl,this.domHandler),this.evTarget&&q(this.target,this.evTarget,this.domHandler),this.evWin&&q(Se(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ce(this.element,this.evEl,this.domHandler),this.evTarget&&ce(this.target,this.evTarget,this.domHandler),this.evWin&&ce(Se(this.element),this.evWin,this.domHandler)}};var Ns={mousedown:1,mousemove:2,mouseup:4},us="mousedown",Ps="mousemove mouseup";function $r(){this.evEl=us,this.evWin=Ps,this.pressed=!1,ve.apply(this,arguments)}E($r,ve,{handler:function(Ae){var Ue=Ns[Ae.type];1&Ue&&0===Ae.button&&(this.pressed=!0),2&Ue&&1!==Ae.which&&(Ue=4),this.pressed&&(4&Ue&&(this.pressed=!1),this.callback(this.manager,Ue,{pointers:[Ae],changedPointers:[Ae],pointerType:Xe,srcEvent:Ae}))}});var Wa={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Cl={2:He,3:"pen",4:Xe,5:"kinect"},da="pointerdown",_s="pointermove pointerup pointercancel";function Jt(){this.evEl=da,this.evWin=_s,ve.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}J.MSPointerEvent&&!J.PointerEvent&&(da="MSPointerDown",_s="MSPointerMove MSPointerUp MSPointerCancel"),E(Jt,ve,{handler:function(Ae){var Ue=this.store,_t=!1,jt=Ae.type.toLowerCase().replace("ms",""),Ht=Wa[jt],si=Cl[Ae.pointerType]||Ae.pointerType,Fr=si==He,Kr=w(Ue,Ae.pointerId,"pointerId");1&Ht&&(0===Ae.button||Fr)?Kr<0&&(Ue.push(Ae),Kr=Ue.length-1):12&Ht&&(_t=!0),!(Kr<0)&&(Ue[Kr]=Ae,this.callback(this.manager,Ht,{pointers:Ue,changedPointers:[Ae],pointerType:si,srcEvent:Ae}),_t&&Ue.splice(Kr,1))}});var qa={touchstart:1,touchmove:2,touchend:4,touchcancel:8},it="touchstart",ot="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=it,this.evWin=ot,this.started=!1,ve.apply(this,arguments)}function ge(ye,Ae){var Ue=z(ye.touches),_t=z(ye.changedTouches);return 12&Ae&&(Ue=Q(Ue.concat(_t),"identifier",!0)),[Ue,_t]}E(ut,ve,{handler:function(Ae){var Ue=qa[Ae.type];if(1===Ue&&(this.started=!0),this.started){var _t=ge.call(this,Ae,Ue);12&Ue&&_t[0].length-_t[1].length==0&&(this.started=!1),this.callback(this.manager,Ue,{pointers:_t[0],changedPointers:_t[1],pointerType:He,srcEvent:Ae})}}});var be={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Le="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=Le,this.targetIds={},ve.apply(this,arguments)}function Ze(ye,Ae){var Ue=z(ye.touches),_t=this.targetIds;if(3&Ae&&1===Ue.length)return _t[Ue[0].identifier]=!0,[Ue,Ue];var jt,Ht,si=z(ye.changedTouches),Fr=[],Kr=this.target;if(Ht=Ue.filter(function(bs){return D(bs.target,Kr)}),1===Ae)for(jt=0;jt<Ht.length;)_t[Ht[jt].identifier]=!0,jt++;for(jt=0;jt<si.length;)_t[si[jt].identifier]&&Fr.push(si[jt]),12&Ae&&delete _t[si[jt].identifier],jt++;return Fr.length?[Q(Ht.concat(Fr),"identifier",!0),Fr]:void 0}function Tt(){ve.apply(this,arguments);var ye=x(this.handler,this);this.touch=new ct(this.manager,ye),this.mouse=new $r(this.manager,ye),this.primaryTouch=null,this.lastTouches=[]}function qt(ye,Ae){1&ye?(this.primaryTouch=Ae.changedPointers[0].identifier,Un.call(this,Ae)):12&ye&&Un.call(this,Ae)}function Un(ye){var Ae=ye.changedPointers[0];if(Ae.identifier===this.primaryTouch){var Ue={x:Ae.clientX,y:Ae.clientY};this.lastTouches.push(Ue);var _t=this.lastTouches;setTimeout(function(){var Ht=_t.indexOf(Ue);Ht>-1&&_t.splice(Ht,1)},2500)}}function ri(ye){for(var Ae=ye.srcEvent.clientX,Ue=ye.srcEvent.clientY,_t=0;_t<this.lastTouches.length;_t++){var jt=this.lastTouches[_t],Ht=Math.abs(Ae-jt.x),si=Math.abs(Ue-jt.y);if(Ht<=25&&si<=25)return!0}return!1}E(ct,ve,{handler:function(Ae){var Ue=be[Ae.type],_t=Ze.call(this,Ae,Ue);!_t||this.callback(this.manager,Ue,{pointers:_t[0],changedPointers:_t[1],pointerType:He,srcEvent:Ae})}}),E(Tt,ve,{handler:function(Ae,Ue,_t){var Ht=_t.pointerType==Xe;if(!(Ht&&_t.sourceCapabilities&&_t.sourceCapabilities.firesTouchEvents)){if(_t.pointerType==He)qt.call(this,Ue,_t);else if(Ht&&ri.call(this,_t))return;this.callback(Ae,Ue,_t)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Rn=se(fe.style,"touchAction"),gn=Rn!==Y,Gn="compute",er="manipulation",tr="none",Yn="pan-x",Vi="pan-y",ha=function(){if(!gn)return!1;var ye={},Ae=J.CSS&&J.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ue){ye[Ue]=!Ae||J.CSS.supports("touch-action",Ue)}),ye}();function Wr(ye,Ae){this.manager=ye,this.set(Ae)}function Dt(ye){this.options=M({},this.defaults,ye||{}),this.id=oe++,this.manager=null,this.options.enable=O(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function We(ye){return 16&ye?"cancel":8&ye?"end":4&ye?"move":2&ye?"start":""}function zt(ye){return 16==ye?"down":8==ye?"up":2==ye?"left":4==ye?"right":""}function Et(ye,Ae){var Ue=Ae.manager;return Ue?Ue.get(ye):ye}function mn(){Dt.apply(this,arguments)}function ys(){mn.apply(this,arguments),this.pX=null,this.pY=null}function qr(){mn.apply(this,arguments)}function Ks(){Dt.apply(this,arguments),this._timer=null,this._input=null}function Al(){mn.apply(this,arguments)}function ao(){mn.apply(this,arguments)}function Pr(){Dt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Fs(ye,Ae){return(Ae=Ae||{}).recognizers=O(Ae.recognizers,Fs.defaults.preset),new lo(ye,Ae)}function lo(ye,Ae){this.options=M({},Fs.defaults,Ae||{}),this.options.inputTarget=this.options.inputTarget||ye,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ye,this.input=function(ye){return new(ye.options.inputClass||(_e?Jt:De?ct:te?Tt:$r))(ye,R)}(this),this.touchAction=new Wr(this,this.options.touchAction),Tl(this,!0),S(this.options.recognizers,function(Ue){var _t=this.add(new Ue[0](Ue[1]));Ue[2]&&_t.recognizeWith(Ue[2]),Ue[3]&&_t.requireFailure(Ue[3])},this)}function Tl(ye,Ae){var _t,Ue=ye.element;Ue.style&&(S(ye.options.cssProps,function(jt,Ht){_t=se(Ue.style,Ht),Ae?(ye.oldCssProps[_t]=Ue.style[_t],Ue.style[_t]=jt):Ue.style[_t]=ye.oldCssProps[_t]||""}),Ae||(ye.oldCssProps={}))}Wr.prototype={set:function(ye){ye==Gn&&(ye=this.compute()),gn&&this.manager.element.style&&ha[ye]&&(this.manager.element.style[Rn]=ye),this.actions=ye.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ye=[];return S(this.manager.recognizers,function(Ae){j(Ae.options.enable,[Ae])&&(ye=ye.concat(Ae.getTouchAction()))}),function(ye){if(I(ye,tr))return tr;var Ae=I(ye,Yn),Ue=I(ye,Vi);return Ae&&Ue?tr:Ae||Ue?Ae?Yn:Vi:I(ye,er)?er:"auto"}(ye.join(" "))},preventDefaults:function(ye){var Ae=ye.srcEvent,Ue=ye.offsetDirection;if(!this.manager.session.prevented){var _t=this.actions,jt=I(_t,tr)&&!ha[tr],Ht=I(_t,Vi)&&!ha[Vi],si=I(_t,Yn)&&!ha[Yn];if(jt&&1===ye.pointers.length&&ye.distance<2&&ye.deltaTime<250)return;return si&&Ht||!(jt||Ht&&6&Ue||si&&24&Ue)?void 0:this.preventSrc(Ae)}Ae.preventDefault()},preventSrc:function(ye){this.manager.session.prevented=!0,ye.preventDefault()}},Dt.prototype={defaults:{},set:function(ye){return M(this.options,ye),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ye){if(v(ye,"recognizeWith",this))return this;var Ae=this.simultaneous;return Ae[(ye=Et(ye,this)).id]||(Ae[ye.id]=ye,ye.recognizeWith(this)),this},dropRecognizeWith:function(ye){return v(ye,"dropRecognizeWith",this)||(ye=Et(ye,this),delete this.simultaneous[ye.id]),this},requireFailure:function(ye){if(v(ye,"requireFailure",this))return this;var Ae=this.requireFail;return-1===w(Ae,ye=Et(ye,this))&&(Ae.push(ye),ye.requireFailure(this)),this},dropRequireFailure:function(ye){if(v(ye,"dropRequireFailure",this))return this;ye=Et(ye,this);var Ae=w(this.requireFail,ye);return Ae>-1&&this.requireFail.splice(Ae,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ye){return!!this.simultaneous[ye.id]},emit:function(ye){var Ae=this,Ue=this.state;function _t(jt){Ae.manager.emit(jt,ye)}Ue<8&&_t(Ae.options.event+We(Ue)),_t(Ae.options.event),ye.additionalEvent&&_t(ye.additionalEvent),Ue>=8&&_t(Ae.options.event+We(Ue))},tryEmit:function(ye){if(this.canEmit())return this.emit(ye);this.state=32},canEmit:function(){for(var ye=0;ye<this.requireFail.length;){if(!(33&this.requireFail[ye].state))return!1;ye++}return!0},recognize:function(ye){var Ae=M({},ye);if(!j(this.options.enable,[this,Ae]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Ae),30&this.state&&this.tryEmit(Ae)},process:function(ye){},getTouchAction:function(){},reset:function(){}},E(mn,Dt,{defaults:{pointers:1},attrTest:function(ye){var Ae=this.options.pointers;return 0===Ae||ye.pointers.length===Ae},process:function(ye){var Ae=this.state,Ue=ye.eventType,_t=6&Ae,jt=this.attrTest(ye);return _t&&(8&Ue||!jt)?16|Ae:_t||jt?4&Ue?8|Ae:2&Ae?4|Ae:2:32}}),E(ys,mn,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var ye=this.options.direction,Ae=[];return 6&ye&&Ae.push(Vi),24&ye&&Ae.push(Yn),Ae},directionTest:function(ye){var Ae=this.options,Ue=!0,_t=ye.distance,jt=ye.direction,Ht=ye.deltaX,si=ye.deltaY;return jt&Ae.direction||(6&Ae.direction?(jt=0===Ht?1:Ht<0?2:4,Ue=Ht!=this.pX,_t=Math.abs(ye.deltaX)):(jt=0===si?1:si<0?8:16,Ue=si!=this.pY,_t=Math.abs(ye.deltaY))),ye.direction=jt,Ue&&_t>Ae.threshold&&jt&Ae.direction},attrTest:function(ye){return mn.prototype.attrTest.call(this,ye)&&(2&this.state||!(2&this.state)&&this.directionTest(ye))},emit:function(ye){this.pX=ye.deltaX,this.pY=ye.deltaY;var Ae=zt(ye.direction);Ae&&(ye.additionalEvent=this.options.event+Ae),this._super.emit.call(this,ye)}}),E(qr,mn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tr]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.scale-1)>this.options.threshold||2&this.state)},emit:function(ye){1!==ye.scale&&(ye.additionalEvent=this.options.event+(ye.scale<1?"in":"out")),this._super.emit.call(this,ye)}}),E(Ks,Dt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(ye){var Ae=this.options,Ue=ye.pointers.length===Ae.pointers,_t=ye.distance<Ae.threshold,jt=ye.deltaTime>Ae.time;if(this._input=ye,!_t||!Ue||12&ye.eventType&&!jt)this.reset();else if(1&ye.eventType)this.reset(),this._timer=$(function(){this.state=8,this.tryEmit()},Ae.time,this);else if(4&ye.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(ye){8===this.state&&(ye&&4&ye.eventType?this.manager.emit(this.options.event+"up",ye):(this._input.timeStamp=ie(),this.manager.emit(this.options.event,this._input)))}}),E(Al,mn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tr]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.rotation)>this.options.threshold||2&this.state)}}),E(ao,mn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ys.prototype.getTouchAction.call(this)},attrTest:function(ye){var Ue,Ae=this.options.direction;return 30&Ae?Ue=ye.overallVelocity:6&Ae?Ue=ye.overallVelocityX:24&Ae&&(Ue=ye.overallVelocityY),this._super.attrTest.call(this,ye)&&Ae&ye.offsetDirection&&ye.distance>this.options.threshold&&ye.maxPointers==this.options.pointers&&L(Ue)>this.options.velocity&&4&ye.eventType},emit:function(ye){var Ae=zt(ye.offsetDirection);Ae&&this.manager.emit(this.options.event+Ae,ye),this.manager.emit(this.options.event,ye)}}),E(Pr,Dt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[er]},process:function(ye){var Ae=this.options,Ue=ye.pointers.length===Ae.pointers,_t=ye.distance<Ae.threshold,jt=ye.deltaTime<Ae.time;if(this.reset(),1&ye.eventType&&0===this.count)return this.failTimeout();if(_t&&jt&&Ue){if(4!=ye.eventType)return this.failTimeout();var Ht=!this.pTime||ye.timeStamp-this.pTime<Ae.interval,si=!this.pCenter||Wn(this.pCenter,ye.center)<Ae.posThreshold;if(this.pTime=ye.timeStamp,this.pCenter=ye.center,si&&Ht?this.count+=1:this.count=1,this._input=ye,0==this.count%Ae.taps)return this.hasRequireFailures()?(this._timer=$(function(){this.state=8,this.tryEmit()},Ae.interval,this),2):8}return 32},failTimeout:function(){return this._timer=$(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Fs.VERSION="2.0.7",Fs.defaults={domEvents:!1,touchAction:Gn,enable:!0,inputTarget:null,inputClass:null,preset:[[Al,{enable:!1}],[qr,{enable:!1},["rotate"]],[ao,{direction:6}],[ys,{direction:6},["swipe"]],[Pr],[Pr,{event:"doubletap",taps:2},["tap"]],[Ks]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},lo.prototype={set:function(ye){return M(this.options,ye),ye.touchAction&&this.touchAction.update(),ye.inputTarget&&(this.input.destroy(),this.input.target=ye.inputTarget,this.input.init()),this},stop:function(ye){this.session.stopped=ye?2:1},recognize:function(ye){var Ae=this.session;if(!Ae.stopped){this.touchAction.preventDefaults(ye);var Ue,_t=this.recognizers,jt=Ae.curRecognizer;(!jt||jt&&8&jt.state)&&(jt=Ae.curRecognizer=null);for(var Ht=0;Ht<_t.length;)Ue=_t[Ht],2===Ae.stopped||jt&&Ue!=jt&&!Ue.canRecognizeWith(jt)?Ue.reset():Ue.recognize(ye),!jt&&14&Ue.state&&(jt=Ae.curRecognizer=Ue),Ht++}},get:function(ye){if(ye instanceof Dt)return ye;for(var Ae=this.recognizers,Ue=0;Ue<Ae.length;Ue++)if(Ae[Ue].options.event==ye)return Ae[Ue];return null},add:function(ye){if(v(ye,"add",this))return this;var Ae=this.get(ye.options.event);return Ae&&this.remove(Ae),this.recognizers.push(ye),ye.manager=this,this.touchAction.update(),ye},remove:function(ye){if(v(ye,"remove",this))return this;if(ye=this.get(ye)){var Ae=this.recognizers,Ue=w(Ae,ye);-1!==Ue&&(Ae.splice(Ue,1),this.touchAction.update())}return this},on:function(ye,Ae){if(ye!==Y&&Ae!==Y){var Ue=this.handlers;return S(X(ye),function(_t){Ue[_t]=Ue[_t]||[],Ue[_t].push(Ae)}),this}},off:function(ye,Ae){if(ye!==Y){var Ue=this.handlers;return S(X(ye),function(_t){Ae?Ue[_t]&&Ue[_t].splice(w(Ue[_t],Ae),1):delete Ue[_t]}),this}},emit:function(ye,Ae){this.options.domEvents&&function(ye,Ae){var Ue=At.createEvent("Event");Ue.initEvent(ye,!0,!0),Ue.gesture=Ae,Ae.target.dispatchEvent(Ue)}(ye,Ae);var Ue=this.handlers[ye]&&this.handlers[ye].slice();if(Ue&&Ue.length){Ae.type=ye,Ae.preventDefault=function(){Ae.srcEvent.preventDefault()};for(var _t=0;_t<Ue.length;)Ue[_t](Ae),_t++}},destroy:function(){this.element&&Tl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},M(Fs,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:lo,Input:ve,TouchAction:Wr,TouchInput:ct,MouseInput:$r,PointerEventInput:Jt,TouchMouseInput:Tt,SingleTouchInput:ut,Recognizer:Dt,AttrRecognizer:mn,Tap:Pr,Pan:ys,Swipe:ao,Pinch:qr,Rotate:Al,Press:Ks,on:q,off:ce,each:S,merge:y,extend:b,assign:M,inherit:E,bindFn:x,prefixed:se}),(void 0!==J?J:"undefined"!=typeof self?self:{}).Hammer=Fs,(mt=function(){return Fs}.call(nt,tt,nt,kt))!==Y&&(kt.exports=mt)}(window,document)},815:function(kt,nt,tt){var mt;kt=tt.nmd(kt),function(){var J,Te="Expected a function",K="__lodash_hash_undefined__",L="__lodash_placeholder__",j=32,q=128,ee=1/0,Se=9007199254740991,_e=4294967295,rt=[["ary",q],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",j],["partialRight",64],["rearg",256]],Xe="[object Arguments]",Je="[object Array]",je="[object Boolean]",Fe="[object Date]",Ce="[object Error]",Be="[object Function]",$e="[object GeneratorFunction]",Ne="[object Map]",G="[object Number]",he="[object Object]",ue="[object Promise]",gt="[object RegExp]",ft="[object Set]",ve="[object String]",k="[object Symbol]",B="[object WeakMap]",Qe="[object ArrayBuffer]",bt="[object DataView]",It="[object Float32Array]",In="[object Float64Array]",Ln="[object Int8Array]",Wn="[object Int16Array]",Ei="[object Int32Array]",mi="[object Uint8Array]",Gr="[object Uint8ClampedArray]",Ns="[object Uint16Array]",us="[object Uint32Array]",Ps=/\b__p \+= '';/g,$r=/\b(__p \+=) '' \+/g,Wa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Cl=/&(?:amp|lt|gt|quot|#39);/g,da=/[&<>"']/g,_s=RegExp(Cl.source),Jt=RegExp(da.source),qa=/<%-([\s\S]+?)%>/g,it=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,ut=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Le=/[\\^$.*+?()[\]{}|]/g,ct=RegExp(Le.source),Ze=/^\s+/,vt=/\s/,xt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Tt=/\{\n\/\* \[wrapped with (.+)\] \*/,qt=/,? & /,Un=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ri=/[()=,{}\[\]\/\s]/,Rn=/\\(\\)?/g,gn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Gn=/\w*$/,En=/^[-+]0x[0-9a-f]+$/i,er=/^0b[01]+$/i,tr=/^\[object .+?Constructor\]$/,Yn=/^0o[0-7]+$/i,Vi=/^(?:0|[1-9]\d*)$/,ha=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wr=/($^)/,ne=/['\n\r\u2028\u2029\\]/g,de="\\ud800-\\udfff",Z="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",Pe="a-z\\xdf-\\xf6\\xf8-\\xff",Et="A-Z\\xc0-\\xd6\\xd8-\\xde",mn="\\ufe0e\\ufe0f",ys="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ks="["+de+"]",Al="["+ys+"]",ao="["+Z+"]",Pr="\\d+",Fs="["+we+"]",dc="["+Pe+"]",wn="[^"+de+ys+Pr+we+Pe+Et+"]",lo="\\ud83c[\\udffb-\\udfff]",fa="[^"+de+"]",id="(?:\\ud83c[\\udde6-\\uddff]){2}",ye="[\\ud800-\\udbff][\\udc00-\\udfff]",Ae="["+Et+"]",_t="(?:"+dc+"|"+wn+")",jt="(?:"+Ae+"|"+wn+")",Ht="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",si="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Fr="(?:"+ao+"|"+lo+")?",Kr="["+mn+"]?",DC=Kr+Fr+"(?:\\u200d(?:"+[fa,id,ye].join("|")+")"+Kr+Fr+")*",rd="(?:"+[Fs,id,ye].join("|")+")"+DC,Xi="(?:"+[fa+ao+"?",ao,id,ye,Ks].join("|")+")",$f=RegExp("['\u2019]","g"),Am=RegExp(ao,"g"),fh=RegExp(lo+"(?="+lo+")|"+Xi+DC,"g"),wb=RegExp([Ae+"?"+dc+"+"+Ht+"(?="+[Al,Ae,"$"].join("|")+")",jt+"+"+si+"(?="+[Al,Ae+_t,"$"].join("|")+")",Ae+"?"+_t+"+"+Ht,Ae+"+"+si,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pr,rd].join("|"),"g"),IC=RegExp("[\\u200d"+de+Z+mn+"]"),Ml=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ph=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],OC=-1,Sn={};Sn[It]=Sn[In]=Sn[Ln]=Sn[Wn]=Sn[Ei]=Sn[mi]=Sn[Gr]=Sn[Ns]=Sn[us]=!0,Sn[Xe]=Sn[Je]=Sn[Qe]=Sn[je]=Sn[bt]=Sn[Fe]=Sn[Ce]=Sn[Be]=Sn[Ne]=Sn[G]=Sn[he]=Sn[gt]=Sn[ft]=Sn[ve]=Sn[B]=!1;var nr={};nr[Xe]=nr[Je]=nr[Qe]=nr[bt]=nr[je]=nr[Fe]=nr[It]=nr[In]=nr[Ln]=nr[Wn]=nr[Ei]=nr[Ne]=nr[G]=nr[he]=nr[gt]=nr[ft]=nr[ve]=nr[k]=nr[mi]=nr[Gr]=nr[Ns]=nr[us]=!0,nr[Ce]=nr[Be]=nr[B]=!1;var _n={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},RC=parseFloat,Cb=parseInt,Lt="object"==typeof global&&global&&global.Object===Object&&global,Ls="object"==typeof self&&self&&self.Object===Object&&self,Fi=Lt||Ls||Function("return this")(),Dl=nt&&!nt.nodeType&&nt,pa=Dl&&kt&&!kt.nodeType&&kt,Co=pa&&pa.exports===Dl,Tm=Co&&Lt.process,br=function(){try{return pa&&pa.require&&pa.require("util").types||Tm&&Tm.binding&&Tm.binding("util")}catch(Mt){}}(),nn=br&&br.isArrayBuffer,li=br&&br.isDate,lr=br&&br.isMap,co=br&&br.isRegExp,hc=br&&br.isSet,es=br&&br.isTypedArray;function ts(st,Mt,yt){switch(yt.length){case 0:return st.call(Mt);case 1:return st.call(Mt,yt[0]);case 2:return st.call(Mt,yt[0],yt[1]);case 3:return st.call(Mt,yt[0],yt[1],yt[2])}return st.apply(Mt,yt)}function Lr(st,Mt,yt,an){for(var Tn=-1,Di=null==st?0:st.length;++Tn<Di;){var Yr=st[Tn];Mt(an,Yr,yt(Yr),st)}return an}function ks(st,Mt){for(var yt=-1,an=null==st?0:st.length;++yt<an&&!1!==Mt(st[yt],yt,st););return st}function sd(st,Mt){for(var yt=null==st?0:st.length;yt--&&!1!==Mt(st[yt],yt,st););return st}function Jn(st,Mt){for(var yt=-1,an=null==st?0:st.length;++yt<an;)if(!Mt(st[yt],yt,st))return!1;return!0}function ga(st,Mt){for(var yt=-1,an=null==st?0:st.length,Tn=0,Di=[];++yt<an;){var Yr=st[yt];Mt(Yr,yt,st)&&(Di[Tn++]=Yr)}return Di}function Il(st,Mt){return!(null==st||!st.length)&&Ka(st,Mt,0)>-1}function gh(st,Mt,yt){for(var an=-1,Tn=null==st?0:st.length;++an<Tn;)if(yt(Mt,st[an]))return!0;return!1}function Hi(st,Mt){for(var yt=-1,an=null==st?0:st.length,Tn=Array(an);++yt<an;)Tn[yt]=Mt(st[yt],yt,st);return Tn}function kr(st,Mt){for(var yt=-1,an=Mt.length,Tn=st.length;++yt<an;)st[Tn+yt]=Mt[yt];return st}function ru(st,Mt,yt,an){var Tn=-1,Di=null==st?0:st.length;for(an&&Di&&(yt=st[++Tn]);++Tn<Di;)yt=Mt(yt,st[Tn],Tn,st);return yt}function od(st,Mt,yt,an){var Tn=null==st?0:st.length;for(an&&Tn&&(yt=st[--Tn]);Tn--;)yt=Mt(yt,st[Tn],Tn,st);return yt}function Ao(st,Mt){for(var yt=-1,an=null==st?0:st.length;++yt<an;)if(Mt(st[yt],yt,st))return!0;return!1}var ir=Mm("length");function mh(st,Mt,yt){var an;return yt(st,function(Tn,Di,Yr){if(Mt(Tn,Di,Yr))return an=Di,!1}),an}function ad(st,Mt,yt,an){for(var Tn=st.length,Di=yt+(an?1:-1);an?Di--:++Di<Tn;)if(Mt(st[Di],Di,st))return Di;return-1}function Ka(st,Mt,yt){return Mt==Mt?function(st,Mt,yt){for(var an=yt-1,Tn=st.length;++an<Tn;)if(st[an]===Mt)return an;return-1}(st,Mt,yt):ad(st,fc,yt)}function Wf(st,Mt,yt,an){for(var Tn=yt-1,Di=st.length;++Tn<Di;)if(an(st[Tn],Mt))return Tn;return-1}function fc(st){return st!=st}function vs(st,Mt){var yt=null==st?0:st.length;return yt?ld(st,Mt)/yt:NaN}function Mm(st){return function(Mt){return null==Mt?J:Mt[st]}}function Go(st){return function(Mt){return null==st?J:st[Mt]}}function $o(st,Mt,yt,an,Tn){return Tn(st,function(Di,Yr,Gi){yt=an?(an=!1,Di):Mt(yt,Di,Yr,Gi)}),yt}function ld(st,Mt){for(var yt,an=-1,Tn=st.length;++an<Tn;){var Di=Mt(st[an]);Di!==J&&(yt=yt===J?Di:yt+Di)}return yt}function cd(st,Mt){for(var yt=-1,an=Array(st);++yt<st;)an[yt]=Mt(yt);return an}function Ab(st){return st&&st.slice(0,pc(st)+1).replace(Ze,"")}function Wo(st){return function(Mt){return st(Mt)}}function Im(st,Mt){return Hi(Mt,function(yt){return st[yt]})}function _h(st,Mt){return st.has(Mt)}function FC(st,Mt){for(var yt=-1,an=st.length;++yt<an&&Ka(Mt,st[yt],0)>-1;);return yt}function LC(st,Mt){for(var yt=st.length;yt--&&Ka(Mt,st[yt],0)>-1;);return yt}function RP(st,Mt){for(var yt=st.length,an=0;yt--;)st[yt]===Mt&&++an;return an}var NP=Go({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),PP=Go({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function FP(st){return"\\"+_n[st]}function yh(st){return IC.test(st)}function Tb(st){var Mt=-1,yt=Array(st.size);return st.forEach(function(an,Tn){yt[++Mt]=[Tn,an]}),yt}function kC(st,Mt){return function(yt){return st(Mt(yt))}}function su(st,Mt){for(var yt=-1,an=st.length,Tn=0,Di=[];++yt<an;){var Yr=st[yt];(Yr===Mt||Yr===L)&&(st[yt]=L,Di[Tn++]=yt)}return Di}function Om(st){var Mt=-1,yt=Array(st.size);return st.forEach(function(an){yt[++Mt]=an}),yt}function bh(st){return yh(st)?function(st){for(var Mt=fh.lastIndex=0;fh.test(st);)++Mt;return Mt}(st):ir(st)}function Ya(st){return yh(st)?function(st){return st.match(fh)||[]}(st):function(st){return st.split("")}(st)}function pc(st){for(var Mt=st.length;Mt--&&vt.test(st.charAt(Mt)););return Mt}var Nm=Go({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),vh=function st(Mt){var u,yt=(Mt=null==Mt?Fi:vh.defaults(Fi.Object(),Mt,vh.pick(Fi,ph))).Array,an=Mt.Date,Tn=Mt.Error,Di=Mt.Function,Yr=Mt.Math,Gi=Mt.Object,Pm=Mt.RegExp,Fm=Mt.String,_a=Mt.TypeError,cr=yt.prototype,ou=Gi.prototype,qf=Mt["__core-js_shared__"],vr=Di.prototype.toString,$i=ou.hasOwnProperty,UP=0,wh=(u=/[^.]+$/.exec(qf&&qf.keys&&qf.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",Ys=ou.toString,VC=vr.call(Gi),Lm=Fi._,ud=Pm("^"+vr.call($i).replace(Le,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bs=Co?Mt.Buffer:J,Ol=Mt.Symbol,dd=Mt.Uint8Array,Ib=Bs?Bs.allocUnsafe:J,ya=kC(Gi.getPrototypeOf,Gi),km=Gi.create,Kf=ou.propertyIsEnumerable,Bn=cr.splice,UC=Ol?Ol.isConcatSpreadable:J,Eh=Ol?Ol.iterator:J,au=Ol?Ol.toStringTag:J,Yf=function(){try{var u=xc(Gi,"defineProperty");return u({},"",{}),u}catch(h){}}(),Ob=Mt.clearTimeout!==Fi.clearTimeout&&Mt.clearTimeout,zC=an&&an.now!==Fi.Date.now&&an.now,HC=Mt.setTimeout!==Fi.setTimeout&&Mt.setTimeout,Ft=Yr.ceil,_i=Yr.floor,Br=Gi.getOwnPropertySymbols,ns=Bs?Bs.isBuffer:J,Bm=Mt.isFinite,Sh=cr.join,Xa=kC(Gi.keys,Gi),jr=Yr.max,ds=Yr.min,zP=an.now,GC=Mt.parseInt,xh=Yr.random,Xf=cr.reverse,ws=xc(Mt,"DataView"),uo=xc(Mt,"Map"),Qf=xc(Mt,"Promise"),ba=xc(Mt,"Set"),To=xc(Mt,"WeakMap"),Ch=xc(Gi,"create"),Ah=To&&new To,hd={},$C=bu(ws),jm=bu(uo),Vm=bu(Qf),Rb=bu(ba),Um=bu(To),Zf=Ol?Ol.prototype:J,fd=Zf?Zf.valueOf:J,Th=Zf?Zf.toString:J;function Ee(u){if(Sr(u)&&!On(u)&&!(u instanceof ci)){if(u instanceof Mo)return u;if($i.call(u,"__wrapped__"))return Ep(u)}return new Mo(u)}var lu=function(){function u(){}return function(h){if(!Er(h))return{};if(km)return km(h);u.prototype=h;var m=new u;return u.prototype=J,m}}();function Mh(){}function Mo(u,h){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=J}function ci(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function ho(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var P=u[h];this.set(P[0],P[1])}}function Rl(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var P=u[h];this.set(P[0],P[1])}}function Qa(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var P=u[h];this.set(P[0],P[1])}}function va(u){var h=-1,m=null==u?0:u.length;for(this.__data__=new Qa;++h<m;)this.add(u[h])}function wa(u){var h=this.__data__=new Rl(u);this.size=h.size}function Ih(u,h){var m=On(u),P=!m&&ol(u),ae=!m&&!P&&al(u),xe=!m&&!P&&!ae&&$h(u),Ve=m||P||ae||xe,qe=Ve?cd(u.length,Fm):[],lt=qe.length;for(var Rt in u)(h||$i.call(u,Rt))&&(!Ve||!("length"==Rt||ae&&("offset"==Rt||"parent"==Rt)||xe&&("buffer"==Rt||"byteLength"==Rt||"byteOffset"==Rt)||Oo(Rt,lt)))&&qe.push(Rt);return qe}function $m(u){var h=u.length;return h?u[Nl(0,h-1)]:J}function Pb(u,h){return Md(Qs(u),cu(h,0,u.length))}function pd(u){return Md(Qs(u))}function Wm(u,h,m){(m!==J&&!Mn(u[h],m)||m===J&&!(h in u))&&Ja(u,h,m)}function Za(u,h,m){var P=u[h];(!$i.call(u,h)||!Mn(P,m)||m===J&&!(h in u))&&Ja(u,h,m)}function gd(u,h){for(var m=u.length;m--;)if(Mn(u[m][0],h))return m;return-1}function ip(u,h,m,P){return _c(u,function(ae,xe,Ve){h(P,ae,m(ae),Ve)}),P}function r1(u,h){return u&&xa(h,As(h),u)}function Ja(u,h,m){"__proto__"==h&&Yf?Yf(u,h,{configurable:!0,enumerable:!0,value:m,writable:!0}):u[h]=m}function qm(u,h){for(var m=-1,P=h.length,ae=yt(P),xe=null==u;++m<P;)ae[m]=xe?J:Kh(u,h[m]);return ae}function cu(u,h,m){return u==u&&(m!==J&&(u=u<=m?u:m),h!==J&&(u=u>=h?u:h)),u}function js(u,h,m,P,ae,xe){var Ve,qe=1&h,lt=2&h,Rt=4&h;if(m&&(Ve=ae?m(u,P,ae,xe):m(u)),Ve!==J)return Ve;if(!Er(u))return u;var Nt=On(u);if(Nt){if(Ve=function(u){var h=u.length,m=new u.constructor(h);return h&&"string"==typeof u[0]&&$i.call(u,"index")&&(m.index=u.index,m.input=u.input),m}(u),!qe)return Qs(u,Ve)}else{var Bt=Us(u),tn=Bt==Be||Bt==$e;if(al(u))return dp(u,qe);if(Bt==he||Bt==Xe||tn&&!ae){if(Ve=lt||tn?{}:iv(u),!qe)return lt?function(u,h){return xa(u,ev(u),h)}(u,function(u,h){return u&&xa(h,Js(h),u)}(Ve,u)):function(u,h){return xa(u,c_(u),h)}(u,r1(Ve,u))}else{if(!nr[Bt])return ae?u:{};Ve=function(u,h,m){var P=u.constructor;switch(h){case Qe:return gu(u);case je:case Fe:return new P(+u);case bt:return function(u,h){var m=h?gu(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.byteLength)}(u,m);case It:case In:case Ln:case Wn:case Ei:case mi:case Gr:case Ns:case us:return r_(u,m);case Ne:return new P;case G:case ve:return new P(u);case gt:return function(u){var h=new u.constructor(u.source,Gn.exec(u));return h.lastIndex=u.lastIndex,h}(u);case ft:return new P;case k:return function(u){return fd?Gi(fd.call(u)):{}}(u)}}(u,Bt,qe)}}xe||(xe=new wa);var bn=xe.get(u);if(bn)return bn;xe.set(u,Ve),xA(u)?u.forEach(function(jn){Ve.add(js(jn,h,m,jn,u,xe))}):vA(u)&&u.forEach(function(jn,hi){Ve.set(hi,js(jn,h,m,hi,u,xe))});var di=Nt?J:(Rt?lt?a_:kl:lt?Js:As)(u);return ks(di||u,function(jn,hi){di&&(jn=u[hi=jn]),Za(Ve,hi,js(jn,h,m,hi,u,xe))}),Ve}function rp(u,h,m){var P=m.length;if(null==u)return!P;for(u=Gi(u);P--;){var ae=m[P],Ve=u[ae];if(Ve===J&&!(ae in u)||!(0,h[ae])(Ve))return!1}return!0}function Oh(u,h,m){if("function"!=typeof u)throw new _a(Te);return Bh(function(){u.apply(J,m)},h)}function mc(u,h,m,P){var ae=-1,xe=Il,Ve=!0,qe=u.length,lt=[],Rt=h.length;if(!qe)return lt;m&&(h=Hi(h,Wo(m))),P?(xe=gh,Ve=!1):h.length>=200&&(xe=_h,Ve=!1,h=new va(h));e:for(;++ae<qe;){var Nt=u[ae],Bt=null==m?Nt:m(Nt);if(Nt=P||0!==Nt?Nt:0,Ve&&Bt==Bt){for(var tn=Rt;tn--;)if(h[tn]===Bt)continue e;lt.push(Nt)}else xe(h,Bt,P)||lt.push(Nt)}return lt}Ee.templateSettings={escape:qa,evaluate:it,interpolate:ot,variable:"",imports:{_:Ee}},(Ee.prototype=Mh.prototype).constructor=Ee,(Mo.prototype=lu(Mh.prototype)).constructor=Mo,(ci.prototype=lu(Mh.prototype)).constructor=ci,ho.prototype.clear=function(){this.__data__=Ch?Ch(null):{},this.size=0},ho.prototype.delete=function(u){var h=this.has(u)&&delete this.__data__[u];return this.size-=h?1:0,h},ho.prototype.get=function(u){var h=this.__data__;if(Ch){var m=h[u];return m===K?J:m}return $i.call(h,u)?h[u]:J},ho.prototype.has=function(u){var h=this.__data__;return Ch?h[u]!==J:$i.call(h,u)},ho.prototype.set=function(u,h){var m=this.__data__;return this.size+=this.has(u)?0:1,m[u]=Ch&&h===J?K:h,this},Rl.prototype.clear=function(){this.__data__=[],this.size=0},Rl.prototype.delete=function(u){var h=this.__data__,m=gd(h,u);return!(m<0||(m==h.length-1?h.pop():Bn.call(h,m,1),--this.size,0))},Rl.prototype.get=function(u){var h=this.__data__,m=gd(h,u);return m<0?J:h[m][1]},Rl.prototype.has=function(u){return gd(this.__data__,u)>-1},Rl.prototype.set=function(u,h){var m=this.__data__,P=gd(m,u);return P<0?(++this.size,m.push([u,h])):m[P][1]=h,this},Qa.prototype.clear=function(){this.size=0,this.__data__={hash:new ho,map:new(uo||Rl),string:new ho}},Qa.prototype.delete=function(u){var h=Vs(this,u).delete(u);return this.size-=h?1:0,h},Qa.prototype.get=function(u){return Vs(this,u).get(u)},Qa.prototype.has=function(u){return Vs(this,u).has(u)},Qa.prototype.set=function(u,h){var m=Vs(this,u),P=m.size;return m.set(u,h),this.size+=m.size==P?0:1,this},va.prototype.add=va.prototype.push=function(u){return this.__data__.set(u,K),this},va.prototype.has=function(u){return this.__data__.has(u)},wa.prototype.clear=function(){this.__data__=new Rl,this.size=0},wa.prototype.delete=function(u){var h=this.__data__,m=h.delete(u);return this.size=h.size,m},wa.prototype.get=function(u){return this.__data__.get(u)},wa.prototype.has=function(u){return this.__data__.has(u)},wa.prototype.set=function(u,h){var m=this.__data__;if(m instanceof Rl){var P=m.__data__;if(!uo||P.length<199)return P.push([u,h]),this.size=++m.size,this;m=this.__data__=new Qa(P)}return m.set(u,h),this.size=m.size,this};var _c=nl(el),Ym=nl(sp,!0);function Lb(u,h){var m=!0;return _c(u,function(P,ae,xe){return m=!!h(P,ae,xe)}),m}function Rh(u,h,m){for(var P=-1,ae=u.length;++P<ae;){var xe=u[P],Ve=h(xe);if(null!=Ve&&(qe===J?Ve==Ve&&!na(Ve):m(Ve,qe)))var qe=Ve,lt=xe}return lt}function Bb(u,h){var m=[];return _c(u,function(P,ae,xe){h(P,ae,xe)&&m.push(P)}),m}function Es(u,h,m,P,ae){var xe=-1,Ve=u.length;for(m||(m=E1),ae||(ae=[]);++xe<Ve;){var qe=u[xe];h>0&&m(qe)?h>1?Es(qe,h-1,m,P,ae):kr(ae,qe):P||(ae[ae.length]=qe)}return ae}var md=$b(),_d=$b(!0);function el(u,h){return u&&md(u,h,As)}function sp(u,h){return u&&_d(u,h,As)}function Nh(u,h){return ga(h,function(m){return ta(u[m])})}function qo(u,h){for(var m=0,P=(h=wc(h,u)).length;null!=u&&m<P;)u=u[ei(h[m++])];return m&&m==P?u:J}function rr(u,h,m){var P=h(u);return On(u)?P:kr(P,m(u))}function Ss(u){return null==u?u===J?"[object Undefined]":"[object Null]":au&&au in Gi(u)?function(u){var h=$i.call(u,au),m=u[au];try{u[au]=J;var P=!0}catch(xe){}var ae=Ys.call(u);return P&&(h?u[au]=m:delete u[au]),ae}(u):function(u){return Ys.call(u)}(u)}function Ea(u,h){return u>h}function yd(u,h){return null!=u&&$i.call(u,h)}function bd(u,h){return null!=u&&h in Gi(u)}function uu(u,h,m){for(var P=m?gh:Il,ae=u[0].length,xe=u.length,Ve=xe,qe=yt(xe),lt=1/0,Rt=[];Ve--;){var Nt=u[Ve];Ve&&h&&(Nt=Hi(Nt,Wo(h))),lt=ds(Nt.length,lt),qe[Ve]=!m&&(h||ae>=120&&Nt.length>=120)?new va(Ve&&Nt):J}Nt=u[0];var Bt=-1,tn=qe[0];e:for(;++Bt<ae&&Rt.length<lt;){var bn=Nt[Bt],kn=h?h(bn):bn;if(bn=m||0!==bn?bn:0,!(tn?_h(tn,kn):P(Rt,kn,m))){for(Ve=xe;--Ve;){var di=qe[Ve];if(!(di?_h(di,kn):P(u[Ve],kn,m)))continue e}tn&&tn.push(kn),Rt.push(bn)}}return Rt}function Sa(u,h,m){var P=null==(u=f_(u,h=wc(h,u)))?u:u[ei(Zo(h))];return null==P?J:ts(P,u,m)}function s1(u){return Sr(u)&&Ss(u)==Xe}function op(u,h,m,P,ae){return u===h||(null==u||null==h||!Sr(u)&&!Sr(h)?u!=u&&h!=h:function(u,h,m,P,ae,xe){var Ve=On(u),qe=On(h),lt=Ve?Je:Us(u),Rt=qe?Je:Us(h),Nt=(lt=lt==Xe?he:lt)==he,Bt=(Rt=Rt==Xe?he:Rt)==he,tn=lt==Rt;if(tn&&al(u)){if(!al(h))return!1;Ve=!0,Nt=!1}if(tn&&!Nt)return xe||(xe=new wa),Ve||$h(u)?_p(u,h,m,P,ae,xe):function(u,h,m,P,ae,xe,Ve){switch(m){case bt:if(u.byteLength!=h.byteLength||u.byteOffset!=h.byteOffset)return!1;u=u.buffer,h=h.buffer;case Qe:return!(u.byteLength!=h.byteLength||!xe(new dd(u),new dd(h)));case je:case Fe:case G:return Mn(+u,+h);case Ce:return u.name==h.name&&u.message==h.message;case gt:case ve:return u==h+"";case Ne:var qe=Tb;case ft:if(qe||(qe=Om),u.size!=h.size&&!(1&P))return!1;var Rt=Ve.get(u);if(Rt)return Rt==h;P|=2,Ve.set(u,h);var Nt=_p(qe(u),qe(h),P,ae,xe,Ve);return Ve.delete(u),Nt;case k:if(fd)return fd.call(u)==fd.call(h)}return!1}(u,h,lt,m,P,ae,xe);if(!(1&m)){var bn=Nt&&$i.call(u,"__wrapped__"),kn=Bt&&$i.call(h,"__wrapped__");if(bn||kn){var di=bn?u.value():u,jn=kn?h.value():h;return xe||(xe=new wa),ae(di,jn,m,P,xe)}}return!!tn&&(xe||(xe=new wa),function(u,h,m,P,ae,xe){var Ve=1&m,qe=kl(u),lt=qe.length;if(lt!=kl(h).length&&!Ve)return!1;for(var Bt=lt;Bt--;){var tn=qe[Bt];if(!(Ve?tn in h:$i.call(h,tn)))return!1}var bn=xe.get(u),kn=xe.get(h);if(bn&&kn)return bn==h&&kn==u;var di=!0;xe.set(u,h),xe.set(h,u);for(var jn=Ve;++Bt<lt;){var hi=u[tn=qe[Bt]],Si=h[tn];if(P)var go=Ve?P(Si,hi,tn,h,u,xe):P(hi,Si,tn,u,h,xe);if(!(go===J?hi===Si||ae(hi,Si,m,P,xe):go)){di=!1;break}jn||(jn="constructor"==tn)}if(di&&!jn){var Hs=u.constructor,ia=h.constructor;Hs!=ia&&"constructor"in u&&"constructor"in h&&!("function"==typeof Hs&&Hs instanceof Hs&&"function"==typeof ia&&ia instanceof ia)&&(di=!1)}return xe.delete(u),xe.delete(h),di}(u,h,m,P,ae,xe))}(u,h,m,P,op,ae))}function Qm(u,h,m,P){var ae=m.length,xe=ae,Ve=!P;if(null==u)return!xe;for(u=Gi(u);ae--;){var qe=m[ae];if(Ve&&qe[2]?qe[1]!==u[qe[0]]:!(qe[0]in u))return!1}for(;++ae<xe;){var lt=(qe=m[ae])[0],Rt=u[lt],Nt=qe[1];if(Ve&&qe[2]){if(Rt===J&&!(lt in u))return!1}else{var Bt=new wa;if(P)var tn=P(Rt,Nt,lt,u,h,Bt);if(!(tn===J?op(Nt,Rt,3,P,Bt):tn))return!1}}return!0}function Zm(u){return!(!Er(u)||function(u){return!!wh&&wh in u}(u))&&(ta(u)?ud:tr).test(bu(u))}function l1(u){return"function"==typeof u?u:null==u?eo:"object"==typeof u?On(u)?wd(u[0],u[1]):u1(u):Eu(u)}function jb(u){if(!vp(u))return Xa(u);var h=[];for(var m in Gi(u))$i.call(u,m)&&"constructor"!=m&&h.push(m);return h}function Vb(u,h){return u<h}function c1(u,h){var m=-1,P=fo(u)?yt(u.length):[];return _c(u,function(ae,xe,Ve){P[++m]=h(ae,xe,Ve)}),P}function u1(u){var h=Xo(u);return 1==h.length&&h[0][2]?x1(h[0][0],h[0][1]):function(m){return m===u||Qm(m,u,h)}}function wd(u,h){return Qo(u)&&S1(h)?x1(ei(u),h):function(m){var P=Kh(m,u);return P===J&&P===h?Np(m,u):op(h,P,3)}}function Jm(u,h,m,P,ae){u!==h&&md(h,function(xe,Ve){if(ae||(ae=new wa),Er(xe))!function(u,h,m,P,ae,xe,Ve){var qe=p_(u,m),lt=p_(h,m),Rt=Ve.get(lt);if(Rt)Wm(u,m,Rt);else{var Nt=xe?xe(qe,lt,m+"",u,h,Ve):J,Bt=Nt===J;if(Bt){var tn=On(lt),bn=!tn&&al(lt),kn=!tn&&!bn&&$h(lt);Nt=lt,tn||bn||kn?On(qe)?Nt=qe:wr(qe)?Nt=Qs(qe):bn?(Bt=!1,Nt=dp(lt,!0)):kn?(Bt=!1,Nt=r_(lt,!0)):Nt=[]:Rp(lt)||ol(lt)?(Nt=qe,ol(qe)?Nt=Yv(qe):(!Er(qe)||ta(qe))&&(Nt=iv(lt))):Bt=!1}Bt&&(Ve.set(lt,Nt),ae(Nt,lt,P,xe,Ve),Ve.delete(lt)),Wm(u,m,Nt)}}(u,h,Ve,m,Jm,P,ae);else{var qe=P?P(p_(u,Ve),xe,Ve+"",u,h,ae):J;qe===J&&(qe=xe),Wm(u,Ve,qe)}},Js)}function du(u,h){var m=u.length;if(m)return Oo(h+=h<0?m:0,m)?u[h]:J}function Ph(u,h,m){h=h.length?Hi(h,function(xe){return On(xe)?function(Ve){return qo(Ve,1===xe.length?xe[0]:xe)}:xe}):[eo];var P=-1;return h=Hi(h,Wo(Nn())),function(st,Mt){var yt=st.length;for(st.sort(function(xe,Ve){return function(u,h,m){for(var P=-1,ae=u.criteria,xe=h.criteria,Ve=ae.length,qe=m.length;++P<Ve;){var lt=Ec(ae[P],xe[P]);if(lt)return P>=qe?lt:lt*("desc"==m[P]?-1:1)}return u.index-h.index}(xe,Ve,m)});yt--;)st[yt]=st[yt].value;return st}(c1(u,function(xe,Ve,qe){return{criteria:Hi(h,function(Rt){return Rt(xe)}),index:++P,value:xe}}))}function Ub(u,h,m){for(var P=-1,ae=h.length,xe={};++P<ae;){var Ve=h[P],qe=qo(u,Ve);m(qe,Ve)&&lp(xe,wc(Ve,u),qe)}return xe}function Yo(u,h,m,P){var ae=P?Wf:Ka,xe=-1,Ve=h.length,qe=u;for(u===h&&(h=Qs(h)),m&&(qe=Hi(u,Wo(m)));++xe<Ve;)for(var lt=0,Rt=h[xe],Nt=m?m(Rt):Rt;(lt=ae(qe,Nt,lt,P))>-1;)qe!==u&&Bn.call(qe,lt,1),Bn.call(u,lt,1);return u}function Fh(u,h){for(var m=u?h.length:0,P=m-1;m--;){var ae=h[m];if(m==P||ae!==xe){var xe=ae;Oo(ae)?Bn.call(u,ae,1):hu(u,ae)}}return u}function Nl(u,h){return u+_i(xh()*(h-u+1))}function ap(u,h){var m="";if(!u||h<1||h>Se)return m;do{h%2&&(m+=u),(h=_i(h/2))&&(u+=u)}while(h);return m}function ui(u,h){return wp(C1(u,h,eo),u+"")}function d1(u){return $m(kd(u))}function QP(u,h){var m=kd(u);return Md(m,cu(h,0,m.length))}function lp(u,h,m,P){if(!Er(u))return u;for(var ae=-1,xe=(h=wc(h,u)).length,Ve=xe-1,qe=u;null!=qe&&++ae<xe;){var lt=ei(h[ae]),Rt=m;if("__proto__"===lt||"constructor"===lt||"prototype"===lt)return u;if(ae!=Ve){var Nt=qe[lt];(Rt=P?P(Nt,lt,qe):J)===J&&(Rt=Er(Nt)?Nt:Oo(h[ae+1])?[]:{})}Za(qe,lt,Rt),qe=qe[lt]}return u}var e_=Ah?function(u,h){return Ah.set(u,h),u}:eo,Do=Yf?function(u,h){return Yf(u,"toString",{configurable:!0,enumerable:!1,value:ty(h),writable:!0})}:eo;function t_(u){return Md(kd(u))}function xs(u,h,m){var P=-1,ae=u.length;h<0&&(h=-h>ae?0:ae+h),(m=m>ae?ae:m)<0&&(m+=ae),ae=h>m?0:m-h>>>0,h>>>=0;for(var xe=yt(ae);++P<ae;)xe[P]=u[P+h];return xe}function ZP(u,h){var m;return _c(u,function(P,ae,xe){return!(m=h(P,ae,xe))}),!!m}function Lh(u,h,m){var P=0,ae=null==u?P:u.length;if("number"==typeof h&&h==h&&ae<=2147483647){for(;P<ae;){var xe=P+ae>>>1,Ve=u[xe];null!==Ve&&!na(Ve)&&(m?Ve<=h:Ve<h)?P=xe+1:ae=xe}return ae}return n_(u,h,eo,m)}function n_(u,h,m,P){var ae=0,xe=null==u?0:u.length;if(0===xe)return 0;for(var Ve=(h=m(h))!=h,qe=null===h,lt=na(h),Rt=h===J;ae<xe;){var Nt=_i((ae+xe)/2),Bt=m(u[Nt]),tn=Bt!==J,bn=null===Bt,kn=Bt==Bt,di=na(Bt);if(Ve)var jn=P||kn;else jn=Rt?kn&&(P||tn):qe?kn&&tn&&(P||!bn):lt?kn&&tn&&!bn&&(P||!di):!bn&&!di&&(P?Bt<=h:Bt<h);jn?ae=Nt+1:xe=Nt}return ds(xe,4294967294)}function zb(u,h){for(var m=-1,P=u.length,ae=0,xe=[];++m<P;){var Ve=u[m],qe=h?h(Ve):Ve;if(!m||!Mn(qe,lt)){var lt=qe;xe[ae++]=0===Ve?0:Ve}}return xe}function Hb(u){return"number"==typeof u?u:na(u)?NaN:+u}function Io(u){if("string"==typeof u)return u;if(On(u))return Hi(u,Io)+"";if(na(u))return Th?Th.call(u):"";var h=u+"";return"0"==h&&1/u==-ee?"-0":h}function bc(u,h,m){var P=-1,ae=Il,xe=u.length,Ve=!0,qe=[],lt=qe;if(m)Ve=!1,ae=gh;else if(xe>=200){var Rt=h?null:o_(u);if(Rt)return Om(Rt);Ve=!1,ae=_h,lt=new va}else lt=h?[]:qe;e:for(;++P<xe;){var Nt=u[P],Bt=h?h(Nt):Nt;if(Nt=m||0!==Nt?Nt:0,Ve&&Bt==Bt){for(var tn=lt.length;tn--;)if(lt[tn]===Bt)continue e;h&&lt.push(Bt),qe.push(Nt)}else ae(lt,Bt,m)||(lt!==qe&&lt.push(Bt),qe.push(Nt))}return qe}function hu(u,h){return null==(u=f_(u,h=wc(h,u)))||delete u[ei(Zo(h))]}function cp(u,h,m,P){return lp(u,h,m(qo(u,h)),P)}function fu(u,h,m,P){for(var ae=u.length,xe=P?ae:-1;(P?xe--:++xe<ae)&&h(u[xe],xe,u););return m?xs(u,P?0:xe,P?xe+1:ae):xs(u,P?xe+1:0,P?ae:xe)}function h1(u,h){var m=u;return m instanceof ci&&(m=m.value()),ru(h,function(P,ae){return ae.func.apply(ae.thisArg,kr([P],ae.args))},m)}function pu(u,h,m){var P=u.length;if(P<2)return P?bc(u[0]):[];for(var ae=-1,xe=yt(P);++ae<P;)for(var Ve=u[ae],qe=-1;++qe<P;)qe!=ae&&(xe[ae]=mc(xe[ae]||Ve,u[qe],h,m));return bc(Es(xe,1),h,m)}function up(u,h,m){for(var P=-1,ae=u.length,xe=h.length,Ve={};++P<ae;)m(Ve,u[P],P<xe?h[P]:J);return Ve}function vc(u){return wr(u)?u:[]}function i_(u){return"function"==typeof u?u:eo}function wc(u,h){return On(u)?u:Qo(u,h)?[u]:av(Li(u))}var f1=ui;function tl(u,h,m){var P=u.length;return m=m===J?P:m,!h&&m>=P?u:xs(u,h,m)}var p1=Ob||function(u){return Fi.clearTimeout(u)};function dp(u,h){if(h)return u.slice();var m=u.length,P=Ib?Ib(m):new u.constructor(m);return u.copy(P),P}function gu(u){var h=new u.constructor(u.byteLength);return new dd(h).set(new dd(u)),h}function r_(u,h){var m=h?gu(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.length)}function Ec(u,h){if(u!==h){var m=u!==J,P=null===u,ae=u==u,xe=na(u),Ve=h!==J,qe=null===h,lt=h==h,Rt=na(h);if(!qe&&!Rt&&!xe&&u>h||xe&&Ve&&lt&&!qe&&!Rt||P&&Ve&&lt||!m&&lt||!ae)return 1;if(!P&&!xe&&!Rt&&u<h||Rt&&m&&ae&&!P&&!xe||qe&&m&&ae||!Ve&&ae||!lt)return-1}return 0}function Sd(u,h,m,P){for(var ae=-1,xe=u.length,Ve=m.length,qe=-1,lt=h.length,Rt=jr(xe-Ve,0),Nt=yt(lt+Rt),Bt=!P;++qe<lt;)Nt[qe]=h[qe];for(;++ae<Ve;)(Bt||ae<xe)&&(Nt[m[ae]]=u[ae]);for(;Rt--;)Nt[qe++]=u[ae++];return Nt}function Gb(u,h,m,P){for(var ae=-1,xe=u.length,Ve=-1,qe=m.length,lt=-1,Rt=h.length,Nt=jr(xe-qe,0),Bt=yt(Nt+Rt),tn=!P;++ae<Nt;)Bt[ae]=u[ae];for(var bn=ae;++lt<Rt;)Bt[bn+lt]=h[lt];for(;++Ve<qe;)(tn||ae<xe)&&(Bt[bn+m[Ve]]=u[ae++]);return Bt}function Qs(u,h){var m=-1,P=u.length;for(h||(h=yt(P));++m<P;)h[m]=u[m];return h}function xa(u,h,m,P){var ae=!m;m||(m={});for(var xe=-1,Ve=h.length;++xe<Ve;){var qe=h[xe],lt=P?P(m[qe],u[qe],qe,m,u):J;lt===J&&(lt=u[qe]),ae?Ja(m,qe,lt):Za(m,qe,lt)}return m}function Xr(u,h){return function(m,P){var ae=On(m)?Lr:ip,xe=h?h():{};return ae(m,u,Nn(P,2),xe)}}function Pl(u){return ui(function(h,m){var P=-1,ae=m.length,xe=ae>1?m[ae-1]:J,Ve=ae>2?m[2]:J;for(xe=u.length>3&&"function"==typeof xe?(ae--,xe):J,Ve&&zs(m[0],m[1],Ve)&&(xe=ae<3?J:xe,ae=1),h=Gi(h);++P<ae;){var qe=m[P];qe&&u(h,qe,P,xe)}return h})}function nl(u,h){return function(m,P){if(null==m)return m;if(!fo(m))return u(m,P);for(var ae=m.length,xe=h?ae:-1,Ve=Gi(m);(h?xe--:++xe<ae)&&!1!==P(Ve[xe],xe,Ve););return m}}function $b(u){return function(h,m,P){for(var ae=-1,xe=Gi(h),Ve=P(h),qe=Ve.length;qe--;){var lt=Ve[u?qe:++ae];if(!1===m(xe[lt],lt,xe))break}return h}}function hp(u){return function(h){var m=yh(h=Li(h))?Ya(h):J,P=m?m[0]:h.charAt(0),ae=m?tl(m,1).join(""):h.slice(1);return P[u]()+ae}}function Fl(u){return function(h){return ru(J_(W_(h).replace($f,"")),u,"")}}function Cd(u){return function(){var h=arguments;switch(h.length){case 0:return new u;case 1:return new u(h[0]);case 2:return new u(h[0],h[1]);case 3:return new u(h[0],h[1],h[2]);case 4:return new u(h[0],h[1],h[2],h[3]);case 5:return new u(h[0],h[1],h[2],h[3],h[4]);case 6:return new u(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new u(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var m=lu(u.prototype),P=u.apply(m,h);return Er(P)?P:m}}function qb(u){return function(h,m,P){var ae=Gi(h);if(!fo(h)){var xe=Nn(m,3);h=As(h),m=function(qe){return xe(ae[qe],qe,ae)}}var Ve=u(h,m,P);return Ve>-1?ae[xe?h[Ve]:Ve]:J}}function _u(u){return il(function(h){var m=h.length,P=m,ae=Mo.prototype.thru;for(u&&h.reverse();P--;){var xe=h[P];if("function"!=typeof xe)throw new _a(Te);if(ae&&!Ve&&"wrapper"==yp(xe))var Ve=new Mo([],!0)}for(P=Ve?P:m;++P<m;){var qe=yp(xe=h[P]),lt="wrapper"==qe?l_(xe):J;Ve=lt&&bp(lt[0])&&424==lt[1]&&!lt[4].length&&1==lt[9]?Ve[yp(lt[0])].apply(Ve,lt[3]):1==xe.length&&bp(xe)?Ve[qe]():Ve.thru(xe)}return function(){var Rt=arguments,Nt=Rt[0];if(Ve&&1==Rt.length&&On(Nt))return Ve.plant(Nt).value();for(var Bt=0,tn=m?h[Bt].apply(this,Rt):Nt;++Bt<m;)tn=h[Bt].call(this,tn);return tn}})}function Sc(u,h,m,P,ae,xe,Ve,qe,lt,Rt){var Nt=h&q,Bt=1&h,tn=2&h,bn=24&h,kn=512&h,di=tn?J:Cd(u);return function jn(){for(var hi=arguments.length,Si=yt(hi),go=hi;go--;)Si[go]=arguments[go];if(bn)var Hs=Td(jn),ia=RP(Si,Hs);if(P&&(Si=Sd(Si,P,ae,bn)),xe&&(Si=Gb(Si,xe,Ve,bn)),hi-=ia,bn&&hi<Rt){var ki=su(Si,Hs);return Xb(u,h,Sc,jn.placeholder,m,Si,ki,qe,lt,Rt-hi)}var ul=Bt?m:this,Mc=tn?ul[u]:u;return hi=Si.length,qe?Si=A1(Si,qe):kn&&hi>1&&Si.reverse(),Nt&&lt<hi&&(Si.length=lt),this&&this!==Fi&&this instanceof jn&&(Mc=di||Cd(Mc)),Mc.apply(ul,Si)}}function Kb(u,h){return function(m,P){return function(u,h,m,P){return el(u,function(ae,xe,Ve){h(P,m(ae),xe,Ve)}),P}(m,u,h(P),{})}}function s_(u,h){return function(m,P){var ae;if(m===J&&P===J)return h;if(m!==J&&(ae=m),P!==J){if(ae===J)return P;"string"==typeof m||"string"==typeof P?(m=Io(m),P=Io(P)):(m=Hb(m),P=Hb(P)),ae=u(m,P)}return ae}}function fp(u){return il(function(h){return h=Hi(h,Wo(Nn())),ui(function(m){var P=this;return u(h,function(ae){return ts(ae,P,m)})})})}function pp(u,h){var m=(h=h===J?" ":Io(h)).length;if(m<2)return m?ap(h,u):h;var P=ap(h,Ft(u/bh(h)));return yh(h)?tl(Ya(P),0,u).join(""):P.slice(0,u)}function Yb(u){return function(h,m,P){return P&&"number"!=typeof P&&zs(h,m,P)&&(m=P=J),h=ll(h),m===J?(m=h,h=0):m=ll(m),function(u,h,m,P){for(var ae=-1,xe=jr(Ft((h-u)/(m||1)),0),Ve=yt(xe);xe--;)Ve[P?xe:++ae]=u,u+=m;return Ve}(h,m,P=P===J?h<m?1:-1:ll(P),u)}}function gp(u){return function(h,m){return"string"==typeof h&&"string"==typeof m||(h=po(h),m=po(m)),u(h,m)}}function Xb(u,h,m,P,ae,xe,Ve,qe,lt,Rt){var Nt=8&h;h|=Nt?j:64,4&(h&=~(Nt?64:j))||(h&=-4);var di=[u,h,ae,Nt?xe:J,Nt?Ve:J,Nt?J:xe,Nt?J:Ve,qe,lt,Rt],jn=m.apply(J,di);return bp(u)&&ov(jn,di),jn.placeholder=P,jh(jn,u,h)}function Ad(u){var h=Yr[u];return function(m,P){if(m=po(m),(P=null==P?0:ds(Qn(P),292))&&Bm(m)){var ae=(Li(m)+"e").split("e");return+((ae=(Li(h(ae[0]+"e"+(+ae[1]+P)))+"e").split("e"))[0]+"e"+(+ae[1]-P))}return h(m)}}var o_=ba&&1/Om(new ba([,-0]))[1]==ee?function(u){return new ba(u)}:ry;function yu(u){return function(h){var m=Us(h);return m==Ne?Tb(h):m==ft?function(st){var Mt=-1,yt=Array(st.size);return st.forEach(function(an){yt[++Mt]=[an,an]}),yt}(h):function(st,Mt){return Hi(Mt,function(yt){return[yt,st[yt]]})}(h,u(h))}}function Ll(u,h,m,P,ae,xe,Ve,qe){var lt=2&h;if(!lt&&"function"!=typeof u)throw new _a(Te);var Rt=P?P.length:0;if(Rt||(h&=-97,P=ae=J),Ve=Ve===J?Ve:jr(Qn(Ve),0),qe=qe===J?qe:Qn(qe),Rt-=ae?ae.length:0,64&h){var Nt=P,Bt=ae;P=ae=J}var tn=lt?J:l_(u),bn=[u,h,m,P,ae,Nt,Bt,xe,Ve,qe];if(tn&&function(u,h){var m=u[1],P=h[1],ae=m|P;if(!(ae<131||(P==q&&8==m||P==q&&256==m&&u[7].length<=h[8]||384==P&&h[7].length<=h[8]&&8==m)))return u;1&P&&(u[2]=h[2],ae|=1&m?0:4);var qe=h[3];if(qe){var lt=u[3];u[3]=lt?Sd(lt,qe,h[4]):qe,u[4]=lt?su(u[3],L):h[4]}(qe=h[5])&&(u[5]=(lt=u[5])?Gb(lt,qe,h[6]):qe,u[6]=lt?su(u[5],L):h[6]),(qe=h[7])&&(u[7]=qe),P&q&&(u[8]=null==u[8]?h[8]:ds(u[8],h[8])),null==u[9]&&(u[9]=h[9]),u[0]=h[0],u[1]=ae}(bn,tn),u=bn[0],h=bn[1],m=bn[2],P=bn[3],ae=bn[4],!(qe=bn[9]=bn[9]===J?lt?0:u.length:jr(bn[9]-Rt,0))&&24&h&&(h&=-25),h&&1!=h)kn=8==h||16==h?function(u,h,m){var P=Cd(u);return function ae(){for(var xe=arguments.length,Ve=yt(xe),qe=xe,lt=Td(ae);qe--;)Ve[qe]=arguments[qe];var Rt=xe<3&&Ve[0]!==lt&&Ve[xe-1]!==lt?[]:su(Ve,lt);return(xe-=Rt.length)<m?Xb(u,h,Sc,ae.placeholder,J,Ve,Rt,J,J,m-xe):ts(this&&this!==Fi&&this instanceof ae?P:u,this,Ve)}}(u,h,qe):h!=j&&33!=h||ae.length?Sc.apply(J,bn):function(u,h,m,P){var ae=1&h,xe=Cd(u);return function Ve(){for(var qe=-1,lt=arguments.length,Rt=-1,Nt=P.length,Bt=yt(Nt+lt),tn=this&&this!==Fi&&this instanceof Ve?xe:u;++Rt<Nt;)Bt[Rt]=P[Rt];for(;lt--;)Bt[Rt++]=arguments[++qe];return ts(tn,ae?m:this,Bt)}}(u,h,m,P);else var kn=function(u,h,m){var P=1&h,ae=Cd(u);return function xe(){return(this&&this!==Fi&&this instanceof xe?ae:u).apply(P?m:this,arguments)}}(u,h,m);return jh((tn?e_:ov)(kn,bn),u,h)}function Qb(u,h,m,P){return u===J||Mn(u,ou[m])&&!$i.call(P,m)?h:u}function _1(u,h,m,P,ae,xe){return Er(u)&&Er(h)&&(xe.set(h,u),Jm(u,h,J,_1,xe),xe.delete(h)),u}function mp(u){return Rp(u)?J:u}function _p(u,h,m,P,ae,xe){var Ve=1&m,qe=u.length,lt=h.length;if(qe!=lt&&!(Ve&&lt>qe))return!1;var Rt=xe.get(u),Nt=xe.get(h);if(Rt&&Nt)return Rt==h&&Nt==u;var Bt=-1,tn=!0,bn=2&m?new va:J;for(xe.set(u,h),xe.set(h,u);++Bt<qe;){var kn=u[Bt],di=h[Bt];if(P)var jn=Ve?P(di,kn,Bt,h,u,xe):P(kn,di,Bt,u,h,xe);if(jn!==J){if(jn)continue;tn=!1;break}if(bn){if(!Ao(h,function(hi,Si){if(!_h(bn,Si)&&(kn===hi||ae(kn,hi,m,P,xe)))return bn.push(Si)})){tn=!1;break}}else if(kn!==di&&!ae(kn,di,m,P,xe)){tn=!1;break}}return xe.delete(u),xe.delete(h),tn}function il(u){return wp(C1(u,J,Cs),u+"")}function kl(u){return rr(u,As,c_)}function a_(u){return rr(u,Js,ev)}var l_=Ah?function(u){return Ah.get(u)}:ry;function yp(u){for(var h=u.name+"",m=hd[h],P=$i.call(hd,h)?m.length:0;P--;){var ae=m[P],xe=ae.func;if(null==xe||xe==u)return ae.name}return h}function Td(u){return($i.call(Ee,"placeholder")?Ee:u).placeholder}function Nn(){var u=Ee.iteratee||wu;return u=u===wu?l1:u,arguments.length?u(arguments[0],arguments[1]):u}function Vs(u,h){var m=u.__data__;return function(u){var h=typeof u;return"string"==h||"number"==h||"symbol"==h||"boolean"==h?"__proto__"!==u:null===u}(h)?m["string"==typeof h?"string":"hash"]:m.map}function Xo(u){for(var h=As(u),m=h.length;m--;){var P=h[m],ae=u[P];h[m]=[P,ae,S1(ae)]}return h}function xc(u,h){var m=function(st,Mt){return null==st?J:st[Mt]}(u,h);return Zm(m)?m:J}var c_=Br?function(u){return null==u?[]:(u=Gi(u),ga(Br(u),function(h){return Kf.call(u,h)}))}:Tc,ev=Br?function(u){for(var h=[];u;)kr(h,c_(u)),u=ya(u);return h}:Tc,Us=Ss;function nv(u,h,m){for(var P=-1,ae=(h=wc(h,u)).length,xe=!1;++P<ae;){var Ve=ei(h[P]);if(!(xe=null!=u&&m(u,Ve)))break;u=u[Ve]}return xe||++P!=ae?xe:!!(ae=null==u?0:u.length)&&k_(ae)&&Oo(Ve,ae)&&(On(u)||ol(u))}function iv(u){return"function"!=typeof u.constructor||vp(u)?{}:lu(ya(u))}function E1(u){return On(u)||ol(u)||!!(UC&&u&&u[UC])}function Oo(u,h){var m=typeof u;return!!(h=null==h?Se:h)&&("number"==m||"symbol"!=m&&Vi.test(u))&&u>-1&&u%1==0&&u<h}function zs(u,h,m){if(!Er(m))return!1;var P=typeof h;return!!("number"==P?fo(m)&&Oo(h,m.length):"string"==P&&h in m)&&Mn(m[h],u)}function Qo(u,h){if(On(u))return!1;var m=typeof u;return!("number"!=m&&"symbol"!=m&&"boolean"!=m&&null!=u&&!na(u))||ge.test(u)||!ut.test(u)||null!=h&&u in Gi(h)}function bp(u){var h=yp(u),m=Ee[h];if("function"!=typeof m||!(h in ci.prototype))return!1;if(u===m)return!0;var P=l_(m);return!!P&&u===P[0]}(ws&&Us(new ws(new ArrayBuffer(1)))!=bt||uo&&Us(new uo)!=Ne||Qf&&Us(Qf.resolve())!=ue||ba&&Us(new ba)!=ft||To&&Us(new To)!=B)&&(Us=function(u){var h=Ss(u),m=h==he?u.constructor:J,P=m?bu(m):"";if(P)switch(P){case $C:return bt;case jm:return Ne;case Vm:return ue;case Rb:return ft;case Um:return B}return h});var sv=qf?ta:oy;function vp(u){var h=u&&u.constructor;return u===("function"==typeof h&&h.prototype||ou)}function S1(u){return u==u&&!Er(u)}function x1(u,h){return function(m){return null!=m&&m[u]===h&&(h!==J||u in Gi(m))}}function C1(u,h,m){return h=jr(h===J?u.length-1:h,0),function(){for(var P=arguments,ae=-1,xe=jr(P.length-h,0),Ve=yt(xe);++ae<xe;)Ve[ae]=P[h+ae];ae=-1;for(var qe=yt(h+1);++ae<h;)qe[ae]=P[ae];return qe[h]=m(Ve),ts(u,this,qe)}}function f_(u,h){return h.length<2?u:qo(u,xs(h,0,-1))}function A1(u,h){for(var m=u.length,P=ds(h.length,m),ae=Qs(u);P--;){var xe=h[P];u[P]=Oo(xe,m)?ae[xe]:J}return u}function p_(u,h){if(("constructor"!==h||"function"!=typeof u[h])&&"__proto__"!=h)return u[h]}var ov=g_(e_),Bh=HC||function(u,h){return Fi.setTimeout(u,h)},wp=g_(Do);function jh(u,h,m){var P=h+"";return wp(u,function(u,h){var m=h.length;if(!m)return u;var P=m-1;return h[P]=(m>1?"& ":"")+h[P],h=h.join(m>2?", ":" "),u.replace(xt,"{\n/* [wrapped with "+h+"] */\n")}(P,function(u,h){return ks(rt,function(m){var P="_."+m[0];h&m[1]&&!Il(u,P)&&u.push(P)}),u.sort()}(function(u){var h=u.match(Tt);return h?h[1].split(qt):[]}(P),m)))}function g_(u){var h=0,m=0;return function(){var P=zP(),ae=16-(P-m);if(m=P,ae>0){if(++h>=800)return arguments[0]}else h=0;return u.apply(J,arguments)}}function Md(u,h){var m=-1,P=u.length,ae=P-1;for(h=h===J?P:h;++m<h;){var xe=Nl(m,ae),Ve=u[xe];u[xe]=u[m],u[m]=Ve}return u.length=h,u}var h,m,av=(h=Gh(function(u){var h=[];return 46===u.charCodeAt(0)&&h.push(""),u.replace(be,function(m,P,ae,xe){h.push(ae?xe.replace(Rn,"$1"):P||m)}),h},function(P){return 500===m.size&&m.clear(),P}),m=h.cache,h);function ei(u){if("string"==typeof u||na(u))return u;var h=u+"";return"0"==h&&1/u==-ee?"-0":h}function bu(u){if(null!=u){try{return vr.call(u)}catch(h){}try{return u+""}catch(h){}}return""}function Ep(u){if(u instanceof ci)return u.clone();var h=new Mo(u.__wrapped__,u.__chain__);return h.__actions__=Qs(u.__actions__),h.__index__=u.__index__,h.__values__=u.__values__,h}var I1=ui(function(u,h){return wr(u)?mc(u,Es(h,1,wr,!0)):[]}),O1=ui(function(u,h){var m=Zo(h);return wr(m)&&(m=J),wr(u)?mc(u,Es(h,1,wr,!0),Nn(m,2)):[]}),R1=ui(function(u,h){var m=Zo(h);return wr(m)&&(m=J),wr(u)?mc(u,Es(h,1,wr,!0),J,m):[]});function __(u,h,m){var P=null==u?0:u.length;if(!P)return-1;var ae=null==m?0:Qn(m);return ae<0&&(ae=jr(P+ae,0)),ad(u,Nn(h,3),ae)}function y_(u,h,m){var P=null==u?0:u.length;if(!P)return-1;var ae=P-1;return m!==J&&(ae=Qn(m),ae=m<0?jr(P+ae,0):ds(ae,P-1)),ad(u,Nn(h,3),ae,!0)}function Cs(u){return null!=u&&u.length?Es(u,1):[]}function cv(u){return u&&u.length?u[0]:J}var dv=ui(function(u){var h=Hi(u,vc);return h.length&&h[0]===u[0]?uu(h):[]}),F1=ui(function(u){var h=Zo(u),m=Hi(u,vc);return h===Zo(m)?h=J:m.pop(),m.length&&m[0]===u[0]?uu(m,Nn(h,2)):[]}),hv=ui(function(u){var h=Zo(u),m=Hi(u,vc);return(h="function"==typeof h?h:J)&&m.pop(),m.length&&m[0]===u[0]?uu(m,J,h):[]});function Zo(u){var h=null==u?0:u.length;return h?u[h-1]:J}var v_=ui(w_);function w_(u,h){return u&&u.length&&h&&h.length?Yo(u,h):u}var pv=il(function(u,h){var m=null==u?0:u.length,P=qm(u,h);return Fh(u,Hi(h,function(ae){return Oo(ae,m)?+ae:ae}).sort(Ec)),P});function E_(u){return null==u?u:Xf.call(u)}var _v=ui(function(u){return bc(Es(u,1,wr,!0))}),q1=ui(function(u){var h=Zo(u);return wr(h)&&(h=J),bc(Es(u,1,wr,!0),Nn(h,2))}),K1=ui(function(u){var h=Zo(u);return h="function"==typeof h?h:J,bc(Es(u,1,wr,!0),J,h)});function yv(u){if(!u||!u.length)return[];var h=0;return u=ga(u,function(m){if(wr(m))return h=jr(m.length,h),!0}),cd(h,function(m){return Hi(u,Mm(m))})}function X1(u,h){if(!u||!u.length)return[];var m=yv(u);return null==h?m:Hi(m,function(P){return ts(h,J,P)})}var bv=ui(function(u,h){return wr(u)?mc(u,h):[]}),aF=ui(function(u){return pu(ga(u,wr))}),Ro=ui(function(u){var h=Zo(u);return wr(h)&&(h=J),pu(ga(u,wr),Nn(h,2))}),S_=ui(function(u){var h=Zo(u);return h="function"==typeof h?h:J,pu(ga(u,wr),J,h)}),x_=ui(yv),zh=ui(function(u){var h=u.length,m=h>1?u[h-1]:J;return m="function"==typeof m?(u.pop(),m):J,X1(u,m)});function C_(u){var h=Ee(u);return h.__chain__=!0,h}function Id(u,h){return h(u)}var A_=il(function(u){var h=u.length,m=h?u[0]:0,P=this.__wrapped__,ae=function(xe){return qm(xe,u)};return!(h>1||this.__actions__.length)&&P instanceof ci&&Oo(m)?((P=P.slice(m,+m+(h?1:0))).__actions__.push({func:Id,args:[ae],thisArg:J}),new Mo(P,this.__chain__).thru(function(xe){return h&&!xe.length&&xe.push(J),xe})):this.thru(ae)}),J1=Xr(function(u,h,m){$i.call(u,m)?++u[m]:Ja(u,m,1)}),nA=qb(__),iA=qb(y_);function I_(u,h){return(On(u)?ks:_c)(u,Nn(h,3))}function Cp(u,h){return(On(u)?sd:Ym)(u,Nn(h,3))}var sA=Xr(function(u,h,m){$i.call(u,m)?u[m].push(h):Ja(u,m,[h])}),Cv=ui(function(u,h,m){var P=-1,ae="function"==typeof h,xe=fo(u)?yt(u.length):[];return _c(u,function(Ve){xe[++P]=ae?ts(h,Ve,m):Sa(Ve,h,m)}),xe}),Av=Xr(function(u,h,m){Ja(u,m,h)});function sl(u,h){return(On(u)?Hi:c1)(u,Nn(h,3))}var Mv=Xr(function(u,h,m){u[m?0:1].push(h)},function(){return[[],[]]}),Tp=ui(function(u,h){if(null==u)return[];var m=h.length;return m>1&&zs(u,h[0],h[1])?h=[]:m>2&&zs(h[0],h[1],h[2])&&(h=[h[0]]),Ph(u,Es(h,1),[])}),vu=zC||function(){return Fi.Date.now()};function Mp(u,h,m){return h=m?J:h,Ll(u,q,J,J,J,J,h=u&&null==h?u.length:h)}function R_(u,h){var m;if("function"!=typeof h)throw new _a(Te);return u=Qn(u),function(){return--u>0&&(m=h.apply(this,arguments)),u<=1&&(h=J),m}}var Hh=ui(function(u,h,m){var P=1;if(m.length){var ae=su(m,Td(Hh));P|=j}return Ll(u,P,h,m,ae)}),Rd=ui(function(u,h,m){var P=3;if(m.length){var ae=su(m,Td(Rd));P|=j}return Ll(h,P,u,m,ae)});function Fv(u,h,m){var P,ae,xe,Ve,qe,lt,Rt=0,Nt=!1,Bt=!1,tn=!0;if("function"!=typeof u)throw new _a(Te);function bn(ki){var ul=P,Mc=ae;return P=ae=J,Rt=ki,Ve=u.apply(Mc,ul)}function kn(ki){return Rt=ki,qe=Bh(hi,h),Nt?bn(ki):Ve}function jn(ki){var ul=ki-lt;return lt===J||ul>=h||ul<0||Bt&&ki-Rt>=xe}function hi(){var ki=vu();if(jn(ki))return Si(ki);qe=Bh(hi,function(ki){var fT=h-(ki-lt);return Bt?ds(fT,xe-(ki-Rt)):fT}(ki))}function Si(ki){return qe=J,tn&&P?bn(ki):(P=ae=J,Ve)}function ia(){var ki=vu(),ul=jn(ki);if(P=arguments,ae=this,lt=ki,ul){if(qe===J)return kn(lt);if(Bt)return p1(qe),qe=Bh(hi,h),bn(lt)}return qe===J&&(qe=Bh(hi,h)),Ve}return h=po(h)||0,Er(m)&&(Nt=!!m.leading,xe=(Bt="maxWait"in m)?jr(po(m.maxWait)||0,h):xe,tn="trailing"in m?!!m.trailing:tn),ia.cancel=function(){qe!==J&&p1(qe),Rt=0,P=lt=ae=qe=J},ia.flush=function(){return qe===J?Ve:Si(vu())},ia}var cA=ui(function(u,h){return Oh(u,1,h)}),Lv=ui(function(u,h,m){return Oh(u,po(h)||0,m)});function Gh(u,h){if("function"!=typeof u||null!=h&&"function"!=typeof h)throw new _a(Te);var m=function(){var P=arguments,ae=h?h.apply(this,P):P[0],xe=m.cache;if(xe.has(ae))return xe.get(ae);var Ve=u.apply(this,P);return m.cache=xe.set(ae,Ve)||xe,Ve};return m.cache=new(Gh.Cache||Qa),m}function F_(u){if("function"!=typeof u)throw new _a(Te);return function(){var h=arguments;switch(h.length){case 0:return!u.call(this);case 1:return!u.call(this,h[0]);case 2:return!u.call(this,h[0],h[1]);case 3:return!u.call(this,h[0],h[1],h[2])}return!u.apply(this,h)}}Gh.Cache=Qa;var uA=f1(function(u,h){var m=(h=1==h.length&&On(h[0])?Hi(h[0],Wo(Nn())):Hi(Es(h,1),Wo(Nn()))).length;return ui(function(P){for(var ae=-1,xe=ds(P.length,m);++ae<xe;)P[ae]=h[ae].call(this,P[ae]);return ts(u,this,P)})}),Dp=ui(function(u,h){var m=su(h,Td(Dp));return Ll(u,j,J,h,m)}),Bv=ui(function(u,h){var m=su(h,Td(Bv));return Ll(u,64,J,h,m)}),dA=il(function(u,h){return Ll(u,256,J,J,J,h)});function Mn(u,h){return u===h||u!=u&&h!=h}var ln=gp(Ea),Uv=gp(function(u,h){return u>=h}),ol=s1(function(){return arguments}())?s1:function(u){return Sr(u)&&$i.call(u,"callee")&&!Kf.call(u,"callee")},On=yt.isArray,zv=nn?Wo(nn):function(u){return Sr(u)&&Ss(u)==Qe};function fo(u){return null!=u&&k_(u.length)&&!ta(u)}function wr(u){return Sr(u)&&fo(u)}var al=ns||oy,Hv=li?Wo(li):function(u){return Sr(u)&&Ss(u)==Fe};function Aa(u){if(!Sr(u))return!1;var h=Ss(u);return h==Ce||"[object DOMException]"==h||"string"==typeof u.message&&"string"==typeof u.name&&!Rp(u)}function ta(u){if(!Er(u))return!1;var h=Ss(u);return h==Be||h==$e||"[object AsyncFunction]"==h||"[object Proxy]"==h}function Op(u){return"number"==typeof u&&u==Qn(u)}function k_(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=Se}function Er(u){var h=typeof u;return null!=u&&("object"==h||"function"==h)}function Sr(u){return null!=u&&"object"==typeof u}var vA=lr?Wo(lr):function(u){return Sr(u)&&Us(u)==Ne};function SA(u){return"number"==typeof u||Sr(u)&&Ss(u)==G}function Rp(u){if(!Sr(u)||Ss(u)!=he)return!1;var h=ya(u);if(null===h)return!0;var m=$i.call(h,"constructor")&&h.constructor;return"function"==typeof m&&m instanceof m&&vr.call(m)==VC}var qv=co?Wo(co):function(u){return Sr(u)&&Ss(u)==gt},xA=hc?Wo(hc):function(u){return Sr(u)&&Us(u)==ft};function j_(u){return"string"==typeof u||!On(u)&&Sr(u)&&Ss(u)==ve}function na(u){return"symbol"==typeof u||Sr(u)&&Ss(u)==k}var $h=es?Wo(es):function(u){return Sr(u)&&k_(u.length)&&!!Sn[Ss(u)]},Cc=gp(Vb),V_=gp(function(u,h){return u<=h});function Kv(u){if(!u)return[];if(fo(u))return j_(u)?Ya(u):Qs(u);if(Eh&&u[Eh])return function(st){for(var Mt,yt=[];!(Mt=st.next()).done;)yt.push(Mt.value);return yt}(u[Eh]());var h=Us(u);return(h==Ne?Tb:h==ft?Om:kd)(u)}function ll(u){return u?(u=po(u))===ee||u===-ee?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Qn(u){var h=ll(u),m=h%1;return h==h?m?h-m:h:0}function U_(u){return u?cu(Qn(u),0,_e):0}function po(u){if("number"==typeof u)return u;if(na(u))return NaN;if(Er(u)){var h="function"==typeof u.valueOf?u.valueOf():u;u=Er(h)?h+"":h}if("string"!=typeof u)return 0===u?u:+u;u=Ab(u);var m=er.test(u);return m||Yn.test(u)?Cb(u.slice(2),m?2:8):En.test(u)?NaN:+u}function Yv(u){return xa(u,Js(u))}function Li(u){return null==u?"":Io(u)}var CA=Pl(function(u,h){if(vp(h)||fo(h))xa(h,As(h),u);else for(var m in h)$i.call(h,m)&&Za(u,m,h[m])}),AA=Pl(function(u,h){xa(h,Js(h),u)}),Nd=Pl(function(u,h,m,P){xa(h,Js(h),u,P)}),TA=Pl(function(u,h,m,P){xa(h,As(h),u,P)}),Xv=il(qm),DA=ui(function(u,h){u=Gi(u);var m=-1,P=h.length,ae=P>2?h[2]:J;for(ae&&zs(h[0],h[1],ae)&&(P=1);++m<P;)for(var xe=h[m],Ve=Js(xe),qe=-1,lt=Ve.length;++qe<lt;){var Rt=Ve[qe],Nt=u[Rt];(Nt===J||Mn(Nt,ou[Rt])&&!$i.call(u,Rt))&&(u[Rt]=xe[Rt])}return u}),Wh=ui(function(u){return u.push(J,_1),ts(nw,J,u)});function Kh(u,h,m){var P=null==u?J:qo(u,h);return P===J?m:P}function Np(u,h){return null!=u&&nv(u,h,bd)}var Pp=Kb(function(u,h,m){null!=h&&"function"!=typeof h.toString&&(h=Ys.call(h)),u[h]=m},ty(eo)),OA=Kb(function(u,h,m){null!=h&&"function"!=typeof h.toString&&(h=Ys.call(h)),$i.call(u,h)?u[h].push(m):u[h]=[m]},Nn),Jv=ui(Sa);function As(u){return fo(u)?Ih(u):jb(u)}function Js(u){return fo(u)?Ih(u,!0):function(u){if(!Er(u))return function(u){var h=[];if(null!=u)for(var m in Gi(u))h.push(m);return h}(u);var h=vp(u),m=[];for(var P in u)"constructor"==P&&(h||!$i.call(u,P))||m.push(P);return m}(u)}var tw=Pl(function(u,h,m){Jm(u,h,m)}),nw=Pl(function(u,h,m,P){Jm(u,h,m,P)}),NA=il(function(u,h){var m={};if(null==u)return m;var P=!1;h=Hi(h,function(xe){return xe=wc(xe,u),P||(P=xe.length>1),xe}),xa(u,a_(u),m),P&&(m=js(m,7,mp));for(var ae=h.length;ae--;)hu(m,h[ae]);return m}),PA=il(function(u,h){return null==u?{}:function(u,h){return Ub(u,h,function(m,P){return Np(u,P)})}(u,h)});function iw(u,h){if(null==u)return{};var m=Hi(a_(u),function(P){return[P]});return h=Nn(h),Ub(u,m,function(P,ae){return h(P,ae[0])})}var FA=yu(As),sw=yu(Js);function kd(u){return null==u?[]:Im(u,As(u))}var VA=Fl(function(u,h,m){return h=h.toLowerCase(),u+(m?$_(h):h)});function $_(u){return Lp(Li(u).toLowerCase())}function W_(u){return(u=Li(u))&&u.replace(ha,NP).replace(Am,"")}var zA=Fl(function(u,h,m){return u+(m?"-":"")+h.toLowerCase()}),HA=Fl(function(u,h,m){return u+(m?" ":"")+h.toLowerCase()}),yF=hp("toLowerCase"),KA=Fl(function(u,h,m){return u+(m?"_":"")+h.toLowerCase()}),Y_=Fl(function(u,h,m){return u+(m?" ":"")+Lp(h)}),dw=Fl(function(u,h,m){return u+(m?" ":"")+h.toUpperCase()}),Lp=hp("toUpperCase");function J_(u,h,m){return u=Li(u),(h=m?J:h)===J?function(st){return Ml.test(st)}(u)?function(st){return st.match(wb)||[]}(u):function(st){return st.match(Un)||[]}(u):u.match(h)||[]}var ey=ui(function(u,h){try{return ts(u,J,h)}catch(m){return Aa(m)?m:new Tn(m)}}),hw=il(function(u,h){return ks(h,function(m){m=ei(m),Ja(u,m,Hh(u[m],u))}),u});function ty(u){return function(){return u}}var vF=_u(),Bd=_u(!0);function eo(u){return u}function wu(u){return l1("function"==typeof u?u:js(u,1))}var ny=ui(function(u,h){return function(m){return Sa(m,u,h)}}),fw=ui(function(u,h){return function(m){return Sa(u,m,h)}});function iy(u,h,m){var P=As(h),ae=Nh(h,P);null==m&&(!Er(h)||!ae.length&&P.length)&&(m=h,h=u,u=this,ae=Nh(h,As(h)));var xe=!(Er(m)&&"chain"in m&&!m.chain),Ve=ta(u);return ks(ae,function(qe){var lt=h[qe];u[qe]=lt,Ve&&(u.prototype[qe]=function(){var Rt=this.__chain__;if(xe||Rt){var Nt=u(this.__wrapped__),Bt=Nt.__actions__=Qs(this.__actions__);return Bt.push({func:lt,args:arguments,thisArg:u}),Nt.__chain__=Rt,Nt}return lt.apply(u,kr([this.value()],arguments))})}),u}function ry(){}var tT=fp(Hi),nT=fp(Jn),gw=fp(Ao);function Eu(u){return Qo(u)?Mm(ei(u)):function(u){return function(h){return qo(h,u)}}(u)}var iT=Yb(),rT=Yb(!0);function Tc(){return[]}function oy(){return!1}var $n=s_(function(u,h){return u+h},0),ay=Ad("ceil"),EF=s_(function(u,h){return u/h},1),Vl=Ad("floor"),bw=s_(function(u,h){return u*h},1),vw=Ad("round"),ww=s_(function(u,h){return u-h},0);return Ee.after=function(u,h){if("function"!=typeof h)throw new _a(Te);return u=Qn(u),function(){if(--u<1)return h.apply(this,arguments)}},Ee.ary=Mp,Ee.assign=CA,Ee.assignIn=AA,Ee.assignInWith=Nd,Ee.assignWith=TA,Ee.at=Xv,Ee.before=R_,Ee.bind=Hh,Ee.bindAll=hw,Ee.bindKey=Rd,Ee.castArray=function(){if(!arguments.length)return[];var u=arguments[0];return On(u)?u:[u]},Ee.chain=C_,Ee.chunk=function(u,h,m){h=(m?zs(u,h,m):h===J)?1:jr(Qn(h),0);var P=null==u?0:u.length;if(!P||h<1)return[];for(var ae=0,xe=0,Ve=yt(Ft(P/h));ae<P;)Ve[xe++]=xs(u,ae,ae+=h);return Ve},Ee.compact=function(u){for(var h=-1,m=null==u?0:u.length,P=0,ae=[];++h<m;){var xe=u[h];xe&&(ae[P++]=xe)}return ae},Ee.concat=function(){var u=arguments.length;if(!u)return[];for(var h=yt(u-1),m=arguments[0],P=u;P--;)h[P-1]=arguments[P];return kr(On(m)?Qs(m):[m],Es(h,1))},Ee.cond=function(u){var h=null==u?0:u.length,m=Nn();return u=h?Hi(u,function(P){if("function"!=typeof P[1])throw new _a(Te);return[m(P[0]),P[1]]}):[],ui(function(P){for(var ae=-1;++ae<h;){var xe=u[ae];if(ts(xe[0],this,P))return ts(xe[1],this,P)}})},Ee.conforms=function(u){return function(u){var h=As(u);return function(m){return rp(m,u,h)}}(js(u,1))},Ee.constant=ty,Ee.countBy=J1,Ee.create=function(u,h){var m=lu(u);return null==h?m:r1(m,h)},Ee.curry=function Pv(u,h,m){var P=Ll(u,8,J,J,J,J,J,h=m?J:h);return P.placeholder=Pv.placeholder,P},Ee.curryRight=function N_(u,h,m){var P=Ll(u,16,J,J,J,J,J,h=m?J:h);return P.placeholder=N_.placeholder,P},Ee.debounce=Fv,Ee.defaults=DA,Ee.defaultsDeep=Wh,Ee.defer=cA,Ee.delay=Lv,Ee.difference=I1,Ee.differenceBy=O1,Ee.differenceWith=R1,Ee.drop=function(u,h,m){var P=null==u?0:u.length;return P?xs(u,(h=m||h===J?1:Qn(h))<0?0:h,P):[]},Ee.dropRight=function(u,h,m){var P=null==u?0:u.length;return P?xs(u,0,(h=P-(h=m||h===J?1:Qn(h)))<0?0:h):[]},Ee.dropRightWhile=function(u,h){return u&&u.length?fu(u,Nn(h,3),!0,!0):[]},Ee.dropWhile=function(u,h){return u&&u.length?fu(u,Nn(h,3),!0):[]},Ee.fill=function(u,h,m,P){var ae=null==u?0:u.length;return ae?(m&&"number"!=typeof m&&zs(u,h,m)&&(m=0,P=ae),function(u,h,m,P){var ae=u.length;for((m=Qn(m))<0&&(m=-m>ae?0:ae+m),(P=P===J||P>ae?ae:Qn(P))<0&&(P+=ae),P=m>P?0:U_(P);m<P;)u[m++]=h;return u}(u,h,m,P)):[]},Ee.filter=function(u,h){return(On(u)?ga:Bb)(u,Nn(h,3))},Ee.flatMap=function(u,h){return Es(sl(u,h),1)},Ee.flatMapDeep=function(u,h){return Es(sl(u,h),ee)},Ee.flatMapDepth=function(u,h,m){return m=m===J?1:Qn(m),Es(sl(u,h),m)},Ee.flatten=Cs,Ee.flattenDeep=function(u){return null!=u&&u.length?Es(u,ee):[]},Ee.flattenDepth=function(u,h){return null!=u&&u.length?Es(u,h=h===J?1:Qn(h)):[]},Ee.flip=function(u){return Ll(u,512)},Ee.flow=vF,Ee.flowRight=Bd,Ee.fromPairs=function(u){for(var h=-1,m=null==u?0:u.length,P={};++h<m;){var ae=u[h];P[ae[0]]=ae[1]}return P},Ee.functions=function(u){return null==u?[]:Nh(u,As(u))},Ee.functionsIn=function(u){return null==u?[]:Nh(u,Js(u))},Ee.groupBy=sA,Ee.initial=function(u){return null!=u&&u.length?xs(u,0,-1):[]},Ee.intersection=dv,Ee.intersectionBy=F1,Ee.intersectionWith=hv,Ee.invert=Pp,Ee.invertBy=OA,Ee.invokeMap=Cv,Ee.iteratee=wu,Ee.keyBy=Av,Ee.keys=As,Ee.keysIn=Js,Ee.map=sl,Ee.mapKeys=function(u,h){var m={};return h=Nn(h,3),el(u,function(P,ae,xe){Ja(m,h(P,ae,xe),P)}),m},Ee.mapValues=function(u,h){var m={};return h=Nn(h,3),el(u,function(P,ae,xe){Ja(m,ae,h(P,ae,xe))}),m},Ee.matches=function(u){return u1(js(u,1))},Ee.matchesProperty=function(u,h){return wd(u,js(h,1))},Ee.memoize=Gh,Ee.merge=tw,Ee.mergeWith=nw,Ee.method=ny,Ee.methodOf=fw,Ee.mixin=iy,Ee.negate=F_,Ee.nthArg=function(u){return u=Qn(u),ui(function(h){return du(h,u)})},Ee.omit=NA,Ee.omitBy=function(u,h){return iw(u,F_(Nn(h)))},Ee.once=function(u){return R_(2,u)},Ee.orderBy=function(u,h,m,P){return null==u?[]:(On(h)||(h=null==h?[]:[h]),On(m=P?J:m)||(m=null==m?[]:[m]),Ph(u,h,m))},Ee.over=tT,Ee.overArgs=uA,Ee.overEvery=nT,Ee.overSome=gw,Ee.partial=Dp,Ee.partialRight=Bv,Ee.partition=Mv,Ee.pick=PA,Ee.pickBy=iw,Ee.property=Eu,Ee.propertyOf=function(u){return function(h){return null==u?J:qo(u,h)}},Ee.pull=v_,Ee.pullAll=w_,Ee.pullAllBy=function(u,h,m){return u&&u.length&&h&&h.length?Yo(u,h,Nn(m,2)):u},Ee.pullAllWith=function(u,h,m){return u&&u.length&&h&&h.length?Yo(u,h,J,m):u},Ee.pullAt=pv,Ee.range=iT,Ee.rangeRight=rT,Ee.rearg=dA,Ee.reject=function(u,h){return(On(u)?ga:Bb)(u,F_(Nn(h,3)))},Ee.remove=function(u,h){var m=[];if(!u||!u.length)return m;var P=-1,ae=[],xe=u.length;for(h=Nn(h,3);++P<xe;){var Ve=u[P];h(Ve,P,u)&&(m.push(Ve),ae.push(P))}return Fh(u,ae),m},Ee.rest=function(u,h){if("function"!=typeof u)throw new _a(Te);return ui(u,h=h===J?h:Qn(h))},Ee.reverse=E_,Ee.sampleSize=function(u,h,m){return h=(m?zs(u,h,m):h===J)?1:Qn(h),(On(u)?Pb:QP)(u,h)},Ee.set=function(u,h,m){return null==u?u:lp(u,h,m)},Ee.setWith=function(u,h,m,P){return P="function"==typeof P?P:J,null==u?u:lp(u,h,m,P)},Ee.shuffle=function(u){return(On(u)?pd:t_)(u)},Ee.slice=function(u,h,m){var P=null==u?0:u.length;return P?(m&&"number"!=typeof m&&zs(u,h,m)?(h=0,m=P):(h=null==h?0:Qn(h),m=m===J?P:Qn(m)),xs(u,h,m)):[]},Ee.sortBy=Tp,Ee.sortedUniq=function(u){return u&&u.length?zb(u):[]},Ee.sortedUniqBy=function(u,h){return u&&u.length?zb(u,Nn(h,2)):[]},Ee.split=function(u,h,m){return m&&"number"!=typeof m&&zs(u,h,m)&&(h=m=J),(m=m===J?_e:m>>>0)?(u=Li(u))&&("string"==typeof h||null!=h&&!qv(h))&&!(h=Io(h))&&yh(u)?tl(Ya(u),0,m):u.split(h,m):[]},Ee.spread=function(u,h){if("function"!=typeof u)throw new _a(Te);return h=null==h?0:jr(Qn(h),0),ui(function(m){var P=m[h],ae=tl(m,0,h);return P&&kr(ae,P),ts(u,this,ae)})},Ee.tail=function(u){var h=null==u?0:u.length;return h?xs(u,1,h):[]},Ee.take=function(u,h,m){return u&&u.length?xs(u,0,(h=m||h===J?1:Qn(h))<0?0:h):[]},Ee.takeRight=function(u,h,m){var P=null==u?0:u.length;return P?xs(u,(h=P-(h=m||h===J?1:Qn(h)))<0?0:h,P):[]},Ee.takeRightWhile=function(u,h){return u&&u.length?fu(u,Nn(h,3),!1,!0):[]},Ee.takeWhile=function(u,h){return u&&u.length?fu(u,Nn(h,3)):[]},Ee.tap=function(u,h){return h(u),u},Ee.throttle=function(u,h,m){var P=!0,ae=!0;if("function"!=typeof u)throw new _a(Te);return Er(m)&&(P="leading"in m?!!m.leading:P,ae="trailing"in m?!!m.trailing:ae),Fv(u,h,{leading:P,maxWait:h,trailing:ae})},Ee.thru=Id,Ee.toArray=Kv,Ee.toPairs=FA,Ee.toPairsIn=sw,Ee.toPath=function(u){return On(u)?Hi(u,ei):na(u)?[u]:Qs(av(Li(u)))},Ee.toPlainObject=Yv,Ee.transform=function(u,h,m){var P=On(u),ae=P||al(u)||$h(u);if(h=Nn(h,4),null==m){var xe=u&&u.constructor;m=ae?P?new xe:[]:Er(u)&&ta(xe)?lu(ya(u)):{}}return(ae?ks:el)(u,function(Ve,qe,lt){return h(m,Ve,qe,lt)}),m},Ee.unary=function(u){return Mp(u,1)},Ee.union=_v,Ee.unionBy=q1,Ee.unionWith=K1,Ee.uniq=function(u){return u&&u.length?bc(u):[]},Ee.uniqBy=function(u,h){return u&&u.length?bc(u,Nn(h,2)):[]},Ee.uniqWith=function(u,h){return h="function"==typeof h?h:J,u&&u.length?bc(u,J,h):[]},Ee.unset=function(u,h){return null==u||hu(u,h)},Ee.unzip=yv,Ee.unzipWith=X1,Ee.update=function(u,h,m){return null==u?u:cp(u,h,i_(m))},Ee.updateWith=function(u,h,m,P){return P="function"==typeof P?P:J,null==u?u:cp(u,h,i_(m),P)},Ee.values=kd,Ee.valuesIn=function(u){return null==u?[]:Im(u,Js(u))},Ee.without=bv,Ee.words=J_,Ee.wrap=function(u,h){return Dp(i_(h),u)},Ee.xor=aF,Ee.xorBy=Ro,Ee.xorWith=S_,Ee.zip=x_,Ee.zipObject=function(u,h){return up(u||[],h||[],Za)},Ee.zipObjectDeep=function(u,h){return up(u||[],h||[],lp)},Ee.zipWith=zh,Ee.entries=FA,Ee.entriesIn=sw,Ee.extend=AA,Ee.extendWith=Nd,iy(Ee,Ee),Ee.add=$n,Ee.attempt=ey,Ee.camelCase=VA,Ee.capitalize=$_,Ee.ceil=ay,Ee.clamp=function(u,h,m){return m===J&&(m=h,h=J),m!==J&&(m=(m=po(m))==m?m:0),h!==J&&(h=(h=po(h))==h?h:0),cu(po(u),h,m)},Ee.clone=function(u){return js(u,4)},Ee.cloneDeep=function(u){return js(u,5)},Ee.cloneDeepWith=function(u,h){return js(u,5,h="function"==typeof h?h:J)},Ee.cloneWith=function(u,h){return js(u,4,h="function"==typeof h?h:J)},Ee.conformsTo=function(u,h){return null==h||rp(u,h,As(h))},Ee.deburr=W_,Ee.defaultTo=function(u,h){return null==u||u!=u?h:u},Ee.divide=EF,Ee.endsWith=function(u,h,m){u=Li(u),h=Io(h);var P=u.length,ae=m=m===J?P:cu(Qn(m),0,P);return(m-=h.length)>=0&&u.slice(m,ae)==h},Ee.eq=Mn,Ee.escape=function(u){return(u=Li(u))&&Jt.test(u)?u.replace(da,PP):u},Ee.escapeRegExp=function(u){return(u=Li(u))&&ct.test(u)?u.replace(Le,"\\$&"):u},Ee.every=function(u,h,m){var P=On(u)?Jn:Lb;return m&&zs(u,h,m)&&(h=J),P(u,Nn(h,3))},Ee.find=nA,Ee.findIndex=__,Ee.findKey=function(u,h){return mh(u,Nn(h,3),el)},Ee.findLast=iA,Ee.findLastIndex=y_,Ee.findLastKey=function(u,h){return mh(u,Nn(h,3),sp)},Ee.floor=Vl,Ee.forEach=I_,Ee.forEachRight=Cp,Ee.forIn=function(u,h){return null==u?u:md(u,Nn(h,3),Js)},Ee.forInRight=function(u,h){return null==u?u:_d(u,Nn(h,3),Js)},Ee.forOwn=function(u,h){return u&&el(u,Nn(h,3))},Ee.forOwnRight=function(u,h){return u&&sp(u,Nn(h,3))},Ee.get=Kh,Ee.gt=ln,Ee.gte=Uv,Ee.has=function(u,h){return null!=u&&nv(u,h,yd)},Ee.hasIn=Np,Ee.head=cv,Ee.identity=eo,Ee.includes=function(u,h,m,P){u=fo(u)?u:kd(u),m=m&&!P?Qn(m):0;var ae=u.length;return m<0&&(m=jr(ae+m,0)),j_(u)?m<=ae&&u.indexOf(h,m)>-1:!!ae&&Ka(u,h,m)>-1},Ee.indexOf=function(u,h,m){var P=null==u?0:u.length;if(!P)return-1;var ae=null==m?0:Qn(m);return ae<0&&(ae=jr(P+ae,0)),Ka(u,h,ae)},Ee.inRange=function(u,h,m){return h=ll(h),m===J?(m=h,h=0):m=ll(m),function(u,h,m){return u>=ds(h,m)&&u<jr(h,m)}(u=po(u),h,m)},Ee.invoke=Jv,Ee.isArguments=ol,Ee.isArray=On,Ee.isArrayBuffer=zv,Ee.isArrayLike=fo,Ee.isArrayLikeObject=wr,Ee.isBoolean=function(u){return!0===u||!1===u||Sr(u)&&Ss(u)==je},Ee.isBuffer=al,Ee.isDate=Hv,Ee.isElement=function(u){return Sr(u)&&1===u.nodeType&&!Rp(u)},Ee.isEmpty=function(u){if(null==u)return!0;if(fo(u)&&(On(u)||"string"==typeof u||"function"==typeof u.splice||al(u)||$h(u)||ol(u)))return!u.length;var h=Us(u);if(h==Ne||h==ft)return!u.size;if(vp(u))return!jb(u).length;for(var m in u)if($i.call(u,m))return!1;return!0},Ee.isEqual=function(u,h){return op(u,h)},Ee.isEqualWith=function(u,h,m){var P=(m="function"==typeof m?m:J)?m(u,h):J;return P===J?op(u,h,J,m):!!P},Ee.isError=Aa,Ee.isFinite=function(u){return"number"==typeof u&&Bm(u)},Ee.isFunction=ta,Ee.isInteger=Op,Ee.isLength=k_,Ee.isMap=vA,Ee.isMatch=function(u,h){return u===h||Qm(u,h,Xo(h))},Ee.isMatchWith=function(u,h,m){return m="function"==typeof m?m:J,Qm(u,h,Xo(h),m)},Ee.isNaN=function(u){return SA(u)&&u!=+u},Ee.isNative=function(u){if(sv(u))throw new Tn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Zm(u)},Ee.isNil=function(u){return null==u},Ee.isNull=function(u){return null===u},Ee.isNumber=SA,Ee.isObject=Er,Ee.isObjectLike=Sr,Ee.isPlainObject=Rp,Ee.isRegExp=qv,Ee.isSafeInteger=function(u){return Op(u)&&u>=-Se&&u<=Se},Ee.isSet=xA,Ee.isString=j_,Ee.isSymbol=na,Ee.isTypedArray=$h,Ee.isUndefined=function(u){return u===J},Ee.isWeakMap=function(u){return Sr(u)&&Us(u)==B},Ee.isWeakSet=function(u){return Sr(u)&&"[object WeakSet]"==Ss(u)},Ee.join=function(u,h){return null==u?"":Sh.call(u,h)},Ee.kebabCase=zA,Ee.last=Zo,Ee.lastIndexOf=function(u,h,m){var P=null==u?0:u.length;if(!P)return-1;var ae=P;return m!==J&&(ae=(ae=Qn(m))<0?jr(P+ae,0):ds(ae,P-1)),h==h?function(st,Mt,yt){for(var an=yt+1;an--;)if(st[an]===Mt)return an;return an}(u,h,ae):ad(u,fc,ae,!0)},Ee.lowerCase=HA,Ee.lowerFirst=yF,Ee.lt=Cc,Ee.lte=V_,Ee.max=function(u){return u&&u.length?Rh(u,eo,Ea):J},Ee.maxBy=function(u,h){return u&&u.length?Rh(u,Nn(h,2),Ea):J},Ee.mean=function(u){return vs(u,eo)},Ee.meanBy=function(u,h){return vs(u,Nn(h,2))},Ee.min=function(u){return u&&u.length?Rh(u,eo,Vb):J},Ee.minBy=function(u,h){return u&&u.length?Rh(u,Nn(h,2),Vb):J},Ee.stubArray=Tc,Ee.stubFalse=oy,Ee.stubObject=function(){return{}},Ee.stubString=function(){return""},Ee.stubTrue=function(){return!0},Ee.multiply=bw,Ee.nth=function(u,h){return u&&u.length?du(u,Qn(h)):J},Ee.noConflict=function(){return Fi._===this&&(Fi._=Lm),this},Ee.noop=ry,Ee.now=vu,Ee.pad=function(u,h,m){u=Li(u);var P=(h=Qn(h))?bh(u):0;if(!h||P>=h)return u;var ae=(h-P)/2;return pp(_i(ae),m)+u+pp(Ft(ae),m)},Ee.padEnd=function(u,h,m){u=Li(u);var P=(h=Qn(h))?bh(u):0;return h&&P<h?u+pp(h-P,m):u},Ee.padStart=function(u,h,m){u=Li(u);var P=(h=Qn(h))?bh(u):0;return h&&P<h?pp(h-P,m)+u:u},Ee.parseInt=function(u,h,m){return m||null==h?h=0:h&&(h=+h),GC(Li(u).replace(Ze,""),h||0)},Ee.random=function(u,h,m){if(m&&"boolean"!=typeof m&&zs(u,h,m)&&(h=m=J),m===J&&("boolean"==typeof h?(m=h,h=J):"boolean"==typeof u&&(m=u,u=J)),u===J&&h===J?(u=0,h=1):(u=ll(u),h===J?(h=u,u=0):h=ll(h)),u>h){var P=u;u=h,h=P}if(m||u%1||h%1){var ae=xh();return ds(u+ae*(h-u+RC("1e-"+((ae+"").length-1))),h)}return Nl(u,h)},Ee.reduce=function(u,h,m){var P=On(u)?ru:$o,ae=arguments.length<3;return P(u,Nn(h,4),m,ae,_c)},Ee.reduceRight=function(u,h,m){var P=On(u)?od:$o,ae=arguments.length<3;return P(u,Nn(h,4),m,ae,Ym)},Ee.repeat=function(u,h,m){return h=(m?zs(u,h,m):h===J)?1:Qn(h),ap(Li(u),h)},Ee.replace=function(){var u=arguments,h=Li(u[0]);return u.length<3?h:h.replace(u[1],u[2])},Ee.result=function(u,h,m){var P=-1,ae=(h=wc(h,u)).length;for(ae||(ae=1,u=J);++P<ae;){var xe=null==u?J:u[ei(h[P])];xe===J&&(P=ae,xe=m),u=ta(xe)?xe.call(u):xe}return u},Ee.round=vw,Ee.runInContext=st,Ee.sample=function(u){return(On(u)?$m:d1)(u)},Ee.size=function(u){if(null==u)return 0;if(fo(u))return j_(u)?bh(u):u.length;var h=Us(u);return h==Ne||h==ft?u.size:jb(u).length},Ee.snakeCase=KA,Ee.some=function(u,h,m){var P=On(u)?Ao:ZP;return m&&zs(u,h,m)&&(h=J),P(u,Nn(h,3))},Ee.sortedIndex=function(u,h){return Lh(u,h)},Ee.sortedIndexBy=function(u,h,m){return n_(u,h,Nn(m,2))},Ee.sortedIndexOf=function(u,h){var m=null==u?0:u.length;if(m){var P=Lh(u,h);if(P<m&&Mn(u[P],h))return P}return-1},Ee.sortedLastIndex=function(u,h){return Lh(u,h,!0)},Ee.sortedLastIndexBy=function(u,h,m){return n_(u,h,Nn(m,2),!0)},Ee.sortedLastIndexOf=function(u,h){if(null!=u&&u.length){var P=Lh(u,h,!0)-1;if(Mn(u[P],h))return P}return-1},Ee.startCase=Y_,Ee.startsWith=function(u,h,m){return u=Li(u),m=null==m?0:cu(Qn(m),0,u.length),h=Io(h),u.slice(m,m+h.length)==h},Ee.subtract=ww,Ee.sum=function(u){return u&&u.length?ld(u,eo):0},Ee.sumBy=function(u,h){return u&&u.length?ld(u,Nn(h,2)):0},Ee.template=function(u,h,m){var P=Ee.templateSettings;m&&zs(u,h,m)&&(h=J),u=Li(u),h=Nd({},h,P,Qb);var qe,lt,ae=Nd({},h.imports,P.imports,Qb),xe=As(ae),Ve=Im(ae,xe),Rt=0,Nt=h.interpolate||Wr,Bt="__p += '",tn=Pm((h.escape||Wr).source+"|"+Nt.source+"|"+(Nt===ot?gn:Wr).source+"|"+(h.evaluate||Wr).source+"|$","g"),bn="//# sourceURL="+($i.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++OC+"]")+"\n";u.replace(tn,function(jn,hi,Si,go,Hs,ia){return Si||(Si=go),Bt+=u.slice(Rt,ia).replace(ne,FP),hi&&(qe=!0,Bt+="' +\n__e("+hi+") +\n'"),Hs&&(lt=!0,Bt+="';\n"+Hs+";\n__p += '"),Si&&(Bt+="' +\n((__t = ("+Si+")) == null ? '' : __t) +\n'"),Rt=ia+jn.length,jn}),Bt+="';\n";var kn=$i.call(h,"variable")&&h.variable;if(kn){if(ri.test(kn))throw new Tn("Invalid `variable` option passed into `_.template`")}else Bt="with (obj) {\n"+Bt+"\n}\n";Bt=(lt?Bt.replace(Ps,""):Bt).replace($r,"$1").replace(Wa,"$1;"),Bt="function("+(kn||"obj")+") {\n"+(kn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(qe?", __e = _.escape":"")+(lt?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+Bt+"return __p\n}";var di=ey(function(){return Di(xe,bn+"return "+Bt).apply(J,Ve)});if(di.source=Bt,Aa(di))throw di;return di},Ee.times=function(u,h){if((u=Qn(u))<1||u>Se)return[];var m=_e,P=ds(u,_e);h=Nn(h),u-=_e;for(var ae=cd(P,h);++m<u;)h(m);return ae},Ee.toFinite=ll,Ee.toInteger=Qn,Ee.toLength=U_,Ee.toLower=function(u){return Li(u).toLowerCase()},Ee.toNumber=po,Ee.toSafeInteger=function(u){return u?cu(Qn(u),-Se,Se):0===u?u:0},Ee.toString=Li,Ee.toUpper=function(u){return Li(u).toUpperCase()},Ee.trim=function(u,h,m){if((u=Li(u))&&(m||h===J))return Ab(u);if(!u||!(h=Io(h)))return u;var P=Ya(u),ae=Ya(h);return tl(P,FC(P,ae),LC(P,ae)+1).join("")},Ee.trimEnd=function(u,h,m){if((u=Li(u))&&(m||h===J))return u.slice(0,pc(u)+1);if(!u||!(h=Io(h)))return u;var P=Ya(u);return tl(P,0,LC(P,Ya(h))+1).join("")},Ee.trimStart=function(u,h,m){if((u=Li(u))&&(m||h===J))return u.replace(Ze,"");if(!u||!(h=Io(h)))return u;var P=Ya(u);return tl(P,FC(P,Ya(h))).join("")},Ee.truncate=function(u,h){var m=30,P="...";if(Er(h)){var ae="separator"in h?h.separator:ae;m="length"in h?Qn(h.length):m,P="omission"in h?Io(h.omission):P}var xe=(u=Li(u)).length;if(yh(u)){var Ve=Ya(u);xe=Ve.length}if(m>=xe)return u;var qe=m-bh(P);if(qe<1)return P;var lt=Ve?tl(Ve,0,qe).join(""):u.slice(0,qe);if(ae===J)return lt+P;if(Ve&&(qe+=lt.length-qe),qv(ae)){if(u.slice(qe).search(ae)){var Rt,Nt=lt;for(ae.global||(ae=Pm(ae.source,Li(Gn.exec(ae))+"g")),ae.lastIndex=0;Rt=ae.exec(Nt);)var Bt=Rt.index;lt=lt.slice(0,Bt===J?qe:Bt)}}else if(u.indexOf(Io(ae),qe)!=qe){var tn=lt.lastIndexOf(ae);tn>-1&&(lt=lt.slice(0,tn))}return lt+P},Ee.unescape=function(u){return(u=Li(u))&&_s.test(u)?u.replace(Cl,Nm):u},Ee.uniqueId=function(u){var h=++UP;return Li(u)+h},Ee.upperCase=dw,Ee.upperFirst=Lp,Ee.each=I_,Ee.eachRight=Cp,Ee.first=cv,iy(Ee,function(){var u={};return el(Ee,function(h,m){$i.call(Ee.prototype,m)||(u[m]=h)}),u}(),{chain:!1}),Ee.VERSION="4.17.21",ks(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){Ee[u].placeholder=Ee}),ks(["drop","take"],function(u,h){ci.prototype[u]=function(m){m=m===J?1:jr(Qn(m),0);var P=this.__filtered__&&!h?new ci(this):this.clone();return P.__filtered__?P.__takeCount__=ds(m,P.__takeCount__):P.__views__.push({size:ds(m,_e),type:u+(P.__dir__<0?"Right":"")}),P},ci.prototype[u+"Right"]=function(m){return this.reverse()[u](m).reverse()}}),ks(["filter","map","takeWhile"],function(u,h){var m=h+1,P=1==m||3==m;ci.prototype[u]=function(ae){var xe=this.clone();return xe.__iteratees__.push({iteratee:Nn(ae,3),type:m}),xe.__filtered__=xe.__filtered__||P,xe}}),ks(["head","last"],function(u,h){var m="take"+(h?"Right":"");ci.prototype[u]=function(){return this[m](1).value()[0]}}),ks(["initial","tail"],function(u,h){var m="drop"+(h?"":"Right");ci.prototype[u]=function(){return this.__filtered__?new ci(this):this[m](1)}}),ci.prototype.compact=function(){return this.filter(eo)},ci.prototype.find=function(u){return this.filter(u).head()},ci.prototype.findLast=function(u){return this.reverse().find(u)},ci.prototype.invokeMap=ui(function(u,h){return"function"==typeof u?new ci(this):this.map(function(m){return Sa(m,u,h)})}),ci.prototype.reject=function(u){return this.filter(F_(Nn(u)))},ci.prototype.slice=function(u,h){u=Qn(u);var m=this;return m.__filtered__&&(u>0||h<0)?new ci(m):(u<0?m=m.takeRight(-u):u&&(m=m.drop(u)),h!==J&&(m=(h=Qn(h))<0?m.dropRight(-h):m.take(h-u)),m)},ci.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},ci.prototype.toArray=function(){return this.take(_e)},el(ci.prototype,function(u,h){var m=/^(?:filter|find|map|reject)|While$/.test(h),P=/^(?:head|last)$/.test(h),ae=Ee[P?"take"+("last"==h?"Right":""):h],xe=P||/^find/.test(h);!ae||(Ee.prototype[h]=function(){var Ve=this.__wrapped__,qe=P?[1]:arguments,lt=Ve instanceof ci,Rt=qe[0],Nt=lt||On(Ve),Bt=function(hi){var Si=ae.apply(Ee,kr([hi],qe));return P&&tn?Si[0]:Si};Nt&&m&&"function"==typeof Rt&&1!=Rt.length&&(lt=Nt=!1);var tn=this.__chain__,bn=!!this.__actions__.length,kn=xe&&!tn,di=lt&&!bn;if(!xe&&Nt){Ve=di?Ve:new ci(this);var jn=u.apply(Ve,qe);return jn.__actions__.push({func:Id,args:[Bt],thisArg:J}),new Mo(jn,tn)}return kn&&di?u.apply(this,qe):(jn=this.thru(Bt),kn?P?jn.value()[0]:jn.value():jn)})}),ks(["pop","push","shift","sort","splice","unshift"],function(u){var h=cr[u],m=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",P=/^(?:pop|shift)$/.test(u);Ee.prototype[u]=function(){var ae=arguments;if(P&&!this.__chain__){var xe=this.value();return h.apply(On(xe)?xe:[],ae)}return this[m](function(Ve){return h.apply(On(Ve)?Ve:[],ae)})}}),el(ci.prototype,function(u,h){var m=Ee[h];if(m){var P=m.name+"";$i.call(hd,P)||(hd[P]=[]),hd[P].push({name:h,func:m})}}),hd[Sc(J,2).name]=[{name:"wrapper",func:J}],ci.prototype.clone=function(){var u=new ci(this.__wrapped__);return u.__actions__=Qs(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Qs(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Qs(this.__views__),u},ci.prototype.reverse=function(){if(this.__filtered__){var u=new ci(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},ci.prototype.value=function(){var u=this.__wrapped__.value(),h=this.__dir__,m=On(u),P=h<0,ae=m?u.length:0,xe=function(u,h,m){for(var P=-1,ae=m.length;++P<ae;){var xe=m[P],Ve=xe.size;switch(xe.type){case"drop":u+=Ve;break;case"dropRight":h-=Ve;break;case"take":h=ds(h,u+Ve);break;case"takeRight":u=jr(u,h-Ve)}}return{start:u,end:h}}(0,ae,this.__views__),Ve=xe.start,qe=xe.end,lt=qe-Ve,Rt=P?qe:Ve-1,Nt=this.__iteratees__,Bt=Nt.length,tn=0,bn=ds(lt,this.__takeCount__);if(!m||!P&&ae==lt&&bn==lt)return h1(u,this.__actions__);var kn=[];e:for(;lt--&&tn<bn;){for(var di=-1,jn=u[Rt+=h];++di<Bt;){var hi=Nt[di],go=hi.type,Hs=(0,hi.iteratee)(jn);if(2==go)jn=Hs;else if(!Hs){if(1==go)continue e;break e}}kn[tn++]=jn}return kn},Ee.prototype.at=A_,Ee.prototype.chain=function(){return C_(this)},Ee.prototype.commit=function(){return new Mo(this.value(),this.__chain__)},Ee.prototype.next=function(){this.__values__===J&&(this.__values__=Kv(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?J:this.__values__[this.__index__++]}},Ee.prototype.plant=function(u){for(var h,m=this;m instanceof Mh;){var P=Ep(m);P.__index__=0,P.__values__=J,h?ae.__wrapped__=P:h=P;var ae=P;m=m.__wrapped__}return ae.__wrapped__=u,h},Ee.prototype.reverse=function(){var u=this.__wrapped__;if(u instanceof ci){var h=u;return this.__actions__.length&&(h=new ci(this)),(h=h.reverse()).__actions__.push({func:Id,args:[E_],thisArg:J}),new Mo(h,this.__chain__)}return this.thru(E_)},Ee.prototype.toJSON=Ee.prototype.valueOf=Ee.prototype.value=function(){return h1(this.__wrapped__,this.__actions__)},Ee.prototype.first=Ee.prototype.head,Eh&&(Ee.prototype[Eh]=function(){return this}),Ee}();Fi._=vh,(mt=function(){return vh}.call(nt,tt,nt,kt))!==J&&(kt.exports=mt)}.call(this)},478:function(kt){kt.exports=function(){"use strict";function nt(it,ot){for(var ut=0;ut<ot.length;ut++){var ge=ot[ut];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(it,ge.key,ge)}}function J(it,ot){(null==ot||ot>it.length)&&(ot=it.length);for(var ut=0,ge=new Array(ot);ut<ot;ut++)ge[ut]=it[ut];return ge}function At(it,ot){var ut="undefined"!=typeof Symbol&&it[Symbol.iterator]||it["@@iterator"];if(ut)return(ut=ut.call(it)).next.bind(ut);if(Array.isArray(it)||(ut=function(it,ot){if(it){if("string"==typeof it)return J(it,ot);var ut=Object.prototype.toString.call(it).slice(8,-1);if("Object"===ut&&it.constructor&&(ut=it.constructor.name),"Map"===ut||"Set"===ut)return Array.from(it);if("Arguments"===ut||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ut))return J(it,ot)}}(it))||ot&&it&&"number"==typeof it.length){ut&&(it=ut);var ge=0;return function(){return ge>=it.length?{done:!0}:{done:!1,value:it[ge++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var dt={exports:{}};function Y(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}dt.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:Y,changeDefaults:function(it){dt.exports.defaults=it}};var fe=/[&<>"']/,K=/[&<>"']/g,V=/[<>"']|&(?!#?\w+;)/,L=/[<>"']|&(?!#?\w+;)/g,ie={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$=function(ot){return ie[ot]};var S=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function N(it){return it.replace(S,function(ot,ut){return"colon"===(ut=ut.toLowerCase())?":":"#"===ut.charAt(0)?"x"===ut.charAt(1)?String.fromCharCode(parseInt(ut.substring(2),16)):String.fromCharCode(+ut.substring(1)):""})}var M=/(^|[^\[])\^/g;var y=/[^\w:]/g,E=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var j={},O=/^[^:]+:\/*[^/]*$/,q=/^([^:]+:)[\s\S]*$/,ce=/^([^:]+:\/*[^/]*)[\s\S]*$/;function D(it,ot){j[" "+it]||(j[" "+it]=O.test(it)?it+"/":z(it,"/",!0));var ut=-1===(it=j[" "+it]).indexOf(":");return"//"===ot.substring(0,2)?ut?ot:it.replace(q,"$1")+ot:"/"===ot.charAt(0)?ut?ot:it.replace(ce,"$1")+ot:it+ot}function z(it,ot,ut){var ge=it.length;if(0===ge)return"";for(var be=0;be<ge;){var Le=it.charAt(ge-be-1);if(Le!==ot||ut){if(Le===ot||!ut)break;be++}else be++}return it.substr(0,ge-be)}var ee_escape=function(it,ot){if(ot){if(fe.test(it))return it.replace(K,$)}else if(V.test(it))return it.replace(L,$);return it},ee_unescape=N,ee_edit=function(it,ot){it=it.source||it,ot=ot||"";var ut={replace:function(be,Le){return Le=(Le=Le.source||Le).replace(M,"$1"),it=it.replace(be,Le),ut},getRegex:function(){return new RegExp(it,ot)}};return ut},ee_cleanUrl=function(it,ot,ut){if(it){var ge;try{ge=decodeURIComponent(N(ut)).replace(y,"").toLowerCase()}catch(be){return null}if(0===ge.indexOf("javascript:")||0===ge.indexOf("vbscript:")||0===ge.indexOf("data:"))return null}ot&&!E.test(ut)&&(ut=D(ot,ut));try{ut=encodeURI(ut).replace(/%25/g,"%")}catch(be){return null}return ut},ee_noopTest={exec:function(){}},ee_merge=function(it){for(var ut,ge,ot=1;ot<arguments.length;ot++)for(ge in ut=arguments[ot])Object.prototype.hasOwnProperty.call(ut,ge)&&(it[ge]=ut[ge]);return it},ee_checkSanitizeDeprecation=function(it){it&&it.sanitize&&!it.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},ee_repeatString=function(it,ot){if(ot<1)return"";for(var ut="";ot>1;)1&ot&&(ut+=it),ot>>=1,it+=it;return ut+it},Se=dt.exports.defaults,pe=z,te=function(it,ot){var ge=it.replace(/\|/g,function(Le,ct,Ze){for(var vt=!1,xt=ct;--xt>=0&&"\\"===Ze[xt];)vt=!vt;return vt?"|":" |"}).split(/ \|/),be=0;if(ge.length>ot)ge.splice(ot);else for(;ge.length<ot;)ge.push("");for(;be<ge.length;be++)ge[be]=ge[be].trim().replace(/\\\|/g,"|");return ge},_e=ee_escape,De=function(it,ot){if(-1===it.indexOf(ot[1]))return-1;for(var ut=it.length,ge=0,be=0;be<ut;be++)if("\\"===it[be])be++;else if(it[be]===ot[0])ge++;else if(it[be]===ot[1]&&--ge<0)return be;return-1};function He(it,ot,ut){var ge=ot.href,be=ot.title?_e(ot.title):null,Le=it[1].replace(/\\([\[\]])/g,"$1");return"!"!==it[0].charAt(0)?{type:"link",raw:ut,href:ge,title:be,text:Le}:{type:"image",raw:ut,href:ge,title:be,text:_e(Le)}}var Xe=function(){function it(ut){this.options=ut||Se}var ot=it.prototype;return ot.space=function(ge){var be=this.rules.block.newline.exec(ge);if(be)return be[0].length>1?{type:"space",raw:be[0]}:{raw:"\n"}},ot.code=function(ge){var be=this.rules.block.code.exec(ge);if(be){var Le=be[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:be[0],codeBlockStyle:"indented",text:this.options.pedantic?Le:pe(Le,"\n")}}},ot.fences=function(ge){var be=this.rules.block.fences.exec(ge);if(be){var Le=be[0],ct=function(it,ot){var ut=it.match(/^(\s+)(?:```)/);if(null===ut)return ot;var ge=ut[1];return ot.split("\n").map(function(be){var Le=be.match(/^\s+/);return null===Le?be:Le[0].length>=ge.length?be.slice(ge.length):be}).join("\n")}(Le,be[3]||"");return{type:"code",raw:Le,lang:be[2]?be[2].trim():be[2],text:ct}}},ot.heading=function(ge){var be=this.rules.block.heading.exec(ge);if(be){var Le=be[2].trim();if(/#$/.test(Le)){var ct=pe(Le,"#");(this.options.pedantic||!ct||/ $/.test(ct))&&(Le=ct.trim())}return{type:"heading",raw:be[0],depth:be[1].length,text:Le}}},ot.nptable=function(ge){var be=this.rules.block.nptable.exec(ge);if(be){var Le={type:"table",header:te(be[1].replace(/^ *| *\| *$/g,"")),align:be[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:be[3]?be[3].replace(/\n$/,"").split("\n"):[],raw:be[0]};if(Le.header.length===Le.align.length){var Ze,ct=Le.align.length;for(Ze=0;Ze<ct;Ze++)Le.align[Ze]=/^ *-+: *$/.test(Le.align[Ze])?"right":/^ *:-+: *$/.test(Le.align[Ze])?"center":/^ *:-+ *$/.test(Le.align[Ze])?"left":null;for(ct=Le.cells.length,Ze=0;Ze<ct;Ze++)Le.cells[Ze]=te(Le.cells[Ze],Le.header.length);return Le}}},ot.hr=function(ge){var be=this.rules.block.hr.exec(ge);if(be)return{type:"hr",raw:be[0]}},ot.blockquote=function(ge){var be=this.rules.block.blockquote.exec(ge);if(be){var Le=be[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:be[0],text:Le}}},ot.list=function(ge){var be=this.rules.block.list.exec(ge);if(be){var qt,Un,ri,Rn,gn,Gn,En,er,tr,Le=be[0],ct=be[2],Ze=ct.length>1,vt={type:"list",raw:Le,ordered:Ze,start:Ze?+ct.slice(0,-1):"",loose:!1,items:[]},xt=be[0].match(this.rules.block.item),Tt=!1,Yn=xt.length;ri=this.rules.block.listItemStart.exec(xt[0]);for(var Vi=0;Vi<Yn;Vi++){if(Le=qt=xt[Vi],this.options.pedantic||(tr=qt.match(new RegExp("\\n\\s*\\n {0,"+(ri[0].length-1)+"}\\S")))&&(gn=qt.length-tr.index+xt.slice(Vi+1).join("\n").length,vt.raw=vt.raw.substring(0,vt.raw.length-gn),Le=qt=qt.substring(0,tr.index),Yn=Vi+1),Vi!==Yn-1){if(Rn=this.rules.block.listItemStart.exec(xt[Vi+1]),this.options.pedantic?Rn[1].length>ri[1].length:Rn[1].length>=ri[0].length||Rn[1].length>3){xt.splice(Vi,2,xt[Vi]+(!this.options.pedantic&&Rn[1].length<ri[0].length&&!xt[Vi].match(/\n$/)?"":"\n")+xt[Vi+1]),Vi--,Yn--;continue}(!this.options.pedantic||this.options.smartLists?Rn[2][Rn[2].length-1]!==ct[ct.length-1]:Ze===(1===Rn[2].length))&&(gn=xt.slice(Vi+1).join("\n").length,vt.raw=vt.raw.substring(0,vt.raw.length-gn),Vi=Yn-1),ri=Rn}Un=qt.length,~(qt=qt.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(Un-=qt.length,qt=qt.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+Un+"}","gm"),"")),qt=pe(qt,"\n"),Vi!==Yn-1&&(Le+="\n"),Gn=Tt||/\n\n(?!\s*$)/.test(Le),Vi!==Yn-1&&(Tt="\n\n"===Le.slice(-2),Gn||(Gn=Tt)),Gn&&(vt.loose=!0),this.options.gfm&&(er=void 0,(En=/^\[[ xX]\] /.test(qt))&&(er=" "!==qt[1],qt=qt.replace(/^\[[ xX]\] +/,""))),vt.items.push({type:"list_item",raw:Le,task:En,checked:er,loose:Gn,text:qt})}return vt}},ot.html=function(ge){var be=this.rules.block.html.exec(ge);if(be)return{type:this.options.sanitize?"paragraph":"html",raw:be[0],pre:!this.options.sanitizer&&("pre"===be[1]||"script"===be[1]||"style"===be[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(be[0]):_e(be[0]):be[0]}},ot.def=function(ge){var be=this.rules.block.def.exec(ge);if(be)return be[3]&&(be[3]=be[3].substring(1,be[3].length-1)),{type:"def",tag:be[1].toLowerCase().replace(/\s+/g," "),raw:be[0],href:be[2],title:be[3]}},ot.table=function(ge){var be=this.rules.block.table.exec(ge);if(be){var Le={type:"table",header:te(be[1].replace(/^ *| *\| *$/g,"")),align:be[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:be[3]?be[3].replace(/\n$/,"").split("\n"):[]};if(Le.header.length===Le.align.length){Le.raw=be[0];var Ze,ct=Le.align.length;for(Ze=0;Ze<ct;Ze++)Le.align[Ze]=/^ *-+: *$/.test(Le.align[Ze])?"right":/^ *:-+: *$/.test(Le.align[Ze])?"center":/^ *:-+ *$/.test(Le.align[Ze])?"left":null;for(ct=Le.cells.length,Ze=0;Ze<ct;Ze++)Le.cells[Ze]=te(Le.cells[Ze].replace(/^ *\| *| *\| *$/g,""),Le.header.length);return Le}}},ot.lheading=function(ge){var be=this.rules.block.lheading.exec(ge);if(be)return{type:"heading",raw:be[0],depth:"="===be[2].charAt(0)?1:2,text:be[1]}},ot.paragraph=function(ge){var be=this.rules.block.paragraph.exec(ge);if(be)return{type:"paragraph",raw:be[0],text:"\n"===be[1].charAt(be[1].length-1)?be[1].slice(0,-1):be[1]}},ot.text=function(ge){var be=this.rules.block.text.exec(ge);if(be)return{type:"text",raw:be[0],text:be[0]}},ot.escape=function(ge){var be=this.rules.inline.escape.exec(ge);if(be)return{type:"escape",raw:be[0],text:_e(be[1])}},ot.tag=function(ge,be,Le){var ct=this.rules.inline.tag.exec(ge);if(ct)return!be&&/^<a /i.test(ct[0])?be=!0:be&&/^<\/a>/i.test(ct[0])&&(be=!1),!Le&&/^<(pre|code|kbd|script)(\s|>)/i.test(ct[0])?Le=!0:Le&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(ct[0])&&(Le=!1),{type:this.options.sanitize?"text":"html",raw:ct[0],inLink:be,inRawBlock:Le,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ct[0]):_e(ct[0]):ct[0]}},ot.link=function(ge){var be=this.rules.inline.link.exec(ge);if(be){var Le=be[2].trim();if(!this.options.pedantic&&/^</.test(Le)){if(!/>$/.test(Le))return;var ct=pe(Le.slice(0,-1),"\\");if((Le.length-ct.length)%2==0)return}else{var Ze=De(be[2],"()");if(Ze>-1){var xt=(0===be[0].indexOf("!")?5:4)+be[1].length+Ze;be[2]=be[2].substring(0,Ze),be[0]=be[0].substring(0,xt).trim(),be[3]=""}}var Tt=be[2],qt="";if(this.options.pedantic){var Un=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Tt);Un&&(Tt=Un[1],qt=Un[3])}else qt=be[3]?be[3].slice(1,-1):"";return Tt=Tt.trim(),/^</.test(Tt)&&(Tt=this.options.pedantic&&!/>$/.test(Le)?Tt.slice(1):Tt.slice(1,-1)),He(be,{href:Tt&&Tt.replace(this.rules.inline._escapes,"$1"),title:qt&&qt.replace(this.rules.inline._escapes,"$1")},be[0])}},ot.reflink=function(ge,be){var Le;if((Le=this.rules.inline.reflink.exec(ge))||(Le=this.rules.inline.nolink.exec(ge))){var ct=(Le[2]||Le[1]).replace(/\s+/g," ");if(!(ct=be[ct.toLowerCase()])||!ct.href){var Ze=Le[0].charAt(0);return{type:"text",raw:Ze,text:Ze}}return He(Le,ct,Le[0])}},ot.emStrong=function(ge,be,Le){void 0===Le&&(Le="");var ct=this.rules.inline.emStrong.lDelim.exec(ge);if(ct&&(!ct[3]||!Le.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Ze=ct[1]||ct[2]||"";if(!Ze||Ze&&(""===Le||this.rules.inline.punctuation.exec(Le))){var xt,Tt,vt=ct[0].length-1,qt=vt,Un=0,ri="*"===ct[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ri.lastIndex=0,be=be.slice(-1*ge.length+vt);null!=(ct=ri.exec(be));)if(xt=ct[1]||ct[2]||ct[3]||ct[4]||ct[5]||ct[6]){if(Tt=xt.length,ct[3]||ct[4]){qt+=Tt;continue}if((ct[5]||ct[6])&&vt%3&&!((vt+Tt)%3)){Un+=Tt;continue}if(!((qt-=Tt)>0))return Tt=Math.min(Tt,Tt+qt+Un),Math.min(vt,Tt)%2?{type:"em",raw:ge.slice(0,vt+ct.index+Tt+1),text:ge.slice(1,vt+ct.index+Tt)}:{type:"strong",raw:ge.slice(0,vt+ct.index+Tt+1),text:ge.slice(2,vt+ct.index+Tt-1)}}}}},ot.codespan=function(ge){var be=this.rules.inline.code.exec(ge);if(be){var Le=be[2].replace(/\n/g," "),ct=/[^ ]/.test(Le),Ze=/^ /.test(Le)&&/ $/.test(Le);return ct&&Ze&&(Le=Le.substring(1,Le.length-1)),Le=_e(Le,!0),{type:"codespan",raw:be[0],text:Le}}},ot.br=function(ge){var be=this.rules.inline.br.exec(ge);if(be)return{type:"br",raw:be[0]}},ot.del=function(ge){var be=this.rules.inline.del.exec(ge);if(be)return{type:"del",raw:be[0],text:be[2]}},ot.autolink=function(ge,be){var ct,Ze,Le=this.rules.inline.autolink.exec(ge);if(Le)return Ze="@"===Le[2]?"mailto:"+(ct=_e(this.options.mangle?be(Le[1]):Le[1])):ct=_e(Le[1]),{type:"link",raw:Le[0],text:ct,href:Ze,tokens:[{type:"text",raw:ct,text:ct}]}},ot.url=function(ge,be){var Le;if(Le=this.rules.inline.url.exec(ge)){var ct,Ze;if("@"===Le[2])Ze="mailto:"+(ct=_e(this.options.mangle?be(Le[0]):Le[0]));else{var vt;do{vt=Le[0],Le[0]=this.rules.inline._backpedal.exec(Le[0])[0]}while(vt!==Le[0]);ct=_e(Le[0]),Ze="www."===Le[1]?"http://"+ct:ct}return{type:"link",raw:Le[0],text:ct,href:Ze,tokens:[{type:"text",raw:ct,text:ct}]}}},ot.inlineText=function(ge,be,Le){var Ze,ct=this.rules.inline.text.exec(ge);if(ct)return Ze=be?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ct[0]):_e(ct[0]):ct[0]:_e(this.options.smartypants?Le(ct[0]):ct[0]),{type:"text",raw:ct[0],text:Ze}},it}(),Je=ee_noopTest,Ke=ee_edit,je=ee_merge,Fe={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:Je,table:Je,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Fe.def=Ke(Fe.def).replace("label",Fe._label).replace("title",Fe._title).getRegex(),Fe.bullet=/(?:[*+-]|\d{1,9}[.)])/,Fe.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,Fe.item=Ke(Fe.item,"gm").replace(/bull/g,Fe.bullet).getRegex(),Fe.listItemStart=Ke(/^( *)(bull) */).replace("bull",Fe.bullet).getRegex(),Fe.list=Ke(Fe.list).replace(/bull/g,Fe.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Fe.def.source+")").getRegex(),Fe._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Fe._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Fe.html=Ke(Fe.html,"i").replace("comment",Fe._comment).replace("tag",Fe._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Fe.paragraph=Ke(Fe._paragraph).replace("hr",Fe.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Fe._tag).getRegex(),Fe.blockquote=Ke(Fe.blockquote).replace("paragraph",Fe.paragraph).getRegex(),Fe.normal=je({},Fe),Fe.gfm=je({},Fe.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Fe.gfm.nptable=Ke(Fe.gfm.nptable).replace("hr",Fe.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Fe._tag).getRegex(),Fe.gfm.table=Ke(Fe.gfm.table).replace("hr",Fe.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Fe._tag).getRegex(),Fe.pedantic=je({},Fe.normal,{html:Ke("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Fe._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Je,paragraph:Ke(Fe.normal._paragraph).replace("hr",Fe.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Fe.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Ye={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Je,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Je,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Ye.punctuation=Ke(Ye.punctuation).replace(/punctuation/g,Ye._punctuation).getRegex(),Ye.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Ye.escapedEmSt=/\\\*|\\_/g,Ye._comment=Ke(Fe._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ye.emStrong.lDelim=Ke(Ye.emStrong.lDelim).replace(/punct/g,Ye._punctuation).getRegex(),Ye.emStrong.rDelimAst=Ke(Ye.emStrong.rDelimAst,"g").replace(/punct/g,Ye._punctuation).getRegex(),Ye.emStrong.rDelimUnd=Ke(Ye.emStrong.rDelimUnd,"g").replace(/punct/g,Ye._punctuation).getRegex(),Ye._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Ye._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Ye._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Ye.autolink=Ke(Ye.autolink).replace("scheme",Ye._scheme).replace("email",Ye._email).getRegex(),Ye._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Ye.tag=Ke(Ye.tag).replace("comment",Ye._comment).replace("attribute",Ye._attribute).getRegex(),Ye._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ye._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Ye._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Ye.link=Ke(Ye.link).replace("label",Ye._label).replace("href",Ye._href).replace("title",Ye._title).getRegex(),Ye.reflink=Ke(Ye.reflink).replace("label",Ye._label).getRegex(),Ye.reflinkSearch=Ke(Ye.reflinkSearch,"g").replace("reflink",Ye.reflink).replace("nolink",Ye.nolink).getRegex(),Ye.normal=je({},Ye),Ye.pedantic=je({},Ye.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ke(/^!?\[(label)\]\((.*?)\)/).replace("label",Ye._label).getRegex(),reflink:Ke(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ye._label).getRegex()}),Ye.gfm=je({},Ye.normal,{escape:Ke(Ye.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Ye.gfm.url=Ke(Ye.gfm.url,"i").replace("email",Ye.gfm._extended_email).getRegex(),Ye.breaks=je({},Ye.gfm,{br:Ke(Ye.br).replace("{2,}","*").getRegex(),text:Ke(Ye.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Ce={block:Fe,inline:Ye},Be=Xe,$e=dt.exports.defaults,Ne=Ce.block,G=Ce.inline,U=ee_repeatString;function he(it){return it.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function ue(it){var ut,ge,ot="",be=it.length;for(ut=0;ut<be;ut++)ge=it.charCodeAt(ut),Math.random()>.5&&(ge="x"+ge.toString(16)),ot+="&#"+ge+";";return ot}var ke=function(){function it(ut){this.tokens=[],this.tokens.links=Object.create(null),this.options=ut||$e,this.options.tokenizer=this.options.tokenizer||new Be,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var ge={block:Ne.normal,inline:G.normal};this.options.pedantic?(ge.block=Ne.pedantic,ge.inline=G.pedantic):this.options.gfm&&(ge.block=Ne.gfm,ge.inline=this.options.breaks?G.breaks:G.gfm),this.tokenizer.rules=ge}it.lex=function(ge,be){return new it(be).lex(ge)},it.lexInline=function(ge,be){return new it(be).inlineTokens(ge)};var ot=it.prototype;return ot.lex=function(ge){return ge=ge.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(ge,this.tokens,!0),this.inline(this.tokens),this.tokens},ot.blockTokens=function(ge,be,Le){var Ze,vt,xt,Tt,qt,Un,ct=this;for(void 0===be&&(be=[]),void 0===Le&&(Le=!0),this.options.pedantic&&(ge=ge.replace(/^ +$/gm,""));ge;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(Rn){return!!(Ze=Rn.call(ct,ge,be))&&(ge=ge.substring(Ze.raw.length),be.push(Ze),!0)}))){if(Ze=this.tokenizer.space(ge)){ge=ge.substring(Ze.raw.length),Ze.type&&be.push(Ze);continue}if(Ze=this.tokenizer.code(ge)){ge=ge.substring(Ze.raw.length),(Tt=be[be.length-1])&&"paragraph"===Tt.type?(Tt.raw+="\n"+Ze.raw,Tt.text+="\n"+Ze.text):be.push(Ze);continue}if(Ze=this.tokenizer.fences(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.heading(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.nptable(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.hr(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.blockquote(ge)){ge=ge.substring(Ze.raw.length),Ze.tokens=this.blockTokens(Ze.text,[],Le),be.push(Ze);continue}if(Ze=this.tokenizer.list(ge)){for(ge=ge.substring(Ze.raw.length),xt=Ze.items.length,vt=0;vt<xt;vt++)Ze.items[vt].tokens=this.blockTokens(Ze.items[vt].text,[],!1);be.push(Ze);continue}if(Ze=this.tokenizer.html(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Le&&(Ze=this.tokenizer.def(ge))){ge=ge.substring(Ze.raw.length),this.tokens.links[Ze.tag]||(this.tokens.links[Ze.tag]={href:Ze.href,title:Ze.title});continue}if(Ze=this.tokenizer.table(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(Ze=this.tokenizer.lheading(ge)){ge=ge.substring(Ze.raw.length),be.push(Ze);continue}if(qt=ge,this.options.extensions&&this.options.extensions.startBlock&&function(){var Rn=1/0,gn=ge.slice(1),Gn=void 0;ct.options.extensions.startBlock.forEach(function(En){"number"==typeof(Gn=En.call(this,gn))&&Gn>=0&&(Rn=Math.min(Rn,Gn))}),Rn<1/0&&Rn>=0&&(qt=ge.substring(0,Rn+1))}(),Le&&(Ze=this.tokenizer.paragraph(qt))){Tt=be[be.length-1],Un&&"paragraph"===Tt.type?(Tt.raw+="\n"+Ze.raw,Tt.text+="\n"+Ze.text):be.push(Ze),Un=qt.length!==ge.length,ge=ge.substring(Ze.raw.length);continue}if(Ze=this.tokenizer.text(ge)){ge=ge.substring(Ze.raw.length),(Tt=be[be.length-1])&&"text"===Tt.type?(Tt.raw+="\n"+Ze.raw,Tt.text+="\n"+Ze.text):be.push(Ze);continue}if(ge){var ri="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(ri);break}throw new Error(ri)}}return be},ot.inline=function(ge){var be,Le,ct,Ze,vt,xt,Tt=ge.length;for(be=0;be<Tt;be++)switch(xt=ge[be],xt.type){case"paragraph":case"text":case"heading":xt.tokens=[],this.inlineTokens(xt.text,xt.tokens);break;case"table":for(xt.tokens={header:[],cells:[]},Ze=xt.header.length,Le=0;Le<Ze;Le++)xt.tokens.header[Le]=[],this.inlineTokens(xt.header[Le],xt.tokens.header[Le]);for(Ze=xt.cells.length,Le=0;Le<Ze;Le++)for(vt=xt.cells[Le],xt.tokens.cells[Le]=[],ct=0;ct<vt.length;ct++)xt.tokens.cells[Le][ct]=[],this.inlineTokens(vt[ct],xt.tokens.cells[Le][ct]);break;case"blockquote":this.inline(xt.tokens);break;case"list":for(Ze=xt.items.length,Le=0;Le<Ze;Le++)this.inline(xt.items[Le].tokens)}return ge},ot.inlineTokens=function(ge,be,Le,ct){var Ze=this;void 0===be&&(be=[]),void 0===Le&&(Le=!1),void 0===ct&&(ct=!1);var vt,xt,Tt,Un,ri,Rn,qt=ge;if(this.tokens.links){var gn=Object.keys(this.tokens.links);if(gn.length>0)for(;null!=(Un=this.tokenizer.rules.inline.reflinkSearch.exec(qt));)gn.includes(Un[0].slice(Un[0].lastIndexOf("[")+1,-1))&&(qt=qt.slice(0,Un.index)+"["+U("a",Un[0].length-2)+"]"+qt.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(Un=this.tokenizer.rules.inline.blockSkip.exec(qt));)qt=qt.slice(0,Un.index)+"["+U("a",Un[0].length-2)+"]"+qt.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(Un=this.tokenizer.rules.inline.escapedEmSt.exec(qt));)qt=qt.slice(0,Un.index)+"++"+qt.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;ge;)if(ri||(Rn=""),ri=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(En){return!!(vt=En.call(Ze,ge,be))&&(ge=ge.substring(vt.raw.length),be.push(vt),!0)}))){if(vt=this.tokenizer.escape(ge)){ge=ge.substring(vt.raw.length),be.push(vt);continue}if(vt=this.tokenizer.tag(ge,Le,ct)){ge=ge.substring(vt.raw.length),Le=vt.inLink,ct=vt.inRawBlock,(xt=be[be.length-1])&&"text"===vt.type&&"text"===xt.type?(xt.raw+=vt.raw,xt.text+=vt.text):be.push(vt);continue}if(vt=this.tokenizer.link(ge)){ge=ge.substring(vt.raw.length),"link"===vt.type&&(vt.tokens=this.inlineTokens(vt.text,[],!0,ct)),be.push(vt);continue}if(vt=this.tokenizer.reflink(ge,this.tokens.links)){ge=ge.substring(vt.raw.length),xt=be[be.length-1],"link"===vt.type?(vt.tokens=this.inlineTokens(vt.text,[],!0,ct),be.push(vt)):xt&&"text"===vt.type&&"text"===xt.type?(xt.raw+=vt.raw,xt.text+=vt.text):be.push(vt);continue}if(vt=this.tokenizer.emStrong(ge,qt,Rn)){ge=ge.substring(vt.raw.length),vt.tokens=this.inlineTokens(vt.text,[],Le,ct),be.push(vt);continue}if(vt=this.tokenizer.codespan(ge)){ge=ge.substring(vt.raw.length),be.push(vt);continue}if(vt=this.tokenizer.br(ge)){ge=ge.substring(vt.raw.length),be.push(vt);continue}if(vt=this.tokenizer.del(ge)){ge=ge.substring(vt.raw.length),vt.tokens=this.inlineTokens(vt.text,[],Le,ct),be.push(vt);continue}if(vt=this.tokenizer.autolink(ge,ue)){ge=ge.substring(vt.raw.length),be.push(vt);continue}if(!Le&&(vt=this.tokenizer.url(ge,ue))){ge=ge.substring(vt.raw.length),be.push(vt);continue}if(Tt=ge,this.options.extensions&&this.options.extensions.startInline&&function(){var En=1/0,er=ge.slice(1),tr=void 0;Ze.options.extensions.startInline.forEach(function(Yn){"number"==typeof(tr=Yn.call(this,er))&&tr>=0&&(En=Math.min(En,tr))}),En<1/0&&En>=0&&(Tt=ge.substring(0,En+1))}(),vt=this.tokenizer.inlineText(Tt,ct,he)){ge=ge.substring(vt.raw.length),"_"!==vt.raw.slice(-1)&&(Rn=vt.raw.slice(-1)),ri=!0,(xt=be[be.length-1])&&"text"===xt.type?(xt.raw+=vt.raw,xt.text+=vt.text):be.push(vt);continue}if(ge){var Gn="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(Gn);break}throw new Error(Gn)}}return be},function(it,ot,ut){ot&&nt(it.prototype,ot),ut&&nt(it,ut)}(it,null,[{key:"rules",get:function(){return{block:Ne,inline:G}}}]),it}(),gt=dt.exports.defaults,ft=ee_cleanUrl,ve=ee_escape,k=function(){function it(ut){this.options=ut||gt}var ot=it.prototype;return ot.code=function(ge,be,Le){var ct=(be||"").match(/\S*/)[0];if(this.options.highlight){var Ze=this.options.highlight(ge,ct);null!=Ze&&Ze!==ge&&(Le=!0,ge=Ze)}return ge=ge.replace(/\n$/,"")+"\n",ct?'<pre><code class="'+this.options.langPrefix+ve(ct,!0)+'">'+(Le?ge:ve(ge,!0))+"</code></pre>\n":"<pre><code>"+(Le?ge:ve(ge,!0))+"</code></pre>\n"},ot.blockquote=function(ge){return"<blockquote>\n"+ge+"</blockquote>\n"},ot.html=function(ge){return ge},ot.heading=function(ge,be,Le,ct){return this.options.headerIds?"<h"+be+' id="'+this.options.headerPrefix+ct.slug(Le)+'">'+ge+"</h"+be+">\n":"<h"+be+">"+ge+"</h"+be+">\n"},ot.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},ot.list=function(ge,be,Le){var ct=be?"ol":"ul";return"<"+ct+(be&&1!==Le?' start="'+Le+'"':"")+">\n"+ge+"</"+ct+">\n"},ot.listitem=function(ge){return"<li>"+ge+"</li>\n"},ot.checkbox=function(ge){return"<input "+(ge?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},ot.paragraph=function(ge){return"<p>"+ge+"</p>\n"},ot.table=function(ge,be){return be&&(be="<tbody>"+be+"</tbody>"),"<table>\n<thead>\n"+ge+"</thead>\n"+be+"</table>\n"},ot.tablerow=function(ge){return"<tr>\n"+ge+"</tr>\n"},ot.tablecell=function(ge,be){var Le=be.header?"th":"td";return(be.align?"<"+Le+' align="'+be.align+'">':"<"+Le+">")+ge+"</"+Le+">\n"},ot.strong=function(ge){return"<strong>"+ge+"</strong>"},ot.em=function(ge){return"<em>"+ge+"</em>"},ot.codespan=function(ge){return"<code>"+ge+"</code>"},ot.br=function(){return this.options.xhtml?"<br/>":"<br>"},ot.del=function(ge){return"<del>"+ge+"</del>"},ot.link=function(ge,be,Le){if(null===(ge=ft(this.options.sanitize,this.options.baseUrl,ge)))return Le;var ct='<a href="'+ve(ge)+'"';return be&&(ct+=' title="'+be+'"'),ct+">"+Le+"</a>"},ot.image=function(ge,be,Le){if(null===(ge=ft(this.options.sanitize,this.options.baseUrl,ge)))return Le;var ct='<img src="'+ge+'" alt="'+Le+'"';return be&&(ct+=' title="'+be+'"'),ct+(this.options.xhtml?"/>":">")},ot.text=function(ge){return ge},it}(),R=function(){function it(){}var ot=it.prototype;return ot.strong=function(ge){return ge},ot.em=function(ge){return ge},ot.codespan=function(ge){return ge},ot.del=function(ge){return ge},ot.html=function(ge){return ge},ot.text=function(ge){return ge},ot.link=function(ge,be,Le){return""+Le},ot.image=function(ge,be,Le){return""+Le},ot.br=function(){return""},it}(),B=function(){function it(){this.seen={}}var ot=it.prototype;return ot.serialize=function(ge){return ge.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},ot.getNextSafeSlug=function(ge,be){var Le=ge,ct=0;if(this.seen.hasOwnProperty(Le)){ct=this.seen[ge];do{Le=ge+"-"+ ++ct}while(this.seen.hasOwnProperty(Le))}return be||(this.seen[ge]=ct,this.seen[Le]=0),Le},ot.slug=function(ge,be){void 0===be&&(be={});var Le=this.serialize(ge);return this.getNextSafeSlug(Le,be.dryrun)},it}(),Oe=k,Qe=R,bt=B,It=dt.exports.defaults,In=ee_unescape,Wn=ke,Ei=function(){function it(ut){this.options=ut||It,this.options.renderer=this.options.renderer||new Oe,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Qe,this.slugger=new bt}it.parse=function(ge,be){return new it(be).parse(ge)},it.parseInline=function(ge,be){return new it(be).parseInline(ge)};var ot=it.prototype;return ot.parse=function(ge,be){void 0===be&&(be=!0);var ct,Ze,vt,xt,Tt,qt,Un,ri,Rn,gn,Gn,En,er,tr,Yn,Vi,ha,Wr,ne,Le="",de=ge.length;for(ct=0;ct<de;ct++)if(gn=ge[ct],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[gn.type]&&(!1!==(ne=this.options.extensions.renderers[gn.type].call(this,gn))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(gn.type)))Le+=ne||"";else switch(gn.type){case"space":continue;case"hr":Le+=this.renderer.hr();continue;case"heading":Le+=this.renderer.heading(this.parseInline(gn.tokens),gn.depth,In(this.parseInline(gn.tokens,this.textRenderer)),this.slugger);continue;case"code":Le+=this.renderer.code(gn.text,gn.lang,gn.escaped);continue;case"table":for(ri="",Un="",xt=gn.header.length,Ze=0;Ze<xt;Ze++)Un+=this.renderer.tablecell(this.parseInline(gn.tokens.header[Ze]),{header:!0,align:gn.align[Ze]});for(ri+=this.renderer.tablerow(Un),Rn="",xt=gn.cells.length,Ze=0;Ze<xt;Ze++){for(Un="",Tt=(qt=gn.tokens.cells[Ze]).length,vt=0;vt<Tt;vt++)Un+=this.renderer.tablecell(this.parseInline(qt[vt]),{header:!1,align:gn.align[vt]});Rn+=this.renderer.tablerow(Un)}Le+=this.renderer.table(ri,Rn);continue;case"blockquote":Rn=this.parse(gn.tokens),Le+=this.renderer.blockquote(Rn);continue;case"list":for(Gn=gn.ordered,En=gn.start,er=gn.loose,xt=gn.items.length,Rn="",Ze=0;Ze<xt;Ze++)Vi=(Yn=gn.items[Ze]).checked,ha=Yn.task,tr="",Yn.task&&(Wr=this.renderer.checkbox(Vi),er?Yn.tokens.length>0&&"text"===Yn.tokens[0].type?(Yn.tokens[0].text=Wr+" "+Yn.tokens[0].text,Yn.tokens[0].tokens&&Yn.tokens[0].tokens.length>0&&"text"===Yn.tokens[0].tokens[0].type&&(Yn.tokens[0].tokens[0].text=Wr+" "+Yn.tokens[0].tokens[0].text)):Yn.tokens.unshift({type:"text",text:Wr}):tr+=Wr),tr+=this.parse(Yn.tokens,er),Rn+=this.renderer.listitem(tr,ha,Vi);Le+=this.renderer.list(Rn,Gn,En);continue;case"html":Le+=this.renderer.html(gn.text);continue;case"paragraph":Le+=this.renderer.paragraph(this.parseInline(gn.tokens));continue;case"text":for(Rn=gn.tokens?this.parseInline(gn.tokens):gn.text;ct+1<de&&"text"===ge[ct+1].type;)Rn+="\n"+((gn=ge[++ct]).tokens?this.parseInline(gn.tokens):gn.text);Le+=be?this.renderer.paragraph(Rn):Rn;continue;default:var re='Token with "'+gn.type+'" type was not found.';if(this.options.silent)return void console.error(re);throw new Error(re)}return Le},ot.parseInline=function(ge,be){be=be||this.renderer;var ct,Ze,vt,Le="",xt=ge.length;for(ct=0;ct<xt;ct++)if(Ze=ge[ct],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Ze.type]&&(!1!==(vt=this.options.extensions.renderers[Ze.type].call(this,Ze))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Ze.type)))Le+=vt||"";else switch(Ze.type){case"escape":Le+=be.text(Ze.text);break;case"html":Le+=be.html(Ze.text);break;case"link":Le+=be.link(Ze.href,Ze.title,this.parseInline(Ze.tokens,be));break;case"image":Le+=be.image(Ze.href,Ze.title,Ze.text);break;case"strong":Le+=be.strong(this.parseInline(Ze.tokens,be));break;case"em":Le+=be.em(this.parseInline(Ze.tokens,be));break;case"codespan":Le+=be.codespan(Ze.text);break;case"br":Le+=be.br();break;case"del":Le+=be.del(this.parseInline(Ze.tokens,be));break;case"text":Le+=be.text(Ze.text);break;default:var Tt='Token with "'+Ze.type+'" type was not found.';if(this.options.silent)return void console.error(Tt);throw new Error(Tt)}return Le},it}(),mi=Xe,Gr=k,Ns=R,us=B,Ps=ee_merge,$r=ee_checkSanitizeDeprecation,Wa=ee_escape,Cl=dt.exports.getDefaults,da=dt.exports.changeDefaults,_s=dt.exports.defaults;function Jt(it,ot,ut){if(null==it)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof it)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(it)+", string expected");if("function"==typeof ot&&(ut=ot,ot=null),ot=Ps({},Jt.defaults,ot||{}),$r(ot),ut){var be,ge=ot.highlight;try{be=Wn.lex(it,ot)}catch(vt){return ut(vt)}var Le=function(xt){var Tt;if(!xt)try{ot.walkTokens&&Jt.walkTokens(be,ot.walkTokens),Tt=Ei.parse(be,ot)}catch(qt){xt=qt}return ot.highlight=ge,xt?ut(xt):ut(null,Tt)};if(!ge||ge.length<3||(delete ot.highlight,!be.length))return Le();var ct=0;return Jt.walkTokens(be,function(vt){"code"===vt.type&&(ct++,setTimeout(function(){ge(vt.text,vt.lang,function(xt,Tt){if(xt)return Le(xt);null!=Tt&&Tt!==vt.text&&(vt.text=Tt,vt.escaped=!0),0==--ct&&Le()})},0))}),void(0===ct&&Le())}try{var Ze=Wn.lex(it,ot);return ot.walkTokens&&Jt.walkTokens(Ze,ot.walkTokens),Ei.parse(Ze,ot)}catch(vt){if(vt.message+="\nPlease report this to https://github.com/markedjs/marked.",ot.silent)return"<p>An error occurred:</p><pre>"+Wa(vt.message+"",!0)+"</pre>";throw vt}}return Jt.options=Jt.setOptions=function(it){return Ps(Jt.defaults,it),da(Jt.defaults),Jt},Jt.getDefaults=Cl,Jt.defaults=_s,Jt.use=function(){for(var it=this,ot=arguments.length,ut=new Array(ot),ge=0;ge<ot;ge++)ut[ge]=arguments[ge];var ct,be=Ps.apply(void 0,[{}].concat(ut)),Le=Jt.defaults.extensions||{renderers:{},childTokens:{}};ut.forEach(function(Ze){if(Ze.extensions&&(ct=!0,Ze.extensions.forEach(function(xt){if(!xt.name)throw new Error("extension name required");if(xt.renderer){var Tt=Le.renderers?Le.renderers[xt.name]:null;Le.renderers[xt.name]=Tt?function(){for(var qt=arguments.length,Un=new Array(qt),ri=0;ri<qt;ri++)Un[ri]=arguments[ri];var Rn=xt.renderer.apply(this,Un);return!1===Rn&&(Rn=Tt.apply(this,Un)),Rn}:xt.renderer}if(xt.tokenizer){if(!xt.level||"block"!==xt.level&&"inline"!==xt.level)throw new Error("extension level must be 'block' or 'inline'");Le[xt.level]?Le[xt.level].unshift(xt.tokenizer):Le[xt.level]=[xt.tokenizer],xt.start&&("block"===xt.level?Le.startBlock?Le.startBlock.push(xt.start):Le.startBlock=[xt.start]:"inline"===xt.level&&(Le.startInline?Le.startInline.push(xt.start):Le.startInline=[xt.start]))}xt.childTokens&&(Le.childTokens[xt.name]=xt.childTokens)})),Ze.renderer&&function(){var xt=Jt.defaults.renderer||new Gr,Tt=function(ri){var Rn=xt[ri];xt[ri]=function(){for(var gn=arguments.length,Gn=new Array(gn),En=0;En<gn;En++)Gn[En]=arguments[En];var er=Ze.renderer[ri].apply(xt,Gn);return!1===er&&(er=Rn.apply(xt,Gn)),er}};for(var qt in Ze.renderer)Tt(qt);be.renderer=xt}(),Ze.tokenizer&&function(){var xt=Jt.defaults.tokenizer||new mi,Tt=function(ri){var Rn=xt[ri];xt[ri]=function(){for(var gn=arguments.length,Gn=new Array(gn),En=0;En<gn;En++)Gn[En]=arguments[En];var er=Ze.tokenizer[ri].apply(xt,Gn);return!1===er&&(er=Rn.apply(xt,Gn)),er}};for(var qt in Ze.tokenizer)Tt(qt);be.tokenizer=xt}(),Ze.walkTokens){var vt=Jt.defaults.walkTokens;be.walkTokens=function(xt){Ze.walkTokens.call(it,xt),vt&&vt(xt)}}ct&&(be.extensions=Le),Jt.setOptions(be)})},Jt.walkTokens=function(it,ot){for(var be,ut=function(){var ct=be.value;switch(ot(ct),ct.type){case"table":for(var vt,Ze=At(ct.tokens.header);!(vt=Ze()).done;)Jt.walkTokens(vt.value,ot);for(var qt,Tt=At(ct.tokens.cells);!(qt=Tt()).done;)for(var Rn,ri=At(qt.value);!(Rn=ri()).done;)Jt.walkTokens(Rn.value,ot);break;case"list":Jt.walkTokens(ct.items,ot);break;default:Jt.defaults.extensions&&Jt.defaults.extensions.childTokens&&Jt.defaults.extensions.childTokens[ct.type]?Jt.defaults.extensions.childTokens[ct.type].forEach(function(Gn){Jt.walkTokens(ct[Gn],ot)}):ct.tokens&&Jt.walkTokens(ct.tokens,ot)}},ge=At(it);!(be=ge()).done;)ut()},Jt.parseInline=function(it,ot){if(null==it)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof it)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(it)+", string expected");ot=Ps({},Jt.defaults,ot||{}),$r(ot);try{var ut=Wn.lexInline(it,ot);return ot.walkTokens&&Jt.walkTokens(ut,ot.walkTokens),Ei.parseInline(ut,ot)}catch(ge){if(ge.message+="\nPlease report this to https://github.com/markedjs/marked.",ot.silent)return"<p>An error occurred:</p><pre>"+Wa(ge.message+"",!0)+"</pre>";throw ge}},Jt.Parser=Ei,Jt.parser=Ei.parse,Jt.Renderer=Gr,Jt.TextRenderer=Ns,Jt.Lexer=Wn,Jt.lexer=Wn.lex,Jt.Tokenizer=mi,Jt.Slugger=us,Jt.parse=Jt,Jt}()},369:(kt,nt,tt)=>{var mt=tt(284),J=tt(830);function At(){this.clear()}At.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},At.prototype.enqueue=function(dt){return this.items.push(dt),++this.size},At.prototype.dequeue=function(){if(this.size){var dt=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,dt}},At.prototype.peek=function(){if(this.size)return this.items[this.offset]},At.prototype.forEach=function(dt,Y){Y=arguments.length>1?Y:this;for(var Te=this.offset,fe=0,K=this.items.length;Te<K;Te++,fe++)dt.call(Y,this.items[Te],fe,this)},At.prototype.toArray=function(){return this.items.slice(this.offset)},At.prototype.values=function(){var dt=this.items,Y=this.offset;return new mt(function(){if(Y>=dt.length)return{done:!0};var Te=dt[Y];return Y++,{value:Te,done:!1}})},At.prototype.entries=function(){var dt=this.items,Y=this.offset,Te=0;return new mt(function(){if(Y>=dt.length)return{done:!0};var fe=dt[Y];return Y++,{value:[Te++,fe],done:!1}})},"undefined"!=typeof Symbol&&(At.prototype[Symbol.iterator]=At.prototype.values),At.prototype.toString=function(){return this.toArray().join(",")},At.prototype.toJSON=function(){return this.toArray()},At.prototype.inspect=function(){var dt=this.toArray();return Object.defineProperty(dt,"constructor",{value:At,enumerable:!1}),dt},"undefined"!=typeof Symbol&&(At.prototype[Symbol.for("nodejs.util.inspect.custom")]=At.prototype.inspect),At.from=function(dt){var Y=new At;return J(dt,function(Te){Y.enqueue(Te)}),Y},At.of=function(){return At.from(arguments)},kt.exports=At},830:kt=>{var nt="undefined"!=typeof ArrayBuffer,tt="undefined"!=typeof Symbol;function mt(J,At){var dt,Y,Te,fe,K;if(!J)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof At)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(J)||nt&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Te=0,fe=J.length;Te<fe;Te++)At(J[Te],Te);else if("function"!=typeof J.forEach)if(tt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(Y in J)J.hasOwnProperty(Y)&&At(J[Y],Y);else for(dt=J,Te=0;!0!==(K=dt.next()).done;)At(K.value,Te),Te++;else J.forEach(At)}mt.forEachWithNullKeys=function(J,At){var dt,Y,Te,fe,K;if(!J)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof At)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(J)||nt&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Te=0,fe=J.length;Te<fe;Te++)At(J[Te],null);else if(J instanceof Set)J.forEach(function(V){At(V,null)});else if("function"!=typeof J.forEach)if(tt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(Y in J)J.hasOwnProperty(Y)&&At(J[Y],Y);else for(dt=J,Te=0;!0!==(K=dt.next()).done;)At(K.value,null),Te++;else J.forEach(At)},kt.exports=mt},284:kt=>{function nt(tt){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:tt}),this.done=!1}nt.prototype.next=function(){if(this.done)return{done:!0};var tt=this._next();return tt.done&&(this.done=!0),tt},"undefined"!=typeof Symbol&&(nt.prototype[Symbol.iterator]=function(){return this}),nt.of=function(){var tt=arguments,mt=tt.length,J=0;return new nt(function(){return J>=mt?{done:!0}:{done:!1,value:tt[J++]}})},nt.empty=function(){var tt=new nt(null);return tt.done=!0,tt},nt.is=function(tt){return tt instanceof nt||"object"==typeof tt&&null!==tt&&"function"==typeof tt.next},kt.exports=nt},310:(kt,nt,tt)=>{"use strict";var mt=tt(948);Object.defineProperty(nt,"__esModule",{value:!0}),nt.isMobile=function(){return void 0!==J.window.orientation},nt.default=function(fe){if(!fe&&!(0,At.default)())return"Node";if((0,dt.default)(fe))return"Electron";var K="undefined"!=typeof navigator?navigator:{},V=fe||K.userAgent||"";if(V.indexOf("Edge")>-1)return"Edge";var L=-1!==V.indexOf("MSIE "),ie=-1!==V.indexOf("Trident/");return L||ie?"IE":J.window.chrome?"Chrome":J.window.safari?"Safari":J.window.mozInnerScreenX?"Firefox":"Unknown"};var J=tt(151),At=mt(tt(602)),dt=mt(tt(344))},151:(kt,nt,tt)=>{"use strict";var mt=tt(948);Object.defineProperty(nt,"__esModule",{value:!0}),nt.console=nt.process=nt.document=nt.global=nt.window=nt.self=void 0;var J=mt(tt(321)),At={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&process};nt.self=At.self||At.window||At.global,nt.window=At.window||At.self||At.global,nt.global=At.global||At.self||At.window,nt.document=At.document||{},nt.process=At.process||{};var V=console;nt.console=V},761:(kt,nt,tt)=>{"use strict";var J=tt(948),At=tt(321);Object.defineProperty(nt,"CO",{enumerable:!0,get:function(){return dt.global}}),Object.defineProperty(nt,"jU",{enumerable:!0,get:function(){return Y.default}}),Object.defineProperty(nt,"qs",{enumerable:!0,get:function(){return Te.default}});var dt=tt(151),Y=V(tt(602)),Te=V(tt(310));J(tt(344));function K(L){if("function"!=typeof WeakMap)return null;var ie=new WeakMap,$=new WeakMap;return(K=function(S){return S?$:ie})(L)}function V(L,ie){if(!ie&&L&&L.__esModule)return L;if(null===L||"object"!==At(L)&&"function"!=typeof L)return{default:L};var $=K(ie);if($&&$.has(L))return $.get(L);var v={},S=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in L)if("default"!==N&&Object.prototype.hasOwnProperty.call(L,N)){var M=S?Object.getOwnPropertyDescriptor(L,N):null;M&&(M.get||M.set)?Object.defineProperty(v,N,M):v[N]=L[N]}return v.default=L,$&&$.set(L,v),v}},602:(kt,nt,tt)=>{"use strict";var mt=tt(948);Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=dt,nt.isBrowserMainThread=function(){return dt()&&"undefined"!=typeof document};var J=mt(tt(321)),At=mt(tt(344));function dt(){return!("object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,At.default)()}},344:(kt,nt,tt)=>{"use strict";var mt=tt(948);Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=function(dt){if("undefined"!=typeof window&&"object"===(0,J.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,J.default)(process.versions)&&Boolean(process.versions.electron))return!0;var Y="object"===("undefined"==typeof navigator?"undefined":(0,J.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,Te=dt||Y;return!!(Te&&Te.indexOf("Electron")>=0)};var J=mt(tt(321))},991:function(kt,nt,tt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(At,dt,Y,Te){void 0===Te&&(Te=Y),Object.defineProperty(At,Te,{enumerable:!0,get:function(){return dt[Y]}})}:function(At,dt,Y,Te){void 0===Te&&(Te=Y),At[Te]=dt[Y]}),J=this&&this.__exportStar||function(At,dt){for(var Y in At)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&mt(dt,At,Y)};Object.defineProperty(nt,"__esModule",{value:!0}),J(tt(180),nt),J(tt(103),nt),J(tt(965),nt),J(tt(1),nt),J(tt(417),nt),J(tt(451),nt),J(tt(735),nt)},180:(kt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.BlankNode=void 0,nt.BlankNode=class{constructor(J){this.termType="BlankNode",this.value=J}equals(J){return!!J&&"BlankNode"===J.termType&&J.value===this.value}}},103:(kt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.DataFactory=void 0;const mt=tt(180),J=tt(965),At=tt(1),dt=tt(417),Y=tt(451),Te=tt(735);let fe=0;nt.DataFactory=class{constructor(L){this.blankNodeCounter=0,this.blankNodePrefix=(L=L||{}).blankNodePrefix||`df_${fe++}_`}namedNode(L){return new dt.NamedNode(L)}blankNode(L){return new mt.BlankNode(L||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(L,ie){return new At.Literal(L,ie)}variable(L){return new Te.Variable(L)}defaultGraph(){return J.DefaultGraph.INSTANCE}quad(L,ie,$,v){return new Y.Quad(L,ie,$,v||this.defaultGraph())}fromTerm(L){switch(L.termType){case"NamedNode":return this.namedNode(L.value);case"BlankNode":return this.blankNode(L.value);case"Literal":return L.language?this.literal(L.value,L.language):L.datatype.equals(At.Literal.XSD_STRING)?this.literal(L.value):this.literal(L.value,this.fromTerm(L.datatype));case"Variable":return this.variable(L.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(L.subject),this.fromTerm(L.predicate),this.fromTerm(L.object),this.fromTerm(L.graph))}}fromQuad(L){return this.fromTerm(L)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(kt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.DefaultGraph=void 0;class tt{constructor(){this.termType="DefaultGraph",this.value=""}equals(J){return!!J&&"DefaultGraph"===J.termType}}nt.DefaultGraph=tt,tt.INSTANCE=new tt},1:(kt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.Literal=void 0;const mt=tt(417);class J{constructor(dt,Y){this.termType="Literal",this.value=dt,"string"==typeof Y?(this.language=Y,this.datatype=J.RDF_LANGUAGE_STRING):Y?(this.language="",this.datatype=Y):(this.language="",this.datatype=J.XSD_STRING)}equals(dt){return!!dt&&"Literal"===dt.termType&&dt.value===this.value&&dt.language===this.language&&dt.datatype.equals(this.datatype)}}nt.Literal=J,J.RDF_LANGUAGE_STRING=new mt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),J.XSD_STRING=new mt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(kt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.NamedNode=void 0,nt.NamedNode=class{constructor(J){this.termType="NamedNode",this.value=J}equals(J){return!!J&&"NamedNode"===J.termType&&J.value===this.value}}},451:(kt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.Quad=void 0,nt.Quad=class{constructor(J,At,dt,Y){this.termType="Quad",this.value="",this.subject=J,this.predicate=At,this.object=dt,this.graph=Y}equals(J){return!!J&&("Quad"===J.termType||!J.termType)&&this.subject.equals(J.subject)&&this.predicate.equals(J.predicate)&&this.object.equals(J.object)&&this.graph.equals(J.graph)}}},735:(kt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.Variable=void 0,nt.Variable=class{constructor(J){this.termType="Variable",this.value=J}equals(J){return!!J&&"Variable"===J.termType&&J.value===this.value}}},609:function(kt,nt,tt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(v,S,N,M){void 0===M&&(M=N),Object.defineProperty(v,M,{enumerable:!0,get:function(){return S[N]}})}:function(v,S,N,M){void 0===M&&(M=N),v[M]=S[N]}),J=this&&this.__exportStar||function(v,S){for(var N in v)"default"!==N&&!Object.prototype.hasOwnProperty.call(S,N)&&mt(S,v,N)};Object.defineProperty(nt,"__esModule",{value:!0}),nt.getSupportedJavaScriptPrimitives=nt.getSupportedRdfDatatypes=nt.getTermRaw=nt.toRdf=nt.fromRdf=void 0;const At=tt(991),dt=tt(938),Y=tt(60);J(tt(938),nt),J(tt(871),nt),J(tt(60),nt);const Te=new At.DataFactory,fe=new Y.Translator;function K(v,S){return fe.fromRdf(v,S)}fe.registerHandler(new dt.TypeHandlerString,dt.TypeHandlerString.TYPES.map(v=>Te.namedNode(v)),["string"]),fe.registerHandler(new dt.TypeHandlerBoolean,[dt.TypeHandlerBoolean.TYPE].map(v=>Te.namedNode(v)),["boolean"]),fe.registerHandler(new dt.TypeHandlerNumberDouble,dt.TypeHandlerNumberDouble.TYPES.map(v=>Te.namedNode(v)),["number"]),fe.registerHandler(new dt.TypeHandlerNumberInteger,dt.TypeHandlerNumberInteger.TYPES.map(v=>Te.namedNode(v)),["number"]),fe.registerHandler(new dt.TypeHandlerDate,dt.TypeHandlerDate.TYPES.map(v=>Te.namedNode(v)),["object"]),nt.fromRdf=K,nt.toRdf=function(v,S){return S&&"namedNode"in S&&(S={dataFactory:S}),(S=S||{})&&!S.dataFactory&&(S.dataFactory=Te),fe.toRdf(v,S)},nt.getTermRaw=function(v,S){return"Literal"===v.termType?K(v,S):v.value},nt.getSupportedRdfDatatypes=function(){return fe.getSupportedRdfDatatypes()},nt.getSupportedJavaScriptPrimitives=function(){return fe.getSupportedJavaScriptPrimitives()}},871:(kt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0})},60:(kt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.Translator=void 0,nt.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(J){throw new Error(`Invalid RDF ${J.datatype.value} value: '${J.value}'`)}registerHandler(J,At,dt){for(const Y of At)this.supportedRdfDatatypes.push(Y),this.fromRdfHandlers[Y.value]=J;for(const Y of dt){let Te=this.toRdfHandlers[Y];Te||(this.toRdfHandlers[Y]=Te=[]),Te.push(J)}}fromRdf(J,At){const dt=this.fromRdfHandlers[J.datatype.value];return dt?dt.fromRdf(J,At):J.value}toRdf(J,At){const dt=this.toRdfHandlers[typeof J];if(dt)for(const Y of dt){const Te=Y.toRdf(J,At);if(Te)return Te}throw new Error(`Invalid JavaScript value: '${J}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(kt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerBoolean=void 0;const mt=tt(60);class J{fromRdf(dt,Y){switch(dt.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return Y&&mt.Translator.incorrectRdfDataType(dt),!1}toRdf(dt,{datatype:Y,dataFactory:Te}){return Te.literal(dt?"true":"false",Y||Te.namedNode(J.TYPE))}}nt.TypeHandlerBoolean=J,J.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},525:(kt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerDate=void 0;const mt=tt(60);class J{fromRdf(dt,Y){switch(Y&&!dt.value.match(J.VALIDATORS[dt.datatype.value.substr(33,dt.datatype.value.length)])&&mt.Translator.incorrectRdfDataType(dt),dt.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(dt.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const Te=dt.value.split("-");return new Date(0,parseInt(Te[0],10)-1,parseInt(Te[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(dt.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(dt.value+"-01");default:return new Date(dt.value)}}toRdf(dt,{datatype:Y,dataFactory:Te}){if(Y=Y||Te.namedNode(J.TYPES[0]),!(dt instanceof Date))return null;const fe=dt;let K;switch(Y.value){case"http://www.w3.org/2001/XMLSchema#gDay":K=String(fe.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":K=fe.getUTCMonth()+1+"-"+fe.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":K=String(fe.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":K=fe.getUTCFullYear()+"-"+(fe.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":K=fe.toISOString().replace(/T.*$/,"");break;default:K=fe.toISOString()}return Te.literal(K,Y)}}nt.TypeHandlerDate=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],J.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(kt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerNumberDouble=void 0;const mt=tt(60);class J{fromRdf(dt,Y){const Te=parseFloat(dt.value);return Y&&isNaN(Te)&&mt.Translator.incorrectRdfDataType(dt),Te}toRdf(dt,{datatype:Y,dataFactory:Te}){return Y=Y||Te.namedNode(J.TYPES[0]),isNaN(dt)?Te.literal("NaN",Y):isFinite(dt)?dt%1==0?null:Te.literal(dt.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Y):Te.literal(dt>0?"INF":"-INF",Y)}}nt.TypeHandlerNumberDouble=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(kt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerNumberInteger=void 0;const mt=tt(60);class J{fromRdf(dt,Y){const Te=parseInt(dt.value,10);return Y&&(isNaN(Te)||dt.value.indexOf(".")>=0)&&mt.Translator.incorrectRdfDataType(dt),Te}toRdf(dt,{datatype:Y,dataFactory:Te}){return Te.literal(String(dt),Y||Te.namedNode(dt<=J.MAX_INT&&dt>=J.MIN_INT?J.TYPES[0]:J.TYPES[1]))}}nt.TypeHandlerNumberInteger=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],J.MAX_INT=2147483647,J.MIN_INT=-2147483648},608:(kt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerString=void 0;class tt{fromRdf(J){return J.value}toRdf(J,{datatype:At,dataFactory:dt}){return dt.literal(J,At)}}nt.TypeHandlerString=tt,tt.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:function(kt,nt,tt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(At,dt,Y,Te){void 0===Te&&(Te=Y),Object.defineProperty(At,Te,{enumerable:!0,get:function(){return dt[Y]}})}:function(At,dt,Y,Te){void 0===Te&&(Te=Y),At[Te]=dt[Y]}),J=this&&this.__exportStar||function(At,dt){for(var Y in At)"default"!==Y&&!Object.prototype.hasOwnProperty.call(dt,Y)&&mt(dt,At,Y)};Object.defineProperty(nt,"__esModule",{value:!0}),J(tt(727),nt),J(tt(525),nt),J(tt(554),nt),J(tt(750),nt),J(tt(608),nt)},595:(kt,nt,tt)=>{"use strict";var mt={};tt.r(mt),tt.d(mt,{decode:()=>Mfe,encode:()=>Dfe});var J={};tt.r(J),tt.d(J,{decode:()=>Pfe,encode:()=>Ffe});var At={};tt.r(At),tt.d(At,{decode:()=>Lfe,encode:()=>kfe});var dt={};function Y(n){return"function"==typeof n}tt.r(dt),tt.d(dt,{decode:()=>Bfe,encode:()=>jfe});let Te=!1;const fe={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Te&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Te=n},get useDeprecatedSynchronousErrorHandling(){return Te}};function K(n){setTimeout(()=>{throw n},0)}const V={closed:!0,next(n){},error(n){if(fe.useDeprecatedSynchronousErrorHandling)throw n;K(n)},complete(){}},L=Array.isArray||(n=>n&&"number"==typeof n.length);function ie(n){return null!==n&&"object"==typeof n}const v=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class S{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof S)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(Y(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof v?N(o.errors):[o]}}if(L(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(ie(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof v?e=e.concat(N(c.errors)):e.push(c)}}}if(e)throw new v(e)}add(e){let t=e;if(!e)return S.EMPTY;switch(typeof e){case"function":t=new S(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof S)){const s=t;t=new S,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof S){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function N(n){return n.reduce((e,t)=>e.concat(t instanceof v?t.errors:t),[])}S.EMPTY=((n=new S).closed=!0,n);const M="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends S{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=V;break;case 1:if(!e){this.destination=V;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new E(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new E(this,e,t,i)}}[M](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class E extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;Y(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==V&&(o=Object.create(t),Y(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;fe.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=fe;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):K(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;K(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);fe.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),fe.useDeprecatedSynchronousErrorHandling)throw i;K(i)}}__tryOrSetError(e,t,i){if(!fe.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return fe.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(K(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const O="function"==typeof Symbol&&Symbol.observable||"@@observable";function q(n){return n}let I=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[M])return n[M]()}return n||e||t?new y(n,e,t):new y(V)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||fe.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),fe.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){fe.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=X(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[O](){return this}pipe(...t){return 0===t.length?this:function(n){return 0===n.length?q:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=X(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function X(n){if(n||(n=fe.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const z=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class Q extends S{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class se extends y{constructor(e){super(e),this.destination=e}}let oe=(()=>{class n extends I{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[M](){return new se(this)}lift(t){const i=new ee(this,this);return i.operator=t,i}next(t){if(this.closed)throw new z;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new z;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new z;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new z;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new z;return this.hasError?(t.error(this.thrownError),S.EMPTY):this.isStopped?(t.complete(),S.EMPTY):(this.observers.push(t),new Q(this,t))}asObservable(){const t=new I;return t.source=this,t}}return n.create=(e,t)=>new ee(e,t),n})();class ee extends oe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):S.EMPTY}}function Se(n){return n&&"function"==typeof n.schedule}function pe(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new te(n,e))}}class te{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new _e(e,this.project,this.thisArg))}}class _e extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const De=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Xe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Fe=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ye(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const Ce=n=>{if(n&&"function"==typeof n[O])return(n=>e=>{const t=n[O]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(Fe(n))return De(n);if(Ye(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,K),e))(n);if(n&&"function"==typeof n[Xe])return(n=>e=>{const t=n[Xe]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${ie(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Ne(n,e){return new I(t=>{const i=new S;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function ke(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[O]}(n))return function(n,e){return new I(t=>{const i=new S;return i.add(e.schedule(()=>{const r=n[O]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Ye(n))return function(n,e){return new I(t=>{const i=new S;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(Fe(n))return Ne(n,e);if(function(n){return n&&"function"==typeof n[Xe]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new I(t=>{const i=new S;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Xe](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof I?n:new I(Ce(n))}class gt extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class ve extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function R(n,e){if(e.closed)return;if(n instanceof I)return n.subscribe(e);let t;try{t=Ce(n)(e)}catch(i){e.error(i)}return t}function B(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(B((r,s)=>ke(n(r,s)).pipe(pe((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Oe(n,t)))}class Oe{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Qe(e,this.project,this.concurrent))}}class Qe extends ve{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new gt(this),i=this.destination;i.add(t);const r=R(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function It(n=Number.POSITIVE_INFINITY){return B(q,n)}function In(n,e){return e?Ne(n,e):new I(De(n))}function Ln(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return Se(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof I?n[0]:It(e)(In(n,t))}function Wn(){return function(e){return e.lift(new Ei(e))}}class Ei{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new mi(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class mi extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Gr extends I{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new S,e.add(this.source.subscribe(new us(this.getSubject(),this))),e.closed&&(this._connection=null,e=S.EMPTY)),e}refCount(){return Wn()(this)}}const Ns=(()=>{const n=Gr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class us extends se{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}class Cl{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function da(){return new oe}function _s(){return n=>Wn()(function(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new Cl(r,e));const s=Object.create(i,Ns);return s.source=i,s.subjectFactory=r,s}}(da)(n))}function Jt(n){for(let e in n)if(n[e]===Jt)return e;throw Error("Could not find renamed property on target object.")}function qa(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function it(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(it).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function ot(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ut=Jt({__forward_ref__:Jt});function ge(n){return n.__forward_ref__=ge,n.toString=function(){return it(this())},n}function be(n){return Le(n)?n():n}function Le(n){return"function"==typeof n&&n.hasOwnProperty(ut)&&n.__forward_ref__===ge}class Ze extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function qt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():function(n){return"string"==typeof n?n:null==n?"":String(n)}(n)}function gn(n,e){const t=e?` in ${e}`:"";throw new Ze("201",`No provider for ${qt(n)} found${t}`)}function Z(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function We(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Et(n){return{providers:n.providers||[],imports:n.imports||[]}}function mn(n){return ys(n,ao)||ys(n,Fs)}function ys(n,e){return n.hasOwnProperty(e)?n[e]:null}function Al(n){return n&&(n.hasOwnProperty(Pr)||n.hasOwnProperty(dc))?n[Pr]:null}const ao=Jt({\u0275prov:Jt}),Pr=Jt({\u0275inj:Jt}),Fs=Jt({ngInjectableDef:Jt}),dc=Jt({ngInjectorDef:Jt});var wn=(()=>((wn=wn||{})[wn.Default=0]="Default",wn[wn.Host=1]="Host",wn[wn.Self=2]="Self",wn[wn.SkipSelf=4]="SkipSelf",wn[wn.Optional=8]="Optional",wn))();let lo;function fa(n){const e=lo;return lo=n,e}function id(n,e,t){const i=mn(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&wn.Optional?null:void 0!==e?e:void gn(it(n),"Injector")}function Ae(n){return{toString:n}.toString()}var Ue=(()=>((Ue=Ue||{})[Ue.OnPush=0]="OnPush",Ue[Ue.Default=1]="Default",Ue))(),Ht=(()=>((Ht=Ht||{})[Ht.Emulated=0]="Emulated",Ht[Ht.None=2]="None",Ht[Ht.ShadowDom=3]="ShadowDom",Ht))();const si="undefined"!=typeof globalThis&&globalThis,Fr="undefined"!=typeof window&&window,Kr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,bs="undefined"!=typeof global&&global,ni=si||bs||Fr||Kr,rd={},Xi=[],$f=Jt({\u0275cmp:Jt}),Am=Jt({\u0275dir:Jt}),fh=Jt({\u0275pipe:Jt}),wb=Jt({\u0275mod:Jt}),IC=Jt({\u0275loc:Jt}),Ml=Jt({\u0275fac:Jt}),ph=Jt({__NG_ELEMENT_ID__:Jt});let OC=0;function Sn(n){return Ae(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ue.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Xi,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Ht.Emulated,id:"c",styles:n.styles||Xi,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=OC++,i.inputs=Cb(n.inputs,t),i.outputs=Cb(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(Eb):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(Sb):null,i})}function Eb(n){return Fi(n)||function(n){return n[Am]||null}(n)}function Sb(n){return function(n){return n[fh]||null}(n)}const xb={};function _n(n){return Ae(()=>{const e={type:n.type,bootstrap:n.bootstrap||Xi,declarations:n.declarations||Xi,imports:n.imports||Xi,exports:n.exports||Xi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(xb[n.id]=n.type),e})}function Cb(n,e){if(null==n)return rd;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Lt=Sn;function Ls(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Fi(n){return n[$f]||null}function Co(n,e){const t=n[wb]||null;if(!t&&!0===e)throw new Error(`Type ${it(n)} does not have '\u0275mod' property.`);return t}function Go(n){return Array.isArray(n)&&"object"==typeof n[1]}function $o(n){return Array.isArray(n)&&!0===n[1]}function Dm(n){return 0!=(8&n.flags)}function ld(n){return 2==(2&n.flags)}function cd(n){return 1==(1&n.flags)}function ma(n){return null!==n.template}function Ab(n){return 0!=(512&n[2])}function pc(n,e){return n.hasOwnProperty(Ml)?n[Ml]:null}class Nm{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Qi(){return Db}function Db(n){return n.type.prototype.ngOnChanges&&(n.setInput=jC),BC}function BC(){const n=st(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===rd)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function jC(n,e,t,i){const r=st(n)||function(n,e){return n[vh]=e}(n,{previous:rd,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new Nm(l&&l.currentValue,e,o===rd),n[i]=e}Qi.ngInherit=!0;const vh="__ngSimpleChanges__";function st(n){return n[vh]||null}let Gi;function cr(n){return!!n.listen}const ou={createRenderer:(n,e)=>void 0!==Gi?Gi:"undefined"!=typeof document?document:void 0};function vr(n){for(;Array.isArray(n);)n=n[0];return n}function Ys(n,e){return vr(e[n.index])}function Lm(n,e){return n.data[e]}function Bs(n,e){const t=e[n];return Go(t)?t:t[0]}function Ol(n){return 4==(4&n[2])}function dd(n){return 128==(128&n[2])}function ya(n,e){return null==e?null:n[e]}function km(n){n[18]=0}function Kf(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Bn={lFrame:lu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ob(){return Bn.bindingsEnabled}function Ft(){return Bn.lFrame.lView}function _i(){return Bn.lFrame.tView}function Br(n){return Bn.lFrame.contextLView=n,n[8]}function ns(){let n=Bm();for(;null!==n&&64===n.type;)n=n.parent;return n}function Bm(){return Bn.lFrame.currentTNode}function Xa(n,e){const t=Bn.lFrame;t.currentTNode=n,t.isParent=e}function jr(){return Bn.lFrame.isParent}function xh(){return Bn.isInCheckNoChangesMode}function Xf(n){Bn.isInCheckNoChangesMode=n}function hd(n,e){const t=Bn.lFrame;t.bindingIndex=t.bindingRootIndex=n,jm(e)}function jm(n){Bn.lFrame.currentDirectiveIndex=n}function Rb(){return Bn.lFrame.currentQueryIndex}function Um(n){Bn.lFrame.currentQueryIndex=n}function Zf(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function fd(n,e,t){if(t&wn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&wn.Host||(r=Zf(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Bn.lFrame=Ee();return i.currentTNode=e,i.lView=n,!0}function Th(n){const e=Ee(),t=n[1];Bn.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Ee(){const n=Bn.lFrame,e=null===n?null:n.child;return null===e?lu(n):e}function lu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Mh(){const n=Bn.lFrame;return Bn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Mo=Mh;function ci(){const n=Mh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Xs(){return Bn.lFrame.selectedIndex}function ho(n){Bn.lFrame.selectedIndex=n}function Jf(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=d&&(n.destroyHooks||(n.destroyHooks=[])).push(t,d)}}function ep(n,e,t){Qa(n,e,3,t)}function tp(n,e,t,i){(3&n[2])===t&&Qa(n,e,t,i)}function zm(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Qa(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(JC(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function JC(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Dh{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function np(n,e,t){const i=cr(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];Gm(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Nb(n){return 3===n||4===n||6===n}function Gm(n){return 64===n.charCodeAt(0)}function Ih(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||$m(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function $m(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function Pb(n){return-1!==n}function pd(n){return 32767&n}function Za(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let gd=!0;function ip(n){const e=gd;return gd=n,e}let qm=0;function js(n,e){const t=rp(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,Km(i.data,n),Km(e,null),Km(i.blueprint,null));const r=Oh(n,e),s=n.injectorIndex;if(Pb(r)){const o=pd(r),a=Za(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Km(n,e){n.push(0,0,0,0,0,0,0,0,e)}function rp(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Oh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function mc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(ph)&&(i=t[ph]),null==i&&(i=t[ph]=qm++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function Ym(n,e,t){if(t&wn.Optional)return n;gn(e,"NodeInjector")}function Lb(n,e,t,i){if(t&wn.Optional&&void 0===i&&(i=null),0==(t&(wn.Self|wn.Host))){const r=n[9],s=fa(void 0);try{return r?r.get(e,i,t&wn.Optional):id(e,i,t&wn.Optional)}finally{fa(s)}}return Ym(i,e,t)}function Rh(n,e,t,i=wn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(ph)?n[ph]:void 0;return"number"==typeof e?e>=0?255&e:Bb:e}(t);if("function"==typeof s){if(!fd(e,n,i))return i&wn.Host?Ym(r,t,i):Lb(e,t,i,r);try{const o=s(i);if(null!=o||i&wn.Optional)return o;gn(t)}finally{Mo()}}else if("number"==typeof s){let o=null,a=rp(n,e),l=-1,c=i&wn.Host?e[16][6]:null;for((-1===a||i&wn.SkipSelf)&&(l=-1===a?Oh(n,e):e[a+8],-1!==l&&Nh(i,!1)?(o=e[1],a=pd(l),e=Za(l,e)):a=-1);-1!==a;){const d=e[1];if(sp(s,a,d.data)){const f=Es(a,e,t,o,i,c);if(f!==kb)return f}l=e[a+8],-1!==l&&Nh(i,e[1].data[a+8]===c)&&sp(s,a,e)?(o=d,a=pd(l),e=Za(l,e)):a=-1}}}return Lb(e,t,i,r)}const kb={};function Bb(){return new qo(ns(),Ft())}function Es(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],d=md(a,o,t,null==i?ld(a)&&gd:i!=o&&0!=(3&a.type),r&wn.Host&&s===a);return null!==d?_d(e,o,d,a):kb}function md(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,d=s>>20,p=r?a+d:n.directiveEnd;for(let g=i?a:a+d;g<p;g++){const _=o[g];if(g<l&&t===_||g>=l&&_.type===t)return g}if(r){const g=o[l];if(g&&ma(g)&&g.type===t)return l}return null}function _d(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof Dh}(r)){const o=r;o.resolving&&function(n,e){throw new Ze("200",`Circular dependency in DI detected for ${n}`)}(qt(s[t]));const a=ip(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?fa(o.injectImpl):null;fd(n,i,wn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=Db(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&fa(l),ip(a),o.resolving=!1,Mo()}}return r}function sp(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Nh(n,e){return!(n&wn.Self||n&wn.Host&&e)}class qo{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Rh(this._tNode,this._lView,e,void 0,t)}}function rr(n){return Ae(()=>{const e=n.prototype.constructor,t=e[Ml]||Ss(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Ml]||Ss(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Ss(n){return Le(n)?()=>{const e=Ss(be(n));return e&&e()}:pc(n)}const bd="__parameters__";function Sa(n,e,t){return Ae(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,d){const f=l.hasOwnProperty(bd)?l[bd]:Object.defineProperty(l,bd,{value:[]})[bd];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Vt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=We({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Ko(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),Ko(i,e)):e!==n&&e.push(i)}return e}function Yo(n,e){n.forEach(t=>Array.isArray(t)?Yo(t,e):e(t))}function Fh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Nl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Do(n,e,t){let i=xs(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function t_(n,e){const t=xs(n,e);if(t>=0)return n[1|t]}function xs(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const pu={},up="__NG_DI_FLAG__",vc="ngTempTokenPath",wc=/\n/gm,tl="__source",dp=Jt({provide:String,useValue:Jt});let gu;function Ed(n){const e=gu;return gu=n,e}function g1(n,e=wn.Default){if(void 0===gu)throw new Error("inject() must be called from an injection context");return null===gu?id(n,void 0,e):gu.get(n,e&wn.Optional?null:void 0,e)}function Ie(n,e=wn.Default){return(lo||g1)(be(n),e)}const Ec=Ie;function mu(n){const e=[];for(let t=0;t<n.length;t++){const i=be(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=wn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=Gb(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Ie(r,s))}else e.push(Ie(i))}return e}function Sd(n,e){return n[up]=e,n.prototype[up]=e,n}function Gb(n){return n[up]}function Qs(n,e,t,i){const r=n[vc];throw e[tl]&&r.unshift(e[tl]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=it(e);if(Array.isArray(e))r=e.map(it).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):it(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(wc,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[vc]=null,n}const xd=Sd(Sa("Inject",n=>({token:n})),-1),Xr=Sd(Sa("Optional"),8),nl=Sd(Sa("SkipSelf"),4);const y_="__ngContext__";function Cs(n,e){n[y_]=e}function b_(n){const e=function(n){return n[y_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function Sp(n){return n.ngOriginalError}function j1(n,...e){n.error(...e)}class Jo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||j1}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(Sp(e)):null}_findOriginalError(e){let t=e&&Sp(e);for(;t&&Sp(t);)t=Sp(t);return t||null}}const _v=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ni))();function rl(n){return n instanceof Function?n():n}var Ro=(()=>((Ro=Ro||{})[Ro.Important=1]="Important",Ro[Ro.DashCase=2]="DashCase",Ro))();function x_(n,e){return undefined(n,e)}function zh(n){const e=n[3];return $o(e)?e[3]:e}function Id(n){return Ev(n[13])}function A_(n){return Ev(n[4])}function Ev(n){for(;null!==n&&!$o(n);)n=n[4];return n}function Od(n,e,t,i,r){if(null!=i){let s,o=!1;$o(i)?s=i:Go(i)&&(o=!0,i=i[0]);const a=vr(i);0===n&&null!==t?null==r?Tv(e,t,a):sl(e,t,a,r||null,!0):1===n&&null!==t?sl(e,t,a,r||null,!0):2===n?function(n,e,t){const i=Ap(n,e);i&&function(n,e,t,i){cr(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==vr(t)&&Od(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Rd(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function M_(n,e,t){return cr(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function xv(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Kf(r,-1)),t.splice(i,1)}function D_(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&xv(r,i),e>0&&(n[t-1][4]=i[4]);const s=Nl(n,10+e);!function(n,e){Rd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function I_(n,e){if(!(256&e[2])){const t=e[11];cr(t)&&t.destroyNode&&Rd(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return Cp(n[1],n);for(;e;){let t=null;if(Go(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Go(e)&&Cp(e[1],e),e=e[3];null===e&&(e=n),Go(e)&&Cp(e[1],e),t=e&&e[4]}e=t}}(e)}}function Cp(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Dh)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):vr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&cr(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&$o(e[3])){t!==e[3]&&xv(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function Cv(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Ht.None||r===Ht.Emulated)return null}return Ys(i,t)}(n,e.parent,t)}function sl(n,e,t,i,r){cr(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function Tv(n,e,t){cr(n)?n.appendChild(e,t):e.appendChild(t)}function Mv(n,e,t,i,r){null!==i?sl(n,e,t,i,r):Tv(n,e,t)}function Ap(n,e){return cr(n)?n.parentNode(e):e.parentNode}let Ov=function(n,e,t){return 40&n.type?Ys(n,t):null};function Tp(n,e,t,i){const r=Cv(n,i,e),s=e[11],a=function(n,e,t){return Ov(n,e,t)}(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)Mv(s,r,t[l],a,!1);else Mv(s,r,t,a,!1)}function vu(n,e){if(null!==e){const t=e.type;if(3&t)return Ys(e,n);if(4&t)return Mp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return vu(n,i);{const r=n[e.index];return $o(r)?Mp(-1,r):vr(r)}}if(32&t)return x_(e,n)()||vr(n[e.index]);{const i=Nv(n,e);return null!==i?Array.isArray(i)?i[0]:vu(zh(n[16]),i):vu(n,e.next)}}return null}function Nv(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Mp(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return vu(i,r)}return e[7]}function Hh(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Cs(vr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)Hh(n,e,t.child,i,r,s,!1),Od(e,n,r,a,s);else if(32&l){const c=x_(t,i);let d;for(;d=c();)Od(e,n,r,d,s);Od(e,n,r,a,s)}else 16&l?N_(n,e,i,t,r,s):Od(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Rd(n,e,t,i,r,s){Hh(t,i,n.firstChild,e,r,s,!1)}function N_(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Od(e,n,r,l[c],s);else Hh(n,e,l,o[3],r,s,!0)}function Lv(n,e,t){cr(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function P_(n,e,t){cr(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function Gh(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const kv="ng-template";function uA(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==Gh(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Dp(n){return 4===n.type&&n.value!==kv}function Bv(n,e,t){return e===(4!==n.type||t?n.value:kv)}function dA(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(Nb(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Bv(n,l,t)||""===l&&1===e.length){if(Ca(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!uA(n.attrs,c,t)){if(Ca(i))return!1;o=!0}continue}const f=hA(8&i?"class":l,r,Dp(n),t);if(-1===f){if(Ca(i))return!1;o=!0;continue}if(""!==c){let p;p=f>s?"":r[f+1].toLowerCase();const g=8&i?p:null;if(g&&-1!==Gh(g,c,0)||2&i&&c!==p){if(Ca(i))return!1;o=!0}}}}else{if(!o&&!Ca(i)&&!Ca(l))return!1;if(o&&Ca(l))continue;o=!1,i=l|1&i}}return Ca(i)||o}function Ca(n){return 0==(1&n)}function hA(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function jv(n,e,t=!1){for(let i=0;i<e.length;i++)if(dA(n,e[i],t))return!0;return!1}function Vv(n,e){return n?":not("+e.trim()+")":e}function _A(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ca(o)&&(e+=Vv(s,r),r=""),i=o,s=s||!Ca(i);t++}return""!==r&&(e+=Vv(s,r)),e}const Mn={};function ol(n,e){return n<<17|e<<2}function On(n){return n>>17&32767}function wr(n){return 2|n}function Bl(n){return(131068&n)>>2}function al(n,e){return-131069&n|e<<2}function L_(n){return 1|n}function Xv(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];Um(r),o.contentQueries(2,e[s],s)}}}function Wh(n,e,t,i,r,s,o,a,l,c){const d=e.blueprint.slice();return d[0]=r,d[2]=140|i,km(d),d[3]=d[15]=n,d[8]=t,d[10]=o||n&&n[10],d[11]=a||n&&n[11],d[12]=l||n&&n[12]||null,d[9]=c||n&&n[9]||null,d[6]=s,d[16]=2==e.type?n[16]:d,d}function Pd(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=Bm(),o=jr(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Bn.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Bn.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Xa(s,!0),s}function Fd(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function qh(n,e,t){Th(e);try{const i=n.viewQuery;null!==i&&Z_(1,i,t);const r=n.template;null!==r&&Qv(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Xv(n,e),n.staticViewQueries&&Z_(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)qA(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,ci()}}function Ld(n,e,t,i){const r=e[2];if(256==(256&r))return;Th(e);const s=xh();try{km(e),function(n){Bn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Qv(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&ep(e,c,null)}else{const c=n.preOrderHooks;null!==c&&tp(e,c,0,null),zm(e,0)}if(function(n){for(let e=Id(n);null!==e;e=A_(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&Kf(s,1),r[2]|=1024}}}(e),function(n){for(let e=Id(n);null!==e;e=A_(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];dd(i)&&Ld(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&Xv(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&ep(e,c)}else{const c=n.contentHooks;null!==c&&tp(e,c,1),zm(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)ho(~r);else{const s=r,o=t[++i],a=t[++i];hd(o,s),a(2,e[s])}}}finally{ho(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)WA(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&Z_(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&ep(e,c)}else{const c=n.viewHooks;null!==c&&tp(e,c,2),zm(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Kf(e[3],-1))}finally{ci()}}function IA(n,e,t,i){const r=e[10],s=!xh(),o=Ol(e);try{s&&!o&&r.begin&&r.begin(),o&&qh(n,e,i),Ld(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function Qv(n,e,t,i,r){const s=Xs(),o=2&i;try{ho(-1),o&&e.length>20&&function(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&ep(e,s,t)}else{const s=n.preOrderHooks;null!==s&&tp(e,s,0,t)}ho(t)}(n,e,20,xh()),t(i,r)}finally{ho(s)}}function Kh(n,e,t){!Ob()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||js(t,e),Cs(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=ma(l);c&&UA(e,t,l);const d=_d(e,n,a,t);Cs(d,e),null!==o&&zA(0,a-r,d,l,0,o),c&&(Bs(t.index,e)[8]=d)}}(n,e,t,Ys(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Bn.lFrame.currentDirectiveIndex;try{ho(o);for(let l=i;l<r;l++){const c=n.data[l],d=e[l];jm(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&aw(c,d)}}finally{ho(-1),jm(a)}}(n,e,t))}function H_(n,e,t=Ys){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Np(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Pp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Pp(n,e,t,i,r,s,o,a,l,c){const d=20+i,f=d+r,p=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Mn);return t}(d,f),g="function"==typeof c?c():c;return p[1]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function ew(n,e,t,i){const r=dw(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Lp(n).push(i,r.length-1))}function tw(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function G_(n,e,t,i){let r=!1;if(Ob()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];jv(t,o.selectors,!1)&&(r||(r=[]),mc(js(t,e),n,o.type),ma(o)?(lw(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,$_(t,n.data.length,s.length);for(let d=0;d<s.length;d++){const f=s[d];f.providersResolver&&f.providersResolver(f)}let a=!1,l=!1,c=Fd(n,e,s.length,null);for(let d=0;d<s.length;d++){const f=s[d];t.mergedAttrs=Ih(t.mergedAttrs,f.hostAttrs),W_(n,t,e,c,f),VA(c,f,o),null!==f.contentQueries&&(t.flags|=8),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=128);const p=f.type.prototype;!a&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const d=r[c],f=d.inputs,p=null===s||Dp(e)?null:HA(f,s);o.push(p),a=tw(f,c,a),l=tw(d.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Ze("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Ih(t.mergedAttrs,t.attrs),r}function ow(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function aw(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function lw(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function VA(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ma(e)&&(t[""]=n)}}function $_(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function W_(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=pc(r.type)),o=new Dh(s,ma(r),null);n.blueprint[i]=o,t[i]=o,ow(n,e,0,i,Fd(n,t,r.hostVars,Mn),r)}function UA(n,e,t){const i=Ys(e,n),r=Np(t),s=n[10],o=Fp(n,Wh(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function zA(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],d=o[l++],f=o[l++];null!==a?i.setInput(t,f,c,d):t[d]=f}}}function HA(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function cw(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function WA(n,e){const t=Bs(e,n);if(dd(t)){const i=t[1];80&t[2]?Ld(i,t,i.template,t[8]):t[5]>0&&K_(t)}}function K_(n){for(let i=Id(n);null!==i;i=A_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Ld(o,s,o.template,s[8])}else s[5]>0&&K_(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Bs(t[i],n);dd(r)&&r[5]>0&&K_(r)}}function qA(n,e){const t=Bs(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),qh(i,t,t[8])}function Fp(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function Y_(n){for(;n;){n[2]|=64;const e=zh(n);if(Ab(n)&&!e)return n;n=e}return null}function Q_(n,e,t){const i=e[10];i.begin&&i.begin();try{Ld(n,e,n.template,t)}catch(r){throw ey(e,r),r}finally{i.end&&i.end()}}function uw(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=b_(t),r=i[1];IA(r,i,r.template,t)}}(n[8])}function Z_(n,e,t){Um(0),e(n,t)}const ZA=(()=>Promise.resolve(null))();function dw(n){return n[7]||(n[7]=[])}function Lp(n){return n.cleanup||(n.cleanup=[])}function ey(n,e){const t=n[9],i=t?t.get(Jo,null):null;i&&i.handleError(e)}function hw(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function kp(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=ot(r,a):2==s&&(i=ot(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Bd=new Vt("INJECTOR",-1);class eo{get(e,t=pu){if(t===pu){const i=new Error(`NullInjectorError: No provider for ${it(e)}!`);throw i.name="NullInjectorError",i}return t}}const wu=new Vt("Set Injector scope."),Yh={},eT={};let ny;function fw(){return void 0===ny&&(ny=new eo),ny}function pw(n,e=null,t=null,i){return new ry(n,t,e||fw(),i)}class ry{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Yo(t,a=>this.processProvider(a,e,t)),Yo([e],a=>this.processInjectorType(a,[],s)),this.records.set(Bd,Eu(void 0,this));const o=this.records.get(wu);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:it(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=pu,i=wn.Default){this.assertNotDestroyed();const r=Ed(this),s=fa(void 0);try{if(!(i&wn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof Vt}(e)&&mn(e);a=l&&this.injectableDefInScope(l)?Eu(sy(e),Yh):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&wn.Self?fw():this.parent).get(e,t=i&wn.Optional&&t===pu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[vc]=o[vc]||[]).unshift(it(e)),r)throw o;return Qs(o,e,"R3InjectorError",this.source)}throw o}finally{fa(s),Ed(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(it(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=be(e)))return!1;let r=Al(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Al(s)),null==r)return!1;if(null!=r.imports&&!a){let d;i.push(o);try{Yo(r.imports,f=>{this.processInjectorType(f,t,i)&&(void 0===d&&(d=[]),d.push(f))})}finally{}if(void 0!==d)for(let f=0;f<d.length;f++){const{ngModule:p,providers:g}=d[f];Yo(g,_=>this.processProvider(_,p,g||Xi))}}this.injectorDefTypes.add(o);const l=pc(o)||(()=>new o);this.records.set(o,Eu(l,Yh));const c=r.providers;if(null!=c&&!a){const d=e;Yo(c,f=>this.processProvider(f,d,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=Tc(e=be(e))?e:be(e&&e.provide);const s=function(n,e,t){return mw(n)?Eu(void 0,n.useValue):Eu(function(n,e,t){let i;if(Tc(n)){const r=be(n);return pc(r)||sy(r)}if(mw(n))i=()=>be(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...mu(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>Ie(be(n.useExisting));else{const r=be(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return pc(r)||sy(r);i=()=>new r(...mu(n.deps))}return i}(n),Yh)}(e);if(Tc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Eu(void 0,Yh,!0),o.factory=()=>mu(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===Yh&&(t.value=eT,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=be(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function sy(n){const e=mn(n),t=null!==e?e.factory:pc(n);if(null!==t)return t;if(n instanceof Vt)throw new Error(`Token ${it(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=function(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?");throw new Error(`Can't resolve all parameters for ${it(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[ao]||n[Fs]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function Eu(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function mw(n){return null!==n&&"object"==typeof n&&dp in n}function Tc(n){return"function"==typeof n}const _w=function(n,e,t){return function(n,e=null,t=null,i){const r=pw(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class $n{static create(e,t){return Array.isArray(e)?_w(e,t,""):_w(e.providers,e.parent,e.name||"")}}function Y7(n,e){Jf(b_(n)[1],ns())}function Pn(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(ma(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=pT(n.inputs),o.declaredInputs=pT(n.declaredInputs),o.outputs=pT(n.outputs);const a=r.hostBindings;a&&J7(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&Q7(n,l),c&&Z7(n,c),qa(n.inputs,r.inputs),qa(n.declaredInputs,r.declaredInputs),qa(n.outputs,r.outputs),ma(r)&&r.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Pn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Ih(r.hostAttrs,t=Ih(t,r.hostAttrs))}}(i)}function pT(n){return n===rd?{}:n===Xi?[]:n}function Q7(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function Z7(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function J7(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}$n.THROW_IF_NOT_FOUND=pu,$n.NULL=new eo,$n.\u0275prov=We({token:$n,providedIn:"any",factory:()=>Ie(Bd)}),$n.__NG_ELEMENT_ID__=-1;let Ew=null;function Bp(){if(!Ew){const n=ni.Symbol;if(n&&n.iterator)Ew=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Ew=i)}}}return Ew}class Ul{constructor(e){this.wrapped=e}static wrap(e){return new Ul(e)}static unwrap(e){return Ul.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Ul}}function uy(n){return!!gT(n)&&(Array.isArray(n)||!(n instanceof Map)&&Bp()in n)}function gT(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function mo(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Me(n,e=wn.Default){const t=Ft();return null===t?Ie(n,e):Rh(ns(),t,be(n),e)}function vn(n,e,t){const i=Ft();return mo(i,Bn.lFrame.bindingIndex++,e)&&function(n,e,t,i,r,s,o,a){const l=Ys(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[i])?(hw(n,t,d,i,r),ld(e)&&function(n,e){const t=Bs(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,cr(s)?s.setProperty(l,i,r):Gm(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}(_i(),function(){const n=Bn.lFrame;return Lm(n.tView,n.selectedIndex)}(),i,n,e,i[11],t,!1),vn}function vT(n,e,t,i,r){const o=r?"class":"style";hw(n,t,e.inputs[o],o,i)}function Xt(n,e,t,i){const r=Ft(),s=_i(),o=20+n,a=r[11],l=r[o]=M_(a,e,Bn.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=Pd(e,n,2,r,ya(a,s));return G_(e,t,c,ya(a,o)),null!==c.attrs&&kp(c,c.attrs,!1),null!==c.mergedAttrs&&kp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Xa(c,!0);const d=c.mergedAttrs;null!==d&&np(a,l,d);const f=c.classes;null!==f&&P_(a,l,f);const p=c.styles;null!==p&&Lv(a,l,p),64!=(64&c.flags)&&Tp(s,r,l,c),0===Bn.lFrame.elementDepthCount&&Cs(l,r),Bn.lFrame.elementDepthCount++,cd(c)&&(Kh(s,r,c),function(n,e,t){if(Dm(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&H_(r,c)}function Qt(){let n=ns();jr()?Bn.lFrame.isParent=!1:(n=n.parent,Xa(n,!1));const e=n;Bn.lFrame.elementDepthCount--;const t=_i();t.firstCreatePass&&(Jf(t,n),Dm(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&vT(t,e,Ft(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&vT(t,e,Ft(),e.stylesWithoutHost,!1)}function hy(n){return!!n&&"function"==typeof n.then}function QF(n){return!!n&&"function"==typeof n.subscribe}const Cw=QF;function fi(n,e,t,i){const r=Ft(),s=_i(),o=ns();return function(n,e,t,i,r,s,o,a){const l=cd(i),d=n.firstCreatePass&&Lp(n),f=e[8],p=dw(e);let g=!0;if(3&i.type||a){const T=Ys(i,e),W=a?a(T):T,H=p.length,me=a?Re=>a(vr(Re[i.index])):i.index;if(cr(t)){let Re=null;if(!a&&l&&(Re=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Re)(Re.__ngLastListenerFn__||Re).__ngNextListenerFn__=s,Re.__ngLastListenerFn__=s,g=!1;else{s=wT(i,e,f,s,!1);const ze=t.listen(W,r,s);p.push(s,ze),d&&d.push(r,me,H,H+1)}}else s=wT(i,e,f,s,!0),W.addEventListener(r,s,o),p.push(s),d&&d.push(r,me,H,o)}else s=wT(i,e,f,s,!1);const _=i.outputs;let C;if(g&&null!==_&&(C=_[r])){const T=C.length;if(T)for(let W=0;W<T;W+=2){const Ge=e[C[W]][C[W+1]].subscribe(s),at=p.length;p.push(s,Ge),d&&d.push(r,i.index,at,-(at+1))}}}(s,r,r[11],o,n,e,!!t,i),fi}function JF(n,e,t,i){try{return!1!==t(i)}catch(r){return ey(n,r),!1}}function wT(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Bs(n.index,e):e;0==(32&e[2])&&Y_(a);let l=JF(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=JF(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function bi(n=1){return function(n){return(Bn.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Bn.lFrame.contextLView))[8]}(n)}function c2(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?On(s):Bl(s),l=!1;for(;0!==a&&(!1===l||o);){const d=n[a+1];L9(n[a],e)&&(l=!0,n[a+1]=i?L_(d):wr(d)),a=i?On(d):Bl(d)}l&&(n[t+1]=i?wr(s):L_(s))}function L9(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&xs(n,e)>=0}const Ts={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function u2(n){return n.substring(Ts.key,Ts.keyEnd)}function d2(n,e){const t=Ts.textEnd;return t===e?-1:(e=Ts.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Ts.key=e,t),Qp(n,e,t))}function Qp(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function xu(n){!function(n,e,t,i){const r=_i(),s=function(n){const e=Bn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);r.firstUpdatePass&&function(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Xs()],o=m2(n,t);w2(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=function(n){const e=Bn.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=py(t=ST(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=ST(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Bl(i))return n[On(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=ST(null,n,e,l[1],i),l=py(l,e.attrs,i),function(n,e,t,i){n[On(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=py(i,n[s].hostAttrs,t);return py(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=On(o),l=Bl(o);n[i]=t;let d,c=!1;if(Array.isArray(t)){const f=t;d=f[1],(null===d||xs(f,d)>0)&&(c=!0)}else d=t;if(r)if(0!==l){const p=On(n[a+1]);n[i+1]=ol(p,a),0!==p&&(n[p+1]=al(n[p+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=ol(a,0),0!==a&&(n[a+1]=al(n[a+1],i)),a=i;else n[i+1]=ol(l,0),0===a?a=i:n[l+1]=al(n[l+1],i),l=i;c&&(n[i+1]=wr(n[i+1])),c2(n,d,i,!0),c2(n,d,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&xs(s,e)>=0&&(t[i+1]=L_(t[i+1]))}(e,d,n,i,s),o=ol(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(r,null,s,i);const o=Ft();if(t!==Mn&&mo(o,s,t)){const a=r.data[Xs()];if(w2(a,i)&&!m2(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=ot(l,t||"")),vT(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===Mn&&(r=Xi);let l=0,c=0,d=0<r.length?r[0]:null,f=0<s.length?s[0]:null;for(;null!==d||null!==f;){const p=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let C,_=null;d===f?(l+=2,c+=2,p!==g&&(_=f,C=g)):null===f||null!==d&&d<f?(l+=2,_=d):(c+=2,_=f,C=g),null!==_&&b2(n,e,t,i,_,C,o,a),d=l<r.length?r[l]:null,f=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return Xi;const i=[],r=function(n){return n instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(Do,Ic,n,!0)}function Ic(n,e){for(let t=function(n){return function(n){Ts.key=0,Ts.keyEnd=0,Ts.value=0,Ts.valueEnd=0,Ts.textEnd=n.length}(n),d2(n,Qp(n,0,Ts.textEnd))}(e);t>=0;t=d2(e,t))Do(n,u2(e),!0)}function m2(n,e){return e>=n.expandoStartIndex}function ST(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=py(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function py(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Do(n,o,!!t||e[++s]))}return void 0===n?null:n}function b2(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];Mw(function(n){return 1==(1&n)}(c)?v2(l,e,t,r,Bl(c),o):void 0)||(Mw(s)||function(n){return 2==(2&n)}(c)&&(s=v2(l,null,t,r,a,o)),function(n,e,t,i,r){const s=cr(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Ro.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Ro.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,function(n,e){return vr(e[n])}(Xs(),t),r,s))}function v2(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),d=c?l[1]:l,f=null===d;let p=t[r+1];p===Mn&&(p=f?Xi:void 0);let g=f?t_(p,i):d===i?p:void 0;if(c&&!Mw(g)&&(g=t_(l,i)),Mw(g)&&(a=g,o))return a;const _=n[r+1];r=o?On(_):Bl(_)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=t_(l,i))}return a}function Mw(n){return void 0!==n}function w2(n,e){return 0!=(n.flags&(e?16:32))}const Qh=void 0;var mW=["en",[["a","p"],["AM","PM"],Qh],[["AM","PM"],Qh,Qh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Qh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Qh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Qh,"{1} 'at' {0}",Qh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let Zp={};function j2(n){return n in Zp||(Zp[n]=ni.ng&&ni.ng.common&&ni.ng.common.locales&&ni.ng.common.locales[n]),Zp[n]}var on=(()=>((on=on||{})[on.LocaleId=0]="LocaleId",on[on.DayPeriodsFormat=1]="DayPeriodsFormat",on[on.DayPeriodsStandalone=2]="DayPeriodsStandalone",on[on.DaysFormat=3]="DaysFormat",on[on.DaysStandalone=4]="DaysStandalone",on[on.MonthsFormat=5]="MonthsFormat",on[on.MonthsStandalone=6]="MonthsStandalone",on[on.Eras=7]="Eras",on[on.FirstDayOfWeek=8]="FirstDayOfWeek",on[on.WeekendRange=9]="WeekendRange",on[on.DateFormat=10]="DateFormat",on[on.TimeFormat=11]="TimeFormat",on[on.DateTimeFormat=12]="DateTimeFormat",on[on.NumberSymbols=13]="NumberSymbols",on[on.NumberFormats=14]="NumberFormats",on[on.CurrencyCode=15]="CurrencyCode",on[on.CurrencySymbol=16]="CurrencySymbol",on[on.CurrencyName=17]="CurrencyName",on[on.Currencies=18]="Currencies",on[on.Directionality=19]="Directionality",on[on.PluralCase=20]="PluralCase",on[on.ExtraData=21]="ExtraData",on))();const Iw="en-US";let V2=Iw;function CT(n){Z(n,"Expected localeId to be defined"),"string"==typeof n&&(V2=n.toLowerCase().replace(/_/g,"-"))}class dL{}const fL="ngComponent";class mq{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${it(n)}. Did you add it to @NgModule.entryComponents?`);return e[fL]=n,e}(e)}}class hl{}function Fw(...n){}function eg(n,e){return new Dn(Ys(n,e))}hl.NULL=new mq;const bq=function(){return eg(ns(),Ft())};let Dn=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=bq,n})();function pL(n){return n instanceof Dn?n.nativeElement:n}class Zh{}let NT=(()=>{class n{}return n.\u0275prov=We({token:n,providedIn:"root",factory:()=>null}),n})();class Au{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const gL=new Au("12.2.5");class mL{constructor(){}supports(e){return uy(e)}create(e){return new Cq(e)}}const xq=(n,e)=>e;class Cq{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||xq}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<yL(i,r,s)?t:i,a=yL(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,d=l-r;if(c!=d){for(let p=0;p<c;p++){const g=p<s.length?s[p]:s[p]=0,_=g+p;d<=_&&_<c&&(s[p]=g+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!uy(e))throw new Error(`Error trying to diff '${it(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Bp()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new Aq(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new _L),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _L),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Aq{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Tq{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class _L{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Tq,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function yL(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class bL{constructor(){}supports(e){return e instanceof Map||gT(e)}create(){return new Mq}}class Mq{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||gT(e)))throw new Error(`Error trying to diff '${it(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new Dq(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class Dq{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function vL(){return new tg([new mL])}let tg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||vL()),deps:[[n,new nl,new Xr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:vL}),n})();function wL(){return new ng([new bL])}let ng=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||wL()),deps:[[n,new nl,new Xr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=We({token:n,providedIn:"root",factory:wL}),n})();function Lw(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(vr(s)),$o(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Lw(l[1],l,c,i)}const o=t.type;if(8&o)Lw(n,e,t.child,i);else if(32&o){const a=x_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=Nv(e,t);if(Array.isArray(a))i.push(...a);else{const l=zh(e[16]);Lw(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class by{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Lw(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if($o(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(D_(e,i),Nl(t,i))}this._attachedToViewContainer=!1}I_(this._lView[1],this._lView)}onDestroy(e){ew(this._lView[1],this._lView,null,e)}markForCheck(){Y_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Q_(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){Xf(!0);try{Q_(n,e,t)}finally{Xf(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){Rd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class Oq extends by{constructor(e){super(e),this._view=e}detectChanges(){uw(this._view)}checkNoChanges(){!function(n){Xf(!0);try{uw(n)}finally{Xf(!1)}}(this._view)}get context(){return null}}const Nq=function(n){return function(n,e,t){if(ld(n)&&!t){const i=Bs(n.index,e);return new by(i,i)}return 47&n.type?new by(e[16],e):null}(ns(),Ft(),16==(16&n))};let rs=(()=>{class n{}return n.__NG_ELEMENT_ID__=Nq,n})();const Lq=[new bL],Bq=new tg([new mL]),jq=new ng(Lq),Uq=function(){return kw(ns(),Ft())};let Fo=(()=>{class n{}return n.__NG_ELEMENT_ID__=Uq,n})();const zq=Fo,Hq=class extends zq{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Wh(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),qh(t,i,e),new by(i)}};function kw(n,e){return 4&n.type?new Hq(e,n,eg(n,e)):null}class Oc{}const Wq=function(){return CL(ns(),Ft())};let Ms=(()=>{class n{}return n.__NG_ELEMENT_ID__=Wq,n})();const Kq=Ms,SL=class extends Kq{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return eg(this._hostTNode,this._hostLView)}get injector(){return new qo(this._hostTNode,this._hostLView)}get parentInjector(){const e=Oh(this._hostTNode,this._hostLView);if(Pb(e)){const t=Za(e,this._hostLView),i=pd(e);return new qo(t[1].data[i+8],t)}return new qo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=xL(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(Oc,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return $o(n[3])}(i)){const d=this.indexOf(e);if(-1!==d)this.detach(d);else{const f=i[3],p=new SL(f,f[6],f[3]);p.detach(p.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Fh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Mp(s,o),l=i[11],c=Ap(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,Rd(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Fh(PT(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=xL(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=D_(this._lContainer,t);i&&(Nl(PT(this._lContainer),t),I_(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=D_(this._lContainer,t);return i&&null!=Nl(PT(this._lContainer),t)?new by(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function xL(n){return n[8]}function PT(n){return n[8]||(n[8]=[])}function CL(n,e){let t;const i=e[n.index];if($o(i))t=i;else{let r;if(8&n.type)r=vr(i);else{const s=e[11];r=s.createComment("");const o=Ys(n,e);sl(s,Ap(s,o),r,function(n,e){return cr(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=cw(i,e,r,n),Fp(e,t)}return new SL(t,n,e)}const og={};class $L extends hl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Fi(e);return new qL(t,this.ngModule)}}function WL(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const GK=new Vt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>_v});class qL extends dL{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map(_A).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return WL(this.componentDef.inputs)}get outputs(){return WL(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,og,r);return s!==og||i===og?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(Zh,ou),a=s.get(NT,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",d=i?function(n,e,t){if(cr(n))return n.selectRootElement(e,t===Ht.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):M_(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),f=this.componentDef.onPush?576:528,p=function(n,e){return{components:[],scheduler:n||_v,clean:ZA,playerHandler:e||null,flags:0}}(),g=Pp(0,null,null,1,0,null,null,null,null,null),_=Wh(null,g,p,f,null,null,o,l,a,s);let C,T;Th(_);try{const W=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=Pd(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(kp(l,c,!0),null!==n&&(np(r,n,c),null!==l.classes&&P_(r,n,l.classes),null!==l.styles&&Lv(r,n,l.styles)));const d=i.createRenderer(n,e),f=Wh(t,Np(e),null,e.onPush?64:16,t[20],l,i,d,s||null,null);return o.firstCreatePass&&(mc(js(l,t),o,e.type),lw(o,l),$_(l,t.length,1)),Fp(t,f),t[20]=f}(d,this.componentDef,_,o,l);if(d)if(i)np(l,d,["ng-version",gL.full]);else{const{attrs:H,classes:me}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Ca(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);H&&np(l,d,H),me&&me.length>0&&P_(l,d,me.join(" "))}if(T=Lm(g,20),void 0!==t){const H=T.projection=[];for(let me=0;me<this.ngContentSelectors.length;me++){const Re=t[me];H.push(null!=Re?Array.from(Re):null)}}C=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=ns();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),W_(n,i,e,Fd(n,e,1,null),t));const r=_d(e,n,i.directiveStart,i);Cs(r,e);const s=Ys(i,e);return s&&Cs(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=ns();e.contentQueries(1,o,l.directiveStart)}const a=ns();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(ho(a.index),ow(t[1],a,0,a.directiveStart,a.directiveEnd,e),aw(e,o)),o}(W,this.componentDef,_,p,[Y7]),qh(g,_,null)}finally{ci()}return new qK(this.componentType,C,eg(T,_),_,T)}}class qK extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new Oq(r),this.componentType=e}get injector(){return new qo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const ag=new Map;class XK extends Oc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new $L(this);const i=Co(e),r=function(n){return n[IC]||null}(e);r&&CT(r),this._bootstrapComponents=rl(i.bootstrap),this._r3Injector=pw(e,t,[{provide:Oc,useValue:this},{provide:hl,useValue:this.componentFactoryResolver}],it(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=$n.THROW_IF_NOT_FOUND,i=wn.Default){return e===$n||e===Oc||e===Bd?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class qT extends class{}{constructor(e){super(),this.moduleType=e,null!==Co(e)&&function(n){const e=new Set;!function t(i){const r=Co(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${it(e)} vs ${it(e.name)}`)}(s,ag.get(s),i),ag.set(s,i));const o=rl(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new XK(this.moduleType,e)}}function XL(n,e,t,i,r,s){const o=e+t;return mo(n,o,r)?function(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===Mn?void 0:t}(n,o+1)}function Dy(n,e,t){const i=n+20,r=Ft(),s=function(n,e){return n[e]}(r,i);return function(n,e){Ul.isWrapped(e)&&(e=Ul.unwrap(e),n[Bn.lFrame.bindingIndex]=Mn);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?XL(r,function(){const n=Bn.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),e,s.transform,t,s):s.transform(t))}function KT(n){return e=>{setTimeout(n,void 0,e)}}const dn=class extends oe{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const f=e;a=null===(r=f.next)||void 0===r?void 0:r.bind(f),l=null===(s=f.error)||void 0===s?void 0:s.bind(f),c=null===(o=f.complete)||void 0===o?void 0:o.bind(f)}this.__isAsync&&(l=KT(l),a&&(a=KT(a)),c&&(c=KT(c)));const d=super.subscribe({next:a,error:l,complete:c});return e instanceof S&&e.add(d),d}};function fY(){return this._results[Bp()]()}class tf{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Bp(),i=tf.prototype;i[t]||(i[t]=fY)}get changes(){return this._changes||(this._changes=new dn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=Ko(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class XT{constructor(e){this.queryList=e,this.matches=null}clone(){return new XT(this.queryList)}setDirty(){this.queryList.setDirty()}}class QT{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new QT(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==sk(e,t).matches&&this.queries[t].setDirty()}}class tk{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class ZT{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new ZT(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class JT{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new JT(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,mY(t,s)),this.matchTNodeWithReadOption(e,t,md(t,e,s,!1,!1))}else i===Fo?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,md(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Dn||r===Ms||r===Fo&&4&t.type)this.addMatch(t.index,-2);else{const s=md(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function mY(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function yY(n,e,t,i){return-1===t?function(n,e){return 11&n.type?eg(n,e):4&n.type?kw(n,e):null}(e,n):-2===t?function(n,e,t){return t===Dn?eg(e,n):t===Fo?kw(e,n):t===Ms?CL(e,n):void 0}(n,e,i):_d(n,n[1],t,e)}function nk(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:yY(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function eM(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=nk(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let f=10;f<d.length;f++){const p=d[f];p[17]===p[3]&&eM(p[1],p,c,i)}if(null!==d[9]){const f=d[9];for(let p=0;p<f.length;p++){const g=f[p];eM(g[1],g,c,i)}}}}}return i}function Oi(n){const e=Ft(),t=_i(),i=Rb();Um(i+1);const r=sk(t,i);if(n.dirty&&Ol(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?eM(t,e,i,[]):nk(t,e,r,i);n.reset(s,pL),n.notifyOnChanges()}return!0}return!1}function Ds(n,e,t){const i=_i();i.firstCreatePass&&(function(n,e,t){null===n.queries&&(n.queries=new ZT),n.queries.track(new JT(e,t))}(i,new tk(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function(n,e,t){const i=new tf(4==(4&t));ew(n,e,i,i.destroy),null===e[19]&&(e[19]=new QT),e[19].queries.push(new XT(i))}(i,Ft(),e)}function Ri(){return function(n,e){return n[19].queries[e].queryList}(Ft(),Rb())}function sk(n,e){return n.queries.getByIndex(e)}const nf=new Vt("Application Initializer");let cg=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Fw,this.reject=Fw,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(hy(s))t.push(s);else if(Cw(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Ie(nf,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Ny=new Vt("AppId"),YY={provide:Ny,useFactory:function(){return`${oM()}${oM()}${oM()}`},deps:[]};function oM(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Sk=new Vt("Platform Initializer"),Rc=new Vt("Platform ID"),Gw=new Vt("appBootstrapListener");let $w=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Tu=new Vt("LocaleId"),xk=new Vt("DefaultCurrencyCode");class QY{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const aM=function(n){return new qT(n)},ZY=aM,JY=function(n){return Promise.resolve(aM(n))},Ck=function(n){const e=aM(n),i=rl(Co(n).declarations).reduce((r,s)=>{const o=Fi(s);return o&&r.push(new qL(o)),r},[]);return new QY(e,i)},eX=Ck,tX=function(n){return Promise.resolve(Ck(n))};let rf=(()=>{class n{constructor(){this.compileModuleSync=ZY,this.compileModuleAsync=JY,this.compileModuleAndAllComponentsSync=eX,this.compileModuleAndAllComponentsAsync=tX}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Ak=new Vt("compilerOptions"),iX=(()=>Promise.resolve(0))();function lM(n){"undefined"==typeof Zone?iX.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class yn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new dn(!1),this.onMicrotaskEmpty=new dn(!1),this.onStable=new dn(!1),this.onError=new dn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=ni.requestAnimationFrame,e=ni.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ni,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,uM(n),n.isCheckStableRunning=!0,cM(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),uM(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return Tk(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),Mk(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return Tk(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),Mk(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,uM(n),cM(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!yn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(yn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,sX,Fw,Fw);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const sX={};function cM(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function uM(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Tk(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Mk(n){n._nesting--,cM(n)}class lX{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new dn,this.onMicrotaskEmpty=new dn,this.onStable=new dn,this.onError=new dn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let dM=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{yn.assertNotInAngularZone(),lM(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())lM(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Ie(yn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Dk=(()=>{class n{constructor(){this._applications=new Map,hM.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return hM.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class cX{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let hM=new cX,Ik=!0,Ok=!1;function Da(){return Ok=!0,Ik}let ql;const Rk=new Vt("AllowMultipleToken");function Nk(n,e,t=[]){const i=`Platform: ${e}`,r=new Vt(i);return(s=[])=>{let o=pM();if(!o||o.injector.get(Rk,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:wu,useValue:"platform"});!function(n){if(ql&&!ql.destroyed&&!ql.injector.get(Rk,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");ql=n.get(Pk);const e=n.get(Sk,null);e&&e.forEach(t=>t())}($n.create({providers:a,name:i}))}return function(n){const e=pM();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function pM(){return ql&&!ql.destroyed?ql:null}let Pk=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new lX:("zone.js"===n?void 0:n)||new yn({enableLongStackTrace:Da(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:yn,useValue:a}];return a.run(()=>{const c=$n.create({providers:l,parent:this.injector,name:t.moduleType.name}),d=t.create(c),f=d.injector.get(Jo,null);if(!f)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const p=a.onError.subscribe({next:g=>{f.handleError(g)}});d.onDestroy(()=>{gM(this._modules,d),p.unsubscribe()})}),function(n,e,t){try{const i=t();return hy(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(f,a,()=>{const p=d.injector.get(cg);return p.runInitializers(),p.donePromise.then(()=>(CT(d.injector.get(Tu,Iw)||Iw),this._moduleDoBootstrap(d),d))})})}bootstrapModule(t,i=[]){const r=Fk({},i);return function(n,e,t){const i=new qT(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(zd);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${it(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Ie($n))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function Fk(n,e){return Array.isArray(e)?e.reduce(Fk,n):Object.assign(Object.assign({},n),e)}let zd=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new I(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new I(c=>{let d;this._zone.runOutsideAngular(()=>{d=this._zone.onStable.subscribe(()=>{yn.assertNotInAngularZone(),lM(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const f=this._zone.onUnstable.subscribe(()=>{yn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{d.unsubscribe(),f.unsubscribe()}});this.isStable=Ln(a,l.pipe(_s()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof dL?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Oc),a=r.create($n.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(dM,null),d=c&&a.injector.get(Dk);return c&&d&&d.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),gM(this.components,a),d&&d.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;gM(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Gw,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Ie(yn),Ie($n),Ie(Jo),Ie(hl),Ie(cg))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function gM(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const LX=Nk(null,"core",[{provide:Rc,useValue:"unknown"},{provide:Pk,deps:[$n]},{provide:Dk,deps:[]},{provide:$w,deps:[]}]),UX=[{provide:zd,useClass:zd,deps:[yn,$n,Jo,hl,cg]},{provide:GK,deps:[yn],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:cg,useClass:cg,deps:[[new Xr,nf]]},{provide:rf,useClass:rf,deps:[]},YY,{provide:tg,useFactory:function(){return Bq},deps:[]},{provide:ng,useFactory:function(){return jq},deps:[]},{provide:Tu,useFactory:function(n){return CT(n=n||"undefined"!=typeof $localize&&$localize.locale||Iw),n},deps:[[new xd(Tu),new Xr,new nl]]},{provide:xk,useValue:"USD"}];let HX=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Ie(zd))},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({providers:UX}),n})(),iE=null;function Nc(){return iE}const un=new Vt("DocumentToken");let af=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:zQ,token:n,providedIn:"platform"}),n})();function zQ(){return Ie(u3)}let u3=(()=>{class n extends af{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Nc().getBaseHref(this._doc)}onPopState(t){const i=Nc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Nc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){d3()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){d3()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Ie(un))},n.\u0275prov=We({factory:GQ,token:n,providedIn:"platform"}),n})();function d3(){return!!window.history.pushState}function GQ(){return new u3(Ie(un))}function Du(n){return n&&"?"!==n[0]?"?"+n:n}let lf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({factory:$Q,token:n,providedIn:"root"}),n})();function $Q(n){const e=Ie(un).location;return new f3(Ie(af),e&&e.origin||"")}const OM=new Vt("appBaseHref");let f3=(()=>{class n extends lf{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return function(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Du(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Du(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Du(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(af),Ie(OM,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();var hs=(()=>((hs=hs||{})[hs.Zero=0]="Zero",hs[hs.One=1]="One",hs[hs.Two=2]="Two",hs[hs.Few=3]="Few",hs[hs.Many=4]="Many",hs[hs.Other=5]="Other",hs))();const tZ=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=j2(e);if(t)return t;const i=e.split("-")[0];if(t=j2(i),t)return t;if("en"===i)return mW;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[on.PluralCase]};class fE{}let IZ=(()=>{class n extends fE{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(tZ(i||this.locale)(t)){case hs.Zero:return"zero";case hs.One:return"one";case hs.Two:return"two";case hs.Few:return"few";case hs.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Tu))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();let Ou=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new PZ,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){C3("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){C3("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(Me(Ms),Me(Fo))},n.\u0275dir=Lt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class PZ{constructor(){this.$implicit=null,this.ngIf=null}}function C3(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${it(e)}'.`)}class BZ{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class jZ{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const VZ=new jZ,UZ=new BZ;let gE=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(hy(t))return VZ;if(QF(t))return UZ;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${it(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(Me(rs,16))},n.\u0275pipe=Ls({name:"async",type:n,pure:!1}),n})(),Ws=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({providers:[{provide:fE,useClass:IZ}]}),n})();const O3="browser";class GM extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){iE||(iE=n)}(new GM)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(Vy=Vy||document.querySelector("base"),Vy?Vy.getAttribute("href"):null);return null==t?null:function(n){mE=mE||document.createElement("a"),mE.setAttribute("href",n);const e=mE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Vy=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let mE,Vy=null;const F3=new Vt("TRANSITION_ID"),hJ=[{provide:nf,useFactory:function(n,e,t){return()=>{t.get(cg).donePromise.then(()=>{const i=Nc(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[F3,un,$n],multi:!0}];class $M{static init(){!function(n){hM=n}(new $M)}addToWindow(e){ni.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},ni.getAllAngularTestabilities=()=>e.getAllTestabilities(),ni.getAllAngularRootElements=()=>e.getAllRootElements(),ni.frameworkStabilizers||(ni.frameworkStabilizers=[]),ni.frameworkStabilizers.push(i=>{const r=ni.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Nc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let fJ=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const Uy=new Vt("EventManagerPlugins");let yE=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Uy),Ie(yn))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class WM{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Nc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let k3=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),zy=(()=>{class n extends k3{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(B3),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(B3))}}return n.\u0275fac=function(t){return new(t||n)(Ie(un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function B3(n){Nc().remove(n)}const qM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},KM=/%COMP%/g;function bE(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?bE(n,r,t):(r=r.replace(KM,n),t.push(r))}return t}function U3(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let vE=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new YM(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Ht.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new MJ(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Ht.ShadowDom:return new DJ(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=bE(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Ie(yE),Ie(zy),Ie(Ny))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class YM{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(qM[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=qM[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=qM[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Ro.DashCase|Ro.Important)?e.style.setProperty(t,i,r&Ro.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Ro.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,U3(i)):this.eventManager.addEventListener(e,t,U3(i))}}class MJ extends YM{constructor(e,t,i,r){super(e),this.component=i;const s=bE(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(KM,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(KM,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class DJ extends YM{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=bE(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let IJ=(()=>{class n extends WM{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Ie(un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const G3=["alt","control","meta","shift"],kJ={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},$3={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},BJ={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let jJ=(()=>{class n extends WM{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Nc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(G3.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&$3.hasOwnProperty(e)&&(e=$3[e]))}return kJ[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),G3.forEach(s=>{s!=r&&BJ[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(Ie(un))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const qJ=Nk(LX,"browser",[{provide:Rc,useValue:O3},{provide:Sk,useValue:function(){GM.makeCurrent(),$M.init()},multi:!0},{provide:un,useFactory:function(){return function(n){Gi=n}(document),document},deps:[]}]),KJ=[[],{provide:wu,useValue:"root"},{provide:Jo,useFactory:function(){return new Jo},deps:[]},{provide:Uy,useClass:IJ,multi:!0,deps:[un,yn,Rc]},{provide:Uy,useClass:jJ,multi:!0,deps:[un]},[],{provide:vE,useClass:vE,deps:[yE,zy,Ny]},{provide:Zh,useExisting:vE},{provide:k3,useExisting:zy},{provide:zy,useClass:zy,deps:[un]},{provide:dM,useClass:dM,deps:[yn]},{provide:yE,useClass:yE,deps:[Uy,yn]},{provide:class{},useClass:fJ,deps:[]},[]];let ZM=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:Ny,useValue:t.appId},{provide:F3,useExisting:Ny},hJ]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12))},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({providers:KJ,imports:[Ws,HX]}),n})();"undefined"!=typeof window&&window;class nee extends S{constructor(e,t){super()}schedule(e,t=0){return this}}class wE extends nee{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let q3=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class Zl extends q3{constructor(e,t=q3.now){super(e,()=>Zl.delegate&&Zl.delegate!==this?Zl.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return Zl.delegate&&Zl.delegate!==this?Zl.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const see=new class extends Zl{}(class extends wE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),Pc=new I(n=>n.complete());function EE(n){return n?function(n){return new I(e=>n.schedule(()=>e.complete()))}(n):Pc}function cn(...n){let e=n[n.length-1];return Se(e)?(n.pop(),Ne(n,e)):In(n)}function pg(n,e){return new I(e?t=>e.schedule(aee,0,{error:n,subscriber:t}):t=>t.error(n))}function aee({error:n,subscriber:e}){e.error(n)}class sa{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return cn(this.value);case"E":return pg(this.error);case"C":return EE()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new sa("N",e):sa.undefinedValueNotification}static createError(e){return new sa("E",void 0,e)}static createComplete(){return sa.completeNotification}}sa.completeNotification=new sa("C"),sa.undefinedValueNotification=new sa("N",void 0);class SE extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(SE.dispatch,this.delay,new cee(e,this.destination)))}_next(e){this.scheduleMessage(sa.createNext(e))}_error(e){this.scheduleMessage(sa.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(sa.createComplete()),this.unsubscribe()}}class cee{constructor(e,t){this.notification=e,this.destination=t}}class gg extends oe{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new uee(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new z;if(this.isStopped||this.hasError?o=S.EMPTY:(this.observers.push(e),o=new Q(this,e)),r&&e.add(e=new SE(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||see).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class uee{constructor(e,t){this.time=e,this.value=t}}function xr(n,e){return"function"==typeof e?t=>t.pipe(xr((i,r)=>ke(n(i,r)).pipe(pe((s,o)=>e(i,s,r,o))))):t=>t.lift(new dee(n))}class dee{constructor(e){this.project=e}call(e,t){return t.subscribe(new hee(e,this.project))}}class hee extends ve{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new gt(this),r=this.destination;r.add(i),this.innerSubscription=R(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const xE={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return xE.schedule(n,0);if(void 0===window.requestAnimationFrame)return xE.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let eD;function Eee(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!eD){const t=Element.prototype;eD=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&eD.call(n,e)}(n,r)||(i=s,0))),i}class xee{constructor(e,t){this.componentFactory=t.get(hl).resolveComponentFactory(e)}create(e){return new Cee(this.componentFactory,e)}}class Cee{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new gg(1),this.events=this.eventEmitters.pipe(xr(i=>Ln(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(yn),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=xE.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=$n.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=Eee(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(rs),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(zd).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(pe(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=xE.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new Nm(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class Aee extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}const Mee={initialConfig:{},parse:{},rename:{}};class Dee{constructor(e,t){this.configState=e,this.storedChanges={},this.options=Object.assign(Object.assign({},Mee),t)}addChanges(e){this.storedChanges=Object.assign(Object.assign({},this.storedChanges),e)}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,s=i.snapshot,o=Object.assign(Object.assign(Object.assign({},r),s),t);for(const[a,l]of Object.entries(e))this.processChange(a,l,o);i.setConfig(o)}processChange(e,t,i){var r,s;const{options:{parse:o,rename:a}}=this,l=null!==(r=a[e])&&void 0!==r?r:e,c=t.currentValue,d=null!==(s=o[e])&&void 0!==s?s:o[l];if(null==c)delete i[l];else if(d)try{i[l]=d(c)}catch(f){console.warn(`Failed to parse ${e} = ${c}`,f.message)}else i[l]=c}}let Iee=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new Dee(this.configState,this.options)}ngOnInit(){var t;this._init=setTimeout(()=>this.initialize(),null!==(t=this.options.initialDelay)&&void 0!==t?t:0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}}return n.\u0275fac=function(t){!function(){throw new Error("invalid")}()},n.\u0275dir=Lt({type:n,features:[Qi]}),n})();var tD;const Hy={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org",hubmapToken:null!==(tD=localStorage.getItem("HUBMAP_TOKEN"))&&void 0!==tD?tD:""},googleAnalyticsToken:"portal.hubmapconsortium.org"===window.location.hostname?"G-1WRJHN9FM6":"G-J9HWV9QPJ4"};function Ia(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function Y3(n,e){return function(t,i){e(t,i,n)}}function Jl(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function Ni(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(d){try{c(i.next(d))}catch(f){o(f)}}function l(d){try{c(i.throw(d))}catch(f){o(f)}}function c(d){d.done?s(d.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function Z3(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function iD(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||Z3()}const J3="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",AE=iD();class Pee{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function rD(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const eB={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function tB(n){return"string"==typeof n?eB[n.toUpperCase()]||eB.WHITE:n}function TE(n,e){if(!n)throw new Error(e||"Assertion failed")}const ec={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},Gy=ec.window||ec.self||ec.global,nB=ec.process||{};function mg(){let n;if(AE&&Gy.performance)n=Gy.performance.now();else if(nB.hrtime){const e=nB.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const _g={debug:AE&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Uee={enabled:!0,level:0};function _l(){}const iB={},rB={once:!0};function zee(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let sD=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=J3,this._startTs=mg(),this._deltaTs=mg(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Pee("__probe-".concat(this.id,"__"),Uee),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((mg()-this._startTs).toPrecision(10))}getDelta(){return Number((mg()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){TE(t,i)}warn(t){return this._getLogFunction(0,t,_g.warn,arguments,rB)}error(t){return this._getLogFunction(0,t,_g.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,_g.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,_g.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,_g.debug||_g.info,arguments,rB)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||_l,r&&[r],{tag:zee(i)}):_l}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?AE?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=rD(r,e,t);console.log(...s)},r.src=n,_l}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...rD(n,e,t)),_l;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...rD(r,e,t)),r.src=n.toDataURL(),_l}return _l}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=tt(307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):_l}({image:r,message:s,scale:o}):_l}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||_l)}group(t,i,r={collapsed:!1}){r=oB({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||_l)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=sB(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=oB({logLevel:t,message:i,args:s,opts:o}),TE(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=mg();const a=o.tag||o.message;if(o.once){if(iB[a])return _l;iB[a]=mg()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!AE&&"string"==typeof n&&(e&&(e=tB(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=tB(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return _l}}return n.VERSION=J3,n})();function sB(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return TE(Number.isFinite(e)&&e>=0),e}function oB(n){const{logLevel:e,message:t}=n;n.logLevel=sB(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return TE("string"===r||"object"===r),Object.assign(n,n.opts)}const Bi=new sD({id:"deck"}),Pi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Pi,"IDENTITY",{get:()=>Bi.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const Fc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},aB={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},hn=new sD({id:"luma.gl"});function Bo(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function ME(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function yi(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function DE(n){return Bo(ME(n),"Invalid WebGLRenderingContext"),n}function jo(n){return Bo(yi(n),"Requires WebGL2"),n}var Cr=tt(761);const $y={};const Wy=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(Wy.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const df=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&($y[i]=!0)}while(0!==i);for(i in $y)if($y[i])return delete $y[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,d){const f=t.currentVertexArrayObject;f.maxAttrib=Math.max(f.maxAttrib,s);const p=f.attribs[s];return p.buffer=t.currentArrayBuffer,p.size=o,p.type=a,p.normalized=l,p.stride=c,p.offset=d,p.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{Cr.CO.console&&Cr.CO.console.log&&Cr.CO.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};df.prototype.VERTEX_ARRAY_BINDING_OES=34229,df.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new Wy(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},df.prototype.createVertexArrayOES=function(){const e=new Wy(this);return this.vertexArrayObjects.push(e),e},df.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},df.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Wy&&e.hasBeenBound&&e.ext===this)},df.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){$y[n]=!0,void 0!==e&&function(n){Cr.CO.console&&Cr.CO.console.error&&Cr.CO.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],d=r?r.attribs[l]:null;if((!r||c.enabled!==d.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let f=!1;(!r||c.buffer!==d.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),f=!0),(f||c.cached!==d.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const lB="OES_element_index",cB="WEBGL_draw_buffers",uB="WEBGL_debug_renderer_info",pr=n=>yi(n)?void 0:0,cte={3074:n=>yi(n)?void 0:36064,35723:n=>yi(n)?void 0:4352,35977:pr,32937:pr,36795:(n,e)=>{const t=yi(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(uB);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(uB);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:pr,35071:pr,37447:pr,36063:(n,e)=>{if(!yi(n)){const t=n.getExtension(cB);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:pr,35374:pr,35377:pr,34852:n=>{if(!yi(n)){const e=n.getExtension(cB);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(lB)?2147483647:65535,33001:n=>n.getExtension(lB)?16777216:65535,33e3:n=>16777216,37157:pr,35373:pr,35657:pr,36183:pr,37137:pr,34045:pr,35978:pr,35979:pr,35968:pr,35376:pr,35375:pr,35659:pr,37154:pr,35371:pr,35658:pr,35076:pr,35077:pr,35380:pr},dB="ANGLE_instanced_arrays",hB={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Bo(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[dB]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){Bo(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Bo(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Bo(!1)},deleteQuery:()=>{Bo(!1)},beginQuery:()=>{Bo(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},oD={readBuffer:(n,e,t)=>{yi(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:yi(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!yi(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!yi(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=cte[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function Ete(n,{extension:e,target:t,target2:i}){const r=hB[e];Bo(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let d=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?d=(...f)=>a[c](...f):"function"==typeof r[l]&&(d=r[l].bind(t))),d&&(t[l]=d,i[l]=d)}}("undefined"!=typeof global?global:window).polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new df(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&Ete(n,{extension:t,target:n.luma,target2:n})}(n,hB),function(n,{target:e,target2:t}){Object.keys(oD).forEach(i=>{if("function"==typeof oD[i]){const r=n[i]?n[i].bind(n):()=>{},s=oD[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const aD={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},$d=(n,e,t)=>e?n.enable(t):n.disable(t),fB=(n,e,t)=>n.hint(t,e),Oa=(n,e,t)=>n.pixelStorei(t,e);function qy(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const Cte={3042:$d,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:$d,2885:(n,e)=>n.cullFace(e),2929:$d,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:$d,35723:fB,36006:(n,e)=>{const t=yi(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:fB,2849:(n,e)=>n.lineWidth(e),32823:$d,32824:"polygonOffset",10752:"polygonOffset",35977:$d,32938:"sampleCoverage",32939:"sampleCoverage",3089:$d,3088:(n,e)=>n.scissor(...e),2960:$d,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Oa,3317:Oa,37440:Oa,37441:Oa,37443:Oa,3330:Oa,3332:Oa,3331:Oa,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Oa,32878:Oa,3316:Oa,3315:Oa,32877:Oa,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=qy(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=qy(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=qy(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=qy(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=qy(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function Zr(n,e,t){return void 0!==e[n]?e[n]:t[n]}const Ate={blendEquation:(n,e,t)=>n.blendEquationSeparate(Zr(32777,e,t),Zr(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(Zr(32969,e,t),Zr(32968,e,t),Zr(32971,e,t),Zr(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(Zr(32824,e,t),Zr(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(Zr(32938,e,t),Zr(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,Zr(2962,e,t),Zr(2967,e,t),Zr(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,Zr(34816,e,t),Zr(36003,e,t),Zr(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,Zr(2964,e,t),Zr(2965,e,t),Zr(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,Zr(34817,e,t),Zr(34818,e,t),Zr(34819,e,t))},pB={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Lc=(n,e)=>n.isEnabled(e),gB={3042:Lc,2884:Lc,2929:Lc,3024:Lc,32823:Lc,32926:Lc,32928:Lc,3089:Lc,2960:Lc,35977:Lc};function mB(n){for(const e in n)return!1;return!0}function Tte(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function _B(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache||(n.state.cache[s]=t(...r)),n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function Mte(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class Ite{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||aD)){const r=e,s=gB[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=gB[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},aD),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Bo(this.stateStack.length>0),Ru(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Bo(void 0!==s);const o=e[s],a=this.cache[s];Tte(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function yB(n,e={}){const{enable:t=!0,copyState:i}=e;if(Bo(void 0!==i),!n.state){const r="undefined"!=typeof global?global:window,{polyfillContext:s}=r;s&&s(n),n.state=new Ite(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const o in pB)Mte(n,o,pB[o]);_B(n,"getParameter"),_B(n,"isEnabled")}return n.state.enable=t,n}function bB(n){Bo(n.state),n.state.pop()}function Ru(n,e){if(Bo(ME(n),"setParameters requires a WebGL context"),mB(e))return;const t={};for(const r in e){const s=Number(r),o=Cte[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)Ate[r](n,e,i)}function tc(n,e,t){if(mB(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||yB(n,{copyState:!1}),n.state.push()}(n),Ru(n,e),i)r=t(n),bB(n);else try{r=t(n)}finally{bB(n)}return r}function yg(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function lD(n,e,t=!0){return function(n,e,t,i,r){const s=vB(n[0],e,t);let o=wB(n[1],e,i,r),a=vB(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=wB(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,yg(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function vB(n,e,t){return Math.min(Math.round(n*e),t-1)}function wB(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const cD=(0,Cr.jU)(),Lte=cD&&"undefined"!=typeof document,EB={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function SB(n={}){Bo(cD,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},EB,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(Lte&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=uD(r,n),function(n){const e=yi(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);hn.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function uD(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},EB,e);const{manageState:t,debug:i}=e;return t&&yB(n,{copyState:!1,log:(...r)=>hn.log(1,...r)()}),cD&&i&&(Cr.CO.makeDebugContext?(n=Cr.CO.makeDebugContext(n,e),hn.level=Math.max(hn.level,1)):hn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function xB(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class CB{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=xB(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(xB()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class dD{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof CB?e:new CB(t,i)),this.stats[t]}}const Ky="8.5.7",hf=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new dD({id:e})),this.stats.get(e)}};if(Cr.CO.luma&&Cr.CO.luma.VERSION!==Ky)throw new Error(`luma.gl - multiple VERSIONs detected: ${Cr.CO.luma.VERSION} vs 8.5.7`);function rn(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function hD(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return rn(void 0!==i,`Accessing undefined constant GL.${e}`),i}function Wd(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}Cr.CO.luma||((0,Cr.jU)()&&hn.log(1,"luma.gl 8.5.7 - set luma.log.level=1 (or higher) to trace rendering")(),Cr.CO.luma=Cr.CO.luma||{VERSION:Ky,version:Ky,log:hn,stats:hf,globals:{modules:{},nodeIO:{}}});const fD={};function kc(n="id"){return fD[n]=fD[n]||1,`${n}-${fD[n]++}`}function AB(n){return rn("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function bg(n){let e=!0;for(const t in n){e=!1;break}return e}function TB(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw hn.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const vg="Resource subclass must define virtual methods";class Nu{constructor(e,t={}){DE(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||kc(this.constructor.name),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){rn(e=hD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=yi(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=yi(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const f=i?Wd(this.gl,l):l;o[f]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[f]=Wd(this.gl,o[f]))}}return o}setParameter(e,t){rn(e=hD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=yi(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=hD(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return TB(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(vg)}_deleteHandle(){throw new Error(vg)}_bindHandle(e){throw new Error(vg)}_getOptsFromHandle(){throw new Error(vg)}_getParameter(e,t){throw new Error(vg)}_setParameter(e,t){throw new Error(vg)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,t=hf.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this.constructor.name;hf.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this.constructor.name){const i=hf.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this.constructor.name){const t=hf.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function pD(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Yy(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Kte({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function gD(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&hn.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&hn.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];hn.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const Yte={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Xte={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class oa{static getBytesPerElement(e){return Yy(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return rn(e.size),Yy(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new oa(...[Yte,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return oa.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return oa.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=gD("Accessor",e,Xte)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const DB={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Qte={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:DB},Zte={removedProps:DB};class or extends Nu{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/oa.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/oa.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=gD("Buffer",e,Qte),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=gD("Buffer",e,Zte))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new oa(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;rn(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(jo(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return jo(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){jo(this.gl);const s=Yy(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const d=Math.min(o,l);return rn((r=r||d)<=d),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(rn(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){rn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=pD(e);return rn(s),this.setAccessor(new oa(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){rn(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/Yy(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new oa(this.accessor,{type:pD(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return hn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return hn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return hn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return hn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new oa(this.accessor,e),this}}const mD={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},IB={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},OB={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},tne=[9729,9728],RB=Cr.CO.WebGLBuffer||function(){};class wg extends Nu{static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=mD[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=yi(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=mD[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=kc("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(H=>this.initialize(Object.assign({},e,{pixels:H,data:H}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:d}=e;t||(t=r);let{width:f,height:p,dataFormat:g,type:_,compressed:C=!1,mipmaps:T=!0}=e;const{depth:W=0}=e;return({width:f,height:p,compressed:C,dataFormat:g,type:_}=this._deduceParameters({format:s,type:_,dataFormat:g,compressed:C,data:t,width:f,height:p})),this.width=f,this.height=p,this.depth=W,this.format=s,this.type=_,this.dataFormat=g,this.border=o,this.textureUnit=d,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),T&&this._isNPOT()&&(hn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),T=!1,this._updateForNPOT(l)),this.mipmaps=T,this.setImageData({data:t,width:f,height:p,depth:W,format:s,type:_,dataFormat:g,border:o,mipmaps:T,parameters:c,compressed:C}),T&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(hn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),tc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:d=this.type,width:f=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:_=!1}=e;c||(c=i),({type:d,dataFormat:g,compressed:_,width:f,height:p}=this._deduceParameters({format:s,type:d,dataFormat:g,compressed:_,data:c,width:f,height:p}));const{gl:C}=this;C.bindTexture(this.target,this.handle);let W,T=null;return({data:c,dataType:T}=this._getDataType({data:c,compressed:_})),tc(this.gl,l,()=>{switch(T){case"null":C.texImage2D(t,r,s,f,p,o,g,d,c);break;case"typed-array":C.texImage2D(t,r,s,f,p,o,g,d,c,a);break;case"buffer":W=jo(C),W.bindBuffer(35052,c.handle||c),W.texImage2D(t,r,s,f,p,o,g,d,a),W.bindBuffer(35052,null);break;case"browser-object":yi(C)?C.texImage2D(t,r,s,f,p,o,g,d,c):C.texImage2D(t,r,s,g,d,c);break;case"compressed":for(const[H,me]of c.entries())C.compressedTexImage2D(t,H,me.format,me.width,me.height,o,me.data);break;default:rn(!1,"Unknown image data type")}}),this._trackAllocatedMemory(c&&c.byteLength?c.byteLength:this.width*this.height*(IB[this.dataFormat]||4)*(OB[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:d=this.type,dataFormat:f=this.dataFormat,compressed:p=!1,offset:g=0,border:_=this.border,parameters:C={}}){if(({type:d,dataFormat:f,compressed:p,width:o,height:a}=this._deduceParameters({format:c,type:d,dataFormat:f,compressed:p,data:i,width:o,height:a})),rn(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const T=i;i=T.data,o=T.shape[0],a=T.shape[1]}i instanceof or&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),tc(this.gl,C,()=>{if(p)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,f,d,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,f,d,i,g);else if(i instanceof RB){const T=jo(this.gl);T.bindBuffer(35052,i),T.texSubImage2D(e,l,r,s,o,a,f,d,g),T.bindBuffer(35052,null)}else yi(this.gl)?jo(this.gl).texSubImage2D(e,l,r,s,o,a,f,d,i):this.gl.texSubImage2D(e,l,r,s,f,d,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return hn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof or?{data:e.handle,dataType:"buffer"}:e instanceof RB?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=mD[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},rn(r,"Could not deduced texture size"),rn(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),rn(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:rn(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(yi(this.gl)||!this.width||!this.height||AB(this.width)&&AB(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===tne.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function nne(n,e){return rn("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class Ra extends wg{static isSupported(e,t){return wg.isSupported(e,t)}constructor(e,t={}){DE(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:nne(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const ff="EXT_color_buffer_float",NB={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:ff,bpp:2},33327:{gl2:ff,bpp:4},34842:{gl2:ff,bpp:8},33326:{gl2:ff,bpp:4},33328:{gl2:ff,bpp:8},34836:{gl2:ff,bpp:16},35898:{gl2:ff,bpp:4}};class Eg extends Nu{static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=yi(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,NB)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return rn(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&yi(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*NB[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const BB="clear: bad arguments";function yD(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),rn(0!==o,BB),tc(n,s,()=>{n.clear(o)})}function jB(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function ii(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){jB(s,i,r,o,a,"next",l)}function a(l){jB(s,i,r,o,a,"throw",l)}o(void 0)})}}const bD=[34069,34070,34071,34072,34073,34074];let cne=(()=>{class n extends wg{constructor(t,i={}){DE(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return ii(function*(){const{gl:d}=c,f=r||s,p=yield Promise.all(bD.map(g=>{const _=f[g];return Promise.all(Array.isArray(_)?_:[_])}));c.bind(),bD.forEach((g,_)=>{p[_].length>1&&!1!==c.opts.mipmaps&&hn.warn(`${c.id} has mipmap and multiple LODs.`)(),p[_].forEach((C,T)=>{t&&i?d.texImage2D(g,T,a,t,i,o,a,l,C):d.texImage2D(g,T,a,a,l,C)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:d=5121}=t,{gl:f}=this,p=o||a;return this.bind(),p instanceof Promise?p.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?f.texImage2D(i,0,c,r,s,l,c,d,p):f.texImage2D(i,0,c,c,d,p),this}}return n.FACES=bD,n})();class une extends wg{static isSupported(e){return yi(e)}constructor(e,t={}){jo(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:d,parameters:f={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),tc(this.gl,f,()=>{ArrayBuffer.isView(d)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,d),d instanceof or&&(this.gl.bindBuffer(35052,d.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(d&&d.byteLength?d.byteLength:this.width*this.height*this.depth*(IB[this.dataFormat]||4)*(OB[this.type]||1),"Texture"),this.loaded=!0,this}}function hne(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Os(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function IE(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:d,deleteFramebuffer:f}=function(n){return n instanceof Os?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:hne(n),deleteFramebuffer:!0}}(n);rn(d);const{gl:p,handle:g,attachments:_}=d;a=a||d.width,l=l||d.height,36064===s&&null===g&&(s=1028),rn(_[s]),c=c||_[s].type,o=function(n,e,t,i,r){if(n)return n;return new(Yy(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return rn(!1),0}}(t))}(o,c,r,a,l),c=c||pD(o);const C=p.bindFramebuffer(36160,g);return p.readPixels(t,i,a,l,r,c,o),p.bindFramebuffer(36160,C||null),f&&d.delete(),o}function vD(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=IE(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=Kte({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}const VB="Multiple render targets not supported";class Os extends Nu{static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Os(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=jo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=jo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(rn(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const d in i){const f=i[d];(Array.isArray(f)?f[0]:f).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return rn(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&hn.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){rn(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof Eg)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[d,f=0,p=0]=l;c=d,this._attachTexture({attachment:a,texture:d,layer:f,level:p})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(Os.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&yD(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){jo(n),tc(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:rn(!1,BB)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return hn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return hn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return hn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return hn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return hn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return hn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=jo(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=Wd(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?Wd(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?Wd(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(vD(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>hn.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=vD(this,{targetMaxHeight:100});return hn.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new Ra(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new Eg(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new Eg(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&rn(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof Eg?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:jo(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:rn(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return yi(n)?n:null}(this.gl);t?t.readBuffer(e):rn(36064===e||1029===e,VB),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=jo(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):rn(1===e.length&&(36064===e[0]||1029===e[0]),VB)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in UB)void 0===n.luma.caps[e]&&(n.luma.caps[e]=HB(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Os.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const UB={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new Ra(n,{format:6408,type:5126,dataFormat:6408}),t=new Os(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function wD(n,e){return zB(n,e)}function zB(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>HB(n,t))}function HB(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=UB[e];let i;rn(t,e);const r=yi(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:rn(!1);return i}(n,e)),n.luma.caps[e]||hn.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class ED{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return ht(ht({},this.source.getAccessor()),this.opts)}}const Qy=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,d=t*i+s;if(ArrayBuffer.isView(e)){if(d<=e.length)return e;if(d*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,d)}let f;l&&(f=l*i+s);const p=this._allocate(c,d,a,f);return e&&o?p.set(e):a||p.fill(0,0,4),this._release(e),p}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},xne=(Math,1/180*Math.PI),Ar={};function Ane(n,{precision:e=Ar.precision||4}={}){return n=function(n){return Math.round(n/Ar.EPSILON)*Ar.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function qd(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Pu(n,e,t){if(qd(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function GB(n){return function(n,e){return Pu(n,t=>t*xne,void 0)}(n)}function pf(n,e,t){return Pu(n,i=>Math.max(e,Math.min(t,i)))}function OE(n,e,t){return qd(n)?n.map((i,r)=>OE(i,e[r],t)):t*e+(1-t)*n}function Zy(n,e,t){const i=Ar.EPSILON;t&&(Ar.EPSILON=t);try{if(n===e)return!0;if(qd(n)&&qd(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!Zy(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Ar.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Ar.EPSILON=i}}function Fu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}Ar.EPSILON=1e-12,Ar.debug=!1,Ar.precision=4,Ar.printTypes=!1,Ar.printDegrees=!1,Ar.printRowMajor=!0;class SD extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return Fu(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:qd(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ar)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+Ane(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Zy(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Ar.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function to(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function RE(n,e,t=""){if(Ar.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const $B={};function xD(n,e){$B[n]||($B[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class Nne extends SD{get ELEMENTS(){return Fu(!1),0}copy(e){return Fu(!1),this}get x(){return this[0]}set x(e){this[0]=to(e)}get y(){return this[1]}set y(e){this[1]=to(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return to(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return to(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Fu(e>=0&&e<this.ELEMENTS,"index is out of range"),to(this[e])}setComponent(e,t){return Fu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var mr=1e-6,aa="undefined"!=typeof Float32Array?Float32Array:Array;function WB(){var n=new aa(3);return aa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function qB(n,e,t){var i=new aa(3);return i[0]=n,i[1]=e,i[2]=t,i}function KB(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function NE(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function YB(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function XB(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}WB();const CD=[0,0,0],QB={};class vo extends Nne{static get ZERO(){return QB.ZERO=QB.ZERO||Object.freeze(new vo(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&qd(e)?this.copy(e):(Ar.debug&&(to(e),to(t),to(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ar.debug&&(to(e.x),to(e.y),to(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=to(e)}angle(e){return function(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],d=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),f=d&&KB(n,e)/d;return Math.acos(Math.min(Math.max(f,-1),1))}(this,e)}cross(e){return NE(this,this,e),this.check()}rotateX({radians:e,origin:t=CD}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=CD}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=CD}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return YB(this,this,e),this.check()}transformAsVector(e){return XB(this,this,e),this.check()}transformByMatrix3(e){return function(n,e,t){var i=e[0],r=e[1],s=e[2];n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8]}(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],d=r*c-s*l,f=s*a-i*c,p=i*l-r*a,g=r*p-s*f,_=s*d-i*p,C=i*f-r*d,T=2*t[3];f*=T,p*=T,_*=2,C*=2,n[0]=a+(d*=T)+(g*=2),n[1]=l+f+_,n[2]=c+p+C}(this,this,e),this.check()}}const ZB=new vo;function Sg(n,e,t,i){ZB.set(n,e,t);const r=ZB.len();return{distance:i/r,normal:new vo(-n/r,-e/r,-t/r)}}function tie(n){return n-Math.fround(n)}let e0;function AD(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;e0=Qy.allocate(e0,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];e0[o+a]=l,e0[o+a+e]=tie(l)}o+=2*e}return e0.subarray(0,r*e*2)}function PE(n){return n.stride||n.size*n.bytesPerElement}function JB(n,e){e.offset&&Bi.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=PE(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return Hn(ht({},e),{offset:s,stride:t})}function nc(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const ej=[],tj=[];function nj(n,e=0,t=1/0){let i=ej;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(tj.length=n.length,i=tj):i=ej,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function ij(n){return n&&n[Symbol.asyncIterator]}function TD(n,e=(()=>!0)){return Array.isArray(n)?rj(n,e,[]):e(n)?[n]:[]}function rj(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?rj(r,e,t):e(r)&&t.push(r)}return t}function sie({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const oie=[],FE=[[0,1/0]];function MD({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let d=0;d<r;d++)e[t+l]=c[d]||0,l++}}const cie={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function sj(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",ht(ht(ht({},cie[n.type]),e),n)):null}function oj(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function aj(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function lj(n){n.push(n.shift())}function DD(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function cj({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,d=r&&c,f=DD(t,e),p=t.state.constant;if(!d&&i>=f)return;const g=p?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!p){const W=s;s=(H,me)=>t._normalizeConstant(W(H,me))}const _=p?(W,H)=>s(g,H):(W,H)=>s(g.subarray(W,W+a),H),C=n.getData({length:i}),T=new Float32Array(f);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return MD({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((d,f)=>i(d+a,f)),c=Math.min(r.length,s.length);for(let d=1;d<c;d++){const f=r[d]*t,p=s[d]*t;MD({source:n.subarray(o,f),target:e,start:a,end:p,size:t,getData:l}),o=f,a=p}a<e.length&&MD({source:[],target:e,start:a,size:t,getData:l})})({source:C,target:T,sourceStartIndices:r,targetStartIndices:c,size:a,getData:_}),n.byteLength<T.byteLength+l&&n.reallocate(T.byteLength+l),n.subData({data:T,offset:l})}class ID extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&wD(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new or(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*PE(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Qy.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=JB(n,e);return{high:t,low:Hn(ht({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new ED(this,s.high),i["".concat(e,"64Low")]=r?new ED(this,s.low):new Float32Array(this.size),i}if(t){const i=JB(this.getAccessor(),t);return{[e]:new ED(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof or&&(e={buffer:e});const i=ht(ht({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=PE(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=PE(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=AD(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?AD(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=Qy.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?AD(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Bi.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:FE,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return sj(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===FE||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=FE}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=oie}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==FE}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,d]of s)o.call(r,this,{data:t,startRow:c,endRow:d,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,d]of s){const f=Number.isFinite(c)?this.getVertexOffset(c):0,p=Number.isFinite(d)?this.getVertexOffset(d):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:p})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(nc(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(d,{index:f,target:p})=>{if(!r){const T=f*a+l;for(let W=0;W<e;W++)p[W]=n[T+W];return p}const g=r[f],_=r[f+1]||c;let C;if(s){C=new Array(_-g);for(let T=g;T<_;T++){const W=T*a+l;p=new Array(e);for(let H=0;H<e;H++)p[H]=n[W+H];C[T-g]=p}}else if(a===e)C=n.subarray(g*e+l,_*e+l);else{C=new n.constructor((_-g)*e);let T=0;for(let W=g;W<_;W++){const H=W*a+l;for(let me=0;me<e;me++)C[T++]=n[H+me]}}return C}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:d,startIndices:f}=e,{accessor:p,transform:g}=a,_=l.binaryAccessor||("function"==typeof p?p:s[p]);nc("function"==typeof _,'accessor "'.concat(p,'" is not a function'));let C=e.getVertexOffset(i);const{iterable:T,objectInfo:W}=nj(t,i,r);for(const H of T){W.index++;let me=_(H,W);if(g&&(me=g.call(this,me)),f){const Re=(W.index<f.length-1?f[W.index+1]:o)-f[W.index];if(me&&Array.isArray(me[0])){let ze=C;for(const Ge of me)e._normalizeValue(Ge,c,ze),ze+=d}else me&&me.length>d?c.set(me,C):(e._normalizeValue(me,W.target,0),sie({target:c,source:W.target,start:C,count:Re}));C+=Re*d}else e._normalizeValue(me,c,C),C+=d}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let OD={};function wo(n){Bi.level>0&&OD[n]&&OD[n].call(...arguments)}function Na(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const uj="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",hie=`#version 300 es\n${uj}`;function dj(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function hj(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?hie:e>300?`#version ${e}\n${uj}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return Na(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class fj extends Nu{static isSupported(e){return yi(e)}constructor(e,t={}){jo(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,bg(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,hn.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof or?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class mie{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof or?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&rn(yi(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new fj(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],rn(i[s]instanceof or)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new or(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function pj(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const t0="vs",bie={[t0]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},LE="__LUMA_INJECT_DECLARATIONS__",gj=/void\s+main\s*\([^)]*\)\s*\{\n?/,mj=/}\n?[^{}]*$/,ND=[];function _j(n,e,t,i=!1){const r=e===t0;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),ND.length=o.length;for(let l=0,c=o.length;l<c;++l)ND[l]=o[l].injection;const a=`${ND.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(LE,a));break;case"vs:#main-start":r&&(n=n.replace(gj,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(mj,l=>a+l));break;case"fs:#decl":r||(n=n.replace(LE,a));break;case"fs:#main-start":r||(n=n.replace(gj,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(mj,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(LE,""),i&&(n=n.replace(/\}\s*$/,s=>s+bie[e])),n}function PD(n){const e={};return Na(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const vie={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},kE="transform_uSize_",yj="transform_position";const Mie={10241:9728,10240:9728,10242:33071,10243:33071};class Iie{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const f in this.samplerTextureMap)a[f]=i[this.samplerTextureMap[f]];this._setSourceTextureParameters();const d=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${kE}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${kE}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,d)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=IE(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Na(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof Ra)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new or(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Os(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(Mie)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function(n,e){rn(n instanceof Ra||n instanceof cne||n instanceof une);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:d}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:d},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(e);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const d=l.split("\n"),f=d.slice();if(d.forEach((p,g,_)=>{if(s>0){const C=function(n,e){const t={},i=function(n){return dj(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${kE}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),f=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Na(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":f},samplerTextureMap:t}}return null}(p,e);if(C){const{updatedLine:T,inject:W}=C;f[g]=T,c=PD([c,W]),Object.assign(a,C.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=dj(n,["varying","out"]);return t&&t.name===e?t.type:null}(p,t))}),t){rn(i);const p=`${kE}${t}`;c=PD([c,{"vs:#decl":`uniform vec2 ${p};\n`,"vs:#main-start":`     vec2 ${yj} = transform_getPos(${p});\n     gl_Position = vec4(${yj}, 0, 1.);\n`}])}l=f.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=PD([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||hj({version:pj(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[vie].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const FD={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function Rie(n){let e=bj(n);return"object"===e?n?"type"in n?Object.assign({},n,FD[n.type]):"value"in n?(e=bj(n.value),Object.assign({type:e},n,FD[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},FD[e])}function bj(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class LD{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:d,fragmentShader:f}){Na("string"==typeof e),this.name=e,this.vs=t||d,this.fs=i||f,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=Rie(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Na(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Na(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function Lie(n){return function(n){const e={},t={};return kD({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(wj(n))}function kD({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&kD({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function wj(n,e){return n.map(t=>(t instanceof LD||(Na("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),Na(t.name,"shader module has no name"),(t=new LD(t)).dependencies=wj(t.dependencies)),t))}const BD={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},gf={};function Gie(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/Apple/i)||e.match(/Apple/i)?"APPLE":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN"}Object.keys(BD).forEach(n=>{gf[n]=n});const jD={};function Ej(n,e,t={}){const i=BD[e];if(Na(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in jD)return jD[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),jD[e]=l,l}function BE(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=BD[e];Na(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return Na(!1===r||!0===r),r}(n,t))}function xg(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const Sj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Kie=[...Sj,[xg("attribute"),"in $1"],[xg("varying"),"out $1"]],Yie=[...Sj,[xg("varying"),"in $1"]],xj=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Xie=[...xj,[xg("in"),"attribute $1"],[xg("out"),"varying $1"]],Qie=[...xj,[xg("in"),"varying $1"]],VD="gl_FragColor",UD=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Zie=/void\s+main\s*\([^)]*\)\s*\{\n?/;function jE(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const nre=`\n\n${LE}\n\n`,Cj={[t0]:"vertex",fs:"fragment"};function Aj(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:d}){Na("string"==typeof t,"shader source must be a string");const f=i===t0,p=t.split("\n");let g=100,_="",C=t;0===p[0].indexOf("#version ")?(g=300,_=p[0],C=p.slice(1).join("\n")):_=`#version ${g}`;const T={};r.forEach(Ge=>{Object.assign(T,Ge.getDefines())}),Object.assign(T,s);let W=c?`${_}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${Cj[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${Cj[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:Gie(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return BE(n,gf.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),BE(n,gf.GLSL_DERIVATIVES)&&Ej(n,gf.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),BE(n,gf.GLSL_FRAG_DATA)&&Ej(n,gf.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),BE(n,gf.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(T)}\n${f?"":"precision highp float;\n\n"}\n`:`${_}\n`;const H=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),me={},Re={},ze={};for(const Ge in a){const at="string"==typeof a[Ge]?{injection:a[Ge],order:0}:a[Ge],St=Ge.match(/^(v|f)s:(#)?([\w-]+)$/);if(St){const Pt=St[3];St[2]?"decl"===Pt?Re[Ge]=[at]:ze[Ge]=[at]:me[Ge]=[at]}else ze[Ge]=[at]}for(const Ge of r){d&&Ge.checkDeprecations(C,d),W+=Ge.getModuleSource(i,g);const St=Ge.injections[i];for(const Ot in St){const Pt=Ot.match(/^(v|f)s:#([\w-]+)$/);if(Pt){const en="decl"===Pt[2]?Re:ze;en[Ot]=en[Ot]||[],en[Ot].push(St[Ot])}else me[Ot]=me[Ot]||[],me[Ot].push(St[Ot])}}return W+=nre,W=_j(W,i,Re),W+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(H[i],me),W+=C,W=_j(W,i,ze),W=function(n,e,t){switch(e){case 300:return t?jE(n,Kie):function(n){const e=(n=jE(n,Yie)).match(UD);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${VD}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace(Zie,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${VD}\\b`,"g"),t)}return n}(n);case 100:return t?jE(n,Xie):function(n){const e=(n=jE(n,Qie)).match(UD);if(e){const t=e[1];n=n.replace(UD,"").replace(new RegExp(`\\b${t}\\b`,"g"),VD)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(W,l?100:g,f),W}function sre(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const dre={5126:Tr.bind(null,"uniform1fv",Pa,1,Eo),35664:Tr.bind(null,"uniform2fv",Pa,2,Eo),35665:Tr.bind(null,"uniform3fv",Pa,3,Eo),35666:Tr.bind(null,"uniform4fv",Pa,4,Eo),5124:Tr.bind(null,"uniform1iv",Kd,1,Eo),35667:Tr.bind(null,"uniform2iv",Kd,2,Eo),35668:Tr.bind(null,"uniform3iv",Kd,3,Eo),35669:Tr.bind(null,"uniform4iv",Kd,4,Eo),35670:Tr.bind(null,"uniform1iv",Kd,1,Eo),35671:Tr.bind(null,"uniform2iv",Kd,2,Eo),35672:Tr.bind(null,"uniform3iv",Kd,3,Eo),35673:Tr.bind(null,"uniform4iv",Kd,4,Eo),35674:Tr.bind(null,"uniformMatrix2fv",Pa,4,Lu),35675:Tr.bind(null,"uniformMatrix3fv",Pa,9,Lu),35676:Tr.bind(null,"uniformMatrix4fv",Pa,16,Lu),35678:no,35680:no,5125:Tr.bind(null,"uniform1uiv",VE,1,Eo),36294:Tr.bind(null,"uniform2uiv",VE,2,Eo),36295:Tr.bind(null,"uniform3uiv",VE,3,Eo),36296:Tr.bind(null,"uniform4uiv",VE,4,Eo),35685:Tr.bind(null,"uniformMatrix2x3fv",Pa,6,Lu),35686:Tr.bind(null,"uniformMatrix2x4fv",Pa,8,Lu),35687:Tr.bind(null,"uniformMatrix3x2fv",Pa,6,Lu),35688:Tr.bind(null,"uniformMatrix3x4fv",Pa,12,Lu),35689:Tr.bind(null,"uniformMatrix4x2fv",Pa,8,Lu),35690:Tr.bind(null,"uniformMatrix4x3fv",Pa,12,Lu),35678:no,35680:no,35679:no,35682:no,36289:no,36292:no,36293:no,36298:no,36299:no,36300:no,36303:no,36306:no,36307:no,36308:no,36311:no},hre={},fre={},pre={},Tj=[0];function zD(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(Tj[0]=n,n=Tj);const r=n.length;if(r%e&&hn.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Pa(n,e){return zD(n,e,Float32Array,hre)}function Kd(n,e){return zD(n,e,Int32Array,fre)}function VE(n,e){return zD(n,e,Uint32Array,pre)}function Mj(n,e,t){const i=dre[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function gre(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function _re(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof wg||n instanceof Eg)||n instanceof Os&&Boolean(n.texture)}function yre(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function no(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Tr(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),d=c.length;let f=!1;if(null===r)r=new Float32Array(d),s=d,f=!0;else{rn(s===d,"Uniform length cannot change.");for(let p=0;p<d;++p)if(c[p]!==r[p]){f=!0;break}}return f&&(i(o,n,a,c),r.set(c)),f}}function Eo(n,e,t,i){n[e](t,i)}function Lu(n,e,t,i){n[e](t,!1,i)}function UE(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function Ij(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=Oj(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function Oj(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class n0 extends Nu{static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return rn(!1),"unknown"}}constructor(e,t){DE(e),rn("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:UE(t.source,null)||t.id||kc(`unnamed ${n0.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=UE(e,null);t&&(this.id=kc(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${n0.getTypeName(this.shaderType)}:${this.id}`}getName(){return UE(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||UE(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let d=0;d<r.length;d++){const f=r[d];if(f.length<=1)continue;const p=f.split(":"),g=p[0],_=parseInt(p[2],10);if(isNaN(_))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[_]=f:o[_]=f}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return Oj(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:Ij(s,c),warnings:Ij(o,c)}}(i,this.source,this.shaderType,this.id);throw hn.error(`GLSL compilation errors in ${r}\n${s}`)(),hn.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class HD extends n0{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class GD extends n0{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Rs=5126,r0=5124,s0=5125,$D={[Rs]:[Rs,1,"float"],35664:[Rs,2,"vec2"],35665:[Rs,3,"vec3"],35666:[Rs,4,"vec4"],[r0]:[r0,1,"int"],35667:[r0,2,"ivec2"],35668:[r0,3,"ivec3"],35669:[r0,4,"ivec4"],[s0]:[s0,1,"uint"],36294:[s0,2,"uvec2"],36295:[s0,3,"uvec3"],36296:[s0,4,"uvec4"],35670:[Rs,1,"bool"],35671:[Rs,2,"bvec2"],35672:[Rs,3,"bvec3"],35673:[Rs,4,"bvec4"],35674:[Rs,8,"mat2"],35685:[Rs,8,"mat2x3"],35686:[Rs,8,"mat2x4"],35675:[Rs,12,"mat3"],35687:[Rs,12,"mat3x2"],35688:[Rs,12,"mat3x4"],35676:[Rs,16,"mat4"],35689:[Rs,16,"mat4x2"],35690:[Rs,16,"mat4x3"]};function kj(n){const e=$D[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function Bj(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Rs}for(const t in $D){const[i,r,s]=$D[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class Zre{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!yi(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=kj(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new oa(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=kj(i),l={location:e,name:t,accessor:new oa({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const Jre=35981,ese=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Vj extends Nu{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",ese),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=Jre}=e;return this.hash=t||"",this.vs="string"==typeof i?new HD(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new GD(this.gl,{id:`${e.id}-fs`,source:r}):r,rn(this.vs instanceof HD),rn(this.fs instanceof GD),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(jo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Zre(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:d=c>0,vertexArray:f=null,transformFeedback:p,framebuffer:g,parameters:_={},uniforms:C,samplers:T}){if((C||T)&&(hn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(C||{})),hn.priority>=e){const W=g?g.id:"default",H=`mode=${Wd(this.gl,t)} verts=${i} instances=${c} indexType=${Wd(this.gl,l)} isInstanced=${d} isIndexed=${a} Framebuffer=${W}`;hn.log(e,H)()}return rn(f),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||d&&0===c||(f.bindForDraw(i,c,()=>{if(void 0!==g&&(_=Object.assign({},_,{framebuffer:g})),p){const W=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return rn(!1),0}}(t);p.begin(W)}this._bindTextures(),tc(this.gl,_,()=>{a&&d?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&yi(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):d?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),p&&p.end()}),0))}setUniforms(e={}){hn.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!_re(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Os&&(s=s.texture),s instanceof wg)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&yre(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new HD({handle:r});break;case 35632:i.fs=new GD({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=kc(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),hn.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),hn.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||hn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=gre(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=Mj(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=Mj(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class o0{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new o0(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),d=this._getHash(t),f=this._getHash(i),p=c.map(me=>this._getHash(me.name)).sort(),g=o.map(me=>this._getHash(me)),_=Object.keys(r).sort(),C=Object.keys(s).sort(),T=[],W=[];for(const me of _)T.push(this._getHash(me)),T.push(this._getHash(r[me]));for(const me of C)W.push(this._getHash(me)),W.push(this._getHash(s[me]));const H=`${d}/${f}D${T.join("/")}M${p.join("/")}I${W.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[H]){const me=function(n,e){const{vs:t,fs:i}=e,r=Lie(e.modules||[]);return{gl:n,vs:Aj(n,Object.assign({},e,{source:t,type:t0,modules:r})),fs:Aj(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:sre(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[H]=new Vj(this.gl,{hash:H,vs:me.vs,fs:me.fs,varyings:o,bufferMode:a}),this._getUniforms[H]=me.getUniforms||(Re=>{}),this._useCounts[H]=0}return this._useCounts[H]++,this._programCache[H]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let HE=null;class Fa extends Nu{static isSupported(e,t={}){return!t.constantAttributeZero||yi(e)||"Chrome"===function(n){if(!iD())return"Node";if(Z3(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":Gy.chrome?"Chrome":Gy.safari?"Safari":Gy.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Fa(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Fa.MAX_ATTRIBUTES=Fa.MAX_ATTRIBUTES||e.getParameter(34921),Fa.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:Fa._setConstantFloatArray(e,t,i);break;case Int32Array:Fa._setConstantIntArray(e,t,i);break;case Uint32Array:Fa._setConstantUintArray(e,t,i);break;default:rn(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Fa.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return rn(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:d}=i,{gl:f,gl2:p}=this;return e=Number(e),this.bind(()=>{f.bindBuffer(34962,t.handle),c?(rn(yi(f)),p.vertexAttribIPointer(e,r,s,o,a)):f.vertexAttribPointer(e,r,s,l,o,a),f.enableVertexAttribArray(e),p.vertexAttribDivisor(e,d||0)}),this}enable(e,t=!0){return!t&&0===e&&!Fa.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new or(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!HE||HE.byteLength<n)&&(HE=new ArrayBuffer(n)),HE}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:rn(!1)}}static _setConstantIntArray(e,t,i){switch(rn(yi(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:rn(!1)}}static _setConstantUintArray(e,t,i){switch(rn(yi(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:rn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return rn(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const ase=/^(.+)__LOCATION_([0-9]+)$/,lse=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class cse{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Fa(e),TB(this,"VertexArray","v6.0",lse),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new or(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof or&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof or&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,hn.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const d=oa.resolve(l.accessor,this.accessors[o]||{},i,r),{size:f,type:p}=d;return rn(Number.isFinite(f)&&Number.isFinite(p)),{location:o,accessor:d}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=ase.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof or)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof or)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof or))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(Fa.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){Fa.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof or){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return hn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function a0(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=a0(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function Uj(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,d,f,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof or){const p=e,{data:g,changed:_}=p.getDebugData();let C;return d=_?"*":"",f=g,l=p.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?C=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${Wd(r,s)})`:(c=!0,C=`${l} bytes`),{[i]:`${d}${a0(f,{size:o,isInteger:c})}`,"Format ":C}}return f=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${a0(f,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function hse(n,e){const{type:t,size:i}=e,r=Bj(t,i);return r?`${n} (${r.name})`:n}function zj({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){rn(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const p of l)!p.match(".*_.*")&&!p.match(s)&&WD({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)p.match(s)&&WD({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)a[p]||WD({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;let d=0;const f={};if(!i)for(const p in t){const g=t[p];a[p]||(d++,f[p]={Type:`NOT USED: ${g}`,[n]:a0(g)})}return{table:a,count:c,unusedTable:f,unusedCount:d}}function WD({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?a0(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function Hj(n){const{type:e,size:t}=n.accessor,i=Bj(e,t);return i?`${i.name} ${n.name}`:n.name}const gse={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function _se(n,e){const{attributeMap:t=gse}=e||{};return t&&t[n]||n}function yse(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}rn(Number.isFinite(e.size),`attribute ${n} needs size`)}const Gj=()=>{},wse={};class GE{constructor(e,t={}){const{id:i=kc("model")}=t;rn(ME(e)),this.id=i,this.gl=e,this.id=t.id||kc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||o0.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},rn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return rn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return rn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=_se(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=ht({},o);delete c.value,i[a]=[new or(n,l),c],yse(s,c)}}if(r){const s=r.value||r;rn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new or(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(bg(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return yD(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),hn.priority>=2&&(c=this._logDrawCallStart(2));const d=this.vertexArray.getDrawParams(),{isIndexed:f=d.isIndexed,indexType:p=d.indexType,indexOffset:g=d.indexOffset,vertexArrayInstanced:_=d.isInstanced}=this.props;_&&!this.isInstanced&&hn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:C,instanceCount:T}=this,{onBeforeRender:W=Gj,onAfterRender:H=Gj}=this.props;W(),this.program.setUniforms(this.uniforms);const me=this.program.draw(Object.assign(wse,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:f,indexType:p,isInstanced:C,instanceCount:T,offset:f?g:0}));return H(),hn.priority>=2&&this._logDrawCallEnd(c,l,i),me}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return hn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:d}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}rn(t instanceof Vj,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new cse(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof or&&t.delete()}}_setAnimationProps(e){this.animated&&rn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(bg(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new fj(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),hn.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:hn.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=Uj(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${hse(s.name,a)}`),t[o]=Uj(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=zj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:d}=zj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});d>0&&hn.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&hn.log("UNUSED UNIFORMS",Object.keys(a))();const f=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${Hj(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${Hj(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);hn.table(e,s)(),hn.table(e,o)(),hn.table(e+1,f)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),hn.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class qD{static isSupported(e){return yi(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();rn(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new GE(t,Object.assign({},e,{fs:e.fs||hj({version:pj(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(bg(n.feedbackBuffers)&&bg(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new mie(e,t)),function(n){return!(bg(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new Iie(e,t)),rn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function $E(){}const xse={onStart:$E,onUpdate:$E,onInterrupt:$E,onEnd:$E};class l0{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=ht(ht({},xse),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Rse={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new l0(i),this.attribute=t,this.attributeInTransition=new ID(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=aj(e.size);return new qD(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new or(e,r),new or(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;lj(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)cj(ht({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=DD(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:oj(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new l0(i),this.attribute=t,this.attributeInTransition=new ID(e,Hn(ht({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new Ra(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new Os(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=aj(e.size);return new qD(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new or(e,r),new or(e,r),new or(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)cj(ht({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=DD(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:oj(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),lj(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),IE(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Nse{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=qD.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void Bi.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=Rse[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Bi.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const $j="attributeManager.invalidate";class jse{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Nse(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);wo($j,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);wo($j,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;wo("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const d=this.attributes[c],f=d.settings.accessor;d.startIndices=i,s[c]&&Bi.removed("props.".concat(c),"data.attributes.".concat(c))(),d.setExternalBuffer(o[c])||d.setBinaryValue(o[f],e.startIndices)||!o[f]&&d.setConstantValue(s[f])||d.needsUpdate()&&(l=!0,this._updateAttribute({attribute:d,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=d.needsRedraw()}l&&wo("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=ht({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&Bi.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=Hn(ht({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new ID(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;wo("attribute.updateStart",t),t.allocate(i)&&wo("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,wo("attribute.updateEnd",t,i))}}function qj(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function Kj(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const Hse={interpolation:class extends l0{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=OE(t,i,o)}},spring:class extends l0{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=qj(n[o],e[o],t[o],i,r);return s}return qj(n,e,t,i,r)}(s,o,t,i,r);const l=Kj(a,t),c=Kj(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class Gse{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=sj(r)))return;const o=Hse[r.type];if(!o)return void Bi.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(Hn(ht({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const WE={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:$se}=WE;function Kse(n,e){if(!n.transitions)return null;const t={},i=YD(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&KD(n[r],e[r],s)&&(t[r]=!0)}return t}function Yj({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=KD(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=KD(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function KD(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Qse(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function Xj(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,Yj({oldProps:r,newProps:i,triggerName:t})}function YD(n){const e=n[$se],t=e&&e.constructor;return t?t._propTypes:{}}function ioe(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function qE(n){let t,e={};return i=>{for(const r in i)if(!ioe(i[r],e[r])){t=n(i),e=i;break}return t}}function roe(n,e){if(!e)return n;const t=ht(ht({},n),e);if("defines"in e&&(t.defines=ht(ht({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=ht({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function KE(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],f=e[9],p=e[10],g=e[11],_=e[12],C=e[13],T=e[14],W=e[15],H=t*a-i*o,me=t*l-r*o,Re=t*c-s*o,ze=i*l-r*a,Ge=i*c-s*a,at=r*c-s*l,St=d*C-f*_,Ot=d*T-p*_,Pt=d*W-g*_,Zt=f*T-p*C,en=f*W-g*C,wt=p*W-g*T,Ct=H*wt-me*en+Re*Zt+ze*Pt-Ge*Ot+at*St;return Ct?(n[0]=(a*wt-l*en+c*Zt)*(Ct=1/Ct),n[1]=(r*en-i*wt-s*Zt)*Ct,n[2]=(C*at-T*Ge+W*ze)*Ct,n[3]=(p*Ge-f*at-g*ze)*Ct,n[4]=(l*Pt-o*wt-c*Ot)*Ct,n[5]=(t*wt-r*Pt+s*Ot)*Ct,n[6]=(T*Re-_*at-W*me)*Ct,n[7]=(d*at-p*Re+g*me)*Ct,n[8]=(o*en-a*Pt+c*St)*Ct,n[9]=(i*Pt-t*en-s*St)*Ct,n[10]=(_*Ge-C*Re+W*H)*Ct,n[11]=(f*Re-d*Ge-g*H)*Ct,n[12]=(a*Ot-o*Zt-l*St)*Ct,n[13]=(t*Zt-i*Ot+r*St)*Ct,n[14]=(C*me-_*ze-T*H)*Ct,n[15]=(d*ze-f*me+p*H)*Ct,n):null}function Bc(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],d=e[7],f=e[8],p=e[9],g=e[10],_=e[11],C=e[12],T=e[13],W=e[14],H=e[15],me=t[0],Re=t[1],ze=t[2],Ge=t[3];return n[0]=me*i+Re*a+ze*f+Ge*C,n[1]=me*r+Re*l+ze*p+Ge*T,n[2]=me*s+Re*c+ze*g+Ge*W,n[3]=me*o+Re*d+ze*_+Ge*H,n[4]=(me=t[4])*i+(Re=t[5])*a+(ze=t[6])*f+(Ge=t[7])*C,n[5]=me*r+Re*l+ze*p+Ge*T,n[6]=me*s+Re*c+ze*g+Ge*W,n[7]=me*o+Re*d+ze*_+Ge*H,n[8]=(me=t[8])*i+(Re=t[9])*a+(ze=t[10])*f+(Ge=t[11])*C,n[9]=me*r+Re*l+ze*p+Ge*T,n[10]=me*s+Re*c+ze*g+Ge*W,n[11]=me*o+Re*d+ze*_+Ge*H,n[12]=(me=t[12])*i+(Re=t[13])*a+(ze=t[14])*f+(Ge=t[15])*C,n[13]=me*r+Re*l+ze*p+Ge*T,n[14]=me*s+Re*c+ze*g+Ge*W,n[15]=me*o+Re*d+ze*_+Ge*H,n}function c0(n,e,t){var o,a,l,c,d,f,p,g,_,C,T,W,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],d=e[4],f=e[5],p=e[6],g=e[7],_=e[8],C=e[9],T=e[10],W=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=d,n[5]=f,n[6]=p,n[7]=g,n[8]=_,n[9]=C,n[10]=T,n[11]=W,n[12]=o*i+d*r+_*s+e[12],n[13]=a*i+f*r+C*s+e[13],n[14]=l*i+p*r+T*s+e[14],n[15]=c*i+g*r+W*s+e[15]),n}function u0(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Qj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],d=e[9],f=e[10],p=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+d*i,n[6]=a*r+f*i,n[7]=l*r+p*i,n[8]=c*r-s*i,n[9]=d*r-o*i,n[10]=f*r-a*i,n[11]=p*r-l*i,n}function Zj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],d=e[5],f=e[6],p=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+d*i,n[2]=a*r+f*i,n[3]=l*r+p*i,n[4]=c*r-s*i,n[5]=d*r-o*i,n[6]=f*r-a*i,n[7]=p*r-l*i,n}function Jj(n,e,t,i,r){var o,s=1/Math.tan(e/2);return n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i),n}function eV(n,e){var t=n[0],i=n[1],r=n[2],s=n[3],o=n[4],a=n[5],l=n[6],c=n[7],d=n[8],f=n[9],p=n[10],g=n[11],_=n[12],C=n[13],T=n[14],W=n[15],H=e[0],me=e[1],Re=e[2],ze=e[3],Ge=e[4],at=e[5],St=e[6],Ot=e[7],Pt=e[8],Zt=e[9],en=e[10],wt=e[11],Ct=e[12],Ut=e[13],pt=e[14],Kt=e[15];return Math.abs(t-H)<=mr*Math.max(1,Math.abs(t),Math.abs(H))&&Math.abs(i-me)<=mr*Math.max(1,Math.abs(i),Math.abs(me))&&Math.abs(r-Re)<=mr*Math.max(1,Math.abs(r),Math.abs(Re))&&Math.abs(s-ze)<=mr*Math.max(1,Math.abs(s),Math.abs(ze))&&Math.abs(o-Ge)<=mr*Math.max(1,Math.abs(o),Math.abs(Ge))&&Math.abs(a-at)<=mr*Math.max(1,Math.abs(a),Math.abs(at))&&Math.abs(l-St)<=mr*Math.max(1,Math.abs(l),Math.abs(St))&&Math.abs(c-Ot)<=mr*Math.max(1,Math.abs(c),Math.abs(Ot))&&Math.abs(d-Pt)<=mr*Math.max(1,Math.abs(d),Math.abs(Pt))&&Math.abs(f-Zt)<=mr*Math.max(1,Math.abs(f),Math.abs(Zt))&&Math.abs(p-en)<=mr*Math.max(1,Math.abs(p),Math.abs(en))&&Math.abs(g-wt)<=mr*Math.max(1,Math.abs(g),Math.abs(wt))&&Math.abs(_-Ct)<=mr*Math.max(1,Math.abs(_),Math.abs(Ct))&&Math.abs(C-Ut)<=mr*Math.max(1,Math.abs(C),Math.abs(Ut))&&Math.abs(T-pt)<=mr*Math.max(1,Math.abs(T),Math.abs(pt))&&Math.abs(W-Kt)<=mr*Math.max(1,Math.abs(W),Math.abs(Kt))}function tV(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function YE(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}!function(){var n=new aa(4);aa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const nV=[0,0,0,0],Ioe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ooe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Roe=[0,0,0],Noe=[0,0,0],Poe=qE(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=nV,l=nV,c=n.cameraPosition;const{geospatialOrigin:d,shaderCoordinateOrigin:f,offsetMode:p}=iV(n,e,t);return p&&(l=n.projectPosition(d||f),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=YE([],l,o),s=i||s,o=Bc([],r,s),o=Bc([],o,Ioe)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:d}}(n,t,i),d=n.getDistanceScales(),f=[n.width*e,n.height*e],p=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:p,project_uCommonUnitsPerMeter:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Roe,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const _=n.getDistanceScales(c);switch(t){case Pi.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=_.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=_.unitsPerMeter2;break;case Pi.LNGLAT:case Pi.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=_.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=_.unitsPerDegree2;break;case Pi.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,_.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,_.unitsPerMeter2[2]]}}return g});function iV(n,e,t=Noe){let r,i=t,s=!0;switch(r=e===Pi.LNGLAT_OFFSETS||e===Pi.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case Fc.WEB_MERCATOR:(e===Pi.LNGLAT||e===Pi.CARTESIAN)&&(s=!1);break;case Fc.WEB_MERCATOR_AUTO_OFFSET:e===Pi.LNGLAT?i=r:e===Pi.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case Fc.IDENTITY:i=n.position.map(Math.fround);break;case Fc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class Boe extends SD{get ELEMENTS(){return Fu(!1),0}get RANK(){return Fu(!1),0}toString(){let e="[";if(Ar.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=to(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function Dg(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function XD(n,e){return n[0]=-e[0],n[1]=-e[1],n}function rV(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}!function(){var n=new aa(2);aa!=Float32Array&&(n[0]=0,n[1]=0)}();const sV=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Uoe=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zoe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Ig={};class qn extends Boe{static get IDENTITY(){return Ig.IDENTITY=Ig.IDENTITY||Object.freeze(new qn(sV)),Ig.IDENTITY}static get ZERO(){return Ig.ZERO=Ig.ZERO||Object.freeze(new qn(Uoe)),Ig.ZERO}get INDICES(){return zoe}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,d,f,p,g,_,C,T){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=d,this[10]=f,this[11]=p,this[12]=g,this[13]=_,this[14]=C,this[15]=T,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,d,f,p,g,_,C,T){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=d,this[7]=_,this[8]=i,this[9]=a,this[10]=f,this[11]=C,this[12]=r,this[13]=l,this[14]=p,this[15]=T,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(sV)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,d=i*o,f=i*a,p=r*o,g=r*a,_=r*l,C=s*o,T=s*a,W=s*l;n[0]=1-f-_,n[1]=d+W,n[2]=p-T,n[3]=0,n[4]=d-W,n[5]=1-c-_,n[6]=g+C,n[7]=0,n[8]=p+T,n[9]=g-C,n[10]=1-c-f,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?qn._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),d=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=d,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,d,f,p,g,_=e[0],C=e[1],T=e[2],W=i[0],H=i[1],me=i[2],Re=t[0],ze=t[1],Ge=t[2];Math.abs(_-Re)<mr&&Math.abs(C-ze)<mr&&Math.abs(T-Ge)<mr?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(d=_-Re,f=C-ze,p=T-Ge,r=H*(p*=g=1/Math.hypot(d,f,p))-me*(f*=g),s=me*(d*=g)-W*p,o=W*f-H*d,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=f*o-p*s,l=p*r-d*o,c=d*s-f*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=d,n[3]=0,n[4]=s,n[5]=l,n[6]=f,n[7]=0,n[8]=o,n[9]=c,n[10]=p,n[11]=0,n[12]=-(r*_+s*C+o*T),n[13]=-(a*_+l*C+c*T),n[14]=-(d*_+f*C+p*T),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new qn).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return Jj(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],d=n[9],f=n[10],p=n[11],g=n[12],_=n[13],C=n[14],T=n[15];return(e*o-t*s)*(f*T-p*C)-(e*a-i*s)*(d*T-p*_)+(e*l-r*s)*(d*C-f*_)+(t*a-i*o)*(c*T-p*g)-(t*l-r*o)*(c*C-f*g)+(i*l-r*a)*(c*_-d*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return KE(this,this),this.check()}multiplyLeft(e){return Bc(this,e,this),this.check()}multiplyRight(e){return Bc(this,this,e),this.check()}rotateX(e){return Qj(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],d=e[9],f=e[10],p=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-d*i,n[2]=a*r-f*i,n[3]=l*r-p*i,n[8]=s*i+c*r,n[9]=o*i+d*r,n[10]=a*i+f*r,n[11]=l*i+p*r}(this,this,e),this.check()}rotateZ(e){return Zj(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,d,f,p,g,_,C,T,W,H,me,Re,ze,Ge,at,St,Ot,Pt,Zt,en,wt,Ct,Ut,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<mr||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),p=e[1],g=e[2],_=e[3],T=e[5],W=e[6],H=e[7],Re=e[9],ze=e[10],Ge=e[11],Pt=r*s*(d=1-c)-o*l,Zt=s*s*d+c,en=o*s*d+r*l,wt=r*o*d+s*l,Ct=s*o*d-r*l,Ut=o*o*d+c,n[0]=(f=e[0])*(at=r*r*d+c)+(C=e[4])*(St=s*r*d+o*l)+(me=e[8])*(Ot=o*r*d-s*l),n[1]=p*at+T*St+Re*Ot,n[2]=g*at+W*St+ze*Ot,n[3]=_*at+H*St+Ge*Ot,n[4]=f*Pt+C*Zt+me*en,n[5]=p*Pt+T*Zt+Re*en,n[6]=g*Pt+W*Zt+ze*en,n[7]=_*Pt+H*Zt+Ge*en,n[8]=f*wt+C*Ct+me*Ut,n[9]=p*wt+T*Ct+Re*Ut,n[10]=g*wt+W*Ct+ze*Ut,n[11]=_*wt+H*Ct+Ge*Ut,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?u0(this,this,e):u0(this,this,[e,e,e]),this.check()}translate(e){return c0(this,this,e),this.check()}transform(e,t){return 4===e.length?(RE(t=YE(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=YB(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return RE(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=XB(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return RE(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return xD("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return xD("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return xD("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Og(n,e){const t=YE([],e,n);return tV(t,t,1/t[3]),t}function oV(n,e){const t=n%e;return t<0?e+t:t}const QD=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function ku(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const ic=Math.PI,aV=ic/4,rc=ic/180,ZD=180/ic,JD=4003e4;function Rg([n,e]){return ku(Number.isFinite(n)),ku(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*rc+ic)/(2*ic),512*(ic+Math.log(Math.tan(aV+e*rc*.5)))/(2*ic)]}function Yd([n,e]){const t=n/512*(2*ic)-ic,i=2*(Math.atan(Math.exp(e/512*(2*ic)-ic))-aV);return[t*ZD,i*ZD]}function QE({latitude:n,longitude:e,highPrecision:t=!1}){ku(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*rc),o=512/360,a=o/s,l=512/JD/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=rc*Math.tan(n*rc)/s,f=512/JD*c,p=f/a*l;i.unitsPerDegree2=[0,o*c/2,f],i.unitsPerMeter2=[p,0,p]}return i}function cV(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=QE({longitude:t,latitude:i,highPrecision:!0}),d=Rg(n);d[0]+=s*(l[0]+c[0]*o),d[1]+=o*(l[1]+c[1]*o);const f=Yd(d),p=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[f[0],f[1],p]:f}function uV({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return c0(o,o,[0,0,-i]),Qj(o,o,-e*rc),Zj(o,o,t*rc),u0(o,o,[r/=n,r,r]),s&&c0(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}function dV({width:n,height:e,fovy:t=ZE(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=ZE(i));const a=.5*t*rc,l=hV(t),c=r*rc,d=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*d+l)*o}}function ZE(n){return 2*Math.atan(.5/n)*ZD}function hV(n){return.5/Math.tan(.5*n*rc)}function eI(n,e){const[t,i,r=0]=n;return ku(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Og(e,[t,i,r,1])}function mf(n,e,t=0){const[i,r,s]=n;if(ku(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Og(e,[i,r,s,1]);const o=Og(e,[i,r,0,1]),a=Og(e,[i,r,1,1]),l=o[2],c=a[2];return rV([],o,a,l===c?0:((t||0)-l)/(c-l))}function fV({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,d]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:ku(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const f=new JE({width:n,height:e,longitude:0,latitude:0,zoom:0}),p=f.project([a,d]),g=f.project([c,l]),_=[Math.max(Math.abs(g[0]-p[0]),i),Math.max(Math.abs(g[1]-p[1]),i)],C=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];ku(C[0]>0&&C[1]>0);const T=C[0]/_[0],W=C[1]/_[1],ze=f.unproject([(g[0]+p[0])/2+(s.right-s.left)/2/T,(g[1]+p[1])/2+(s.bottom-s.top)/2/W]),Ge=Math.min(r,f.zoom+QD(Math.abs(Math.min(T,W))));return ku(Number.isFinite(Ge)),{longitude:ze[0],latitude:ze[1],zoom:Ge}}const pV=Math.PI/180;function gV(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*pV:Math.atan(.5/n.altitude))>(90-n.pitch)*pV-.01?(l=mV(n,0,e),c=mV(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}function mV(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Og(i,[e,0,1,1]),s=Og(i,[e,n.height,1,1]),c=Yd(rV([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}class JE{constructor({width:e,height:t,latitude:i=0,longitude:r=0,zoom:s=0,pitch:o=0,bearing:a=0,altitude:l=null,fovy:c=null,position:d=null,nearZMultiplier:f=.02,farZMultiplier:p=1.01}={width:1,height:1}){e=e||1,t=t||1,null===c&&null===l?c=ZE(l=1.5):null===c?c=ZE(l):null===l&&(l=hV(c));const g=function(n){return Math.pow(2,n)}(s);l=Math.max(.75,l);const _=QE({longitude:r,latitude:i}),C=Rg([r,i]);C[2]=0,d&&function(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2]}(C,C,function(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}([],d,_.unitsPerMeter)),this.projectionMatrix=function({width:n,height:e,pitch:t,altitude:i,fovy:r,nearZMultiplier:s,farZMultiplier:o}){const{fov:a,aspect:l,near:c,far:d}=dV({width:n,height:e,altitude:i,fovy:r,pitch:t,nearZMultiplier:s,farZMultiplier:o});return Jj([],a,l,c,d)}({width:e,height:t,pitch:o,fovy:c,nearZMultiplier:f,farZMultiplier:p}),this.viewMatrix=uV({height:t,scale:g,center:C,pitch:o,bearing:a,altitude:l}),this.width=e,this.height=t,this.scale=g,this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=l,this.fovy=c,this.center=C,this.meterOffset=d||[0,0,0],this.distanceScales=_,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:e,height:t,projectionMatrix:i,viewMatrix:r}=this,s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Bc(s,s,i),Bc(s,s,r),this.viewProjectionMatrix=s;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u0(o,o,[e/2,-t/2,1]),c0(o,o,[1,-1,0]),Bc(o,o,s);const a=KE([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!a)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=a}equals(e){return e instanceof JE&&e.width===this.width&&e.height===this.height&&eV(e.projectionMatrix,this.projectionMatrix)&&eV(e.viewMatrix,this.viewMatrix)}project(e,{topLeft:t=!0}={}){const r=eI(this.projectPosition(e),this.pixelProjectionMatrix),[s,o]=r,a=t?o:this.height-o;return 2===e.length?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[r,s,o]=e,c=mf([r,t?s:this.height-s,o],this.pixelUnprojectionMatrix,i&&i*this.distanceScales.unitsPerMeter[2]),[d,f,p]=this.unprojectPosition(c);return Number.isFinite(o)?[d,f,p]:Number.isFinite(i)?[d,f,i]:[d,f]}projectPosition(e){const[t,i]=Rg(e);return[t,i,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,i]=Yd(e);return[t,i,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){return Rg(e)}unprojectFlat(e){return Yd(e)}getMapCenterByLngLatPosition({lngLat:e,pos:t}){const i=mf(t,this.pixelUnprojectionMatrix),s=Dg([],Rg(e),XD([],i));return Yd(Dg([],this.center,s))}getLocationAtPoint({lngLat:e,pos:t}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:t})}fitBounds(e,t={}){const{width:i,height:r}=this,{longitude:s,latitude:o,zoom:a}=fV(Object.assign({width:i,height:r,bounds:e},t));return new JE({width:i,height:r,longitude:s,latitude:o,zoom:a})}getBounds(e){const t=this.getBoundingRegion(e),i=Math.min(...t.map(a=>a[0])),r=Math.max(...t.map(a=>a[0]));return[[i,Math.min(...t.map(a=>a[1]))],[r,Math.max(...t.map(a=>a[1]))]]}getBoundingRegion(e={}){return gV(this,e.z||0)}}const Xoe=Math.PI/180,Qoe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],tI=[0,0,0],Joe={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let Ng=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Fc.WEB_MERCATOR:Fc.WEB_MERCATOR_AUTO_OFFSET:Fc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Zy(t.projectionMatrix,this.projectionMatrix)&&Zy(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=eI(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,d=mf([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[f,p,g]=this.unprojectPosition(d);return Number.isFinite(a)?[f,p,g]:Number.isFinite(r)?[f,p,r]:[f,p]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?Rg(t):t}unprojectFlat(t){return this.isGeospatial?Yd(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?QE({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=Sg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=Sg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=Sg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=Sg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=Sg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=Sg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new qn).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new qn).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=Qoe,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:d=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){ku(Number.isFinite(n));const e=Math.cos(n*rc);return function(n){return QD(n)}(JD*e)-9}({latitude:s})+Math.log2(c):0);const f=Math.pow(2,this.zoom);this.scale=f,this.distanceScales=this.isGeospatial?QE({latitude:s,longitude:r}):d||Joe,this.focalDistance=c,this.distanceScales.metersPerUnit=new vo(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new vo(this.distanceScales.unitsPerMeter),this.position=tI,this.meterOffset=tI,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new qn).multiplyRight(this.viewMatrixUncentered).translate(new vo(this.center||tI).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new vo(this.projectPosition([t,i,0]));if(r){const a=new vo(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*Xoe,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Bc(t,t,this.projectionMatrix),Bc(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=KE([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u0(i,i,[this.width/2,-this.height/2,1]),c0(i,i,[1,-1,0]),Bc(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=KE([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Bi.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),wV=(()=>{class n extends Ng{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:d=!1,repeat:f=!1,worldOffset:p=0}=t;let{width:g,height:_,altitude:C=1.5}=t;const T=Math.pow(2,s);g=g||1,_=_||1,C=Math.max(.75,C);const{fov:W,aspect:H,focalDistance:me,near:Re,far:ze}=dV({width:g,height:_,pitch:o,altitude:C,nearZMultiplier:l,farZMultiplier:c});let Ge=uV({height:_,pitch:o,bearing:a,scale:T,altitude:C});p&&(Ge=(new qn).translate([512*p,0,0]).multiplyLeft(Ge)),super(Hn(ht({},t),{width:g,height:_,viewMatrix:Ge,longitude:r,latitude:i,zoom:s,orthographic:d,fovyRadians:W,aspect:H,focalDistance:me,near:Re,far:ze})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=C,this.orthographic=d,this._subViewports=f?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(Hn(ht({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return cV(t,i)}panByPosition(t,i){const r=mf(i,this.pixelUnprojectionMatrix),o=Dg([],this.projectFlat(t),XD([],r)),a=Dg([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=gV(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=fV(ht({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function nI(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof wV){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function EV(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=YE([],[o,a,l,1],t)),i){case Pi.LNGLAT:return nI([o,a,l],e,s);case Pi.LNGLAT_OFFSETS:return nI([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Pi.METER_OFFSETS:return nI(cV(r,[o,a,l]),e,s);case Pi.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const nae={10241:9987,10240:9729,10242:33071,10243:33071},iI={},sae={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||f0(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>rI(n,e)},accessor:{validate(n,e){const t=eS(n);return"function"===t||t===eS(e.value)},equal:(n,e,t)=>"function"==typeof e||rI(n,e)},array:{validate:(n,e)=>e.optional&&!n||f0(n),equal:(n,e,t)=>t.compare?rI(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof Ra)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new Ra(t,Hn(ht({},e),{parameters:ht(ht(ht({},nae),i),n.props.textureParameters)}));return iI[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof Ra)||iI[n.id]&&(n.delete(),delete iI[n.id])}(n)}}};function rI(n,e){if(n===e)return!0;if(!f0(n)||!f0(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function aae(n,e){switch(eS(e)){case"object":return h0(n,e);case"array":return h0(n,{type:"array",value:e,compare:!1});case"boolean":return h0(n,{type:"boolean",value:e});case"number":return h0(n,{type:"number",value:e});case"function":return h0(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function h0(n,e){return"type"in e?ht(ht({name:n},sae[e.type]),e):"value"in e?ht({name:n,type:eS(e.value)},e):{name:n,type:"object",value:e}}function f0(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function eS(n){return f0(n)?"array":null===n?"null":typeof n}const{COMPONENT:sI,ASYNC_ORIGINAL:tS,ASYNC_RESOLVED:p0,ASYNC_DEFAULTS:nS}=WE;function lae(){const n=this,e=SV(n.constructor),t=Object.create(e);t[sI]=n,t[tS]={},t[p0]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function SV(n){return iS(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=SV(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=aae(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(iS(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=iS(n,"layerName")||iS(n,"componentName");return e||Bi.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=ht(ht({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=fae(o))}n[nS]=t,n[tS]={},Object.defineProperties(n,i)}(o,a);const l=ht(ht({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])xV(this,s)||(this[s]=i);Bi.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function fae(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||ij(e)?this[tS][n]=e:this[p0][n]=e},get(){if(this[p0]){if(n in this[p0])return this[p0][n]||this[nS][n];if(n in this[tS]){const e=this[sI]&&this[sI].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[nS][n]}}return this[nS][n]}}}function xV(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function iS(n,e){return xV(n,e)&&n[e]}function oI(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:gae,ASYNC_RESOLVED:mae,ASYNC_DEFAULTS:_ae}=WE,yae=Object.freeze({});class CV{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=yae,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[mae]||{},i=e[gae]||e,r=e[_ae]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(ij(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return ii(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var f,c=!0,d=!1;try{for(var g,_,p=oI(t);c=(g=yield p.next()).done,_=yield g.value,!c;c=!0){const T=_,{dataTransform:W}=i.component?i.component.props:{};a=W?W(T,a):a.concat(T),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(T){d=!0,f=T}finally{try{!c&&null!=p.return&&(yield p.return())}finally{if(d)throw f}}const C=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;C&&C(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:AV,ASYNC_RESOLVED:TV,ASYNC_DEFAULTS:bae}=WE,vae={};let wae=0,Eae=(()=>{class n{constructor(){this.props=lae.apply(this,arguments),this.id=this.props.id,this.count=wae++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[bae])s in i[TV]?r[s]=i[TV][s]:s in i[AV]&&(r[s]=i[AV][s]);return new this.constructor(ht(ht(ht({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new CV({})}}return n.componentName="Component",n.defaultProps=vae,n})();class Sae extends CV{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const sc=n=>"function"==typeof n,Xd=n=>null!==n&&"object"==typeof n,DV=n=>Xd(n)&&n.constructor==={}.constructor,xae=n=>n&&"function"==typeof n[Symbol.iterator],Cae=n=>n&&"function"==typeof n[Symbol.asyncIterator],g0=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Pg=n=>"undefined"!=typeof Blob&&n instanceof Blob,IV=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||Xd(n)&&sc(n.tee)&&sc(n.cancel)&&sc(n.getReader))(n)||(n=>Xd(n)&&sc(n.read)&&sc(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function _f(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function aI(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function lI(n){var e,t;let i;return _f(n,"null loader"),_f(aI(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=Hn(ht({},n=n[0]),{options:ht(ht({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const jc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},cI=jc.global||jc.self||jc.window||{},Oae="object"!=typeof process||"[object process]"!==String(process)||process.browser,OV="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);OV&&parseFloat(OV[1]);const dI={};function Rae(n){for(const e in dI)n.startsWith(e)&&(n=n.replace(e,dI[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const Nae=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Pae=/^([-\w.]+\/[-\w.+]+)/;function Fae(n){const e=Pae.exec(n);return e?e[1]:n}function RV(n){const e=Nae.exec(n);return e?e[1]:""}const Lae=/\?.*/;function rS(n){if(g0(n)){const e=hI(n.url||"");return{url:e,type:Fae(n.headers.get("content-type")||"")||RV(e)}}return Pg(n)?{url:hI(n.name||""),type:n.type||""}:"string"==typeof n?{url:hI(n),type:RV(n)}:{url:"",type:""}}function kae(n){return g0(n)?n.headers["content-length"]||-1:Pg(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function hI(n){return n.replace(Lae,"")}function NV(n){return fI.apply(this,arguments)}function fI(){return(fI=ii(function*(n){if(g0(n))return n;const e={},t=kae(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=rS(n);r&&(e["content-type"]=r);const s=yield Vae(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function Bae(n){return pI.apply(this,arguments)}function pI(){return(pI=ii(function*(n){if(!n.ok){const e=yield jae(n);throw new Error(e)}})).apply(this,arguments)}function jae(n){return gI.apply(this,arguments)}function gI(){return(gI=ii(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function Vae(n){return mI.apply(this,arguments)}function mI(){return(mI=ii(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${Uae(n.slice(0,5))}`:null})).apply(this,arguments)}function Uae(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function PV(n,e){return _I.apply(this,arguments)}function _I(){return(_I=ii(function*(n,e){if("string"==typeof n){n=Rae(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield NV(n)})).apply(this,arguments)}function Kn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const FV=new sD({id:"loaders.gl"});class zae{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const LV={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){Kn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Gae={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function yI(){cI.loaders=cI.loaders||{};const{loaders:n}=cI;return n._state=n._state||{},n._state}const bI=()=>{const n=yI();return n.globalOptions=n.globalOptions||ht({},LV),n.globalOptions};function $ae(n,e,t,i){return t=t||[],function(n,e){BV(n,null,LV,Gae,e);for(const t of e)BV(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=ht({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new zae),VV(r,bI()),VV(r,e),r}(e,n,i)}function kV(n,e){const t=bI(),i=n||t;return"function"==typeof i.fetch?i.fetch:Xd(i.fetch)?r=>PV(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:PV}function BV(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&Xd(n[a]),c="baseUri"===a&&!e,d="workerUrl"===a&&e;if(!(a in t)&&!c&&!d)if(a in i)FV.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const f=qae(a,r);FV.warn(`${s} loader option '${o}${a}' not recognized. ${f}`)()}}}function qae(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function VV(n,e){for(const t in e)t in e&&(n[t]=DV(e[t])&&DV(n[t])?ht(ht({},n[t]),e[t]):e[t])}function Vc(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function Xae(n,e="3.0.12"){return Vc(n,"no worker provided"),!(!e||!n.version)}const Uc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Qae=Uc.global||Uc.self||Uc.window||{},vI="object"!=typeof process||"[object process]"!==String(process)||process.browser,wI="function"==typeof importScripts,Zae="undefined"!=typeof window&&void 0!==window.orientation,UV="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),EI=(UV&&parseFloat(UV[1]),new Map);function zV(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function HV(n,e=!0,t){const i=t||new Set;if(n)if(GV(n))i.add(n);else if(GV(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)HV(n[r],e,i);return void 0===t?Array.from(i):[]}function GV(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const SI=()=>{};class $V{static isSupported(){return"undefined"!=typeof Worker}constructor(e){Kn(this,"name",void 0),Kn(this,"source",void 0),Kn(this,"url",void 0),Kn(this,"terminated",!1),Kn(this,"worker",void 0),Kn(this,"onMessage",void 0),Kn(this,"onError",void 0),Kn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;Vc(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=SI,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=SI,this.onError=SI,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||HV(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){Vc(n.source&&!n.url||!n.source&&n.url);let e=EI.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?zV(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),EI.set(n.url,e)),n.source&&(e=zV(n.source),EI.set(n.source,e))),Vc(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class nle{constructor(e,t){Kn(this,"name",void 0),Kn(this,"workerThread",void 0),Kn(this,"isRunning",void 0),Kn(this,"result",void 0),Kn(this,"_resolve",void 0),Kn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Vc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Vc(this.isRunning),this.isRunning=!1,this._reject(e)}}class ile{constructor(e){Kn(this,"name","unnamed"),Kn(this,"source",void 0),Kn(this,"url",void 0),Kn(this,"maxConcurrency",1),Kn(this,"maxMobileConcurrency",1),Kn(this,"onDebug",()=>{}),Kn(this,"reuseWorkers",!0),Kn(this,"props",{}),Kn(this,"jobQueue",[]),Kn(this,"idleQueue",[]),Kn(this,"count",0),Kn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=ht(ht({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return ii(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return ii(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new nle(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new $V({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Zae?this.maxMobileConcurrency:this.maxConcurrency}}const rle={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Bu{static isSupported(){return $V.isSupported()}static getWorkerFarm(e={}){return Bu._workerFarm=Bu._workerFarm||new Bu({}),Bu._workerFarm.setProps(e),Bu._workerFarm}constructor(e){Kn(this,"props",void 0),Kn(this,"workerPools",new Map),this.props=ht({},rle),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=ht(ht({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new ile({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function ole(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return Vc(r),r}function ale(n,e){return!!Bu.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function lle(n,e,t,i,r){return xI.apply(this,arguments)}function xI(){return(xI=ii(function*(n,e,t,i,r){const s=n.id,o=ole(n,t),l=Bu.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",cle.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function cle(n,e,t,i){return CI.apply(this,arguments)}function CI(){return(CI=ii(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}Kn(Bu,"_workerFarm",void 0);var qV=tt(521);function KV(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return qV.toArrayBuffer?qV.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function fle(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function YV(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function ple(n){return TI.apply(this,arguments)}function TI(){return(TI=ii(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=oI(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return fle(...e)})).apply(this,arguments)}const _le=262144;function XV(n){this.wrapped=n}function m0(n){return new XV(n)}function _0(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,d=c instanceof XV;Promise.resolve(d?c.wrapped:c).then(function(f){d?r("return"===o?"return":"next",f):s(l.done?"return":"normal",f)},function(f){r("throw",f)})}catch(f){s("throw",f)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var d={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=d:(e=t=d,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function DI(n){return function(){return new _0(n.apply(this,arguments))}}function II(){return(II=DI(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield m0(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function QV(n,e){return Oae?function(n,e){return OI.apply(this,arguments)}(n,e):function(n,e){return RI.apply(this,arguments)}(n,e)}function OI(){return(OI=DI(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield m0(r);if(s)return;yield KV(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function RI(){return(RI=DI(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=oI(n);t=(o=yield m0(s.next())).done,a=yield m0(o.value),!t;t=!0)yield KV(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield m0(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function Sle(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=_le}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(Pg(n))return function(n,e){return II.apply(this,arguments)}(n,e);if(IV(n))return QV(n,e);if(g0(n))return QV(n.body,e);throw new Error("makeIterator")}_0.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},_0.prototype.next=function(n){return this._invoke("next",n)},_0.prototype.throw=function(n){return this._invoke("throw",n)},_0.prototype.return=function(n){return this._invoke("return",n)};const NI="Cannot convert supplied data type";function xle(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(NI)}function Cle(n,e,t){return PI.apply(this,arguments)}function PI(){return(PI=ii(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return xle(n,e);if(Pg(n)&&(n=yield NV(n)),g0(n)){const r=n;return yield Bae(r),e.binary?yield r.arrayBuffer():yield r.text()}if(IV(n)&&(n=Sle(n,t)),xae(n)||Cae(n))return ple(n);throw new Error(NI)})).apply(this,arguments)}function Tle(n,e,t=null){if(t)return t;const i=ht({fetch:kV(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function Mle(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const ZV=()=>{const n=yI();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function JV(n){const e=ZV();n=Array.isArray(n)?n:[n];for(const t of n){const i=lI(t);e.find(r=>i===r)||e.unshift(i)}}const Ile=/\.([^.]+)$/;function Ole(n){return kI.apply(this,arguments)}function kI(){return(kI=ii(function*(n,e=[],t,i){if(!tU(n))return null;let r=eU(n,e,Hn(ht({},t),{nothrow:!0}),i);if(r)return r;if(Pg(n)&&(r=eU(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(nU(n));return r})).apply(this,arguments)}function eU(n,e=[],t,i){if(!tU(n))return null;if(e&&!Array.isArray(e))return lI(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...ZV()),function(n){for(const e of n)lI(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=rS(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=BI(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&Ile.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||BI(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(kle(e,t))return t}else if(ArrayBuffer.isView(e)){if(iU(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&iU(e,0,t))return t;return null}(e,n),a=a||BI(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(nU(n));return s}function tU(n){return!(n instanceof Response&&204===n.status)}function nU(n){const{url:e,type:t}=rS(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?jI(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?jI(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function BI(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function kle(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function iU(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===jI(n,e,i.length);default:return!1}}(n,e,t,r))}function jI(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function sS(n,e,t,i){return VI.apply(this,arguments)}function VI(){return(VI=ii(function*(n,e,t,i){Vc(!i||"object"==typeof i),e&&!Array.isArray(e)&&!aI(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=rS(n),o=Mle(e,i),a=yield Ole(n,o,t);return a?(i=Tle({url:r,parse:sS,loaders:o},t=$ae(t,a,o,r),i),yield Vle(a,n,t,i)):null})).apply(this,arguments)}function Vle(n,e,t,i){return UI.apply(this,arguments)}function UI(){return(UI=ii(function*(n,e,t,i){if(Xae(n),e=yield Cle(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(ale(n,t))return yield lle(n,e,t,i,sS);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw Vc(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function oS(n,e,t,i){return zI.apply(this,arguments)}function zI(){return(zI=ii(function*(n,e,t,i){!Array.isArray(e)&&!aI(e)&&(t=e,e=void 0);const r=kV(t);let s=n;return"string"==typeof n&&(s=yield r(n)),Pg(n)&&(s=yield r(n)),yield sS(s,e,t)})).apply(this,arguments)}const rU=yr(2,24)-1,Wle=Object.freeze([]),qle=qE(({oldViewport:n,viewport:e})=>n.equals(e));let zc=new Uint8ClampedArray(0);const Kle={data:{type:"data",value:Wle,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=Hn(ht({},r),{fetch:Hn(ht({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:oS(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):oS(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Pi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let HI=(()=>{class n extends Eae{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=EV(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=eI(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=ht({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Pi.DEFAULT&&(t=i.isGeospatial?Pi.LNGLAT:Pi.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:d}=iV(t,i,r),f=EV(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:d});d&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(f,f,t.projectPosition(l||c));return f}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Pi.DEFAULT||t===Pi.LNGLAT||t===Pi.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){nc(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=roe(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const d of c)o.invalidateAll(d);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:d}=o.attributes,f=c||d;f&&(l&&f.constant&&(f.constant=!1,o.invalidate(f.id)),!f.value&&!l&&(f.constant=!0,f.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!qle({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(zc.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>rU&&Bi.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),zc=Qy.allocate(zc,i,{size:3,copy:!0,maxCount:Math.max(i,rU)});const s=Math.floor(zc.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),zc[3*a+0]=o[0],zc[3*a+1]=o[1],zc[3*a+2]=o[2]}t.value=zc.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==zc.buffer&&(r.value=zc.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){wo("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();wo("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){wo("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];Ru(this.context.gl,{polygonOffset:l}),tc(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const d of this.props.extensions)d.draw.call(this,c,d);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&wo("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=Yj({newProps:n,oldProps:e,propTypes:YD(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&Xj(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&Xj(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Qse(n,e),transitionsChanged:Kse(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=YD(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new jse(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){nc(!this.internalState&&!this.state),nc(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Sae({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Bi.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new Gse(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){wo("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=Kle,n})(),Xle=(()=>{class n extends HI{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:d,coordinateSystem:f,coordinateOrigin:p,wrapLongitude:g,positionFormat:_,modelMatrix:C,extensions:T,fetch:W,_subLayerProps:H}=this.props,me={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:d,coordinateSystem:f,coordinateOrigin:p,wrapLongitude:g,positionFormat:_,modelMatrix:C,extensions:T,fetch:W},Re=H&&H[t.id],ze=Re&&Re.updateTriggers,Ge=t.id||"sublayer";if(Re){const at=this.constructor._propTypes,St=t.type?t.type._propTypes:{};for(const Ot in Re){const Pt=St[Ot]||at[Ot];Pt&&"accessor"===Pt.type&&(Re[Ot]=this.getSubLayerAccessor(Re[Ot]))}}Object.assign(me,t,Re),me.id="".concat(this.props.id,"-").concat(Ge),me.updateTriggers=ht(ht({all:this.props.updateTriggers.all},t.updateTriggers),ze);for(const at of T){const St=at.getSubLayerProps.call(this,at);St&&Object.assign(me,St,{updateTriggers:Object.assign(me.updateTriggers,St.updateTriggers)})}return me}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=TD(t,Boolean),this.internalState.subLayers=t),wo("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const Qle=/([0-9]+\.?[0-9]*)(%|px)/;function aS(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match(Qle);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function lS(n,e){return n.relative?Math.round(n.position*e):n.position}function y0(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&y0(i,r)))return!1}return!0}class GI{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:d=1e3,modelMatrix:f=null,viewportInstance:p=null,type:g=Ng}=e;nc(!p||p instanceof Ng),this.viewportInstance=p,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=Hn(ht({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:d,modelMatrix:f}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):y0(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=ht({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:lS(this._x,e),y:lS(this._y,t),width:lS(this._width,e),height:lS(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),ht(ht({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(ht(ht(ht({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=aS(e),this._y=aS(t),this._width=aS(i),this._height=aS(r)}}const b0=()=>{},sU={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:b0,onTransitionInterrupt:b0,onTransitionEnd:b0};class Zle{constructor(e,t={}){this.ControllerState=e,this.props=ht(ht({},sU),t),this.propsInTransition=null,this.transition=new l0(t.timeline),this.onViewStateChange=t.onViewStateChange||b0,this.onStateChange=t.onStateChange||b0,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=ht(ht({},sU),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=ht(ht({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(ht(ht({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const oU=["longitude","latitude","zoom","bearing","pitch"],ece=["longitude","latitude","zoom"];class aU extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!Zy(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];nc(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:oU,extract:oU,required:ece}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=OE(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(ht(ht({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,OE(e.around,t.around,i)))}return r}}const Qd={transitionDuration:0},tce={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},uS=n=>1-(1-n)*(1-n),Fg_WHEEL=["wheel"],Fg_PAN=["panstart","panmove","panend"],Fg_PINCH=["pinchstart","pinchmove","pinchend"],Fg_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],Fg_DOUBLE_TAP=["doubletap"],Fg_KEYBOARD=["keydown"];class $I{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new Zle(e,Hn(ht({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&Hn(ht({},tce),{transitionInterpolator:new aU({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(ht(ht({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,d=Boolean(this.onViewStateChange);this.toggleEvents(Fg_WHEEL,d&&i),this.toggleEvents(Fg_PAN,d&&(r||s)),this.toggleEvents(Fg_PINCH,d&&(a||l)),this.toggleEvents(Fg_TRIPLE_PAN,d&&l),this.toggleEvents(Fg_DOUBLE_TAP,d&&o),this.toggleEvents(Fg_KEYBOARD,d&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=ht(ht({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,Qd,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,Qd,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,Hn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:uS}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Qd,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,Hn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:uS}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,Hn(ht({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,Qd,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Qd,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,Hn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:uS}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,Qd,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,Qd,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,Hn(ht({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:uS}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?Hn(ht({},t),{transitionInterpolator:new aU(Hn(ht({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:Qd}}class lU{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const Zd_target=[0,0,0];class dS extends lU{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=Zd_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:d=-(1/0),maxZoom:f=Infinity,startPanPosition:p,startRotatePos:g,startRotationX:_,startRotationOrbit:C,startZoomPosition:T,startZoom:W}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:d,maxZoom:f}),this._state={startPanPosition:p,startRotatePos:g,startRotationX:_,startRotationOrbit:C,startZoomPosition:T,startZoom:W},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let d=(e[0]-r[0])/a;(s<-90||s>90)&&(d*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*d}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=ht({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(Hn(ht({},this._viewportProps),{zoom:a}));return this._getUpdatedState(ht({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),pf(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new dS(ht(ht(ht({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=pf(r,i,t),e.rotationX=pf(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class ice extends $I{constructor(e){super(dS,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class rce extends $I{constructor(e){e.dragMode=e.dragMode||"pan",super(dS,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const sce=(new qn).lookAt({eye:[0,0,1]});function oce({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new qn).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class ace extends Ng{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(Hn(ht({},e),{longitude:null,position:a,viewMatrix:sce.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:oce({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=Dg([],e,XD([],mf(t,this.pixelUnprojectionMatrix)));return{target:Dg([],this.center,r)}}}let lce=(()=>{class n extends GI{constructor(t){super(Hn(ht({},t),{type:ace}))}get controller(){return this._getControllerProps({type:rce})}}return n.displayName="OrthographicView",n})();const hS=Math.PI/180;function cce({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*hS/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new qn).lookAt({eye:l,up:a});c.rotateX(i*hS),"Z"===t?c.rotateZ(r*hS):c.rotateY(r*hS);const d=Math.pow(2,s)/(n||1);return c.scale(d),c}class uce extends Ng{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(Hn(ht({},e),{longitude:null,viewMatrix:cce({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=mf([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let dce=(()=>{class n extends GI{constructor(t={}){const{orbitAxis:i="Z"}=t;super(Hn(ht({},t),{orbitAxis:i,type:uce}))}get controller(){return this._getControllerProps({type:ice})}}return n.displayName="OrbitView",n})();const hce=[255,255,255],fce=1;let pce=0;class cU{constructor(e={}){const{color:t=hce}=e,{intensity:i=fce}=e;this.id=e.id||"ambient-".concat(pce++),this.color=t,this.intensity=i,this.type="ambient"}}const gce=[255,255,255],mce=1,_ce=[0,0,-1];let yce=0;class uU{constructor(e={}){const{color:t=gce}=e,{intensity:i=mce}=e,{direction:r=_ce}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(yce++),this.color=t,this.intensity=i,this.type="directional",this.direction=new vo(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class dU{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=ht({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class WI extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=ht({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return Ru(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){Ru(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,d=i&&i[c.id];r(c);const f=this._getDrawLayerParams(c,e);e.view=d;const p=c.subViewports||[c];for(const g of p){e.viewport=g;const _=this._drawLayersInViewport(o,e,f);a.push(_)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=hU(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let d=0;d<t.length;d++){const f=t[d],p=this._shouldDrawLayer(f,c,r),_={shouldDrawLayer:p,layerRenderIndex:l(f,p)};p&&(_.moduleParameters=this._getModuleParameters(f,s,i,o),_.layerParameters=this.getLayerParameters(f,d)),a[d]=_}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=yg(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;tc(e,{scissorTest:!0,scissor:a},()=>yD(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Ru(e,{viewport:a});for(let c=0;c<t.length;c++){const d=t[c],{shouldDrawLayer:f,layerRenderIndex:p,moduleParameters:g,layerParameters:_}=o[c];if(f&&d.props.pickable&&l.pickableCount++,d.isComposite)l.compositeCount++;else if(f){l.visibleCount++,g.viewport=r;try{d.drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:_})}catch(C){d.raiseError(C,"drawing ".concat(d," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:yg(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function hU(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const d=t[l]=t[l]||hU(e[l],e);c=d(r,s),t[a]=d}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class Ece extends WI{constructor(e,t){super(e,t),this.shadowMap=new Ra(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Eg(e,{format:33189,width:1,height:1}),this.fbo=new Os(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;tc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=yg(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(Hn(ht({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const xce=Object.keys(Pi).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Pi[n],";")).join(""),Cce=Object.keys(Fc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(Fc[n],";")).join(""),Ace="".concat(xce,"\n").concat(Cce,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),Tce={},qI={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:Ace,getUniforms:function(n=Tce){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Pi.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Pi.DEFAULT&&(i=n.isGeospatial?Pi.LNGLAT:Pi.CARTESIAN);const o=Poe({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||Ooe,o}(n):{}}},Oce=qE(function({viewport:n,center:e}){return new qn(n.viewProjectionMatrix).invert().transform(e)}),Rce=qE(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=mf([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new vo(n.center).negate()),l=s.map(d=>a.transform(d)),c=(new qn).ortho({left:Math.min(...l.map(d=>d[0])),right:Math.max(...l.map(d=>d[0])),bottom:Math.min(...l.map(d=>d[1])),top:Math.max(...l.map(d=>d[1])),near:Math.min(...l.map(d=>-d[2])),far:Math.max(...l.map(d=>-d[2]))});t.push(c.multiplyRight(o))}return t}),Nce=[0,0,0,1],Pce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],KI={name:"shadow",dependencies:[qI],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Nce,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=Oce({viewport:n.viewport,center:e.project_uCenter}),r=[],s=Rce({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new vo(n.viewport.center).negate());e.project_uCoordinateSystem===Pi.LNGLAT&&e.project_uProjectionMode===Fc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(Pce),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},jce={color:[255,255,255],intensity:1},fU=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Vce=[0,0,0,200/255];class YI extends dU{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=Vce,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=o0.getDefaultProgramManager(e),KI&&this.programManager.addDefaultModule(KI)),this.dummyShadowMap||(this.dummyShadowMap=new Ra(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(KI),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new qn).lookAt({eye:new vo(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new Ece(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new cU(jce),this.directionalLights.push(new uU(fU[0]),new uU(fU[1])))}}let Uce=1,zce=1;class pU{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=Uce++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=zce++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class Hce{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=oS(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class Gce{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new Hce(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const $ce=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},qI],Wce=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function qce(n){const e=o0.getDefaultProgramManager(n);for(const t of $ce)e.addDefaultModule(t);for(const t of Wce)e.addShaderHook(t);return e}const Xce=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class Qce{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new Gce({gl:e,protocol:"deck://"}),this.context=Hn(ht({},Xce),{layerManager:this,gl:e,deck:t,programManager:e&&qce(e),stats:i||new dD({id:"deck.gl"}),viewport:r||new Ng({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new pU,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){wo("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=TD(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return wo("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?Bi.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&Bi.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class Zce{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=TD(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!y0(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Bi.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(ht({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=Hn(ht(ht(ht({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let d=r[a.id];a.controller&&!d&&(s=!0),(s||!a.controller)&&d&&(d.finalize(),d=null),this.controllers[a.id]=this._updateController(a,l,c,d),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class eue extends lU{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:d=20,minZoom:f=0,maxPitch:p=60,minPitch:g=0,startPanLngLat:_,startZoomLngLat:C,startRotatePos:T,startBearing:W,startPitch:H,startZoom:me,normalize:Re}={}){nc(Number.isFinite(s)),nc(Number.isFinite(r)),nc(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:d,minZoom:f,maxPitch:p,minPitch:g,normalize:Re}),this._state={startPanLngLat:_,startZoomLngLat:C,startRotatePos:T,startBearing:W,startPitch:H,startZoom:me},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(Hn(ht({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(Hn(ht({},this._viewportProps),{zoom:o}));return this._getUpdatedState(ht({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=ht({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(ht(ht(ht({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=pf(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=pf(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=oV(t+180,360)-180),(o<-180||o>180)&&(o=oV(o+180,360)-180);const a=QD(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=Yd([0,l])[1];if(i<c)i=c;else{const d=Yd([0,512-l])[1];i>d&&(i=d)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return pf(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=pf(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let d=0;return r>0?Math.abs(l-o)>5&&(d=r/(o-l)*1.2):r<0&&o>5&&(d=1-s/o),d=Math.min(1,Math.max(-1,d)),{deltaScaleX:c,deltaScaleY:d}}}class tue extends $I{constructor(e){e.dragMode=e.dragMode||"pan",super(eue,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(ht(ht({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let nue=(()=>{class n extends GI{constructor(t){super(Hn(ht({},t),{type:wV}))}get controller(){return this._getControllerProps({type:tue})}}return n.displayName="MapView",n})();const iue=new YI;class rue{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!y0(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof YI)||this._internalEffects.push(iue)}}class sue extends WI{}const mU={blendFunc:[1,0,32771,0],blendEquation:32774};class _U extends WI{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:d},pass:f="picking",redrawReason:p,pickZ:g}){const _=this.gl;return this.pickZ=g,tc(_,Hn(ht({scissorTest:!0,scissor:[a,l,c,d],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},mU),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:f,redrawReason:p})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:Hn(ht({},mU),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return ht(ht({},e.props.parameters),i)}}class aue{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new sue(e),this.pickLayersPass=new _U(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||Os.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(Hn(ht({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,wo("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Os(this.gl),new Os(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const lue={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function cue({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let d=r*r,f=-1,p=0;for(let g=0;g<c;g++){const _=g+a-i,C=_*_;if(C>d)p+=4*l;else for(let T=0;T<l;T++){if(n[p+3]-1>=0){const H=T+o-t,me=H*H+C;me<=d&&(d=me,f=p)}p+=4}}if(f>=0){const g=n[f+3]-1,_=n.slice(f,f+4),C=e[g];if(C){const T=C.decodePickingColor(_),W=Math.floor(f/4/l);return{pickedColor:_,pickedLayer:C,pickedObjectIndex:T,pickedX:o+(f/4-W*l),pickedY:a+W}}Bi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return lue}function yU({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,d=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(p=>i({layer:l,viewport:p,isPicking:!0,renderPass:"picking:".concat(e)}))),f=d&&d.unproject([s-d.x,o-d.y],{targetZ:a});return{color:null,layer:null,viewport:d,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:f,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function due(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const f=t.index,p=t.layerId,g=o&&o.props.id;if(g!==p||a!==f){if(g!==p){const _=r.find(C=>C.props.id===p);_&&l.unshift(_)}t.layerId=g,t.index=a,t.info=null}}const c=yU(n),d=new Map;return d.set(null,c),l.forEach(f=>{let p=ht({},c);f===o&&(p.color=s,p.index=a,p.picked=!0),p=bU({layer:f,info:p,mode:i}),f===o&&"hover"===i&&(t.info=p),d.set(p.layer.id,p),"hover"===i&&p.layer.updateAutoHighlight(p)}),d}function bU({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class fue{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new _U(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(p=>p.id===o):null,c=a&&r.find(p=>p.id===a)||r[0],d=c&&c.unproject([e-c.x,t-c.y]),f={x:e,y:t,viewport:c,coordinate:d,layer:l};return l?ht(ht({},s),f):Object.assign(f,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Os(e),Os.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Os(e),this.depthFBO.attach({36064:new Ra(e,{format:yi(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(Bi.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:d}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:yU({viewports:i,x:r,y:s})};this._resizeBuffer();const f=yg(this.gl),p=lD(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],_=Math.round(o*f),{width:C,height:T}=this.pickingFBO,W=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceWidth:C,deviceHeight:T});let H;const me=[],Re={};for(let ze=0;ze<a;ze++){const at=cue({pickedColors:W&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:d,deviceRect:W,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceRect:W});let St;if(at.pickedLayer&&c&&this.depthFBO&&(St=this._drawAndSample({layers:[at.pickedLayer],views:t,viewports:i,onViewportActive:d,deviceRect:{x:at.pickedX,y:at.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),at.pickedColor&&ze+1<a){const Ot=at.pickedColor[3]-1;Re[Ot]=!0,e[Ot].disablePickingIndex(at.pickedObjectIndex)}H=due({pickInfo:at,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:St,pixelRatio:f});for(const Ot of H.values())Ot.layer&&me.push(Ot);if(!at.pickedColor)break}for(const ze in Re)e[ze].restorePickingColors();return{result:me,emptyInfo:H&&H.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:d}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const f=yg(this.gl),p=lD(this.gl,[r,s],!0),g=p.x,_=p.y+p.height,C=lD(this.gl,[r+o,s+a],!0),W=C.y,Re=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):Bi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:d,deviceRect:{x:g,y:W,width:C.x+C.width-g,height:_-W},pass:"picking:".concat(l),redrawReason:l}),layers:e}),ze=new Map,Ge=Number.isFinite(c);for(let at=0;at<Re.length&&!(Ge&&ze.size>=c);at++){const St=Re[at];let Ot={color:St.pickedColor,layer:null,index:St.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:f};Ot=bU({layer:St.pickedLayer,info:Ot,mode:l}),ze.has(Ot.object)||ze.set(Ot.object,Ot)}return Array.from(ze.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:d,y:f,width:p,height:g}=s,_=new(l?Float32Array:Uint8Array)(p*g*4);return IE(c,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:_}),_}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const pue={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class gue{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,pue),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function vU(n,e){if(!n)throw new Error(e)}const Hc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},wU=Hc.global||Hc.self||Hc.window,_ue="object"!=typeof process||"[object process]"!==String(process)||process.browser,EU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:yue}=(EU&&parseFloat(EU[1]),wU),XI="undefined"!=typeof Image,QI="undefined"!=typeof ImageBitmap,bue=Boolean(yue),ZI=!!_ue||bue;function SU(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function xU(n){switch(SU(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const Eue=/^data:image\/svg\+xml/,Sue=/\.svg((\?|#).*)?$/;function JI(n){return n&&(Eue.test(n)||Sue.test(n))}function xue(n,e){if(JI(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return AU(n,e)}function AU(n,e){if(JI(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function TU(n,e,t){return eO.apply(this,arguments)}function eO(){return(eO=ii(function*(n,e,t){const i=xue(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield Cue(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function Cue(n,e){return tO.apply(this,arguments)}function tO(){return(tO=ii(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const Aue={};let MU=!0;function Tue(n,e,t){return nO.apply(this,arguments)}function nO(){return(nO=ii(function*(n,e,t){let i;i=JI(t)?yield TU(n,e,t):AU(n,t);const r=e&&e.imagebitmap;return yield Mue(i,r)})).apply(this,arguments)}function Mue(n){return iO.apply(this,arguments)}function iO(){return(iO=ii(function*(n,e=null){if((Due(e)||!MU)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),MU=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function Due(n){for(const e in n||Aue)return!1;return!0}const Gc=!1,v0=!0;function rO(n){const e=w0(n);return function(n){const e=w0(n);return e.byteLength>=24&&2303741511===e.getUint32(0,Gc)?{mimeType:"image/png",width:e.getUint32(16,Gc),height:e.getUint32(20,Gc)}:null}(e)||function(n){const e=w0(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,Gc)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Gc);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Gc),width:e.getUint16(s+7,Gc)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,Gc)}return null}(e)||function(n){const e=w0(n);return e.byteLength>=10&&1195984440===e.getUint32(0,Gc)?{mimeType:"image/gif",width:e.getUint16(6,v0),height:e.getUint16(8,v0)}:null}(e)||function(n){const e=w0(n);return e.byteLength>=14&&16973===e.getUint16(0,Gc)&&e.getUint32(2,v0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,v0),height:e.getUint32(22,v0)}:null}(e)}function w0(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function Fue(n,e){const{mimeType:t}=rO(n)||{},{_parseImageNode:i}=wU;return vU(i),i(n,t,e)}function sO(){return(sO=ii(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(kue(r)){case"imagebitmap":a=yield Tue(n,e,s);break;case"image":a=yield TU(n,e,s);break;case"data":a=yield Fue(n,e);break;default:vU(!1)}return"data"===r&&(a=xU(a)),a})).apply(this,arguments)}function kue(n){switch(n){case"auto":case"data":return function(){if(QI)return"imagebitmap";if(XI)return"image";if(ZI)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return QI||XI||ZI;case"imagebitmap":return QI;case"image":return XI;case"data":return ZI;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const DU={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return sO.apply(this,arguments)},tests:[n=>Boolean(rO(new DataView(n)))],options:{image:{type:"auto",decode:!0}}},jue={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},E0="8.5.8",fS=Cr.CO.deck&&Cr.CO.deck.VERSION;if(fS&&fS!==E0)throw new Error("deck.gl - multiple versions detected: ".concat(fS," vs ").concat(E0));fS||(Bi.log(1,"deck.gl ".concat(E0))(),Cr.CO.deck=Object.assign(Cr.CO.deck||{},{VERSION:E0,version:E0,log:Bi,_registerLoggers:function(n){OD=n}}),JV([jue,[DU,{imagebitmap:{premultiplyAlpha:"none"}}]]));const Vue=Cr.CO.deck;class pS extends Nu{static isSupported(e,t=[]){const i=yi(e),r=zB(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:rn(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return pS.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const IU=(0,Cr.jU)()&&"undefined"!=typeof document;let Xue=0;class Que{constructor(e={}){const{onCreateContext:t=(T=>SB(T)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:d=!1,createFramebuffer:f=!1,autoResizeViewport:p=!0,autoResizeDrawingBuffer:g=!0,stats:_=hf.get("animation-loop-"+Xue++)}=e;let{useDevicePixels:C=!0}=e;"useDevicePixelRatio"in e&&(hn.deprecated("useDevicePixelRatio","useDevicePixels")(),C=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:d,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=_,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:p,autoResizeDrawingBuffer:g,useDevicePixels:C}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return rn("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=pS.isSupported(this.gl,["timers"])?new pS(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return ii(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return hn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=IU?new Promise((e,t)=>{IU&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?uD(this.props.gl,e):this.onCreateContext(e),!ME(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){Ru(n,aD)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(hn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(hn.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Os(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Zue=tt(524),gS=tt.n(Zue);const Jue={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})(gS().PointerEventInput),function(n){n.prototype.handler=function(t){let i=Jue[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(gS().MouseInput);const ide=gS().Manager,$c=gS(),rde=$c?[[$c.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[$c.Rotate,{enable:!1}],[$c.Pinch,{enable:!1}],[$c.Swipe,{enable:!1}],[$c.Pan,{threshold:0,enable:!1}],[$c.Press,{enable:!1}],[$c.Tap,{event:"doubletap",taps:2,enable:!1}],[$c.Tap,{event:"anytap",enable:!1}],[$c.Tap,{enable:!1}]]:null,NU={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},sde={doubletap:["tap"]},ode={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},aO={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},ade={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},PU={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},lde="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Lg="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let FU=!1;try{const n={get passive(){return FU=!0,!0}};Lg.addEventListener("test",n,n),Lg.removeEventListener("test",n,n)}catch(n){}const cde=-1!==lde.indexOf("firefox"),{WHEEL_EVENTS:ude}=aO,kU=4.000244140625;class fde{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=ude.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!FU&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;Lg.WheelEvent&&(cde&&e.deltaMode===Lg.WheelEvent.DOM_DELTA_PIXEL&&(t/=Lg.devicePixelRatio),e.deltaMode===Lg.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%kU==0&&(t=Math.floor(t/kU)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:pde}=aO,BU="pointermove",jU="pointerover",VU="pointerout",UU="pointerleave";class gde{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=pde.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===BU&&(this.enableMoveEvent=t),e===jU&&(this.enableOverEvent=t),e===VU&&(this.enableOutEvent=t),e===UU&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:jU,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:VU,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:UU,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:BU,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:mde}=aO,zU="keydown";class _de{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=mde.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===zU&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:zU,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const GU="contextmenu";class yde{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===GU&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:GU,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const bde={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},$U={srcElement:"root",priority:0};class Ode{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},$U,i):$U;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let d=l.length-1;for(;d>=0&&!(l[d].priority>=c.priority);)d--;l.splice(d+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:d,once:f}=i[l];if(d(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),f&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:d}=a[l];this.remove(c,d)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=bde[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const Rde={events:null,recognizers:null,recognizerOptions:{},Manager:ide,touchAction:"none",tabIndex:0};class Nde{constructor(e=null,t={}){this.options=Object.assign({},Rde,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||rde}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(NU).forEach(r=>{const s=this.manager.get(r);s&&NU[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new fde(e,this._onOtherEvent,{enable:!1}),this.moveInput=new gde(e,this._onOtherEvent,{enable:!1}),this.keyInput=new _de(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new yde(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=sde[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const d in e)this._addEventHandler(d,e[d],i,r,s);return}const{manager:o,events:a}=this,l=PU[e]||e;let c=a.get(l);c||(c=new Ode(this),a.set(l,c),c.recognizerName=ade[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(PU[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=ode[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function bf(){}const WU={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:bf,onResize:bf,onViewStateChange:bf,onInteractionStateChange:bf,onBeforeRender:bf,onAfterRender:bf,onLoad:bf,onError:(n,e)=>Bi.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class _S{constructor(e){e=ht(ht({},WU),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&Bi.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Cr.qs)()&&Bi.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new dD({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Qy.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Bi.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Bi.removed("onLayerClick","onClick")(),e.initialViewState&&!y0(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](ht({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),nc(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:d,autoResizeDrawingBuffer:f}=e;return new Que({width:t,height:i,useDevicePixels:d,autoResizeDrawingBuffer:f,autoResizeViewport:!1,gl:r,onCreateContext:p=>SB(Hn(ht(ht({},s),p),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:p=>this._setGLContext(p.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new nue({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,uD(e,{enable:!0,copyState:!0})),this.tooltip=new gue(this.canvas),Ru(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new pU;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Nde(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in aB)this.eventManager.on(r,this._onEvent);this.viewManager=new Zce({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new Qce(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new rue,this.deckRenderer=new aue(e),this.deckPicker=new fue(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;Ru(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(ht({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Bi.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=Hn(ht({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=aB[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=hf.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}_S.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(dU)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},_S.defaultProps=WU,_S.VERSION=Vue.VERSION;const qU={name:"project32",dependencies:[qI],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},KU="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Lde={lightSources:{}};function uO({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const dO={name:"lights",vs:KU,fs:KU,getUniforms:function YU(n=Lde){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?uO(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=uO(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=uO(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return YU({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Bde={};const Vde={name:"phong-lighting",dependencies:[dO],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=Bde){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},zde={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},ZU=ht({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=zde){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),JU={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class yS{static get DRAW_MODE(){return JU}constructor(e={}){const{id:t=kc("geometry"),drawMode:i=JU.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?ht({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,rn(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(rn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return rn(Number.isFinite(i)),i}}const hO=Math.PI/180,bS=new Float32Array(16),ez=new Float32Array(12);function tz(n,e,t){const i=e[0]*hO,r=e[1]*hO,s=e[2]*hO,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),d=Math.cos(i),f=Math.cos(r),p=t[0],g=t[1],_=t[2];n[0]=p*f*d,n[1]=p*l*d,n[2]=p*-a,n[3]=g*(-l*c+f*a*o),n[4]=g*(f*c+l*a*o),n[5]=g*d*o,n[6]=_*(l*o+f*a*c),n[7]=_*(-f*o+l*a*c),n[8]=_*d*c}function nz(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const iz={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,d=Array.isArray(s),f=Array.isArray(r),p=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:f&&d&&p;const _=n.value;if(n.constant){let C;g?(bS.set(a),C=nz(bS)):(C=ez,tz(C,r,s),C.set(o,9)),n.value=new Float32Array(C)}else{let C=e*n.size;const{iterable:T,objectInfo:W}=nj(i,e,t);for(const H of T){let me;W.index++,g?(bS.set(c?a:a(H,W)),me=nz(bS)):(me=ez,tz(me,f?r:r(H,W),d?s:s(H,W)),me.set(p?o:o(H,W),9)),_[C++]=me[0],_[C++]=me[1],_[C++]=me[2],_[C++]=me[3],_[C++]=me[4],_[C++]=me[5],_[C++]=me[6],_[C++]=me[7],_[C++]=me[8],_[C++]=me[9],_[C++]=me[10],_[C++]=me[11]}}}};function rz(n,e){return e===Pi.CARTESIAN||e===Pi.METER_OFFSETS||e===Pi.DEFAULT&&!n.isGeospatial}function sz(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),Bi.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Wde(n,e){if(n.attributes)return sz(n.attributes,e),n instanceof yS?n:new yS(n);if(n.positions||n.POSITION)return sz(n,e),new yS({attributes:n});throw Error("Invalid mesh")}const qde={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let Kde=(()=>{class n extends HI{getShaders(){const t=!yi(this.context.gl),i={};return wD(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[qU,Vde,ZU],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:iz}),this.setState({emptyTexture:new Ra(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||rz(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new GE(this.context.gl,Hn(ht({},this.getShaders()),{id:this.props.id,geometry:Wde(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=qde,n})();const oz={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[dO]};class kg{constructor(e={}){const{id:t}=e;this.id=t||kc(this.constructor.name),this.display=!0,this.position=new vo,this.rotation=new vo,this.scale=new vo(1,1,1),this.matrix=new qn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return rn(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return rn(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return rn(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){rn(e),t=t||this.matrix;const i=new qn(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class S0 extends kg{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;hn.assert(t.every(i=>i instanceof kg),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new qn}={}){const i=new qn(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof S0?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function az(){var n=new aa(4);return aa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function lz(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function cz(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],d=t[3];return n[0]=i*d+o*a+r*c-s*l,n[1]=r*d+o*l+s*a-i*c,n[2]=s*d+o*c+i*l-r*a,n[3]=o*d-i*a-r*l-s*c,n}var dz=tV,che=function(){var n=WB(),e=qB(1,0,0),t=qB(0,1,0);return function(i,r,s){var o=KB(r,s);return o<-.999999?(NE(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&NE(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),lz(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(NE(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();az(),az(),function(){var n=new aa(9);aa!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const uhe=[0,0,0,1],hhe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},fhe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function pz(n){if(!n._animation){const e=fhe[n.componentType],t=hhe[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const phe=new qn,fO=new class extends SD{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return function(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}}(this,e),this.check()}identity(){return function(n){n[0]=0,n[1]=0,n[2]=0,n[3]=1}(this),this.check()}fromAxisRotation(e,t){return lz(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=to(e)}get y(){return this[1]}set y(e){this[1]=to(e)}get z(){return this[2]}set z(e){this[2]=to(e)}get w(){return this[3]}set w(e){this[3]=to(e)}len(){return function(n){return Math.hypot(n[0],n[1],n[2],n[3])}(this)}lengthSquared(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r}(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}(this,e)}rotationTo(e,t){return che(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return function(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3]}(this,this,e),this.check()}calculateW(){return function(n,e){var t=e[0],i=e[1],r=e[2];n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r))}(this,this),this.check()}conjugate(){return function(n,e){n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3]}(this,this),this.check()}invert(){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a}(this,this),this.check()}lerp(e,t,i){return function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a)}(this,e,t,i),this.check()}multiplyRight(e,t){return Fu(!t),cz(this,this,e),this.check()}multiplyLeft(e,t){return Fu(!t),cz(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a}(this,this,e),this.check()}rotateY(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a}(this,this,e),this.check()}rotateZ(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a}(this,this,e),this.check()}scale(e){return dz(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=uhe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return function(n,e,t,i){var p,g,_,C,T,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],d=t[2],f=t[3];(g=r*l+s*c+o*d+a*f)<0&&(g=-g,l=-l,c=-c,d=-d,f=-f),1-g>mr?(p=Math.acos(g),_=Math.sin(p),C=Math.sin((1-i)*p)/_,T=Math.sin(i*p)/_):(C=1-i,T=i),n[0]=C*r+T*l,n[1]=C*s+T*c,n[2]=C*o+T*d,n[3]=C*a+T*f}(this,e,t,i),this.check()}transformVector4(e,t=e){return function(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],d=c*i+a*s-l*r,f=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;n[0]=d*c+g*-o+f*-l-p*-a,n[1]=f*c+g*-a+p*-o-d*-l,n[2]=p*c+g*-l+d*-a-f*-o,n[3]=e[3]}(t,e,this),RE(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}};class vhe{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(p=>p>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:hn.warn(`Bad animation path ${s}`)()}rn(r[s].length===i[c].length);const d=e[c],f=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":f>d&&function(n,e,t,i,r){if("rotation"===e){fO.slerp({start:t,target:i,ratio:r});for(let s=0;s<fO.length;s++)n[e][s]=fO[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-d)/(f-d));break;case"CUBICSPLINE":f>d&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,d=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*d}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:f-d,ratio:(a-d)/(f-d)});break;default:hn.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=phe.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class whe{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:pz(e.accessors[a]),interpolation:l,output:pz(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new vhe({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class Ehe extends kg{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof GE?(this.model=e,this._setModelNodeProps(t)):this.model=new GE(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class She{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},wD(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new Ra(this.gl,ht({id:e.name||e.id,parameters:ht(ht({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(hn.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function gz(n,e){return yi(n)?`#version 300 es\n${e}`:e}const The={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mhe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Dhe{constructor(e,t={}){this.gl=e,this.options=Object.assign({},Mhe,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new whe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new S0({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new S0({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new qn).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new S0({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){hn.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new She(n,e);hn.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(d=>d.buffer));const c=new Ehe(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[oz],defines:a.defines,parameters:a.parameters,vs:gz(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:gz(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),hn.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new or(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new oa({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:The[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function mz(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function La(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function _z(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function yz(n,e,t){const i=n.bufferViews[t];La(i);const s=e[i.buffer];return La(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const bz={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class Bg{constructor(e,t){Kn(this,"fields",void 0),Kn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new Bg(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new Bg(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof Bg){const o=e;t=o.fields,i=vz(vz(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new Bg(s,i)}}function vz(n,e){return new Map([...n||new Map,...e||new Map])}let Or,wz,Ez,Sz,xz,Cz,Az,Tz;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(Or||(Or={}));class pO{static isNull(e){return e&&e.typeId===Or.Null}static isInt(e){return e&&e.typeId===Or.Int}static isFloat(e){return e&&e.typeId===Or.Float}static isBinary(e){return e&&e.typeId===Or.Binary}static isUtf8(e){return e&&e.typeId===Or.Utf8}static isBool(e){return e&&e.typeId===Or.Bool}static isDecimal(e){return e&&e.typeId===Or.Decimal}static isDate(e){return e&&e.typeId===Or.Date}static isTime(e){return e&&e.typeId===Or.Time}static isTimestamp(e){return e&&e.typeId===Or.Timestamp}static isInterval(e){return e&&e.typeId===Or.Interval}static isList(e){return e&&e.typeId===Or.List}static isStruct(e){return e&&e.typeId===Or.Struct}static isUnion(e){return e&&e.typeId===Or.Union}static isFixedSizeBinary(e){return e&&e.typeId===Or.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Or.FixedSizeList}static isMap(e){return e&&e.typeId===Or.Map}static isDictionary(e){return e&&e.typeId===Or.Dictionary}get typeId(){return Or.NONE}compareTo(e){return this===e}}Symbol,Symbol,wz=Symbol.toStringTag;class jg extends pO{constructor(e,t){super(),Kn(this,"isSigned",void 0),Kn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Or.Int}get[wz](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class jhe extends jg{constructor(){super(!0,8)}}class Vhe extends jg{constructor(){super(!0,16)}}class Uhe extends jg{constructor(){super(!0,32)}}class zhe extends jg{constructor(){super(!1,8)}}class Hhe extends jg{constructor(){super(!1,16)}}class Ghe extends jg{constructor(){super(!1,32)}}Ez=Symbol.toStringTag;class Mz extends pO{constructor(e){super(),Kn(this,"precision",void 0),this.precision=e}get typeId(){return Or.Float}get[Ez](){return"Float"}toString(){return`Float${this.precision}`}}class $he extends Mz{constructor(){super(32)}}class Whe extends Mz{constructor(){super(64)}}Symbol,Symbol,Sz=Symbol.toStringTag,xz=Symbol.toStringTag,Cz=Symbol.toStringTag,Az=Symbol.toStringTag,Tz=Symbol.toStringTag;class qhe extends pO{constructor(e,t){super(),Kn(this,"listSize",void 0),Kn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Or.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Tz](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class wS{constructor(e,t,i=!1,r=new Map){Kn(this,"name",void 0),Kn(this,"type",void 0),Kn(this,"nullable",void 0),Kn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new wS(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function Dz(n,e,t){const i=t?Iz(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new jhe;case Uint8Array:return new zhe;case Int16Array:return new Vhe;case Uint16Array:return new Hhe;case Int32Array:return new Uhe;case Uint32Array:return new Ghe;case Float32Array:return new $he;case Float64Array:return new Whe;default:throw new Error("array type not supported")}}(e.value);return new wS(n,new qhe(e.size,new wS("value",r)),!1,i)}function Iz(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const Oz={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Qhe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class Jhe{constructor(e){Kn(this,"draco",void 0),Kn(this,"decoder",void 0),Kn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const p=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(p)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const d=a[c],f=a[c+1],p=a[c+2];e=d<e?d:e,t=f<t?f:t,i=p<i?p:i,r=d>r?d:r,s=f>s?f:s,o=p>o?p:o}return[[e,t,i],[r,s,o]]}(l.attributes),d=function(n,e,t){const i=Iz(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=Dz(o,n[o],s[o]);r.push(l)}if(t){const o=Dz("indices",t);r.push(o)}return new Bg(r,i)}(l.attributes,a,l.indices);return Hn(ht({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:d})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=Qhe[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const d=this.draco._malloc(a);try{const f=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,f,l,a,d),c=new i(this.draco.HEAPF32.buffer,d,o).slice()}finally{this.draco._free(d)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in Oz)if(this.draco[o]===r)return Oz[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var ES=tt(125);const yO={};function bO(n){return vO.apply(this,arguments)}function vO(){return(vO=ii(function*(n,e=null,t={}){return e&&(n=rfe(n,e,t)),yO[n]=yO[n]||sfe(n),yield yO[n]})).apply(this,arguments)}function rfe(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:vI?t.CDN?(Vc(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):wI?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function sfe(n){return wO.apply(this,arguments)}function wO(){return(wO=ii(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():vI?wI?importScripts(n):ofe(yield(yield fetch(n)).text(),n):ES.requireFromFile&&(yield ES.requireFromFile(n))})).apply(this,arguments)}function ofe(n,e){if(!vI)return ES.requireFromString&&ES.requireFromString(n,e);if(wI)return eval.call(Qae,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const afe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",lfe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",cfe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let x0;function dfe(n){return EO.apply(this,arguments)}function EO(){return(EO=ii(function*(n){const e=n.modules||{};return x0=e.draco3d?x0||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):x0||hfe(n),yield x0})).apply(this,arguments)}function hfe(n){return xO.apply(this,arguments)}function xO(){return(xO=ii(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield bO(afe,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield bO(lfe,"draco",n),yield bO(cfe,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield ffe(e,t)})).apply(this,arguments)}function ffe(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(Hn(ht({},t),{onModuleLoaded:r=>i({draco:r})}))})}const AO=Hn(ht({},bz),{parse:function(n,e){return TO.apply(this,arguments)}});function TO(){return(TO=ii(function*(n,e){const{draco:t}=yield dfe(e),i=new Jhe(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function A0(n,e){return _f(n>=0),_f(e>0),n+(e-1)&~(e-1)}function mfe(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+A0(i.byteLength,4)}const Rz=["SCALAR","VEC2","VEC3","VEC4"],_fe=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],yfe=new Map(_fe),bfe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},vfe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},wfe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Nz(n){return Rz[n-1]||Rz[0]}function Pz(n){const e=yfe.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function Fz(n,e){const t=wfe[n.componentType],i=bfe[n.type],s=n.count*i,o=n.count*i*vfe[n.componentType];return La(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const Efe={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class eh{constructor(e){Kn(this,"gltf",void 0),Kn(this,"sourceBuffers",void 0),Kn(this,"byteLength",void 0),this.gltf=e||{json:ht({},Efe),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return La(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=Fz(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return La(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return La(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=rO(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;La(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=A0(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:Nz(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:Pz(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=mfe(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const Lz="KHR_binary_glTF",T0="KHR_draco_mesh_compression",Vg="KHR_lights_punctual",xS="KHR_materials_unlit",CS="KHR_techniques_webgl";function Cfe(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=kz(i);e[t]=r}}return e}function kz(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:Nz(t),componentType:Pz(e)}}function Mfe(n,e,t){return MO.apply(this,arguments)}function MO(){return(MO=ii(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new eh(n),s=[];for(const o of Nfe(r))r.getObjectExtension(o,T0)&&s.push(Ife(r,o,e,t));yield Promise.all(s),r.removeExtension(T0)})).apply(this,arguments)}function Dfe(n,e={}){const t=new eh(n);for(const i of t.json.meshes||[])Ofe(i),t.addRequiredExtension(T0)}function Ife(n,e,t,i){return DO.apply(this,arguments)}function DO(){return(DO=ii(function*(n,e,t,i){const r=n.getObjectExtension(e,T0);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=YV(s.buffer,s.byteOffset),{parse:a}=i,l=ht({},t);delete l["3d-tiles"];const c=yield a(o,AO,l,i),d=Cfe(c.attributes);for(const[f,p]of Object.entries(d))if(f in e.attributes){const _=n.getAccessor(e.attributes[f]);null!=_&&_.min&&null!=_&&_.max&&(p.min=_.min,p.max=_.max)}e.attributes=d,c.indices&&(e.indices=kz(c.indices)),Rfe(e)})).apply(this,arguments)}function Ofe(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[T0]:{bufferView:c,attributes:l}}}]}}function Rfe(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Nfe(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function Pfe(n){return IO.apply(this,arguments)}function IO(){return(IO=ii(function*(n){const e=new eh(n),{json:t}=e;e.removeExtension(xS);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,xS)})).apply(this,arguments)}function Ffe(n){const e=new eh(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,xS,{}),e.addExtension(xS))}function Lfe(n){return OO.apply(this,arguments)}function OO(){return(OO=ii(function*(n){const e=new eh(n),{json:t}=e,i=e.getExtension(Vg);i&&(e.json.lights=i.lights,e.removeExtension(Vg));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,Vg);s&&(r.light=s.light),e.removeObjectExtension(r,Vg)}})).apply(this,arguments)}function kfe(n){return RO.apply(this,arguments)}function RO(){return(RO=ii(function*(n){const e=new eh(n),{json:t}=e;if(t.lights){const i=e.addExtension(Vg);La(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,Vg,i);delete e.json.lights}})).apply(this,arguments)}function Bfe(n){return NO.apply(this,arguments)}function NO(){return(NO=ii(function*(n){const e=new eh(n),{json:t}=e,i=e.getExtension(CS);if(i){const r=Vfe(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,CS);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=Ufe(s.technique,e)),e.removeObjectExtension(s,CS)}e.removeExtension(CS)}})).apply(this,arguments)}function jfe(n,e){return PO.apply(this,arguments)}function PO(){return(PO=ii(function*(n,e){})).apply(this,arguments)}function Vfe(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function Ufe(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const Bz={KHR_draco_mesh_compression:mt,KHR_materials_unlit:J,KHR_lights_punctual:At,KHR_techniques_webgl:dt};function zfe(n){return FO.apply(this,arguments)}function FO(){return(FO=ii(function*(n,e={},t){for(const r in Bz){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield Bz[r].decode(n,e,t))}})).apply(this,arguments)}const jz={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Gfe={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class $fe{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new eh(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,Lz);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(Lz)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in jz)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in jz)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=Gfe[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function Wfe(n,e={}){return(new $fe).normalize(n,e)}const qfe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kfe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},yl={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Yfe={magFilter:yl.TEXTURE_MAG_FILTER,minFilter:yl.TEXTURE_MIN_FILTER,wrapS:yl.TEXTURE_WRAP_S,wrapT:yl.TEXTURE_WRAP_T},Xfe={[yl.TEXTURE_MAG_FILTER]:yl.LINEAR,[yl.TEXTURE_MIN_FILTER]:yl.NEAREST_MIPMAP_LINEAR,[yl.TEXTURE_WRAP_S]:yl.REPEAT,[yl.TEXTURE_WRAP_]:yl.REPEAT};class Jfe{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return La(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=ht({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=ht({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ht({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ht({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ht({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=ht({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=ht({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return Kfe[n]}(e.componentType),e.components=function(n){return qfe[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=Fz(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):Xfe,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return Yfe[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function epe(n,e){return(new Jfe).postProcess(n,e)}const Vz=1735152710,Ug=!0;function kO(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),A0(i,4)}function BO(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),A0(i,4)}function hpe(n,e){return jO.apply(this,arguments)}function jO(){return(jO=ii(function*(n,e,t=0,i,r){var s,o,a,l;fpe(n,e,t,i),Wfe(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield ppe(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const f=gpe(n,i,r);c.push(f)}const d=zfe(n,i,r);return c.push(d),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?epe(n,i):n})).apply(this,arguments)}function fpe(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=Vz}=t,s=i.getUint32(e,!1);return s===r||s===Vz}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?mz(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?mz(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,Ug),a=r.getUint32(t+8,Ug);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){_f(n.header.byteLength>20);const i=e.getUint32(t+0,Ug),r=e.getUint32(t+4,Ug);return t+=8,_f(0===r),kO(n,e,t,i),(t+=i)+BO(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return _f(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,Ug),s=e.getUint32(t+4,Ug);switch(t+=8,s){case 1313821514:kO(n,e,t,r);break;case 5130562:BO(n,e,t,r);break;case 0:i.strict||kO(n,e,t,r);break;case 1:i.strict||BO(n,e,t,r)}t+=A0(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),La("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else La(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function ppe(n,e,t){return VO.apply(this,arguments)}function VO(){return(VO=ii(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;La(a);const l=_z(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),d=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:d,byteOffset:0,byteLength:d.byteLength},delete o.uri}}})).apply(this,arguments)}function gpe(n,e,t){return UO.apply(this,arguments)}function UO(){return(UO=ii(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(mpe(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function mpe(n,e,t,i,r){return zO.apply(this,arguments)}function zO(){return(zO=ii(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=_z(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=yz(n.json,n.buffers,e.bufferView);a=YV(c.buffer,c.byteOffset,c.byteLength)}La(a,"glTF image has no data");const l=yield o(a,DU,{},r);n.images[t]=l})).apply(this,arguments)}const zg={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return HO.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function HO(){return(HO=ii(function*(n,e={},t){(e=ht(ht({},zg.options),e)).gltf=ht(ht({},zg.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield hpe({},n,i,e,t)})).apply(this,arguments)}function GO(){return(GO=ii(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield bpe(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function bpe(n){return $O.apply(this,arguments)}function $O(){return($O=ii(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const Uz=[255,255,255,255],Epe={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:Uz},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[zg]};let Spe=(()=>{class n extends HI{getShaders(){const t=[qU,ZU];return"pbr"===this.props._lighting&&t.push(oz),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Uz,transition:!0},instanceModelMatrix:iz})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof kg)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new Dhe(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=ht({gltf:l},c),function(n){return GO.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Bi.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof kg?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&Bi.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):Bi.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):Bi.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof kg&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:ht({isInstanced:!0,transpileToGLSL100:!yi(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:d}=this.props,f=this.getNumInstances();this.state.scenegraph.traverse((p,{worldMatrix:g})=>{p.model.setInstanceCount(f),p.updateModuleSettings(t),p.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:rz(s,d),sceneModelMatrix:g,u_Camera:p.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=Epe,n})();const xpe=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Cpe=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),Ape=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),Tpe=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),Mpe={POSITION:{size:3,value:new Float32Array(Cpe)},NORMAL:{size:3,value:new Float32Array(Ape)},TEXCOORD_0:{size:2,value:new Float32Array(Tpe)}};class Dpe extends yS{constructor(e={}){const{id:t=kc("cube-geometry")}=e;super(Hn(ht({},e),{id:t,indices:{size:1,value:new Uint16Array(xpe)},attributes:ht(ht({},Mpe),e.attributes)}))}}class Wc{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new le){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new le){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new Wc){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],d=i[4],f=i[5],p=i[6],g=i[7],_=i[8],C=r[0],T=r[1],W=r[2],H=r[3],me=r[4],Re=r[5],ze=r[6],Ge=r[7],at=r[8];return s[0]=o*C+a*H+l*ze,s[1]=o*T+a*me+l*Ge,s[2]=o*W+a*Re+l*at,s[3]=c*C+d*H+f*ze,s[4]=c*T+d*me+f*Ge,s[5]=c*W+d*Re+f*at,s[6]=p*C+g*H+_*ze,s[7]=p*T+g*me+_*Ge,s[8]=p*W+g*Re+_*at,t}scale(e,t=new Wc){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new le){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let d,p;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){d=4;do{p=4-d,s[p+4*o]+=s[p+4*a]}while(--d);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];d=4;do{p=4-d,s[p+4*a]=p<=o?0:s[p+4*a]-s[p+4*o]*g}while(--d)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new Wc){const r=Ipe;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,f;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{f=6-c,r[f+6*s]+=r[f+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const p=r[s+6*o]/r[s+6*s];c=6;do{f=6-c,r[f+6*o]=f<=s?0:r[f+6*o]-r[f+6*s]*p}while(--c)}}while(--a);s=2;do{o=s-1;do{const p=r[s+6*o]/r[s+6*s];c=6;do{f=6-c,r[f+6*o]=r[f+6*o]-r[f+6*s]*p}while(--c)}while(o--)}while(--s);s=2;do{const p=1/r[s+6*s];c=6;do{f=6-c,r[f+6*s]=r[f+6*s]*p}while(--c)}while(s--);s=2;do{o=2;do{if(f=r[3+o+6*s],isNaN(f)||f===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,f)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,d=t*a,f=t*l,p=i*a,g=i*l,_=r*l,C=s*o,T=s*a,W=s*l,H=this.elements;return H[0]=1-(p+_),H[1]=d-W,H[2]=f+T,H[3]=d+W,H[4]=1-(c+_),H[5]=g-C,H[6]=f-T,H[7]=g+C,H[8]=1-(c+p),this}transpose(e=new Wc){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const Ipe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class le{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new le(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new le(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new Wc([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new le){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new le){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new le){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new le){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new le){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=Ope,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=Rpe;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(zz),zz.almostEquals(e,t)}clone(){return new le(this.x,this.y,this.z)}}le.ZERO=void 0,le.UNIT_X=void 0,le.UNIT_Y=void 0,le.UNIT_Z=void 0,le.ZERO=new le(0,0,0),le.UNIT_X=new le(1,0,0),le.UNIT_Y=new le(0,1,0),le.UNIT_Z=new le(0,0,1);const Ope=new le,Rpe=new le,zz=new le;class ur{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new le,this.upperBound=new le,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,Hz),c=Hz),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new ur).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,d=this.upperBound;e.copy(c),t.set(d.x,c.y,c.z),i.set(d.x,d.y,c.z),r.set(c.x,d.y,d.z),s.set(d.x,c.y,d.z),o.set(c.x,d.y,c.z),a.set(c.x,c.y,d.z),l.copy(d)}toLocalFrame(e,t){const i=Gz;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=Gz;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,d=(this.upperBound.y-i.y)*s,f=(this.lowerBound.z-i.z)*o,p=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,d)),Math.min(f,p)),_=Math.min(Math.min(Math.max(a,l),Math.max(c,d)),Math.max(f,p));return!(_<0||g>_)}}const Hz=new le,Gz=[new le,new le,new le,new le,new le,new le,new le,new le];class os{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new le){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=Ppe;e.tangents(i,Fpe),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(yr(e.length(),2)*yr(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new os){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,d=e.w;return t.x=i*d+o*a+r*c-s*l,t.y=r*d+o*l+s*a-i*c,t.z=s*d+o*c+i*l-r*a,t.w=o*d-i*a-r*l-s*c,t}inverse(e=new os){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new os){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,d=c*i+a*s-l*r,f=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=d*c+g*-o+f*-l-p*-a,t.y=f*c+g*-a+p*-o-d*-l,t.z=p*c+g*-l+d*-a-f*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const d=o*a+l*c;if(d>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),d<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const f=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*d),s=Math.atan2(2*o*c-2*a*l,1-2*f-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),d=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a-l*c*d):"YXZ"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a+l*c*d):"ZXY"===r?(this.x=l*o*a-s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a-l*c*d):"ZYX"===r?(this.x=l*o*a-s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a+l*c*d):"YZX"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a-l*c*d):"XZY"===r&&(this.x=l*o*a-s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a+l*c*d),this}clone(){return new os(this.x,this.y,this.z,this.w)}slerp(e,t,i=new os){const r=this.x,s=this.y,o=this.z,a=this.w;let p,g,_,C,T,l=e.x,c=e.y,d=e.z,f=e.w;return g=r*l+s*c+o*d+a*f,g<0&&(g=-g,l=-l,c=-c,d=-d,f=-f),1-g>1e-6?(p=Math.acos(g),_=Math.sin(p),C=Math.sin((1-t)*p)/_,T=Math.sin(t*p)/_):(C=1-t,T=t),i.x=C*r+T*l,i.y=C*s+T*c,i.z=C*o+T*d,i.w=C*a+T*f,i}integrate(e,t,i,r=new os){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,d=this.z,f=this.w,p=.5*t;return r.x+=p*(s*f+o*d-a*c),r.y+=p*(o*f+a*l-s*d),r.z+=p*(a*f+s*c-o*l),r.w+=p*(-s*l-o*c-a*d),r}}const Ppe=new le,Fpe=new le,Lpe={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let fn=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=Lpe,n})();class ji{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new le,this.quaternion=new os,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return ji.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return ji.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new le){return i.vsub(e,r),t.conjugate(Wz),Wz.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new le){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new le){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new le){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const Wz=new os;class vf extends fn{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:fn.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new le;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let d=!1;for(let f=0;f!==i.length;f++)if(i[f].almostEquals(r)||i[f].almostEquals(r)){d=!0;break}d||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new le;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];vf.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new le,o=new le;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const d=new le;let f=-1,p=-Number.MAX_VALUE;for(let _=0;_<i.faces.length;_++){d.copy(i.faceNormals[_]),s.vmult(d,d);const C=d.dot(o);C>p&&(p=C,f=_)}const g=[];for(let _=0;_<i.faces[f].length;_++){const C=i.vertices[i.faces[f][_]],T=new le;T.copy(C),s.vmult(T,T),r.vadd(T,T),g.push(T)}f>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new le,d=new le,f=new le,p=new le,g=new le,_=new le;let C=Number.MAX_VALUE;const T=this;if(T.uniqueAxes)for(let W=0;W!==T.uniqueAxes.length;W++){i.vmult(T.uniqueAxes[W],c);const H=T.testSepAxis(c,e,t,i,r,s);if(!1===H)return!1;H<C&&(C=H,o.copy(c))}else{const W=a?a.length:T.faces.length;for(let H=0;H<W;H++){c.copy(T.faceNormals[a?a[H]:H]),i.vmult(c,c);const Re=T.testSepAxis(c,e,t,i,r,s);if(!1===Re)return!1;Re<C&&(C=Re,o.copy(c))}}if(e.uniqueAxes)for(let W=0;W!==e.uniqueAxes.length;W++){s.vmult(e.uniqueAxes[W],d);const H=T.testSepAxis(d,e,t,i,r,s);if(!1===H)return!1;H<C&&(C=H,o.copy(d))}else{const W=l?l.length:e.faces.length;for(let H=0;H<W;H++){d.copy(e.faceNormals[l?l[H]:H]),s.vmult(d,d);const Re=T.testSepAxis(d,e,t,i,r,s);if(!1===Re)return!1;Re<C&&(C=Re,o.copy(d))}}for(let W=0;W!==T.uniqueEdges.length;W++){i.vmult(T.uniqueEdges[W],p);for(let H=0;H!==e.uniqueEdges.length;H++)if(s.vmult(e.uniqueEdges[H],g),p.cross(g,_),!_.almostZero()){_.normalize();const me=T.testSepAxis(_,e,t,i,r,s);if(!1===me)return!1;me<C&&(C=me,o.copy(_))}}return r.vsub(t,f),f.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){vf.project(this,e,i,r,WO),vf.project(t,e,s,o,qO);const l=WO[0],c=WO[1],d=qO[0],f=qO[1];if(l<f||d<c)return!1;const p=l-f,g=d-c;return p<g?p:g}calculateLocalInertia(e,t){const i=new le,r=new le;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new le,c=new le,d=new le,f=new le,p=new le,g=new le,_=new le,C=new le,T=this,H=r,me=[];let Re=-1,ze=Number.MAX_VALUE;for(let Pt=0;Pt<T.faces.length;Pt++){l.copy(T.faceNormals[Pt]),i.vmult(l,l);const Zt=l.dot(e);Zt<ze&&(ze=Zt,Re=Pt)}if(Re<0)return;const Ge=T.faces[Re];Ge.connectedFaces=[];for(let Pt=0;Pt<T.faces.length;Pt++)for(let Zt=0;Zt<T.faces[Pt].length;Zt++)-1!==Ge.indexOf(T.faces[Pt][Zt])&&Pt!==Re&&-1===Ge.connectedFaces.indexOf(Pt)&&Ge.connectedFaces.push(Pt);const at=Ge.length;for(let Pt=0;Pt<at;Pt++){const Zt=T.vertices[Ge[Pt]];Zt.vsub(T.vertices[Ge[(Pt+1)%at]],c),d.copy(c),i.vmult(d,d),t.vadd(d,d),f.copy(this.faceNormals[Re]),i.vmult(f,f),t.vadd(f,f),d.cross(f,p),p.negate(p),g.copy(Zt),i.vmult(g,g),t.vadd(g,g);const wt=Ge.connectedFaces[Pt];_.copy(this.faceNormals[wt]);const Ct=this.getPlaneConstantOfFace(wt);C.copy(_),i.vmult(C,C);const Ut=Ct-C.dot(t);for(this.clipFaceAgainstPlane(H,me,C,Ut);H.length;)H.shift();for(;me.length;)H.push(me.shift())}_.copy(this.faceNormals[Re]);const St=this.getPlaneConstantOfFace(Re);C.copy(_),i.vmult(C,C);const Ot=St-C.dot(t);for(let Pt=0;Pt<H.length;Pt++){let Zt=C.dot(H[Pt])+Ot;if(Zt<=s&&(console.log("clamped: depth="+Zt+" to minDist="+s),Zt=s),Zt<=o){const en=H[Pt];Zt<=1e-6&&a.push({point:en,normal:C,depth:Zt})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let d=0;d<a;d++){if(c=e[d],o=i.dot(c)+r,s<0)if(o<0){const f=new le;f.copy(c),t.push(f)}else{const f=new le;l.lerp(c,s/(s-o),f),t.push(f)}else if(o<0){const f=new le;l.lerp(c,s/(s-o),f),t.push(f),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new le);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new le);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,d,f,p=new le;for(let g=0;g<s.length;g++){p.copy(s[g]),t.vmult(p,p),e.vadd(p,p);const _=p;(void 0===o||_.x<o)&&(o=_.x),(void 0===c||_.x>c)&&(c=_.x),(void 0===a||_.y<a)&&(a=_.y),(void 0===d||_.y>d)&&(d=_.y),(void 0===l||_.z<l)&&(l=_.z),(void 0===f||_.z>f)&&(f=_.z)}i.set(o,a,l),r.set(c,d,f)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new le){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new le;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new le;e.vsub(l,c);const d=a.dot(c),f=new le;s.vsub(l,f);const p=a.dot(f);if(d<0&&p>0||d>0&&p<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=kpe;let l=0,c=0;const d=Bpe,f=e.vertices;d.setZero(),ji.vectorToLocalFrame(i,r,t,a),ji.pointToLocalFrame(i,r,d,d);const p=d.dot(a);c=l=f[0].dot(a);for(let g=1;g<o;g++){const _=f[g].dot(a);_>l&&(l=_),_<c&&(c=_)}if(c-=p,l-=p,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const WO=[],qO=[],kpe=new le,Bpe=new le;class TS extends fn{constructor(e){super({type:fn.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=le,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new vf({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new le){return TS.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)th.set(s[o][0],s[o][1],s[o][2]),t.vmult(th,th),e.vadd(th,th),i(th.x,th.y,th.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;qc[0].set(s.x,s.y,s.z),qc[1].set(-s.x,s.y,s.z),qc[2].set(-s.x,-s.y,s.z),qc[3].set(-s.x,-s.y,-s.z),qc[4].set(s.x,-s.y,-s.z),qc[5].set(s.x,s.y,-s.z),qc[6].set(-s.x,s.y,-s.z),qc[7].set(s.x,-s.y,s.z);const o=qc[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=qc[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,d=l.y,f=l.z;c>r.x&&(r.x=c),d>r.y&&(r.y=d),f>r.z&&(r.z=f),c<i.x&&(i.x=c),d<i.y&&(i.y=d),f<i.z&&(i.z=f)}}}const th=new le,qc=[new le,new le,new le,new le,new le,new le,new le,new le];class pn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=pn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new le,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new le,this.previousPosition=new le,this.interpolatedPosition=new le,this.initPosition=new le,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new le,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new le,this.force=new le;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?pn.STATIC:pn.DYNAMIC,typeof e.type==typeof pn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=pn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new le,this.quaternion=new os,this.initQuaternion=new os,this.previousQuaternion=new os,this.interpolatedQuaternion=new os,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new le,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new le,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new le,this.invInertia=new le,this.invInertiaWorld=new Wc,this.invMassSolve=0,this.invInertiaSolve=new le,this.invInertiaWorldSolve=new Wc,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new le(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new le(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new ur,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new le,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=pn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===pn.SLEEPING&&this.dispatchEvent(pn.wakeupEvent)}sleep(){this.sleepState=pn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=yr(this.sleepSpeedLimit,2);t===pn.AWAKE&&i<r?(this.sleepState=pn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(pn.sleepyEvent)):t===pn.SLEEPY&&i>r?this.wakeUp():t===pn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(pn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===pn.SLEEPING||this.type===pn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new le){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new le){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new le,s=new os;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=jpe,o=Vpe,a=this.quaternion,l=this.aabb,c=Upe;for(let d=0;d!==r;d++){const f=e[d];a.vmult(t[d],s),s.vadd(this.position,s),a.mult(i[d],o),f.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===d?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=zpe,r=Hpe;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new le){if(this.type!==pn.DYNAMIC)return;this.sleepState===pn.SLEEPING&&this.wakeUp();const i=Gpe;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new le){if(this.type!==pn.DYNAMIC)return;const i=$pe,r=Wpe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===pn.DYNAMIC&&(this.sleepState===pn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new le){if(this.type!==pn.DYNAMIC)return;this.sleepState===pn.SLEEPING&&this.wakeUp();const i=t,r=qpe;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=Kpe;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new le){if(this.type!==pn.DYNAMIC)return;const i=Ype,r=Xpe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=Qpe;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),TS.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new le;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==pn.DYNAMIC&&this.type!==pn.KINEMATIC||this.sleepState===pn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,f=this.invInertiaWorld,p=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*p.x,r.y+=a.y*g*p.y,r.z+=a.z*g*p.z;const _=f.elements,C=this.angularFactor,T=l.x*C.x,W=l.y*C.y,H=l.z*C.z;s.x+=e*(_[0]*T+_[1]*W+_[2]*H),s.y+=e*(_[3]*T+_[4]*W+_[5]*H),s.z+=e*(_[6]*T+_[7]*W+_[8]*H),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}pn.idCounter=0,pn.COLLIDE_EVENT_NAME="collide",pn.DYNAMIC=1,pn.STATIC=2,pn.KINEMATIC=4,pn.AWAKE=0,pn.SLEEPY=1,pn.SLEEPING=2,pn.wakeupEvent={type:"wakeup"},pn.sleepyEvent={type:"sleepy"},pn.sleepEvent={type:"sleep"};const jpe=new le,Vpe=new os,Upe=new ur,zpe=new Wc,Hpe=new Wc,Gpe=new le,$pe=new le,Wpe=new le,qpe=new le,Kpe=new le,Ype=new le,Xpe=new le,Qpe=new le;new le,new le;class MS{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new le,this.rayToWorld=new le,this.hitNormalWorld=new le,this.hitPointWorld=new le,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let qz,Kz,Yz,Xz,Qz,Zz,Jz;qz=fn.types.SPHERE,Kz=fn.types.PLANE,Yz=fn.types.BOX,Xz=fn.types.CYLINDER,Qz=fn.types.CONVEXPOLYHEDRON,Zz=fn.types.HEIGHTFIELD,Jz=fn.types.TRIMESH;class ps{get[qz](){return this._intersectSphere}get[Kz](){return this._intersectPlane}get[Yz](){return this._intersectBox}get[Xz](){return this._intersectConvex}get[Qz](){return this._intersectConvex}get[Zz](){return this._intersectHeightfield}get[Jz](){return this._intersectTrimesh}constructor(e=new le,t=new le){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new le,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=ps.ANY,this.result=new MS,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||ps.ANY,this.result=t.result||new MS,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(e4),QO.length=0,e.broadphase.aabbQuery(e,e4,QO),this.intersectBodies(QO),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=rge,s=sge;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,wf);const i=wf.dot(e);return e.scale(i,IS),IS.vadd(n,IS),t.distanceTo(IS)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new le(0,0,1);t.vmult(c,c);const d=new le;o.vsub(i,d);const f=d.dot(c);if(a.vsub(i,d),f*d.dot(c)>0||o.distanceTo(a)<f)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const _=new le,C=new le,T=new le;o.vsub(i,_);const W=-c.dot(_)/g;l.scale(W,C),o.vadd(C,T),this.reportIntersection(c,T,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=oge;o.from.copy(this.from),o.to.copy(this.to),ji.pointToLocalFrame(i,t,o.from,o.from),ji.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=age;let l,c,d,f;l=c=0,d=f=e.data.length-1;const p=new ur;o.getAABB(p),e.getIndexOfPosition(p.lowerBound.x,p.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(p.upperBound.x,p.upperBound.y,a,!0),d=Math.min(d,a[0]+1),f=Math.min(f,a[1]+1);for(let g=l;g<d;g++)for(let _=c;_<f;_++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,_,p),p.overlapsRay(o)){if(e.getConvexTrianglePillar(g,_,!1),ji.pointToWorldFrame(i,t,e.pillarOffset,DS),this._intersectConvex(e.pillarConvex,t,DS,r,s,t4),this.result.shouldStop)return;e.getConvexTrianglePillar(g,_,!0),ji.pointToWorldFrame(i,t,e.pillarOffset,DS),this._intersectConvex(e.pillarConvex,t,DS,r,s,t4)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=yr(a.x-o.x,2)+yr(a.y-o.y,2)+yr(a.z-o.z,2),d=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),f=yr(o.x-i.x,2)+yr(o.y-i.y,2)+yr(o.z-i.z,2)-yr(l,2),p=yr(d,2)-4*c*f,g=lge,_=cge;if(!(p<0))if(0===p)o.lerp(a,p,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1);else{const C=(-d-Math.sqrt(p))/(2*c),T=(-d+Math.sqrt(p))/(2*c);if(C>=0&&C<=1&&(o.lerp(a,C,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1)),this.result.shouldStop)return;T>=0&&T<=1&&(o.lerp(a,T,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=uge,l=n4,c=o&&o.faceList||null,d=e.faces,f=e.vertices,p=e.faceNormals,g=this.direction,_=this.from,T=_.distanceTo(this.to),W=c?c.length:d.length,H=this.result;for(let me=0;!H.shouldStop&&me<W;me++){const Re=c?c[me]:me,ze=d[Re],Ge=p[Re],at=t,St=i;l.copy(f[ze[0]]),at.vmult(l,l),l.vadd(St,l),l.vsub(_,l),at.vmult(Ge,a);const Ot=g.dot(a);if(Math.abs(Ot)<this.precision)continue;const Pt=a.dot(l)/Ot;if(!(Pt<0)){g.scale(Pt,la),la.vadd(_,la),oc.copy(f[ze[0]]),at.vmult(oc,oc),St.vadd(oc,oc);for(let Zt=1;!H.shouldStop&&Zt<ze.length-1;Zt++){Kc.copy(f[ze[Zt]]),Yc.copy(f[ze[Zt+1]]),at.vmult(Kc,Kc),at.vmult(Yc,Yc),St.vadd(Kc,Kc),St.vadd(Yc,Yc);const en=la.distanceTo(_);!ps.pointInTriangle(la,oc,Kc,Yc)&&!ps.pointInTriangle(la,Kc,oc,Yc)||en>T||this.reportIntersection(a,la,s,r,Re)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=dge,l=_ge,c=yge,d=n4,f=hge,p=fge,g=pge,_=mge,C=gge,T=e.indices,W=this.from,H=this.to,me=this.direction;c.position.copy(i),c.quaternion.copy(t),ji.vectorToLocalFrame(i,t,me,f),ji.pointToLocalFrame(i,t,W,p),ji.pointToLocalFrame(i,t,H,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,p.x*=e.scale.x,p.y*=e.scale.y,p.z*=e.scale.z,g.vsub(p,f),f.normalize();const Re=p.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let ze=0,Ge=l.length;!this.result.shouldStop&&ze!==Ge;ze++){const at=l[ze];e.getNormal(at,a),e.getVertex(T[3*at],oc),oc.vsub(p,d);const St=f.dot(a),Ot=a.dot(d)/St;if(Ot<0)continue;f.scale(Ot,la),la.vadd(p,la),e.getVertex(T[3*at+1],Kc),e.getVertex(T[3*at+2],Yc);const Pt=la.distanceSquared(p);!ps.pointInTriangle(la,Kc,oc,Yc)&&!ps.pointInTriangle(la,oc,Kc,Yc)||Pt>Re||(ji.vectorToWorldFrame(t,a,C),ji.pointToWorldFrame(i,t,la,_),this.reportIntersection(C,_,s,r,at))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case ps.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case ps.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case ps.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,wf),i.vsub(t,M0),e.vsub(t,ZO);const s=wf.dot(wf),o=wf.dot(M0),a=wf.dot(ZO),l=M0.dot(M0),c=M0.dot(ZO);let d,f;return(d=l*a-o*c)>=0&&(f=s*c-o*a)>=0&&d+f<s*l-o*o}}ps.CLOSEST=1,ps.ANY=2,ps.ALL=4;const e4=new ur,QO=[],M0=new le,ZO=new le,rge=new le,sge=new os,la=new le,oc=new le,Kc=new le,Yc=new le,t4={faceList:[0]},DS=new le,oge=new ps,age=[],lge=new le,cge=new le,uge=new le,n4=new le,dge=new le,hge=new le,fge=new le,pge=new le,gge=new le,mge=new le;new ur;const _ge=[],yge=new ji,wf=new le,IS=new le;let _4,y4,b4,v4,w4,E4,S4,x4,C4,A4,T4,M4,D4,I4,O4,R4,N4,P4,F4,L4,k4,B4,j4,V4,U4;new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new ps,new le,new le,new le(1,0,0),new le(0,1,0),new le(0,0,1),new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new ur,new le,new ur,new le,new le,new le,new le,new le,new le,new le,new ur,new le,new ji,new ur;const Mr={sphereSphere:fn.types.SPHERE,spherePlane:fn.types.SPHERE|fn.types.PLANE,boxBox:fn.types.BOX|fn.types.BOX,sphereBox:fn.types.SPHERE|fn.types.BOX,planeBox:fn.types.PLANE|fn.types.BOX,convexConvex:fn.types.CONVEXPOLYHEDRON,sphereConvex:fn.types.SPHERE|fn.types.CONVEXPOLYHEDRON,planeConvex:fn.types.PLANE|fn.types.CONVEXPOLYHEDRON,boxConvex:fn.types.BOX|fn.types.CONVEXPOLYHEDRON,sphereHeightfield:fn.types.SPHERE|fn.types.HEIGHTFIELD,boxHeightfield:fn.types.BOX|fn.types.HEIGHTFIELD,convexHeightfield:fn.types.CONVEXPOLYHEDRON|fn.types.HEIGHTFIELD,sphereParticle:fn.types.PARTICLE|fn.types.SPHERE,planeParticle:fn.types.PLANE|fn.types.PARTICLE,boxParticle:fn.types.BOX|fn.types.PARTICLE,convexParticle:fn.types.PARTICLE|fn.types.CONVEXPOLYHEDRON,cylinderCylinder:fn.types.CYLINDER,sphereCylinder:fn.types.SPHERE|fn.types.CYLINDER,planeCylinder:fn.types.PLANE|fn.types.CYLINDER,boxCylinder:fn.types.BOX|fn.types.CYLINDER,convexCylinder:fn.types.CONVEXPOLYHEDRON|fn.types.CYLINDER,heightfieldCylinder:fn.types.HEIGHTFIELD|fn.types.CYLINDER,particleCylinder:fn.types.PARTICLE|fn.types.CYLINDER,sphereTrimesh:fn.types.SPHERE|fn.types.TRIMESH,planeTrimesh:fn.types.PLANE|fn.types.TRIMESH};_4=Mr.sphereSphere,y4=Mr.spherePlane,b4=Mr.boxBox,v4=Mr.sphereBox,w4=Mr.planeBox,E4=Mr.convexConvex,S4=Mr.sphereConvex,x4=Mr.planeConvex,C4=Mr.boxConvex,A4=Mr.sphereHeightfield,T4=Mr.boxHeightfield,M4=Mr.convexHeightfield,D4=Mr.sphereParticle,I4=Mr.planeParticle,O4=Mr.boxParticle,R4=Mr.convexParticle,N4=Mr.cylinderCylinder,P4=Mr.sphereCylinder,F4=Mr.planeCylinder,L4=Mr.boxCylinder,k4=Mr.convexCylinder,B4=Mr.heightfieldCylinder,j4=Mr.particleCylinder,V4=Mr.sphereTrimesh,U4=Mr.planeTrimesh,new le,new le,new le,new le,new le,new os,new os,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new ur,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new os,new le,new le,new le,new le,new le,new le,new le,new le,new ur,new ps;const qs=globalThis.performance||{};if(!qs.now){let n=Date.now();qs.timing&&qs.timing.navigationStart&&(n=qs.timing.navigationStart),qs.now=()=>Date.now()-n}var Cf=tt(517);class Rr extends oe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new z;return this._value}next(e){super.next(this._value=e)}}function Wg(n,e,t){e||(e=new qn(qn.IDENTITY));const i=new qn(qn.IDENTITY);if(!n)return!0;if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new qn(qn.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new qn(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===Wg(s,r,t))return!1;return!0}function q4(){JV([bz,zg])}function K4(n,e){const t=e.nodes.find(i=>i.name===n);if(t){let i=!1;for(const r of e.scenes)i||Wg(r,new qn(qn.IDENTITY),(s,o)=>s!==t||(s.matrix=o,s.translation=void 0,s.rotation=void 0,s.scale=void 0,i=!0,!1));return e.scene={id:n,name:n,nodes:[t]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function tR(n,e){return Ni(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield sS(i,zg,{DracoLoader:AO,gltf:{decompressMeshes:!0,postProcess:!0}});return K4(n.scenegraphNode,r)})}function bye(n,e){return Ni(this,void 0,void 0,function*(){return K4(n,yield e)})}function nR(n,e,t){if(e&&0!==e.length)return new Kde(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Pi.CARTESIAN,data:e,mesh:new Dpe,wireframe:!1,getTransformMatrix:i=>i.transformMatrix,getColor:i=>i.color||[255,255,255,229.5]},t))}let wye=(()=>{class n extends Xle{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),q4()}renderLayers(){const t=this.state,i=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&l.unpickable),r=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&!l.unpickable),s=t.data.filter(l=>!l.scenegraph&&l.wireframe),o=t.data.filter(l=>!!l.scenegraph);t.doCollisions&&function(n){Ni(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&!o.wireframe).map(o=>{const a=new qn(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new ur({lowerBound:new le(...l.map((d,f)=>Math.min(d,c[f]))),upperBound:new le(...c.map((d,f)=>Math.max(d,l[f])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield oS(o.scenegraph,zg,{DracoLoader:AO,decompress:!0,postProcess:!0});for(const l of a.scenes)Wg(l,new qn(o.transformMatrix),(c,d)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const f of c.mesh.primitives)if(f.attributes.POSITION&&f.attributes.POSITION.min){const p=d.transformAsPoint(f.attributes.POSITION.min,[]),g=d.transformAsPoint(f.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new ur({lowerBound:new le(...p.map((_,C)=>Math.min(_,g[C]))),upperBound:new le(...g.map((_,C)=>Math.max(_,p[C])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(t.data);const a={};for(const l of o)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(a,l.scenegraph)&&(a[l.scenegraph]=tR({scenegraph:l.scenegraph},n.gltfCache));return[nR("cubes",i,{wireframe:!1,pickable:!1}),nR("pickableCubes",r,{wireframe:!1,pickable:!0}),nR("wireframes",s,{wireframe:!0,pickable:!1}),...o.map(l=>{var c;return new Spe({id:"models-"+l["@id"],opacity:l.zoomBasedOpacity?t.zoomOpacity:void 0!==l.opacity?l.opacity:1,pickable:!l.unpickable,coordinateSystem:Pi.CARTESIAN,data:[l],scenegraph:l.scenegraphNode?bye(l.scenegraphNode,a[l.scenegraph]):l.scenegraph,_lighting:l._lighting,getTransformMatrix:l.transformMatrix,getColor:null!==(c=l.color)&&void 0!==c?c:[0,255,0,127.5],parameters:{depthMask:!l.zoomBasedOpacity&&(void 0===l.opacity||1===l.opacity)}})})].filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function Y4(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),Y4(t,e);return e}let Sye=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new wye({}),this.nodeClickSubject=new oe,this.nodeHoverStartSubject=new oe,this.nodeHoverStopSubject=new oe,this.sceneRotationSubject=new Rr([0,0]),this.nodeDragStartSubject=new oe,this.nodeDragSubject=new oe,this.nodeDragEndSubject=new oe,this.nodeClick$=this.nodeClickSubject.pipe(_s()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(_s()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(_s()),this.sceneRotation$=this.sceneRotationSubject.pipe(_s()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(_s()),this.nodeDrag$=this.nodeDragSubject.pipe(_s()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(_s());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new lce({flipY:!1,near:-1e3}):new dce({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var d;return null!==(d=this.cursor)&&void 0!==d?d:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new YI({ambientLight:new cU({color:[255,255,255],intensity:10})})]),this.deck=new _S(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return Ni(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new qn([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t){return Ni(this,void 0,void 0,function*(){q4();const i=yield tR({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},s=[];for(const o of i.scenes)Wg(o,e=new qn(e||qn.IDENTITY),(a,l)=>{const c={"@id":a.name||a.id,"@type":"ProcessedNode",transformMatrix:new qn(l),wireframe:!0,node:a};if(s.push({"@id":`GLTF:${c["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:c["@id"],transformMatrix:new qn(e||qn.IDENTITY),tooltip:a.name||a.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:a}),a.mesh&&a.mesh.primitives&&a.mesh.primitives.length>0)for(const d of a.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const f=l.transformAsPoint(d.attributes.POSITION.min,[]),p=l.transformAsPoint(d.attributes.POSITION.max,[]);c.bbox=new ur({lowerBound:new le(...f.map((g,_)=>Math.min(g,p[_]))),upperBound:new le(...p.map((g,_)=>Math.max(g,f[_])))})}return r[c["@id"]]=c,!0});for(const o of Object.values(r).filter(a=>!a.bbox)){for(const a of Y4(o.node).map(l=>r[l]).filter(l=>l.bbox))o.bbox?o.bbox.extend(a.bbox):o.bbox=a.bbox.clone();o.bbox||delete r[o["@id"]]}for(const o of Object.values(r)){const a=o.bbox.lowerBound,d=(o.size=o.bbox.upperBound.clone().vsub(a)).clone().vmul(new le(.5,.5,.5)),f=o.center=a.clone().vadd(d);o.transformMatrix=new qn(qn.IDENTITY).translate(f.toArray()).scale(d.toArray())}for(const o of s)r[o["@id"]]=o;return r})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new qn(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return Ia([Cf.ZP],n.prototype,"_onHover",null),Ia([Cf.ZP],n.prototype,"_onClick",null),Ia([Cf.ZP],n.prototype,"_onViewStateChange",null),Ia([Cf.ZP],n.prototype,"_onDragStart",null),Ia([Cf.ZP],n.prototype,"_onDrag",null),Ia([Cf.ZP],n.prototype,"_onDragEnd",null),n})();function xye(n,e){return n===e}function Cye(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function X4(n,e=xye){let t=null,i=null;function r(){return Cye(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const Tye=X4(function(){const n=pM();if(!n)return!1;const e=n.injector.get(Ak,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let iR=(()=>{class n{constructor(){this.bootstrap$=new gg(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const rR=new Vt("INITIAL_STATE_TOKEN");let Mye=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const Q4=new Vt("Internals.StateContextFactory"),Z4=new Vt("Internals.StateFactory");function P0(...n){if(1===n.length){const e=n[0];if(L(e))return kS(e,null);if(ie(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return kS(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return kS(n=1===n.length&&L(n[0])?n[0]:n,null).pipe(pe(t=>e(...t)))}return kS(n,null)}function kS(n,e){return new I(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=ke(n[a]);let c=!1;t.add(l.subscribe({next:d=>{c||(c=!0,o++),r[a]=d},error:d=>t.error(d),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((d,f,p)=>(d[f]=r[p],d),{}):r),t.complete())}}))}})}function qi(n,e){return function(i){return i.lift(new Dye(n,e))}}class Dye{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new Iye(e,this.predicate,this.thisArg))}}class Iye extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function ka(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(d){let f;s++,!r||a?(a=!1,r=new gg(n,e,i),f=r.subscribe(this),o=d.subscribe({next(p){r.next(p)},error(p){a=!0,r.error(p)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):f=r.subscribe(this),this.add(()=>{s--,f.unsubscribe(),f=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}const J4=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function zi(n){return e=>0===n?EE():e.lift(new Rye(n))}class Rye{constructor(e){if(this.total=e,this.total<0)throw new J4}call(e,t){return t.subscribe(new Nye(e,this.total))}}class Nye extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function e8(n,e){return e?t=>t.pipe(e8((i,r)=>ke(n(i,r)).pipe(pe((s,o)=>e(i,s,r,o))))):t=>t.lift(new Pye(n))}class Pye{constructor(e){this.project=e}call(e,t){return t.subscribe(new Fye(e,this.project))}}class Fye extends ve{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new gt(this),i=this.destination;i.add(t);const r=R(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function BS(n=null){return e=>e.lift(new Lye(n))}class Lye{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new kye(e,this.defaultValue))}}class kye extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function ac(n){return function(t){const i=new Bye(n),r=t.lift(i);return i.caught=r}}class Bye{constructor(e){this.selector=e}call(e,t){return t.subscribe(new jye(e,this.selector,this.caught))}}class jye extends ve{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new gt(this);this.add(i);const r=R(t,i);r!==i&&this.add(r)}}}function as(n){return e=>e.lift(new Vye(n))}class Vye{constructor(e){this.notifier=e}call(e,t){const i=new Uye(e),r=R(this.notifier,new gt(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class Uye extends ve{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function nh(){}function Jr(n,e,t){return function(r){return r.lift(new zye(n,e,t))}}class zye{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new Hye(e,this.nextOrObserver,this.error,this.complete))}}class Hye extends y{constructor(e,t,i,r){super(e),this._tapNext=nh,this._tapError=nh,this._tapComplete=nh,this._tapError=i||nh,this._tapComplete=r||nh,Y(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||nh,this._tapError=t.error||nh,this._tapComplete=t.complete||nh)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function $u(n,e){return t=>t.lift(new Gye(n,e))}class Gye{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new $ye(e,this.compare,this.keySelector))}}class $ye extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const Ba={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let t8=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return yn.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return yn.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof yn||console.warn(Ba.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(Ie(yn),Ie(Rc))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const n8=new Vt("ROOT_STATE_TOKEN"),i8=new Vt("FEATURE_STATE_TOKEN"),r8=new Vt("NGXS_PLUGINS"),s8=new Vt("NG_TEST_MODE"),o8=new Vt("NG_DEV_MODE"),Wu="NGXS_META",a8="NGXS_OPTIONS_META";let Af=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=t8}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class Wye{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const l8=new Vt("NGXS_EXECUTION_STRATEGY");function Tf(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const c8=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},jS=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),oR=n=>n&&"object"==typeof n&&!Array.isArray(n),aR=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(oR(n)&&oR(t))for(const i in t)oR(t[i])?(n[i]||Object.assign(n,{[i]:{}}),aR(n[i],t[i])):Object.assign(n,{[i]:t[i]});return aR(n,...e)};function F0(n){return n[Wu]}function d8(n,e){const t=jS(e.currentAppState,n.path),i=jS(e.newAppState,n.path);return new Wye(t,i,!n.isInitialised)}function e0e(...n){return function(n,e,t=i0e){const i=function(n){return n.reduce((e,t)=>(e[Tf(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return qi(t=>{const i=Tf(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function i0e(){return pe(n=>n.action)}function VS(n){return e=>new I(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let US=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(l8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class o0e extends oe{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let zS=(()=>{class n extends o0e{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),a0e=(()=>{class n extends I{constructor(t,i){super(r=>{const s=t.pipe(VS(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(Ie(zS),Ie(US))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const h8=n=>(...e)=>n.shift()(...e,(...i)=>h8(n)(...i));let HS=(()=>{class n extends Rr{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),dR=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(Ie(n,12),Ie(r8,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),hR=(()=>{class n extends oe{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),f8=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(Jo),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(VS(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?cn(this._stateStream.getValue()):P0(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!Tf(t))return pg(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return h8([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(ka())}getActionResultStream(t){return this._actionResults.pipe(qi(i=>i.action===t&&"DISPATCHED"!==i.status),zi(1),ka())}createDispatchObservable(t){return t.pipe(e8(i=>{switch(i.status){case"SUCCESSFUL":return cn(this._stateStream.getValue());case"ERRORED":return pg(i.error);default:return Pc}})).pipe(ka())}}return n.\u0275fac=function(t){return new(t||n)(Ie($n),Ie(zS),Ie(hR),Ie(dR),Ie(HS),Ie(US))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const p8=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&p8(n[i])}),n};let g8=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(Ie(o8),Ie(s8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),m8=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(Ba.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(Ba.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(Ie(g8),Ie(Af))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),Kg=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=p8(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(Ie(HS),Ie(f8),Ie(Af),Ie(m8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),GS=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return jS(l,t.path)}function s(l,c){const d=c8(l,t.path,c),f=t.instance;if(f.ngxsOnChanges){const p=d8(t,{currentAppState:l,newAppState:d});f.ngxsOnChanges(p)}return i.setState(d),d}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error(Ba.PATCHING_ARRAY());if("object"!=typeof n)throw new Error(Ba.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(Kg))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class $S{static stateNameErrorMessage(e){return Ba.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(Ba.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error(Ba.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=F0(e);if(!t)throw new Error(Ba.STATE_DECORATOR());return t}}$S.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let Yg=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=X4(()=>{const c=this;function d(p){const g=c.statePaths[p];return g?function(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(p){let g=d(p);return g||((..._)=>(g||(g=d(p)),g?g(..._):void 0))},getSelectorOptions:p=>Object.assign({},c._config.selectorOptions,p||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach($S.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[Wu].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[Wu];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[Wu].name]=t,e),{})}(i),l=[];for(const c of s){const d=a[c],f=o[c],p=d[Wu];this.addRuntimeInfoToMeta(p,f);const g={name:c,path:f,isInitialised:!1,actions:p.actions,instance:this._injector.get(d),defaults:n.cloneDefaults(p.defaults)};this.hasBeenMountedAndBootstrapped(c,f)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>c8(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(qi(t=>"DISPATCHED"===t.status),B(({action:t})=>this.invokeActions(this._actions,t).pipe(pe(()=>({action:t,status:"SUCCESSFUL"})),BS({action:t,status:"CANCELED"}),ac(i=>cn({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=Tf(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let d=o.instance[l.fn](c,i);d instanceof Promise&&(d=ke(d)),d instanceof I?(d=d.pipe(BS({})),l.options.cancelUncompleted&&(d=d.pipe(as(t.pipe(e0e(i)))))):d=cn({}).pipe(ka()),s.push(d)}catch(d){s.push(pg(d))}}}return s.length||s.push(cn({})),P0(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=$S.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==jS(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(Ie($n),Ie(Af),Ie(n,12),Ie(zS),Ie(hR),Ie(GS),Ie(rR,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),fR=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(qi(()=>!!i),Jr(()=>this.invokeInit(i.states)),B(()=>this.bootstrapper.appBootstrapped$),qi(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=d8(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Kg),Ie(GS),Ie(iR))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();let ih=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(pe(i),ac(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?cn(void 0):pg(r)}),$u(),VS(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(zi(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(VS(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return function(n){const e=function(n){return n.NGXS_SELECTOR_META}(n)||F0(n);return e&&e.makeRootSelector||(()=>n)}(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(Ie(HS),Ie(Kg),Ie(Af),Ie(US),Ie(Yg),Ie(rR,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),L0=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(Ie(ih),Ie(Af))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class p0e{static get type(){return"@@INIT"}}class g0e{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const qS=new gg(1);let BR,_0e=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&Da();qS.next(t)}catch(n){qS.next(!1)}finally{qS.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new p0e,l)}}return n.\u0275fac=function(t){return new(t||n)(Ie(Yg),Ie(Kg),Ie(ih),Ie(L0),Ie(n8,8),Ie(fR))},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({}),n})(),y0e=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new g0e(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(Ie(ih),Ie(Kg),Ie(Yg),Ie(i8,8),Ie(fR))},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({}),n})();class ca{static forRoot(e=[],t={}){return{ngModule:_0e,providers:[Yg,GS,a0e,zS,iR,m8,g8,fR,f8,hR,Kg,US,ih,HS,L0,dR,...e,...ca.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:y0e,providers:[Yg,dR,...e,{provide:i8,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:s8,useValue:Tye},{provide:o8,useValue:Da},{provide:l8,useClass:t.executionStrategy||t8},{provide:n8,useValue:e},{provide:ca.ROOT_OPTIONS,useValue:t},{provide:Af,useFactory:ca.ngxsConfigFactory,deps:[ca.ROOT_OPTIONS]},{provide:Gw,useFactory:ca.appBootstrapListenerFactory,multi:!0,deps:[iR]},{provide:rR,useFactory:ca.getInitialState},{provide:Q4,useExisting:GS},{provide:Z4,useExisting:Yg}]}static ngxsConfigFactory(e){return aR(new Af,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return Mye.pop()}}function v0e(n){return i=>{!function(n){qS.subscribe(e=>{e&&(n.\u0275prov||console.warn(Ba.UNDECORATED_STATE_IN_IVY(n.name)))})}(i);const r=i,s=function(n){if(!n.hasOwnProperty(Wu)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,Wu,{value:e})}return F0(n)}(r),o=Object.getPrototypeOf(r),a=function(i){return Object.assign({},i[a8]||{},n)}(o);(function(i){const{meta:r,inheritedStateClass:s,optionsWithInheritance:o}=i,{children:a,defaults:l,name:c}=o,d="string"==typeof c?c:c&&c.getName()||null;$S.checkCorrectStateName(d),s.hasOwnProperty(Wu)&&(r.actions=Object.assign({},r.actions,(s[Wu]||{}).actions)),r.children=a,r.defaults=l,r.name=d})({meta:s,inheritedStateClass:o,optionsWithInheritance:a}),r[a8]=a}}ca.\u0275fac=function(e){return new(e||ca)},ca.\u0275mod=_n({type:ca}),ca.\u0275inj=Et({}),ca.ROOT_OPTIONS=new Vt("ROOT_OPTIONS"),new Zl(wE);try{BR="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){BR=!1}"undefined"!=typeof Element&&Element;function nH(n){Promise.resolve(null).then(n)}class tm{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){nH(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function rH(){return"undefined"!=typeof window&&void 0!==window.document}function GR(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let KR=(n,e)=>!1,YR=(n,e)=>!1,aH=(n,e,t)=>[];const lH=GR();(lH||"undefined"!=typeof Element)&&(KR=rH()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),YR=(()=>{if(lH||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):YR}})(),aH=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let Of=null,cH=!1;function XR(n){Of||(Of=("undefined"!=typeof document?document.body:null)||{},cH=!!Of.style&&"WebkitAppearance"in Of.style);let e=!0;return Of.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Of.style,!e&&cH&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Of.style)),e}const QR=YR,ZR=KR,JR=aH;let dH=(()=>{class n{validateStyleProperty(t){return XR(t)}matchesElement(t,i){return QR(t,i)}containsElement(t,i){return ZR(t,i)}query(t,i,r){return JR(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new tm(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class hx{}hx.NOOP=new dH;function gH(n,e,t){return t?e+":"+t+";":""}function mH(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=gH(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=gH(0,bve(t),n.style[t]));n.setAttribute("style",e)}function Zc(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=rN(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),GR()&&mH(n))}function Nf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=rN(t);n.style[i]=""}),GR()&&mH(n))}const yve=/-+([a-z0-9])/g;function rN(n){return n.replace(yve,(...e)=>e[1].toUpperCase())}function bve(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class rm{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=rm.initialStylesByElement.get(e);r||rm.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&Zc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Zc(this._element,this._initialStyles),this._endStyles&&(Zc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(rm.initialStylesByElement.delete(this._element),this._startStyles&&(Nf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Nf(this._element,this._endStyles),this._endStyles=null),Zc(this._element,this._initialStyles),this._state=3)}}rm.initialStylesByElement=new WeakMap;let Ff;try{Ff="undefined"!=typeof Intl}catch(n){Ff=!1}new class extends Zl{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends wE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let bEe=1;const vEe=Promise.resolve(),Px={};function f6(n){return n in Px&&(delete Px[n],!0)}const p6={setImmediate(n){const e=bEe++;return Px[e]=!0,vEe.then(()=>f6(e)&&n()),e},clearImmediate(n){f6(n)}};new class extends Zl{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends wE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=p6.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(p6.clearImmediate(t),e.scheduled=void 0)}});function Z0(n){return!!n&&(n instanceof I||"function"==typeof n.lift&&"function"==typeof n.subscribe)}function Lx(...n){return It(1)(cn(...n))}function Uo(...n){const e=n[n.length-1];return Se(e)?(n.pop(),t=>Lx(n,t,e)):t=>Lx(n,t)}function q6(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return t=>pe(function(n,e){return i=>{let r=i;for(let s=0;s<e;s++){const o=null!=r?r[n[s]]:void 0;if(void 0===o)return;r=o}return r}}(n,e))(t)}"undefined"!=typeof window&&window,tt(266);class K6 extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class gxe extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function Y6(n,e,t,i,r=new gxe(n,t,i)){if(!r.closed)return e instanceof I?e.subscribe(r):Ce(e)(r)}const X6={};function zo(...n){let e,t;return Se(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&L(n[0])&&(n=n[0]),In(n,t).lift(new Q6(e))}class Q6{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new mxe(e,this.resultSelector))}}class mxe extends K6{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(X6),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(Y6(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===X6?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function ib(n){return!0===n}function za(n){return null==n}function Ha(n){return!za(n)}function $N(n){return Boolean(n)}function HG(n){return za(n)?n:JSON.parse(JSON.stringify(n))}tt(478),Object.create(Error.prototype),new Vt("SECURITY_CONTEXT");const Jx=n=>{const t=n instanceof Date;if("object"!=typeof n||null===n||t)return n;Object.freeze(n);const r="function"==typeof n,s=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(o=>{s.call(n,o)&&(!r||"caller"!==o&&"callee"!==o&&"arguments"!==o)&&null!==n[o]&&("object"==typeof n[o]||"function"==typeof n[o])&&!Object.isFrozen(n[o])&&Jx(n[o])}),n};function GG(n){return Ha(n)&&"object"==typeof n&&function(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}const qG="NGXS_DATA_META",qN="NGXS_META",KG="NGXS_ARGUMENT_REGISTRY_META";let YG=(()=>{class n{constructor(t){this.sequence$=new Rr(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(Ie(ih,8))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();function rb(n){return n[qG]}let Ga=(()=>{class n{constructor(t,i,r){n.store=t.get(ih),n.ngZone=t.get(yn),n.factory=i,n.context=r,n.computed=t.get(YG)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(Ie($n),Ie(Z4),Ie(Q4))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();class cs{constructor(){cs.statesCachedMeta.clear()}static createStateContext(e){return Ga.context.createStateContext(e)}static ensureMappedState(e){if(za(Ga.factory)||za(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(Ha(e.name)?cs.statesCachedMeta.get(e.name):null)||cs.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=rb(cs.getStateClassByInstance(e)))&&void 0!==t?t:null;if(za(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=cs.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);Ha(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=cs.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=Ha(e.name)?null===(t=Ga.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return Ha(i)&&Ha(e.name)&&cs.statesCachedMeta.set(e.name,i),i}}cs.statesCachedMeta=new Map,cs.\u0275fac=function(e){return new(e||cs)},cs.\u0275prov=We({token:cs,factory:cs.\u0275fac}),new gg(1);class G1e extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${Ha(null==e?void 0:e.constructor)?e.constructor.name:e} to PlainObject`)}}function XG(n){var e;return null!==(e=n.NGXS_OPTIONS_META)&&void 0!==e?e:{name:""}}function QG(n){var e;const t=XG(n),i=null!==(e=t.children)&&void 0!==e?e:[],s=HG(void 0===t.defaults?{}:t.defaults);if(i.length){if(GG(s))return function(n,e){return e.reduce((t,i)=>{const r=XG(i);if(function(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=QG(i),t},null!=n?n:{})}(s,i);throw new G1e(s)}return s}function JG(n){var e;return null!==(e=n.__NGXS_COMPUTED_OPTION__)&&void 0!==e?e:null}function e$(){var n,e;return null!==(e=null===(n=null==Ga?void 0:Ga.computed)||void 0===n?void 0:n.sequenceValue)&&void 0!==e?e:0}function K1e(n){let e=!1;return Z0(n)&&(e=!0),e}function KN(n){return n[KG]}class Y1e extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class X1e{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){var t;return null!==(t=this.payloadMap.get(e))&&void 0!==t?t:null}getArgumentNameByIndex(e){var t;return null!==(t=this.argumentMap.get(e))&&void 0!==t?t:null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if($N(this.argumentMap.has(e))||$N(this.payloadMap.has(e)))throw new Y1e(e,t)}}function nAe(n){return{enumerable:!0,configurable:!0,get(){const e=rb(n),t=cs.ensureMappedState(e.stateMeta);return cs.createStateContext(t)}}}function t$(){return(n,e,t)=>{!function(n,e){if(!function(n,e){var t;let i=n,r=!1;if(GG(i))for(;null!==i;){if(ib(null==i?void 0:i.hasOwnProperty(e))){r=!!(null===(t=Object.getOwnPropertyDescriptor(i,e))||void 0===t?void 0:t.get);break}i=Object.getPrototypeOf(i)}return r}(n,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function(n){return za(JG(n))&&Object.defineProperties(n,{__NGXS_COMPUTED_OPTION__:{enumerable:!0,configurable:!0,value:new WeakMap}}),JG(n)}(this),o=null==s?void 0:s.get(i);if(ib(null==o?void 0:o.isObservable))return null==o?void 0:o.value;if(za(o)||o.sequenceId!==e$()){s.delete(i);const l=i.apply(this,r);return s.set(i,{value:l,sequenceId:e$(),isObservable:K1e(l)}),l}return o.value},t}}const lAe={cancelUncompleted:!0,insideZone:!1};function YN(n=lAe){return(e,t,i)=>{!function(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(e,i);const r=i.value,s=t.toString();return i.value=function(...o){const a=this;let l=null;const c=cs.getRepositoryByInstance(a),d=c.operations;let f=d[s];const p=c.stateMeta,g=KN(r);if(za(f)){const H=function(n){var e,t,i;return null!==(i=null===(t=null===(e=(n+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1))||void 0===e?void 0:e[0])||void 0===t?void 0:t.replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean))&&void 0!==i?i:[]}(r),me=function(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)Ha(null==r?void 0:r.getArgumentNameByIndex(o))?s+=null==r?void 0:r.getArgumentNameByIndex(o):Ha(null==r?void 0:r.getPayloadTypeByIndex(o))?s+=null==r?void 0:r.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replace(/\./g,"/")}.${i}(${s})`}({statePath:p.path,methodName:s,argumentsNames:H,argumentRegistry:g});f=d[s]={type:me,options:{cancelUncompleted:n.cancelUncompleted}},p.actions[f.type]=[{type:f.type,options:f.options,fn:f.type}]}cs.ensureMappedState(p).instance[f.type]=()=>{var H;return ib(n.insideZone)?null===(H=Ga.ngZone)||void 0===H||H.run(()=>{l=r.apply(a,o)}):l=r.apply(a,o),Z0(l)?cn(null).pipe(pe(()=>l)):l};const T=cs.createAction(f,o,g),W=Ga.store.dispatch(T);return Z0(l)?function(n,e){return P0([n,e]).pipe(pe(t=>t.pop()))}(W,l):l},i}}function n$(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function(n,e){const t=n[e];return za(KN(t))&&Object.defineProperties(t,{[KG]:{enumerable:!0,configurable:!0,value:new X1e}}),KN(t)})(e,t).createPayloadType(r,t,i)}}function uAe(){return n=>{const e=function(n){if(function(n){return!$N(n)}(n.hasOwnProperty(qN))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,qN,{value:e})}return function(n){var e;return null===(e=n)||void 0===e?void 0:e[qN]}(n)}(n);if(za(e.name))throw new Error("@StateRepository should be add before decorator @State");!function(n,e){(function(n){var e;const t=null!==(e=rb(n))&&void 0!==e?e:null;return(za(t)||(null==t?void 0:t.stateClass)!==n)&&function(n){Object.defineProperty(n,qG,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),rb(n)}(n)).stateMeta=e}(n,e),function(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>HG(t)},context:nAe(n)})}(n,e,QG(n)),function(n){var e,t;const i=rb(n),r=null!==(t=null===(e=null==i?void 0:i.stateMeta)||void 0===e?void 0:e.name)&&void 0!==t?t:null;if(Ha(r)){const s=`__${r}__selector`;Object.defineProperties(n.prototype,{[s]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(Ha(this[s]))return this[s];if(za(Ga.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[s]=Ga.store.select(n).pipe(pe(o=>Da()?Jx(o):o),ka({refCount:!0,bufferSize:1})),this[s]}}})}}(n)}}let hAe=(()=>{class n{constructor(){this.browserStorageEvents$=new oe,this.isInitialised=!1,this.isBootstrapped=!1,this._dirty=!0}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){var r;this.dirty&&this.isBootstrapped&&(this.dirty=!1,null===(r=this.ngxsDataDoCheck)||void 0===r||r.call(this))}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){var i;this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,null===(i=this.ngxsDataDoCheck)||void 0===i||i.call(this))}markAsDirtyAfterReset(){var i;this.dirty=!0,null===(i=this.ngxsDataAfterReset)||void 0===i||i.call(this)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})(),fAe=(()=>{class n extends hAe{get snapshot(){return function(n){return Da()?Jx(n):n}(this.getState())}get ctx(){return function(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},n),{getState:()=>Da()?Jx(n.getState()):n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}})}(this.context)}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Ia([t$(),Jl("design:type",Object),Jl("design:paramtypes",[])],n.prototype,"snapshot",null),Ia([YN(),Y3(0,n$("patchValue")),Jl("design:type",Function),Jl("design:paramtypes",[Object]),Jl("design:returntype",void 0)],n.prototype,"patchState",null),Ia([YN(),Y3(0,n$("stateValue")),Jl("design:type",Function),Jl("design:paramtypes",[Object]),Jl("design:returntype",void 0)],n.prototype,"setState",null),Ia([YN(),Jl("design:type",Function),Jl("design:paramtypes",[]),Jl("design:returntype",void 0)],n.prototype,"reset",null),n})();new Vt("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})});const bP=new Vt("ngx-window",{providedIn:"root",factory:()=>function(n){return function(n){return n===O3}(n)?window:null}(Ec(Rc))}),FMe=new Vt("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(Ec(bP))});new Vt("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(Ec(bP),Ec(FMe))}),new Vt("ngx-google-analytics-routing-settings",{factory:()=>({})}),new Vt("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"});const qMe=["bodyCanvas"];let KMe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new dn,this.nodeDrag=new dn,this.nodeClick=new dn,this.nodeHoverStart=new dn,this.nodeHoverStop=new dn,this.initialized=new dn,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return Ni(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new Sye({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))],this.initialized.emit()})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Sn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&Ds(qMe,5,Dn),2&t){let r;Oi(r=Ri())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&xu(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&function(n,e,t,i){Xt(n,e,t,i),Qt()}(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),YMe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({imports:[[Ws]]}),n})();new Vt("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10}),[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_54449"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7214"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7213"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name)).filter(n=>!0!==n.disabled);let pb=(()=>{let n=class extends fAe{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(qi(n=>null!=n),ka(1))}setConfig(t){this.setState(t)}patchConfig(t){this.patchState(t)}getProperty(t){return this.config$.pipe(q6(...t),$u(),ka(1))}getOption(...t){const i=this.getPathKey(t);if(this.optionCache.has(i))return this.optionCache.get(i);const r=this.config$.pipe(q6(...t),$u(),ka(1));return this.optionCache.set(i,r),r}getPathKey(t){return`${t.length}:${t.join(".")}`}};return n.\u0275fac=function(){let e;return function(i){return(e||(e=rr(n)))(i||n)}}(),n.\u0275prov=We({token:n,factory:n.\u0275fac}),Ia([t$()],n.prototype,"config$",null),n=Ia([uAe(),v0e({name:"globalConfig",defaults:null})],n),n})();!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}(),new oe;const _7="http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity",TDe=[173,255,47,229.5];var Fn=tt(440),RDe=tt(698),NDe=tt(445),PDe=tt.n(NDe),zr=tt(815),yC=tt(609);const Ai=Fn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},Fn.DataFactory),_m=(Ai("rdf"),Ai("rdf")("type"),{x:Ai("rdfs"),label:Ai("rdfs")("label"),comment:Ai("rdfs")("comment"),isDefinedBy:Ai("rdfs")("isDefinedBy"),seeAlso:Ai("rdfs")("seeAlso")}),so_label=(Ai("entity"),Ai("entity")("id"),_m.label),so_description=_m.comment,so_link=_m.seeAlso,so_providerName=(Ai("entity")("sex"),Ai("entity")("age"),Ai("entity")("bmi"),Fn.DataFactory.literal("Male"),Fn.DataFactory.literal("Female"),Ai("entity")("consortium_name"),Ai("entity")("provider_name")),so_donor=(Ai("entity")("provider_uuid"),Ai("entity")("has_donor")),so_sections=Ai("entity")("has_tissue_section"),so_datasets=Ai("entity")("has_dataset"),so_sampleType=Ai("entity")("sample_type"),so_sectionCount=(Fn.DataFactory.literal("Tissue Block"),Fn.DataFactory.literal("Tissue Section"),Fn.DataFactory.literal("Non-standard"),Ai("entity")("section_count")),so_sectionSize=Ai("entity")("section_size"),so_sectionUnits=Ai("entity")("section_units"),so_sectionNumber=Ai("entity")("section_number"),so_spatialEntity=Ai("entity")("has_spatial_entity"),so_technology=(Ai("entity")("has_ontology_term"),Ai("entity")("has_cell_type_term"),Ai("entity")("technology")),so_thumbnail=Ai("entity")("has_thumbnail"),xn=Ai("ccf"),EP={x:xn,ontologyNode:{label:xn("ccf_preferred_label"),parent:xn("ccf_part_of"),children:xn("ccf_part_of"),rui_rank:xn("ccf_rui_rank"),synonymLabels:Fn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:xn("ccf_part_of"),ct_is_a:xn("ct_is_a"),located_in:xn("located_in"),characterizes:xn("characterizes")},spatial:{Female:xn("VHFemale"),Male:xn("VHMale"),BothSexes:xn("VHBothSexes"),FemaleOrgans:xn("VHFemaleOrgans"),MaleOrgans:xn("VHMaleOrgans")},SpatialObjectReference:xn("SpatialObjectReference"),SpatialEntity:xn("SpatialEntity"),SpatialPlacement:xn("SpatialPlacement"),spatialObjectReference:{file:xn("has_object_file"),file_format:xn("has_object_file_format"),file_subpath:xn("has_object_file_subpath")},extractionSet:{label:_m.label,rui_rank:xn("ccf_rui_rank")},spatialEntity:{label:_m.label,comment:_m.comment,creator:Ai("dc")("creator"),creator_first_name:xn("creator_first_name"),creator_last_name:xn("creator_last_name"),creator_orcid:xn("creator_orcid"),creation_date:xn("creation_date"),updated_date:xn("updated_date"),ccf_annotations:xn("ccf_annotation"),representation_of:xn("ccf_representation_of"),reference_organ:xn("anatomical_structure_of"),extraction_set_for:xn("extraction_set_for"),extraction_set:xn("extraction_site_for"),sex:xn("has_sex"),side:xn("has_side"),rui_rank:xn("ccf_rui_rank"),slice_thickness:xn("ccf_slice_thickness"),slice_count:xn("ccf_slice_count"),x_dimension:xn("has_x_dimension"),y_dimension:xn("has_y_dimension"),z_dimension:xn("has_z_dimension"),dimension_units:xn("has_dimension_units"),object:xn("has_object_reference")},spatialPlacement:{source:xn("has_placement_source"),target:xn("has_placement_target"),placement_date:xn("has_placement_date"),x_scaling:xn("has_x_scaling"),y_scaling:xn("has_y_scaling"),z_scaling:xn("has_z_scaling"),scaling_units:xn("has_scaling_units"),x_rotation:xn("has_x_rotation"),y_rotation:xn("has_y_rotation"),z_rotation:xn("has_z_rotation"),w_rotation:xn("has_theta_rotation"),rotation_order:xn("has_rotation_order"),rotation_units:xn("has_rotation_units"),x_translation:xn("has_x_translation"),y_translation:xn("has_y_translation"),z_translation:xn("has_z_translation"),translation_units:xn("has_translation_units")}},oi={x:Ai("uberon"),body:Ai("uberon")("0013702")},LDe={x:Ai("cl"),cell:Ai("cl")("0000000")},gb={x:Ai("fma")},kDe=(Ai("lmha"),{body:oi.body,cell:LDe.cell,respiratory_system:oi.x("0001004"),colon:oi.x("0001155"),left_lung:oi.x("0002168"),right_lung:oi.x("0002167"),left_bronchus:oi.x("0002178"),right_bronchus:oi.x("0002177"),kidney:oi.x("0002113"),ureter:oi.x("0000056"),eye:oi.x("0000970"),fallopian_tube:oi.x("0003889"),knee:oi.x("0001465"),ovary:oi.x("0000992"),trachea:oi.x("0003126"),aorta:oi.x("0000947"),blood:oi.x("0000178"),bone_marrow:oi.x("0002371"),male_reproductive_system:oi.x("0000079"),lymph_node:oi.x("0000029"),blood_vasculature:oi.x("0004537"),brain:oi.x("0000955"),eye_left:oi.x("0004548"),eye_right:gb.x("54449"),fallopian_tube_left:oi.x("0001303"),fallopian_tube_right:oi.x("0001302"),heart:oi.x("0000948"),kidney_left:oi.x("0004538"),kidney_right:oi.x("0004539"),knee_left:gb.x("24978"),knee_right:gb.x("24977"),large_intestine:oi.x("0000059"),liver:oi.x("0002107"),lungs:oi.x("0002048"),mesenteric_lymph_node:oi.x("0002509"),ovary_left:gb.x("7214"),ovary_right:gb.x("7213"),pancreas:oi.x("0001264"),pelvis:oi.x("0001270"),prostate_gland:oi.x("0002367"),skin:oi.x("0002097"),small_intestine:oi.x("0002108"),spleen:oi.x("0002106"),thymus:oi.x("0002370"),ureter_left:oi.x("0001223"),ureter_right:oi.x("0001222"),urinary_bladder:oi.x("0001255"),uterus:oi.x("0000995")});function SP(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}SP(EP.spatialObjectReference),SP(EP.spatialEntity),SP(EP.spatialPlacement),new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),function(){const n={};Object.entries(kDe).forEach(([e,t])=>n[e]=t.id)}();const EC={[so_label.id]:"label",[so_description.id]:"description",[so_link.id]:"link"};Object.assign(Object.assign({},EC),{[so_providerName.id]:"providerName"}),Object.assign(Object.assign({},EC),{[so_technology.id]:"technology",[so_thumbnail.id]:"thumbnail"}),Object.assign(Object.assign({},EC),{[so_sampleType.id]:"sampleType",[so_sectionNumber.id]:"sectionNumber",[so_datasets.id]:"datasets"}),Object.assign(Object.assign({},EC),{[so_sampleType.id]:"sampleType",[so_sectionCount.id]:"sectionCount",[so_sectionSize.id]:"sectionSize",[so_sectionUnits.id]:"sectionUnits",[so_donor.id]:"donor",[so_spatialEntity.id]:"spatialEntityId",[so_sections.id]:"sections",[so_datasets.id]:"datasets"});const A7={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};function nu(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let CP;function uc(){return CP||(CP=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),nu(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),CP}function T7(n,e=uc()){return e("readonly",t=>nu(t.get(n)))}function*TP(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,Fn.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,yC.fromRdf)(s.object):s.object.id;yield[r,o]}}function vm(n,e,t,i){const r={"@id":e,"@type":t};for(const[s,o]of Object.entries(i))for(const a of(0,Fn.readQuads)(n,r["@id"],s,null,null)){const l="Literal"===a.object.termType?(0,yC.fromRdf)(a.object):a.object.id;r[o]=l}return r}const Ti=Fn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},Fn.DataFactory),M7={x:Ti("rdf"),type:Ti("rdf")("type")},wm={x:Ti("rdfs"),label:Ti("rdfs")("label"),comment:Ti("rdfs")("comment"),isDefinedBy:Ti("rdfs")("isDefinedBy"),seeAlso:Ti("rdfs")("seeAlso")},gi={x:Ti("entity"),id:Ti("entity")("id"),label:wm.label,description:wm.comment,link:wm.seeAlso,sex:Ti("entity")("sex"),age:Ti("entity")("age"),bmi:Ti("entity")("bmi"),Male:Fn.DataFactory.literal("Male"),Female:Fn.DataFactory.literal("Female"),consortiumName:Ti("entity")("consortium_name"),providerName:Ti("entity")("provider_name"),providerUUID:Ti("entity")("provider_uuid"),donor:Ti("entity")("has_donor"),sections:Ti("entity")("has_tissue_section"),datasets:Ti("entity")("has_dataset"),sampleType:Ti("entity")("sample_type"),TissueBlock:Fn.DataFactory.literal("Tissue Block"),TissueSection:Fn.DataFactory.literal("Tissue Section"),NonStandard:Fn.DataFactory.literal("Non-standard"),sectionCount:Ti("entity")("section_count"),sectionSize:Ti("entity")("section_size"),sectionUnits:Ti("entity")("section_units"),sectionNumber:Ti("entity")("section_number"),spatialEntity:Ti("entity")("has_spatial_entity"),ontologyTerms:Ti("entity")("has_ontology_term"),cellTypeTerms:Ti("entity")("has_cell_type_term"),technology:Ti("entity")("technology"),thumbnail:Ti("entity")("has_thumbnail")},Cn=Ti("ccf"),ar={x:Cn,ontologyNode:{label:Cn("ccf_preferred_label"),parent:Cn("ccf_part_of"),children:Cn("ccf_part_of"),rui_rank:Cn("ccf_rui_rank"),synonymLabels:Fn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:Cn("ccf_part_of"),ct_is_a:Cn("ct_is_a"),located_in:Cn("located_in"),characterizes:Cn("characterizes")},spatial:{Female:Cn("VHFemale"),Male:Cn("VHMale"),BothSexes:Cn("VHBothSexes"),FemaleOrgans:Cn("VHFemaleOrgans"),MaleOrgans:Cn("VHMaleOrgans")},SpatialObjectReference:Cn("SpatialObjectReference"),SpatialEntity:Cn("SpatialEntity"),SpatialPlacement:Cn("SpatialPlacement"),spatialObjectReference:{file:Cn("has_object_file"),file_format:Cn("has_object_file_format"),file_subpath:Cn("has_object_file_subpath")},extractionSet:{label:wm.label,rui_rank:Cn("ccf_rui_rank")},spatialEntity:{label:wm.label,comment:wm.comment,creator:Ti("dc")("creator"),creator_first_name:Cn("creator_first_name"),creator_last_name:Cn("creator_last_name"),creator_orcid:Cn("creator_orcid"),creation_date:Cn("creation_date"),updated_date:Cn("updated_date"),ccf_annotations:Cn("ccf_annotation"),representation_of:Cn("ccf_representation_of"),reference_organ:Cn("anatomical_structure_of"),extraction_set_for:Cn("extraction_set_for"),extraction_set:Cn("extraction_site_for"),sex:Cn("has_sex"),side:Cn("has_side"),rui_rank:Cn("ccf_rui_rank"),slice_thickness:Cn("ccf_slice_thickness"),slice_count:Cn("ccf_slice_count"),x_dimension:Cn("has_x_dimension"),y_dimension:Cn("has_y_dimension"),z_dimension:Cn("has_z_dimension"),dimension_units:Cn("has_dimension_units"),object:Cn("has_object_reference")},spatialPlacement:{source:Cn("has_placement_source"),target:Cn("has_placement_target"),placement_date:Cn("has_placement_date"),x_scaling:Cn("has_x_scaling"),y_scaling:Cn("has_y_scaling"),z_scaling:Cn("has_z_scaling"),scaling_units:Cn("has_scaling_units"),x_rotation:Cn("has_x_rotation"),y_rotation:Cn("has_y_rotation"),z_rotation:Cn("has_z_rotation"),w_rotation:Cn("has_theta_rotation"),rotation_order:Cn("has_rotation_order"),rotation_units:Cn("has_rotation_units"),x_translation:Cn("has_x_translation"),y_translation:Cn("has_y_translation"),z_translation:Cn("has_z_translation"),translation_units:Cn("has_translation_units")}},ai={x:Ti("uberon"),body:Ti("uberon")("0013702")},wIe={x:Ti("cl"),cell:Ti("cl")("0000000")},yb={x:Ti("fma")},iu=(Ti("lmha"),{body:ai.body,cell:wIe.cell,respiratory_system:ai.x("0001004"),colon:ai.x("0001155"),left_lung:ai.x("0002168"),right_lung:ai.x("0002167"),left_bronchus:ai.x("0002178"),right_bronchus:ai.x("0002177"),kidney:ai.x("0002113"),ureter:ai.x("0000056"),eye:ai.x("0000970"),fallopian_tube:ai.x("0003889"),knee:ai.x("0001465"),ovary:ai.x("0000992"),trachea:ai.x("0003126"),aorta:ai.x("0000947"),blood:ai.x("0000178"),bone_marrow:ai.x("0002371"),male_reproductive_system:ai.x("0000079"),lymph_node:ai.x("0000029"),blood_vasculature:ai.x("0004537"),brain:ai.x("0000955"),eye_left:ai.x("0004548"),eye_right:yb.x("54449"),fallopian_tube_left:ai.x("0001303"),fallopian_tube_right:ai.x("0001302"),heart:ai.x("0000948"),kidney_left:ai.x("0004538"),kidney_right:ai.x("0004539"),knee_left:yb.x("24978"),knee_right:yb.x("24977"),large_intestine:ai.x("0000059"),liver:ai.x("0002107"),lungs:ai.x("0002048"),mesenteric_lymph_node:ai.x("0002509"),ovary_left:yb.x("7214"),ovary_right:yb.x("7213"),pancreas:ai.x("0001264"),pelvis:ai.x("0001270"),prostate_gland:ai.x("0002367"),skin:ai.x("0002097"),small_intestine:ai.x("0002108"),spleen:ai.x("0002106"),thymus:ai.x("0002370"),ureter_left:ai.x("0001223"),ureter_right:ai.x("0001222"),urinary_bladder:ai.x("0001255"),uterus:ai.x("0000995")});function MP(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const SC={spatialObjectReference:MP(ar.spatialObjectReference),spatialEntity:MP(ar.spatialEntity),spatialPlacement:MP(ar.spatialPlacement)};function D7(n,e){const t=vm(n,e,"ExtractionSet",SC.spatialEntity);return t.extractionSites=(0,zr.sortBy)(n.getSubjects(ar.spatialEntity.extraction_set,e,null).map(i=>Gf(n,i.id)),["rui_rank"]),t}function Gf(n,e){const t=vm(n,e,"SpatialEntity",SC.spatialEntity);return t.object&&(t.object=function(n,e){return vm(n,e,"SpatialObjectReference",SC.spatialObjectReference)}(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,ar.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,gi.spatialEntity,e,null),t}function AIe(n,e){const t=vm(n,e,"SpatialPlacement",SC.spatialPlacement);return t.source&&(t.source=Gf(n,t.source)),t.target&&(t.target=Gf(n,t.target)),t}function MIe(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(GB),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class I7{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new RDe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},M7.type,ar.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},M7.type,ar.SpatialEntity,null);const t={};for(const i of(0,Fn.readQuads)(e,null,ar.spatialPlacement.source,null,null))t[i.subject.id]=i.object.id;for(const i of(0,Fn.readQuads)(e,null,ar.spatialPlacement.target,null,null)){const r=t[i.subject.id];r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement")}}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new qn(qn.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new qn(qn.IDENTITY),s=PDe()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s)o&&MIe(r,AIe(i,this.graph.getEdgeAttribute(a,o,"id"))),o=a;return r}}}class O7{constructor(e){this.db=e}getSpatialEntity(e){return Gf(this.db.store,e)}getExtractionSets(e){return function(n,e){return(0,zr.sortBy)(n.getSubjects(ar.spatialEntity.extraction_set_for,e,null).map(t=>D7(n,t.id)),["rui_rank"])}(this.db.store,e)}getExtractionSet(e){return D7(this.db.store,e)}getAnatomicalStructures(e){return function(n,e){return(0,zr.sortBy)(n.getSubjects(ar.spatialEntity.reference_organ,e,null).map(t=>Gf(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])}(this.db.store,e)}getReferenceOrgans(){return function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(Gf(n,t.subject.id))},null,ar.spatialEntity.reference_organ,null,null),(0,zr.sortBy)(e,["rui_rank"])}(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=ar.spatial.Male.id;break;case"Female":t=ar.spatial.Female.id;break;case"Both":default:t=ar.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e),i=[];let r=[...this.getReferenceOrganSets(e).map(s=>{const o="http://purl.obolibrary.org/obo/UBERON_0002097"===s.representation_of,a=this.getSceneNode(s,t,{color:[255,255,255,255],opacity:o?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!o});return o&&a?void i.push(a):a})];return i.length>0&&(r=[...i,...r]),(null==e?void 0:e.debug)&&(r=r.concat([this.getSceneNode(this.getSpatialEntity(ar.x("VHRightKidney").id),t,{color:[0,0,255,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(ar.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(ar.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(ar.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(ar.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],wireframe:!0})])),r.filter(s=>void 0!==s)}getReferenceOrganScene(e,t){var i,r;const s=null!==(i=void 0!==(null==t?void 0:t.sex))&&void 0!==i&&i,o=this.getReferenceOrgans().filter(a=>a.representation_of===e&&(!s||a.sex===(null==t?void 0:t.sex)));if(o.length>0){const a=o[0],c=this.getSceneNode(a,a,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===a.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),d=(null!==(r=this.db.getSpatialEntities(t))&&void 0!==r?r:[]).map(f=>this.getSceneNode(f,a,{color:[255,255,255,229.5]}));return[c].concat(d).filter(f=>void 0!==f)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let d=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(d){if(l)d=new qn(qn.IDENTITY).rotateX(GB(90)).multiplyLeft(d);else{let f;switch(e.dimension_units){case"centimeter":f=.01;break;case"millimeter":f=.001;break;case"meter":default:f=1}const p=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*f/2);d.scale(p)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:d,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const xC="https://entity.api.hubmapconsortium.org/entities/",R7=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),DIe={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},Em={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford","5c106f29-ea2d-11e9-85e8-0efb3ba9a670":"RTI-General Electric","301615f9-c870-11eb-a8dc-35ce3d8786fe":"TMC-UConn"},$t=function(){const n={};return Object.entries(iu).forEach(([e,t])=>n[e]=t.id),n}(),OIe={AO:[$t.body,$t.heart,$t.aorta],BL:[$t.body,$t.urinary_bladder],BD:[$t.body,$t.pelvis,$t.blood],BM:[$t.body,$t.pelvis,$t.bone_marrow],BR:[$t.body,$t.brain],LB:[$t.body,$t.respiratory_system,$t.lungs,$t.left_bronchus],RB:[$t.body,$t.respiratory_system,$t.lungs,$t.right_bronchus],LE:[$t.body,$t.eye,$t.eye_left],RE:[$t.body,$t.eye,$t.eye_right],LF:[$t.body,$t.fallopian_tube,$t.fallopian_tube_left],RF:[$t.body,$t.fallopian_tube,$t.fallopian_tube_right],HT:[$t.body,$t.heart],LK:[$t.body,$t.kidney,$t.kidney_left],RK:[$t.body,$t.kidney,$t.kidney_right],LI:[$t.body,$t.large_intestine,$t.colon],LV:[$t.body,$t.liver],LL:[$t.body,$t.respiratory_system,$t.lungs,$t.left_lung],LN:[$t.body,$t.knee,$t.knee_left],RL:[$t.body,$t.respiratory_system,$t.lungs,$t.right_lung],RN:[$t.body,$t.knee,$t.knee_right],LY:[$t.body,$t.lymph_node,$t.mesenteric_lymph_node],LO:[$t.body,$t.ovary,$t.ovary_left],RO:[$t.body,$t.ovary,$t.ovary_right],PA:[$t.body,$t.pancreas],PL:[$t.body],SI:[$t.body,$t.small_intestine],SK:[$t.body,$t.skin],SP:[$t.body,$t.spleen],ST:[$t.body],TH:[$t.body,$t.thymus],TR:[$t.body,$t.respiratory_system,$t.lungs,$t.trachea],UR:[$t.body,$t.ureter],UT:[$t.body,$t.uterus],OT:[$t.body]},N7={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},cellTypeTerms:{"@id":"has_cell_type_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class PIe{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],d=(this.data.ancestors||[]).find(Ge=>"Donor"===Ge.entity_type);this.donor=this.getDonor(d,i);const f=this.getRuiLocation(e,this.donor);f?this.rui_location=f:this.bad=!0,Em[e.group_uuid]||(Em[e.group_uuid]=e.group_name);const p=new Date(e.last_modified_timestamp).toLocaleDateString(),g=Em[e.group_uuid]||e.group_name,_=e.created_by_user_displayname;this["@id"]=xC+e.uuid,this.label=`Registered ${p}, ${_}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const C={},T=[];this.sections=T;const W=[];this.datasets=W;for(const Ge of c.filter(at=>"Sample"===at.entity_type)){const at=this.getSection(Ge,e,i);C[Ge.submission_id]=at,T.push(at),at.section_number=null!==(s=at.section_number)&&void 0!==s?s:T.length}for(const Ge of c)if("Dataset"===Ge.entity_type){const at=this.getDataset(Ge,t,i,r),St=(0,zr.get)(Ge,["ingest_metadata","metadata","tissue_id"]);C[St]?null===(o=C[St].datasets)||void 0===o||o.push(at):W.push(at)}const H=null!=f?f:{},me=`${H.x_dimension} x ${H.y_dimension} x ${H.z_dimension} ${H.dimension_units}`;this.section_count=H.slice_count||T.length;const Re=parseFloat((H.slice_thickness||(H.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=Re;const ze=H.dimension_units||"millimeter";this.section_units=ze,this.description=`${me}, ${Re} ${ze}, ${e.specimen_type}, ${this.section_count} Sections`,T.forEach((Ge,at)=>{Ge.description=`${H.x_dimension} x ${H.y_dimension} x ${Re} ${ze}, ${Re} ${ze}, ${Ge.description}`,Ge.section_number=at+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":xC+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${Em[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=Em[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,zr.get)(e,["ingest_metadata","metadata","assay_type"],"")],d=c.join("|").toLowerCase();let f,p="assets/icons/ico-unknown.svg";return-1!==d.indexOf("10x")?(f="10x",p="assets/icons/ico-bulk-10x.svg"):-1!==d.indexOf("af")?(f="AF",p="assets/icons/ico-spatial-af.svg"):-1!==d.indexOf("codex")?(f="CODEX",p="assets/icons/ico-spatial-codex.svg"):-1!==d.indexOf("imc")?(f="IMC",p="assets/icons/ico-spatial-imc.svg"):-1!==d.indexOf("lc")&&-1===d.indexOf("af")?(f="LC",p="assets/icons/ico-bulk-lc.svg"):f=-1!==d.indexOf("maldi")?"MALDI":-1!==d.indexOf("pas")?"PAS":"OTHER",p=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:p,{"@id":xC+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:f,thumbnail:p}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,zr.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>R7.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(R7.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=DIe[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,zr.toNumber)(s[1]));for(const p of(0,zr.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===p.preferred_term||"Female"===p.preferred_term?r="Female":"Masculine gender"===p.preferred_term||"Male"===p.preferred_term?r="Male":"Current chronological age"===p.preferred_term||"Age"===p.preferred_term?o=(0,zr.toNumber)(p.data_value):"Body mass index"===p.preferred_term&&(a=(0,zr.toNumber)(p.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),d=Em[e.group_uuid]||e.group_name;return{"@id":xC+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${d}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:d,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;const s=(e.ancestors||[]).find(c=>"Sample"===c.entity_type&&"organ"===c.specimen_type),o=OIe[null==s?void 0:s.organ]||[$t.body];let a,l=e.rui_location;if(l&&("string"==typeof l&&(l=JSON.parse(l)),l.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):l["@id"]&&(a=l)),a){a.ccf_annotations=o.concat(a.ccf_annotations||[]);const c=null!==(i=(0,zr.get)(a,["placement","target"]))&&void 0!==i?i:"";c.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")&&(0,zr.set)(a,["placement","target"],c.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")),("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===c||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===c)&&(0,zr.set)(a,["placement","target"],"Male"===t.sex?c.replace("#VH","#VHM")+"_Patch":c.replace("#VH","#VHF")+"_Patch")}return a}getTissueBlock(){return(0,zr.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}const LIe=["uuid","entity_type","group_uuid","group_name","last_modified_timestamp","created_by_user_displayname","ancestors","descendants","rui_location","specimen_type"],kIe={exists:{field:"rui_location"}};function P7(n,e,t){return JSON.stringify({version:!0,from:n,size:e,stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:kIe,_source:{includes:LIe}})}function DP(n,e){return Ni(this,void 0,void 0,function*(){try{const t=yield fetch(n,e);return t.ok?yield t.json():void 0}catch(t){return}})}function F7(n,e,t,i,r="",s=""){return Ni(this,void 0,void 0,function*(){let o;if("static"===e?o=yield DP(n):"search-api"===e&&(o=yield function(n,e,t){return Ni(this,void 0,void 0,function*(){const r=function(n){const e=new Headers;return e.append("Content-type","application/json"),n&&e.append("Authorization",`Bearer ${n}`),e}(e),s=P7(0,50,t),o=yield DP(n,{method:"POST",headers:r,body:s});if(!o)return;const a=o.hits.total.value;if(a<=50)return o;const l=[];for(let f=50;f<a;f+=50)l.push(DP(n,{method:"POST",headers:r,body:P7(f,50,t)}));const c=yield Promise.all(l);if(c.some(f=>!f))return;const d=c.map(f=>f.hits.hits);return Object.assign(Object.assign({},o),{hits:Object.assign(Object.assign({},o.hits),{hits:o.hits.hits.concat(...d)})})})}(n,i,t)),o)return function(n,e="",t="",i,r=!1){const o={},a=(0,zr.get)(n,"hits.hits",[]).map(c=>(0,zr.get)(c,"_source",{})).map(c=>new PIe(c,e,t,i).toJsonLd());for(const c of a){const d=c["@id"];o[d]?o[d].samples.push(c.samples[0]):o[d]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":N7},c)))),{"@context":N7,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function bb(n,e,t){const i=new Set;for(const r of e)for(const s of(0,Fn.readQuads)(n,r,t,null,null))i.add(s.object.id);return i}function CC(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const d of(0,Fn.readQuads)(n,c,gi.donor,null,null))o.add(d.object.id),s.has(d.object.id)?null===(i=s.get(d.object.id))||void 0===i||i.push(c):s.set(d.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const d of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(d);return l}function L7(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const d of(0,Fn.readQuads)(n,c,gi.spatialEntity,null,null))o.add(d.object.id),s.has(d.object.id)?null===(i=s.get(d.object.id))||void 0===i||i.push(c):s.set(d.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const d of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(d);return l}function vb(n,e){return function(t){n.has(t.id)&&e.add(t.id)}}function k7(n,e,t){const i=new Set;for(const r of t){const s=Fn.DataFactory.namedNode(r);n.forSubjects(vb(e,i),ar.spatialEntity.ccf_annotations,s,null)}return i}function B7(n,e){const t=function(n,e){const t=new Map;for(const i of n)for(const r of(0,Fn.readQuads)(e,i,gi.spatialEntity,null,null))t.has(r.object.id)?t.get(r.object.id).add(i):t.set(r.object.id,new Set([i]));return t}(n,e),i=new Map;for(const r of t.keys()){const s=t.get(r);for(const o of(0,Fn.readQuads)(e,r,ar.spatialEntity.ccf_annotations,null,null))if(i.has(o.object.id)){const a=i.get(o.object.id);s.forEach(l=>a.add(l))}else i.set(o.object.id,new Set(s))}return i}function nOe(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[ar.ontologyNode.label.id]:"label",[t]:"parent",[ar.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of TP(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}function j7(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,Fn.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=nOe(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,r}const AC={[gi.label.id]:"label",[gi.description.id]:"description",[gi.link.id]:"link"},sOe=Object.assign(Object.assign({},AC),{[gi.providerName.id]:"providerName"}),oOe=Object.assign(Object.assign({},AC),{[gi.technology.id]:"technology",[gi.thumbnail.id]:"thumbnail"}),aOe=Object.assign(Object.assign({},AC),{[gi.sampleType.id]:"sampleType",[gi.sectionNumber.id]:"sectionNumber",[gi.datasets.id]:"datasets"}),lOe=Object.assign(Object.assign({},AC),{[gi.sampleType.id]:"sampleType",[gi.sectionCount.id]:"sectionCount",[gi.sectionSize.id]:"sectionSize",[gi.sectionUnits.id]:"sectionUnits",[gi.donor.id]:"donor",[gi.spatialEntity.id]:"spatialEntityId",[gi.sections.id]:"sections",[gi.datasets.id]:"datasets"});function cOe(n,e){return vm(n,e,"Donor",sOe)}function V7(n,e){return vm(n,e,"Dataset",oOe)}function uOe(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};for(const[i,r]of TP(n,e,aOe))if("datasets"===i){const s=V7(n,r);t[i].push(s)}else t[i]=r;return t}class hOe{constructor(e){this.database=e,this.connect()}toJson(){return{status:this.status,message:this.message,checkback:"Ready"===this.status||"Error"===this.status?36e5:2e3,loadTime:this.loadTime}}connect(){this.status="Loading",this.message="Loading database";const e=Date.now();return this.database.connect().then(t=>Ni(this,void 0,void 0,function*(){t?(this.message="Building scene",yield this.database.getScene(),this.message="Building tissue block results",yield this.database.getTissueBlockResults(),this.message="Aggregating results",yield this.database.getAggregateResults(),this.status="Ready",this.message="Database successfully loaded"):(this.status="Error",this.message="Unknown error while loading database")})).catch(t=>{var i;this.status="Error",this.message=null!==(i=null==t?void 0:t.message)&&void 0!==i?i:"Unknown error while loading database"}).finally(()=>{this.loadTime=Date.now()-e})}}const fOe={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class pOe{constructor(e=fOe){this.options=e,this.store=new Fn.Store(void 0,{factory:Fn.DataFactory}),this.graph=new I7(this),this.scene=new O7(this)}connect(e,t=!1){return Ni(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return Ni(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield T7(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=uc()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),nu(t.transaction)))}([i,t]).catch(()=>{}):s=yield T7(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=uc()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),nu(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return Ni(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.startsWith("{"))this.store=(0,Fn.deserializeN3Store)(s,Fn.DataFactory);else if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,Fn.deserializeN3Store)(o,Fn.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(F7(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return Ni(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>Ni(this,void 0,void 0,function*(){"string"==typeof r?r.endsWith("jsonld")?yield(0,Fn.addJsonLdToStore)(r,i):r.endsWith("n3")?yield(0,Fn.addN3ToStore)(r,i):r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml")?yield(0,Fn.addRdfXmlToStore)(r,i):yield(0,Fn.addJsonLdToStore)(r,i):yield(0,Fn.addJsonLdToStore)(r,i)}))),this})}synchronize(){return Ni(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),this})}serialize(){return(0,Fn.serializeN3Store)(this.store)}deserialize(e){return Ni(this,void 0,void 0,function*(){this.store=(0,Fn.deserializeN3Store)(e,Fn.DataFactory),this.graph=new I7(this),this.scene=new O7(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e){var t,i,r,s,o,a;let l=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),gi.spatialEntity,null,null),e}(n);if(l.size>0&&(l=function(n,e,t=!0){const i=new Set;if(n.forSubjects(vb(e,i),gi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,l)),l.size>0&&("Male"===e.sex||"Female"===e.sex)){const c=e.sex;l=CC(n,l,d=>function(n,e,t){const i=new Set;return n.forSubjects(vb(e,i),gi.sex,gi[t],null),i}(n,d,c))}if(l.size>0&&(null===(t=e.tmc)||void 0===t?void 0:t.length)>0&&(l=CC(n,l,c=>function(n,e,t){const i=new Set;for(const r of t){const s=Fn.DataFactory.literal(r);n.forSubjects(vb(e,i),gi.providerName,s,null)}return i}(n,c,e.tmc))),l.size>0&&(null===(i=e.technologies)||void 0===i?void 0:i.length)>0&&(l=function(n,e,t){var i,r;const s=new Map,o=new Set,a=new Set(e);for(const d of e)for(const f of(0,Fn.readQuads)(n,d,gi.sections,null,null))a.add(f.object.id);for(const d of a)for(const f of(0,Fn.readQuads)(n,d,gi.datasets,null,null))o.add(f.object.id),s.has(f.object.id)?null===(i=s.get(f.object.id))||void 0===i||i.push(d):s.set(f.object.id,[d]);const l=t(o),c=new Set;for(const d of l)for(const f of null!==(r=s.get(d))&&void 0!==r?r:[])c.add(f);return c}(n,l,c=>function(n,e,t){const i=new Set;for(const r of t){const s=Fn.DataFactory.literal(r);n.forSubjects(vb(e,i),gi.technology,s,null)}return i}(n,c,e.technologies))),l.size>0&&(null===(r=e.ontologyTerms)||void 0===r?void 0:r.length)>0){const c=e.ontologyTerms;-1===c.indexOf(iu.body.id)&&(l=L7(n,l,d=>k7(n,d,c)))}if(l.size>0&&(null===(s=e.cellTypeTerms)||void 0===s?void 0:s.length)>0){const c=e.cellTypeTerms;-1===c.indexOf(iu.cell.id)&&(l=L7(n,l,d=>function(n,e,t){const i=new Set;for(const r of t)n.forObjects(s=>{i.add(s.id)},r,ar.asctb.located_in,null),r===iu.cell.id&&i.add(iu.body.id);return k7(n,e,[...i])}(n,d,c)))}if(l.size>0&&2===(null===(o=e.ageRange)||void 0===o?void 0:o.length)&&(0,zr.isFinite)(e.ageRange[0])&&(0,zr.isFinite)(e.ageRange[1])){const c=Math.max(...e.ageRange),d=Math.min(...e.ageRange);1===d&&110===c||(l=CC(n,l,f=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Fn.readQuads)(n,s,gi.age,null,null)){const a=(0,yC.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,f,d,c)))}if(l.size>0&&2===(null===(a=e.bmiRange)||void 0===a?void 0:a.length)&&(0,zr.isFinite)(e.bmiRange[0])&&(0,zr.isFinite)(e.bmiRange[1])){const c=Math.max(...e.bmiRange),d=Math.min(...e.bmiRange);13===d&&83===c||(l=CC(n,l,f=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Fn.readQuads)(n,s,gi.bmi,null,null)){const a=(0,yC.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,f,d,c)))}return l}(this.store,e)}get(e){return this.store.getQuads(Fn.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t=n.getObjects(Fn.DataFactory.namedNode(e),gi.spatialEntity,null);if(t.length>0)return Gf(n,t[0].id)}(this.store,t))}getDatabaseStatus(){return Ni(this,void 0,void 0,function*(){return this.status||(this.status=new hOe(this)),this.status.toJson()})}getDatasetTechnologyNames(){return Ni(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Fn.readQuads)(n,null,gi.technology,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getProviderNames(){return Ni(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Fn.readQuads)(n,null,gi.providerName,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getTissueBlockResults(e){return Ni(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};for(const[i,r]of TP(n,e,lOe))if("sections"===i){const s=uOe(n,r);t[i].push(s)}else if("datasets"===i){const s=V7(n,r);t[i].push(s)}else t[i]="donor"===i?cOe(n,r):r;return t}(this.store,t))})}getAggregateResults(e){return Ni(this,void 0,void 0,function*(){return function(n,e){const t=bb(e,n,gi.donor.id),i=bb(e,t,gi.providerUUID.id),r=new Set;for(const l of n)for(const c of(0,Fn.readQuads)(e,l,gi.spatialEntity,null,null))r.add(c.subject.id);const s=bb(e,r,gi.sections.id),o=new Set([...bb(e,r,gi.datasets.id),...bb(e,s,gi.datasets.id)]);return Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return Ni(this,void 0,void 0,function*(){return function(n,e){const t={};return B7(n,e).forEach((r,s)=>{t[s]=r.size}),t}(this.getIds(e),this.store)})}getCellTypeTermOccurences(e){return Ni(this,void 0,void 0,function*(){return function(n,e){var t,i;const r=B7(n,e),s=new Map;for(const a of r.keys()){const l=r.get(a);for(const c of(0,Fn.readQuads)(e,null,ar.asctb.located_in,a,null)){const d=c.subject.id;if(s.has(d)){const f=s.get(d);l.forEach(p=>f.add(p))}else s.set(d,new Set(l))}}const o={};return s.forEach((a,l)=>{o[l]=a.size}),o[iu.cell.id]=null!==(i=null===(t=r.get(iu.body.id))||void 0===t?void 0:t.size)&&void 0!==i?i:0,o}(this.getIds(e),this.store)})}getOntologyTreeModel(){return Ni(this,void 0,void 0,function*(){return function(n){const e=j7(n,iu.body.id,"body",ar.asctb.part_of.id);return e.nodes[iu.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e}(this.store)})}getCellTypeTreeModel(){return Ni(this,void 0,void 0,function*(){return function(n){return j7(n,iu.cell.id,"cell",ar.asctb.ct_is_a.id)}(this.store)})}getReferenceOrgans(){return Ni(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return Ni(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return Ni(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}}function mOe(n,e){return n===e}let _Oe=(()=>{class n{constructor(t,i){this.locator=t,this.globalConfig=i,this.subscriptions=new S,this.dataSource=i.getOption("data").pipe(pe(r=>Object.assign(Object.assign({},A7),{dataSources:r})),qi(r=>Object.keys(r).length>0),pe(r=>r),$u(mOe),xr(r=>function(n,e){return new I(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?ke(r):Pc).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDataSource(),s=>this.connectDataSource(s.source,r))),ka(1)),this.subscriptions.add(this.dataSource.subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}getTissueBlockResults(t){return this.dataSource.pipe(xr(i=>i.getTissueBlockResults(t)),zi(1))}getAggregateResults(t){return this.dataSource.pipe(xr(i=>i.getAggregateResults(t)),zi(1))}getOntologyTermOccurences(t){return this.dataSource.pipe(xr(i=>i.getOntologyTermOccurences(t)),zi(1))}getCellTypeTermOccurences(t){return this.dataSource.pipe(xr(i=>i.getCellTypeTermOccurences(t)),zi(1))}getOntologyTreeModel(){return this.dataSource.pipe(xr(t=>t.getOntologyTreeModel()),zi(1))}getCellTypeTreeModel(){return this.dataSource.pipe(xr(t=>t.getCellTypeTreeModel()),zi(1))}getReferenceOrgans(){return this.dataSource.pipe(xr(t=>t.getReferenceOrgans()),zi(1))}getScene(t){return this.dataSource.pipe(xr(i=>i.getScene(t)),zi(1))}getOrganScene(t,i){return this.dataSource.pipe(xr(r=>r.getReferenceOrganScene(t,i)),zi(1))}createDataSource(){return{source:new pOe,unsubscribe:()=>{}}}connectDataSource(t,i){return Ni(this,void 0,void 0,function*(){const r=(new Date).getTime();return yield t.connect(i,!1),Hy.production||(console.info(`Loaded CCF database in ${((new Date).getTime()-r)/1e3}s`),console.log(t)),t})}}return n.\u0275fac=function(t){return new(t||n)(Ie(lf),Ie(pb))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),yOe=(()=>{class n{constructor(t,i){this.configState=t,this.source=i,this.data$=this.configState.getOption("data"),this.zoomToID$=this.configState.getOption("zoomToID").pipe(pe(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.highlightID$=this.configState.getOption("highlightID").pipe(pe(r=>`http://purl.org/ccf/1.5/entity/${r}`)),this.referenceOrgans$=this.source.getReferenceOrgans(),this.scene$=zo([this.data$,this.referenceOrgans$,this.source.dataSource]).pipe(xr(([r,s,o])=>this.chooseScene(r,s))),this.organs$=this.configState.getOption("data").pipe(pe(r=>this.selectOrgans(r)),ka(1)),this.filteredOrgans$=zo([this.organs$,this.referenceOrgans$]).pipe(pe(([r,s])=>this.getNeededReferenceOrgans(s,r)),ka(1)),this.filteredScene$=zo([this.scene$,this.organs$,this.referenceOrgans$]).pipe(pe(([r,s,o])=>this.filterSceneNodes(r,s,o)),function(n,e){const t=n.pipe(Uo(""));return i=>zo([i,t]).pipe(pe(([r,s])=>r.map(o=>function(n,e,t){return n.entityId!==e?n:Object.assign(Object.assign({},n),{color:t})}(o,s,e))))}(this.highlightID$,TDe),function(n){const e=n.pipe(Uo(""));return t=>zo([t,e]).pipe(pe(([i,r])=>i.map(s=>function(n,e){return n.entityId!==e?n:Object.assign(Object.assign({},n),{zoomToOnLoad:!0})}(s,r))))}(this.zoomToID$),ka(1))}chooseScene(t,i){var r;const s=null!==(r=null==t?void 0:t.map(a=>{const l=a[_7];return null==l?void 0:l.placement.target}))&&void 0!==r?r:[];if(new Set(s).size>1)return this.source.getScene();if(i){const a=i.find(l=>l["@id"]===s[0]);if(a)return this.source.getOrganScene(a.representation_of,{ontologyTerms:[a.reference_organ],sex:a.sex})}return cn([])}selectOrgans(t){const r=(null!=t?t:[]).map(s=>s[_7].placement.target);return new Set(r)}filterSceneNodes(t,i,r){const s=this.getNeededReferenceOrgans(r,i),o=this.getNeededSkins(s),a=new Set([...i,...o]);return t.filter(c=>!c.reference_organ||a.has(c.reference_organ))}getNeededReferenceOrgans(t,i){return t.filter(r=>{var s;return i.has(null!==(s=r.reference_organ)&&void 0!==s?s:"")})}getNeededSkins(t){if(1===t.length)return[];const i=new Set;return t.forEach(r=>{"Female"===r.sex?i.add("http://purl.org/ccf/latest/ccf.owl#VHFSkin"):"Male"===r.sex&&i.add("http://purl.org/ccf/latest/ccf.owl#VHMSkin")}),[...i]}}return n.\u0275fac=function(t){return new(t||n)(Ie(pb),Ie(_Oe))},n.\u0275prov=We({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const bOe=["bodyUI"];let vOe=(()=>{class n{constructor(t,i,r){this.configState=t,this.sceneSource=i,this.cdr=r,this.onMouseEnter=new dn,this.onMouseLeave=new dn,this.onClick=new dn,this.data$=this.configState.getOption("data"),this.organs$=this.sceneSource.filteredOrgans$,this.scene$=this.sceneSource.filteredScene$.pipe(Jr(s=>this.reset()))}reset(){var t,i;return Ni(this,void 0,void 0,function*(){const{bodyUI:r}=this;yield new Promise(a=>setTimeout(a,200));const s=yield this.organs$.pipe(zi(1)).toPromise(),o=null!==(i=!!(null===(t=r.scene)||void 0===t?void 0:t.find(a=>a.zoomToOnLoad)))&&void 0!==i&&i;if(r.rotation=0,r.rotationX=0,!o)if(1===s.length){const{x_dimension:a,y_dimension:l,z_dimension:c}=s[0];r.bounds={x:1.25*a/1e3,y:1.25*l/1e3,z:1.25*c/1e3},r.target=[a/1e3/2,l/1e3/2,c/1e3/2]}else r.bounds={x:2.2,y:2,z:.4},r.target=[0,0,0];this.cdr.detectChanges()})}}return n.\u0275fac=function(t){return new(t||n)(Me(pb),Me(yOe),Me(rs))},n.\u0275cmp=Sn({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&Ds(bOe,7),2&t){let r;Oi(r=Ri())&&(i.bodyUI=r.first)}},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},decls:3,vars:4,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick","nodeHoverStart","nodeHoverStop"],["bodyUI",""]],template:function(t,i){1&t&&(Xt(0,"ccf-body-ui",0,1),fi("nodeClick",function(s){return i.onClick.emit(s)})("nodeHoverStart",function(s){return i.onMouseEnter.emit(s)})("nodeHoverStop",function(s){return i.onMouseLeave.emit(s)}),function(n,e){const t=_i();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Ze("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=pc(i.type)),o=fa(Me);try{const a=ip(!1),l=s();ip(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,Ft(),r,l)}finally{fa(o)}}(2,"async"),Qt()),2&t&&vn("scene",Dy(2,2,i.scene$))("interactive",!0)},directives:[KMe],pipes:[gE],styles:[".body-ui[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),n})();function wOe(n,e){if(1&n){const t=Ft();Xt(0,"ccf-root",1),fi("onMouseEnter",function(r){return Br(t),bi().onMouseEnter.emit(r)})("onMouseLeave",function(r){return Br(t),bi().onMouseLeave.emit(r)})("onClick",function(r){return Br(t),bi().onClick.emit(r)}),Qt()}}function EOe(n){return n.map(e=>({"@id":`http://purl.org/ccf/1.5/entity/${e.id}`,"@type":"http://purl.org/ccf/latest/ccf-entity.owl#Sample","http://purl.org/ccf/latest/ccf-entity.owl#has_spatial_entity":e.rui_location}))}let SOe=(()=>{class n extends Iee{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:Object.assign(Object.assign({},Hy.dbOptions),globalThis.dbOptions),parse:{data:EOe}}),this.onMouseEnter=new dn,this.onMouseLeave=new dn,this.onClick=new dn}}return n.\u0275fac=function(t){return new(t||n)(Me(pb),Me(rs))},n.\u0275cmp=Sn({type:n,selectors:[["ccf-root-wc"]],inputs:{data:"data",highlightID:"highlightID",zoomToID:"zoomToID"},outputs:{onMouseEnter:"onMouseEnter",onMouseLeave:"onMouseLeave",onClick:"onClick"},features:[Pn],decls:1,vars:1,consts:[[3,"onMouseEnter","onMouseLeave","onClick",4,"ngIf"],[3,"onMouseEnter","onMouseLeave","onClick"]],template:function(t,i){1&t&&function(n,e,t,i,r,s,o,a){const l=Ft(),c=_i(),d=n+20,f=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,d=Pd(e,n,4,o||null,ya(c,a));G_(e,t,d,ya(c,l)),Jf(e,d);const f=d.tViews=Pp(2,d,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,i,r,s,o):c.data[d];Xa(f,!1);const p=l[11].createComment("");Tp(c,l,p,f),Cs(p,l),Fp(l,l[d]=cw(p,l,p,f)),cd(f)&&Kh(c,l,f),null!=o&&H_(l,f,a)}(0,wOe,1,0,"ccf-root",0),2&t&&vn("ngIf",i.initialized)},directives:[Ou,vOe],encapsulation:2,changeDetection:0}),n})(),xOe=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[cs,Ga,YG,...t]}}}return n.\u0275fac=function(t){return new(t||n)(Ie(cs,2),Ie(Ga,2))},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({}),n})();const TC=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class TOe{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=Tf(this.action),i=function(n){return TC(n.getHours(),2)+":"+TC(n.getMinutes(),2)+":"+TC(n.getSeconds(),2)+"."+TC(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",Object.assign({},this.action)),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class MOe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch(i){console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch(e){this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,t,i)}isIE(){const e="undefined"!=typeof window&&window.navigator.userAgent?window.navigator.userAgent:"";let t=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(t=!0),t}}const U7=new Vt("NGXS_LOGGER_PLUGIN_OPTIONS");let DOe=(()=>{class n{constructor(t,i){this._options=t,this._injector=i}handle(t,i,r){if(this._options.disabled||!this._options.filter(i,t))return r(t,i);this._logWriter=this._logWriter||new MOe(this._options),this._store=this._store||this._injector.get(ih);const s=new TOe(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(Jr(o=>{s.completed(o)}),ac(o=>{throw s.errored(o),o}))}}return n.\u0275fac=function(t){return new(t||n)(Ie(U7),Ie($n))},n.\u0275prov=We({token:n,factory:n.\u0275fac}),n})();const z7=new Vt("LOGGER_USER_OPTIONS");function IOe(n){return Object.assign({},{logger:console,collapsed:!1,disabled:!1,filter:()=>!0},n)}let OOe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:r8,useClass:DOe,multi:!0},{provide:z7,useValue:t},{provide:U7,useFactory:IOe,deps:[z7]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({}),n})();const ROe=[pb];let NOe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({imports:[[xOe.forRoot(),ca.forRoot(ROe,{developmentMode:!Hy.production}),OOe.forRoot({disabled:Hy.production})]]}),n})(),POe=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(hl).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new xee(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends Aee{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,d){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(SOe,{injector:this.injector});customElements.define("ccf-body-ui-wc",t)}}return n.\u0275fac=function(t){return new(t||n)(Ie($n))},n.\u0275mod=_n({type:n}),n.\u0275inj=Et({providers:[],imports:[[ZM,NOe,YMe]]}),n})();Hy.production&&function(){if(Ok)throw new Error("Cannot enable prod mode after platform setup.");Ik=!1}(),qJ().bootstrapModule(POe).catch(n=>console.error(n))},52:kt=>{function nt(mt,J,At,dt,Y,Te,fe){try{var K=mt[Te](fe),V=K.value}catch(L){return void At(L)}K.done?J(V):Promise.resolve(V).then(dt,Y)}kt.exports=function(mt){return function(){var J=this,At=arguments;return new Promise(function(dt,Y){var Te=mt.apply(J,At);function fe(V){nt(Te,dt,Y,fe,K,"next",V)}function K(V){nt(Te,dt,Y,fe,K,"throw",V)}fe(void 0)})}},kt.exports.default=kt.exports,kt.exports.__esModule=!0},948:kt=>{kt.exports=function(tt){return tt&&tt.__esModule?tt:{default:tt}},kt.exports.default=kt.exports,kt.exports.__esModule=!0},321:kt=>{function nt(tt){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(kt.exports=nt=function(J){return typeof J},kt.exports.default=kt.exports,kt.exports.__esModule=!0):(kt.exports=nt=function(J){return J&&"function"==typeof Symbol&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},kt.exports.default=kt.exports,kt.exports.__esModule=!0),nt(tt)}kt.exports=nt,kt.exports.default=kt.exports,kt.exports.__esModule=!0},380:kt=>{function nt(tt){return Promise.resolve().then(()=>{var mt=new Error("Cannot find module '"+tt+"'");throw mt.code="MODULE_NOT_FOUND",mt})}nt.keys=()=>[],nt.resolve=nt,nt.id=380,kt.exports=nt},521:()=>{},125:()=>{},307:()=>{}},kt=>{kt(kt.s=595)}]);