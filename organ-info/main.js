(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:e=>{e.exports=function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){return i(t[s][1][e]||e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var o=void 0,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){!function(r,i){"object"==typeof n&&void 0!==t?i(n,e("jsonld"),e("n3"),e("rdfxml-streaming-parser"),e("readable-stream")):i((r="undefined"!=typeof globalThis?globalThis:r||self).tripleStoreUtils={},r.jsonld,r.n3,r.rdfxmlStreamingParser,r.readablestream)}(this,function(e,t,n,r,i){"use strict";function o(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(t){o(t)}}function a(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})}function s(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function a(e){var t=e.length,n=0;return new i.Readable({objectMode:!0,read:function(){this.push(n<t?e[n++]:null)}})}e.addJsonLdToStore=function(e,n){return o(this,void 0,void 0,function(){var r,i,o;return s(this,function(s){switch(s.label){case 0:return"string"!=typeof e?[3,4]:[4,fetch(e,{redirect:"follow"})];case 1:return(i=s.sent()).ok?[4,i.json()]:[3,3];case 2:r=s.sent(),s.label=3;case 3:return[3,5];case 4:r=e,s.label=5;case 5:return r?[4,t.toRDF(r)]:[3,7];case 6:o=s.sent(),n.import(a(o)),s.label=7;case 7:return[2,n]}})})},e.addN3ToStore=function(e,t){return o(this,void 0,void 0,function(){var r,i,o;return s(this,function(s){switch(s.label){case 0:return"string"==typeof e&&(null==e?void 0:e.startsWith("http"))?[4,fetch(e,{redirect:"follow"})]:[3,4];case 1:return(i=s.sent()).ok?[4,i.text()]:[3,3];case 2:r=s.sent(),s.label=3;case 3:return[3,5];case 4:r=e,s.label=5;case 5:return r&&(o=new n.Parser({format:"n3"}).parse(r),t.import(a(o))),[2,t]}})})},e.addRdfXmlToStore=function(e,t){return o(this,void 0,void 0,function(){var i,o,a,u;return s(this,function(s){switch(s.label){case 0:return"string"==typeof e&&(null==e?void 0:e.startsWith("http"))?[4,fetch(e,{redirect:"follow"})]:[3,4];case 1:return(o=s.sent()).ok?[4,o.text()]:[3,3];case 2:i=s.sent(),s.label=3;case 3:return[3,5];case 4:i=e,s.label=5;case 5:return i?(a=new r.RdfXmlParser({dataFactory:n.DataFactory,strict:!0}),u=new Promise(function(e){a.once("end",function(){return e(t)})}),t.import(a),a.write(i),a.end(),[2,u]):[2,t]}})})},e.arrayToStream=a,e.deserializeN3Store=function(e,t){var r=JSON.parse(e),i=new n.Store;return Object.assign(i,r,{_factory:null!=t?t:n.DataFactory}),i},e.serializeN3Store=function(e){var t=Object.assign({},e);return delete t._factory,JSON.stringify(t)},e.streamToArray=function(e){return new Promise(function(t,n){var r=[];e.on("data",function(e){r.push(e)}).once("end",function(){t(r)}).once("error",function(e){n(e)})})},Object.keys(n).forEach(function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}})}),Object.defineProperty(e,"__esModule",{value:!0})})},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(e,t,n){"use strict";n.byteLength=function(e){var t=c(e),n=t[1];return 3*(t[0]+n)/4-n},n.toByteArray=function(e){var t,n,r=c(e),s=r[0],a=r[1],u=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),l=0,h=a>0?s-4:s;for(n=0;n<h;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===a&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[l++]=255&t),1===a&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u},n.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=16383,a=0,u=n-i;a<u;a+=s)o.push(l(e,a,a+s>u?u:a+s));return 1===i?o.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&o.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i=[],o=t;o<n;o+=3)i.push(r[(s=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);var s;return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],3:[function(e,t,n){},{}],4:[function(e,t,n){var r=e("buffer"),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,n),n.Buffer=s),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},{buffer:6}],5:[function(e,t,n){"use strict";var r=e("safe-buffer").Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}n.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":4}],6:[function(e,t,n){(function(t){(function(){"use strict";var t=e("base64-js"),r=e("ieee754");n.Buffer=s,n.SlowBuffer=function(e){return+e!=e&&(e=0),s.alloc(+e)},n.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=s.prototype,t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|d(e,t),r=o(n),i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return l(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(B(e,ArrayBuffer)||e&&B(e.buffer,ArrayBuffer))return function(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n)).__proto__=s.prototype,r}(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return s.from(r,t,n);var i=function(e){if(s.isBuffer(e)){var t=0|h(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||z(e.length)?o(0):l(e):"Buffer"===e.type&&Array.isArray(e.data)?l(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return u(e),o(e<0?0:0|h(e))}function l(e){for(var t=e.length<0?0:0|h(e.length),n=o(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function d(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||B(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(e).length;default:if(i)return r?-1:N(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function p(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),z(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,i){var o,s=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,d=0;d<u;d++)if(c(e,o+d)!==c(t,d)){h=!1;break}if(h)return o}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(z(a))return s;e[n+s]=a}return s}function v(e,t,n,r){return F(N(t,e.length-n),e,n,r)}function b(e,t,n,r){return F(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function _(e,t,n,r){return b(e,t,n,r)}function w(e,t,n,r){return F(L(t),e,n,r)}function x(e,t,n,r){return F(function(e,t){for(var n,r,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i.push(n%256),i.push(r);return i}(t,e.length-n),e,n,r)}function E(e,n,r){return t.fromByteArray(0===n&&r===e.length?e:e.slice(n,r))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,u,c=e[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:s=e[i+2],128==(192&(o=e[i+1]))&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:s=e[i+2],a=e[i+3],128==(192&(o=e[i+1]))&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(r.push((l-=65536)>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(e){var t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=A));return n}(r)}n.kMaxLength=i,(s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(e,t,n){return a(e,t,n)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},s.allocUnsafe=function(e){return c(e)},s.allocUnsafeSlow=function(e){return c(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(B(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),B(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=s.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(B(o,Uint8Array)&&(o=s.from(o)),!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},s.prototype.toLocaleString=s.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):f.apply(this,arguments)},s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s.prototype.compare=function(e,t,n,r,i){if(B(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(o,a),c=this.slice(r,i),l=e.slice(t,n),h=0;h<u;++h)if(c[h]!==l[h]){o=c[h],a=l[h];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function k(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function O(e,t,n){var r,i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var o="",s=t;s<n;++s)o+=(r=e[s])<16?"0"+r.toString(16):r.toString(16);return o}function I(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function C(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(e,t,n,i,o){return t=+t,n>>>=0,o||j(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function M(e,t,n,i,o){return t=+t,n>>>=0,o||j(e,0,n,8),r.write(e,t,n,i,52,8),n+8}s.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=s.prototype,r},s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},s.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||C(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),r.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),r.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),r.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),r.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||D(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||D(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,n){return P(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return P(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return M(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return M(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var o=i-1;o>=0;--o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return i},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=s.isBuffer(e)?e:s.from(e,r),u=a.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=a[o%u]}return this};var R=/[^+/0-9A-Za-z-_]/g;function N(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function L(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(R,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function B(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function z(e){return e!=e}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(e,t,n){"use strict";t.exports=function e(t){return null===t||"object"!=typeof t||null!=t.toJSON?JSON.stringify(t):Array.isArray(t)?"["+t.reduce((t,n,r)=>t+(0===r?"":",")+e(void 0===n||"symbol"==typeof n?null:n),"")+"]":"{"+Object.keys(t).sort().reduce((n,r,i)=>void 0===t[r]||"symbol"==typeof t[r]?n:n+(0===n.length?"":",")+e(r)+":"+e(t[r]),"")+"}"}},{}],8:[function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,i)})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var i,o,s;if(c(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)o(u,this,t);else{var c=u.length,l=m(u,c);for(n=0;n<c;++n)o(l[n],this,t)}return!0},a.prototype.on=a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,f(this,e,t)),this},a.prototype.off=a.prototype.removeListener=function(e,t){var n,r,i,o,s;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},a.prototype.listenerCount=g,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},{}],9:[function(e,t,n){n.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=d,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=c}return(f?-1:1)*s*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*u-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+f]=255&s,f+=p,s/=256,c-=8);e[n+f-p]|=128*g}},{}],10:[function(e,t,n){t.exports="function"==typeof Object.create?function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},{}],11:[function(e,t,n){"use strict";const{isArray:r,isObject:i,isString:o}=e("./types"),{asArray:s}=e("./util"),{prependBase:a}=e("./url"),u=e("./JsonLdError"),c=e("./ResolvedContext");function l(e){throw new u("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:e})}function h({context:e,base:t}){if(!e)return;const n=e["@context"];if(o(n))e["@context"]=a(t,n);else if(r(n))for(let r=0;r<n.length;++r){const e=n[r];o(e)?n[r]=a(t,e):i(e)&&h({context:{"@context":e},base:t})}else if(i(n))for(const r in n)h({context:n[r],base:t})}t.exports=class{constructor({sharedCache:e}){this.perOpCache=new Map,this.sharedCache=e}async resolve({activeCtx:e,context:t,documentLoader:n,base:a,cycles:u=new Set}){t&&i(t)&&t["@context"]&&(t=t["@context"]),t=s(t);const h=[];for(const s of t){if(o(s)){let t=this._get(s);t||(t=await this._resolveRemoteContext({activeCtx:e,url:s,documentLoader:n,base:a,cycles:u})),r(t)?h.push(...t):h.push(t);continue}if(null===s){h.push(new c({document:null}));continue}i(s)||l(t);const d=JSON.stringify(s);let f=this._get(d);f||(f=new c({document:s}),this._cacheResolvedContext({key:d,resolved:f,tag:"static"})),h.push(f)}return h}_get(e){let t=this.perOpCache.get(e);if(!t){const n=this.sharedCache.get(e);n&&(t=n.get("static"),t&&this.perOpCache.set(e,t))}return t}_cacheResolvedContext({key:e,resolved:t,tag:n}){if(this.perOpCache.set(e,t),void 0!==n){let r=this.sharedCache.get(e);r||(r=new Map,this.sharedCache.set(e,r)),r.set(n,t)}return t}async _resolveRemoteContext({activeCtx:e,url:t,documentLoader:n,base:r,cycles:i}){t=a(r,t);const{context:o,remoteDoc:s}=await this._fetchContext({activeCtx:e,url:t,documentLoader:n,cycles:i});h({context:o,base:r=s.documentUrl||t});const u=await this.resolve({activeCtx:e,context:o,documentLoader:n,base:r,cycles:i});return this._cacheResolvedContext({key:t,resolved:u,tag:s.tag}),u}async _fetchContext({activeCtx:e,url:t,documentLoader:n,cycles:s}){if(s.size>10)throw new u("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"loading remote context failed":"context overflow",max:10});if(s.has(t))throw new u("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"recursive context inclusion":"context overflow",url:t});let a,c;s.add(t);try{c=await n(t),a=c.document||null,o(a)&&(a=JSON.parse(a))}catch(l){throw new u("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:t,cause:l})}if(!i(a))throw new u("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:t});return a="@context"in a?{"@context":a["@context"]}:{"@context":{}},c.contextUrl&&(r(a["@context"])||(a["@context"]=[a["@context"]]),a["@context"].push(c.contextUrl)),{context:a,remoteDoc:c}}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(e,t,n){"use strict";t.exports=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",n={}){super(e),this.name=t,this.message=e,this.details=n}}},{}],13:[function(e,t,n){"use strict";t.exports=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,n){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,n)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}},{}],14:[function(e,t,n){"use strict";t.exports=e("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(e,t,n){"use strict";t.exports=class{constructor(){this._requests={}}wrapLoader(e){const t=this;return t._loader=e,function(){return t.add.apply(t,arguments)}}async add(e){let t=this._requests[e];if(t)return Promise.resolve(t);t=this._requests[e]=this._loader(e);try{return await t}finally{delete this._requests[e]}}}},{}],16:[function(e,t,n){"use strict";const r=e("lru-cache");t.exports=class{constructor({document:e}){this.document=e,this.cache=new r({max:10})}getProcessed(e){return this.cache.get(e)}setProcessed(e,t){this.cache.set(e,t)}}},{"lru-cache":33}],17:[function(e,t,n){"use strict";const r=e("./JsonLdError"),{isArray:i,isObject:o,isString:s,isUndefined:a}=e("./types"),{isList:u,isValue:c,isGraph:l,isSimpleGraph:h,isSubjectReference:d}=e("./graphTypes"),{expandIri:f,getContextValue:p,isKeyword:g,process:m,processingMode:y}=e("./context"),{removeBase:v,prependBase:b}=e("./url"),{addValue:_,asArray:w,compareShortestLeast:x}=e("./util"),E={};function S(e,t,n){if("@nest"!==f(e,t,{vocab:!0},n))throw new r("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}t.exports=E,E.compact=async({activeCtx:e,activeProperty:t=null,element:n,options:f={},compactionMap:v=(()=>{})})=>{if(i(n)){let r=[];for(let i=0;i<n.length;++i){let o=await E.compact({activeCtx:e,activeProperty:t,element:n[i],options:f,compactionMap:v});null===o&&(o=await v({unmappedValue:n[i],activeCtx:e,activeProperty:t,parent:n,index:i,options:f}),void 0===o)||r.push(o)}return f.compactArrays&&1===r.length&&0===(p(e,t,"@container")||[]).length&&(r=r[0]),r}const b=p(e,t,"@context");if(a(b)||(e=await m({activeCtx:e,localCtx:b,propagate:!0,overrideProtected:!0,options:f})),o(n)){if(f.link&&"@id"in n&&f.link.hasOwnProperty(n["@id"])){const e=f.link[n["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===n)return e[t].compacted}if(c(n)||d(n)){const r=E.compactValue({activeCtx:e,activeProperty:t,value:n,options:f});return f.link&&d(n)&&(f.link.hasOwnProperty(n["@id"])||(f.link[n["@id"]]=[]),f.link[n["@id"]].push({expanded:n,compacted:r})),r}if(u(n)&&(p(e,t,"@container")||[]).includes("@list"))return E.compact({activeCtx:e,activeProperty:t,element:n["@list"],options:f,compactionMap:v});const b="@reverse"===t,x={},A=e;c(n)||d(n)||(e=e.revertToPreviousContext());const k=p(A,t,"@context");a(k)||(e=await m({activeCtx:e,localCtx:k,propagate:!0,overrideProtected:!0,options:f})),f.link&&"@id"in n&&(f.link.hasOwnProperty(n["@id"])||(f.link[n["@id"]]=[]),f.link[n["@id"]].push({expanded:n,compacted:x}));let T=n["@type"]||[];T.length>1&&(T=Array.from(T).sort());const O=e;for(const t of T){const n=E.compactIri({activeCtx:O,iri:t,relativeTo:{vocab:!0}}),r=p(A,n,"@context");a(r)||(e=await m({activeCtx:e,localCtx:r,options:f,propagate:!1}))}const I=Object.keys(n).sort();for(const a of I){const d=n[a];if("@id"!==a)if("@type"!==a)if("@reverse"!==a)if("@preserve"!==a)if("@index"!==a)if("@graph"!==a&&"@list"!==a&&"@included"!==a&&g(a)){const t=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});_(x,t,d)}else{if(!i(d))throw new r("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===d.length){const t=E.compactIri({activeCtx:e,iri:a,value:d,relativeTo:{vocab:!0},reverse:b}),n=e.mappings.has(t)?e.mappings.get(t)["@nest"]:null;let r=x;n&&(S(e,n,f),o(x[n])||(x[n]={}),r=x[n]),_(r,t,d,{propertyIsArray:!0})}for(const t of d){const n=E.compactIri({activeCtx:e,iri:a,value:t,relativeTo:{vocab:!0},reverse:b}),r=e.mappings.has(n)?e.mappings.get(n)["@nest"]:null;let d=x;r&&(S(e,r,f),o(x[r])||(x[r]={}),d=x[r]);const g=p(e,n,"@container")||[],m=l(t),y=u(t);let A;y?A=t["@list"]:m&&(A=t["@graph"]);let k=await E.compact({activeCtx:e,activeProperty:n,element:y||m?A:t,options:f,compactionMap:v});if(y){if(i(k)||(k=[k]),g.includes("@list")){_(d,n,k,{valueIsArray:!0,allowDuplicate:!0});continue}k={[E.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:k},"@index"in t&&(k[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"])}if(m)if(g.includes("@graph")&&(g.includes("@id")||g.includes("@index")&&h(t))){let r;d.hasOwnProperty(n)?r=d[n]:d[n]=r={};const i=(g.includes("@id")?t["@id"]:t["@index"])||E.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}});_(r,i,k,{propertyIsArray:!f.compactArrays||g.includes("@set")})}else g.includes("@graph")&&h(t)?(i(k)&&k.length>1&&(k={"@included":k}),_(d,n,k,{propertyIsArray:!f.compactArrays||g.includes("@set")})):(i(k)&&1===k.length&&f.compactArrays&&(k=k[0]),k={[E.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:k},"@id"in t&&(k[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t["@id"]),"@index"in t&&(k[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]),_(d,n,k,{propertyIsArray:!f.compactArrays||g.includes("@set")}));else if(g.includes("@language")||g.includes("@index")||g.includes("@id")||g.includes("@type")){let r,i;if(d.hasOwnProperty(n)?r=d[n]:d[n]=r={},g.includes("@language"))c(k)&&(k=k["@value"]),i=t["@language"];else if(g.includes("@index")){const r=p(e,n,"@index")||"@index",o=E.compactIri({activeCtx:e,iri:r,relativeTo:{vocab:!0}});if("@index"===r)i=t["@index"],delete k[o];else{let e;if([i,...e]=w(k[r]||[]),s(i))switch(e.length){case 0:delete k[r];break;case 1:k[r]=e[0];break;default:k[r]=e}else i=null}}else if(g.includes("@id")){const t=E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});i=k[t],delete k[t]}else if(g.includes("@type")){const r=E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}});let o;switch([i,...o]=w(k[r]||[]),o.length){case 0:delete k[r];break;case 1:k[r]=o[0];break;default:k[r]=o}1===Object.keys(k).length&&"@id"in t&&(k=await E.compact({activeCtx:e,activeProperty:n,element:{"@id":t["@id"]},options:f,compactionMap:v}))}i||(i=E.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}})),_(r,i,k,{propertyIsArray:g.includes("@set")})}else{const e=!f.compactArrays||g.includes("@set")||g.includes("@list")||i(k)&&0===k.length||"@list"===a||"@graph"===a;_(d,n,k,{propertyIsArray:e})}}}else{if((p(e,t,"@container")||[]).includes("@index"))continue;const n=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});_(x,n,d)}else{const n=await E.compact({activeCtx:e,activeProperty:t,element:d,options:f,compactionMap:v});i(n)&&0===n.length||_(x,a,n)}else{const t=await E.compact({activeCtx:e,activeProperty:"@reverse",element:d,options:f,compactionMap:v});for(const n in t)if(e.mappings.has(n)&&e.mappings.get(n).reverse){const r=t[n],i=(p(e,n,"@container")||[]).includes("@set")||!f.compactArrays;_(x,n,r,{propertyIsArray:i}),delete t[n]}if(Object.keys(t).length>0){const n=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});_(x,n,t)}}else{let t=w(d).map(e=>E.compactIri({activeCtx:A,iri:e,relativeTo:{vocab:!0}}));1===t.length&&(t=t[0]);const n=E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}}),r=(p(e,n,"@container")||[]).includes("@set")&&y(e,1.1)||i(t)&&0===d.length;_(x,n,t,{propertyIsArray:r})}else{let t=w(d).map(t=>E.compactIri({activeCtx:e,iri:t,relativeTo:{vocab:!1},base:f.base}));1===t.length&&(t=t[0]),x[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t}}return x}return n},E.compactIri=({activeCtx:e,iri:t,value:n=null,relativeTo:i={vocab:!1},reverse:s=!1,base:a=null})=>{if(null===t)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const h=e.getInverse();if(g(t)&&t in h&&"@none"in h[t]&&"@type"in h[t]["@none"]&&"@none"in h[t]["@none"]["@type"])return h[t]["@none"]["@type"]["@none"];if(i.vocab&&t in h){const r=e["@language"]||"@none",i=[];o(n)&&"@index"in n&&!("@graph"in n)&&i.push("@index","@index@set"),o(n)&&"@preserve"in n&&(n=n["@preserve"][0]),l(n)?("@index"in n&&i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n&&i.push("@graph@id","@graph@id@set"),i.push("@graph","@graph@set","@set"),"@index"in n||i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n||i.push("@graph@id","@graph@id@set")):o(n)&&!c(n)&&i.push("@id","@id@set","@type","@set@type");let a="@language",h="@null";if(s)a="@type",h="@reverse",i.push("@set");else if(u(n)){"@index"in n||i.push("@list");const e=n["@list"];if(0===e.length)a="@any",h="@none";else{let t=0===e.length?r:null,n=null;for(let r=0;r<e.length;++r){const i=e[r];let o="@none",s="@none";if(c(i)?"@direction"in i?o=`${(i["@language"]||"").toLowerCase()}_${i["@direction"]}`:"@language"in i?o=i["@language"].toLowerCase():"@type"in i?s=i["@type"]:o="@null":s="@id",null===t?t=o:o!==t&&c(i)&&(t="@none"),null===n?n=s:s!==n&&(n="@none"),"@none"===t&&"@none"===n)break}t=t||"@none",n=n||"@none","@none"!==n?(a="@type",h=n):h=t}}else{if(c(n))if("@language"in n&&!("@index"in n)){i.push("@language","@language@set"),h=n["@language"];const e=n["@direction"];e&&(h=`${h}_${e}`)}else"@direction"in n&&!("@index"in n)?h=`_${n["@direction"]}`:"@type"in n&&(a="@type",h=n["@type"]);else a="@type",h="@id";i.push("@set")}i.push("@none"),o(n)&&!("@index"in n)&&i.push("@index","@index@set"),c(n)&&1===Object.keys(n).length&&i.push("@language","@language@set");const d=function(e,t,n,r,i,s){null===s&&(s="@null");const a=[];if(("@id"===s||"@reverse"===s)&&o(n)&&"@id"in n){"@reverse"===s&&a.push("@reverse");const t=E.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===n["@id"]?a.push.apply(a,["@vocab","@id"]):a.push.apply(a,["@id","@vocab"])}else{a.push(s);const e=a.find(e=>e.includes("_"));e&&a.push(e.replace(/^[^_]+_/,"_"))}a.push("@none");const u=e.inverse[t];for(const o of r){if(!(o in u))continue;const e=u[o][i];for(const t of a)if(t in e)return e[t]}return null}(e,t,n,i,a,h);if(null!==d)return d}if(i.vocab&&"@vocab"in e){const n=e["@vocab"];if(0===t.indexOf(n)&&t!==n){const r=t.substr(n.length);if(!e.mappings.has(r))return r}}let d=null;const f=[];let p=e.fastCurieMap;const m=t.length-1;for(let r=0;r<m&&t[r]in p;++r)p=p[t[r]],""in p&&f.push(p[""][0]);for(let r=f.length-1;r>=0;--r){const i=f[r],o=i.terms;for(const r of o){const o=r+":"+t.substr(i.iri.length);e.mappings.get(r)._prefix&&(!e.mappings.has(o)||null===n&&e.mappings.get(o)["@id"]===t)&&(null===d||x(o,d)<0)&&(d=o)}}if(null!==d)return d;for(const[o,u]of e.mappings)if(u&&u._prefix&&t.startsWith(o+":"))throw new r(`Absolute IRI "${t}" confused with prefix "${o}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:e});return i.vocab?t:"@base"in e?e["@base"]?v(b(a,e["@base"]),t):t:v(a,t)},E.compactValue=({activeCtx:e,activeProperty:t,value:n,options:r})=>{if(c(n)){const r=p(e,t,"@type"),i=p(e,t,"@language"),o=p(e,t,"@direction"),a=p(e,t,"@container")||[],u="@index"in n&&!a.includes("@index");if(!u&&"@none"!==r){if(n["@type"]===r)return n["@value"];if("@language"in n&&n["@language"]===i&&"@direction"in n&&n["@direction"]===o)return n["@value"];if("@language"in n&&n["@language"]===i)return n["@value"];if("@direction"in n&&n["@direction"]===o)return n["@value"]}const c=Object.keys(n).length,l=1===c||2===c&&"@index"in n&&!u,h="@language"in e,d=s(n["@value"]),f=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(l&&"@none"!==r&&(!h||!d||f))return n["@value"];const g={};return u&&(g[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=n["@index"]),"@type"in n?g[E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:e,iri:n["@type"],relativeTo:{vocab:!0}}):"@language"in n&&(g[E.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=n["@language"]),"@direction"in n&&(g[E.compactIri({activeCtx:e,iri:"@direction",relativeTo:{vocab:!0}})]=n["@direction"]),g[E.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=n["@value"],g}const i=f(e,t,{vocab:!0},r),o=p(e,t,"@type"),a=E.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:"@vocab"===o},base:r.base});return"@id"===o||"@vocab"===o||"@graph"===i?a:{[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:a}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(e,t,n){"use strict";const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#";t.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:r,RDF_LIST:r+"List",RDF_FIRST:r+"first",RDF_REST:r+"rest",RDF_NIL:r+"nil",RDF_TYPE:r+"type",RDF_PLAIN_LITERAL:r+"PlainLiteral",RDF_XML_LITERAL:r+"XMLLiteral",RDF_JSON_LITERAL:r+"JSON",RDF_OBJECT:r+"object",RDF_LANGSTRING:r+"langString",XSD:i,XSD_BOOLEAN:i+"boolean",XSD_DOUBLE:i+"double",XSD_INTEGER:i+"integer",XSD_STRING:i+"string"}},{}],19:[function(e,t,n){"use strict";const r=e("./util"),i=e("./JsonLdError"),{isArray:o,isObject:s,isString:a,isUndefined:u}=e("./types"),{isAbsolute:c,isRelative:l,prependBase:h}=e("./url"),{asArray:d,compareShortestLeast:f}=e("./util"),p=new Map,g=/^@[a-zA-Z]+$/,m={};function y(e,t,n,r,i,o){if(null===t||!a(t)||m.isKeyword(t))return t;if(t.match(g))return null;if(r&&r.hasOwnProperty(t)&&!0!==i.get(t)&&m.createTermDefinition({activeCtx:e,localCtx:r,term:t,defined:i,options:o}),(n=n||{}).vocab){const n=e.mappings.get(t);if(null===n)return null;if(s(n)&&"@id"in n)return n["@id"]}const u=t.indexOf(":");if(u>0){const n=t.substr(0,u),s=t.substr(u+1);if("_"===n||0===s.indexOf("//"))return t;r&&r.hasOwnProperty(n)&&m.createTermDefinition({activeCtx:e,localCtx:r,term:n,defined:i,options:o});const a=e.mappings.get(n);if(a&&a._prefix)return a["@id"]+s;if(c(t))return t}if(n.vocab&&"@vocab"in e)return e["@vocab"]+t;if(n.base&&"@base"in e){if(e["@base"])return h(h(o.base,e["@base"]),t)}else if(n.base)return h(o.base,t);return t}function v(e,t){if(!e||"object"!=typeof e||!t||"object"!=typeof t)return e===t;const n=Array.isArray(e);if(n!==Array.isArray(t))return!1;if(n){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!v(e[n],t[n]))return!1;return!0}const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const o in e){let n=e[o],r=t[o];if("@container"===o&&Array.isArray(n)&&Array.isArray(r)&&(n=n.slice().sort(),r=r.slice().sort()),!v(n,r))return!1}return!0}t.exports=m,m.process=async({activeCtx:e,localCtx:t,options:n,propagate:u=!0,overrideProtected:f=!1,cycles:p=new Set})=>{if(s(t)&&"@context"in t&&o(t["@context"])&&(t=t["@context"]),0===d(t).length)return e;const g=await n.contextResolver.resolve({activeCtx:e,context:t,documentLoader:n.documentLoader,base:n.base});s(g[0].document)&&"boolean"==typeof g[0].document["@propagate"]&&(u=g[0].document["@propagate"]);let v=e;u||v.previousContext||(v=v.clone(),v.previousContext=e);for(const o of g){let{document:u}=o;if(e=v,null===u){if(!f&&0!==Object.keys(e.protected).length){const s=n&&n.protectedMode||"error";if("error"===s)throw new i("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===s){console.warn("WARNING: invalid context nullification");const t=o.getProcessed(e);if(t){v=e=t;continue}const i=e;v=e=m.getInitialContext(n).clone();for(const[n,o]of Object.entries(i.protected))o&&(e.mappings[n]=r.clone(i.mappings[n]));e.protected=r.clone(i.protected),o.setProcessed(i,v);continue}throw new i("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,protectedMode:s})}v=e=m.getInitialContext(n).clone();continue}const d=o.getProcessed(e);if(d){v=e=d;continue}if(s(u)&&"@context"in u&&(u=u["@context"]),!s(u))throw new i("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:u});v=v.clone();const g=new Map;if("@version"in u){if(1.1!==u["@version"])throw new i("Unsupported JSON-LD version: "+u["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:u});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new i("@version: "+u["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:u});v.processingMode="json-ld-1.1",v["@version"]=u["@version"],g.set("@version",!0)}if(v.processingMode=v.processingMode||e.processingMode,"@base"in u){let e=u["@base"];if(null===e||c(e));else{if(!l(e))throw new i('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:u});e=h(v["@base"],e)}v["@base"]=e,g.set("@base",!0)}if("@vocab"in u){const e=u["@vocab"];if(null===e)delete v["@vocab"];else{if(!a(e))throw new i('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:u});if(!c(e)&&m.processingMode(v,1))throw new i('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:u});v["@vocab"]=y(v,e,{vocab:!0,base:!0},void 0,void 0,n)}g.set("@vocab",!0)}if("@language"in u){const e=u["@language"];if(null===e)delete v["@language"];else{if(!a(e))throw new i('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:u});v["@language"]=e.toLowerCase()}g.set("@language",!0)}if("@direction"in u){const t=u["@direction"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @direction not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:u});if(null===t)delete v["@direction"];else{if("ltr"!==t&&"rtl"!==t)throw new i('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:u});v["@direction"]=t}g.set("@direction",!0)}if("@propagate"in u){const n=u["@propagate"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @propagate not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:u});if("boolean"!=typeof n)throw new i("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:t});g.set("@propagate",!0)}if("@import"in u){const r=u["@import"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @import not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:u});if(!a(r))throw new i("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:t});const o=await n.contextResolver.resolve({activeCtx:e,context:r,documentLoader:n.documentLoader,base:n.base});if(1!==o.length)throw new i("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:t});const s=o[0].getProcessed(e);if(s)u=s;else{const n=o[0].document;if("@import"in n)throw new i("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:t});for(const e in n)u.hasOwnProperty(e)||(u[e]=n[e]);o[0].setProcessed(e,u)}g.set("@import",!0)}g.set("@protected",u["@protected"]||!1);for(const e in u)if(m.createTermDefinition({activeCtx:v,localCtx:u,term:e,defined:g,options:n,overrideProtected:f}),s(u[e])&&"@context"in u[e]){const t=u[e]["@context"];let r=!0;if(a(t)){const e=h(n.base,t);p.has(e)?r=!1:p.add(e)}if(r)try{await m.process({activeCtx:v.clone(),localCtx:u[e]["@context"],overrideProtected:!0,options:n,cycles:p})}catch(b){throw new i("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:u[e]["@context"],term:e})}}o.setProcessed(e,v)}return v},m.createTermDefinition=({activeCtx:e,localCtx:t,term:n,defined:r,options:u,overrideProtected:l=!1})=>{if(r.has(n)){if(r.get(n))return;throw new i("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:n})}let h;if(r.set(n,!1),t.hasOwnProperty(n)&&(h=t[n]),"@type"===n&&s(h)&&"@set"===(h["@container"]||"@set")&&m.processingMode(e,1.1)){const e=["@container","@id","@protected"],r=Object.keys(h);if(0===r.length||r.some(t=>!e.includes(t)))throw new i("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n})}else{if(m.isKeyword(n))throw new i("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n});if(n.match(g))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:n});if(""===n)throw new i("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t})}const d=e.mappings.get(n);e.mappings.has(n)&&e.mappings.delete(n);let f=!1;if((a(h)||null===h)&&(f=!0,h={"@id":h}),!s(h))throw new i("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const p={};e.mappings.set(n,p),p.reverse=!1;const b=["@container","@id","@language","@reverse","@type"];m.processingMode(e,1.1)&&b.push("@context","@direction","@index","@nest","@prefix","@protected");for(const o in h)if(!b.includes(o))throw new i("Invalid JSON-LD syntax; a term definition must not contain "+o,"jsonld.SyntaxError",{code:"invalid term definition",context:t});const _=n.indexOf(":");if(p._termHasColon=_>0,"@reverse"in h){if("@id"in h)throw new i("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in h)throw new i("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});const o=h["@reverse"];if(!a(o))throw new i("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(!m.isKeyword(o)&&o.match(g))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:o}),void(d?e.mappings.set(n,d):e.mappings.delete(n));const s=y(e,o,{vocab:!0,base:!1},t,r,u);if(!c(s))throw new i("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});p["@id"]=s,p.reverse=!0}else if("@id"in h){let o=h["@id"];if(o&&!a(o))throw new i("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(null===o)p["@id"]=null;else{if(!m.isKeyword(o)&&o.match(g))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:o}),void(d?e.mappings.set(n,d):e.mappings.delete(n));if(o!==n){if(o=y(e,o,{vocab:!0,base:!1},t,r,u),!c(o)&&!m.isKeyword(o))throw new i("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(n.match(/(?::[^:])|\//)&&y(e,n,{vocab:!0,base:!1},t,new Map(r).set(n,!0),u)!==o)throw new i("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});p["@id"]=o,p._prefix=f&&!p._termHasColon&&o.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in p))if(p._termHasColon){const i=n.substr(0,_);if(t.hasOwnProperty(i)&&m.createTermDefinition({activeCtx:e,localCtx:t,term:i,defined:r,options:u}),e.mappings.has(i)){const t=n.substr(_+1);p["@id"]=e.mappings.get(i)["@id"]+t}else p["@id"]=n}else if("@type"===n)p["@id"]=n;else{if(!("@vocab"in e))throw new i("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:n});p["@id"]=e["@vocab"]+n}if((!0===h["@protected"]||!0===r.get("@protected")&&!1!==h["@protected"])&&(e.protected[n]=!0,p.protected=!0),r.set(n,!0),"@type"in h){let n=h["@type"];if(!a(n))throw new i("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@json"===n||"@none"===n){if(m.processingMode(e,1))throw new i(`Invalid JSON-LD syntax; an @context @type value must not be "${n}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else if("@id"!==n&&"@vocab"!==n){if(n=y(e,n,{vocab:!0,base:!1},t,r,u),!c(n))throw new i("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===n.indexOf("_:"))throw new i("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}p["@type"]=n}if("@container"in h){const n=a(h["@container"])?[h["@container"]]:h["@container"]||[],r=["@list","@set","@index","@language"];let s=!0;const u=n.includes("@set");if(m.processingMode(e,1.1)){if(r.push("@graph","@id","@type"),n.includes("@list")){if(1!==n.length)throw new i("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(n.includes("@graph")){if(n.some(e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e))throw new i("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else s&=n.length<=(u?2:1);if(n.includes("@type")&&(p["@type"]=p["@type"]||"@id",!["@id","@vocab"].includes(p["@type"])))throw new i("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else s&=!o(h["@container"]),s&=n.length<=1;if(s&=n.every(e=>r.includes(e)),s&=!(u&&n.includes("@list")),!s)throw new i("Invalid JSON-LD syntax; @context @container value must be one of the following: "+r.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(p.reverse&&!n.every(e=>["@index","@set"].includes(e)))throw new i("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});p["@container"]=n}if("@index"in h){if(!("@container"in h)||!p["@container"].includes("@index"))throw new i(`Invalid JSON-LD syntax; @index without @index in @container: "${h["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});if(!a(h["@index"])||0===h["@index"].indexOf("@"))throw new i(`Invalid JSON-LD syntax; @index must expand to an IRI: "${h["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});p["@index"]=h["@index"]}if("@context"in h&&(p["@context"]=h["@context"]),"@language"in h&&!("@type"in h)){let e=h["@language"];if(null!==e&&!a(e))throw new i("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==e&&(e=e.toLowerCase()),p["@language"]=e}if("@prefix"in h){if(n.match(/:|\//))throw new i("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if(m.isKeyword(p["@id"]))throw new i("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:t});if("boolean"!=typeof h["@prefix"])throw new i("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t});p._prefix=!0===h["@prefix"]}if("@direction"in h){const e=h["@direction"];if(null!==e&&"ltr"!==e&&"rtl"!==e)throw new i('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:t});p["@direction"]=e}if("@nest"in h){const e=h["@nest"];if(!a(e)||"@nest"!==e&&0===e.indexOf("@"))throw new i("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});p["@nest"]=e}const w=p["@id"];if("@context"===w||"@preserve"===w)throw new i("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(d&&d.protected&&!l&&(e.protected[n]=!0,p.protected=!0,!v(d,p))){const e=u&&u.protectedMode||"error";if("error"===e)throw new i(`Invalid JSON-LD syntax; tried to redefine "${n}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:n});if("warn"===e)return void console.warn("WARNING: protected term redefinition",{term:n});throw new i("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,term:n,protectedMode:e})}},m.expandIri=(e,t,n,r)=>y(e,t,n,void 0,void 0,r),m.getInitialContext=e=>{const t=JSON.stringify({processingMode:e.processingMode}),n=p.get(t);if(n)return n;const i={processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},n=e.fastCurieMap={},r={},i=(e["@language"]||"@none").toLowerCase(),a=e["@direction"],u=e.mappings,c=[...u.keys()].sort(f);for(const o of c){const e=u.get(o);if(null===e)continue;let c=e["@container"]||"@none";if(c=[].concat(c).sort().join(""),null===e["@id"])continue;const l=d(e["@id"]);for(const u of l){let l=t[u];const h=m.isKeyword(u);if(l)h||e._termHasColon||r[u].push(o);else if(t[u]=l={},!h&&!e._termHasColon){r[u]=[o];const e={iri:u,terms:r[u]};u[0]in n?n[u[0]].push(e):n[u[0]]=[e]}if(l[c]||(l[c]={"@language":{},"@type":{},"@any":{}}),l=l[c],s(o,l["@any"],"@none"),e.reverse)s(o,l["@type"],"@reverse");else if("@none"===e["@type"])s(o,l["@any"],"@none"),s(o,l["@language"],"@none"),s(o,l["@type"],"@none");else if("@type"in e)s(o,l["@type"],e["@type"]);else if("@language"in e&&"@direction"in e){const t=e["@language"],n=e["@direction"];s(o,l["@language"],t&&n?`${t}_${n}`.toLowerCase():t?t.toLowerCase():n?`_${n}`:"@null")}else"@language"in e?s(o,l["@language"],(e["@language"]||"@null").toLowerCase()):"@direction"in e?s(o,l["@language"],e["@direction"]?`_${e["@direction"]}`:"@none"):a?(s(o,l["@language"],`_${a}`),s(o,l["@language"],"@none"),s(o,l["@type"],"@none")):(s(o,l["@language"],i),s(o,l["@language"],"@none"),s(o,l["@type"],"@none"))}}for(const s in n)o(n,s,1);return t},clone:function(){const e={};return e.mappings=r.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=r.clone(this.protected),this.previousContext&&(e.previousContext=this.previousContext.clone()),e.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(e["@base"]=this["@base"]),"@language"in this&&(e["@language"]=this["@language"]),"@vocab"in this&&(e["@vocab"]=this["@vocab"]),e},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===p.size&&p.clear(),p.set(t,i),i;function o(e,t,n){const r=e[t],i=e[t]={};let s,a;for(const o of r)s=o.iri,a=n>=s.length?"":s[n],a in i?i[a].push(o):i[a]=[o];for(const u in i)""!==u&&o(i,u,n+1)}function s(e,t,n){t.hasOwnProperty(n)||(t[n]=e)}},m.getContextValue=(e,t,n)=>{if(null===t){if("@context"===n)return;return null}if(e.mappings.has(t)){const r=e.mappings.get(t);if(u(n))return r;if(r.hasOwnProperty(n))return r[n]}return"@language"===n&&n in e||"@direction"===n&&n in e?e[n]:"@context"!==n?null:void 0},m.processingMode=(e,t)=>t.toString()>="1.1"?!e.processingMode||e.processingMode>="json-ld-"+t.toString():"json-ld-1.0"===e.processingMode,m.isKeyword=e=>{if(!a(e)||"@"!==e[0])return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(e,t,n){"use strict";const{parseLinkHeader:r,buildHeaders:i}=e("../util"),{LINK_HEADER_CONTEXT:o}=e("../constants"),s=e("../JsonLdError"),a=e("../RequestQueue"),{prependBase:u}=e("../url"),c=/(^|(\r\n))link:/i;t.exports=({secure:e,headers:t={},xhr:n}={headers:{}})=>(t=i(t),(new a).wrapLoader(async function i(a){if(0!==a.indexOf("http:")&&0!==a.indexOf("https:"))throw new s('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a});if(e&&0!==a.indexOf("https"))throw new s('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:a});let l;try{l=await function(e,t,n){const r=new(e=e||XMLHttpRequest);return new Promise((e,i)=>{r.onload=()=>e(r),r.onerror=e=>i(e),r.open("GET",t,!0);for(const t in n)r.setRequestHeader(t,n[t]);r.send()})}(n,a,t)}catch(g){throw new s("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:g})}if(l.status>=400)throw new s("URL could not be dereferenced: "+l.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:a,httpStatusCode:l.status});let h={contextUrl:null,documentUrl:a,document:l.response},d=null;const f=l.getResponseHeader("Content-Type");let p;if(c.test(l.getAllResponseHeaders())&&(p=l.getResponseHeader("Link")),p&&"application/ld+json"!==f){const e=r(p),t=e[o];if(Array.isArray(t))throw new s("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a});t&&(h.contextUrl=t.target),d=e.alternate,d&&"application/ld+json"==d.type&&!(f||"").match(/^application\/(\w*\+)?json$/)&&(h=await i(u(a,d.target)))}return h}))},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(e,t,n){"use strict";const r=e("./JsonLdError"),{isArray:i,isObject:o,isEmptyObject:s,isString:a,isUndefined:u}=e("./types"),{isList:c,isValue:l,isGraph:h,isSubject:d}=e("./graphTypes"),{expandIri:f,getContextValue:p,isKeyword:g,process:m,processingMode:y}=e("./context"),{isAbsolute:v}=e("./url"),{addValue:b,asArray:_,getValues:w,validateTypeValue:x}=e("./util"),E={};t.exports=E;const S=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;async function A({activeCtx:e,activeProperty:t,expandedActiveProperty:n,element:h,expandedParent:w,options:k={},insideList:I,typeKey:C,typeScopedContext:D,expansionMap:j}){const P=Object.keys(h).sort(),M=[];let R;const N=h[C]&&"@json"===f(e,i(h[C])?h[C][0]:h[C],{vocab:!0},k);for(const A of P){let C,P=h[A];if("@context"===A)continue;let L=f(e,A,{vocab:!0},k);if((null===L||!v(L)&&!g(L))&&(L=j({unmappedProperty:A,activeCtx:e,activeProperty:t,parent:h,options:k,insideList:I,value:P,expandedParent:w}),void 0===L))continue;if(g(L)){if("@reverse"===n)throw new r("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:P});if(L in w&&"@included"!==L&&"@type"!==L)throw new r("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:L})}if("@id"===L){if(!a(P)){if(!k.isFrame)throw new r('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:P});if(o(P)){if(!s(P))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:P})}else{if(!i(P))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:P});if(!P.every(e=>a(e)))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:P})}}b(w,"@id",_(P).map(t=>a(t)?f(e,t,{base:!0},k):t),{propertyIsArray:k.isFrame});continue}if("@type"===L){o(P)&&(P=Object.fromEntries(Object.entries(P).map(([e,t])=>[f(D,e,{vocab:!0}),_(t).map(e=>f(D,e,{base:!0,vocab:!0}))]))),x(P,k.isFrame),b(w,"@type",_(P).map(e=>a(e)?f(D,e,{base:!0,vocab:!0},k):e),{propertyIsArray:k.isFrame});continue}if("@included"===L&&y(e,1.1)){const n=_(await E.expand({activeCtx:e,activeProperty:t,element:P,options:k,expansionMap:j}));if(!n.every(e=>d(e)))throw new r("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:P});b(w,"@included",n,{propertyIsArray:!0});continue}if("@graph"===L&&!o(P)&&!i(P))throw new r('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:P});if("@value"===L){R=P,N&&y(e,1.1)?w["@value"]=P:b(w,"@value",P,{propertyIsArray:k.isFrame});continue}if("@language"===L){if(null===P)continue;if(!a(P)&&!k.isFrame)throw new r('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:P});P=_(P).map(e=>a(e)?e.toLowerCase():e);for(const e of P)a(e)&&!e.match(S)&&console.warn(`@language must be valid BCP47: ${e}`);b(w,"@language",P,{propertyIsArray:k.isFrame});continue}if("@direction"===L){if(!a(P)&&!k.isFrame)throw new r('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:P});P=_(P);for(const e of P)if(a(e)&&"ltr"!==e&&"rtl"!==e)throw new r('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:P});b(w,"@direction",P,{propertyIsArray:k.isFrame});continue}if("@index"===L){if(!a(P))throw new r('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:P});b(w,"@index",P);continue}if("@reverse"===L){if(!o(P))throw new r('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:P});if(C=await E.expand({activeCtx:e,activeProperty:"@reverse",element:P,options:k,expansionMap:j}),"@reverse"in C)for(const e in C["@reverse"])b(w,e,C["@reverse"][e],{propertyIsArray:!0});let t=w["@reverse"]||null;for(const e in C){if("@reverse"===e)continue;null===t&&(t=w["@reverse"]={}),b(t,e,[],{propertyIsArray:!0});const n=C[e];for(let i=0;i<n.length;++i){const o=n[i];if(l(o)||c(o))throw new r('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:C});b(t,e,o,{propertyIsArray:!0})}}continue}if("@nest"===L){M.push(A);continue}let F=e;const B=p(e,A,"@context");u(B)||(F=await m({activeCtx:e,localCtx:B,propagate:!0,overrideProtected:!0,options:k}));const z=p(F,A,"@container")||[];if(z.includes("@language")&&o(P))C=T(F,P,p(F,A,"@direction"),k);else if(z.includes("@index")&&o(P)){const t=z.includes("@graph"),n=p(F,A,"@index")||"@index",r="@index"!==n&&f(e,n,{vocab:!0},k);C=await O({activeCtx:F,options:k,activeProperty:A,value:P,expansionMap:j,asGraph:t,indexKey:n,propertyIndex:r})}else if(z.includes("@id")&&o(P)){const e=z.includes("@graph");C=await O({activeCtx:F,options:k,activeProperty:A,value:P,expansionMap:j,asGraph:e,indexKey:"@id"})}else if(z.includes("@type")&&o(P))C=await O({activeCtx:F.revertToPreviousContext(),options:k,activeProperty:A,value:P,expansionMap:j,asGraph:!1,indexKey:"@type"});else{const r="@list"===L;if(r||"@set"===L){let e=t;r&&"@graph"===n&&(e=null),C=await E.expand({activeCtx:F,activeProperty:e,element:P,options:k,insideList:r,expansionMap:j})}else C="@json"===p(e,A,"@type")?{"@type":"@json","@value":P}:await E.expand({activeCtx:F,activeProperty:A,element:P,options:k,insideList:!1,expansionMap:j})}if(null!==C||"@value"===L||(C=j({unmappedValue:P,expandedProperty:L,activeCtx:F,activeProperty:t,parent:h,options:k,insideList:I,key:A,expandedParent:w}),void 0!==C))if("@list"!==L&&!c(C)&&z.includes("@list")&&(C={"@list":_(C)}),z.includes("@graph")&&!z.some(e=>"@id"===e||"@index"===e)&&(C=_(C).map(e=>({"@graph":_(e)}))),F.mappings.has(A)&&F.mappings.get(A).reverse){const e=w["@reverse"]=w["@reverse"]||{};C=_(C);for(let t=0;t<C.length;++t){const n=C[t];if(l(n)||c(n))throw new r('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:C});b(e,L,n,{propertyIsArray:!0})}}else b(w,L,C,{propertyIsArray:!0})}if("@value"in w)if("@json"===w["@type"]&&y(e,1.1));else if((o(R)||i(R))&&!k.isFrame)throw new r('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:R});for(const s of M){const a=i(h[s])?h[s]:[h[s]];for(const i of a){if(!o(i)||Object.keys(i).some(t=>"@value"===f(e,t,{vocab:!0},k)))throw new r("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:i});await A({activeCtx:e,activeProperty:t,expandedActiveProperty:n,element:i,expandedParent:w,options:k,insideList:I,typeScopedContext:D,typeKey:C,expansionMap:j})}}}function k({activeCtx:e,activeProperty:t,value:n,options:r}){if(null==n)return null;const i=f(e,t,{vocab:!0},r);if("@id"===i)return f(e,n,{base:!0},r);if("@type"===i)return f(e,n,{vocab:!0,base:!0},r);const o=p(e,t,"@type");if(("@id"===o||"@graph"===i)&&a(n))return{"@id":f(e,n,{base:!0},r)};if("@vocab"===o&&a(n))return{"@id":f(e,n,{vocab:!0,base:!0},r)};if(g(i))return n;const s={};if(o&&!["@id","@vocab","@none"].includes(o))s["@type"]=o;else if(a(n)){const n=p(e,t,"@language");null!==n&&(s["@language"]=n);const r=p(e,t,"@direction");null!==r&&(s["@direction"]=r)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),s["@value"]=n,s}function T(e,t,n,o){const s=[],u=Object.keys(t).sort();for(const c of u){const u=f(e,c,{vocab:!0},o);let l=t[c];i(l)||(l=[l]);for(const e of l){if(null===e)continue;if(!a(e))throw new r("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const i={"@value":e};"@none"!==u&&(i["@language"]=c.toLowerCase()),n&&(i["@direction"]=n),s.push(i)}}return s}async function O({activeCtx:e,options:t,activeProperty:n,value:o,expansionMap:s,asGraph:a,indexKey:c,propertyIndex:d}){const g=[],y=Object.keys(o).sort(),v="@type"===c;for(let _ of y){if(v){const n=p(e,_,"@context");u(n)||(e=await m({activeCtx:e,localCtx:n,propagate:!1,options:t}))}let y,w=o[_];i(w)||(w=[w]),w=await E.expand({activeCtx:e,activeProperty:n,element:w,options:t,insideList:!1,insideIndex:!0,expansionMap:s}),y=d?"@none"===_?"@none":k({activeCtx:e,activeProperty:c,value:_,options:t}):f(e,_,{vocab:!0},t),"@id"===c?_=f(e,_,{base:!0},t):v&&(_=y);for(let e of w){if(a&&!h(e)&&(e={"@graph":[e]}),"@type"===c)"@none"===y||(e["@type"]=e["@type"]?[_].concat(e["@type"]):[_]);else{if(l(e)&&!["@language","@type","@index"].includes(c))throw new r(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${c}".`,"jsonld.SyntaxError",{code:"invalid value object",value:e});d?"@none"!==y&&b(e,d,y,{propertyIsArray:!0,prependValue:!0}):"@none"===y||c in e||(e[c]=_)}g.push(e)}}return g}E.expand=async({activeCtx:e,activeProperty:t=null,element:n,options:c={},insideList:l=!1,insideIndex:h=!1,typeScopedContext:d=null,expansionMap:g=(()=>{})})=>{if(null==n)return null;if("@default"===t&&(c=Object.assign({},c,{isFrame:!1})),!i(n)&&!o(n)){if(!l&&(null===t||"@graph"===f(e,t,{vocab:!0},c))){const r=await g({unmappedValue:n,activeCtx:e,activeProperty:t,options:c,insideList:l});return void 0===r?null:r}return k({activeCtx:e,activeProperty:t,value:n,options:c})}if(i(n)){let r=[];const o=p(e,t,"@container")||[];l=l||o.includes("@list");for(let s=0;s<n.length;++s){let o=await E.expand({activeCtx:e,activeProperty:t,element:n[s],options:c,expansionMap:g,insideIndex:h,typeScopedContext:d});l&&i(o)&&(o={"@list":o}),null===o&&(o=await g({unmappedValue:n[s],activeCtx:e,activeProperty:t,parent:n,index:s,options:c,expandedParent:r,insideList:l}),void 0===o)||(i(o)?r=r.concat(o):r.push(o))}return r}const b=f(e,t,{vocab:!0},c),x=p(e,t,"@context");d=d||(e.previousContext?e:null);let S=Object.keys(n).sort(),T=!h;if(T&&d&&S.length<=2&&!S.includes("@context"))for(const r of S){const t=f(d,r,{vocab:!0},c);if("@value"===t){T=!1,e=d;break}if("@id"===t&&1===S.length){T=!1;break}}T&&(e=e.revertToPreviousContext()),u(x)||(e=await m({activeCtx:e,localCtx:x,propagate:!0,overrideProtected:!0,options:c})),"@context"in n&&(e=await m({activeCtx:e,localCtx:n["@context"],options:c})),d=e;let O=null;for(const r of S)if("@type"===f(e,r,{vocab:!0},c)){O=O||r;const t=n[r],i=Array.isArray(t)?t.length>1?t.slice().sort():t:[t];for(const n of i){const t=p(d,n,"@context");u(t)||(e=await m({activeCtx:e,localCtx:t,options:c,propagate:!1}))}}let I={};await A({activeCtx:e,activeProperty:t,expandedActiveProperty:b,element:n,expandedParent:I,options:c,insideList:l,typeKey:O,typeScopedContext:d,expansionMap:g}),S=Object.keys(I);let C=S.length;if("@value"in I){if("@type"in I&&("@language"in I||"@direction"in I))throw new r('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:I});let i=C-1;if("@type"in I&&(i-=1),"@index"in I&&(i-=1),"@language"in I&&(i-=1),"@direction"in I&&(i-=1),0!==i)throw new r('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:I});const o=null===I["@value"]?[]:_(I["@value"]),u=w(I,"@type");if(y(e,1.1)&&u.includes("@json")&&1===u.length);else if(0===o.length){const r=await g({unmappedValue:I,activeCtx:e,activeProperty:t,element:n,options:c,insideList:l});I=void 0!==r?r:null}else{if(!o.every(e=>a(e)||s(e))&&"@language"in I)throw new r("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:I});if(!u.every(e=>v(e)&&!(a(e)&&0===e.indexOf("_:"))||s(e)))throw new r('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:I})}}else if("@type"in I&&!i(I["@type"]))I["@type"]=[I["@type"]];else if("@set"in I||"@list"in I){if(C>1&&(2!==C||!("@index"in I)))throw new r('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:I});"@set"in I&&(I=I["@set"],S=Object.keys(I),C=S.length)}else if(1===C&&"@language"in I){const r=await g(I,{unmappedValue:I,activeCtx:e,activeProperty:t,element:n,options:c,insideList:l});I=void 0!==r?r:null}if(o(I)&&!c.keepFreeFloatingNodes&&!l&&(null===t||"@graph"===b)&&(0===C||"@value"in I||"@list"in I||1===C&&"@id"in I)){const r=await g({unmappedValue:I,activeCtx:e,activeProperty:t,element:n,options:c,insideList:l});I=void 0!==r?r:null}return I}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(e,t,n){"use strict";const{isSubjectReference:r}=e("./graphTypes"),{createMergedNodeMap:i}=e("./nodeMap"),o={};t.exports=o,o.flatten=e=>{const t=i(e),n=[],o=Object.keys(t).sort();for(let i=0;i<o.length;++i){const e=t[o[i]];r(e)||n.push(e)}return n}},{"./graphTypes":25,"./nodeMap":27}],23:[function(e,t,n){"use strict";const{isKeyword:r}=e("./context"),i=e("./graphTypes"),o=e("./types"),s=e("./util"),a=e("./url"),u=e("./JsonLdError"),{createNodeMap:c,mergeNodeMapGraphs:l}=e("./nodeMap"),h={};function d(e){const t={};for(const n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function f(e,t,n){for(let r=n.length-1;r>=0;--r){const i=n[r];if(i.graph===t&&i.subject["@id"]===e["@id"])return!0}return!1}function p(e,t,n){const r="@"+n;let i=r in e?e[r][0]:t[n];if("embed"===n)if(!0===i)i="@once";else if(!1===i)i="@never";else if("@always"!==i&&"@never"!==i&&"@link"!==i&&"@first"!==i&&"@last"!==i&&"@once"!==i)throw new u("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:e});return i}function g(e){if(!o.isArray(e)||1!==e.length||!o.isObject(e[0]))throw new u("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e});if("@id"in e[0])for(const t of s.asArray(e[0]["@id"]))if(!o.isObject(t)&&!a.isAbsolute(t)||o.isString(t)&&0===t.indexOf("_:"))throw new u("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e});if("@type"in e[0])for(const t of s.asArray(e[0]["@type"]))if(!o.isObject(t)&&!a.isAbsolute(t)||o.isString(t)&&0===t.indexOf("_:"))throw new u("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}function m(e,t,n,a){let u=!0,c=!1;for(const l in n){let h=!1;const d=s.getValues(t,l),f=0===s.getValues(n,l).length;if("@id"===l){if(o.isEmptyObject(n["@id"][0]||{})?h=!0:n["@id"].length>=0&&(h=n["@id"].includes(d[0])),!a.requireAll)return h}else if("@type"===l){if(u=!1,f){if(d.length>0)return!1;h=!0}else if(1===n["@type"].length&&o.isEmptyObject(n["@type"][0]))h=d.length>0;else for(const e of n["@type"])h=!(!o.isObject(e)||!("@default"in e))||h||d.some(t=>t===e);if(!a.requireAll)return h}else{if(r(l))continue;{const t=s.getValues(n,l)[0];let r=!1;if(t&&(g([t]),r="@default"in t),u=!1,0===d.length&&r)continue;if(d.length>0&&f)return!1;if(void 0===t){if(d.length>0)return!1;h=!0}else if(i.isList(t)){const n=t["@list"][0];if(i.isList(d[0])){const t=d[0]["@list"];i.isValue(n)?h=t.some(e=>w(n,e)):(i.isSubject(n)||i.isSubjectReference(n))&&(h=t.some(t=>_(e,n,t,a)))}}else h=i.isValue(t)?d.some(e=>w(t,e)):i.isSubjectReference(t)?d.some(n=>_(e,t,n,a)):!!o.isObject(t)&&d.length>0}}if(!h&&a.requireAll)return!1;c=c||h}return u||c}function y(e,t){const n=e.uniqueEmbeds[e.graph],r=n[t],i=r.parent,a=r.property,u={"@id":t};if(o.isArray(i)){for(let o=0;o<i.length;++o)if(s.compareValues(i[o],u)){i[o]=u;break}}else{const e=o.isArray(i[a]);s.removeValue(i,a,u,{propertyIsArray:e}),s.addValue(i,a,u,{propertyIsArray:e})}const c=e=>{const t=Object.keys(n);for(const r of t)r in n&&o.isObject(n[r].parent)&&n[r].parent["@id"]===e&&(delete n[r],c(r))};c(t)}function v(e,t){if(o.isArray(e))return e.map(e=>v(e,t));if(o.isObject(e)){if("@preserve"in e)return e["@preserve"][0];if(i.isValue(e))return e;if(i.isList(e))return e["@list"]=v(e["@list"],t),e;if("@id"in e){const n=e["@id"];if(t.link.hasOwnProperty(n)){const r=t.link[n].indexOf(e);if(-1!==r)return t.link[n][r];t.link[n].push(e)}else t.link[n]=[e]}for(const n in e)"@id"===n&&t.bnodesToClear.includes(e[n])?delete e["@id"]:e[n]=v(e[n],t)}return e}function b(e,t,n){o.isObject(e)?s.addValue(e,t,n,{propertyIsArray:!0}):e.push(n)}function _(e,t,n,r){if(!("@id"in n))return!1;const i=e.subjects[n["@id"]];return i&&m(e,i,t,r)}function w(e,t){const n=t["@value"],r=t["@type"],i=t["@language"],s=e["@value"]?o.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],a=e["@type"]?o.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],u=e["@language"]?o.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===s.length&&0===a.length&&0===u.length||!(!s.includes(n)&&!o.isEmptyObject(s[0]))&&!!(!r&&0===a.length||a.includes(r)||r&&o.isEmptyObject(a[0]))&&!!(!i&&0===u.length||u.includes(i)||i&&o.isEmptyObject(u[0]))}t.exports=h,h.frameMergedOrDefault=(e,t,n)=>{const r={options:n,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},i=new s.IdentifierIssuer("_:b");c(e,r.graphMap,"@default",i),n.merged&&(r.graphMap["@merged"]=l(r.graphMap),r.graph="@merged"),r.subjects=r.graphMap[r.graph];const o=[];return h.frame(r,Object.keys(r.subjects).sort(),t,o),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(r.bnodeMap).filter(e=>1===r.bnodeMap[e].length)),n.link={},v(o,n)},h.frame=(e,t,n,a,c=null)=>{g(n);const l=e.options,v={embed:p(n=n[0],l,"embed"),explicit:p(n,l,"explicit"),requireAll:p(n,l,"requireAll")};e.link.hasOwnProperty(e.graph)||(e.link[e.graph]={});const _=e.link[e.graph],x=function(e,t,n,r){const i={};for(const o of t){const t=e.graphMap[e.graph][o];m(e,t,n,r)&&(i[o]=t)}return i}(e,t,n,v),E=Object.keys(x).sort();for(const g of E){const m=x[g];if(null===c?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{},"@link"===v.embed&&g in _){b(a,c,_[g]);continue}const E={"@id":g};if(0===g.indexOf("_:")&&s.addValue(e.bnodeMap,g,E,{propertyIsArray:!0}),_[g]=E,("@first"===v.embed||"@last"===v.embed)&&e.is11)throw new u("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:n});if(e.embedded||!e.uniqueEmbeds[e.graph].hasOwnProperty(g))if(!e.embedded||"@never"!==v.embed&&!f(m,e.graph,e.subjectStack))if(!e.embedded||"@first"!=v.embed&&"@once"!=v.embed||!e.uniqueEmbeds[e.graph].hasOwnProperty(g)){if("@last"===v.embed&&g in e.uniqueEmbeds[e.graph]&&y(e,g),e.uniqueEmbeds[e.graph][g]={parent:a,property:c},e.subjectStack.push({subject:m,graph:e.graph}),g in e.graphMap){let t=!1,r=null;"@graph"in n?(r=n["@graph"][0],t=!("@merged"===g||"@default"===g),o.isObject(r)||(r={})):(t="@merged"!==e.graph,r={}),t&&h.frame({...e,graph:g,embedded:!1},Object.keys(e.graphMap[g]).sort(),[r],E,"@graph")}"@included"in n&&h.frame({...e,embedded:!1},t,n["@included"],E,"@included");for(const t of Object.keys(m).sort())if(r(t)){if(E[t]=s.clone(m[t]),"@type"===t)for(const n of m["@type"])0===n.indexOf("_:")&&s.addValue(e.bnodeMap,n,E,{propertyIsArray:!0})}else if(!v.explicit||t in n)for(const r of m[t]){const o=t in n?n[t]:d(v);if(i.isList(r)){const o=n[t]&&n[t][0]&&n[t][0]["@list"]?n[t][0]["@list"]:d(v),a={"@list":[]};b(E,t,a);const u=r["@list"];for(const t of u)i.isSubjectReference(t)?h.frame({...e,embedded:!0},[t["@id"]],o,a,"@list"):b(a,"@list",s.clone(t))}else i.isSubjectReference(r)?h.frame({...e,embedded:!0},[r["@id"]],o,E,t):w(o[0],r)&&b(E,t,s.clone(r))}for(const e of Object.keys(n).sort()){if("@type"===e){if(!o.isObject(n[e][0])||!("@default"in n[e][0]))continue}else if(r(e))continue;const t=n[e][0]||{};if(!p(t,l,"omitDefault")&&!(e in E)){let n="@null";"@default"in t&&(n=s.clone(t["@default"])),o.isArray(n)||(n=[n]),E[e]=[{"@preserve":n}]}}for(const t of Object.keys(n["@reverse"]||{}).sort()){const r=n["@reverse"][t];for(const n of Object.keys(e.subjects))s.getValues(e.subjects[n],t).some(e=>e["@id"]===g)&&(E["@reverse"]=E["@reverse"]||{},s.addValue(E["@reverse"],t,[],{propertyIsArray:!0}),h.frame({...e,embedded:!0},[n],r,E["@reverse"][t],c))}b(a,c,E),e.subjectStack.pop()}else b(a,c,E);else b(a,c,E)}},h.cleanupNull=(e,t)=>{if(o.isArray(e))return e.map(e=>h.cleanupNull(e,t)).filter(e=>e);if("@null"===e)return null;if(o.isObject(e)){if("@id"in e){const n=e["@id"];if(t.link.hasOwnProperty(n)){const r=t.link[n].indexOf(e);if(-1!==r)return t.link[n][r];t.link[n].push(e)}else t.link[n]=[e]}for(const n in e)e[n]=h.cleanupNull(e[n],t)}return e}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(e,t,n){"use strict";const r=e("./JsonLdError"),i=e("./graphTypes"),o=e("./types"),s=e("./util"),{RDF_LIST:a,RDF_FIRST:u,RDF_REST:c,RDF_NIL:l,RDF_TYPE:h,RDF_JSON_LITERAL:d,XSD_BOOLEAN:f,XSD_DOUBLE:p,XSD_INTEGER:g,XSD_STRING:m}=e("./constants"),y=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,v={};function b(e,t,n){if(e.termType.endsWith("Node"))return{"@id":e.value};const i={"@value":e.value};if(e.language)i["@language"]=e.language;else{let a=e.datatype.value;if(a||(a=m),a===d){a="@json";try{i["@value"]=JSON.parse(i["@value"])}catch(s){throw new r("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:i["@value"],cause:s})}}if(t){if(a===f)"true"===i["@value"]?i["@value"]=!0:"false"===i["@value"]&&(i["@value"]=!1);else if(o.isNumeric(i["@value"]))if(a===g){const e=parseInt(i["@value"],10);e.toFixed(0)===i["@value"]&&(i["@value"]=e)}else a===p&&(i["@value"]=parseFloat(i["@value"]));[f,g,p,m].includes(a)||(i["@type"]=a)}else if("i18n-datatype"===n&&a.startsWith("https://www.w3.org/ns/i18n#")){const[,e,t]=a.split(/[#_]/);e.length>0&&(i["@language"]=e,e.match(y)||console.warn(`@language must be valid BCP47: ${e}`)),i["@direction"]=t}else a!==m&&(i["@type"]=a)}return i}t.exports=v,v.fromRDF=async(e,{useRdfType:t=!1,useNativeTypes:n=!1,rdfDirection:r=null})=>{const d={},f={"@default":d},p={};for(const i of e){const e="DefaultGraph"===i.graph.termType?"@default":i.graph.value;e in f||(f[e]={}),"@default"===e||e in d||(d[e]={"@id":e});const o=f[e],a=i.subject.value,u=i.predicate.value,c=i.object;a in o||(o[a]={"@id":a});const g=o[a],m=c.termType.endsWith("Node");if(m&&!(c.value in o)&&(o[c.value]={"@id":c.value}),u===h&&!t&&m){s.addValue(g,"@type",c.value,{propertyIsArray:!0});continue}const y=b(c,n,r);if(s.addValue(g,u,y,{propertyIsArray:!0}),m)if(c.value===l){const e=o[c.value];"usages"in e||(e.usages=[]),e.usages.push({node:g,property:u,value:y})}else p[c.value]=!(c.value in p)&&{node:g,property:u,value:y}}for(const s in f){const e=f[s];if(!(l in e))continue;const t=e[l];if(t.usages){for(let n of t.usages){let t=n.node,r=n.property,s=n.value;const l=[],h=[];let d=Object.keys(t).length;for(;r===c&&o.isObject(p[t["@id"]])&&o.isArray(t[u])&&1===t[u].length&&o.isArray(t[c])&&1===t[c].length&&(3===d||4===d&&o.isArray(t["@type"])&&1===t["@type"].length&&t["@type"][0]===a)&&(l.push(t[u][0]),h.push(t["@id"]),n=p[t["@id"]],t=n.node,r=n.property,s=n.value,d=Object.keys(t).length,i.isBlankNode(t)););delete s["@id"],s["@list"]=l.reverse();for(const n of h)delete e[n]}delete t.usages}}const g=[],m=Object.keys(d).sort();for(const o of m){const e=d[o];if(o in f){const t=e["@graph"]=[],n=f[o],r=Object.keys(n).sort();for(const e of r){const r=n[e];i.isSubjectReference(r)||t.push(r)}}i.isSubjectReference(e)||g.push(e)}return g}},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(e,t,n){"use strict";const r=e("./types"),i={};t.exports=i,i.isSubject=e=>!(!r.isObject(e)||"@value"in e||"@set"in e||"@list"in e)&&(Object.keys(e).length>1||!("@id"in e)),i.isSubjectReference=e=>r.isObject(e)&&1===Object.keys(e).length&&"@id"in e,i.isValue=e=>r.isObject(e)&&"@value"in e,i.isList=e=>r.isObject(e)&&"@list"in e,i.isGraph=e=>r.isObject(e)&&"@graph"in e&&1===Object.keys(e).filter(e=>"@id"!==e&&"@index"!==e).length,i.isSimpleGraph=e=>i.isGraph(e)&&!("@id"in e),i.isBlankNode=e=>!!r.isObject(e)&&("@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e))},{"./types":30}],26:[function(e,t,n){const r=e("rdf-canonize"),i=e("./platform"),o=e("./util"),s=e("./ContextResolver"),a=o.IdentifierIssuer,u=e("./JsonLdError"),c=e("lru-cache"),l=e("./NQuads"),{expand:h}=e("./expand"),{flatten:d}=e("./flatten"),{fromRDF:f}=e("./fromRdf"),{toRDF:p}=e("./toRdf"),{frameMergedOrDefault:g,cleanupNull:m}=e("./frame"),{isArray:y,isObject:v,isString:b}=e("./types"),{isSubjectReference:_}=e("./graphTypes"),{expandIri:w,getInitialContext:x,process:E,processingMode:S}=e("./context"),{compact:A,compactIri:k}=e("./compact"),{createNodeMap:T,createMergedNodeMap:O,mergeNodeMaps:I}=e("./nodeMap"),C=function(t){const n={},C=new c({max:100});function D(e,{documentLoader:n=t.documentLoader,...r}){return Object.assign({},{documentLoader:n},r,e)}return t.compact=async function(e,n,r){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===n)throw new u("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===e)return null;let i;(r=D(r,{base:b(e)?e:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new a("_:b"),contextResolver:new s({sharedCache:C})})).link&&(r.skipExpansion=!0),r.compactToRelative||delete r.base,i=r.skipExpansion?e:await t.expand(e,r);const c=await t.processContext(x(r),n,r);let l=await A({activeCtx:c,element:i,options:r,compactionMap:r.compactionMap});r.compactArrays&&!r.graph&&y(l)?1===l.length?l=l[0]:0===l.length&&(l={}):r.graph&&v(l)&&(l=[l]),v(n)&&"@context"in n&&(n=n["@context"]),n=o.clone(n),y(n)||(n=[n]);const h=n;n=[];for(let t=0;t<h.length;++t)(!v(h[t])||Object.keys(h[t]).length>0)&&n.push(h[t]);const d=n.length>0;if(1===n.length&&(n=n[0]),y(l)){const e=k({activeCtx:c,iri:"@graph",relativeTo:{vocab:!0}}),t=l;l={},d&&(l["@context"]=n),l[e]=t}else if(v(l)&&d){const e=l;l={"@context":n};for(const t in e)l[t]=e[t]}return l},t.expand=async function(e,n){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(n=D(n,{keepFreeFloatingNodes:!1,contextResolver:new s({sharedCache:C})})).expansionMap&&(n.expansionMap=void 0);const r={},i=[];if("expandContext"in n){const e=o.clone(n.expandContext);r.expandContext=v(e)&&"@context"in e?e:{"@context":e},i.push(r.expandContext)}let a;if(b(e)){const o=await t.get(e,n);a=o.documentUrl,r.input=o.document,o.contextUrl&&(r.remoteContext={"@context":o.contextUrl},i.push(r.remoteContext))}else r.input=o.clone(e);"base"in n||(n.base=a||"");let u=x(n);for(const t of i)u=await E({activeCtx:u,localCtx:t,options:n});let c=await h({activeCtx:u,element:r.input,options:n,expansionMap:n.expansionMap});return v(c)&&"@graph"in c&&1===Object.keys(c).length?c=c["@graph"]:null===c&&(c=[]),y(c)||(c=[c]),c},t.flatten=async function(e,n,r){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");n="function"==typeof n?null:n||null,r=D(r,{base:b(e)?e:"",contextResolver:new s({sharedCache:C})});const i=await t.expand(e,r),o=d(i);return null===n?o:(r.graph=!0,r.skipExpansion=!0,await t.compact(o,n,r))},t.frame=async function(e,n,r){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(r=D(r,{base:b(e)?e:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new s({sharedCache:C})}),b(n)){const e=await t.get(n,r);if(n=e.document,e.contextUrl){let t=n["@context"];t?y(t)?t.push(e.contextUrl):t=[t,e.contextUrl]:t=e.contextUrl,n["@context"]=t}}const i=n&&n["@context"]||{},o=await t.processContext(x(r),i,r);r.hasOwnProperty("omitGraph")||(r.omitGraph=S(o,1.1)),r.hasOwnProperty("pruneBlankNodeIdentifiers")||(r.pruneBlankNodeIdentifiers=S(o,1.1));const a=await t.expand(e,r),u={...r};u.isFrame=!0,u.keepFreeFloatingNodes=!0;const c=await t.expand(n,u),l=Object.keys(n).map(e=>w(o,e,{vocab:!0}));u.merged=!l.includes("@graph"),u.is11=S(o,1.1);const h=g(a,c,u);u.graph=!r.omitGraph,u.skipExpansion=!0,u.link={},u.framing=!0;let d=await t.compact(h,i,u);return u.link={},d=m(d,u),d},t.link=async function(e,n,r){const i={};return n&&(i["@context"]=n),i["@embed"]="@link",t.frame(e,i,r)},t.normalize=t.canonize=async function(e,n){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(n=D(n,{base:b(e)?e:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new s({sharedCache:C})}))){if("application/n-quads"!==n.inputFormat&&"application/nquads"!==n.inputFormat)throw new u("Unknown canonicalization input format.","jsonld.CanonizeError");const t=l.parse(e);return r.canonize(t,n)}const i={...n};delete i.format,i.produceGeneralizedRdf=!1;const o=await t.toRDF(e,i);return r.canonize(o,n)},t.fromRDF=async function(e,t){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");t=D(t,{format:b(e)?"application/n-quads":void 0});const{format:r}=t;let{rdfParser:i}=t;if(r){if(i=i||n[r],!i)throw new u("Unknown input format.","jsonld.UnknownFormat",{format:r})}else i=()=>e;const o=await i(e);return f(o,t)},t.toRDF=async function(e,n){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let r;r=(n=D(n,{base:b(e)?e:"",skipExpansion:!1,contextResolver:new s({sharedCache:C})})).skipExpansion?e:await t.expand(e,n);const i=p(r,n);if(n.format){if("application/n-quads"===n.format||"application/nquads"===n.format)return l.serialize(i);throw new u("Unknown output format.","jsonld.UnknownFormat",{format:n.format})}return i},t.createNodeMap=async function(e,n){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");n=D(n,{base:b(e)?e:"",contextResolver:new s({sharedCache:C})});const r=await t.expand(e,n);return O(r,n)},t.merge=async function(e,n,r){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!y(e))throw new TypeError('Could not merge, "docs" must be an array.');n="function"==typeof n?null:n||null,r=D(r,{contextResolver:new s({sharedCache:C})});const i=await Promise.all(e.map(e=>{const n={...r};return t.expand(e,n)}));let u=!0;"mergeNodes"in r&&(u=r.mergeNodes);const c=r.issuer||new a("_:b"),l={"@default":{}};for(let t=0;t<i.length;++t){const e=o.relabelBlankNodes(i[t],{issuer:new a("_:b"+t+"-")}),n=u||0===t?l:{"@default":{}};if(T(e,n,"@default",c),n!==l)for(const t in n){const e=n[t];if(!(t in l)){l[t]=e;continue}const r=l[t];for(const t in e)t in r||(r[t]=e[t])}}const h=I(l),d=[],f=Object.keys(h).sort();for(let t=0;t<f.length;++t){const e=h[f[t]];_(e)||d.push(e)}return null===n?d:(r.graph=!0,r.skipExpansion=!0,await t.compact(d,n,r))},Object.defineProperty(t,"documentLoader",{get:()=>t._documentLoader,set:e=>t._documentLoader=e}),t.documentLoader=async e=>{throw new u("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},t.get=async function(e,n){let r;r="function"==typeof n.documentLoader?n.documentLoader:t.documentLoader;const i=await r(e);try{if(!i.document)throw new u("No remote document found at the given URL.","jsonld.NullRemoteDocument");b(i.document)&&(i.document=JSON.parse(i.document))}catch(o){throw new u("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:o,remoteDoc:i})}return i},t.processContext=async function(e,t,n){return n=D(n,{base:"",contextResolver:new s({sharedCache:C})}),null===t?x(n):(t=o.clone(t),v(t)&&"@context"in t||(t={"@context":t}),E({activeCtx:e,localCtx:t,options:n}))},t.getContextValue=e("./context").getContextValue,t.documentLoaders={},t.useDocumentLoader=function(e){if(!(e in t.documentLoaders))throw new u('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});t.documentLoader=t.documentLoaders[e].apply(t,Array.prototype.slice.call(arguments,1))},t.registerRDFParser=function(e,t){n[e]=t},t.unregisterRDFParser=function(e){delete n[e]},t.registerRDFParser("application/n-quads",l.parse),t.registerRDFParser("application/nquads",l.parse),t.url=e("./url"),t.util=o,Object.assign(t,o),t.promises=t,t.RequestQueue=e("./RequestQueue"),t.JsonLdProcessor=e("./JsonLdProcessor")(t),i.setupGlobals(t),i.setupDocumentLoaders(t),t},D=function(){return C(function(){return D()})};C(D),t.exports=D},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(e,t,n){"use strict";const{isKeyword:r}=e("./context"),i=e("./graphTypes"),o=e("./types"),s=e("./util"),a=e("./JsonLdError"),u={};t.exports=u,u.createMergedNodeMap=(e,t)=>{const n=(t=t||{}).issuer||new s.IdentifierIssuer("_:b"),r={"@default":{}};return u.createNodeMap(e,r,"@default",n),u.mergeNodeMaps(r)},u.createNodeMap=(e,t,n,c,l,h)=>{if(o.isArray(e)){for(const r of e)u.createNodeMap(r,t,n,c,void 0,h);return}if(!o.isObject(e))return void(h&&h.push(e));if(i.isValue(e)){if("@type"in e){let t=e["@type"];0===t.indexOf("_:")&&(e["@type"]=t=c.getId(t))}return void(h&&h.push(e))}if(h&&i.isList(e)){const r=[];return u.createNodeMap(e["@list"],t,n,c,l,r),void h.push({"@list":r})}if("@type"in e){const t=e["@type"];for(const e of t)0===e.indexOf("_:")&&c.getId(e)}o.isUndefined(l)&&(l=i.isBlankNode(e)?c.getId(e["@id"]):e["@id"]),h&&h.push({"@id":l});const d=t[n],f=d[l]=d[l]||{};f["@id"]=l;const p=Object.keys(e).sort();for(let o of p){if("@id"===o)continue;if("@reverse"===o){const r={"@id":l},o=e["@reverse"];for(const e in o){const a=o[e];for(const o of a){let a=o["@id"];i.isBlankNode(o)&&(a=c.getId(a)),u.createNodeMap(o,t,n,c,a),s.addValue(d[a],e,r,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===o){l in t||(t[l]={}),u.createNodeMap(e[o],t,l,c);continue}if("@included"===o){u.createNodeMap(e[o],t,n,c);continue}if("@type"!==o&&r(o)){if("@index"===o&&o in f&&(e[o]!==f[o]||e[o]["@id"]!==f[o]["@id"]))throw new a("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:f});f[o]=e[o];continue}const h=e[o];if(0===o.indexOf("_:")&&(o=c.getId(o)),0!==h.length)for(let e of h)if("@type"===o&&(e=0===e.indexOf("_:")?c.getId(e):e),i.isSubject(e)||i.isSubjectReference(e)){if("@id"in e&&!e["@id"])continue;const r=i.isBlankNode(e)?c.getId(e["@id"]):e["@id"];s.addValue(f,o,{"@id":r},{propertyIsArray:!0,allowDuplicate:!1}),u.createNodeMap(e,t,n,c,r)}else if(i.isValue(e))s.addValue(f,o,e,{propertyIsArray:!0,allowDuplicate:!1});else if(i.isList(e)){const r=[];u.createNodeMap(e["@list"],t,n,c,l,r),e={"@list":r},s.addValue(f,o,e,{propertyIsArray:!0,allowDuplicate:!1})}else u.createNodeMap(e,t,n,c,l),s.addValue(f,o,e,{propertyIsArray:!0,allowDuplicate:!1});else s.addValue(f,o,[],{propertyIsArray:!0})}},u.mergeNodeMapGraphs=e=>{const t={};for(const n of Object.keys(e).sort())for(const i of Object.keys(e[n]).sort()){const o=e[n][i];i in t||(t[i]={"@id":i});const a=t[i];for(const e of Object.keys(o).sort())if(r(e)&&"@type"!==e)a[e]=s.clone(o[e]);else for(const t of o[e])s.addValue(a,e,s.clone(t),{propertyIsArray:!0,allowDuplicate:!1})}return t},u.mergeNodeMaps=e=>{const t=e["@default"],n=Object.keys(e).sort();for(const r of n){if("@default"===r)continue;const n=e[r];let o=t[r];o?"@graph"in o||(o["@graph"]=[]):t[r]=o={"@id":r,"@graph":[]};const s=o["@graph"];for(const e of Object.keys(n).sort()){const t=n[e];i.isSubjectReference(t)||s.push(t)}}return t}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(e,t,n){"use strict";const r=e("./documentLoaders/xhr"),i={};t.exports=i,i.setupDocumentLoaders=function(e){"undefined"!=typeof XMLHttpRequest&&(e.documentLoaders.xhr=r,e.useDocumentLoader("xhr"))},i.setupGlobals=function(e){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(e,t,n){"use strict";const{createNodeMap:r}=e("./nodeMap"),{isKeyword:i}=e("./context"),o=e("./graphTypes"),s=e("canonicalize"),a=e("./types"),u=e("./util"),{RDF_FIRST:c,RDF_REST:l,RDF_NIL:h,RDF_TYPE:d,RDF_JSON_LITERAL:f,RDF_LANGSTRING:p,XSD_BOOLEAN:g,XSD_DOUBLE:m,XSD_INTEGER:y,XSD_STRING:v}=e("./constants"),{isAbsolute:b}=e("./url"),_={};function w(e,t,n,r,o){const s=Object.keys(t).sort();for(const a of s){const s=t[a],u=Object.keys(s).sort();for(let t of u){const u=s[t];if("@type"===t)t=d;else if(i(t))continue;for(const i of u){const s={termType:a.startsWith("_:")?"BlankNode":"NamedNode",value:a};if(!b(a))continue;const u={termType:t.startsWith("_:")?"BlankNode":"NamedNode",value:t};if(!b(t))continue;if("BlankNode"===u.termType&&!o.produceGeneralizedRdf)continue;const c=x(i,r,e,n,o.rdfDirection);c&&e.push({subject:s,predicate:u,object:c,graph:n})}}}}function x(e,t,n,r,i){const u={};if(o.isValue(e)){u.termType="Literal",u.value=void 0,u.datatype={termType:"NamedNode"};let t=e["@value"];const n=e["@type"]||null;"@json"===n?(u.value=s(t),u.datatype.value=f):a.isBoolean(t)?(u.value=t.toString(),u.datatype.value=n||g):a.isDouble(t)||n===m?(a.isDouble(t)||(t=parseFloat(t)),u.value=t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),u.datatype.value=n||m):a.isNumber(t)?(u.value=t.toFixed(0),u.datatype.value=n||y):"i18n-datatype"===i&&"@direction"in e?(u.datatype.value="https://www.w3.org/ns/i18n#"+(e["@language"]||"")+`_${e["@direction"]}`,u.value=t):"@language"in e?(u.value=t,u.datatype.value=n||p,u.language=e["@language"]):(u.value=t,u.datatype.value=n||v)}else if(o.isList(e)){const o=function(e,t,n,r,i){const o={termType:"NamedNode",value:c},s={termType:"NamedNode",value:l},a={termType:"NamedNode",value:h},u=e.pop(),d=u?{termType:"BlankNode",value:t.getId()}:a;let f=d;for(const c of e){const e=x(c,t,n,r,i),a={termType:"BlankNode",value:t.getId()};n.push({subject:f,predicate:o,object:e,graph:r}),n.push({subject:f,predicate:s,object:a,graph:r}),f=a}if(u){const e=x(u,t,n,r,i);n.push({subject:f,predicate:o,object:e,graph:r}),n.push({subject:f,predicate:s,object:a,graph:r})}return d}(e["@list"],t,n,r,i);u.termType=o.termType,u.value=o.value}else{const t=a.isObject(e)?e["@id"]:e;u.termType=t.startsWith("_:")?"BlankNode":"NamedNode",u.value=t}return"NamedNode"!==u.termType||b(u.value)?u:null}t.exports=_,_.toRDF=(e,t)=>{const n=new u.IdentifierIssuer("_:b"),i={"@default":{}};r(e,i,"@default",n);const o=[],s=Object.keys(i).sort();for(const r of s){let e;if("@default"===r)e={termType:"DefaultGraph",value:""};else{if(!b(r))continue;e=r.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},e.value=r}w(o,i[r],e,n,t)}return o}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(e,t,n){"use strict";const r={};t.exports=r,r.isArray=Array.isArray,r.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),r.isDouble=e=>r.isNumber(e)&&(-1!==String(e).indexOf(".")||Math.abs(e)>=1e21),r.isEmptyObject=e=>r.isObject(e)&&0===Object.keys(e).length,r.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),r.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),r.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),r.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),r.isUndefined=e=>void 0===e},{}],31:[function(e,t,n){"use strict";const r=e("./types"),i={};t.exports=i,i.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},i.parse=(e,t)=>{const n={},r=i.parsers[t||"full"],o=r.regex.exec(e);let s=r.keys.length;for(;s--;)n[r.keys[s]]=void 0===o[s]?null:o[s];return("https"===n.scheme&&"443"===n.port||"http"===n.scheme&&"80"===n.port)&&(n.href=n.href.replace(":"+n.port,""),n.authority=n.authority.replace(":"+n.port,""),n.port=null),n.normalizedPath=i.removeDotSegments(n.path),n},i.prependBase=(e,t)=>{if(null===e)return t;if(i.isAbsolute(t))return t;e&&!r.isString(e)||(e=i.parse(e||""));const n=i.parse(t),o={protocol:e.protocol||""};if(null!==n.authority)o.authority=n.authority,o.path=n.path,o.query=n.query;else if(o.authority=e.authority,""===n.path)o.path=e.path,o.query=null!==n.query?n.query:e.query;else{if(0===n.path.indexOf("/"))o.path=n.path;else{let t=e.path;t=t.substr(0,t.lastIndexOf("/")+1),(t.length>0||e.authority)&&"/"!==t.substr(-1)&&(t+="/"),t+=n.path,o.path=t}o.query=n.query}""!==n.path&&(o.path=i.removeDotSegments(o.path));let s=o.protocol;return null!==o.authority&&(s+="//"+o.authority),s+=o.path,null!==o.query&&(s+="?"+o.query),null!==n.fragment&&(s+="#"+n.fragment),""===s&&(s="./"),s},i.removeBase=(e,t)=>{if(null===e)return t;e&&!r.isString(e)||(e=i.parse(e||""));let n="";if(""!==e.href?n+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(n+="//"),0!==t.indexOf(n))return t;const o=i.parse(t.substr(n.length)),s=e.normalizedPath.split("/"),a=o.normalizedPath.split("/"),u=o.fragment||o.query?0:1;for(;s.length>0&&a.length>u&&s[0]===a[0];)s.shift(),a.shift();let c="";if(s.length>0){s.pop();for(let e=0;e<s.length;++e)c+="../"}return c+=a.join("/"),null!==o.query&&(c+="?"+o.query),null!==o.fragment&&(c+="#"+o.fragment),""===c&&(c="./"),c},i.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),n=[];for(;t.length>0;){const e=t.shift(),r=0===t.length;"."!==e?".."!==e?n.push(e):(n.pop(),r&&n.push("")):r&&n.push("")}return"/"===e[0]&&n.length>0&&""!==n[0]&&n.unshift(""),1===n.length&&""===n[0]?"/":n.join("/")};const o=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;i.isAbsolute=e=>r.isString(e)&&o.test(e),i.isRelative=e=>r.isString(e)},{"./types":30}],32:[function(e,t,n){"use strict";const r=e("./graphTypes"),i=e("./types"),o=e("rdf-canonize").IdentifierIssuer,s=e("./JsonLdError"),a=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,u=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,c=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,l="application/ld+json, application/json",h={};function d(e,t){if(i.isArray(t))for(let n=0;n<t.length;++n)t[n]=d(e,t[n]);else if(r.isList(t))t["@list"]=d(e,t["@list"]);else if(i.isObject(t)){r.isBlankNode(t)&&(t["@id"]=e.getId(t["@id"]));const n=Object.keys(t).sort();for(let r=0;r<n.length;++r){const i=n[r];"@id"!==i&&(t[i]=d(e,t[i]))}}return t}t.exports=h,h.IdentifierIssuer=o,h.clone=function(e){if(e&&"object"==typeof e){let t;if(i.isArray(e)){t=[];for(let n=0;n<e.length;++n)t[n]=h.clone(e[n])}else if(e instanceof Map){t=new Map;for(const[n,r]of e)t.set(n,h.clone(r))}else if(e instanceof Set){t=new Set;for(const n of e)t.add(h.clone(n))}else if(i.isObject(e)){t={};for(const n in e)t[n]=h.clone(e[n])}else t=e.toString();return t}return e},h.asArray=function(e){return Array.isArray(e)?e:[e]},h.buildHeaders=(e={})=>{if(Object.keys(e).some(e=>"accept"===e.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+l+'" is supported.');return Object.assign({Accept:l},e)},h.parseLinkHeader=e=>{const t={},n=e.match(a);for(let r=0;r<n.length;++r){let e=n[r].match(u);if(!e)continue;const i={target:e[1]},o=e[2];for(;e=c.exec(o);)i[e[1]]=void 0===e[2]?e[3]:e[2];const s=i.rel||"";Array.isArray(t[s])?t[s].push(i):t[s]=t.hasOwnProperty(s)?[t[s],i]:i}return t},h.validateTypeValue=(e,t)=>{if(!(i.isString(e)||i.isArray(e)&&e.every(e=>i.isString(e)))){if(t&&i.isObject(e))switch(Object.keys(e).length){case 0:return;case 1:if("@default"in e&&h.asArray(e["@default"]).every(e=>i.isString(e)))return}throw new s('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}},h.hasProperty=(e,t)=>{if(e.hasOwnProperty(t)){const n=e[t];return!i.isArray(n)||n.length>0}return!1},h.hasValue=(e,t,n)=>{if(h.hasProperty(e,t)){let o=e[t];const s=r.isList(o);if(i.isArray(o)||s){s&&(o=o["@list"]);for(let e=0;e<o.length;++e)if(h.compareValues(n,o[e]))return!0}else if(!i.isArray(n))return h.compareValues(n,o)}return!1},h.addValue=(e,t,n,r)=>{if("propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1),"valueIsArray"in r||(r.valueIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),"prependValue"in r||(r.prependValue=!1),r.valueIsArray)e[t]=n;else if(i.isArray(n)){0===n.length&&r.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]),r.prependValue&&(n=n.concat(e[t]),e[t]=[]);for(let i=0;i<n.length;++i)h.addValue(e,t,n[i],r)}else if(e.hasOwnProperty(t)){const o=!r.allowDuplicate&&h.hasValue(e,t,n);i.isArray(e[t])||o&&!r.propertyIsArray||(e[t]=[e[t]]),o||(r.prependValue?e[t].unshift(n):e[t].push(n))}else e[t]=r.propertyIsArray?[n]:n},h.getValues=(e,t)=>[].concat(e[t]||[]),h.removeProperty=(e,t)=>{delete e[t]},h.removeValue=(e,t,n,r)=>{"propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1);const i=h.getValues(e,t).filter(e=>!h.compareValues(e,n));0===i.length?h.removeProperty(e,t):e[t]=1!==i.length||r.propertyIsArray?i:i[0]},h.relabelBlankNodes=(e,t)=>d((t=t||{}).issuer||new o("_:b"),e),h.compareValues=(e,t)=>e===t||!(!r.isValue(e)||!r.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(i.isObject(e)&&"@id"in e&&i.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"],h.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(e,t,n){"use strict";const r=e("yallist"),i=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),u=Symbol("maxAge"),c=Symbol("dispose"),l=Symbol("noDisposeOnSet"),h=Symbol("lruList"),d=Symbol("cache"),f=Symbol("updateAgeOnGet"),p=()=>1,g=(e,t,n)=>{const r=e[d].get(t);if(r){const t=r.value;if(m(e,t)){if(v(e,r),!e[a])return}else n&&(e[f]&&(r.value.now=Date.now()),e[h].unshiftNode(r));return t.value}},m=(e,t)=>{if(!t||!t.maxAge&&!e[u])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[u]&&n>e[u]},y=e=>{if(e[o]>e[i])for(let t=e[h].tail;e[o]>e[i]&&null!==t;){const n=t.prev;v(e,t),t=n}},v=(e,t)=>{if(t){const n=t.value;e[c]&&e[c](n.key,n.value),e[o]-=n.length,e[d].delete(n.key),e[h].removeNode(t)}};class b{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const _=(e,t,n,r)=>{let i=n.value;m(e,i)&&(v(e,n),e[a]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};t.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||p;if(this[s]="function"!=typeof t?p:t,this[a]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[u]=e.maxAge||0,this[c]=e.dispose,this[l]=e.noDisposeOnSet||!1,this[f]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,y(this)}get max(){return this[i]}set allowStale(e){this[a]=!!e}get allowStale(){return this[a]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[u]=e,y(this)}get maxAge(){return this[u]}set lengthCalculator(e){"function"!=typeof e&&(e=p),e!==this[s]&&(this[s]=e,this[o]=0,this[h].forEach(e=>{e.length=this[s](e.value,e.key),this[o]+=e.length})),y(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[h].length}rforEach(e,t){t=t||this;for(let n=this[h].tail;null!==n;){const r=n.prev;_(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[h].head;null!==n;){const r=n.next;_(this,e,n,t),n=r}}keys(){return this[h].toArray().map(e=>e.key)}values(){return this[h].toArray().map(e=>e.value)}reset(){this[c]&&this[h]&&this[h].length&&this[h].forEach(e=>this[c](e.key,e.value)),this[d]=new Map,this[h]=new r,this[o]=0}dump(){return this[h].map(e=>!m(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[h]}set(e,t,n){if((n=n||this[u])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,a=this[s](t,e);if(this[d].has(e)){if(a>this[i])return v(this,this[d].get(e)),!1;const s=this[d].get(e).value;return this[c]&&(this[l]||this[c](e,s.value)),s.now=r,s.maxAge=n,s.value=t,this[o]+=a-s.length,s.length=a,this.get(e),y(this),!0}const f=new b(e,t,a,r,n);return f.length>this[i]?(this[c]&&this[c](e,t),!1):(this[o]+=f.length,this[h].unshift(f),this[d].set(e,this[h].head),y(this),!0)}has(e){if(!this[d].has(e))return!1;const t=this[d].get(e).value;return!m(this,t)}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){const e=this[h].tail;return e?(v(this,e),e.value):null}del(e){v(this,this[d].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[d].forEach((e,t)=>g(this,t,!1))}}},{yallist:92}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#",o="http://www.w3.org/2000/10/swap/";n.default={xsd:{decimal:`${i}decimal`,boolean:`${i}boolean`,double:`${i}double`,integer:`${i}integer`,string:`${i}string`},rdf:{type:`${r}type`,nil:`${r}nil`,first:`${r}first`,rest:`${r}rest`,langString:`${r}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${o}reify#forSome`,forAll:`${o}reify#forAll`},log:{implies:`${o}log#implies`}}},{}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.termFromId=function e(t,n){if(n=n||d,!t)return n.defaultGraph();switch(t[0]){case"?":return n.variable(t.substr(1));case"_":return n.blankNode(t.substr(2));case'"':if(n===d)return new g(t);if('"'===t[t.length-1])return n.literal(t.substr(1,t.length-2));const r=t.lastIndexOf('"',t.length-1);return n.literal(t.substr(1,r-1),"@"===t[r+1]?t.substr(r+2):n.namedNode(t.substr(r+3)));case"<":const i=h.exec(t);return n.quad(e(w(i[1]),n),e(w(i[2]),n),e(w(i[3]),n),i[4]&&e(w(i[4]),n));default:return n.namedNode(t)}},n.termToId=function e(t){if("string"==typeof t)return t;if(t instanceof f&&"Quad"!==t.termType)return t.id;if(!t)return u.id;switch(t.termType){case"NamedNode":return t.value;case"BlankNode":return`_:${t.value}`;case"Variable":return`?${t.value}`;case"DefaultGraph":return"";case"Literal":return`"${t.value}"${t.language?`@${t.language}`:t.datatype&&t.datatype.value!==a.string?`^^${t.datatype.value}`:""}`;case"Quad":return`<<${_(e(t.subject))} ${_(e(t.predicate))} ${_(e(t.object))}${(0,o.isDefaultGraph)(t.graph)?"":` ${e(t.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${t.termType}`)}},n.escapeQuotes=_,n.unescapeQuotes=w,n.Triple=n.Quad=n.DefaultGraph=n.Variable=n.BlankNode=n.Literal=n.NamedNode=n.Term=n.default=void 0;var r,i=(r=e("./IRIs"))&&r.__esModule?r:{default:r},o=e("./N3Util");const{rdf:s,xsd:a}=i.default;let u,c=0;const l=/^"(.*".*)(?="[^"]*$)/,h=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,d={namedNode:function(e){return new p(e)},blankNode:function(e){return new m(e||"n3-"+c++)},variable:function(e){return new y(e)},literal:function(e,t){if("string"==typeof t)return new g(`"${e}"@${t.toLowerCase()}`);let n=t?t.value:"";return""===n&&("boolean"==typeof e?n=a.boolean:"number"==typeof e&&(Number.isFinite(e)?n=Number.isInteger(e)?a.integer:a.double:(n=a.double,Number.isNaN(e)||(e=e>0?"INF":"-INF")))),new g(""===n||n===a.string?`"${e}"`:`"${e}"^^${n}`)},defaultGraph:function(){return u},quad:x,triple:x};n.default=d;class f{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof f?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}toJSON(){return{termType:this.termType,value:this.value}}}n.Term=f;class p extends f{get termType(){return"NamedNode"}}n.NamedNode=p;class g extends f{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new p(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,n=t<e.length?e[t]:"";return"^"===n?e.substr(t+2):"@"!==n?a.string:s.langString}equals(e){return e instanceof g?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}n.Literal=g;class m extends f{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}n.BlankNode=m;class y extends f{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}n.Variable=y;class v extends f{constructor(){return super(""),u||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}}n.DefaultGraph=v,u=new v;class b extends f{constructor(e,t,n,r){super(""),this._subject=e,this._predicate=t,this._object=n,this._graph=r||u}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function _(e){return e.replace(l,(e,t)=>`"${t.replace(/"/g,'""')}`)}function w(e){return e.replace(l,(e,t)=>`"${t.replace(/""/g,'"')}`)}function x(e,t,n,r){return new b(e,t,n,r)}n.Triple=n.Quad=b},{"./IRIs":34,"./N3Util":41}],36:[function(e,t,n){(function(t){(function(){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(e("./IRIs")),i=o(e("queue-microtask"));function o(e){return e&&e.__esModule?e:{default:e}}const{xsd:s}=r.default,a=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,u={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},c=/[\x00-\x20<>\\"\{\}\|\^\`]/,l={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},h=/$0^/;n.default=class{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(e=e||{}).lineMode){this._n3Mode=!1;for(const e in this)!(e in l)&&this[e]instanceof RegExp&&(this[e]=h)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let n=this._input;const r=this._comments;for(;;){let o,a;for(;o=this._newline.exec(n);)r&&(a=this._comment.exec(o[0]))&&e(null,{line:this._line,type:"comment",value:a[1],prefix:""}),n=n.substr(o[0].length,n.length),this._line++;if(!o&&(o=this._whitespace.exec(n))&&(n=n.substr(o[0].length,n.length)),this._endOfFile.test(n))return t&&(r&&(a=this._comment.exec(n))&&e(null,{line:this._line,type:"comment",value:a[1],prefix:""}),e(n=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=n;const u=this._line,l=n[0];let h="",d="",f="",p=null,g=0,m=!1;switch(l){case"^":if(n.length<3)break;if("^"!==n[1]){this._n3Mode&&(g=1,h="^");break}if(this._previousMarker="^^",n=n.substr(2),"<"!==n[0]){m=!0;break}case"<":if(p=this._unescapedIri.exec(n))h="IRI",d=p[1];else if(p=this._iri.exec(n)){if(d=this._unescape(p[1]),null===d||c.test(d))return i(this);h="IRI"}else n.length>1&&"<"===n[1]?(h="<<",g=2):this._n3Mode&&n.length>1&&"="===n[1]&&(h="inverse",g=2,d=">");break;case">":n.length>1&&">"===n[1]&&(h=">>",g=2);break;case"_":((p=this._blank.exec(n))||t&&(p=this._blank.exec(`${n} `)))&&(h="blank",f="_",d=p[1]);break;case'"':if(p=this._simpleQuotedString.exec(n))d=p[1];else if(({value:d,matchLength:g}=this._parseLiteral(n)),null===d)return i(this);null===p&&0===g||(h="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(p=this._simpleApostropheString.exec(n))d=p[1];else if(({value:d,matchLength:g}=this._parseLiteral(n)),null===d)return i(this);null===p&&0===g||(h="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(p=this._variable.exec(n))&&(h="var",d=p[0]);break;case"@":"literal"===this._previousMarker&&(p=this._langcode.exec(n))?(h="langcode",d=p[1]):(p=this._keyword.exec(n))&&(h=p[0]);break;case".":if(1===n.length?t:n[1]<"0"||n[1]>"9"){h=".",g=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(p=this._number.exec(n)||t&&(p=this._number.exec(`${n} `)))&&(h="literal",d=p[0],f="string"==typeof p[1]?s.double:"string"==typeof p[2]?s.decimal:s.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(p=this._sparqlKeyword.exec(n))?h=p[0].toUpperCase():m=!0;break;case"f":case"t":(p=this._boolean.exec(n))?(h="literal",d=p[0],f=s.boolean):m=!0;break;case"a":(p=this._shortPredicates.exec(n))?(h="abbreviation",d="a"):m=!0;break;case"=":this._n3Mode&&n.length>1&&(h="abbreviation",">"!==n[1]?(g=1,d="="):(g=2,d=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(g=1,h=l);break;default:m=!0}if(m&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(p=this._prefix.exec(n))?((p=this._prefixed.exec(n))||t&&(p=this._prefixed.exec(`${n} `)))&&(h="prefixed",f=p[1]||"",d=this._unescape(p[2])):(h="prefix",d=p[1]||"")),"^^"===this._previousMarker)switch(h){case"prefixed":h="type";break;case"IRI":h="typeIRI";break;default:h=""}if(!h)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?i(this):this._input=n;const y={line:u,type:h,value:d,prefix:f};e(null,y),this.previousToken=y,this._previousMarker=h,n=n.substr(g||p[0].length,n.length)}function i(t){e(t._syntaxError(/^\S*/.exec(n)[0]))}}_unescape(e){let t=!1;const n=e.replace(a,(e,n,r,i)=>{if("string"==typeof n)return String.fromCharCode(Number.parseInt(n,16));if("string"==typeof r){let e=Number.parseInt(r,16);return e<=65535?String.fromCharCode(Number.parseInt(r,16)):String.fromCharCode(55296+((e-=65536)>>10),56320+(1023&e))}return i in u?u[i]:(t=!0,"")});return t?null:n}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],n=t.length;let r=Math.max(this._literalClosingPos,n);for(;(r=e.indexOf(t,r))>0;){let t=0;for(;"\\"===e[r-t-1];)t++;if(t%2==0){const t=e.substring(n,r),i=t.split(/\r\n|\r|\n/).length-1,o=r+n;if(1===n&&0!==i||3===n&&this._lineMode)break;return this._line+=i,{value:this._unescape(t),matchLength:o}}r++}this._literalClosingPos=e.length-n+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,n){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof n){const e=[];let t;if(this._tokenizeToEnd((n,r)=>n?t=n:e.push(r),!0),t)throw t;return e}(0,i.default)(()=>this._tokenizeToEnd(n,!0))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",e=>{null!==this._input&&0!==e.length&&(this._pendingBuffer&&(e=t.concat([this._pendingBuffer,e]),this._pendingBuffer=null),128&e[e.length-1]?this._pendingBuffer=e:(void 0===this._input?this._input=this._readStartingBom("string"==typeof e?e:e.toString()):this._input+=e,this._tokenizeToEnd(n,!1)))}),e.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(n,!0)}),e.on("error",n)}}}).call(this)}).call(this,e("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(e("./N3Lexer")),i=s(e("./N3DataFactory")),o=s(e("./IRIs"));function s(e){return e&&e.__esModule?e:{default:e}}let a=0;class u{constructor(e){this._contextStack=[],this._graph=null,this._setBase((e=e||{}).baseIRI),e.factory&&l(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",n=/turtle/.test(t),i=/trig/.test(t),o=/triple/.test(t),s=/quad/.test(t),a=this._n3Mode=/n3/.test(t),u=o||s;(this._supportsNamedGraphs=!(n||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||i||o||a),this._supportsRDFStar=""===t||/star|\*$/.test(t),u&&(this._resolveRelativeIRI=e=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new r.default({lineMode:u,n3:a}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){a=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,n,r,i){const o=this._n3Mode;this._contextStack.push({subject:n,predicate:r,object:i,graph:t,type:e,inverse:!!o&&this._inversePredicate,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const e=this._contextStack.pop(),t=this._n3Mode;this._subject=e.subject,this._predicate=e.predicate,this._object=e.object,this._graph=e.graph,t&&(this._inversePredicate=e.inverse,this._prefixes._=e.blankPrefix,this._quantified=e.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let n;switch(e.type){case"IRI":case"typeIRI":const t=this._resolveIRI(e.value);if(null===t)return this._error("Invalid IRI",e);n=this._namedNode(t);break;case"type":case"prefixed":const r=this._prefixes[e.prefix];if(void 0===r)return this._error(`Undefined prefix "${e.prefix}:"`,e);n=this._namedNode(r+e.value);break;case"blank":n=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":n=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext(),null===this._object?t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,n=null,r=this._readListItem;const i=this._subject,o=this._contextStack,s=o[o.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,n=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),r=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==o.length&&"list"===o[o.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(r=this._readPredicate,this._subject===this.RDF_NIL)return r}else if(r=this._getContextEndReader(),this._object===this.RDF_NIL)return r;n=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,r=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),r=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===n&&(this._subject=n=this._blankNode()),null===i?null===s.predicate?s.subject=n:s.object=n:this._emit(i,this.RDF_REST,n,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,n,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,t,this._graph)}return r}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const n=this._readEntity(e);if(void 0===n)return;t=this._literal(this._literalValue,n),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const n=this._completeLiteral(e);if(n)return this._object=n.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===n.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(n.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,n=this._graph;const r=this._subject,i=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==r){const e=this._predicate,t=this._object;i?this._emit(t,e,r,n):this._emit(r,e,t,n)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,n=t.length&&t[t.length-1];if(n&&"item"===n.type){const e=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,e,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,n;const r=this._blankNode();if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=r):(t=this._object,this._object=r),this._emit(t,n,r,this._graph),this._readPath}_readBackwardPath(e){const t=this._blankNode();let n,r;if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(r=this._subject,this._subject=t):(r=this._object,this._object=t),this._emit(t,n,r,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,n,r){this._callback(null,this._quad(e,t,n,r||this.DEFAULTGRAPH))}_error(e,t){const n=new Error(`${e} on line ${t.line}.`);n.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=c}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let n="",r=-1,i=-1,o=0,s="/";for(;r<t;){switch(s){case":":if(i<0&&"/"===e[++r]&&"/"===e[++r])for(;(i=r+1)<t&&"/"!==e[i];)r=i;break;case"?":case"#":r=t;break;case"/":if("."===e[r+1])switch(s=e[1+ ++r],s){case"/":n+=e.substring(o,r-1),o=r+1;break;case void 0:case"?":case"#":return n+e.substring(o,r)+e.substr(r+1);case".":if(s=e[1+ ++r],void 0===s||"/"===s||"?"===s||"#"===s){if(n+=e.substring(o,r-2),(o=n.lastIndexOf("/"))>=i&&(n=n.substr(0,o)),"/"!==s)return`${n}/${e.substr(r+1)}`;o=r+1}}}s=e[++r]}return n+e.substring(o)}parse(e,t,n){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${a++}_`,this._prefixCallback=n||c,this._inversePredicate=!1,this._quantified=Object.create(null),!t){const t=[];let n;if(this._callback=(e,r)=>{e?n=e:r&&t.push(r)},this._lexer.tokenize(e).every(e=>this._readCallback=this._readCallback(e)),n)throw n;return t}this._callback=t,this._lexer.tokenize(e,(e,t)=>{null!==e?(this._callback(e),this._callback=c):this._readCallback&&(this._readCallback=this._readCallback(t))})}}function c(){}function l(e,t){const n=t.namedNode;e._namedNode=n,e._blankNode=t.blankNode,e._literal=t.literal,e._variable=t.variable,e._quad=t.quad,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=n(o.default.rdf.first),e.RDF_REST=n(o.default.rdf.rest),e.RDF_NIL=n(o.default.rdf.nil),e.N3_FORALL=n(o.default.r.forAll),e.N3_FORSOME=n(o.default.r.forSome),e.ABBREVIATIONS={a:n(o.default.rdf.type),"=":n(o.default.owl.sameAs),">":n(o.default.log.implies)},e.QUANTIFIERS_GRAPH=n("urn:n3:quantifiers")}n.default=u,l(u.prototype,i.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(e("./N3DataFactory")),o=e("readable-stream"),s=(r=e("./IRIs"))&&r.__esModule?r:{default:r};function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}class u{constructor(e,t){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),this._factory=(t=t||{}).factory||i.default,e&&this.addQuads(e)}get size(){let e=this._size;if(null!==e)return e;e=0;const t=this._graphs;let n,r;for(const i in t)for(const o in n=t[i].subjects)for(const t in r=n[o])e+=Object.keys(r[t]).length;return this._size=e}_addToIndex(e,t,n,r){const i=e[t]||(e[t]={}),o=i[n]||(i[n]={}),s=r in o;return s||(o[r]=null),!s}_removeFromIndex(e,t,n,r){const i=e[t],o=i[n];delete o[r];for(const s in o)return;delete i[n];for(const s in i)return;delete e[t]}_findInIndex(e,t,n,r,o,s,a,u,c,l){let h,d,f;const p=!t+!n+!r>1?Object.keys(this._ids):this._entities;t&&((h=e,e={})[t]=h[t]);for(const g in e){const t=p[g];if(d=e[g]){n&&((h=d,d={})[n]=h[n]);for(const e in d){const n=p[e];if(f=d[e]){const e=r?r in f?[r]:[]:Object.keys(f);for(let r=0;r<e.length;r++){const h={subject:null,predicate:null,object:null};h[o]=(0,i.termFromId)(t,this._factory),h[s]=(0,i.termFromId)(n,this._factory),h[a]=(0,i.termFromId)(p[e[r]],this._factory);const d=this._factory.quad(h.subject,h.predicate,h.object,(0,i.termFromId)(u,this._factory));if(l)l.push(d);else if(c(d))return!0}}}}}return l}_loop(e,t){for(const n in e)t(n)}_loopByKey0(e,t,n){let r,i;if(r=e[t])for(i in r)n(i)}_loopByKey1(e,t,n){let r,i;for(r in e)i=e[r],i[t]&&n(r)}_loopBy2Keys(e,t,n,r){let i,o,s;if((i=e[t])&&(o=i[n]))for(s in o)r(s)}_countInIndex(e,t,n,r){let i,o,s,a=0;t&&((i=e,e={})[t]=i[t]);for(const u in e)if(o=e[u]){n&&((i=o,o={})[n]=i[n]);for(const e in o)(s=o[e])&&(r?r in s&&a++:a+=Object.keys(s).length)}return a}_getGraphs(e){if(!c(e))return this._graphs;const t={};return t[e]=this._graphs[e],t}_uniqueEntities(e){const t=Object.create(null);return n=>{n in t||(t[n]=!0,e((0,i.termFromId)(this._entities[n],this._factory)))}}add(e){return this.addQuad(e),this}addQuad(e,t,n,r){t||(r=e.graph,n=e.object,t=e.predicate,e=e.subject),e=(0,i.termToId)(e),t=(0,i.termToId)(t),n=(0,i.termToId)(n),r=(0,i.termToId)(r);let o=this._graphs[r];o||(o=this._graphs[r]={subjects:{},predicates:{},objects:{}},Object.freeze(o));const s=this._ids,a=this._entities;e=s[e]||(s[a[++this._id]=e]=this._id),t=s[t]||(s[a[++this._id]=t]=this._id),n=s[n]||(s[a[++this._id]=n]=this._id);const u=this._addToIndex(o.subjects,e,t,n);return this._addToIndex(o.predicates,t,n,e),this._addToIndex(o.objects,n,e,t),this._size=null,u}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}delete(e){return this.removeQuad(e),this}has(e){return 0!==this.getQuads(e.subject,e.predicate,e.object,e.graph).length}import(e){return e.on("data",e=>{this.addQuad(e)}),e}removeQuad(e,t,n,r){t||(r=e.graph,n=e.object,t=e.predicate,e=e.subject),e=(0,i.termToId)(e),t=(0,i.termToId)(t),n=(0,i.termToId)(n),r=(0,i.termToId)(r);const o=this._ids,s=this._graphs;let a,u,c;if(!((e=o[e])&&(t=o[t])&&(n=o[n])&&(a=s[r])&&(u=a.subjects[e])&&(c=u[t])&&n in c))return!1;for(e in this._removeFromIndex(a.subjects,e,t,n),this._removeFromIndex(a.predicates,t,n,e),this._removeFromIndex(a.objects,n,e,t),null!==this._size&&this._size--,a.subjects)return!0;return delete s[r],!0}removeQuads(e){for(let t=0;t<e.length;t++)this.removeQuad(e[t])}remove(e){return e.on("data",e=>{this.removeQuad(e)}),e}removeMatches(e,t,n,r){const i=new o.Readable({objectMode:!0});return i._read=()=>{for(const o of this.getQuads(e,t,n,r))i.push(o);i.push(null)},this.remove(i)}deleteGraph(e){return this.removeMatches(null,null,null,e)}getQuads(e,t,n,r){e=e&&(0,i.termToId)(e),t=t&&(0,i.termToId)(t),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const o=[],s=this._getGraphs(r),a=this._ids;let u,l,h,d;if(c(e)&&!(l=a[e])||c(t)&&!(h=a[t])||c(n)&&!(d=a[n]))return o;for(const i in s)(u=s[i])&&(l?d?this._findInIndex(u.objects,d,l,h,"object","subject","predicate",i,null,o):this._findInIndex(u.subjects,l,h,null,"subject","predicate","object",i,null,o):h?this._findInIndex(u.predicates,h,d,null,"predicate","object","subject",i,null,o):d?this._findInIndex(u.objects,d,null,null,"object","subject","predicate",i,null,o):this._findInIndex(u.subjects,null,null,null,"subject","predicate","object",i,null,o));return o}match(e,t,n,r){return new l(this,e,t,n,r)}countQuads(e,t,n,r){e=e&&(0,i.termToId)(e),t=t&&(0,i.termToId)(t),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const o=this._getGraphs(r),s=this._ids;let a,u,l,h,d=0;if(c(e)&&!(u=s[e])||c(t)&&!(l=s[t])||c(n)&&!(h=s[n]))return 0;for(const i in o)(a=o[i])&&(d+=e?n?this._countInIndex(a.objects,h,u,l):this._countInIndex(a.subjects,u,l,h):t?this._countInIndex(a.predicates,l,h,u):this._countInIndex(a.objects,h,u,l));return d}forEach(e,t,n,r,i){this.some(t=>(e(t),!1),t,n,r,i)}every(e,t,n,r,i){let o=!1;const s=!this.some(t=>(o=!0,!e(t)),t,n,r,i);return o&&s}some(e,t,n,r,o){t=t&&(0,i.termToId)(t),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r),o=o&&(0,i.termToId)(o);const s=this._getGraphs(o),a=this._ids;let u,l,h,d;if(c(t)&&!(l=a[t])||c(n)&&!(h=a[n])||c(r)&&!(d=a[r]))return!1;for(const i in s)if(u=s[i])if(l){if(d){if(this._findInIndex(u.objects,d,l,h,"object","subject","predicate",i,e,null))return!0}else if(this._findInIndex(u.subjects,l,h,null,"subject","predicate","object",i,e,null))return!0}else if(h){if(this._findInIndex(u.predicates,h,d,null,"predicate","object","subject",i,e,null))return!0}else if(d){if(this._findInIndex(u.objects,d,null,null,"object","subject","predicate",i,e,null))return!0}else if(this._findInIndex(u.subjects,null,null,null,"subject","predicate","object",i,e,null))return!0;return!1}getSubjects(e,t,n){const r=[];return this.forSubjects(e=>{r.push(e)},e,t,n),r}forSubjects(e,t,n,r){t=t&&(0,i.termToId)(t),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const o=this._ids,s=this._getGraphs(r);let a,u,l;if(e=this._uniqueEntities(e),!(c(t)&&!(u=o[t])||c(n)&&!(l=o[n])))for(r in s)(a=s[r])&&(u?l?this._loopBy2Keys(a.predicates,u,l,e):this._loopByKey1(a.subjects,u,e):l?this._loopByKey0(a.objects,l,e):this._loop(a.subjects,e))}getPredicates(e,t,n){const r=[];return this.forPredicates(e=>{r.push(e)},e,t,n),r}forPredicates(e,t,n,r){t=t&&(0,i.termToId)(t),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const o=this._ids,s=this._getGraphs(r);let a,u,l;if(e=this._uniqueEntities(e),!(c(t)&&!(u=o[t])||c(n)&&!(l=o[n])))for(r in s)(a=s[r])&&(u?l?this._loopBy2Keys(a.objects,l,u,e):this._loopByKey0(a.subjects,u,e):l?this._loopByKey1(a.predicates,l,e):this._loop(a.predicates,e))}getObjects(e,t,n){const r=[];return this.forObjects(e=>{r.push(e)},e,t,n),r}forObjects(e,t,n,r){t=t&&(0,i.termToId)(t),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const o=this._ids,s=this._getGraphs(r);let a,u,l;if(e=this._uniqueEntities(e),!(c(t)&&!(u=o[t])||c(n)&&!(l=o[n])))for(r in s)(a=s[r])&&(u?l?this._loopBy2Keys(a.subjects,u,l,e):this._loopByKey1(a.objects,u,e):l?this._loopByKey0(a.predicates,l,e):this._loop(a.objects,e))}getGraphs(e,t,n){const r=[];return this.forGraphs(e=>{r.push(e)},e,t,n),r}forGraphs(e,t,n,r){for(const i in this._graphs)this.some(t=>(e(t.graph),!0),t,n,r,i)}createBlankNode(e){let t,n;if(e)for(t=e=`_:${e}`,n=1;this._ids[t];)t=e+n++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,this._factory.blankNode(t.substr(2))}extractLists({remove:e=!1,ignoreErrors:t=!1}={}){const n={},r=t?()=>!0:(e,t)=>{throw new Error(`${e.value} ${t}`)},i=this.getQuads(null,s.default.rdf.rest,s.default.rdf.nil,null),o=e?[...i]:[];return i.forEach(t=>{const i=[];let a,u,c=!1;const l=t.graph;let h=t.subject;for(;h&&!c;){const e=this.getQuads(null,null,h,null),t=this.getQuads(h,null,null,null);let n,d=null,f=null,p=null;for(let i=0;i<t.length&&!c;i++)n=t[i],n.graph.equals(l)?a?c=r(h,"has non-list arcs out"):n.predicate.value===s.default.rdf.first?d?c=r(h,"has multiple rdf:first arcs"):o.push(d=n):n.predicate.value===s.default.rdf.rest?f?c=r(h,"has multiple rdf:rest arcs"):o.push(f=n):e.length?c=r(h,"can't be subject and object"):(a=n,u="subject"):c=r(h,"not confined to single graph");for(let i=0;i<e.length&&!c;++i)n=e[i],a?c=r(h,"can't have coreferences"):n.predicate.value===s.default.rdf.rest?p?c=r(h,"has incoming rdf:rest arcs"):p=n:(a=n,u="object");d?i.unshift(d.object):c=r(h,"has no list head"),h=p&&p.subject}c?e=!1:a&&(n[a[u].value]=i)}),e&&this.removeQuads(o),n}*[Symbol.iterator](){yield*this.getQuads()}}function c(e){return"string"==typeof e||e instanceof String}n.default=u;class l extends o.Readable{constructor(e,t,n,r,i){super({objectMode:!0}),Object.assign(this,{n3Store:e,subject:t,predicate:n,object:r,graph:i})}get filtered(){if(!this._filtered){const{n3Store:e,graph:t,object:n,predicate:r,subject:i}=this,o=e.getQuads(i,r,n,t);this._filtered=new u(o,{factory:e._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const e of this.filtered.getQuads())this.push(e);this.push(null)}add(e){return this.filtered.add(e)}delete(e){return this.filtered.delete(e)}has(e){return this.filtered.has(e)}match(e,t,n,r){return new l(this.filtered,e,t,n,r)}*[Symbol.iterator](){yield*this.filtered.getQuads()}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=(r=e("./N3Parser"))&&r.__esModule?r:{default:r},o=e("readable-stream");n.default=class extends o.Transform{constructor(e){let t,n;super({decodeStrings:!0}),this._readableState.objectMode=!0,new i.default(e).parse({on:(e,r)=>{switch(e){case"data":t=r;break;case"end":n=r}}},(e,t)=>{e&&this.emit("error",e)||t&&this.push(t)},(e,t)=>{this.emit("prefix",e,t)}),this._transform=(e,n,r)=>{t(e),r()},this._flush=e=>{n(),e()}}import(e){return e.on("data",e=>{this.write(e)}),e.on("end",()=>{this.end()}),e.on("error",e=>{this.emit("error",e)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=e("readable-stream"),o=(r=e("./N3Writer"))&&r.__esModule?r:{default:r};n.default=class extends i.Transform{constructor(e){super({encoding:"utf8",writableObjectMode:!0});const t=this._writer=new o.default({write:(e,t,n)=>{this.push(e),n&&n()},end:e=>{this.push(null),e&&e()}},e);this._transform=(e,n,r)=>{t.addQuad(e,r)},this._flush=e=>{t.end(e)}}import(e){return e.on("data",e=>{this.write(e)}),e.on("end",()=>{this.end()}),e.on("error",e=>{this.emit("error",e)}),e.on("prefix",(e,t)=>{this._writer.addPrefix(e,t)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isNamedNode=function(e){return!!e&&"NamedNode"===e.termType},n.isBlankNode=function(e){return!!e&&"BlankNode"===e.termType},n.isLiteral=function(e){return!!e&&"Literal"===e.termType},n.isVariable=function(e){return!!e&&"Variable"===e.termType},n.isDefaultGraph=o,n.inDefaultGraph=function(e){return o(e.graph)},n.prefix=function(e,t){return s({"":e},t)("")},n.prefixes=s;var r,i=(r=e("./N3DataFactory"))&&r.__esModule?r:{default:r};function o(e){return!!e&&"DefaultGraph"===e.termType}function s(e,t){const n=Object.create(null);for(const i in e)r(i,e[i]);function r(e,r){if("string"==typeof r){const i=Object.create(null);n[e]=e=>i[e]||(i[e]=t.namedNode(r+e))}else if(!(e in n))throw new Error(`Unknown prefix: ${e}`);return n[e]}return t=t||i.default,r}},{"./N3DataFactory":35}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=(r=e("./IRIs"))&&r.__esModule?r:{default:r},o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(e("./N3DataFactory")),s=e("./N3Util");function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}const u=o.default.defaultGraph(),{rdf:c,xsd:l}=i.default,h=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,d=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,f={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class p extends o.Term{equals(){return!1}}function g(e){let t=f[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}n.default=class{constructor(e,t){if(this._prefixRegex=/$0^/,e&&"function"!=typeof e.write&&(t=e,e=null),this._lists=(t=t||{}).lists,e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{let e="";this._outputStream={write(t,n,r){e+=t,r&&r()},end:t=>{t&&t(null,e)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=u,this._baseIRI=t.baseIRI,this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}get _inDefaultGraph(){return u.equals(this._graph)}_write(e,t){this._outputStream.write(e,"utf8",t)}_writeQuad(e,t,n,r,i){try{r.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(u.equals(r)?"":`${this._encodeIriOrBlank(r)} {\n`)),this._graph=r,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(`, ${this._encodeObject(n)}`,i):this._write(`;\n    ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(n)}`,i):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(n)}`,i)}catch(o){i&&i(o)}}_writeQuadLine(e,t,n,r,i){delete this._prefixMatch,this._write(this.quadToString(e,t,n,r),i)}quadToString(e,t,n,r){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(t)} ${this._encodeObject(n)}${r&&r.value?` ${this._encodeIriOrBlank(r)} .\n`:" .\n"}`}quadsToString(e){return e.map(e=>this.quadToString(e.subject,e.predicate,e.object,e.graph)).join("")}_encodeSubject(e){return"Quad"===e.termType?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if("NamedNode"!==e.termType)return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let t=e.value;this._baseIRI&&t.startsWith(this._baseIRI)&&(t=t.substr(this._baseIRI.length)),h.test(t)&&(t=t.replace(d,g));const n=this._prefixRegex.exec(t);return n?n[1]?this._prefixIRIs[n[1]]+n[2]:t:`<${t}>`}_encodeLiteral(e){let t=e.value;if(h.test(t)&&(t=t.replace(d,g)),e.language)return`"${t}"@${e.language}`;if(this._lineMode){if(e.datatype.value===l.string)return`"${t}"`}else switch(e.datatype.value){case l.string:return`"${t}"`;case l.boolean:if("true"===t||"false"===t)return t;break;case l.integer:if(/^[+-]?\d+$/.test(t))return t;break;case l.decimal:if(/^[+-]?\d*\.\d+$/.test(t))return t;break;case l.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(t))return t}return`"${t}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===c.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:t,object:n,graph:r}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(t)} ${this._encodeObject(n)}${(0,s.isDefaultGraph)(r)?"":` ${this._encodeIriOrBlank(r)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,t,n,r,i){void 0===n?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"==typeof r?this._writeQuad(e,t,n,u,r):this._writeQuad(e,t,n,r||u,i)}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}addPrefix(e,t,n){const r={};r[e]=t,this.addPrefixes(r,n)}addPrefixes(e,t){if(!this._prefixIRIs)return t&&t();let n=!1;for(let r in e){let t=e[r];"string"!=typeof t&&(t=t.value),n=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[t]=r+=":",this._write(`@prefix ${r} <${t}>.\n`)}if(n){let e="",t="";for(const n in this._prefixIRIs)e+=e?`|${n}`:n,t+=(t?"|":"")+this._prefixIRIs[n];e=e.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp(`^(?:${t})[^/]*$|^(${e})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(n?"\n":"",t)}blank(e,t){let n,r,i=e;switch(void 0===e?i=[]:e.termType?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),r=i.length){case 0:return new p("[]");case 1:if(n=i[0],!(n.object instanceof p))return new p(`[ ${this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)} ]`);default:let t="[";for(let o=0;o<r;o++)n=i[o],n.predicate.equals(e)?t+=`, ${this._encodeObject(n.object)}`:(t+=`${(o?";\n  ":"\n  ")+this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)}`,e=n.predicate);return new p(`${t}\n]`)}}list(e){const t=e&&e.length||0,n=new Array(t);for(let r=0;r<t;r++)n[r]=this._encodeObject(e[r]);return new p(`(${n.join(" ")})`)}end(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let t=e&&((n,r)=>{t=null,e(n,r)});if(this._endStream)try{return this._outputStream.end(t)}catch(n){}t&&t()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Lexer",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"Parser",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"Writer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"Store",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"StreamParser",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"StreamWriter",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"DataFactory",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"Term",{enumerable:!0,get:function(){return l.Term}}),Object.defineProperty(n,"NamedNode",{enumerable:!0,get:function(){return l.NamedNode}}),Object.defineProperty(n,"Literal",{enumerable:!0,get:function(){return l.Literal}}),Object.defineProperty(n,"BlankNode",{enumerable:!0,get:function(){return l.BlankNode}}),Object.defineProperty(n,"Variable",{enumerable:!0,get:function(){return l.Variable}}),Object.defineProperty(n,"DefaultGraph",{enumerable:!0,get:function(){return l.DefaultGraph}}),Object.defineProperty(n,"Quad",{enumerable:!0,get:function(){return l.Quad}}),Object.defineProperty(n,"Triple",{enumerable:!0,get:function(){return l.Triple}}),Object.defineProperty(n,"termFromId",{enumerable:!0,get:function(){return l.termFromId}}),Object.defineProperty(n,"termToId",{enumerable:!0,get:function(){return l.termToId}}),n.Util=void 0;var r=f(e("./N3Lexer")),i=f(e("./N3Parser")),o=f(e("./N3Writer")),s=f(e("./N3Store")),a=f(e("./N3StreamParser")),u=f(e("./N3StreamWriter")),c=d(e("./N3Util"));n.Util=c;var l=d(e("./N3DataFactory"));function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function f(e){return e&&e.__esModule?e:{default:e}}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(e,t,n){var r,i,o=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var c,l=[],h=!1,d=-1;function f(){h&&c&&(h=!1,c.length?l=c.concat(l):d=-1,l.length&&p())}function p(){if(!h){var e=u(f);h=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new g(e,t)),1!==l.length||h||u(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],45:[function(e,t,n){(function(e){(function(){let n;t.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:e):e=>(n||(n=Promise.resolve())).then(e).catch(e=>setTimeout(()=>{throw e},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(e,t,n){t.exports=e("./lib")},{"./lib":55}],47:[function(e,t,n){"use strict";t.exports=class e{constructor(e,t=new Map,n=0){this.prefix=e,this._existing=t,this.counter=n}clone(){const{prefix:t,_existing:n,counter:r}=this;return new e(t,new Map(n),r)}getId(e){const t=e&&this._existing.get(e);if(t)return t;const n=this.prefix+this.counter;return this.counter++,e&&this._existing.set(e,n),n}hasId(e){return this._existing.has(e)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(e,t,n){"use strict";e("setimmediate");const r=self.crypto||self.msCrypto;t.exports=class{constructor(e){if(!r||!r.subtle)throw new Error("crypto.subtle not found.");if("sha256"===e)this.algorithm={name:"SHA-256"};else{if("sha1"!==e)throw new Error(`Unsupport algorithm "${e}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(e){this._content+=e}async digest(){const e=(new TextEncoder).encode(this._content),t=new Uint8Array(await r.subtle.digest(this.algorithm,e));let n="";for(let r=0;r<t.length;++r)n+=t[r].toString(16).padStart(2,"0");return n}}},{setimmediate:86}],49:[function(e,t,n){"use strict";const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",i="http://www.w3.org/2001/XMLSchema#string",o="NamedNode",s="BlankNode",a="Literal",u="DefaultGraph",c={eoln:/(?:\r\n)|(?:\n)|(?:\r)/g};c.empty=new RegExp("^[ \\t]*$"),c.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),t.exports=class e{static parse(e){const t=[],n={},l=e.split(c.eoln);let d=0;for(const g of l){if(d++,c.empty.test(g))continue;const e=g.match(c.quad);if(null===e)throw new Error("N-Quads parse error on line "+d+".");const l={subject:null,predicate:null,object:null,graph:null};if(l.subject=void 0!==e[1]?{termType:o,value:e[1]}:{termType:s,value:e[2]},l.predicate={termType:o,value:e[3]},void 0!==e[4]?l.object={termType:o,value:e[4]}:void 0!==e[5]?l.object={termType:s,value:e[5]}:(l.object={termType:a,value:void 0,datatype:{termType:o}},void 0!==e[7]?l.object.datatype.value=e[7]:void 0!==e[8]?(l.object.datatype.value=r,l.object.language=e[8]):l.object.datatype.value=i,l.object.value=e[6].replace(h,function(e,t,n,r){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(n)return String.fromCharCode(parseInt(n,16));if(r)throw new Error("Unsupported U escape")})),l.graph=void 0!==e[9]?{termType:o,value:e[9]}:void 0!==e[10]?{termType:s,value:e[10]}:{termType:u,value:""},l.graph.value in n){let e=!0;const r=n[l.graph.value];for(const t of r)if((f=t).subject.termType===(p=l).subject.termType&&f.object.termType===p.object.termType&&f.subject.value===p.subject.value&&f.predicate.value===p.predicate.value&&f.object.value===p.object.value&&(f.object.termType!==a||f.object.datatype.termType===p.object.datatype.termType&&f.object.language===p.object.language&&f.object.datatype.value===p.object.datatype.value)){e=!1;break}e&&(r.push(l),t.push(l))}else n[l.graph.value]=[l],t.push(l)}var f,p;return t}static serialize(t){Array.isArray(t)||(t=e.legacyDatasetToQuads(t));const n=[];for(const r of t)n.push(e.serializeQuad(r));return n.sort().join("")}static serializeQuad(e){const t=e.subject,n=e.object,a=e.graph;let u="";return u+=t.termType===o?`<${t.value}>`:`${t.value}`,u+=` <${e.predicate.value}> `,n.termType===o?u+=`<${n.value}>`:n.termType===s?u+=n.value:(u+=`"${function(e){return e.replace(l,function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}(n.value)}"`,n.datatype.value===r?n.language&&(u+=`@${n.language}`):n.datatype.value!==i&&(u+=`^^<${n.datatype.value}>`)),a.termType===o?u+=` <${a.value}>`:a.termType===s&&(u+=` ${a.value}`),u+=" .\n",u}static legacyDatasetToQuads(e){const t=[],n={"blank node":s,IRI:o,literal:a};for(const c in e)e[c].forEach(e=>{const l={};for(const t in e){const s=e[t],u={termType:n[s.type],value:s.value};u.termType===a&&(u.datatype={termType:o},"datatype"in s&&(u.datatype.value=s.datatype),"language"in s?("datatype"in s||(u.datatype.value=r),u.language=s.language):"datatype"in s||(u.datatype.value=i)),l[t]=u}l.graph="@default"===c?{termType:u,value:""}:{termType:c.startsWith("_:")?s:o,value:c},t.push(l)});return t}};const l=/["\\\n\r]/g,h=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(e,t,n){"use strict";t.exports=class{constructor(e){this.current=e.sort(),this.done=!1,this.dir=new Map;for(let t=0;t<e.length;++t)this.dir.set(e[t],!0)}hasNext(){return!this.done}next(){const{current:e,dir:t}=this,n=e.slice();let r=null,i=0;const o=e.length;for(let s=0;s<o;++s){const n=e[s],a=t.get(n);(null===r||n>r)&&(a&&s>0&&n>e[s-1]||!a&&s<o-1&&n>e[s+1])&&(r=n,i=s)}if(null===r)this.done=!0;else{const n=t.get(r)?i-1:i+1;e[i]=e[n],e[n]=r;for(const i of e)i>r&&t.set(i,!t.get(i))}return n}}},{}],51:[function(e,t,n){(function(n){(function(){"use strict";const r=e("./IdentifierIssuer"),i=e("./MessageDigest"),o=e("./Permuter"),s=e("./NQuads");function a(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}t.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new r("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}async main(e){this.quads=e;for(const r of e)this._addBlankNodeQuadInfo({quad:r,component:r.subject}),this._addBlankNodeQuadInfo({quad:r,component:r.object}),this._addBlankNodeQuadInfo({quad:r,component:r.graph});const t=new Map,n=[...this.blankNodeInfo.keys()];let i=0;for(const r of n)++i%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:r,hashToBlankNodes:t});const o=[...t.keys()].sort(),u=[];for(const r of o){const e=t.get(r);e.length>1?u.push(e):this.canonicalIssuer.getId(e[0])}for(const s of u){const e=[];for(const t of s){if(this.canonicalIssuer.hasId(t))continue;const n=new r("_:b");n.getId(t);const i=await this.hashNDegreeQuads(t,n);e.push(i)}e.sort(a);for(const t of e){const e=t.issuer.getOldIds();for(const t of e)this.canonicalIssuer.getId(t)}}const c=[];for(const r of this.quads){const e={...r};e.subject=this._useCanonicalId({component:e.subject}),e.object=this._useCanonicalId({component:e.object}),e.graph=this._useCanonicalId({component:e.graph}),c.push(s.serializeQuad(e))}return c.sort(),c.join("")}async hashFirstDegreeQuads(e){const t=[],n=this.blankNodeInfo.get(e),r=n.quads;for(const i of r){const n={subject:null,predicate:i.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(e,i.subject,"subject"),n.object=this.modifyFirstDegreeComponent(e,i.object,"object"),n.graph=this.modifyFirstDegreeComponent(e,i.graph,"graph"),t.push(s.serializeQuad(n))}t.sort();const o=new i(this.hashAlgorithm);for(const i of t)o.update(i);return n.hash=await o.digest(),n.hash}async hashRelatedBlankNode(e,t,n,r){let o;o=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.blankNodeInfo.get(e).hash;const s=new i(this.hashAlgorithm);return s.update(r),"g"!==r&&s.update(this.getRelatedPredicate(t)),s.update(o),s.digest()}async hashNDegreeQuads(e,t){const n=new i(this.hashAlgorithm),r=await this.createHashToRelated(e,t),s=[...r.keys()].sort();for(const i of s){n.update(i);let e,s="";const a=new o(r.get(i));let u=0;for(;a.hasNext();){const n=a.next();++u%3==0&&await this._yield();let r=t.clone(),i="";const o=[];let c=!1;for(const e of n)if(this.canonicalIssuer.hasId(e)?i+=this.canonicalIssuer.getId(e):(r.hasId(e)||o.push(e),i+=r.getId(e)),0!==s.length&&i>s){c=!0;break}if(!c){for(const e of o){const t=await this.hashNDegreeQuads(e,r);if(i+=r.getId(e),i+=`<${t.hash}>`,r=t.issuer,0!==s.length&&i>s){c=!0;break}}c||(0===s.length||i<s)&&(s=i,e=r)}}n.update(s),t=e}return{hash:await n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}async createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;let i=0;for(const o of r)++i%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:o,component:o.subject,position:"s",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:o,component:o.object,position:"o",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:o,component:o.graph,position:"g",id:e,issuer:t,hashToRelated:n})]);return n}async _hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const n=await this.hashFirstDegreeQuads(e),r=t.get(n);r?r.push(e):t.set(n,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const n=t.value,r=this.blankNodeInfo.get(n);r?r.quads.add(e):this.blankNodeInfo.set(n,{quads:new Set([e]),hash:null})}async _addRelatedBlankNodeHash({quad:e,component:t,position:n,id:r,issuer:i,hashToRelated:o}){if("BlankNode"!==t.termType||t.value===r)return;const s=t.value,a=await this.hashRelatedBlankNode(s,e,i,n),u=o.get(a);u?u.push(s):o.set(a,[s])}_useCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}async _yield(){return new Promise(e=>n(e))}}}).call(this)}).call(this,e("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(e,t,n){"use strict";const r=e("./IdentifierIssuer"),i=e("./MessageDigest"),o=e("./Permuter"),s=e("./NQuads");function a(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}t.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new r("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(e){this.quads=e;for(const r of e)this._addBlankNodeQuadInfo({quad:r,component:r.subject}),this._addBlankNodeQuadInfo({quad:r,component:r.object}),this._addBlankNodeQuadInfo({quad:r,component:r.graph});const t=new Map,n=[...this.blankNodeInfo.keys()];for(const r of n)this._hashAndTrackBlankNode({id:r,hashToBlankNodes:t});const i=[...t.keys()].sort(),o=[];for(const r of i){const e=t.get(r);e.length>1?o.push(e):this.canonicalIssuer.getId(e[0])}for(const s of o){const e=[];for(const t of s){if(this.canonicalIssuer.hasId(t))continue;const n=new r("_:b");n.getId(t);const i=this.hashNDegreeQuads(t,n);e.push(i)}e.sort(a);for(const t of e){const e=t.issuer.getOldIds();for(const t of e)this.canonicalIssuer.getId(t)}}const u=[];for(const r of this.quads){const e={...r};e.subject=this._useCanonicalId({component:e.subject}),e.object=this._useCanonicalId({component:e.object}),e.graph=this._useCanonicalId({component:e.graph}),u.push(s.serializeQuad(e))}return u.sort(),u.join("")}hashFirstDegreeQuads(e){const t=[],n=this.blankNodeInfo.get(e),r=n.quads;for(const i of r){const n={subject:null,predicate:i.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(e,i.subject,"subject"),n.object=this.modifyFirstDegreeComponent(e,i.object,"object"),n.graph=this.modifyFirstDegreeComponent(e,i.graph,"graph"),t.push(s.serializeQuad(n))}t.sort();const o=new i(this.hashAlgorithm);for(const i of t)o.update(i);return n.hash=o.digest(),n.hash}hashRelatedBlankNode(e,t,n,r){let o;o=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.blankNodeInfo.get(e).hash;const s=new i(this.hashAlgorithm);return s.update(r),"g"!==r&&s.update(this.getRelatedPredicate(t)),s.update(o),s.digest()}hashNDegreeQuads(e,t){const n=new i(this.hashAlgorithm),r=this.createHashToRelated(e,t),s=[...r.keys()].sort();for(const i of s){n.update(i);let e,s="";const a=new o(r.get(i));for(;a.hasNext();){const n=a.next();let r=t.clone(),i="";const o=[];let u=!1;for(const e of n)if(this.canonicalIssuer.hasId(e)?i+=this.canonicalIssuer.getId(e):(r.hasId(e)||o.push(e),i+=r.getId(e)),0!==s.length&&i>s){u=!0;break}if(!u){for(const e of o){const t=this.hashNDegreeQuads(e,r);if(i+=r.getId(e),i+=`<${t.hash}>`,r=t.issuer,0!==s.length&&i>s){u=!0;break}}u||(0===s.length||i<s)&&(s=i,e=r)}}n.update(s),t=e}return{hash:n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;for(const i of r)this._addRelatedBlankNodeHash({quad:i,component:i.subject,position:"s",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:i,component:i.object,position:"o",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:i,component:i.graph,position:"g",id:e,issuer:t,hashToRelated:n});return n}_hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const n=this.hashFirstDegreeQuads(e),r=t.get(n);r?r.push(e):t.set(n,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const n=t.value,r=this.blankNodeInfo.get(n);r?r.quads.add(e):this.blankNodeInfo.set(n,{quads:new Set([e]),hash:null})}_addRelatedBlankNodeHash({quad:e,component:t,position:n,id:r,issuer:i,hashToRelated:o}){if("BlankNode"!==t.termType||t.value===r)return;const s=t.value,a=this.hashRelatedBlankNode(s,e,i,n),u=o.get(a);u?u.push(s):o.set(a,[s])}_useCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(e,t,n){"use strict";const r=e("./URDNA2015");t.exports=class extends r{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}async createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;let i=0;for(const o of r){let r,s;if("BlankNode"===o.subject.termType&&o.subject.value!==e)s=o.subject.value,r="p";else{if("BlankNode"!==o.object.termType||o.object.value===e)continue;s=o.object.value,r="r"}++i%100==0&&await this._yield();const a=await this.hashRelatedBlankNode(s,o,t,r),u=n.get(a);u?u.push(s):n.set(a,[s])}return n}}},{"./URDNA2015":51}],54:[function(e,t,n){"use strict";const r=e("./URDNA2015Sync");t.exports=class extends r{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;for(const i of r){let r,o;if("BlankNode"===i.subject.termType&&i.subject.value!==e)o=i.subject.value,r="p";else{if("BlankNode"!==i.object.termType||i.object.value===e)continue;o=i.object.value,r="r"}const s=this.hashRelatedBlankNode(o,i,t,r),a=n.get(s);a?a.push(o):n.set(s,[o])}return n}}},{"./URDNA2015Sync":52}],55:[function(e,t,n){"use strict";const r=e("./URDNA2015"),i=e("./URGNA2012"),o=e("./URDNA2015Sync"),s=e("./URGNA2012Sync");let a;try{a=e("rdf-canonize-native")}catch(c){}const u={};t.exports=u,u.NQuads=e("./NQuads"),u.IdentifierIssuer=e("./IdentifierIssuer"),u._rdfCanonizeNative=function(e){return e&&(a=e),a},u.canonize=async function(e,t){if(Array.isArray(e)||(e=u.NQuads.legacyDatasetToQuads(e)),t.useNative){if(!a)throw new Error("rdf-canonize-native not available");return new Promise((n,r)=>a.canonize(e,t,(e,t)=>e?r(e):n(t)))}if("URDNA2015"===t.algorithm)return new r(t).main(e);if("URGNA2012"===t.algorithm)return new i(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)},u._canonizeSync=function(e,t){if(Array.isArray(e)||(e=u.NQuads.legacyDatasetToQuads(e)),t.useNative){if(a)return a.canonizeSync(e,t);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===t.algorithm)return new o(t).main(e);if("URGNA2012"===t.algorithm)return new s(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./lib/BlankNode"),n),i(e("./lib/DataFactory"),n),i(e("./lib/DefaultGraph"),n),i(e("./lib/Literal"),n),i(e("./lib/NamedNode"),n),i(e("./lib/Quad"),n),i(e("./lib/Variable"),n)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BlankNode=void 0,n.BlankNode=class{constructor(e){this.termType="BlankNode",this.value=e}equals(e){return!!e&&"BlankNode"===e.termType&&e.value===this.value}}},{}],58:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DataFactory=void 0;const r=e("./BlankNode"),i=e("./DefaultGraph"),o=e("./Literal"),s=e("./NamedNode"),a=e("./Quad"),u=e("./Variable");let c=0;n.DataFactory=class{constructor(e){this.blankNodeCounter=0,this.blankNodePrefix=(e=e||{}).blankNodePrefix||`df_${c++}_`}namedNode(e){return new s.NamedNode(e)}blankNode(e){return new r.BlankNode(e||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(e,t){return new o.Literal(e,t)}variable(e){return new u.Variable(e)}defaultGraph(){return i.DefaultGraph.INSTANCE}quad(e,t,n,r){return new a.Quad(e,t,n,r||this.defaultGraph())}fromTerm(e){switch(e.termType){case"NamedNode":return this.namedNode(e.value);case"BlankNode":return this.blankNode(e.value);case"Literal":return e.language?this.literal(e.value,e.language):e.datatype.equals(o.Literal.XSD_STRING)?this.literal(e.value):this.literal(e.value,this.fromTerm(e.datatype));case"Variable":return this.variable(e.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(e.subject),this.fromTerm(e.predicate),this.fromTerm(e.object),this.fromTerm(e.graph))}}fromQuad(e){return this.fromTerm(e)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DefaultGraph=void 0;class r{constructor(){this.termType="DefaultGraph",this.value=""}equals(e){return!!e&&"DefaultGraph"===e.termType}}n.DefaultGraph=r,r.INSTANCE=new r},{}],60:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Literal=void 0;const r=e("./NamedNode");class i{constructor(e,t){this.termType="Literal",this.value=e,"string"==typeof t?(this.language=t,this.datatype=i.RDF_LANGUAGE_STRING):t?(this.language="",this.datatype=t):(this.language="",this.datatype=i.XSD_STRING)}equals(e){return!!e&&"Literal"===e.termType&&e.value===this.value&&e.language===this.language&&e.datatype.equals(this.datatype)}}n.Literal=i,i.RDF_LANGUAGE_STRING=new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),i.XSD_STRING=new r.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NamedNode=void 0,n.NamedNode=class{constructor(e){this.termType="NamedNode",this.value=e}equals(e){return!!e&&"NamedNode"===e.termType&&e.value===this.value}}},{}],62:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Quad=void 0,n.Quad=class{constructor(e,t,n,r){this.termType="Quad",this.value="",this.subject=e,this.predicate=t,this.object=n,this.graph=r}equals(e){return!!e&&("Quad"===e.termType||!e.termType)&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}}},{}],63:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Variable=void 0,n.Variable=class{constructor(e){this.termType="Variable",this.value=e}equals(e){return!!e&&"Variable"===e.termType&&e.value===this.value}}},{}],64:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}(e("./lib/RdfXmlParser"))},{"./lib/RdfXmlParser":66}],65:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends Error{constructor(e,t){const n=e.saxStream._parser;super(e.trackPosition?`Line ${n.line+1} column ${n.column+1}: ${t}`:t)}}n.ParseError=r},{}],66:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=e("relative-to-absolute-iri"),i=e("sax"),o=e("stream"),s=e("./ParseError"),a=e("rdf-data-factory");class u extends o.Transform{constructor(e){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},e&&(Object.assign(this,e),this.options=e),this.dataFactory||(this.dataFactory=new a.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=i.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(e,t){const n={};let r=!1;for(const o in e.attributes)o.startsWith("xmlns")&&(5===o.length?(r=!0,n[""]=e.attributes[o]):":"===o.charAt(5)&&(r=!0,n[o.substr(6)]=e.attributes[o]));const i=t&&t.ns?t.ns:[u.DEFAULT_NS];return r?i.concat([n]):i}static expandPrefixedTerm(e,t,n){const r=e.indexOf(":");let i,o;r>=0?(i=e.substr(0,r),o=e.substr(r+1)):(i="",o=e);let a=null,u=null;for(let s=t.length-1;s>=0;s--){const e=t[s][i];if(e){a=e;break}u||(u=t[s][""])}if(!a){if(i&&"xmlns"!==i)throw new s.ParseError(n,`The prefix '${i}' in term '${e}' was not bound.`);a=u||""}return{prefix:i,local:o,uri:a}}static isValidIri(e){return u.IRI_REGEX.test(e)}import(e){const t=new o.PassThrough({readableObjectMode:!0});e.on("error",e=>n.emit("error",e)),e.on("data",e=>t.push(e)),e.on("end",()=>t.push(null));const n=t.pipe(new u(this.options));return n}_transform(e,t,n){try{this.saxStream.write(e,t)}catch(r){return n(r)}n()}newParseError(e){return new s.ParseError(this,e)}valueToUri(e,t){return this.uriToNamedNode(r.resolve(e,t.baseIRI))}uriToNamedNode(e){if(!u.isValidIri(e))throw this.newParseError(`Invalid URI: ${e}`);return this.dataFactory.namedNode(e)}validateNcname(e){if(!u.NCNAME_MATCHER.test(e))throw this.newParseError(`Not a valid NCName: ${e}`)}attachSaxListeners(){this.saxStream.on("error",e=>this.emit("error",e)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(e){const t=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let n=c.RESOURCE;if(t&&(t.hadChildren=!0,n=t.childrenParseType),t&&t.childrenStringTags){const n=e.name;let r="";for(const t in e.attributes)r+=` ${t}="${e.attributes[t]}"`;t.childrenStringTags.push(`<${n}${r}>`);const i={childrenStringTags:t.childrenStringTags};return i.childrenStringEmitClosingTag=`</${n}>`,void this.activeTagStack.push(i)}const r={};t?(r.language=t.language,r.baseIRI=t.baseIRI):r.baseIRI=this.baseIRI,this.activeTagStack.push(r),r.ns=u.parseNamespace(e,t),n===c.RESOURCE?this.onTagResource(e,r,t,!t):this.onTagProperty(e,r,t)}onTagResource(e,t,n,i){const o=u.expandPrefixedTerm(e.name,t.ns,this);t.childrenParseType=c.PROPERTY;let s=!0;if(o.uri===u.RDF){if(!i&&u.FORBIDDEN_NODE_ELEMENTS.indexOf(o.local)>=0)throw this.newParseError(`Illegal node element name: ${o.local}`);switch(o.local){case"RDF":t.childrenParseType=c.RESOURCE;case"Description":s=!1}}const a=[],l=[];let h=null,d=!1,f=!1,p=null;for(const c in e.attributes){const i=e.attributes[c],o=u.expandPrefixedTerm(c,t.ns,this);if(n&&o.uri===u.RDF)switch(o.local){case"about":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${i} and ${h} where found.`);h=i;continue;case"ID":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${i} and ${h} where found.`);this.validateNcname(i),h="#"+i,d=!0;continue;case"nodeID":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${i} and ${h} where found.`);this.validateNcname(i),h=i,f=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":p=i;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(o.uri===u.XML){if("lang"===o.local){t.language=""===i?null:i.toLowerCase();continue}if("base"===o.local){t.baseIRI=r.resolve(i,t.baseIRI);continue}}"xml"!==o.prefix&&o.uri&&(a.push(this.uriToNamedNode(o.uri+o.local)),l.push(i))}if(null!==h&&(t.subject=f?this.dataFactory.blankNode(h):this.valueToUri(h,t),d&&this.claimNodeId(t.subject)),t.subject||(t.subject=this.dataFactory.blankNode()),s){const e=this.uriToNamedNode(o.uri+o.local);this.emitTriple(t.subject,this.dataFactory.namedNode(u.RDF+"type"),e,n?n.reifiedStatementId:null)}if(n){if(n.predicate)if(n.childrenCollectionSubject){const e=this.dataFactory.blankNode();this.emitTriple(n.childrenCollectionSubject,n.childrenCollectionPredicate,e,n.reifiedStatementId),this.emitTriple(e,this.dataFactory.namedNode(u.RDF+"first"),t.subject,t.reifiedStatementId),n.childrenCollectionSubject=e,n.childrenCollectionPredicate=this.dataFactory.namedNode(u.RDF+"rest")}else{this.emitTriple(n.subject,n.predicate,t.subject,n.reifiedStatementId);for(let e=0;e<n.predicateSubPredicates.length;e++)this.emitTriple(t.subject,n.predicateSubPredicates[e],n.predicateSubObjects[e],null);n.predicateSubPredicates=[],n.predicateSubObjects=[],n.predicateEmitted=!0}for(let e=0;e<a.length;e++){const r=this.dataFactory.literal(l[e],t.datatype||t.language);this.emitTriple(t.subject,a[e],r,n.reifiedStatementId)}p&&this.emitTriple(t.subject,this.dataFactory.namedNode(u.RDF+"type"),this.uriToNamedNode(p),null)}}onTagProperty(e,t,n){const r=u.expandPrefixedTerm(e.name,t.ns,this);if(t.childrenParseType=c.RESOURCE,t.subject=n.subject,r.uri===u.RDF&&"li"===r.local?(n.listItemCounter||(n.listItemCounter=1),t.predicate=this.uriToNamedNode(r.uri+"_"+n.listItemCounter++)):t.predicate=this.uriToNamedNode(r.uri+r.local),r.uri===u.RDF&&u.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(r.local)>=0)throw this.newParseError(`Illegal property element name: ${r.local}`);t.predicateSubPredicates=[],t.predicateSubObjects=[];let i=!1,o=!1,s=null,a=!0;const l=[],h=[];for(const d in e.attributes){const n=e.attributes[d],r=u.expandPrefixedTerm(d,t.ns,this);if(r.uri===u.RDF)switch(r.local){case"resource":if(s)throw this.newParseError(`Found both rdf:resource (${n}) and rdf:nodeID (${s}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${n})`);t.hadChildren=!0,s=n,a=!1;continue;case"datatype":if(o)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${n}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${n})`);t.datatype=this.valueToUri(n,t);continue;case"nodeID":if(o)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${n}).`);if(t.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${n}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${n})`);this.validateNcname(n),t.hadChildren=!0,s=n,a=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(o)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(t.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${t.datatype.value})`);if(s)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${s})`);if("Resource"===n){i=!0,t.childrenParseType=c.PROPERTY;const e=this.dataFactory.blankNode();this.emitTriple(t.subject,t.predicate,e,t.reifiedStatementId),t.subject=e,t.predicate=null}else"Collection"===n?(i=!0,t.hadChildren=!0,t.childrenCollectionSubject=t.subject,t.childrenCollectionPredicate=t.predicate,a=!1):"Literal"===n&&(i=!0,t.childrenTagsToString=!0,t.childrenStringTags=[]);continue;case"ID":this.validateNcname(n),t.reifiedStatementId=this.valueToUri("#"+n,t),this.claimNodeId(t.reifiedStatementId);continue}else if(r.uri===u.XML&&"lang"===r.local){t.language=""===n?null:n.toLowerCase();continue}if("xml"!==r.prefix&&"xmlns"!==r.prefix&&r.uri){if(i||t.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${n}`);t.hadChildren=!0,o=!0,l.push(this.uriToNamedNode(r.uri+r.local)),h.push(this.dataFactory.literal(n,t.datatype||t.language))}}if(null!==s){const e=t.subject;t.subject=a?this.dataFactory.blankNode(s):this.valueToUri(s,t),this.emitTriple(e,t.predicate,t.subject,t.reifiedStatementId);for(let n=0;n<l.length;n++)this.emitTriple(t.subject,l[n],h[n],null);t.predicateEmitted=!0}else a&&(t.predicateSubPredicates=l,t.predicateSubObjects=h,t.predicateEmitted=!1)}emitTriple(e,t,n,r){this.push(this.dataFactory.quad(e,t,n,this.defaultGraph)),r&&(this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(u.RDF+"type"),this.dataFactory.namedNode(u.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(u.RDF+"subject"),e,this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(u.RDF+"predicate"),t,this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(u.RDF+"object"),n,this.defaultGraph)))}claimNodeId(e){if(!this.allowDuplicateRdfIds){if(this.nodeIds[e.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${e.value}'.`);this.nodeIds[e.value]=!0}}onText(e){const t=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;t&&(t.childrenStringTags?t.childrenStringTags.push(e):t.predicate&&(t.text=e))}onCloseTag(){const e=this.activeTagStack.pop();if(e.childrenStringEmitClosingTag&&e.childrenStringTags.push(e.childrenStringEmitClosingTag),e.childrenTagsToString&&(e.datatype=this.dataFactory.namedNode(u.RDF+"XMLLiteral"),e.text=e.childrenStringTags.join(""),e.hadChildren=!1),e.childrenCollectionSubject)this.emitTriple(e.childrenCollectionSubject,e.childrenCollectionPredicate,this.dataFactory.namedNode(u.RDF+"nil"),e.reifiedStatementId);else if(e.predicate)if(e.hadChildren||e.childrenParseType===c.PROPERTY){if(!e.predicateEmitted){const t=this.dataFactory.blankNode();this.emitTriple(e.subject,e.predicate,t,e.reifiedStatementId);for(let n=0;n<e.predicateSubPredicates.length;n++)this.emitTriple(t,e.predicateSubPredicates[n],e.predicateSubObjects[n],null)}}else this.emitTriple(e.subject,e.predicate,this.dataFactory.literal(e.text||"",e.datatype||e.language),e.reifiedStatementId)}onDoctype(e){e.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(e,t,n)=>(this.saxStream._parser.ENTITIES[t]=n,""))}}var c;n.RdfXmlParser=u,u.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,u.MIME_TYPE="application/rdf+xml",u.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",u.XML="http://www.w3.org/XML/1998/namespace",u.XMLNS="http://www.w3.org/2000/xmlns/",u.DEFAULT_NS={xml:u.XML},u.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],u.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],u.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,function(e){e[e.RESOURCE=0]="RESOURCE",e[e.PROPERTY=1]="PROPERTY"}(c=n.ParseType||(n.ParseType={}))},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(e,t,n){"use strict";var r={};function i(e,t,n){n||(n=Error);var i=function(e){function n(n,r,i){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,i))||this}return i=e,(r=n).prototype=Object.create(i.prototype),r.prototype.constructor=r,r.__proto__=i,n;var r,i}(n);i.prototype.name=n.name,i.prototype.code=e,r[e]=i}function o(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map(function(e){return String(e)}),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(e,t,n){var r,i,s,a;if("string"==typeof t&&"not "===t.substr(0,"not ".length)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))i="The ".concat(e," ").concat(r," ").concat(o(t,"type"));else{var u=("number"!=typeof a&&(a=0),a+".".length>(s=e).length||-1===s.indexOf(".",a)?"argument":"property");i='The "'.concat(e,'" ').concat(u," ").concat(r," ").concat(o(t,"type"))}return i+". Received type ".concat(typeof n)},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=r},{}],68:[function(e,t,n){(function(n){(function(){"use strict";var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=c;var i=e("./_stream_readable"),o=e("./_stream_writable");e("inherits")(c,i);for(var s=r(o.prototype),a=0;a<s.length;a++){var u=s[a];c.prototype[u]||(c.prototype[u]=o.prototype[u])}function c(e){if(!(this instanceof c))return new c(e);i.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||n.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(e,t,n){"use strict";t.exports=i;var r=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e("inherits")(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":71,inherits:10}],70:[function(e,t,n){(function(n,r){(function(){"use strict";var i;t.exports=A,A.ReadableState=S,e("events");var o,s=function(e,t){return e.listeners(t).length},a=e("./internal/streams/stream"),u=e("buffer").Buffer,c=r.Uint8Array||function(){},l=e("util");o=l&&l.debuglog?l.debuglog("stream"):function(){};var h,d,f,p=e("./internal/streams/buffer_list"),g=e("./internal/streams/destroy"),m=e("./internal/streams/state").getHighWaterMark,y=e("../errors").codes,v=y.ERR_INVALID_ARG_TYPE,b=y.ERR_STREAM_PUSH_AFTER_EOF,_=y.ERR_METHOD_NOT_IMPLEMENTED,w=y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(A,a);var x=g.errorOrDestroy,E=["error","close","destroy","pause","resume"];function S(t,n,r){i=i||e("./_stream_duplex"),"boolean"!=typeof r&&(r=n instanceof i),this.objectMode=!!(t=t||{}).objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",r),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(h||(h=e("string_decoder/").StringDecoder),this.decoder=new h(t.encoding),this.encoding=t.encoding)}function A(t){if(i=i||e("./_stream_duplex"),!(this instanceof A))return new A(t);this._readableState=new S(t,this,this instanceof i),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),a.call(this)}function k(e,t,n,r,i){o("readableAddChunk",t);var s,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(o("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?C(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,D(e)))}}(e,a);else if(i||(s=function(e,t){var n,r;return u.isBuffer(r=t)||r instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new v("chunk",["string","Buffer","Uint8Array"],t)),n}(a,t)),s)x(e,s);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),r)a.endEmitted?x(e,new w):T(e,a,t,!0);else if(a.ended)x(e,new b);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?T(e,a,t,!1):j(e,a)):T(e,a,t,!1)}else r||(a.reading=!1,j(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function T(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&C(e)),j(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=g.destroy,A.prototype._undestroy=g.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=u.from(e,t),t=""),n=!0),k(this,e,t,!1,n)},A.prototype.unshift=function(e){return k(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(t){h||(h=e("string_decoder/").StringDecoder);var n=new h(t);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var O=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=O?e=O:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function C(e){var t=e._readableState;o("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(o("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(D,e))}function D(e){var t=e._readableState;o("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function j(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(o("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function M(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function R(e){o("readable nexttick read 0"),e.read(0)}function N(e,t){o("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(o("flow",t.flowing);t.flowing&&null!==e.read(););}function F(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function B(e){var t=e._readableState;o("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(z,t,e))}function z(e,t){if(o("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function U(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}A.prototype.read=function(e){o("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return o("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?B(this):C(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&B(this),null;var r,i=t.needReadable;return o("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&o("length less than watermark",i=!0),t.ended||t.reading?o("reading or ended",i=!1):i&&(o("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(n,t))),null===(r=e>0?F(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&B(this)),null!==r&&this.emit("data",r),r},A.prototype._read=function(e){x(this,new _("_read()"))},A.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,o("pipe count=%d opts=%j",i.pipesCount,t);var a=t&&!1===t.end||e===n.stdout||e===n.stderr?g:u;function u(){o("onend"),e.end()}i.endEmitted?n.nextTick(a):r.once("end",a),e.on("unpipe",function t(n,s){o("onunpipe"),n===r&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,o("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",t),r.removeListener("end",u),r.removeListener("end",g),r.removeListener("data",h),l=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())});var c=function(e){return function(){var t=e._readableState;o("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,L(e))}}(r);e.on("drain",c);var l=!1;function h(t){o("ondata");var n=e.write(t);o("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!l&&(o("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){o("onerror",t),g(),e.removeListener("error",d),0===s(e,"error")&&x(e,t)}function f(){e.removeListener("finish",p),g()}function p(){o("onfinish"),e.removeListener("close",f),g()}function g(){o("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events.error?Array.isArray(e._events.error)?e._events.error.unshift(n):e._events.error=[n,e._events.error]:e.on(t,n)}(e,"error",d),e.once("close",f),e.once("finish",p),e.emit("pipe",r),i.flowing||(o("pipe resume"),r.resume()),e},A.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=U(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},A.prototype.addListener=A.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,o("on readable",i.length,i.reading),i.length?C(this):i.reading||n.nextTick(R,this))),r},A.prototype.removeListener=function(e,t){var r=a.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(M,this),r},A.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(M,this),t},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(o("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(N,e,t))}(this,e)),e.paused=!1,this},A.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",function(){if(o("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){o("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<E.length;s++)e.on(E[s],this.emit.bind(this,E[s]));return this._read=function(t){o("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=F,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(t,n){return void 0===f&&(f=e("./internal/streams/from")),f(A,t,n)})}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(e,t,n){"use strict";t.exports=l;var r=e("../errors").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,u=e("./_stream_duplex");function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);u.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush(function(t,n){d(e,t,n)})}function d(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}e("inherits")(l,u),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new i("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,function(e){t(e)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(e,t,n){(function(n,r){(function(){"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(undefined),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var o;t.exports=A,A.WritableState=S;var s,a={deprecate:e("util-deprecate")},u=e("./internal/streams/stream"),c=e("buffer").Buffer,l=r.Uint8Array||function(){},h=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,f=e("../errors").codes,p=f.ERR_INVALID_ARG_TYPE,g=f.ERR_METHOD_NOT_IMPLEMENTED,m=f.ERR_MULTIPLE_CALLBACK,y=f.ERR_STREAM_CANNOT_PIPE,v=f.ERR_STREAM_DESTROYED,b=f.ERR_STREAM_NULL_VALUES,_=f.ERR_STREAM_WRITE_AFTER_END,w=f.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function E(){}function S(t,r,s){o=o||e("./_stream_duplex"),"boolean"!=typeof s&&(s=r instanceof o),this.objectMode=!!(t=t||{}).objectMode,s&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===t.decodeStrings),this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,o=r.writecb;if("function"!=typeof o)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,o){--t.pendingcb,r?(n.nextTick(o,i),n.nextTick(D,e,t),e._writableState.errorEmitted=!0,x(e,i)):(o(i),e._writableState.errorEmitted=!0,x(e,i),D(e,t))}(e,r,i,t,o);else{var s=I(r)||e.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||O(e,r),i?n.nextTick(T,e,r,s,o):T(e,r,s,o)}}(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function A(t){var n=this instanceof(o=o||e("./_stream_duplex"));if(!n&&!s.call(A,this))return new A(t);this._writableState=new S(t,this,n),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),u.call(this)}function k(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function T(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),D(e,t)}function O(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=new Array(t.bufferedRequestCount),o=t.corkedRequestsFree;o.entry=n;for(var s=0,a=!0;n;)r[s]=n,n.isBuf||(a=!1),n=n.next,s+=1;r.allBuffers=a,k(e,t,!0,t.length,r,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk;if(k(e,t,!1,t.objectMode?1:u.length,u,n.encoding,n.callback),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,t){e._final(function(n){t.pendingcb--,n&&x(e,n),t.prefinished=!0,e.emit("prefinish"),D(e,t)})}function D(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(C,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}e("inherits")(A,u),S.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(S.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===A&&e&&e._writableState instanceof S}})):s=function(e){return e instanceof this},A.prototype.pipe=function(){x(this,new y)},A.prototype.write=function(e,t,r){var i,o=this._writableState,s=!1,a=!o.objectMode&&(c.isBuffer(i=e)||i instanceof l);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof r&&(r=E),o.ending?function(e,t){var r=new _;x(e,r),n.nextTick(t,r)}(this,r):(a||function(e,t,r,i){var o;return null===r?o=new b:"string"==typeof r||t.objectMode||(o=new p("chunk",["string","Buffer"],r)),!o||(x(e,o),n.nextTick(i,o),!1)}(this,o,e,r))&&(o.pendingcb++,s=function(e,t,n,r,i,o){if(!n){var s=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n)),t}(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=t.objectMode?1:r.length;t.length+=a;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else k(e,t,!1,a,r,i,o);return u}(this,o,a,e,t,r)),s},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||O(this,e))},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(e,t,n){n(new g("_write()"))},A.prototype._writev=null,A.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,D(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),A.prototype.destroy=h.destroy,A.prototype._undestroy=h.undestroy,A.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(e,t,n){(function(n){(function(){"use strict";var r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=e("./end-of-stream"),s=Symbol("lastResolve"),a=Symbol("lastReject"),u=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[s];if(null!==t){var n=e[d].read();null!==n&&(e[l]=null,e[s]=null,e[a]=null,t(f(n,!1)))}}function g(e){n.nextTick(p,e)}var m=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((i(r={get stream(){return this[d]},next:function(){var e=this,t=this[u];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(f(void 0,!0));if(this[d].destroyed)return new Promise(function(t,r){n.nextTick(function(){e[u]?r(e[u]):t(f(void 0,!0))})});var r,i=this[l];if(i)r=new Promise(function(e,t){return function(n,r){e.then(function(){t[c]?n(f(void 0,!0)):t[h](n,r)},r)}}(i,this));else{var o=this[d].read();if(null!==o)return Promise.resolve(f(o,!1));r=new Promise(this[h])}return this[l]=r,r}},Symbol.asyncIterator,function(){return this}),i(r,"return",function(){var e=this;return new Promise(function(t,n){e[d].destroy(null,function(e){e?n(e):t(f(void 0,!0))})})}),r),m);t.exports=function(e){var t,n=Object.create(y,(i(t={},d,{value:e,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,c,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var r=n[d].read();r?(n[l]=null,n[s]=null,n[a]=null,e(f(r,!1))):(n[s]=e,n[a]=t)},writable:!0}),t));return n[l]=null,o(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[a];return null!==t&&(n[l]=null,n[s]=null,n[a]=null,t(e)),void(n[u]=e)}var r=n[s];null!==r&&(n[l]=null,n[s]=null,n[a]=null,r(f(void 0,!0))),n[c]=!0}),e.on("readable",g.bind(null,n)),n}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":76,_process:44}],74:[function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=e("buffer").Buffer,a=e("util").inspect,u=a&&a.custom||"inspect";t.exports=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.head=null,this.tail=null,this.length=0}return t=e,(n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t=s.allocUnsafe(e>>>0),n=this.head,r=0;n;)s.prototype.copy.call(n.data,t,r),r+=n.data.length,n=n.next;return t}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(r+=o===i.length?i:i.slice(0,e),0==(e-=o)){o===i.length?(++n,this.head=t.next?t.next:this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,this.head=n.next?n.next:this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t,{depth:0,customInspect:!1}))}}])&&o(t.prototype,n),e;var t,n}()},{buffer:6,util:3}],75:[function(e,t,n){(function(e){(function(){"use strict";function n(e,t){i(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,o){var s=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(o?o(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!o&&t?s._writableState?s._writableState.errorEmitted?e.nextTick(r,s):(s._writableState.errorEmitted=!0,e.nextTick(n,s,t)):e.nextTick(n,s,t):o?(e.nextTick(r,s),o(t)):e.nextTick(r,s)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))},{_process:44}],76:[function(e,t,n){"use strict";var r=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,n,o){if("function"==typeof n)return e(t,null,n);n||(n={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||i);var s=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,u=function(){t.writable||l()},c=t._writableState&&t._writableState.finished,l=function(){a=!1,c=!0,s||o.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){s=!1,h=!0,a||o.call(t)},f=function(e){o.call(t,e)},p=function(){var e;return s&&!h?(t._readableState&&t._readableState.ended||(e=new r),o.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new r),o.call(t,e)):void 0},g=function(){t.req.on("finish",l)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",l),t.on("abort",p),t.req?g():t.on("request",g)):a&&!t._writableState&&(t.on("end",u),t.on("close",u)),t.on("end",d),t.on("finish",l),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",l),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",p)}}},{"../../../errors":67}],77:[function(e,t,n){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(e,t,n){"use strict";var r,i=e("../../../errors").codes,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function u(t,n,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;t.on("close",function(){a=!0}),void 0===r&&(r=e("./end-of-stream")),r(t,{readable:n,writable:i},function(e){if(e)return o(e);a=!0,o()});var u=!1;return function(e){if(!a&&!u)return u=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void o(e||new s("pipe"))}}function c(e){e()}function l(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}t.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var s=t.map(function(e,n){var o=n<t.length-1;return u(e,o,n>0,function(e){r||(r=e),e&&s.forEach(c),o||(s.forEach(c),i(r))})});return t.reduce(l)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(e,t,n){"use strict";var r=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},{"../../../errors":67}],80:[function(e,t,n){t.exports=e("events").EventEmitter},{events:8}],81:[function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}(e("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(e,t,n){"use strict";function r(e){const t=[];let n=0;for(;n<e.length;)switch(e[n]){case"/":if("."===e[n+1])if("."===e[n+2]){if(!o(e[n+3])){t.push([]),n++;break}t.pop(),e[n+3]||t.push([]),n+=3}else{if(!o(e[n+2])){t.push([]),n++;break}e[n+2]||t.push([]),n+=2}else t.push([]),n++;break;case"#":case"?":t.length||t.push([]),t[t.length-1].push(e.substr(n)),n=e.length;break;default:t.length||t.push([]),t[t.length-1].push(e[n]),n++}return"/"+t.map(e=>e.join("")).join("/")}function i(e,t){let n=t+1;t>=0?"/"===e[t+1]&&"/"===e[t+2]&&(n=t+3):"/"===e[0]&&"/"===e[1]&&(n=2);const i=e.indexOf("/",n);return i<0?e:e.substr(0,i)+r(e.substr(i))}function o(e){return!e||"#"===e||"?"===e||"/"===e}Object.defineProperty(n,"__esModule",{value:!0}),n.resolve=function(e,t){const n=(t=t||"").indexOf("#");if(n>0&&(t=t.substr(0,n)),!e.length){if(t.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${t}' for value '${e}'`);return t}if(e.startsWith("?")){const n=t.indexOf("?");return n>0&&(t=t.substr(0,n)),t+e}if(e.startsWith("#"))return t+e;if(!t.length){const t=e.indexOf(":");if(t<0)throw new Error(`Found invalid relative IRI '${e}' for a missing baseIRI`);return i(e,t)}const o=e.indexOf(":");if(o>=0)return i(e,o);const s=t.indexOf(":");if(s<0)throw new Error(`Found invalid baseIRI '${t}' for value '${e}'`);const a=t.substr(0,s+1);if(0===e.indexOf("//"))return a+i(e,o);let u;if(t.indexOf("//",s)===s+1){if(u=t.indexOf("/",s+3),u<0)return t.length>s+3?t+"/"+i(e,o):a+i(e,o)}else if(u=t.indexOf("/",s+1),u<0)return a+i(e,o);if(0===e.indexOf("/"))return t.substr(0,u)+r(e);let c=t.substr(u);const l=c.lastIndexOf("/");return l>=0&&l<c.length-1&&(c=c.substr(0,l+1),"."===e[0]&&"."!==e[1]&&"/"!==e[1]&&e[2]&&(e=e.substr(1))),e=r(e=c+e),t.substr(0,u)+e},n.removeDotSegments=r,n.removeDotSegmentsOfPath=i},{}],84:[function(e,t,n){var r=e("buffer"),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,n),n.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},{buffer:6}],85:[function(e,t,n){(function(t){(function(){!function(n){n.parser=function(e,t){return new o(e,t)},n.SAXParser=o,n.SAXStream=a,n.createStream=function(e,t){return new a(e,t)},n.MAX_BUFFER_LENGTH=65536;var r,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function o(e,t){if(!(this instanceof o))return new o(e,t);var r=this;(function(e){for(var t=0,n=i.length;t<n;t++)e[i[t]]=""})(r),r.q=r.c="",r.bufferCheckPosition=n.MAX_BUFFER_LENGTH,r.opt=t||{},r.opt.lowercase=r.opt.lowercase||r.opt.lowercasetags,r.looseCase=r.opt.lowercase?"toLowerCase":"toUpperCase",r.tags=[],r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.strict=!!e,r.noscript=!(!e&&!r.opt.noscript),r.state=E.BEGIN,r.strictEntities=r.opt.strictEntities,r.ENTITIES=Object.create(r.strictEntities?n.XML_ENTITIES:n.ENTITIES),r.attribList=[],r.opt.xmlns&&(r.ns=Object.create(l)),r.trackPosition=!1!==r.opt.position,r.trackPosition&&(r.position=r.line=r.column=0),A(r,"onready")}n.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),o.prototype={end:function(){C(this)},write:function(e){var t=this;if(this.error)throw this.error;if(t.closed)return I(t,"Cannot write after close. Assign an onready handler.");if(null===e)return C(t);"object"==typeof e&&(e=e.toString());for(var r=0,o="";o=B(e,r++),t.c=o,o;)switch(t.trackPosition&&(t.position++,"\n"===o?(t.line++,t.column=0):t.column++),t.state){case E.BEGIN:if(t.state=E.BEGIN_WHITESPACE,"\ufeff"===o)continue;F(t,o);continue;case E.BEGIN_WHITESPACE:F(t,o);continue;case E.TEXT:if(t.sawRoot&&!t.closedRoot){for(var s=r-1;o&&"<"!==o&&"&"!==o;)(o=B(e,r++))&&t.trackPosition&&(t.position++,"\n"===o?(t.line++,t.column=0):t.column++);t.textNode+=e.substring(s,r-1)}"<"!==o||t.sawRoot&&t.closedRoot&&!t.strict?(g(o)||t.sawRoot&&!t.closedRoot||D(t,"Text data outside of root node."),"&"===o?t.state=E.TEXT_ENTITY:t.textNode+=o):(t.state=E.OPEN_WAKA,t.startTagPosition=t.position);continue;case E.SCRIPT:"<"===o?t.state=E.SCRIPT_ENDING:t.script+=o;continue;case E.SCRIPT_ENDING:"/"===o?t.state=E.CLOSE_TAG:(t.script+="<"+o,t.state=E.SCRIPT);continue;case E.OPEN_WAKA:"!"===o?(t.state=E.SGML_DECL,t.sgmlDecl=""):g(o)||(v(h,o)?(t.state=E.OPEN_TAG,t.tagName=o):"/"===o?(t.state=E.CLOSE_TAG,t.tagName=""):"?"===o?(t.state=E.PROC_INST,t.procInstName=t.procInstBody=""):(D(t,"Unencoded <"),t.startTagPosition+1<t.position&&(o=new Array(t.position-t.startTagPosition).join(" ")+o),t.textNode+="<"+o,t.state=E.TEXT));continue;case E.SGML_DECL:"[CDATA["===(t.sgmlDecl+o).toUpperCase()?(k(t,"onopencdata"),t.state=E.CDATA,t.sgmlDecl="",t.cdata=""):t.sgmlDecl+o==="--"?(t.state=E.COMMENT,t.comment="",t.sgmlDecl=""):"DOCTYPE"===(t.sgmlDecl+o).toUpperCase()?(t.state=E.DOCTYPE,(t.doctype||t.sawRoot)&&D(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):">"===o?(k(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=E.TEXT):m(o)?(t.state=E.SGML_DECL_QUOTED,t.sgmlDecl+=o):t.sgmlDecl+=o;continue;case E.SGML_DECL_QUOTED:o===t.q&&(t.state=E.SGML_DECL,t.q=""),t.sgmlDecl+=o;continue;case E.DOCTYPE:">"===o?(t.state=E.TEXT,k(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=o,"["===o?t.state=E.DOCTYPE_DTD:m(o)&&(t.state=E.DOCTYPE_QUOTED,t.q=o));continue;case E.DOCTYPE_QUOTED:t.doctype+=o,o===t.q&&(t.q="",t.state=E.DOCTYPE);continue;case E.DOCTYPE_DTD:t.doctype+=o,"]"===o?t.state=E.DOCTYPE:m(o)&&(t.state=E.DOCTYPE_DTD_QUOTED,t.q=o);continue;case E.DOCTYPE_DTD_QUOTED:t.doctype+=o,o===t.q&&(t.state=E.DOCTYPE_DTD,t.q="");continue;case E.COMMENT:"-"===o?t.state=E.COMMENT_ENDING:t.comment+=o;continue;case E.COMMENT_ENDING:"-"===o?(t.state=E.COMMENT_ENDED,t.comment=O(t.opt,t.comment),t.comment&&k(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+o,t.state=E.COMMENT);continue;case E.COMMENT_ENDED:">"!==o?(D(t,"Malformed comment"),t.comment+="--"+o,t.state=E.COMMENT):t.state=E.TEXT;continue;case E.CDATA:"]"===o?t.state=E.CDATA_ENDING:t.cdata+=o;continue;case E.CDATA_ENDING:"]"===o?t.state=E.CDATA_ENDING_2:(t.cdata+="]"+o,t.state=E.CDATA);continue;case E.CDATA_ENDING_2:">"===o?(t.cdata&&k(t,"oncdata",t.cdata),k(t,"onclosecdata"),t.cdata="",t.state=E.TEXT):"]"===o?t.cdata+="]":(t.cdata+="]]"+o,t.state=E.CDATA);continue;case E.PROC_INST:"?"===o?t.state=E.PROC_INST_ENDING:g(o)?t.state=E.PROC_INST_BODY:t.procInstName+=o;continue;case E.PROC_INST_BODY:if(!t.procInstBody&&g(o))continue;"?"===o?t.state=E.PROC_INST_ENDING:t.procInstBody+=o;continue;case E.PROC_INST_ENDING:">"===o?(k(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=E.TEXT):(t.procInstBody+="?"+o,t.state=E.PROC_INST_BODY);continue;case E.OPEN_TAG:v(d,o)?t.tagName+=o:(j(t),">"===o?R(t):"/"===o?t.state=E.OPEN_TAG_SLASH:(g(o)||D(t,"Invalid character in tag name"),t.state=E.ATTRIB));continue;case E.OPEN_TAG_SLASH:">"===o?(R(t,!0),N(t)):(D(t,"Forward-slash in opening tag not followed by >"),t.state=E.ATTRIB);continue;case E.ATTRIB:if(g(o))continue;">"===o?R(t):"/"===o?t.state=E.OPEN_TAG_SLASH:v(h,o)?(t.attribName=o,t.attribValue="",t.state=E.ATTRIB_NAME):D(t,"Invalid attribute name");continue;case E.ATTRIB_NAME:"="===o?t.state=E.ATTRIB_VALUE:">"===o?(D(t,"Attribute without value"),t.attribValue=t.attribName,M(t),R(t)):g(o)?t.state=E.ATTRIB_NAME_SAW_WHITE:v(d,o)?t.attribName+=o:D(t,"Invalid attribute name");continue;case E.ATTRIB_NAME_SAW_WHITE:if("="===o)t.state=E.ATTRIB_VALUE;else{if(g(o))continue;D(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",k(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",">"===o?R(t):v(h,o)?(t.attribName=o,t.state=E.ATTRIB_NAME):(D(t,"Invalid attribute name"),t.state=E.ATTRIB)}continue;case E.ATTRIB_VALUE:if(g(o))continue;m(o)?(t.q=o,t.state=E.ATTRIB_VALUE_QUOTED):(D(t,"Unquoted attribute value"),t.state=E.ATTRIB_VALUE_UNQUOTED,t.attribValue=o);continue;case E.ATTRIB_VALUE_QUOTED:if(o!==t.q){"&"===o?t.state=E.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=o;continue}M(t),t.q="",t.state=E.ATTRIB_VALUE_CLOSED;continue;case E.ATTRIB_VALUE_CLOSED:g(o)?t.state=E.ATTRIB:">"===o?R(t):"/"===o?t.state=E.OPEN_TAG_SLASH:v(h,o)?(D(t,"No whitespace between attributes"),t.attribName=o,t.attribValue="",t.state=E.ATTRIB_NAME):D(t,"Invalid attribute name");continue;case E.ATTRIB_VALUE_UNQUOTED:if(!y(o)){"&"===o?t.state=E.ATTRIB_VALUE_ENTITY_U:t.attribValue+=o;continue}M(t),">"===o?R(t):t.state=E.ATTRIB;continue;case E.CLOSE_TAG:if(t.tagName)">"===o?N(t):v(d,o)?t.tagName+=o:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=E.SCRIPT):(g(o)||D(t,"Invalid tagname in closing tag"),t.state=E.CLOSE_TAG_SAW_WHITE);else{if(g(o))continue;b(h,o)?t.script?(t.script+="</"+o,t.state=E.SCRIPT):D(t,"Invalid tagname in closing tag."):t.tagName=o}continue;case E.CLOSE_TAG_SAW_WHITE:if(g(o))continue;">"===o?N(t):D(t,"Invalid characters in closing tag");continue;case E.TEXT_ENTITY:case E.ATTRIB_VALUE_ENTITY_Q:case E.ATTRIB_VALUE_ENTITY_U:var a,u;switch(t.state){case E.TEXT_ENTITY:a=E.TEXT,u="textNode";break;case E.ATTRIB_VALUE_ENTITY_Q:a=E.ATTRIB_VALUE_QUOTED,u="attribValue";break;case E.ATTRIB_VALUE_ENTITY_U:a=E.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===o?(t[u]+=L(t),t.entity="",t.state=a):v(t.entity.length?p:f,o)?t.entity+=o:(D(t,"Invalid character in entity name"),t[u]+="&"+t.entity+o,t.entity="",t.state=a);continue;default:throw new Error(t,"Unknown state: "+t.state)}return t.position>=t.bufferCheckPosition&&function(e){for(var t=Math.max(n.MAX_BUFFER_LENGTH,10),r=0,o=0,s=i.length;o<s;o++){var a=e[i[o]].length;if(a>t)switch(i[o]){case"textNode":T(e);break;case"cdata":k(e,"oncdata",e.cdata),e.cdata="";break;case"script":k(e,"onscript",e.script),e.script="";break;default:I(e,"Max buffer length exceeded: "+i[o])}r=Math.max(r,a)}e.bufferCheckPosition=n.MAX_BUFFER_LENGTH-r+e.position}(t),t},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;T(e=this),""!==e.cdata&&(k(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(k(e,"onscript",e.script),e.script="")}};try{r=e("stream").Stream}catch(z){r=function(){}}var s=n.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function a(e,t){if(!(this instanceof a))return new a(e,t);r.apply(this),this._parser=new o(e,t),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,s.forEach(function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})})}(a.prototype=Object.create(r.prototype,{constructor:{value:a}})).write=function(n){if("function"==typeof t&&"function"==typeof t.isBuffer&&t.isBuffer(n)){if(!this._decoder){var r=e("string_decoder").StringDecoder;this._decoder=new r("utf8")}n=this._decoder.write(n)}return this._parser.write(n.toString()),this.emit("data",n),!0},a.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},a.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||-1===s.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),r.prototype.on.call(n,e,t)};var u="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/2000/xmlns/",l={xml:u,xmlns:c},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function m(e){return'"'===e||"'"===e}function y(e){return">"===e||g(e)}function v(e,t){return e.test(t)}function b(e,t){return!v(e,t)}var _,w,x,E=0;for(var S in n.STATE={BEGIN:E++,BEGIN_WHITESPACE:E++,TEXT:E++,TEXT_ENTITY:E++,OPEN_WAKA:E++,SGML_DECL:E++,SGML_DECL_QUOTED:E++,DOCTYPE:E++,DOCTYPE_QUOTED:E++,DOCTYPE_DTD:E++,DOCTYPE_DTD_QUOTED:E++,COMMENT_STARTING:E++,COMMENT:E++,COMMENT_ENDING:E++,COMMENT_ENDED:E++,CDATA:E++,CDATA_ENDING:E++,CDATA_ENDING_2:E++,PROC_INST:E++,PROC_INST_BODY:E++,PROC_INST_ENDING:E++,OPEN_TAG:E++,OPEN_TAG_SLASH:E++,ATTRIB:E++,ATTRIB_NAME:E++,ATTRIB_NAME_SAW_WHITE:E++,ATTRIB_VALUE:E++,ATTRIB_VALUE_QUOTED:E++,ATTRIB_VALUE_CLOSED:E++,ATTRIB_VALUE_UNQUOTED:E++,ATTRIB_VALUE_ENTITY_Q:E++,ATTRIB_VALUE_ENTITY_U:E++,CLOSE_TAG:E++,CLOSE_TAG_SAW_WHITE:E++,SCRIPT:E++,SCRIPT_ENDING:E++},n.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},n.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(n.ENTITIES).forEach(function(e){var t=n.ENTITIES[e],r="number"==typeof t?String.fromCharCode(t):t;n.ENTITIES[e]=r}),n.STATE)n.STATE[n.STATE[S]]=S;function A(e,t,n){e[t]&&e[t](n)}function k(e,t,n){e.textNode&&T(e),A(e,t,n)}function T(e){e.textNode=O(e.opt,e.textNode),e.textNode&&A(e,"ontext",e.textNode),e.textNode=""}function O(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function I(e,t){return T(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,A(e,"onerror",t),e}function C(e){return e.sawRoot&&!e.closedRoot&&D(e,"Unclosed root tag"),e.state!==E.BEGIN&&e.state!==E.BEGIN_WHITESPACE&&e.state!==E.TEXT&&I(e,"Unexpected end"),T(e),e.c="",e.closed=!0,A(e,"onend"),o.call(e,e.strict,e.opt),e}function D(e,t){if("object"!=typeof e||!(e instanceof o))throw new Error("bad call to strictFail");e.strict&&I(e,t)}function j(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,k(e,"onopentagstart",n)}function P(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function M(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=P(e.attribName,!0),n=t.local;if("xmlns"===t.prefix)if("xml"===n&&e.attribValue!==u)D(e,"xml: prefix must be bound to "+u+"\nActual: "+e.attribValue);else if("xmlns"===n&&e.attribValue!==c)D(e,"xmlns: prefix must be bound to "+c+"\nActual: "+e.attribValue);else{var r=e.tag,i=e.tags[e.tags.length-1]||e;r.ns===i.ns&&(r.ns=Object.create(i.ns)),r.ns[n]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,k(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function R(e,t){if(e.opt.xmlns){var n=e.tag,r=P(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(D(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix),n.ns&&(e.tags[e.tags.length-1]||e).ns!==n.ns&&Object.keys(n.ns).forEach(function(t){k(e,"onopennamespace",{prefix:t,uri:n.ns[t]})});for(var i=0,o=e.attribList.length;i<o;i++){var s=e.attribList[i],a=s[0],u=s[1],c=P(a,!0),l=c.prefix,h=""===l?"":n.ns[l]||"",d={name:a,value:u,prefix:l,local:c.local,uri:h};l&&"xmlns"!==l&&!h&&(D(e,"Unbound namespace prefix: "+JSON.stringify(l)),d.uri=l),e.tag.attributes[a]=d,k(e,"onattribute",d)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),k(e,"onopentag",e.tag),t||(e.state=e.noscript||"script"!==e.tagName.toLowerCase()?E.TEXT:E.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function N(e){if(!e.tagName)return D(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=E.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=E.SCRIPT);k(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--&&e.tags[t].name!==r;)D(e,"Unexpected close tag");if(t<0)return D(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=E.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,k(e,"onclosetag",e.tagName);var s={};for(var a in o.ns)s[a]=o.ns[a];e.opt.xmlns&&o.ns!==(e.tags[e.tags.length-1]||e).ns&&Object.keys(o.ns).forEach(function(t){k(e,"onclosenamespace",{prefix:t,uri:o.ns[t]})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=E.TEXT}function L(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==n?(D(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function F(e,t){"<"===t?(e.state=E.OPEN_WAKA,e.startTagPosition=e.position):g(t)||(D(e,"Non-whitespace before first tag."),e.textNode=t,e.state=E.TEXT)}function B(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}E=n.STATE,String.fromCodePoint||(_=String.fromCharCode,w=Math.floor,x=function(){var e=16384,t=[],n=-1,r=arguments.length;if(!r)return"";for(var i="";++n<r;){var o=Number(arguments[n]);if(!isFinite(o)||o<0||o>1114111||w(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?t.push(o):t.push(55296+((o-=65536)>>10),o%1024+56320),(n+1===r||t.length>e)&&(i+=_.apply(null,t),t.length=0)}return i},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:x,configurable:!0,writable:!0}):String.fromCodePoint=x)}(void 0===n?this.sax={}:n)}).call(this)}).call(this,e("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(e,t,n){(function(e,t){(function(){!function(t,n){"use strict";if(!t.setImmediate){var r,i=1,o={},s=!1,a=t.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(t);u=u&&u.setTimeout?u:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){p(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?(h="setImmediate$"+Math.random()+"$",d=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(h)&&p(+e.data.slice(h.length))},t.addEventListener?t.addEventListener("message",d,!1):t.attachEvent("onmessage",d),r=function(e){t.postMessage(h+e,"*")}):t.MessageChannel?((l=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){l.port2.postMessage(e)}):a&&"onreadystatechange"in a.createElement("script")?(c=a.documentElement,r=function(e){var t=a.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,c.removeChild(t),t=null},c.appendChild(t)}):r=function(e){setTimeout(p,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];return o[i]={callback:e,args:t},r(i),i++},u.clearImmediate=f}var c,l,h,d;function f(e){delete o[e]}function p(e){if(s)setTimeout(p,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{f(e),s=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(e,t,n){t.exports=i;var r=e("events").EventEmitter;function i(){r.call(this)}e("inherits")(i,r),i.Readable=e("readable-stream/lib/_stream_readable.js"),i.Writable=e("readable-stream/lib/_stream_writable.js"),i.Duplex=e("readable-stream/lib/_stream_duplex.js"),i.Transform=e("readable-stream/lib/_stream_transform.js"),i.PassThrough=e("readable-stream/lib/_stream_passthrough.js"),i.finished=e("readable-stream/lib/internal/streams/end-of-stream.js"),i.pipeline=e("readable-stream/lib/internal/streams/pipeline.js"),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",u));var s=!1;function a(){s||(s=!0,e.end())}function u(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(l(),0===r.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",i),e.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",u),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",c),e.on("error",c),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(e,t,n){arguments[4][5][0].apply(n,arguments)},{dup:5,"safe-buffer":84}],89:[function(e,t,n){(function(t,r){(function(){var i=e("process/browser.js").nextTick,o=Function.prototype.apply,s=Array.prototype.slice,a={},u=0;function c(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new c(o.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new c(o.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n.setImmediate="function"==typeof t?t:function(e){var t=u++,r=!(arguments.length<2)&&s.call(arguments,1);return a[t]=!0,i(function(){a[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))}),t},n.clearImmediate="function"==typeof r?r:function(e){delete a[e]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(e,t,n){(function(e){(function(){function n(t){try{if(!e.localStorage)return!1}catch(r){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(e,t,n){"use strict";t.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},{}],92:[function(e,t,n){"use strict";function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function i(e,t,n){var r=t===e.head?new a(n,null,t,e):new a(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function o(e,t){e.tail=new a(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new a(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function a(e,t,n,r){if(!(this instanceof a))return new a(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}t.exports=r,r.Node=a,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},r.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},r.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)n.push(o.value);return n},r.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;var s=[];for(r=0;o&&r<t;r++)s.push(o.value),o=this.removeNode(o);for(null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev),r=0;r<n.length;r++)o=i(this,o,n[r]);return s},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{e("./iterator.js")(r)}catch(u){}},{"./iterator.js":91}]},{},[1])(1)},322:e=>{e.exports=function(e,t){var n=t.length;if(0!==n){var r=e.length;e.length+=n;for(var i=0;i<n;i++)e[r+i]=t[i]}}},517:(e,t)=>{"use strict";var n=(()=>(function(e){e.typeOfFunction="function",e.boolTrue=!0}(n||(n={})),n))();function r(e,t,r){if(!r||typeof r.value!==n.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+t+"> is not a method!");return{configurable:n.boolTrue,get:function(){var e=r.value.bind(this);return Object.defineProperty(this,t,{value:e,configurable:n.boolTrue,writable:n.boolTrue}),e}}}t.ak=r,t.ZP=r},266:(e,t,n)=>{e.exports={ResizeSensor:n(835),ElementQueries:n(845)}},845:function(e,t,n){"use strict";var r,i,o;"undefined"!=typeof window&&window,i=[n(835)],void 0===(o="function"==typeof(r=function(e){var t=function(){var t,n={},r=[];function i(e){e||(e=document.documentElement);var t=window.getComputedStyle(e,null).fontSize;return parseFloat(t)||16}function o(e,t){var n=t.split(/\d/),r=n[n.length-1];switch(t=parseFloat(t),r){case"px":return t;case"em":return t*i(e);case"rem":return t*i();case"vw":return t*document.documentElement.clientWidth/100;case"vh":return t*document.documentElement.clientHeight/100;case"vmin":case"vmax":var o=document.documentElement.clientWidth/100,s=document.documentElement.clientHeight/100;return t*(0,Math["vmin"===r?"min":"max"])(o,s);default:return t}}function s(e,t){var r,i,s,a,u,c,l,h;this.element=e;var d=["min-width","min-height","max-width","max-height"];this.call=function(){for(r in s=function(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}(this.element),c={},n[t])n[t].hasOwnProperty(r)&&(a=o(this.element,(i=n[t][r]).value),u="width"===i.property?s.width:s.height,l="","min"===i.mode&&u>=a&&(l+=i.value),"max"===i.mode&&u<=a&&(l+=i.value),c[h=i.mode+"-"+i.property]||(c[h]=""),l&&-1===(" "+c[h]+" ").indexOf(" "+l+" ")&&(c[h]+=" "+l));for(var e in d)d.hasOwnProperty(e)&&(c[d[e]]?this.element.setAttribute(d[e],c[d[e]].substr(1)):this.element.removeAttribute(d[e]))}}function a(t,n){t.elementQueriesSetupInformation||(t.elementQueriesSetupInformation=new s(t,n)),t.elementQueriesSensor||(t.elementQueriesSensor=new e(t,function(){t.elementQueriesSetupInformation.call()}))}function u(e,i,o,s){if(void 0===n[e]){n[e]=[];var a=r.length;t.innerHTML+="\n"+e+" {animation: 0.1s element-queries;}",t.innerHTML+="\n"+e+" > .resize-sensor {min-width: "+a+"px;}",r.push(e)}n[e].push({mode:i,property:o,value:s})}function c(e){var t;if(document.querySelectorAll&&(t=e?e.querySelectorAll.bind(e):document.querySelectorAll.bind(document)),t||"undefined"==typeof $$||(t=$$),t||"undefined"==typeof jQuery||(t=jQuery),!t)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return t}function l(t){var n=[],r=[],i=[],o=0,s=-1,a=[];for(var u in t.children)if(t.children.hasOwnProperty(u)&&t.children[u].tagName&&"img"===t.children[u].tagName.toLowerCase()){n.push(t.children[u]);var c=t.children[u].getAttribute("min-width")||t.children[u].getAttribute("data-min-width"),l=t.children[u].getAttribute("data-src")||t.children[u].getAttribute("url");i.push(l),r.push({minWidth:c}),c?t.children[u].style.display="none":(o=n.length-1,t.children[u].style.display="block")}function h(){var e,u=!1;for(e in n)n.hasOwnProperty(e)&&r[e].minWidth&&t.offsetWidth>r[e].minWidth&&(u=e);if(u||(u=o),s!==u)if(a[u])n[s].style.display="none",n[u].style.display="block",s=u;else{var c=new Image;c.onload=function(){n[u].src=i[u],n[s].style.display="none",n[u].style.display="block",a[u]=!0,s=u},c.src=i[u]}else n[u].src=i[u]}s=o,t.resizeSensorInstance=new e(t,h),h()}var h=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,d=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function f(e){var t,n,r,i;for(e=e.replace(/'/g,'"');null!==(t=h.exec(e));)for(n=t[1]+t[3],r=t[2];null!==(i=d.exec(r));)u(n,i[1],i[2],i[3])}function p(e){var t="";if(e)if("string"==typeof e)-1===(e=e.toLowerCase()).indexOf("min-width")&&-1===e.indexOf("max-width")||f(e);else for(var n=0,r=e.length;n<r;n++)1===e[n].type?-1!==(t=e[n].selectorText||e[n].cssText).indexOf("min-height")||-1!==t.indexOf("max-height")?f(t):-1===t.indexOf("min-width")&&-1===t.indexOf("max-width")||f(t):4===e[n].type?p(e[n].cssRules||e[n].rules):3===e[n].type&&e[n].styleSheet.hasOwnProperty("cssRules")&&p(e[n].styleSheet.cssRules)}var g=!1;this.init=function(){var n="animationstart";void 0!==document.documentElement.style.webkitAnimationName?n="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?n="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(n="oanimationstart"),document.body.addEventListener(n,function(t){var n=t.target,i=n&&window.getComputedStyle(n,null),o=i&&i.getPropertyValue("animation-name");if(o&&-1!==o.indexOf("element-queries")){n.elementQueriesSensor=new e(n,function(){n.elementQueriesSetupInformation&&n.elementQueriesSetupInformation.call()});var s=window.getComputedStyle(n.resizeSensor,null).getPropertyValue("min-width");s=parseInt(s.replace("px","")),a(t.target,r[s])}}),g||((t=document.createElement("style")).type="text/css",t.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",t.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(t),g=!0);for(var i=0,o=document.styleSheets.length;i<o;i++)try{document.styleSheets[i].href&&0===document.styleSheets[i].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[i].href),p(document.styleSheets[i].cssRules||document.styleSheets[i].rules||document.styleSheets[i].cssText)}catch(s){}!function(){for(var e=c()("[data-responsive-image],[responsive-image]"),t=0,n=e.length;t<n;t++)l(e[t])}()},this.findElementQueriesElements=function(e){!function(e){var t=c(e);for(var r in n)if(n.hasOwnProperty(r))for(var i=t(r,e),o=0,s=i.length;o<s;o++)a(i[o],r)}(e)},this.update=function(){this.init()}};return t.update=function(){t.instance.update()},t.detach=function(e){e.elementQueriesSetupInformation?(e.elementQueriesSensor.detach(),delete e.elementQueriesSetupInformation,delete e.elementQueriesSensor):e.resizeSensorInstance&&(e.resizeSensorInstance.detach(),delete e.resizeSensorInstance)},t.init=function(){t.instance||(t.instance=new t),t.instance.init()},t.findElementQueriesElements=function(e){t.instance.findElementQueriesElements(e)},t.listen=function(){!function(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var t=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(e(),clearInterval(t))},10);else window.onload=e}(t.init)},t})?r.apply(t,i):r)||(e.exports=o)},835:function(e,t,n){"use strict";var r,i;"undefined"!=typeof window&&window,void 0===(i="function"==typeof(r=function(){if("undefined"==typeof window)return null;var e="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||function(t){return e.setTimeout(t,20)},n=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||function(t){e.clearTimeout(t)};function r(e,t){var n=Object.prototype.toString.call(e),r="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!=typeof jQuery&&e instanceof jQuery||"undefined"!=typeof Elements&&e instanceof Elements,i=0,o=e.length;if(r)for(;i<o;i++)t(e[i]);else t(e)}function i(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function o(e,t){Object.keys(t).forEach(function(n){e.style[n]=t[n]})}var s=function(e,a){var u=0;function c(){var e,t,n=[];this.add=function(e){n.push(e)},this.call=function(r){for(e=0,t=n.length;e<t;e++)n[e].call(this,r)},this.remove=function(r){var i=[];for(e=0,t=n.length;e<t;e++)n[e]!==r&&i.push(n[e]);n=i},this.length=function(){return n.length}}r(e,function(e){!function(e,n){if(e)if(e.resizedAttached)e.resizedAttached.add(n);else{e.resizedAttached=new c,e.resizedAttached.add(n),e.resizeSensor=document.createElement("div"),e.resizeSensor.dir="ltr",e.resizeSensor.className="resize-sensor";var r={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},s={position:"absolute",left:"0px",top:"0px",transition:"0s"};o(e.resizeSensor,r);var a=document.createElement("div");a.className="resize-sensor-expand",o(a,r);var l=document.createElement("div");o(l,s),a.appendChild(l);var h=document.createElement("div");h.className="resize-sensor-shrink",o(h,r);var d=document.createElement("div");o(d,s),o(d,{width:"200%",height:"200%"}),h.appendChild(d),e.resizeSensor.appendChild(a),e.resizeSensor.appendChild(h),e.appendChild(e.resizeSensor);var f=window.getComputedStyle(e),p=f?f.getPropertyValue("position"):null;"absolute"!==p&&"relative"!==p&&"fixed"!==p&&"sticky"!==p&&(e.style.position="relative");var g=!1,m=0,y=i(e),v=0,b=0,_=!0;u=0;var w=function(){if(_){if(0===e.offsetWidth&&0===e.offsetHeight)return void(u||(u=t(function(){u=0,w()})));_=!1}var n,r;r=e.offsetHeight,l.style.width=(n=e.offsetWidth)+10+"px",l.style.height=r+10+"px",a.scrollLeft=n+10,a.scrollTop=r+10,h.scrollLeft=n+10,h.scrollTop=r+10};e.resizeSensor.resetSensor=w;var x=function(){m=0,g&&(v=y.width,b=y.height,e.resizedAttached&&e.resizedAttached.call(y))},E=function(){y=i(e),(g=y.width!==v||y.height!==b)&&!m&&(m=t(x)),w()},S=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)};S(a,"scroll",E),S(h,"scroll",E),u=t(function(){u=0,w()})}}(e,a)}),this.detach=function(t){u||(n(u),u=0),s.detach(e,t)},this.reset=function(){e.resizeSensor.resetSensor()}};if(s.reset=function(e){r(e,function(e){e.resizeSensor.resetSensor()})},s.detach=function(e,t){r(e,function(e){e&&(e.resizedAttached&&"function"==typeof t&&(e.resizedAttached.remove(t),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached))})},"undefined"!=typeof MutationObserver){var a=new MutationObserver(function(e){for(var t in e)if(e.hasOwnProperty(t))for(var n=e[t].addedNodes,r=0;r<n.length;r++)n[r].resizeSensor&&s.reset(n[r])});document.addEventListener("DOMContentLoaded",function(e){a.observe(document.body,{childList:!0,subtree:!0})})}return s})?r.call(t,n,t,e):r)||(e.exports=i)},445:(e,t,n)=>{var r=n(910),i=n(369),o=n(322);function s(e,t,n){if(!r(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!e.hasNode(t))throw new Error('graphology-shortest-path: the "'+t+'" source node does not exist in the given graph.');if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if((t=""+t)==(n=""+n))return[t];var i=e.inboundNeighbors.bind(e),o=e.outboundNeighbors.bind(e),s={},a={};s[t]=null,a[n]=null;var u,c,l,h,d,f,p,g,m=[t],y=[n],v=!1;e:for(;m.length&&y.length;)if(m.length<=y.length){for(u=m,m=[],d=0,p=u.length;d<p;d++)for(f=0,g=(l=o(c=u[d])).length;f<g;f++)if((h=l[f])in s||(m.push(h),s[h]=c),h in a){v=!0;break e}}else for(u=y,y=[],d=0,p=u.length;d<p;d++)for(f=0,g=(l=i(c=u[d])).length;f<g;f++)if((h=l[f])in a||(y.push(h),a[h]=c),h in s){v=!0;break e}if(!v)return null;for(var b=[];h;)b.unshift(h),h=s[h];for(h=a[b[b.length-1]];h;)b.push(h),h=a[h];return b.length?b:null}function a(e,t){if(!r(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!e.hasNode(t))throw new Error('graphology-shortest-path: the "'+t+'" source node does not exist in the given graph.');var n,i,o,s,a,u,c={},l={};for(c[t=""+t]=!0,l[t]=[t];Object.keys(c).length;)for(o in n=c,c={},n)for(a=0,u=(i=e.outboundNeighbors(o)).length;a<u;a++)l[s=i[a]]||(l[s]=l[o].concat(s),c[s]=!0);return l}function u(e,t,n){if(!r(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var i=new Set,s={},a=0;s[n]=0;for(var u,c,l,h=[n];0!==h.length;){var d=[];for(u=0,c=h.length;u<c;u++)i.has(l=h[u])||(i.add(l),o(d,t[e](l)),s[l]=a);a++,h=d}return s}var c=u.bind(null,"outboundNeighbors"),l=u.bind(null,"neighbors");function h(e,t,n){return arguments.length<3?a(e,t):s(e,t,n)}h.bidirectional=s,h.singleSource=a,h.singleSourceLength=c,h.undirectedSingleSourceLength=l,h.brandes=function(e,t){t=""+t;var n,r,o,s,a,u,c,l,h,d=[],f={},p={},g=e.nodes();for(u=0,l=g.length;u<l;u++)f[s=g[u]]=[],p[s]=0;var m={};p[t]=1,m[t]=0;for(var y=i.of(t);y.size;)for(s=y.dequeue(),d.push(s),n=m[s],r=p[s],c=0,h=(o=e.outboundNeighbors(s)).length;c<h;c++)(a=o[c])in m||(y.enqueue(a),m[a]=n+1),m[a]===n+1&&(p[a]+=r,f[a].push(s));return[d,f,p]},e.exports=h},910:e=>{e.exports=function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.addUndirectedEdgeWithKey&&"function"==typeof e.dropNode&&"boolean"==typeof e.multi}},698:function(e){e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function o(e,t,n){return(o=i()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return o(e,arguments,n(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),r(i,e)})(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var u=function(){for(var e=arguments[0],t=1,n=arguments.length;t<n;t++)if(arguments[t])for(var r in arguments[t])e[r]=arguments[t][r];return e};function c(e,t,n,r){var i=e._nodes.get(t),o=null;return i?o="mixed"===r?i.out&&i.out[n]||i.undirected&&i.undirected[n]:"directed"===r?i.out&&i.out[n]:i.undirected&&i.undirected[n]:o}function l(t){return null!==t&&"object"===e(t)&&"function"==typeof t.addUndirectedEdgeWithKey&&"function"==typeof t.dropNode}function h(t){return"object"===e(t)&&null!==t&&t.constructor===Object}function d(e){var t;for(t in e)return!1;return!0}function f(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!0,value:n})}function p(e,t,n){var r={enumerable:!0,configurable:!0};"function"==typeof n?r.get=n:(r.value=n,r.writable=!1),Object.defineProperty(e,t,r)}function g(e){return!(!h(e)||e.attributes&&!Array.isArray(e.attributes))}"function"==typeof Object.assign&&(u=Object.assign);var m,y={exports:{}},v="object"==typeof Reflect?Reflect:null,b=v&&"function"==typeof v.apply?v.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};m=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var _=Number.isNaN||function(e){return e!=e};function w(){w.init.call(this)}y.exports=w,y.exports.once=function(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}D(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&D(e,"error",t,{once:!0})}(e,i)})},w.EventEmitter=w,w.prototype._events=void 0,w.prototype._eventsCount=0,w.prototype._maxListeners=void 0;var x=10;function E(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function S(e){return void 0===e._maxListeners?w.defaultMaxListeners:e._maxListeners}function A(e,t,n,r){var i,o,s;if(E(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=S(e))>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,console&&console.warn&&console.warn(a)}return e}function k(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function T(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=k.bind(r);return i.listener=n,r.wrapFn=i,i}function O(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):C(i,i.length)}function I(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function C(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function D(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(o){r.once&&e.removeEventListener(t,i),n(o)})}}function j(e){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:e}),this.done=!1}Object.defineProperty(w,"defaultMaxListeners",{enumerable:!0,get:function(){return x},set:function(e){if("number"!=typeof e||e<0||_(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");x=e}}),w.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},w.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||_(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},w.prototype.getMaxListeners=function(){return S(this)},w.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)b(a,this,t);else{var u=a.length,c=C(a,u);for(n=0;n<u;++n)b(c[n],this,t)}return!0},w.prototype.on=w.prototype.addListener=function(e,t){return A(this,e,t,!1)},w.prototype.prependListener=function(e,t){return A(this,e,t,!0)},w.prototype.once=function(e,t){return E(t),this.on(e,T(this,e,t)),this},w.prototype.prependOnceListener=function(e,t){return E(t),this.prependListener(e,T(this,e,t)),this},w.prototype.off=w.prototype.removeListener=function(e,t){var n,r,i,o,s;if(E(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},w.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},w.prototype.listeners=function(e){return O(this,e,!0)},w.prototype.rawListeners=function(e){return O(this,e,!1)},w.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):I.call(e,t)},w.prototype.listenerCount=I,w.prototype.eventNames=function(){return this._eventsCount>0?m(this._events):[]},j.prototype.next=function(){if(this.done)return{done:!0};var e=this._next();return e.done&&(this.done=!0),e},"undefined"!=typeof Symbol&&(j.prototype[Symbol.iterator]=function(){return this}),j.of=function(){var e=arguments,t=e.length,n=0;return new j(function(){return n>=t?{done:!0}:{done:!1,value:e[n++]}})},j.empty=function(){var e=new j(null);return e.done=!0,e},j.is=function(e){return e instanceof j||"object"==typeof e&&null!==e&&"function"==typeof e.next};var P=j,M=function(e,t){for(var n,r=arguments.length>1?t:1/0,i=r!==1/0?new Array(r):[],o=0;;){if(o===r)return i;if((n=e.next()).done)return o!==t?i.slice(0,o):i;i[o++]=n.value}},R=function(e){function n(t,n){var r;return(r=e.call(this)||this).name="GraphError",r.message=t||"",r.data=n||{},r}return t(n,e),n}(s(Error)),N=function(e){function n(t,r){var i;return(i=e.call(this,t,r)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(i),n.prototype.constructor),i}return t(n,e),n}(R),L=function(e){function n(t,r){var i;return(i=e.call(this,t,r)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(i),n.prototype.constructor),i}return t(n,e),n}(R),F=function(e){function n(t,r){var i;return(i=e.call(this,t,r)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(i),n.prototype.constructor),i}return t(n,e),n}(R);function B(e,t){this.key=e,this.attributes=t,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function z(e,t){this.key=e,this.attributes=t,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function U(e,t){this.key=e,this.attributes=t,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function V(e,t,n,r,i,o){this.key=t,this.attributes=o,this.undirected=e,this.source=r,this.target=i,this.generatedKey=n}function G(e,t,n,r,i,o,s){var a,u,c="out",l="in";if(t&&(c=l="undirected"),e.multi){if(void 0===(u=(a=o[c])[i])&&(u=new Set,a[i]=u),u.add(n),r===i&&t)return;void 0===(a=s[l])[r]&&(a[r]=u)}else{if(o[c][i]=n,r===i&&t)return;s[l][r]=n}}function H(e,t,n){var r=e.multi,i=n.source,o=n.target,s=i.key,a=o.key,u=i[t?"undirected":"out"],c=t?"undirected":"in";if(a in u)if(r){var l=u[a];1===l.size?(delete u[a],delete o[c][s]):l.delete(n)}else delete u[a];r||delete o[c][s]}z.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},U.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var q=[{name:function(e){return"get".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,s=""+r;if(r=arguments[2],!(i=c(this,o,s,n)))throw new L("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(s,'").'))}else if(!(i=this._edges.get(e=""+e)))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" ').concat(n," edge in the graph."));return i.attributes[r]}}},{name:function(e){return"get".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e){var r;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new F("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var i=""+e,o=""+arguments[1];if(!(r=c(this,i,o,n)))throw new L("Graph.".concat(t,': could not find an edge for the given path ("').concat(i,'" - "').concat(o,'").'))}else if(!(r=this._edges.get(e=""+e)))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'));if("mixed"!==n&&r.undirected!==("undirected"===n))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" ').concat(n," edge in the graph."));return r.attributes}}},{name:function(e){return"has".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,s=""+r;if(r=arguments[2],!(i=c(this,o,s,n)))throw new L("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(s,'").'))}else if(!(i=this._edges.get(e=""+e)))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" ').concat(n," edge in the graph."));return i.attributes.hasOwnProperty(r)}}},{name:function(e){return"set".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new F("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var s=""+e,a=""+r;if(r=arguments[2],i=arguments[3],!(o=c(this,s,a,n)))throw new L("Graph.".concat(t,': could not find an edge for the given path ("').concat(s,'" - "').concat(a,'").'))}else if(!(o=this._edges.get(e=""+e)))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'));if("mixed"!==n&&o.undirected!==("undirected"===n))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" ').concat(n," edge in the graph."));return o.attributes[r]=i,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}},{name:function(e){return"update".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r,i){var o;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new F("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var s=""+e,a=""+r;if(r=arguments[2],i=arguments[3],!(o=c(this,s,a,n)))throw new L("Graph.".concat(t,': could not find an edge for the given path ("').concat(s,'" - "').concat(a,'").'))}else if(!(o=this._edges.get(e=""+e)))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'));if("function"!=typeof i)throw new N("Graph.".concat(t,": updater should be a function."));if("mixed"!==n&&o.undirected!==("undirected"===n))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" ').concat(n," edge in the graph."));return o.attributes[r]=i(o.attributes[r]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}},{name:function(e){return"remove".concat(e,"Attribute")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,s=""+r;if(r=arguments[2],!(i=c(this,o,s,n)))throw new L("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(s,'").'))}else if(!(i=this._edges.get(e=""+e)))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" ').concat(n," edge in the graph."));return delete i.attributes[r],this.emit("edgeAttributesUpdated",{key:i.key,type:"remove",attributes:i.attributes,name:r}),this}}},{name:function(e){return"replace".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,s=""+r;if(r=arguments[2],!(i=c(this,o,s,n)))throw new L("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(s,'").'))}else if(!(i=this._edges.get(e=""+e)))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'));if(!h(r))throw new N("Graph.".concat(t,": provided attributes are not a plain object."));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" ').concat(n," edge in the graph."));return i.attributes=r,this.emit("edgeAttributesUpdated",{key:i.key,type:"replace",attributes:i.attributes}),this}}},{name:function(e){return"merge".concat(e,"Attributes")},attacher:function(e,t,n){e.prototype[t]=function(e,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(t,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(t,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+e,s=""+r;if(r=arguments[2],!(i=c(this,o,s,n)))throw new L("Graph.".concat(t,': could not find an edge for the given path ("').concat(o,'" - "').concat(s,'").'))}else if(!(i=this._edges.get(e=""+e)))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" edge in the graph.'));if(!h(r))throw new N("Graph.".concat(t,": provided attributes are not a plain object."));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(t,': could not find the "').concat(e,'" ').concat(n," edge in the graph."));return u(i.attributes,r),this.emit("edgeAttributesUpdated",{key:i.key,type:"merge",attributes:i.attributes,data:r}),this}}}],W=P,$=function(){var e,t=arguments,n=-1;return new W(function r(){if(!e){if(++n>=t.length)return{done:!0};e=t[n]}var i=e.next();return i.done?(e=null,r()):i})},X=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function K(e,t){for(var n in t)e.push(t[n].key)}function Z(e,t){for(var n in t)t[n].forEach(function(t){return e.push(t.key)})}function Y(e,t,n){for(var r in e)if(r!==n){var i=e[r];t(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected,i.generatedKey)}}function Q(e,t,n){for(var r in e)r!==n&&e[r].forEach(function(e){return t(e.key,e.attributes,e.source.key,e.target.key,e.source.attributes,e.target.attributes,e.undirected,e.generatedKey)})}function J(e,t,n){for(var r in e)if(r!==n){var i=e[r];if(t(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected,i.generatedKey))return!0}return!1}function ee(e,t,n){var r,i,o,s,a;for(var u in e)if(u!==n)for(r=e[u].values();!0!==(i=r.next()).done;)if(s=(o=i.value).source,t(o.key,o.attributes,s.key,(a=o.target).key,s.attributes,a.attributes,o.undirected,o.generatedKey))return!0;return!1}function te(e,t){var n=Object.keys(e),r=n.length,i=null,o=0;return new P(function s(){var a;if(i){var u=i.next();if(u.done)return i=null,o++,s();a=u.value}else{if(o>=r)return{done:!0};var c=n[o];if(c===t)return o++,s();if((a=e[c])instanceof Set)return i=a.values(),s();o++}return{done:!1,value:[a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes]}})}function ne(e,t,n){var r=t[n];r&&e.push(r.key)}function re(e,t,n){var r=t[n];r&&r.forEach(function(t){return e.push(t.key)})}function ie(e,t,n){var r=e[t];if(r){var i=r.source,o=r.target;n(r.key,r.attributes,i.key,o.key,i.attributes,o.attributes,r.undirected,r.generatedKey)}}function oe(e,t,n){var r=e[t];r&&r.forEach(function(e){return n(e.key,e.attributes,e.source.key,e.target.key,e.source.attributes,e.target.attributes,e.undirected,e.generatedKey)})}function se(e,t,n){var r=e[t];if(r){var i=r.source,o=r.target;return n(r.key,r.attributes,i.key,o.key,i.attributes,o.attributes,r.undirected,r.generatedKey)}}function ae(e,t,n){var r=e[t];if(r){for(var i,o,s=r.values();!0!==(i=s.next()).done;)if(n((o=i.value).key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected,o.generatedKey))return!0;return!1}}function ue(e,t){var n=e[t];if(n instanceof Set){var r=n.values();return new P(function(){var e=r.next();if(e.done)return e;var t=e.value;return{done:!1,value:[t.key,t.attributes,t.source.key,t.target.key,t.source.attributes,t.target.attributes]}})}return P.of([n.key,n.attributes,n.source.key,n.target.key,n.source.attributes,n.target.attributes])}function ce(e,t){if(0===e.size)return[];if("mixed"===t||t===e.type)return"function"==typeof Array.from?Array.from(e._edges.keys()):M(e._edges.keys(),e._edges.size);for(var n,r,i=new Array("undirected"===t?e.undirectedSize:e.directedSize),o="undirected"===t,s=e._edges.values(),a=0;!0!==(n=s.next()).done;)(r=n.value).undirected===o&&(i[a++]=r.key);return i}function le(e,t,n){if(0!==e.size)for(var r,i,o="mixed"!==t&&t!==e.type,s="undirected"===t,a=e._edges.values();!0!==(r=a.next()).done;)if(i=r.value,!o||i.undirected===s){var u=i.source,c=i.target;n(i.key,i.attributes,u.key,c.key,u.attributes,c.attributes,i.undirected,i.generatedKey)}}function he(e,t,n){if(0!==e.size)for(var r,i,o="mixed"!==t&&t!==e.type,s="undirected"===t,a=e._edges.values();!0!==(r=a.next()).done;)if(i=r.value,!o||i.undirected===s){var u=i.source,c=i.target;if(n(i.key,i.attributes,u.key,c.key,u.attributes,c.attributes,i.undirected,i.generatedKey))break}}function de(e,t){if(0===e.size)return P.empty();var n="mixed"!==t&&t!==e.type,r="undirected"===t,i=e._edges.values();return new P(function(){for(var e,t;;){if((e=i.next()).done)return e;if(t=e.value,!n||t.undirected===r)break}return{value:[t.key,t.attributes,t.source.key,t.target.key,t.source.attributes,t.target.attributes],done:!1}})}function fe(e,t,n,r){var i=[],o=e?Z:K;return"undirected"!==t&&("out"!==n&&o(i,r.in),"in"!==n&&o(i,r.out),!n&&r.directedSelfLoops>0&&i.splice(i.lastIndexOf(r.key),1)),"directed"!==t&&o(i,r.undirected),i}function pe(e,t,n,r,i){var o=e?Q:Y;"undirected"!==t&&("out"!==n&&o(r.in,i),"in"!==n&&o(r.out,i,n?null:r.key)),"directed"!==t&&o(r.undirected,i)}function ge(e,t,n,r,i){var o=e?ee:J;if("undirected"!==t){if("out"!==n&&o(r.in,i))return;if("in"!==n&&o(r.out,i,n?null:r.key))return}"directed"===t||o(r.undirected,i)}function me(e,t,n){var r=P.empty();return"undirected"!==e&&("out"!==t&&void 0!==n.in&&(r=$(r,te(n.in))),"in"!==t&&void 0!==n.out&&(r=$(r,te(n.out,t?null:n.key)))),"directed"!==e&&void 0!==n.undirected&&(r=$(r,te(n.undirected))),r}function ye(e,t,n,r,i){var o=t?re:ne,s=[];return"undirected"!==e&&(void 0!==r.in&&"out"!==n&&o(s,r.in,i),void 0!==r.out&&"in"!==n&&o(s,r.out,i),!n&&r.directedSelfLoops>0&&s.splice(s.lastIndexOf(r.key),1)),"directed"!==e&&void 0!==r.undirected&&o(s,r.undirected,i),s}function ve(e,t,n,r,i,o){var s=t?oe:ie;"undirected"!==e&&(void 0!==r.in&&"out"!==n&&s(r.in,i,o),r.key!==i&&void 0!==r.out&&"in"!==n&&s(r.out,i,o)),"directed"!==e&&void 0!==r.undirected&&s(r.undirected,i,o)}function be(e,t,n,r,i,o){var s=t?ae:se;if("undirected"!==e){if(void 0!==r.in&&"out"!==n&&s(r.in,i,o))return;if(r.key!==i&&void 0!==r.out&&"in"!==n&&s(r.out,i,o,n?null:r.key))return}"directed"===e||void 0===r.undirected||s(r.undirected,i,o)}function _e(e,t,n,r){var i=P.empty();return"undirected"!==e&&(void 0!==n.in&&"out"!==t&&r in n.in&&(i=$(i,ue(n.in,r))),void 0!==n.out&&"in"!==t&&r in n.out&&(i=$(i,ue(n.out,r)))),"directed"!==e&&void 0!==n.undirected&&r in n.undirected&&(i=$(i,ue(n.undirected,r))),i}var we=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function xe(e,t){if(void 0!==t)for(var n in t)e.add(n)}function Ee(e,t,n){if("mixed"!==e){if("undirected"===e)return Object.keys(n.undirected);if("string"==typeof t)return Object.keys(n[t])}var r=new Set;return"undirected"!==e&&("out"!==t&&xe(r,n.in),"in"!==t&&xe(r,n.out)),"directed"!==e&&xe(r,n.undirected),M(r.values(),r.size)}function Se(e,t,n){for(var r in t){var i=t[r];i instanceof Set&&(i=i.values().next().value);var o=i.source,s=o===e?i.target:o;n(s.key,s.attributes)}}function Ae(e,t,n,r){for(var i in n){var o=n[i];o instanceof Set&&(o=o.values().next().value);var s=o.source,a=s===t?o.target:s;e.has(a.key)||(e.add(a.key),r(a.key,a.attributes))}}function ke(e,t,n){for(var r in t){var i=t[r];i instanceof Set&&(i=i.values().next().value);var o=i.source,s=o===e?i.target:o;if(n(s.key,s.attributes))return!0}return!1}function Te(e,t,n,r){for(var i in n){var o=n[i];o instanceof Set&&(o=o.values().next().value);var s=o.source,a=s===t?o.target:s;if(!e.has(a.key)&&(e.add(a.key),r(a.key,a.attributes)))return!0}return!1}function Oe(e,t){var n=Object.keys(t),r=n.length,i=0;return new P(function(){if(i>=r)return{done:!0};var o=t[n[i++]];o instanceof Set&&(o=o.values().next().value);var s=o.source,a=s===e?o.target:s;return{done:!1,value:[a.key,a.attributes]}})}function Ie(e,t,n){var r=Object.keys(n),i=r.length,o=0;return new P(function s(){if(o>=i)return{done:!0};var a=n[r[o++]];a instanceof Set&&(a=a.values().next().value);var u=a.source,c=u===t?a.target:u;return e.has(c.key)?s():(e.add(c.key),{done:!1,value:[c.key,c.attributes]})})}function Ce(e,t,n,r,i){var o=e._nodes.get(r);if("undirected"!==t){if("out"!==n&&void 0!==o.in)for(var s in o.in)if(s===i)return!0;if("in"!==n&&void 0!==o.out)for(var a in o.out)if(a===i)return!0}if("directed"!==t&&void 0!==o.undirected)for(var u in o.undirected)if(u===i)return!0;return!1}function De(e,t,n){for(var r,i,o,s,a,u,c,l=t._nodes.values(),h=t.type;!0!==(r=l.next()).done;){if(i=r.value,"undirected"!==h)for(o in s=i.out)if(u=(a=s[o]).target,c=n(i.key,u.key,i.attributes,u.attributes,a.key,a.attributes,a.undirected,a.generatedKey),e&&c)return;if("directed"!==h)for(o in s=i.undirected)if((u=(a=s[o]).target).key!==o&&(u=a.source),c=n(i.key,u.key,i.attributes,u.attributes,a.key,a.attributes,a.undirected,a.generatedKey),e&&c)return}}function je(e,t,n){for(var r,i,o,s,a,u,c,l,h,d=t._nodes.values(),f=t.type;!0!==(r=d.next()).done;){if(i=r.value,"undirected"!==f)for(o in u=i.out)for(s=u[o].values();!0!==(a=s.next()).done;)if(l=(c=a.value).target,h=n(i.key,l.key,i.attributes,l.attributes,c.key,c.attributes,c.undirected,c.generatedKey),e&&h)return;if("directed"!==f)for(o in u=i.undirected)for(s=u[o].values();!0!==(a=s.next()).done;)if((l=(c=a.value).target).key!==o&&(l=c.source),h=n(i.key,l.key,i.attributes,l.attributes,c.key,c.attributes,c.undirected,c.generatedKey),e&&h)return}}function Pe(e,t){var n={key:e};return d(t.attributes)||(n.attributes=u({},t.attributes)),n}function Me(e,t){var n={source:t.source.key,target:t.target.key};return t.generatedKey||(n.key=e),d(t.attributes)||(n.attributes=u({},t.attributes)),t.undirected&&(n.undirected=!0),n}function Re(e){return h(e)?"key"in e?!("attributes"in e)||h(e.attributes)&&null!==e.attributes?null:"invalid-attributes":"no-key":"not-object"}function Ne(e){return h(e)?"source"in e?"target"in e?!("attributes"in e)||h(e.attributes)&&null!==e.attributes?"undirected"in e&&"boolean"!=typeof e.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var Le=new Set(["directed","undirected","mixed"]),Fe=new Set(["domain","_events","_eventsCount","_maxListeners"]),Be={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function ze(e,t,n){var r=new e.NodeDataClass(t,n);return e._nodes.set(t,r),e.emit("nodeAdded",{key:t,attributes:n}),r}function Ue(e,t,n,r,i,o,s,a){if(!r&&"undirected"===e.type)throw new F("Graph.".concat(t,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(r&&"directed"===e.type)throw new F("Graph.".concat(t,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(a&&!h(a))throw new N("Graph.".concat(t,': invalid attributes. Expecting an object but got "').concat(a,'"'));if(o=""+o,s=""+s,a=a||{},!e.allowSelfLoops&&o===s)throw new F("Graph.".concat(t,': source & target are the same ("').concat(o,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var u=e._nodes.get(o),c=e._nodes.get(s);if(!u)throw new L("Graph.".concat(t,': source node "').concat(o,'" not found.'));if(!c)throw new L("Graph.".concat(t,': target node "').concat(s,'" not found.'));var l={key:null,undirected:r,source:o,target:s,attributes:a};if(n&&(i=e._edgeKeyGenerator(l)),e._edges.has(i=""+i))throw new F("Graph.".concat(t,': the "').concat(i,'" edge already exists in the graph.'));if(!e.multi&&(r?void 0!==u.undirected[s]:void 0!==u.out[s]))throw new F("Graph.".concat(t,': an edge linking "').concat(o,'" to "').concat(s,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var d=new V(r,i,n,u,c,a);return e._edges.set(i,d),o===s?r?(u.undirectedSelfLoops++,e._undirectedSelfLoopCount++):(u.directedSelfLoops++,e._directedSelfLoopCount++):r?(u.undirectedDegree++,c.undirectedDegree++):(u.outDegree++,c.inDegree++),G(e,r,d,o,s,u,c),r?e._undirectedSize++:e._directedSize++,l.key=i,e.emit("edgeAdded",l),i}function Ve(e,t,n,r,i,o,s,a,c){if(!r&&"undirected"===e.type)throw new F("Graph.".concat(t,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(r&&"directed"===e.type)throw new F("Graph.".concat(t,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(a)if(c){if("function"!=typeof a)throw new N("Graph.".concat(t,': invalid updater function. Expecting a function but got "').concat(a,'"'))}else if(!h(a))throw new N("Graph.".concat(t,': invalid attributes. Expecting an object but got "').concat(a,'"'));var l;if(o=""+o,s=""+s,c&&(l=a,a=void 0),!e.allowSelfLoops&&o===s)throw new F("Graph.".concat(t,': source & target are the same ("').concat(o,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var d,f,p=e._nodes.get(o),g=e._nodes.get(s);if(!n&&(d=e._edges.get(i))){if(d.source.key!==o||d.target.key!==s||r&&(d.source.key!==s||d.target.key!==o))throw new F("Graph.".concat(t,': inconsistency detected when attempting to merge the "').concat(i,'" edge with "').concat(o,'" source & "').concat(s,'" target vs. ("').concat(d.source.key,'", "').concat(d.target.key,'").'));f=d}if(f||e.multi||!p||(f=r?p.undirected[s]:p.out[s]),f)return(c?l:a)?(c?(f.attributes=l(f.attributes),e.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})):(u(f.attributes,a),e.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:a})),f.key):f.key;a=a||{},c&&l&&(a=l(a));var m={key:null,undirected:r,source:o,target:s,attributes:a};if(n&&(i=e._edgeKeyGenerator(m)),e._edges.has(i=""+i))throw new F("Graph.".concat(t,': the "').concat(i,'" edge already exists in the graph.'));return p||(p=ze(e,o,{}),o===s&&(g=p)),g||(g=ze(e,s,{})),d=new V(r,i,n,p,g,a),e._edges.set(i,d),o===s?r?(p.undirectedSelfLoops++,e._undirectedSelfLoopCount++):(p.directedSelfLoops++,e._directedSelfLoopCount++):r?(p.undirectedDegree++,g.undirectedDegree++):(p.outDegree++,g.inDegree++),G(e,r,d,o,s,p,g),r?e._undirectedSize++:e._directedSize++,m.key=i,e.emit("edgeAdded",m),i}var Ge=function(e){function n(t){var n;if(n=e.call(this)||this,(t=u({},Be,t)).edgeKeyGenerator&&"function"!=typeof t.edgeKeyGenerator)throw new N("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(t.edgeKeyGenerator,'".'));if("boolean"!=typeof t.multi)throw new N("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(t.multi,'".'));if(!Le.has(t.type))throw new N('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(t.type,'".'));if("boolean"!=typeof t.allowSelfLoops)throw new N("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(t.allowSelfLoops,'".'));var r,i="mixed"===t.type?B:"directed"===t.type?z:U;return f(a(n),"NodeDataClass",i),f(a(n),"_attributes",{}),f(a(n),"_nodes",new Map),f(a(n),"_edges",new Map),f(a(n),"_directedSize",0),f(a(n),"_undirectedSize",0),f(a(n),"_directedSelfLoopCount",0),f(a(n),"_undirectedSelfLoopCount",0),f(a(n),"_edgeKeyGenerator",t.edgeKeyGenerator||(r=0,function(){return r++})),f(a(n),"_options",t),Fe.forEach(function(e){return f(a(n),e,n[e])}),p(a(n),"order",function(){return n._nodes.size}),p(a(n),"size",function(){return n._edges.size}),p(a(n),"directedSize",function(){return n._directedSize}),p(a(n),"undirectedSize",function(){return n._undirectedSize}),p(a(n),"selfLoopCount",function(){return n._directedSelfLoopCount+n._undirectedSelfLoopCount}),p(a(n),"directedSelfLoopCount",function(){return n._directedSelfLoopCount}),p(a(n),"undirectedSelfLoopCount",function(){return n._undirectedSelfLoopCount}),p(a(n),"multi",n._options.multi),p(a(n),"type",n._options.type),p(a(n),"allowSelfLoops",n._options.allowSelfLoops),p(a(n),"implementation",function(){return"graphology"}),n}t(n,e);var r=n.prototype;return r.hasNode=function(e){return this._nodes.has(""+e)},r.hasDirectedEdge=function(e,t){if("undirected"===this.type)return!1;if(1===arguments.length){var n=this._edges.get(""+e);return!!n&&!n.undirected}if(2===arguments.length){t=""+t;var r=this._nodes.get(e=""+e);if(!r)return!1;var i=r.out[t];return!(!i||this.multi&&!i.size)}throw new N("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},r.hasUndirectedEdge=function(e,t){if("directed"===this.type)return!1;if(1===arguments.length){var n=this._edges.get(""+e);return!!n&&n.undirected}if(2===arguments.length){t=""+t;var r=this._nodes.get(e=""+e);if(!r)return!1;var i=r.undirected[t];return!(!i||this.multi&&!i.size)}throw new N("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},r.hasEdge=function(e,t){if(1===arguments.length)return this._edges.has(""+e);if(2===arguments.length){t=""+t;var n=this._nodes.get(e=""+e);if(!n)return!1;var r=void 0!==n.out&&n.out[t];return r||(r=void 0!==n.undirected&&n.undirected[t]),!(!r||this.multi&&!r.size)}throw new N("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},r.directedEdge=function(e,t){if("undirected"!==this.type){if(e=""+e,t=""+t,this.multi)throw new F("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var n=this._nodes.get(e);if(!n)throw new L('Graph.directedEdge: could not find the "'.concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new L('Graph.directedEdge: could not find the "'.concat(t,'" target node in the graph.'));var r=n.out&&n.out[t]||void 0;return r?r.key:void 0}},r.undirectedEdge=function(e,t){if("directed"!==this.type){if(e=""+e,t=""+t,this.multi)throw new F("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var n=this._nodes.get(e);if(!n)throw new L('Graph.undirectedEdge: could not find the "'.concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new L('Graph.undirectedEdge: could not find the "'.concat(t,'" target node in the graph.'));var r=n.undirected&&n.undirected[t]||void 0;return r?r.key:void 0}},r.edge=function(e,t){if(this.multi)throw new F("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");t=""+t;var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.edge: could not find the "'.concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new L('Graph.edge: could not find the "'.concat(t,'" target node in the graph.'));var r=n.out&&n.out[t]||n.undirected&&n.undirected[t]||void 0;if(r)return r.key},r.inDegree=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof t)throw new N('Graph.inDegree: Expecting a boolean but got "'.concat(t,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.inDegree: could not find the "'.concat(e,'" node in the graph.'));return"undirected"===this.type?0:n.inDegree+(t?n.directedSelfLoops:0)},r.outDegree=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof t)throw new N('Graph.outDegree: Expecting a boolean but got "'.concat(t,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.outDegree: could not find the "'.concat(e,'" node in the graph.'));return"undirected"===this.type?0:n.outDegree+(t?n.directedSelfLoops:0)},r.directedDegree=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof t)throw new N('Graph.directedDegree: Expecting a boolean but got "'.concat(t,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.directedDegree: could not find the "'.concat(e,'" node in the graph.'));if("undirected"===this.type)return 0;var r=t?n.directedSelfLoops:0;return n.inDegree+r+(n.outDegree+r)},r.undirectedDegree=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof t)throw new N('Graph.undirectedDegree: Expecting a boolean but got "'.concat(t,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.undirectedDegree: could not find the "'.concat(e,'" node in the graph.'));return"directed"===this.type?0:n.undirectedDegree+2*(t?n.undirectedSelfLoops:0)},r.degree=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof t)throw new N('Graph.degree: Expecting a boolean but got "'.concat(t,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.degree: could not find the "'.concat(e,'" node in the graph.'));var r=0,i=0;return"directed"!==this.type&&(t&&(i=n.undirectedSelfLoops),r+=n.undirectedDegree+2*i),"undirected"!==this.type&&(t&&(i=n.directedSelfLoops),r+=n.inDegree+n.outDegree+2*i),r},r.source=function(e){var t=this._edges.get(e=""+e);if(!t)throw new L('Graph.source: could not find the "'.concat(e,'" edge in the graph.'));return t.source.key},r.target=function(e){var t=this._edges.get(e=""+e);if(!t)throw new L('Graph.target: could not find the "'.concat(e,'" edge in the graph.'));return t.target.key},r.extremities=function(e){var t=this._edges.get(e=""+e);if(!t)throw new L('Graph.extremities: could not find the "'.concat(e,'" edge in the graph.'));return[t.source.key,t.target.key]},r.opposite=function(e,t){e=""+e;var n=this._edges.get(t=""+t);if(!n)throw new L('Graph.opposite: could not find the "'.concat(t,'" edge in the graph.'));var r=n.source.key,i=n.target.key;if(e!==r&&e!==i)throw new L('Graph.opposite: the "'.concat(e,'" node is not attached to the "').concat(t,'" edge (').concat(r,", ").concat(i,")."));return e===r?i:r},r.hasExtremity=function(e,t){t=""+t;var n=this._edges.get(e=""+e);if(!n)throw new L('Graph.hasExtremity: could not find the "'.concat(e,'" edge in the graph.'));return n.source.key===t||n.target.key===t},r.isUndirected=function(e){var t=this._edges.get(e=""+e);if(!t)throw new L('Graph.isUndirected: could not find the "'.concat(e,'" edge in the graph.'));return t.undirected},r.isDirected=function(e){var t=this._edges.get(e=""+e);if(!t)throw new L('Graph.isDirected: could not find the "'.concat(e,'" edge in the graph.'));return!t.undirected},r.isSelfLoop=function(e){var t=this._edges.get(e=""+e);if(!t)throw new L('Graph.isSelfLoop: could not find the "'.concat(e,'" edge in the graph.'));return t.source===t.target},r.hasGeneratedKey=function(e){var t=this._edges.get(e=""+e);if(!t)throw new L('Graph.hasGeneratedKey: could not find the "'.concat(e,'" edge in the graph.'));return t.generatedKey},r.addNode=function(e,t){return function(e,t,n){if(n&&!h(n))throw new N('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(n,'"'));if(n=n||{},e._nodes.has(t=""+t))throw new F('Graph.addNode: the "'.concat(t,'" node already exist in the graph.'));var r=new e.NodeDataClass(t,n);return e._nodes.set(t,r),e.emit("nodeAdded",{key:t,attributes:n}),r}(this,e,t).key},r.mergeNode=function(e,t){if(t&&!h(t))throw new N('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(t,'"'));t=t||{};var n=this._nodes.get(e=""+e);return n?(t&&(u(n.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:n.attributes,data:t})),e):(n=new this.NodeDataClass(e,t),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:t}),e)},r.updateNode=function(e,t){if(t&&"function"!=typeof t)throw new N('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(t,'"'));var n=this._nodes.get(e=""+e);if(n)return t&&(n.attributes=t(n.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:n.attributes})),e;var r=t?t({}):{};return n=new this.NodeDataClass(e,r),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:r}),e},r.dropNode=function(e){var t=this,n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.dropNode: could not find the "'.concat(e,'" node in the graph.'));this.forEachEdge(e,function(e){t.dropEdge(e)}),this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})},r.dropEdge=function(e){var t;if(arguments.length>1){var n=""+arguments[0],r=""+arguments[1];if(!(t=c(this,n,r,this.type)))throw new L('Graph.dropEdge: could not find the "'.concat(n,'" -> "').concat(r,'" edge in the graph.'))}else if(!(t=this._edges.get(e=""+e)))throw new L('Graph.dropEdge: could not find the "'.concat(e,'" edge in the graph.'));this._edges.delete(t.key);var i=t.source,o=t.target,s=t.attributes,a=t.undirected;return i===o?a?(i.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(i.directedSelfLoops--,this._directedSelfLoopCount--):a?(i.undirectedDegree--,o.undirectedDegree--):(i.outDegree--,o.inDegree--),H(this,a,t),a?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:e,attributes:s,source:i.key,target:o.key,undirected:a}),this},r.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},r.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},r.getAttribute=function(e){return this._attributes[e]},r.getAttributes=function(){return this._attributes},r.hasAttribute=function(e){return this._attributes.hasOwnProperty(e)},r.setAttribute=function(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this},r.updateAttribute=function(e,t){if("function"!=typeof t)throw new N("Graph.updateAttribute: updater should be a function.");return this._attributes[e]=t(this._attributes[e]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this},r.removeAttribute=function(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this},r.replaceAttributes=function(e){if(!h(e))throw new N("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},r.mergeAttributes=function(e){if(!h(e))throw new N("Graph.mergeAttributes: provided attributes are not a plain object.");return u(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this},r.getNodeAttribute=function(e,t){var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.getNodeAttribute: could not find the "'.concat(e,'" node in the graph.'));return n.attributes[t]},r.getNodeAttributes=function(e){var t=this._nodes.get(e=""+e);if(!t)throw new L('Graph.getNodeAttributes: could not find the "'.concat(e,'" node in the graph.'));return t.attributes},r.hasNodeAttribute=function(e,t){var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.hasNodeAttribute: could not find the "'.concat(e,'" node in the graph.'));return n.attributes.hasOwnProperty(t)},r.setNodeAttribute=function(e,t,n){var r=this._nodes.get(e=""+e);if(!r)throw new L('Graph.setNodeAttribute: could not find the "'.concat(e,'" node in the graph.'));if(arguments.length<3)throw new N("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return r.attributes[t]=n,this.emit("nodeAttributesUpdated",{key:e,type:"set",attributes:r.attributes,name:t}),this},r.updateNodeAttribute=function(e,t,n){var r=this._nodes.get(e=""+e);if(!r)throw new L('Graph.updateNodeAttribute: could not find the "'.concat(e,'" node in the graph.'));if(arguments.length<3)throw new N("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof n)throw new N("Graph.updateAttribute: updater should be a function.");var i=r.attributes,o=n(i[t]);return i[t]=o,this.emit("nodeAttributesUpdated",{key:e,type:"set",attributes:r.attributes,name:t}),this},r.removeNodeAttribute=function(e,t){var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.hasNodeAttribute: could not find the "'.concat(e,'" node in the graph.'));return delete n.attributes[t],this.emit("nodeAttributesUpdated",{key:e,type:"remove",attributes:n.attributes,name:t}),this},r.replaceNodeAttributes=function(e,t){var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.replaceNodeAttributes: could not find the "'.concat(e,'" node in the graph.'));if(!h(t))throw new N("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return n.attributes=t,this.emit("nodeAttributesUpdated",{key:e,type:"replace",attributes:n.attributes}),this},r.mergeNodeAttributes=function(e,t){var n=this._nodes.get(e=""+e);if(!n)throw new L('Graph.mergeNodeAttributes: could not find the "'.concat(e,'" node in the graph.'));if(!h(t))throw new N("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return u(n.attributes,t),this.emit("nodeAttributesUpdated",{key:e,type:"merge",attributes:n.attributes,data:t}),this},r.updateEachNodeAttributes=function(e,t){if("function"!=typeof e)throw new N("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!g(t))throw new N("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var n,r,i=this._nodes.values();!0!==(n=i.next()).done;)(r=n.value).attributes=e(r.key,r.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})},r.updateEachEdgeAttributes=function(e,t){if("function"!=typeof e)throw new N("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!g(t))throw new N("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var n,r,i=this._edges.values();!0!==(n=i.next()).done;)(r=n.value).attributes=e(r.key,r.attributes);this.emit("eachEdgeAttributesUpdated",{hints:t||null})},r.forEach=function(e){if("function"!=typeof e)throw new N("Graph.forEach: expecting a callback.");this.multi?je(!1,this,e):De(!1,this,e)},r.forEachUntil=function(e){if("function"!=typeof e)throw new N("Graph.forEach: expecting a callback.");this.multi?je(!0,this,e):De(!0,this,e)},r.adjacency=function(){return this.multi?(o=(e=this)._nodes.values(),s=e.type,a="outer",u=null,new P(function e(){var c;if("outer"===a)return!0===(c=o.next()).done?c:(t=c.value,a="directed",e());if("directed"===a)return"undirected"===s?(a="undirected",e()):(r=t.out,n=Object.keys(t.out),i=0,a="inner-directed",e());if("undirected"===a){if("directed"===s)return a="outer",e();r=t.undirected,n=Object.keys(t.undirected),i=0,a="inner-undirected"}if(!u&&i>=n.length)return a="inner-undirected"===a?"outer":"undirected",e();if(!u){var l=n[i++];return u=r[l].values(),e()}if((c=u.next()).done)return u=null,e();var h=c.value,d=h.target;return"inner-undirected"===a&&d.key===t.key&&(d=h.source),{done:!1,value:[t.key,d.key,t.attributes,d.attributes,h.key,h.attributes]}})):function(e){var t,n,r,i,o=e._nodes.values(),s=e.type,a="outer";return new P(function e(){var u;if("outer"===a)return!0===(u=o.next()).done?u:(t=u.value,a="directed",e());if("directed"===a)return"undirected"===s?(a="undirected",e()):(r=t.out,n=Object.keys(t.out),i=0,a="inner-directed",e());if("undirected"===a){if("directed"===s)return a="outer",e();r=t.undirected,n=Object.keys(t.undirected),i=0,a="inner-undirected"}if(i>=n.length)return a="inner-undirected"===a?"outer":"undirected",e();var c=n[i++],l=r[c],h=l.target;return"inner-undirected"===a&&h.key===t.key&&(h=l.source),{done:!1,value:[t.key,h.key,t.attributes,h.attributes,l.key,l.attributes]}})}(this);var e,t,n,r,i,o,s,a,u},r.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):M(this._nodes.keys(),this._nodes.size)},r.forEachNode=function(e){if("function"!=typeof e)throw new N("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(t,n){e(n,t.attributes)})},r.forEachNodeUntil=function(e){if("function"!=typeof e)throw new N("Graph.forEachNode: expecting a callback.");for(var t,n,r=this._nodes.values();!0!==(t=r.next())&&!e((n=t.value).key,n.attributes););},r.nodeEntries=function(){var e=this._nodes.values();return new P(function(){var t=e.next();if(t.done)return t;var n=t.value;return{value:[n.key,n.attributes],done:!1}})},r.exportNode=function(e){var t=this._nodes.get(e=""+e);if(!t)throw new L('Graph.exportNode: could not find the "'.concat(e,'" node in the graph.'));return Pe(e,t)},r.exportEdge=function(e){var t=this._edges.get(e=""+e);if(!t)throw new L('Graph.exportEdge: could not find the "'.concat(e,'" edge in the graph.'));return Me(e,t)},r.export=function(){var e=new Array(this._nodes.size),t=0;this._nodes.forEach(function(n,r){e[t++]=Pe(r,n)});var n=new Array(this._edges.size);return t=0,this._edges.forEach(function(e,r){n[t++]=Me(r,e)}),{attributes:this.getAttributes(),nodes:e,edges:n,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},r.importNode=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Re(e);if(n){if("not-object"===n)throw new N('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===n)throw new N("Graph.importNode: no key provided.");if("invalid-attributes"===n)throw new N("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var r=e.key,i=e.attributes,o=void 0===i?{}:i;return t?this.mergeNode(r,o):this.addNode(r,o),this},r.importEdge=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ne(e);if(n){if("not-object"===n)throw new N('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===n)throw new N("Graph.importEdge: missing souce.");if("no-target"===n)throw new N("Graph.importEdge: missing target.");if("invalid-attributes"===n)throw new N("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===n)throw new N("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var r=e.source,i=e.target,o=e.attributes,s=void 0===o?{}:o,a=e.undirected,u=void 0!==a&&a;return"key"in e?(t?u?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:u?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,e.key,r,i,s):(t?u?this.mergeUndirectedEdge:this.mergeDirectedEdge:u?this.addUndirectedEdge:this.addDirectedEdge).call(this,r,i,s),this},r.import=function(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(l(e))return this.import(e.export(),i),this;if(!h(e))throw new N("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!h(e.attributes))throw new N("Graph.import: invalid attributes. Expecting a plain object.");i?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}if(e.nodes){if(r=e.nodes,!Array.isArray(r))throw new N("Graph.import: invalid nodes. Expecting an array.");for(t=0,n=r.length;t<n;t++)this.importNode(r[t],i)}if(e.edges){if(r=e.edges,!Array.isArray(r))throw new N("Graph.import: invalid edges. Expecting an array.");for(t=0,n=r.length;t<n;t++)this.importEdge(r[t],i)}return this},r.nullCopy=function(e){return new n(u({},this._options,e))},r.emptyCopy=function(e){var t=this.nullCopy(e);return this._nodes.forEach(function(e,n){var r=u({},e.attributes);e=new t.NodeDataClass(n,r),t._nodes.set(n,e)}),t},r.copy=function(){var e=new n(this._options);return e.import(this),e},r.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(e){return e.upgradeToMixed()}),this._options.type="mixed",p(this,"type",this._options.type),f(this,"NodeDataClass",B)),this},r.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,p(this,"multi",!0),(e=this)._nodes.forEach(function(t,n){if(t.out)for(var r in t.out){var i=new Set;i.add(t.out[r]),t.out[r]=i,e._nodes.get(r).in[n]=i}if(t.undirected)for(var o in t.undirected)if(!(o>n)){var s=new Set;s.add(t.undirected[o]),t.undirected[o]=s,e._nodes.get(o).undirected[n]=s}})),this;var e},r.clearIndex=function(){return this._nodes.forEach(function(e){void 0!==e.in&&(e.in={},e.out={}),void 0!==e.undirected&&(e.undirected={})}),this},r.toJSON=function(){return this.export()},r.toString=function(){return"[object Graph]"},r.inspect=function(){var e=this,t={};this._nodes.forEach(function(e,n){t[n]=e.attributes});var n={},r={};this._edges.forEach(function(t,i){var o=t.undirected?"--":"->",s="",a="(".concat(t.source.key,")").concat(o,"(").concat(t.target.key,")");t.generatedKey?e.multi&&(void 0===r[a]?r[a]=0:r[a]++,s+="".concat(r[a],". ")):s+="[".concat(i,"]: "),n[s+=a]=t.attributes});var i={};for(var o in this)this.hasOwnProperty(o)&&!Fe.has(o)&&"function"!=typeof this[o]&&(i[o]=this[o]);return i.attributes=this._attributes,i.nodes=t,i.edges=n,f(i,"constructor",this.constructor),i},n}(y.exports.EventEmitter);"undefined"!=typeof Symbol&&(Ge.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ge.prototype.inspect),[{name:function(e){return"".concat(e,"Edge")},generateKey:!0},{name:function(e){return"".concat(e,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(e){return"".concat(e,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(e){return"".concat(e,"EdgeWithKey")}},{name:function(e){return"".concat(e,"DirectedEdgeWithKey")},type:"directed"},{name:function(e){return"".concat(e,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(e){["add","merge","update"].forEach(function(t){var n=e.name(t),r="add"===t?Ue:Ve;Ge.prototype[n]=e.generateKey?function(i,o,s){return r(this,n,!0,"undirected"===(e.type||this.type),null,i,o,s,"update"===t)}:function(i,o,s,a){return r(this,n,!1,"undirected"===(e.type||this.type),i,o,s,a,"update"===t)}})}),"undefined"!=typeof Symbol&&(Ge.prototype[Symbol.iterator]=Ge.prototype.adjacency),function(e){q.forEach(function(t){var n=t.name,r=t.attacher;r(e,n("Edge"),"mixed"),r(e,n("DirectedEdge"),"directed"),r(e,n("UndirectedEdge"),"undirected")})}(Ge),function(e){X.forEach(function(t){!function(e,t){var n=t.name,r=t.type,i=t.direction;e.prototype[n]=function(e,t){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return[];if(!arguments.length)return ce(this,r);if(1===arguments.length){var o=this._nodes.get(e=""+e);if(void 0===o)throw new L("Graph.".concat(n,': could not find the "').concat(e,'" node in the graph.'));return fe(this.multi,"mixed"===r?this.type:r,i,o)}if(2===arguments.length){t=""+t;var s=this._nodes.get(e=""+e);if(!s)throw new L("Graph.".concat(n,':  could not find the "').concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new L("Graph.".concat(n,':  could not find the "').concat(t,'" target node in the graph.'));return ye(r,this.multi,i,s,t)}throw new N("Graph.".concat(n,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o="forEach"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[o]=function(e,t,n){if("mixed"===r||"mixed"===this.type||r===this.type){if(1===arguments.length)return le(this,r,n=e);if(2===arguments.length){n=t;var s=this._nodes.get(e=""+e);if(void 0===s)throw new L("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));return pe(this.multi,"mixed"===r?this.type:r,i,s,n)}if(3===arguments.length){t=""+t;var a=this._nodes.get(e=""+e);if(!a)throw new L("Graph.".concat(o,':  could not find the "').concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new L("Graph.".concat(o,':  could not find the "').concat(t,'" target node in the graph.'));return ve(r,this.multi,i,a,t,n)}throw new N("Graph.".concat(o,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o="forEach"+n[0].toUpperCase()+n.slice(1,-1)+"Until";e.prototype[o]=function(e,t,n){if("mixed"===r||"mixed"===this.type||r===this.type){if(1===arguments.length)return he(this,r,n=e);if(2===arguments.length){n=t;var s=this._nodes.get(e=""+e);if(void 0===s)throw new L("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));return ge(this.multi,"mixed"===r?this.type:r,i,s,n)}if(3===arguments.length){t=""+t;var a=this._nodes.get(e=""+e);if(!a)throw new L("Graph.".concat(o,':  could not find the "').concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new L("Graph.".concat(o,':  could not find the "').concat(t,'" target node in the graph.'));return be(r,this.multi,i,a,t,n)}throw new N("Graph.".concat(o,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(e,t),function(e,t){var n=t.type,r=t.direction,i=t.name.slice(0,-1)+"Entries";e.prototype[i]=function(e,t){if("mixed"!==n&&"mixed"!==this.type&&n!==this.type)return P.empty();if(!arguments.length)return de(this,n);if(1===arguments.length){var o=this._nodes.get(e=""+e);if(!o)throw new L("Graph.".concat(i,': could not find the "').concat(e,'" node in the graph.'));return me(n,r,o)}if(2===arguments.length){t=""+t;var s=this._nodes.get(e=""+e);if(!s)throw new L("Graph.".concat(i,':  could not find the "').concat(e,'" source node in the graph.'));if(!this._nodes.has(t))throw new L("Graph.".concat(i,':  could not find the "').concat(t,'" target node in the graph.'));return _e(n,r,s,t)}throw new N("Graph.".concat(i,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(e,t)})}(Ge),function(e){we.forEach(function(t){!function(e,t){var n=t.name,r=t.type,i=t.direction;e.prototype[n]=function(e){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return[];if(2===arguments.length){var t=""+arguments[0],o=""+arguments[1];if(!this._nodes.has(t))throw new L("Graph.".concat(n,': could not find the "').concat(t,'" node in the graph.'));if(!this._nodes.has(o))throw new L("Graph.".concat(n,': could not find the "').concat(o,'" node in the graph.'));return Ce(this,r,i,t,o)}if(1===arguments.length){var s=this._nodes.get(e=""+e);if(void 0===s)throw new L("Graph.".concat(n,': could not find the "').concat(e,'" node in the graph.'));return Ee("mixed"===r?this.type:r,i,s)}throw new N("Graph.".concat(n,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o="forEach"+n[0].toUpperCase()+n.slice(1,-1);e.prototype[o]=function(e,t){if("mixed"===r||"mixed"===this.type||r===this.type){var n=this._nodes.get(e=""+e);if(void 0===n)throw new L("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));!function(e,t,n,r){if("mixed"!==e){if("undirected"===e)return Se(n,n.undirected,r);if("string"==typeof t)return Se(n,n[t],r)}var i=new Set;"undirected"!==e&&("out"!==t&&Ae(i,n,n.in,r),"in"!==t&&Ae(i,n,n.out,r)),"directed"!==e&&Ae(i,n,n.undirected,r)}("mixed"===r?this.type:r,i,n,t)}}}(e,t),function(e,t){var n=t.name,r=t.type,i=t.direction,o="forEach"+n[0].toUpperCase()+n.slice(1,-1)+"Until";e.prototype[o]=function(e,t){if("mixed"===r||"mixed"===this.type||r===this.type){var n=this._nodes.get(e=""+e);if(void 0===n)throw new L("Graph.".concat(o,': could not find the "').concat(e,'" node in the graph.'));!function(e,t,n,r){if("mixed"!==e){if("undirected"===e)return ke(n,n.undirected,r);if("string"==typeof t)return ke(n,n[t],r)}var i=new Set;if("undirected"!==e){if("out"!==t&&Te(i,n,n.in,r))return;if("in"!==t&&Te(i,n,n.out,r))return}"directed"===e||Te(i,n,n.undirected,r)}("mixed"===r?this.type:r,i,n,t)}}}(e,t),function(e,t){var n=t.type,r=t.direction,i=t.name.slice(0,-1)+"Entries";e.prototype[i]=function(e){if("mixed"!==n&&"mixed"!==this.type&&n!==this.type)return P.empty();var t=this._nodes.get(e=""+e);if(void 0===t)throw new L("Graph.".concat(i,': could not find the "').concat(e,'" node in the graph.'));return function(e,t,n){if("mixed"!==e){if("undirected"===e)return Oe(n,n.undirected);if("string"==typeof t)return Oe(n,n[t])}var r=P.empty(),i=new Set;return"undirected"!==e&&("out"!==t&&(r=$(r,Ie(i,n,n.in))),"in"!==t&&(r=$(r,Ie(i,n,n.out)))),"directed"!==e&&(r=$(r,Ie(i,n,n.undirected))),r}("mixed"===n?this.type:n,r,t)}}(e,t)})}(Ge);var He=function(e){function n(t){var n=u({type:"directed"},t);if("multi"in n&&!1!==n.multi)throw new N("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==n.type)throw new N('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return e.call(this,n)||this}return t(n,e),n}(Ge),qe=function(e){function n(t){var n=u({type:"undirected"},t);if("multi"in n&&!1!==n.multi)throw new N("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==n.type)throw new N('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return e.call(this,n)||this}return t(n,e),n}(Ge),We=function(e){function n(t){var n=u({multi:!0},t);if("multi"in n&&!0!==n.multi)throw new N("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return e.call(this,n)||this}return t(n,e),n}(Ge),$e=function(e){function n(t){var n=u({type:"directed",multi:!0},t);if("multi"in n&&!0!==n.multi)throw new N("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==n.type)throw new N('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return e.call(this,n)||this}return t(n,e),n}(Ge),Xe=function(e){function n(t){var n=u({type:"undirected",multi:!0},t);if("multi"in n&&!0!==n.multi)throw new N("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==n.type)throw new N('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return e.call(this,n)||this}return t(n,e),n}(Ge);function Ke(e){e.from=function(t,n){var r=u({},t.options,n),i=new e(r);return i.import(t),i}}return Ke(Ge),Ke(He),Ke(qe),Ke(We),Ke($e),Ke(Xe),Ge.Graph=Ge,Ge.DirectedGraph=He,Ge.UndirectedGraph=qe,Ge.MultiGraph=We,Ge.MultiDirectedGraph=$e,Ge.MultiUndirectedGraph=Xe,Ge.InvalidArgumentsGraphError=N,Ge.NotFoundGraphError=L,Ge.UsageGraphError=F,Ge}()},524:(e,t,n)=>{var r;!function(i,o,s,a){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(e,t,n){return setTimeout(w(e,n),t)}function g(e,t,n){return!!Array.isArray(e)&&(m(e,n[t],n),!0)}function m(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==a)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function y(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),e.apply(this,arguments)}}u="function"!=typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var v=y(function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;)(!n||n&&e[r[i]]===a)&&(e[r[i]]=t[r[i]]),i++;return e},"extend","Use `assign`."),b=y(function(e,t){return v(e,t,!0)},"merge","Use `assign`.");function _(e,t,n){var r,i=t.prototype;(r=e.prototype=Object.create(i)).constructor=e,r._super=i,n&&u(r,n)}function w(e,t){return function(){return e.apply(t,arguments)}}function x(e,t){return"function"==typeof e?e.apply(t&&t[0]||a,t):e}function E(e,t){return e===a?t:e}function S(e,t,n){m(O(t),function(t){e.addEventListener(t,n,!1)})}function A(e,t,n){m(O(t),function(t){e.removeEventListener(t,n,!1)})}function k(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function T(e,t){return e.indexOf(t)>-1}function O(e){return e.trim().split(/\s+/g)}function I(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function C(e){return Array.prototype.slice.call(e,0)}function D(e,t,n){for(var r=[],i=[],o=0;o<e.length;){var s=t?e[o][t]:e[o];I(i,s)<0&&r.push(e[o]),i[o]=s,o++}return n&&(r=t?r.sort(function(e,n){return e[t]>n[t]}):r.sort()),r}function j(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:t)in e)return r;o++}return a}var P=1;function M(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var R="ontouchstart"in i,N=j(i,"PointerEvent")!==a,L=R&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F="touch",B="mouse",z=["x","y"],U=["clientX","clientY"];function V(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){x(e.options.enable,[e])&&n.handler(t)},this.init()}function G(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&t&&r-i==0,s=12&t&&r-i==0;n.isFirst=!!o,n.isFinal=!!s,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=H(t)),i>1&&!n.firstMultiple?n.firstMultiple=H(t):1===i&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,u=s?s.center:o.center,c=t.center=q(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=K(u,c),t.distance=X(u,c),function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},o=e.prevInput||{};1!==t.eventType&&4!==o.eventType||(i=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}(n,t),t.offsetDirection=$(t.deltaX,t.deltaY);var l,h,p=W(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=p.x,t.overallVelocityY=p.y,t.overallVelocity=d(p.x)>d(p.y)?p.x:p.y,t.scale=s?(l=s.pointers,X((h=r)[0],h[1],U)/X(l[0],l[1],U)):1,t.rotation=s?function(e,t){return K(t[1],t[0],U)+K(e[1],e[0],U)}(s.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,i,o,s=e.lastInterval||t,u=t.timeStamp-s.timeStamp;if(8!=t.eventType&&(u>25||s.velocity===a)){var c=t.deltaX-s.deltaX,l=t.deltaY-s.deltaY,h=W(u,c,l);r=h.x,i=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=$(c,l),e.lastInterval=t}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=o}(n,t);var g=e.element;k(t.srcEvent.target,g)&&(g=t.srcEvent.target),t.target=g}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function H(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:q(t),deltaX:e.deltaX,deltaY:e.deltaY}}function q(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:h(n/t),y:h(r/t)}}function W(e,t,n){return{x:t/e||0,y:n/e||0}}function $(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function X(e,t,n){n||(n=z);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function K(e,t,n){return n||(n=z),180*Math.atan2(t[n[1]]-e[n[1]],t[n[0]]-e[n[0]])/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(M(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(M(this.element),this.evWin,this.domHandler)}};var Z={mousedown:1,mousemove:2,mouseup:4},Y="mousedown",Q="mousemove mouseup";function J(){this.evEl=Y,this.evWin=Q,this.pressed=!1,V.apply(this,arguments)}_(J,V,{handler:function(e){var t=Z[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:B,srcEvent:e}))}});var ee={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},te={2:F,3:"pen",4:B,5:"kinect"},ne="pointerdown",re="pointermove pointerup pointercancel";function ie(){this.evEl=ne,this.evWin=re,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(ne="MSPointerDown",re="MSPointerMove MSPointerUp MSPointerCancel"),_(ie,V,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=ee[r],o=te[e.pointerType]||e.pointerType,s=o==F,a=I(t,e.pointerId,"pointerId");1&i&&(0===e.button||s)?a<0&&(t.push(e),a=t.length-1):12&i&&(n=!0),a<0||(t[a]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(a,1))}});var oe={touchstart:1,touchmove:2,touchend:4,touchcancel:8},se="touchstart",ae="touchstart touchmove touchend touchcancel";function ue(){this.evTarget=se,this.evWin=ae,this.started=!1,V.apply(this,arguments)}function ce(e,t){var n=C(e.touches),r=C(e.changedTouches);return 12&t&&(n=D(n.concat(r),"identifier",!0)),[n,r]}_(ue,V,{handler:function(e){var t=oe[e.type];if(1===t&&(this.started=!0),this.started){var n=ce.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:e})}}});var le={touchstart:1,touchmove:2,touchend:4,touchcancel:8},he="touchstart touchmove touchend touchcancel";function de(){this.evTarget=he,this.targetIds={},V.apply(this,arguments)}function fe(e,t){var n=C(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=C(e.changedTouches),a=[],u=this.target;if(o=n.filter(function(e){return k(e.target,u)}),1===t)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&t&&delete r[s[i].identifier],i++;return a.length?[D(o.concat(a),"identifier",!0),a]:void 0}function pe(){V.apply(this,arguments);var e=w(this.handler,this);this.touch=new de(this.manager,e),this.mouse=new J(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ge(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,me.call(this,t)):12&e&&me.call(this,t)}function me(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)},2500)}}function ye(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(t-i.x),s=Math.abs(n-i.y);if(o<=25&&s<=25)return!0}return!1}_(de,V,{handler:function(e){var t=le[e.type],n=fe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:e})}}),_(pe,V,{handler:function(e,t,n){var r=n.pointerType==B;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(n.pointerType==F)ge.call(this,t,n);else if(r&&ye.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ve=j(l.style,"touchAction"),be=ve!==a,_e="compute",we="auto",xe="manipulation",Ee="none",Se="pan-x",Ae="pan-y",ke=function(){if(!be)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||i.CSS.supports("touch-action",n)}),e}();function Te(e,t){this.manager=e,this.set(t)}Te.prototype={set:function(e){e==_e&&(e=this.compute()),be&&this.manager.element.style&&ke[e]&&(this.manager.element.style[ve]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return m(this.manager.recognizers,function(t){x(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(T(e,Ee))return Ee;var t=T(e,Se),n=T(e,Ae);return t&&n?Ee:t||n?t?Se:Ae:T(e,xe)?xe:we}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=T(r,Ee)&&!ke.none,o=T(r,Ae)&&!ke["pan-y"],s=T(r,Se)&&!ke["pan-x"];if(i&&1===e.pointers.length&&e.distance<2&&e.deltaTime<250)return;if(!s||!o)return i||o&&6&n||s&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Oe=32;function Ie(e){this.options=u({},this.defaults,e||{}),this.id=P++,this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Ce(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function De(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function je(e,t){var n=t.manager;return n?n.get(e):e}function Pe(){Ie.apply(this,arguments)}function Me(){Pe.apply(this,arguments),this.pX=null,this.pY=null}function Re(){Pe.apply(this,arguments)}function Ne(){Ie.apply(this,arguments),this._timer=null,this._input=null}function Le(){Pe.apply(this,arguments)}function Fe(){Pe.apply(this,arguments)}function Be(){Ie.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ze(e,t){return(t=t||{}).recognizers=E(t.recognizers,ze.defaults.preset),new Ue(e,t)}function Ue(e,t){this.options=u({},ze.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(N?ie:L?de:R?pe:J))(this,G),this.touchAction=new Te(this,this.options.touchAction),Ve(this,!0),m(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Ve(e,t){var n,r=e.element;r.style&&(m(e.options.cssProps,function(i,o){n=j(r.style,o),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}Ie.prototype={defaults:{},set:function(e){return u(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=je(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=je(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return-1===I(t,e=je(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=je(e,this);var t=I(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+Ce(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+Ce(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Oe},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=u({},e);if(!x(this.options.enable,[this,t]))return this.reset(),void(this.state=Oe);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},_(Pe,Ie,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(8&n||!i)?16|t:r||i?4&n?8|t:2&t?4|t:2:Oe}}),_(Me,Pe,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Ae),24&e&&t.push(Se),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,o=e.deltaX,s=e.deltaY;return i&t.direction||(6&t.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(e.deltaX)):(i=0===s?1:s<0?8:16,n=s!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return Pe.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=De(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),_(Re,Pe,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),this._super.emit.call(this,e)}}),_(Ne,Ie,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[we]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=p(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return Oe},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),_(Le,Pe,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),_(Fe,Pe,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Me.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=De(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),_(Be,Ie,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||X(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&o?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=p(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return Oe},failTimeout:function(){return this._timer=p(function(){this.state=Oe},this.options.interval,this),Oe},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ze.VERSION="2.0.7",ze.defaults={domEvents:!1,touchAction:_e,enable:!0,inputTarget:null,inputClass:null,preset:[[Le,{enable:!1}],[Re,{enable:!1},["rotate"]],[Fe,{direction:6}],[Me,{direction:6},["swipe"]],[Be],[Be,{event:"doubletap",taps:2},["tap"]],[Ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ue.prototype={set:function(e){return u(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Ie)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=I(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var n=this.handlers;return m(O(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==a){var n=this.handlers;return m(O(e),function(e){t?n[e]&&n[e].splice(I(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&Ve(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(ze,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Oe,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ue,Input:V,TouchAction:Te,TouchInput:de,MouseInput:J,PointerEventInput:ie,TouchMouseInput:pe,SingleTouchInput:ue,Recognizer:Ie,AttrRecognizer:Pe,Tap:Be,Pan:Me,Swipe:Fe,Pinch:Re,Rotate:Le,Press:Ne,on:S,off:A,each:m,merge:b,extend:v,assign:u,inherit:_,bindFn:w,prefixed:j}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=ze,(r=(function(){return ze}).call(t,n,t,e))===a||(e.exports=r)}(window,document)},815:function(e,t,n){var r;e=n.nmd(e),(function(){var i,o="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",u=32,c=128,l=1/0,h=9007199254740991,d=NaN,f=4294967295,p=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",u],["partialRight",64],["rearg",256]],g="[object Arguments]",m="[object Array]",y="[object Boolean]",v="[object Date]",b="[object Error]",_="[object Function]",w="[object GeneratorFunction]",x="[object Map]",E="[object Number]",S="[object Object]",A="[object Promise]",k="[object RegExp]",T="[object Set]",O="[object String]",I="[object Symbol]",C="[object WeakMap]",D="[object ArrayBuffer]",j="[object DataView]",P="[object Float32Array]",M="[object Float64Array]",R="[object Int8Array]",N="[object Int16Array]",L="[object Int32Array]",F="[object Uint8Array]",B="[object Uint8ClampedArray]",z="[object Uint16Array]",U="[object Uint32Array]",V=/\b__p \+= '';/g,G=/\b(__p \+=) '' \+/g,H=/(__e\(.*?\)|\b__t\)) \+\n'';/g,q=/&(?:amp|lt|gt|quot|#39);/g,W=/[&<>"']/g,$=RegExp(q.source),X=RegExp(W.source),K=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,Y=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(te.source),re=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,se=/\{\n\/\* \[wrapped with (.+)\] \*/,ae=/,? & /,ue=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ce=/[()=,{}\[\]\/\s]/,le=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,de=/\w*$/,fe=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,me=/^0o[0-7]+$/i,ye=/^(?:0|[1-9]\d*)$/,ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,be=/($^)/,_e=/['\n\r\u2028\u2029\\]/g,we="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",xe="a-z\\xdf-\\xf6\\xf8-\\xff",Ee="A-Z\\xc0-\\xd6\\xd8-\\xde",Se="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ae="["+Se+"]",ke="["+we+"]",Te="\\d+",Oe="["+xe+"]",Ie="[^\\ud800-\\udfff"+Se+Te+"\\u2700-\\u27bf"+xe+Ee+"]",Ce="\\ud83c[\\udffb-\\udfff]",De="[^\\ud800-\\udfff]",je="(?:\\ud83c[\\udde6-\\uddff]){2}",Pe="[\\ud800-\\udbff][\\udc00-\\udfff]",Me="["+Ee+"]",Re="(?:"+Oe+"|"+Ie+")",Ne="(?:"+Me+"|"+Ie+")",Le="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Fe="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Be="(?:"+ke+"|"+Ce+")?",ze="[\\ufe0e\\ufe0f]?",Ue=ze+Be+"(?:\\u200d(?:"+[De,je,Pe].join("|")+")"+ze+Be+")*",Ve="(?:"+["[\\u2700-\\u27bf]",je,Pe].join("|")+")"+Ue,Ge="(?:"+[De+ke+"?",ke,je,Pe,"[\\ud800-\\udfff]"].join("|")+")",He=RegExp("['\u2019]","g"),qe=RegExp(ke,"g"),We=RegExp(Ce+"(?="+Ce+")|"+Ge+Ue,"g"),$e=RegExp([Me+"?"+Oe+"+"+Le+"(?="+[Ae,Me,"$"].join("|")+")",Ne+"+"+Fe+"(?="+[Ae,Me+Re,"$"].join("|")+")",Me+"?"+Re+"+"+Le,Me+"+"+Fe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Te,Ve].join("|"),"g"),Xe=RegExp("[\\u200d\\ud800-\\udfff"+we+"\\ufe0e\\ufe0f]"),Ke=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ze=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ye=-1,Qe={};Qe[P]=Qe[M]=Qe[R]=Qe[N]=Qe[L]=Qe[F]=Qe[B]=Qe[z]=Qe[U]=!0,Qe[g]=Qe[m]=Qe[D]=Qe[y]=Qe[j]=Qe[v]=Qe[b]=Qe[_]=Qe[x]=Qe[E]=Qe[S]=Qe[k]=Qe[T]=Qe[O]=Qe[C]=!1;var Je={};Je[g]=Je[m]=Je[D]=Je[j]=Je[y]=Je[v]=Je[P]=Je[M]=Je[R]=Je[N]=Je[L]=Je[x]=Je[E]=Je[S]=Je[k]=Je[T]=Je[O]=Je[I]=Je[F]=Je[B]=Je[z]=Je[U]=!0,Je[b]=Je[_]=Je[C]=!1;var et={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tt=parseFloat,nt=parseInt,rt="object"==typeof global&&global&&global.Object===Object&&global,it="object"==typeof self&&self&&self.Object===Object&&self,ot=rt||it||Function("return this")(),st=t&&!t.nodeType&&t,at=st&&e&&!e.nodeType&&e,ut=at&&at.exports===st,ct=ut&&rt.process,lt=function(){try{return at&&at.require&&at.require("util").types||ct&&ct.binding&&ct.binding("util")}catch(e){}}(),ht=lt&&lt.isArrayBuffer,dt=lt&&lt.isDate,ft=lt&&lt.isMap,pt=lt&&lt.isRegExp,gt=lt&&lt.isSet,mt=lt&&lt.isTypedArray;function yt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function vt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function bt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function _t(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function wt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function xt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function Et(e,t){return!(null==e||!e.length)&&Pt(e,t,0)>-1}function St(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function At(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function kt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Tt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Ot(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function It(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Ct=Lt("length");function Dt(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function jt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Pt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):jt(e,Rt,n)}function Mt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Rt(e){return e!=e}function Nt(e,t){var n=null==e?0:e.length;return n?zt(e,t)/n:d}function Lt(e){return function(t){return null==t?i:t[e]}}function Ft(e){return function(t){return null==e?i:e[t]}}function Bt(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function zt(e,t){for(var n,r=-1,o=e.length;++r<o;){var s=t(e[r]);s!==i&&(n=n===i?s:n+s)}return n}function Ut(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Vt(e){return e?e.slice(0,an(e)+1).replace(re,""):e}function Gt(e){return function(t){return e(t)}}function Ht(e,t){return At(t,function(t){return e[t]})}function qt(e,t){return e.has(t)}function Wt(e,t){for(var n=-1,r=e.length;++n<r&&Pt(t,e[n],0)>-1;);return n}function $t(e,t){for(var n=e.length;n--&&Pt(t,e[n],0)>-1;);return n}function Xt(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var Kt=Ft({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),Zt=Ft({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Yt(e){return"\\"+et[e]}function Qt(e){return Xe.test(e)}function Jt(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function en(e,t){return function(n){return e(t(n))}}function tn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==a||(e[n]=a,o[i++]=n)}return o}function nn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function rn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function on(e){return Qt(e)?function(e){for(var t=We.lastIndex=0;We.test(e);)++t;return t}(e):Ct(e)}function sn(e){return Qt(e)?function(e){return e.match(We)||[]}(e):function(e){return e.split("")}(e)}function an(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var un=Ft({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),cn=function e(t){var n,r=(t=null==t?ot:cn.defaults(ot.Object(),t,cn.pick(ot,Ze))).Array,ie=t.Date,we=t.Error,xe=t.Function,Ee=t.Math,Se=t.Object,Ae=t.RegExp,ke=t.String,Te=t.TypeError,Oe=r.prototype,Ie=Se.prototype,Ce=t["__core-js_shared__"],De=xe.prototype.toString,je=Ie.hasOwnProperty,Pe=0,Me=(n=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Re=Ie.toString,Ne=De.call(Se),Le=ot._,Fe=Ae("^"+De.call(je).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Be=ut?t.Buffer:i,ze=t.Symbol,Ue=t.Uint8Array,Ve=Be?Be.allocUnsafe:i,Ge=en(Se.getPrototypeOf,Se),We=Se.create,Xe=Ie.propertyIsEnumerable,et=Oe.splice,rt=ze?ze.isConcatSpreadable:i,it=ze?ze.iterator:i,st=ze?ze.toStringTag:i,at=function(){try{var e=uo(Se,"defineProperty");return e({},"",{}),e}catch(t){}}(),ct=t.clearTimeout!==ot.clearTimeout&&t.clearTimeout,lt=ie&&ie.now!==ot.Date.now&&ie.now,Ct=t.setTimeout!==ot.setTimeout&&t.setTimeout,Ft=Ee.ceil,ln=Ee.floor,hn=Se.getOwnPropertySymbols,dn=Be?Be.isBuffer:i,fn=t.isFinite,pn=Oe.join,gn=en(Se.keys,Se),mn=Ee.max,yn=Ee.min,vn=ie.now,bn=t.parseInt,_n=Ee.random,wn=Oe.reverse,xn=uo(t,"DataView"),En=uo(t,"Map"),Sn=uo(t,"Promise"),An=uo(t,"Set"),kn=uo(t,"WeakMap"),Tn=uo(Se,"create"),On=kn&&new kn,In={},Cn=Fo(xn),Dn=Fo(En),jn=Fo(Sn),Pn=Fo(An),Mn=Fo(kn),Rn=ze?ze.prototype:i,Nn=Rn?Rn.valueOf:i,Ln=Rn?Rn.toString:i;function Fn(e){if(ta(e)&&!Hs(e)&&!(e instanceof Vn)){if(e instanceof Un)return e;if(je.call(e,"__wrapped__"))return Bo(e)}return new Un(e)}var Bn=function(){function e(){}return function(t){if(!ea(t))return{};if(We)return We(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function zn(){}function Un(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Vn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new qn;++t<n;)this.add(e[t])}function $n(e){var t=this.__data__=new Hn(e);this.size=t.size}function Xn(e,t){var n=Hs(e),r=!n&&Gs(e),i=!n&&!r&&Xs(e),o=!n&&!r&&!i&&ca(e),s=n||r||i||o,a=s?Ut(e.length,ke):[],u=a.length;for(var c in e)!t&&!je.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||mo(c,u))||a.push(c);return a}function Kn(e){var t=e.length;return t?e[qr(0,t-1)]:i}function Zn(e,t){return Po(ki(e),or(t,0,e.length))}function Yn(e){return Po(ki(e))}function Qn(e,t,n){(n!==i&&!zs(e[t],n)||n===i&&!(t in e))&&rr(e,t,n)}function Jn(e,t,n){var r=e[t];je.call(e,t)&&zs(r,n)&&(n!==i||t in e)||rr(e,t,n)}function er(e,t){for(var n=e.length;n--;)if(zs(e[n][0],t))return n;return-1}function tr(e,t,n,r){return lr(e,function(e,i,o){t(r,e,n(e),o)}),r}function nr(e,t){return e&&Ti(t,Da(t),e)}function rr(e,t,n){"__proto__"==t&&at?at(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ir(e,t){for(var n=-1,o=t.length,s=r(o),a=null==e;++n<o;)s[n]=a?i:ka(e,t[n]);return s}function or(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function sr(e,t,n,r,o,s){var a,u=1&t,c=2&t,l=4&t;if(n&&(a=o?n(e,r,o,s):n(e)),a!==i)return a;if(!ea(e))return e;var h=Hs(e);if(h){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&je.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!u)return ki(e,a)}else{var d=ho(e),f=d==_||d==w;if(Xs(e))return _i(e,u);if(d==S||d==g||f&&!o){if(a=c||f?{}:po(e),!u)return c?function(e,t){return Ti(e,lo(e),t)}(e,function(e,t){return e&&Ti(t,ja(t),e)}(a,e)):function(e,t){return Ti(e,co(e),t)}(e,nr(a,e))}else{if(!Je[d])return o?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case D:return wi(e);case y:case v:return new r(+e);case j:return function(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case P:case M:case R:case N:case L:case F:case B:case z:case U:return xi(e,n);case x:return new r;case E:case O:return new r(e);case k:return function(e){var t=new e.constructor(e.source,de.exec(e));return t.lastIndex=e.lastIndex,t}(e);case T:return new r;case I:return Nn?Se(Nn.call(e)):{}}}(e,d,u)}}s||(s=new $n);var p=s.get(e);if(p)return p;s.set(e,a),sa(e)?e.forEach(function(r){a.add(sr(r,t,n,r,e,s))}):na(e)&&e.forEach(function(r,i){a.set(i,sr(r,t,n,i,e,s))});var m=h?i:(l?c?to:eo:c?ja:Da)(e);return bt(m||e,function(r,i){m&&(r=e[i=r]),Jn(a,i,sr(r,t,n,i,e,s))}),a}function ar(e,t,n){var r=n.length;if(null==e)return!r;for(e=Se(e);r--;){var o=n[r],s=e[o];if(s===i&&!(o in e)||!(0,t[o])(s))return!1}return!0}function ur(e,t,n){if("function"!=typeof e)throw new Te(o);return Io(function(){e.apply(i,n)},t)}function cr(e,t,n,r){var i=-1,o=Et,s=!0,a=e.length,u=[],c=t.length;if(!a)return u;n&&(t=At(t,Gt(n))),r?(o=St,s=!1):t.length>=200&&(o=qt,s=!1,t=new Wn(t));e:for(;++i<a;){var l=e[i],h=null==n?l:n(l);if(l=r||0!==l?l:0,s&&h==h){for(var d=c;d--;)if(t[d]===h)continue e;u.push(l)}else o(t,h,r)||u.push(l)}return u}Fn.templateSettings={escape:K,evaluate:Z,interpolate:Y,variable:"",imports:{_:Fn}},(Fn.prototype=zn.prototype).constructor=Fn,(Un.prototype=Bn(zn.prototype)).constructor=Un,(Vn.prototype=Bn(zn.prototype)).constructor=Vn,Gn.prototype.clear=function(){this.__data__=Tn?Tn(null):{},this.size=0},Gn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Gn.prototype.get=function(e){var t=this.__data__;if(Tn){var n=t[e];return n===s?i:n}return je.call(t,e)?t[e]:i},Gn.prototype.has=function(e){var t=this.__data__;return Tn?t[e]!==i:je.call(t,e)},Gn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Tn&&t===i?s:t,this},Hn.prototype.clear=function(){this.__data__=[],this.size=0},Hn.prototype.delete=function(e){var t=this.__data__,n=er(t,e);return!(n<0||(n==t.length-1?t.pop():et.call(t,n,1),--this.size,0))},Hn.prototype.get=function(e){var t=this.__data__,n=er(t,e);return n<0?i:t[n][1]},Hn.prototype.has=function(e){return er(this.__data__,e)>-1},Hn.prototype.set=function(e,t){var n=this.__data__,r=er(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},qn.prototype.clear=function(){this.size=0,this.__data__={hash:new Gn,map:new(En||Hn),string:new Gn}},qn.prototype.delete=function(e){var t=so(this,e).delete(e);return this.size-=t?1:0,t},qn.prototype.get=function(e){return so(this,e).get(e)},qn.prototype.has=function(e){return so(this,e).has(e)},qn.prototype.set=function(e,t){var n=so(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Wn.prototype.add=Wn.prototype.push=function(e){return this.__data__.set(e,s),this},Wn.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.clear=function(){this.__data__=new Hn,this.size=0},$n.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},$n.prototype.get=function(e){return this.__data__.get(e)},$n.prototype.has=function(e){return this.__data__.has(e)},$n.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Hn){var r=n.__data__;if(!En||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new qn(r)}return n.set(e,t),this.size=n.size,this};var lr=Ci(vr),hr=Ci(br,!0);function dr(e,t){var n=!0;return lr(e,function(e,r,i){return n=!!t(e,r,i)}),n}function fr(e,t,n){for(var r=-1,o=e.length;++r<o;){var s=e[r],a=t(s);if(null!=a&&(u===i?a==a&&!ua(a):n(a,u)))var u=a,c=s}return c}function pr(e,t){var n=[];return lr(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function gr(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=go),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?gr(a,t-1,n,r,i):kt(i,a):r||(i[i.length]=a)}return i}var mr=Di(),yr=Di(!0);function vr(e,t){return e&&mr(e,t,Da)}function br(e,t){return e&&yr(e,t,Da)}function _r(e,t){return xt(t,function(t){return Ys(e[t])})}function wr(e,t){for(var n=0,r=(t=mi(t,e)).length;null!=e&&n<r;)e=e[Lo(t[n++])];return n&&n==r?e:i}function xr(e,t,n){var r=t(e);return Hs(e)?r:kt(r,n(e))}function Er(e){return null==e?e===i?"[object Undefined]":"[object Null]":st&&st in Se(e)?function(e){var t=je.call(e,st),n=e[st];try{e[st]=i;var r=!0}catch(s){}var o=Re.call(e);return r&&(t?e[st]=n:delete e[st]),o}(e):function(e){return Re.call(e)}(e)}function Sr(e,t){return e>t}function Ar(e,t){return null!=e&&je.call(e,t)}function kr(e,t){return null!=e&&t in Se(e)}function Tr(e,t,n){for(var o=n?St:Et,s=e[0].length,a=e.length,u=a,c=r(a),l=1/0,h=[];u--;){var d=e[u];u&&t&&(d=At(d,Gt(t))),l=yn(d.length,l),c[u]=!n&&(t||s>=120&&d.length>=120)?new Wn(u&&d):i}d=e[0];var f=-1,p=c[0];e:for(;++f<s&&h.length<l;){var g=d[f],m=t?t(g):g;if(g=n||0!==g?g:0,!(p?qt(p,m):o(h,m,n))){for(u=a;--u;){var y=c[u];if(!(y?qt(y,m):o(e[u],m,n)))continue e}p&&p.push(m),h.push(g)}}return h}function Or(e,t,n){var r=null==(e=Ao(e,t=mi(t,e)))?e:e[Lo(Zo(t))];return null==r?i:yt(r,e,n)}function Ir(e){return ta(e)&&Er(e)==g}function Cr(e,t,n,r,o){return e===t||(null==e||null==t||!ta(e)&&!ta(t)?e!=e&&t!=t:function(e,t,n,r,o,s){var a=Hs(e),u=Hs(t),c=a?m:ho(e),l=u?m:ho(t),h=(c=c==g?S:c)==S,d=(l=l==g?S:l)==S,f=c==l;if(f&&Xs(e)){if(!Xs(t))return!1;a=!0,h=!1}if(f&&!h)return s||(s=new $n),a||ca(e)?Qi(e,t,n,r,o,s):function(e,t,n,r,i,o,s){switch(n){case j:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case D:return!(e.byteLength!=t.byteLength||!o(new Ue(e),new Ue(t)));case y:case v:case E:return zs(+e,+t);case b:return e.name==t.name&&e.message==t.message;case k:case O:return e==t+"";case x:var a=Jt;case T:if(a||(a=nn),e.size!=t.size&&!(1&r))return!1;var u=s.get(e);if(u)return u==t;r|=2,s.set(e,t);var c=Qi(a(e),a(t),r,i,o,s);return s.delete(e),c;case I:if(Nn)return Nn.call(e)==Nn.call(t)}return!1}(e,t,c,n,r,o,s);if(!(1&n)){var p=h&&je.call(e,"__wrapped__"),_=d&&je.call(t,"__wrapped__");if(p||_){var w=p?e.value():e,A=_?t.value():t;return s||(s=new $n),o(w,A,n,r,s)}}return!!f&&(s||(s=new $n),function(e,t,n,r,o,s){var a=1&n,u=eo(e),c=u.length;if(c!=eo(t).length&&!a)return!1;for(var l=c;l--;){var h=u[l];if(!(a?h in t:je.call(t,h)))return!1}var d=s.get(e),f=s.get(t);if(d&&f)return d==t&&f==e;var p=!0;s.set(e,t),s.set(t,e);for(var g=a;++l<c;){var m=e[h=u[l]],y=t[h];if(r)var v=a?r(y,m,h,t,e,s):r(m,y,h,e,t,s);if(!(v===i?m===y||o(m,y,n,r,s):v)){p=!1;break}g||(g="constructor"==h)}if(p&&!g){var b=e.constructor,_=t.constructor;b==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _||(p=!1)}return s.delete(e),s.delete(t),p}(e,t,n,r,o,s))}(e,t,n,r,Cr,o))}function Dr(e,t,n,r){var o=n.length,s=o,a=!r;if(null==e)return!s;for(e=Se(e);o--;){var u=n[o];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<s;){var c=(u=n[o])[0],l=e[c],h=u[1];if(a&&u[2]){if(l===i&&!(c in e))return!1}else{var d=new $n;if(r)var f=r(l,h,c,e,t,d);if(!(f===i?Cr(h,l,3,r,d):f))return!1}}return!0}function jr(e){return!(!ea(e)||(t=e,Me&&Me in t))&&(Ys(e)?Fe:ge).test(Fo(e));var t}function Pr(e){return"function"==typeof e?e:null==e?ru:"object"==typeof e?Hs(e)?Fr(e[0],e[1]):Lr(e):du(e)}function Mr(e){if(!wo(e))return gn(e);var t=[];for(var n in Se(e))je.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Rr(e,t){return e<t}function Nr(e,t){var n=-1,i=Ws(e)?r(e.length):[];return lr(e,function(e,r,o){i[++n]=t(e,r,o)}),i}function Lr(e){var t=ao(e);return 1==t.length&&t[0][2]?Eo(t[0][0],t[0][1]):function(n){return n===e||Dr(n,e,t)}}function Fr(e,t){return vo(e)&&xo(t)?Eo(Lo(e),t):function(n){var r=ka(n,e);return r===i&&r===t?Ta(n,e):Cr(t,r,3)}}function Br(e,t,n,r,o){e!==t&&mr(t,function(s,a){if(o||(o=new $n),ea(s))!function(e,t,n,r,o,s,a){var u=To(e,n),c=To(t,n),l=a.get(c);if(l)Qn(e,n,l);else{var h=s?s(u,c,n+"",e,t,a):i,d=h===i;if(d){var f=Hs(c),p=!f&&Xs(c),g=!f&&!p&&ca(c);h=c,f||p||g?Hs(u)?h=u:$s(u)?h=ki(u):p?(d=!1,h=_i(c,!0)):g?(d=!1,h=xi(c,!0)):h=[]:ia(c)||Gs(c)?(h=u,Gs(u)?h=ya(u):ea(u)&&!Ys(u)||(h=po(c))):d=!1}d&&(a.set(c,h),o(h,c,r,s,a),a.delete(c)),Qn(e,n,h)}}(e,t,a,n,Br,r,o);else{var u=r?r(To(e,a),s,a+"",e,t,o):i;u===i&&(u=s),Qn(e,a,u)}},ja)}function zr(e,t){var n=e.length;if(n)return mo(t+=t<0?n:0,n)?e[t]:i}function Ur(e,t,n){t=t.length?At(t,function(e){return Hs(e)?function(t){return wr(t,1===e.length?e[0]:e)}:e}):[ru];var r=-1;return t=At(t,Gt(oo())),function(e,t){var r=e.length;for(e.sort(function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var u=Ei(i[r],o[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)});r--;)e[r]=e[r].value;return e}(Nr(e,function(e,n,i){return{criteria:At(t,function(t){return t(e)}),index:++r,value:e}}))}function Vr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=wr(e,s);n(a,s)&&Zr(o,mi(s,e),a)}return o}function Gr(e,t,n,r){var i=r?Mt:Pt,o=-1,s=t.length,a=e;for(e===t&&(t=ki(t)),n&&(a=At(e,Gt(n)));++o<s;)for(var u=0,c=t[o],l=n?n(c):c;(u=i(a,l,u,r))>-1;)a!==e&&et.call(a,u,1),et.call(e,u,1);return e}function Hr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;mo(i)?et.call(e,i,1):ui(e,i)}}return e}function qr(e,t){return e+ln(_n()*(t-e+1))}function Wr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=ln(t/2))&&(e+=e)}while(t);return n}function $r(e,t){return Co(So(e,t,ru),e+"")}function Xr(e){return Kn(za(e))}function Kr(e,t){var n=za(e);return Po(n,or(t,0,n.length))}function Zr(e,t,n,r){if(!ea(e))return e;for(var o=-1,s=(t=mi(t,e)).length,a=s-1,u=e;null!=u&&++o<s;){var c=Lo(t[o]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var h=u[c];(l=r?r(h,c,u):i)===i&&(l=ea(h)?h:mo(t[o+1])?[]:{})}Jn(u,c,l),u=u[c]}return e}var Yr=On?function(e,t){return On.set(e,t),e}:ru,Qr=at?function(e,t){return at(e,"toString",{configurable:!0,enumerable:!1,value:eu(t),writable:!0})}:ru;function Jr(e){return Po(za(e))}function ei(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var s=r(o);++i<o;)s[i]=e[i+t];return s}function ti(e,t){var n;return lr(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function ni(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!ua(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return ri(e,t,ru,n)}function ri(e,t,n,r){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=n(t))!=t,u=null===t,c=ua(t),l=t===i;o<s;){var h=ln((o+s)/2),d=n(e[h]),f=d!==i,p=null===d,g=d==d,m=ua(d);if(a)var y=r||g;else y=l?g&&(r||f):u?g&&f&&(r||!p):c?g&&f&&!p&&(r||!m):!p&&!m&&(r?d<=t:d<t);y?o=h+1:s=h}return yn(s,4294967294)}function ii(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!zs(a,u)){var u=a;o[i++]=0===s?0:s}}return o}function oi(e){return"number"==typeof e?e:ua(e)?d:+e}function si(e){if("string"==typeof e)return e;if(Hs(e))return At(e,si)+"";if(ua(e))return Ln?Ln.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ai(e,t,n){var r=-1,i=Et,o=e.length,s=!0,a=[],u=a;if(n)s=!1,i=St;else if(o>=200){var c=t?null:Wi(e);if(c)return nn(c);s=!1,i=qt,u=new Wn}else u=t?[]:a;e:for(;++r<o;){var l=e[r],h=t?t(l):l;if(l=n||0!==l?l:0,s&&h==h){for(var d=u.length;d--;)if(u[d]===h)continue e;t&&u.push(h),a.push(l)}else i(u,h,n)||(u!==a&&u.push(h),a.push(l))}return a}function ui(e,t){return null==(e=Ao(e,t=mi(t,e)))||delete e[Lo(Zo(t))]}function ci(e,t,n,r){return Zr(e,t,n(wr(e,t)),r)}function li(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ei(e,r?0:o,r?o+1:i):ei(e,r?o+1:0,r?i:o)}function hi(e,t){var n=e;return n instanceof Vn&&(n=n.value()),Tt(t,function(e,t){return t.func.apply(t.thisArg,kt([e],t.args))},n)}function di(e,t,n){var i=e.length;if(i<2)return i?ai(e[0]):[];for(var o=-1,s=r(i);++o<i;)for(var a=e[o],u=-1;++u<i;)u!=o&&(s[o]=cr(s[o]||a,e[u],t,n));return ai(gr(s,1),t,n)}function fi(e,t,n){for(var r=-1,o=e.length,s=t.length,a={};++r<o;)n(a,e[r],r<s?t[r]:i);return a}function pi(e){return $s(e)?e:[]}function gi(e){return"function"==typeof e?e:ru}function mi(e,t){return Hs(e)?e:vo(e,t)?[e]:No(va(e))}var yi=$r;function vi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ei(e,t,n)}var bi=ct||function(e){return ot.clearTimeout(e)};function _i(e,t){if(t)return e.slice();var n=e.length,r=Ve?Ve(n):new e.constructor(n);return e.copy(r),r}function wi(e){var t=new e.constructor(e.byteLength);return new Ue(t).set(new Ue(e)),t}function xi(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ei(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,s=ua(e),a=t!==i,u=null===t,c=t==t,l=ua(t);if(!u&&!l&&!s&&e>t||s&&a&&c&&!u&&!l||r&&a&&c||!n&&c||!o)return 1;if(!r&&!s&&!l&&e<t||l&&n&&o&&!r&&!s||u&&n&&o||!a&&o||!c)return-1}return 0}function Si(e,t,n,i){for(var o=-1,s=e.length,a=n.length,u=-1,c=t.length,l=mn(s-a,0),h=r(c+l),d=!i;++u<c;)h[u]=t[u];for(;++o<a;)(d||o<s)&&(h[n[o]]=e[o]);for(;l--;)h[u++]=e[o++];return h}function Ai(e,t,n,i){for(var o=-1,s=e.length,a=-1,u=n.length,c=-1,l=t.length,h=mn(s-u,0),d=r(h+l),f=!i;++o<h;)d[o]=e[o];for(var p=o;++c<l;)d[p+c]=t[c];for(;++a<u;)(f||o<s)&&(d[p+n[a]]=e[o++]);return d}function ki(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Ti(e,t,n,r){var o=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var u=t[s],c=r?r(n[u],e[u],u,n,e):i;c===i&&(c=e[u]),o?rr(n,u,c):Jn(n,u,c)}return n}function Oi(e,t){return function(n,r){var i=Hs(n)?vt:tr,o=t?t():{};return i(n,e,oo(r,2),o)}}function Ii(e){return $r(function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:i,a=o>2?n[2]:i;for(s=e.length>3&&"function"==typeof s?(o--,s):i,a&&yo(n[0],n[1],a)&&(s=o<3?i:s,o=1),t=Se(t);++r<o;){var u=n[r];u&&e(t,u,r,s)}return t})}function Ci(e,t){return function(n,r){if(null==n)return n;if(!Ws(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Se(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Di(e){return function(t,n,r){for(var i=-1,o=Se(t),s=r(t),a=s.length;a--;){var u=s[e?a:++i];if(!1===n(o[u],u,o))break}return t}}function ji(e){return function(t){var n=Qt(t=va(t))?sn(t):i,r=n?n[0]:t.charAt(0),o=n?vi(n,1).join(""):t.slice(1);return r[e]()+o}}function Pi(e){return function(t){return Tt(Ya(Ga(t).replace(He,"")),e,"")}}function Mi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Bn(e.prototype),r=e.apply(n,t);return ea(r)?r:n}}function Ri(e){return function(t,n,r){var o=Se(t);if(!Ws(t)){var s=oo(n,3);t=Da(t),n=function(e){return s(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[s?t[a]:a]:i}}function Ni(e){return Ji(function(t){var n=t.length,r=n,s=Un.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Te(o);if(s&&!u&&"wrapper"==ro(a))var u=new Un([],!0)}for(r=u?r:n;++r<n;){var c=ro(a=t[r]),l="wrapper"==c?no(a):i;u=l&&bo(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[ro(l[0])].apply(u,l[3]):1==a.length&&bo(a)?u[c]():u.thru(a)}return function(){var e=arguments,r=e[0];if(u&&1==e.length&&Hs(r))return u.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}})}function Li(e,t,n,o,s,a,u,l,h,d){var f=t&c,p=1&t,g=2&t,m=24&t,y=512&t,v=g?i:Mi(e);return function i(){for(var c=arguments.length,b=r(c),_=c;_--;)b[_]=arguments[_];if(m)var w=io(i),x=Xt(b,w);if(o&&(b=Si(b,o,s,m)),a&&(b=Ai(b,a,u,m)),c-=x,m&&c<d){var E=tn(b,w);return Hi(e,t,Li,i.placeholder,n,b,E,l,h,d-c)}var S=p?n:this,A=g?S[e]:e;return c=b.length,l?b=ko(b,l):y&&c>1&&b.reverse(),f&&h<c&&(b.length=h),this&&this!==ot&&this instanceof i&&(A=v||Mi(A)),A.apply(S,b)}}function Fi(e,t){return function(n,r){return function(e,t,n,r){return vr(e,function(e,i,o){t(r,n(e),i,o)}),r}(n,e,t(r),{})}}function Bi(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=si(n),r=si(r)):(n=oi(n),r=oi(r)),o=e(n,r)}return o}}function zi(e){return Ji(function(t){return t=At(t,Gt(oo())),$r(function(n){var r=this;return e(t,function(e){return yt(e,r,n)})})})}function Ui(e,t){var n=(t=t===i?" ":si(t)).length;if(n<2)return n?Wr(t,e):t;var r=Wr(t,Ft(e/on(t)));return Qt(t)?vi(sn(r),0,e).join(""):r.slice(0,e)}function Vi(e){return function(t,n,o){return o&&"number"!=typeof o&&yo(t,n,o)&&(n=o=i),t=fa(t),n===i?(n=t,t=0):n=fa(n),function(e,t,n,i){for(var o=-1,s=mn(Ft((t-e)/(n||1)),0),a=r(s);s--;)a[i?s:++o]=e,e+=n;return a}(t,n,o=o===i?t<n?1:-1:fa(o),e)}}function Gi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ma(t),n=ma(n)),e(t,n)}}function Hi(e,t,n,r,o,s,a,c,l,h){var d=8&t;t|=d?u:64,4&(t&=~(d?64:u))||(t&=-4);var f=[e,t,o,d?s:i,d?a:i,d?i:s,d?i:a,c,l,h],p=n.apply(i,f);return bo(e)&&Oo(p,f),p.placeholder=r,Do(p,e,t)}function qi(e){var t=Ee[e];return function(e,n){if(e=ma(e),(n=null==n?0:yn(pa(n),292))&&fn(e)){var r=(va(e)+"e").split("e");return+((r=(va(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Wi=An&&1/nn(new An([,-0]))[1]==l?function(e){return new An(e)}:uu;function $i(e){return function(t){var n=ho(t);return n==x?Jt(t):n==T?rn(t):function(e,t){return At(t,function(t){return[t,e[t]]})}(t,e(t))}}function Xi(e,t,n,s,l,h,d,f){var p=2&t;if(!p&&"function"!=typeof e)throw new Te(o);var g=s?s.length:0;if(g||(t&=-97,s=l=i),d=d===i?d:mn(pa(d),0),f=f===i?f:pa(f),g-=l?l.length:0,64&t){var m=s,y=l;s=l=i}var v=p?i:no(e),b=[e,t,n,s,l,m,y,h,d,f];if(v&&function(e,t){var n=e[1],r=t[1],i=n|r;if(!(i<131||r==c&&8==n||r==c&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n))return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var o=t[3];if(o){var s=e[3];e[3]=s?Si(s,o,t[4]):o,e[4]=s?tn(e[3],a):t[4]}(o=t[5])&&(e[5]=(s=e[5])?Ai(s,o,t[6]):o,e[6]=s?tn(e[5],a):t[6]),(o=t[7])&&(e[7]=o),r&c&&(e[8]=null==e[8]?t[8]:yn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(b,v),e=b[0],t=b[1],n=b[2],s=b[3],l=b[4],!(f=b[9]=b[9]===i?p?0:e.length:mn(b[9]-g,0))&&24&t&&(t&=-25),t&&1!=t)_=8==t||16==t?function(e,t,n){var o=Mi(e);return function s(){for(var a=arguments.length,u=r(a),c=a,l=io(s);c--;)u[c]=arguments[c];var h=a<3&&u[0]!==l&&u[a-1]!==l?[]:tn(u,l);return(a-=h.length)<n?Hi(e,t,Li,s.placeholder,i,u,h,i,i,n-a):yt(this&&this!==ot&&this instanceof s?o:e,this,u)}}(e,t,f):t!=u&&33!=t||l.length?Li.apply(i,b):function(e,t,n,i){var o=1&t,s=Mi(e);return function t(){for(var a=-1,u=arguments.length,c=-1,l=i.length,h=r(l+u),d=this&&this!==ot&&this instanceof t?s:e;++c<l;)h[c]=i[c];for(;u--;)h[c++]=arguments[++a];return yt(d,o?n:this,h)}}(e,t,n,s);else var _=function(e,t,n){var r=1&t,i=Mi(e);return function t(){return(this&&this!==ot&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Do((v?Yr:Oo)(_,b),e,t)}function Ki(e,t,n,r){return e===i||zs(e,Ie[n])&&!je.call(r,n)?t:e}function Zi(e,t,n,r,o,s){return ea(e)&&ea(t)&&(s.set(t,e),Br(e,t,i,Zi,s),s.delete(t)),e}function Yi(e){return ia(e)?i:e}function Qi(e,t,n,r,o,s){var a=1&n,u=e.length,c=t.length;if(u!=c&&!(a&&c>u))return!1;var l=s.get(e),h=s.get(t);if(l&&h)return l==t&&h==e;var d=-1,f=!0,p=2&n?new Wn:i;for(s.set(e,t),s.set(t,e);++d<u;){var g=e[d],m=t[d];if(r)var y=a?r(m,g,d,t,e,s):r(g,m,d,e,t,s);if(y!==i){if(y)continue;f=!1;break}if(p){if(!It(t,function(e,t){if(!qt(p,t)&&(g===e||o(g,e,n,r,s)))return p.push(t)})){f=!1;break}}else if(g!==m&&!o(g,m,n,r,s)){f=!1;break}}return s.delete(e),s.delete(t),f}function Ji(e){return Co(So(e,i,qo),e+"")}function eo(e){return xr(e,Da,co)}function to(e){return xr(e,ja,lo)}var no=On?function(e){return On.get(e)}:uu;function ro(e){for(var t=e.name+"",n=In[t],r=je.call(In,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function io(e){return(je.call(Fn,"placeholder")?Fn:e).placeholder}function oo(){var e=Fn.iteratee||iu;return e=e===iu?Pr:e,arguments.length?e(arguments[0],arguments[1]):e}function so(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ao(e){for(var t=Da(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,xo(i)]}return t}function uo(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return jr(n)?n:i}var co=hn?function(e){return null==e?[]:(e=Se(e),xt(hn(e),function(t){return Xe.call(e,t)}))}:gu,lo=hn?function(e){for(var t=[];e;)kt(t,co(e)),e=Ge(e);return t}:gu,ho=Er;function fo(e,t,n){for(var r=-1,i=(t=mi(t,e)).length,o=!1;++r<i;){var s=Lo(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Js(i)&&mo(s,i)&&(Hs(e)||Gs(e))}function po(e){return"function"!=typeof e.constructor||wo(e)?{}:Bn(Ge(e))}function go(e){return Hs(e)||Gs(e)||!!(rt&&e&&e[rt])}function mo(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&ye.test(e))&&e>-1&&e%1==0&&e<t}function yo(e,t,n){if(!ea(n))return!1;var r=typeof t;return!!("number"==r?Ws(n)&&mo(t,n.length):"string"==r&&t in n)&&zs(n[t],e)}function vo(e,t){if(Hs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ua(e))||J.test(e)||!Q.test(e)||null!=t&&e in Se(t)}function bo(e){var t=ro(e),n=Fn[t];if("function"!=typeof n||!(t in Vn.prototype))return!1;if(e===n)return!0;var r=no(n);return!!r&&e===r[0]}(xn&&ho(new xn(new ArrayBuffer(1)))!=j||En&&ho(new En)!=x||Sn&&ho(Sn.resolve())!=A||An&&ho(new An)!=T||kn&&ho(new kn)!=C)&&(ho=function(e){var t=Er(e),n=t==S?e.constructor:i,r=n?Fo(n):"";if(r)switch(r){case Cn:return j;case Dn:return x;case jn:return A;case Pn:return T;case Mn:return C}return t});var _o=Ce?Ys:mu;function wo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ie)}function xo(e){return e==e&&!ea(e)}function Eo(e,t){return function(n){return null!=n&&n[e]===t&&(t!==i||e in Se(n))}}function So(e,t,n){return t=mn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=mn(i.length-t,0),a=r(s);++o<s;)a[o]=i[t+o];o=-1;for(var u=r(t+1);++o<t;)u[o]=i[o];return u[t]=n(a),yt(e,this,u)}}function Ao(e,t){return t.length<2?e:wr(e,ei(t,0,-1))}function ko(e,t){for(var n=e.length,r=yn(t.length,n),o=ki(e);r--;){var s=t[r];e[r]=mo(s,n)?o[s]:i}return e}function To(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Oo=jo(Yr),Io=Ct||function(e,t){return ot.setTimeout(e,t)},Co=jo(Qr);function Do(e,t,n){var r=t+"";return Co(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return bt(p,function(n){var r="_."+n[0];t&n[1]&&!Et(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(se);return t?t[1].split(ae):[]}(r),n)))}function jo(e){var t=0,n=0;return function(){var r=vn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Po(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var s=qr(n,o),a=e[s];e[s]=e[n],e[n]=a}return e.length=t,e}var Mo,Ro,No=(Mo=Ms(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,function(e,n,r,i){t.push(r?i.replace(le,"$1"):n||e)}),t},function(e){return 500===Ro.size&&Ro.clear(),e}),Ro=Mo.cache,Mo);function Lo(e){if("string"==typeof e||ua(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Fo(e){if(null!=e){try{return De.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Bo(e){if(e instanceof Vn)return e.clone();var t=new Un(e.__wrapped__,e.__chain__);return t.__actions__=ki(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var zo=$r(function(e,t){return $s(e)?cr(e,gr(t,1,$s,!0)):[]}),Uo=$r(function(e,t){var n=Zo(t);return $s(n)&&(n=i),$s(e)?cr(e,gr(t,1,$s,!0),oo(n,2)):[]}),Vo=$r(function(e,t){var n=Zo(t);return $s(n)&&(n=i),$s(e)?cr(e,gr(t,1,$s,!0),i,n):[]});function Go(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=mn(r+i,0)),jt(e,oo(t,3),i)}function Ho(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=pa(n),o=n<0?mn(r+o,0):yn(o,r-1)),jt(e,oo(t,3),o,!0)}function qo(e){return null!=e&&e.length?gr(e,1):[]}function Wo(e){return e&&e.length?e[0]:i}var $o=$r(function(e){var t=At(e,pi);return t.length&&t[0]===e[0]?Tr(t):[]}),Xo=$r(function(e){var t=Zo(e),n=At(e,pi);return t===Zo(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Tr(n,oo(t,2)):[]}),Ko=$r(function(e){var t=Zo(e),n=At(e,pi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Tr(n,i,t):[]});function Zo(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Yo=$r(Qo);function Qo(e,t){return e&&e.length&&t&&t.length?Gr(e,t):e}var Jo=Ji(function(e,t){var n=null==e?0:e.length,r=ir(e,t);return Hr(e,At(t,function(e){return mo(e,n)?+e:e}).sort(Ei)),r});function es(e){return null==e?e:wn.call(e)}var ts=$r(function(e){return ai(gr(e,1,$s,!0))}),ns=$r(function(e){var t=Zo(e);return $s(t)&&(t=i),ai(gr(e,1,$s,!0),oo(t,2))}),rs=$r(function(e){var t=Zo(e);return t="function"==typeof t?t:i,ai(gr(e,1,$s,!0),i,t)});function is(e){if(!e||!e.length)return[];var t=0;return e=xt(e,function(e){if($s(e))return t=mn(e.length,t),!0}),Ut(t,function(t){return At(e,Lt(t))})}function os(e,t){if(!e||!e.length)return[];var n=is(e);return null==t?n:At(n,function(e){return yt(t,i,e)})}var ss=$r(function(e,t){return $s(e)?cr(e,t):[]}),as=$r(function(e){return di(xt(e,$s))}),us=$r(function(e){var t=Zo(e);return $s(t)&&(t=i),di(xt(e,$s),oo(t,2))}),cs=$r(function(e){var t=Zo(e);return t="function"==typeof t?t:i,di(xt(e,$s),i,t)}),ls=$r(is),hs=$r(function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,os(e,n)});function ds(e){var t=Fn(e);return t.__chain__=!0,t}function fs(e,t){return t(e)}var ps=Ji(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ir(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Vn&&mo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:fs,args:[o],thisArg:i}),new Un(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(i),e})):this.thru(o)}),gs=Oi(function(e,t,n){je.call(e,n)?++e[n]:rr(e,n,1)}),ms=Ri(Go),ys=Ri(Ho);function vs(e,t){return(Hs(e)?bt:lr)(e,oo(t,3))}function bs(e,t){return(Hs(e)?_t:hr)(e,oo(t,3))}var _s=Oi(function(e,t,n){je.call(e,n)?e[n].push(t):rr(e,n,[t])}),ws=$r(function(e,t,n){var i=-1,o="function"==typeof t,s=Ws(e)?r(e.length):[];return lr(e,function(e){s[++i]=o?yt(t,e,n):Or(e,t,n)}),s}),xs=Oi(function(e,t,n){rr(e,n,t)});function Es(e,t){return(Hs(e)?At:Nr)(e,oo(t,3))}var Ss=Oi(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),As=$r(function(e,t){if(null==e)return[];var n=t.length;return n>1&&yo(e,t[0],t[1])?t=[]:n>2&&yo(t[0],t[1],t[2])&&(t=[t[0]]),Ur(e,gr(t,1),[])}),ks=lt||function(){return ot.Date.now()};function Ts(e,t,n){return t=n?i:t,Xi(e,c,i,i,i,i,t=e&&null==t?e.length:t)}function Os(e,t){var n;if("function"!=typeof t)throw new Te(o);return e=pa(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Is=$r(function(e,t,n){var r=1;if(n.length){var i=tn(n,io(Is));r|=u}return Xi(e,r,t,n,i)}),Cs=$r(function(e,t,n){var r=3;if(n.length){var i=tn(n,io(Cs));r|=u}return Xi(t,r,e,n,i)});function Ds(e,t,n){var r,s,a,u,c,l,h=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new Te(o);function g(t){var n=r,o=s;return r=s=i,h=t,u=e.apply(o,n)}function m(e){return h=e,c=Io(v,t),d?g(e):u}function y(e){var n=e-l;return l===i||n>=t||n<0||f&&e-h>=a}function v(){var e=ks();if(y(e))return b(e);c=Io(v,function(e){var n=t-(e-l);return f?yn(n,a-(e-h)):n}(e))}function b(e){return c=i,p&&r?g(e):(r=s=i,u)}function _(){var e=ks(),n=y(e);if(r=arguments,s=this,l=e,n){if(c===i)return m(l);if(f)return bi(c),c=Io(v,t),g(l)}return c===i&&(c=Io(v,t)),u}return t=ma(t)||0,ea(n)&&(d=!!n.leading,a=(f="maxWait"in n)?mn(ma(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),_.cancel=function(){c!==i&&bi(c),h=0,r=l=s=c=i},_.flush=function(){return c===i?u:b(ks())},_}var js=$r(function(e,t){return ur(e,1,t)}),Ps=$r(function(e,t,n){return ur(e,ma(t)||0,n)});function Ms(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Te(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Ms.Cache||qn),n}function Rs(e){if("function"!=typeof e)throw new Te(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ms.Cache=qn;var Ns=yi(function(e,t){var n=(t=1==t.length&&Hs(t[0])?At(t[0],Gt(oo())):At(gr(t,1),Gt(oo()))).length;return $r(function(r){for(var i=-1,o=yn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return yt(e,this,r)})}),Ls=$r(function(e,t){var n=tn(t,io(Ls));return Xi(e,u,i,t,n)}),Fs=$r(function(e,t){var n=tn(t,io(Fs));return Xi(e,64,i,t,n)}),Bs=Ji(function(e,t){return Xi(e,256,i,i,i,t)});function zs(e,t){return e===t||e!=e&&t!=t}var Us=Gi(Sr),Vs=Gi(function(e,t){return e>=t}),Gs=Ir(function(){return arguments}())?Ir:function(e){return ta(e)&&je.call(e,"callee")&&!Xe.call(e,"callee")},Hs=r.isArray,qs=ht?Gt(ht):function(e){return ta(e)&&Er(e)==D};function Ws(e){return null!=e&&Js(e.length)&&!Ys(e)}function $s(e){return ta(e)&&Ws(e)}var Xs=dn||mu,Ks=dt?Gt(dt):function(e){return ta(e)&&Er(e)==v};function Zs(e){if(!ta(e))return!1;var t=Er(e);return t==b||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ia(e)}function Ys(e){if(!ea(e))return!1;var t=Er(e);return t==_||t==w||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Qs(e){return"number"==typeof e&&e==pa(e)}function Js(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function ea(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ta(e){return null!=e&&"object"==typeof e}var na=ft?Gt(ft):function(e){return ta(e)&&ho(e)==x};function ra(e){return"number"==typeof e||ta(e)&&Er(e)==E}function ia(e){if(!ta(e)||Er(e)!=S)return!1;var t=Ge(e);if(null===t)return!0;var n=je.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&De.call(n)==Ne}var oa=pt?Gt(pt):function(e){return ta(e)&&Er(e)==k},sa=gt?Gt(gt):function(e){return ta(e)&&ho(e)==T};function aa(e){return"string"==typeof e||!Hs(e)&&ta(e)&&Er(e)==O}function ua(e){return"symbol"==typeof e||ta(e)&&Er(e)==I}var ca=mt?Gt(mt):function(e){return ta(e)&&Js(e.length)&&!!Qe[Er(e)]},la=Gi(Rr),ha=Gi(function(e,t){return e<=t});function da(e){if(!e)return[];if(Ws(e))return aa(e)?sn(e):ki(e);if(it&&e[it])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[it]());var t=ho(e);return(t==x?Jt:t==T?nn:za)(e)}function fa(e){return e?(e=ma(e))===l||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function pa(e){var t=fa(e),n=t%1;return t==t?n?t-n:t:0}function ga(e){return e?or(pa(e),0,f):0}function ma(e){if("number"==typeof e)return e;if(ua(e))return d;if(ea(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ea(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Vt(e);var n=pe.test(e);return n||me.test(e)?nt(e.slice(2),n?2:8):fe.test(e)?d:+e}function ya(e){return Ti(e,ja(e))}function va(e){return null==e?"":si(e)}var ba=Ii(function(e,t){if(wo(t)||Ws(t))Ti(t,Da(t),e);else for(var n in t)je.call(t,n)&&Jn(e,n,t[n])}),_a=Ii(function(e,t){Ti(t,ja(t),e)}),wa=Ii(function(e,t,n,r){Ti(t,ja(t),e,r)}),xa=Ii(function(e,t,n,r){Ti(t,Da(t),e,r)}),Ea=Ji(ir),Sa=$r(function(e,t){e=Se(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&yo(t[0],t[1],o)&&(r=1);++n<r;)for(var s=t[n],a=ja(s),u=-1,c=a.length;++u<c;){var l=a[u],h=e[l];(h===i||zs(h,Ie[l])&&!je.call(e,l))&&(e[l]=s[l])}return e}),Aa=$r(function(e){return e.push(i,Zi),yt(Ma,i,e)});function ka(e,t,n){var r=null==e?i:wr(e,t);return r===i?n:r}function Ta(e,t){return null!=e&&fo(e,t,kr)}var Oa=Fi(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Re.call(t)),e[t]=n},eu(ru)),Ia=Fi(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Re.call(t)),je.call(e,t)?e[t].push(n):e[t]=[n]},oo),Ca=$r(Or);function Da(e){return Ws(e)?Xn(e):Mr(e)}function ja(e){return Ws(e)?Xn(e,!0):function(e){if(!ea(e))return function(e){var t=[];if(null!=e)for(var n in Se(e))t.push(n);return t}(e);var t=wo(e),n=[];for(var r in e)("constructor"!=r||!t&&je.call(e,r))&&n.push(r);return n}(e)}var Pa=Ii(function(e,t,n){Br(e,t,n)}),Ma=Ii(function(e,t,n,r){Br(e,t,n,r)}),Ra=Ji(function(e,t){var n={};if(null==e)return n;var r=!1;t=At(t,function(t){return t=mi(t,e),r||(r=t.length>1),t}),Ti(e,to(e),n),r&&(n=sr(n,7,Yi));for(var i=t.length;i--;)ui(n,t[i]);return n}),Na=Ji(function(e,t){return null==e?{}:function(e,t){return Vr(e,t,function(t,n){return Ta(e,n)})}(e,t)});function La(e,t){if(null==e)return{};var n=At(to(e),function(e){return[e]});return t=oo(t),Vr(e,n,function(e,n){return t(e,n[0])})}var Fa=$i(Da),Ba=$i(ja);function za(e){return null==e?[]:Ht(e,Da(e))}var Ua=Pi(function(e,t,n){return t=t.toLowerCase(),e+(n?Va(t):t)});function Va(e){return Za(va(e).toLowerCase())}function Ga(e){return(e=va(e))&&e.replace(ve,Kt).replace(qe,"")}var Ha=Pi(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),qa=Pi(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Wa=ji("toLowerCase"),$a=Pi(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Xa=Pi(function(e,t,n){return e+(n?" ":"")+Za(t)}),Ka=Pi(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Za=ji("toUpperCase");function Ya(e,t,n){return e=va(e),(t=n?i:t)===i?function(e){return Ke.test(e)}(e)?function(e){return e.match($e)||[]}(e):function(e){return e.match(ue)||[]}(e):e.match(t)||[]}var Qa=$r(function(e,t){try{return yt(e,i,t)}catch(n){return Zs(n)?n:new we(n)}}),Ja=Ji(function(e,t){return bt(t,function(t){t=Lo(t),rr(e,t,Is(e[t],e))}),e});function eu(e){return function(){return e}}var tu=Ni(),nu=Ni(!0);function ru(e){return e}function iu(e){return Pr("function"==typeof e?e:sr(e,1))}var ou=$r(function(e,t){return function(n){return Or(n,e,t)}}),su=$r(function(e,t){return function(n){return Or(e,n,t)}});function au(e,t,n){var r=Da(t),i=_r(t,r);null!=n||ea(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=_r(t,Da(t)));var o=!(ea(n)&&"chain"in n&&!n.chain),s=Ys(e);return bt(i,function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__),i=n.__actions__=ki(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,kt([this.value()],arguments))})}),e}function uu(){}var cu=zi(At),lu=zi(wt),hu=zi(It);function du(e){return vo(e)?Lt(Lo(e)):function(e){return function(t){return wr(t,e)}}(e)}var fu=Vi(),pu=Vi(!0);function gu(){return[]}function mu(){return!1}var yu,vu=Bi(function(e,t){return e+t},0),bu=qi("ceil"),_u=Bi(function(e,t){return e/t},1),wu=qi("floor"),xu=Bi(function(e,t){return e*t},1),Eu=qi("round"),Su=Bi(function(e,t){return e-t},0);return Fn.after=function(e,t){if("function"!=typeof t)throw new Te(o);return e=pa(e),function(){if(--e<1)return t.apply(this,arguments)}},Fn.ary=Ts,Fn.assign=ba,Fn.assignIn=_a,Fn.assignInWith=wa,Fn.assignWith=xa,Fn.at=Ea,Fn.before=Os,Fn.bind=Is,Fn.bindAll=Ja,Fn.bindKey=Cs,Fn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Hs(e)?e:[e]},Fn.chain=ds,Fn.chunk=function(e,t,n){t=(n?yo(e,t,n):t===i)?1:mn(pa(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var s=0,a=0,u=r(Ft(o/t));s<o;)u[a++]=ei(e,s,s+=t);return u},Fn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Fn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return kt(Hs(n)?ki(n):[n],gr(t,1))},Fn.cond=function(e){var t=null==e?0:e.length,n=oo();return e=t?At(e,function(e){if("function"!=typeof e[1])throw new Te(o);return[n(e[0]),e[1]]}):[],$r(function(n){for(var r=-1;++r<t;){var i=e[r];if(yt(i[0],this,n))return yt(i[1],this,n)}})},Fn.conforms=function(e){return function(e){var t=Da(e);return function(n){return ar(n,e,t)}}(sr(e,1))},Fn.constant=eu,Fn.countBy=gs,Fn.create=function(e,t){var n=Bn(e);return null==t?n:nr(n,t)},Fn.curry=function e(t,n,r){var o=Xi(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Fn.curryRight=function e(t,n,r){var o=Xi(t,16,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Fn.debounce=Ds,Fn.defaults=Sa,Fn.defaultsDeep=Aa,Fn.defer=js,Fn.delay=Ps,Fn.difference=zo,Fn.differenceBy=Uo,Fn.differenceWith=Vo,Fn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=n||t===i?1:pa(t))<0?0:t,r):[]},Fn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,0,(t=r-(t=n||t===i?1:pa(t)))<0?0:t):[]},Fn.dropRightWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!0,!0):[]},Fn.dropWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!0):[]},Fn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&yo(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=pa(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:pa(r))<0&&(r+=o),r=n>r?0:ga(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Fn.filter=function(e,t){return(Hs(e)?xt:pr)(e,oo(t,3))},Fn.flatMap=function(e,t){return gr(Es(e,t),1)},Fn.flatMapDeep=function(e,t){return gr(Es(e,t),l)},Fn.flatMapDepth=function(e,t,n){return n=n===i?1:pa(n),gr(Es(e,t),n)},Fn.flatten=qo,Fn.flattenDeep=function(e){return null!=e&&e.length?gr(e,l):[]},Fn.flattenDepth=function(e,t){return null!=e&&e.length?gr(e,t=t===i?1:pa(t)):[]},Fn.flip=function(e){return Xi(e,512)},Fn.flow=tu,Fn.flowRight=nu,Fn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Fn.functions=function(e){return null==e?[]:_r(e,Da(e))},Fn.functionsIn=function(e){return null==e?[]:_r(e,ja(e))},Fn.groupBy=_s,Fn.initial=function(e){return null!=e&&e.length?ei(e,0,-1):[]},Fn.intersection=$o,Fn.intersectionBy=Xo,Fn.intersectionWith=Ko,Fn.invert=Oa,Fn.invertBy=Ia,Fn.invokeMap=ws,Fn.iteratee=iu,Fn.keyBy=xs,Fn.keys=Da,Fn.keysIn=ja,Fn.map=Es,Fn.mapKeys=function(e,t){var n={};return t=oo(t,3),vr(e,function(e,r,i){rr(n,t(e,r,i),e)}),n},Fn.mapValues=function(e,t){var n={};return t=oo(t,3),vr(e,function(e,r,i){rr(n,r,t(e,r,i))}),n},Fn.matches=function(e){return Lr(sr(e,1))},Fn.matchesProperty=function(e,t){return Fr(e,sr(t,1))},Fn.memoize=Ms,Fn.merge=Pa,Fn.mergeWith=Ma,Fn.method=ou,Fn.methodOf=su,Fn.mixin=au,Fn.negate=Rs,Fn.nthArg=function(e){return e=pa(e),$r(function(t){return zr(t,e)})},Fn.omit=Ra,Fn.omitBy=function(e,t){return La(e,Rs(oo(t)))},Fn.once=function(e){return Os(2,e)},Fn.orderBy=function(e,t,n,r){return null==e?[]:(Hs(t)||(t=null==t?[]:[t]),Hs(n=r?i:n)||(n=null==n?[]:[n]),Ur(e,t,n))},Fn.over=cu,Fn.overArgs=Ns,Fn.overEvery=lu,Fn.overSome=hu,Fn.partial=Ls,Fn.partialRight=Fs,Fn.partition=Ss,Fn.pick=Na,Fn.pickBy=La,Fn.property=du,Fn.propertyOf=function(e){return function(t){return null==e?i:wr(e,t)}},Fn.pull=Yo,Fn.pullAll=Qo,Fn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Gr(e,t,oo(n,2)):e},Fn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Gr(e,t,i,n):e},Fn.pullAt=Jo,Fn.range=fu,Fn.rangeRight=pu,Fn.rearg=Bs,Fn.reject=function(e,t){return(Hs(e)?xt:pr)(e,Rs(oo(t,3)))},Fn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=oo(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return Hr(e,i),n},Fn.rest=function(e,t){if("function"!=typeof e)throw new Te(o);return $r(e,t=t===i?t:pa(t))},Fn.reverse=es,Fn.sampleSize=function(e,t,n){return t=(n?yo(e,t,n):t===i)?1:pa(t),(Hs(e)?Zn:Kr)(e,t)},Fn.set=function(e,t,n){return null==e?e:Zr(e,t,n)},Fn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:Zr(e,t,n,r)},Fn.shuffle=function(e){return(Hs(e)?Yn:Jr)(e)},Fn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&yo(e,t,n)?(t=0,n=r):(t=null==t?0:pa(t),n=n===i?r:pa(n)),ei(e,t,n)):[]},Fn.sortBy=As,Fn.sortedUniq=function(e){return e&&e.length?ii(e):[]},Fn.sortedUniqBy=function(e,t){return e&&e.length?ii(e,oo(t,2)):[]},Fn.split=function(e,t,n){return n&&"number"!=typeof n&&yo(e,t,n)&&(t=n=i),(n=n===i?f:n>>>0)?(e=va(e))&&("string"==typeof t||null!=t&&!oa(t))&&!(t=si(t))&&Qt(e)?vi(sn(e),0,n):e.split(t,n):[]},Fn.spread=function(e,t){if("function"!=typeof e)throw new Te(o);return t=null==t?0:mn(pa(t),0),$r(function(n){var r=n[t],i=vi(n,0,t);return r&&kt(i,r),yt(e,this,i)})},Fn.tail=function(e){var t=null==e?0:e.length;return t?ei(e,1,t):[]},Fn.take=function(e,t,n){return e&&e.length?ei(e,0,(t=n||t===i?1:pa(t))<0?0:t):[]},Fn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=r-(t=n||t===i?1:pa(t)))<0?0:t,r):[]},Fn.takeRightWhile=function(e,t){return e&&e.length?li(e,oo(t,3),!1,!0):[]},Fn.takeWhile=function(e,t){return e&&e.length?li(e,oo(t,3)):[]},Fn.tap=function(e,t){return t(e),e},Fn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Te(o);return ea(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ds(e,t,{leading:r,maxWait:t,trailing:i})},Fn.thru=fs,Fn.toArray=da,Fn.toPairs=Fa,Fn.toPairsIn=Ba,Fn.toPath=function(e){return Hs(e)?At(e,Lo):ua(e)?[e]:ki(No(va(e)))},Fn.toPlainObject=ya,Fn.transform=function(e,t,n){var r=Hs(e),i=r||Xs(e)||ca(e);if(t=oo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:ea(e)&&Ys(o)?Bn(Ge(e)):{}}return(i?bt:vr)(e,function(e,r,i){return t(n,e,r,i)}),n},Fn.unary=function(e){return Ts(e,1)},Fn.union=ts,Fn.unionBy=ns,Fn.unionWith=rs,Fn.uniq=function(e){return e&&e.length?ai(e):[]},Fn.uniqBy=function(e,t){return e&&e.length?ai(e,oo(t,2)):[]},Fn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?ai(e,i,t):[]},Fn.unset=function(e,t){return null==e||ui(e,t)},Fn.unzip=is,Fn.unzipWith=os,Fn.update=function(e,t,n){return null==e?e:ci(e,t,gi(n))},Fn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ci(e,t,gi(n),r)},Fn.values=za,Fn.valuesIn=function(e){return null==e?[]:Ht(e,ja(e))},Fn.without=ss,Fn.words=Ya,Fn.wrap=function(e,t){return Ls(gi(t),e)},Fn.xor=as,Fn.xorBy=us,Fn.xorWith=cs,Fn.zip=ls,Fn.zipObject=function(e,t){return fi(e||[],t||[],Jn)},Fn.zipObjectDeep=function(e,t){return fi(e||[],t||[],Zr)},Fn.zipWith=hs,Fn.entries=Fa,Fn.entriesIn=Ba,Fn.extend=_a,Fn.extendWith=wa,au(Fn,Fn),Fn.add=vu,Fn.attempt=Qa,Fn.camelCase=Ua,Fn.capitalize=Va,Fn.ceil=bu,Fn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=ma(n))==n?n:0),t!==i&&(t=(t=ma(t))==t?t:0),or(ma(e),t,n)},Fn.clone=function(e){return sr(e,4)},Fn.cloneDeep=function(e){return sr(e,5)},Fn.cloneDeepWith=function(e,t){return sr(e,5,t="function"==typeof t?t:i)},Fn.cloneWith=function(e,t){return sr(e,4,t="function"==typeof t?t:i)},Fn.conformsTo=function(e,t){return null==t||ar(e,t,Da(t))},Fn.deburr=Ga,Fn.defaultTo=function(e,t){return null==e||e!=e?t:e},Fn.divide=_u,Fn.endsWith=function(e,t,n){e=va(e),t=si(t);var r=e.length,o=n=n===i?r:or(pa(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Fn.eq=zs,Fn.escape=function(e){return(e=va(e))&&X.test(e)?e.replace(W,Zt):e},Fn.escapeRegExp=function(e){return(e=va(e))&&ne.test(e)?e.replace(te,"\\$&"):e},Fn.every=function(e,t,n){var r=Hs(e)?wt:dr;return n&&yo(e,t,n)&&(t=i),r(e,oo(t,3))},Fn.find=ms,Fn.findIndex=Go,Fn.findKey=function(e,t){return Dt(e,oo(t,3),vr)},Fn.findLast=ys,Fn.findLastIndex=Ho,Fn.findLastKey=function(e,t){return Dt(e,oo(t,3),br)},Fn.floor=wu,Fn.forEach=vs,Fn.forEachRight=bs,Fn.forIn=function(e,t){return null==e?e:mr(e,oo(t,3),ja)},Fn.forInRight=function(e,t){return null==e?e:yr(e,oo(t,3),ja)},Fn.forOwn=function(e,t){return e&&vr(e,oo(t,3))},Fn.forOwnRight=function(e,t){return e&&br(e,oo(t,3))},Fn.get=ka,Fn.gt=Us,Fn.gte=Vs,Fn.has=function(e,t){return null!=e&&fo(e,t,Ar)},Fn.hasIn=Ta,Fn.head=Wo,Fn.identity=ru,Fn.includes=function(e,t,n,r){e=Ws(e)?e:za(e),n=n&&!r?pa(n):0;var i=e.length;return n<0&&(n=mn(i+n,0)),aa(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Pt(e,t,n)>-1},Fn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=mn(r+i,0)),Pt(e,t,i)},Fn.inRange=function(e,t,n){return t=fa(t),n===i?(n=t,t=0):n=fa(n),function(e,t,n){return e>=yn(t,n)&&e<mn(t,n)}(e=ma(e),t,n)},Fn.invoke=Ca,Fn.isArguments=Gs,Fn.isArray=Hs,Fn.isArrayBuffer=qs,Fn.isArrayLike=Ws,Fn.isArrayLikeObject=$s,Fn.isBoolean=function(e){return!0===e||!1===e||ta(e)&&Er(e)==y},Fn.isBuffer=Xs,Fn.isDate=Ks,Fn.isElement=function(e){return ta(e)&&1===e.nodeType&&!ia(e)},Fn.isEmpty=function(e){if(null==e)return!0;if(Ws(e)&&(Hs(e)||"string"==typeof e||"function"==typeof e.splice||Xs(e)||ca(e)||Gs(e)))return!e.length;var t=ho(e);if(t==x||t==T)return!e.size;if(wo(e))return!Mr(e).length;for(var n in e)if(je.call(e,n))return!1;return!0},Fn.isEqual=function(e,t){return Cr(e,t)},Fn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Cr(e,t,i,n):!!r},Fn.isError=Zs,Fn.isFinite=function(e){return"number"==typeof e&&fn(e)},Fn.isFunction=Ys,Fn.isInteger=Qs,Fn.isLength=Js,Fn.isMap=na,Fn.isMatch=function(e,t){return e===t||Dr(e,t,ao(t))},Fn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Dr(e,t,ao(t),n)},Fn.isNaN=function(e){return ra(e)&&e!=+e},Fn.isNative=function(e){if(_o(e))throw new we("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return jr(e)},Fn.isNil=function(e){return null==e},Fn.isNull=function(e){return null===e},Fn.isNumber=ra,Fn.isObject=ea,Fn.isObjectLike=ta,Fn.isPlainObject=ia,Fn.isRegExp=oa,Fn.isSafeInteger=function(e){return Qs(e)&&e>=-9007199254740991&&e<=h},Fn.isSet=sa,Fn.isString=aa,Fn.isSymbol=ua,Fn.isTypedArray=ca,Fn.isUndefined=function(e){return e===i},Fn.isWeakMap=function(e){return ta(e)&&ho(e)==C},Fn.isWeakSet=function(e){return ta(e)&&"[object WeakSet]"==Er(e)},Fn.join=function(e,t){return null==e?"":pn.call(e,t)},Fn.kebabCase=Ha,Fn.last=Zo,Fn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=pa(n))<0?mn(r+o,0):yn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):jt(e,Rt,o,!0)},Fn.lowerCase=qa,Fn.lowerFirst=Wa,Fn.lt=la,Fn.lte=ha,Fn.max=function(e){return e&&e.length?fr(e,ru,Sr):i},Fn.maxBy=function(e,t){return e&&e.length?fr(e,oo(t,2),Sr):i},Fn.mean=function(e){return Nt(e,ru)},Fn.meanBy=function(e,t){return Nt(e,oo(t,2))},Fn.min=function(e){return e&&e.length?fr(e,ru,Rr):i},Fn.minBy=function(e,t){return e&&e.length?fr(e,oo(t,2),Rr):i},Fn.stubArray=gu,Fn.stubFalse=mu,Fn.stubObject=function(){return{}},Fn.stubString=function(){return""},Fn.stubTrue=function(){return!0},Fn.multiply=xu,Fn.nth=function(e,t){return e&&e.length?zr(e,pa(t)):i},Fn.noConflict=function(){return ot._===this&&(ot._=Le),this},Fn.noop=uu,Fn.now=ks,Fn.pad=function(e,t,n){e=va(e);var r=(t=pa(t))?on(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Ui(ln(i),n)+e+Ui(Ft(i),n)},Fn.padEnd=function(e,t,n){e=va(e);var r=(t=pa(t))?on(e):0;return t&&r<t?e+Ui(t-r,n):e},Fn.padStart=function(e,t,n){e=va(e);var r=(t=pa(t))?on(e):0;return t&&r<t?Ui(t-r,n)+e:e},Fn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),bn(va(e).replace(re,""),t||0)},Fn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&yo(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=fa(e),t===i?(t=e,e=0):t=fa(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=_n();return yn(e+o*(t-e+tt("1e-"+((o+"").length-1))),t)}return qr(e,t)},Fn.reduce=function(e,t,n){var r=Hs(e)?Tt:Bt,i=arguments.length<3;return r(e,oo(t,4),n,i,lr)},Fn.reduceRight=function(e,t,n){var r=Hs(e)?Ot:Bt,i=arguments.length<3;return r(e,oo(t,4),n,i,hr)},Fn.repeat=function(e,t,n){return t=(n?yo(e,t,n):t===i)?1:pa(t),Wr(va(e),t)},Fn.replace=function(){var e=arguments,t=va(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Fn.result=function(e,t,n){var r=-1,o=(t=mi(t,e)).length;for(o||(o=1,e=i);++r<o;){var s=null==e?i:e[Lo(t[r])];s===i&&(r=o,s=n),e=Ys(s)?s.call(e):s}return e},Fn.round=Eu,Fn.runInContext=e,Fn.sample=function(e){return(Hs(e)?Kn:Xr)(e)},Fn.size=function(e){if(null==e)return 0;if(Ws(e))return aa(e)?on(e):e.length;var t=ho(e);return t==x||t==T?e.size:Mr(e).length},Fn.snakeCase=$a,Fn.some=function(e,t,n){var r=Hs(e)?It:ti;return n&&yo(e,t,n)&&(t=i),r(e,oo(t,3))},Fn.sortedIndex=function(e,t){return ni(e,t)},Fn.sortedIndexBy=function(e,t,n){return ri(e,t,oo(n,2))},Fn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ni(e,t);if(r<n&&zs(e[r],t))return r}return-1},Fn.sortedLastIndex=function(e,t){return ni(e,t,!0)},Fn.sortedLastIndexBy=function(e,t,n){return ri(e,t,oo(n,2),!0)},Fn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=ni(e,t,!0)-1;if(zs(e[n],t))return n}return-1},Fn.startCase=Xa,Fn.startsWith=function(e,t,n){return e=va(e),n=null==n?0:or(pa(n),0,e.length),t=si(t),e.slice(n,n+t.length)==t},Fn.subtract=Su,Fn.sum=function(e){return e&&e.length?zt(e,ru):0},Fn.sumBy=function(e,t){return e&&e.length?zt(e,oo(t,2)):0},Fn.template=function(e,t,n){var r=Fn.templateSettings;n&&yo(e,t,n)&&(t=i),e=va(e),t=wa({},t,r,Ki);var o,s,a=wa({},t.imports,r.imports,Ki),u=Da(a),c=Ht(a,u),l=0,h=t.interpolate||be,d="__p += '",f=Ae((t.escape||be).source+"|"+h.source+"|"+(h===Y?he:be).source+"|"+(t.evaluate||be).source+"|$","g"),p="//# sourceURL="+(je.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ye+"]")+"\n";e.replace(f,function(t,n,r,i,a,u){return r||(r=i),d+=e.slice(l,u).replace(_e,Yt),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+t.length,t}),d+="';\n";var g=je.call(t,"variable")&&t.variable;if(g){if(ce.test(g))throw new we("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(s?d.replace(V,""):d).replace(G,"$1").replace(H,"$1;"),d="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=Qa(function(){return xe(u,p+"return "+d).apply(i,c)});if(m.source=d,Zs(m))throw m;return m},Fn.times=function(e,t){if((e=pa(e))<1||e>h)return[];var n=f,r=yn(e,f);t=oo(t),e-=f;for(var i=Ut(r,t);++n<e;)t(n);return i},Fn.toFinite=fa,Fn.toInteger=pa,Fn.toLength=ga,Fn.toLower=function(e){return va(e).toLowerCase()},Fn.toNumber=ma,Fn.toSafeInteger=function(e){return e?or(pa(e),-9007199254740991,h):0===e?e:0},Fn.toString=va,Fn.toUpper=function(e){return va(e).toUpperCase()},Fn.trim=function(e,t,n){if((e=va(e))&&(n||t===i))return Vt(e);if(!e||!(t=si(t)))return e;var r=sn(e),o=sn(t);return vi(r,Wt(r,o),$t(r,o)+1).join("")},Fn.trimEnd=function(e,t,n){if((e=va(e))&&(n||t===i))return e.slice(0,an(e)+1);if(!e||!(t=si(t)))return e;var r=sn(e);return vi(r,0,$t(r,sn(t))+1).join("")},Fn.trimStart=function(e,t,n){if((e=va(e))&&(n||t===i))return e.replace(re,"");if(!e||!(t=si(t)))return e;var r=sn(e);return vi(r,Wt(r,sn(t))).join("")},Fn.truncate=function(e,t){var n=30,r="...";if(ea(t)){var o="separator"in t?t.separator:o;n="length"in t?pa(t.length):n,r="omission"in t?si(t.omission):r}var s=(e=va(e)).length;if(Qt(e)){var a=sn(e);s=a.length}if(n>=s)return e;var u=n-on(r);if(u<1)return r;var c=a?vi(a,0,u).join(""):e.slice(0,u);if(o===i)return c+r;if(a&&(u+=c.length-u),oa(o)){if(e.slice(u).search(o)){var l,h=c;for(o.global||(o=Ae(o.source,va(de.exec(o))+"g")),o.lastIndex=0;l=o.exec(h);)var d=l.index;c=c.slice(0,d===i?u:d)}}else if(e.indexOf(si(o),u)!=u){var f=c.lastIndexOf(o);f>-1&&(c=c.slice(0,f))}return c+r},Fn.unescape=function(e){return(e=va(e))&&$.test(e)?e.replace(q,un):e},Fn.uniqueId=function(e){var t=++Pe;return va(e)+t},Fn.upperCase=Ka,Fn.upperFirst=Za,Fn.each=vs,Fn.eachRight=bs,Fn.first=Wo,au(Fn,(yu={},vr(Fn,function(e,t){je.call(Fn.prototype,t)||(yu[t]=e)}),yu),{chain:!1}),Fn.VERSION="4.17.21",bt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){Fn[e].placeholder=Fn}),bt(["drop","take"],function(e,t){Vn.prototype[e]=function(n){n=n===i?1:mn(pa(n),0);var r=this.__filtered__&&!t?new Vn(this):this.clone();return r.__filtered__?r.__takeCount__=yn(n,r.__takeCount__):r.__views__.push({size:yn(n,f),type:e+(r.__dir__<0?"Right":"")}),r},Vn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),bt(["filter","map","takeWhile"],function(e,t){var n=t+1,r=1==n||3==n;Vn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:oo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),bt(["head","last"],function(e,t){var n="take"+(t?"Right":"");Vn.prototype[e]=function(){return this[n](1).value()[0]}}),bt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");Vn.prototype[e]=function(){return this.__filtered__?new Vn(this):this[n](1)}}),Vn.prototype.compact=function(){return this.filter(ru)},Vn.prototype.find=function(e){return this.filter(e).head()},Vn.prototype.findLast=function(e){return this.reverse().find(e)},Vn.prototype.invokeMap=$r(function(e,t){return"function"==typeof e?new Vn(this):this.map(function(n){return Or(n,e,t)})}),Vn.prototype.reject=function(e){return this.filter(Rs(oo(e)))},Vn.prototype.slice=function(e,t){e=pa(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Vn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=pa(t))<0?n.dropRight(-t):n.take(t-e)),n)},Vn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Vn.prototype.toArray=function(){return this.take(f)},vr(Vn.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Fn[r?"take"+("last"==t?"Right":""):t],s=r||/^find/.test(t);o&&(Fn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,u=t instanceof Vn,c=a[0],l=u||Hs(t),h=function(e){var t=o.apply(Fn,kt([e],a));return r&&d?t[0]:t};l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var d=this.__chain__,f=!!this.__actions__.length,p=s&&!d,g=u&&!f;if(!s&&l){t=g?t:new Vn(this);var m=e.apply(t,a);return m.__actions__.push({func:fs,args:[h],thisArg:i}),new Un(m,d)}return p&&g?e.apply(this,a):(m=this.thru(h),p?r?m.value()[0]:m.value():m)})}),bt(["pop","push","shift","sort","splice","unshift"],function(e){var t=Oe[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Fn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Hs(i)?i:[],e)}return this[n](function(n){return t.apply(Hs(n)?n:[],e)})}}),vr(Vn.prototype,function(e,t){var n=Fn[t];if(n){var r=n.name+"";je.call(In,r)||(In[r]=[]),In[r].push({name:t,func:n})}}),In[Li(i,2).name]=[{name:"wrapper",func:i}],Vn.prototype.clone=function(){var e=new Vn(this.__wrapped__);return e.__actions__=ki(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ki(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ki(this.__views__),e},Vn.prototype.reverse=function(){if(this.__filtered__){var e=new Vn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Vn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Hs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=yn(t,e+s);break;case"takeRight":e=mn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,u=a-s,c=r?a:s-1,l=this.__iteratees__,h=l.length,d=0,f=yn(u,this.__takeCount__);if(!n||!r&&i==u&&f==u)return hi(e,this.__actions__);var p=[];e:for(;u--&&d<f;){for(var g=-1,m=e[c+=t];++g<h;){var y=l[g],v=y.type,b=(0,y.iteratee)(m);if(2==v)m=b;else if(!b){if(1==v)continue e;break e}}p[d++]=m}return p},Fn.prototype.at=ps,Fn.prototype.chain=function(){return ds(this)},Fn.prototype.commit=function(){return new Un(this.value(),this.__chain__)},Fn.prototype.next=function(){this.__values__===i&&(this.__values__=da(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Fn.prototype.plant=function(e){for(var t,n=this;n instanceof zn;){var r=Bo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Fn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Vn){var t=e;return this.__actions__.length&&(t=new Vn(this)),(t=t.reverse()).__actions__.push({func:fs,args:[es],thisArg:i}),new Un(t,this.__chain__)}return this.thru(es)},Fn.prototype.toJSON=Fn.prototype.valueOf=Fn.prototype.value=function(){return hi(this.__wrapped__,this.__actions__)},Fn.prototype.first=Fn.prototype.head,it&&(Fn.prototype[it]=function(){return this}),Fn}();ot._=cn,(r=(function(){return cn}).call(t,n,t,e))===i||(e.exports=r)}).call(this)},478:function(e){e.exports=function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r={exports:{}};r.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:function(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}},changeDefaults:function(e){r.exports.defaults=e}};var i=/[&<>"']/,o=/[&<>"']/g,s=/[<>"']|&(?!#?\w+;)/,a=/[<>"']|&(?!#?\w+;)/g,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=function(e){return u[e]},l=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function h(e){return e.replace(l,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}var d=/(^|[^\[])\^/g,f=/[^\w:]/g,p=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i,g={},m=/^[^:]+:\/*[^/]*$/,y=/^([^:]+:)[\s\S]*$/,v=/^([^:]+:\/*[^/]*)[\s\S]*$/;function b(e,t,n){var r=e.length;if(0===r)return"";for(var i=0;i<r;){var o=e.charAt(r-i-1);if(o!==t||n){if(o===t||!n)break;i++}else i++}return e.substr(0,r-i)}var _=function(e,t){if(t){if(i.test(e))return e.replace(o,c)}else if(s.test(e))return e.replace(a,c);return e},w=h,x=function(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},E=r.exports.defaults,S=b,A=function(e,t){var n=e.replace(/\|/g,function(e,t,n){for(var r=!1,i=t;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"}).split(/ \|/),r=0;if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n},k=_;function T(e,t,n){var r=t.href,i=t.title?k(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");return"!"!==e[0].charAt(0)?{type:"link",raw:n,href:r,title:i,text:o}:{type:"image",raw:n,href:r,title:i,text:k(o)}}var O=function(){function e(e){this.options=e||E}var t=e.prototype;return t.space=function(e){var t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}},t.code=function(e){var t=this.rules.block.code.exec(e);if(t){var n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:S(n,"\n")}}},t.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var n=t[0],r=function(e,t){var n=e.match(/^(\s+)(?:```)/);if(null===n)return t;var r=n[1];return t.split("\n").map(function(e){var t=e.match(/^\s+/);return null===t?e:t[0].length>=r.length?e.slice(r.length):e}).join("\n")}(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim():t[2],text:r}}},t.heading=function(e){var t=this.rules.block.heading.exec(e);if(t){var n=t[2].trim();if(/#$/.test(n)){var r=S(n,"#");this.options.pedantic?n=r.trim():r&&!/ $/.test(r)||(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n}}},t.nptable=function(e){var t=this.rules.block.nptable.exec(e);if(t){var n={type:"table",header:A(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[],raw:t[0]};if(n.header.length===n.align.length){var r,i=n.align.length;for(r=0;r<i;r++)n.align[r]=/^ *-+: *$/.test(n.align[r])?"right":/^ *:-+: *$/.test(n.align[r])?"center":/^ *:-+ *$/.test(n.align[r])?"left":null;for(i=n.cells.length,r=0;r<i;r++)n.cells[r]=A(n.cells[r],n.header.length);return n}}},t.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},t.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var n=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],text:n}}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){var n,r,i,o,s,a,u,c,l,h=t[0],d=t[2],f=d.length>1,p={type:"list",raw:h,ordered:f,start:f?+d.slice(0,-1):"",loose:!1,items:[]},g=t[0].match(this.rules.block.item),m=!1,y=g.length;i=this.rules.block.listItemStart.exec(g[0]);for(var v=0;v<y;v++){if(h=n=g[v],this.options.pedantic||(l=n.match(new RegExp("\\n\\s*\\n {0,"+(i[0].length-1)+"}\\S")))&&(s=n.length-l.index+g.slice(v+1).join("\n").length,p.raw=p.raw.substring(0,p.raw.length-s),h=n=n.substring(0,l.index),y=v+1),v!==y-1){if(o=this.rules.block.listItemStart.exec(g[v+1]),this.options.pedantic?o[1].length>i[1].length:o[1].length>=i[0].length||o[1].length>3){g.splice(v,2,g[v]+(!this.options.pedantic&&o[1].length<i[0].length&&!g[v].match(/\n$/)?"":"\n")+g[v+1]),v--,y--;continue}(!this.options.pedantic||this.options.smartLists?o[2][o[2].length-1]!==d[d.length-1]:f===(1===o[2].length))&&(s=g.slice(v+1).join("\n").length,p.raw=p.raw.substring(0,p.raw.length-s),v=y-1),i=o}r=n.length,~(n=n.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(r-=n.length,n=n.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+r+"}","gm"),"")),n=S(n,"\n"),v!==y-1&&(h+="\n"),a=m||/\n\n(?!\s*$)/.test(h),v!==y-1&&(m="\n\n"===h.slice(-2),a||(a=m)),a&&(p.loose=!0),this.options.gfm&&(c=void 0,(u=/^\[[ xX]\] /.test(n))&&(c=" "!==n[1],n=n.replace(/^\[[ xX]\] +/,""))),p.items.push({type:"list_item",raw:h,task:u,checked:c,loose:a,text:n})}return p}},t.html=function(e){var t=this.rules.block.html.exec(e);if(t)return{type:this.options.sanitize?"paragraph":"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):k(t[0]):t[0]}},t.def=function(e){var t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}},t.table=function(e){var t=this.rules.block.table.exec(e);if(t){var n={type:"table",header:A(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=t[0];var r,i=n.align.length;for(r=0;r<i;r++)n.align[r]=/^ *-+: *$/.test(n.align[r])?"right":/^ *:-+: *$/.test(n.align[r])?"center":/^ *:-+ *$/.test(n.align[r])?"left":null;for(i=n.cells.length,r=0;r<i;r++)n.cells[r]=A(n.cells[r].replace(/^ *\| *| *\| *$/g,""),n.header.length);return n}}},t.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1]}},t.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t)return{type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1]}},t.text=function(e){var t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0]}},t.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:k(t[1])}},t.tag=function(e,t,n){var r=this.rules.inline.tag.exec(e);if(r)return!t&&/^<a /i.test(r[0])?t=!0:t&&/^<\/a>/i.test(r[0])&&(t=!1),!n&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?n=!0:n&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(n=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:t,inRawBlock:n,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):k(r[0]):r[0]}},t.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;var r=S(n.slice(0,-1),"\\");if((n.length-r.length)%2==0)return}else{var i=function(e,t){if(-1===e.indexOf(t[1]))return-1;for(var n=e.length,r=0,i=0;i<n;i++)if("\\"===e[i])i++;else if(e[i]===t[0])r++;else if(e[i]===t[1]&&--r<0)return i;return-1}(t[2],"()");if(i>-1){var o=(0===t[0].indexOf("!")?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}var s=t[2],a="";if(this.options.pedantic){var u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);u&&(s=u[1],a=u[3])}else a=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(n)?s.slice(1):s.slice(1,-1)),T(t,{href:s?s.replace(this.rules.inline._escapes,"$1"):s,title:a?a.replace(this.rules.inline._escapes,"$1"):a},t[0])}},t.reflink=function(e,t){var n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){var r=(n[2]||n[1]).replace(/\s+/g," ");if(!(r=t[r.toLowerCase()])||!r.href){var i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return T(n,r,n[0])}},t.emStrong=function(e,t,n){void 0===n&&(n="");var r=this.rules.inline.emStrong.lDelim.exec(e);if(r&&(!r[3]||!n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var i=r[1]||r[2]||"";if(!i||i&&(""===n||this.rules.inline.punctuation.exec(n))){var o,s,a=r[0].length-1,u=a,c=0,l="*"===r[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+a);null!=(r=l.exec(t));)if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6])if(s=o.length,r[3]||r[4])u+=s;else if(!((r[5]||r[6])&&a%3)||(a+s)%3){if(!((u-=s)>0))return s=Math.min(s,s+u+c),Math.min(a,s)%2?{type:"em",raw:e.slice(0,a+r.index+s+1),text:e.slice(1,a+r.index+s)}:{type:"strong",raw:e.slice(0,a+r.index+s+1),text:e.slice(2,a+r.index+s-1)}}else c+=s}}},t.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var n=t[2].replace(/\n/g," "),r=/[^ ]/.test(n),i=/^ /.test(n)&&/ $/.test(n);return r&&i&&(n=n.substring(1,n.length-1)),n=k(n,!0),{type:"codespan",raw:t[0],text:n}}},t.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}},t.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2]}},t.autolink=function(e,t){var n,r,i=this.rules.inline.autolink.exec(e);if(i)return r="@"===i[2]?"mailto:"+(n=k(this.options.mangle?t(i[1]):i[1])):n=k(i[1]),{type:"link",raw:i[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}},t.url=function(e,t){var n;if(n=this.rules.inline.url.exec(e)){var r,i;if("@"===n[2])i="mailto:"+(r=k(this.options.mangle?t(n[0]):n[0]));else{var o;do{o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(o!==n[0]);r=k(n[0]),i="www."===n[1]?"http://"+r:r}return{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}},t.inlineText=function(e,t,n){var r,i=this.rules.inline.text.exec(e);if(i)return r=t?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):k(i[0]):i[0]:k(this.options.smartypants?n(i[0]):i[0]),{type:"text",raw:i[0],text:r}},e}(),I={exec:function(){}},C=function(e,t){e=e.source||e,t=t||"";var n={replace:function(t,r){return r=(r=r.source||r).replace(d,"$1"),e=e.replace(t,r),n},getRegex:function(){return new RegExp(e,t)}};return n},D=x,j={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:I,table:I,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};j.def=C(j.def).replace("label",j._label).replace("title",j._title).getRegex(),j.bullet=/(?:[*+-]|\d{1,9}[.)])/,j.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,j.item=C(j.item,"gm").replace(/bull/g,j.bullet).getRegex(),j.listItemStart=C(/^( *)(bull) */).replace("bull",j.bullet).getRegex(),j.list=C(j.list).replace(/bull/g,j.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+j.def.source+")").getRegex(),j._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",j._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,j.html=C(j.html,"i").replace("comment",j._comment).replace("tag",j._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),j.paragraph=C(j._paragraph).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j._tag).getRegex(),j.blockquote=C(j.blockquote).replace("paragraph",j.paragraph).getRegex(),j.normal=D({},j),j.gfm=D({},j.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),j.gfm.nptable=C(j.gfm.nptable).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j._tag).getRegex(),j.gfm.table=C(j.gfm.table).replace("hr",j.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",j._tag).getRegex(),j.pedantic=D({},j.normal,{html:C("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",j._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:I,paragraph:C(j.normal._paragraph).replace("hr",j.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",j.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var P={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:I,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:I,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};P.punctuation=C(P.punctuation).replace(/punctuation/g,P._punctuation).getRegex(),P.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,P.escapedEmSt=/\\\*|\\_/g,P._comment=C(j._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),P.emStrong.lDelim=C(P.emStrong.lDelim).replace(/punct/g,P._punctuation).getRegex(),P.emStrong.rDelimAst=C(P.emStrong.rDelimAst,"g").replace(/punct/g,P._punctuation).getRegex(),P.emStrong.rDelimUnd=C(P.emStrong.rDelimUnd,"g").replace(/punct/g,P._punctuation).getRegex(),P._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,P._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,P._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,P.autolink=C(P.autolink).replace("scheme",P._scheme).replace("email",P._email).getRegex(),P._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,P.tag=C(P.tag).replace("comment",P._comment).replace("attribute",P._attribute).getRegex(),P._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,P._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,P._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,P.link=C(P.link).replace("label",P._label).replace("href",P._href).replace("title",P._title).getRegex(),P.reflink=C(P.reflink).replace("label",P._label).getRegex(),P.reflinkSearch=C(P.reflinkSearch,"g").replace("reflink",P.reflink).replace("nolink",P.nolink).getRegex(),P.normal=D({},P),P.pedantic=D({},P.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:C(/^!?\[(label)\]\((.*?)\)/).replace("label",P._label).getRegex(),reflink:C(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",P._label).getRegex()}),P.gfm=D({},P.normal,{escape:C(P.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),P.gfm.url=C(P.gfm.url,"i").replace("email",P.gfm._extended_email).getRegex(),P.breaks=D({},P.gfm,{br:C(P.br).replace("{2,}","*").getRegex(),text:C(P.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var M={block:j,inline:P},R=O,N=r.exports.defaults,L=M.block,F=M.inline,B=function(e,t){if(t<1)return"";for(var n="";t>1;)1&t&&(n+=e),t>>=1,e+=e;return n+e};function z(e){return e.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function U(e){var t,n,r="",i=e.length;for(t=0;t<i;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}var V=function(){function t(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||N,this.options.tokenizer=this.options.tokenizer||new R,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var t={block:L.normal,inline:F.normal};this.options.pedantic?(t.block=L.pedantic,t.inline=F.pedantic):this.options.gfm&&(t.block=L.gfm,t.inline=this.options.breaks?F.breaks:F.gfm),this.tokenizer.rules=t}t.lex=function(e,n){return new t(n).lex(e)},t.lexInline=function(e,n){return new t(n).inlineTokens(e)};var n,r,i=t.prototype;return i.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens,!0),this.inline(this.tokens),this.tokens},i.blockTokens=function(e,t,n){var r,i,o,s,a,u,c=this;for(void 0===t&&(t=[]),void 0===n&&(n=!0),this.options.pedantic&&(e=e.replace(/^ +$/gm,""));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(n){return!!(r=n.call(c,e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)})))if(r=this.tokenizer.space(e))e=e.substring(r.raw.length),r.type&&t.push(r);else if(r=this.tokenizer.code(e))e=e.substring(r.raw.length),(s=t[t.length-1])&&"paragraph"===s.type?(s.raw+="\n"+r.raw,s.text+="\n"+r.text):t.push(r);else if(r=this.tokenizer.fences(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.heading(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.nptable(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.hr(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.blockquote(e))e=e.substring(r.raw.length),r.tokens=this.blockTokens(r.text,[],n),t.push(r);else if(r=this.tokenizer.list(e)){for(e=e.substring(r.raw.length),o=r.items.length,i=0;i<o;i++)r.items[i].tokens=this.blockTokens(r.items[i].text,[],!1);t.push(r)}else if(r=this.tokenizer.html(e))e=e.substring(r.raw.length),t.push(r);else if(n&&(r=this.tokenizer.def(e)))e=e.substring(r.raw.length),this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});else if(r=this.tokenizer.table(e))e=e.substring(r.raw.length),t.push(r);else if(r=this.tokenizer.lheading(e))e=e.substring(r.raw.length),t.push(r);else if(a=e,this.options.extensions&&this.options.extensions.startBlock&&function(){var t=1/0,n=e.slice(1),r=void 0;c.options.extensions.startBlock.forEach(function(e){"number"==typeof(r=e.call(this,n))&&r>=0&&(t=Math.min(t,r))}),t<1/0&&t>=0&&(a=e.substring(0,t+1))}(),n&&(r=this.tokenizer.paragraph(a)))s=t[t.length-1],u&&"paragraph"===s.type?(s.raw+="\n"+r.raw,s.text+="\n"+r.text):t.push(r),u=a.length!==e.length,e=e.substring(r.raw.length);else if(r=this.tokenizer.text(e))e=e.substring(r.raw.length),(s=t[t.length-1])&&"text"===s.type?(s.raw+="\n"+r.raw,s.text+="\n"+r.text):t.push(r);else if(e){var l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}throw new Error(l)}return t},i.inline=function(e){var t,n,r,i,o,s,a=e.length;for(t=0;t<a;t++)switch((s=e[t]).type){case"paragraph":case"text":case"heading":s.tokens=[],this.inlineTokens(s.text,s.tokens);break;case"table":for(s.tokens={header:[],cells:[]},i=s.header.length,n=0;n<i;n++)s.tokens.header[n]=[],this.inlineTokens(s.header[n],s.tokens.header[n]);for(i=s.cells.length,n=0;n<i;n++)for(o=s.cells[n],s.tokens.cells[n]=[],r=0;r<o.length;r++)s.tokens.cells[n][r]=[],this.inlineTokens(o[r],s.tokens.cells[n][r]);break;case"blockquote":this.inline(s.tokens);break;case"list":for(i=s.items.length,n=0;n<i;n++)this.inline(s.items[n].tokens)}return e},i.inlineTokens=function(e,t,n,r){var i,o,s,a=this;void 0===t&&(t=[]),void 0===n&&(n=!1),void 0===r&&(r=!1);var u,c,l,h=e;if(this.tokens.links){var d=Object.keys(this.tokens.links);if(d.length>0)for(;null!=(u=this.tokenizer.rules.inline.reflinkSearch.exec(h));)d.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(h=h.slice(0,u.index)+"["+B("a",u[0].length-2)+"]"+h.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(u=this.tokenizer.rules.inline.blockSkip.exec(h));)h=h.slice(0,u.index)+"["+B("a",u[0].length-2)+"]"+h.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(u=this.tokenizer.rules.inline.escapedEmSt.exec(h));)h=h.slice(0,u.index)+"++"+h.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(n){return!!(i=n.call(a,e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)})))if(i=this.tokenizer.escape(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.tag(e,n,r))e=e.substring(i.raw.length),n=i.inLink,r=i.inRawBlock,(o=t[t.length-1])&&"text"===i.type&&"text"===o.type?(o.raw+=i.raw,o.text+=i.text):t.push(i);else if(i=this.tokenizer.link(e))e=e.substring(i.raw.length),"link"===i.type&&(i.tokens=this.inlineTokens(i.text,[],!0,r)),t.push(i);else if(i=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(i.raw.length),o=t[t.length-1],"link"===i.type?(i.tokens=this.inlineTokens(i.text,[],!0,r),t.push(i)):o&&"text"===i.type&&"text"===o.type?(o.raw+=i.raw,o.text+=i.text):t.push(i);else if(i=this.tokenizer.emStrong(e,h,l))e=e.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],n,r),t.push(i);else if(i=this.tokenizer.codespan(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.br(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.del(e))e=e.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],n,r),t.push(i);else if(i=this.tokenizer.autolink(e,U))e=e.substring(i.raw.length),t.push(i);else if(n||!(i=this.tokenizer.url(e,U))){if(s=e,this.options.extensions&&this.options.extensions.startInline&&function(){var t=1/0,n=e.slice(1),r=void 0;a.options.extensions.startInline.forEach(function(e){"number"==typeof(r=e.call(this,n))&&r>=0&&(t=Math.min(t,r))}),t<1/0&&t>=0&&(s=e.substring(0,t+1))}(),i=this.tokenizer.inlineText(s,r,z))e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(l=i.raw.slice(-1)),c=!0,(o=t[t.length-1])&&"text"===o.type?(o.raw+=i.raw,o.text+=i.text):t.push(i);else if(e){var f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}throw new Error(f)}}else e=e.substring(i.raw.length),t.push(i);return t},n=t,r=[{key:"rules",get:function(){return{block:L,inline:F}}}],null&&e(n.prototype,null),r&&e(n,r),t}(),G=r.exports.defaults,H=function(e,t,n){if(e){var r;try{r=decodeURIComponent(h(n)).replace(f,"").toLowerCase()}catch(i){return null}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return null}t&&!p.test(n)&&(n=function(e,t){g[" "+e]||(g[" "+e]=m.test(e)?e+"/":b(e,"/",!0));var n=-1===(e=g[" "+e]).indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(y,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(v,"$1")+t:e+t}(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(i){return null}return n},q=_,W=function(){function e(e){this.options=e||G}var t=e.prototype;return t.code=function(e,t,n){var r=(t||"").match(/\S*/)[0];if(this.options.highlight){var i=this.options.highlight(e,r);null!=i&&i!==e&&(n=!0,e=i)}return e=e.replace(/\n$/,"")+"\n",r?'<pre><code class="'+this.options.langPrefix+q(r,!0)+'">'+(n?e:q(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:q(e,!0))+"</code></pre>\n"},t.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},t.html=function(e){return e},t.heading=function(e,t,n,r){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+r.slug(n)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},t.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},t.list=function(e,t,n){var r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"},t.listitem=function(e){return"<li>"+e+"</li>\n"},t.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},t.paragraph=function(e){return"<p>"+e+"</p>\n"},t.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},t.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},t.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},t.strong=function(e){return"<strong>"+e+"</strong>"},t.em=function(e){return"<em>"+e+"</em>"},t.codespan=function(e){return"<code>"+e+"</code>"},t.br=function(){return this.options.xhtml?"<br/>":"<br>"},t.del=function(e){return"<del>"+e+"</del>"},t.link=function(e,t,n){if(null===(e=H(this.options.sanitize,this.options.baseUrl,e)))return n;var r='<a href="'+q(e)+'"';return t&&(r+=' title="'+t+'"'),r+">"+n+"</a>"},t.image=function(e,t,n){if(null===(e=H(this.options.sanitize,this.options.baseUrl,e)))return n;var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+(this.options.xhtml?"/>":">")},t.text=function(e){return e},e}(),$=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,n){return""+n},t.image=function(e,t,n){return""+n},t.br=function(){return""},e}(),X=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},t.getNextSafeSlug=function(e,t){var n=e,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[e];do{n=e+"-"+ ++r}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=r,this.seen[n]=0),n},t.slug=function(e,t){void 0===t&&(t={});var n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)},e}(),K=W,Z=$,Y=X,Q=r.exports.defaults,J=w,ee=V,te=function(){function e(e){this.options=e||Q,this.options.renderer=this.options.renderer||new K,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Z,this.slugger=new Y}e.parse=function(t,n){return new e(n).parse(t)},e.parseInline=function(t,n){return new e(n).parseInline(t)};var t=e.prototype;return t.parse=function(e,t){void 0===t&&(t=!0);var n,r,i,o,s,a,u,c,l,h,d,f,p,g,m,y,v,b,_,w="",x=e.length;for(n=0;n<x;n++)if(h=e[n],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[h.type])||!1===(_=this.options.extensions.renderers[h.type].call(this,h))&&["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type))switch(h.type){case"space":continue;case"hr":w+=this.renderer.hr();continue;case"heading":w+=this.renderer.heading(this.parseInline(h.tokens),h.depth,J(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue;case"code":w+=this.renderer.code(h.text,h.lang,h.escaped);continue;case"table":for(c="",u="",o=h.header.length,r=0;r<o;r++)u+=this.renderer.tablecell(this.parseInline(h.tokens.header[r]),{header:!0,align:h.align[r]});for(c+=this.renderer.tablerow(u),l="",o=h.cells.length,r=0;r<o;r++){for(u="",s=(a=h.tokens.cells[r]).length,i=0;i<s;i++)u+=this.renderer.tablecell(this.parseInline(a[i]),{header:!1,align:h.align[i]});l+=this.renderer.tablerow(u)}w+=this.renderer.table(c,l);continue;case"blockquote":l=this.parse(h.tokens),w+=this.renderer.blockquote(l);continue;case"list":for(d=h.ordered,f=h.start,p=h.loose,o=h.items.length,l="",r=0;r<o;r++)y=(m=h.items[r]).checked,v=m.task,g="",m.task&&(b=this.renderer.checkbox(y),p?m.tokens.length>0&&"text"===m.tokens[0].type?(m.tokens[0].text=b+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=b+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:b}):g+=b),g+=this.parse(m.tokens,p),l+=this.renderer.listitem(g,v,y);w+=this.renderer.list(l,d,f);continue;case"html":w+=this.renderer.html(h.text);continue;case"paragraph":w+=this.renderer.paragraph(this.parseInline(h.tokens));continue;case"text":for(l=h.tokens?this.parseInline(h.tokens):h.text;n+1<x&&"text"===e[n+1].type;)l+="\n"+((h=e[++n]).tokens?this.parseInline(h.tokens):h.text);w+=t?this.renderer.paragraph(l):l;continue;default:var E='Token with "'+h.type+'" type was not found.';if(this.options.silent)return void console.error(E);throw new Error(E)}else w+=_||"";return w},t.parseInline=function(e,t){t=t||this.renderer;var n,r,i,o="",s=e.length;for(n=0;n<s;n++)if(r=e[n],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type])||!1===(i=this.options.extensions.renderers[r.type].call(this,r))&&["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type))switch(r.type){case"escape":o+=t.text(r.text);break;case"html":o+=t.html(r.text);break;case"link":o+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break;case"image":o+=t.image(r.href,r.title,r.text);break;case"strong":o+=t.strong(this.parseInline(r.tokens,t));break;case"em":o+=t.em(this.parseInline(r.tokens,t));break;case"codespan":o+=t.codespan(r.text);break;case"br":o+=t.br();break;case"del":o+=t.del(this.parseInline(r.tokens,t));break;case"text":o+=t.text(r.text);break;default:var a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(a);throw new Error(a)}else o+=i||"";return o},e}(),ne=O,re=W,ie=$,oe=X,se=x,ae=function(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},ue=_,ce=r.exports.getDefaults,le=r.exports.changeDefaults,he=r.exports.defaults;function de(e,t,n){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(n=t,t=null),t=se({},de.defaults,t||{}),ae(t),n){var r,i=t.highlight;try{r=ee.lex(e,t)}catch(u){return n(u)}var o=function(e){var o;if(!e)try{t.walkTokens&&de.walkTokens(r,t.walkTokens),o=te.parse(r,t)}catch(u){e=u}return t.highlight=i,e?n(e):n(null,o)};if(!i||i.length<3)return o();if(delete t.highlight,!r.length)return o();var s=0;return de.walkTokens(r,function(e){"code"===e.type&&(s++,setTimeout(function(){i(e.text,e.lang,function(t,n){if(t)return o(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),0==--s&&o()})},0))}),void(0===s&&o())}try{var a=ee.lex(e,t);return t.walkTokens&&de.walkTokens(a,t.walkTokens),te.parse(a,t)}catch(u){if(u.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+ue(u.message+"",!0)+"</pre>";throw u}}return de.options=de.setOptions=function(e){return se(de.defaults,e),le(de.defaults),de},de.getDefaults=ce,de.defaults=he,de.use=function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i,o=se.apply(void 0,[{}].concat(n)),s=de.defaults.extensions||{renderers:{},childTokens:{}};n.forEach(function(t){if(t.extensions&&(i=!0,t.extensions.forEach(function(e){if(!e.name)throw new Error("extension name required");if(e.renderer){var t=s.renderers?s.renderers[e.name]:null;s.renderers[e.name]=t?function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=e.renderer.apply(this,r);return!1===o&&(o=t.apply(this,r)),o}:e.renderer}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");s[e.level]?s[e.level].unshift(e.tokenizer):s[e.level]=[e.tokenizer],e.start&&("block"===e.level?s.startBlock?s.startBlock.push(e.start):s.startBlock=[e.start]:"inline"===e.level&&(s.startInline?s.startInline.push(e.start):s.startInline=[e.start]))}e.childTokens&&(s.childTokens[e.name]=e.childTokens)})),t.renderer&&function(){var e=de.defaults.renderer||new re,n=function(n){var r=e[n];e[n]=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var a=t.renderer[n].apply(e,o);return!1===a&&(a=r.apply(e,o)),a}};for(var r in t.renderer)n(r);o.renderer=e}(),t.tokenizer&&function(){var e=de.defaults.tokenizer||new ne,n=function(n){var r=e[n];e[n]=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];var a=t.tokenizer[n].apply(e,o);return!1===a&&(a=r.apply(e,o)),a}};for(var r in t.tokenizer)n(r);o.tokenizer=e}(),t.walkTokens){var n=de.defaults.walkTokens;o.walkTokens=function(r){t.walkTokens.call(e,r),n&&n(r)}}i&&(o.extensions=s),de.setOptions(o)})},de.walkTokens=function(e,t){for(var r,i=function(){var e=r.value;switch(t(e),e.type){case"table":for(var i,o=n(e.tokens.header);!(i=o()).done;)de.walkTokens(i.value,t);for(var s,a=n(e.tokens.cells);!(s=a()).done;)for(var u,c=n(s.value);!(u=c()).done;)de.walkTokens(u.value,t);break;case"list":de.walkTokens(e.items,t);break;default:de.defaults.extensions&&de.defaults.extensions.childTokens&&de.defaults.extensions.childTokens[e.type]?de.defaults.extensions.childTokens[e.type].forEach(function(n){de.walkTokens(e[n],t)}):e.tokens&&de.walkTokens(e.tokens,t)}},o=n(e);!(r=o()).done;)i()},de.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=se({},de.defaults,t||{}),ae(t);try{var n=ee.lexInline(e,t);return t.walkTokens&&de.walkTokens(n,t.walkTokens),te.parseInline(n,t)}catch(r){if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+ue(r.message+"",!0)+"</pre>";throw r}},de.Parser=te,de.parser=te.parse,de.Renderer=re,de.TextRenderer=ie,de.Lexer=ee,de.lexer=ee.lex,de.Tokenizer=ne,de.Slugger=oe,de.parse=de,de}()},369:(e,t,n)=>{var r=n(284),i=n(830);function o(){this.clear()}o.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},o.prototype.enqueue=function(e){return this.items.push(e),++this.size},o.prototype.dequeue=function(){if(this.size){var e=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,e}},o.prototype.peek=function(){if(this.size)return this.items[this.offset]},o.prototype.forEach=function(e,t){t=arguments.length>1?t:this;for(var n=this.offset,r=0,i=this.items.length;n<i;n++,r++)e.call(t,this.items[n],r,this)},o.prototype.toArray=function(){return this.items.slice(this.offset)},o.prototype.values=function(){var e=this.items,t=this.offset;return new r(function(){if(t>=e.length)return{done:!0};var n=e[t];return t++,{value:n,done:!1}})},o.prototype.entries=function(){var e=this.items,t=this.offset,n=0;return new r(function(){if(t>=e.length)return{done:!0};var r=e[t];return t++,{value:[n++,r],done:!1}})},"undefined"!=typeof Symbol&&(o.prototype[Symbol.iterator]=o.prototype.values),o.prototype.toString=function(){return this.toArray().join(",")},o.prototype.toJSON=function(){return this.toArray()},o.prototype.inspect=function(){var e=this.toArray();return Object.defineProperty(e,"constructor",{value:o,enumerable:!1}),e},"undefined"!=typeof Symbol&&(o.prototype[Symbol.for("nodejs.util.inspect.custom")]=o.prototype.inspect),o.from=function(e){var t=new o;return i(e,function(e){t.enqueue(e)}),t},o.of=function(){return o.from(arguments)},e.exports=o},830:e=>{var t="undefined"!=typeof ArrayBuffer,n="undefined"!=typeof Symbol;function r(e,r){var i,o,s,a,u;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof r)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||t&&ArrayBuffer.isView(e)||"string"==typeof e||"[object Arguments]"===e.toString())for(s=0,a=e.length;s<a;s++)r(e[s],s);else if("function"!=typeof e.forEach)if(n&&Symbol.iterator in e&&"function"!=typeof e.next&&(e=e[Symbol.iterator]()),"function"!=typeof e.next)for(o in e)e.hasOwnProperty(o)&&r(e[o],o);else for(i=e,s=0;!0!==(u=i.next()).done;)r(u.value,s),s++;else e.forEach(r)}r.forEachWithNullKeys=function(e,r){var i,o,s,a,u;if(!e)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof r)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(e)||t&&ArrayBuffer.isView(e)||"string"==typeof e||"[object Arguments]"===e.toString())for(s=0,a=e.length;s<a;s++)r(e[s],null);else if(e instanceof Set)e.forEach(function(e){r(e,null)});else if("function"!=typeof e.forEach)if(n&&Symbol.iterator in e&&"function"!=typeof e.next&&(e=e[Symbol.iterator]()),"function"!=typeof e.next)for(o in e)e.hasOwnProperty(o)&&r(e[o],o);else for(i=e,s=0;!0!==(u=i.next()).done;)r(u.value,null),s++;else e.forEach(r)},e.exports=r},284:e=>{function t(e){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:e}),this.done=!1}t.prototype.next=function(){if(this.done)return{done:!0};var e=this._next();return e.done&&(this.done=!0),e},"undefined"!=typeof Symbol&&(t.prototype[Symbol.iterator]=function(){return this}),t.of=function(){var e=arguments,n=e.length,r=0;return new t(function(){return r>=n?{done:!0}:{done:!1,value:e[r++]}})},t.empty=function(){var e=new t(null);return e.done=!0,e},t.is=function(e){return e instanceof t||"object"==typeof e&&null!==e&&"function"==typeof e.next},e.exports=t},310:(e,t,n)=>{"use strict";var r=n(948);Object.defineProperty(t,"__esModule",{value:!0}),t.isMobile=function(){return void 0!==i.window.orientation},t.default=function(e){if(!e&&!(0,o.default)())return"Node";if((0,s.default)(e))return"Electron";var t="undefined"!=typeof navigator?navigator:{},n=e||t.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"};var i=n(151),o=r(n(602)),s=r(n(344))},151:(e,t,n)=>{"use strict";var r=n(948);Object.defineProperty(t,"__esModule",{value:!0}),t.console=t.process=t.document=t.global=t.window=t.self=void 0;var i=r(n(321)),o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&process};t.self=o.self||o.window||o.global,t.window=o.window||o.self||o.global,t.global=o.global||o.self||o.window,t.document=o.document||{},t.process=o.process||{};var s=console;t.console=s},761:(e,t,n)=>{"use strict";var r=n(948),i=n(321);Object.defineProperty(t,"CO",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(t,"jU",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"qs",{enumerable:!0,get:function(){return a.default}});var o=n(151),s=c(n(602)),a=c(n(310));function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}r(n(344))},602:(e,t,n)=>{"use strict";var r=n(948);Object.defineProperty(t,"__esModule",{value:!0}),t.default=s,t.isBrowserMainThread=function(){return s()&&"undefined"!=typeof document};var i=r(n(321)),o=r(n(344));function s(){return!("object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,o.default)()}},344:(e,t,n)=>{"use strict";var r=n(948);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("undefined"!=typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===(0,i.default)(process.versions)&&Boolean(process.versions.electron))return!0;var t="object"===("undefined"==typeof navigator?"undefined":(0,i.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=e||t;return!!(n&&n.indexOf("Electron")>=0)};var i=r(n(321))},991:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(180),t),i(n(103),t),i(n(965),t),i(n(595),t),i(n(417),t),i(n(451),t),i(n(735),t)},180:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlankNode=void 0,t.BlankNode=class{constructor(e){this.termType="BlankNode",this.value=e}equals(e){return!!e&&"BlankNode"===e.termType&&e.value===this.value}}},103:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataFactory=void 0;const r=n(180),i=n(965),o=n(595),s=n(417),a=n(451),u=n(735);let c=0;t.DataFactory=class{constructor(e){this.blankNodeCounter=0,this.blankNodePrefix=(e=e||{}).blankNodePrefix||`df_${c++}_`}namedNode(e){return new s.NamedNode(e)}blankNode(e){return new r.BlankNode(e||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(e,t){return new o.Literal(e,t)}variable(e){return new u.Variable(e)}defaultGraph(){return i.DefaultGraph.INSTANCE}quad(e,t,n,r){return new a.Quad(e,t,n,r||this.defaultGraph())}fromTerm(e){switch(e.termType){case"NamedNode":return this.namedNode(e.value);case"BlankNode":return this.blankNode(e.value);case"Literal":return e.language?this.literal(e.value,e.language):e.datatype.equals(o.Literal.XSD_STRING)?this.literal(e.value):this.literal(e.value,this.fromTerm(e.datatype));case"Variable":return this.variable(e.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(e.subject),this.fromTerm(e.predicate),this.fromTerm(e.object),this.fromTerm(e.graph))}}fromQuad(e){return this.fromTerm(e)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultGraph=void 0;class n{constructor(){this.termType="DefaultGraph",this.value=""}equals(e){return!!e&&"DefaultGraph"===e.termType}}t.DefaultGraph=n,n.INSTANCE=new n},595:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Literal=void 0;const r=n(417);class i{constructor(e,t){this.termType="Literal",this.value=e,"string"==typeof t?(this.language=t,this.datatype=i.RDF_LANGUAGE_STRING):t?(this.language="",this.datatype=t):(this.language="",this.datatype=i.XSD_STRING)}equals(e){return!!e&&"Literal"===e.termType&&e.value===this.value&&e.language===this.language&&e.datatype.equals(this.datatype)}}t.Literal=i,i.RDF_LANGUAGE_STRING=new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),i.XSD_STRING=new r.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NamedNode=void 0,t.NamedNode=class{constructor(e){this.termType="NamedNode",this.value=e}equals(e){return!!e&&"NamedNode"===e.termType&&e.value===this.value}}},451:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Quad=void 0,t.Quad=class{constructor(e,t,n,r){this.termType="Quad",this.value="",this.subject=e,this.predicate=t,this.object=n,this.graph=r}equals(e){return!!e&&("Quad"===e.termType||!e.termType)&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}}},735:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Variable=void 0,t.Variable=class{constructor(e){this.termType="Variable",this.value=e}equals(e){return!!e&&"Variable"===e.termType&&e.value===this.value}}},609:(e,t,n)=>{"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});const i=n(991),o=n(938),s=n(60);r(n(938)),r(n(60));const a=new i.DataFactory,u=new s.Translator;function c(e,t){return u.fromRdf(e,t)}u.registerHandler(new o.TypeHandlerString,o.TypeHandlerString.TYPES.map(e=>a.namedNode(e)),["string"]),u.registerHandler(new o.TypeHandlerBoolean,[o.TypeHandlerBoolean.TYPE].map(e=>a.namedNode(e)),["boolean"]),u.registerHandler(new o.TypeHandlerNumberDouble,o.TypeHandlerNumberDouble.TYPES.map(e=>a.namedNode(e)),["number"]),u.registerHandler(new o.TypeHandlerNumberInteger,o.TypeHandlerNumberInteger.TYPES.map(e=>a.namedNode(e)),["number"]),u.registerHandler(new o.TypeHandlerDate,o.TypeHandlerDate.TYPES.map(e=>a.namedNode(e)),["object"]),t.fromRdf=c,t.toRdf=function(e,t){return t&&"namedNode"in t&&(t={dataFactory:t}),(t=t||{})&&!t.dataFactory&&(t.dataFactory=a),u.toRdf(e,t)},t.getTermRaw=function(e,t){return"Literal"===e.termType?c(e,t):e.value},t.getSupportedRdfDatatypes=function(){return u.getSupportedRdfDatatypes()},t.getSupportedJavaScriptPrimitives=function(){return u.getSupportedJavaScriptPrimitives()}},60:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(e){throw new Error(`Invalid RDF ${e.datatype.value} value: '${e.value}'`)}registerHandler(e,t,n){for(const r of t)this.supportedRdfDatatypes.push(r),this.fromRdfHandlers[r.value]=e;for(const r of n){let t=this.toRdfHandlers[r];t||(this.toRdfHandlers[r]=t=[]),t.push(e)}}fromRdf(e,t){const n=this.fromRdfHandlers[e.datatype.value];return n?n.fromRdf(e,t):e.value}toRdf(e,t){const n=this.toRdfHandlers[typeof e];if(n)for(const r of n){const n=r.toRdf(e,t);if(n)return n}throw new Error(`Invalid JavaScript value: '${e}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(60);class i{fromRdf(e,t){switch(e.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return t&&r.Translator.incorrectRdfDataType(e),!1}toRdf(e,{datatype:t,dataFactory:n}){return n.literal(e?"true":"false",t||n.namedNode(i.TYPE))}}t.TypeHandlerBoolean=i,i.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},525:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(60);class i{fromRdf(e,t){switch(t&&!e.value.match(i.VALIDATORS[e.datatype.value.substr(33,e.datatype.value.length)])&&r.Translator.incorrectRdfDataType(e),e.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(e.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const t=e.value.split("-");return new Date(0,parseInt(t[0],10)-1,parseInt(t[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(e.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(e.value+"-01");default:return new Date(e.value)}}toRdf(e,{datatype:t,dataFactory:n}){if(t=t||n.namedNode(i.TYPES[0]),!(e instanceof Date))return null;const r=e;let o;switch(t.value){case"http://www.w3.org/2001/XMLSchema#gDay":o=String(r.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":o=r.getUTCMonth()+1+"-"+r.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":o=String(r.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":o=r.getUTCFullYear()+"-"+(r.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":o=r.toISOString().replace(/T.*$/,"");break;default:o=r.toISOString()}return n.literal(o,t)}}t.TypeHandlerDate=i,i.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],i.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(60);class i{fromRdf(e,t){const n=parseFloat(e.value);return t&&isNaN(n)&&r.Translator.incorrectRdfDataType(e),n}toRdf(e,{datatype:t,dataFactory:n}){return t=t||n.namedNode(i.TYPES[0]),isNaN(e)?n.literal("NaN",t):isFinite(e)?e%1==0?null:n.literal(e.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),t):n.literal(e>0?"INF":"-INF",t)}}t.TypeHandlerNumberDouble=i,i.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(60);class i{fromRdf(e,t){const n=parseInt(e.value,10);return t&&(isNaN(n)||e.value.indexOf(".")>=0)&&r.Translator.incorrectRdfDataType(e),n}toRdf(e,{datatype:t,dataFactory:n}){return n.literal(String(e),t||n.namedNode(e<=i.MAX_INT&&e>=i.MIN_INT?i.TYPES[0]:i.TYPES[1]))}}t.TypeHandlerNumberInteger=i,i.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],i.MAX_INT=2147483647,i.MIN_INT=-2147483648},608:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{fromRdf(e){return e.value}toRdf(e,{datatype:t,dataFactory:n}){return n.literal(e,t)}}t.TypeHandlerString=n,n.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:(e,t,n)=>{"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(727)),r(n(525)),r(n(554)),r(n(750)),r(n(608))},941:e=>{var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(D){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=Object.create((t&&t.prototype instanceof m?t:m).prototype),o=new O(r||[]);return i._invoke=function(e,t,n){var r=h;return function(i,o){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return C()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=A(s,n);if(a){if(a===g)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?p:d,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(e,n,o),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(D){return{type:"throw",arg:D}}}e.wrap=c;var h="suspendedStart",d="suspendedYield",f="executing",p="completed",g={};function m(){}function y(){}function v(){}var b={};b[o]=function(){return this};var _=Object.getPrototypeOf,w=_&&_(_(I([])));w&&w!==n&&r.call(w,o)&&(b=w);var x=v.prototype=m.prototype=Object.create(b);function E(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function S(e,t){function n(i,o,s,a){var u=l(e[i],e,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then(function(e){n("next",e,s,a)},function(e){n("throw",e,s,a)}):t.resolve(h).then(function(e){c.value=e,s(c)},function(e){return n("throw",e,s,a)})}a(u.arg)}var i;this._invoke=function(e,r){function o(){return new t(function(t,i){n(e,r,t,i)})}return i=i?i.then(o,o):o()}}function A(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function I(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:C}}function C(){return{value:t,done:!0}}return y.prototype=x.constructor=v,v.constructor=y,y.displayName=u(v,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,a,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},E(S.prototype),S.prototype[s]=function(){return this},e.AsyncIterator=S,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new S(c(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then(function(e){return e.done?e.value:s.next()})},E(x),u(x,a,"Generator"),x[o]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(n){Function("r","regeneratorRuntime = r")(t)}},481:(e,t,n)=>{"use strict";var r={};n.r(r),n.d(r,{decode:()=>aO,encode:()=>cO});var i={};n.r(i),n.d(i,{decode:()=>yO,encode:()=>vO});var o={};n.r(o),n.d(o,{decode:()=>wO,encode:()=>xO});var s={};function a(e){return"function"==typeof e}n.r(s),n.d(s,{decode:()=>SO,encode:()=>AO});let u=!1;const c={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else u&&console.log("RxJS: Back to a better error behavior. Thank you. <3");u=e},get useDeprecatedSynchronousErrorHandling(){return u}};function l(e){setTimeout(()=>{throw e},0)}const h={closed:!0,next(e){},error(e){if(c.useDeprecatedSynchronousErrorHandling)throw e;l(e)},complete(){}},d=Array.isArray||(e=>e&&"number"==typeof e.length);function f(e){return null!==e&&"object"==typeof e}const p=(()=>{function e(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e})();class g{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:n,_unsubscribe:r,_subscriptions:i}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof g)t.remove(this);else if(null!==t)for(let s=0;s<t.length;++s)t[s].remove(this);if(a(r)){n&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof p?m(o.errors):[o]}}if(d(i)){let t=-1,n=i.length;for(;++t<n;){const n=i[t];if(f(n))try{n.unsubscribe()}catch(o){e=e||[],o instanceof p?e=e.concat(m(o.errors)):e.push(o)}}}if(e)throw new p(e)}add(e){let t=e;if(!e)return g.EMPTY;switch(typeof e){case"function":t=new g(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof g)){const e=t;t=new g,t._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:n}=t;if(null===n)t._parentOrParents=this;else if(n instanceof g){if(n===this)return t;t._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return t;n.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}function m(e){return e.reduce((e,t)=>e.concat(t instanceof p?t.errors:t),[])}g.EMPTY=function(e){return e.closed=!0,e}(new g);const y="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class v extends g{constructor(e,t,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=h;break;case 1:if(!e){this.destination=h;break}if("object"==typeof e){e instanceof v?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new b(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new b(this,e,t,n)}}[y](){return this}static create(e,t,n){const r=new v(e,t,n);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class b extends v{constructor(e,t,n,r){let i;super(),this._parentSubscriber=e;let o=this;a(t)?i=t:t&&(i=t.next,n=t.error,r=t.complete,t!==h&&(o=Object.create(t),a(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=i,this._error=n,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;c.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:n}=c;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):l(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;l(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),c.useDeprecatedSynchronousErrorHandling)throw n;l(n)}}__tryOrSetError(e,t,n){if(!c.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return c.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(l(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const _="function"==typeof Symbol&&Symbol.observable||"@@observable";function w(e){return e}let x=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const n=new e;return n.source=this,n.operator=t,n}subscribe(e,t,n){const{operator:r}=this,i=function(e,t,n){if(e){if(e instanceof v)return e;if(e[y])return e[y]()}return e||t||n?new v(e,t,n):new v(h)}(e,t,n);if(i.add(r?r.call(i,this.source):this.source||c.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),c.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(e){try{return this._subscribe(e)}catch(t){c.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:n,isStopped:r}=e;if(t||r)return!1;e=n&&n instanceof v?n:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=E(t))((t,n)=>{let r;r=this.subscribe(t=>{try{e(t)}catch(i){n(i),r&&r.unsubscribe()}},n,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[_](){return this}pipe(...e){return 0===e.length?this:(0===(t=e).length?w:1===t.length?t[0]:function(e){return t.reduce((e,t)=>t(e),e)})(this);var t}toPromise(e){return new(e=E(e))((e,t)=>{let n;this.subscribe(e=>n=e,e=>t(e),()=>e(n))})}}return e.create=t=>new e(t),e})();function E(e){if(e||(e=c.Promise||Promise),!e)throw new Error("no Promise impl found");return e}const S=(()=>{function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e})();class A extends g{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}class k extends v{constructor(e){super(e),this.destination=e}}let T=(()=>{class e extends x{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[y](){return new k(this)}lift(e){const t=new O(this,this);return t.operator=e,t}next(e){if(this.closed)throw new S;if(!this.isStopped){const{observers:t}=this,n=t.length,r=t.slice();for(let i=0;i<n;i++)r[i].next(e)}}error(e){if(this.closed)throw new S;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:t}=this,n=t.length,r=t.slice();for(let i=0;i<n;i++)r[i].error(e);this.observers.length=0}complete(){if(this.closed)throw new S;this.isStopped=!0;const{observers:e}=this,t=e.length,n=e.slice();for(let r=0;r<t;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new S;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new S;return this.hasError?(e.error(this.thrownError),g.EMPTY):this.isStopped?(e.complete(),g.EMPTY):(this.observers.push(e),new A(this,e))}asObservable(){const e=new x;return e.source=this,e}}return e.create=(e,t)=>new O(e,t),e})();class O extends T{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):g.EMPTY}}function I(e){return e&&"function"==typeof e.schedule}function C(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new D(e,t))}}class D{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new j(e,this.project,this.thisArg))}}class j extends v{constructor(e,t,n){super(e),this.project=t,this.count=0,this.thisArg=n||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}const P=e=>t=>{for(let n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()},M="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",R=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function N(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}const L=e=>{if(e&&"function"==typeof e[_])return n=e,e=>{const t=n[_]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(R(e))return P(e);if(N(e))return(e=>t=>(e.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,l),t))(e);if(e&&"function"==typeof e[M])return t=e,e=>{const n=t[M]();for(;;){let t;try{t=n.next()}catch(r){return e.error(r),e}if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e};{const t=f(e)?"an invalid object":`'${e}'`;throw new TypeError(`You provided ${t} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var t,n};function F(e,t){return new x(n=>{const r=new g;let i=0;return r.add(t.schedule(function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()})),r})}function B(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[_]}(e))return function(e,t){return new x(n=>{const r=new g;return r.add(t.schedule(()=>{const i=e[_]();r.add(i.subscribe({next(e){r.add(t.schedule(()=>n.next(e)))},error(e){r.add(t.schedule(()=>n.error(e)))},complete(){r.add(t.schedule(()=>n.complete()))}}))})),r})}(e,t);if(N(e))return function(e,t){return new x(n=>{const r=new g;return r.add(t.schedule(()=>e.then(e=>{r.add(t.schedule(()=>{n.next(e),r.add(t.schedule(()=>n.complete()))}))},e=>{r.add(t.schedule(()=>n.error(e)))}))),r})}(e,t);if(R(e))return F(e,t);if(function(e){return e&&"function"==typeof e[M]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new x(n=>{const r=new g;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(t.schedule(()=>{i=e[M](),r.add(t.schedule(function(){if(n.closed)return;let e,t;try{const n=i.next();e=n.value,t=n.done}catch(r){return void n.error(r)}t?n.complete():(n.next(e),this.schedule())}))})),r})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof x?e:new x(L(e))}class z extends v{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class U extends v{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function V(e,t){if(t.closed)return;if(e instanceof x)return e.subscribe(t);let n;try{n=L(e)(t)}catch(r){t.error(r)}return n}function G(e,t,n=Number.POSITIVE_INFINITY){return"function"==typeof t?r=>r.pipe(G((n,r)=>B(e(n,r)).pipe(C((e,i)=>t(n,e,r,i))),n)):("number"==typeof t&&(n=t),t=>t.lift(new H(e,n)))}class H{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new q(e,this.project,this.concurrent))}}class q extends U{constructor(e,t,n=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new z(this),n=this.destination;n.add(t);const r=V(e,t);r!==t&&n.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function W(e,t){return t?F(e,t):new x(P(e))}function $(...e){let t=Number.POSITIVE_INFINITY,n=null,r=e[e.length-1];return I(r)?(n=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof r&&(t=e.pop()),null===n&&1===e.length&&e[0]instanceof x?e[0]:function(e=Number.POSITIVE_INFINITY){return G(w,e)}(t)(W(e,n))}function X(){return function(e){return e.lift(new K(e))}}class K{constructor(e){this.connectable=e}call(e,t){const{connectable:n}=this;n._refCount++;const r=new Z(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class Z extends v{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:n}=this,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}class Y extends x{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new g,e.add(this.source.subscribe(new J(this.getSubject(),this))),e.closed&&(this._connection=null,e=g.EMPTY)),e}refCount(){return X()(this)}}const Q=(()=>{const e=Y.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}})();class J extends k{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function ee(){return new T}function te(){return e=>{return X()((t=ee,function(e){let n;n="function"==typeof t?t:function(){return t};const r=Object.create(e,Q);return r.source=e,r.subjectFactory=n,r})(e));var t}}function ne(e){for(let t in e)if(e[t]===ne)return t;throw Error("Could not find renamed property on target object.")}function re(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function ie(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(ie).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function oe(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const se=ne({__forward_ref__:ne});function ae(e){return e.__forward_ref__=ae,e.toString=function(){return ie(this())},e}function ue(e){return ce(e)?e():e}function ce(e){return"function"==typeof e&&e.hasOwnProperty(se)&&e.__forward_ref__===ae}class le extends Error{constructor(e,t){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(e,t)),this.code=e}}function he(e){return"string"==typeof e?e:null==e?"":String(e)}function de(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():he(e)}function fe(e,t){const n=t?` in ${t}`:"";throw new le("201",`No provider for ${de(e)} found${n}`)}function pe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function ge(e){return{providers:e.providers||[],imports:e.imports||[]}}function me(e){return ye(e,be)||ye(e,we)}function ye(e,t){return e.hasOwnProperty(t)?e[t]:null}function ve(e){return e&&(e.hasOwnProperty(_e)||e.hasOwnProperty(xe))?e[_e]:null}const be=ne({"\u0275prov":ne}),_e=ne({"\u0275inj":ne}),we=ne({ngInjectableDef:ne}),xe=ne({ngInjectorDef:ne});var Ee=(()=>((Ee=Ee||{})[Ee.Default=0]="Default",Ee[Ee.Host=1]="Host",Ee[Ee.Self=2]="Self",Ee[Ee.SkipSelf=4]="SkipSelf",Ee[Ee.Optional=8]="Optional",Ee))();let Se;function Ae(e){const t=Se;return Se=e,t}function ke(e,t,n){const r=me(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Ee.Optional?null:void 0!==t?t:void fe(ie(e),"Injector")}function Te(e){return{toString:e}.toString()}var Oe=(()=>((Oe=Oe||{})[Oe.OnPush=0]="OnPush",Oe[Oe.Default=1]="Default",Oe))(),Ie=(()=>((Ie=Ie||{})[Ie.Emulated=0]="Emulated",Ie[Ie.None=2]="None",Ie[Ie.ShadowDom=3]="ShadowDom",Ie))();const Ce="undefined"!=typeof globalThis&&globalThis,De="undefined"!=typeof window&&window,je="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Pe="undefined"!=typeof global&&global,Me=Ce||Pe||De||je,Re={},Ne=[],Le=ne({"\u0275cmp":ne}),Fe=ne({"\u0275dir":ne}),Be=ne({"\u0275pipe":ne}),ze=ne({"\u0275mod":ne}),Ue=ne({"\u0275loc":ne}),Ve=ne({"\u0275fac":ne}),Ge=ne({__NG_ELEMENT_ID__:ne});let He=0;function qe(e){return Te(()=>{const t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Oe.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Ne,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ie.Emulated,id:"c",styles:e.styles||Ne,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,o=e.pipes;return n.id+=He++,n.inputs=Ze(e.inputs,t),n.outputs=Ze(e.outputs),i&&i.forEach(e=>e(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(We):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map($e):null,n})}function We(e){return Je(e)||function(e){return e[Fe]||null}(e)}function $e(e){return function(e){return e[Be]||null}(e)}const Xe={};function Ke(e){return Te(()=>{const t={type:e.type,bootstrap:e.bootstrap||Ne,declarations:e.declarations||Ne,imports:e.imports||Ne,exports:e.exports||Ne,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(Xe[e.id]=e.type),t})}function Ze(e,t){if(null==e)return Re;const n={};for(const r in e)if(e.hasOwnProperty(r)){let i=e[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,t&&(t[i]=o)}return n}const Ye=qe;function Qe(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function Je(e){return e[Le]||null}function et(e,t){const n=e[ze]||null;if(!n&&!0===t)throw new Error(`Type ${ie(e)} does not have '\u0275mod' property.`);return n}const tt=20,nt=10;function rt(e){return Array.isArray(e)&&"object"==typeof e[1]}function it(e){return Array.isArray(e)&&!0===e[1]}function ot(e){return 0!=(8&e.flags)}function st(e){return 2==(2&e.flags)}function at(e){return 1==(1&e.flags)}function ut(e){return null!==e.template}function ct(e,t){return e.hasOwnProperty(Ve)?e[Ve]:null}class lt{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function ht(){return dt}function dt(e){return e.type.prototype.ngOnChanges&&(e.setInput=pt),ft}function ft(){const e=gt(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===Re)e.previous=t;else for(let e in t)n[e]=t[e];e.current=null,this.ngOnChanges(t)}}function pt(e,t,n,r){const i=gt(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:Re,current:null}),o=i.current||(i.current={}),s=i.previous,a=this.declaredInputs[n],u=s[a];o[a]=new lt(u&&u.currentValue,t,s===Re),e[r]=t}function gt(e){return e.__ngSimpleChanges__||null}let mt;function yt(e){return!!e.listen}ht.ngInherit=!0;const vt={createRenderer:(e,t)=>void 0!==mt?mt:"undefined"!=typeof document?document:void 0};function bt(e){for(;Array.isArray(e);)e=e[0];return e}function _t(e,t){return bt(t[e])}function wt(e,t){return bt(t[e.index])}function xt(e,t){return e.data[t]}function Et(e,t){return e[t]}function St(e,t){const n=t[e];return rt(n)?n:n[0]}function At(e){return 4==(4&e[2])}function kt(e){return 128==(128&e[2])}function Tt(e,t){return null==t?null:e[t]}function Ot(e){e[18]=0}function It(e,t){e[5]+=t;let n=e,r=e[3];for(;null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}const Ct={lFrame:Jt(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Dt(){return Ct.bindingsEnabled}function jt(){return Ct.lFrame.lView}function Pt(){return Ct.lFrame.tView}function Mt(e){return Ct.lFrame.contextLView=e,e[8]}function Rt(){let e=Nt();for(;null!==e&&64===e.type;)e=e.parent;return e}function Nt(){return Ct.lFrame.currentTNode}function Lt(e,t){const n=Ct.lFrame;n.currentTNode=e,n.isParent=t}function Ft(){return Ct.lFrame.isParent}function Bt(){Ct.lFrame.isParent=!1}function zt(){return Ct.isInCheckNoChangesMode}function Ut(e){Ct.isInCheckNoChangesMode=e}function Vt(){const e=Ct.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Gt(){return Ct.lFrame.bindingIndex++}function Ht(e){const t=Ct.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function qt(e,t){const n=Ct.lFrame;n.bindingIndex=n.bindingRootIndex=e,Wt(t)}function Wt(e){Ct.lFrame.currentDirectiveIndex=e}function $t(){return Ct.lFrame.currentQueryIndex}function Xt(e){Ct.lFrame.currentQueryIndex=e}function Kt(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function Zt(e,t,n){if(n&Ee.SkipSelf){let r=t,i=e;for(;r=r.parent,!(null!==r||n&Ee.Host||(r=Kt(i),null===r)||(i=i[15],10&r.type)););if(null===r)return!1;t=r,e=i}const r=Ct.lFrame=Qt();return r.currentTNode=t,r.lView=e,!0}function Yt(e){const t=Qt(),n=e[1];Ct.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Qt(){const e=Ct.lFrame,t=null===e?null:e.child;return null===t?Jt(e):t}function Jt(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function en(){const e=Ct.lFrame;return Ct.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const tn=en;function nn(){const e=en();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function rn(){return Ct.lFrame.selectedIndex}function on(e){Ct.lFrame.selectedIndex=e}function sn(){const e=Ct.lFrame;return xt(e.tView,e.selectedIndex)}function an(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const t=e.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:o,ngAfterViewChecked:s,ngOnDestroy:a}=t;r&&(e.contentHooks||(e.contentHooks=[])).push(-n,r),i&&((e.contentHooks||(e.contentHooks=[])).push(n,i),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,i)),o&&(e.viewHooks||(e.viewHooks=[])).push(-n,o),s&&((e.viewHooks||(e.viewHooks=[])).push(n,s),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,s)),null!=a&&(e.destroyHooks||(e.destroyHooks=[])).push(n,a)}}function un(e,t,n){hn(e,t,3,n)}function cn(e,t,n,r){(3&e[2])===n&&hn(e,t,n,r)}function ln(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function hn(e,t,n,r){const i=null!=r?r:-1,o=t.length-1;let s=0;for(let a=void 0!==r?65535&e[18]:0;a<o;a++)if("number"==typeof t[a+1]){if(s=t[a],null!=r&&s>=r)break}else t[a]<0&&(e[18]+=65536),(s<i||-1==i)&&(dn(e,n,t,a),e[18]=(4294901760&e[18])+a+2),a++}function dn(e,t,n,r){const i=n[r]<0,o=n[r+1],s=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{o.call(s)}finally{}}}else try{o.call(s)}finally{}}const fn=-1;class pn{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function gn(e,t,n){const r=yt(e);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const s=n[i++],a=n[i++],u=n[i++];r?e.setAttribute(t,a,u,s):t.setAttributeNS(s,a,u)}else{const s=o,a=n[++i];yn(s)?r&&e.setProperty(t,s,a):r?e.setAttribute(t,s,a):t.setAttribute(s,a),i++}}return i}function mn(e){return 3===e||4===e||6===e}function yn(e){return 64===e.charCodeAt(0)}function vn(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const i=t[r];"number"==typeof i?n=i:0===n||bn(e,n,i,null,-1===n||2===n?t[++r]:null)}}return e}function bn(e,t,n,r,i){let o=0,s=e.length;if(-1===t)s=-1;else for(;o<e.length;){const n=e[o++];if("number"==typeof n){if(n===t){s=-1;break}if(n>t){s=o-1;break}}}for(;o<e.length;){const t=e[o];if("number"==typeof t)break;if(t===n){if(null===r)return void(null!==i&&(e[o+1]=i));if(r===e[o+1])return void(e[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==s&&(e.splice(s,0,t),o=s+1),e.splice(o++,0,n),null!==r&&e.splice(o++,0,r),null!==i&&e.splice(o++,0,i)}function _n(e){return e!==fn}function wn(e){return 32767&e}function xn(e,t){let n=e>>16,r=t;for(;n>0;)r=r[15],n--;return r}let En=!0;function Sn(e){const t=En;return En=e,t}let An=0;function kn(e,t){const n=On(e,t);if(-1!==n)return n;const r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,Tn(r.data,e),Tn(t,null),Tn(r.blueprint,null));const i=In(e,t),o=e.injectorIndex;if(_n(i)){const e=wn(i),n=xn(i,t),r=n[1].data;for(let i=0;i<8;i++)t[o+i]=n[e+i]|r[e+i]}return t[o+8]=i,o}function Tn(e,t){e.push(0,0,0,0,0,0,0,0,t)}function On(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function In(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,i=t;for(;null!==i;){const e=i[1],t=e.type;if(r=2===t?e.declTNode:1===t?i[6]:null,null===r)return fn;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return fn}function Cn(e,t,n){!function(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Ge)&&(r=n[Ge]),null==r&&(r=n[Ge]=An++);const i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function Dn(e,t,n){if(n&Ee.Optional)return e;fe(t,"NodeInjector")}function jn(e,t,n,r){if(n&Ee.Optional&&void 0===r&&(r=null),0==(n&(Ee.Self|Ee.Host))){const i=e[9],o=Ae(void 0);try{return i?i.get(t,r,n&Ee.Optional):ke(t,r,n&Ee.Optional)}finally{Ae(o)}}return Dn(r,t,n)}function Pn(e,t,n,r=Ee.Default,i){if(null!==e){const o=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(Ge)?e[Ge]:void 0;return"number"==typeof t?t>=0?255&t:Rn:t}(n);if("function"==typeof o){if(!Zt(t,e,r))return r&Ee.Host?Dn(i,n,r):jn(t,n,r,i);try{const e=o(r);if(null!=e||r&Ee.Optional)return e;fe(n)}finally{tn()}}else if("number"==typeof o){let i=null,s=On(e,t),a=fn,u=r&Ee.Host?t[16][6]:null;for((-1===s||r&Ee.SkipSelf)&&(a=-1===s?In(e,t):t[s+8],a!==fn&&zn(r,!1)?(i=t[1],s=wn(a),t=xn(a,t)):s=-1);-1!==s;){const e=t[1];if(Bn(o,s,e.data)){const e=Nn(s,t,n,i,r,u);if(e!==Mn)return e}a=t[s+8],a!==fn&&zn(r,t[1].data[s+8]===u)&&Bn(o,s,t)?(i=e,s=wn(a),t=xn(a,t)):s=-1}}}return jn(t,n,r,i)}const Mn={};function Rn(){return new Un(Rt(),jt())}function Nn(e,t,n,r,i,o){const s=t[1],a=s.data[e+8],u=Ln(a,s,n,null==r?st(a)&&En:r!=s&&0!=(3&a.type),i&Ee.Host&&o===a);return null!==u?Fn(t,s,u,a):Mn}function Ln(e,t,n,r,i){const o=e.providerIndexes,s=t.data,a=1048575&o,u=e.directiveStart,c=o>>20,l=i?a+c:e.directiveEnd;for(let h=r?a:a+c;h<l;h++){const e=s[h];if(h<u&&n===e||h>=u&&e.type===n)return h}if(i){const e=s[u];if(e&&ut(e)&&e.type===n)return u}return null}function Fn(e,t,n,r){let i=e[n];const o=t.data;if(i instanceof pn){const s=i;s.resolving&&function(e,t){throw new le("200",`Circular dependency in DI detected for ${e}`)}(de(o[n]));const a=Sn(s.canSeeViewProviders);s.resolving=!0;const u=s.injectImpl?Ae(s.injectImpl):null;Zt(e,r,Ee.Default);try{i=e[n]=s.factory(void 0,o,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=t.type.prototype;if(r){const r=dt(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,o[n],t)}finally{null!==u&&Ae(u),Sn(a),s.resolving=!1,tn()}}return i}function Bn(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function zn(e,t){return!(e&Ee.Self||e&Ee.Host&&t)}class Un{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Pn(this._tNode,this._lView,e,void 0,t)}}function Vn(e){return Te(()=>{const t=e.prototype.constructor,n=t[Ve]||Gn(t),r=Object.prototype;let i=Object.getPrototypeOf(e.prototype).constructor;for(;i&&i!==r;){const e=i[Ve]||Gn(i);if(e&&e!==n)return e;i=Object.getPrototypeOf(i)}return e=>new e})}function Gn(e){return ce(e)?()=>{const t=Gn(ue(e));return t&&t()}:ct(e)}const Hn="__parameters__";function qn(e,t,n){return Te(()=>{const r=function(e){return function(...t){if(e){const n=e(...t);for(const e in n)this[e]=n[e]}}}(t);function i(...e){if(this instanceof i)return r.apply(this,e),this;const t=new i(...e);return n.annotation=t,n;function n(e,n,r){const i=e.hasOwnProperty(Hn)?e[Hn]:Object.defineProperty(e,Hn,{value:[]})[Hn];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(t),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}class Wn{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function $n(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),$n(r,t)):t!==e&&t.push(r)}return t}function Xn(e,t){e.forEach(e=>Array.isArray(e)?Xn(e,t):t(e))}function Kn(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Zn(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function Yn(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}function Qn(e,t,n){let r=er(e,t);return r>=0?e[1|r]=n:(r=~r,function(e,t,n,r){let i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r,t,n)),r}function Jn(e,t){const n=er(e,t);if(n>=0)return e[1|n]}function er(e,t){return function(e,t,n){let r=0,i=e.length>>1;for(;i!==r;){const n=r+(i-r>>1),o=e[n<<1];if(t===o)return n<<1;o>t?i=n:r=n+1}return~(i<<1)}(e,t)}const tr={},nr=/\n/gm,rr="__source",ir=ne({provide:String,useValue:ne});let or;function sr(e){const t=or;return or=e,t}function ar(e,t=Ee.Default){if(void 0===or)throw new Error("inject() must be called from an injection context");return null===or?ke(e,void 0,t):or.get(e,t&Ee.Optional?null:void 0,t)}function ur(e,t=Ee.Default){return(Se||ar)(ue(e),t)}const cr=ur;function lr(e){const t=[];for(let n=0;n<e.length;n++){const r=ue(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let e,n=Ee.Default;for(let t=0;t<r.length;t++){const i=r[t],o=i.__NG_DI_FLAG__;"number"==typeof o?-1===o?e=i.token:n|=o:e=i}t.push(ur(e,n))}else t.push(ur(r))}return t}function hr(e,t){return e.__NG_DI_FLAG__=t,e.prototype.__NG_DI_FLAG__=t,e}const dr=hr(qn("Inject",e=>({token:e})),-1),fr=hr(qn("Optional"),8),pr=hr(qn("SkipSelf"),4);function gr(e){return e instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?e.changingThisBreaksApplicationSecurity:e}function mr(e,t){e.__ngContext__=t}function yr(e){const t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function vr(e){return e.ngOriginalError}function br(e,...t){e.error(...t)}class _r{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e.ngErrorLogger||br}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(e){return e?function(e){return e.ngDebugContext}(e)||this._findContext(vr(e)):null}_findOriginalError(e){let t=vr(e);for(;t&&vr(t);)t=vr(t);return t}}const wr=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Me))();function xr(e){return e instanceof Function?e():e}var Er=(()=>((Er=Er||{})[Er.Important=1]="Important",Er[Er.DashCase=2]="DashCase",Er))();function Sr(e,t){return(void 0)(e,t)}function Ar(e){const t=e[3];return it(t)?t[3]:t}function kr(e){return Or(e[13])}function Tr(e){return Or(e[4])}function Or(e){for(;null!==e&&!it(e);)e=e[4];return e}function Ir(e,t,n,r,i){if(null!=r){let o,s=!1;it(r)?o=r:rt(r)&&(s=!0,r=r[0]);const a=bt(r);0===e&&null!==n?null==i?Lr(t,n,a):Nr(t,n,a,i||null,!0):1===e&&null!==n?Nr(t,n,a,i||null,!0):2===e?function(e,t,n){const r=Br(e,t);r&&function(e,t,n,r){yt(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}(t,a,s):3===e&&t.destroyNode(a),null!=o&&function(e,t,n,r,i){const o=n[7];o!==bt(n)&&Ir(t,e,r,o,i);for(let s=nt;s<n.length;s++){const i=n[s];$r(i[1],i,e,t,r,o)}}(t,e,o,n,i)}}function Cr(e,t,n){return yt(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Dr(e,t){const n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,It(i,-1)),n.splice(r,1)}function jr(e,t){if(e.length<=nt)return;const n=nt+t,r=e[n];if(r){const o=r[17];null!==o&&o!==e&&Dr(o,r),t>0&&(e[n-1][4]=r[4]);const s=Zn(e,nt+t);$r(r[1],i=r,i[11],2,null,null),i[0]=null,i[6]=null;const a=s[19];null!==a&&a.detachView(s[1]),r[3]=null,r[4]=null,r[2]&=-129}var i;return r}function Pr(e,t){if(!(256&t[2])){const n=t[11];yt(n)&&n.destroyNode&&$r(e,t,n,3,null,null),function(e){let t=e[13];if(!t)return Mr(e[1],e);for(;t;){let n=null;if(rt(t))n=t[13];else{const e=t[10];e&&(n=e)}if(!n){for(;t&&!t[4]&&t!==e;)rt(t)&&Mr(t[1],t),t=t[3];null===t&&(t=e),rt(t)&&Mr(t[1],t),n=t&&t[4]}t=n}}(t)}}function Mr(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const e=t[n[r]];if(!(e instanceof pn)){const t=n[r+1];if(Array.isArray(t))for(let n=0;n<t.length;n+=2){const r=e[t[n]],i=t[n+1];try{i.call(r)}finally{}}else try{t.call(e)}finally{}}}}(e,t),function(e,t){const n=e.cleanup,r=t[7];let i=-1;if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const e=n[o+1],s="function"==typeof e?e(t):bt(t[e]),a=r[i=n[o+2]],u=n[o+3];"boolean"==typeof u?s.removeEventListener(n[o],a,u):u>=0?r[i=u]():r[i=-u].unsubscribe(),o+=2}else{const e=r[i=n[o+1]];n[o].call(e)}if(null!==r){for(let e=i+1;e<r.length;e++)(0,r[e])();t[7]=null}}(e,t),1===t[1].type&&yt(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&it(t[3])){n!==t[3]&&Dr(n,t);const r=t[19];null!==r&&r.detachView(e)}}}function Rr(e,t,n){return function(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){const t=e.data[r.directiveStart].encapsulation;if(t===Ie.None||t===Ie.Emulated)return null}return wt(r,n)}(e,t.parent,n)}function Nr(e,t,n,r,i){yt(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function Lr(e,t,n){yt(e)?e.appendChild(t,n):t.appendChild(n)}function Fr(e,t,n,r,i){null!==r?Nr(e,t,n,r,i):Lr(e,t,n)}function Br(e,t){return yt(e)?e.parentNode(t):t.parentNode}function zr(e,t,n){return Ur(e,t,n)}let Ur=function(e,t,n){return 40&e.type?wt(e,n):null};function Vr(e,t,n,r){const i=Rr(e,r,t),o=t[11],s=zr(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(let a=0;a<n.length;a++)Fr(o,i,n[a],s,!1);else Fr(o,i,n,s,!1)}function Gr(e,t){if(null!==t){const n=t.type;if(3&n)return wt(t,e);if(4&n)return qr(-1,e[t.index]);if(8&n){const n=t.child;if(null!==n)return Gr(e,n);{const n=e[t.index];return it(n)?qr(-1,n):bt(n)}}if(32&n)return Sr(t,e)()||bt(e[t.index]);{const n=Hr(e,t);return null!==n?Array.isArray(n)?n[0]:Gr(Ar(e[16]),n):Gr(e,t.next)}}return null}function Hr(e,t){return null!==t?e[16][6].projection[t.projection]:null}function qr(e,t){const n=nt+e+1;if(n<t.length){const e=t[n],r=e[1].firstChild;if(null!==r)return Gr(e,r)}return t[7]}function Wr(e,t,n,r,i,o,s){for(;null!=n;){const a=r[n.index],u=n.type;if(s&&0===t&&(a&&mr(bt(a),r),n.flags|=4),64!=(64&n.flags))if(8&u)Wr(e,t,n.child,r,i,o,!1),Ir(t,e,i,a,o);else if(32&u){const s=Sr(n,r);let u;for(;u=s();)Ir(t,e,i,u,o);Ir(t,e,i,a,o)}else 16&u?Xr(e,t,r,n,i,o):Ir(t,e,i,a,o);n=s?n.projectionNext:n.next}}function $r(e,t,n,r,i,o){Wr(n,r,e.firstChild,t,i,o,!1)}function Xr(e,t,n,r,i,o){const s=n[16],a=s[6].projection[r.projection];if(Array.isArray(a))for(let u=0;u<a.length;u++)Ir(t,e,i,a[u],o);else Wr(e,t,a,s[3],i,o,!0)}function Kr(e,t,n){yt(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function Zr(e,t,n){yt(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function Yr(e,t,n){let r=e.length;for(;;){const i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){const n=t.length;if(i+n===r||e.charCodeAt(i+n)<=32)return i}n=i+1}}const Qr="ng-template";function Jr(e,t,n){let r=0;for(;r<e.length;){let i=e[r++];if(n&&"class"===i){if(i=e[r],-1!==Yr(i.toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function ei(e){return 4===e.type&&e.value!==Qr}function ti(e,t,n){return t===(4!==e.type||n?e.value:Qr)}function ni(e,t,n){let r=4;const i=e.attrs||[],o=function(e){for(let t=0;t<e.length;t++)if(mn(e[t]))return t;return e.length}(i);let s=!1;for(let a=0;a<t.length;a++){const u=t[a];if("number"!=typeof u){if(!s)if(4&r){if(r=2|1&r,""!==u&&!ti(e,u,n)||""===u&&1===t.length){if(ri(r))return!1;s=!0}}else{const c=8&r?u:t[++a];if(8&r&&null!==e.attrs){if(!Jr(e.attrs,c,n)){if(ri(r))return!1;s=!0}continue}const l=ii(8&r?"class":u,i,ei(e),n);if(-1===l){if(ri(r))return!1;s=!0;continue}if(""!==c){let e;e=l>o?"":i[l+1].toLowerCase();const t=8&r?e:null;if(t&&-1!==Yr(t,c,0)||2&r&&c!==e){if(ri(r))return!1;s=!0}}}}else{if(!s&&!ri(r)&&!ri(u))return!1;if(s&&ri(u))continue;s=!1,r=u|1&r}}return ri(r)||s}function ri(e){return 0==(1&e)}function ii(e,t,n,r){if(null===t)return-1;let i=0;if(r||!n){let n=!1;for(;i<t.length;){const r=t[i];if(r===e)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let e=t[++i];for(;"string"==typeof e;)e=t[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function oi(e,t,n=!1){for(let r=0;r<t.length;r++)if(ni(e,t[r],n))return!0;return!1}function si(e,t){return e?":not("+t.trim()+")":t}function ai(e){let t=e[0],n=1,r=2,i="",o=!1;for(;n<e.length;){let s=e[n];if("string"==typeof s)if(2&r){const t=e[++n];i+="["+s+(t.length>0?'="'+t+'"':"")+"]"}else 8&r?i+="."+s:4&r&&(i+=" "+s);else""===i||ri(s)||(t+=si(o,i),i=""),r=s,o=o||!ri(r);n++}return""!==i&&(t+=si(o,i)),t}const ui={};function ci(e){li(Pt(),jt(),rn()+e,zt())}function li(e,t,n,r){if(!r)if(3==(3&t[2])){const r=e.preOrderCheckHooks;null!==r&&un(t,r,n)}else{const r=e.preOrderHooks;null!==r&&cn(t,r,0,n)}on(n)}function hi(e,t){return e<<17|t<<2}function di(e){return e>>17&32767}function fi(e){return 2|e}function pi(e){return(131068&e)>>2}function gi(e,t){return-131069&e|t<<2}function mi(e){return 1|e}function yi(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const n=e.data[o];Xt(i),n.contentQueries(2,t[o],o)}}}function vi(e,t,n,r,i,o,s,a,u,c){const l=t.blueprint.slice();return l[0]=i,l[2]=140|r,Ot(l),l[3]=l[15]=e,l[8]=n,l[10]=s||e&&e[10],l[11]=a||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=o,l[16]=2==t.type?e[16]:l,l}function bi(e,t,n,r,i){let o=e.data[t];if(null===o)o=function(e,t,n,r,i){const o=Nt(),s=Ft(),a=e.data[t]=function(e,t,n,r,i,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=a),null!==o&&(s?null==o.child&&null!==a.parent&&(o.child=a):null===o.next&&(o.next=a)),a}(e,t,n,r,i),Ct.lFrame.inI18n&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=i;const e=function(){const e=Ct.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();o.injectorIndex=null===e?-1:e.injectorIndex}return Lt(o,!0),o}function _i(e,t,n,r){if(0===n)return-1;const i=t.length;for(let o=0;o<n;o++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function wi(e,t,n){Yt(t);try{const r=e.viewQuery;null!==r&&Zi(1,r,n);const i=e.template;null!==i&&Si(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&yi(e,t),e.staticViewQueries&&Zi(2,e.viewQuery,n);const o=e.components;null!==o&&function(e,t){for(let n=0;n<t.length;n++)qi(e,t[n])}(t,o)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),r}finally{t[2]&=-5,nn()}}function xi(e,t,n,r){const i=t[2];if(256==(256&i))return;Yt(t);const o=zt();try{Ot(t),Ct.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&Si(e,t,n,2,r);const s=3==(3&i);if(!o)if(s){const n=e.preOrderCheckHooks;null!==n&&un(t,n,null)}else{const n=e.preOrderHooks;null!==n&&cn(t,n,0,null),ln(t,0)}if(function(e){for(let t=kr(e);null!==t;t=Tr(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const n=e[t],r=n[3];0==(1024&n[2])&&It(r,1),n[2]|=1024}}}(t),function(e){for(let t=kr(e);null!==t;t=Tr(t))for(let e=nt;e<t.length;e++){const n=t[e],r=n[1];kt(n)&&xi(r,n,r.template,n[8])}}(t),null!==e.contentQueries&&yi(e,t),!o)if(s){const n=e.contentCheckHooks;null!==n&&un(t,n)}else{const n=e.contentHooks;null!==n&&cn(t,n,1),ln(t,1)}!function(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let e=0;e<n.length;e++){const r=n[e];if(r<0)on(~r);else{const i=r,o=n[++e],s=n[++e];qt(o,i),s(2,t[i])}}}finally{on(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let n=0;n<t.length;n++)Gi(e,t[n])}(t,a);const u=e.viewQuery;if(null!==u&&Zi(2,u,r),!o)if(s){const n=e.viewCheckHooks;null!==n&&un(t,n)}else{const n=e.viewHooks;null!==n&&cn(t,n,2),ln(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),o||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,It(t[3],-1))}finally{nn()}}function Ei(e,t,n,r){const i=t[10],o=!zt(),s=At(t);try{o&&!s&&i.begin&&i.begin(),s&&wi(e,t,r),xi(e,t,n,r)}finally{o&&!s&&i.end&&i.end()}}function Si(e,t,n,r,i){const o=rn(),s=2&r;try{on(-1),s&&t.length>tt&&li(e,t,tt,zt()),n(r,i)}finally{on(o)}}function Ai(e,t,n){Dt()&&(function(e,t,n,r){const i=n.directiveStart,o=n.directiveEnd;e.firstCreatePass||kn(n,t),mr(r,t);const s=n.initialInputs;for(let a=i;a<o;a++){const r=e.data[a],o=ut(r);o&&Bi(t,n,r);const u=Fn(t,e,a,n);mr(u,t),null!==s&&zi(0,a-i,u,r,0,s),o&&(St(n.index,t)[8]=u)}}(e,t,n,wt(n,t)),128==(128&n.flags)&&function(e,t,n){const r=n.directiveStart,i=n.directiveEnd,o=n.index,s=Ct.lFrame.currentDirectiveIndex;try{on(o);for(let n=r;n<i;n++){const r=e.data[n],i=t[n];Wt(n),null===r.hostBindings&&0===r.hostVars&&null===r.hostAttrs||Mi(r,i)}}finally{on(-1),Wt(s)}}(e,t,n))}function ki(e,t,n=wt){const r=t.localNames;if(null!==r){let i=t.index+1;for(let o=0;o<r.length;o+=2){const s=r[o+1],a=-1===s?n(t,e):e[s];e[i++]=a}}}function Ti(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Oi(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Oi(e,t,n,r,i,o,s,a,u,c){const l=tt+r,h=l+i,d=function(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:ui);return n}(l,h),f="function"==typeof c?c():c;return d[1]={type:e,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:u,consts:f,incompleteFirstPass:!1}}function Ii(e,t,n,r){const i=Qi(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&Ji(e).push(r,i.length-1))}function Ci(e,t,n){for(let r in e)if(e.hasOwnProperty(r)){const i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function Di(e,t,n,r,i,o,s,a){const u=wt(t,n);let c,l=t.inputs;var h;!a&&null!=l&&(c=l[r])?(to(e,n,c,r,i),st(t)&&function(e,t){const n=St(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r="class"===(h=r)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,i=null!=s?s(i,t.value||"",r):i,yt(o)?o.setProperty(u,r,i):yn(r)||(u.setProperty?u.setProperty(r,i):u[r]=i))}function ji(e,t,n,r){let i=!1;if(Dt()){const o=function(e,t,n){const r=e.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const s=r[o];oi(n,s.selectors,!1)&&(i||(i=[]),Cn(kn(n,t),e,s.type),ut(s)?(Ri(e,n),i.unshift(s)):i.push(s))}return i}(e,t,n),s=null===r?null:{"":-1};if(null!==o){i=!0,Li(n,e.data.length,o.length);for(let e=0;e<o.length;e++){const t=o[e];t.providersResolver&&t.providersResolver(t)}let r=!1,a=!1,u=_i(e,t,o.length,null);for(let i=0;i<o.length;i++){const c=o[i];n.mergedAttrs=vn(n.mergedAttrs,c.hostAttrs),Fi(e,n,t,u,c),Ni(u,c,s),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const l=c.type.prototype;!r&&(l.ngOnChanges||l.ngOnInit||l.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),r=!0),a||!l.ngOnChanges&&!l.ngDoCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),a=!0),u++}!function(e,t){const n=t.directiveEnd,r=e.data,i=t.attrs,o=[];let s=null,a=null;for(let u=t.directiveStart;u<n;u++){const e=r[u],n=e.inputs,c=null===i||ei(t)?null:Ui(n,i);o.push(c),s=Ci(n,u,s),a=Ci(e.outputs,u,a)}null!==s&&(s.hasOwnProperty("class")&&(t.flags|=16),s.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=s,t.outputs=a}(e,n)}s&&function(e,t,n){if(t){const r=e.localNames=[];for(let e=0;e<t.length;e+=2){const i=n[t[e+1]];if(null==i)throw new le("301",`Export of name '${t[e+1]}' not found!`);r.push(t[e],i)}}}(n,r,s)}return n.mergedAttrs=vn(n.mergedAttrs,n.attrs),i}function Pi(e,t,n,r,i,o){const s=o.hostBindings;if(s){let n=e.hostBindingOpCodes;null===n&&(n=e.hostBindingOpCodes=[]);const o=~t.index;(function(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(n)!=o&&n.push(o),n.push(r,i,s)}}function Mi(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Ri(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Ni(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;ut(t)&&(n[""]=e)}}function Li(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Fi(e,t,n,r,i){e.data[r]=i;const o=i.factory||(i.factory=ct(i.type)),s=new pn(o,ut(i),null);e.blueprint[r]=s,n[r]=s,Pi(e,t,0,r,_i(e,n,i.hostVars,ui),i)}function Bi(e,t,n){const r=wt(t,e),i=Ti(n),o=e[10],s=Wi(e,vi(e,i,null,n.onPush?64:16,r,t,o,o.createRenderer(r,n),null,null));e[t.index]=s}function zi(e,t,n,r,i,o){const s=o[t];if(null!==s){const e=r.setInput;for(let t=0;t<s.length;){const i=s[t++],o=s[t++],a=s[t++];null!==e?r.setInput(n,a,i,o):n[o]=a}}}function Ui(e,t){let n=null,r=0;for(;r<t.length;){const i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function Vi(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function Gi(e,t){const n=St(t,e);if(kt(n)){const e=n[1];80&n[2]?xi(e,n,e.template,n[8]):n[5]>0&&Hi(n)}}function Hi(e){for(let n=kr(e);null!==n;n=Tr(n))for(let e=nt;e<n.length;e++){const t=n[e];if(1024&t[2]){const e=t[1];xi(e,t,e.template,t[8])}else t[5]>0&&Hi(t)}const t=e[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=St(t[n],e);kt(r)&&r[5]>0&&Hi(r)}}function qi(e,t){const n=St(t,e),r=n[1];!function(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n),wi(r,n,n[8])}function Wi(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function $i(e){for(;e;){e[2]|=64;const t=Ar(e);if(0!=(512&e[2])&&!t)return e;e=t}return null}function Xi(e,t,n){const r=t[10];r.begin&&r.begin();try{xi(e,t,e.template,n)}catch(i){throw eo(t,i),i}finally{r.end&&r.end()}}function Ki(e){!function(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],r=yr(n),i=r[1];Ei(i,r,i.template,n)}}(e[8])}function Zi(e,t,n){Xt(0),t(e,n)}const Yi=(()=>Promise.resolve(null))();function Qi(e){return e[7]||(e[7]=[])}function Ji(e){return e.cleanup||(e.cleanup=[])}function eo(e,t){const n=e[9],r=n?n.get(_r,null):null;r&&r.handleError(t)}function to(e,t,n,r,i){for(let o=0;o<n.length;){const s=n[o++],a=n[o++],u=t[s],c=e.data[s];null!==c.setInput?c.setInput(u,i,r,a):u[a]=i}}function no(e,t,n){let r=n?e.styles:null,i=n?e.classes:null,o=0;if(null!==t)for(let s=0;s<t.length;s++){const e=t[s];"number"==typeof e?o=e:1==o?i=oe(i,e):2==o&&(r=oe(r,e+": "+t[++s]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}const ro=new Wn("INJECTOR",-1);class io{get(e,t=tr){if(t===tr){const t=new Error(`NullInjectorError: No provider for ${ie(e)}!`);throw t.name="NullInjectorError",t}return t}}const oo=new Wn("Set Injector scope."),so={},ao={};let uo;function co(){return void 0===uo&&(uo=new io),uo}function lo(e,t=null,n=null,r){return new ho(e,n,t||co(),r)}class ho{constructor(e,t,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];t&&Xn(t,n=>this.processProvider(n,e,t)),Xn([e],e=>this.processInjectorType(e,[],i)),this.records.set(ro,go(void 0,this));const o=this.records.get(oo);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:ie(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=tr,n=Ee.Default){this.assertNotDestroyed();const r=sr(this),i=Ae(void 0);try{if(!(n&Ee.SkipSelf)){let t=this.records.get(e);if(void 0===t){const n=("function"==typeof(o=e)||"object"==typeof o&&o instanceof Wn)&&me(e);t=n&&this.injectableDefInScope(n)?go(fo(e),so):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(n&Ee.Self?co():this.parent).get(e,t=n&Ee.Optional&&t===tr?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(ie(e)),r)throw s;return function(e,t,n,r){const i=e.ngTempTokenPath;throw t[rr]&&i.unshift(t[rr]),e.message=function(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let i=ie(t);if(Array.isArray(t))i=t.map(ie).join(" -> ");else if("object"==typeof t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e.push(n+":"+("string"==typeof r?JSON.stringify(r):ie(r)))}i=`{${e.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${e.replace(nr,"\n  ")}`}("\n"+e.message,i,n,r),e.ngTokenPath=i,e.ngTempTokenPath=null,e}(s,e,"R3InjectorError",this.source)}throw s}finally{Ae(i),sr(r)}var o}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,n)=>e.push(ie(n))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,n){if(!(e=ue(e)))return!1;let r=ve(e);const i=null==r&&e.ngModule||void 0,o=void 0===i?e:i,s=-1!==n.indexOf(o);if(void 0!==i&&(r=ve(i)),null==r)return!1;if(null!=r.imports&&!s){let e;n.push(o);try{Xn(r.imports,r=>{this.processInjectorType(r,t,n)&&(void 0===e&&(e=[]),e.push(r))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:n,providers:r}=e[t];Xn(r,e=>this.processProvider(e,n,r||Ne))}}this.injectorDefTypes.add(o);const a=ct(o)||(()=>new o);this.records.set(o,go(a,so));const u=r.providers;if(null!=u&&!s){const t=e;Xn(u,e=>this.processProvider(e,t,u))}return void 0!==i&&void 0!==e.providers}processProvider(e,t,n){let r=yo(e=ue(e))?e:ue(e&&e.provide);const i=function(e,t,n){return mo(e)?go(void 0,e.useValue):go(po(e),so)}(e);if(yo(e)||!0!==e.multi)this.records.get(r);else{let t=this.records.get(r);t||(t=go(void 0,so,!0),t.factory=()=>lr(t.multi),this.records.set(r,t)),r=e,t.multi.push(e)}this.records.set(r,i)}hydrate(e,t){var n;return t.value===so&&(t.value=ao,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ue(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function fo(e){const t=me(e),n=null!==t?t.factory:ct(e);if(null!==n)return n;if(e instanceof Wn)throw new Error(`Token ${ie(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const n=Yn(t,"?");throw new Error(`Can't resolve all parameters for ${ie(e)}: (${n.join(", ")}).`)}const n=function(e){const t=e&&(e[be]||e[we]);if(t){const n=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Error("unreachable")}function po(e,t,n){let r;if(yo(e)){const t=ue(e);return ct(t)||fo(t)}if(mo(e))r=()=>ue(e.useValue);else if((i=e)&&i.useFactory)r=()=>e.useFactory(...lr(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))r=()=>ur(ue(e.useExisting));else{const t=ue(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return ct(t)||fo(t);r=()=>new t(...lr(e.deps))}var i;return r}function go(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function mo(e){return null!==e&&"object"==typeof e&&ir in e}function yo(e){return"function"==typeof e}const vo=function(e,t,n){return function(e,t=null,n=null,r){const i=lo(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)};class bo{static create(e,t){return Array.isArray(e)?vo(e,t,""):vo(e.providers,e.parent,e.name||"")}}function _o(e,t){an(yr(e)[1],Rt())}function wo(e){let t=Object.getPrototypeOf(e.type.prototype).constructor,n=!0;const r=[e];for(;t;){let i;if(ut(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);const t=e;t.inputs=xo(e.inputs),t.declaredInputs=xo(e.declaredInputs),t.outputs=xo(e.outputs);const n=i.hostBindings;n&&Ao(e,n);const o=i.viewQuery,s=i.contentQueries;if(o&&Eo(e,o),s&&So(e,s),re(e.inputs,i.inputs),re(e.declaredInputs,i.declaredInputs),re(e.outputs,i.outputs),ut(i)&&i.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(i.data.animation)}}const t=i.features;if(t)for(let r=0;r<t.length;r++){const i=t[r];i&&i.ngInherit&&i(e),i===wo&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,n=null;for(let r=e.length-1;r>=0;r--){const i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=vn(i.hostAttrs,n=vn(n,i.hostAttrs))}}(r)}function xo(e){return e===Re?{}:e===Ne?[]:e}function Eo(e,t){const n=e.viewQuery;e.viewQuery=n?(e,r)=>{t(e,r),n(e,r)}:t}function So(e,t){const n=e.contentQueries;e.contentQueries=n?(e,r,i)=>{t(e,r,i),n(e,r,i)}:t}function Ao(e,t){const n=e.hostBindings;e.hostBindings=n?(e,r)=>{t(e,r),n(e,r)}:t}bo.THROW_IF_NOT_FOUND=tr,bo.NULL=new io,bo.\u0275prov=pe({token:bo,providedIn:"any",factory:()=>ur(ro)}),bo.__NG_ELEMENT_ID__=-1;let ko=null;function To(){if(!ko){const e=Me.Symbol;if(e&&e.iterator)ko=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(ko=n)}}}return ko}class Oo{constructor(e){this.wrapped=e}static wrap(e){return new Oo(e)}static unwrap(e){return Oo.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Oo}}function Io(e){return!!Co(e)&&(Array.isArray(e)||!(e instanceof Map)&&To()in e)}function Co(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Do(e,t,n){return e[t]=n}function jo(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function Po(e,t,n,r){const i=jt();return jo(i,Gt(),t)&&(Pt(),function(e,t,n,r,i,o){const s=wt(e,t);!function(e,t,n,r,i,o,s){if(null==o)yt(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{const a=null==s?he(o):s(o,r||"",i);yt(e)?e.setAttribute(t,i,a,n):n?t.setAttributeNS(n,i,a):t.setAttribute(i,a)}}(t[11],s,o,e.value,n,r,i)}(sn(),i,e,t,n,r)),Po}function Mo(e,t,n,r,i,o,s,a){const u=jt(),c=Pt(),l=e+tt,h=c.firstCreatePass?function(e,t,n,r,i,o,s,a,u){const c=t.consts,l=bi(t,e,4,s||null,Tt(c,a));ji(t,n,l,Tt(c,u)),an(t,l);const h=l.tViews=Oi(2,l,r,i,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,o,s):c.data[l];Lt(h,!1);const d=u[11].createComment("");Vr(c,u,d,h),mr(d,u),Wi(u,u[l]=Vi(d,u,d,h)),at(h)&&Ai(c,u,h),null!=s&&ki(u,h,a)}function Ro(e){return Et(Ct.lFrame.contextLView,tt+e)}function No(e,t=Ee.Default){const n=jt();return null===n?ur(e,t):Pn(Rt(),n,ue(e),t)}function Lo(e,t,n){const r=jt();return jo(r,Gt(),t)&&Di(Pt(),sn(),r,e,t,r[11],n,!1),Lo}function Fo(e,t,n,r,i){const o=i?"class":"style";to(e,n,t.inputs[o],o,r)}function Bo(e,t,n,r){const i=jt(),o=Pt(),s=tt+e,a=i[11],u=i[s]=Cr(a,t,Ct.lFrame.currentNamespace),c=o.firstCreatePass?function(e,t,n,r,i,o,s){const a=t.consts,u=bi(t,e,2,i,Tt(a,o));return ji(t,n,u,Tt(a,s)),null!==u.attrs&&no(u,u.attrs,!1),null!==u.mergedAttrs&&no(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(s,o,i,0,t,n,r):o.data[s];Lt(c,!0);const l=c.mergedAttrs;null!==l&&gn(a,u,l);const h=c.classes;null!==h&&Zr(a,u,h);const d=c.styles;null!==d&&Kr(a,u,d),64!=(64&c.flags)&&Vr(o,i,u,c),0===Ct.lFrame.elementDepthCount&&mr(u,i),Ct.lFrame.elementDepthCount++,at(c)&&(Ai(o,i,c),function(e,t,n){if(ot(t)){const r=t.directiveEnd;for(let i=t.directiveStart;i<r;i++){const t=e.data[i];t.contentQueries&&t.contentQueries(1,n[i],i)}}}(o,c,i)),null!==r&&ki(i,c)}function zo(){let e=Rt();Ft()?Bt():(e=e.parent,Lt(e,!1));const t=e;Ct.lFrame.elementDepthCount--;const n=Pt();n.firstCreatePass&&(an(n,e),ot(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Fo(n,t,jt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Fo(n,t,jt(),t.stylesWithoutHost,!1)}function Uo(e,t,n,r){Bo(e,t,n,r),zo()}function Vo(){return jt()}function Go(e){return!!e&&"function"==typeof e.then}function Ho(e){return!!e&&"function"==typeof e.subscribe}const qo=Ho;function Wo(e,t,n,r){const i=jt(),o=Pt(),s=Rt();return function(e,t,n,r,i,o,s,a){const u=at(r),c=e.firstCreatePass&&Ji(e),l=Qi(t);let h=!0;if(3&r.type||a){const d=wt(r,t),f=a?a(d):d,p=l.length,g=a?e=>a(bt(e[r.index])):r.index;if(yt(n)){let s=null;if(!a&&u&&(s=function(e,t,n,r){const i=e.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const e=i[o];if(e===n&&i[o+1]===r){const e=t[7],n=i[o+2];return e.length>n?e[n]:null}"string"==typeof e&&(o+=2)}return null}(e,t,i,r.index)),null!==s)(s.__ngLastListenerFn__||s).__ngNextListenerFn__=o,s.__ngLastListenerFn__=o,h=!1;else{o=Xo(r,t,0,o,!1);const e=n.listen(f,i,o);l.push(o,e),c&&c.push(i,g,p,p+1)}}else o=Xo(r,t,0,o,!0),f.addEventListener(i,o,s),l.push(o),c&&c.push(i,g,p,s)}else o=Xo(r,t,0,o,!1);const d=r.outputs;let f;if(h&&null!==d&&(f=d[i])){const e=f.length;if(e)for(let n=0;n<e;n+=2){const e=t[f[n]][f[n+1]].subscribe(o),s=l.length;l.push(o,e),c&&c.push(i,r.index,s,-(s+1))}}}(o,i,i[11],s,e,t,!!n,r),Wo}function $o(e,t,n,r){try{return!1!==n(r)}catch(i){return eo(e,i),!1}}function Xo(e,t,n,r,i){return function n(o){if(o===Function)return r;const s=2&e.flags?St(e.index,t):t;0==(32&t[2])&&$i(s);let a=$o(t,0,r,o),u=n.__ngNextListenerFn__;for(;u;)a=$o(t,0,u,o)&&a,u=u.__ngNextListenerFn__;return i&&!1===a&&(o.preventDefault(),o.returnValue=!1),a}}function Ko(e=1){return function(e){return(Ct.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Ct.lFrame.contextLView))[8]}(e)}function Zo(e,t,n,r,i){const o=e[n+1],s=null===t;let a=r?di(o):pi(o),u=!1;for(;0!==a&&(!1===u||s);){const n=e[a+1];Yo(e[a],t)&&(u=!0,e[a+1]=r?mi(n):fi(n)),a=r?di(n):pi(n)}u&&(e[n+1]=r?fi(o):mi(o))}function Yo(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&er(e,t)>=0}const Qo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Jo(e){return e.substring(Qo.key,Qo.keyEnd)}function es(e,t){const n=Qo.textEnd;return n===t?-1:(t=Qo.keyEnd=function(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,Qo.key=t,n),ts(e,t,n))}function ts(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function ns(e,t){return function(e,t,n,r){const i=jt(),o=Pt(),s=Ht(2);o.firstUpdatePass&&ss(o,e,s,true),t!==ui&&jo(i,s,t)&&cs(o,o.data[rn()],i,i[11],e,i[s+1]=function(e,t){return null==e||"object"==typeof e&&(e=ie(gr(e))),e}(t),true,s)}(e,t),ns}function rs(e){!function(e,t,n,r){const i=Pt(),o=Ht(2);i.firstUpdatePass&&ss(i,null,o,r);const s=jt();if(n!==ui&&jo(s,o,n)){const a=i.data[rn()];if(ds(a,r)&&!os(i,o)){let e=a.classesWithoutHost;null!==e&&(n=oe(e,n||"")),Fo(i,a,s,n,r)}else!function(e,t,n,r,i,o,s,a){i===ui&&(i=Ne);let u=0,c=0,l=0<i.length?i[0]:null,h=0<o.length?o[0]:null;for(;null!==l||null!==h;){const s=u<i.length?i[u+1]:void 0,d=c<o.length?o[c+1]:void 0;let f,p=null;l===h?(u+=2,c+=2,s!==d&&(p=h,f=d)):null===h||null!==l&&l<h?(u+=2,p=l):(c+=2,p=h,f=d),null!==p&&cs(e,t,n,r,p,f,true,a),l=u<i.length?i[u]:null,h=c<o.length?o[c]:null}}(i,a,s,s[11],s[o+1],s[o+1]=function(e,t,n){if(null==n||""===n)return Ne;const r=[],i=gr(n);if(Array.isArray(i))for(let o=0;o<i.length;o++)e(r,i[o],!0);else if("object"==typeof i)for(const o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),0,o)}}(Qn,is,e,!0)}function is(e,t){for(let n=function(e){return function(e){Qo.key=0,Qo.keyEnd=0,Qo.value=0,Qo.valueEnd=0,Qo.textEnd=e.length}(e),es(e,ts(e,0,Qo.textEnd))}(t);n>=0;n=es(t,n))Qn(e,Jo(t),!0)}function os(e,t){return t>=e.expandoStartIndex}function ss(e,t,n,r){const i=e.data;if(null===i[n+1]){const o=i[rn()],s=os(e,n);ds(o,r)&&null===t&&!s&&(t=!1),t=function(e,t,n,r){const i=function(e){const t=Ct.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let o=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=us(n=as(null,e,t,n,r),t.attrs,r),o=null);else{const s=t.directiveStylingLast;if(-1===s||e[s]!==i)if(n=as(i,e,t,n,r),null===o){let n=function(e,t,n){const r=n?t.classBindings:t.styleBindings;if(0!==pi(r))return e[di(r)]}(e,t,r);void 0!==n&&Array.isArray(n)&&(n=as(null,e,t,n[1],r),n=us(n,t.attrs,r),function(e,t,n,r){e[di(n?t.classBindings:t.styleBindings)]=r}(e,t,r,n))}else o=function(e,t,n){let r;const i=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<i;o++)r=us(r,e[o].hostAttrs,n);return us(r,t.attrs,n)}(e,t,r)}return void 0!==o&&(r?t.residualClasses=o:t.residualStyles=o),n}(i,o,t,r),function(e,t,n,r,i,o){let s=o?t.classBindings:t.styleBindings,a=di(s),u=pi(s);e[r]=n;let c,l=!1;if(Array.isArray(n)){const e=n;c=e[1],(null===c||er(e,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){const t=di(e[a+1]);e[r+1]=hi(t,a),0!==t&&(e[t+1]=gi(e[t+1],r)),e[a+1]=131071&e[a+1]|r<<17}else e[r+1]=hi(a,0),0!==a&&(e[a+1]=gi(e[a+1],r)),a=r;else e[r+1]=hi(u,0),0===a?a=r:e[u+1]=gi(e[u+1],r),u=r;l&&(e[r+1]=fi(e[r+1])),Zo(e,c,r,!0),Zo(e,c,r,!1),function(e,t,n,r,i){const o=i?e.residualClasses:e.residualStyles;null!=o&&"string"==typeof t&&er(o,t)>=0&&(n[r+1]=mi(n[r+1]))}(t,c,e,r,o),s=hi(a,u),o?t.classBindings=s:t.styleBindings=s}(i,o,t,n,s,r)}}function as(e,t,n,r,i){let o=null;const s=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<s&&(o=t[a],r=us(r,o.hostAttrs,i),o!==e);)a++;return null!==e&&(n.directiveStylingLast=a),r}function us(e,t,n){const r=n?1:2;let i=-1;if(null!==t)for(let o=0;o<t.length;o++){const s=t[o];"number"==typeof s?i=s:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Qn(e,s,!!n||t[++o]))}return void 0===e?null:e}function cs(e,t,n,r,i,o,s,a){if(!(3&t.type))return;const u=e.data,c=u[a+1];hs(1==(1&c)?ls(u,t,n,i,pi(c),s):void 0)||(hs(o)||2==(2&c)&&(o=ls(u,null,n,i,a,s)),function(e,t,n,r,i){const o=yt(e);if(t)i?o?e.addClass(n,r):n.classList.add(r):o?e.removeClass(n,r):n.classList.remove(r);else{let t=-1===r.indexOf("-")?void 0:Er.DashCase;if(null==i)o?e.removeStyle(n,r,t):n.style.removeProperty(r);else{const s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),t|=Er.Important),o?e.setStyle(n,r,i,t):n.style.setProperty(r,i,s?"important":"")}}}(r,s,_t(rn(),n),i,o))}function ls(e,t,n,r,i,o){const s=null===t;let a;for(;i>0;){const t=e[i],o=Array.isArray(t),u=o?t[1]:t,c=null===u;let l=n[i+1];l===ui&&(l=c?Ne:void 0);let h=c?Jn(l,r):u===r?l:void 0;if(o&&!hs(h)&&(h=Jn(t,r)),hs(h)&&(a=h,s))return a;const d=e[i+1];i=s?di(d):pi(d)}if(null!==t){let e=o?t.residualClasses:t.residualStyles;null!=e&&(a=Jn(e,r))}return a}function hs(e){return void 0!==e}function ds(e,t){return 0!=(e.flags&(t?16:32))}function fs(e,t=""){const n=jt(),r=Pt(),i=e+tt,o=r.firstCreatePass?bi(r,i,1,t,null):r.data[i],s=n[i]=function(e,t){return yt(e)?e.createText(t):e.createTextNode(t)}(n[11],t);Vr(r,n,s,o),Lt(o,!1)}function ps(e){return gs("",e,""),ps}function gs(e,t,n){const r=jt(),i=function(e,t,n,r){return jo(e,Gt(),n)?t+he(n)+r:ui}(r,e,t,n);return i!==ui&&function(e,t,n){const r=_t(t,e);!function(e,t,n){yt(e)?e.setValue(t,n):t.textContent=n}(e[11],r,n)}(r,rn(),i),gs}function ms(e,t,n){const r=jt();return jo(r,Gt(),t)&&Di(Pt(),sn(),r,e,t,r[11],n,!0),ms}const ys=void 0;var vs=["en",[["a","p"],["AM","PM"],ys],[["AM","PM"],ys,ys],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ys,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ys,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ys,"{1} 'at' {0}",ys],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){let t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let bs={};function _s(e){return e in bs||(bs[e]=Me.ng&&Me.ng.common&&Me.ng.common.locales&&Me.ng.common.locales[e]),bs[e]}var ws=(()=>((ws=ws||{})[ws.LocaleId=0]="LocaleId",ws[ws.DayPeriodsFormat=1]="DayPeriodsFormat",ws[ws.DayPeriodsStandalone=2]="DayPeriodsStandalone",ws[ws.DaysFormat=3]="DaysFormat",ws[ws.DaysStandalone=4]="DaysStandalone",ws[ws.MonthsFormat=5]="MonthsFormat",ws[ws.MonthsStandalone=6]="MonthsStandalone",ws[ws.Eras=7]="Eras",ws[ws.FirstDayOfWeek=8]="FirstDayOfWeek",ws[ws.WeekendRange=9]="WeekendRange",ws[ws.DateFormat=10]="DateFormat",ws[ws.TimeFormat=11]="TimeFormat",ws[ws.DateTimeFormat=12]="DateTimeFormat",ws[ws.NumberSymbols=13]="NumberSymbols",ws[ws.NumberFormats=14]="NumberFormats",ws[ws.CurrencyCode=15]="CurrencyCode",ws[ws.CurrencySymbol=16]="CurrencySymbol",ws[ws.CurrencyName=17]="CurrencyName",ws[ws.Currencies=18]="Currencies",ws[ws.Directionality=19]="Directionality",ws[ws.PluralCase=20]="PluralCase",ws[ws.ExtraData=21]="ExtraData",ws))();const xs="en-US";let Es=xs;function Ss(e){var t,n;n="Expected localeId to be defined",null==(t=e)&&function(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e} [Expected=> null != ${t} <=Actual]`)}(n,t),"string"==typeof e&&(Es=e.toLowerCase().replace(/_/g,"-"))}function As(e,t,n,r,i){if(e=ue(e),Array.isArray(e))for(let o=0;o<e.length;o++)As(e[o],t,n,r,i);else{const o=Pt(),s=jt();let a=yo(e)?e:ue(e.provide),u=po(e);const c=Rt(),l=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(yo(e)||!e.multi){const r=new pn(u,i,No),f=Os(a,t,i?l:l+d,h);-1===f?(Cn(kn(c,s),o,a),ks(o,e,t.length),t.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(r),s.push(r)):(n[f]=r,s[f]=r)}else{const f=Os(a,t,l+d,h),p=Os(a,t,l,l+d),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){Cn(kn(c,s),o,a);const l=function(e,t,n,r,i){const o=new pn(e,n,No);return o.multi=[],o.index=t,o.componentProviders=0,Ts(o,i,r&&!n),o}(i?Cs:Is,n.length,i,r,u);!i&&m&&(n[p].providerFactory=l),ks(o,e,t.length,0),t.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(l),s.push(l)}else ks(o,e,f>-1?f:p,Ts(n[i?p:f],u,!i&&r));!i&&r&&m&&n[p].componentProviders++}}}function ks(e,t,n,r){const i=yo(t);if(i||t.useClass){const o=(t.useClass||t).prototype.ngOnDestroy;if(o){const s=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){const e=s.indexOf(n);-1===e?s.push(n,[r,o]):s[e+1].push(r,o)}else s.push(n,o)}}}function Ts(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function Os(e,t,n,r){for(let i=n;i<r;i++)if(t[i]===e)return i;return-1}function Is(e,t,n,r){return Ds(this.multi,[])}function Cs(e,t,n,r){const i=this.multi;let o;if(this.providerFactory){const e=this.providerFactory.componentProviders,t=Fn(n,n[1],this.providerFactory.index,r);o=t.slice(0,e),Ds(i,o);for(let n=e;n<t.length;n++)o.push(t[n])}else o=[],Ds(i,o);return o}function Ds(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function js(e,t=[]){return n=>{n.providersResolver=(n,r)=>function(e,t,n){const r=Pt();if(r.firstCreatePass){const i=ut(e);As(n,r.data,r.blueprint,i,!0),As(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}class Ps{}class Ms{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${ie(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(e)}}class Rs{}function Ns(...e){}function Ls(e,t){return new Bs(wt(e,t))}Rs.NULL=new Ms;const Fs=function(){return Ls(Rt(),jt())};let Bs=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=Fs,e})();function zs(e){return e instanceof Bs?e.nativeElement:e}class Us{}let Vs=(()=>{class e{}return e.\u0275prov=pe({token:e,providedIn:"root",factory:()=>null}),e})();class Gs{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Hs=new Gs("12.1.3");class qs{constructor(){}supports(e){return Io(e)}create(e){return new $s(e)}}const Ws=(e,t)=>t;class $s{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Ws}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,i=null;for(;t||n;){const o=!n||t&&t.currentIndex<Ys(n,r,i)?t:n,s=Ys(o,r,i),a=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{i||(i=[]);const e=s-r,t=a-r;if(e!=t){for(let n=0;n<e;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;t<=o&&o<e&&(i[n]=r+1)}i[o.previousIndex]=t-e}}s!==a&&e(o,s,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Io(e))throw new Error(`Error trying to diff '${ie(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,n,r,i=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)n=e[t],r=this._trackByFn(t,n),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,t)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,t),o=!0),i=i._next}else t=0,function(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[To()]();let r;for(;!(r=n.next()).done;)t(r.value)}}(e,e=>{r=this._trackByFn(t,e),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,e,r,t)),Object.is(i.item,e)||this._addIdentityChange(i,e)):(i=this._mismatch(i,e,r,t),o=!0),i=i._next,t++}),this.length=t;return this._truncate(i),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new Xs(t,n),i,r),e}_verifyReinsertion(e,t,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Zs),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Zs),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Xs{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Ks{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class Zs{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new Ks,this.map.set(t,n)),n.add(e)}get(e,t){const n=this.map.get(e);return n?n.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Ys(e,t,n){const r=e.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+t+i}class Qs{constructor(){}supports(e){return e instanceof Map||Co(e)}create(){return new Js}}class Js{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Co(e)))throw new Error(`Error trying to diff '${ie(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,n)=>{if(t&&t.key===n)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const r=this._getOrCreateRecordForKey(n,e);t=this._insertBeforeOrAppend(t,r)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const n=this._records.get(e);this._maybeAddToChanges(n,t);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new ea(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class ea{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ta(){return new na([new qs])}let na=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(null!=n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||ta()),deps:[[e,new pr,new fr]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${n=e,n.name||typeof n}'`);var n}}return e.\u0275prov=pe({token:e,providedIn:"root",factory:ta}),e})();function ra(){return new ia([new Qs])}let ia=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||ra()),deps:[[e,new pr,new fr]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=pe({token:e,providedIn:"root",factory:ra}),e})();function oa(e,t,n,r,i=!1){for(;null!==n;){const o=t[n.index];if(null!==o&&r.push(bt(o)),it(o))for(let e=nt;e<o.length;e++){const t=o[e],n=t[1].firstChild;null!==n&&oa(t[1],t,n,r)}const s=n.type;if(8&s)oa(e,t,n.child,r);else if(32&s){const e=Sr(n,t);let i;for(;i=e();)r.push(i)}else if(16&s){const e=Hr(t,n);if(Array.isArray(e))r.push(...e);else{const n=Ar(t[16]);oa(n[1],n,e,r,!0)}}n=i?n.projectionNext:n.next}return r}class sa{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return oa(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(it(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(jr(e,n),Zn(t,n))}this._attachedToViewContainer=!1}Pr(this._lView[1],this._lView)}onDestroy(e){Ii(this._lView[1],this._lView,null,e)}markForCheck(){$i(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Xi(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,n){Ut(!0);try{Xi(e,t,n)}finally{Ut(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,$r(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class aa extends sa{constructor(e){super(e),this._view=e}detectChanges(){Ki(this._view)}checkNoChanges(){!function(e){Ut(!0);try{Ki(e)}finally{Ut(!1)}}(this._view)}get context(){return null}}const ua=function(e){return function(e,t,n){if(st(e)&&!n){const n=St(e.index,t);return new sa(n,n)}return 47&e.type?new sa(t[16],t):null}(Rt(),jt(),16==(16&e))};let ca=(()=>{class e{}return e.__NG_ELEMENT_ID__=ua,e})();const la=[new Qs],ha=new na([new qs]),da=new ia(la),fa=function(){return ya(Rt(),jt())};let pa=(()=>{class e{}return e.__NG_ELEMENT_ID__=fa,e})();const ga=pa,ma=class extends ga{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e){const t=this._declarationTContainer.tViews,n=vi(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),wi(t,n,e),new sa(n)}};function ya(e,t){return 4&e.type?new ma(t,e,Ls(e,t)):null}class va{}const ba=function(){return Aa(Rt(),jt())};let _a=(()=>{class e{}return e.__NG_ELEMENT_ID__=ba,e})();const wa=_a,xa=class extends wa{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Ls(this._hostTNode,this._hostLView)}get injector(){return new Un(this._hostTNode,this._hostLView)}get parentInjector(){const e=In(this._hostTNode,this._hostLView);if(_n(e)){const t=xn(e,this._hostLView),n=wn(e);return new Un(t[1].data[n+8],t)}return new Un(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Ea(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-nt}createEmbeddedView(e,t,n){const r=e.createEmbeddedView(t||{});return this.insert(r,n),r}createComponent(e,t,n,r,i){const o=n||this.parentInjector;if(!i&&null==e.ngModule&&o){const e=o.get(va,null);e&&(i=e)}const s=e.create(o,r,void 0,i);return this.insert(s.hostView,t),s}insert(e,t){const n=e._lView,r=n[1];if(it(n[3])){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=n[3],r=new xa(t,t[6],t[3]);r.detach(r.indexOf(e))}}const i=this._adjustIndex(t),o=this._lContainer;!function(e,t,n,r){const i=nt+r,o=n.length;r>0&&(n[i-1][4]=t),r<o-nt?(t[4]=n[i],Kn(n,nt+r,t)):(n.push(t),t[4]=null),t[3]=n;const s=t[17];null!==s&&n!==s&&function(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(s,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(r,n,o,i);const s=qr(i,o),a=n[11],u=Br(a,o[7]);return null!==u&&function(e,t,n,r,i,o){r[0]=i,r[6]=t,$r(e,r,n,1,i,o)}(r,o[6],a,n,u,s),e.attachToViewContainerRef(),Kn(Sa(o),i,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Ea(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=jr(this._lContainer,t);n&&(Zn(Sa(this._lContainer),t),Pr(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=jr(this._lContainer,t);return n&&null!=Zn(Sa(this._lContainer),t)?new sa(n):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function Ea(e){return e[8]}function Sa(e){return e[8]||(e[8]=[])}function Aa(e,t){let n;const r=t[e.index];if(it(r))n=r;else{let i;if(8&e.type)i=bt(r);else{const n=t[11];i=n.createComment("");const r=wt(e,t);Nr(n,Br(n,r),i,function(e,t){return yt(e)?e.nextSibling(t):t.nextSibling}(n,r),!1)}t[e.index]=n=Vi(r,t,i,e),Wi(t,n)}return new xa(n,e,t)}const ka={};class Ta extends Rs{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Je(e);return new Ca(t,this.ngModule)}}function Oa(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}const Ia=new Wn("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>wr});class Ca extends Ps{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(ai).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Oa(this.componentDef.inputs)}get outputs(){return Oa(this.componentDef.outputs)}create(e,t,n,r){const i=(r=r||this.ngModule)?function(e,t){return{get:(n,r,i)=>{const o=e.get(n,ka,i);return o!==ka||r===ka?o:t.get(n,r,i)}}}(e,r.injector):e,o=i.get(Us,vt),s=i.get(Vs,null),a=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=n?function(e,t,n){if(yt(e))return e.selectRootElement(t,n===Ie.ShadowDom);let r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(a,n,this.componentDef.encapsulation):Cr(o.createRenderer(null,this.componentDef),u,function(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(u)),l=this.componentDef.onPush?576:528,h={components:[],scheduler:wr,clean:Yi,playerHandler:null,flags:0},d=Oi(0,null,null,1,0,null,null,null,null,null),f=vi(null,d,h,l,null,null,o,a,s,i);let p,g;Yt(f);try{const e=function(e,t,n,r,i,o){const s=n[1];n[20]=e;const a=bi(s,20,2,"#host",null),u=a.mergedAttrs=t.hostAttrs;null!==u&&(no(a,u,!0),null!==e&&(gn(i,e,u),null!==a.classes&&Zr(i,e,a.classes),null!==a.styles&&Kr(i,e,a.styles)));const c=r.createRenderer(e,t),l=vi(n,Ti(t),null,t.onPush?64:16,n[20],a,r,c,null,null);return s.firstCreatePass&&(Cn(kn(a,n),s,t.type),Ri(s,a),Li(a,n.length,1)),Wi(n,l),n[20]=l}(c,this.componentDef,f,o,a);if(c)if(n)gn(a,c,["ng-version",Hs.full]);else{const{attrs:e,classes:t}=function(e){const t=[],n=[];let r=1,i=2;for(;r<e.length;){let o=e[r];if("string"==typeof o)2===i?""!==o&&t.push(o,e[++r]):8===i&&n.push(o);else{if(!ri(i))break;i=o}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);e&&gn(a,c,e),t&&t.length>0&&Zr(a,c,t.join(" "))}if(g=xt(d,tt),void 0!==t){const e=g.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=t[n];e.push(null!=r?Array.from(r):null)}}p=function(e,t,n,r,i){const o=n[1],s=function(e,t,n){const r=Rt();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Fi(e,r,t,_i(e,t,1,null),n));const i=Fn(t,e,r.directiveStart,r);mr(i,t);const o=wt(r,t);return o&&mr(o,t),i}(o,n,t);if(r.components.push(s),e[8]=s,i&&i.forEach(e=>e(s,t)),t.contentQueries){const e=Rt();t.contentQueries(1,s,e.directiveStart)}const a=Rt();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(on(a.index),Pi(n[1],a,0,a.directiveStart,a.directiveEnd,t),Mi(t,s)),s}(e,this.componentDef,f,h,[_o]),wi(d,f,null)}finally{nn()}return new Da(this.componentType,p,Ls(g,f),f,g)}}class Da extends class{}{constructor(e,t,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.instance=t,this.hostView=this.changeDetectorRef=new aa(r),this.componentType=e}get injector(){return new Un(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const ja=new Map;class Pa extends va{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Ta(this);const n=et(e),r=e[Ue]||null;r&&Ss(r),this._bootstrapComponents=xr(n.bootstrap),this._r3Injector=lo(e,t,[{provide:va,useValue:this},{provide:Rs,useValue:this.componentFactoryResolver}],ie(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=bo.THROW_IF_NOT_FOUND,n=Ee.Default){return e===bo||e===va||e===ro?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Ma extends class{}{constructor(e){super(),this.moduleType=e,null!==et(e)&&function(e){const t=new Set;!function e(n){const r=et(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${ie(t)} vs ${ie(t.name)}`)}(i,ja.get(i),n),ja.set(i,n));const o=xr(r.imports);for(const s of o)t.has(s)||(t.add(s),e(s))}(e)}(e)}create(e){return new Pa(this.moduleType,e)}}function Ra(e,t,n){const r=Vt()+e,i=jt();return i[r]===ui?Do(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function Na(e,t,n,r,i,o){const s=t+n;return jo(e,s,i)?Do(e,s+1,o?r.call(o,i):r(i)):function(e,t){const n=e[t];return n===ui?void 0:n}(e,s+1)}function La(e,t){const n=Pt();let r;const i=e+tt;n.firstCreatePass?(r=function(e,t){if(t)for(let n=t.length-1;n>=0;n--){const r=t[n];if(e===r.name)return r}throw new le("302",`The pipe '${e}' could not be found!`)}(t,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const o=r.factory||(r.factory=ct(r.type)),s=Ae(No);try{const e=Sn(!1),t=o();return Sn(e),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(n,jt(),i,t),t}finally{Ae(s)}}function Fa(e,t,n){const r=e+tt,i=jt(),o=Et(i,r);return function(e,t){return Oo.isWrapped(t)&&(t=Oo.unwrap(t),e[Ct.lFrame.bindingIndex]=ui),t}(i,function(e,t){return e[1].data[t].pure}(i,r)?Na(i,Vt(),t,o.transform,n,o):o.transform(n))}function Ba(e){return t=>{setTimeout(e,void 0,t)}}const za=class extends T{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){var r,i,o;let s=e,a=t||(()=>null),u=n;if(e&&"object"==typeof e){const t=e;s=null===(r=t.next)||void 0===r?void 0:r.bind(t),a=null===(i=t.error)||void 0===i?void 0:i.bind(t),u=null===(o=t.complete)||void 0===o?void 0:o.bind(t)}this.__isAsync&&(a=Ba(a),s&&(s=Ba(s)),u&&(u=Ba(u)));const c=super.subscribe({next:s,error:a,complete:u});return e instanceof g&&e.add(c),c}};function Ua(){return this._results[To()]()}class Va{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=To(),n=Va.prototype;n[t]||(n[t]=Ua)}get changes(){return this._changes||(this._changes=new za)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=$n(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],o=t[r];if(n&&(i=n(i),o=n(o)),o!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class Ga{constructor(e){this.queryList=e,this.matches=null}clone(){return new Ga(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ha{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let e=0;e<n;e++){const n=t.getByIndex(e);r.push(this.queries[n.indexInDeclarationView].clone())}return new Ha(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==tu(e,t).matches&&this.queries[t].setDirty()}}class qa{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class Wa{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,i=this.getByIndex(n).embeddedTView(e,r);i&&(i.indexInDeclarationView=n,null!==t?t.push(i):t=[i])}return null!==t?new Wa(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class $a{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new $a(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const i=n[r];this.matchTNodeWithReadOption(e,t,Xa(t,i)),this.matchTNodeWithReadOption(e,t,Ln(t,e,i,!1,!1))}else n===pa?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Ln(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===Bs||r===_a||r===pa&&4&t.type)this.addMatch(t.index,-2);else{const n=Ln(t,e,r,!1,!1);null!==n&&this.addMatch(t.index,n)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Xa(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function Ka(e,t,n,r){return-1===n?function(e,t){return 11&e.type?Ls(e,t):4&e.type?ya(e,t):null}(t,e):-2===n?function(e,t,n){return n===Bs?Ls(t,e):n===pa?ya(t,e):n===_a?Aa(t,e):void 0}(e,t,r):Fn(e,e[1],n,t)}function Za(e,t,n,r){const i=t[19].queries[r];if(null===i.matches){const r=e.data,o=n.matches,s=[];for(let e=0;e<o.length;e+=2){const i=o[e];s.push(i<0?null:Ka(t,r[i],o[e+1],n.metadata.read))}i.matches=s}return i.matches}function Ya(e,t,n,r){const i=e.queries.getByIndex(n),o=i.matches;if(null!==o){const s=Za(e,t,i,n);for(let e=0;e<o.length;e+=2){const n=o[e];if(n>0)r.push(s[e/2]);else{const i=o[e+1],s=t[-n];for(let e=nt;e<s.length;e++){const t=s[e];t[17]===t[3]&&Ya(t[1],t,i,r)}if(null!==s[9]){const e=s[9];for(let t=0;t<e.length;t++){const n=e[t];Ya(n[1],n,i,r)}}}}}return r}function Qa(e){const t=jt(),n=Pt(),r=$t();Xt(r+1);const i=tu(n,r);if(e.dirty&&At(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{const o=i.crossesNgTemplate?Ya(n,t,r,[]):Za(n,t,i,r);e.reset(o,zs),e.notifyOnChanges()}return!0}return!1}function Ja(e,t,n){const r=Pt();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new Wa),e.queries.track(new $a(t,-1))}(r,new qa(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){const r=new Va(4==(4&n));Ii(e,t,r,r.destroy),null===t[19]&&(t[19]=new Ha),t[19].queries.push(new Ga(r))}(r,jt(),t)}function eu(){return e=jt(),t=$t(),e[19].queries[t].queryList;var e,t}function tu(e,t){return e.queries.getByIndex(t)}const nu=new Wn("Application Initializer");let ru=(()=>{class e{constructor(e){this.appInits=e,this.resolve=Ns,this.reject=Ns,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const t=this.appInits[n]();if(Go(t))e.push(t);else if(qo(t)){const n=new Promise((e,n)=>{t.subscribe({complete:e,error:n})});e.push(n)}}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(ur(nu,8))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const iu=new Wn("AppId"),ou={provide:iu,useFactory:function(){return`${su()}${su()}${su()}`},deps:[]};function su(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const au=new Wn("Platform Initializer"),uu=new Wn("Platform ID"),cu=new Wn("appBootstrapListener");let lu=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const hu=new Wn("LocaleId"),du=new Wn("DefaultCurrencyCode");class fu{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const pu=function(e){return new Ma(e)},gu=pu,mu=function(e){return Promise.resolve(pu(e))},yu=function(e){const t=pu(e),n=xr(et(e).declarations).reduce((e,t)=>{const n=Je(t);return n&&e.push(new Ca(n)),e},[]);return new fu(t,n)},vu=yu,bu=function(e){return Promise.resolve(yu(e))};let _u=(()=>{class e{constructor(){this.compileModuleSync=gu,this.compileModuleAsync=mu,this.compileModuleAndAllComponentsSync=vu,this.compileModuleAndAllComponentsAsync=bu}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const wu=new Wn("compilerOptions"),xu=(()=>Promise.resolve(0))();function Eu(e){"undefined"==typeof Zone?xu.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class Su{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new za(!1),this.onMicrotaskEmpty=new za(!1),this.onStable=new za(!1),this.onError=new za(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let e=Me.requestAnimationFrame,t=Me.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Me,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Tu(e),e.isCheckStableRunning=!0,ku(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Tu(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,o,s,a)=>{try{return Ou(e),n.invokeTask(i,o,s,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||e.shouldCoalesceRunChangeDetection)&&t(),Iu(e)}},onInvoke:(n,r,i,o,s,a,u)=>{try{return Ou(e),n.invoke(i,o,s,a,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),Iu(e)}},onHasTask:(t,n,r,i)=>{t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,Tu(e),ku(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,n,r,i)=>(t.handleError(r,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Su.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Su.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,e,Au,Ns,Ns);try{return i.runTask(o,t,n)}finally{i.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const Au={};function ku(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Tu(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Ou(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Iu(e){e._nesting--,ku(e)}class Cu{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new za,this.onMicrotaskEmpty=new za,this.onStable=new za,this.onError=new za}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}let Du=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Su.assertNotInAngularZone(),Eu(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Eu(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,n){let r=-1;t&&t>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==r),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:n})}whenStable(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,n){return[]}}return e.\u0275fac=function(t){return new(t||e)(ur(Su))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),ju=(()=>{class e{constructor(){this._applications=new Map,Ru.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return Ru.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class Pu{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}let Mu,Ru=new Pu,Nu=!0,Lu=!1;function Fu(){return Lu=!0,Nu}const Bu=new Wn("AllowMultipleToken");function zu(e,t,n=[]){const r=`Platform: ${t}`,i=new Wn(r);return(t=[])=>{let o=Uu();if(!o||o.injector.get(Bu,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{const e=n.concat(t).concat({provide:i,useValue:!0},{provide:oo,useValue:"platform"});!function(e){if(Mu&&!Mu.destroyed&&!Mu.injector.get(Bu,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Mu=e.get(Vu);const t=e.get(au,null);t&&t.forEach(e=>e())}(bo.create({providers:e,name:r}))}return function(e){const t=Uu();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function Uu(){return Mu&&!Mu.destroyed?Mu:null}let Vu=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const n=function(e,t){let n;return n="noop"===e?new Cu:("zone.js"===e?void 0:e)||new Su({enableLongStackTrace:Fu(),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),r=[{provide:Su,useValue:n}];return n.run(()=>{const t=bo.create({providers:r,parent:this.injector,name:e.moduleType.name}),i=e.create(t),o=i.injector.get(_r,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const e=n.onError.subscribe({next:e=>{o.handleError(e)}});i.onDestroy(()=>{qu(this._modules,i),e.unsubscribe()})}),function(e,t,n){try{const r=n();return Go(r)?r.catch(n=>{throw t.runOutsideAngular(()=>e.handleError(n)),n}):r}catch(r){throw t.runOutsideAngular(()=>e.handleError(r)),r}}(o,n,()=>{const e=i.injector.get(ru);return e.runInitializers(),e.donePromise.then(()=>(Ss(i.injector.get(hu,xs)||xs),this._moduleDoBootstrap(i),i))})})}bootstrapModule(e,t=[]){const n=Gu({},t);return function(e,t,n){const r=new Ma(n);return Promise.resolve(r)}(0,0,e).then(e=>this.bootstrapModuleFactory(e,n))}_moduleDoBootstrap(e){const t=e.injector.get(Hu);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${ie(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(ur(bo))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();function Gu(e,t){return Array.isArray(t)?t.reduce(Gu,e):Object.assign(Object.assign({},e),t)}let Hu=(()=>{class e{constructor(e,t,n,r,i){this._zone=e,this._injector=t,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new x(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),s=new x(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{Su.assertNotInAngularZone(),Eu(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,e.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{Su.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),n.unsubscribe()}});this.isStable=$(o,s.pipe(te()))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=e instanceof Ps?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(va),i=n.create(bo.NULL,[],t||n.selector,r),o=i.location.nativeElement,s=i.injector.get(Du,null),a=s&&i.injector.get(ju);return s&&a&&a.registerApplication(o,s),i.onDestroy(()=>{this.detachView(i.hostView),qu(this.components,i),a&&a.unregisterApplication(o)}),this._loadComponent(i),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;qu(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(cu,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(ur(Su),ur(bo),ur(_r),ur(Rs),ur(ru))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();function qu(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Wu=zu(null,"core",[{provide:uu,useValue:"unknown"},{provide:Vu,deps:[bo]},{provide:ju,deps:[]},{provide:lu,deps:[]}]),$u=[{provide:Hu,useClass:Hu,deps:[Su,bo,_r,Rs,ru]},{provide:Ia,deps:[Su],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:ru,useClass:ru,deps:[[new fr,nu]]},{provide:_u,useClass:_u,deps:[]},ou,{provide:na,useFactory:function(){return ha},deps:[]},{provide:ia,useFactory:function(){return da},deps:[]},{provide:hu,useFactory:function(e){return Ss(e=e||"undefined"!=typeof $localize&&$localize.locale||xs),e},deps:[[new dr(hu),new fr,new pr]]},{provide:du,useValue:"USD"}];let Xu=(()=>{class e{constructor(e){}}return e.\u0275fac=function(t){return new(t||e)(ur(Hu))},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({providers:$u}),e})(),Ku=null;function Zu(){return Ku}const Yu=new Wn("DocumentToken");let Qu=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({factory:Ju,token:e,providedIn:"platform"}),e})();function Ju(){return ur(ec)}let ec=(()=>{class e extends Qu{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Zu().getBaseHref(this._doc)}onPopState(e){const t=Zu().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),()=>t.removeEventListener("popstate",e)}onHashChange(e){const t=Zu().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),()=>t.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,n){tc()?this._history.pushState(e,t,n):this.location.hash=n}replaceState(e,t,n){tc()?this._history.replaceState(e,t,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(ur(Yu))},e.\u0275prov=pe({factory:nc,token:e,providedIn:"platform"}),e})();function tc(){return!!window.history.pushState}function nc(){return new ec(ur(Yu))}function rc(e){return e&&"?"!==e[0]?"?"+e:e}let ic=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({factory:oc,token:e,providedIn:"root"}),e})();function oc(e){const t=ur(Yu).location;return new ac(ur(Qu),t&&t.origin||"")}const sc=new Wn("appBaseHref");let ac=(()=>{class e extends ic{constructor(e,t){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==t&&(t=this._platformLocation.getBaseHrefFromDOM()),null==t)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=t}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return function(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}(this._baseHref,e)}path(e=!1){const t=this._platformLocation.pathname+rc(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?`${t}${n}`:t}pushState(e,t,n,r){const i=this.prepareExternalUrl(n+rc(r));this._platformLocation.pushState(e,t,i)}replaceState(e,t,n,r){const i=this.prepareExternalUrl(n+rc(r));this._platformLocation.replaceState(e,t,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,n;null===(n=(t=this._platformLocation).historyGo)||void 0===n||n.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(ur(Qu),ur(sc,8))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();var uc=(()=>((uc=uc||{})[uc.Zero=0]="Zero",uc[uc.One=1]="One",uc[uc.Two=2]="Two",uc[uc.Few=3]="Few",uc[uc.Many=4]="Many",uc[uc.Other=5]="Other",uc))();class cc{}let lc=(()=>{class e extends cc{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(function(e){return function(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=_s(t);if(n)return n;const r=t.split("-")[0];if(n=_s(r),n)return n;if("en"===r)return vs;throw new Error(`Missing locale data for the locale "${e}".`)}(e)[ws.PluralCase]}(t||this.locale)(e)){case uc.Zero:return"zero";case uc.One:return"one";case uc.Two:return"two";case uc.Few:return"few";case uc.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(ur(hu))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class hc{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let dc=(()=>{class e{constructor(e,t,n){this._viewContainer=e,this._template=t,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(t){throw new Error(`Cannot find a differ supporting object '${n}' of type '${e=n,e.name||typeof e}'. NgFor only supports binding to Iterables such as Arrays.`)}}var e;if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,n,r)=>{if(null==e.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new hc(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new fc(e,n);t.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const o=new fc(e,i);t.push(o)}});for(let n=0;n<t.length;n++)this._perViewChange(t[n].view,t[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const e=this._viewContainer.get(n);e.context.index=n,e.context.count=r,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(No(_a),No(pa),No(na))},e.\u0275dir=Ye({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();class fc{constructor(e,t){this.record=e,this.view=t}}class pc{createSubscription(e,t){return e.subscribe({next:t,error:e=>{throw e}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class gc{createSubscription(e,t){return e.then(t,e=>{throw e})}dispose(e){}onDestroy(e){}}const mc=new gc,yc=new pc;let vc=(()=>{class e{constructor(e){this._ref=e,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue:(e&&this._subscribe(e),this._latestValue)}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,t=>this._updateLatestValue(e,t))}_selectStrategy(t){if(Go(t))return mc;if(Ho(t))return yc;throw Error(`InvalidPipeArgument: '${t}' for pipe '${ie(e)}'`)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,t){e===this._obj&&(this._latestValue=t,this._ref.markForCheck())}}return e.\u0275fac=function(t){return new(t||e)(No(ca,16))},e.\u0275pipe=Qe({name:"async",type:e,pure:!1}),e})(),bc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({providers:[{provide:cc,useClass:lc}]}),e})();function _c(e){return"browser"===e}class wc extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var e;e=new wc,Ku||(Ku=e)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(Ec=Ec||document.querySelector("base"),Ec?Ec.getAttribute("href"):null);return null==t?null:function(e){xc=xc||document.createElement("a"),xc.setAttribute("href",e);const t=xc.pathname;return"/"===t.charAt(0)?t:`/${t}`}(t)}resetBaseElement(){Ec=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const e=n.indexOf("="),[r,i]=-1==e?[n,""]:[n.slice(0,e),n.slice(e+1)];if(r.trim()===t)return decodeURIComponent(i)}return null}(document.cookie,e)}}let xc,Ec=null;const Sc=new Wn("TRANSITION_ID"),Ac=[{provide:nu,useFactory:function(e,t,n){return()=>{n.get(ru).donePromise.then(()=>{const n=Zu();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(t=>t.getAttribute("ng-transition")===e).forEach(e=>n.remove(e))})}},deps:[Sc,Yu,bo],multi:!0}];class kc{static init(){var e;e=new kc,Ru=e}addToWindow(e){Me.getAngularTestability=(t,n=!0)=>{const r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Me.getAllAngularTestabilities=()=>e.getAllTestabilities(),Me.getAllAngularRootElements=()=>e.getAllRootElements(),Me.frameworkStabilizers||(Me.frameworkStabilizers=[]),Me.frameworkStabilizers.push(e=>{const t=Me.getAllAngularTestabilities();let n=t.length,r=!1;const i=function(t){r=r||t,n--,0==n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:n?Zu().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let Tc=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const Oc=new Wn("EventManagerPlugins");let Ic=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}addGlobalEventListener(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const n=this._plugins;for(let r=0;r<n.length;r++){const t=n[r];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}return e.\u0275fac=function(t){return new(t||e)(ur(Oc),ur(Su))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class Cc{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Zu().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let Dc=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),jc=(()=>{class e extends Dc{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,t,n){e.forEach(e=>{const r=this._doc.createElement("style");r.textContent=e,n.push(t.appendChild(r))})}addHost(e){const t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}removeHost(e){const t=this._hostNodes.get(e);t&&t.forEach(Pc),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((t,n)=>{this._addStylesToHost(e,n,t)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(Pc))}}return e.\u0275fac=function(t){return new(t||e)(ur(Yu))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();function Pc(e){Zu().remove(e)}const Mc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Rc=/%COMP%/g;function Nc(e,t,n){for(let r=0;r<t.length;r++){let i=t[r];Array.isArray(i)?Nc(e,i,n):(i=i.replace(Rc,e),n.push(i))}return n}function Lc(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let Fc=(()=>{class e{constructor(e,t,n){this.eventManager=e,this.sharedStylesHost=t,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Bc(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ie.Emulated:{let n=this.rendererByCompId.get(t.id);return n||(n=new zc(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n}case 1:case Ie.ShadowDom:return new Uc(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=Nc(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(ur(Ic),ur(jc),ur(iu))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class Bc{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(Mc[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const i=Mc[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Mc[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Er.DashCase|Er.Important)?e.style.setProperty(t,n,r&Er.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Er.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Lc(n)):this.eventManager.addEventListener(e,t,Lc(n))}}class zc extends Bc{constructor(e,t,n,r){super(e),this.component=n;const i=Nc(r+"-"+n.id,n.styles,[]);t.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(Rc,r+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(Rc,r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class Uc extends Bc{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=Nc(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const e=document.createElement("style");e.textContent=i[o],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Vc=(()=>{class e extends Cc{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,n){return e.addEventListener(t,n,!1),()=>this.removeEventListener(e,t,n)}removeEventListener(e,t,n){return e.removeEventListener(t,n)}}return e.\u0275fac=function(t){return new(t||e)(ur(Yu))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const Gc=["alt","control","meta","shift"],Hc={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},qc={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Wc={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let $c=(()=>{class e extends Cc{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,n,r){const i=e.parseEventName(n),o=e.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Zu().onAndCancel(t,i.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=e._normalizeKey(n.pop());let o="";if(Gc.forEach(e=>{const t=n.indexOf(e);t>-1&&(n.splice(t,1),o+=e+".")}),o+=i,0!=n.length||0===i.length)return null;const s={};return s.domEventName=r,s.fullKey=o,s}static getEventFullKey(e){let t="",n=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&qc.hasOwnProperty(t)&&(t=qc[t]))}return Hc[t]||t}(e);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),Gc.forEach(r=>{r!=n&&(0,Wc[r])(e)&&(t+=r+".")}),t+=n,t}static eventCallback(t,n,r){return i=>{e.getEventFullKey(i)===t&&r.runGuarded(()=>n(i))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}return e.\u0275fac=function(t){return new(t||e)(ur(Yu))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const Xc=zu(Wu,"browser",[{provide:uu,useValue:"browser"},{provide:au,useValue:function(){wc.makeCurrent(),kc.init()},multi:!0},{provide:Yu,useFactory:function(){return function(e){mt=e}(document),document},deps:[]}]),Kc=[[],{provide:oo,useValue:"root"},{provide:_r,useFactory:function(){return new _r},deps:[]},{provide:Oc,useClass:Vc,multi:!0,deps:[Yu,Su,uu]},{provide:Oc,useClass:$c,multi:!0,deps:[Yu]},[],{provide:Fc,useClass:Fc,deps:[Ic,jc,iu]},{provide:Us,useExisting:Fc},{provide:Dc,useExisting:jc},{provide:jc,useClass:jc,deps:[Yu]},{provide:Du,useClass:Du,deps:[Su]},{provide:Ic,useClass:Ic,deps:[Oc,Su]},{provide:class{},useClass:Tc,deps:[]},[]];let Zc=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:iu,useValue:t.appId},{provide:Sc,useExisting:iu},Ac]}}}return e.\u0275fac=function(t){return new(t||e)(ur(e,12))},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({providers:Kc,imports:[bc,Xu]}),e})();"undefined"!=typeof window&&window;class Yc extends g{constructor(e,t){super()}schedule(e,t=0){return this}}class Qc extends Yc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,n=0){return setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n,r=!1;try{this.work(e)}catch(i){r=!0,n=!!i&&i||new Error(i)}if(r)return this.unsubscribe(),n}_unsubscribe(){const e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let Jc=(()=>{class e{constructor(t,n=e.now){this.SchedulerAction=t,this.now=n}schedule(e,t=0,n){return new this.SchedulerAction(this,e).schedule(n,t)}}return e.now=()=>Date.now(),e})();class el extends Jc{constructor(e,t=Jc.now){super(e,()=>el.delegate&&el.delegate!==this?el.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,n){return el.delegate&&el.delegate!==this?el.delegate.schedule(e,t,n):super.schedule(e,t,n)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const tl=new class extends el{}(class extends Qc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(e,t,n):e.flush(this)}}),nl=new x(e=>e.complete());function rl(e){return e?function(e){return new x(t=>e.schedule(()=>t.complete()))}(e):nl}function il(...e){let t=e[e.length-1];return I(t)?(e.pop(),F(e,t)):W(e)}function ol(e,t){return new x(t?n=>t.schedule(sl,0,{error:e,subscriber:n}):t=>t.error(e))}function sl({error:e,subscriber:t}){t.error(e)}class al{constructor(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}accept(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}toObservable(){switch(this.kind){case"N":return il(this.value);case"E":return ol(this.error);case"C":return rl()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new al("N",e):al.undefinedValueNotification}static createError(e){return new al("E",void 0,e)}static createComplete(){return al.completeNotification}}al.completeNotification=new al("C"),al.undefinedValueNotification=new al("N",void 0);class ul extends v{constructor(e,t,n=0){super(e),this.scheduler=t,this.delay=n}static dispatch(e){const{notification:t,destination:n}=e;t.observe(n),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(ul.dispatch,this.delay,new cl(e,this.destination)))}_next(e){this.scheduleMessage(al.createNext(e))}_error(e){this.scheduleMessage(al.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(al.createComplete()),this.unsubscribe()}}class cl{constructor(e,t){this.notification=e,this.destination=t}}class ll extends T{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new hl(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,n=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,i=n.length;let o;if(this.closed)throw new S;if(this.isStopped||this.hasError?o=g.EMPTY:(this.observers.push(e),o=new A(this,e)),r&&e.add(e=new ul(e,r)),t)for(let s=0;s<i&&!e.closed;s++)e.next(n[s]);else for(let s=0;s<i&&!e.closed;s++)e.next(n[s].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||tl).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length;let o=0;for(;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r}}class hl{constructor(e,t){this.time=e,this.value=t}}function dl(e,t){return"function"==typeof t?n=>n.pipe(dl((n,r)=>B(e(n,r)).pipe(C((e,i)=>t(n,e,r,i))))):t=>t.lift(new fl(e))}class fl{constructor(e){this.project=e}call(e,t){return t.subscribe(new pl(e,this.project))}}class pl extends U{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const n=new z(this),r=this.destination;r.add(n),this.innerSubscription=V(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;e&&!e.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const gl={schedule(e,t){const n=setTimeout(e,t);return()=>clearTimeout(n)},scheduleBeforeRender(e){if("undefined"==typeof window)return gl.schedule(e,0);if(void 0===window.requestAnimationFrame)return gl.schedule(e,16);const t=window.requestAnimationFrame(e);return()=>window.cancelAnimationFrame(t)}};let ml;function yl(e,t,n){let r=n;return function(e){return!!e&&e.nodeType===Node.ELEMENT_NODE}(e)&&t.some((t,n)=>!("*"===t||!function(e,t){if(!ml){const e=Element.prototype;ml=e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}return e.nodeType===Node.ELEMENT_NODE&&ml.call(e,t)}(e,t)||(r=n,0))),r}class vl{constructor(e,t){this.componentFactory=t.get(Rs).resolveComponentFactory(e)}create(e){return new bl(this.componentFactory,e)}}class bl{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new ll(1),this.events=this.eventEmitters.pipe(dl(e=>$(...e))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:e})=>e)),this.ngZone=this.injector.get(Su),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null!==this.componentRef&&null===this.scheduledDestroyFn&&(this.scheduledDestroyFn=gl.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{var n,r;null!==this.componentRef?((n=t)!==(r=this.getInputValue(e))&&(n==n||r==r)||void 0===t&&this.unchangedInputs.has(e))&&(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=bo.create({providers:[],parent:this.injector}),n=function(e,t){const n=e.childNodes,r=t.map(()=>[]);let i=-1;t.some((e,t)=>"*"===e&&(i=t,!0));for(let o=0,s=n.length;o<s;++o){const e=n[o],s=yl(e,t,i);-1!==s&&r[s].push(e)}return r}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,n,e),this.viewChangeDetectorRef=this.componentRef.injector.get(ca),this.implementsOnChanges="function"==typeof this.componentRef.instance.ngOnChanges,this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(Hu).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:t,templateName:n})=>e.instance[t].pipe(C(e=>({name:n,value:e}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=gl.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const n=this.inputChanges[e];if(n)return void(n.currentValue=t);const r=this.unchangedInputs.has(e),i=r?void 0:this.getInputValue(e);this.inputChanges[e]=new lt(i,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class _l extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}function wl(e,t,n,r){return a(n)&&(r=n,n=void 0),r?wl(e,t,n).pipe(C(e=>d(e)?r(...e):r(e))):new x(r=>{xl(e,t,function(e){r.next(arguments.length>1?Array.prototype.slice.call(arguments):e)},r,n)})}function xl(e,t,n,r,i){let o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){const r=e;e.addEventListener(t,n,i),o=()=>r.removeEventListener(t,n,i)}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){const r=e;e.on(t,n),o=()=>r.off(t,n)}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){const r=e;e.addListener(t,n),o=()=>r.removeListener(t,n)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let o=0,s=e.length;o<s;o++)xl(e[o],t,n,r,i)}r.add(o)}function El(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function Sl(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(t){o(t)}}function a(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})}class Al extends T{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new S;return this._value}next(e){super.next(this._value=e)}}Object.create(Error.prototype);const kl=(()=>{function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e})();function Tl(e){return t=>0===e?rl():t.lift(new Ol(e))}class Ol{constructor(e){if(this.total=e,this.total<0)throw new kl}call(e,t){return t.subscribe(new Il(e,this.total))}}class Il extends v{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}function Cl(e,t){return function(n){return n.lift(new Dl(e,t))}}class Dl{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new jl(e,this.predicate,this.thisArg))}}class jl extends v{constructor(e,t,n){super(e),this.predicate=t,this.thisArg=n,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}function Pl(e){return function(t){const n=new Ml(e),r=t.lift(n);return n.caught=r}}class Ml{constructor(e){this.selector=e}call(e,t){return t.subscribe(new Rl(e,this.selector,this.caught))}}class Rl extends U{constructor(e,t,n){super(e),this.selector=t,this.caught=n}error(e){if(!this.isStopped){let n;try{n=this.selector(e,this.caught)}catch(t){return void super.error(t)}this._unsubscribeAndRecycle();const r=new z(this);this.add(r);const i=V(n,r);i!==r&&this.add(i)}}}function Nl(e=null){return t=>t.lift(new Ll(e))}class Ll{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new Fl(e,this.defaultValue))}}class Fl extends v{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function Bl(){}class zl{constructor(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}call(e,t){return t.subscribe(new Ul(e,this.nextOrObserver,this.error,this.complete))}}class Ul extends v{constructor(e,t,n,r){super(e),this._tapNext=Bl,this._tapError=Bl,this._tapComplete=Bl,this._tapError=n||Bl,this._tapComplete=r||Bl,a(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||Bl,this._tapError=t.error||Bl,this._tapComplete=t.complete||Bl)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}class Vl{constructor(e){this.total=e}call(e,t){return t.subscribe(new Gl(e,this.total))}}class Gl extends v{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}let Hl=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["","gaEvent","","gaCategory",""],["","gaCategory",""]],inputs:{gaCategory:"gaCategory"},exportAs:["gaCategory"]}),e})();const ql=new Wn("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),Wl=new Wn("ngx-window",{providedIn:"root",factory:()=>_c(cr(uu))?window:null}),$l=new Wn("ngx-data-layer",{providedIn:"root",factory:()=>function(e){return e?e.dataLayer=e.dataLayer||[]:null}(cr(Wl))}),Xl=new Wn("ngx-gtag-fn",{providedIn:"root",factory:()=>function(e,t){return e?e.gtag=e.gtag||function(){t.push(arguments)}:null}(cr(Wl),cr($l))});let Kl=(()=>{class e{constructor(e,t,n){this.settings=e,this._document=t,this._gtag=n}get document(){return this._document}throw(e){(this.settings.enableTracing||Fu())&&console&&console.error&&console.error(e)}toKeyValue(e){return e.size>0?Array.from(e).reduce((e,[t,n])=>Object.defineProperty(e,t,{value:n,enumerable:!0}),{}):void 0}gtag(...e){try{this._gtag(...e.filter(e=>void 0!==e))}catch(t){this.throw(t)}}event(e,t,n,r,i){try{const o=new Map;t&&o.set("event_category",t),n&&o.set("event_label",n),r&&o.set("value",r),void 0!==i&&o.set("interaction",i);const s=this.toKeyValue(o);s?this.gtag("event",e,s):this.gtag("event",e)}catch(o){this.throw(o)}}pageView(e,t,n,r){try{const i=new Map([["page_path",e]]);t&&i.set("page_title",t),(n||this.document)&&i.set("page_location",n||this.document.location.href),r&&Object.entries(r).map(([e,t])=>i.set(e,t)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(i))}catch(i){this.throw(i)}}appView(e,t,n,r,i){try{const o=new Map([["screen_name",e],["app_name",t]]);n&&o.set("app_id",n),r&&o.set("app_version",r),i&&o.set("app_installer_id",i),this.gtag("event","screen_view",this.toKeyValue(o))}catch(o){this.throw(o)}}set(...e){try{this._gtag("set",...e)}catch(t){this.throw(t)}}exception(e,t){try{const n=new Map;e&&n.set("description",e),t&&n.set("fatal",t),this.toKeyValue(n)?this.gtag("event","exception",this.toKeyValue(n)):this.gtag("event","exception")}catch(n){this.throw(n)}}}return e.\u0275fac=function(t){return new(t||e)(ur(ql),ur(Yu),ur(Xl))},e.\u0275prov=pe({factory:function(){return new e(ur(ql),ur(Yu),ur(Xl))},token:e,providedIn:"root"}),e})(),Zl=(()=>{class e{constructor(e,t,n,r){this.gaCategoryDirective=e,this.gaService=t,this.settings=n,this.el=r,this.gaBind="click"}set gaBind(e){this.bindSubscription&&this.bindSubscription.unsubscribe(),this._gaBind=e,this.bindSubscription=wl(this.el.nativeElement,e).subscribe(()=>this.trigger())}get gaBind(){return this._gaBind}ngOnDestroy(){this.bindSubscription&&this.bindSubscription.unsubscribe()}trigger(){try{if(!this.gaAction&&!this.gaEvent)throw new Error("You must provide a gaAction attribute to identify this event.");this.gaService.event(this.gaAction||this.gaEvent,this.gaCategoryDirective?this.gaCategoryDirective.gaCategory:void 0,this.gaLabel||this.label,this.gaValue,this.gaInteraction)}catch(e){this.throw(e)}}throw(e){(Fu()||this.settings.enableTracing)&&console&&console.warn&&console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)(No(Hl,8),No(Kl),No(ql),No(Bs))},e.\u0275dir=Ye({type:e,selectors:[["","gaEvent",""]],inputs:{gaBind:"gaBind",gaAction:"gaAction",gaLabel:"gaLabel",label:"label",gaValue:"gaValue",gaInteraction:"gaInteraction",gaEvent:"gaEvent"},exportAs:["gaEvent"]}),e})();const Yl={provide:nu,multi:!0,useFactory:function(e,t,n){return()=>Sl(this,void 0,void 0,function*(){var r;if(!e.trackingCode)return void(Fu()||console.error("Empty tracking code for Google Analytics. Make sure to provide one when initializing NgxGoogleAnalyticsModule."));if(!t)return void(Fu()||console.error("Was not possible create or read gtag() fn. Make sure this module is running on a Browser w/ access to Window interface."));n||Fu()||console.error("Was not possible to access Document interface. Make sure this module is running on a Browser w/ access do Document interface."),e.uri=e.uri||`https://www.googletagmanager.com/gtag/js?id=${e.trackingCode}`,e.initCommands=null!==(r=null==e?void 0:e.initCommands)&&void 0!==r?r:[],e.initCommands.find(e=>"config"===e.command)||e.initCommands.unshift({command:"config",values:[e.trackingCode]}),e.initCommands.find(e=>"js"===e.command)||e.initCommands.unshift({command:"js",values:[new Date]});for(const n of e.initCommands)t(n.command,...n.values);const i=n.createElement("script");i.async=!0,i.src=e.uri,e.nonce&&i.setAttribute("nonce",e.nonce),n.getElementsByTagName("head")[0].appendChild(i)})},deps:[ql,Xl,Yu]};new Wn("ngx-google-analytics-routing-settings",{factory:()=>({})});let Ql=(()=>{class e{static forRoot(t,n=[],r,i,o){return{ngModule:e,providers:[{provide:ql,useValue:{trackingCode:t,initCommands:n,uri:r,enableTracing:i,nonce:o}},Yl]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[]]}),e})(),Jl=(()=>{class e{static forRoot(t){const{providers:n=[]}=Ql.forRoot(t.gaToken,function(e){const{appName:t,projectName:n,developmentMode:r}=e;return[{command:"set",values:[(i={appName:t,projectName:n,developmentMode:r},Object.entries(i).reduce((e,[t,n])=>(null!=n&&(e[t]=`${n}`),e),{}))]}];var i}(t));return{ngModule:e,providers:n}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[Ql]]}),e})();const eh={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],organNodes:["http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0002049"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org",hubmapToken:localStorage.getItem("HUBMAP_TOKEN")||""},googleAnalyticsToken:"G-ERNVZ1Q4KE"};function th(e){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const t="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=e||t;return!!(n&&n.indexOf("Electron")>=0)}function nh(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||th()}const rh="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",ih=nh();class oh{constructor(e,t,n="sessionStorage"){this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(t){return null}}(n),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function sh(e,t,n,r=600){const i=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));const o=e.width*n,s=e.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),a]}const ah={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function uh(e){return"string"==typeof e?ah[e.toUpperCase()]||ah.WHITE:e}function ch(e,t){if(!e)throw new Error(t||"Assertion failed")}const lh={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},hh=lh.window||lh.self||lh.global,dh=lh.process||{};function fh(){let e;if(ih&&hh.performance)e=hh.performance.now();else if(dh.hrtime){const t=dh.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}console;const ph={debug:ih&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},gh={enabled:!0,level:0};function mh(){}const yh={},vh={once:!0};function bh(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}let _h=(()=>{class e{constructor({id:e}={id:""}){this.id=e,this.VERSION=rh,this._startTs=fh(),this._deltaTs=fh(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new oh("__probe-".concat(this.id,"__"),gh),this.userData={},this.timeStamp("".concat(this.id," started")),function(e,t=["constructor"]){const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n);for(const i of r)"function"==typeof e[i]&&(t.find(e=>i===e)||(e[i]=e[i].bind(e)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((fh()-this._startTs).toPrecision(10))}getDelta(){return Number((fh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.updateConfiguration({enabled:e}),this}setLevel(e){return this._storage.updateConfiguration({level:e}),this}assert(e,t){ch(e,t)}warn(e){return this._getLogFunction(0,e,ph.warn,arguments,vh)}error(e){return this._getLogFunction(0,e,ph.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,ph.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,ph.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,ph.debug||ph.info,arguments,vh)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||mh,n&&[n],{tag:bh(t)}):mh}image({logLevel:e,priority:t,image:r,message:i="",scale:o=1}){return this._shouldLog(e||t)?ih?function({image:e,message:t="",scale:n=1}){if("string"==typeof e){const r=new Image;return r.onload=()=>{const e=sh(r,t,n);console.log(...e)},r.src=e,mh}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...sh(e,t,n)),mh;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...sh(r,t,n)),r.src=e.toDataURL(),mh}return mh}({image:r,message:i,scale:o}):function({image:e,message:t="",scale:r=1}){let i=null;try{i=n(307)}catch(o){}return i?()=>i(e,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then(e=>console.log(e)):mh}({image:r,message:i,scale:o}):mh}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(e){return this._storage.config[e]}set(e,t){this._storage.updateConfiguration({[e]:t})}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||mh)}group(e,t,n={collapsed:!1}){n=xh({logLevel:e,message:t,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,t,n={}){return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||mh)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=wh(e)}_getLogFunction(e,t,n,r=[],i){if(this._shouldLog(e)){i=xh({logLevel:e,message:t,args:r,opts:i}),ch(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=fh();const o=i.tag||i.message;if(i.once){if(yh[o])return mh;yh[o]=fh()}return t=function(e,t,n){if("string"==typeof t){const s=n.time?function(e,t=8){const n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}(function(e){let t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}(n.total)):"";r=t=n.time?"".concat(e,": ").concat(s,"  ").concat(t):"".concat(e,": ").concat(t),i=n.color,o=n.background,ih||"string"!=typeof r||(i&&(i=uh(i),r="\x1b[".concat(i,"m").concat(r,"\x1b[39m")),o&&(i=uh(o),r="\x1b[".concat(o+10,"m").concat(r,"\x1b[49m"))),t=r}var r,i,o;return t}(this.id,i.message,i),n.bind(console,t,...i.args)}return mh}}return e.VERSION=rh,e})();function wh(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return ch(Number.isFinite(t)&&t>=0),t}function xh(e){const{logLevel:t,message:n}=e;e.logLevel=wh(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(e.args=r,typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const i=typeof e.message;return ch("string"===i||"object"===i),Object.assign(e,e.opts)}const Eh=new _h({id:"deck"});var Sh={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Sh,"IDENTITY",{get:function(){return Eh.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0}});var Ah={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},kh={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function Th(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ih(e,t,n){return t&&Oh(e.prototype,t),n&&Oh(e,n),e}function Ch(e){return(Ch=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dh(e,t,n){return(Dh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ch(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function jh(e,t){return(jh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ph(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jh(e,t)}function Mh(e){return(Mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nh(e,t){return!t||"object"!==Mh(t)&&"function"!=typeof t?Rh(e):t}function Lh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fh(e,t){if(e){if("string"==typeof e)return Lh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lh(e,t):void 0}}function Bh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(u){a=!0,i=u}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e,t)||Fh(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Uh=new _h({id:"luma.gl"});function Vh(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function Gh(e){return"undefined"!=typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&Number.isFinite(e._version))}function Hh(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function qh(e){return Vh(Gh(e),"Invalid WebGLRenderingContext"),e}function Wh(e){return Vh(Hh(e),"Requires WebGL2"),e}var $h=n(761);const Xh={},Kh=function e(t){const n=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const t=new e.VertexAttrib(n);this.attribs[r]=t}this.maxAttrib=0};(Kh.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Zh=function(e){const t=this;this.gl=e,function(e){const t=e.getError;e.getError=function(){let n;do{n=t.apply(e),0!==n&&(Xh[n]=!0)}while(0!==n);for(n in Xh)if(Xh[n])return delete Xh[n],parseInt(n,10);return 0}}(e);const n=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(e){return e===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(e){const r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);const i=r.attribs[e];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(e){const r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);const i=r.attribs[e];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(e,r){switch(e){case 34962:t.currentArrayBuffer=r;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(e,r){const i=t.currentVertexArrayObject,o=i.attribs[e];switch(r){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(e,r,i,o,s,a){const u=t.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,e);const c=u.attribs[e];return c.buffer=t.currentArrayBuffer,c.size=r,c.type=i,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{$h.CO.console&&$h.CO.console.log&&$h.CO.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};Zh.prototype.VERTEX_ARRAY_BINDING_OES=34229,Zh.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new Kh(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Zh.prototype.createVertexArrayOES=function(){const e=new Kh(this);return this.vertexArrayObjects.push(e),e},Zh.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},Zh.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Kh&&e.hasBeenBound&&e.ext===this)},Zh.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return n="bindVertexArrayOES: attempt to bind deleted arrayObject",Xh[1282]=!0,void($h.CO.console&&$h.CO.console.error&&$h.CO.console.error(n));var n;const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const o=this.currentVertexArrayObject;if(i===o)return;i&&o.elementArrayBuffer===i.elementArrayBuffer||r.bindBuffer.call(t,34963,o.elementArrayBuffer);let s=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,o.maxAttrib);for(let u=0;u<=a;u++){const e=o.attribs[u],n=i?i.attribs[u]:null;if(i&&e.enabled===n.enabled||(e.enabled?r.enableVertexAttribArray.call(t,u):r.disableVertexAttribArray.call(t,u)),e.enabled){let o=!1;i&&e.buffer===n.buffer||(s!==e.buffer&&(r.bindBuffer.call(t,34962,e.buffer),s=e.buffer),o=!0),(o||e.cached!==n.cached)&&r.vertexAttribPointer.call(t,u,e.size,e.type,e.normalized,e.stride,e.offset)}}this.currentArrayBuffer!==s&&r.bindBuffer.call(t,34962,this.currentArrayBuffer)};const Yh="OES_element_index",Qh="WEBGL_draw_buffers",Jh="WEBGL_debug_renderer_info",ed=e=>Hh(e)?void 0:0,td={3074:e=>Hh(e)?void 0:36064,35723:e=>Hh(e)?void 0:4352,35977:ed,32937:ed,36795:(e,t)=>{const n=Hh(e)?e.getExtension("EXT_disjoint_timer_query_webgl2"):e.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?t(n.GPU_DISJOINT_EXT):0},37445:(e,t)=>{const n=e.getExtension(Jh);return t(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(e,t)=>{const n=e.getExtension(Jh);return t(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(e,t)=>{const n=e.luma.extensions.EXT_texture_filter_anisotropic;return n?t(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:ed,35071:ed,37447:ed,36063:(e,t)=>{if(!Hh(e)){const n=e.getExtension(Qh);return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:ed,35374:ed,35377:ed,34852:e=>{if(!Hh(e)){const t=e.getExtension(Qh);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},36203:e=>e.getExtension(Yh)?2147483647:65535,33001:e=>e.getExtension(Yh)?16777216:65535,33e3:e=>16777216,37157:ed,35373:ed,35657:ed,36183:ed,37137:ed,34045:ed,35978:ed,35979:ed,35968:ed,35376:ed,35375:ed,35659:ed,37154:ed,35371:ed,35658:ed,35076:ed,35077:ed,35380:ed},nd={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Vh(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},ANGLE_instanced_arrays:{meta:{suffix:"ANGLE"},vertexAttribDivisor(e,t){Vh(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Vh(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Vh(!1)},deleteQuery:()=>{Vh(!1)},beginQuery:()=>{Vh(!1)},endQuery:()=>{},getQuery(e,t){return this.getQueryObject(e,t)},getQueryParameter(e,t){return this.getQueryObject(e,t)},getQueryObject:()=>{}}},rd={readBuffer:(e,t,n)=>{Hh(e)&&t(n)},getVertexAttrib:(e,t,n,r)=>{const{webgl2:i,ext:o}=function(e,t){return{webgl2:Hh(e),ext:e.getExtension("ANGLE_instanced_arrays")}}(e);let s;switch(r){case 35069:s=!!i&&void 0;break;case 35070:s=i||o?void 0:0}return void 0!==s?s:t(n,r)},getProgramParameter:(e,t,n,r)=>{if(!Hh(e))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return t(n,r)},getInternalformatParameter:(e,t,n,r,i)=>{if(!Hh(e))switch(i){case 32937:return new Int32Array([0])}return e.getInternalformatParameter(n,r,i)},getTexParameter(e,t,n,r){switch(r){case 34046:const{extensions:t}=e.luma,n=t.EXT_texture_filter_anisotropic;r=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return t(n,r)},getParameter:function(e,t,n){const r=td[n],i="function"==typeof r?r(e,t,n):r;return void 0!==i?i:t(n)},hint:(e,t,n,r)=>t(n,r)};function id(e,{extension:t,target:n,target2:r}){const i=nd[t];Vh(i);const{meta:o={}}=i,{suffix:s=""}=o,a=e.getExtension(t);for(const u of Object.keys(i)){const t="".concat(u).concat(s);let o=null;"meta"===u||"function"==typeof e[u]||(a&&"function"==typeof a[t]?o=(...e)=>a[t](...e):"function"==typeof i[u]&&(o=i[u].bind(n))),o&&(n[u]=o,r[u]=o)}}("undefined"!=typeof global?global:window).polyfillContext=function(e){e.luma=e.luma||{};const{luma:t}=e;return t.polyfilled||(function(e){if("function"==typeof e.createVertexArray)return;const t=e.getSupportedExtensions;e.getSupportedExtensions=function(){const e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e};const n=e.getExtension;e.getExtension=function(t){return n.call(this,t)||("OES_vertex_array_object"!==t?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Zh(this)),this.__OESVertexArrayObject))}}(e),function(e){e.luma.extensions={};const t=e.getSupportedExtensions()||[];for(const n of t)e.luma[n]=e.getExtension(n)}(e),function(e,t){for(const n of Object.getOwnPropertyNames(t))"overrides"!==n&&id(e,{extension:n,target:e.luma,target2:e})}(e,nd),function(e,{target:t,target2:n}){Object.keys(rd).forEach(r=>{if("function"==typeof rd[r]){const i=e[r]?e[r].bind(e):()=>{},o=rd[r].bind(null,e,i);t[r]=o,n[r]=o}})}(e,{target:t,target2:e}),t.polyfilled=!0),e};const od={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},sd=(e,t,n)=>t?e.enable(n):e.disable(n),ad=(e,t,n)=>e.hint(n,t),ud=(e,t,n)=>e.pixelStorei(n,t);function cd(e){return Array.isArray(e)||ArrayBuffer.isView(e)}const ld={3042:sd,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:sd,2885:(e,t)=>e.cullFace(t),2929:sd,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:sd,35723:ad,36006:(e,t)=>{const n=Hh(e)?36009:36160;return e.bindFramebuffer(n,t)},2886:(e,t)=>e.frontFace(t),33170:ad,2849:(e,t)=>e.lineWidth(t),32823:sd,32824:"polygonOffset",10752:"polygonOffset",35977:sd,32938:"sampleCoverage",32939:"sampleCoverage",3089:sd,3088:(e,t)=>e.scissor(...t),2960:sd,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),3333:ud,3317:ud,37440:ud,37441:ud,37443:ud,3330:ud,3332:ud,3331:ud,36010:(e,t)=>e.bindFramebuffer(36008,t),3314:ud,32878:ud,3316:ud,3315:ud,32877:ud,framebuffer:(e,t)=>e.bindFramebuffer(36160,t&&"handle"in t?t.handle:t),blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{t=cd(t)?t:[t,t],e.blendEquationSeparate(...t)},blendFunc:(e,t)=>{t=cd(t)&&2===t.length?[...t,...t]:t,e.blendFuncSeparate(...t)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=cd(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,r)},stencilFunc:(e,t)=>{t=cd(t)&&3===t.length?[...t,...t]:t;const[n,r,i,o,s,a]=t;e.stencilFuncSeparate(1028,n,r,i),e.stencilFuncSeparate(1029,o,s,a)},stencilOp:(e,t)=>{t=cd(t)&&3===t.length?[...t,...t]:t;const[n,r,i,o,s,a]=t;e.stencilOpSeparate(1028,n,r,i),e.stencilOpSeparate(1029,o,s,a)},viewport:(e,t)=>e.viewport(...t)};function hd(e,t,n){return void 0!==t[e]?t[e]:n[e]}const dd={blendEquation:(e,t,n)=>e.blendEquationSeparate(hd(32777,t,n),hd(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(hd(32969,t,n),hd(32968,t,n),hd(32971,t,n),hd(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(hd(32824,t,n),hd(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(hd(32938,t,n),hd(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,hd(2962,t,n),hd(2967,t,n),hd(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,hd(34816,t,n),hd(36003,t,n),hd(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,hd(2964,t,n),hd(2965,t,n),hd(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,hd(34817,t,n),hd(34818,t,n),hd(34819,t,n))},fd={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},blendColor:(e,t,n,r,i)=>e({32773:new Float32Array([t,n,r,i])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,r,i)=>e({32969:t,32968:n,32971:r,32970:i}),clearColor:(e,t,n,r,i)=>e({3106:new Float32Array([t,n,r,i])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,r,i)=>e({3107:[t,n,r,i]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,r,i)=>e({3088:new Int32Array([t,n,r,i])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,r)=>e({2962:t,2967:n,2963:r,34816:t,36003:n,36004:r}),stencilFuncSeparate:(e,t,n,r,i)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:r,[1028===t?2963:36004]:i}),stencilOp:(e,t,n,r)=>e({2964:t,2965:n,2966:r,34817:t,34818:n,34819:r}),stencilOpSeparate:(e,t,n,r,i)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:r,[1028===t?2966:34819]:i}),viewport:(e,t,n,r,i)=>e({2978:[t,n,r,i]})},pd=(e,t)=>e.isEnabled(t),gd={3042:pd,2884:pd,2929:pd,3024:pd,32823:pd,32926:pd,32928:pd,3089:pd,2960:pd,35977:pd};function md(e){for(const t in e)return!1;return!0}function yd(e,t){if(e===t)return!0;const n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}function vd(e,t){const n=e[t].bind(e);e[t]=function(...t){const r=t[0];return r in e.state.cache||(e.state.cache[r]=n(...t)),e.state.enable?e.state.cache[r]:n(...t)},Object.defineProperty(e[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function bd(e,t,n){const r=e[t].bind(e);e[t]=function(...t){const{valueChanged:i,oldValue:o}=n(e.state._updateCache,...t);return i&&r(...t),o},Object.defineProperty(e[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}class _d{constructor(e,{copyState:t=!1,log:n=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(e,t){if("number"==typeof(t=t||od)){const n=t,r=gd[n];return r?r(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),r={};for(const i of n){const t=gd[i];r[i]=t?t(e,Number(i)):e.getParameter(Number(i))}return r}(e):Object.assign({},od),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Vh(this.stateStack.length>0),Ed(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const i in e){Vh(void 0!==i);const o=e[i],s=this.cache[i];yd(o,s)||(n=!0,t=s,r&&!(i in r)&&(r[i]=s),this.cache[i]=o)}return{valueChanged:n,oldValue:t}}}function wd(e,t={}){const{enable:n=!0,copyState:r}=t;if(Vh(void 0!==r),!e.state){const t="undefined"!=typeof global?global:window,{polyfillContext:n}=t;n&&n(e),e.state=new _d(e,{copyState:r}),function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){e.state.program!==n&&(t(n),e.state.program=n)}}(e);for(const r in fd)bd(e,r,fd[r]);vd(e,"getParameter"),vd(e,"isEnabled")}return e.state.enable=n,e}function xd(e){Vh(e.state),e.state.pop()}function Ed(e,t){if(Vh(Gh(e),"setParameters requires a WebGL context"),md(t))return;const n={};for(const i in t){const r=Number(i),o=ld[i];o&&("string"==typeof o?n[o]=!0:o(e,t[i],r))}const r=e.state&&e.state.cache;if(r)for(const i in n)(0,dd[i])(e,t,r)}function Sd(e,t,n){if(md(t))return n(e);const{nocatch:r=!0}=t;let i;if(function(e){e.state||wd(e,{copyState:!1}),e.state.push()}(e),Ed(e,t),r)i=n(e),xd(e);else try{i=n(e)}finally{xd(e)}return i}function Ad(e){const{luma:t}=e;if(e.canvas&&t){const{clientWidth:n}=t.canvasSizeInfo;return n?e.drawingBufferWidth/n:1}return 1}function kd(e,t,n=!0){return function(e,t,n,r,i){const o=Td(e[0],t,n);let s=Od(e[1],t,r,i),a=Td(e[0]+1,t,n);const u=a===n-1?a:a-1;let c;return a=Od(e[1]+1,t,r,i),i?(a=0===a?a:a+1,c=s,s=a):c=a===r-1?a:a-1,{x:o,y:s,width:Math.max(u-o+1,1),height:Math.max(c-s+1,1)}}(t,Ad(e),e.drawingBufferWidth,e.drawingBufferHeight,n)}function Td(e,t,n){return Math.min(Math.round(e*t),n-1)}function Od(e,t,n,r){return r?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}const Id=(0,$h.jU)(),Cd=Id&&"undefined"!=typeof document,Dd={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function jd(e={}){Vh(Id,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),e=Object.assign({},Dd,e);const{width:t,height:n}=e;function r(t){if(e.throwOnError)throw new Error(t);return console.error(t),null}let i;e.onError=r;const{canvas:o}=e;return i=function(e,t){const{onError:n}=t;let r=null;const i=e=>r=e.statusMessage||r;e.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:s=!0}=t;let a=null;return s&&(a=a||e.getContext("webgl2",t),a=a||e.getContext("experimental-webgl2",t)),o&&(a=a||e.getContext("webgl",t),a=a||e.getContext("experimental-webgl",t)),e.removeEventListener("webglcontextcreationerror",i,!1),a?(t.onContextLost&&e.addEventListener("webglcontextlost",t.onContextLost,!1),t.onContextRestored&&e.addEventListener("webglcontextrestored",t.onContextRestored,!1),a):n("Failed to create ".concat(s&&!o?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}(function({canvas:e,width:t=800,height:n=600,onError:r}){let i;return"string"==typeof e?(Cd&&"complete"===document.readyState||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),i=document.getElementById(e)):e?i=e:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",i.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",document.body.insertBefore(i,document.body.firstChild)),i}({canvas:o,width:t,height:n,onError:r}),e),i?(i=Pd(i,e),function(e){const t=Hh(e)?"WebGL2":"WebGL1",n=function(e){const t=e.getParameter(7936),n=e.getParameter(7937),r=e.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&e.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||t,renderer:r&&e.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:t,rendererMasked:n,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}(e),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=e.debug?" debug":"";Uh.info(1,"".concat(t).concat(i," context ").concat(r))()}(i),i):null}function Pd(e,t={}){if(!e||e._instrumented)return e;e._version=e._version||function(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext?2:1}(e),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{},t=Object.assign({},Dd,t);const{manageState:n,debug:r}=t;return n&&wd(e,{copyState:!1,log:(...e)=>Uh.log(1,...e)()}),Id&&r&&($h.CO.makeDebugContext?(e=$h.CO.makeDebugContext(e,t),Uh.level=Math.max(Uh.level,1)):Uh.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),e._instrumented=!0,e}function Md(){let e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}class Rd{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Md(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Md()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Nd{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(e=>this._getOrCreate(e))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:n}=e;return this.stats[t]||(this.stats[t]=e instanceof Rd?e:new Rd(t,n)),this.stats[t]}}const Ld="8.5.2",Fd=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new Nd({id:e})),this.stats.get(e)}};if($h.CO.luma&&$h.CO.luma.VERSION!==Ld)throw new Error("luma.gl - multiple VERSIONs detected: ".concat($h.CO.luma.VERSION," vs ").concat(Ld));function Bd(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}function zd(e,t){if("string"!=typeof t)return t;const n=Number(t);if(!isNaN(n))return n;const r=e[t=t.replace(/^.*\./,"")];return Bd(void 0!==r,"Accessing undefined constant GL.".concat(t)),r}function Ud(e,t){t=Number(t);for(const n in e)if(e[n]===t)return"GL.".concat(n);return String(t)}$h.CO.luma||((0,$h.jU)()&&Uh.log(1,"luma.gl ".concat(Ld," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),$h.CO.luma=$h.CO.luma||{VERSION:Ld,version:Ld,log:Uh,stats:Fd,globals:{modules:{},nodeIO:{}}});const Vd={};function Gd(e="id"){Vd[e]=Vd[e]||1;const t=Vd[e]++;return"".concat(e,"-").concat(t)}function Hd(e){return Bd("number"==typeof e,"Input must be a number"),e&&0==(e&e-1)}function qd(e){let t=!0;for(const n in e){t=!1;break}return t}function Wd(e,t,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(e);r.forEach(e=>{o.methodName||(o[e]=()=>{throw Uh.removed("Calling removed method ".concat(t,".").concat(e,": "),i)(),new Error(e)})})}const $d="Resource subclass must define virtual methods";class Xd{constructor(e,t={}){qh(e);const{id:n,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=n||Gd(this.constructor.name),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(e=>e.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){Bd(e=zd(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=Hh(this.gl);if("webgl2"in n&&!e||"extension"in n&&!this.gl.getExtension(n.extension)){const t=n.webgl1,r="webgl2"in n?n.webgl2:n.webgl1;return e?r:t}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:n}=e,r=this.constructor.PARAMETERS||{},i=Hh(this.gl),o={},s=t||Object.keys(r);for(const a of s){const t=r[a];if(t&&(!("webgl2"in t)||i)&&(!("extension"in t)||this.gl.getExtension(t.extension))){const r=n?Ud(this.gl,a):a;o[r]=this.getParameter(a,e),n&&"GLenum"===t.type&&(o[r]=Ud(this.gl,o[r]))}}return o}setParameter(e,t){Bd(e=zd(this.gl,e));const n=(this.constructor.PARAMETERS||{})[e];if(n){const e=Hh(this.gl);if("webgl2"in n&&!e||"extension"in n&&!this.gl.getExtension(n.extension))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(t=zd(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,n){return Wd(this,e,t,n)}initialize(e){}_createHandle(){throw new Error($d)}_deleteHandle(){throw new Error($d)}_bindHandle(e){throw new Error($d)}_getOptsFromHandle(){throw new Error($d)}_getParameter(e,t){throw new Error($d)}_setParameter(e,t){throw new Error($d)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,t=Fd.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get("".concat(e,"s Created")).incrementCount(),t.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this.constructor.name;Fd.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e,t=this.constructor.name){const n=Fd.get("Memory Usage");n.get("GPU Memory").addCount(e),n.get("".concat(t," Memory")).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this.constructor.name){const t=Fd.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get("".concat(e," Memory")).subtractCount(this.byteLength),this.byteLength=0}}function Kd(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Zd(e,{clamped:t=!0}={}){switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Yd({data:e,width:t,height:n}){const r=Math.round(t/2),i=Math.round(n/2),o=new Uint8Array(r*i*4);for(let s=0;s<i;s++)for(let n=0;n<r;n++)for(let i=0;i<4;i++)o[4*(s*r+n)+i]=e[4*(2*s*t+2*n)+i];return{data:o,width:r,height:i}}function Qd(e,t,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:o={}}=n;for(const a in r)if(a in t){const t=r[a]?"".concat(e,".").concat(r[a]):"N/A";Uh.removed("".concat(e,".").concat(a),t)()}for(const a in i)if(a in t){const t=i[a];Uh.deprecated("".concat(e,".").concat(a),"".concat(e,".").concat(t))()}let s=null;for(const a in o)if(a in t){const n=o[a];Uh.deprecated("".concat(e,".").concat(a),"".concat(e,".").concat(n))(),s=s||Object.assign({},t),s[n]=t[a],delete s[a]}return s||t}const Jd={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},ef={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class tf{static getBytesPerElement(e){return Zd(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Bd(e.size),Zd(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new tf(...[Jd,...e])}constructor(...e){e.forEach(e=>this._assign(e)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return tf.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return tf.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=Qd("Accessor",e,ef)).type&&(this.type=e.type,5124!==e.type&&5125!==e.type||(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const nf={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},rf={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:nf},of={removedProps:nf};class sf extends Xd{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/tf.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/tf.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=Qd("Buffer",e,rf),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=Qd("Buffer",e,of))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new tf(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:n=0,srcOffset:r=0}=e,i=e.byteLength||e.length;Bd(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==i?(Wh(this.gl),this.gl.bufferSubData(this.target,n,t,r,i)):this.gl.bufferSubData(o,n,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:n=0,size:r}){const{gl:i}=this;return Wh(i),i.bindBuffer(36662,e.handle),i.bindBuffer(36663,this.handle),i.copyBufferSubData(36662,36663,t,n,r),i.bindBuffer(36662,null),i.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:n=0,length:r=0}={}){Wh(this.gl);const i=Zd(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),s=n;let a,u;e?(u=e.length,a=u-s):(a=Math.min(o,r||o),u=s+a);const c=Math.min(o,a);return Bd((r=r||c)<=c),e=e||new i(u),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,n,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:n=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,n,r):(Bd(0===n),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,n=e.byteLength+t){Bd(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const i=Kd(e);return Bd(i),this.setAccessor(new tf(this.accessor,{type:i})),this}_setByteLength(e,t=this.usage){Bd(e>=0),this._trackDeallocatedMemory();let n=e;0===e&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const t=e/Zd(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-t}_inferType(e){this.accessor.type||this.setAccessor(new tf(this.accessor,{type:Kd(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return Uh.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Uh.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Uh.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Uh.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new tf(this.accessor,e),this}}const af={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},uf={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},cf={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},lf=[9729,9728],hf=$h.CO.WebGLBuffer||function(){};class df extends Xd{static isSupported(e,t={}){const{format:n,linearFiltering:r}=t;let i=!0;return n&&(i=i&&function(e,t){const n=af[t];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const r=Hh(e)&&n.gl2||n.gl1;return"string"==typeof r?e.getExtension(r):r}(e,n),i=i&&(!r||function(e,t){const n=af[t];switch(n&&n.types[0]){case 5126:return e.getExtension("OES_texture_float_linear");case 5131:return e.getExtension("OES_texture_half_float_linear");default:return!0}}(e,n))),i}constructor(e,t){const{id:n=Gd("texture"),handle:r,target:i}=t;super(e,{id:n,handle:r}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(t=>this.initialize(Object.assign({},e,{pixels:t,data:t}))),this;const n="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:i=6408,border:o=0,recreate:s=!1,parameters:a={},pixelStore:u={},textureUnit:c}=e;t||(t=r);let{width:l,height:h,dataFormat:d,type:f,compressed:p=!1,mipmaps:g=!0}=e;const{depth:m=0}=e;return({width:l,height:h,compressed:p,dataFormat:d,type:f}=this._deduceParameters({format:i,type:f,dataFormat:d,compressed:p,data:t,width:l,height:h})),this.width=l,this.height=h,this.depth=m,this.format=i,this.type=f,this.dataFormat=d,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(Uh.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:t,width:l,height:h,depth:m,format:i,type:f,dataFormat:d,border:o,mipmaps:g,parameters:u,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),s&&(this.data=t),n&&(this._video={video:t,parameters:a,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:n}=this._video;if(n===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:n=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:n}):this}generateMipmap(e={}){return this._isNPOT()?(Uh.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Sd(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:n=null,level:r=0,format:i=this.format,border:o=this.border,offset:s=0,parameters:a={}}=e;let{data:u=null,type:c=this.type,width:l=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:f=!1}=e;u||(u=n),({type:c,dataFormat:d,compressed:f,width:l,height:h}=this._deduceParameters({format:i,type:c,dataFormat:d,compressed:f,data:u,width:l,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;return({data:u,dataType:m}=this._getDataType({data:u,compressed:f})),Sd(this.gl,a,()=>{switch(m){case"null":p.texImage2D(t,r,i,l,h,o,d,c,u);break;case"typed-array":p.texImage2D(t,r,i,l,h,o,d,c,u,s);break;case"buffer":g=Wh(p),g.bindBuffer(35052,u.handle||u),g.texImage2D(t,r,i,l,h,o,d,c,s),g.bindBuffer(35052,null);break;case"browser-object":Hh(p)?p.texImage2D(t,r,i,l,h,o,d,c,u):p.texImage2D(t,r,i,d,c,u);break;case"compressed":for(const[e,n]of u.entries())p.compressedTexImage2D(t,e,n.format,n.width,n.height,o,n.data);break;default:Bd(!1,"Unknown image data type")}}),this._trackAllocatedMemory(u&&u.byteLength?u.byteLength:this.width*this.height*(uf[this.dataFormat]||4)*(cf[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:n=null,x:r=0,y:i=0,width:o=this.width,height:s=this.height,level:a=0,format:u=this.format,type:c=this.type,dataFormat:l=this.dataFormat,compressed:h=!1,offset:d=0,border:f=this.border,parameters:p={}}){if(({type:c,dataFormat:l,compressed:h,width:o,height:s}=this._deduceParameters({format:u,type:c,dataFormat:l,compressed:h,data:n,width:o,height:s})),Bd(0===this.depth,"texSubImage not supported for 3D textures"),n||(n=t),n&&n.data){const e=n;n=e.data,o=e.shape[0],s=e.shape[1]}n instanceof sf&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),Sd(this.gl,p,()=>{if(h)this.gl.compressedTexSubImage2D(e,a,r,i,o,s,u,n);else if(null===n)this.gl.texSubImage2D(e,a,r,i,o,s,l,c,null);else if(ArrayBuffer.isView(n))this.gl.texSubImage2D(e,a,r,i,o,s,l,c,n,d);else if(n instanceof hf){const t=Wh(this.gl);t.bindBuffer(35052,n),t.texSubImage2D(e,a,r,i,o,s,l,c,d),t.bindBuffer(35052,null)}else Hh(this.gl)?Wh(this.gl).texSubImage2D(e,a,r,i,o,s,l,c,n):this.gl.texSubImage2D(e,a,r,i,l,c,n)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return Uh.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof sf?{data:e.handle,dataType:"buffer"}:e instanceof hf?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:n}=e;let{width:r,height:i,dataFormat:o,type:s,compressed:a}=e;const u=af[t];return o=o||u&&u.dataFormat,s=s||u&&u.types[0],a=a||u&&u.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:o,type:s,compressed:a,width:r,height:i,format:t,data:n}}_deduceImageSize(e,t,n){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:n}:{width:t>=0?t:1,height:n>=0?n:1},Bd(r,"Could not deduced texture size"),Bd(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),Bd(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:Bd(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(Hh(this.gl)||!this.width||!this.height||Hd(this.width)&&Hd(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===lf.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}class ff extends df{static isSupported(e,t){return df.isSupported(e,t)}constructor(e,t={}){var n;qh(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:(n=t.data,Bd("string"==typeof n),n=""+n,new Promise((e,t)=>{try{const r=new Image;r.onload=()=>e(r),r.onerror=()=>t(new Error("Could not load image ".concat(n,"."))),r.crossOrigin="anonymous",r.src=n}catch(r){t(r)}}))})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const pf="EXT_color_buffer_float",gf={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:pf,bpp:2},33327:{gl2:pf,bpp:4},34842:{gl2:pf,bpp:8},33326:{gl2:pf,bpp:4},33328:{gl2:pf,bpp:8},34836:{gl2:pf,bpp:16},35898:{gl2:pf,bpp:4}};class mf extends Xd{static isSupported(e,{format:t}={format:null}){return!t||function(e,t,n){const r=n[t];if(!r)return!1;const i=Hh(e)&&r.gl2||r.gl1;return"string"==typeof i?e.getExtension(i):i}(e,t,gf)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:n=1,samples:r=0}){return Bd(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&Hh(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,n):this.gl.renderbufferStorage(36161,e,t,n),this.format=e,this.width=t,this.height=n,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*gf[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const yf="clear: bad arguments";function vf(e,{framebuffer:t=null,color:n=null,depth:r=null,stencil:i=null}={}){const o={};t&&(o.framebuffer=t);let s=0;n&&(s|=16384,!0!==n&&(o.clearColor=n)),r&&(s|=256,!0!==r&&(o.clearDepth=r)),i&&(s|=1024,!0!==r&&(o.clearStencil=r)),Bd(0!==s,yf),Sd(e,o,()=>{e.clear(s)})}const bf=[34069,34070,34071,34072,34073,34074];let _f=(()=>{class e extends df{constructor(e,t={}){qh(e),super(e,Object.assign({},t,{target:34067})),this.initialize(t),Object.seal(this)}initialize(e={}){const{mipmaps:t=!0,parameters:n={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,t&&this.generateMipmap(e),this.setParameters(n)}),this}subImage({face:e,data:t,x:n=0,y:r=0,mipmapLevel:i=0}){return this._subImage({target:e,data:t,x:n,y:r,mipmapLevel:i})}async setCubeMapImageData({width:e,height:t,pixels:n,data:r,border:i=0,format:o=6408,type:s=5121}){const{gl:a}=this,u=n||r,c=await Promise.all(bf.map(e=>{const t=u[e];return Promise.all(Array.isArray(t)?t:[t])}));this.bind(),bf.forEach((n,r)=>{c[r].length>1&&!1!==this.opts.mipmaps&&Uh.warn("".concat(this.id," has mipmap and multiple LODs."))(),c[r].forEach((r,u)=>{e&&t?a.texImage2D(n,u,o,e,t,i,o,s,r):a.texImage2D(n,u,o,o,s,r)})}),this.unbind()}setImageDataForFace(e){const{face:t,width:n,height:r,pixels:i,data:o,border:s=0,format:a=6408,type:u=5121}=e,{gl:c}=this,l=i||o;return this.bind(),l instanceof Promise?l.then(n=>this.setImageDataForFace(Object.assign({},e,{face:t,data:n,pixels:n}))):this.width||this.height?c.texImage2D(t,0,a,n,r,s,a,u,l):c.texImage2D(t,0,a,a,u,l),this}}return e.FACES=bf,e})();class wf extends df{static isSupported(e){return Hh(e)}constructor(e,t={}){Wh(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:n,height:r,depth:i=1,border:o=0,format:s,type:a=5121,offset:u=0,data:c,parameters:l={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Sd(this.gl,l,()=>{ArrayBuffer.isView(c)&&this.gl.texImage3D(this.target,e,t,n,r,i,o,s,a,c),c instanceof sf&&(this.gl.bindBuffer(35052,c.handle),this.gl.texImage3D(this.target,e,t,n,r,i,o,s,a,u))}),this._trackAllocatedMemory(c&&c.byteLength?c.byteLength:this.width*this.height*this.depth*(uf[this.dataFormat]||4)*(cf[this.type]||1),"Texture"),this.loaded=!0,this}}function xf(e,t){const{gl:n,width:r,height:i,id:o}=e;return new kf(n,Object.assign({},t,{id:"framebuffer-for-".concat(o),width:r,height:i,attachments:{36064:e}}))}function Ef(e,t={}){const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=t;let{sourceAttachment:o=36064,target:s=null,sourceWidth:a,sourceHeight:u,sourceType:c}=t;const{framebuffer:l,deleteFramebuffer:h}=function(e){return e instanceof kf?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:xf(e),deleteFramebuffer:!0}}(e);Bd(l);const{gl:d,handle:f,attachments:p}=l;var g,m,y,v;a=a||l.width,u=u||l.height,36064===o&&null===f&&(o=1028),Bd(p[o]),c=c||p[o].type,g=c,m=i,y=a,v=u,s=s||new(Zd(g=g||5121,{clamped:!1}))(y*v*function(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Bd(!1),0}}(m)),c=c||Kd(s);const b=d.bindFramebuffer(36160,f);return d.readPixels(n,r,a,u,i,c,s),d.bindFramebuffer(36160,b||null),h&&l.delete(),s}function Sf(e,{sourceAttachment:t=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}={}){let r=Ef(e,{sourceAttachment:t}),{width:i,height:o}=e;for(;o>n;)({data:r,width:i,height:o}=Yd({data:r,width:i,height:o}));!function({data:e,width:t,height:n,bytesPerPixel:r=4,temp:i}){const o=t*r;i=i||new Uint8Array(o);for(let s=0;s<n/2;++s){const t=s*o,r=(n-s-1)*o;i.set(e.subarray(t,t+o)),e.copyWithin(t,r,r+o),e.set(i,r)}}({data:r,width:i,height:o});const s=document.createElement("canvas");s.width=i,s.height=o;const a=s.getContext("2d"),u=a.createImageData(i,o);return u.data.set(r),a.putImageData(u,0,0),s.toDataURL()}const Af="Multiple render targets not supported";class kf extends Xd{static isSupported(e,t={}){const{colorBufferFloat:n,colorBufferHalfFloat:r}=t;let i=!0;return n&&(i=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new kf(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Wh(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Wh(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:n=null,color:r=!0,depth:i=!0,stencil:o=!1,check:s=!0,readBuffer:a,drawBuffers:u}){if(Bd(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,n)for(const c in n){const r=n[c];(Array.isArray(r)?r[0]:r).resize({width:e,height:t})}else n=this._createDefaultAttachments(r,i,o,e,t);this.update({clearAttachments:!0,attachments:n,readBuffer:a,drawBuffers:u}),n&&s&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:n,clearAttachments:r=!1,resizeAttachments:i=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:i});const{gl:o}=this,s=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),n&&this._setDrawBuffers(n),o.bindFramebuffer(36160,s||null),this}resize(e={}){let{width:t,height:n}=e;if(null===this.handle)return Bd(void 0===t&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),t!==this.width&&n!==this.height&&Uh.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(t,"x").concat(n))();for(const r in this.attachments)this.attachments[r].resize({width:t,height:n});return this.width=t,this.height=n,this}attach(e,{clearAttachments:t=!1,resizeAttachments:n=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(e=>{r[e]=null}),Object.assign(r,e);const i=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){Bd(void 0!==o,"Misspelled framebuffer binding point?");const e=Number(o),t=r[e];let i=t;if(i)if(i instanceof mf)this._attachRenderbuffer({attachment:e,renderbuffer:i});else if(Array.isArray(t)){const[n,r=0,o=0]=t;i=n,this._attachTexture({attachment:e,texture:n,layer:r,level:o})}else this._attachTexture({attachment:e,texture:i,layer:0,level:0});else this._unattach(e);n&&i&&i.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(e=>!this.attachments[e]).forEach(e=>{delete this.attachments[e]})}checkStatus(){const e=this.getStatus();if(36053!==e)throw new Error(function(e){return(kf.STATUS||{})[e]||"Framebuffer error ".concat(e)}(e));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),n=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),n}clear(e={}){const{color:t,depth:n,stencil:r,drawBuffers:i=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||n||r)&&vf(this.gl,{color:t,depth:n,stencil:r}),i.forEach((e,t)=>{!function(e,{framebuffer:t=null,buffer:n=6144,drawBuffer:r=0,value:i=[0,0,0,0]}={}){Wh(e),Sd(e,{framebuffer:t},()=>{switch(n){case 6144:switch(i.constructor){case Int32Array:e.clearBufferiv(n,r,i);break;case Uint32Array:e.clearBufferuiv(n,r,i);break;case Float32Array:default:e.clearBufferfv(n,r,i)}break;case 6145:e.clearBufferfv(6145,0,[i]);break;case 6146:e.clearBufferiv(6146,0,[i]);break;case 34041:const[t,o]=i;e.clearBufferfi(34041,0,t,o);break;default:Bd(!1,yf)}})}(this.gl,{drawBuffer:t,value:e})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return Uh.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return Uh.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return Uh.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return Uh.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return Uh.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return Uh.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:n=0,width:r,height:i}){const o=Wh(this.gl),s=o.bindFramebuffer(36008,this.handle);return 0===t&&0===n&&void 0===r&&void 0===i?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,n,r,i),o.bindFramebuffer(36008,s),this}getAttachmentParameter(e,t,n){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=Ud(this.gl,r)),r}getAttachmentParameters(e=36064,t,n=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const i of n)r[t?Ud(this.gl,i):i]=this.getAttachmentParameter(e,i,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),n={};for(const r of t){const t=Number(r);n[e?Ud(this.gl,t):t]=this.getAttachmentParameters(t,e)}return n}show(){return"undefined"!=typeof window&&window.open(Sf(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>Uh.level||"undefined"==typeof window)return this;t=t||"Framebuffer ".concat(this.id);const n=Sf(this,{targetMaxHeight:100});return Uh.image({logLevel:e,message:t,image:n},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,n,r,i){let o=null;return e&&(o=o||{},o[36064]=new ff(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&n?(o=o||{},o[33306]=new mf(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new mf(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:i}),this.ownResources.push(o[36096])):n&&Bd(!1),o}_unattach(e){const t=this.attachments[e];t&&(t instanceof mf?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:n}=this;n.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:n,level:r}){const{gl:i}=this;switch(i.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:Wh(i).framebufferTextureLayer(36160,e,t.target,r,n);break;case 34067:const o=function(e){return e<34069?e+34069:e}(n);i.framebufferTexture2D(36160,e,o,t.handle,r);break;case 3553:i.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:Bd(!1,"Illegal texture type")}i.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=Hh(n=this.gl)?n:null;var n;t?t.readBuffer(e):Bd(36064===e||1029===e,Af),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,n=Wh(t);if(n)n.drawBuffers(e);else{const n=t.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(e):Bd(1===e.length&&(36064===e[0]||1029===e[0]),Af)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(e){e.luma=e.luma||{},e.luma.caps=e.luma.caps||{};for(const t in Df)void 0===e.luma.caps[t]&&(e.luma.caps[t]=Mf(e,t));return e.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}kf.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Tf="TIMER_QUERY",Of="ELEMENT_INDEX_UINT32",If="GLSL_DERIVATIVES",Cf="GLSL_TEXTURE_LOD",Df={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],[Tf]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],[Of]:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(e){const t=new ff(e,{format:6408,type:5126,dataFormat:6408}),n=new kf(e,{id:"test-framebuffer",check:!1,attachments:{36064:t}}),r=n.getStatus();return t.delete(),n.delete(),36053===r},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],[If]:["OES_standard_derivatives",!0],[Cf]:["EXT_shader_texture_lod",!0]};function jf(e,t){return Pf(e,t)}function Pf(e,t){return(t=Array.isArray(t)?t:[t]).every(t=>Mf(e,t))}function Mf(e,t){return e.luma=e.luma||{},e.luma.caps=e.luma.caps||{},void 0===e.luma.caps[t]&&(e.luma.caps[t]=function(e,t){const n=Df[t];let r;Bd(n,t);const i=Hh(e)&&n[1]||n[0];if("function"==typeof i)r=i(e);else if(Array.isArray(i)){r=!0;for(const t of i)r=r&&Boolean(e.getExtension(t))}else"string"==typeof i?r=Boolean(e.getExtension(i)):"boolean"==typeof i?r=i:Bd(!1);return r}(e,t)),e.luma.caps[t]||Uh.log(2,"Feature: ".concat(t," not supported"))(),e.luma.caps[t]}function Rf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Nf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rf(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rf(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Lf=function(){function e(t,n){Th(this,e),this.opts=n,this.source=t}return Ih(e,[{key:"getValue",value:function(){var e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];var n=this.source.value,r=t.size,i=n;if(n&&n.length!==r){i=new Float32Array(r);for(var o=t.elementOffset||0,s=0;s<r;++s)i[s]=n[o+s]}return i}},{key:"getAccessor",value:function(){return Nf(Nf({},this.source.getAccessor()),this.opts)}},{key:"value",get:function(){return this.source.value}}]),e}();const Ff=new(function(){function e(t){Th(this,e),this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(t)}return Ih(e,[{key:"setProps",value:function(e){Object.assign(this.props,e)}},{key:"allocate",value:function(e,t,n){var r,i=n.size,o=void 0===i?1:i,s=n.padding,a=void 0===s?0:s,u=n.copy,c=void 0!==u&&u,l=n.initialize,h=void 0!==l&&l,d=n.maxCount,f=n.type||e&&e.constructor||Float32Array,p=t*o+a;if(ArrayBuffer.isView(e)){if(p<=e.length)return e;if(p*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new f(e.buffer,0,p)}d&&(r=d*o+a);var g=this._allocate(f,p,h,r);return e&&c?g.set(e):h||g.fill(0,0,4),this._release(e),g}},{key:"release",value:function(e){this._release(e)}},{key:"_allocate",value:function(e,t,n,r){var i=Math.max(Math.ceil(t*this.props.overAlloc),1);i>r&&(i=r);var o=this._pool,s=e.BYTES_PER_ELEMENT*i,a=o.findIndex(function(e){return e.byteLength>=s});if(a>=0){var u=new e(o.splice(a,1)[0],0,i);return n&&u.fill(0),u}return new e(i)}},{key:"_release",value:function(e){if(ArrayBuffer.isView(e)){var t=this._pool,n=e.buffer,r=n.byteLength,i=t.findIndex(function(e){return e.byteLength>=r});i<0?t.push(n):(i>0||t.length<this.props.poolSize)&&t.splice(i,0,n),t.length>this.props.poolSize&&t.shift()}}}]),e}()),Bf=(Math,1/180*Math.PI),zf={};function Uf(e,{precision:t=zf.precision||4}={}){return e=function(e){return Math.round(e/zf.EPSILON)*zf.EPSILON}(e),"".concat(parseFloat(e.toPrecision(t)))}function Vf(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Gf(e,t,n){if(Vf(e)){n=n||((r=e).clone?r.clone():new Array(r.length));for(let r=0;r<n.length&&r<e.length;++r)n[r]=t(e[r],r,n);return n}var r;return t(e)}function Hf(e){return function(e,t){return Gf(e,e=>e*Bf,void 0)}(e)}function qf(e,t,n){return Gf(e,e=>Math.max(t,Math.min(n,e)))}function Wf(e,t,n){return Vf(e)?e.map((e,r)=>Wf(e,t[r],n)):n*t+(1-n)*e}function $f(e,t,n){const r=zf.EPSILON;n&&(zf.EPSILON=n);try{if(e===t)return!0;if(Vf(e)&&Vf(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!$f(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):!(!Number.isFinite(e)||!Number.isFinite(t))&&Math.abs(e-t)<=zf.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{zf.EPSILON=r}}function Xf(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}zf.EPSILON=1e-12,zf.debug=!1,zf.precision=4,zf.printTypes=!1,zf.printDegrees=!1,zf.printRowMajor=!0;class Kf extends(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Array)){get ELEMENTS(){return Xf(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}to(e){return e===this?this:Vf(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(zf)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+Uf(this[n],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!$f(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){void 0===n&&(n=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const i=e[r];this[r]=i+n*(t[r]-i)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]+=t[e];return this.check()}subtract(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]-=t[e];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(zf.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function Zf(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(e));return e}function Yf(e,t,n=""){if(zf.debug&&!function(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e,t))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return e}const Qf={};function Jf(e,t){Qf[e]||(Qf[e]=!0,console.warn("".concat(e," has been removed in version ").concat(t,", see upgrade guide for more information")))}class ep extends Kf{get ELEMENTS(){return Xf(!1),0}copy(e){return Xf(!1),this}get x(){return this[0]}set x(e){this[0]=Zf(e)}get y(){return this[1]}set y(e){this[1]=Zf(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-e[n];t+=r*r}return Zf(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return Zf(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t[e];return this.check()}divide(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Xf(e>=0&&e<this.ELEMENTS,"index is out of range"),Zf(this[e])}setComponent(e,t){return Xf(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var tp=1e-6,np="undefined"!=typeof Float32Array?Float32Array:Array;function rp(){var e=new np(3);return np!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ip(e,t,n){var r=new np(3);return r[0]=e,r[1]=t,r[2]=n,r}function op(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function sp(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],u=n[2];return e[0]=i*u-o*a,e[1]=o*s-r*u,e[2]=r*a-i*s,e}function ap(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/(s=s||1),e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,e}function up(e,t,n){const r=t[0],i=t[1],o=n[3]*r+n[7]*i||1;return e[0]=(n[0]*r+n[4]*i)/o,e[1]=(n[1]*r+n[5]*i)/o,e}function cp(e,t,n){const r=t[0],i=t[1],o=t[2],s=n[3]*r+n[7]*i+n[11]*o||1;return e[0]=(n[0]*r+n[4]*i+n[8]*o)/s,e[1]=(n[1]*r+n[5]*i+n[9]*o)/s,e[2]=(n[2]*r+n[6]*i+n[10]*o)/s,e}Math,Math,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),rp();const lp=[0,0,0],hp={};class dp extends ep{static get ZERO(){return hp.ZERO=hp.ZERO||Object.freeze(new dp(0,0,0,0))}constructor(e=0,t=0,n=0){super(-0,-0,-0),1===arguments.length&&Vf(e)?this.copy(e):(zf.debug&&(Zf(e),Zf(t),Zf(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return zf.debug&&(Zf(e.x),Zf(e.y),Zf(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Zf(e)}angle(e){return function(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],s=t[1],a=t[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+a*a),c=u&&op(e,t)/u;return Math.acos(Math.min(Math.max(c,-1),1))}(this,e)}cross(e){return sp(this,this,e),this.check()}rotateX({radians:e,origin:t=lp}){return function(e,t,n,r){var i=[],o=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=lp}){return function(e,t,n,r){var i=[],o=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=lp}){return function(e,t,n,r){var i=[],o=[];i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ap(this,this,e),this.check()}transformAsVector(e){return cp(this,this,e),this.check()}transformByMatrix3(e){return function(e,t,n){var r=t[0],i=t[1],o=t[2];e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8]}(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){const r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(e,t,n){var r=n[0],i=n[1],o=n[2],s=t[0],a=t[1],u=t[2],c=i*u-o*a,l=o*s-r*u,h=r*a-i*s,d=i*h-o*l,f=o*c-r*h,p=r*l-i*c,g=2*n[3];l*=g,h*=g,f*=2,p*=2,e[0]=s+(c*=g)+(d*=2),e[1]=a+l+f,e[2]=u+h+p}(this,this,e),this.check()}}var fp,pp=new dp;function gp(e,t,n,r){pp.set(e,t,n);var i=pp.len();return{distance:r/i,normal:new dp(-e/i,-t/i,-n/i)}}function mp(e,t){var n=t.size,r=void 0===n?1:n,i=t.startIndex,o=void 0===i?0:i,s=t.endIndex;Number.isFinite(s)||(s=e.length);var a=(s-o)/r;fp=Ff.allocate(fp,a,{type:Float32Array,size:2*r});for(var u,c=o,l=0;c<s;){for(var h=0;h<r;h++){var d=e[c++];fp[l+h]=d,fp[l+h+r]=(u=d)-Math.fround(u)}l+=2*r}return fp.subarray(0,a*r*2)}function yp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yp(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yp(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function bp(e){return e.stride||e.size*e.bytesPerElement}function _p(e,t){t.offset&&Eh.removed("shaderAttribute.offset","vertexOffset, elementOffset")();var n=bp(e),r=("vertexOffset"in t?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return vp(vp({},t),{},{offset:r,stride:n})}var wp=function(){function e(t,n){Th(this,e),this.gl=t,this.id=n.id,this.size=n.size;var r=n.logicalType||n.type,i=5130===r,o=n.defaultValue;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),n.defaultValue=o;var s=r;i?s=5126:!s&&n.isIndexed?s=t&&jf(t,Of)?5125:5123:s||(s=5126),n.logicalType=r,n.type=s;var a=function(e){switch(e){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||s||5126);this.shaderAttributes={},this.doublePrecision=i,i&&!1===n.fp64&&(a=Float32Array),n.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=n,this.state={externalBuffer:null,bufferAccessor:n,allocatedValue:null,constant:!1},this._buffer=null,this.setData(n)}return Ih(e,[{key:"delete",value:function(){this._buffer&&(this._buffer.delete(),this._buffer=null),Ff.release(this.state.allocatedValue)}},{key:"getShaderAttributes",value:function(e,t){if(this.doublePrecision){var n={},r=this.value instanceof Float64Array,i={high:s=_p(o=this.getAccessor(),t||{}),low:vp(vp({},s),{},{offset:s.offset+4*o.size})};return n[e]=new Lf(this,i.high),n["".concat(e,"64Low")]=r?new Lf(this,i.low):new Float32Array(this.size),n}var o,s;if(t){var a=_p(this.getAccessor(),t);return zh({},e,new Lf(this,a))}return zh({},e,this)}},{key:"getBuffer",value:function(){return this.state.constant?null:this.state.externalBuffer||this._buffer}},{key:"getValue",value:function(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}},{key:"getAccessor",value:function(){return this.state.bufferAccessor}},{key:"setData",value:function(e){var t=this.state;ArrayBuffer.isView(e)?e={value:e}:e instanceof sf&&(e={buffer:e});var n=vp(vp({},this.settings),e);if(t.bufferAccessor=n,e.constant){var r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){var i=e.buffer;t.externalBuffer=i,t.constant=!1,this.value=e.value;var o=e.value instanceof Float64Array;n.type=e.type||i.accessor.type,n.bytesPerElement=i.accessor.BYTES_PER_ELEMENT*(o?2:1),n.stride=bp(n)}else if(e.value){this._checkExternalBuffer(e);var s=e.value;t.externalBuffer=null,t.constant=!1,this.value=s,n.bytesPerElement=s.BYTES_PER_ELEMENT,n.stride=bp(n);var a=this.buffer,u=this.byteOffset;this.doublePrecision&&s instanceof Float64Array&&(s=mp(s,n));var c=s.byteLength+u+2*n.stride;a.byteLength<c&&a.reallocate(c),a.setAccessor(null),a.subData({data:s,offset:u}),n.type=e.type||a.accessor.type}return!0}},{key:"updateSubBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.value,n=e.startOffset,r=void 0===n?0:n,i=e.endOffset;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?mp(t,{size:this.size,startIndex:r,endIndex:i}):t.subarray(r,i),offset:r*t.BYTES_PER_ELEMENT+this.byteOffset})}},{key:"allocate",value:function(e){var t=e.copy,n=void 0!==t&&t,r=this.state,i=r.allocatedValue,o=Ff.allocate(i,e.numInstances+1,{size:this.size,type:this.defaultType,copy:n});this.value=o;var s=this.buffer,a=this.byteOffset;return s.byteLength<o.byteLength+a&&(s.reallocate(o.byteLength+a),n&&i&&s.subData({data:i instanceof Float64Array?mp(i,this):i,offset:a})),r.allocatedValue=o,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}},{key:"_checkExternalBuffer",value:function(e){var t=e.value;if(!e.constant&&t){var n=this.defaultType,r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));t instanceof n||!this.settings.normalized||"normalized"in e||Eh.warn("Attribute ".concat(this.id," is normalized"))()}}},{key:"_normalizeConstant",value:function(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(function(e){return(e+128)/255*2-1});case 5122:return new Float32Array(e).map(function(e){return(e+32768)/65535*2-1});case 5121:return new Float32Array(e).map(function(e){return e/255});case 5123:return new Float32Array(e).map(function(e){return e/65535});default:return e}}},{key:"_normalizeValue",value:function(e,t,n){var r=this.settings,i=r.defaultValue,o=r.size;if(Number.isFinite(e))return t[n]=e,t;if(!e)return t[n]=i[0],t;switch(o){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:for(var s=o;--s>=0;)t[n+s]=Number.isFinite(e[s])?e[s]:i[s]}return t}},{key:"_areValuesEqual",value:function(e,t){if(!e||!t)return!1;for(var n=this.size,r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},{key:"buffer",get:function(){if(!this._buffer){var e=this.settings;this._buffer=new sf(this.gl,{id:this.id,target:e.isIndexed?34963:34962,accessor:{type:e.type}})}return this._buffer}},{key:"byteOffset",get:function(){var e=this.getAccessor();return e.vertexOffset?e.vertexOffset*bp(e):0}}]),e}();function xp(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}var Ep=[],Sp=[];function Ap(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=Ep,i={index:-1,data:e,target:[]};return e?"function"==typeof e[Symbol.iterator]?r=e:e.length>0&&(Sp.length=e.length,r=Sp):r=Ep,(t>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(t,n),i.index=t-1),{iterable:r,objectInfo:i}}function kp(e){return e&&e[Symbol.asyncIterator]}function Tp(e,t){var n=t.size,r=t.stride,i=t.offset,o=t.startIndices,s=t.nested,a=e.BYTES_PER_ELEMENT,u=r?r/a:n,c=i?i/a:0,l=Math.floor((e.length-c)/u);return function(t,r){var i=r.index,a=r.target;if(!o){for(var h=i*u+c,d=0;d<n;d++)a[d]=e[h+d];return a}var f,p=o[i],g=o[i+1]||l;if(s){f=new Array(g-p);for(var m=p;m<g;m++){var y=m*u+c;a=new Array(n);for(var v=0;v<n;v++)a[v]=e[y+v];f[m-p]=a}}else if(u===n)f=e.subarray(p*n+c,g*n+c);else{f=new e.constructor((g-p)*n);for(var b=0,_=p;_<g;_++)for(var w=_*u+c,x=0;x<n;x++)f[b++]=e[w+x]}return f}}function Op(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};return Array.isArray(e)?Ip(e,t,[]):t(e)?[e]:[]}function Ip(e,t,n){for(var r=-1;++r<e.length;){var i=e[r];Array.isArray(i)?Ip(i,t,n):t(i)&&n.push(i)}return n}function Cp(e){for(var t=e.target,n=e.source,r=e.start,i=void 0===r?0:r,o=e.count,s=n.length,a=(void 0===o?1:o)*s,u=0,c=i;u<s;u++)t[c++]=n[u];for(;u<a;)u<a-u?(t.copyWithin(i+u,i,i+u),u*=2):(t.copyWithin(i+u,i,i+a-u),u=a);return t}var Dp=[],jp=[[0,1/0]];function Pp(e,t){if(e===jp)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;for(var n=[],r=e.length,i=0,o=0;o<r;o++){var s=e[o];s[1]<t[0]?(n.push(s),i=o+1):s[0]>t[1]?n.push(s):t=[Math.min(s[0],t[0]),Math.max(s[1],t[1])]}return n.splice(i,0,t),n}function Mp(e){var t=e.source,n=e.target,r=e.start,i=void 0===r?0:r,o=e.end,s=e.size,a=e.getData,u=t.length,c=(o=o||n.length)-i;if(u>c)n.set(t.subarray(0,c),i);else if(n.set(t,i),a)for(var l=u;l<c;)for(var h=a(l,t),d=0;d<s;d++)n[i+l]=h[d]||0,l++}var Rp={interpolation:{duration:0,easing:function(e){return e}},spring:{stiffness:.05,damping:.5}};function Np(e,t){return e?(Number.isFinite(e)&&(e={duration:e}),e.type=e.type||"interpolation",Object.assign({},Rp[e.type],t,e)):null}function Lp(e,t){return t.getBuffer()?[t.getBuffer(),{divisor:0,size:t.size,normalized:t.settings.normalized}]:t.value}function Fp(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(e,'"'))}}function Bp(e){e.push(e.shift())}function zp(e,t){var n=e.value,r=e.doublePrecision&&n instanceof Float64Array?2:1;return(e.settings.noAlloc?n.length:t*e.size)*r}function Up(e){var t=e.buffer,n=e.attribute,r=e.fromLength,i=e.fromStartIndices,o=e.getData,s=void 0===o?function(e){return e}:o,a=n.doublePrecision&&n.value instanceof Float64Array?2:1,u=n.size*a,c=n.byteOffset,l=n.startIndices,h=i&&l,d=zp(n,e.numInstances),f=n.state.constant;if(h||!(r>=d)){var p=f?n.value:n.getBuffer().getData({srcByteOffset:c});if(n.settings.normalized&&!f){var g=s;s=function(e,t){return n._normalizeConstant(g(e,t))}}var m=f?function(e,t){return s(p,t)}:function(e,t){return s(p.subarray(e,e+u),t)},y=t.getData({length:r}),v=new Float32Array(d);!function(e){var t=e.source,n=e.target,r=e.size,i=e.getData,o=e.sourceStartIndices,s=e.targetStartIndices;if(!Array.isArray(s))return Mp({source:t,target:n,size:r,getData:i}),n;for(var a=0,u=0,c=i&&function(e,t){return i(e+u,t)},l=Math.min(o.length,s.length),h=1;h<l;h++){var d=o[h]*r,f=s[h]*r;Mp({source:t.subarray(a,d),target:n,start:u,end:f,size:r,getData:c}),a=d,u=f}u<n.length&&Mp({source:[],target:n,start:u,size:r,getData:c})}({source:y,target:v,sourceStartIndices:i,targetStartIndices:l,size:u,getData:m}),t.byteLength<v.byteLength+c&&t.reallocate(v.byteLength+c),t.subData({data:v,offset:c})}}function Vp(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Gp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gp(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Gp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hp=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Th(this,i),t=r.call(this,e,n);var o=n.transition,s=void 0!==o&&o,a=n.noAlloc,u=void 0!==a&&a,c=n.update,l=void 0===c?null:c,h=n.accessor,d=void 0===h?null:h,f=n.transform,p=void 0===f?null:f,g=n.startIndices,m=void 0===g?null:g;return Object.assign(t.settings,{transition:s,noAlloc:u,update:l||d&&t._autoUpdater,accessor:d,transform:p}),Object.assign(t.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:jp,startIndices:m}),Object.seal(t.settings),Object.seal(t.state),t._validateAttributeUpdaters(),t}return Ih(i,[{key:"needsUpdate",value:function(){return this.state.needsUpdate}},{key:"needsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.clearChangedFlags,n=void 0!==t&&t,r=this.state.needsRedraw;return this.state.needsRedraw=r&&!n,r}},{key:"getUpdateTriggers",value:function(){var e=this.settings.accessor;return[this.id].concat("function"!=typeof e&&e||[])}},{key:"supportsTransition",value:function(){return Boolean(this.settings.transition)}},{key:"getTransitionSetting",value:function(e){if(!e||!this.supportsTransition())return null;var t=this.settings.accessor,n=this.settings.transition;return Np(Array.isArray(t)?e[t.find(function(t){return e[t]})]:e[t],n)}},{key:"setNeedsUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,t=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){var n=t.startRow,r=void 0===n?0:n,i=t.endRow,o=void 0===i?1/0:i;this.state.updateRanges=Pp(this.state.updateRanges,[r,o])}else this.state.updateRanges=jp}},{key:"clearNeedsUpdate",value:function(){this.state.needsUpdate=!1,this.state.updateRanges=Dp}},{key:"setNeedsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||e}},{key:"update",value:function(e){this.setData(e)}},{key:"allocate",value:function(e){var t=this.state,n=this.settings;return!n.noAlloc&&!!n.update&&(xp(Number.isFinite(e)),Dh(Ch(i.prototype),"allocate",this).call(this,{numInstances:e,copy:t.updateRanges!==jp}),!0)}},{key:"updateBuffer",value:function(e){var t=e.numInstances,n=e.data,r=e.props,o=e.context;if(!this.needsUpdate())return!1;var s=this.state.updateRanges,a=this.settings,u=a.update,c=a.noAlloc,l=!0;if(u){var h,d=Vp(s);try{for(d.s();!(h=d.n()).done;){var f=Bh(h.value,2);u.call(o,this,{data:n,startRow:f[0],endRow:f[1],props:r,numInstances:t})}}catch(w){d.e(w)}finally{d.f()}if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else{var p,g=Vp(s);try{for(g.s();!(p=g.n()).done;){var m=Bh(p.value,2),y=m[0],v=m[1],b=Number.isFinite(y)?this.getVertexOffset(y):0,_=Number.isFinite(v)?this.getVertexOffset(v):c||!Number.isFinite(t)?this.value.length:t*this.size;Dh(Ch(i.prototype),"updateSubBuffer",this).call(this,{startOffset:b,endOffset:_})}}catch(w){g.e(w)}finally{g.f()}}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}},{key:"setConstantValue",value:function(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}},{key:"setExternalBuffer",value:function(e){var t=this.state;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}},{key:"setBinaryValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.state,r=this.settings;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;n.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e});var i=r.transform||t!==this.startIndices;if(i){xp(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor));var o=e.size&&e.size!==this.size;return n.binaryAccessor=Tp(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}},{key:"getVertexOffset",value:function(e){var t=this.startIndices;return(t?t[e]:e)*this.size}},{key:"getShaderAttributes",value:function(){var e=this.settings.shaderAttributes||zh({},this.id,null),t={};for(var n in e)Object.assign(t,Dh(Ch(i.prototype),"getShaderAttributes",this).call(this,n,e[n]));return t}},{key:"_autoUpdater",value:function(e,t){var n=t.data,r=t.startRow,i=t.endRow,o=t.numInstances;if(!e.constant){var s=e.settings,a=e.value,u=e.size,c=e.startIndices,l=s.accessor,h=s.transform,d=e.state.binaryAccessor||("function"==typeof l?l:t.props[l]);xp("function"==typeof d,'accessor "'.concat(l,'" is not a function'));var f,p=e.getVertexOffset(r),g=Ap(n,r,i),m=g.objectInfo,y=Vp(g.iterable);try{for(y.s();!(f=y.n()).done;){var v=f.value;m.index++;var b=d(v,m);if(h&&(b=h.call(this,b)),c){var _=(m.index<c.length-1?c[m.index+1]:o)-c[m.index];if(b&&Array.isArray(b[0])){var w,x=p,E=Vp(b);try{for(E.s();!(w=E.n()).done;)e._normalizeValue(w.value,a,x),x+=u}catch(S){E.e(S)}finally{E.f()}}else b&&b.length>u?a.set(b,p):(e._normalizeValue(b,m.target,0),Cp({target:a,source:m.target,start:p,count:_}));p+=_*u}else e._normalizeValue(b,a,p),p+=u}}catch(S){y.e(S)}finally{y.f()}}}},{key:"_validateAttributeUpdaters",value:function(){var e=this.settings;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}},{key:"_checkAttributeArray",value:function(){var e=this.value,t=Math.min(4,this.size);if(e&&e.length>=t){var n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}},{key:"startIndices",get:function(){return this.state.startIndices},set:function(e){this.state.startIndices=e}}]),i}(wp),qp={};function Wp(e){var t;Eh.level>0&&qp[e]&&(t=qp[e]).call.apply(t,arguments)}function $p(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const Xp="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",Kp="#version 300 es\n".concat(Xp);function Zp(e,t){t=Array.isArray(t)?t:[t];const n=e.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;return t.includes(r)&&i&&o?{qualifier:r,type:i,name:o.split(";")[0]}:null}function Yp(e={}){const{version:t=100,input:n,inputType:r,output:i}=e;if(!n)return 300===t?Kp:t>300?"#version ".concat(t,"\n").concat(Xp):"void main() {gl_FragColor = vec4(0);}";const o=function(e,t){switch(t){case"float":return"vec4(".concat(e,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(e,", 0.0, 1.0)");case"vec3":return"vec4(".concat(e,", 1.0)");case"vec4":return e;default:return $p(!1),null}}(n,r);return t>=300?"#version ".concat(t," ").concat(300===t?"es":"","\nin ").concat(r," ").concat(n,";\nout vec4 ").concat(i,";\nvoid main() {\n  ").concat(i," = ").concat(o,";\n}"):"varying ".concat(r," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(o,";\n}")}class Qp extends Xd{static isSupported(e){return Hh(e)}constructor(e,t={}){Wh(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,qd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteSize:i,byteOffset:o}=this._getBufferParams(t);return n<0?(this.unused[e]=r,Uh.warn(()=>"".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[n]=t,this.bindOnUse||this._bindBuffer(n,r,o,i),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,n,r;return e instanceof sf==0?(r=e.buffer,n=e.byteSize,t=e.byteOffset):r=e,void 0===t&&void 0===n||(t=t||0,n=n||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:n}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,n=0,r){const i=t&&t.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,e,i,n,r):this.gl.bindBufferBase(35982,e,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class Jp{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=t;return{attributes:Object.assign({},n,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],n=e?t[e]:null;return n?n instanceof sf?n:n.buffer:null}getData(e={}){const{varyingName:t}=e,n=this.getBuffer(t);return n?n.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Bd(Hh(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const e=this.feedbackMap[r];r in t&&(n[e]=r)}Object.assign(n,e.feedbackBuffers);for(const r in n){const e=n[r];if("string"==typeof e){const i=t[e],{byteLength:o,usage:s,accessor:a}=i;n[r]=this._createNewBuffer(r,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const n=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:n})}_setupTransformFeedback(e,{model:t}){const{program:n}=t;e.transformFeedback=new Qp(this.gl,{program:n,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:t}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:e,feedbackBuffers:t})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),n=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const i=this.feedbackMap[r];t[r]=e.feedbackBuffers[i],n[i]=e.sourceBuffers[r],Bd(n[i]instanceof sf)}return{sourceBuffers:t,feedbackBuffers:n}}_createNewBuffer(e,t){const n=new sf(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function eg(e){let t=100;const n=e.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}return t}const tg="vs",ng="fs",rg={[tg]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[ng]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},ig="__LUMA_INJECT_DECLARATIONS__",og=/void\s+main\s*\([^)]*\)\s*\{\n?/,sg=/}\n?[^{}]*$/,ag=[];function ug(e,t,n,r=!1){const i=t===tg;for(const o in n){const t=n[o];t.sort((e,t)=>e.order-t.order),ag.length=t.length;for(let e=0,n=t.length;e<n;++e)ag[e]=t[e].injection;const r="".concat(ag.join("\n"),"\n");switch(o){case"vs:#decl":i&&(e=e.replace(ig,r));break;case"vs:#main-start":i&&(e=e.replace(og,e=>e+r));break;case"vs:#main-end":i&&(e=e.replace(sg,e=>r+e));break;case"fs:#decl":i||(e=e.replace(ig,r));break;case"fs:#main-start":i||(e=e.replace(og,e=>e+r));break;case"fs:#main-end":i||(e=e.replace(sg,e=>r+e));break;default:e=e.replace(o,e=>e+r)}}return e=e.replace(ig,""),r&&(e=e.replace(/\}\s*$/,e=>e+rg[t])),e}function cg(e){const t={};return $p(Array.isArray(e)&&e.length>1),e.forEach(e=>{for(const n in e)t[n]=t[n]?"".concat(t[n],"\n").concat(e[n]):e[n]}),t}const lg={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},hg="transform_uSize_",dg="transform_position",fg={10241:9728,10240:9728,10242:33071,10243:33071};class pg{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:n,framebuffer:r,targetTexture:i}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),s=Object.assign({},e.uniforms),a=Object.assign({},e.parameters);let u=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap)s[t]=n[this.samplerTextureMap[t]];this._setSourceTextureParameters();const e=function({sourceTextureMap:e,targetTextureVarying:t,targetTexture:n}){const r={};let i,o;t&&(({width:i,height:o}=n),r["".concat(hg).concat(t)]=[i,o]);for(const s in e)({width:i,height:o}=e[s]),r["".concat(hg).concat(s)]=[i,o];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(s,e)}return this.hasTargetTexture&&(u=!1,a.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:s,discard:u,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],n=Ef(t);if(!e)return n;const r=n.constructor,i=function(e){switch(e){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return $p(!1),null}}(this.targetTextureType),o=new r(n.length*i/4);let s=0;for(let a=0;a<n.length;a+=4)for(let e=0;e<i;e++)o[s++]=n[a+e];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:n}=e;this._swapTexture=n,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:n}=e;if(n instanceof ff)return n;const r=t[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:n={},_targetTexture:r}=e,i=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:n,targetTexture:i}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((e,t,n)=>{n[t]=t}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new sf(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:e,targetTexture:t}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:e,targetTexture:t})}}_updateBinding(e,t){const{sourceBuffers:n,sourceTextures:r,targetTexture:i}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,n),i){e.targetTexture=i;const{width:t,height:n}=i,{framebuffer:r}=e;r?(r.update({attachments:{36064:i},resizeAttachments:!1}),r.resize({width:t,height:n})):e.framebuffer=new kf(this.gl,{id:"transform-framebuffer",width:t,height:n,attachments:{36064:i}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const n in t)t[n].setParameters(fg)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function(e,t){Bd(e instanceof ff||e instanceof _f||e instanceof wf);const n=e.constructor,{gl:r,width:i,height:o,format:s,type:a,dataFormat:u,border:c,mipmaps:l}=e;return new n(r,Object.assign({width:i,height:o,format:s,type:a,dataFormat:u,border:c,mipmaps:l},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(e);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:n}=this.bindings[this.currentIndex],{vs:r,uniforms:i,targetTextureType:o,inject:s,samplerTextureMap:a}=function({vs:e,sourceTextureMap:t,targetTextureVarying:n,targetTexture:r}){let i=Object.keys(t).length,o=null;const s={};let a=e,u={};if(i>0||n){const e=a.split("\n"),c=e.slice();if(e.forEach((e,r,a)=>{if(i>0){const n=function(e,t){const n={},r=function(e){return Zp(e,["attribute","in"])}(e);if(!r)return null;const{type:i,name:o}=r;if(o&&t[o]){const t="// ".concat(e," => Replaced by Transform with a sampler"),{samplerName:r,sizeName:s,uniformDeclerations:a}=function(e){const t="".concat("transform_uSampler_").concat(e),n="".concat(hg).concat(e);return{samplerName:t,sizeName:n,uniformDeclerations:"  uniform sampler2D ".concat(t,";\n  uniform vec2 ").concat(n,";")}}(o),u=function(e){switch(e){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return $p(!1),null}}(i),c="  ".concat(i," ").concat(o," = transform_getInput(").concat(r,", ").concat(s,").").concat(u,";\n");return n[r]=o,{updatedLine:t,inject:{"vs:#decl":a,"vs:#main-start":c},samplerTextureMap:n}}return null}(e,t);if(n){const{updatedLine:e,inject:t}=n;c[r]=e,u=cg([u,t]),Object.assign(s,n.samplerTextureMap),i--}}n&&!o&&(o=function(e,t){const n=Zp(e,["varying","out"]);return n&&n.name===t?n.type:null}(e,n))}),n){Bd(r);const e="".concat(hg).concat(n),t="uniform vec2 ".concat(e,";\n"),i="     vec2 ".concat(dg," = transform_getPos(").concat(e,");\n     gl_Position = vec4(").concat(dg,", 0, 1.);\n");u=cg([u,{"vs:#decl":t,"vs:#main-start":i}])}a=c.join("\n")}return{vs:a,targetTextureType:o,inject:u,samplerTextureMap:s}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),u=cg([e.inject||{},s]);return this.targetTextureType=o,this.samplerTextureMap=a,{vs:r,fs:e._fs||Yp({version:eg(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[lg].concat(e.modules||[]):e.modules,uniforms:i,inject:u}}}const gg={number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},array:{validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function mg(e){let t=yg(e);return"object"===t?e?"type"in e?Object.assign({},e,gg[e.type]):"value"in e?(t=yg(e.value),Object.assign({type:t},e,gg[t])):{type:"object",value:e}:{type:"object",value:null}:Object.assign({type:t,value:e},gg[t])}function yg(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}class vg{constructor({name:e,vs:t,fs:n,dependencies:r=[],uniforms:i,getUniforms:o,deprecations:s=[],defines:a={},inject:u={},vertexShader:c,fragmentShader:l}){$p("string"==typeof e),this.name=e,this.vs=t||c,this.fs=n||l,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(s),this.defines=a,this.injections=function(e){const t={vs:{},fs:{}};for(const n in e){let r=e[n];const i=n.slice(0,2);"string"==typeof r&&(r={order:0,injection:r}),t[i][n]=r}return t}(u),i&&(this.uniforms=function(e){const t={};for(const n in e){const r=mg(e[n]);t[n]=r}return t}(i))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:$p(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(t,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(n=>{n.regex.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())})}_parseDeprecationDefinitions(e){return e.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp("\\b".concat(e.old,"\\("));break;default:e.regex=new RegExp("".concat(e.type," ").concat(e.old,";"))}}),e}_defaultGetUniforms(e={}){const t={},n=this.uniforms;for(const r in n){const i=n[r];r in e&&!i.private?(i.validate&&$p(i.validate(e[r],i),"".concat(this.name,": invalid ").concat(r)),t[r]=e[r]):t[r]=i.value}return t}}function bg(e){return function(e){const t={},n={};return _g({modules:e,level:0,moduleMap:t,moduleDepth:n}),Object.keys(n).sort((e,t)=>n[t]-n[e]).map(e=>t[e])}(wg(e))}function _g({modules:e,level:t,moduleMap:n,moduleDepth:r}){if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const i of e)n[i.name]=i,(void 0===r[i.name]||r[i.name]<t)&&(r[i.name]=t);for(const i of e)i.dependencies&&_g({modules:i.dependencies,level:t+1,moduleMap:n,moduleDepth:r})}function wg(e,t){return e.map(e=>(e instanceof vg||($p("string"!=typeof e,"Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),$p(e.name,"shader module has no name"),(e=new vg(e)).dependencies=wg(e.dependencies)),e))}const xg={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Eg={};Object.keys(xg).forEach(e=>{Eg[e]=e});const Sg={};function Ag(e,t,n={}){const r=xg[t];if($p(r,t),!function(e={}){const t="undefined"!=typeof window&&window.navigator||{},n=e.userAgent||t.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(t in Sg)return Sg[t];const i=n.behavior||"enable",o="#extension GL_".concat(r[0]," : ").concat(i,"\nvoid main(void) {}"),s=e.createShader(35633);e.shaderSource(s,o),e.compileShader(s);const a=e.getShaderParameter(s,35713);return e.deleteShader(s),Sg[t]=a,a}function kg(e,t){return(t=Array.isArray(t)?t:[t]).every(t=>function(e,t){const n=xg[t];$p(n,t);const r=function(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}(e)&&n[1]||n[0],i="string"==typeof r?Boolean(e.getExtension(r)):r;return $p(!1===i||!0===i),i}(e,t))}const Tg=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Og=[...Tg,[/^[ \t]*attribute[ \t]+(.+;)/gm,"in $1"],[/^[ \t]*varying[ \t]+(.+;)/gm,"out $1"]],Ig=[...Tg,[/^[ \t]*varying[ \t]+(.+;)/gm,"in $1"]],Cg=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Dg=[...Cg,[/^[ \t]*in[ \t]+(.+;)/gm,"attribute $1"],[/^[ \t]*out[ \t]+(.+;)/gm,"varying $1"]],jg=[...Cg,[/^[ \t]*in[ \t]+/gm,"varying "]],Pg="gl_FragColor",Mg=/^[ \t]*out[ \t]+vec4[ \t]+(\w+)[ \t]*;\s+/m,Rg=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Ng(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}const Lg="\n\n".concat(ig,"\n\n"),Fg={[tg]:"vertex",[ng]:"fragment"};function Bg(e,{id:t,source:n,type:r,modules:i,defines:o={},hookFunctions:s=[],inject:a={},transpileToGLSL100:u=!1,prologue:c=!0,log:l}){$p("string"==typeof n,"shader source must be a string");const h=r===tg,d=n.split("\n");let f=100,p="",g=n;0===d[0].indexOf("#version ")?(f=300,p=d[0],g=d.slice(1).join("\n")):p="#version ".concat(f);const m={};i.forEach(e=>{Object.assign(m,e.getDefines())}),Object.assign(m,o);let y=c?"".concat(p,"\n").concat(function({id:e,source:t,type:n}){return e&&"string"==typeof e&&-1===t.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(Fg[n],"\n\n"):""}({id:t,source:n,type:r}),"\n").concat(function({type:e}){return"\n#define SHADER_TYPE_".concat(Fg[e].toUpperCase(),"\n")}({type:r}),"\n").concat(function(e){switch(function(e){const t=e.getExtension("WEBGL_debug_renderer_info"),n=e.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||7936),r=e.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:function(e,t){return e.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":e.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":e.match(/AMD/i)||t.match(/AMD/i)||e.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,r),vendor:n,renderer:r,version:e.getParameter(7938),shadingLanguageVersion:e.getParameter(35724)}}(e).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e),"\n").concat(function(e,t,n){let r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return kg(e,Eg.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),kg(e,Eg.GLSL_DERIVATIVES)&&Ag(e,Eg.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),kg(e,Eg.GLSL_FRAG_DATA)&&Ag(e,Eg.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),kg(e,Eg.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}(e),"\n").concat(function(e={}){let t=0,n="";for(const r in e){0===t&&(n+="\n// APPLICATION DEFINES\n"),t++;const i=e[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(e[r],"\n"))}return 0===t&&(n+="\n"),n}(m),"\n").concat(h?"":"precision highp float;\n\n","\n"):"".concat(p,"\n");const v=function(e){const t={vs:{},fs:{}};return e.forEach(e=>{let n;"string"!=typeof e?(n=e,e=n.hook):n={},e=e.trim();const[r,i]=e.split(":"),o=e.replace(/\(.+/,"");t[r][o]=Object.assign(n,{signature:i})}),t}(s),b={},_={},w={};for(const x in a){const e="string"==typeof a[x]?{injection:a[x],order:0}:a[x],t=x.match(/^(v|f)s:(#)?([\w-]+)$/);if(t){const n=t[3];t[2]?"decl"===n?_[x]=[e]:w[x]=[e]:b[x]=[e]}else w[x]=[e]}for(const x of i){l&&x.checkDeprecations(g,l),y+=x.getModuleSource(r,f);const e=x.injections[r];for(const t in e){const n=t.match(/^(v|f)s:#([\w-]+)$/);if(n){const r="decl"===n[2]?_:w;r[t]=r[t]||[],r[t].push(e[t])}else b[t]=b[t]||[],b[t].push(e[t])}}return y+=Lg,y=ug(y,r,_),y+=function(e,t){let n="";for(const r in e){const i=e[r];if(n+="void ".concat(i.signature," {\n"),i.header&&(n+="  ".concat(i.header)),t[r]){const e=t[r];e.sort((e,t)=>e.order-t.order);for(const t of e)n+="  ".concat(t.injection,"\n")}i.footer&&(n+="  ".concat(i.footer)),n+="}\n"}return n}(v[r],b),y+=g,y=ug(y,r,w),y=function(e,t,n){switch(t){case 300:return n?Ng(e,Og):function(e){const t=(e=Ng(e,Ig)).match(Mg);if(t){const n=t[1];e=e.replace(new RegExp("\\b".concat(Pg,"\\b"),"g"),n)}else{const t="fragmentColor";e=e.replace(Rg,e=>"out vec4 ".concat(t,";\n").concat(e)).replace(new RegExp("\\b".concat(Pg,"\\b"),"g"),t)}return e}(e);case 100:return n?Ng(e,Dg):function(e){const t=(e=Ng(e,jg)).match(Mg);if(t){const n=t[1];e=e.replace(Mg,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Pg)}return e}(e);default:throw new Error("unknown GLSL version ".concat(t))}}(y,u?100:f,h),y}function zg(e){return function(t){const n={};for(const r of e){const e=r.getUniforms(t,n);Object.assign(n,e)}return n}}const Ug={5126:tm.bind(null,"uniform1fv",$g,1,nm),35664:tm.bind(null,"uniform2fv",$g,2,nm),35665:tm.bind(null,"uniform3fv",$g,3,nm),35666:tm.bind(null,"uniform4fv",$g,4,nm),5124:tm.bind(null,"uniform1iv",Xg,1,nm),35667:tm.bind(null,"uniform2iv",Xg,2,nm),35668:tm.bind(null,"uniform3iv",Xg,3,nm),35669:tm.bind(null,"uniform4iv",Xg,4,nm),35670:tm.bind(null,"uniform1iv",Xg,1,nm),35671:tm.bind(null,"uniform2iv",Xg,2,nm),35672:tm.bind(null,"uniform3iv",Xg,3,nm),35673:tm.bind(null,"uniform4iv",Xg,4,nm),35674:tm.bind(null,"uniformMatrix2fv",$g,4,rm),35675:tm.bind(null,"uniformMatrix3fv",$g,9,rm),35676:tm.bind(null,"uniformMatrix4fv",$g,16,rm),35678:em,35680:em,5125:tm.bind(null,"uniform1uiv",Kg,1,nm),36294:tm.bind(null,"uniform2uiv",Kg,2,nm),36295:tm.bind(null,"uniform3uiv",Kg,3,nm),36296:tm.bind(null,"uniform4uiv",Kg,4,nm),35685:tm.bind(null,"uniformMatrix2x3fv",$g,6,rm),35686:tm.bind(null,"uniformMatrix2x4fv",$g,8,rm),35687:tm.bind(null,"uniformMatrix3x2fv",$g,6,rm),35688:tm.bind(null,"uniformMatrix3x4fv",$g,12,rm),35689:tm.bind(null,"uniformMatrix4x2fv",$g,8,rm),35690:tm.bind(null,"uniformMatrix4x3fv",$g,12,rm),35678:em,35680:em,35679:em,35682:em,36289:em,36292:em,36293:em,36298:em,36299:em,36300:em,36303:em,36306:em,36307:em,36308:em,36311:em},Vg={},Gg={},Hg={},qg=[0];function Wg(e,t,n,r){1===t&&"boolean"==typeof e&&(e=e?1:0),Number.isFinite(e)&&(qg[0]=e,e=qg);const i=e.length;if(i%t&&Uh.warn("Uniform size should be multiples of ".concat(t),e)(),e instanceof n)return e;let o=r[i];o||(o=new n(i),r[i]=o);for(let s=0;s<i;s++)o[s]=e[s];return o}function $g(e,t){return Wg(e,t,Float32Array,Vg)}function Xg(e,t){return Wg(e,t,Int32Array,Gg)}function Kg(e,t){return Wg(e,t,Uint32Array,Hg)}function Zg(e,t,n){const r=Ug[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,e,t)}function Yg(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=e.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function Qg(e){return Array.isArray(e)||ArrayBuffer.isView(e)?function(e){if(0===e.length)return!1;const t=Math.min(e.length,16);for(let n=0;n<t;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e):!!isFinite(e)||!0===e||!1===e||e instanceof df||e instanceof mf||e instanceof kf&&Boolean(e.texture)}function Jg(e,t,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(e[t]){const r=e[t];for(let e=0,t=n.length;e<t;++e)r[e]=n[e]}else e[t]=n.slice();else e[t]=n}function em(){let e=null;return(t,n,r)=>{const i=e!==r;return i&&(t.uniform1i(n,r),e=r),i}}function tm(e,t,n,r){let i=null,o=null;return(s,a,u)=>{const c=t(u,n),l=c.length;let h=!1;if(null===i)i=new Float32Array(l),o=l,h=!0;else{Bd(o===l,"Uniform length cannot change.");for(let e=0;e<l;++e)if(c[e]!==i[e]){h=!0;break}}return h&&(r(s,e,a,c),i.set(c)),h}}function nm(e,t,n,r){e[t](n,r)}function rm(e,t,n,r){e[t](n,!1,r)}function im(e,t="unnamed"){const n=e.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:t}function om(e,t){let n="";for(let r=0;r<t.length;r++){const i=t[r];if((e[r+3]||e[r+2]||e[r+1])&&(n+="".concat(i,"\n"),e[r+1])){const t=e[r+1],i=t.split(":",3),o=i[0],s=parseInt(i[1],10)||0,a=t.substring(i.join(":").length+1).trim();n+=sm("^^^ ".concat(o,": ").concat(a,"\n\n"),s)}}return n}function sm(e,t){let n="";for(let r=0;r<t;++r)n+=" ";return"".concat(n).concat(e)}class am extends Xd{static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Bd(!1),"unknown"}}constructor(e,t){qh(e),Bd("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:im(t.source,null)||t.id||Gd("unnamed ".concat(am.getTypeName(t.shaderType)))}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=im(e,null);t&&(this.id=Gd(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(am.getTypeName(this.shaderType),":").concat(this.id)}getName(){return im(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e="#version 100\n".concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const e=this.gl.getShaderInfoLog(this.handle),{shaderName:t,errors:n,warnings:r}=function(e,t,n,r){const i=e.split(/\r?\n/),o={},s={},a=r||im(t)||"(unnamed)",u="".concat(function(e){switch(e){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let l=0;l<i.length;l++){const t=i[l];if(t.length<=1)continue;const n=t.split(":"),r=n[0],a=parseInt(n[2],10);if(isNaN(a))throw new Error("GLSL compilation error in ".concat(u,": ").concat(e));"WARNING"!==r?o[a]=t:s[a]=t}const c=function(e,t=1,n=": "){const r=e.split(/\r?\n/),i=String(r.length+t-1).length;return r.map((e,r)=>{const o=String(r+t);return sm(o,i-o.length)+n+e})}(t);return{shaderName:u,errors:om(o,c),warnings:om(s,c)}}(e,this.source,this.shaderType,this.id);throw Uh.error("GLSL compilation errors in ".concat(t,"\n").concat(n))(),Uh.warn("GLSL compilation warnings in ".concat(t,"\n").concat(r))(),new Error("GLSL compilation errors in ".concat(t))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class um extends am{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class cm extends am{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const lm=5126,hm=5124,dm=5125,fm={[lm]:[lm,1,"float"],35664:[lm,2,"vec2"],35665:[lm,3,"vec3"],35666:[lm,4,"vec4"],[hm]:[hm,1,"int"],35667:[hm,2,"ivec2"],35668:[hm,3,"ivec3"],35669:[hm,4,"ivec4"],[dm]:[dm,1,"uint"],36294:[dm,2,"uvec2"],36295:[dm,3,"uvec3"],36296:[dm,4,"uvec4"],35670:[lm,1,"bool"],35671:[lm,2,"bvec2"],35672:[lm,3,"bvec3"],35673:[lm,4,"bvec4"],35674:[lm,8,"mat2"],35685:[lm,8,"mat2x3"],35686:[lm,8,"mat2x4"],35675:[lm,12,"mat3"],35687:[lm,12,"mat3x2"],35688:[lm,12,"mat3x4"],35676:[lm,16,"mat4"],35689:[lm,16,"mat4x2"],35690:[lm,16,"mat4x3"]};function pm(e){const t=fm[e];if(!t)return null;const[n,r]=t;return{type:n,components:r}}function gm(e,t){switch(e){case 5120:case 5121:case 5122:case 5123:e=lm}for(const n in fm){const[r,i,o]=fm[n];if(r===e&&i===t)return{glType:n,name:o}}return null}class mm{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,n=t.getProgramParameter(e.handle,35721);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=t.getActiveAttrib(e.handle,r),s=t.getAttribLocation(e.handle,n);s>=0&&this._addAttribute(s,n,i,o)}this.attributeInfos.sort((e,t)=>e.location-t.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!Hh(t))return;const n=t.getProgramParameter(e.handle,35971);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,n,i,o)}this.varyingInfos.sort((e,t)=>e.location-t.location)}_addAttribute(e,t,n,r){const{type:i,components:o}=pm(n),s={type:i,size:r*o};this._inferProperties(e,t,s);const a={location:e,name:t,accessor:new tf(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[e]=a,this.attributeInfosByName[a.name]=a}_inferProperties(e,t,n){/instance/i.test(t)&&(n.divisor=1)}_addVarying(e,t,n,r){const{type:i,components:o}=pm(n),s={location:e,name:t,accessor:new tf({type:i,size:r*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const ym=35981,vm=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class bm extends Xd{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",vm),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:n,fs:r,varyings:i,bufferMode:o=ym}=e;return this.hash=t||"",this.vs="string"==typeof n?new um(this.gl,{id:"".concat(e.id,"-vs"),source:n}):n,this.fs="string"==typeof r?new cm(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,Bd(this.vs instanceof um),Bd(this.fs instanceof cm),this.uniforms={},this._textureUniforms={},i&&i.length>0&&(Wh(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new mm(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:n,offset:r=0,start:i,end:o,isIndexed:s=!1,indexType:a=5123,instanceCount:u=0,isInstanced:c=u>0,vertexArray:l=null,transformFeedback:h,framebuffer:d,parameters:f={},uniforms:p,samplers:g}){if((p||g)&&(Uh.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(p||{})),Uh.priority>=e){const r=d?d.id:"default",i="mode=".concat(Ud(this.gl,t)," verts=").concat(n," ")+"instances=".concat(u," indexType=").concat(Ud(this.gl,a)," ")+"isInstanced=".concat(c," isIndexed=").concat(s," ")+"Framebuffer=".concat(r);Uh.log(e,i)()}return Bd(l),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===n||c&&0===u||(l.bindForDraw(n,u,()=>{if(void 0!==d&&(f=Object.assign({},f,{framebuffer:d})),h){const e=function(e){switch(e){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return Bd(!1),0}}(t);h.begin(e)}this._bindTextures(),Sd(this.gl,f,()=>{s&&c?this.gl2.drawElementsInstanced(t,n,a,r,u):s&&Hh(this.gl)&&!isNaN(i)&&!isNaN(o)?this.gl2.drawRangeElements(t,i,o,n,a,r):s?this.gl.drawElements(t,n,a,r):c?this.gl2.drawArraysInstanced(t,r,n,u):this.gl.drawArrays(t,r,n)}),h&&h.end()}),0))}setUniforms(e={}){Uh.priority>=2&&function(e,t,n){for(const r in e){const i=e[r];if((!n||Boolean(n[r]))&&!Qg(i))throw t=t?"".concat(t," "):"",console.error("".concat(t," Bad uniform ").concat(r),i),new Error("".concat(t," Bad uniform ").concat(r))}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const n=e[t],r=this._uniformSetters[t];if(r){let e=n,i=!1;if(e instanceof kf&&(e=e.texture),e instanceof df)if(i=this.uniforms[t]!==n,i){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const n=e,{textureIndex:i}=r;n.bind(i),e=i,this._textureUniforms[t]=n}else e=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(e)||i)&&Jg(this.uniforms,t,n)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const n=this._textureUniforms[t];n.update(),e=e&&n.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),n={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new um({handle:r});break;case 35632:n.fs=new cm({handle:r})}return n}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const e=this._getName();this.id=Gd(e)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Uh.time(4,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Uh.timeEnd(4,"linkProgram for ".concat(this._getName()))(),e.debug||Uh.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const n=this.gl.getActiveUniform(this.handle,t),{name:r}=Yg(n.name);let i=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=Zg(e,i,n),n.size>1)for(let t=0;t<n.size;t++)i=e.getUniformLocation(this.handle,"".concat(r,"[").concat(t,"]")),this._uniformSetters["".concat(r,"[").concat(t,"]")]=Zg(e,i,n)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class _m{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new _m(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(e=>e.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:n="",defines:r={},inject:i={},varyings:o=[],bufferMode:s=35981,transpileToGLSL100:a=!1}=e,u=this._getModuleList(e.modules),c=this._getHash(t),l=this._getHash(n),h=u.map(e=>this._getHash(e.name)).sort(),d=o.map(e=>this._getHash(e)),f=Object.keys(r).sort(),p=Object.keys(i).sort(),g=[],m=[];for(const v of f)g.push(this._getHash(v)),g.push(this._getHash(r[v]));for(const v of p)m.push(this._getHash(v)),m.push(this._getHash(i[v]));const y="".concat(c,"/").concat(l,"D").concat(g.join("/"),"M").concat(h.join("/"),"I").concat(m.join("/"),"V").concat(d.join("/"),"H").concat(this.stateHash,"B").concat(s).concat(a?"T":"");if(!this._programCache[y]){const e=function(e,t){const{vs:n,fs:r}=t,i=bg(t.modules||[]);return{gl:e,vs:Bg(e,Object.assign({},t,{source:n,type:tg,modules:i})),fs:Bg(e,Object.assign({},t,{source:r,type:ng,modules:i})),getUniforms:zg(i)}}(this.gl,{vs:t,fs:n,modules:u,inject:i,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[y]=new bm(this.gl,{hash:y,vs:e.vs,fs:e.fs,varyings:o,bufferMode:s}),this._getUniforms[y]=e.getUniforms||(e=>{}),this._useCounts[y]=0}return this._useCounts[y]++,this._programCache[y]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),n={};let r=0;for(let i=0,o=this._defaultModules.length;i<o;++i){const e=this._defaultModules[i],o=e.name;t[r++]=e,n[o]=!0}for(let i=0,o=e.length;i<o;++i){const o=e[i],s=o.name;n[s]||(t[r++]=o,n[s]=!0)}return t.length=r,t}}let wm=null;class xm extends Xd{static isSupported(e,t={}){return!t.constantAttributeZero||Hh(e)||"Chrome"===function(e){if(!nh())return"Node";if(th(void 0))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const n=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return n||r?"IE":hh.chrome?"Chrome":hh.safari?"Safari":hh.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new xm(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return xm.MAX_ATTRIBUTES=xm.MAX_ATTRIBUTES||e.getParameter(34921),xm.MAX_ATTRIBUTES}static setConstant(e,t,n){switch(n.constructor){case Float32Array:xm._setConstantFloatArray(e,t,n);break;case Int32Array:xm._setConstantIntArray(e,t,n);break;case Uint32Array:xm._setConstantUintArray(e,t,n);break;default:Bd(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return xm.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return Bd(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,n){if(34963===t.target)return this.setElementBuffer(t,n);const{size:r,type:i,stride:o,offset:s,normalized:a,integer:u,divisor:c}=n,{gl:l,gl2:h}=this;return e=Number(e),this.bind(()=>{l.bindBuffer(34962,t.handle),u?(Bd(Hh(l)),h.vertexAttribIPointer(e,r,i,o,s)):l.vertexAttribPointer(e,r,i,a,o,s),l.enableVertexAttribArray(e),h.vertexAttribDivisor(e,c||0)}),this}enable(e,t=!0){return!t&&0===e&&!xm.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const n=this._normalizeConstantArrayValue(t),r=n.byteLength*e,i=n.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new sf(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const e=function(e,t){var n;return new e((n=e.BYTES_PER_ELEMENT*t,(!wm||wm.byteLength<n)&&(wm=new ArrayBuffer(n)),wm),0,t)}(t.constructor,i);!function({target:e,source:t,start:n=0,count:r=1}){const i=t.length,o=r*i;let s=0;for(let a=n;s<i;s++)e[a++]=t[s];for(;s<o;)s<o-s?(e.copyWithin(n+s,n,n+s),s*=2):(e.copyWithin(n+s,n,n+o-s),s=o)}({target:e,source:n,start:0,count:i}),this.buffer.subData(e),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}static _setConstantFloatArray(e,t,n){switch(n.length){case 1:e.vertexAttrib1fv(t,n);break;case 2:e.vertexAttrib2fv(t,n);break;case 3:e.vertexAttrib3fv(t,n);break;case 4:e.vertexAttrib4fv(t,n);break;default:Bd(!1)}}static _setConstantIntArray(e,t,n){switch(Bd(Hh(e)),n.length){case 1:e.vertexAttribI1iv(t,n);break;case 2:e.vertexAttribI2iv(t,n);break;case 3:e.vertexAttribI3iv(t,n);break;case 4:e.vertexAttribI4iv(t,n);break;default:Bd(!1)}}static _setConstantUintArray(e,t,n){switch(Bd(Hh(e)),n.length){case 1:e.vertexAttribI1uiv(t,n);break;case 2:e.vertexAttribI2uiv(t,n);break;case 3:e.vertexAttribI3uiv(t,n);break;case 4:e.vertexAttribI4uiv(t,n);break;default:Bd(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return Bd(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const Em=/^(.+)__LOCATION_([0-9]+)$/,Sm=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Am{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new xm(e),Wd(this,"VertexArray","v6.0",Sm),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,n={}){if(34963===t.target)return this.setElementBuffer(t,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(e,t,t.accessor,n);return r>=0&&(this.values[r]=t,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,i)),this}setConstant(e,t,n={}){const{location:r,accessor:i}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},n));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new sf(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof sf&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof sf&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,n){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=n()}),r}_resolveLocationAndAccessor(e,t,n,r){const i={location:-1,accessor:null},{location:o,name:s}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,Uh.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),i;const a=this._getAttributeInfo(s||o);if(!a)return i;const u=tf.resolve(a.accessor,this.accessors[o]||{},n,r),{size:c,type:l}=u;return Bd(Number.isFinite(c)&&Number.isFinite(l)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const n=Em.exec(e),r=n?n[1]:e,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof sf)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof sf)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof sf))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const n=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}_setConstantAttributeZero(e,t){if(xm.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const n=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(e,t){xm.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const n=this.values[t],r=this.accessors[t];if(!n)return;const{divisor:i}=r,o=i>0;if(e.isInstanced=e.isInstanced||o,n instanceof sf){const t=n;if(o){const n=t.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,n)}else{const n=t.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,n)}}}setElements(e=null,t={}){return Uh.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function km(e,t={}){const{isInteger:n=!1}=t;if(Array.isArray(e)||ArrayBuffer.isView(e))return function(e,t){const{maxElts:n=16,size:r=1}=t;let i="[";for(let s=0;s<e.length&&s<n;++s)s>0&&(i+=",".concat(s%r==0?" ":"")),i+=km(e[s],t);const o=e.length>n?"...":"]";return"".concat(i).concat(o)}(e,t);if(!Number.isFinite(e))return String(e);if(Math.abs(e)<1e-16)return n?"0":"0.";if(n)return e.toFixed(0);if(Math.abs(e)>100&&Math.abs(e)<1e4)return e.toFixed(0);const r=e.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function Tm(e,t,n,r){const{gl:i}=e;if(!t)return{[r]:"null","Format ":"N/A"};let o,s,a,u="NOT PROVIDED",c=1,l=0,h=0;if(n&&(u=n.type,c=n.size,u=String(u).replace("Array",""),o=-1!==u.indexOf("nt")),t instanceof sf){const e=t,{data:d,changed:f}=e.getDebugData();let p;return s=f?"*":"",a=d,h=e.byteLength,l=h/d.BYTES_PER_ELEMENT/c,n?p="".concat(n.divisor>0?"I ":"P "," ").concat(l," (x").concat(c,"=").concat(h," bytes ").concat(Ud(i,u),")"):(o=!0,p="".concat(h," bytes")),{[r]:"".concat(s).concat(km(a,{size:c,isInteger:o})),"Format ":p}}return a=t,c=t.length,u=String(t.constructor.name).replace("Array",""),o=-1!==u.indexOf("nt"),{[r]:"".concat(km(a,{size:c,isInteger:o})," (constant)"),"Format ":"".concat(c,"x").concat(u," (constant)")}}function Om(e,t){const{type:n,size:r}=t,i=gm(n,r);return i?"".concat(e," (").concat(i.name,")"):e}function Im({header:e="Uniforms",program:t,uniforms:n,undefinedOnly:r=!1}){Bd(t);const i=".*Matrix",o={},s=Object.keys(t._uniformSetters).sort();let a=0;for(const l of s)l.match(".*_.*")||l.match(i)||Cm({table:o,header:e,uniforms:n,uniformName:l,undefinedOnly:r})&&a++;for(const l of s)l.match(i)&&Cm({table:o,header:e,uniforms:n,uniformName:l,undefinedOnly:r})&&a++;for(const l of s)o[l]||Cm({table:o,header:e,uniforms:n,uniformName:l,undefinedOnly:r})&&a++;let u=0;const c={};if(!r)for(const l in n){const t=n[l];o[l]||(u++,c[l]={Type:"NOT USED: ".concat(t),[e]:km(t)})}return{table:o,count:a,unusedTable:c,unusedCount:u}}function Cm({table:e,header:t,uniforms:n,uniformName:r,undefinedOnly:i}){const o=n[r],s=function(e){return null!=e}(o);return!(i&&s||(e[r]={[t]:s?km(o):"N/A","Uniform Type":s?o:"NOT PROVIDED"},0))}function Dm(e){const{type:t,size:n}=e.accessor,r=gm(t,n);return r?"".concat(r.name," ").concat(e.name):e.name}const jm={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Pm(e,t){const{attributeMap:n=jm}=t||{};return n&&n[e]||e}function Mm(e,t){let n;switch(e){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2}Bd(Number.isFinite(t.size),"attribute ".concat(e," needs size"))}const Rm=()=>{},Nm={};class Lm{constructor(e,t={}){const{id:n=Gd("model")}=t;Bd(Gh(e)),this.id=n,this.gl=e,this.id=t.id||Gd("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||_m.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:t,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Bd(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:t,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Bd(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Bd(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(e,t,n){const r={};let i=t.indices;for(const o in t.attributes){const n=t.attributes[o],s=Pm(o,void 0);if("indices"===o)i=n;else if(n.constant)r[s]=n.value;else{const t=n.value,i={...n};delete i.value,r[s]=[new sf(e,t),i],Mm(o,i)}}if(i){const t=i.value||i;Bd(t instanceof Uint16Array||t instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new sf(e,{data:t,target:34963}),n]}return r}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(qd(e))return this;const t={};for(const n in e){const r=e[n];t[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return vf(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:n,uniforms:r={},attributes:i={},transformFeedback:o=this.transformFeedback,parameters:s={},vertexArray:a=this.vertexArray}=e;let u;this.setAttributes(i),this.updateModuleSettings(t),this.setUniforms(r),Uh.priority>=2&&(u=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:l=c.isIndexed,indexType:h=c.indexType,indexOffset:d=c.indexOffset,vertexArrayInstanced:f=c.isInstanced}=this.props;f&&!this.isInstanced&&Uh.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=Rm,onAfterRender:y=Rm}=this.props;m(),this.program.setUniforms(this.uniforms);const v=this.program.draw(Object.assign(Nm,e,{logPriority:u,uniforms:null,framebuffer:n,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:o,isIndexed:l,indexType:h,isInstanced:p,instanceCount:g,offset:l?d:0}));return y(),Uh.priority>=2&&this._logDrawCallEnd(u,a,n),v}transform(e={}){const{discard:t=!0,feedbackBuffers:n,unbindModels:r=[]}=e;let{parameters:i}=e;n&&this._setFeedbackBuffers(n),t&&(i=Object.assign({},i,{35977:t})),r.forEach(e=>e.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:i}))}finally{r.forEach(e=>e.vertexArray.bindBuffers())}return this}render(e={}){return Uh.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:t,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}=this.programProps;e=this.programManager.get({vs:t,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Bd(e instanceof bm,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Am(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof sf&&t.delete()}}_setAnimationProps(e){this.animated&&Bd(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(qd(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new Qp(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),Uh.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:Uh.level<=2})(),e}_logDrawCallEnd(e,t,n,r){if(void 0===e)return;const i=function({vertexArray:e,header:t="Attributes"}){if(!e.configuration)return{};const n={};e.elements&&(n.ELEMENT_ARRAY_BUFFER=Tm(e,e.elements,null,t));const r=e.values;for(const i in r){const o=e._getAttributeInfo(i);if(o){let s="".concat(i,": ").concat(o.name);const a=e.accessors[o.location];a&&(s="".concat(i,": ").concat(Om(o.name,a))),n[s]=Tm(e,r[i],a,t)}}return n}({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=Im({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:u,count:c}=Im({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&Uh.log("MISSING UNIFORMS",Object.keys(u))(),a>0&&Uh.log("UNUSED UNIFORMS",Object.keys(s))();const l=function(e){const t={},n="Accessors for ".concat(e.id);for(const r of e.attributeInfos)if(r){const e=Dm(r);t["in ".concat(e)]={[n]:JSON.stringify(r.accessor)}}for(const r of e.varyingInfos)if(r){const e=Dm(r);t["out ".concat(e)]={[n]:JSON.stringify(r.accessor)}}return t}(this.vertexArray.configuration);Uh.table(e,i)(),Uh.table(e,o)(),Uh.table(e+1,l)(),r&&r.log({logLevel:2,message:"Rendered to ".concat(r.id)}),Uh.groupEnd(2,">>> DRAWING MODEL ".concat(this.id))()}}class Fm{static isSupported(e){return Hh(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:n}=this;e&&e.delete(),t&&t.delete(),n&&n.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,n=this._updateDrawOptions(e);t&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)e=e||n.swap();Bd(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t){const t=n.getData(e);if(t)return t}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of t)n.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new Lm(t,Object.assign({},e,{fs:e.fs||Yp({version:eg(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(e){return!(qd(e.feedbackBuffers)&&qd(e.feedbackMap)&&!(e.varyings&&e.varyings.length>0))})(t)&&(this.bufferTransform=new Jp(e,t)),function(e){return!(qd(e._sourceTextures)&&!e._targetTexture&&!e._targetTextureVarying)}(t)&&(this.textureTransform=new pg(e,t)),Bd(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)t=Object.assign(t,r.getDrawOptions(t));return t}}function Bm(){}var zm={onStart:Bm,onUpdate:Bm,onInterrupt:Bm,onEnd:Bm},Um=function(){function e(t){Th(this,e),this._inProgress=!1,this._handle=null,this.timeline=t,this.settings={}}return Ih(e,[{key:"start",value:function(e){this.cancel(),this.settings=Object.assign({},zm,e),this._inProgress=!0,this.settings.onStart(this)}},{key:"end",value:function(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}},{key:"cancel",value:function(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}},{key:"update",value:function(){if(!this._inProgress)return!1;if(null===this._handle){var e=this.timeline,t=this.settings;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}},{key:"_onUpdate",value:function(){}},{key:"inProgress",get:function(){return this._inProgress}}]),e}();function Vm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Gm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vm(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vm(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Hm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qm=function(){function e(t){var n=t.gl,r=t.attribute,i=t.timeline;Th(this,e),this.gl=n,this.type="interpolation",this.transition=new Um(i),this.attribute=r,this.attributeInTransition=new Hp(n,r.settings),this.currentStartIndices=r.startIndices,this.currentLength=0,this.transform=function(e,t){var n=Fp(t.size);return new Fm(e,{vs:Wm,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(n,r);var o={byteLength:0,usage:35050};this.buffers=[new sf(n,o),new sf(n,o)]}return Ih(e,[{key:"start",value:function(e,t){if(e.duration<=0)this.transition.cancel();else{var n=this.buffers,r=this.attribute;Bp(n);var i,o={numInstances:t,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter},s=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Hm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hm(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(n);try{for(s.s();!(i=s.n()).done;)Up(Gm({buffer:i.value},o))}catch(a){s.e(a)}finally{s.f()}this.currentStartIndices=r.startIndices,this.currentLength=zp(r,t),this.attributeInTransition.update({buffer:n[1],value:r.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:n[0],aTo:Lp(0,r)},feedbackBuffers:{vCurrent:n[1]}})}}},{key:"update",value:function(){var e=this.transition.update();if(e){var t=this.transition,n=t.settings,r=(0,n.easing)(t.time/n.duration);this.transform.run({uniforms:{time:r}})}return e}},{key:"cancel",value:function(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},{key:"inProgress",get:function(){return this.transition.inProgress}}]),e}(),Wm="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";function $m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Xm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$m(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Km(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zm={interpolation:qm,spring:function(){function e(t){var n=t.gl,r=t.attribute,i=t.timeline;Th(this,e),this.gl=n,this.type="spring",this.transition=new Um(i),this.attribute=r,this.attributeInTransition=new Hp(n,Object.assign({},r.settings,{normalized:!1})),this.currentStartIndices=r.startIndices,this.currentLength=0,this.texture=function(e){return new ff(e,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(n),this.framebuffer=function(e,t){return new kf(e,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:zh({},36064,t)})}(n,this.texture),this.transform=function(e,t,n){var r=Fp(t.size);return new Fm(e,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(n,r,this.framebuffer);var o={byteLength:0,usage:35050};this.buffers=[new sf(n,o),new sf(n,o),new sf(n,o)]}return Ih(e,[{key:"start",value:function(e,t){var n,r=this.buffers,i=this.attribute,o={numInstances:t,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter},s=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Km(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Km(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(r);try{for(s.s();!(n=s.n()).done;)Up(Xm({buffer:n.value},o))}catch(a){s.e(a)}finally{s.f()}this.currentStartIndices=i.startIndices,this.currentLength=zp(i,t),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:Lp(0,i)}})}},{key:"update",value:function(){var e=this.buffers,t=this.transform,n=this.framebuffer,r=this.transition;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Bp(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),Ef(n)[0]>0||r.end(),!0)}},{key:"cancel",value:function(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}},{key:"inProgress",get:function(){return this.transition.inProgress}}]),e}()},Ym=function(){function e(t,n){var r=n.id,i=n.timeline;Th(this,e),this.id=r,this.gl=t,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Fm.isSupported(t)}return Ih(e,[{key:"finalize",value:function(){for(var e in this.transitions)this._removeTransition(e)}},{key:"update",value:function(e){var t=e.attributes,n=e.transitions,r=e.numInstances;for(var i in this.numInstances=r||1,t){var o=t[i],s=o.getTransitionSetting(n);s&&this._updateAttribute(i,o,s)}for(var a in this.transitions){var u=t[a];u&&u.getTransitionSetting(n)||this._removeTransition(a)}}},{key:"hasAttribute",value:function(e){var t=this.transitions[e];return t&&t.inProgress}},{key:"getAttributes",value:function(){var e={};for(var t in this.transitions){var n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}},{key:"run",value:function(){if(!this.isSupported||0===this.numInstances)return!1;for(var e in this.transitions)this.transitions[e].update()&&(this.needsRedraw=!0);var t=this.needsRedraw;return this.needsRedraw=!1,t}},{key:"_removeTransition",value:function(e){this.transitions[e].cancel(),delete this.transitions[e]}},{key:"_updateAttribute",value:function(e,t,n){var r=this.transitions[e],i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void Eh.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);var o=Zm[n.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Eh.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}]),e}(),Qm="attributeManager.invalidate",Jm="attributeManager.updateStart",ey="attributeManager.updateEnd",ty=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.id,i=void 0===r?"attribute-manager":r,o=n.stats,s=n.timeline;Th(this,e),this.id=i,this.gl=t,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=o,this.attributeTransitionManager=new Ym(t,{id:"".concat(i,"-transitions"),timeline:s}),Object.seal(this)}return Ih(e,[{key:"finalize",value:function(){for(var e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}},{key:"getNeedsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}},{key:"setNeedsRedraw",value:function(){return this.needsRedraw=!0,this}},{key:"add",value:function(e,t){this._add(e,t)}},{key:"addInstanced",value:function(e,t){this._add(e,t,{instanced:1})}},{key:"remove",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}},{key:"invalidate",value:function(e,t){var n=this._invalidateTrigger(e,t);Wp(Qm,this,e,n)}},{key:"invalidateAll",value:function(e){for(var t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Wp(Qm,this,"all")}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=e.numInstances,r=e.startIndices,i=void 0===r?null:r,o=e.transitions,s=e.props,a=void 0===s?{}:s,u=e.buffers,c=void 0===u?{}:u,l=e.context,h=void 0===l?{}:l,d=!1;for(var f in Wp(Jm,this),this.stats&&this.stats.get("Update Attributes").timeStart(),this.attributes){var p=this.attributes[f],g=p.settings.accessor;p.startIndices=i,a[f]&&Eh.removed("props.".concat(f),"data.attributes.".concat(f))(),p.setExternalBuffer(c[f])||p.setBinaryValue(c[g],t.startIndices)||!c[g]&&p.setConstantValue(a[g])||p.needsUpdate()&&(d=!0,this._updateAttribute({attribute:p,numInstances:n,data:t,props:a,context:h})),this.needsRedraw|=p.needsRedraw()}d&&Wp(ey,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:o})}},{key:"updateTransition",value:function(){var e=this.attributeTransitionManager.run();return this.needsRedraw=this.needsRedraw||e,e}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getChangedAttributes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1},t=this.attributes,n=this.attributeTransitionManager,r=Object.assign({},n.getAttributes());for(var i in t){var o=t[i];o.needsRedraw(e)&&!n.hasAttribute(i)&&(r[i]=o)}return r}},{key:"getShaderAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e||(e=this.getAttributes());var n={};for(var r in e)t[r]||Object.assign(n,e[r].getShaderAttributes());return n}},{key:"getAccessors",value:function(){return this.updateTriggers}},{key:"_add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t&&Eh.warn("AttributeManager.add({updaters}) - updater map no longer supported")();var r={};for(var i in e){var o=e[i],s=this._createAttribute(i,o,n);r[i]=s}Object.assign(this.attributes,r),this._mapUpdateTriggersToAttributes()}},{key:"_createAttribute",value:function(e,t,n){return new Hp(this.gl,Object.assign({},t,{id:e,constant:t.constant||!1,isIndexed:t.isIndexed||t.elements,size:t.elements?1:t.size,value:t.value||null,divisor:t.instanced||n.instanced?1:t.divisor}))}},{key:"_mapUpdateTriggersToAttributes",value:function(){var e=this,t={},n=function(n){e.attributes[n].getUpdateTriggers().forEach(function(e){t[e]||(t[e]=[]),t[e].push(n)})};for(var r in this.attributes)n(r);this.updateTriggers=t}},{key:"_invalidateTrigger",value:function(e,t){var n=this.attributes,r=this.updateTriggers[e];return r&&r.forEach(function(e){var r=n[e];r&&r.setNeedsUpdate(r.id,t)}),r}},{key:"_updateAttribute",value:function(e){var t=e.attribute,n=e.numInstances;Wp("attribute.updateStart",t),t.allocate(n)&&Wp("attribute.allocate",t,n),t.updateBuffer(e)&&(this.needsRedraw=!0,Wp("attribute.updateEnd",t,n))}}]),e}(),ny=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return Ih(i,[{key:"_onUpdate",value:function(){var e=this.settings,t=e.fromValue,n=e.toValue,r=(0,e.easing)(this.time/e.duration);this._value=Wf(t,n,r)}},{key:"value",get:function(){return this._value}}]),i}(Um),ry=1e-5;function iy(e,t,n,r,i){var o=t-e;return(n-t)*i+-o*r+o+t}function oy(e,t){if(Array.isArray(e)){for(var n=0,r=0;r<e.length;r++){var i=e[r]-t[r];n+=i*i}return Math.sqrt(n)}return Math.abs(e-t)}function sy(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ay(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ay(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function ay(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function cy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uy(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uy(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ly={interpolation:ny,spring:function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return Ih(i,[{key:"_onUpdate",value:function(){var e=this.settings,t=e.fromValue,n=e.toValue,r=this._prevValue,i=this._currValue,o=void 0===i?t:i,s=function(e,t,n,r,i){if(Array.isArray(n)){for(var o=[],s=0;s<n.length;s++)o[s]=iy(e[s],t[s],n[s],r,i);return o}return iy(e,t,n,r,i)}(void 0===r?t:r,o,n,e.damping,e.stiffness),a=oy(s,n),u=oy(s,o);a<ry&&u<ry&&(s=n,this.end()),this._prevValue=o,this._currValue=s}},{key:"value",get:function(){return this._currValue}}]),i}(Um)},hy=function(){function e(t){Th(this,e),this.transitions=new Map,this.timeline=t}return Ih(e,[{key:"add",value:function(e,t,n,r){var i=this.transitions;if(i.has(e)){var o=i.get(e),s=o.value;t=void 0===s?o.settings.fromValue:s,this.remove(e)}if(r=Np(r)){var a=ly[r.type];if(a){var u=new a(this.timeline);u.start(cy(cy({},r),{},{fromValue:t,toValue:n})),i.set(e,u)}else Eh.error("unsupported transition type '".concat(r.type,"'"))()}}},{key:"remove",value:function(e){var t=this.transitions;t.has(e)&&(t.get(e).cancel(),t.delete(e))}},{key:"update",value:function(){var e,t={},n=sy(this.transitions);try{for(n.s();!(e=n.n()).done;){var r=Bh(e.value,2),i=r[0],o=r[1];o.update(),t[i]=o.value,o.inProgress||this.remove(i)}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"clear",value:function(){var e,t=sy(this.transitions.keys());try{for(t.s();!(e=t.n()).done;)this.remove(e.value)}catch(n){t.e(n)}finally{t.f()}}},{key:"active",get:function(){return this.transitions.size>0}}]),e}(),dy="Awaiting state",fy={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},py=fy.COMPONENT;function gy(e,t){if(!e.transitions)return null;var n={},r=_y(e);for(var i in e.transitions){var o=r[i],s=o&&o.type;("number"===s||"color"===s||"array"===s)&&yy(e[i],t[i],o)&&(n[i]=!0)}return n}function my(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.newProps,n=e.oldProps,r=e.ignoreProps,i=void 0===r?{}:r,o=e.propTypes,s=void 0===o?{}:o,a=e.triggerName,u=void 0===a?"props":a;if(n===t)return null;if("object"!==Mh(t)||null===t)return"".concat(u," changed shallowly");if("object"!==Mh(n)||null===n)return"".concat(u," changed shallowly");for(var c=0,l=Object.keys(t);c<l.length;c++){var h=l[c];if(!(h in i)){if(!(h in n))return"".concat(u,".").concat(h," added");var d=yy(t[h],n[h],s[h]);if(d)return"".concat(u,".").concat(h," ").concat(d)}}for(var f=0,p=Object.keys(n);f<p.length;f++){var g=p[f];if(!(g in i)){if(!(g in t))return"".concat(u,".").concat(g," dropped");if(!Object.hasOwnProperty.call(t,g)){var m=yy(t[g],n[g],s[g]);if(m)return"".concat(u,".").concat(g," ").concat(m)}}}return null}function yy(e,t,n){var r=n&&n.equal;return r&&!r(e,t,n)?"changed deeply":r||!(r=e&&t&&e.equals)||r.call(e,t)?r||t===e?null:"changed shallowly":"changed deeply"}function vy(e,t){if(null===t)return"oldProps is null, initial diff";var n=t.extensions,r=e.extensions;if(r===n)return!1;if(r.length!==n.length)return!0;for(var i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function by(e,t,n){var r=e.updateTriggers[n],i=t.updateTriggers[n];return my({oldProps:i=null==i?{}:i,newProps:r=null==r?{}:r,triggerName:n})}function _y(e){var t=e[py],n=t&&t.constructor;return n?n._propTypes:{}}function wy(e,t){if(e===t)return!0;if(Array.isArray(e)){var n=e.length;if(!t||t.length!==n)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}function xy(e){var t,n={};return function(r){for(var i in r)if(!wy(r[i],n[i])){t=e(r),n=r;break}return t}}function Ey(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sy(e,t){if(!t)return e;var n=Object.assign({},e,t);if("defines"in t&&(n.defines=Object.assign({},e.defines,t.defines)),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some(function(e){return"project64"===e.name}))){var r=n.modules.findIndex(function(e){return"project32"===e.name});r>=0&&n.modules.splice(r,1)}if("inject"in t)if(e.inject){var i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ey(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ey(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.inject);for(var o in t.inject)i[o]=(i[o]||"")+t.inject[o];n.inject=i}else n.inject=t.inject;return n}function Ay(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],y=t[15],v=n*a-r*s,b=n*u-i*s,_=n*c-o*s,w=r*u-i*a,x=r*c-o*a,E=i*c-o*u,S=l*g-h*p,A=l*m-d*p,k=l*y-f*p,T=h*m-d*g,O=h*y-f*g,I=d*y-f*m,C=v*I-b*O+_*T+w*k-x*A+E*S;return C?(e[0]=(a*I-u*O+c*T)*(C=1/C),e[1]=(i*O-r*I-o*T)*C,e[2]=(g*E-m*x+y*w)*C,e[3]=(d*x-h*E-f*w)*C,e[4]=(u*k-s*I-c*A)*C,e[5]=(n*I-i*k+o*A)*C,e[6]=(m*_-p*E-y*b)*C,e[7]=(l*E-d*_+f*b)*C,e[8]=(s*O-a*k+c*S)*C,e[9]=(r*k-n*O-o*S)*C,e[10]=(p*x-g*_+y*v)*C,e[11]=(h*_-l*x-f*v)*C,e[12]=(a*A-s*T-u*S)*C,e[13]=(n*T-r*A+i*S)*C,e[14]=(g*b-p*w-m*v)*C,e[15]=(l*w-h*b+d*v)*C,e):null}function ky(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],d=t[9],f=t[10],p=t[11],g=t[12],m=t[13],y=t[14],v=t[15],b=n[0],_=n[1],w=n[2],x=n[3];return e[0]=b*r+_*a+w*h+x*g,e[1]=b*i+_*u+w*d+x*m,e[2]=b*o+_*c+w*f+x*y,e[3]=b*s+_*l+w*p+x*v,e[4]=(b=n[4])*r+(_=n[5])*a+(w=n[6])*h+(x=n[7])*g,e[5]=b*i+_*u+w*d+x*m,e[6]=b*o+_*c+w*f+x*y,e[7]=b*s+_*l+w*p+x*v,e[8]=(b=n[8])*r+(_=n[9])*a+(w=n[10])*h+(x=n[11])*g,e[9]=b*i+_*u+w*d+x*m,e[10]=b*o+_*c+w*f+x*y,e[11]=b*s+_*l+w*p+x*v,e[12]=(b=n[12])*r+(_=n[13])*a+(w=n[14])*h+(x=n[15])*g,e[13]=b*i+_*u+w*d+x*m,e[14]=b*o+_*c+w*f+x*y,e[15]=b*s+_*l+w*p+x*v,e}function Ty(e,t,n){var r,i,o,s,a,u,c,l,h,d,f,p,g=n[0],m=n[1],y=n[2];return t===e?(e[12]=t[0]*g+t[4]*m+t[8]*y+t[12],e[13]=t[1]*g+t[5]*m+t[9]*y+t[13],e[14]=t[2]*g+t[6]*m+t[10]*y+t[14],e[15]=t[3]*g+t[7]*m+t[11]*y+t[15]):(i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=r=t[0],e[1]=i,e[2]=o,e[3]=s,e[4]=a,e[5]=u,e[6]=c,e[7]=l,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=r*g+a*m+h*y+t[12],e[13]=i*g+u*m+d*y+t[13],e[14]=o*g+c*m+f*y+t[14],e[15]=s*g+l*m+p*y+t[15]),e}function Oy(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Iy(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=s*i+l*r,e[6]=a*i+h*r,e[7]=u*i+d*r,e[8]=c*i-o*r,e[9]=l*i-s*r,e[10]=h*i-a*r,e[11]=d*i-u*r,e}function Cy(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],s=t[1],a=t[2],u=t[3],c=t[4],l=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=s*i+l*r,e[2]=a*i+h*r,e[3]=u*i+d*r,e[4]=c*i-o*r,e[5]=l*i-s*r,e[6]=h*i-a*r,e[7]=d*i-u*r,e}function Dy(e,t,n,r,i){var o,s=1/Math.tan(t/2);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+r)*(o=1/(r-i)),e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e}function jy(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=t[0],b=t[1],_=t[2],w=t[3],x=t[4],E=t[5],S=t[6],A=t[7],k=t[8],T=t[9],O=t[10],I=t[11],C=t[12],D=t[13],j=t[14],P=t[15];return Math.abs(n-v)<=tp*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-b)<=tp*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-_)<=tp*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-w)<=tp*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-x)<=tp*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-E)<=tp*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(u-S)<=tp*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-A)<=tp*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(l-k)<=tp*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(h-T)<=tp*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(d-O)<=tp*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(f-I)<=tp*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(p-C)<=tp*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(g-D)<=tp*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(m-j)<=tp*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(y-P)<=tp*Math.max(1,Math.abs(y),Math.abs(P))}function Py(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function My(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,e}!function(){var e;e=new np(4),np!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Ry=[0,0,0,0],Ny=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Ly=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Fy=[0,0,0],By=[0,0,0],zy=xy(function(e){var t=e.viewport,n=e.devicePixelRatio,r=e.coordinateSystem,i=function(e,t,n){var r=e.viewMatrixUncentered,i=e.projectionMatrix,o=e.viewMatrix,s=e.viewProjectionMatrix,a=Ry,u=e.cameraPosition,c=Uy(e,t,n),l=c.geospatialOrigin,h=c.shaderCoordinateOrigin;if(c.offsetMode){var d=e.projectPosition(l||h);u=[u[0]-d[0],u[1]-d[1],u[2]-d[2]],d[3]=1,a=My([],d,s),s=ky([],i,o=r||o),s=ky([],s,Ny)}return{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,cameraPosCommon:u,shaderCoordinateOrigin:h,geospatialOrigin:l}}(t,r,e.coordinateOrigin),o=i.projectionCenter,s=i.viewProjectionMatrix,a=i.cameraPosCommon,u=i.shaderCoordinateOrigin,c=i.geospatialOrigin,l=t.getDistanceScales(),h={project_uCoordinateSystem:r,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:u,project_uCenter:o,project_uViewportSize:[t.width*n,t.height*n],project_uDevicePixelRatio:n,project_uFocalDistance:t.focalDistance||1,project_uCommonUnitsPerMeter:l.unitsPerMeter,project_uCommonUnitsPerWorldUnit:l.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Fy,project_uScale:t.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){var d=t.getDistanceScales(c);switch(r){case Sh.METER_OFFSETS:h.project_uCommonUnitsPerWorldUnit=d.unitsPerMeter,h.project_uCommonUnitsPerWorldUnit2=d.unitsPerMeter2;break;case Sh.LNGLAT:case Sh.LNGLAT_OFFSETS:h.project_uCommonUnitsPerWorldUnit=d.unitsPerDegree,h.project_uCommonUnitsPerWorldUnit2=d.unitsPerDegree2;break;case Sh.CARTESIAN:h.project_uCommonUnitsPerWorldUnit=[1,1,d.unitsPerMeter[2]],h.project_uCommonUnitsPerWorldUnit2=[0,0,d.unitsPerMeter2[2]]}}return h});function Uy(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:By,i=r,o=!0;switch(n=t===Sh.LNGLAT_OFFSETS||t===Sh.METER_OFFSETS?r:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case Ah.WEB_MERCATOR:t!==Sh.LNGLAT&&t!==Sh.CARTESIAN||(o=!1);break;case Ah.WEB_MERCATOR_AUTO_OFFSET:t===Sh.LNGLAT?i=n:t===Sh.CARTESIAN&&(i=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],n=e.unprojectPosition(i),i[0]-=r[0],i[1]-=r[1],i[2]-=r[2]);break;case Ah.IDENTITY:i=e.position.map(Math.fround);break;case Ah.GLOBE:o=!1,n=null;break;default:o=!1}return i[2]=i[2]||0,{geospatialOrigin:n,shaderCoordinateOrigin:i,offsetMode:o}}function Vy(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.viewport,n=e.devicePixelRatio,r=void 0===n?1:n,i=e.modelMatrix,o=void 0===i?null:i,s=e.coordinateSystem,a=void 0===s?Sh.DEFAULT:s,u=e.coordinateOrigin,c=e.autoWrapLongitude,l=void 0!==c&&c;xp(t),a===Sh.DEFAULT&&(a=t.isGeospatial?Sh.LNGLAT:Sh.CARTESIAN);var h=zy({viewport:t,devicePixelRatio:r,coordinateSystem:a,coordinateOrigin:u});return h.project_uWrapLongitude=l,h.project_uModelMatrix=o||Ly,h}class Gy extends Kf{get ELEMENTS(){return Xf(!1),0}get RANK(){return Xf(!1),0}toString(){let e="[";if(zf.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=" ".concat(this[n*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=Zf(n),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[n+r];return t}setColumn(e,t){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=t[r];return this}}function Hy(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function qy(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Wy(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e}function $y(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}!function(){var e;e=new np(2),np!=Float32Array&&(e[0]=0,e[1]=0)}();const Xy=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Ky=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zy=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Yy={};class Qy extends Gy{static get IDENTITY(){return Yy.IDENTITY=Yy.IDENTITY||Object.freeze(new Qy(Xy)),Yy.IDENTITY}static get ZERO(){return Yy.ZERO=Yy.ZERO||Object.freeze(new Qy(Ky)),Yy.ZERO}get INDICES(){return Zy}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,r,i,o,s,a,u,c,l,h,d,f,p,g){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=u,this[9]=c,this[10]=l,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(e,t,n,r,i,o,s,a,u,c,l,h,d,f,p,g){return this[0]=e,this[1]=i,this[2]=u,this[3]=d,this[4]=t,this[5]=o,this[6]=c,this[7]=f,this[8]=n,this[9]=s,this[10]=l,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Xy)}fromQuaternion(e){return function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n+n,a=r+r,u=i+i,c=n*s,l=r*s,h=r*a,d=i*s,f=i*a,p=i*u,g=o*s,m=o*a,y=o*u;e[0]=1-h-p,e[1]=l+y,e[2]=d-m,e[3]=0,e[4]=l-y,e[5]=1-c-p,e[6]=f+g,e[7]=0,e[8]=d+m,e[9]=f-g,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:n,top:r,near:i,far:o}){return o===1/0?Qy._computeInfinitePerspectiveOffCenter(this,e,t,n,r,i):function(e,t,n,r,i,o,s){var a=1/(n-t),u=1/(i-r),c=1/(o-s);e[0]=2*o*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(i+r)*u,e[10]=(s+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=s*o*2*c,e[15]=0}(this,e,t,n,r,i,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,n,r,i,o){const s=2*o/(i-r),a=(n+t)/(n-t),u=(i+r)/(i-r),c=-2*o;return e[0]=2*o/(n-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=a,e[9]=u,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=c,e[15]=0,e}lookAt(e,t,n){return 1===arguments.length&&({eye:e,center:t,up:n}=e),function(e,t,n,r){var i,o,s,a,u,c,l,h,d,f,p=t[0],g=t[1],m=t[2],y=r[0],v=r[1],b=r[2],_=n[0],w=n[1],x=n[2];Math.abs(p-_)<tp&&Math.abs(g-w)<tp&&Math.abs(m-x)<tp?function(e){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}(e):(l=p-_,h=g-w,d=m-x,i=v*(d*=f=1/Math.hypot(l,h,d))-b*(h*=f),o=b*(l*=f)-y*d,s=y*h-v*l,(f=Math.hypot(i,o,s))?(i*=f=1/f,o*=f,s*=f):(i=0,o=0,s=0),a=h*s-d*o,u=d*i-l*s,c=l*o-h*i,(f=Math.hypot(a,u,c))?(a*=f=1/f,u*=f,c*=f):(a=0,u=0,c=0),e[0]=i,e[1]=a,e[2]=l,e[3]=0,e[4]=o,e[5]=u,e[6]=h,e[7]=0,e[8]=s,e[9]=c,e[10]=d,e[11]=0,e[12]=-(i*p+o*g+s*m),e[13]=-(a*p+u*g+c*m),e[14]=-(l*p+h*g+d*m),e[15]=1)}(this,e,t=t||[0,0,0],n=n||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:n,top:r,near:i=.1,far:o=500}){return function(e,t,n,r,i,o,s){var a=1/(t-n),u=1/(r-i),c=1/(o-s);e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*u,e[14]=(s+o)*c,e[15]=1}(this,e,t,n,r,i,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:n=1,near:r=.1,far:i=500}){if(e>2*Math.PI)throw Error("radians");const o=n*Math.tan(e/2),s=o*t;return(new Qy).ortho({left:-s,right:s,bottom:-o,top:o,near:r,far:i})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return Dy(this,e,n,r,i),this.check()}determinant(){return function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],d=e[11],f=e[12],p=e[13],g=e[14],m=e[15];return(t*s-n*o)*(h*m-d*g)-(t*a-r*o)*(l*m-d*p)+(t*u-i*o)*(l*g-h*p)+(n*a-r*s)*(c*m-d*f)-(n*u-i*s)*(c*g-h*f)+(r*u-i*a)*(c*p-l*f)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const n=this.getScale(t||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*i,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*i,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const n=this.getScale(t||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*i,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*i,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*i,e[8]=this[10]*o,e}transpose(){return function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],s=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=s,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15]}(this,this),this.check()}invert(){return Ay(this,this),this.check()}multiplyLeft(e){return ky(this,e,this),this.check()}multiplyRight(e){return ky(this,this,e),this.check()}rotateX(e){return Iy(this,this,e),this.check()}rotateY(e){return function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],s=t[1],a=t[2],u=t[3],c=t[8],l=t[9],h=t[10],d=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=s*i-l*r,e[2]=a*i-h*r,e[3]=u*i-d*r,e[8]=o*r+c*i,e[9]=s*r+l*i,e[10]=a*r+h*i,e[11]=u*r+d*i}(this,this,e),this.check()}rotateZ(e){return Cy(this,this,e),this.check()}rotateXYZ([e,t,n]){return this.rotateX(e).rotateY(t).rotateZ(n)}rotateAxis(e,t){return function(e,t,n,r){var i,o,s,a,u,c,l,h,d,f,p,g,m,y,v,b,_,w,x,E,S,A,k,T,O=r[0],I=r[1],C=r[2],D=Math.hypot(O,I,C);D<tp||(O*=D=1/D,I*=D,C*=D,i=Math.sin(n),o=Math.cos(n),u=t[1],c=t[2],l=t[3],d=t[5],f=t[6],p=t[7],m=t[9],y=t[10],v=t[11],x=O*I*(s=1-o)-C*i,E=I*I*s+o,S=C*I*s+O*i,A=O*C*s+I*i,k=I*C*s-O*i,T=C*C*s+o,e[0]=(a=t[0])*(b=O*O*s+o)+(h=t[4])*(_=I*O*s+C*i)+(g=t[8])*(w=C*O*s-I*i),e[1]=u*b+d*_+m*w,e[2]=c*b+f*_+y*w,e[3]=l*b+p*_+v*w,e[4]=a*x+h*E+g*S,e[5]=u*x+d*E+m*S,e[6]=c*x+f*E+y*S,e[7]=l*x+p*E+v*S,e[8]=a*A+h*k+g*T,e[9]=u*A+d*k+m*T,e[10]=c*A+f*k+y*T,e[11]=l*A+p*k+v*T,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?Oy(this,this,e):Oy(this,this,[e,e,e]),this.check()}translate(e){return Ty(this,this,e),this.check()}transform(e,t){return 4===e.length?(Yf(t=My(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;switch(n){case 2:t=$y(t||[-0,-0],e,this);break;case 3:t=ap(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Yf(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=up(t||[-0,-0],e,this);break;case 3:t=cp(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Yf(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}transformPoint(e,t){return Jf("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return Jf("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return Jf("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Jy(e,t){const n=My([],t,e);return Py(n,n,1/n[3]),n}function ev(e,t){const n=e%t;return n<0?t+n:n}const tv=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function nv(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const rv=Math.PI,iv=rv/4,ov=rv/180,sv=180/rv,av=512;function uv([e,t]){return nv(Number.isFinite(e)),nv(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude"),[av*(e*ov+rv)/(2*rv),av*(rv+Math.log(Math.tan(iv+t*ov*.5)))/(2*rv)]}function cv([e,t]){const n=e/av*(2*rv)-rv,r=2*(Math.atan(Math.exp(t/av*(2*rv)-rv))-iv);return[n*sv,r*sv]}function lv({latitude:e,longitude:t,highPrecision:n=!1}){nv(Number.isFinite(e)&&Number.isFinite(t));const r={},i=Math.cos(e*ov),o=512/360,s=o/i,a=12790407194604047e-21/i;if(r.unitsPerMeter=[a,a,a],r.metersPerUnit=[1/a,1/a,1/a],r.unitsPerDegree=[o,s,a],r.degreesPerUnit=[.703125,1/s,1/a],n){const t=ov*Math.tan(e*ov)/i,n=12790407194604047e-21*t,u=n/s*a;r.unitsPerDegree2=[0,o*t/2,n],r.unitsPerMeter2=[u,0,u]}return r}function hv(e,t){const[n,r,i]=e,[o,s,a]=t,{unitsPerMeter:u,unitsPerMeter2:c}=lv({longitude:n,latitude:r,highPrecision:!0}),l=uv(e);l[0]+=o*(u[0]+c[0]*s),l[1]+=s*(u[1]+c[1]*s);const h=cv(l),d=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],d]:h}function dv({height:e,pitch:t,bearing:n,altitude:r,scale:i,center:o=null}){const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return Ty(s,s,[0,0,-r]),Iy(s,s,-t*ov),Cy(s,s,n*ov),Oy(s,s,[i/=e,i,i]),o&&Ty(s,s,function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}([],o)),s}function fv({width:e,height:t,fovy:n=pv(1.5),altitude:r,pitch:i=0,nearZMultiplier:o=1,farZMultiplier:s=1}){void 0!==r&&(n=pv(r));const a=.5*n*ov,u=gv(n),c=i*ov,l=Math.sin(a)*u/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:e/t,focalDistance:u,near:o,far:(Math.sin(c)*l+u)*s}}function pv(e){return 2*Math.atan(.5/e)*sv}function gv(e){return.5/Math.tan(.5*e*ov)}function mv(e,t){const[n,r,i=0]=e;return nv(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Jy(t,[n,r,i,1])}function yv(e,t,n=0){const[r,i,o]=e;if(nv(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o))return Jy(t,[r,i,o,1]);const s=Jy(t,[r,i,0,1]),a=Jy(t,[r,i,1,1]),u=s[2],c=a[2];return Wy([],s,a,u===c?0:((n||0)-u)/(c-u))}function vv({width:e,height:t,bounds:n,minExtent:r=0,maxZoom:i=24,padding:o=0,offset:s=[0,0]}){const[[a,u],[c,l]]=n;Number.isFinite(o)?o={top:o,bottom:o,left:o,right:o}:nv(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));const h=new xv({width:e,height:t,longitude:0,latitude:0,zoom:0}),d=h.project([a,l]),f=h.project([c,u]),p=[Math.max(Math.abs(f[0]-d[0]),r),Math.max(Math.abs(f[1]-d[1]),r)],g=[e-o.left-o.right-2*Math.abs(s[0]),t-o.top-o.bottom-2*Math.abs(s[1])];nv(g[0]>0&&g[1]>0);const m=g[0]/p[0],y=g[1]/p[1],v=h.unproject([(f[0]+d[0])/2+(o.right-o.left)/2/m,(f[1]+d[1])/2+(o.bottom-o.top)/2/y]),b=Math.min(i,h.zoom+tv(Math.abs(Math.min(m,y))));return nv(Number.isFinite(b)),{longitude:v[0],latitude:v[1],zoom:b}}const bv=Math.PI/180;function _v(e,t=0){const{width:n,height:r,unproject:i}=e,o={targetZ:t},s=i([0,r],o),a=i([n,r],o);let u,c;return(e.fovy?.5*e.fovy*bv:Math.atan(.5/e.altitude))>(90-e.pitch)*bv-.01?(u=wv(e,0,t),c=wv(e,n,t)):(u=i([0,0],o),c=i([n,0],o)),[s,a,c,u]}function wv(e,t,n){const{pixelUnprojectionMatrix:r}=e,i=Jy(r,[t,0,1,1]),o=Jy(r,[t,e.height,1,1]),s=cv(Wy([],i,o,(n*e.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2])));return s[2]=n,s}class xv{constructor({width:e,height:t,latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:s=0,altitude:a=null,fovy:u=null,position:c=null,nearZMultiplier:l=.02,farZMultiplier:h=1.01}={width:1,height:1}){e=e||1,t=t||1,null===u&&null===a?u=pv(a=1.5):null===u?u=pv(a):null===a&&(a=gv(u));const d=function(e){return Math.pow(2,e)}(i);a=Math.max(.75,a);const f=lv({longitude:r,latitude:n}),p=uv([r,n]);p[2]=0,c&&function(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2]}(p,p,function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}([],c,f.unitsPerMeter)),this.projectionMatrix=function({width:e,height:t,pitch:n,altitude:r,fovy:i,nearZMultiplier:o,farZMultiplier:s}){const{fov:a,aspect:u,near:c,far:l}=fv({width:e,height:t,altitude:r,fovy:i,pitch:n,nearZMultiplier:o,farZMultiplier:s});return Dy([],a,u,c,l)}({width:e,height:t,pitch:o,fovy:u,nearZMultiplier:l,farZMultiplier:h}),this.viewMatrix=dv({height:t,scale:d,center:p,pitch:o,bearing:s,altitude:a}),this.width=e,this.height=t,this.scale=d,this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=a,this.fovy=u,this.center=p,this.meterOffset=c||[0,0,0],this.distanceScales=f,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:e,height:t,projectionMatrix:n,viewMatrix:r}=this,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];ky(i,i,n),ky(i,i,r),this.viewProjectionMatrix=i;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Oy(o,o,[e/2,-t/2,1]),Ty(o,o,[1,-1,0]),ky(o,o,i);const s=Ay([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}equals(e){return e instanceof xv&&e.width===this.width&&e.height===this.height&&jy(e.projectionMatrix,this.projectionMatrix)&&jy(e.viewMatrix,this.viewMatrix)}project(e,{topLeft:t=!0}={}){const n=mv(this.projectPosition(e),this.pixelProjectionMatrix),[r,i]=n,o=t?i:this.height-i;return 2===e.length?[r,o]:[r,o,n[2]]}unproject(e,{topLeft:t=!0,targetZ:n}={}){const[r,i,o]=e,s=yv([r,t?i:this.height-i,o],this.pixelUnprojectionMatrix,n&&n*this.distanceScales.unitsPerMeter[2]),[a,u,c]=this.unprojectPosition(s);return Number.isFinite(o)?[a,u,c]:Number.isFinite(n)?[a,u,n]:[a,u]}projectPosition(e){const[t,n]=uv(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=cv(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){return uv(e)}unprojectFlat(e){return cv(e)}getMapCenterByLngLatPosition({lngLat:e,pos:t}){const n=yv(t,this.pixelUnprojectionMatrix),r=Hy([],uv(e),qy([],n));return cv(Hy([],this.center,r))}getLocationAtPoint({lngLat:e,pos:t}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:t})}fitBounds(e,t={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=vv(Object.assign({width:n,height:r,bounds:e},t));return new xv({width:n,height:r,longitude:i,latitude:o,zoom:s})}getBounds(e){const t=this.getBoundingRegion(e),n=Math.min(...t.map(e=>e[0])),r=Math.max(...t.map(e=>e[0]));return[[n,Math.min(...t.map(e=>e[1]))],[r,Math.max(...t.map(e=>e[1]))]]}getBoundingRegion(e={}){return _v(this,e.z||0)}}const Ev=85.05113,Sv=-85.05113;var Av=Math.PI/180,kv=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Tv=[0,0,0],Ov={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]},Iv=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,e);var n=t.id,r=void 0===n?null:n,i=t.x,o=void 0===i?0:i,s=t.y,a=void 0===s?0:s,u=t.width,c=void 0===u?1:u,l=t.height,h=void 0===l?1:l;this.id=r||this.constructor.displayName||"viewport",this.x=o,this.y=a,this.width=c||1,this.height=h||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Ih(e,[{key:"equals",value:function(t){return t instanceof e&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&$f(t.projectionMatrix,this.projectionMatrix)&&$f(t.viewMatrix,this.viewMatrix))}},{key:"project",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.topLeft,r=void 0===n||n,i=this.projectPosition(e),o=mv(i,this.pixelProjectionMatrix),s=Bh(o,2),a=s[0],u=s[1],c=r?u:this.height-u;return 2===e.length?[a,c]:[a,c,o[2]]}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.topLeft,r=void 0===n||n,i=t.targetZ,o=Bh(e,3),s=o[0],a=o[1],u=o[2],c=r?a:this.height-a,l=i&&i*this.distanceScales.unitsPerMeter[2],h=yv([s,c,u],this.pixelUnprojectionMatrix,l),d=this.unprojectPosition(h),f=Bh(d,3),p=f[0],g=f[1],m=f[2];return Number.isFinite(u)?[p,g,m]:Number.isFinite(i)?[p,g,i]:[p,g]}},{key:"projectPosition",value:function(e){var t=Bh(this.projectFlat(e),2);return[t[0],t[1],(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:"unprojectPosition",value:function(e){var t=Bh(this.unprojectFlat(e),2);return[t[0],t[1],(e[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:"projectFlat",value:function(e){return this.isGeospatial?uv(e):e}},{key:"unprojectFlat",value:function(e){return this.isGeospatial?cv(e):e}},{key:"getBounds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={targetZ:e.z||0},n=this.unproject([0,0],t),r=this.unproject([this.width,0],t),i=this.unproject([0,this.height],t),o=this.unproject([this.width,this.height],t);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}},{key:"getDistanceScales",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?lv({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}},{key:"containsPixel",value:function(e){var t=e.x,n=e.y,r=e.width,i=e.height;return t<this.x+this.width&&this.x<t+(void 0===r?1:r)&&n<this.y+this.height&&this.y<n+(void 0===i?1:i)}},{key:"getFrustumPlanes",value:function(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,((t={}).left=gp((e=this.viewProjectionMatrix)[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),t.right=gp(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),t.bottom=gp(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),t.top=gp(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),t.near=gp(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),t.far=gp(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14]),t)),this._frustumPlanes;var e,t}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"getCameraDirection",value:function(){return this.cameraDirection}},{key:"getCameraUp",value:function(){return this.cameraUp}},{key:"_createProjectionMatrix",value:function(e){var t=e.fovyRadians,n=e.aspect,r=e.focalDistance,i=e.near,o=e.far;return e.orthographic?(new Qy).orthographic({fovy:t,aspect:n,focalDistance:r,near:i,far:o}):(new Qy).perspective({fovy:t,aspect:n,near:i,far:o})}},{key:"_initViewMatrix",value:function(e){var t=e.viewMatrix,n=void 0===t?kv:t,r=e.longitude,i=void 0===r?null:r,o=e.latitude,s=void 0===o?null:o,a=e.zoom,u=void 0===a?null:a,c=e.position,l=void 0===c?null:c,h=e.modelMatrix,d=void 0===h?null:h,f=e.focalDistance,p=void 0===f?1:f,g=e.distanceScales,m=void 0===g?null:g;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(i),this.zoom=u,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:e}){nv(Number.isFinite(e));const t=Math.cos(e*ov);return tv(4003e4*t)-9}({latitude:s})+Math.log2(p):0);var y=Math.pow(2,this.zoom);this.scale=y,this.distanceScales=this.isGeospatial?lv({latitude:s,longitude:i}):m||Ov,this.focalDistance=p,this.distanceScales.metersPerUnit=new dp(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new dp(this.distanceScales.unitsPerMeter),this.position=Tv,this.meterOffset=Tv,l&&(this.position=l,this.modelMatrix=d,this.meterOffset=d?d.transformVector(l):l),this.isGeospatial?(this.longitude=i,this.latitude=s,this.center=this._getCenterInWorld({longitude:i,latitude:s})):this.center=l?this.projectPosition(l):[0,0,0],this.viewMatrixUncentered=n,this.viewMatrix=(new Qy).multiplyRight(this.viewMatrixUncentered).translate(new dp(this.center||Tv).negate())}},{key:"_getCenterInWorld",value:function(e){var t=this.meterOffset,n=this.distanceScales,r=new dp(this.projectPosition([e.longitude,e.latitude,0]));if(t){var i=new dp(t).scale(n.unitsPerMeter);r.add(i)}return r}},{key:"_initProjectionMatrix",value:function(e){var t=e.projectionMatrix,n=e.orthographic,r=e.fovy,i=e.near,o=e.far,s=e.focalDistance;this.projectionMatrix=(void 0===t?null:t)||this._createProjectionMatrix({orthographic:void 0!==n&&n,fovyRadians:e.fovyRadians||(void 0===r?75:r)*Av,aspect:this.width/this.height,focalDistance:void 0===s?1:s,near:void 0===i?.1:i,far:void 0===o?1e3:o})}},{key:"_initPixelMatrices",value:function(){var e,t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];ky(t,t,this.projectionMatrix),ky(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=Ay([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(e=this.viewMatrixInverse)[12],e[13],e[14]];var n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Oy(n,n,[this.width/2,-this.height/2,1]),Ty(n,n,[1,-1,0]),ky(r,n,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=n,this.pixelUnprojectionMatrix=Ay([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Eh.warn("Pixel project matrix not invertible")()}},{key:"metersPerPixel",get:function(){return this.distanceScales.metersPerUnit[2]/this.scale}},{key:"projectionMode",get:function(){return this.isGeospatial?this.zoom<12?Ah.WEB_MERCATOR:Ah.WEB_MERCATOR_AUTO_OFFSET:Ah.IDENTITY}}]),e}();function Cv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Dv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cv(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}Iv.displayName="Viewport";var jv,Pv=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,i);var n=t.latitude,o=void 0===n?0:n,s=t.longitude,a=void 0===s?0:s,u=t.zoom,c=void 0===u?11:u,l=t.pitch,h=void 0===l?0:l,d=t.bearing,f=void 0===d?0:d,p=t.nearZMultiplier,g=void 0===p?.1:p,m=t.farZMultiplier,y=void 0===m?1.01:m,v=t.orthographic,b=void 0!==v&&v,_=t.repeat,w=void 0!==_&&_,x=t.worldOffset,E=void 0===x?0:x,S=t.width,A=t.height,k=t.altitude,T=void 0===k?1.5:k,O=Math.pow(2,c),I=fv({width:S=S||1,height:A=A||1,pitch:h,altitude:T=Math.max(.75,T),nearZMultiplier:g,farZMultiplier:y}),C=I.fov,D=I.aspect,j=I.focalDistance,P=I.near,M=I.far,R=dv({height:A,pitch:h,bearing:f,scale:O,altitude:T});if(E){var N=(new Qy).translate([512*E,0,0]);R=N.multiplyLeft(R)}var L=Object.assign({},t,{width:S,height:A,viewMatrix:R,longitude:a,latitude:o,zoom:c,orthographic:b,fovyRadians:C,aspect:D,focalDistance:b?j:1,near:P,far:M});return(e=r.call(this,L)).latitude=o,e.longitude=a,e.zoom=c,e.pitch=h,e.bearing=f,e.altitude=T,e.orthographic=b,e._subViewports=w?[]:null,Object.freeze(Rh(e)),e}return Ih(i,[{key:"addMetersToLngLat",value:function(e,t){return hv(e,t)}},{key:"getMapCenterByLngLatPosition",value:function(e){var t=e.lngLat,n=yv(e.pos,this.pixelUnprojectionMatrix),r=Hy([],this.projectFlat(t),qy([],n)),i=Hy([],this.center,r);return this.unprojectFlat(i)}},{key:"getBounds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=_v(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}},{key:"fitBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.width,r=this.height,o=vv(Object.assign({width:n,height:r,bounds:e},t)),s=o.longitude,a=o.latitude,u=o.zoom;return new i({width:n,height:r,longitude:s,latitude:a,zoom:u})}},{key:"subViewports",get:function(){if(this._subViewports&&!this._subViewports.length)for(var e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360),r=t;r<=n;r++){var o=r?new i(Dv(Dv({},this),{},{worldOffset:r})):this;this._subViewports.push(o)}return this._subViewports}}]),i}(Iv);function Mv(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.projectPosition(e);if(n&&t instanceof Pv){var i=Bh(e,3),o=i[0],s=i[1],a=i[2],u=void 0===a?0:a,c=t.getDistanceScales([o,s]);r[2]=u*c.unitsPerMeter[2]}return r}function Rv(e,t){var n=t.viewport,r=t.modelMatrix,i=t.coordinateSystem,o=t.coordinateOrigin,s=t.offsetMode,a=Bh(e,3),u=a[0],c=a[1],l=a[2],h=void 0===l?0:l;if(r){var d=Bh(My([],[u,c,h,1],r),3);u=d[0],c=d[1],h=d[2]}switch(i){case Sh.LNGLAT:return Mv([u,c,h],n,s);case Sh.LNGLAT_OFFSETS:return Mv([u+o[0],c+o[1],h+(o[2]||0)],n,s);case Sh.METER_OFFSETS:return Mv(hv(o,[u,c,h]),n,s);case Sh.CARTESIAN:default:return n.isGeospatial?[u+o[0],c+o[1],h+o[2]]:n.projectPosition([u,c,h])}}function Nv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Lv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nv(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}Pv.displayName="WebMercatorViewport";var Fv=(zh(jv={},10241,9987),zh(jv,10240,9729),zh(jv,10242,33071),zh(jv,10243,33071),jv),Bv={},zv={boolean:{validate:function(e,t){return!0},equal:function(e,t,n){return Boolean(e)===Boolean(t)}},number:{validate:function(e,t){return Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)}},color:{validate:function(e,t){return t.optional&&!e||Hv(e)&&(3===e.length||4===e.length)},equal:function(e,t,n){return Uv(e,t)}},accessor:{validate:function(e,t){var n=qv(e);return"function"===n||n===qv(t.value)},equal:function(e,t,n){return"function"==typeof t||Uv(e,t)}},array:{validate:function(e,t){return t.optional&&!e||Hv(e)},equal:function(e,t,n){return n.compare?Uv(e,t):e===t}},function:{validate:function(e,t){return t.optional&&!e||"function"==typeof e},equal:function(e,t,n){return!n.compare||e===t}},data:{transform:function(e,t,n){var r=(n?n.props:{}).dataTransform;return r&&e?r(e):e}},image:{transform:function(e,t,n){return function(e,t){var n=e.context&&e.context.gl;if(!n||!t)return null;if(t instanceof ff)return t;t.constructor&&"Object"!==t.constructor.name&&(t={data:t});var r=null;t.compressed&&(r=zh({},10241,t.data.length>1?9985:9729));var i=new ff(n,Lv(Lv({},t),{},{parameters:Lv(Lv(Lv({},Fv),r),e.props.textureParameters)}));return Bv[i.id]=!0,i}(n,e)},release:function(e){var t;(t=e)&&t instanceof ff&&Bv[t.id]&&(t.delete(),delete Bv[t.id])}}};function Uv(e,t){if(e===t)return!0;if(!Hv(e)||!Hv(t))return!1;var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Vv(e,t){switch(qv(t)){case"object":return Gv(e,t);case"array":return Gv(e,{type:"array",value:t,compare:!1});case"boolean":return Gv(e,{type:"boolean",value:t});case"number":return Gv(e,{type:"number",value:t});case"function":return Gv(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function Gv(e,t){return"type"in t?Object.assign({name:e},zv[t.type],t):"value"in t?Object.assign({name:e,type:qv(t.value)},t):{name:e,type:"object",value:t}}function Hv(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function qv(e){return Hv(e)?"array":null===e?"null":Mh(e)}function Wv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $v=fy.COMPONENT,Xv=fy.ASYNC_ORIGINAL,Kv=fy.ASYNC_RESOLVED,Zv=fy.ASYNC_DEFAULTS;function Yv(){var e=this,t=Qv(e.constructor),n=Object.create(t);n[$v]=e,n[Xv]={},n[Kv]={};for(var r=0;r<arguments.length;++r){var i=arguments[r];for(var o in i)n[o]=i[o]}return Object.freeze(n),n}function Qv(e){return tb(e,"_mergedDefaultProps")||(function(e){if(e.prototype){var t=Object.getPrototypeOf(e),n=Qv(t),r=function(e){for(var t={},n={},r={},i=0,o=Object.entries(e);i<o.length;i++){var s=Bh(o[i],2),a=s[0],u=s[1];if(u&&u.deprecatedFor)r[a]=Array.isArray(u.deprecatedFor)?u.deprecatedFor:[u.deprecatedFor];else{var c=Vv(a,u);t[a]=c,n[a]=c.value}}return{propTypes:t,defaultProps:n,deprecatedProps:r}}(tb(e,"defaultProps")||{}),i=function(e,t,n){var r=Object.create(null);Object.assign(r,t,e);var i=function(e){var t=tb(e,"layerName")||tb(e,"componentName");return t||Eh.once(0,"".concat(e.name,".componentName not specified"))(),t||e.name}(n);return delete e.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}(r.defaultProps,n,e),o=Object.assign({},t._propTypes,r.propTypes);!function(e,t){var n={},r={};for(var i in t){var o=t[i],s=o.name;o.async&&(n[s]=o.value,r[s]=Jv(s))}e[Zv]=n,e[Xv]={},Object.defineProperties(e,r)}(i,o);var s=Object.assign({},t._deprecatedProps,r.deprecatedProps);(function(e,t){var n=function(n){Object.defineProperty(e,n,{enumerable:!1,set:function(e){var r,i="".concat(this.id,": ").concat(n),o=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Wv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wv(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(t[n]);try{for(o.s();!(r=o.n()).done;){var s=r.value;eb(this,s)||(this[s]=e)}}catch(a){o.e(a)}finally{o.f()}Eh.deprecated(i,t[n].join("/"))()}})};for(var r in t)n(r)})(i,s),e._mergedDefaultProps=i,e._propTypes=o,e._deprecatedProps=s}}(e),e._mergedDefaultProps)}function Jv(e){return{enumerable:!0,set:function(t){"string"==typeof t||t instanceof Promise||kp(t)?this[Xv][e]=t:this[Kv][e]=t},get:function(){if(this[Kv]){if(e in this[Kv])return this[Kv][e]||this[Zv][e];if(e in this[Xv]){var t=this[$v]&&this[$v].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[Zv][e]}}return this[Zv][e]}}}function eb(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function tb(e,t){return eb(e,t)&&e[t]}var nb=n(774),rb=n.n(nb);function ib(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(c){return void n(c)}a.done?t(u):Promise.resolve(u).then(r,i)}function ob(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function s(e){ib(o,r,i,s,a,"next",e)}function a(e){ib(o,r,i,s,a,"throw",e)}s(void 0)})}}function sb(e){var t;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(t=e[Symbol.asyncIterator]),null==t&&Symbol.iterator&&(t=e[Symbol.iterator])),null==t&&(t=e["@@asyncIterator"]),null==t&&(t=e["@@iterator"]),null==t)throw new TypeError("Object is not async iterable");return t.call(e)}var ab=fy.ASYNC_ORIGINAL,ub=fy.ASYNC_RESOLVED,cb=fy.ASYNC_DEFAULTS,lb=Object.freeze({}),hb=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Th(this,e),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=function(){},this.oldProps=lb,this.oldAsyncProps=null}var t;return Ih(e,[{key:"finalize",value:function(){for(var e in this.asyncProps){var t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}},{key:"getOldProps",value:function(){return this.oldAsyncProps||this.oldProps}},{key:"resetOldProps",value:function(){this.oldAsyncProps=null,this.oldProps=this.component.props}},{key:"freezeAsyncOldProps",value:function(){if(!this.oldAsyncProps)for(var e in this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps),this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}},{key:"hasAsyncProp",value:function(e){return e in this.asyncProps}},{key:"getAsyncProp",value:function(e){var t=this.asyncProps[e];return t&&t.resolvedValue}},{key:"isAsyncPropLoading",value:function(e){if(e){var t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(var n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}},{key:"reloadAsyncProp",value:function(e,t){this._watchPromise(e,Promise.resolve(t))}},{key:"setAsyncProps",value:function(e){var t=e[ub]||{},n=e[ab]||e,r=e[cb]||{};for(var i in t){var o=t[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,o),t[i]=this.getAsyncProp(i)}for(var s in n){var a=n[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,a)}}},{key:"_updateAsyncProp",value:function(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var n=this.layer&&this.layer.props.fetch;n&&(t=n(t,{propName:e,layer:this.layer}))}t instanceof Promise?this._watchPromise(e,t):kp(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t)}}},{key:"_didAsyncInputValueChange",value:function(e,t){var n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}},{key:"_setPropValue",value:function(e,t){var n=this.asyncProps[e];t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}},{key:"_setAsyncPropValue",value:function(e,t,n){var r=this.asyncProps[e];r&&n>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}},{key:"_watchPromise",value:function(e,t){var n=this,r=this.asyncProps[e];r.pendingLoadCount++;var i=r.pendingLoadCount;t.then(function(t){t=n._postProcessValue(r,t),n._setAsyncPropValue(e,t,i);var o=n.layer&&n.layer.props.onDataLoad;"data"===e&&o&&o(t,{propName:e,layer:n.layer})}).catch(function(e){return Eh.error(e)()})}},{key:"_resolveAsyncIterable",value:(t=ob(rb().mark(function e(t,n){var r,i,o,s,a,u,c,l,h,d,f,p,g;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"data"!==t&&this._setPropValue(t,n),(r=this.asyncProps[t]).pendingLoadCount++,i=r.pendingLoadCount,o=[],s=0,a=!0,u=!1,e.prev=8,l=sb(n);case 10:return e.next=12,l.next();case 12:return a=(h=e.sent).done,e.next=16,h.value;case 16:if(d=e.sent,a){e.next=27;break}f=d,o=(p=(this.component?this.component.props:{}).dataTransform)?p(f,o):o.concat(f),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(t,o,i);case 24:a=!0,e.next=10;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(8),u=!0,c=e.t0;case 33:if(e.prev=33,e.prev=34,a||null==l.return){e.next=38;break}return e.next=38,l.return();case 38:if(e.prev=38,!u){e.next=41;break}throw c;case 41:return e.finish(38);case 42:return e.finish(33);case 43:(g=this.layer&&this.layer.props.onDataLoad)&&g(o,{propName:t,layer:this.layer});case 45:case"end":return e.stop()}},e,this,[[8,29,33,43],[34,,38,42]])})),function(e,n){return t.apply(this,arguments)})},{key:"_postProcessValue",value:function(e,t){var n=e.type;return n&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}},{key:"_createAsyncPropData",value:function(e,t){if(!this.asyncProps[e]){var n=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}]),e}(),db=fy.ASYNC_ORIGINAL,fb=fy.ASYNC_RESOLVED,pb=fy.ASYNC_DEFAULTS,gb=0,mb=function(){function e(){Th(this,e),this.props=Yv.apply(this,arguments),this.id=this.props.id,this.count=gb++,this.lifecycle=dy,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}return Ih(e,[{key:"clone",value:function(e){var t=this.props,n={};for(var r in t[pb])r in t[fb]?n[r]=t[fb][r]:r in t[db]&&(n[r]=t[db][r]);return new this.constructor(Object.assign({},t,n,e))}},{key:"_initState",value:function(){this.internalState=new hb({})}},{key:"stats",get:function(){return this.internalState.stats}}]),e}();mb.componentName="Component",mb.defaultProps={};var yb=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(e){var t,n=e.attributeManager,o=e.layer;return Th(this,i),(t=r.call(this,o)).attributeManager=n,t.model=null,t.needsRedraw=!0,t.subLayers=null,t.usesPickingColorCache=!1,t}return Ih(i,[{key:"layer",get:function(){return this.component},set:function(e){this.component=e}}]),i}(hb),vb=function(e){return"function"==typeof e},bb=function(e){return null!==e&&"object"===Mh(e)},_b=function(e){return bb(e)&&e.constructor==={}.constructor},wb=function(e){return e&&"function"==typeof e[Symbol.iterator]},xb=function(e){return e&&"function"==typeof e[Symbol.asyncIterator]},Eb=function(e){return"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json},Sb=function(e){return"undefined"!=typeof Blob&&e instanceof Blob},Ab=function(e){return function(e){return"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||bb(e)&&vb(e.tee)&&vb(e.cancel)&&vb(e.getReader)}(e)||function(e){return bb(e)&&vb(e.read)&&vb(e.pipe)&&function(e){return"boolean"==typeof e}(e.readable)}(e)};function kb(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function Tb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ob(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tb(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tb(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ib(e){if(!e)return!1;Array.isArray(e)&&(e=e[0]);var t=e.options&&e.options[e.id];return e.parseTextSync||e.parseSync||e.parse||e.parseStream||e.parseInBatches||t&&t.workerUrl}function Cb(e){var t;return kb(e,"null loader"),kb(Ib(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=Ob(Ob({},e=e[0]),{},{options:Ob(Ob({},e.options),t)})),e.extension&&(e.extensions=e.extensions||e.extension,delete e.extension),Array.isArray(e.extensions)||(e.extensions=[e.extensions]),kb(e.extensions&&e.extensions.length>0&&e.extensions[0]),(e.parseTextSync||e.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}var Db={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},jb=Db.global||Db.self||Db.window,Pb="object"!==("undefined"==typeof process?"undefined":Mh(process))||"[object process]"!==String(process)||process.browser,Mb="function"==typeof importScripts,Rb="undefined"!=typeof process&&process.version&&process.version.match(/v([0-9]*)/),Nb=Rb&&parseFloat(Rb[1])||0,Lb={};function Fb(e){for(var t in Lb)e.startsWith(t)&&(e=e.replace(t,Lb[t]));return e.startsWith("http://")||e.startsWith("https://")||(e="".concat("").concat(e)),e}var Bb=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,zb=/^([-\w.]+\/[-\w.+]+)/;function Ub(e){if("string"!=typeof e)return"";var t=e.match(Bb);return t?t[1]:""}var Vb=/\?.*/;function Gb(e){if(Eb(e)){var t=function(e){if("string"!=typeof e)return"";var t=e.match(zb);return t?t[1]:e}(e.headers.get("content-type")),n=Ub(e.url);return{url:qb(e.url||""),type:t||n||null}}return Sb(e)?{url:qb(e.name||""),type:e.type||""}:"string"==typeof e?{url:qb(e),type:Ub(e)}:{url:"",type:""}}function Hb(e){return Eb(e)?e.headers["content-length"]||-1:Sb(e)?e.size:"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}function qb(e){return e.replace(Vb,"")}function Wb(e){return $b.apply(this,arguments)}function $b(){return($b=ob(rb().mark(function e(t){var n,r,i,o,s,a,u;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Eb(t)){e.next=2;break}return e.abrupt("return",t);case 2:return n={},(r=Hb(t))>=0&&(n["content-length"]=String(r)),i=Gb(t),o=i.url,(s=i.type)&&(n["content-type"]=s),e.next=9,Qb(t);case 9:return(a=e.sent)&&(n["x-first-bytes"]=a),"string"==typeof t&&(t=(new TextEncoder).encode(t)),u=new Response(t,{headers:n}),Object.defineProperty(u,"url",{value:o}),e.abrupt("return",u);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Xb(e){return Kb.apply(this,arguments)}function Kb(){return(Kb=ob(rb().mark(function e(t){return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=5;break}return e.next=3,Zb(t);case 3:throw new Error(e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Zb(e){return Yb.apply(this,arguments)}function Yb(){return(Yb=ob(rb().mark(function e(t){var n,r,i;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): "),e.prev=1,r=t.headers.get("Content-Type"),i=t.statusText,!r.includes("application/json")){e.next=11;break}return e.t0=i,e.t1=" ",e.next=9,t.text();case 9:e.t2=e.sent,i=e.t0+=e.t1.concat.call(e.t1,e.t2);case 11:n=(n+=i).length>60?"".concat(n.slice(60),"..."):n,e.next=17;break;case 15:e.prev=15,e.t3=e.catch(1);case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}},e,null,[[1,15]])}))).apply(this,arguments)}function Qb(e){return Jb.apply(this,arguments)}function Jb(){return(Jb=ob(rb().mark(function e(t){var n,r,i,o;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=5,"string"!=typeof t){e.next=3;break}return e.abrupt("return","data:,".concat(t.slice(0,n)));case 3:if(!(t instanceof Blob)){e.next=8;break}return r=t.slice(0,5),e.next=7,new Promise(function(e){var t=new FileReader;t.onload=function(t){return e(t.target&&t.target.result)},t.readAsDataURL(r)});case 7:return e.abrupt("return",e.sent);case 8:if(!(t instanceof ArrayBuffer)){e.next=12;break}return i=t.slice(0,n),o=e_(i),e.abrupt("return","data:base64,".concat(o));case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function e_(e){for(var t="",n=new Uint8Array(e),r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}function t_(e){return n_.apply(this,arguments)}function n_(){return(n_=ob(rb().mark(function e(t){var n;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): "),e.prev=1,!t.headers.get("Content-Type").includes("application/json")){e.next=10;break}return e.t0=n,e.next=7,t.text();case 7:n=e.t0+=e.sent,e.next=11;break;case 10:n+=t.statusText;case 11:e.next=16;break;case 13:return e.prev=13,e.t1=e.catch(1),e.abrupt("return",n);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}function r_(e){return i_.apply(this,arguments)}function i_(){return(i_=ob(rb().mark(function e(t){var n,r,i=arguments;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},"string"==typeof t){e.next=5;break}return e.next=4,Wb(t);case 4:return e.abrupt("return",e.sent);case 5:return t=Fb(t),e.next=8,fetch(t,n);case 8:if((r=e.sent).ok||!n.throws){e.next=15;break}return e.t0=Error,e.next=13,t_(r);case 13:throw e.t1=e.sent,new e.t0(e.t1);case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}var o_=function(){function e(){Th(this,e)}return Ih(e,[{key:"log",value:function(){return function(e){}}},{key:"info",value:function(){return function(e){}}},{key:"warn",value:function(){return function(e){}}},{key:"error",value:function(){return function(e){}}}]),e}();function s_(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a_(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function a_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u_(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l_={baseUri:"",fetch:null,CDN:"https://unpkg.com/@loaders.gl",worker:!0,log:new(function(){function e(){Th(this,e),this.console=console}return Ih(e,[{key:"log",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.console.log).bind.apply(e,[this.console].concat(n))}},{key:"info",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.console.info).bind.apply(e,[this.console].concat(n))}},{key:"warn",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.console.warn).bind.apply(e,[this.console].concat(n))}},{key:"error",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.console.error).bind.apply(e,[this.console].concat(n))}}]),e}()),metadata:!1,transforms:[],reuseWorkers:!0},h_={dataType:"(no longer used)",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"},d_=function(){jb.loaders=jb.loaders||{};var e=jb.loaders;return e._state=e._state||{},e._state},f_=function(){var e=d_();return e.globalOptions=e.globalOptions||c_({},l_),e.globalOptions};function p_(e,t,n,r){return n=n||[],function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console;m_(e,null,n,l_,h_,t);var r,i=s_(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;m_(e&&e[o.id]||{},o.id,n,o.options&&o.options[o.id]||{},o.defaultOptions&&o.defaultOptions[o.id]||{},t)}}catch(s){i.e(s)}finally{i.f()}}(e,n=Array.isArray(n)?n:[n]),function(e,t,n){var r=c_({},e.options||{});return null===r.log&&(r.log=new o_),v_(r,f_()),v_(r,t),function(e,t){t&&!e.baseUri&&(e.baseUri=t)}(r,n),r}(t,e,r)}function g_(e,t){var n=f_(),r=e.fetch||n.fetch;return"function"==typeof r?r:bb(r)?function(e){return r_(e,r)}:t&&t.fetch?t.fetch:function(t){return r_(t,e)}}function m_(e,t,n,r,i,o){var s=t||"Top level",a=t?"".concat(t,"."):"";for(var u in e){var c=!t&&bb(e[u]);if(!(u in r))if(u in i)n.warn("".concat(s," loader option '").concat(a).concat(u,"' deprecated, use '").concat(i[u],"'"));else if(!c){var l=y_(u,o);n.warn("".concat(s," loader option '").concat(a).concat(u,"' not recognized. ").concat(l))}}}function y_(e,t){var n,r=e.toLowerCase(),i="",o=s_(t);try{for(o.s();!(n=o.n()).done;){var s=n.value;for(var a in s.options){if(e===a)return"Did you mean '".concat(s.id,".").concat(a,"'?");var u=a.toLowerCase();(r.startsWith(u)||u.startsWith(r))&&(i=i||"Did you mean '".concat(s.id,".").concat(a,"'?"))}}}catch(c){o.e(c)}finally{o.f()}return i}function v_(e,t){for(var n in t)n in t&&(e[n]=_b(t[n])&&_b(e[n])?c_(c_({},e[n]),t[n]):t[n])}var b_="2.3.13";function __(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b_;kb(e,"no loader provided");var n=e.version;t&&n&&(t=w_(t),n=w_(n))}function w_(e){var t=e.split(".").map(Number);return{major:t[0],minor:t[1]}}var x_=n(540);function E_(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return S_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S_(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function S_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A_(e){if(x_.toArrayBuffer&&(e=x_.toArrayBuffer(e)),e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.buffer;if("string"==typeof e){var t=e;return(new TextEncoder).encode(t).buffer}return e&&"object"===Mh(e)&&e._toArrayBuffer?e._toArrayBuffer():kb(!1)}function k_(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=t.map(function(e){return e instanceof ArrayBuffer?new Uint8Array(e):e}),o=i.reduce(function(e,t){return e+t.byteLength},0),s=new Uint8Array(o),a=0,u=E_(i);try{for(u.s();!(r=u.n()).done;){var c=r.value;s.set(c,a),a+=c.byteLength}}catch(l){u.e(l)}finally{u.f()}return s.buffer}function T_(e){return O_.apply(this,arguments)}function O_(){return(O_=ob(rb().mark(function e(t){var n,r,i,o,s,a,u,c,l;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=[],i=!0,o=!1,e.prev=4,a=sb(t);case 6:return e.next=8,a.next();case 8:return i=(u=e.sent).done,e.next=12,u.value;case 12:if(c=e.sent,i){e.next=19;break}"string"==typeof(l=c)?r.push(l):n.push(l);case 16:i=!0,e.next=6;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(4),o=!0,s=e.t0;case 25:if(e.prev=25,e.prev=26,i||null==a.return){e.next=30;break}return e.next=30,a.return();case 30:if(e.prev=30,!o){e.next=33;break}throw s;case 33:return e.finish(30);case 34:return e.finish(25);case 35:if(!(r.length>0)){e.next=38;break}return kb(0===n.length),e.abrupt("return",r.join(""));case 38:return e.abrupt("return",k_.apply(void 0,n));case 39:case"end":return e.stop()}},e,null,[[4,21,25,35],[26,,30,34]])}))).apply(this,arguments)}var I_=rb().mark(C_);function C_(e){var t,n,r,i,o,s,a=arguments;return rb().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=void 0===(t=(a.length>1&&void 0!==a[1]?a[1]:{}).chunkSize)?262144:t,r=0,i=new TextEncoder;case 4:if(!(r<e.length)){u.next=12;break}return o=Math.min(e.length-r,n),s=e.slice(r,r+o),r+=o,u.next=10,i.encode(s);case 10:u.next=4;break;case 12:case"end":return u.stop()}},I_)}var D_=rb().mark(j_);function j_(e){var t,n,r,i,o,s,a=arguments;return rb().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:n=void 0===(t=(a.length>1&&void 0!==a[1]?a[1]:{}).chunkSize)?262144:t,r=0;case 3:if(!(r<e.byteLength)){u.next=14;break}return i=Math.min(e.byteLength-r,n),o=new ArrayBuffer(i),s=new Uint8Array(e,r,i),new Uint8Array(o).set(s),r+=i,u.next=12,o;case 12:u.next=3;break;case 14:case"end":return u.stop()}},D_)}function P_(e){this.wrapped=e}function M_(e){return new P_(e)}function R_(e){var t,n;function r(t,n){try{var o=e[t](n),s=o.value,a=s instanceof P_;Promise.resolve(a?s.wrapped:s).then(function(e){a?r("return"===t?"return":"next",e):i(o.done?"return":"normal",e)},function(e){r("throw",e)})}catch(u){i("throw",u)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(o,s){var a={key:e,arg:i,resolve:o,reject:s,next:null};n?n=n.next=a:(t=n=a,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}function N_(e){return function(){return new R_(e.apply(this,arguments))}}R_.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},R_.prototype.next=function(e){return this._invoke("next",e)},R_.prototype.throw=function(e){return this._invoke("throw",e)},R_.prototype.return=function(e){return this._invoke("return",e)};var L_=1048576;function F_(e){return B_.apply(this,arguments)}function B_(){return(B_=N_(rb().mark(function e(t){var n,r,i,o,s=arguments;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=(s.length>1&&void 0!==s[1]?s[1]:{}).chunkSize||L_,r=0;case 3:if(!(r<t.size)){e.next=13;break}return i=r+n,e.next=7,M_(z_(t,r,i));case 7:return o=e.sent,r=i,e.next=11,o;case 11:e.next=3;break;case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function z_(e,t,n){return U_.apply(this,arguments)}function U_(){return(U_=ob(rb().mark(function e(t,n,r){return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e,i){var o=t.slice(n,r),s=new FileReader;s.onload=function(t){return e(t.target&&t.target.result)},s.onerror=function(e){return i(e)},s.readAsArrayBuffer(o)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V_(e){if(Pb||Nb>=10){if("function"==typeof e[Symbol.asyncIterator])return function(e){return G_.apply(this,arguments)}(e);if("function"==typeof e.getIterator)return e.getIterator()}return Pb?function(e){return H_.apply(this,arguments)}(e):function(e){return q_.apply(this,arguments)}(e)}function G_(){return(G_=N_(rb().mark(function e(t){var n,r,i,o,s,a,u;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,r=!1,e.prev=2,o=sb(t);case 4:return e.next=6,M_(o.next());case 6:return n=(s=e.sent).done,e.next=10,M_(s.value);case 10:if(a=e.sent,n){e.next=18;break}return u=a,e.next=15,A_(u);case 15:n=!0,e.next=4;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(2),r=!0,i=e.t0;case 24:if(e.prev=24,e.prev=25,n||null==o.return){e.next=29;break}return e.next=29,M_(o.return());case 29:if(e.prev=29,!r){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(24);case 34:case"end":return e.stop()}},e,null,[[2,20,24,34],[25,,29,33]])}))).apply(this,arguments)}function H_(){return(H_=N_(rb().mark(function e(t){var n,r,i;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.getReader(),e.prev=1;case 2:return e.next=5,M_(n.read());case 5:if(i=(r=e.sent).value,!r.done){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,A_(i);case 12:e.next=2;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),n.releaseLock();case 19:case"end":return e.stop()}},e,null,[[1,16]])}))).apply(this,arguments)}function q_(){return(q_=N_(rb().mark(function e(t){var n;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M_(t);case 2:t=e.sent;case 3:if(null===(n=t.read())){e.next=9;break}return e.next=8,A_(n);case 8:return e.abrupt("continue",3);case 9:if(!t._readableState.ended){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,M_(W_(t));case 13:e.next=3;break;case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W_(e){return $_.apply(this,arguments)}function $_(){return($_=ob(rb().mark(function e(t){return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){t.once("readable",e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e?C_(e,t):e instanceof ArrayBuffer?j_(e,t):Sb(e)?F_(e,t):Ab(e)?V_(e):Eb(e)?V_(e.body):kb(!1)}var K_="Cannot convert supplied data type";function Z_(e,t){if(t.text&&"string"==typeof e)return e;if(e instanceof ArrayBuffer){var n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)||(o=e)&&"object"===Mh(o)&&o.isBuffer){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);var r=e.buffer,i=e.byteLength||e.length;return 0===e.byteOffset&&i===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+i)),r}var o;throw new Error(K_)}function Y_(e,t){return Q_.apply(this,arguments)}function Q_(){return(Q_=ob(rb().mark(function e(t,n){var r,i;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t instanceof ArrayBuffer||ArrayBuffer.isView(t),"string"!=typeof t&&!r){e.next=3;break}return e.abrupt("return",Z_(t,n));case 3:if(!Sb(t)){e.next=7;break}return e.next=6,Wb(t);case 6:t=e.sent;case 7:if(!Eb(t)){e.next=21;break}return i=t,e.next=11,Xb(i);case 11:if(!n.binary){e.next=17;break}return e.next=14,i.arrayBuffer();case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,i.text();case 19:e.t0=e.sent;case 20:return e.abrupt("return",e.t0);case 21:if(Ab(t)&&(t=X_(t)),!wb(t)&&!xb(t)){e.next=24;break}return e.abrupt("return",T_(t));case 24:throw new Error(K_);case 25:case"end":return e.stop()}},e)}))).apply(this,arguments)}function J_(e){return function(e){if(Array.isArray(e))return Lh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Fh(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ew(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ew(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ew(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nw(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n||(e=tw({fetch:g_(t||{},e)},e),Array.isArray(e.loaders)||(e.loaders=null),e)}function rw(e,t){if(!t&&e&&!Array.isArray(e))return e;var n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){var r=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[].concat(J_(n),J_(r)):r}return n&&n.length?n:null}var iw=new Map;function ow(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=n||new Set;if(e)if(sw(e))r.add(e);else if(sw(e.buffer))r.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"===Mh(e))for(var i in e)ow(e[i],t,r);return void 0===n?Array.from(r):[]}function sw(e){return!!e&&(e instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&e instanceof MessagePort||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)}var aw=0;function uw(e){(0,e.resolve)(e.data)}var cw=function(){function e(t){var n=t.source,r=t.name,i=void 0===r?"web-worker-".concat(aw++):r,o=t.onMessage;Th(this,e);var s=function(e){if(kb("string"==typeof e,"worker source"),e.startsWith("url(")&&e.endsWith(")")){var t=e.match(/^url\((.*)\)$/)[1];if(t&&!t.startsWith("http"))return t;e=function(e){return"try {\n  importScripts('".concat(e,"');\n} catch (error) {\n  console.error(error);\n}")}(t)}var n=iw.get(e);if(!n){var r=new Blob([e],{type:"application/javascript"});n=URL.createObjectURL(r),iw.set(e,n)}return n}(n);this.worker=new Worker(s,{name:i}),this.name=i,this.onMessage=o||uw}var t;return Ih(e,[{key:"process",value:(t=ob(rb().mark(function e(t){var n=this;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){n.worker.onmessage=function(t){n.onMessage({worker:n.worker,data:t.data,resolve:e,reject:r})},n.worker.onerror=function(e){var t="".concat(n.name,": WorkerThread.process() failed");e.message&&(t+=" ".concat(e.message," ").concat(e.filename,":").concat(e.lineno,":").concat(e.colno));var i=new Error(t);console.error(e),r(i)};var i=ow(t);n.worker.postMessage(t,i)}));case 1:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.worker.terminate(),this.worker=null}}]),e}(),lw=function(){function e(t){var n=t.source,r=t.name,i=void 0===r?"unnamed":r,o=t.maxConcurrency,s=void 0===o?1:o,a=t.onMessage,u=t.onDebug,c=void 0===u?function(){}:u,l=t.reuseWorkers,h=void 0===l||l;Th(this,e),this.source=n,this.name=i,this.maxConcurrency=s,this.onMessage=a,this.onDebug=c,this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.reuseWorkers=h}var t;return Ih(e,[{key:"destroy",value:function(){this.idleQueue.forEach(function(e){return e.destroy()}),this.isDestroyed=!0}},{key:"process",value:function(e,t){var n=this;return new Promise(function(r,i){n.jobQueue.push({data:e,jobName:t,resolve:r,reject:i}),n._startQueuedJob()})}},{key:"_startQueuedJob",value:(t=ob(rb().mark(function e(){var t,n;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.jobQueue.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this._getAvailableWorker()){e.next=5;break}return e.abrupt("return");case 5:return n=this.jobQueue.shift(),this.onDebug({message:"processing",worker:t.name,job:n.jobName,backlog:this.jobQueue.length}),e.prev=7,e.t0=n,e.next=11,t.process(n.data);case 11:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=18;break;case 15:e.prev=15,e.t2=e.catch(7),n.reject(e.t2);case 18:return e.prev=18,this._onWorkerDone(t),e.finish(18);case 21:case"end":return e.stop()}},e,this,[[7,15,18,21]])})),function(){return t.apply(this,arguments)})},{key:"_onWorkerDone",value:function(e){this.isDestroyed?e.destroy():(this.reuseWorkers?this.idleQueue.push(e):(e.destroy(),this.count--),this._startQueuedJob())}},{key:"_getAvailableWorker",value:function(){if(this.idleQueue.length>0)return this.idleQueue.shift();if(this.count<this.maxConcurrency){this.count++;var e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new cw({source:this.source,onMessage:this.onMessage,name:e})}return null}}]),e}(),hw=function(){function e(t){var n=t.maxConcurrency,r=void 0===n?5:n,i=t.onMessage,o=void 0===i?null:i,s=t.onDebug,a=void 0===s?function(){}:s,u=t.reuseWorkers,c=void 0===u||u;Th(this,e),this.maxConcurrency=r,this.onMessage=o,this.onDebug=a,this.workerPools=new Map,this.reuseWorkers=c}var t;return Ih(e,null,[{key:"isSupported",value:function(){return"undefined"!=typeof Worker}}]),Ih(e,[{key:"setProps",value:function(e){"maxConcurrency"in e&&(this.maxConcurrency=e.maxConcurrency),"onDebug"in e&&(this.onDebug=e.onDebug),"reuseWorkers"in e&&(this.reuseWorkers=e.reuseWorkers)}},{key:"destroy",value:function(){this.workerPools.forEach(function(e){return e.destroy()})}},{key:"process",value:(t=ob(rb().mark(function e(t,n,r){var i;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._getWorkerPool(t,n),e.abrupt("return",i.process(r));case 2:case"end":return e.stop()}},e,this)})),function(e,n,r){return t.apply(this,arguments)})},{key:"_getWorkerPool",value:function(e,t){var n=this.workerPools.get(t);return n||(n=new lw({source:e,name:t,onMessage:dw.bind(null,this.onMessage),maxConcurrency:this.maxConcurrency,onDebug:this.onDebug,reuseWorkers:this.reuseWorkers}),this.workerPools.set(t,n)),n}}]),e}();function dw(e,t){var n=t.data,r=t.resolve,i=t.reject;if(e)e({worker:t.worker,data:n,resolve:r,reject:i});else switch(n.type){case"done":r(n.result);break;case"error":i(n.message)}}var fw="2.3.13";function pw(e,t,n,r){if(!hw.isSupported())return!1;var i=n&&n[e.id];return!!("local"===n.worker&&i&&i.localWorkerUrl||n.worker&&i&&i.workerUrl)&&(!e.useWorker||e.useWorker(n))}function gw(e,t,n,r){var i=n&&n[e.id]||{},o="url(".concat("local"===(n||{}).worker?i.localWorkerUrl:i.workerUrl,")"),s=e.name,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return e.maxConcurrency&&(t.maxConcurrency=e.maxConcurrency),e.onDebug&&(t.onDebug=e.onDebug),"reuseWorkers"in e&&(t.reuseWorkers=e.reuseWorkers),mw||(mw=new hw({onMessage:yw})),mw.setProps(t),mw}(n);n=JSON.parse(JSON.stringify(n));var u=e.version!==fw?"(core version ".concat(fw,")"):"";return a.process(o,"".concat(s,"-worker@").concat(e.version).concat(u),{arraybuffer:A_(t),options:n,source:"loaders.gl@".concat(fw),type:"parse"})}var mw=null;function yw(e){return vw.apply(this,arguments)}function vw(){return(vw=ob(rb().mark(function e(t){var n,r,i,o,s;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.worker,i=t.resolve,o=t.reject,e.t0=(r=t.data).type,e.next="done"===e.t0?4:"parse"===e.t0?6:"error"===e.t0?17:19;break;case 4:return i(r.result),e.abrupt("break",19);case 6:return e.prev=6,e.next=9,Bw(r.arraybuffer,r.options,r.url);case 9:n.postMessage({type:"parse-done",id:r.id,result:s=e.sent},ow(s)),e.next=16;break;case 13:e.prev=13,e.t1=e.catch(6),n.postMessage({type:"parse-error",id:r.id,message:e.t1.message});case 16:return e.abrupt("break",19);case 17:return o(r.message),e.abrupt("break",19);case 19:case"end":return e.stop()}},e,null,[[6,13]])}))).apply(this,arguments)}function bw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _w=function(){var e=d_();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function ww(e){var t,n=_w(),r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return bw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bw(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(e=Array.isArray(e)?e:[e]);try{var i=function(){var e=Cb(t.value);n.find(function(t){return e===t})||n.unshift(e)};for(r.s();!(t=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}}function xw(){return _w()}function Ew(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Sw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ew(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ew(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Aw(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return kw(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kw(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function kw(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tw=/\.([^.]+)$/;function Ow(e){return Iw.apply(this,arguments)}function Iw(){return(Iw=ob(rb().mark(function e(t){var n,r,i,o,s=arguments;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>3&&void 0!==s[3]?s[3]:{},!(o=Cw(t,n=s.length>1&&void 0!==s[1]?s[1]:[],Sw(Sw({},r=s.length>2&&void 0!==s[2]?s[2]:{}),{},{nothrow:!0}),i))){e.next=6;break}return e.abrupt("return",o);case 6:if(!Sb(t)){e.next=11;break}return e.next=9,z_(t,0,10);case 9:o=Cw(t=e.sent,n,r,i);case 11:if(o||r.nothrow){e.next=13;break}throw new Error(Dw(t));case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Cw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t&&!Array.isArray(t))return Cb(t);jw(t=[].concat(J_(t||[]),J_(xw())));var i=Gb(e),o=i.url,s=i.type,a=Pw(t,o||r.url);if(!(a=(a=a||Mw(t,s))||Rw(t,e))&&!n.nothrow)throw new Error(Dw(e));return a}function Dw(e){var t=Gb(e),n=t.url,r=t.type,i="No valid loader found";return e&&(i+=' data: "'.concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?Fw(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?Fw(e,0,t):""}(e),'", contentType: "').concat(r,'"')),n&&(i+=" url: ".concat(n)),i}function jw(e){var t,n=Aw(e);try{for(n.s();!(t=n.n()).done;)Cb(t.value)}catch(r){n.e(r)}finally{n.f()}}function Pw(e,t){var n=t&&t.match(Tw),r=n&&n[1];return r&&function(e,t){t=t.toLowerCase();var n,r=Aw(e);try{for(r.s();!(n=r.n()).done;){var i,o=n.value,s=Aw(o.extensions);try{for(s.s();!(i=s.n()).done;)if(i.value.toLowerCase()===t)return o}catch(a){s.e(a)}finally{s.f()}}}catch(a){r.e(a)}finally{r.f()}return null}(e,r)}function Mw(e,t){var n,r=Aw(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.mimeTypes&&i.mimeTypes.includes(t))return i;if(t==="application/x.".concat(i.id))return i}}catch(o){r.e(o)}finally{r.f()}return null}function Rw(e,t){if(!t)return null;var n,r=Aw(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if("string"==typeof t){if(Nw(t,i))return i}else if(ArrayBuffer.isView(t)){if(Lw(t.buffer,t.byteOffset,i))return i}else if(t instanceof ArrayBuffer&&Lw(t,0,i))return i}}catch(o){r.e(o)}finally{r.f()}return null}function Nw(e,t){return t.testText&&t.testText(e)}function Lw(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(function(r){return function(e,t,n,r){if(r instanceof ArrayBuffer)return function(e,t,n){if(e.byteLength<(n=n||e.byteLength)||t.byteLength<n)return!1;for(var r=new Uint8Array(e),i=new Uint8Array(t),o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(r,e,r.byteLength);switch(Mh(r)){case"function":return r(e,n);case"string":return r===Fw(e,t,r.length);default:return!1}}(e,t,n,r)})}function Fw(e,t,n){if(e.byteLength<t+n)return"";for(var r=new DataView(e),i="",o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(t+o));return i}function Bw(e,t,n,r){return zw.apply(this,arguments)}function zw(){return(zw=ob(rb().mark(function e(t,n,r,i){var o,s,a,u;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return kb(!i||"string"!=typeof i,"parse no longer accepts final url"),!n||Array.isArray(n)||Ib(n)||(i=r,r=n,n=null),e.next=4,t;case 4:return r=r||{},o=Gb(t=e.sent),s=o.url,a=rw(n,i),e.next=10,Ow(t,a,r);case 10:if(u=e.sent){e.next=13;break}return e.abrupt("return",null);case 13:return r=p_(r,u,a,s),i=nw({url:s,parse:Bw,loaders:a},r,i),e.next=17,Uw(u,t,r,i);case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Uw(e,t,n,r){return Vw.apply(this,arguments)}function Vw(){return(Vw=ob(rb().mark(function e(t,n,r,i){return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return __(t),e.next=3,Y_(n,t);case 3:if(n=e.sent,!t.parseTextSync||"string"!=typeof n){e.next=7;break}return r.dataType="text",e.abrupt("return",t.parseTextSync(n,r,i,t));case 7:if(!pw(t,0,r)){e.next=11;break}return e.next=10,gw(t,n,r);case 10:return e.abrupt("return",e.sent);case 11:if(!t.parseText||"string"!=typeof n){e.next=15;break}return e.next=14,t.parseText(n,r,i,t);case 14:return e.abrupt("return",e.sent);case 15:if(!t.parse){e.next=19;break}return e.next=18,t.parse(n,r,i,t);case 18:return e.abrupt("return",e.sent);case 19:return kb(!t.parseSync),e.abrupt("return",kb(!1));case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Gw(e,t,n){return Hw.apply(this,arguments)}function Hw(){return(Hw=ob(rb().mark(function e(t,n,r){var i,o;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(n)||Ib(n)||(r=n,n=null),i=g_(r||{}),o=t,"string"!=typeof t){e.next=9;break}return e.next=6,i(t);case 6:o=e.sent,e.next=10;break;case 9:t=null;case 10:if(!Sb(t)){e.next=15;break}return e.next=13,i(t);case 13:o=e.sent,t=null;case 15:return e.next=17,Bw(o,n,r);case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function qw(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ww(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ww(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ww(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $w=Math.pow(2,24)-1,Xw=Object.freeze([]),Kw=xy(function(e){return e.oldViewport.equals(e.viewport)}),Zw=new Uint8ClampedArray(0),Yw={data:{type:"data",value:Xw,async:!0},dataComparator:null,_dataDiff:{type:"function",value:function(e){return e&&e.__diff},compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:function(e,t){var n=t.propName,r=t.layer,i=r.context.resourceManager,o=r.getLoadOptions(),s=r.props.loaders,a=i.contains(e);return a||o||(i.add({resourceId:e,data:Gw(e,s),persistent:!1}),a=!0),a?i.subscribe({resourceId:e,onChange:function(e){return r.internalState.reloadAsyncProp(n,e)},consumerId:r.id,requestId:n}):Gw(e,s,o)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Sh.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:function(e){return[0,100*-e.layerIndex]},compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}},Qw=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return Ih(i,[{key:"toString",value:function(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}},{key:"setState",value:function(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}},{key:"setNeedsRedraw",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.internalState&&(this.internalState.needsRedraw=e)}},{key:"setNeedsUpdate",value:function(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}},{key:"getNeedsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(e)}},{key:"needsUpdate",value:function(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}},{key:"hasUniformTransition",value:function(){return this.internalState.uniformTransitions.active}},{key:"isPickable",value:function(){return this.props.pickable&&this.props.visible}},{key:"getModels",value:function(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}},{key:"getAttributeManager",value:function(){return this.internalState&&this.internalState.attributeManager}},{key:"getCurrentLayer",value:function(){return this.internalState&&this.internalState.layer}},{key:"getLoadOptions",value:function(){return this.props.loadOptions}},{key:"project",value:function(e){var t=this.context.viewport,n=Bh(mv(Rv(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),t.pixelProjectionMatrix),3),r=n[0],i=n[1];return 2===e.length?[r,i]:[r,i,n[2]]}},{key:"unproject",value:function(e){return this.context.viewport.unproject(e)}},{key:"projectPosition",value:function(e){return function(e,t){var n=function(e){var t=Object.assign({},e),n=e.coordinateSystem,r=e.coordinateOrigin,i=e.fromCoordinateOrigin;return n===Sh.DEFAULT&&(n=e.viewport.isGeospatial?Sh.LNGLAT:Sh.CARTESIAN),void 0===e.fromCoordinateSystem&&(t.fromCoordinateSystem=n),void 0===i&&(t.fromCoordinateOrigin=r),t.coordinateSystem=n,t}(t),r=n.viewport,i=n.modelMatrix,o=n.fromCoordinateSystem,s=n.fromCoordinateOrigin,a=Uy(r,n.coordinateSystem,n.coordinateOrigin),u=a.geospatialOrigin,c=a.shaderCoordinateOrigin,l=a.offsetMode,h=Rv(e,{viewport:r,modelMatrix:i,coordinateSystem:o,coordinateOrigin:s,offsetMode:l});return l&&function(e,t,n){e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2]}(h,h,r.projectPosition(u||c)),h}(e,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}},{key:"use64bitPositions",value:function(){var e=this.props.coordinateSystem;return e===Sh.DEFAULT||e===Sh.LNGLAT||e===Sh.CARTESIAN}},{key:"onHover",value:function(e,t){return!!this.props.onHover&&this.props.onHover(e,t)}},{key:"onClick",value:function(e,t){return!!this.props.onClick&&this.props.onClick(e,t)}},{key:"nullPickingColor",value:function(){return[0,0,0]}},{key:"encodePickingColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}},{key:"decodePickingColor",value:function(e){xp(e instanceof Uint8Array);var t=Bh(e,3);return t[0]+256*t[1]+65536*t[2]-1}},{key:"initializeState",value:function(){throw new Error("Layer ".concat(this," has not defined initializeState"))}},{key:"getShaders",value:function(e){var t,n=qw(this.props.extensions);try{for(n.s();!(t=n.n()).done;){var r=t.value;e=Sy(e,r.getShaders.call(this,r))}}catch(i){n.e(i)}finally{n.f()}return e}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.propsOrDataChanged}},{key:"updateState",value:function(e){var t=e.oldProps,n=e.props,r=e.changeFlags,i=this.getAttributeManager();if(r.dataChanged&&i){var o=r.dataChanged;if(Array.isArray(o)){var s,a=qw(o);try{for(a.s();!(s=a.n()).done;)i.invalidateAll(s.value)}catch(h){a.e(h)}finally{a.f()}}else i.invalidateAll()}var u=n.highlightedObjectIndex>=0||n.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==u&&i){var c=i.attributes,l=c.pickingColors||c.instancePickingColors;l&&(u&&l.constant&&(l.constant=!1,i.invalidate(l.id)),l.value||u||(l.constant=!0,l.value=[0,0,0]))}}},{key:"finalizeState",value:function(){var e,t=qw(this.getModels());try{for(t.s();!(e=t.n()).done;)e.value.delete()}catch(r){t.e(r)}finally{t.f()}var n=this.getAttributeManager();n&&n.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}},{key:"draw",value:function(e){var t,n=qw(this.getModels());try{for(n.s();!(t=n.n()).done;)t.value.draw(e)}catch(r){n.e(r)}finally{n.f()}}},{key:"getPickingInfo",value:function(e){var t=e.info,n=t.index;return n>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[n]),t}},{key:"activateViewport",value:function(e){var t=this.internalState.viewport;this.internalState.viewport=e,t&&Kw({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}},{key:"invalidateAttribute",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}},{key:"updateAttributes",value:function(e){var t,n=qw(this.getModels());try{for(n.s();!(t=n.n()).done;)this._setModelAttributes(t.value,e)}catch(r){n.e(r)}finally{n.f()}}},{key:"_updateAttributes",value:function(e){var t=this.getAttributeManager();if(t){var n=this.getNumInstances(e),r=this.getStartIndices(e);t.update({data:e.data,numInstances:n,startIndices:r,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this,ignoreUnknownAttributes:!0});var i=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}}},{key:"_updateAttributeTransition",value:function(){var e=this.getAttributeManager();e&&e.updateTransition()}},{key:"_updateUniformTransition",value:function(){var e=this.internalState.uniformTransitions;if(e.active){var t=e.update(),n=Object.create(this.props);for(var r in t)Object.defineProperty(n,r,{value:t[r]});return n}return this.props}},{key:"calculateInstancePickingColors",value:function(e,t){var n=t.numInstances;if(!e.constant){var r=Math.floor(Zw.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>$w&&Eh.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Zw=Ff.allocate(Zw,n,{size:3,copy:!0,maxCount:Math.max(n,$w)});for(var i=Math.floor(Zw.length/3),o=[],s=r;s<i;s++)this.encodePickingColor(s,o),Zw[3*s+0]=o[0],Zw[3*s+1]=o[1],Zw[3*s+2]=o[2]}e.value=Zw.subarray(0,3*n)}}},{key:"_setModelAttributes",value:function(e,t){var n=this.getAttributeManager().getShaderAttributes(t,e.userData.excludeAttributes||{});e.setAttributes(n)}},{key:"disablePickingIndex",value:function(e){this._disablePickingIndex(e)}},{key:"_disablePickingIndex",value:function(e){var t=this.getAttributeManager().attributes,n=t.pickingColors||t.instancePickingColors,r=n.getVertexOffset(e),i=n.getVertexOffset(e+1);n.buffer.subData({data:new Uint8Array(i-r),offset:r})}},{key:"restorePickingColors",value:function(){var e=this.getAttributeManager().attributes,t=e.pickingColors||e.instancePickingColors;this.internalState.usesPickingColorCache&&t.value.buffer!==Zw.buffer&&(t.value=Zw.subarray(0,t.value.length)),t.updateSubBuffer({startOffset:0})}},{key:"getNumInstances",value:function(e){return void 0!==(e=e||this.props).numInstances?e.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(e){if(null===(t=e)||"object"!==Mh(t))throw new Error("count(): argument not an object");var t;if("function"==typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"===Mh(e)&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error("count(): argument not a container")}(e.data)}},{key:"getStartIndices",value:function(e){return void 0!==(e=e||this.props).startIndices?e.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}},{key:"_initialize",value:function(){Wp("layer.initialize",this),this._initState(),this.initializeState(this.context);var e,t=qw(this.props.extensions);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.initializeState.call(this,this.context,n)}}catch(r){t.e(r)}finally{t.f()}this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}},{key:"_update",value:function(){var e=this.needsUpdate();Wp("layer.update",this,e),e&&this._updateState()}},{key:"_updateState",value:function(){var e=this.props,t=this.context.viewport,n=this._updateUniformTransition();this.internalState.propsInTransition=n,this.context.viewport=this.internalState.viewport||t,this.props=n;try{var r=this._getUpdateParams(),i=this.getModels();if(this.context.gl)this.updateState(r);else try{this.updateState(r)}catch(c){}var o,s=qw(this.props.extensions);try{for(s.s();!(o=s.n()).done;){var a=o.value;a.updateState.call(this,r,a)}}catch(l){s.e(l)}finally{s.f()}var u=this.getModels()[0]!==i[0];this._updateModules(r,u),this.isComposite?this._renderLayers(r):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=t,this.props=e,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}},{key:"_finalize",value:function(){Wp("layer.finalize",this),xp(this.internalState&&this.state),this.finalizeState(this.context);var e,t=qw(this.props.extensions);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.finalizeState.call(this,n)}}catch(r){t.e(r)}finally{t.f()}}},{key:"drawLayer",value:function(e){var t=this,n=e.moduleParameters,r=void 0===n?null:n,i=e.uniforms,o=void 0===i?{}:i,s=e.parameters,a=void 0===s?{}:s;this._updateAttributeTransition();var u=this.props;this.props=this.internalState.propsInTransition||u,o.opacity=Math.pow(this.props.opacity,1/2.2);try{r&&this.setModuleParameters(r);var c=this.props.getPolygonOffset,l=c&&c(o)||[0,0];Ed(this.context.gl,{polygonOffset:l}),Sd(this.context.gl,a,function(){var e,n={moduleParameters:r,uniforms:o,parameters:a,context:t.context},i=qw(t.props.extensions);try{for(i.s();!(e=i.n()).done;){var s=e.value;s.draw.call(t,n,s)}}catch(u){i.e(u)}finally{i.f()}t.draw(n)})}finally{this.props=u}}},{key:"getChangeFlags",value:function(){return this.internalState.changeFlags}},{key:"setChangeFlags",value:function(e){var t=this.internalState.changeFlags;for(var n in e)if(e[n]){var r=!1;switch(n){case"dataChanged":Array.isArray(t[n])&&(t[n]=Array.isArray(e[n])?t[n].concat(e[n]):e[n],r=!0);default:t[n]||(t[n]=e[n],r=!0)}r&&Wp("layer.changeFlag",this,n,e)}var i=t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged;t.propsOrDataChanged=i,t.somethingChanged=i||e.viewportChanged||e.stateChanged}},{key:"clearChangeFlags",value:function(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}},{key:"diffProps",value:function(e,t){var n=function(e,t){var n=my({newProps:e,oldProps:t,propTypes:_y(e),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(e,t){if(null===t)return"oldProps is null, initial diff";var n=null,r=e.dataComparator,i=e._dataDiff;return r?r(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied"),n&&i&&(n=i(e.data,t.data)||n),n}(e,t),i=!1;return r||(i=function(e,t){if(null===t)return"oldProps is null, initial diff";if("all"in e.updateTriggers&&by(e,t,"all"))return{all:!0};var n={},r=!1;for(var i in e.updateTriggers)"all"!==i&&by(e,t,i)&&(n[i]=!0,r=n);return r}(e,t)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:vy(e,t),transitionsChanged:gy(e,t)}}(e,t);if(n.updateTriggersChanged)for(var r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(var i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,t[i],e[i],e.transitions[i]);return this.setChangeFlags(n)}},{key:"validateProps",value:function(){!function(e){var t=_y(e);for(var n in t){var r=t[n],i=r.validate;if(i&&!i(e[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(e[n]))}}(this.props)}},{key:"setModuleParameters",value:function(e){var t,n=qw(this.getModels());try{for(n.s();!(t=n.n()).done;)t.value.updateModuleSettings(e)}catch(r){n.e(r)}finally{n.f()}}},{key:"_updateModules",value:function(e,t){var n=e.props,r=e.oldProps,i=n.autoHighlight,o=n.highlightedObjectIndex,s=n.highlightColor;if(t||r.autoHighlight!==i||r.highlightedObjectIndex!==o||r.highlightColor!==s){var a={};i||(a.pickingSelectedColor=null),Array.isArray(s)&&(a.pickingHighlightColor=s),Number.isInteger(o)&&(a.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(a)}}},{key:"_getUpdateParams",value:function(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}},{key:"_getNeedsRedraw",value:function(e){if(!this.internalState)return!1;var t=!1;t=t||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;var n=this.getAttributeManager(),r=n&&n.getNeedsRedraw(e);return t||r}},{key:"_getAttributeManager",value:function(){return new ty(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}},{key:"_initState",value:function(){xp(!this.internalState&&!this.state),xp(isFinite(this.props.coordinateSystem),"".concat(this.id,": invalid coordinateSystem"));var e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new yb({attributeManager:e,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:function(){return Eh.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),e}}),this.internalState.layer=this,this.internalState.uniformTransitions=new hy(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}},{key:"_transferState",value:function(e){Wp("layer.matched",this,this===e);var t=e.state,n=e.internalState;xp(t&&n),this!==e&&(this.internalState=n,this.internalState.layer=this,this.state=t,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}},{key:"_onAsyncPropUpdated",value:function(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}},{key:"isLoaded",get:function(){return this.internalState&&!this.internalState.isAsyncPropLoading()}},{key:"wrapLongitude",get:function(){return this.props.wrapLongitude}}]),i}(mb);function Jw(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ex(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ex(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function ex(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Qw.layerName="Layer",Qw.defaultProps=Yw;var tx=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return Ih(i,[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(e){Dh(Ch(i.prototype),"setState",this).call(this,e),this.setNeedsUpdate()}},{key:"getPickingInfo",value:function(e){var t=e.info,n=t.object;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?Object.assign(t,{object:n.__source.object,index:n.__source.index}):t}},{key:"renderLayers",value:function(){return null}},{key:"shouldRenderSubLayer",value:function(e,t){var n=this.props._subLayerProps;return t&&t.length||n&&n[e]}},{key:"getSubLayerClass",value:function(e,t){var n=this.props._subLayerProps;return n&&n[e]&&n[e].type||t}},{key:"getSubLayerRow",value:function(e,t,n){return e.__source={parent:this,object:t,index:n},e}},{key:"getSubLayerAccessor",value:function(e){if("function"==typeof e){var t={data:this.props.data,target:[]};return function(n,r){return n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,r)}}return e}},{key:"getSubLayerProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.props,n=t.opacity,r=t.pickable,i=t.visible,o=t.parameters,s=t.getPolygonOffset,a=t.highlightedObjectIndex,u=t.autoHighlight,c=t.highlightColor,l=t.coordinateSystem,h=t.coordinateOrigin,d=t.wrapLongitude,f=t.positionFormat,p=t.modelMatrix,g=t.extensions,m=t._subLayerProps,y={opacity:n,pickable:r,visible:i,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:u,highlightColor:c,coordinateSystem:l,coordinateOrigin:h,wrapLongitude:d,positionFormat:f,modelMatrix:p,extensions:g},v=m&&m[e.id],b=v&&v.updateTriggers,_=e.id||"sublayer";if(v){var w=this.constructor._propTypes;for(var x in v){var E=w[x];E&&"accessor"===E.type&&(v[x]=this.getSubLayerAccessor(v[x]))}}Object.assign(y,e,v,{id:"".concat(this.props.id,"-").concat(_),updateTriggers:Object.assign({all:this.props.updateTriggers.all},e.updateTriggers,b)});var S,A=Jw(g);try{for(A.s();!(S=A.n()).done;){var k=S.value,T=k.getSubLayerProps.call(this,k);T&&Object.assign(y,T,{updateTriggers:Object.assign(y.updateTriggers,T.updateTriggers)})}}catch(O){A.e(O)}finally{A.f()}return y}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var e=this.internalState.subLayers,t=!e||this.needsUpdate();t&&(e=Op(e=this.renderLayers(),Boolean),this.internalState.subLayers=e),Wp("compositeLayer.renderLayers",this,t,e);var n,r=Jw(e);try{for(r.s();!(n=r.n()).done;)n.value.parent=this}catch(i){r.e(i)}finally{r.f()}}},{key:"isComposite",get:function(){return!0}},{key:"isLoaded",get:function(){return Dh(Ch(i.prototype),"isLoaded",this)&&this.getSubLayers().every(function(e){return e.isLoaded})}}]),i}(Qw);tx.layerName="CompositeLayer";var nx=/([0-9]+\.?[0-9]*)(%|px)/;function rx(e){switch(Mh(e)){case"number":return{position:e,relative:!1};case"string":var t=e.match(nx);if(t&&t.length>=3){var n="%"===t[2],r=parseFloat(t[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(e))}}function ix(e,t){return e.relative?Math.round(e.position*t):e.position}function ox(e,t){if(e===t)return!0;if(!e||!t)return!1;for(var n in e){var r=e[n],i=t[n];if(!(r===i||Array.isArray(r)&&Array.isArray(i)&&ox(r,i)))return!1}return!0}function sx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ax(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sx(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ux=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,e);var n=t.id,r=void 0===n?null:n,i=t.x,o=void 0===i?0:i,s=t.y,a=void 0===s?0:s,u=t.width,c=void 0===u?"100%":u,l=t.height,h=void 0===l?"100%":l,d=t.projectionMatrix,f=void 0===d?null:d,p=t.fovy,g=void 0===p?50:p,m=t.near,y=void 0===m?.1:m,v=t.far,b=void 0===v?1e3:v,_=t.modelMatrix,w=void 0===_?null:_,x=t.viewportInstance,E=void 0===x?null:x,S=t.type,A=void 0===S?Iv:S;xp(!E||E instanceof Iv),this.viewportInstance=E,this.id=r||this.constructor.displayName||"view",this.type=A,this.props=Object.assign({},t,{id:this.id,projectionMatrix:f,fovy:g,near:y,far:b,modelMatrix:w}),this._parseDimensions({x:o,y:a,width:c,height:h}),this.equals=this.equals.bind(this),Object.seal(this)}return Ih(e,[{key:"equals",value:function(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):ox(this.props,e.props))}},{key:"makeViewport",value:function(e){var t=e.width,n=e.height,r=e.viewState;if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);var i=this.getDimensions({width:t,height:n});return this._getViewport(r,i)}},{key:"getViewStateId",value:function(){switch(Mh(this.props.viewState)){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}},{key:"filterViewState",value:function(e){if(this.props.viewState&&"object"===Mh(this.props.viewState)){if(!this.props.viewState.id)return this.props.viewState;var t=Object.assign({},e);for(var n in this.props.viewState)"id"!==n&&(t[n]=this.props.viewState[n]);return t}return e}},{key:"getDimensions",value:function(e){var t=e.width,n=e.height;return{x:ix(this._x,t),y:ix(this._y,n),width:ix(this._width,t),height:ix(this._height,n)}}},{key:"_getControllerProps",value:function(e){var t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),Object.assign({},e,t)):null}},{key:"_getViewport",value:function(e,t){return new(0,this.type)(ax(ax(ax({},e),this.props),t))}},{key:"_parseDimensions",value:function(e){var t=e.y,n=e.width,r=e.height;this._x=rx(e.x),this._y=rx(t),this._width=rx(n),this._height=rx(r)}}]),e}(),cx=function(){},lx={transitionEasing:function(e){return e},transitionInterruption:1,onTransitionStart:cx,onTransitionInterrupt:cx,onTransitionEnd:cx},hx=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Th(this,e),this.ControllerState=t,this.props=Object.assign({},lx,n),this.propsInTransition=null,this.transition=new Um(n.timeline),this.onViewStateChange=n.onViewStateChange||cx,this.onStateChange=n.onStateChange||cx,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}return Ih(e,[{key:"finalize",value:function(){this.transition.cancel()}},{key:"getViewportInTransition",value:function(){return this.propsInTransition}},{key:"processViewStateChange",value:function(e){var t=!1,n=this.props;if(e=Object.assign({},lx,e),this.props=e,this._shouldIgnoreViewportChange(n,e))return t;if(this._isTransitionEnabled(e)){var r=this.transition.settings,i=Object.assign({},n,2===r.interruption?r.endProps:this.propsInTransition||n);this._triggerTransition(i,e),t=!0}else this.transition.cancel();return t}},{key:"updateTransition",value:function(){this.transition.update()}},{key:"_isTransitionEnabled",value:function(e){var t=e.transitionDuration;return(t>0||"auto"===t)&&Boolean(e.transitionInterpolator)}},{key:"_isUpdateDueToCurrentTransition",value:function(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}},{key:"_triggerTransition",value:function(e,t){var n=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(n),i=t.transitionInterpolator,o=i.getDuration?i.getDuration(e,t):t.transitionDuration;if(0!==o){var s=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:s.start,endProps:s.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}}},{key:"_onTransitionEnd",value:function(e){var t=this;return function(n){t.propsInTransition=null,t.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(n)}}},{key:"_onTransitionUpdate",value:function(e){var t=e.settings,n=t.interpolator,r=t.startProps,i=t.endProps,o=(0,t.easing)(e.time/t.duration),s=n.interpolateProps(r,i,o);this.propsInTransition=new this.ControllerState(Object.assign({},this.props,s)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}]),e}();function dx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function fx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dx(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var px={transitionDuration:0},gx=function(e){return 1-(1-e)*(1-e)},mx=["wheel"],yx=["panstart","panmove","panend"],vx=["pinchstart","pinchmove","pinchend"],bx=["tripanstart","tripanmove","tripanend"],_x=["doubletap"],wx=["keydown"],xx=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Th(this,e),xp(t),this.ControllerState=t,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new hx(t,fx(fx({},n),{},{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)})),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(n)}return Ih(e,[{key:"finalize",value:function(){for(var e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}},{key:"handleEvent",value:function(e){this.controllerState=new(0,this.ControllerState)(fx(fx({makeViewport:this.makeViewport},this.controllerStateProps),this._state));var t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}},{key:"getCenter",value:function(e){var t=this.controllerStateProps,n=e.offsetCenter;return[n.x-t.x,n.y-t.y]}},{key:"isPointInBounds",value:function(e,t){var n=this.controllerStateProps;if(t&&t.handled)return!1;var r=e[0]>=0&&e[0]<=n.width&&e[1]>=0&&e[1]<=n.height;return r&&t&&t.stopPropagation(),r}},{key:"isFunctionKeyPressed",value:function(e){var t=e.srcEvent;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"blockEvents",value:function(e){var t=this,n=setTimeout(function(){t._eventStartBlocked===n&&(t._eventStartBlocked=null)},e);this._eventStartBlocked=n}},{key:"setProps",value:function(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);var t=e.inertia;!0===t&&(t=300),this.inertia=t;var n=e.scrollZoom,r=void 0===n||n,i=e.dragPan,o=void 0===i||i,s=e.dragRotate,a=void 0===s||s,u=e.doubleClickZoom,c=void 0===u||u,l=e.touchZoom,h=void 0===l||l,d=e.touchRotate,f=void 0!==d&&d,p=e.keyboard,g=void 0===p||p,m=Boolean(this.onViewStateChange);this.toggleEvents(mx,m&&r),this.toggleEvents(yx,m&&(o||a)),this.toggleEvents(vx,m&&(h||f)),this.toggleEvents(bx,m&&f),this.toggleEvents(_x,m&&c),this.toggleEvents(wx,m&&g),this.scrollZoom=r,this.dragPan=o,this.dragRotate=a,this.doubleClickZoom=c,this.touchZoom=h,this.touchRotate=f,this.keyboard=g}},{key:"updateTransition",value:function(){this.transitionManager.updateTransition()}},{key:"toggleEvents",value:function(e,t){var n=this;this.eventManager&&e.forEach(function(e){n._events[e]!==t&&(n._events[e]=t,t?n.eventManager.on(e,n.handleEvent):n.eventManager.off(e,n.handleEvent))})}},{key:"updateViewport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},e.getViewportProps(),t),i=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(n),i){var o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}},{key:"_onTransition",value:function(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}},{key:"_setInteractionState",value:function(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}},{key:"_onPanStart",value:function(e){var t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;var n=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(n=!n);var r=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(r,px,{isDragging:!0}),!0}},{key:"_onPan",value:function(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}},{key:"_onPanEnd",value:function(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}},{key:"_onPanMove",value:function(e){if(!this.dragPan)return!1;var t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,px,{isDragging:!0,isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(e){var t=this.inertia;if(this.dragPan&&t&&e.velocity){var n=this.getCenter(e),r=this.controllerState.pan({pos:[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(r,fx(fx({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:gx}),{isDragging:!1,isPanning:!0})}else{var i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}},{key:"_onPanRotate",value:function(e){if(!this.dragRotate)return!1;var t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,px,{isDragging:!0,isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(e){var t=this.inertia;if(this.dragRotate&&t&&e.velocity){var n=this.getCenter(e),r=this.controllerState.rotate({pos:[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(r,fx(fx({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:gx}),{isDragging:!1,isRotating:!0})}else{var i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}},{key:"_onWheel",value:function(e){if(!this.scrollZoom)return!1;e.preventDefault();var t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;var n=this.scrollZoom,r=n.speed,i=n.smooth,o=void 0!==i&&i,s=e.delta,a=2/(1+Math.exp(-Math.abs(s*(void 0===r?.01:r))));s<0&&0!==a&&(a=1/a);var u=this.controllerState.zoom({pos:t,scale:a});return this.updateViewport(u,fx(fx({},this._getTransitionProps({around:t})),{},{transitionDuration:o?250:1}),{isZooming:!0,isPanning:!0}),!0}},{key:"_onTriplePanStart",value:function(e){var t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;var n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,px,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;var t=this.getCenter(e);t[0]-=e.deltaX;var n=this.controllerState.rotate({pos:t});return this.updateViewport(n,px,{isDragging:!0,isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(e){if(!this.isDragging())return!1;var t=this.inertia;if(this.touchRotate&&t&&e.velocityY){var n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*t/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,fx(fx({},this._getTransitionProps()),{},{transitionDuration:t,transitionEasing:gx}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{var o=this.controllerState.rotateEnd();this.updateViewport(o,null,{isDragging:!1,isRotating:!1})}return!0}},{key:"_onPinchStart",value:function(e){var t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;var n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(n,px,{isDragging:!0}),!0}},{key:"_onPinch",value:function(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;var t=this.controllerState;if(this.touchZoom){var n=e.scale,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}return this.touchRotate&&(t=t.rotate({deltaAngleX:this._startPinchRotation-e.rotation})),this.updateViewport(t,px,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}},{key:"_onPinchEnd",value:function(e){if(!this.isDragging())return!1;var t=this.inertia,n=this._lastPinchEvent;if(this.touchZoom&&t&&n&&e.scale!==n.scale){var r=this.getCenter(e),i=this.controllerState.rotateEnd(),o=Math.log2(e.scale),s=(o-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),a=Math.pow(2,o+s*t/2);i=i.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(i,fx(fx({},this._getTransitionProps({around:r})),{},{transitionDuration:t,transitionEasing:gx}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{var u=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(u,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onDoubleTap",value:function(e){if(!this.doubleClickZoom)return!1;var t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;var n=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}},{key:"_onKeyDown",value:function(e){if(!this.keyboard)return!1;var t,n=this.isFunctionKeyPressed(e),r=this.keyboard,i=r.zoomSpeed,o=r.moveSpeed,s=r.rotateSpeedX,a=r.rotateSpeedY,u=this.controllerState,c={};switch(e.srcEvent.code){case"Minus":t=n?u.zoomOut(i).zoomOut(i):u.zoomOut(i),c.isZooming=!0;break;case"Equal":t=n?u.zoomIn(i).zoomIn(i):u.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":n?(t=u.rotateLeft(s),c.isRotating=!0):(t=u.moveLeft(o),c.isPanning=!0);break;case"ArrowRight":n?(t=u.rotateRight(s),c.isRotating=!0):(t=u.moveRight(o),c.isPanning=!0);break;case"ArrowUp":n?(t=u.rotateUp(a),c.isRotating=!0):(t=u.moveUp(o),c.isPanning=!0);break;case"ArrowDown":n?(t=u.rotateDown(a),c.isRotating=!0):(t=u.moveDown(o),c.isPanning=!0);break;default:return!1}return this.updateViewport(t,this._getTransitionProps(),c),!0}},{key:"_getTransitionProps",value:function(){return px}},{key:"events",set:function(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}}]),e}();class Ex extends ep{constructor(e=0,t=0){super(2),Vf(e)&&1===arguments.length?this.copy(e):(zf.debug&&(Zf(e),Zf(t)),this[0]=e,this[1]=t)}set(e,t){return this[0]=e,this[1]=t,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return zf.debug&&(Zf(e.x),Zf(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return $y(this,this,e),this.check()}transformAsVector(e){return up(this,this,e),this.check()}transformByMatrix3(e){return function(e,t,n){var r=t[0],i=t[1];e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7]}(this,this,e),this.check()}transformByMatrix2x3(e){return function(e,t,n){var r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5]}(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,n){var r=t[0],i=t[1];e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i}(this,this,e),this.check()}}var Sx=function(){function e(t){Th(this,e),xp(Number.isFinite(t.width),"`width` must be supplied"),xp(Number.isFinite(t.height),"`height` must be supplied"),this._viewportProps=this._applyConstraints(t)}return Ih(e,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"shortestPathFrom",value:function(e){return this._viewportProps}},{key:"_applyConstraints",value:function(e){return e}}]),e}();function Ax(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return kx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kx(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function kx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tx=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,e),Array.isArray(t)&&(t={compare:t,extract:t,required:t});var n=t,r=n.compare,i=n.extract,o=n.required;this._propsToCompare=r,this._propsToExtract=i,this._requiredProps=o}return Ih(e,[{key:"arePropsEqual",value:function(e,t){var n,r=Ax(this._propsToCompare||Object.keys(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!(i in e)||!(i in t)||!$f(e[i],t[i]))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}},{key:"initializeProps",value:function(e,t){var n;if(this._propsToExtract){var r,i={},o={},s=Ax(this._propsToExtract);try{for(s.s();!(r=s.n()).done;){var a=r.value;i[a]=e[a],o[a]=t[a]}}catch(u){s.e(u)}finally{s.f()}n={start:i,end:o}}else n={start:e,end:t};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}},{key:"interpolateProps",value:function(e,t,n){return t}},{key:"getDuration",value:function(e,t){return t.transitionDuration}},{key:"_checkRequiredProps",value:function(e){this._requiredProps&&this._requiredProps.forEach(function(t){var n=e[t];xp(Number.isFinite(n)||Array.isArray(n),"".concat(t," is required for transition"))})}}]),e}();function Ox(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ix(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ox(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ox(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Cx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dx=["longitude","latitude","zoom","bearing","pitch"],jx=["longitude","latitude","zoom"],Px=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,i);var n=Array.isArray(t)?t:t.transitionProps;return(e=r.call(this,n||{compare:Dx,extract:Dx,required:jx})).opts=t,e}return Ih(i,[{key:"initializeProps",value:function(e,t){var n=Dh(Ch(i.prototype),"initializeProps",this).call(this,e,t),r=this.opts,o=r.makeViewport,s=r.around;if(o&&s){var a=o(e),u=o(t),c=a.unproject(s);n.start.around=s,Object.assign(n.end,{around:u.project(c),aroundLngLat:c,width:t.width,height:t.height})}return n}},{key:"interpolateProps",value:function(e,t,n){var r,i={},o=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Cx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cx(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(this._propsToExtract);try{for(o.s();!(r=o.n()).done;){var s=r.value;i[s]=Wf(e[s]||0,t[s]||0,n)}}catch(c){o.e(c)}finally{o.f()}if(t.aroundLngLat){var a=Bh(this.opts.makeViewport(Ix(Ix({},t),i)).getMapCenterByLngLatPosition({lngLat:t.aroundLngLat,pos:Wf(e.around,t.around,n)}),2),u=a[1];i.longitude=a[0],i.latitude=u}return i}}]),i}(Tx);function Mx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Ch(e);if(t){var i=Ch(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Nh(this,n)}}var Rx={orbitAxis:"Z",rotationX:0,rotationOrbit:0,zoom:0,target:[0,0,0],minRotationX:-90,maxRotationX:90,minZoom:-1/0,maxZoom:1/0},Nx={transitionDuration:300,transitionEasing:function(e){return e},transitionInterpolator:new Px(["target","zoom","rotationX","rotationOrbit"]),transitionInterruption:1},Lx=function(e){return Math.pow(2,e)},Fx=function(e){Ph(n,e);var t=Mx(n);function n(e){var r,i=e.makeViewport,o=e.width,s=e.height,a=e.orbitAxis,u=void 0===a?Rx.orbitAxis:a,c=e.rotationX,l=void 0===c?Rx.rotationX:c,h=e.rotationOrbit,d=void 0===h?Rx.rotationOrbit:h,f=e.target,p=void 0===f?Rx.target:f,g=e.zoom,m=void 0===g?Rx.zoom:g,y=e.minRotationX,v=void 0===y?Rx.minRotationX:y,b=e.maxRotationX,_=void 0===b?Rx.maxRotationX:b,w=e.minZoom,x=void 0===w?Rx.minZoom:w,E=e.maxZoom,S=void 0===E?Rx.maxZoom:E,A=e.startPanPosition,k=e.startTarget,T=e.startRotatePos,O=e.startRotationX,I=e.startRotationOrbit,C=e.startZoomPosition,D=e.startZoom;return Th(this,n),(r=t.call(this,{width:o,height:s,orbitAxis:u,rotationX:l,rotationOrbit:d,target:p,zoom:m,minRotationX:v,maxRotationX:_,minZoom:x,maxZoom:S}))._state={startPanPosition:A,startTarget:k,startRotatePos:T,startRotationX:O,startRotationOrbit:I,startZoomPosition:C,startZoom:D},r.makeViewport=i,r}return Ih(n,[{key:"panStart",value:function(e){return this._getUpdatedState({startPanPosition:e.pos,startTarget:this._viewportProps.target})}},{key:"pan",value:function(e){var t=this._state,n=t.startPanPosition,r=t.startTarget,i=new Ex(e.pos).subtract(n);return this._getUpdatedState({target:this._calculateNewTarget({startTarget:r,pixelOffset:i})})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanPosition:null,startTarget:null})}},{key:"rotateStart",value:function(e){return this._getUpdatedState({startRotatePos:e.pos,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}},{key:"rotate",value:function(e){var t,n=e.pos,r=e.deltaAngleX,i=void 0===r?0:r,o=e.deltaAngleY,s=void 0===o?0:o,a=this._state,u=a.startRotatePos,c=a.startRotationX,l=a.startRotationOrbit,h=this._viewportProps,d=h.width,f=h.height;if(!u||!Number.isFinite(c)||!Number.isFinite(l))return this;if(n){var p=(n[0]-u[0])/d;(c<-90||c>90)&&(p*=-1),t={rotationX:c+(n[1]-u[1])/f*180,rotationOrbit:l+180*p}}else t={rotationX:c+s,rotationOrbit:l+i};return this._getUpdatedState(t)}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}},{key:"shortestPathFrom",value:function(e){var t=e.getViewportProps(),n=Object.assign({},this._viewportProps),r=n.rotationOrbit;return Math.abs(r-t.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}},{key:"zoomStart",value:function(e){return this._getUpdatedState({startZoomPosition:e.pos,startTarget:this._viewportProps.target,startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(e){var t=e.pos,n=e.startPos,r=e.scale,i=this._viewportProps,o=i.zoom,s=i.width,a=i.height,u=i.target,c=this._state,l=c.startZoom,h=c.startZoomPosition,d=c.startTarget;Number.isFinite(l)||(l=o,d=u,h=n||t);var f=this._calculateNewZoom({scale:r,startZoom:l}),p=Lx(l),g=Lx(f);return this._getUpdatedState({zoom:f,target:this._calculateNewTarget({startTarget:d,zoom:f,pixelOffset:[(s/2-h[0])*(g/p-1),(a/2-h[1])*(g/p-1)]})})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomPosition:null,startTarget:null,startZoom:null})}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}},{key:"moveLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=[-e,0];return this._getUpdatedState({target:this._calculateNewTarget({pixelOffset:t})})}},{key:"moveRight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=[e,0];return this._getUpdatedState({target:this._calculateNewTarget({pixelOffset:t})})}},{key:"moveUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=[0,-e];return this._getUpdatedState({target:this._calculateNewTarget({pixelOffset:t})})}},{key:"moveDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=[0,e];return this._getUpdatedState({target:this._calculateNewTarget({pixelOffset:t})})}},{key:"rotateLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}},{key:"rotateRight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}},{key:"rotateUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}},{key:"rotateDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}},{key:"_calculateNewZoom",value:function(e){var t=e.scale,n=e.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom;return Number.isFinite(n)||(n=this._viewportProps.zoom),qf(n+Math.log2(t),o,i)}},{key:"_calculateNewTarget",value:function(e){var t=e.startTarget,n=e.zoom,r=e.pixelOffset,i=Object.assign({},this._viewportProps);Number.isFinite(n)&&(i.zoom=n),t&&(i.target=t);var o=this.makeViewport(i),s=o.project(i.target);return o.unproject([s[0]-r[0],s[1]-r[1],s[2]])}},{key:"_getUpdatedState",value:function(e){return new n(Object.assign({},this._viewportProps,this._state,e))}},{key:"_applyConstraints",value:function(e){var t,n=e.maxRotationX,r=e.minRotationX,i=e.rotationOrbit;return e.zoom=qf(e.zoom,e.minZoom,e.maxZoom),e.rotationX=qf(e.rotationX,r,n),(i<-180||i>180)&&(e.rotationOrbit=((t=(i+180)%360)<0?360+t:t)-180),e}}]),n}(Sx),Bx=function(e){Ph(n,e);var t=Mx(n);function n(e){return Th(this,n),t.call(this,Fx,e)}return Ih(n,[{key:"_getTransitionProps",value:function(){return Nx}}]),n}(xx),zx={transitionDuration:300,transitionEasing:function(e){return e},transitionInterpolator:new Px(["target","zoom"]),transitionInterruption:1},Ux=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(e){return Th(this,i),e.dragMode=e.dragMode||"pan",r.call(this,Fx,e)}return Ih(i,[{key:"_onPanRotate",value:function(e){return!1}},{key:"_getTransitionProps",value:function(){return zx}}]),i}(xx);function Vx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Gx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vx(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Hx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Ch(e);if(t){var i=Ch(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Nh(this,n)}}var qx=(new Qy).lookAt({eye:[0,0,1]});function Wx(e){var t=e.width,n=e.height,r=e.near,i=e.far;return t=t||1,n=n||1,(new Qy).ortho({left:-t/2,right:t/2,bottom:-n/2,top:n/2,near:r,far:i})}var $x=function(e){Ph(n,e);var t=Hx(n);function n(e){Th(this,n);var r=e.width,i=e.height,o=e.near,s=void 0===o?.1:o,a=e.far,u=void 0===a?1e3:a,c=e.zoom,l=void 0===c?0:c,h=e.target,d=void 0===h?[0,0,0]:h,f=e.flipY,p=void 0===f||f,g=Math.pow(2,l);return t.call(this,Gx(Gx({},e),{},{longitude:null,position:d,viewMatrix:qx.clone().scale([g,g*(p?-1:1),g]),projectionMatrix:Wx({width:r,height:i,near:s,far:u}),zoom:l}))}return n}(Iv),Xx=function(e){Ph(n,e);var t=Hx(n);function n(e){return Th(this,n),t.call(this,Object.assign({},e,{type:$x}))}return Ih(n,[{key:"controller",get:function(){return this._getControllerProps({type:Ux})}}]),n}(ux);function Kx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Zx(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kx(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kx(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Yx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Ch(e);if(t){var i=Ch(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Nh(this,n)}}Xx.displayName="OrthographicView";var Qx=Math.PI/180;function Jx(e){var t=e.height,n=e.orbitAxis,r=e.rotationX,i=e.rotationOrbit,o=e.zoom,s=.5/Math.tan(e.fovy*Qx/2),a="Z"===n?[0,0,1]:[0,1,0],u="Z"===n?[0,-s,0]:[0,0,s],c=(new Qy).lookAt({eye:u,up:a});c.rotateX(r*Qx),"Z"===n?c.rotateZ(i*Qx):c.rotateY(i*Qx);var l=Math.pow(2,o)/(t||1);return c.scale(l),c}var eE=function(e){Ph(n,e);var t=Yx(n);function n(e){Th(this,n);var r=e.height,i=e.fovy,o=void 0===i?50:i,s=e.orbitAxis,a=void 0===s?"Z":s,u=e.target,c=void 0===u?[0,0,0]:u,l=e.rotationX,h=void 0===l?0:l,d=e.rotationOrbit,f=void 0===d?0:d,p=e.zoom,g=void 0===p?0:p;return t.call(this,Zx(Zx({},e),{},{longitude:null,viewMatrix:Jx({height:r,fovy:o,orbitAxis:a,rotationX:h,rotationOrbit:f,zoom:g}),fovy:o,position:c,zoom:g}))}return n}(Iv),tE=function(e){Ph(n,e);var t=Yx(n);function n(e){return Th(this,n),t.call(this,Object.assign({},e,{type:eE}))}return Ih(n,[{key:"controller",get:function(){return this._getControllerProps({type:Bx})}}]),n}(ux);tE.displayName="OrbitView";var nE=[255,255,255],rE=0,iE=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,e);var n=t.color,r=void 0===n?nE:n,i=t.intensity,o=void 0===i?1:i;this.id=t.id||"ambient-".concat(rE++),this.color=r,this.intensity=o,this.type="ambient"},oE=[255,255,255],sE=[0,0,-1],aE=0,uE=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,e);var n=t.color,r=void 0===n?oE:n,i=t.intensity,o=void 0===i?1:i,s=t.direction,a=void 0===s?sE:s,u=t._shadow,c=void 0!==u&&u;this.id=t.id||"directional-".concat(aE++),this.color=r,this.intensity=o,this.type="directional",this.direction=new dp(a).normalize().toArray(),this.shadow=c}return Ih(e,[{key:"getProjectedLight",value:function(){return this}}]),e}(),cE=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,e);var n=t.id,r=void 0===n?"effect":n;this.id=r,this.props={},Object.assign(this.props,t)}return Ih(e,[{key:"preRender",value:function(){}},{key:"getModuleParameters",value:function(){}},{key:"cleanup",value:function(){}}]),e}();function lE(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return hE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hE(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function hE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var dE=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return Ih(i,[{key:"render",value:function(e){return Ed(this.gl,{framebuffer:e.target}),this._drawLayers(e)}},{key:"_drawLayers",value:function(e){var t=e.viewports,n=e.views,r=e.onViewportActive,i=e.clearCanvas,o=this.gl;(void 0===i||i)&&function(e){Ed(e,{viewport:[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}),e.clear(16640)}(o);var s,a=[],u=lE(t);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=c.viewport||c,h=n&&n[l.id];r(l);var d=this._getDrawLayerParams(l,e);e.view=h;var f,p=lE(l.subViewports||[l]);try{for(p.s();!(f=p.n()).done;){e.viewport=f.value;var g=this._drawLayersInViewport(o,e,d);a.push(g)}}catch(m){p.e(m)}finally{p.f()}}}catch(m){u.e(m)}finally{u.f()}return a}},{key:"_getDrawLayerParams",value:function(e,t){for(var n=t.layers,r=t.pass,i=void 0===r?"unknown":r,o=t.layerFilter,s=t.effects,a=t.moduleParameters,u=[],c=fE(),l=0;l<n.length;l++){var h=n[l],d=this._shouldDrawLayer(h,e,i,o),f={shouldDrawLayer:d,layerRenderIndex:c(h,d)};d&&(f.moduleParameters=this._getModuleParameters(h,s,i,a),f.layerParameters=this.getLayerParameters(h,l)),u[l]=f}return u}},{key:"_drawLayersInViewport",value:function(e,t,n){var r=t.layers,i=t.onError,o=t.viewport,s=t.view,a=function(e,t){var n=e.canvas?e.canvas.clientHeight||e.canvas.height:100,r=t.viewport,i=Ad(e);return[r.x*i,(n-r.y-r.height)*i,r.width*i,r.height*i]}(e,{viewport:o});if(s&&s.props.clear){var u=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;Sd(e,{scissorTest:!0,scissor:a},function(){return vf(e,u)})}var c={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};Ed(e,{viewport:a});for(var l=0;l<r.length;l++){var h=r[l],d=n[l],f=d.shouldDrawLayer,p=d.layerRenderIndex,g=d.moduleParameters,m=d.layerParameters;if(f&&h.props.pickable&&c.pickableCount++,h.isComposite)c.compositeCount++;else if(f){c.visibleCount++,g.viewport=o;try{h.drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:m})}catch(y){i?i(y,h):Eh.error("error during drawing of ".concat(h),y)()}}}return c}},{key:"shouldDrawLayer",value:function(e){return!0}},{key:"getModuleParameters",value:function(e,t){return null}},{key:"getLayerParameters",value:function(e,t){return e.props.parameters}},{key:"_shouldDrawLayer",value:function(e,t,n,r){var i=this.shouldDrawLayer(e)&&e.props.visible;return i&&r&&(i=r({layer:e,viewport:t,isPicking:n.startsWith("picking"),renderPass:n})),i&&e.activateViewport(t),i}},{key:"_getModuleParameters",value:function(e,t,n,r){var i=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Ad(this.gl)});if(t){var o,s=lE(t);try{for(s.s();!(o=s.n()).done;)Object.assign(i,o.value.getModuleParameters(e))}catch(a){s.e(a)}finally{s.f()}}return Object.assign(i,this.getModuleParameters(e,t),r)}}]),i}(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Th(this,e);var r=n.id,i=void 0===r?"pass":r;this.id=i,this.gl=t,this.props={},Object.assign(this.props,n)}return Ih(e,[{key:"setProps",value:function(e){Object.assign(this.props,e)}},{key:"render",value:function(){}},{key:"cleanup",value:function(){}}]),e}());function fE(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=function r(i,o){var s,a=i.props._offset,u=i.id,c=i.parent&&i.parent.id;if(c&&!(c in t)&&r(i.parent,!1),c in n){var l=n[c]=n[c]||fE(t[c],t);s=l(i,o),n[u]=l}else Number.isFinite(a)?(s=a+(t[c]||0),n[u]=null):s=e;return o&&s>=e&&(e=s+1),t[u]=s,s};return r}function pE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function gE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pE(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var mE=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(e,t){var n,o,s;return Th(this,i),(s=r.call(this,e,t)).shadowMap=new ff(e,{width:1,height:1,parameters:(n={},zh(n,10241,9729),zh(n,10240,9729),zh(n,10242,33071),zh(n,10243,33071),n)}),s.depthBuffer=new mf(e,{format:33189,width:1,height:1}),s.fbo=new kf(e,{id:"shadowmap",width:1,height:1,attachments:(o={},zh(o,36064,s.shadowMap),zh(o,36096,s.depthBuffer),o)}),s}return Ih(i,[{key:"render",value:function(e){var t=this,n=this.fbo;Sd(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},function(){var r=e.viewports[0],o=Ad(t.gl),s=r.width*o,a=r.height*o;s===n.width&&a===n.height||n.resize({width:s,height:a}),Dh(Ch(i.prototype),"render",t).call(t,gE(gE({},e),{},{target:n,pass:"shadow"}))})}},{key:"shouldDrawLayer",value:function(e){return!1!==e.props.shadowEnabled}},{key:"getModuleParameters",value:function(){return{drawToShadowMap:!0}}},{key:"delete",value:function(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}]),i}(dE),yE=Object.keys(Sh).map(function(e){return"const int COORDINATE_SYSTEM_".concat(e," = ").concat(Sh[e],";")}).join(""),vE=Object.keys(Ah).map(function(e){return"const int PROJECTION_MODE_".concat(e," = ").concat(Ah[e],";")}).join("");const bE="".concat(yE,"\n").concat(vE,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    dy = clamp(dy, -1., 1.);\n  }\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  );\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy) * WORLD_SCALE,\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n");var _E={};const wE={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 0.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 0.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:bE,getUniforms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_E;return e.viewport?Vy(e):{}}};function xE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var EE=xy(function(e){var t=e.center;return new Qy(e.viewport.viewProjectionMatrix).invert().transform(t)}),SE=xy(function(e){var t,n=e.viewport,r=e.shadowMatrices,i=[],o=n.pixelUnprojectionMatrix,s=n.isGeospatial?void 0:1,a=[[0,0,s],[n.width,0,s],[0,n.height,s],[n.width,n.height,s],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(function(e){return function(e,t){var n=Bh(e,3),r=n[2],i=yv([n[0],n[1],r],t);return Number.isFinite(r)?i:[i[0],i[1],0]}(e,o)}),u=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return xE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xE(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(r);try{var c=function(){var e=t.value,r=e.clone().translate(new dp(n.center).negate()),o=a.map(function(e){return r.transform(e)}),s=(new Qy).ortho({left:Math.min.apply(Math,J_(o.map(function(e){return e[0]}))),right:Math.max.apply(Math,J_(o.map(function(e){return e[0]}))),bottom:Math.min.apply(Math,J_(o.map(function(e){return e[1]}))),top:Math.max.apply(Math,J_(o.map(function(e){return e[1]}))),near:Math.min.apply(Math,J_(o.map(function(e){return-e[2]}))),far:Math.max.apply(Math,J_(o.map(function(e){return-e[2]})))});i.push(s.multiplyRight(e))};for(u.s();!(t=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}return i}),AE=[0,0,0,1],kE=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function TE(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={shadow_uDrawShadowMap:Boolean(e.drawToShadowMap),shadow_uUseShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,shadow_uColor:e.shadowColor||AE,shadow_uLightId:e.shadowLightId||0,shadow_uLightCount:e.shadowMatrices.length},r=EE({viewport:e.viewport,center:t.project_uCenter}),i=[],o=SE({shadowMatrices:e.shadowMatrices,viewport:e.viewport}).slice(),s=0;s<e.shadowMatrices.length;s++){var a=o[s],u=a.clone().translate(new dp(e.viewport.center).negate());t.project_uCoordinateSystem===Sh.LNGLAT&&t.project_uProjectionMode===Ah.WEB_MERCATOR?(o[s]=u,i[s]=r):(o[s]=a.clone().multiplyRight(kE),i[s]=u.transform(r))}for(var c=0;c<o.length;c++)n["shadow_uViewProjectionMatrices[".concat(c,"]")]=o[c],n["shadow_uProjectCenters[".concat(c,"]")]=i[c],n["shadow_uShadowMap".concat(c)]=e.shadowMaps&&e.shadowMaps.length>0?e.shadowMaps[c]:e.dummyShadowMap;return n}const OE={name:"shadow",dependencies:[wE],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.drawToShadowMap||e.shadowMaps&&e.shadowMaps.length>0){var n={},r=e.shadowEnabled,i=void 0===r||r;return Object.assign(n,i&&e.shadowMatrices&&e.shadowMatrices.length>0?TE(e,t):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}),n}return{}}};function IE(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return CE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CE(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function CE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var DE={color:[255,255,255],intensity:1},jE=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],PE=[0,0,0,200/255],ME=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(e){var t;for(var n in Th(this,i),(t=r.call(this,e)).ambientLight=null,t.directionalLights=[],t.pointLights=[],t.shadowColor=PE,t.shadowPasses=[],t.shadowMaps=[],t.dummyShadowMap=null,t.shadow=!1,t.programManager=null,e){var o=e[n];switch(o.type){case"ambient":t.ambientLight=o;break;case"directional":t.directionalLights.push(o);break;case"point":t.pointLights.push(o)}}return t._applyDefaultLights(),t.shadow=t.directionalLights.some(function(e){return e.shadow}),t}return Ih(i,[{key:"preRender",value:function(e,t){var n=t.layers,r=t.layerFilter,i=t.viewports,o=t.onViewportActive,s=t.views;if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=_m.getDefaultProgramManager(e),OE&&this.programManager.addDefaultModule(OE)),this.dummyShadowMap||(this.dummyShadowMap=new ff(e,{width:1,height:1}));for(var a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:o,views:s,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}},{key:"getModuleParameters",value:function(e){var t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(function(t){return t.getProjectedLight({layer:e})}),pointLights:this.pointLights.map(function(t){return t.getProjectedLight({layer:e})})},t}},{key:"cleanup",value:function(){var e,t=IE(this.shadowPasses);try{for(t.s();!(e=t.n()).done;)e.value.delete()}catch(n){t.e(n)}finally{t.f()}this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(OE),this.programManager=null)}},{key:"_createLightMatrix",value:function(){var e,t=[],n=IE(this.directionalLights);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=(new Qy).lookAt({eye:new dp(r.direction).negate()});t.push(i)}}catch(o){n.e(o)}finally{n.f()}return t}},{key:"_createShadowPasses",value:function(e){for(var t=0;t<this.directionalLights.length;t++){var n=new mE(e);this.shadowPasses[t]=n,this.shadowMaps[t]=n.shadowMap}}},{key:"_applyDefaultLights",value:function(){this.ambientLight||0!==this.pointLights.length||0!==this.directionalLights.length||(this.ambientLight=new iE(DE),this.directionalLights.push(new uE(jE[0]),new uE(jE[1])))}}]),i}(cE);let RE=1,NE=1;class LE{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:i=1}=e,o=RE++,s={time:0,delay:t,duration:n,rate:r,repeat:i};return this._setChannelTime(s,this.time),this.channels.set(o,s),o}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:e,channel:t}=r;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=NE++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}function FE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var BE=function(){function e(t,n,r){Th(this,e),this.id=t,this.context=r,this._loadCount=0,this._subscribers=new Set,this.setData(n)}return Ih(e,[{key:"subscribe",value:function(e){this._subscribers.add(e)}},{key:"unsubscribe",value:function(e){this._subscribers.delete(e)}},{key:"inUse",value:function(){return this._subscribers.size>0}},{key:"delete",value:function(){}},{key:"getData",value:function(){var e=this;return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(function(){return e.getData()})}},{key:"setData",value:function(e,t){var n=this;if(e!==this._data||t){this._data=e;var r=++this._loadCount,i=e;"string"==typeof e&&(i=Gw(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(function(e){n._loadCount===r&&(n.isLoaded=!0,n._error=null,n._content=e)}).catch(function(e){n._loadCount===r&&(n.isLoaded=!0,n._error=e||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);var o,s=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return FE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?FE(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(this._subscribers);try{for(s.s();!(o=s.n()).done;)o.value.onChange(this.getData())}catch(a){s.e(a)}finally{s.f()}}}}]),e}(),zE=function(){function e(t){var n=t.gl,r=t.protocol;Th(this,e),this.protocol=r||"resource://",this._context={gl:n,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}return Ih(e,[{key:"contains",value:function(e){return!!e.startsWith(this.protocol)||e in this._resources}},{key:"add",value:function(e){var t=e.resourceId,n=e.data,r=e.forceUpdate,i=e.persistent,o=void 0===i||i,s=this._resources[t];s?s.setData(n,void 0!==r&&r):(s=new BE(t,n,this._context),this._resources[t]=s),s.persistent=o}},{key:"remove",value:function(e){var t=this._resources[e];t&&(t.delete(),delete this._resources[e])}},{key:"unsubscribe",value:function(e){var t=e.consumerId,n=this._consumers[t];if(n){for(var r in n){var i=n[r];i.resource&&i.resource.unsubscribe(i)}delete this._consumers[t],this.prune()}}},{key:"subscribe",value:function(e){var t=e.resourceId,n=e.onChange,r=e.consumerId,i=e.requestId,o=void 0===i?"default":i,s=this._resources,a=this.protocol;t.startsWith(a)&&(s[t=t.replace(a,"")]||this.add({resourceId:t,data:null,persistent:!1}));var u=s[t];if(this._track(r,o,u,n),u)return u.getData()}},{key:"prune",value:function(){var e=this;this._pruneRequest||(this._pruneRequest=setTimeout(function(){return e._prune()},0))}},{key:"finalize",value:function(){for(var e in this._resources)this._resources[e].delete()}},{key:"_track",value:function(e,t,n,r){var i=this._consumers,o=i[e]=i[e]||{},s=o[t]||{};s.resource&&(s.resource.unsubscribe(s),s.resource=null,this.prune()),n&&(o[t]=s,s.onChange=r,s.resource=n,n.subscribe(s))}},{key:"_prune",value:function(){this._pruneRequest=null;for(var e=0,t=Object.keys(this._resources);e<t.length;e++){var n=t[e],r=this._resources[n];r.persistent||r.inUse()||(r.delete(),delete this._resources[n])}}}]),e}();function UE(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return VE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VE(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function VE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var GE=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},wE],HE=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function qE(e){var t,n=_m.getDefaultProgramManager(e),r=UE(GE);try{for(r.s();!(t=r.n()).done;)n.addDefaultModule(t.value)}catch(s){r.e(s)}finally{r.f()}var i,o=UE(HE);try{for(o.s();!(i=o.n()).done;)n.addShaderHook(i.value)}catch(s){o.e(s)}finally{o.f()}return n}function WE(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return $E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$E(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function $E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var XE="layerManager.setLayers",KE=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}}),ZE=function(e){return e instanceof Qw?"".concat(e):e?"invalid":"null"},YE=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.deck,i=n.stats,o=n.viewport,s=n.timeline;Th(this,e),this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new zE({gl:t,protocol:"deck://"}),this.context=Object.assign({},KE,{layerManager:this,gl:t,deck:r,programManager:t&&qE(t),stats:i||new Nd({id:"deck.gl"}),viewport:o||new Iv({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new LE,resourceManager:this.resourceManager}),this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this._onError=null,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}return Ih(e,[{key:"finalize",value:function(){this.resourceManager.finalize();var e,t=WE(this.layers);try{for(t.s();!(e=t.n()).done;)this._finalizeLayer(e.value)}catch(n){t.e(n)}finally{t.f()}}},{key:"needsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);var n,r=WE(this.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.getNeedsRedraw(e);t=t||o}}catch(s){r.e(s)}finally{r.f()}return t}},{key:"needsUpdate",value:function(){return this._needsUpdate}},{key:"setNeedsRedraw",value:function(e){this._needsRedraw=this._needsRedraw||e}},{key:"setNeedsUpdate",value:function(e){this._needsUpdate=this._needsUpdate||e}},{key:"getLayers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.layerIds,n=void 0===t?null:t;return n?this.layers.filter(function(e){return n.find(function(t){return 0===e.id.indexOf(t)})}):this.layers}},{key:"setProps",value:function(e){"onError"in e&&(this._onError=e.onError),"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&this.setLayers(e.layers)}},{key:"setLayers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t||e!==this.lastRenderedLayers;if(Wp(XE,this,n,e),!n)return this;this.lastRenderedLayers=e;var r,i=WE(e=Op(e,Boolean));try{for(i.s();!(r=i.n()).done;){var o=r.value;o.context=this.context}}catch(s){i.e(s)}finally{i.f()}return this._updateLayers(this.layers,e),this}},{key:"updateLayers",value:function(){var e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this.lastRenderedLayers,!0))}},{key:"activateViewport",value:function(e){return Wp("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}},{key:"_handleError",value:function(e,t,n){this._onError?this._onError(t,n):Eh.error("error during ".concat(e," of ").concat(ZE(n)),t)()}},{key:"_updateLayers",value:function(e,t){var n,r={},i=WE(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;r[o.id]?Eh.warn("Multiple old layers with same id ".concat(ZE(o)))():r[o.id]=o}}catch(l){i.e(l)}finally{i.f()}var s=[];this._updateSublayersRecursively(t,r,s),this._finalizeOldLayers(r);for(var a=!1,u=0,c=s;u<c.length;u++)if(c[u].hasUniformTransition()){a=!0;break}this._needsUpdate=a,this.layers=s}},{key:"_updateSublayersRecursively",value:function(e,t,n){var r,i=WE(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.context=this.context;var s=t[o.id];null===s&&Eh.warn("Multiple new layers with same id ".concat(ZE(o)))(),t[o.id]=null;var a=null;try{this._debug&&s!==o&&o.validateProps(),s?(this._transferLayerState(s,o),this._updateLayer(o)):this._initializeLayer(o),n.push(o),a=o.isComposite&&o.getSubLayers()}catch(u){this._handleError("matching",u,o)}a&&this._updateSublayersRecursively(a,t,n)}}catch(u){i.e(u)}finally{i.f()}}},{key:"_finalizeOldLayers",value:function(e){for(var t in e){var n=e[t];n&&this._finalizeLayer(n)}}},{key:"_initializeLayer",value:function(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}},{key:"_transferLayerState",value:function(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}},{key:"_updateLayer",value:function(e){try{e._update()}catch(t){this._handleError("update",t,e)}}},{key:"_finalizeLayer",value:function(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(ZE(e)),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}]),e}();function QE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function JE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?QE(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eS=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Th(this,e),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}return Ih(e,[{key:"finalize",value:function(){for(var e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}},{key:"needsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}},{key:"setNeedsUpdate",value:function(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}},{key:"updateViewStates",value:function(){for(var e in this.controllers){var t=this.controllers[e];t&&t.updateTransition()}}},{key:"getViewports",value:function(e){return e?this._viewports.filter(function(t){return t.containsPixel(e)}):this._viewports}},{key:"getViews",value:function(){var e={};return this.views.forEach(function(t){e[t.id]=t}),e}},{key:"getView",value:function(e){return"string"==typeof e?this.views.find(function(t){return t.id===e}):e}},{key:"getViewState",value:function(e){var t=this.getView(e),n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}},{key:"getViewport",value:function(e){return this._viewportMap[e]}},{key:"unproject",value:function(e,t){for(var n=this.getViewports(),r={x:e[0],y:e[1]},i=n.length-1;i>=0;--i){var o=n[i];if(o.containsPixel(r)){var s=e.slice();return s[0]-=o.x,s[1]-=o.y,o.unproject(s,t)}}return null}},{key:"setProps",value:function(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}},{key:"_update",value:function(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}},{key:"_setSize",value:function(e,t){xp(Number.isFinite(e)&&Number.isFinite(t)),e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}},{key:"_setViews",value:function(e){e=Op(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}},{key:"_setViewState",value:function(e){e?(!ox(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Eh.warn("missing `viewState` or `initialViewState`")()}},{key:"_onViewStateChange",value:function(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange(t)}},{key:"_createController",value:function(e,t){return new(0,t.type)(JE({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:function(t){return e._getViewport(t,{width:t.width,height:t.height})}},t))}},{key:"_updateController",value:function(e,t,n,r){var i=e.controller;return i?(i=JE(JE(JE(JE({},t),e.props),i),{},{id:e.id,x:n.x,y:n.y,width:n.width,height:n.height}),r?r.setProps(i):r=this._createController(e,i),r):null}},{key:"_rebuildViewports",value:function(){var e=this.width,t=this.height,n=this.views,r=this.controllers;this._viewports=[],this.controllers={};for(var i=!1,o=n.length;o--;){var s=n[o],a=this.getViewState(s),u=s.makeViewport({width:e,height:t,viewState:a}),c=r[s.id];s.controller&&!c&&(i=!0),!i&&s.controller||!c||(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,a,u,c),this._viewports.unshift(u)}for(var l in r)r[l]&&!this.controllers[l]&&r[l].finalize();this._buildViewportMap()}},{key:"_buildViewportMap",value:function(){var e=this;this._viewportMap={},this._viewports.forEach(function(t){t.id&&(e._viewportMap[t.id]=e._viewportMap[t.id]||t)})}},{key:"_diffViews",value:function(e,t){return e.length!==t.length||e.some(function(n,r){return!e[r].equals(t[r])})}}]),e}();function tS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tS(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=Ch(e);if(t){var i=Ch(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Nh(this,n)}}var iS={transitionDuration:300,transitionEasing:function(e){return e},transitionInterpolator:new Px,transitionInterruption:1},oS=function(e){Ph(n,e);var t=rS(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.makeViewport,o=r.width,s=r.height,a=r.latitude,u=r.longitude,c=r.zoom,l=r.bearing,h=void 0===l?0:l,d=r.pitch,f=void 0===d?0:d,p=r.altitude,g=void 0===p?1.5:p,m=r.maxZoom,y=void 0===m?20:m,v=r.minZoom,b=void 0===v?0:v,_=r.maxPitch,w=void 0===_?60:_,x=r.minPitch,E=void 0===x?0:x,S=r.startPanLngLat,A=r.startZoomLngLat,k=r.startRotatePos,T=r.startBearing,O=r.startPitch,I=r.startZoom;return Th(this,n),xp(Number.isFinite(u),"`longitude` must be supplied"),xp(Number.isFinite(a),"`latitude` must be supplied"),xp(Number.isFinite(c),"`zoom` must be supplied"),(e=t.call(this,{width:o,height:s,latitude:a,longitude:u,zoom:c,bearing:h,pitch:f,altitude:g,maxZoom:y,minZoom:b,maxPitch:w,minPitch:E}))._state={startPanLngLat:S,startZoomLngLat:A,startRotatePos:k,startBearing:T,startPitch:O,startZoom:I},e.makeViewport=i,e}return Ih(n,[{key:"panStart",value:function(e){return this._getUpdatedState({startPanLngLat:this._unproject(e.pos)})}},{key:"pan",value:function(e){var t=e.pos,n=this._state.startPanLngLat||this._unproject(e.startPos);if(!n)return this;var r=Bh(this._calculateNewLngLat({startPanLngLat:n,pos:t}),2);return this._getUpdatedState({longitude:r[0],latitude:r[1]})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanLngLat:null})}},{key:"rotateStart",value:function(e){return this._getUpdatedState({startRotatePos:e.pos,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(e){var t,n=e.pos,r=e.deltaAngleX,i=void 0===r?0:r,o=e.deltaAngleY,s=void 0===o?0:o,a=this._state,u=a.startRotatePos,c=a.startBearing,l=a.startPitch;return u&&Number.isFinite(c)&&Number.isFinite(l)?(t=n?this._calculateNewPitchAndBearing(nS(nS({},this._getRotationParams(n,u)),{},{startBearing:c,startPitch:l})):{bearing:c+i,pitch:l+s},this._getUpdatedState(t)):this}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(e){return this._getUpdatedState({startZoomLngLat:this._unproject(e.pos),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(e){var t=e.pos,n=e.startPos,r=e.scale,i=this._state,o=i.startZoom,s=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,s=this._unproject(n)||this._unproject(t));var a=this._calculateNewZoom({scale:r,startZoom:o}),u=Bh(this.makeViewport(nS(nS({},this._viewportProps),{},{zoom:a})).getMapCenterByLngLatPosition({lngLat:s,pos:t}),2);return this._getUpdatedState({zoom:a,longitude:u[0],latitude:u[1]})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(e)}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/e)}},{key:"moveLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([e,0])}},{key:"moveRight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-e,0])}},{key:"moveUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,e])}},{key:"moveDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-e])}},{key:"rotateLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}},{key:"rotateRight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}},{key:"rotateUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}},{key:"rotateDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}},{key:"shortestPathFrom",value:function(e){var t=e.getViewportProps(),n=Object.assign({},this._viewportProps),r=n.bearing,i=n.longitude;return Math.abs(r-t.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-t.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}},{key:"_zoomFromCenter",value:function(e){var t=this._viewportProps;return this.zoom({pos:[t.width/2,t.height/2],scale:e})}},{key:"_panFromCenter",value:function(e){var t=this._viewportProps,n=t.width,r=t.height;return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}},{key:"_getUpdatedState",value:function(e){return new this.constructor(nS(nS(nS({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}},{key:"_applyConstraints",value:function(e){return e.zoom=qf(e.zoom,e.minZoom,e.maxZoom),e.pitch=qf(e.pitch,e.minPitch,e.maxPitch),Object.assign(e,function({width:e,height:t,longitude:n,latitude:r,zoom:i,pitch:o=0,bearing:s=0}){(n<-180||n>180)&&(n=ev(n+180,360)-180),(s<-180||s>180)&&(s=ev(s+180,360)-180);let a=new xv({width:e,height:t,longitude:n,latitude:r,zoom:i}),u=a.project([n,Ev])[1],c=a.project([n,Sv])[1],l=0;return c-u<t&&(i+=tv(t/(c-u)),a=new xv({width:e,height:t,longitude:n,latitude:r,zoom:i}),u=a.project([n,Ev])[1],c=a.project([n,Sv])[1]),u>0?l=u:c<t&&(l=c-t),l&&(r=a.unproject([e/2,t/2+l])[1]),{width:e,height:t,longitude:n,latitude:r,zoom:i,pitch:o,bearing:s}}(e)),e}},{key:"_unproject",value:function(e){var t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}},{key:"_calculateNewLngLat",value:function(e){var t=e.startPanLngLat,n=e.pos;return this.makeViewport(this._viewportProps).getMapCenterByLngLatPosition({lngLat:t,pos:n})}},{key:"_calculateNewZoom",value:function(e){var t=this._viewportProps,n=t.maxZoom,r=t.minZoom;return qf(e.startZoom+Math.log2(e.scale),r,n)}},{key:"_calculateNewPitchAndBearing",value:function(e){var t=e.deltaScaleX,n=e.deltaScaleY,r=e.startBearing,i=e.startPitch;n=qf(n,-1,1);var o=this._viewportProps,s=i;return n>0?s=i+n*(o.maxPitch-i):n<0&&(s=i-n*(o.minPitch-i)),{pitch:s,bearing:r+180*t}}},{key:"_getRotationParams",value:function(e,t){var n=e[1]-t[1],r=e[1],i=t[1],o=this._viewportProps,s=o.height,a=(e[0]-t[0])/o.width,u=0;return n>0?Math.abs(s-i)>5&&(u=n/(i-s)*1.2):n<0&&i>5&&(u=1-r/i),{deltaScaleX:a,deltaScaleY:u=Math.min(1,Math.max(-1,u))}}}]),n}(Sx),sS=function(e){Ph(n,e);var t=rS(n);function n(e){return Th(this,n),e.dragMode=e.dragMode||"pan",t.call(this,oS,e)}return Ih(n,[{key:"_getTransitionProps",value:function(e){return e?nS(nS({},iS),{},{transitionInterpolator:new Px(nS(nS({},e),{},{makeViewport:this.controllerState.makeViewport}))}):iS}}]),n}(xx),aS=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(e){return Th(this,i),r.call(this,Object.assign({},e,{type:Pv}))}return Ih(i,[{key:"controller",get:function(){return this._getControllerProps({type:sS})}}]),i}(ux);function uS(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return cS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cS(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function cS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}aS.displayName="MapView";var lS=new ME,hS=function(){function e(){Th(this,e),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}return Ih(e,[{key:"setProps",value:function(e){"effects"in e&&(e.effects.length===this.effects.length&&ox(e.effects,this.effects)||(this.setEffects(e.effects),this._needsRedraw="effects changed"))}},{key:"needsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}},{key:"getEffects",value:function(){return this._internalEffects}},{key:"finalize",value:function(){this.cleanup()}},{key:"setEffects",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.cleanup(),this.effects=e,this._createInternalEffects()}},{key:"cleanup",value:function(){var e,t=uS(this.effects);try{for(t.s();!(e=t.n()).done;)e.value.cleanup()}catch(i){t.e(i)}finally{t.f()}var n,r=uS(this._internalEffects);try{for(r.s();!(n=r.n()).done;)n.value.cleanup()}catch(i){r.e(i)}finally{r.f()}this.effects.length=0,this._internalEffects.length=0}},{key:"_createInternalEffects",value:function(){this._internalEffects=this.effects.slice(),this.effects.some(function(e){return e instanceof ME})||this._internalEffects.push(lS)}}]),e}(),dS=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return i}(dE);function fS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function pS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fS(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var gS={blendFunc:[1,0,32771,0],blendEquation:32774},mS=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return Ih(i,[{key:"render",value:function(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,Dh(Ch(i.prototype),"render",this).call(this,e))}},{key:"_drawPickingBuffer",value:function(e){var t=this,n=e.layers,r=e.layerFilter,o=e.views,s=e.viewports,a=e.onViewportActive,u=e.pickingFBO,c=e.deviceRect,l=c.x,h=c.y,d=c.width,f=c.height,p=e.pass,g=void 0===p?"picking":p,m=e.redrawReason,y=e.pickZ,v=this.gl;return this.pickZ=y,Sd(v,pS(pS({scissorTest:!0,scissor:[l,h,d,f],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},gS),{},{blend:!y}),function(){Dh(Ch(i.prototype),"render",t).call(t,{target:u,layers:n,layerFilter:r,views:o,viewports:s,onViewportActive:a,pass:g,redrawReason:m})})}},{key:"shouldDrawLayer",value:function(e){return e.props.pickable}},{key:"getModuleParameters",value:function(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}},{key:"getLayerParameters",value:function(e,t){var n=this.pickZ?{blend:!1}:pS(pS({},gS),{},{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return Object.assign({},e.props.parameters,n)}}]),i}(dE);function yS(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return vS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vS(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function vS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bS(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bS(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var wS=function(){function e(t){Th(this,e),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new dS(t),this.pickLayersPass=new mS(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null,this._onError=null}return Ih(e,[{key:"setProps",value:function(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed"),"onError"in e&&(this._onError=e.onError)}},{key:"renderLayers",value:function(e){var t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.onError=this._onError,e.effects=e.effects||[],e.target=e.target||kf.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);var n=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(_S(_S({},e),{},{target:n}));this._postRender(e.effects,e),this.renderCount++,Wp("deckRenderer.renderLayers",this,r,e)}},{key:"needsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}},{key:"finalize",value:function(){var e,t=this.renderBuffers,n=yS(t);try{for(n.s();!(e=n.n()).done;)e.value.delete()}catch(r){n.e(r)}finally{n.f()}t.length=0}},{key:"_preRender",value:function(e,t){var n,r=null,i=yS(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.preRender(this.gl,t),o.postRender&&(r=o)}}catch(s){i.e(s)}finally{i.f()}r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}},{key:"_resizeRenderBuffers",value:function(){var e=this.renderBuffers;0===e.length&&e.push(new kf(this.gl),new kf(this.gl));var t,n=yS(e);try{for(n.s();!(t=n.n()).done;)t.value.resize()}catch(r){n.e(r)}finally{n.f()}}},{key:"_postRender",value:function(e,t){var n,r=this.renderBuffers,i={inputBuffer:r[0],swapBuffer:r[1],target:null},o=yS(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s.postRender){if(s===this.lastPostProcessEffect){i.target=t.target,s.postRender(this.gl,i);break}var a=s.postRender(this.gl,i);i.inputBuffer=a,i.swapBuffer=a===r[0]?r[1]:r[0]}}}catch(u){o.e(u)}finally{o.f()}}}]),e}(),xS={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function ES(e){var t=e.pickedColors,n=e.layers,r=e.deviceX,i=e.deviceY,o=e.deviceRadius,s=e.deviceRect;if(t){for(var a=s.x,u=s.y,c=s.width,l=s.height,h=o*o,d=-1,f=0,p=0;p<l;p++){var g=p+u-i,m=g*g;if(m>h)f+=4*c;else for(var y=0;y<c;y++){if(t[f+3]-1>=0){var v=y+a-r,b=v*v+m;b<=h&&(h=b,d=f)}f+=4}}if(d>=0){var _=t[d+3]-1,w=t.slice(d,d+4),x=n[_];if(x){var E=x.decodePickingColor(w),S=Math.floor(d/4/c);return{pickedColor:w,pickedLayer:x,pickedObjectIndex:E,pickedX:a+(d/4-S*c),pickedY:u+S}}Eh.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return xS}function SS(e){var t=e.pickInfo,n=e.mode,r=e.layerFilter,i=e.pixelRatio,o=e.x,s=e.y,a=e.z,u=t&&t.pickedLayer,c=function(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r];if(i.containsPixel(t)&&(!n||n(i)))return i}return e[0]}(e.viewports,{x:o,y:s},r&&u&&function(e){return r({layer:u,viewport:e,isPicking:!0,renderPass:"picking:".concat(n)})}),l=c&&c.unproject([o-c.x,s-c.y],{targetZ:a});return{color:null,layer:null,viewport:c,index:-1,picked:!1,x:o,y:s,pixel:[o,s],coordinate:l,devicePixel:t&&[t.pickedX,t.pickedY],pixelRatio:i}}function AS(e){var t=e.pickInfo,n=e.lastPickedInfo,r=e.mode,i=t.pickedColor,o=t.pickedLayer,s=t.pickedObjectIndex,a=o?[o]:[];if("hover"===r){var u=n.layerId,c=o&&o.props.id;if(c!==u||s!==n.index){if(c!==u){var l=e.layers.find(function(e){return e.props.id===u});l&&a.unshift(l)}n.layerId=c,n.index=s,n.info=null}}var h=SS(e),d=new Map;return d.set(null,h),a.forEach(function(e){var t=Object.assign({},h);if(e===o&&(t.color=i,t.index=s,t.picked=!0),t=kS({layer:e,info:t,mode:r}),e===o&&"hover"===r&&(n.info=t),t&&d.set(t.layer.id,t),"hover"===r&&e.props.autoHighlight){var a={pickingSelectedColor:o===e?i:null},u=e.props.highlightColor;o===e&&"function"==typeof u&&(a.pickingHighlightColor=u(t)),e.setModuleParameters(a),e.setNeedsRedraw()}}),d}function kS(e){for(var t=e.layer,n=e.info,r=e.mode;t&&n;){var i=n.layer||t;n.layer=t,n=t.getPickingInfo({info:n,mode:r,sourceLayer:i}),t=t.parent}return n}function TS(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return OS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OS(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function OS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var IS=function(){function e(t){Th(this,e),this.gl=t,this.pickingFBO=null,this.pickLayersPass=new mS(t),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null},this._onError=null}return Ih(e,[{key:"setProps",value:function(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"onError"in e&&(this._onError=e.onError),"_pickable"in e&&(this._pickable=e._pickable)}},{key:"finalize",value:function(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}},{key:"pickObject",value:function(e){return this._pickClosestObject(e)}},{key:"pickObjects",value:function(e){return this._pickVisibleObjects(e)}},{key:"getLastPickedObject",value:function(e){var t=e.x,n=e.y,r=e.layers,i=e.viewports,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info,s=o&&o.layer&&o.layer.id,a=o&&o.viewport&&o.viewport.id,u=s?r.find(function(e){return e.id===s}):null,c=a&&i.find(function(e){return e.id===a})||i[0],l=c&&c.unproject([t-c.x,n-c.y]),h={x:t,y:n,viewport:c,coordinate:l,layer:u};return u?Object.assign({},o,h):Object.assign(h,{color:null,object:null,index:-1})}},{key:"_resizeBuffer",value:function(){var e=this.gl;return this.pickingFBO||(this.pickingFBO=new kf(e),kf.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new kf(e),this.depthFBO.attach(zh({},36064,new ff(e,{format:Hh(e)?34836:6408,type:5126}))))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}},{key:"_getPickable",value:function(e){if(!1===this._pickable)return null;var t=e.filter(function(e){return e.isPickable()&&!e.isComposite});return t.length>255?(Eh.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}},{key:"_pickClosestObject",value:function(e){var t=e.layers,n=e.views,r=e.viewports,i=e.x,o=e.y,s=e.radius,a=void 0===s?0:s,u=e.depth,c=void 0===u?1:u,l=e.mode,h=void 0===l?"query":l,d=e.unproject3D,f=e.onViewportActive;if(!(t=this._getPickable(t)))return{result:[],emptyInfo:SS({viewports:r,x:i,y:o})};this._resizeBuffer();for(var p,g=Ad(this.gl),m=kd(this.gl,[i,o],!0),y=[m.x+Math.floor(m.width/2),m.y+Math.floor(m.height/2)],v=Math.round(a*g),b=this.pickingFBO,_=this._getPickingRect({deviceX:y[0],deviceY:y[1],deviceRadius:v,deviceWidth:b.width,deviceHeight:b.height}),w=[],x={},E=0;E<c;E++){var S=ES({pickedColors:_&&this._drawAndSample({layers:t,views:n,viewports:r,onViewportActive:f,deviceRect:_,pass:"picking:".concat(h),redrawReason:h}),layers:t,deviceX:y[0],deviceY:y[1],deviceRadius:v,deviceRect:_}),A=void 0;if(S.pickedLayer&&d&&this.depthFBO&&(A=this._drawAndSample({layers:[S.pickedLayer],views:n,viewports:r,onViewportActive:f,deviceRect:{x:S.pickedX,y:S.pickedY,width:1,height:1},pass:"picking:".concat(h),redrawReason:"pick-z",pickZ:!0})[0]*r[0].distanceScales.metersPerUnit[2]+r[0].position[2]),S.pickedColor&&E+1<c){var k=S.pickedColor[3]-1;x[k]=!0,t[k].disablePickingIndex(S.pickedObjectIndex)}var T,O=TS((p=AS({pickInfo:S,lastPickedInfo:this.lastPickedInfo,mode:h,layers:t,layerFilter:this.layerFilter,viewports:r,x:i,y:o,z:A,pixelRatio:g})).values());try{for(O.s();!(T=O.n()).done;){var I=T.value;I.layer&&w.push(I)}}catch(D){O.e(D)}finally{O.f()}if(!S.pickedColor)break}for(var C in x)t[C].restorePickingColors();return{result:w,emptyInfo:p&&p.get(null)}}},{key:"_pickVisibleObjects",value:function(e){var t=e.layers,n=e.views,r=e.viewports,i=e.x,o=e.y,s=e.width,a=void 0===s?1:s,u=e.height,c=void 0===u?1:u,l=e.mode,h=void 0===l?"query":l,d=e.maxObjects,f=void 0===d?null:d,p=e.onViewportActive;if(!(t=this._getPickable(t)))return[];this._resizeBuffer();for(var g=Ad(this.gl),m=kd(this.gl,[i,o],!0),y=m.x,v=m.y+m.height,b=kd(this.gl,[i+a,o+c],!0),_=b.y,w=function(e){var t=e.pickedColors,n=e.layers,r=new Map;if(t)for(var i=0;i<t.length;i+=4){var o=t[i+3]-1;if(o>=0){var s=t.slice(i,i+4),a=s.join(",");if(!r.has(a)){var u=n[o];u?r.set(a,{pickedColor:s,pickedLayer:u,pickedObjectIndex:u.decodePickingColor(s)}):Eh.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}({pickedColors:this._drawAndSample({layers:t,views:n,viewports:r,onViewportActive:p,deviceRect:{x:y,y:_,width:b.x+b.width-y,height:v-_},pass:"picking:".concat(h),redrawReason:h}),layers:t}),x=new Map,E=Number.isFinite(f),S=0;S<w.length&&!(E&&x.size>=f);S++){var A=w[S],k={color:A.pickedColor,layer:null,index:A.pickedObjectIndex,picked:!0,x:i,y:o,width:a,height:c,pixelRatio:g};k=kS({layer:A.pickedLayer,info:k,mode:h}),x.has(k.object)||x.set(k.object,k)}return Array.from(x.values())}},{key:"_drawAndSample",value:function(e){var t=e.layers,n=e.views,r=e.viewports,i=e.onViewportActive,o=e.deviceRect,s=e.pass,a=e.redrawReason,u=e.pickZ;if(xp(o.width>0&&o.height>0),t.length<1)return null;var c=u?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:t,layerFilter:this.layerFilter,onError:this._onError,views:n,viewports:r,onViewportActive:i,pickingFBO:c,deviceRect:o,pass:s,redrawReason:a,pickZ:u});var l=o.x,h=o.y,d=o.width,f=o.height,p=new(u?Float32Array:Uint8Array)(d*f*4);return Ef(c,{sourceX:l,sourceY:h,sourceWidth:d,sourceHeight:f,target:p}),p}},{key:"_getPickingRect",value:function(e){var t=e.deviceX,n=e.deviceY,r=e.deviceRadius,i=e.deviceWidth,o=e.deviceHeight,s=Math.max(0,t-r),a=Math.max(0,n-r),u=Math.min(i,t+r+1)-s,c=Math.min(o,n+r+1)-a;return u<=0||c<=0?null:{x:s,y:a,width:u,height:c}}}]),e}(),CS={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"},DS=function(){function e(t){Th(this,e);var n=t.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,CS),n.appendChild(this.el))}return Ih(e,[{key:"setTooltip",value:function(e,t,n){var r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(n,"px)")}},{key:"remove",value:function(){this.el&&this.el.remove()}}]),e}();function jS(e,t){if(!e)throw new Error(t)}var PS={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},MS=PS.global||PS.self||PS.window,RS="object"!==("undefined"==typeof process?"undefined":Mh(process))||"[object process]"!==String(process)||process.browser,NS="undefined"!=typeof process&&process.version&&process.version.match(/v([0-9]*)/),LS=(NS&&parseFloat(NS[1]),"undefined"!=typeof Image),FS="undefined"!=typeof ImageBitmap,BS=Boolean(MS._parseImageNode),zS=!!RS||BS;function US(e){switch(function(e){var t=function(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"===Mh(e)&&e.data&&e.width&&e.height?"data":null}(e);if(!t)throw new Error("Not an image");return t}(e)){case"data":return e;case"image":case"imagebitmap":var t=document.createElement("canvas"),n=t.getContext("2d");if(n)return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:return jS(!1)}}var VS=/^data:image\/svg\+xml/,GS=/\.svg((\?|#).*)?$/;function HS(e){return e&&(VS.test(e)||GS.test(e))}function qS(e,t){if(HS(t)){var n=(new TextDecoder).decode(e);return"data:image/svg+xml;base64,".concat(btoa(n))}return WS(e,t)}function WS(e,t){if(HS(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}function $S(e,t,n){return XS.apply(this,arguments)}function XS(){return(XS=ob(rb().mark(function e(t,n,r){var i,o,s;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=qS(t,r),o=self.URL||self.webkitURL,s="string"!=typeof i&&o.createObjectURL(i),e.prev=3,e.next=6,KS(s||i,n);case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,s&&o.revokeObjectURL(s),e.finish(7);case 10:case"end":return e.stop()}},e,null,[[3,,7,10]])}))).apply(this,arguments)}function KS(e,t){return ZS.apply(this,arguments)}function ZS(){return(ZS=ob(rb().mark(function e(t,n){var r;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=new Image).src=t,!(n.image&&n.image.decode&&r.decode)){e.next=6;break}return e.next=5,r.decode();case 5:return e.abrupt("return",r);case 6:return e.next=8,new Promise(function(e,n){try{r.onload=function(){return e(r)},r.onerror=function(e){return n(new Error("Could not load image ".concat(t,": ").concat(e)))}}catch(i){n(i)}});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var YS={},QS=!0;function JS(e,t,n){return eA.apply(this,arguments)}function eA(){return(eA=ob(rb().mark(function e(t,n,r){var i,o;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!HS(r)){e.next=7;break}return e.next=3,$S(t,n,r);case 3:i=e.sent,e.next=8;break;case 7:i=WS(t,r);case 8:return o=n&&n.imagebitmap,e.next=11,tA(i,o);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function tA(e){return nA.apply(this,arguments)}function nA(){return(nA=ob(rb().mark(function e(t){var n,r=arguments;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!rA(n=r.length>1&&void 0!==r[1]?r[1]:null)&&QS||(n=null),!n){e.next=13;break}return e.prev=3,e.next=6,createImageBitmap(t,n);case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(3),console.warn(e.t0),QS=!1;case 13:return e.next=15,createImageBitmap(t);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function rA(e){for(var t in e||YS)return!1;return!0}var iA=!1,oA=!0;function sA(e){var t=aA(e);return function(e){var t=aA(e);return t.byteLength>=24&&2303741511===t.getUint32(0,iA)?{mimeType:"image/png",width:t.getUint32(16,iA),height:t.getUint32(20,iA)}:null}(t)||function(e){var t=aA(e);if(!(t.byteLength>=3&&65496===t.getUint16(0,iA)&&255===t.getUint8(2)))return null;for(var n=function(){for(var e=new Set([65499,65476,65484,65501,65534]),t=65504;t<65520;++t)e.add(t);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}(),r=n.tableMarkers,i=n.sofMarkers,o=2;o+9<t.byteLength;){var s=t.getUint16(o,iA);if(i.has(s))return{mimeType:"image/jpeg",height:t.getUint16(o+5,iA),width:t.getUint16(o+7,iA)};if(!r.has(s))return null;o+=2,o+=t.getUint16(o,iA)}return null}(t)||function(e){var t=aA(e);return t.byteLength>=10&&1195984440===t.getUint32(0,iA)?{mimeType:"image/gif",width:t.getUint16(6,oA),height:t.getUint16(8,oA)}:null}(t)||function(e){var t=aA(e);return t.byteLength>=14&&16973===t.getUint16(0,iA)&&t.getUint32(2,oA)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,oA),height:t.getUint32(22,oA)}:null}(t)}function aA(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}function uA(e,t){var n=(sA(e)||{}).mimeType,r=MS._parseImageNode;return jS(r),r(e,n,t)}function cA(){return(cA=ob(rb().mark(function e(t,n,r){var i,o,s,a;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=(r||{}).url,s=lA(i=((n=n||{}).image||{}).type||"auto"),e.t0=s,e.next="imagebitmap"===e.t0?8:"image"===e.t0?12:"data"===e.t0?16:20;break;case 8:return e.next=10,JS(t,n,o);case 10:return a=e.sent,e.abrupt("break",21);case 12:return e.next=14,$S(t,n,o);case 14:return a=e.sent,e.abrupt("break",21);case 16:return e.next=18,uA(t,n);case 18:return a=e.sent,e.abrupt("break",21);case 20:jS(!1);case 21:return"data"===i&&(a=US(a)),e.abrupt("return",a);case 23:case"end":return e.stop()}},e)}))).apply(this,arguments)}function lA(e){switch(e){case"auto":case"data":return function(){if(FS)return"imagebitmap";if(LS)return"image";if(zS)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return FS||LS||zS;case"imagebitmap":return FS;case"image":return LS;case"data":return zS;case"html":return LS;case"ndarray":return zS;default:throw new Error("@loaders.gl/images: image ".concat(e," not supported in this environment"))}}(e),e}}const hA={id:"image",name:"Images",version:"2.3.13",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(e,t,n){return cA.apply(this,arguments)},tests:[function(e){return Boolean(sA(new DataView(e)))}],options:{image:{type:"auto",decode:!0}}},dA={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){var t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse};var fA="8.4.20",pA=$h.CO.deck&&$h.CO.deck.VERSION;if(pA&&pA!==fA)throw new Error("deck.gl - multiple versions detected: ".concat(pA," vs ").concat(fA));pA||($h.CO.deck=Object.assign($h.CO.deck||{},{VERSION:fA,version:fA,log:Eh,_registerLoggers:function(e){qp=e}}),ww([dA,[hA,{imagebitmap:{premultiplyAlpha:"none"}}]]));const gA=$h.CO.deck;class mA extends Xd{static isSupported(e,t=[]){const n=Hh(e),r=Pf(e,Tf);let i=n||r;for(const o of t)switch(o){case"queries":i=i&&n;break;case"timers":i=i&&r;break;default:Bd(!1)}return i}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)}),this._pollingPromise}_createHandle(){return mA.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}function yA(e){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}const vA=(0,$h.jU)()&&"undefined"!=typeof document;let bA=0;class _A{constructor(e={}){const{onCreateContext:t=(e=>jd(e)),onAddHTML:n=null,onInitialize:r=(()=>{}),onRender:i=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:u={},debug:c=!1,createFramebuffer:l=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:f=Fd.get("animation-loop-".concat(bA++))}=e;let{useDevicePixels:p=!0}=e;"useDevicePixelRatio"in e&&(Uh.deprecated("useDevicePixelRatio","useDevicePixels")(),p=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:n,onInitialize:r,onRender:i,onFinalize:o,onError:s,gl:a,glOptions:u,debug:c,createFramebuffer:l},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=f,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Bd("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=mA.isSupported(this.gl,["timers"])?new mA(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(e=>{this._running&&(this._addCallbackData(e||{}),!1!==e&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),yA(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const n=document.getElementById(e);return n?Number(n.value):t}setViewParameters(){return Uh.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};yA(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=vA?new Promise((e,t)=>{vA&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(e){var t;this.display&&this.display.requestAnimationFrame(e)||(t=e,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60))}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?Pd(this.props.gl,e):this.onCreateContext(e),!Gh(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Ed(this.gl,od),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(e,t={}){if(e.canvas)return void function(e,t,n){let r="width"in n?n.width:e.canvas.clientWidth,i="height"in n?n.height:e.canvas.clientHeight;r&&i||(Uh.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,r=e.canvas.width||1,i=e.canvas.height||1),e.luma=e.luma||{},e.luma.canvasSizeInfo=e.luma.canvasSizeInfo||{};const o=e.luma.canvasSizeInfo;if(o.clientWidth!==r||o.clientHeight!==i||o.devicePixelRatio!==t){let n=t;const o=Math.floor(r*n),s=Math.floor(i*n);e.canvas.width=o,e.canvas.height=s,e.drawingBufferWidth===o&&e.drawingBufferHeight===s||(Uh.warn("Device pixel ratio clamped")(),n=Math.min(e.drawingBufferWidth/r,e.drawingBufferHeight/i),e.canvas.width=Math.floor(r*n),e.canvas.height=Math.floor(i*n)),Object.assign(e.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:t})}}(e,function(e){const t="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(e)?e<=0?1:e:e?t:1}(t.useDevicePixels),t);const n=e.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in t&&"height"in t&&n.resize(t.width,t.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new kf(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var wA=n(524),xA=n.n(wA);const EA={mousedown:1,mousemove:2,mouseup:4};!function(e){const t=e.prototype.handler;e.prototype.handler=function(e){const n=this.store;e.button>0&&"pointerdown"===e.type&&(function(t,n){for(let r=0;r<t.length;r++)if(t[r].pointerId===e.pointerId)return!0;return!1}(n)||n.push(e)),t.call(this,e)}}(xA().PointerEventInput),xA().MouseInput.prototype.handler=function(e){let t=EA[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};const SA=xA().Manager,AA=xA(),kA=AA?[[AA.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[AA.Rotate,{enable:!1}],[AA.Pinch,{enable:!1}],[AA.Swipe,{enable:!1}],[AA.Pan,{threshold:0,enable:!1}],[AA.Press,{enable:!1}],[AA.Tap,{event:"doubletap",taps:2,enable:!1}],[AA.Tap,{event:"anytap",enable:!1}],[AA.Tap,{enable:!1}]]:null,TA={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},OA={doubletap:["tap"]},IA={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},CA={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},DA={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},jA={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},PA="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",MA="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let RA=!1;try{const e={get passive(){return RA=!0,!0}};MA.addEventListener("test",e,e),MA.removeEventListener("test",e,e)}catch(VR){}const NA=-1!==PA.indexOf("firefox"),{WHEEL_EVENTS:LA}=CA,FA="wheel",BA=4.000244140625;class zA{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.events=LA.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(t=>e.addEventListener(t,this.handleEvent,!!RA&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===FA&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;MA.WheelEvent&&(NA&&e.deltaMode===MA.WheelEvent.DOM_DELTA_PIXEL&&(t/=MA.devicePixelRatio),e.deltaMode===MA.WheelEvent.DOM_DELTA_LINE&&(t*=40));const n={x:e.clientX,y:e.clientY};0!==t&&t%BA==0&&(t=Math.floor(t/BA)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,n)}_onWheel(e,t,n){this.callback({type:FA,center:n,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:UA}=CA,VA="pointermove",GA="pointerover",HA="pointerout",qA="pointerleave";class WA{constructor(e,t,n={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=UA.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===VA&&(this.enableMoveEvent=t),e===GA&&(this.enableOverEvent=t),e===HA&&(this.enableOutEvent=t),e===qA&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:GA,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:HA,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:qA,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:VA,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:$A}=CA,XA="keydown",KA="keyup";class ZA{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=$A.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=n.tabIndex||0,e.style.outline="none",this.events.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===XA&&(this.enableDownEvent=t),e===KA&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:XA,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:KA,srcEvent:e,key:e.key,target:e.target}))}}const YA="contextmenu";class QA{constructor(e,t,n={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===YA&&(this.options.enable=t)}handleEvent(e){this.options.enable&&this.callback({type:YA,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const JA={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},ek={srcElement:"root",priority:0};class tk{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,n,r=!1,i=!1){const{handlers:o,handlersByElement:s}=this;n&&("object"!=typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},ek,n):ek;let a=s.get(n.srcElement);a||(a=[],s.set(n.srcElement,a));const u={type:e,handler:t,srcElement:n.srcElement,priority:n.priority};r&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let c=a.length-1;for(;c>=0&&!(a[c].priority>=u.priority);)c--;a.splice(c+1,0,u)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const o=n[i];if(o.type===e&&o.handler===t){n.splice(i,1);const e=r.get(o.srcElement);e.splice(e.indexOf(o),1),0===e.length&&r.delete(o.srcElement)}}this._active=n.some(e=>!e.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},i=()=>{e.handled=!0,t=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:u,once:c}=n[s];if(u(Object.assign({},e,{type:a,stopPropagation:r,stopImmediatePropagation:i})),c&&o.push(n[s]),t)break}for(let e=0;e<o.length;e++){const{type:t,handler:n}=o[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(e){const t=JA[e.srcEvent.type];if(!t)return null;const{buttons:n,button:r,which:i}=e.srcEvent;let o=!1,s=!1,a=!1;return 4===t||2===t&&!Number.isFinite(n)?(o=1===i,s=2===i,a=3===i):2===t?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===t&&(o=0===r,s=1===r,a=2===r),{leftButton:o,middleButton:s,rightButton:a}}(e),function(e,t){const{srcEvent:n}=e;if(!e.center&&!Number.isFinite(n.clientX))return null;const r=e.center||{x:n.clientX,y:n.clientY},i=t.getBoundingClientRect();return{center:r,offsetCenter:{x:(r.x-i.left-t.clientLeft)/(i.width/t.offsetWidth||1),y:(r.y-i.top-t.clientTop)/(i.height/t.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const nk={events:null,recognizers:null,recognizerOptions:{},Manager:SA,touchAction:"none",tabIndex:0};class rk{constructor(e=null,t={}){this.options=Object.assign({},nk,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:n}=t;n&&this.on(n)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||kA}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(TA).forEach(e=>{const t=this.manager.get(e);t&&TA[e].forEach(e=>{t.recognizeWith(e)})});for(const n in t.recognizerOptions){const e=this.manager.get(n);if(e){const r=t.recognizerOptions[n];delete r.enable,e.set(r)}}this.wheelInput=new zA(e,this._onOtherEvent,{enable:!1}),this.moveInput=new WA(e,this._onOtherEvent,{enable:!1}),this.keyInput=new ZA(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new QA(e,this._onOtherEvent,{enable:!1});for(const[n,r]of this.events)r.isEmpty()||(this._toggleRecognizer(r.recognizerName,!0),this.manager.on(n,r.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const r=n.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const i=OA[e];i&&!this.options.recognizers&&i.forEach(i=>{const o=n.get(i);t?(o.requireFailure(e),r.dropRequireFailure(i)):o.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,n,r,i){if("string"!=typeof e){n=t;for(const t in e)this._addEventHandler(t,e[t],n,r,i);return}const{manager:o,events:s}=this,a=jA[e]||e;let u=s.get(a);u||(u=new tk(this),s.set(a,u),u.recognizerName=DA[a]||a,o&&o.on(a,u.handleEvent)),u.add(e,t,n,r,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const t in e)this._removeEventHandler(t,e[t]);return}const{events:n}=this,r=n.get(jA[e]||e);if(r&&(r.remove(e,t),r.isEmpty())){const{recognizerName:e}=r;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_onBasicInput(e){const{srcEvent:t}=e,n=IA[t.type];n&&this.manager.emit(n,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function ik(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ok(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ik(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ik(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function sk(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ak(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ak(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function ak(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uk(){}var ck={id:"deckgl-overlay",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:uk,onResize:uk,onViewStateChange:uk,onInteractionStateChange:uk,onBeforeRender:uk,onAfterRender:uk,onLoad:uk,onError:null,_onMetrics:null,getCursor:function(e){return e.isDragging?"grabbing":"grab"},debug:!1,drawPickingColors:!1},lk=function(){function e(t){Th(this,e),t=Object.assign({},ck,t),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._pickAndCallback=this._pickAndCallback.bind(this),this._onRendererInitialized=this._onRendererInitialized.bind(this),this._onRenderFrame=this._onRenderFrame.bind(this),this._onViewStateChange=this._onViewStateChange.bind(this),this._onInteractionStateChange=this._onInteractionStateChange.bind(this),t.viewState&&t.initialViewState&&Eh.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,$h.qs)()&&Eh.warn("IE 11 support will be deprecated in v8.0")(),t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new Nd({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&Ff.setProps(t._typedArrayManagerProps),this.animationLoop.start()}return Ih(e,[{key:"finalize",value:function(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}},{key:"setProps",value:function(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Eh.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Eh.removed("onLayerClick","onClick")(),e.initialViewState&&!ox(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);var t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}},{key:"needsRedraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(this.props._animate)return"Deck._animate";var t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);var n=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),i=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t||n||r||i||o}},{key:"redraw",value:function(e){if(this.layerManager){var t=e||this.needsRedraw({clearRedrawFlags:!0});t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}}},{key:"getViews",value:function(){return this.viewManager.views}},{key:"getViewports",value:function(e){return this.viewManager.getViewports(e)}},{key:"pickObject",value:function(e){var t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}},{key:"pickMultipleObjects",value:function(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}},{key:"pickObjects",value:function(e){return this._pick("pickObjects","pickObjects Time",e)}},{key:"_addResources",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}},{key:"_removeResources",value:function(e){var t,n=sk(e);try{for(n.s();!(t=n.n()).done;)this.layerManager.resourceManager.remove(t.value)}catch(VR){n.e(VR)}finally{n.f()}}},{key:"_pick",value:function(e,t,n){var r=this.stats;r.get("Pick Count").incrementCount(),r.get(t).timeStart();var i=this.deckPicker[e](Object.assign({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport},n));return r.get(t).timeEnd(),i}},{key:"_createCanvas",value:function(e){var t=e.canvas;"string"==typeof t&&xp(t=document.getElementById(t)),t||(t=document.createElement("canvas"),(e.parent||document.body).appendChild(t));var n=e.style;return t.id=e.id,Object.assign(t.style,n),t}},{key:"_setCanvasSize",value:function(e){if(this.canvas){var t=e.width,n=e.height;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}}},{key:"_updateCanvasSize",value:function(){this._checkForCanvasSizeChange()&&(this.viewManager.setProps({width:this.width,height:this.height}),this.props.onResize({width:this.width,height:this.height}))}},{key:"_checkForCanvasSizeChange",value:function(){var e=this.canvas;if(!e)return!1;var t=e.clientWidth||e.width,n=e.clientHeight||e.height;return(t!==this.width||n!==this.height)&&(this.width=t,this.height=n,!0)}},{key:"_createAnimationLoop",value:function(e){var t=this,n=e.glOptions,r=e.debug;return new _A({width:e.width,height:e.height,useDevicePixels:e.useDevicePixels,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,autoResizeViewport:!1,gl:e.gl,onCreateContext:function(e){return jd(Object.assign({},n,e,{canvas:t.canvas,debug:r}))},onInitialize:this._onRendererInitialized,onRender:this._onRenderFrame,onBeforeRender:e.onBeforeRender,onAfterRender:e.onAfterRender,onError:e.onError})}},{key:"_getViewState",value:function(){return this.props.viewState||this.viewState}},{key:"_getViews",value:function(){var e=this.props.views||[new aS({id:"default-view"})];return(e=Array.isArray(e)?e:[e]).length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}},{key:"_onPointerMove",value:function(e){var t=this._pickRequest;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;var n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}},{key:"_pickAndCallback",value:function(){var e=this._pickRequest;if(e.event){var t=this._pick("pickObject","pickObject Time",e),n=t.result,r=t.emptyInfo;this.interactiveState.isHovering=n.length>0;var i,o=r,s=!1,a=sk(n);try{for(a.s();!(i=a.n()).done;){var u=i.value;o=u,s=u.layer.onHover(u,e.event)}}catch(VR){a.e(VR)}finally{a.f()}if(!s&&this.props.onHover&&this.props.onHover(o,e.event),this.props.getTooltip){var c=this.props.getTooltip(o);this.tooltip.setTooltip(c,o.x,o.y)}e.event=null}}},{key:"_updateCursor",value:function(){var e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}},{key:"_setGLContext",value:function(e){if(!this.layerManager){this.canvas||(this.canvas=e.canvas,Pd(e,{enable:!0,copyState:!0})),this.tooltip=new DS(this.canvas),Ed(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);var t=new LE;for(var n in t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new rk(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}}),kh)this.eventManager.on(n,this._onEvent);this.viewManager=new eS({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange,onInteractionStateChange:this._onInteractionStateChange,views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});var r=this.viewManager.getViewports()[0];this.layerManager=new YE(e,{deck:this,stats:this.stats,viewport:r,timeline:t}),this.effectManager=new hS,this.deckRenderer=new wS(e),this.deckPicker=new IS(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}}},{key:"_drawLayers",value:function(e,t){var n=this.layerManager.context.gl;Ed(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers(Object.assign({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:n})}},{key:"_onRendererInitialized",value:function(e){this._setGLContext(e.gl)}},{key:"_onRenderFrame",value:function(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Eh.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}},{key:"_onViewStateChange",value:function(e){var t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=ok(ok({},this.viewState),{},zh({},e.viewId,t)),this.props.viewState||this.viewManager.setProps({viewState:this.viewState}))}},{key:"_onInteractionStateChange",value:function(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}},{key:"_onEvent",value:function(e){var t=kh[e.type],n=e.offsetCenter;if(t&&n){var r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),o=i.layer,s=o&&(o[t.handler]||o.props[t.handler]),a=this.props[t.handler],u=!1;s&&(u=s.call(o,i,e)),!u&&a&&a(i,e)}}},{key:"_onPointerDown",value:function(e){var t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}},{key:"_getFrameStats",value:function(){var e=this.stats;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();var t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}},{key:"_getMetrics",value:function(){var e=this.metrics,t=this.stats;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();var n=Fd.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}]),e}();lk.getPropTypes=function(e){return{id:e.string,width:e.oneOfType([e.number,e.string]),height:e.oneOfType([e.number,e.string]),layers:e.oneOfType([e.object,e.array]),layerFilter:e.func,views:e.oneOfType([e.object,e.array]),viewState:e.object,effects:e.arrayOf(e.instanceOf(cE)),controller:e.oneOfType([e.func,e.bool,e.object]),gl:e.object,glOptions:e.object,parameters:e.object,pickingRadius:e.number,useDevicePixels:e.oneOfType([e.bool,e.number]),touchAction:e.string,eventRecognizerOptions:e.object,onWebGLInitialized:e.func,onResize:e.func,onViewStateChange:e.func,onInteractionStateChange:e.func,onBeforeRender:e.func,onAfterRender:e.func,onLoad:e.func,onError:e.func,debug:e.bool,drawPickingColors:e.bool,_framebuffer:e.object,_animate:e.bool,_pickable:e.bool,_typedArrayManagerProps:e.object}},lk.defaultProps=ck,lk.VERSION=gA.VERSION;const hk={name:"project32",dependencies:[wE],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},dk="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",fk={lightSources:{}};function pk({color:e=[0,0,0],intensity:t=1}={}){return e.map(e=>e*t/255)}const gk={name:"lights",vs:dk,fs:dk,getUniforms:function e(t=fk){if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},function({ambientLight:e,pointLights:t=[],directionalLights:n=[]}){const r={};return r["lighting_uAmbientLight.color"]=e?pk(e):[0,0,0],t.forEach((e,t)=>{r["lighting_uPointLight[".concat(t,"].color")]=pk(e),r["lighting_uPointLight[".concat(t,"].position")]=e.position,r["lighting_uPointLight[".concat(t,"].attenuation")]=e.attenuation||[1,0,0]}),r.lighting_uPointLightCount=t.length,n.forEach((e,t)=>{r["lighting_uDirectionalLight[".concat(t,"].color")]=pk(e),r["lighting_uDirectionalLight[".concat(t,"].direction")]=e.direction}),r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const n={pointLights:[],directionalLights:[]};for(const e of t.lights||[])switch(e.type){case"ambient":n.ambientLight=e;break;case"directional":n.directionalLights.push(e);break;case"point":n.pointLights.push(e)}return e({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}},mk={},yk={name:"phong-lighting",dependencies:[gk],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(e=mk){if(!("material"in e))return{};const{material:t}=e;return t?function(e){const{ambient:t=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(e=>e/255)}}(t):{lighting_uEnabled:!1}}},vk={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},bk=Object.assign({inject:{"vs:DECKGL_FILTER_COLOR":"\n    picking_setPickingColor(geometry.pickingColor);\n    // for picking depth values\n    picking_setPickingAttribute(geometry.position.z);\n    ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n    // use highlight color if this fragment belongs to the selected object.\n    color = picking_filterHighlightColor(color);\n\n    // use picking color if rendering to picking FBO.\n    color = picking_filterPickingColor(color);\n      "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(e=vk){const t={};if(void 0!==e.pickingSelectedColor)if(e.pickingSelectedColor){const n=e.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=n}else t.picking_uSelectedColorValid=0;if(e.pickingHighlightColor){const n=Array.from(e.pickingHighlightColor,e=>e/255);Number.isFinite(n[3])||(n[3]=1),t.picking_uHighlightColor=n}return void 0!==e.pickingActive&&(t.picking_uActive=Boolean(e.pickingActive),t.picking_uAttribute=Boolean(e.pickingAttribute)),t}}),_k={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class wk{static get DRAW_MODE(){return _k}constructor(e={}){const{id:t=Gd("geometry"),drawMode:n=_k.TRIANGLES,attributes:r={},indices:i=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(r,i),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const n in e){let t=e[n];t=ArrayBuffer.isView(t)?{value:t}:t,Bd(ArrayBuffer.isView(t.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),"POSITION"!==n&&"positions"!==n||t.size||(t.size=3),"indices"===n?(Bd(!this.indices),this.indices=t):this.attributes[n]=t}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const r in e){const t=e[r],{value:i,size:o,constant:s}=t;!s&&i&&o>=1&&(n=Math.min(n,i.length/o))}return Bd(Number.isFinite(n)),n}}function xk(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ek=Math.PI/180,Sk=new Float32Array(16),Ak=new Float32Array(12);function kk(e,t,n){var r=t[0]*Ek,i=t[1]*Ek,o=t[2]*Ek,s=Math.sin(o),a=Math.sin(r),u=Math.sin(i),c=Math.cos(o),l=Math.cos(r),h=Math.cos(i),d=n[0],f=n[1],p=n[2];e[0]=d*h*l,e[1]=d*u*l,e[2]=d*-a,e[3]=f*(-u*c+h*a*s),e[4]=f*(h*c+u*a*s),e[5]=f*l*s,e[6]=p*(u*s+h*a*c),e[7]=p*(-h*s+u*a*c),e[8]=p*l*c}function Tk(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}var Ok={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(e,t){var n=t.startRow,r=t.endRow,i=this.props,o=i.data,s=i.getOrientation,a=i.getScale,u=i.getTranslation,c=i.getTransformMatrix,l=Array.isArray(c),h=l&&16===c.length,d=Array.isArray(a),f=Array.isArray(s),p=Array.isArray(u),g=h||!l&&Boolean(c(o[0]));e.constant=g?h:f&&d&&p;var m=e.value;if(e.constant){var y;g?(Sk.set(c),y=Tk(Sk)):(kk(y=Ak,s,a),y.set(u,9)),e.value=new Float32Array(y)}else{var v,b=n*e.size,_=Ap(o,n,r),w=_.objectInfo,x=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return xk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xk(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(_.iterable);try{for(x.s();!(v=x.n()).done;){var E=v.value;w.index++;var S=void 0;g?(Sk.set(h?c:c(E,w)),S=Tk(Sk)):(kk(S=Ak,f?s:s(E,w),d?a:a(E,w)),S.set(p?u:u(E,w),9)),m[b++]=S[0],m[b++]=S[1],m[b++]=S[2],m[b++]=S[3],m[b++]=S[4],m[b++]=S[5],m[b++]=S[6],m[b++]=S[7],m[b++]=S[8],m[b++]=S[9],m[b++]=S[10],m[b++]=S[11]}}catch(VR){x.e(VR)}finally{x.f()}}}};function Ik(e,t){return t===Sh.CARTESIAN||t===Sh.METER_OFFSETS||t===Sh.DEFAULT&&!e.isGeospatial}function Ck(e,t){(e.COLOR_0||e.colors)&&t||(e.colors={constant:!0,value:new Float32Array([1,1,1])}),Eh.assert(e.positions||e.POSITION,'SimpleMeshLayer requires "postions" or "POSITION" attribute in mesh property.')}function Dk(e,t){if(e.attributes)return Ck(e.attributes,t),e instanceof wk?e:new wk(e);if(e.positions||e.POSITION)return Ck(e,t),new wk({attributes:e});throw Error("Invalid mesh")}var jk=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return Ih(i,[{key:"getShaders",value:function(){var e=!Hh(this.context.gl),t={};return jf(this.context.gl,If)&&(t.DERIVATIVES_AVAILABLE=1),Dh(Ch(i.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[hk,yk,bk],transpileToGLSL100:e,defines:t})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:Ok}),this.setState({emptyTexture:new ff(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,r=e.changeFlags;if(Dh(Ch(i.prototype),"updateState",this).call(this,{props:t,oldProps:n,changeFlags:r}),t.mesh!==n.mesh||r.extensionsChanged){if(this.state.model&&this.state.model.delete(),t.mesh){this.setState({model:this.getModel(t.mesh)});var o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==n.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(){Dh(Ch(i.prototype),"finalizeState",this).call(this),this.state.emptyTexture.delete()}},{key:"draw",value:function(e){if(this.state.model){var t=this.props;this.state.model.draw({uniforms:Object.assign({},e.uniforms,{sizeScale:t.sizeScale,composeModelMatrix:!t._instanced||Ik(this.context.viewport,t.coordinateSystem),flatShading:!this.state.hasNormals})})}}},{key:"getModel",value:function(e){var t=new Lm(this.context.gl,Object.assign({},this.getShaders(),{id:this.props.id,geometry:Dk(e,this.props._useMeshColors),isInstanced:!0})),n=this.props.texture;return t.setUniforms({sampler:n||this.state.emptyTexture,hasTexture:Boolean(n)}),t}},{key:"setTexture",value:function(e){var t=this.state,n=t.model;n&&n.setUniforms({sampler:e||t.emptyTexture,hasTexture:Boolean(e)})}}]),i}(Qw);jk.layerName="SimpleMeshLayer",jk.defaultProps={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};const Pk={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[gk]};class Mk{constructor(e={}){const{id:t}=e;this.id=t||Gd(this.constructor.name),this.display=!0,this.position=new dp,this.rotation=new dp,this.scale=new dp(1,1,1),this.matrix=new Qy,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}setPosition(e){return Bd(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return Bd(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return Bd(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:n,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),n&&this.setScale(n),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}update(e={}){const{position:t,rotation:n,scale:r}=e;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){Bd(e),t=t||this.matrix;const n=new Qy(e).multiplyRight(t),r=n.invert(),i=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class Rk extends Mk{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;Uh.assert(t.every(e=>e instanceof Mk),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new Qy}={}){const n=new Qy(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof Rk?r.traverse(e,{worldMatrix:n}):e(r,{worldMatrix:n})}}function Nk(){var e=new np(4);return np!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Lk(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Fk(e,t,n){var r=t[0],i=t[1],o=t[2],s=t[3],a=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*l+s*a+i*c-o*u,e[1]=i*l+s*u+o*a-r*c,e[2]=o*l+s*c+r*u-i*a,e[3]=s*l-r*a-i*u-o*c,e}var Bk,zk,Uk,Vk,Gk=Py,Hk=(Bk=rp(),zk=ip(1,0,0),Uk=ip(0,1,0),function(e,t,n){var r=op(t,n);return r<-.999999?(sp(Bk,zk,t),function(e){return Math.hypot(e[0],e[1],e[2])}(Bk)<1e-6&&sp(Bk,Uk,t),function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o}(Bk,Bk),Lk(e,Bk,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(sp(Bk,t,n),e[0]=Bk[0],e[1]=Bk[1],e[2]=Bk[2],e[3]=1+r,function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=o*s,e}(e,e))});Nk(),Nk(),Vk=new np(9),np!=Float32Array&&(Vk[1]=0,Vk[2]=0,Vk[3]=0,Vk[5]=0,Vk[6]=0,Vk[7]=0),Vk[0]=1,Vk[4]=1,Vk[8]=1;const qk=[0,0,0,1],Wk={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$k={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Xk(e){if(!e._animation){const t=$k[e.componentType],n=Wk[e.type],r=n*e.count,{buffer:i,byteOffset:o}=e.bufferView.data,s=new t(i,o+(e.byteOffset||0),r);if(1===n)e._animation=Array.from(s);else{const t=[];for(let e=0;e<s.length;e+=n)t.push(Array.from(s.slice(e,e+n)));e._animation=t}}return e._animation}const Kk=new Qy,Zk=new class extends Kf{constructor(e=0,t=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,n,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}fromMatrix3(e){return function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,e[0]=(t[5]-t[7])*(n=.5/n),e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*s+s]+1),e[i]=.5*n,e[3]=(t[3*o+s]-t[3*s+o])*(n=.5/n),e[o]=(t[3*o+i]+t[3*i+o])*n,e[s]=(t[3*s+i]+t[3*i+s])*n}}(this,e),this.check()}identity(){return function(e){e[0]=0,e[1]=0,e[2]=0,e[3]=1}(this),this.check()}fromAxisRotation(e,t){return Lk(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Zf(e)}get y(){return this[1]}set y(e){this[1]=Zf(e)}get z(){return this[2]}set z(e){this[2]=Zf(e)}get w(){return this[3]}set w(e){this[3]=Zf(e)}len(){return function(e){return Math.hypot(e[0],e[1],e[2],e[3])}(this)}lengthSquared(){return function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}(this,e)}rotationTo(e,t){return Hk(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return function(e,t,n){e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3]}(this,this,e),this.check()}calculateW(){return function(e,t){var n=t[0],r=t[1],i=t[2];e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}conjugate(){return function(e,t){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3]}(this,this),this.check()}invert(){return function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;e[0]=-n*a,e[1]=-r*a,e[2]=-i*a,e[3]=o*a}(this,this),this.check()}lerp(e,t,n){return function(e,t,n,r){var i=t[0],o=t[1],s=t[2],a=t[3];e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=s+r*(n[2]-s),e[3]=a+r*(n[3]-a)}(this,e,t,n),this.check()}multiplyRight(e,t){return Xf(!t),Fk(this,this,e),this.check()}multiplyLeft(e,t){return Xf(!t),Fk(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),u=Math.cos(n);e[0]=r*u+s*a,e[1]=i*u+o*a,e[2]=o*u-i*a,e[3]=s*u-r*a}(this,this,e),this.check()}rotateY(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),u=Math.cos(n);e[0]=r*u-o*a,e[1]=i*u+s*a,e[2]=o*u+r*a,e[3]=s*u-i*a}(this,this,e),this.check()}rotateZ(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],s=t[3],a=Math.sin(n),u=Math.cos(n);e[0]=r*u+i*a,e[1]=i*u-r*a,e[2]=o*u+s*a,e[3]=s*u-o*a}(this,this,e),this.check()}scale(e){return Gk(this,this,e),this.check()}slerp(e,t,n){switch(arguments.length){case 1:({start:e=qk,target:t,ratio:n}=arguments[0]);break;case 2:[t,n]=arguments,e=this}return function(e,t,n,r){var i,o,s,a,u,c=t[0],l=t[1],h=t[2],d=t[3],f=n[0],p=n[1],g=n[2],m=n[3];(o=c*f+l*p+h*g+d*m)<0&&(o=-o,f=-f,p=-p,g=-g,m=-m),1-o>tp?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-r)*i)/s,u=Math.sin(r*i)/s):(a=1-r,u=r),e[0]=a*c+u*f,e[1]=a*l+u*p,e[2]=a*h+u*g,e[3]=a*d+u*m}(this,e,t,n),this.check()}transformVector4(e,t=e){return function(e,t,n){var r=t[0],i=t[1],o=t[2],s=n[0],a=n[1],u=n[2],c=n[3],l=c*r+a*o-u*i,h=c*i+u*r-s*o,d=c*o+s*i-a*r,f=-s*r-a*i-u*o;e[0]=l*c+f*-s+h*-u-d*-a,e[1]=h*c+f*-a+d*-s-l*-u,e[2]=d*c+f*-u+l*-a-h*-s,e[3]=t[3]}(t,e,this),Yf(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}};class Yk{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const t=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:e,target:n,path:r})=>{(function(e,{input:t,interpolation:n,output:r},i,o){const s=e%t[t.length-1],a=t.findIndex(e=>e>=s),u=Math.max(0,a-1);if(!Array.isArray(i[o]))switch(o){case"translation":i[o]=[0,0,0];break;case"rotation":i[o]=[0,0,0,1];break;case"scale":i[o]=[1,1,1];break;default:Uh.warn("Bad animation path ".concat(o))()}Bd(i[o].length===r[u].length);const c=t[u],l=t[a];switch(n){case"STEP":!function(e,t,n){for(let r=0;r<n.length;r++)e[t][r]=n[r]}(i,o,r[u]);break;case"LINEAR":l>c&&function(e,t,n,r,i){if("rotation"===t){Zk.slerp({start:n,target:r,ratio:i});for(let n=0;n<Zk.length;n++)e[t][n]=Zk[n]}else for(let o=0;o<n.length;o++)e[t][o]=i*r[o]+(1-i)*n[o]}(i,o,r[u],r[a],(s-c)/(l-c));break;case"CUBICSPLINE":l>c&&function(e,t,{p0:n,outTangent0:r,inTangent1:i,p1:o,tDiff:s,ratio:a}){for(let u=0;u<e[t].length;u++){const c=r[u]*s,l=i[u]*s;e[t][u]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*n[u]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*o[u]+(Math.pow(a,3)-Math.pow(a,2))*l}}(i,o,{p0:r[3*u+1],outTangent0:r[3*u+2],inTangent1:r[3*a+0],p1:r[3*a+1],tDiff:l-c,ratio:(s-c)/(l-c)});break;default:Uh.warn("Interpolation ".concat(n," not supported"))()}})(t,e,n,r),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){const n=Kk.fromQuaternion(e.rotation);t.matrix.multiplyRight(n)}e.scale&&t.matrix.scale(e.scale)}(n,n._node)})}}class Qk{constructor(e){this.animations=e.animations.map((t,n)=>{const r=t.name||"Animation-".concat(n),i=t.samplers.map(({input:t,interpolation:n="LINEAR",output:r})=>({input:Xk(e.accessors[t]),interpolation:n,output:Xk(e.accessors[r])})),o=t.channels.map(({sampler:t,target:n})=>({sampler:i[t],target:e.nodes[n.node],path:n.path}));return new Yk({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class Jk extends Mk{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof Lm?(this.model=e,this._setModelNodeProps(t)):this.model=new Lm(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class eT{constructor(e,{attributes:t,material:n,pbrDebug:r,imageBasedLightingEnvironment:i,lights:o,useTangents:s}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},jf(e,Cf)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],i&&(this.uniforms.u_DiffuseEnvSampler=i.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=i.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=i.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&s,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(i,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),n&&this.parseMaterial(n)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,n=null){const r=e.texture.source.image;let i,o={};r.compressed?(i=r,o={[this.gl.TEXTURE_MIN_FILTER]:r.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):i={data:r};const s=new ff(this.gl,{id:e.name||e.id,parameters:{...e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},...o},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...i});this.uniforms[t]=s,this.defineIfPresent(n,n),this.generatedTextures.push(s)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:n=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,n]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(Uh.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function tT(e,t){return Hh(e)?"#version 300 es\n".concat(t):t}const nT={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},rT={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class iT{constructor(e,t={}){this.gl=e,this.options=Object.assign({},rT,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(e=>this.createScene(e))}createAnimator(){return Array.isArray(this.gltf.animations)?new Qk(this.gltf):null}createScene(e){const t=(e.nodes||[]).map(e=>this.createNode(e));return new Rk({id:e.name||e.id,children:t})}createNode(e){if(!e._node){const t=(e.children||[]).map(e=>this.createNode(e));e.mesh&&t.push(this.createMesh(e.mesh));const n=new Rk({id:e.name||e.id,children:t});if(e.matrix)n.setMatrix(e.matrix);else{if(n.matrix.identity(),e.translation&&n.matrix.translate(e.translation),e.rotation){const t=(new Qy).fromQuaternion(e.rotation);n.matrix.multiplyRight(t)}e.scale&&n.matrix.scale(e.scale)}e._node=n}return e._node}createMesh(e){if(!e._mesh){const t=(e.primitives||[]).map((t,n)=>this.createPrimitive(t,n,e)),n=new Rk({id:e.name||e.id,children:t});e._mesh=n}return e._mesh}getVertexCount(e){Uh.warn("getVertexCount() not found")()}createPrimitive(e,t,n){return function(e,t){const{id:n,drawMode:r,vertexCount:i,attributes:o,modelOptions:s}=t,a=new eT(e,t);Uh.info(4,"createGLTFModel defines: ",a.defines)();const u=[];u.push(...a.generatedTextures),u.push(...Object.values(o).map(e=>e.buffer));const c=new Jk(e,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[Pk],defines:a.defines,parameters:a.parameters,vs:tT(e,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:tT(e,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:u},s));return c.setProps({attributes:o}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||"".concat(n.name||n.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const n={};return Object.keys(e).forEach(t=>{n[t]=this.createAccessor(e[t],this.createBuffer(e[t],this.gl.ARRAY_BUFFER))}),t&&(n.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),Uh.info(4,"glTF Attributes",{attributes:e,indices:t,generated:n})(),n}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:n}=e;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[t]||(n.lumaBuffers[t]=new sf(this.gl,{id:"from-".concat(n.id),data:n.data||e.value,target:t})),n.lumaBuffers[t]}createAccessor(e,t){return new tf({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:nT[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function oT(e,t,n){if(e.byteLength<=t+n)return"";for(var r=new DataView(e),i="",o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(t+o));return i}function sT(e){return e+3&-4}function aT(e,t,n){return function(e,t,n){var r=void 0!==n?new Uint8Array(e).subarray(t,t+n):new Uint8Array(e).subarray(t);return new Uint8Array(r).buffer}(e,t,n)}function uT(e,t){if(!e)throw new Error(t||"assert failed: gltf")}function cT(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;var n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(e));return n.substr(0,n.lastIndexOf("/")+1)+e}function lT(e,t,n){var r=e.bufferViews[n];uT(r);var i=t[r.buffer];return uT(i),new Uint8Array(i.arrayBuffer,(r.byteOffset||0)+i.byteOffset,r.byteLength)}var hT,dT=n(207),fT={};function pT(e){return gT.apply(this,arguments)}function gT(){return(gT=ob(rb().mark(function e(t){var n,r,i=arguments;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:{},(n=i.length>1&&void 0!==i[1]?i[1]:null)&&(t=mT(t,n,r)),fT[t]=fT[t]||yT(t),e.next=6,fT[t];case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mT(e,t,n){var r=n.modules||{};return r[e]?r[e]:Pb?n.CDN?(kb(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(t,"@").concat("2.3.13","/dist/libs/").concat(e)):Mb?"../src/libs/".concat(e):"modules/".concat(t,"/src/libs/").concat(e):"modules/".concat(t,"/dist/libs/").concat(e)}function yT(e){return vT.apply(this,arguments)}function vT(){return(vT=ob(rb().mark(function e(t){var n,r;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.endsWith("wasm")){e.next=7;break}return e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.arrayBuffer();case 6:return e.abrupt("return",e.sent);case 7:if(Pb){e.next=9;break}return e.abrupt("return",dT.requireFromFile&&dT.requireFromFile(t));case 9:if(!Mb){e.next=11;break}return e.abrupt("return",importScripts(t));case 11:return e.next=13,fetch(t);case 13:return r=e.sent,e.next=16,r.text();case 16:return e.abrupt("return",bT(e.sent,t));case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function bT(e,t){if(!Pb)return dT.requireFromString&&dT.requireFromString(e,t);if(Mb)return eval.call(jb,e),null;var n=document.createElement("script");n.id=t;try{n.appendChild(document.createTextNode(e))}catch(r){n.text=e}return document.body.appendChild(n),null}function _T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_T(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function xT(e){return ET.apply(this,arguments)}function ET(){return(ET=ob(rb().mark(function e(t){var n;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return hT=(n=t.modules||{}).draco3d?hT||new Promise(function(e){var t=n.draco3d.createDecoderModule({onModuleLoaded:function(){e({draco:t})}})}):hT||ST(t),e.next=4,hT;case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ST(e){return AT.apply(this,arguments)}function AT(){return(AT=ob(rb().mark(function e(t){var n,r,i;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.draco&&t.draco.decoderType,e.next="js"===e.t0?3:7;break;case 3:return e.next=5,pT("draco_decoder.js","draco",t);case 5:return n=e.sent,e.abrupt("break",21);case 7:return e.t1=Promise,e.next=10,pT("draco_wasm_wrapper.js","draco",t);case 10:return e.t2=e.sent,e.next=13,pT("draco_decoder.wasm","draco",t);case 13:return e.t3=e.sent,e.t4=[e.t2,e.t3],e.next=17,e.t1.all.call(e.t1,e.t4);case 17:i=Bh(e.sent,2),n=i[0],r=i[1];case 21:return n=n||jb.DracoDecoderModule,e.next=24,kT(n,r);case 24:return e.abrupt("return",e.sent);case 25:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kT(e,t){var n={};return t&&(n.wasmBinary=t),new Promise(function(t){e(wT(wT({},n),{},{onModuleLoaded:function(e){return t({draco:e})}}))})}function TT(e){if(!e||!e.POSITION)return null;var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0,a=e.POSITION.value,u=a&&a.length;if(!u)return null;for(var c=0;c<u;c+=3){var l=a[c],h=a[c+1],d=a[c+2];t=l<t?l:t,n=h<n?h:n,r=d<r?d:r,i=l>i?l:i,o=h>o?h:o,s=d>s?d:s}return[[t,n,r],[i,o,s]]}var OT={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},IT={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},CT=function(){function e(t){Th(this,e),this.draco=t,this.drawMode="TRIANGLE",this.metadataQuerier={}}return Ih(e,[{key:"destroy",value:function(){}},{key:"destroyGeometry",value:function(e){e&&this.draco.destroy(e.dracoGeometry)}},{key:"parseSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.metadataQuerier=new this.draco.MetadataQuerier;var n=new this.draco.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength);var r,i,o,s=new this.draco.Decoder,a={};try{var u=s.GetEncodedGeometryType(n);switch(u){case this.draco.TRIANGULAR_MESH:i=new this.draco.Mesh,r=s.DecodeBufferToMesh(n,i),o={type:0,faceCount:i.num_faces(),attributeCount:i.num_attributes(),vertexCount:i.num_points()};break;case this.draco.POINT_CLOUD:i=new this.draco.PointCloud,r=s.DecodeBufferToPointCloud(n,i),o={type:1,attributeCount:i.num_attributes(),vertexCount:i.num_points()};break;default:throw new Error("Unknown DRACO geometry type.")}if(!r.ok()||!i.ptr){var c="DRACO decompression failed: ".concat(r.error_msg());throw i&&this.draco.destroy(i),new Error(c)}a.loaderData={header:o},this._extractDRACOGeometry(s,i,u,a,t);var l=this._getGeometryMetadata(s,i);a.header={vertexCount:o.vertexCount,boundingBox:TT(a.attributes),metadata:l}}finally{this.draco.destroy(s),this.draco.destroy(n),this.draco.destroy(i),this.draco.destroy(this.metadataQuerier)}return a}},{key:"_extractDRACOGeometry",value:function(e,t,n,r,i){var o=this._getAttributes(e,t,i);if(!o.POSITION)throw new Error("DRACO decompressor: No position attribute found.");return n===this.draco.TRIANGULAR_MESH?(o.indices="TRIANGLE_STRIP"===this.drawMode?this._getMeshStripIndices(e,t):this._getMeshFaceIndices(e,t),r.mode="TRIANGLE_STRIP"===this.drawMode?5:4):r.mode=0,o.indices&&(r.indices={value:o.indices,size:1},delete o.indices),r.attributes=o,r}},{key:"getPositionAttributeMetadata",value:function(e){this.metadata=this.metadata||{},this.metadata.attributes=this.metadata.attributes||{};var t=new this.draco.AttributeQuantizationTransform;if(t.InitFromAttribute(e)){this.metadata.attributes.position.isQuantized=!0,this.metadata.attributes.position.maxRange=t.range(),this.metadata.attributes.position.numQuantizationBits=t.quantization_bits(),this.metadata.attributes.position.minValues=new Float32Array(3);for(var n=0;n<3;++n)this.metadata.attributes.position.minValues[n]=t.min_value(n)}this.draco.destroy(t)}},{key:"_getAttributes",value:function(e,t,n){for(var r={},i=t.num_points(),o=0;o<t.num_attributes();o++){var s=e.GetAttribute(t,o),a=this._getAttributeMetadata(e,t,o),u={uniqueId:s.unique_id(),attributeType:s.attribute_type(),dataType:IT[s.data_type()],size:s.size(),numComponents:s.num_components(),byteOffset:s.byte_offset(),byteStride:s.byte_stride(),normalized:s.normalized(),metadata:a},c=this._deduceAttributeName(u,n),l=this._getAttributeTypedArray(e,t,s,c).typedArray;r[c]={value:l,size:l.length/i,metadata:a}}return r}},{key:"_getMeshFaceIndices",value:function(e,t){for(var n=t.num_faces(),r=new Uint32Array(3*n),i=new this.draco.DracoInt32Array,o=0;o<n;++o){e.GetFaceFromMesh(t,o,i);var s=3*o;r[s]=i.GetValue(0),r[s+1]=i.GetValue(1),r[s+2]=i.GetValue(2)}return this.draco.destroy(i),r}},{key:"_getMeshStripIndices",value:function(e,t){var n=new this.draco.DracoInt32Array;e.GetTriangleStripsFromMesh(t,n);for(var r=new Uint32Array(n.size()),i=0;i<n.size();++i)r[i]=n.GetValue(i);return this.draco.destroy(n),r}},{key:"_getAttributeTypedArray",value:function(e,t,n,r){if(0===n.ptr){var i="DRACO decode bad attribute ".concat(r);throw new Error(i)}var o,s,a=IT[n.data_type()],u=n.num_components(),c=t.num_points()*u;switch(a){case Float32Array:o=new this.draco.DracoFloat32Array,e.GetAttributeFloatForAllPoints(t,n,o),s=new Float32Array(c);break;case Int8Array:o=new this.draco.DracoInt8Array,e.GetAttributeInt8ForAllPoints(t,n,o),s=new Int8Array(c);break;case Int16Array:o=new this.draco.DracoInt16Array,e.GetAttributeInt16ForAllPoints(t,n,o),s=new Int16Array(c);break;case Int32Array:o=new this.draco.DracoInt32Array,e.GetAttributeInt32ForAllPoints(t,n,o),s=new Int32Array(c);break;case Uint8Array:o=new this.draco.DracoUInt8Array,e.GetAttributeUInt8ForAllPoints(t,n,o),s=new Uint8Array(c);break;case Uint16Array:o=new this.draco.DracoUInt16Array,e.GetAttributeUInt16ForAllPoints(t,n,o),s=new Uint16Array(c);break;case Uint32Array:o=new this.draco.DracoUInt32Array,e.GetAttributeUInt32ForAllPoints(t,n,o),s=new Uint32Array(c);break;default:throw new Error("DRACO decoder: unexpected attribute type.")}for(var l=0;l<c;l++)s[l]=o.GetValue(l);return this.draco.destroy(o),{typedArray:s,components:u}}},{key:"_deduceAttributeName",value:function(e,t){var n=t.extraAttributes,r=void 0===n?{}:n;if(r&&"object"===Mh(r))for(var i=0,o=Object.entries(r);i<o.length;i++){var s=Bh(o[i],2);if(s[1]===e.uniqueId)return s[0]}for(var a in OT)if(e.attributeType===this.draco[a])return OT[a];if(e.metadata){var u=t.attributeNameEntry||"name";if(e.metadata[u])return e.metadata[u].string}return"CUSTOM_ATTRIBUTE_".concat(e.uniqueId)}},{key:"_getGeometryMetadata",value:function(e,t){var n=e.GetMetadata(t);return this._queryDracoMetadata(n)}},{key:"_getAttributeMetadata",value:function(e,t,n){var r=e.GetAttributeMetadata(t,n);return this._queryDracoMetadata(r)}},{key:"_queryDracoMetadata",value:function(e){if(!e||!e.ptr)return{};for(var t={},n=this.metadataQuerier.NumEntries(e),r=0;r<n;r++){var i=this.metadataQuerier.GetEntryName(e,r);t[i]={int:this.metadataQuerier.GetIntEntry(e,i),string:this.metadataQuerier.GetStringEntry(e,i),double:this.metadataQuerier.GetDoubleEntry(e,i),intArray:this.metadataQuerier.GetIntEntryArray(e,i)}}return t}},{key:"decode",value:function(e,t){return this.parseSync(e,t)}}]),e}();function DT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function jT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?DT(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var PT="2.3.13",MT={id:"draco",name:"Draco",version:PT,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"===("undefined"==typeof WebAssembly?"undefined":Mh(WebAssembly))?"wasm":"js",libraryPath:"libs/",workerUrl:"https://unpkg.com/@loaders.gl/draco@".concat(PT,"/dist/draco-loader.worker.js"),localWorkerUrl:"modules/draco/dist/draco-loader.worker.dev.js",extraAttributes:{}}}},RT=jT(jT({},MT),{},{parse:function(e,t,n,r){return NT.apply(this,arguments)}});function NT(){return(NT=ob(rb().mark(function e(t,n,r,i){var o;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xT(n);case 2:return o=new CT(e.sent.draco),e.prev=5,e.abrupt("return",o.parseSync(t,jT({extraAttributes:n.draco&&n.draco.extraAttributes||null},n.parseOptions||{})));case 7:return e.prev=7,o.destroy(),e.finish(7);case 10:case"end":return e.stop()}},e,null,[[5,,7,10]])}))).apply(this,arguments)}var LT=["SCALAR","VEC2","VEC3","VEC4"],FT=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),BT={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},zT={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},UT={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function VT(e){return LT[e-1]||LT[0]}function GT(e){var t=FT.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function HT(e,t){var n=UT[e.componentType],r=BT[e.type],i=e.count*r,o=e.count*r*zT[e.componentType];return uT(o>=0&&o<=t.byteLength),{ArrayType:n,length:i,byteLength:o}}var qT=function(){function e(t){if(Th(this,e),t instanceof e)return t;t||(t={json:{asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},buffers:[]}),this.byteLength=0,this.gltf=t,uT(this.gltf.json)}return Ih(e,[{key:"getApplicationData",value:function(e){return this.json[e]}},{key:"getExtraData",value:function(e){return(this.json.extras||{})[e]}},{key:"getExtension",value:function(e){return this.getUsedExtensions().find(function(t){return t===e})?(this.json.extensions||{})[e]||!0:null}},{key:"getRequiredExtension",value:function(e){return this.getRequiredExtensions().find(function(t){return t===e})?this.getExtension(e):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getObjectExtension",value:function(e,t){return(e.extensions||{})[t]}},{key:"getScene",value:function(e){return this.getObject("scenes",e)}},{key:"getNode",value:function(e){return this.getObject("nodes",e)}},{key:"getSkin",value:function(e){return this.getObject("skins",e)}},{key:"getMesh",value:function(e){return this.getObject("meshes",e)}},{key:"getMaterial",value:function(e){return this.getObject("materials",e)}},{key:"getAccessor",value:function(e){return this.getObject("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this.getObject("textures",e)}},{key:"getSampler",value:function(e){return this.getObject("samplers",e)}},{key:"getImage",value:function(e){return this.getObject("images",e)}},{key:"getBufferView",value:function(e){return this.getObject("bufferViews",e)}},{key:"getBuffer",value:function(e){return this.getObject("buffers",e)}},{key:"getObject",value:function(e,t){if("object"===Mh(t))return t;var n=this.json[e]&&this.json[e][t];if(!n)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(t,"]"));return n}},{key:"getTypedArrayForBufferView",value:function(e){e=this.getBufferView(e);var t=this.gltf.buffers[e.buffer];return uT(t),new Uint8Array(t.arrayBuffer,(e.byteOffset||0)+t.byteOffset,e.byteLength)}},{key:"getTypedArrayForAccessor",value:function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=HT(e,t);return new(0,r.ArrayType)(n,t.byteOffset+e.byteOffset,r.length)}},{key:"getTypedArrayForImageData",value:function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer);return new Uint8Array(n.data,t.byteOffset||0,t.byteLength)}},{key:"addApplicationData",value:function(e,t){return this.json[e]=t,this}},{key:"addExtraData",value:function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}},{key:"addObjectExtension",value:function(e,t,n){return uT(n),e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this}},{key:"setObjectExtension",value:function(e,t,n){(e.extensions||{})[t]=n}},{key:"removeObjectExtension",value:function(e,t){var n=e.extensions||{},r=n[t];return delete n[t],r}},{key:"addExtension",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return uT(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}},{key:"addRequiredExtension",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return uT(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}},{key:"registerUsedExtension",value:function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(function(t){return t===e})||this.json.extensionsUsed.push(e)}},{key:"registerRequiredExtension",value:function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(function(t){return t===e})||this.json.extensionsRequired.push(e)}},{key:"removeExtension",value:function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}},{key:"addMesh",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=this._addAttributes(e),i={primitives:[{attributes:r,indices:t,mode:n}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}},{key:"addPointCloud",value:function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}},{key:"addImage",value:function(e,t){t=t||function(e){var t=sA(e);return t?t.mimeType:null}(e);var n={bufferView:this.addBufferView(e),mimeType:t};return this.json.images=this.json.images||[],this.json.images.push(n),this.json.images.length-1}},{key:"addBufferView",value:function(e){var t=e.byteLength;uT(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var n={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=sT(t),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(e,t){var n={bufferView:e,type:VT(t.size),componentType:t.componentType,count:t.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},n=this.addBufferView(e),r={size:t.size,componentType:GT(e),count:Math.round(e.length/t.size)};return this.addAccessor(n,Object.assign(r,t))}},{key:"createBinaryChunk",value:function(){if(!this.arrayBuffer){for(var e=this.byteLength,t=new ArrayBuffer(e),n=new Uint8Array(t),r=0,i=0;i<this.sourceBuffers.length;i++)s=n,a=r,void 0,u=(o=this.sourceBuffers[i])instanceof ArrayBuffer?new Uint8Array(o):new Uint8Array(o.buffer,o.byteOffset,o.byteLength),s.set(u,a),r=a+sT(u.byteLength);this.json.buffers[0].byteLength=e,this.arrayBuffer=t,this.sourceBuffers=[]}var o,s,a,u}},{key:"_removeStringFromArray",value:function(e,t){for(var n=!0;n;){var r=e.indexOf(t);r>-1?e.splice(r,1):n=!1}}},{key:"json",get:function(){return this.gltf.json}}]),e}(),WT="KHR_binary_glTF",$T="KHR_draco_mesh_compression",XT="KHR_lights_punctual",KT="KHR_materials_unlit",ZT="KHR_techniques_webgl";function YT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function QT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?YT(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function JT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={};for(var r in e){var i=e[r];if("indices"!==r){var o=eO(i,t[r]||{});n[r]=o}}return n}function eO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=tO(e),r=n.buffer,i=n.size,o=n.count,s=QT(QT({},t),{},{value:r,size:i,bufferView:null,byteOffset:0,count:o,type:VT(i),componentType:GT(r)});return s}function tO(e){var t=e,n=1,r=0;return e&&e.value&&(t=e.value,n=e.size||1),t&&(ArrayBuffer.isView(t)||(t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e?Array.isArray(e)?new t(e):!n||e instanceof t?e:new t(e):null}(t,Float32Array)),r=t.length/n),{buffer:t,size:n,count:r}}function nO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nO(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var iO=rb().mark(pO);function oO(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return sO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sO(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function sO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aO(e,t,n){return uO.apply(this,arguments)}function uO(){return(uO=ob(rb().mark(function e(t,n,r){var i,o,s,a,u;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.gltf.decompressMeshes){e.next=2;break}return e.abrupt("return");case 2:i=new qT(t),o=[],s=oO(pO(i));try{for(s.s();!(a=s.n()).done;)i.getObjectExtension(u=a.value,$T)&&o.push(lO(u,i,n,r))}catch(VR){s.e(VR)}finally{s.f()}return e.next=8,Promise.all(o);case 8:i.removeExtension($T);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function cO(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new qT(e),i=oO(r.json.meshes||[]);try{for(i.s();!(t=i.n()).done;){var o=t.value;dO(o,n),r.addRequiredExtension($T)}}catch(VR){i.e(VR)}finally{i.f()}}function lO(e,t,n,r){return hO.apply(this,arguments)}function hO(){return(hO=ob(rb().mark(function e(t,n,r,i){var o,s,a,u,c,l,h,d,f,p;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.getObjectExtension(t,$T),s=n.getTypedArrayForBufferView(o.bufferView),a=aT(s.buffer,s.byteOffset),u=i.parse,delete(c=rO({},r))["3d-tiles"],e.next=8,u(a,RT,c,i);case 8:for(l=e.sent,h={},d=0,f=[].concat(J_(Object.entries(t.attributes)),[["indices",t.indices]]);d<f.length;d++)p=Bh(f[d],2),h[p[0]]=n.getAccessor(p[1]);t.attributes=JT(l.attributes,h),l.indices&&(t.indices=eO(l.indices,h.indices||{})),fO(t);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function dO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!r.DracoWriter||!r.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");var o=r.DracoWriter.encodeSync({attributes:e}),s=i.parseSync,a=s({attributes:e}),u=r._addFauxAttributes(a.attributes),c=r.addBufferView(o),l={primitives:[{attributes:u,mode:n,extensions:zh({},$T,{bufferView:c,attributes:u})}]};return l}function fO(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}function pO(e){var t,n,r,i,o;return rb().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:t=oO(e.json.meshes||[]),s.prev=1,t.s();case 3:if((n=t.n()).done){s.next=24;break}r=oO(n.value.primitives),s.prev=6,r.s();case 8:if((i=r.n()).done){s.next=14;break}return o=i.value,s.next=12,o;case 12:s.next=8;break;case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(6),r.e(s.t0);case 19:return s.prev=19,r.f(),s.finish(19);case 22:s.next=3;break;case 24:s.next=29;break;case 26:s.prev=26,s.t1=s.catch(1),t.e(s.t1);case 29:return s.prev=29,t.f(),s.finish(29);case 32:case"end":return s.stop()}},iO,null,[[1,26,29,32],[6,16,19,22]])}function gO(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return mO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mO(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function mO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yO(e,t){var n=new qT(e),r=n.json,i=n.getExtension(XT);i&&(n.json.lights=i.lights,n.removeExtension(XT));var o,s=gO(r.nodes||[]);try{for(s.s();!(o=s.n()).done;){var a=o.value,u=n.getObjectExtension(a,XT);u&&(a.light=u.light),n.removeObjectExtension(a,XT)}}catch(VR){s.e(VR)}finally{s.f()}}function vO(e,t){var n=new qT(e),r=n.json;if(r.lights){var i=n.addExtension(XT);uT(!i.lights),i.lights=r.lights,delete r.lights}if(n.json.lights){var o,s=gO(n.json.lights);try{for(s.s();!(o=s.n()).done;){var a=o.value;n.addObjectExtension(a.node,XT,a)}}catch(VR){s.e(VR)}finally{s.f()}delete n.json.lights}}function bO(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_O(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function _O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wO(e,t){var n=new qT(e),r=n.json;n.removeExtension(KT);var i,o=bO(r.materials||[]);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.extensions&&s.extensions.KHR_materials_unlit&&(s.unlit=!0),n.removeObjectExtension(s,KT)}}catch(VR){o.e(VR)}finally{o.f()}}function xO(e,t){var n=new qT(e);if(n.materials){var r,i=bO(n.json.materials);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.unlit&&(delete o.unlit,n.addObjectExtension(o,KT,{}),n.addExtension(KT))}}catch(VR){i.e(VR)}finally{i.f()}}}function EO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function SO(e,t){var n=new qT(e),r=n.json,i=n.getExtension(ZT);if(i){var o,s=function(e,t){var n=e.programs,r=void 0===n?[]:n,i=e.shaders,o=void 0===i?[]:i,s=e.techniques,a=void 0===s?[]:s,u=new TextDecoder;return o.forEach(function(e){if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=u.decode(t.getTypedArrayForBufferView(e.bufferView))}),r.forEach(function(e){e.fragmentShader=o[e.fragmentShader],e.vertexShader=o[e.vertexShader]}),a.forEach(function(e){e.program=r[e.program]}),a}(i,n),a=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return EO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?EO(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(r.materials||[]);try{for(a.s();!(o=a.n()).done;){var u=o.value,c=n.getObjectExtension(u,ZT);c&&(u.technique=Object.assign({},c,s[c.technique]),u.technique.values=kO(u.technique,n)),n.removeObjectExtension(u,ZT)}}catch(VR){a.e(VR)}finally{a.f()}n.removeExtension(ZT)}}function AO(e,t){}function kO(e,t){var n=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach(function(t){e.uniforms[t].value&&!(t in n)&&(n[t]=e.uniforms[t].value)}),Object.keys(n).forEach(function(e){"object"===Mh(n[e])&&void 0!==n[e].index&&(n[e].texture=t.getTexture(n[e].index))}),n}var TO={KHR_draco_mesh_compression:r,KHR_lights_punctual:i,KHR_materials_unlit:o,KHR_techniques_webgl:s};function OO(e){return IO.apply(this,arguments)}function IO(){return(IO=ob(rb().mark(function e(t){var n,r,i,o,s,a=arguments;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=a.length>2?a[2]:void 0,(n=a.length>1&&void 0!==a[1]?a[1]:{}).gltf=n.gltf||{},e.t0=rb().keys(TO);case 4:if((e.t1=e.t0()).done){e.next=14;break}if((i=e.t1.value)in(o=n.gltf.excludeExtensions||{})&&!o[i]){e.next=12;break}return s=TO[i],e.next=12,s.decode(t,n,r);case 12:e.next=4;break;case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var CO=1735152710,DO=!0;function jO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(e.getUint8(t+0))).concat(String.fromCharCode(e.getUint8(t+1))).concat(String.fromCharCode(e.getUint8(t+2))).concat(String.fromCharCode(e.getUint8(t+3)))}function PO(e,t,n,r){kb(e.header.byteLength>20);var i=t.getUint32(n+0,DO),o=t.getUint32(n+4,DO);return n+=8,kb(0===o),RO(e,t,n,i),(n+=i)+NO(e,t,n,e.header.byteLength)}function MO(e,t,n,r){return kb(e.header.byteLength>20),function(e,t,n,r){for(;n+8<=e.header.byteLength;){var i=t.getUint32(n+0,DO),o=t.getUint32(n+4,DO);switch(n+=8,o){case 1313821514:RO(e,t,n,i);break;case 5130562:NO(e,t,n,i);break;case 0:r.glb.strict||RO(e,t,n,i);break;case 1:r.glb.strict||NO(e,t,n,i)}n+=sT(i)}}(e,t,n,r),n+e.header.byteLength}function RO(e,t,n,r,i){var o=new Uint8Array(t.buffer,n,r),s=new TextDecoder("utf8").decode(o);return e.json=JSON.parse(s),sT(r)}function NO(e,t,n,r,i){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:t.buffer}),sT(r)}function LO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function FO(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return BO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BO(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function BO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zO,UO={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},VO={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},GO=function(){function e(t){Th(this,e),this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}return Ih(e,[{key:"normalize",value:function(e,t){this.json=e.json;var n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(n.asset.version))}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(e,t){var n,r=new qT(e),i=r.json,o=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return LO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LO(e,t):void 0}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(i.images||[]);try{for(o.s();!(n=o.n()).done;){var s=n.value,a=r.removeObjectExtension(s,WT);a&&Object.assign(s,a)}}catch(VR){o.e(VR)}finally{o.f()}i.buffers&&i.buffers[0]&&delete i.buffers[0].uri,r.removeExtension(WT)}(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n)}},{key:"_addAsset",value:function(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}},{key:"_convertTopLevelObjectsToArrays",value:function(e){for(var t in UO)this._convertTopLevelObjectToArray(e,t)}},{key:"_convertTopLevelObjectToArray",value:function(e,t){var n=e[t];if(n&&!Array.isArray(n))for(var r in e[t]=[],n){var i=n[r];i.id=i.id||r;var o=e[t].length;e[t].push(i),this.idToIndexMap[t][r]=o}}},{key:"_convertObjectIdsToArrayIndices",value:function(e){for(var t in UO)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));var n,r=FO(e.textures);try{for(r.s();!(n=r.n()).done;)this._convertTextureIds(n.value)}catch(VR){r.e(VR)}finally{r.f()}var i,o=FO(e.meshes);try{for(o.s();!(i=o.n()).done;)this._convertMeshIds(i.value)}catch(VR){o.e(VR)}finally{o.f()}var s,a=FO(e.nodes);try{for(a.s();!(s=a.n()).done;)this._convertNodeIds(s.value)}catch(VR){a.e(VR)}finally{a.f()}var u,c=FO(e.scenes);try{for(c.s();!(u=c.n()).done;)this._convertSceneIds(u.value)}catch(VR){c.e(VR)}finally{c.f()}}},{key:"_convertTextureIds",value:function(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}},{key:"_convertMeshIds",value:function(e){var t,n=FO(e.primitives);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.attributes,o=r.indices,s=r.material;for(var a in i)i[a]=this._convertIdToIndex(i[a],"accessor");o&&(r.indices=this._convertIdToIndex(o,"accessor")),s&&(r.material=this._convertIdToIndex(s,"material"))}}catch(VR){n.e(VR)}finally{n.f()}}},{key:"_convertNodeIds",value:function(e){var t=this;e.children&&(e.children=e.children.map(function(e){return t._convertIdToIndex(e,"node")}))}},{key:"_convertSceneIds",value:function(e){var t=this;e.nodes&&(e.nodes=e.nodes.map(function(e){return t._convertIdToIndex(e,"node")}))}},{key:"_convertIdsToIndices",value:function(e,t){var n,r=FO(e[t]);try{for(r.s();!(n=r.n()).done;){var i=n.value;for(var o in i){var s=this._convertIdToIndex(i[o],o);i[o]=s}}}catch(VR){r.e(VR)}finally{r.f()}}},{key:"_convertIdToIndex",value:function(e,t){var n=VO[t];if(n in this.idToIndexMap){var r=this.idToIndexMap[n][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(t," with id ").concat(e));return r}return e}},{key:"_updateObjects",value:function(e){var t,n=FO(this.json.buffers);try{for(n.s();!(t=n.n()).done;)delete t.value.type}catch(VR){n.e(VR)}finally{n.f()}}}]),e}();function HO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new GO).normalize(e,t)}function qO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function WO(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qO(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var $O={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},XO={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},KO={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},ZO={magFilter:KO.TEXTURE_MAG_FILTER,minFilter:KO.TEXTURE_MIN_FILTER,wrapS:KO.TEXTURE_WRAP_S,wrapT:KO.TEXTURE_WRAP_T},YO=(zh(zO={},KO.TEXTURE_MAG_FILTER,KO.LINEAR),zh(zO,KO.TEXTURE_MIN_FILTER,KO.NEAREST_MIPMAP_LINEAR),zh(zO,KO.TEXTURE_WRAP_S,KO.REPEAT),zh(zO,KO.TEXTURE_WRAP_,KO.REPEAT),zO),QO=function(){function e(){Th(this,e)}return Ih(e,[{key:"postProcess",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.json,r=e.buffers,i=void 0===r?[]:r,o=e.images,s=void 0===o?[]:o,a=e.baseUri,u=void 0===a?"":a;return uT(n),this.baseUri=u,this.json=n,this.buffers=i,this.images=s,this._resolveTree(this.json,t),this.json}},{key:"_resolveTree",value:function(e){var t=this;e.bufferViews&&(e.bufferViews=e.bufferViews.map(function(e,n){return t._resolveBufferView(e,n)})),e.images&&(e.images=e.images.map(function(e,n){return t._resolveImage(e,n)})),e.samplers&&(e.samplers=e.samplers.map(function(e,n){return t._resolveSampler(e,n)})),e.textures&&(e.textures=e.textures.map(function(e,n){return t._resolveTexture(e,n)})),e.accessors&&(e.accessors=e.accessors.map(function(e,n){return t._resolveAccessor(e,n)})),e.materials&&(e.materials=e.materials.map(function(e,n){return t._resolveMaterial(e,n)})),e.meshes&&(e.meshes=e.meshes.map(function(e,n){return t._resolveMesh(e,n)})),e.nodes&&(e.nodes=e.nodes.map(function(e,n){return t._resolveNode(e,n)})),e.skins&&(e.skins=e.skins.map(function(e,n){return t._resolveSkin(e,n)})),e.scenes&&(e.scenes=e.scenes.map(function(e,n){return t._resolveScene(e,n)})),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}},{key:"getScene",value:function(e){return this._get("scenes",e)}},{key:"getNode",value:function(e){return this._get("nodes",e)}},{key:"getSkin",value:function(e){return this._get("skins",e)}},{key:"getMesh",value:function(e){return this._get("meshes",e)}},{key:"getMaterial",value:function(e){return this._get("materials",e)}},{key:"getAccessor",value:function(e){return this._get("accessors",e)}},{key:"getCamera",value:function(e){return null}},{key:"getTexture",value:function(e){return this._get("textures",e)}},{key:"getSampler",value:function(e){return this._get("samplers",e)}},{key:"getImage",value:function(e){return this._get("images",e)}},{key:"getBufferView",value:function(e){return this._get("bufferViews",e)}},{key:"getBuffer",value:function(e){return this._get("buffers",e)}},{key:"_get",value:function(e,t){if("object"===Mh(t))return t;var n=this.json[e]&&this.json[e][t];return n||console.warn("glTF file error: Could not find ".concat(e,"[").concat(t,"]")),n}},{key:"_resolveScene",value:function(e,t){var n=this;return e.id=e.id||"scene-".concat(t),e.nodes=(e.nodes||[]).map(function(e){return n.getNode(e)}),e}},{key:"_resolveNode",value:function(e,t){var n=this;return e.id=e.id||"node-".concat(t),e.children&&(e.children=e.children.map(function(e){return n.getNode(e)})),void 0!==e.mesh&&(e.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}},{key:"_resolveSkin",value:function(e,t){return e.id=e.id||"skin-".concat(t),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}},{key:"_resolveMesh",value:function(e,t){var n=this;return e.id=e.id||"mesh-".concat(t),e.primitives&&(e.primitives=e.primitives.map(function(e){var t=(e=WO({},e)).attributes;for(var r in e.attributes={},t)e.attributes[r]=n.getAccessor(t[r]);return void 0!==e.indices&&(e.indices=n.getAccessor(e.indices)),void 0!==e.material&&(e.material=n.getMaterial(e.material)),e})),e}},{key:"_resolveMaterial",value:function(e,t){if(e.id=e.id||"material-".concat(t),e.normalTexture&&(e.normalTexture=WO({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=WO({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=WO({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.pbrMetallicRoughness){e.pbrMetallicRoughness=WO({},e.pbrMetallicRoughness);var n=e.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture=WO({},n.baseColorTexture),n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture=WO({},n.metallicRoughnessTexture),n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return e}},{key:"_resolveAccessor",value:function(e,t){if(e.id=e.id||"accessor-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=XO[e.componentType],e.components=$O[e.type],e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){var n=e.bufferView.buffer,r=HT(e,e.bufferView);e.value=new(0,r.ArrayType)(n.arrayBuffer,(e.bufferView.byteOffset||0)+(e.byteOffset||0)+n.byteOffset,r.length)}return e}},{key:"_resolveTexture",value:function(e,t){return e.id=e.id||"texture-".concat(t),e.sampler="sampler"in e?this.getSampler(e.sampler):YO,e.source=this.getImage(e.source),e}},{key:"_resolveSampler",value:function(e,t){for(var n in e.id=e.id||"sampler-".concat(t),e.parameters={},e){var r=this._enumSamplerParameter(n);void 0!==r&&(e.parameters[r]=e[n])}return e}},{key:"_enumSamplerParameter",value:function(e){return ZO[e]}},{key:"_resolveImage",value:function(e,t){e.id=e.id||"image-".concat(t),void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var n=this.images[t];return n&&(e.image=n),e}},{key:"_resolveBufferView",value:function(e,t){e.id=e.id||"bufferView-".concat(t);var n=e.buffer;e.buffer=this.buffers[n];var r=this.buffers[n].byteOffset||0;return"byteOffset"in e&&(r+=e.byteOffset),e.data=new Uint8Array(this.buffers[n].arrayBuffer,r,e.byteLength),e}},{key:"_resolveCamera",value:function(e,t){return e.id=e.id||"camera-".concat(t),e}}]),e}();function JO(e,t){return(new QO).postProcess(e,t)}function eI(e,t){return tI.apply(this,arguments)}function tI(){return(tI=ob(rb().mark(function e(t,n){var r,i,o,s,a,u=arguments;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=u.length>4?u[4]:void 0,nI(t,n,u.length>2&&void 0!==u[2]?u[2]:0,r=u.length>3?u[3]:void 0),HO(t,{normalize:r.gltf.normalize}),o=[],!r.gltf.loadBuffers||!t.json.buffers){e.next=9;break}return e.next=9,rI(t,r,i);case 9:return r.gltf.loadImages&&(s=oI(t,r,i),o.push(s)),a=OO(t,r,i),o.push(a),e.next=14,Promise.all(o);case 14:return e.abrupt("return",r.gltf.postProcess?JO(t,r):t);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function nI(e,t,n,r){if(r.uri&&(e.baseUri=r.uri),t instanceof ArrayBuffer&&!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new DataView(e),i=n.magic,o=void 0===i?CO:i,s=r.getUint32(t,!1);return s===o||s===CO}(t,n,r)&&(t=(new TextDecoder).decode(t)),"string"==typeof t)e.json=function(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'.concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?oT(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?oT(e,0,t):""}(e),'"'))}}(t);else if(t instanceof ArrayBuffer){var i={};n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new DataView(t);e.type=jO(r,n+0),e.version=r.getUint32(n+4,DO);var i=r.getUint32(n+8,DO);switch(e.header={byteOffset:n,byteLength:i},e.json={},e.binChunks=[],n+=12,e.version){case 1:return PO(e,r,n);case 2:return MO(e,r,n,{});default:throw new Error("Invalid GLB version ".concat(e.version,". Only supports v1 and v2."))}}(i,t,n,r),uT("glTF"===i.type,"Invalid GLB magic string ".concat(i.type)),e._glb=i,e.json=i.json}else uT(!1,"GLTF: must be ArrayBuffer or string");if(e.buffers=new Array((e.json.buffers||[]).length).fill(null),e._glb&&e._glb.header.hasBinChunk){var o=e._glb.binChunks;e.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}e.images=new Array((e.json.images||[]).length).fill({})}function rI(e,t,n){return iI.apply(this,arguments)}function iI(){return(iI=ob(rb().mark(function e(t,n,r){var i,o,s,a,u,c;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t.json.buffers.length)){e.next=18;break}if(!(o=t.json.buffers[i]).uri){e.next=15;break}return uT(s=r.fetch),a=cT(o.uri,n),e.next=9,s(a);case 9:return u=e.sent,e.next=12,u.arrayBuffer();case 12:t.buffers[i]={arrayBuffer:c=e.sent,byteOffset:0,byteLength:c.byteLength},delete o.uri;case 15:++i,e.next=1;break;case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}function oI(e,t,n){return sI.apply(this,arguments)}function sI(){return(sI=ob(rb().mark(function e(t,n,r){var i,o,s;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.json.images||[],o=[],s=0;s<i.length;++s)o.push(aI(t,i[s],s,n,r));return e.next=5,Promise.all(o);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function aI(e,t,n,r,i){return uI.apply(this,arguments)}function uI(){return(uI=ob(rb().mark(function e(t,n,r,i,o){var s,a,u,c,l,h;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=o.fetch,a=o.parse,!n.uri){e.next=9;break}return c=cT(n.uri,i),e.next=5,s(c);case 5:return l=e.sent,e.next=8,l.arrayBuffer();case 8:u=e.sent;case 9:return Number.isFinite(n.bufferView)&&(h=lT(t.json,t.buffers,n.bufferView),u=aT(h.buffer,h.byteOffset,h.byteLength)),uT(u,"glTF image has no data"),e.next=13,a(u,hA,{},o);case 13:t.images[r]=e.sent;case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}function cI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cI(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var hI={id:"gltf",name:"glTF",version:"2.3.13",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(e){return fI.apply(this,arguments)},options:{gltf:{normalize:!1,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},baseUri:"",log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};const dI=hI;function fI(){return(fI=ob(rb().mark(function e(t){var n,r,i,o,s,a=arguments;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},r=a.length>2?a[2]:void 0,(n=lI(lI({},hI.options),n)).gltf=lI(lI({},hI.options.gltf),n.gltf),pI(n),o=void 0===(i=n.byteOffset)?0:i,s={},e.next=9,eI(s,t,o,n,r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function pI(e){"fetchImages"in e&&(e.gltf.loadImages=e.fetchImages),"createImages"in e&&(e.gltf.loadImages=e.createImages),"fetchLinkedResources"in e&&(e.gltf.fetchBuffers=e.fetchLinkedResources),"decompress"in e&&(e.gltf.decompressMeshes=e.decompress),"decompress"in e.gltf&&(e.gltf.decompressMeshes=e.gltf.decompress),"postProcess"in e&&(e.gltf.postProcess=e.postProcess)}function gI(){return(gI=ob(rb().mark(function e(t){var n;return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.scenes.forEach(function(e){e.traverse(function(e){Object.values(e.model.getUniforms()).forEach(function(e){!1===e.loaded&&n.push(e)})})}),e.next=4,mI(function(){return n.some(function(e){return!e.loaded})});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mI(e){return yI.apply(this,arguments)}function yI(){return(yI=ob(rb().mark(function e(t){return rb().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t()){e.next=5;break}return e.next=3,new Promise(function(e){return requestAnimationFrame(e)});case 3:e.next=0;break;case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vI(Object(n),!0).forEach(function(t){zh(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _I=[255,255,255,255],wI={scenegraph:{type:"object",value:null,async:!0},getScene:function(e){return e&&e.scenes?"object"===Mh(e.scene)?e.scene:e.scenes[e.scene||0]:e},getAnimator:function(e){return e&&e.animator},_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:_I},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[dI]},xI=function(e){Ph(i,e);var t,n,r=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=Ch(t);if(n){var i=Ch(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return Nh(this,e)});function i(){return Th(this,i),r.apply(this,arguments)}return Ih(i,[{key:"getShaders",value:function(){var e=[hk,bk];return"pbr"===this.props._lighting&&e.push(Pk),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:_I,transition:!0},instanceModelMatrix:Ok})}},{key:"updateState",value:function(e){Dh(Ch(i.prototype),"updateState",this).call(this,e);var t=e.props,n=e.oldProps;t.scenegraph!==n.scenegraph?this._updateScenegraph(t):t._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)}},{key:"finalizeState",value:function(){Dh(Ch(i.prototype),"finalizeState",this).call(this),this._deleteScenegraph()}},{key:"_updateScenegraph",value:function(e){var t=this,n=this.context.gl,r=null;if(e.scenegraph instanceof Mk)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){var i=e.scenegraph,o=function(e,t,n){const r=new iT(e,n);return{scenes:r.instantiate(t),animator:r.createAnimator()}}(n,i,this._getModelOptions());r=Object.assign({gltf:i},o),function(e){return gI.apply(this,arguments)}(o).then(function(){return t.setNeedsRedraw()})}else e.scenegraph&&(Eh.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);var s={layer:this,gl:n},a=e.getScene(r,s),u=e.getAnimator(r,s);a instanceof Mk?(this._deleteScenegraph(),this._applyAllAttributes(a),this._applyAnimationsProp(a,u,e._animations),this.setState({scenegraph:a,animator:u})):null!==a&&Eh.warn("invalid scenegraph:",a)()}},{key:"_applyAllAttributes",value:function(e){var t=this;if(this.state.attributesAvailable){var n=this.getAttributeManager().getAttributes();e.traverse(function(e){t._setModelAttributes(e.model,n)})}}},{key:"_applyAnimationsProp",value:function(e,t,n){if(e&&t&&n){var r=t.getAnimations();Object.keys(n).sort().forEach(function(e){var t=n[e];if("*"===e)r.forEach(function(e){Object.assign(e,t)});else if(Number.isFinite(Number(e))){var i=Number(e);i>=0&&i<r.length?Object.assign(r[i],t):Eh.warn("animation ".concat(e," not found"))()}else{var o=r.find(function(t){return t.name===e});o?Object.assign(o,t):Eh.warn("animation ".concat(e," not found"))()}})}}},{key:"_deleteScenegraph",value:function(){var e=this.state.scenegraph;e instanceof Mk&&e.delete()}},{key:"_getModelOptions",value:function(){var e=this.props._imageBasedLightingEnvironment,t=null;return e&&(t="function"==typeof e?e({gl:this.context.gl,layer:this}):e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:t,modelOptions:bI({isInstanced:!0,transpileToGLSL100:!Hh(this.context.gl)},this.getShaders()),useTangents:!1}}},{key:"updateAttributes",value:function(e){var t=this;this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(function(n){t._setModelAttributes(n.model,e)})}},{key:"draw",value:function(e){var t=e.moduleParameters,n=void 0===t?null:t,r=e.parameters,i=void 0===r?{}:r;if(this.state.scenegraph){this.props._animations&&this.state.animator&&(this.state.animator.animate(e.context.timeline.getTime()),this.setNeedsRedraw());var o=this.context.viewport,s=this.props,a=s.sizeScale,u=s.sizeMinPixels,c=s.sizeMaxPixels,l=s.opacity,h=s.coordinateSystem,d=this.getNumInstances();this.state.scenegraph.traverse(function(e,t){var r=t.worldMatrix;e.model.setInstanceCount(d),e.updateModuleSettings(n),e.draw({parameters:i,uniforms:{sizeScale:a,opacity:l,sizeMinPixels:u,sizeMaxPixels:c,composeModelMatrix:Ik(o,h),sceneModelMatrix:r,u_Camera:e.model.getUniforms().project_uCameraPosition}})})}}}]),i}(Qw);xI.layerName="ScenegraphLayer",xI.defaultProps=wI;const EI=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),SI=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),AI=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),kI=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),TI={POSITION:{size:3,value:new Float32Array(SI)},NORMAL:{size:3,value:new Float32Array(AI)},TEXCOORD_0:{size:2,value:new Float32Array(kI)}};class OI extends wk{constructor(e={}){const{id:t=Gd("cube-geometry")}=e;super({...e,id:t,indices:{size:1,value:new Uint16Array(EI)},attributes:{...TI,...e.attributes}})}}class II{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new DI){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new DI){const n=this.elements,r=e.x,i=e.y,o=e.z;return t.x=n[0]*r+n[1]*i+n[2]*o,t.y=n[3]*r+n[4]*i+n[5]*o,t.z=n[6]*r+n[7]*i+n[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new II){const n=this.elements,r=e.elements,i=t.elements,o=n[0],s=n[1],a=n[2],u=n[3],c=n[4],l=n[5],h=n[6],d=n[7],f=n[8],p=r[0],g=r[1],m=r[2],y=r[3],v=r[4],b=r[5],_=r[6],w=r[7],x=r[8];return i[0]=o*p+s*y+a*_,i[1]=o*g+s*v+a*w,i[2]=o*m+s*b+a*x,i[3]=u*p+c*y+l*_,i[4]=u*g+c*v+l*w,i[5]=u*m+c*b+l*x,i[6]=h*p+d*y+f*_,i[7]=h*g+d*v+f*w,i[8]=h*m+d*b+f*x,t}scale(e,t=new II){const n=this.elements,r=t.elements;for(let i=0;3!==i;i++)r[3*i+0]=e.x*n[3*i+0],r[3*i+1]=e.y*n[3*i+1],r[3*i+2]=e.z*n[3*i+2];return t}solve(e,t=new DI){const n=[];let r,i;for(r=0;r<12;r++)n.push(0);for(r=0;r<3;r++)for(i=0;i<3;i++)n[r+4*i]=this.elements[r+3*i];n[3]=e.x,n[7]=e.y,n[11]=e.z;let o=3;const s=o;let a,u;do{if(r=s-o,0===n[r+4*r])for(i=r+1;i<s;i++)if(0!==n[r+4*i]){a=4;do{u=4-a,n[u+4*r]+=n[u+4*i]}while(--a);break}if(0!==n[r+4*r])for(i=r+1;i<s;i++){const e=n[r+4*i]/n[r+4*r];a=4;do{u=4-a,n[u+4*i]=u<=r?0:n[u+4*i]-n[u+4*r]*e}while(--a)}}while(--o);if(t.z=n[11]/n[10],t.y=(n[7]-n[6]*t.z)/n[5],t.x=(n[3]-n[2]*t.z-n[1]*t.y)/n[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,n){if(void 0===n)return this.elements[t+3*e];this.elements[t+3*e]=n}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let t=0;t<9;t++)e+=this.elements[t]+",";return e}reverse(e=new II){const t=CI;let n,r;for(n=0;n<3;n++)for(r=0;r<3;r++)t[n+6*r]=this.elements[n+3*r];t[3]=1,t[9]=0,t[15]=0,t[4]=0,t[10]=1,t[16]=0,t[5]=0,t[11]=0,t[17]=1;let i=3;const o=i;let s,a;do{if(n=o-i,0===t[n+6*n])for(r=n+1;r<o;r++)if(0!==t[n+6*r]){s=6;do{a=6-s,t[a+6*n]+=t[a+6*r]}while(--s);break}if(0!==t[n+6*n])for(r=n+1;r<o;r++){const e=t[n+6*r]/t[n+6*n];s=6;do{a=6-s,t[a+6*r]=a<=n?0:t[a+6*r]-t[a+6*n]*e}while(--s)}}while(--i);n=2;do{r=n-1;do{const e=t[n+6*r]/t[n+6*n];s=6;do{a=6-s,t[a+6*r]=t[a+6*r]-t[a+6*n]*e}while(--s)}while(r--)}while(--n);n=2;do{const e=1/t[n+6*n];s=6;do{a=6-s,t[a+6*n]=t[a+6*n]*e}while(--s)}while(n--);n=2;do{r=2;do{if(a=t[3+r+6*n],isNaN(a)||a===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(n,r,a)}while(r--)}while(n--);return e}setRotationFromQuaternion(e){const t=e.x,n=e.y,r=e.z,i=e.w,o=t+t,s=n+n,a=r+r,u=t*o,c=t*s,l=t*a,h=n*s,d=n*a,f=r*a,p=i*o,g=i*s,m=i*a,y=this.elements;return y[0]=1-(h+f),y[1]=c-m,y[2]=l+g,y[3]=c+m,y[4]=1-(u+f),y[5]=d-p,y[6]=l-g,y[7]=d+p,y[8]=1-(u+h),this}transpose(e=new II){const t=this.elements,n=e.elements;let r;return n[0]=t[0],n[4]=t[4],n[8]=t[8],r=t[1],n[1]=t[3],n[3]=r,r=t[2],n[2]=t[6],n[6]=r,r=t[5],n[5]=t[7],n[7]=r,e}}const CI=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class DI{constructor(e=0,t=0,n=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=n}cross(e,t=new DI){const n=e.x,r=e.y,i=e.z,o=this.x,s=this.y,a=this.z;return t.x=s*i-a*r,t.y=a*n-o*i,t.z=o*r-s*n,t}set(e,t,n){return this.x=e,this.y=t,this.z=n,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new DI(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new DI(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new II([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,n=this.z,r=Math.sqrt(e*e+t*t+n*n);if(r>0){const e=1/r;this.x*=e,this.y*=e,this.z*=e}else this.x=0,this.y=0,this.z=0;return r}unit(e=new DI){const t=this.x,n=this.y,r=this.z;let i=Math.sqrt(t*t+n*n+r*r);return i>0?(i=1/i,e.x=t*i,e.y=n*i,e.z=r*i):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,n=this.z;return Math.sqrt(e*e+t*t+n*n)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,s=e.z;return Math.sqrt((i-t)*(i-t)+(o-n)*(o-n)+(s-r)*(s-r))}distanceSquared(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,s=e.z;return(i-t)*(i-t)+(o-n)*(o-n)+(s-r)*(s-r)}scale(e,t=new DI){const n=this.y,r=this.z;return t.x=e*this.x,t.y=e*n,t.z=e*r,t}vmul(e,t=new DI){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,n=new DI){return n.x=this.x+e*t.x,n.y=this.y+e*t.y,n.z=this.z+e*t.z,n}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new DI){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const n=this.length();if(n>0){const r=jI,i=1/n;r.set(this.x*i,this.y*i,this.z*i);const o=PI;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,n){const r=this.x,i=this.y,o=this.z;n.x=r+(e.x-r)*t,n.y=i+(e.y-i)*t,n.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(MI),MI.almostEquals(e,t)}clone(){return new DI(this.x,this.y,this.z)}}DI.ZERO=void 0,DI.UNIT_X=void 0,DI.UNIT_Y=void 0,DI.UNIT_Z=void 0,DI.ZERO=new DI(0,0,0),DI.UNIT_X=new DI(1,0,0),DI.UNIT_Y=new DI(0,1,0),DI.UNIT_Z=new DI(0,0,1);const jI=new DI,PI=new DI,MI=new DI;class RI{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new DI,this.upperBound=new DI,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,n,r){const i=this.lowerBound,o=this.upperBound,s=n;i.copy(e[0]),s&&s.vmult(i,i),o.copy(i);for(let a=1;a<e.length;a++){let t=e[a];s&&(s.vmult(t,NI),t=NI),t.x>o.x&&(o.x=t.x),t.x<i.x&&(i.x=t.x),t.y>o.y&&(o.y=t.y),t.y<i.y&&(i.y=t.y),t.z>o.z&&(o.z=t.z),t.z<i.z&&(i.z=t.z)}return t&&(t.vadd(i,i),t.vadd(o,o)),r&&(i.x-=r,i.y-=r,i.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new RI).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,n=this.upperBound,r=e.lowerBound,i=e.upperBound;return(r.x<=n.x&&n.x<=i.x||t.x<=i.x&&i.x<=n.x)&&(r.y<=n.y&&n.y<=i.y||t.y<=i.y&&i.y<=n.y)&&(r.z<=n.z&&n.z<=i.z||t.z<=i.z&&i.z<=n.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,n=this.upperBound,r=e.lowerBound,i=e.upperBound;return t.x<=r.x&&n.x>=i.x&&t.y<=r.y&&n.y>=i.y&&t.z<=r.z&&n.z>=i.z}getCorners(e,t,n,r,i,o,s,a){const u=this.lowerBound,c=this.upperBound;e.copy(u),t.set(c.x,u.y,u.z),n.set(c.x,c.y,u.z),r.set(u.x,c.y,c.z),i.set(c.x,u.y,c.z),o.set(u.x,c.y,u.z),s.set(u.x,u.y,c.z),a.copy(c)}toLocalFrame(e,t){const n=LI;this.getCorners(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);for(let r=0;8!==r;r++){const t=n[r];e.pointToLocal(t,t)}return t.setFromPoints(n)}toWorldFrame(e,t){const n=LI;this.getCorners(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);for(let r=0;8!==r;r++){const t=n[r];e.pointToWorld(t,t)}return t.setFromPoints(n)}overlapsRay(e){const{direction:t,from:n}=e,r=1/t.x,i=1/t.y,o=1/t.z,s=(this.lowerBound.x-n.x)*r,a=(this.upperBound.x-n.x)*r,u=(this.lowerBound.y-n.y)*i,c=(this.upperBound.y-n.y)*i,l=(this.lowerBound.z-n.z)*o,h=(this.upperBound.z-n.z)*o,d=Math.max(Math.max(Math.min(s,a),Math.min(u,c)),Math.min(l,h)),f=Math.min(Math.min(Math.max(s,a),Math.max(u,c)),Math.max(l,h));return!(f<0||d>f)}}const NI=new DI,LI=[new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI];class FI{constructor(e=0,t=0,n=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=n,this.w=r}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const n=Math.sin(.5*t);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(.5*t),this}toAxisAngle(e=new DI){this.normalize();const t=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/n,e.y=this.y/n,e.z=this.z/n),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const t=BI;e.tangents(t,zI),this.setFromAxisAngle(t,Math.PI)}else{const n=e.cross(t);this.x=n.x,this.y=n.y,this.z=n.z,this.w=Math.sqrt(e.length()**2*t.length()**2)+e.dot(t),this.normalize()}return this}mult(e,t=new FI){const n=this.x,r=this.y,i=this.z,o=this.w,s=e.x,a=e.y,u=e.z,c=e.w;return t.x=n*c+o*s+r*u-i*a,t.y=r*c+o*a+i*s-n*u,t.z=i*c+o*u+n*a-r*s,t.w=o*c-n*s-r*a-i*u,t}inverse(e=new FI){const t=this.x,n=this.y,r=this.z,i=this.w;this.conjugate(e);const o=1/(t*t+n*n+r*r+i*i);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new FI){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new DI){const n=e.x,r=e.y,i=e.z,o=this.x,s=this.y,a=this.z,u=this.w,c=u*n+s*i-a*r,l=u*r+a*n-o*i,h=u*i+o*r-s*n,d=-o*n-s*r-a*i;return t.x=c*u+d*-o+l*-a-h*-s,t.y=l*u+d*-s+h*-o-c*-a,t.z=h*u+d*-a+c*-s-l*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let n,r,i;const o=this.x,s=this.y,a=this.z,u=this.w;switch(t){case"YZX":const e=o*s+a*u;if(e>.499&&(n=2*Math.atan2(o,u),r=Math.PI/2,i=0),e<-.499&&(n=-2*Math.atan2(o,u),r=-Math.PI/2,i=0),void 0===n){const t=o*o,c=a*a;n=Math.atan2(2*s*u-2*o*a,1-s*s*2-2*c),r=Math.asin(2*e),i=Math.atan2(2*o*u-2*s*a,1-2*t-2*c)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=n,e.z=r,e.x=i}setFromEuler(e,t,n,r="XYZ"){const i=Math.cos(e/2),o=Math.cos(t/2),s=Math.cos(n/2),a=Math.sin(e/2),u=Math.sin(t/2),c=Math.sin(n/2);return"XYZ"===r?(this.x=a*o*s+i*u*c,this.y=i*u*s-a*o*c,this.z=i*o*c+a*u*s,this.w=i*o*s-a*u*c):"YXZ"===r?(this.x=a*o*s+i*u*c,this.y=i*u*s-a*o*c,this.z=i*o*c-a*u*s,this.w=i*o*s+a*u*c):"ZXY"===r?(this.x=a*o*s-i*u*c,this.y=i*u*s+a*o*c,this.z=i*o*c+a*u*s,this.w=i*o*s-a*u*c):"ZYX"===r?(this.x=a*o*s-i*u*c,this.y=i*u*s+a*o*c,this.z=i*o*c-a*u*s,this.w=i*o*s+a*u*c):"YZX"===r?(this.x=a*o*s+i*u*c,this.y=i*u*s+a*o*c,this.z=i*o*c-a*u*s,this.w=i*o*s-a*u*c):"XZY"===r&&(this.x=a*o*s-i*u*c,this.y=i*u*s-a*o*c,this.z=i*o*c+a*u*s,this.w=i*o*s+a*u*c),this}clone(){return new FI(this.x,this.y,this.z,this.w)}slerp(e,t,n=new FI){const r=this.x,i=this.y,o=this.z,s=this.w;let a,u,c,l,h,d=e.x,f=e.y,p=e.z,g=e.w;return u=r*d+i*f+o*p+s*g,u<0&&(u=-u,d=-d,f=-f,p=-p,g=-g),1-u>1e-6?(a=Math.acos(u),c=Math.sin(a),l=Math.sin((1-t)*a)/c,h=Math.sin(t*a)/c):(l=1-t,h=t),n.x=l*r+h*d,n.y=l*i+h*f,n.z=l*o+h*p,n.w=l*s+h*g,n}integrate(e,t,n,r=new FI){const i=e.x*n.x,o=e.y*n.y,s=e.z*n.z,a=this.x,u=this.y,c=this.z,l=this.w,h=.5*t;return r.x+=h*(i*l+o*c-s*u),r.y+=h*(o*l+s*a-i*c),r.z+=h*(s*l+i*u-o*a),r.w+=h*(-i*a-o*u-s*c),r}}const BI=new DI,zI=new DI,UI={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let VI=(()=>{class e{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=e.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(e,t){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(e,t,n,r){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return e.idCounter=0,e.types=UI,e})();class GI{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new DI,this.quaternion=new FI,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return GI.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return GI.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new DI){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,n,r=new DI){return n.vsub(e,r),t.conjugate(HI),HI.vmult(r,r),r}static pointToWorldFrame(e,t,n,r=new DI){return t.vmult(n,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,n=new DI){return e.vmult(t,n),n}static vectorToLocalFrame(e,t,n,r=new DI){return t.w*=-1,t.vmult(n,r),t.w*=-1,r}}const HI=new FI;class qI extends VI{constructor(e={}){const{vertices:t=[],faces:n=[],normals:r=[],axes:i,boundingSphereRadius:o}=e;super({type:VI.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=n,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=i?i.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,n=this.uniqueEdges;n.length=0;const r=new DI;for(let i=0;i!==e.length;i++){const o=e[i],s=o.length;for(let e=0;e!==s;e++){t[o[e]].vsub(t[o[(e+1)%s]],r),r.normalize();let i=!1;for(let e=0;e!==n.length;e++)if(n[e].almostEquals(r)||n[e].almostEquals(r)){i=!0;break}i||n.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let n=0;n<this.faces[e].length;n++)if(!this.vertices[this.faces[e][n]])throw new Error("Vertex "+this.faces[e][n]+" not found!");const t=this.faceNormals[e]||new DI;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let t=0;t<this.faces[e].length;t++)console.warn(".vertices["+this.faces[e][t]+"] = Vec3("+this.vertices[this.faces[e][t]].toString()+")")}}}getFaceNormal(e,t){const n=this.faces[e];qI.computeNormal(this.vertices[n[0]],this.vertices[n[1]],this.vertices[n[2]],t)}static computeNormal(e,t,n,r){const i=new DI,o=new DI;t.vsub(e,o),n.vsub(t,i),i.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,n,r,i,o,s,a,u){const c=new DI;let l=-1,h=-Number.MAX_VALUE;for(let f=0;f<n.faces.length;f++){c.copy(n.faceNormals[f]),i.vmult(c,c);const e=c.dot(o);e>h&&(h=e,l=f)}const d=[];for(let f=0;f<n.faces[l].length;f++){const e=n.vertices[n.faces[l][f]],t=new DI;t.copy(e),i.vmult(t,t),r.vadd(t,t),d.push(t)}l>=0&&this.clipFaceAgainstHull(o,e,t,d,s,a,u)}findSeparatingAxis(e,t,n,r,i,o,s,a){const u=new DI,c=new DI,l=new DI,h=new DI,d=new DI,f=new DI;let p=Number.MAX_VALUE;const g=this;if(g.uniqueAxes)for(let m=0;m!==g.uniqueAxes.length;m++){n.vmult(g.uniqueAxes[m],u);const s=g.testSepAxis(u,e,t,n,r,i);if(!1===s)return!1;s<p&&(p=s,o.copy(u))}else{const a=s?s.length:g.faces.length;for(let c=0;c<a;c++){u.copy(g.faceNormals[s?s[c]:c]),n.vmult(u,u);const a=g.testSepAxis(u,e,t,n,r,i);if(!1===a)return!1;a<p&&(p=a,o.copy(u))}}if(e.uniqueAxes)for(let m=0;m!==e.uniqueAxes.length;m++){i.vmult(e.uniqueAxes[m],c);const s=g.testSepAxis(c,e,t,n,r,i);if(!1===s)return!1;s<p&&(p=s,o.copy(c))}else{const s=a?a.length:e.faces.length;for(let u=0;u<s;u++){c.copy(e.faceNormals[a?a[u]:u]),i.vmult(c,c);const s=g.testSepAxis(c,e,t,n,r,i);if(!1===s)return!1;s<p&&(p=s,o.copy(c))}}for(let m=0;m!==g.uniqueEdges.length;m++){n.vmult(g.uniqueEdges[m],h);for(let s=0;s!==e.uniqueEdges.length;s++)if(i.vmult(e.uniqueEdges[s],d),h.cross(d,f),!f.almostZero()){f.normalize();const s=g.testSepAxis(f,e,t,n,r,i);if(!1===s)return!1;s<p&&(p=s,o.copy(f))}}return r.vsub(t,l),l.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,n,r,i,o){qI.project(this,e,n,r,WI),qI.project(t,e,i,o,$I);const s=WI[0],a=WI[1],u=$I[0],c=$I[1];if(s<c||u<a)return!1;const l=s-c,h=u-a;return l<h?l:h}calculateLocalInertia(e,t){const n=new DI,r=new DI;this.computeLocalAABB(r,n);const i=n.x-r.x,o=n.y-r.y,s=n.z-r.z;t.x=1/12*e*(2*o*2*o+2*s*2*s),t.y=1/12*e*(2*i*2*i+2*s*2*s),t.z=1/12*e*(2*o*2*o+2*i*2*i)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,n,r,i,o,s){const a=new DI,u=new DI,c=new DI,l=new DI,h=new DI,d=new DI,f=new DI,p=new DI,g=this,m=r,y=[];let v=-1,b=Number.MAX_VALUE;for(let S=0;S<g.faces.length;S++){a.copy(g.faceNormals[S]),n.vmult(a,a);const t=a.dot(e);t<b&&(b=t,v=S)}if(v<0)return;const _=g.faces[v];_.connectedFaces=[];for(let S=0;S<g.faces.length;S++)for(let e=0;e<g.faces[S].length;e++)-1!==_.indexOf(g.faces[S][e])&&S!==v&&-1===_.connectedFaces.indexOf(S)&&_.connectedFaces.push(S);const w=_.length;for(let S=0;S<w;S++){const e=g.vertices[_[S]];e.vsub(g.vertices[_[(S+1)%w]],u),c.copy(u),n.vmult(c,c),t.vadd(c,c),l.copy(this.faceNormals[v]),n.vmult(l,l),t.vadd(l,l),c.cross(l,h),h.negate(h),d.copy(e),n.vmult(d,d),t.vadd(d,d);const r=_.connectedFaces[S];f.copy(this.faceNormals[r]);const i=this.getPlaneConstantOfFace(r);p.copy(f),n.vmult(p,p);const o=i-p.dot(t);for(this.clipFaceAgainstPlane(m,y,p,o);m.length;)m.shift();for(;y.length;)m.push(y.shift())}f.copy(this.faceNormals[v]);const x=this.getPlaneConstantOfFace(v);p.copy(f),n.vmult(p,p);const E=x-p.dot(t);for(let S=0;S<m.length;S++){let e=p.dot(m[S])+E;if(e<=i&&(console.log("clamped: depth="+e+" to minDist="+i),e=i),e<=o){const t=m[S];e<=1e-6&&s.push({point:t,normal:p,depth:e})}}}clipFaceAgainstPlane(e,t,n,r){let i,o;const s=e.length;if(s<2)return t;let a=e[e.length-1],u=e[0];i=n.dot(a)+r;for(let c=0;c<s;c++){if(u=e[c],o=n.dot(u)+r,i<0)if(o<0){const e=new DI;e.copy(u),t.push(e)}else{const e=new DI;a.lerp(u,i/(i-o),e),t.push(e)}else if(o<0){const e=new DI;a.lerp(u,i/(i-o),e),t.push(e),t.push(u)}a=u,i=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new DI);const n=this.vertices,r=this.worldVertices;for(let i=0;i!==this.vertices.length;i++)t.vmult(n[i],r[i]),e.vadd(r[i],r[i]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const n=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const i=n[r];i.x<e.x?e.x=i.x:i.x>t.x&&(t.x=i.x),i.y<e.y?e.y=i.y:i.y>t.y&&(t.y=i.y),i.z<e.z?e.z=i.z:i.z>t.z&&(t.z=i.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new DI);const n=this.faceNormals,r=this.worldFaceNormals;for(let i=0;i!==t;i++)e.vmult(n[i],r[i]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let n=0;n!==t.length;n++){const r=t[n].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,n,r){const i=this.vertices;let o,s,a,u,c,l,h=new DI;for(let d=0;d<i.length;d++){h.copy(i[d]),t.vmult(h,h),e.vadd(h,h);const n=h;(void 0===o||n.x<o)&&(o=n.x),(void 0===u||n.x>u)&&(u=n.x),(void 0===s||n.y<s)&&(s=n.y),(void 0===c||n.y>c)&&(c=n.y),(void 0===a||n.z<a)&&(a=n.z),(void 0===l||n.z>l)&&(l=n.z)}n.set(o,s,a),r.set(u,c,l)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new DI){const t=this.vertices;for(let n=0;n<t.length;n++)e.vadd(t[n],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const n=this.vertices.length,r=this.vertices;if(t){for(let e=0;e<n;e++){const n=r[e];t.vmult(n,n)}for(let e=0;e<this.faceNormals.length;e++){const n=this.faceNormals[e];t.vmult(n,n)}}if(e)for(let i=0;i<n;i++){const t=r[i];t.vadd(e,t)}}pointIsInside(e){const t=this.vertices,n=this.faces,r=this.faceNormals,i=new DI;this.getAveragePointLocal(i);for(let o=0;o<this.faces.length;o++){let s=r[o];const a=t[n[o][0]],u=new DI;e.vsub(a,u);const c=s.dot(u),l=new DI;i.vsub(a,l);const h=s.dot(l);if(c<0&&h>0||c>0&&h<0)return!1}return-1}static project(e,t,n,r,i){const o=e.vertices.length,s=XI;let a=0,u=0;const c=KI,l=e.vertices;c.setZero(),GI.vectorToLocalFrame(n,r,t,s),GI.pointToLocalFrame(n,r,c,c);const h=c.dot(s);u=a=l[0].dot(s);for(let d=1;d<o;d++){const e=l[d].dot(s);e>a&&(a=e),e<u&&(u=e)}if(u-=h,a-=h,u>a){const e=u;u=a,a=e}i[0]=a,i[1]=u}}const WI=[],$I=[],XI=new DI,KI=new DI;class ZI extends VI{constructor(e){super({type:VI.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,n=this.halfExtents.z,r=DI,i=[new r(-e,-t,-n),new r(e,-t,-n),new r(e,t,-n),new r(-e,t,-n),new r(-e,-t,n),new r(e,-t,n),new r(e,t,n),new r(-e,t,n)],o=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],s=new qI({vertices:i,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:o});this.convexPolyhedronRepresentation=s,s.material=this.material}calculateLocalInertia(e,t=new DI){return ZI.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,n){const r=e;n.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),n.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),n.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const n=e,r=this.halfExtents;if(n[0].set(r.x,0,0),n[1].set(0,r.y,0),n[2].set(0,0,r.z),n[3].set(-r.x,0,0),n[4].set(0,-r.y,0),n[5].set(0,0,-r.z),void 0!==t)for(let i=0;i!==n.length;i++)t.vmult(n[i],n[i]);return n}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,n){const r=this.halfExtents,i=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<i.length;o++)YI.set(i[o][0],i[o][1],i[o][2]),t.vmult(YI,YI),e.vadd(YI,YI),n(YI.x,YI.y,YI.z)}calculateWorldAABB(e,t,n,r){const i=this.halfExtents;QI[0].set(i.x,i.y,i.z),QI[1].set(-i.x,i.y,i.z),QI[2].set(-i.x,-i.y,i.z),QI[3].set(-i.x,-i.y,-i.z),QI[4].set(i.x,-i.y,-i.z),QI[5].set(i.x,i.y,-i.z),QI[6].set(-i.x,i.y,-i.z),QI[7].set(i.x,-i.y,i.z);const o=QI[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),n.copy(o);for(let s=1;s<8;s++){const i=QI[s];t.vmult(i,i),e.vadd(i,i);const o=i.x,a=i.y,u=i.z;o>r.x&&(r.x=o),a>r.y&&(r.y=a),u>r.z&&(r.z=u),o<n.x&&(n.x=o),a<n.y&&(n.y=a),u<n.z&&(n.z=u)}}}const YI=new DI,QI=[new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI];class JI extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;return void 0===n[e]&&(n[e]=[]),n[e].includes(t)||n[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return!(void 0===n[e]||!n[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const n=this._listeners;if(void 0===n[e])return this;const r=n[e].indexOf(t);return-1!==r&&n[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const t=this._listeners[e.type];if(void 0!==t){e.target=this;for(let n=0,r=t.length;n<r;n++)t[n].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=JI.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new DI,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new DI,this.previousPosition=new DI,this.interpolatedPosition=new DI,this.initPosition=new DI,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new DI,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new DI,this.force=new DI;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?JI.STATIC:JI.DYNAMIC,typeof e.type==typeof JI.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=JI.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new DI,this.quaternion=new FI,this.initQuaternion=new FI,this.previousQuaternion=new FI,this.interpolatedQuaternion=new FI,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new DI,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new DI,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new DI,this.invInertia=new DI,this.invInertiaWorld=new II,this.invMassSolve=0,this.invInertiaSolve=new DI,this.invInertiaWorldSolve=new II,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new DI(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new DI(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new RI,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new DI,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=JI.AWAKE,this.wakeUpAfterNarrowphase=!1,e===JI.SLEEPING&&this.dispatchEvent(JI.wakeupEvent)}sleep(){this.sleepState=JI.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,n=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=this.sleepSpeedLimit**2;t===JI.AWAKE&&n<r?(this.sleepState=JI.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(JI.sleepyEvent)):t===JI.SLEEPY&&n>r?this.wakeUp():t===JI.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(JI.sleepEvent))}}updateSolveMassProperties(){this.sleepState===JI.SLEEPING||this.type===JI.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new DI){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new DI){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new DI){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new DI){return this.quaternion.vmult(e,t),t}addShape(e,t,n){const r=new DI,i=new FI;return t&&r.copy(t),n&&i.copy(n),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(i),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,n=e.length;let r=0;for(let i=0;i!==n;i++){const n=e[i];n.updateBoundingSphereRadius();const o=t[i].length(),s=n.boundingSphereRadius;o+s>r&&(r=o+s)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,n=this.shapeOrientations,r=e.length,i=eC,o=tC,s=this.quaternion,a=this.aabb,u=nC;for(let c=0;c!==r;c++){const r=e[c];s.vmult(t[c],i),i.vadd(this.position,i),s.mult(n[c],o),r.calculateWorldAABB(i,o,u.lowerBound,u.upperBound),0===c?a.copy(u):a.extend(u)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const e=rC,n=iC;e.setRotationFromQuaternion(this.quaternion),e.transpose(n),e.scale(t,e),e.mmult(n,this.invInertiaWorld)}}applyForce(e,t=new DI){if(this.type!==JI.DYNAMIC)return;this.sleepState===JI.SLEEPING&&this.wakeUp();const n=oC;t.cross(e,n),this.force.vadd(e,this.force),this.torque.vadd(n,this.torque)}applyLocalForce(e,t=new DI){if(this.type!==JI.DYNAMIC)return;const n=sC,r=aC;this.vectorToWorldFrame(e,n),this.vectorToWorldFrame(t,r),this.applyForce(n,r)}applyTorque(e){this.type===JI.DYNAMIC&&(this.sleepState===JI.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new DI){if(this.type!==JI.DYNAMIC)return;this.sleepState===JI.SLEEPING&&this.wakeUp();const n=t,r=uC;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const i=cC;n.cross(e,i),this.invInertiaWorld.vmult(i,i),this.angularVelocity.vadd(i,this.angularVelocity)}applyLocalImpulse(e,t=new DI){if(this.type!==JI.DYNAMIC)return;const n=lC,r=hC;this.vectorToWorldFrame(e,n),this.vectorToWorldFrame(t,r),this.applyImpulse(n,r)}updateMassProperties(){const e=dC;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,n=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),ZI.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!n?1/t.x:0,t.y>0&&!n?1/t.y:0,t.z>0&&!n?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const n=new DI;return e.vsub(this.position,n),this.angularVelocity.cross(n,t),this.velocity.vadd(t,t),t}integrate(e,t,n){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==JI.DYNAMIC&&this.type!==JI.KINEMATIC||this.sleepState===JI.SLEEPING)return;const r=this.velocity,i=this.angularVelocity,o=this.position,s=this.force,a=this.torque,u=this.quaternion,c=this.invInertiaWorld,l=this.linearFactor,h=this.invMass*e;r.x+=s.x*h*l.x,r.y+=s.y*h*l.y,r.z+=s.z*h*l.z;const d=c.elements,f=this.angularFactor,p=a.x*f.x,g=a.y*f.y,m=a.z*f.z;i.x+=e*(d[0]*p+d[1]*g+d[2]*m),i.y+=e*(d[3]*p+d[4]*g+d[5]*m),i.z+=e*(d[6]*p+d[7]*g+d[8]*m),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,u.integrate(this.angularVelocity,e,this.angularFactor,u),t&&(n?u.normalizeFast():u.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}JI.idCounter=0,JI.COLLIDE_EVENT_NAME="collide",JI.DYNAMIC=1,JI.STATIC=2,JI.KINEMATIC=4,JI.AWAKE=0,JI.SLEEPY=1,JI.SLEEPING=2,JI.wakeupEvent={type:"wakeup"},JI.sleepyEvent={type:"sleepy"},JI.sleepEvent={type:"sleep"};const eC=new DI,tC=new FI,nC=new RI,rC=new II,iC=new II,oC=new DI,sC=new DI,aC=new DI,uC=new DI,cC=new DI,lC=new DI,hC=new DI,dC=new DI;new DI,new DI;class fC{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new DI,this.rayToWorld=new DI,this.hitNormalWorld=new DI,this.hitPointWorld=new DI,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,n,r,i,o,s){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(r),this.shape=i,this.body=o,this.distance=s}}let pC,gC,mC,yC,vC,bC,_C;pC=VI.types.SPHERE,gC=VI.types.PLANE,mC=VI.types.BOX,yC=VI.types.CYLINDER,vC=VI.types.CONVEXPOLYHEDRON,bC=VI.types.HEIGHTFIELD,_C=VI.types.TRIMESH;class wC{get[pC](){return this._intersectSphere}get[gC](){return this._intersectPlane}get[mC](){return this._intersectBox}get[yC](){return this._intersectConvex}get[vC](){return this._intersectConvex}get[bC](){return this._intersectHeightfield}get[_C](){return this._intersectTrimesh}constructor(e=new DI,t=new DI){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new DI,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=wC.ANY,this.result=new fC,this.hasHit=!1,this.callback=e=>{}}intersectWorld(e,t){return this.mode=t.mode||wC.ANY,this.result=t.result||new fC,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(xC),EC.length=0,e.broadphase.aabbQuery(e,xC,EC),this.intersectBodies(EC),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const n=this.checkCollisionResponse;if(n&&!e.collisionResponse)return;if(0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=kC,i=TC;for(let o=0,s=e.shapes.length;o<s;o++){const t=e.shapes[o];if((!n||t.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],i),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(t,i,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let n=0,r=e.length;!this.result.shouldStop&&n<r;n++)this.intersectBody(e[n])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,n,r){if(function(e,t,n){n.vsub(e,XC);const r=XC.dot(t);return t.scale(r,KC),KC.vadd(e,KC),n.distanceTo(KC)}(this.from,this.direction,n)>e.boundingSphereRadius)return;const i=this[e.type];i&&i.call(this,e,t,n,r,e)}_intersectBox(e,t,n,r,i){return this._intersectConvex(e.convexPolyhedronRepresentation,t,n,r,i)}_intersectPlane(e,t,n,r,i){const o=this.from,s=this.to,a=this.direction,u=new DI(0,0,1);t.vmult(u,u);const c=new DI;o.vsub(n,c);const l=c.dot(u);if(s.vsub(n,c),l*c.dot(u)>0)return;if(o.distanceTo(s)<l)return;const h=u.dot(a);if(Math.abs(h)<this.precision)return;const d=new DI,f=new DI,p=new DI;o.vsub(n,d);const g=-u.dot(d)/h;a.scale(g,f),o.vadd(f,p),this.reportIntersection(u,p,i,r,-1)}getAABB(e){const{lowerBound:t,upperBound:n}=e,r=this.to,i=this.from;t.x=Math.min(r.x,i.x),t.y=Math.min(r.y,i.y),t.z=Math.min(r.z,i.z),n.x=Math.max(r.x,i.x),n.y=Math.max(r.y,i.y),n.z=Math.max(r.z,i.z)}_intersectHeightfield(e,t,n,r,i){const o=MC;o.from.copy(this.from),o.to.copy(this.to),GI.pointToLocalFrame(n,t,o.from,o.from),GI.pointToLocalFrame(n,t,o.to,o.to),o.updateDirection();const s=RC;let a,u,c,l;a=u=0,c=l=e.data.length-1;const h=new RI;o.getAABB(h),e.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,s,!0),a=Math.max(a,s[0]),u=Math.max(u,s[1]),e.getIndexOfPosition(h.upperBound.x,h.upperBound.y,s,!0),c=Math.min(c,s[0]+1),l=Math.min(l,s[1]+1);for(let d=a;d<c;d++)for(let s=u;s<l;s++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(d,s,h),h.overlapsRay(o)){if(e.getConvexTrianglePillar(d,s,!1),GI.pointToWorldFrame(n,t,e.pillarOffset,PC),this._intersectConvex(e.pillarConvex,t,PC,r,i,jC),this.result.shouldStop)return;e.getConvexTrianglePillar(d,s,!0),GI.pointToWorldFrame(n,t,e.pillarOffset,PC),this._intersectConvex(e.pillarConvex,t,PC,r,i,jC)}}}_intersectSphere(e,t,n,r,i){const o=this.from,s=this.to,a=(s.x-o.x)**2+(s.y-o.y)**2+(s.z-o.z)**2,u=2*((s.x-o.x)*(o.x-n.x)+(s.y-o.y)*(o.y-n.y)+(s.z-o.z)*(o.z-n.z)),c=u**2-4*a*((o.x-n.x)**2+(o.y-n.y)**2+(o.z-n.z)**2-e.radius**2),l=NC,h=LC;if(!(c<0))if(0===c)o.lerp(s,c,l),l.vsub(n,h),h.normalize(),this.reportIntersection(h,l,i,r,-1);else{const e=(-u-Math.sqrt(c))/(2*a),t=(-u+Math.sqrt(c))/(2*a);if(e>=0&&e<=1&&(o.lerp(s,e,l),l.vsub(n,h),h.normalize(),this.reportIntersection(h,l,i,r,-1)),this.result.shouldStop)return;t>=0&&t<=1&&(o.lerp(s,t,l),l.vsub(n,h),h.normalize(),this.reportIntersection(h,l,i,r,-1))}}_intersectConvex(e,t,n,r,i,o){const s=FC,a=BC,u=o&&o.faceList||null,c=e.faces,l=e.vertices,h=e.faceNormals,d=this.direction,f=this.from,p=f.distanceTo(this.to),g=u?u.length:c.length,m=this.result;for(let y=0;!m.shouldStop&&y<g;y++){const e=u?u[y]:y,o=c[e],g=h[e],v=t,b=n;a.copy(l[o[0]]),v.vmult(a,a),a.vadd(b,a),a.vsub(f,a),v.vmult(g,s);const _=d.dot(s);if(Math.abs(_)<this.precision)continue;const w=s.dot(a)/_;if(!(w<0)){d.scale(w,OC),OC.vadd(f,OC),IC.copy(l[o[0]]),v.vmult(IC,IC),b.vadd(IC,IC);for(let t=1;!m.shouldStop&&t<o.length-1;t++){CC.copy(l[o[t]]),DC.copy(l[o[t+1]]),v.vmult(CC,CC),v.vmult(DC,DC),b.vadd(CC,CC),b.vadd(DC,DC);const n=OC.distanceTo(f);!wC.pointInTriangle(OC,IC,CC,DC)&&!wC.pointInTriangle(OC,CC,IC,DC)||n>p||this.reportIntersection(s,OC,i,r,e)}}}}_intersectTrimesh(e,t,n,r,i,o){const s=zC,a=WC,u=$C,c=BC,l=UC,h=VC,d=GC,f=qC,p=HC,g=e.indices,m=this.from,y=this.to,v=this.direction;u.position.copy(n),u.quaternion.copy(t),GI.vectorToLocalFrame(n,t,v,l),GI.pointToLocalFrame(n,t,m,h),GI.pointToLocalFrame(n,t,y,d),d.x*=e.scale.x,d.y*=e.scale.y,d.z*=e.scale.z,h.x*=e.scale.x,h.y*=e.scale.y,h.z*=e.scale.z,d.vsub(h,l),l.normalize();const b=h.distanceSquared(d);e.tree.rayQuery(this,u,a);for(let _=0,w=a.length;!this.result.shouldStop&&_!==w;_++){const o=a[_];e.getNormal(o,s),e.getVertex(g[3*o],IC),IC.vsub(h,c);const u=l.dot(s),d=s.dot(c)/u;if(d<0)continue;l.scale(d,OC),OC.vadd(h,OC),e.getVertex(g[3*o+1],CC),e.getVertex(g[3*o+2],DC);const m=OC.distanceSquared(h);!wC.pointInTriangle(OC,CC,IC,DC)&&!wC.pointInTriangle(OC,IC,CC,DC)||m>b||(GI.vectorToWorldFrame(t,s,p),GI.pointToWorldFrame(n,t,OC,f),this.reportIntersection(p,f,i,r,o))}a.length=0}reportIntersection(e,t,n,r,i){const o=this.from,s=this.to,a=o.distanceTo(t),u=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(u.hitFaceIndex=void 0!==i?i:-1,this.mode){case wC.ALL:this.hasHit=!0,u.set(o,s,e,t,n,r,a),u.hasHit=!0,this.callback(u);break;case wC.CLOSEST:(a<u.distance||!u.hasHit)&&(this.hasHit=!0,u.hasHit=!0,u.set(o,s,e,t,n,r,a));break;case wC.ANY:this.hasHit=!0,u.hasHit=!0,u.set(o,s,e,t,n,r,a),u.shouldStop=!0}}static pointInTriangle(e,t,n,r){r.vsub(t,XC),n.vsub(t,SC),e.vsub(t,AC);const i=XC.dot(XC),o=XC.dot(SC),s=XC.dot(AC),a=SC.dot(SC),u=SC.dot(AC);let c,l;return(c=a*s-o*u)>=0&&(l=i*u-o*s)>=0&&c+l<i*a-o*o}}wC.CLOSEST=1,wC.ANY=2,wC.ALL=4;const xC=new RI,EC=[],SC=new DI,AC=new DI,kC=new DI,TC=new FI,OC=new DI,IC=new DI,CC=new DI,DC=new DI,jC={faceList:[0]},PC=new DI,MC=new wC,RC=[],NC=new DI,LC=new DI,FC=new DI,BC=new DI,zC=new DI,UC=new DI,VC=new DI,GC=new DI,HC=new DI,qC=new DI;new RI;const WC=[],$C=new GI,XC=new DI,KC=new DI;let ZC,YC,QC,JC,eD,tD,nD,rD,iD,oD,sD,aD,uD,cD,lD,hD,dD,fD,pD,gD,mD,yD,vD,bD,_D;new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new wC,new DI,new DI,new DI(1,0,0),new DI(0,1,0),new DI(0,0,1),new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new RI,new DI,new RI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new RI,new DI,new GI,new RI;const wD={sphereSphere:VI.types.SPHERE,spherePlane:VI.types.SPHERE|VI.types.PLANE,boxBox:VI.types.BOX|VI.types.BOX,sphereBox:VI.types.SPHERE|VI.types.BOX,planeBox:VI.types.PLANE|VI.types.BOX,convexConvex:VI.types.CONVEXPOLYHEDRON,sphereConvex:VI.types.SPHERE|VI.types.CONVEXPOLYHEDRON,planeConvex:VI.types.PLANE|VI.types.CONVEXPOLYHEDRON,boxConvex:VI.types.BOX|VI.types.CONVEXPOLYHEDRON,sphereHeightfield:VI.types.SPHERE|VI.types.HEIGHTFIELD,boxHeightfield:VI.types.BOX|VI.types.HEIGHTFIELD,convexHeightfield:VI.types.CONVEXPOLYHEDRON|VI.types.HEIGHTFIELD,sphereParticle:VI.types.PARTICLE|VI.types.SPHERE,planeParticle:VI.types.PLANE|VI.types.PARTICLE,boxParticle:VI.types.BOX|VI.types.PARTICLE,convexParticle:VI.types.PARTICLE|VI.types.CONVEXPOLYHEDRON,cylinderCylinder:VI.types.CYLINDER,sphereCylinder:VI.types.SPHERE|VI.types.CYLINDER,planeCylinder:VI.types.PLANE|VI.types.CYLINDER,boxCylinder:VI.types.BOX|VI.types.CYLINDER,convexCylinder:VI.types.CONVEXPOLYHEDRON|VI.types.CYLINDER,heightfieldCylinder:VI.types.HEIGHTFIELD|VI.types.CYLINDER,particleCylinder:VI.types.PARTICLE|VI.types.CYLINDER,sphereTrimesh:VI.types.SPHERE|VI.types.TRIMESH,planeTrimesh:VI.types.PLANE|VI.types.TRIMESH};ZC=wD.sphereSphere,YC=wD.spherePlane,QC=wD.boxBox,JC=wD.sphereBox,eD=wD.planeBox,tD=wD.convexConvex,nD=wD.sphereConvex,rD=wD.planeConvex,iD=wD.boxConvex,oD=wD.sphereHeightfield,sD=wD.boxHeightfield,aD=wD.convexHeightfield,uD=wD.sphereParticle,cD=wD.planeParticle,lD=wD.boxParticle,hD=wD.convexParticle,dD=wD.cylinderCylinder,fD=wD.sphereCylinder,pD=wD.planeCylinder,gD=wD.boxCylinder,mD=wD.convexCylinder,yD=wD.heightfieldCylinder,vD=wD.particleCylinder,bD=wD.sphereTrimesh,_D=wD.planeTrimesh,new DI,new DI,new DI,new DI,new DI,new FI,new FI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new RI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new FI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new DI,new RI,new wC;const xD=globalThis.performance||{};if(!xD.now){let e=Date.now();xD.timing&&xD.timing.navigationStart&&(e=xD.timing.navigationStart),xD.now=()=>Date.now()-e}var ED=n(517);function SD(e,t,n){t||(t=new Qy(Qy.IDENTITY));const r=new Qy(Qy.IDENTITY);if(e.matrix)r.copy(e.matrix);else{if(r.identity(),e.translation&&r.translate(e.translation),e.rotation){const t=new Qy(Qy.IDENTITY).fromQuaternion(e.rotation);r.multiplyRight(t)}e.scale&&r.scale(e.scale)}const i=new Qy(t).multiplyRight(r);if(!1===n(e,i,t))return!1;for(const o of e.nodes||e.children||[])if(!1===SD(o,i,n))return!1;return!0}function AD(){ww([MT,dI])}function kD(e,t){const n=t.nodes.find(t=>t.name===e);if(n){let r=!1;for(const e of t.scenes)r||SD(e,new Qy(Qy.IDENTITY),(e,t)=>e!==n||(e.matrix=t,e.translation=void 0,e.rotation=void 0,e.scale=void 0,r=!0,!1));return t.scene={id:e,name:e,nodes:[n]},t.scenes=[t.scene],{scene:t.scene,scenes:t.scenes}}return t}function TD(e,t){return Sl(this,void 0,void 0,function*(){const n=e.scenegraph;let r;r=t?t[n]||(t[n]=fetch(n).then(e=>e.blob())):fetch(n);const i=yield Bw(r,dI,{DracoLoader:RT,gltf:{decompressMeshes:!0,postProcess:!0}});return kD(e.scenegraphNode,i)})}function OD(e,t){return Sl(this,void 0,void 0,function*(){return kD(e,yield t)})}function ID(e,t,n){return t&&0!==t.length?new jk(Object.assign({id:e,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Sh.CARTESIAN,data:t,mesh:new OI,wireframe:!1,getTransformMatrix:e=>e.transformMatrix,getColor:e=>e.color||[255,255,255,229.5]},n)):void 0}let CD=(()=>{class e extends tx{initializeState(){const{data:e}=this.props;this.setState({data:null!=e?e:[],zoomOpacity:.8,doCollisions:!1}),AD()}renderLayers(){const t=this.state,n=t.data.filter(e=>!e.scenegraph&&!e.wireframe&&e.unpickable),r=t.data.filter(e=>!e.scenegraph&&!e.wireframe&&!e.unpickable),i=t.data.filter(e=>!e.scenegraph&&e.wireframe),o=t.data.filter(e=>!!e.scenegraph);t.doCollisions&&function(e){Sl(this,void 0,void 0,function*(){console.log("Starting Collisioning");const t=e.filter(e=>!e.scenegraph&&!e.wireframe).map(e=>{const t=new Qy(e.transformMatrix),n=t.transformAsPoint([-1,-1,-1],[]),r=t.transformAsPoint([1,1,1],[]);return{"@id":e["@id"],name:e.tooltip,entityId:e.entityId,bbox:new RI({lowerBound:new DI(...n.map((e,t)=>Math.min(e,r[t]))),upperBound:new DI(...r.map((e,t)=>Math.max(e,n[t])))})}}),n=[];for(const s of e.filter(e=>!!e.scenegraph)){const e=yield Gw(s.scenegraph,dI,{DracoLoader:RT,decompress:!0,postProcess:!0});for(const t of e.scenes)SD(t,new Qy(s.transformMatrix),(t,r)=>{if(t.mesh&&t.mesh.primitives&&t.mesh.primitives.length>0)for(const i of t.mesh.primitives)if(i.attributes.POSITION&&i.attributes.POSITION.min){const o=r.transformAsPoint(i.attributes.POSITION.min,[]),a=r.transformAsPoint(i.attributes.POSITION.max,[]);n.push({"@id":s["@id"],name:t.name,entityId:s.entityId,bbox:new RI({lowerBound:new DI(...o.map((e,t)=>Math.min(e,a[t]))),upperBound:new DI(...a.map((e,t)=>Math.max(e,o[t])))}),gltf:e})}return!0})}const r=[],i=[];for(const e of t){const t=[];for(const r of n)e.bbox.overlaps(r.bbox)&&t.push({"@id":r["@id"],name:r.name});t.length>0?r.push({"@id":e.entityId,name:e.name,hits:t}):i.push(e)}console.log({sourceBoxes:t,targetBoxes:n,report:r,sad:i,maxHits:Math.max(...r.map(e=>e.hits.length))});const o=[];for(const e of r){o.push({"Tissue ID":e["@id"],"Tissue Name":e.name,"Hit ID":"","Hit Name":""});for(const t of e.hits)o.push({"Tissue ID":e["@id"],"Tissue Name":e.name,"Hit ID":t["@id"],"Hit Name":t.name})}return console.log(o),r})}(t.data);const s={};for(const a of o)a.scenegraph&&a.scenegraphNode&&!Object.prototype.hasOwnProperty.call(s,a.scenegraph)&&(s[a.scenegraph]=TD({scenegraph:a.scenegraph},e.gltfCache));return[ID("cubes",n,{wireframe:!1,pickable:!1}),ID("pickableCubes",r,{wireframe:!1,pickable:!0}),ID("wireframes",i,{wireframe:!0,pickable:!1}),...o.map(e=>{var n;return new xI({id:"models-"+e["@id"],opacity:e.zoomBasedOpacity?t.zoomOpacity:void 0!==e.opacity?e.opacity:1,pickable:!e.unpickable,coordinateSystem:Sh.CARTESIAN,data:[e],scenegraph:e.scenegraphNode?OD(e.scenegraphNode,s[e.scenegraph]):e.scenegraph,_lighting:e._lighting,getTransformMatrix:e.transformMatrix,getColor:null!==(n=e.color)&&void 0!==n?n:[0,255,0,127.5],parameters:{depthMask:!e.zoomBasedOpacity&&(void 0===e.opacity||1===e.opacity)}})})].filter(e=>!!e)}getPickingInfo(e){return e.info}}return e.layerName="BodyUILayer",e.gltfCache={},e})();function DD(e,t=[]){for(const n of e.nodes||e.children||[])t.push(n.name),DD(n,t);return t}let jD=(()=>{class e{constructor(e){var t,n,r,i,o;this.deckProps=e,this.bodyUILayer=new CD({}),this.nodeClickSubject=new T,this.nodeHoverStartSubject=new T,this.nodeHoverStopSubject=new T,this.sceneRotationSubject=new Al([0,0]),this.nodeDragStartSubject=new T,this.nodeDragSubject=new T,this.nodeDragEndSubject=new T,this.nodeClick$=this.nodeClickSubject.pipe(te()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(te()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(te()),this.sceneRotation$=this.sceneRotationSubject.pipe(te()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(te()),this.nodeDrag$=this.nodeDragSubject.pipe(te()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(te());const s=Object.assign(Object.assign({},e),{views:["orthographic"===e.camera?new Xx({flipY:!1,near:-1e3}):new tE({})],controller:void 0===e.interactive||e.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:e=>{var t;return null!==(t=this.cursor)&&void 0!==t?t:e.isDragging?"grabbing":"grab"}});e.legacyLighting&&(s.effects=[new ME({ambientLight:new iE({color:[255,255,255],intensity:10})})]),this.deck=new lk(s),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(t=e.minRotationX)&&void 0!==t?t:-15,maxRotationX:null!==(n=e.maxRotationX)&&void 0!==n?n:15,target:null!==(r=e.target)&&void 0!==r?r:[.5,.5,0],rotationX:0,rotationOrbit:null!==(i=e.rotation)&&void 0!==i?i:0,zoom:null!==(o=e.zoom)&&void 0!==o?o:9.5,camera:e.camera}}),e.rotation&&this.sceneRotationSubject.next([e.rotation,0])}initialize(){return Sl(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(e=>{setTimeout(e,200)})})}finalize(){this.deck.finalize()}setScene(e){if((null==e?void 0:e.length)>0){let t=this.bodyUILayer.state.zoomOpacity,n=!1;for(const r of e)r.zoomToOnLoad&&(this.zoomTo(r),n=!0);t=n?.05:t,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(e,t):this.bodyUILayer.setState({data:e,zoomOpacity:t})}}debugSceneNodeProcessing(e,t){const n="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",r=new Qy([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(e,t,n){return Sl(this,void 0,void 0,function*(){AD();const n=yield TD({scenegraph:e,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},i=[];for(const o of n.scenes)SD(o,t=new Qy(t||Qy.IDENTITY),(n,o)=>{const s={"@id":n.name||n.id,"@type":"ProcessedNode",transformMatrix:new Qy(o),wireframe:!0,node:n};if(i.push({"@id":`GLTF:${s["@id"]}`,"@type":"GLTFNode",scenegraph:e,scenegraphNode:s["@id"],transformMatrix:new Qy(t||Qy.IDENTITY),tooltip:n.name||n.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:n}),n.mesh&&n.mesh.primitives&&n.mesh.primitives.length>0)for(const e of n.mesh.primitives)if(e.attributes.POSITION&&e.attributes.POSITION.min){const t=o.transformAsPoint(e.attributes.POSITION.min,[]),n=o.transformAsPoint(e.attributes.POSITION.max,[]);s.bbox=new RI({lowerBound:new DI(...t.map((e,t)=>Math.min(e,n[t]))),upperBound:new DI(...n.map((e,n)=>Math.max(e,t[n])))})}return r[s["@id"]]=s,!0});for(const e of Object.values(r).filter(e=>!e.bbox)){for(const t of DD(e.node).map(e=>r[e]).filter(e=>e.bbox))e.bbox?e.bbox.extend(t.bbox):e.bbox=t.bbox.clone();e.bbox||delete r[e["@id"]]}for(const e of Object.values(r)){const t=e.bbox.lowerBound,n=(e.size=e.bbox.upperBound.clone().vsub(t)).clone().vmul(new DI(.5,.5,.5)),r=e.center=t.clone().vadd(n);e.transformMatrix=(new Qy).translate(r.toArray()).scale(n.toArray())}for(const e of i)r[e["@id"]]=e;return r})})(n,r).then(i=>{console.log("results",i),console.log("data",e),(e=e.concat(Object.values(i))).push({"@id":"TEST","@type":"TEST",scenegraph:n,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:r,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:e,zoomOpacity:t})})}zoomTo(e){const t=new Qy(e.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(e){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:e})})}setRotationX(e){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:e})})}setZoom(e){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:e})})}setTarget(e){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:e})})}setInteractive(e){this.deck.setProps({controller:e})}_onHover(e){const{lastHovered:t}=this;this.cursor=e.picked?"pointer":void 0,e.picked&&e.object&&e.object["@id"]?t!==e.object&&(t&&this.nodeHoverStopSubject.next(t),this.lastHovered=e.object,this.nodeHoverStartSubject.next(e.object)):t&&(this.nodeHoverStopSubject.next(t),this.lastHovered=void 0)}_onClick(e,t){var n,r;e.picked&&e.object&&e.object["@id"]&&this.nodeClickSubject.next({node:e.object,ctrlClick:null!==(r=null===(n=null==t?void 0:t.srcEvent)||void 0===n?void 0:n.ctrlKey)&&void 0!==r?r:void 0})}_onViewStateChange(e){var t;if(null===(t=e.interactionState)||void 0===t?void 0:t.isZooming){const t=this.bodyUILayer.state,n=Math.min(Math.max(1-(e.viewState.zoom-8.9)/2,.05),1);t.zoomOpacity!==n&&this.bodyUILayer.setState({data:t.data,zoomOpacity:n})}this.deck.setProps({viewState:Object.assign({},e.viewState)}),this.sceneRotationSubject.next([e.viewState.rotationOrbit,e.viewState.rotationX])}_onDragStart(e,t){this._dragEvent(e,t,this.nodeDragStartSubject)}_onDrag(e,t){this._dragEvent(e,t,this.nodeDragSubject)}_onDragEnd(e,t){this._dragEvent(e,t,this.nodeDragEndSubject)}_dragEvent(e,t,n){var r;(null===(r=null==e?void 0:e.object)||void 0===r?void 0:r["@id"])&&n.next({node:e.object,info:e,e:t})}}return El([ED.ZP],e.prototype,"_onHover",null),El([ED.ZP],e.prototype,"_onClick",null),El([ED.ZP],e.prototype,"_onViewStateChange",null),El([ED.ZP],e.prototype,"_onDragStart",null),El([ED.ZP],e.prototype,"_onDrag",null),El([ED.ZP],e.prototype,"_onDragEnd",null),e})();function PD(e,t){return e===t}function MD(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;const r=t.length;for(let i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}function RD(e,t=PD){let n=null,r=null;function i(){return MD(t,n,arguments)||(r=e.apply(null,arguments)),n=arguments,r}return i.reset=function(){n=null,r=null},i}const ND=RD(function(){const e=Uu();if(!e)return!1;const t=e.injector.get(wu,null);return!!t&&t.some(e=>(e&&e.providers||[]).some(e=>e&&e.provide&&"MockNgModuleResolver"===e.provide.name||!1))});let LD=(()=>{class e{constructor(){this.bootstrap$=new ll(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const FD=new Wn("INITIAL_STATE_TOKEN");let BD=(()=>{class e{static set(e){this.value=e}static pop(){const e=this.value;return this.value={},e}}return e.value={},e})();const zD=new Wn("Internals.StateContextFactory"),UD=new Wn("Internals.StateFactory");function VD(...e){if(1===e.length){const t=e[0];if(d(t))return GD(t,null);if(f(t)&&Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);return GD(e.map(e=>t[e]),e)}}if("function"==typeof e[e.length-1]){const t=e.pop();return GD(e=1===e.length&&d(e[0])?e[0]:e,null).pipe(C(e=>t(...e)))}return GD(e,null)}function GD(e,t){return new x(n=>{const r=e.length;if(0===r)return void n.complete();const i=new Array(r);let o=0,s=0;for(let a=0;a<r;a++){const u=B(e[a]);let c=!1;n.add(u.subscribe({next:e=>{c||(c=!0,s++),i[a]=e},error:e=>n.error(e),complete:()=>{o++,o!==r&&c||(s===r&&n.next(t?t.reduce((e,t,n)=>(e[t]=i[n],e),{}):i),n.complete())}}))}})}function HD(e,t,n){let r;return r=e&&"object"==typeof e?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n},e=>e.lift(function({bufferSize:e=Number.POSITIVE_INFINITY,windowTime:t=Number.POSITIVE_INFINITY,refCount:n,scheduler:r}){let i,o,s=0,a=!1,u=!1;return function(c){let l;s++,!i||a?(a=!1,i=new ll(e,t,r),l=i.subscribe(this),o=c.subscribe({next(e){i.next(e)},error(e){a=!0,i.error(e)},complete(){u=!0,o=void 0,i.complete()}}),u&&(o=void 0)):l=i.subscribe(this),this.add(()=>{s--,l.unsubscribe(),l=void 0,o&&!u&&n&&0===s&&(o.unsubscribe(),o=void 0,i=void 0)})}}(r))}function qD(e,t){return t?n=>n.pipe(qD((n,r)=>B(e(n,r)).pipe(C((e,i)=>t(n,e,r,i))))):t=>t.lift(new WD(e))}class WD{constructor(e){this.project=e}call(e,t){return t.subscribe(new $D(e,this.project))}}class $D extends U{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const n=this.index++;try{t=this.project(e,n)}catch(VR){return void this.destination.error(VR)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new z(this),n=this.destination;n.add(t);const r=V(e,t);r!==t&&n.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function XD(e){return t=>t.lift(new KD(e))}class KD{constructor(e){this.notifier=e}call(e,t){const n=new ZD(e),r=V(this.notifier,new z(n));return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n}}class ZD extends U{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function YD(e,t){return n=>n.lift(new QD(e,t))}class QD{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new JD(e,this.compare,this.keySelector))}}class JD extends v{constructor(e,t,n){super(e),this.keySelector=n,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:n}=this;t=n?n(e):e}catch(VR){return this.destination.error(VR)}let n=!1;if(this.hasKey)try{const{compare:e}=this;n=e(this.key,t)}catch(VR){return this.destination.error(VR)}else this.hasKey=!0;n||(this.key=t,this.destination.next(e))}}const ej={STATE_NAME:e=>`${e} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(e,t,n)=>`State name '${e}' from ${t} already exists in ${n}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:e=>`'${e}' class should be decorated with @Injectable() right after the @State() decorator`};let tj=(()=>{class e{constructor(e,t){this._ngZone=e,this._platformId=t,this.verifyZoneIsNotNooped(this._ngZone)}enter(e){return"server"===this._platformId?this.runInsideAngular(e):this.runOutsideAngular(e)}leave(e){return this.runInsideAngular(e)}runInsideAngular(e){return Su.isInAngularZone()?e():this._ngZone.run(e)}runOutsideAngular(e){return Su.isInAngularZone()?this._ngZone.runOutsideAngular(e):e()}verifyZoneIsNotNooped(e){e instanceof Su||console.warn(ej.ZONE_WARNING())}}return e.\u0275fac=function(t){return new(t||e)(ur(Su),ur(uu))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const nj=new Wn("ROOT_STATE_TOKEN"),rj=new Wn("FEATURE_STATE_TOKEN"),ij=new Wn("NGXS_PLUGINS"),oj=new Wn("NG_TEST_MODE"),sj=new Wn("NG_DEV_MODE");let aj=(()=>{class e{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=tj}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class uj{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}}const cj=new Wn("NGXS_EXECUTION_STRATEGY");function lj(e){return e.constructor&&e.constructor.type?e.constructor.type:e.type}const hj=(e,t,n)=>{e=Object.assign({},e);const r=t.split("."),i=r.length-1;return r.reduce((e,t,r)=>(e[t]=r===i?n:Array.isArray(e[t])?e[t].slice():Object.assign({},e[t]),e&&e[t]),e),e},dj=(e,t)=>t.split(".").reduce((e,t)=>e&&e[t],e),fj=e=>e&&"object"==typeof e&&!Array.isArray(e),pj=(e,...t)=>{if(!t.length)return e;const n=t.shift();if(fj(e)&&fj(n))for(const r in n)fj(n[r])?(e[r]||Object.assign(e,{[r]:{}}),pj(e[r],n[r])):Object.assign(e,{[r]:n[r]});return pj(e,...t)};function gj(e){return e.NGXS_META}function mj(e,t){const n=dj(t.currentAppState,e.path),r=dj(t.newAppState,e.path);return new uj(n,r,!e.isInitialised)}function yj(...e){return function(e,t,n=vj){const r=e.reduce((e,t)=>(e[lj(t)]=!0,e),{}),i=t&&function(e){return e.reduce((e,t)=>(e[t]=!0,e),{})}(t);return function(e){return e.pipe(function(e,t){return Cl(n=>{const r=lj(n.action);return e[r]&&(!t||t[n.status])})}(r,i),n())}}(e,["DISPATCHED"])}function vj(){return C(e=>e.action)}function bj(e){return t=>new x(n=>t.subscribe({next(t){e.leave(()=>n.next(t))},error(t){e.leave(()=>n.error(t))},complete(){e.leave(()=>n.complete())}}))}let _j=(()=>{class e{constructor(e){this._executionStrategy=e}enter(e){return this._executionStrategy.enter(e)}leave(e){return this._executionStrategy.leave(e)}}return e.\u0275fac=function(t){return new(t||e)(ur(cj))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class wj extends T{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const e=this._itemQueue.pop();super.next(e)}this._busyPushingNext=!1}}}let xj=(()=>{class e extends wj{}return e.\u0275fac=function(){let t;return function(n){return(t||(t=Vn(e)))(n||e)}}(),e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Ej=(()=>{class e extends x{constructor(e,t){super(n=>{const r=e.pipe(bj(t)).subscribe({next:e=>n.next(e),error:e=>n.error(e),complete:()=>n.complete()});n.add(r)})}}return e.\u0275fac=function(t){return new(t||e)(ur(xj),ur(_j))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const Sj=e=>(...t)=>e.shift()(...t,(...t)=>Sj(e)(...t));let Aj=(()=>{class e extends Al{constructor(){super({})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),kj=(()=>{class e{constructor(e,t){this._parentManager=e,this._pluginHandlers=t,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const e=this.getPluginHandlers();this.rootPlugins.push(...e)}getPluginHandlers(){return(this._pluginHandlers||[]).map(e=>e.handle?e.handle.bind(e):e)}}return e.\u0275fac=function(t){return new(t||e)(ur(e,12),ur(ij,8))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Tj=(()=>{class e extends T{}return e.\u0275fac=function(){let t;return function(n){return(t||(t=Vn(e)))(n||e)}}(),e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Oj=(()=>{class e{constructor(e,t,n,r,i,o){this._injector=e,this._actions=t,this._actionResults=n,this._pluginManager=r,this._stateStream=i,this._ngxsExecutionStrategy=o}dispatch(e){const t=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(e));return t.subscribe({error:e=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(_r),this._errorHandler.handleError(e)}catch(t){}})}),t.pipe(bj(this._ngxsExecutionStrategy))}dispatchByEvents(e){return Array.isArray(e)?0===e.length?il(this._stateStream.getValue()):VD(e.map(e=>this.dispatchSingle(e))):this.dispatchSingle(e)}dispatchSingle(e){if(!lj(e))return ol(new Error(`This action doesn't have a type property: ${e.constructor.name}`));const t=this._stateStream.getValue();return Sj([...this._pluginManager.plugins,(e,n)=>{e!==t&&this._stateStream.next(e);const r=this.getActionResultStream(n);return r.subscribe(e=>this._actions.next(e)),this._actions.next({action:n,status:"DISPATCHED"}),this.createDispatchObservable(r)}])(t,e).pipe(HD())}getActionResultStream(e){return this._actionResults.pipe(Cl(t=>t.action===e&&"DISPATCHED"!==t.status),Tl(1),HD())}createDispatchObservable(e){return e.pipe(qD(e=>{switch(e.status){case"SUCCESSFUL":return il(this._stateStream.getValue());case"ERRORED":return ol(e.error);default:return nl}})).pipe(HD())}}return e.\u0275fac=function(t){return new(t||e)(ur(bo),ur(xj),ur(Tj),ur(kj),ur(Aj),ur(_j))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const Ij=e=>{Object.freeze(e);const t="function"==typeof e,n=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(e).forEach(function(r){!n.call(e,r)||t&&("caller"===r||"callee"===r||"arguments"===r)||null===e[r]||"object"!=typeof e[r]&&"function"!=typeof e[r]||Object.isFrozen(e[r])||Ij(e[r])}),e};let Cj=(()=>{class e{constructor(e,t){this.isDevMode=e,this.isTestMode=t}}return e.\u0275fac=function(t){return new(t||e)(ur(sj),ur(oj))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Dj=(()=>{class e{constructor(e,t){this._host=e,this._config=t}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(ej.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(ej.INCORRECT_DEVELOPMENT()))}}return e.\u0275fac=function(t){return new(t||e)(ur(Cj),ur(aj))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),jj=(()=>{class e{constructor(e,t,n,r){this._stateStream=e,this._dispatcher=t,this._config=n,r.verifyDevMode()}getRootStateOperations(){const e={getState:()=>this._stateStream.getValue(),setState:e=>this._stateStream.next(e),dispatch:e=>this._dispatcher.dispatch(e)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(e):e}ensureStateAndActionsAreImmutable(e){return{getState:()=>e.getState(),setState:t=>{const n=Ij(t);return e.setState(n)},dispatch:t=>e.dispatch(t)}}setStateToTheCurrentWithNew(e){const t=this.getRootStateOperations(),n=t.getState();t.setState(Object.assign({},n,e.defaults))}}return e.\u0275fac=function(t){return new(t||e)(ur(Aj),ur(Oj),ur(aj),ur(Dj))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Pj=(()=>{class e{constructor(e){this._internalStateOperations=e}createStateContext(e){const t=this._internalStateOperations.getRootStateOperations();function n(t){return dj(t,e.path)}function r(n,r){const i=hj(n,e.path,r),o=e.instance;if(o.ngxsOnChanges){const t=mj(e,{currentAppState:n,newAppState:i});o.ngxsOnChanges(t)}return t.setState(i),i}function i(e,t){return r(e,t(n(e)))}return{getState:()=>n(t.getState()),patchState:e=>i(t.getState(),function(e){return t=>{if(Array.isArray(e))throw new Error(ej.PATCHING_ARRAY());if("object"!=typeof e)throw new Error(ej.PATCHING_PRIMITIVE());const n=Object.assign({},t);for(const r in e)n[r]=e[r];return n}}(e)),setState(e){const n=t.getState();return"function"==typeof e?i(n,e):r(n,e)},dispatch:e=>t.dispatch(e)}}}return e.\u0275fac=function(t){return new(t||e)(ur(jj))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class Mj{static stateNameErrorMessage(e){return ej.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(ej.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const n=this.getValidStateMeta(e).name,r=t[n];if(r&&r!==e)throw new Error(ej.STATE_UNIQUE(n,e.name,r.name));return n}static getValidStateMeta(e){const t=gj(e);if(!t)throw new Error(ej.STATE_DECORATOR());return t}}Mj.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let Rj=(()=>{class e{constructor(e,t,n,r,i,o,s){this._injector=e,this._config=t,this._parentFactory=n,this._actions=r,this._actionResults=i,this._stateContextFactory=o,this._initialState=s,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=RD(()=>{const e=this;function t(t){const n=e.statePaths[t];return n?function(e,t){return t&&t.compatibility&&t.compatibility.strictContentSecurityPolicy?function(e){const t=e.slice();return e=>t.reduce((e,t)=>e&&e[t],e)}(e):function(e){const t=e;let n="store."+t[0],r=0;const i=t.length;let o=n;for(;++r<i;)o=o+" && "+(n=n+"."+t[r]);return new Function("store","return "+o+";")}(e)}(n.split("."),e._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(e){let n=t(e);return n||((...r)=>(n||(n=t(e)),n?n(...r):void 0))},getSelectorOptions:t=>Object.assign({},e._config.selectorOptions,t||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(e){let t={};var n;return t=Array.isArray(e)?e.slice():"object"==typeof(n=e)&&null!==n||"function"==typeof n?Object.assign({},e):void 0===e?{}:e,t}static checkStatesAreValid(e){e.forEach(Mj.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){e.checkStatesAreValid(t);const{newStates:n}=this.addToStatesMap(t);if(!n.length)return[];const r=function(e){const t=t=>{const n=e.find(e=>e===t);if(!n)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return n.NGXS_META.name};return e.reduce((e,n)=>{const{name:r,children:i}=n.NGXS_META;return e[r]=(i||[]).map(t),e},{})}(n),i=function(e){const t=[],n={},r=(i,o=[])=>{Array.isArray(o)||(o=[]),o.push(i),n[i]=!0,e[i].forEach(e=>{if(o.indexOf(e)>=0)throw new Error(`Circular dependency '${e}' is required by '${i}': ${o.join(" -> ")}`);n[e]||r(e,o.slice(0))}),t.indexOf(i)<0&&t.push(i)};return Object.keys(e).forEach(e=>r(e)),t.reverse()}(r),o=function(e,t={}){const n=(e,t)=>{for(const r in e)if(e.hasOwnProperty(r)&&e[r].indexOf(t)>=0){const t=n(e,r);return null!==t?`${t}.${r}`:r}return null};for(const r in e)if(e.hasOwnProperty(r)){const i=n(e,r);t[r]=i?`${i}.${r}`:r}return t}(r),s=n.reduce((e,t)=>(e[t.NGXS_META.name]=t,e),{}),a=[];for(const u of i){const t=s[u],n=o[u],r=t.NGXS_META;this.addRuntimeInfoToMeta(r,n);const i={name:u,path:n,isInitialised:!1,actions:r.actions,instance:this._injector.get(t),defaults:e.cloneDefaults(r.defaults)};this.hasBeenMountedAndBootstrapped(u,n)||a.push(i),this.states.push(i)}return a}addAndReturnDefaults(e){const t=this.add(e||[]);return{defaults:t.reduce((e,t)=>hj(e,t.path,t.defaults),{}),states:t}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(Cl(e=>"DISPATCHED"===e.status),G(({action:e})=>this.invokeActions(this._actions,e).pipe(C(()=>({action:e,status:"SUCCESSFUL"})),Nl({action:e,status:"CANCELED"}),Pl(t=>il({action:e,status:"ERRORED",error:t}))))).subscribe(e=>this._actionResults.next(e)))}invokeActions(e,t){const n=lj(t),r=[];for(const o of this.states){const s=o.actions[n];if(s)for(const n of s){const s=this._stateContextFactory.createStateContext(o);try{let i=o.instance[n.fn](s,t);i instanceof Promise&&(i=B(i)),i instanceof x?(i=i.pipe(Nl({})),n.options.cancelUncompleted&&(i=i.pipe(XD(e.pipe(yj(t)))))):i=il({}).pipe(HD()),r.push(i)}catch(i){r.push(ol(i))}}}return r.length||r.push(il({})),VD(r)}addToStatesMap(e){const t=[],n=this.statesByName;for(const r of e){const e=Mj.checkStateNameIsUnique(r,n);!n[e]&&(t.push(r),n[e]=r)}return{newStates:t}}addRuntimeInfoToMeta(e,t){this.statePaths[e.name]=t,e.path=t}hasBeenMountedAndBootstrapped(e,t){const n=void 0!==dj(this._initialState,t);return this.statesByName[e]&&n}}return e.\u0275fac=function(t){return new(t||e)(ur(bo),ur(aj),ur(e,12),ur(xj),ur(Tj),ur(Pj),ur(FD,8))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Nj=(()=>{class e{constructor(e,t,n){this.internalStateOperations=e,this.stateContextFactory=t,this.bootstrapper=n}ngxsBootstrap(e,t){var n;this.internalStateOperations.getRootStateOperations().dispatch(e).pipe(Cl(()=>!!t),(n=()=>this.invokeInit(t.states),function(e){return e.lift(new zl(n,undefined,undefined))}),G(()=>this.bootstrapper.appBootstrapped$),Cl(e=>!!e)).subscribe(()=>this.invokeBootstrap(t.states))}invokeInit(e){for(const t of e){const e=t.instance;if(e.ngxsOnChanges){const n=mj(t,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});e.ngxsOnChanges(n)}e.ngxsOnInit&&e.ngxsOnInit(this.getStateContext(t)),t.isInitialised=!0}}invokeBootstrap(e){for(const t of e){const e=t.instance;e.ngxsAfterBootstrap&&e.ngxsAfterBootstrap(this.getStateContext(t))}}getStateContext(e){return this.stateContextFactory.createStateContext(e)}}return e.\u0275fac=function(t){return new(t||e)(ur(jj),ur(Pj),ur(LD))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Lj=(()=>{class e{constructor(e,t,n,r,i,o){this._stateStream=e,this._internalStateOperations=t,this._config=n,this._internalExecutionStrategy=r,this._stateFactory=i,this.initStateStream(o)}dispatch(e){return this._internalStateOperations.getRootStateOperations().dispatch(e)}select(e){const t=this.getStoreBoundSelectorFn(e);return this._stateStream.pipe(C(t),Pl(e=>{const{suppressErrors:t}=this._config.selectorOptions;return e instanceof TypeError&&t?il(void 0):ol(e)}),YD(),bj(this._internalExecutionStrategy))}selectOnce(e){return this.select(e).pipe(Tl(1))}selectSnapshot(e){return this.getStoreBoundSelectorFn(e)(this._stateStream.getValue())}subscribe(e){return this._stateStream.pipe(bj(this._internalExecutionStrategy)).subscribe(e)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(e){return this._internalStateOperations.getRootStateOperations().setState(e)}getStoreBoundSelectorFn(e){return function(e){const t=e.NGXS_SELECTOR_META||gj(e);return t&&t.makeRootSelector||(()=>e)}(e)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(e){const t=this._stateStream.value;if(!t||0===Object.keys(t).length){const t=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,e):e;this._stateStream.next(t)}}}return e.\u0275fac=function(t){return new(t||e)(ur(Aj),ur(jj),ur(aj),ur(_j),ur(Rj),ur(FD,8))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Fj=(()=>{class e{constructor(t,n){e.store=t,e.config=n}ngOnDestroy(){e.store=null,e.config=null}}return e.\u0275fac=function(t){return new(t||e)(ur(Lj),ur(aj))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e.store=null,e.config=null,e})();class Bj{static get type(){return"@@INIT"}}class zj{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const Uj=new ll(1);let Vj=(()=>{class e{constructor(e,t,n,r,i=[],o){!function(){try{const e=window.ng,t=!(e.probe&&e.coreTokens)&&Fu();Uj.next(t)}catch(e){Uj.next(!1)}finally{Uj.complete()}}();const s=e.addAndReturnDefaults(i);t.setStateToTheCurrentWithNew(s),e.connectActionHandlers(),o.ngxsBootstrap(new Bj,s)}}return e.\u0275fac=function(t){return new(t||e)(ur(Rj),ur(jj),ur(Lj),ur(Fj),ur(nj,8),ur(Nj))},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({}),e})(),Gj=(()=>{class e{constructor(t,n,r,i=[],o){const s=e.flattenStates(i),a=r.addAndReturnDefaults(s);a.states.length&&(n.setStateToTheCurrentWithNew(a),o.ngxsBootstrap(new zj(a.defaults),a))}static flattenStates(e=[]){return e.reduce((e,t)=>e.concat(t),[])}}return e.\u0275fac=function(t){return new(t||e)(ur(Lj),ur(jj),ur(Rj),ur(rj,8),ur(Nj))},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({}),e})();class Hj{static forRoot(e=[],t={}){return{ngModule:Vj,providers:[Rj,Pj,Ej,xj,LD,Dj,Cj,Nj,Oj,Tj,jj,_j,Lj,Aj,Fj,kj,...e,...Hj.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:Gj,providers:[Rj,kj,...e,{provide:rj,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:oj,useValue:ND},{provide:sj,useValue:Fu},{provide:cj,useClass:t.executionStrategy||tj},{provide:nj,useValue:e},{provide:Hj.ROOT_OPTIONS,useValue:t},{provide:aj,useFactory:Hj.ngxsConfigFactory,deps:[Hj.ROOT_OPTIONS]},{provide:cu,useFactory:Hj.appBootstrapListenerFactory,multi:!0,deps:[LD]},{provide:FD,useFactory:Hj.getInitialState},{provide:zD,useExisting:Pj},{provide:UD,useExisting:Rj}]}static ngxsConfigFactory(e){return pj(new aj,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return BD.pop()}}Hj.\u0275fac=function(e){return new(e||Hj)},Hj.\u0275mod=Ke({type:Hj}),Hj.\u0275inj=ge({}),Hj.ROOT_OPTIONS=new Wn("ROOT_OPTIONS");const qj=new Wn("NgValueAccessor"),Wj=new el(Qc);class $j{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new Xj(e,this.dueTime,this.scheduler))}}class Xj extends v{constructor(e,t,n){super(e),this.dueTime=t,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Kj,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function Kj(e){e.debouncedNext()}function Zj(e){return null!=e&&"false"!=`${e}`}function Yj(e,t=0){return function(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):t}function Qj(e){return e instanceof Bs?e.nativeElement:e}let Jj;try{Jj="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(GR){Jj=!1}let eP,tP,nP=(()=>{class e{constructor(e){this._platformId=e,this.isBrowser=this._platformId?_c(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!Jj)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return e.\u0275fac=function(t){return new(t||e)(ur(uu))},e.\u0275prov=pe({factory:function(){return new e(ur(uu))},token:e,providedIn:"root"}),e})(),rP=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({}),e})();function iP(e){return function(){if(null==eP&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>eP=!0}))}finally{eP=eP||!1}return eP}()?e:!!e.capture}function oP(e){return e.composedPath?e.composedPath()[0]:e.target}let sP=(()=>{class e{create(e){return"undefined"==typeof MutationObserver?null:new MutationObserver(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({factory:function(){return new e},token:e,providedIn:"root"}),e})(),aP=(()=>{class e{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,t)=>this._cleanupObserver(t))}observe(e){const t=Qj(e);return new x(e=>{const n=this._observeElement(t).subscribe(e);return()=>{n.unsubscribe(),this._unobserveElement(t)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const t=new T,n=this._mutationObserverFactory.create(e=>t.next(e));n&&n.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:n,stream:t,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:t,stream:n}=this._observedElements.get(e);t&&t.disconnect(),n.complete(),this._observedElements.delete(e)}}}return e.\u0275fac=function(t){return new(t||e)(ur(sP))},e.\u0275prov=pe({factory:function(){return new e(ur(sP))},token:e,providedIn:"root"}),e})(),uP=(()=>{class e{constructor(e,t,n){this._contentObserver=e,this._elementRef=t,this._ngZone=n,this.event=new za,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(e){this._disabled=Zj(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=Yj(e),this._subscribe()}ngAfterContentInit(){this._currentSubscription||this.disabled||this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(function(e,t=Wj){return n=>n.lift(new $j(e,t))}(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){var e;null===(e=this._currentSubscription)||void 0===e||e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(No(aP),No(Bs),No(Su))},e.\u0275dir=Ye({type:e,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),e})(),cP=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({providers:[sP]}),e})();function lP(e){return 0===e.offsetX&&0===e.offsetY}function hP(e){const t=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}"undefined"!=typeof Element&&Element;const dP=new Wn("cdk-input-modality-detector-options"),fP={ignoreKeys:[18,17,224,91,16]},pP=iP({passive:!0,capture:!0});let gP=(()=>{class e{constructor(e,t,n,r){this._platform=e,this._mostRecentTarget=null,this._modality=new Al(null),this._lastTouchMs=0,this._onKeydown=e=>{var t,n;(null===(n=null===(t=this._options)||void 0===t?void 0:t.ignoreKeys)||void 0===n?void 0:n.some(t=>t===e.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=oP(e))},this._onMousedown=e=>{Date.now()-this._lastTouchMs<650||(this._modality.next(lP(e)?"keyboard":"mouse"),this._mostRecentTarget=oP(e))},this._onTouchstart=e=>{hP(e)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=oP(e))},this._options=Object.assign(Object.assign({},fP),r),this.modalityDetected=this._modality.pipe(e=>e.lift(new Vl(1))),this.modalityChanged=this.modalityDetected.pipe(YD()),e.isBrowser&&t.runOutsideAngular(()=>{n.addEventListener("keydown",this._onKeydown,pP),n.addEventListener("mousedown",this._onMousedown,pP),n.addEventListener("touchstart",this._onTouchstart,pP)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,pP),document.removeEventListener("mousedown",this._onMousedown,pP),document.removeEventListener("touchstart",this._onTouchstart,pP))}}return e.\u0275fac=function(t){return new(t||e)(ur(nP),ur(Su),ur(Yu),ur(dP,8))},e.\u0275prov=pe({factory:function(){return new e(ur(nP),ur(Su),ur(Yu),ur(dP,8))},token:e,providedIn:"root"}),e})();const mP=new Wn("cdk-focus-monitor-default-options"),yP=iP({passive:!0,capture:!0});let vP=(()=>{class e{constructor(e,t,n,r,i){this._ngZone=e,this._platform=t,this._inputModalityDetector=n,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new T,this._rootNodeFocusAndBlurListener=e=>{const t=oP(e),n="focus"===e.type?this._onFocus:this._onBlur;for(let r=t;r;r=r.parentElement)n.call(this,e,r)},this._document=r,this._detectionMode=(null==i?void 0:i.detectionMode)||0}monitor(e,t=!1){const n=Qj(e);if(!this._platform.isBrowser||1!==n.nodeType)return il(null);const r=function(e){if(function(){if(null==tP){const e="undefined"!=typeof document?document.head:null;tP=!(!e||!e.createShadowRoot&&!e.attachShadow)}return tP}()){const t=e.getRootNode?e.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(n)||this._getDocument(),i=this._elementInfo.get(n);if(i)return t&&(i.checkChildren=!0),i.subject;const o={checkChildren:t,subject:new T,rootNode:r};return this._elementInfo.set(n,o),this._registerGlobalListeners(o),o.subject}stopMonitoring(e){const t=Qj(e),n=this._elementInfo.get(t);n&&(n.subject.complete(),this._setClasses(t),this._elementInfo.delete(t),this._removeGlobalListeners(n))}focusVia(e,t,n){const r=Qj(e);r===this._getDocument().activeElement?this._getClosestElementsInfo(r).forEach(([e,n])=>this._originChanged(e,t,n)):(this._setOrigin(t),"function"==typeof r.focus&&r.focus(n))}ngOnDestroy(){this._elementInfo.forEach((e,t)=>this.stopMonitoring(t))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(e,t,n){n?e.classList.add(t):e.classList.remove(t)}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!(null==e?void 0:e.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(e,t){this._toggleClass(e,"cdk-focused",!!t),this._toggleClass(e,"cdk-touch-focused","touch"===t),this._toggleClass(e,"cdk-keyboard-focused","keyboard"===t),this._toggleClass(e,"cdk-mouse-focused","mouse"===t),this._toggleClass(e,"cdk-program-focused","program"===t)}_setOrigin(e,t=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&t,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,t){const n=this._elementInfo.get(t),r=oP(e);n&&(n.checkChildren||t===r)&&this._originChanged(t,this._getFocusOrigin(r),n)}_onBlur(e,t){const n=this._elementInfo.get(t);!n||n.checkChildren&&e.relatedTarget instanceof Node&&t.contains(e.relatedTarget)||(this._setClasses(t),this._emitOrigin(n.subject,null))}_emitOrigin(e,t){this._ngZone.run(()=>e.next(t))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const t=e.rootNode,n=this._rootNodeFocusListenerCount.get(t)||0;n||this._ngZone.runOutsideAngular(()=>{t.addEventListener("focus",this._rootNodeFocusAndBlurListener,yP),t.addEventListener("blur",this._rootNodeFocusAndBlurListener,yP)}),this._rootNodeFocusListenerCount.set(t,n+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(XD(this._stopInputModalityDetector)).subscribe(e=>{this._setOrigin(e,!0)}))}_removeGlobalListeners(e){const t=e.rootNode;if(this._rootNodeFocusListenerCount.has(t)){const e=this._rootNodeFocusListenerCount.get(t);e>1?this._rootNodeFocusListenerCount.set(t,e-1):(t.removeEventListener("focus",this._rootNodeFocusAndBlurListener,yP),t.removeEventListener("blur",this._rootNodeFocusAndBlurListener,yP),this._rootNodeFocusListenerCount.delete(t))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,t,n){this._setClasses(e,t),this._emitOrigin(n.subject,t),this._lastFocusOrigin=t}_getClosestElementsInfo(e){const t=[];return this._elementInfo.forEach((n,r)=>{(r===e||n.checkChildren&&r.contains(e))&&t.push([r,n])}),t}}return e.\u0275fac=function(t){return new(t||e)(ur(Su),ur(nP),ur(gP),ur(Yu,8),ur(mP,8))},e.\u0275prov=pe({factory:function(){return new e(ur(Su),ur(nP),ur(gP),ur(Yu,8),ur(mP,8))},token:e,providedIn:"root"}),e})();const bP="cdk-high-contrast-black-on-white",_P="cdk-high-contrast-white-on-black",wP="cdk-high-contrast-active";let xP=(()=>{class e{constructor(e,t){this._platform=e,this._document=t}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const t=this._document.defaultView||window,n=t&&t.getComputedStyle?t.getComputedStyle(e):null,r=(n&&n.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(e),r){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(wP),e.remove(bP),e.remove(_P),this._hasCheckedHighContrastMode=!0;const t=this.getHighContrastMode();1===t?(e.add(wP),e.add(bP)):2===t&&(e.add(wP),e.add(_P))}}}return e.\u0275fac=function(t){return new(t||e)(ur(nP),ur(Yu))},e.\u0275prov=pe({factory:function(){return new e(ur(nP),ur(Yu))},token:e,providedIn:"root"}),e})(),EP=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({}),e})();const SP=new Gs("12.1.3");function AP(){return"undefined"!=typeof window&&void 0!==window.document}function kP(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let TP=(e,t)=>!1,OP=(e,t)=>!1,IP=(e,t,n)=>[];const CP=kP();(CP||"undefined"!=typeof Element)&&(TP=AP()?(e,t)=>{for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:(e,t)=>e.contains(t),OP=(()=>{if(CP||Element.prototype.matches)return(e,t)=>e.matches(t);{const e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?(e,n)=>t.apply(e,[n]):OP}})(),IP=(e,t,n)=>{let r=[];if(n){const n=e.querySelectorAll(t);for(let e=0;e<n.length;e++)r.push(n[e])}else{const n=e.querySelector(t);n&&r.push(n)}return r});function DP(e,t,n){return n?t+":"+n+";":""}function jP(e){let t="";for(let n=0;n<e.style.length;n++){const r=e.style.item(n);t+=DP(0,r,e.style.getPropertyValue(r))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=DP(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[n]));e.setAttribute("style",t)}function PP(e,t,n){e.style&&(Object.keys(t).forEach(r=>{const i=NP(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),kP()&&jP(e))}function MP(e,t){e.style&&(Object.keys(t).forEach(t=>{const n=NP(t);e.style[n]=""}),kP()&&jP(e))}const RP=/-+([a-z0-9])/g;function NP(e){return e.replace(RP,(...e)=>e[1].toUpperCase())}class LP{constructor(e,t,n){this._element=e,this._startStyles=t,this._endStyles=n,this._state=0;let r=LP.initialStylesByElement.get(e);r||LP.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&PP(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(PP(this._element,this._initialStyles),this._endStyles&&(PP(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(LP.initialStylesByElement.delete(this._element),this._startStyles&&(MP(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(MP(this._element,this._endStyles),this._endStyles=null),PP(this._element,this._initialStyles),this._state=3)}}LP.initialStylesByElement=new WeakMap;const FP=new Wn("AnimationModuleType"),BP=new Gs("12.1.3"),zP=new Wn("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let UP,VP=(()=>{class e{constructor(e,t,n){this._hasDoneGlobalChecks=!1,this._document=n,e._applyBodyHighContrastModeCssClasses(),this._sanityChecks=t,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const e=this._document.defaultView||window;return"object"==typeof e&&e?e:null}_checksAreEnabled(){return Fu()&&!this._isTestEnv()}_isTestEnv(){const e=this._getWindow();return e&&(e.__karma__||e.jasmine)}_checkDoctypeIsDefined(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype)&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme||!this._document.body||"function"!=typeof getComputedStyle)return;const e=this._document.createElement("div");e.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(e);const t=getComputedStyle(e);t&&"none"!==t.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(e)}_checkCdkVersionMatch(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&BP.full!==SP.full&&console.warn("The Angular Material version ("+BP.full+") does not match the Angular CDK version ("+SP.full+").\nPlease ensure the versions of these two packages exactly match.")}}return e.\u0275fac=function(t){return new(t||e)(ur(xP),ur(zP,8),ur(Yu))},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[EP],EP]}),e})();function GP(e){return class extends e{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=Zj(e)}}}function HP(e,t){return class extends e{constructor(...e){super(...e),this.defaultColor=t,this.color=t}get color(){return this._color}set color(e){const t=e||this.defaultColor;t!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),t&&this._elementRef.nativeElement.classList.add(`mat-${t}`),this._color=t)}}}function qP(e){return class extends e{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Zj(e)}}}function WP(e,t=0){return class extends e{constructor(...e){super(...e),this._tabIndex=t,this.defaultTabIndex=t}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?Yj(e):this.defaultTabIndex}}}try{UP="undefined"!=typeof Intl}catch(GR){UP=!1}class $P{constructor(e,t,n){this._renderer=e,this.element=t,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const XP={enterDuration:225,exitDuration:150},KP=iP({passive:!0}),ZP=["mousedown","touchstart"],YP=["mouseup","mouseleave","touchend","touchcancel"];class QP{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Qj(n))}fadeInRipple(e,t,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=Object.assign(Object.assign({},XP),n.animation);n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=n.radius||function(e,t,n){const r=Math.max(Math.abs(e-n.left),Math.abs(e-n.right)),i=Math.max(Math.abs(t-n.top),Math.abs(t-n.bottom));return Math.sqrt(r*r+i*i)}(e,t,r),s=e-r.left,a=t-r.top,u=i.enterDuration,c=document.createElement("div");c.classList.add("mat-ripple-element"),c.style.left=s-o+"px",c.style.top=a-o+"px",c.style.height=2*o+"px",c.style.width=2*o+"px",null!=n.color&&(c.style.backgroundColor=n.color),c.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(c),window.getComputedStyle(c).getPropertyValue("opacity"),c.style.transform="scale(1)";const l=new $P(this,c,n);return l.state=0,this._activeRipples.add(l),n.persistent||(this._mostRecentTransientRipple=l),this._runTimeoutOutsideZone(()=>{const e=l===this._mostRecentTransientRipple;l.state=1,n.persistent||e&&this._isPointerDown||l.fadeOut()},u),l}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const n=e.element,r=Object.assign(Object.assign({},XP),e.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,n.parentNode.removeChild(n)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Qj(e);t&&t!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(ZP))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(YP),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=lP(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||t||n||(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!hP(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let e=0;e<t.length;e++)this.fadeInRipple(t[e].clientX,t[e].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(e=>{this._triggerElement.addEventListener(e,this,KP)})})}_removeTriggerEvents(){this._triggerElement&&(ZP.forEach(e=>{this._triggerElement.removeEventListener(e,this,KP)}),this._pointerUpEventsRegistered&&YP.forEach(e=>{this._triggerElement.removeEventListener(e,this,KP)}))}}const JP=new Wn("mat-ripple-global-options");let eM=(()=>{class e{constructor(e,t,n,r,i){this._elementRef=e,this._animationMode=i,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new QP(this,t,e,n)}get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,t=0,n){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,t,Object.assign(Object.assign({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),e))}}return e.\u0275fac=function(t){return new(t||e)(No(Bs),No(Su),No(nP),No(JP,8),No(FP,8))},e.\u0275dir=Ye({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,t){2&e&&ns("mat-ripple-unbounded",t.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),e})(),tM=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[VP,rP],VP]}),e})();new class extends el{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let n,r=-1,i=t.length;e=e||t.shift();do{if(n=e.execute(e.state,e.delay))break}while(++r<i&&(e=t.shift()));if(this.active=!1,n){for(;++r<i&&(e=t.shift());)e.unsubscribe();throw n}}}(class extends Qc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(e,t,n);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let nM=1;const rM=Promise.resolve(),iM={};function oM(e){return e in iM&&(delete iM[e],!0)}const sM={setImmediate(e){const t=nM++;return iM[t]=!0,rM.then(()=>oM(t)&&e()),t},clearImmediate(e){oM(e)}};function aM(e){return null==e}function uM(e){return!aM(e)}new class extends el{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let n,r=-1,i=t.length;e=e||t.shift();do{if(n=e.execute(e.state,e.delay))break}while(++r<i&&(e=t.shift()));if(this.active=!1,n){for(;++r<i&&(e=t.shift());)e.unsubscribe();throw n}}}(class extends Qc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,n=0){return null!==n&&n>0?super.requestAsyncId(e,t,n):(e.actions.push(this),e.scheduled||(e.scheduled=sM.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(e,t,n);0===e.actions.length&&(sM.clearImmediate(t),e.scheduled=void 0)}}),"undefined"!=typeof window&&window,n(266),n(478),new Wn("SECURITY_CONTEXT");let cM=(()=>{class e{constructor(e){this.sequence$=new Al(0),this.subscription=null,e&&(this.subscription=e.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var e;this.sequence$.next(0),null===(e=this.subscription)||void 0===e||e.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return e.\u0275fac=function(t){return new(t||e)(ur(Lj,8))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),lM=(()=>{class e{constructor(t,n,r){e.store=t.get(Lj),e.ngZone=t.get(Su),e.factory=n,e.context=r,e.computed=t.get(cM)}}return e.store=null,e.computed=null,e.context=null,e.factory=null,e.ngZone=null,e.\u0275fac=function(t){return new(t||e)(ur(bo),ur(UD),ur(zD))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class hM{constructor(){hM.statesCachedMeta.clear()}static createStateContext(e){return lM.context.createStateContext(e)}static ensureMappedState(e){if(aM(lM.factory)||aM(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(uM(e.name)?hM.statesCachedMeta.get(e.name):null)||hM.ensureMeta(e)}static getRepositoryByInstance(e){var t;const n=null!==(t=function(e){return e.NGXS_DATA_META}(hM.getStateClassByInstance(e)))&&void 0!==t?t:null;if(aM(n))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return n}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=hM.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const n={},r=Array.from(e);for(let i=0;i<r.length;i++){const e=null==t?void 0:t.getPayloadTypeByIndex(i);uM(e)&&(n[e]=r[i])}return Object.keys(n).length>0?n:null}static createAction(e,t,n){const r=hM.createPayload(t,n);var i;return new(i=e.type,class{constructor(e){e&&Object.keys(e).forEach(t=>{this[t]=e[t]})}static get type(){return i}})(r)}static ensureMeta(e){var t;const n=uM(e.name)?null===(t=lM.factory.states)||void 0===t?void 0:t.find(t=>t.name===e.name):null;return uM(n)&&uM(e.name)&&hM.statesCachedMeta.set(e.name,n),n}}hM.statesCachedMeta=new Map,hM.\u0275fac=function(e){return new(e||hM)},hM.\u0275prov=pe({token:hM,factory:hM.\u0275fac}),new ll(1),Error,Error;const dM=["bodyCanvas"];let fM=(()=>{class e{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new za,this.nodeDrag=new za,this.nodeClick=new za,this.nodeHoverStart=new za,this.nodeHoverStop=new za,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(e){var t;this._scene=e,null===(t=this.bodyUI)||void 0===t||t.setScene(e)}get rotation(){return this._rotation}set rotation(e){var t;this._rotation=e,null===(t=this.bodyUI)||void 0===t||t.setRotation(e)}get rotationX(){return this._rotationX}set rotationX(e){var t;this._rotationX=e,null===(t=this.bodyUI)||void 0===t||t.setRotationX(e)}get zoom(){return this._zoom}set zoom(e){var t;this._zoom=e,null===(t=this.bodyUI)||void 0===t||t.setZoom(e)}get target(){return this._target}set target(e){var t;this._target=e,null===(t=this.bodyUI)||void 0===t||t.setTarget(e)}get bounds(){return this._bounds}set bounds(e){this._bounds=e,this.zoomToBounds(e)}get camera(){return this._camera}set camera(e){this._camera=e}get interactive(){return this._interactive}set interactive(e){this._interactive=e,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(e,t={x:48,y:48}){if(this.bodyCanvas){const{width:n,height:r}=this.bodyCanvas.nativeElement,i=window.devicePixelRatio,o=Math.min(Math.log2((n-t.x)/i/e.x),Math.log2((r-t.y)/i/e.y));this.zoom=o}}setupBodyUI(){var e;return Sl(this,void 0,void 0,function*(){const t=this.bodyCanvas.nativeElement,n=new jD({id:"body-ui",canvas:t,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});t.addEventListener("contextmenu",e=>e.preventDefault()),yield n.initialize(),this.bodyUI=n,window.bodyUI=n,(null===(e=this.scene)||void 0===e?void 0:e.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(e=>this.rotationChange.next(e)),this.bodyUI.nodeDrag$.subscribe(e=>this.nodeDrag.emit(e)),this.bodyUI.nodeClick$.subscribe(e=>this.nodeClick.emit(e)),this.bodyUI.nodeHoverStart$.subscribe(e=>this.nodeHoverStart.emit(e)),this.bodyUI.nodeHoverStop$.subscribe(e=>this.nodeHoverStop.emit(e))]})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=qe({type:e,selectors:[["ccf-body-ui"]],viewQuery:function(e,t){if(1&e&&Ja(dM,5,Bs),2&e){let e;Qa(e=eu())&&(t.bodyCanvas=e.first)}},hostVars:2,hostBindings:function(e,t){2&e&&rs(t.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(e,t){1&e&&Uo(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem;border-top-right-radius:.5rem;border-top-left-radius:.5rem}"]}),e})(),pM=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[bc]]}),e})();new Wn("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10});const gM=[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:large_intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:brain",organ:"Brain",name:"Allen Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lymph_nodes",organ:"Lymph Node",name:"Lymph Node, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph_nodes",organ:"Lymph Node",name:"Lymph Node, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:bone_marrow",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{src:"app:vasculature",organ:"Vasculature",name:"Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].filter(e=>!0!==e.disabled);!function(){const e=localStorage.getItem("ALLOW_TELEMETRY");null===e||e.toLowerCase()}();var mM=n(440),yM=n(698),vM=n(445),bM=n.n(vM),_M=n(815),wM=n(609);const xM=mM.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},mM.DataFactory),EM={x:xM("rdf"),type:xM("rdf")("type")},SM={x:xM("rdfs"),label:xM("rdfs")("label"),comment:xM("rdfs")("comment"),isDefinedBy:xM("rdfs")("isDefinedBy"),seeAlso:xM("rdfs")("seeAlso")},AM={x:xM("entity"),id:xM("entity")("id"),label:SM.label,description:SM.comment,link:SM.seeAlso,sex:xM("entity")("sex"),age:xM("entity")("age"),bmi:xM("entity")("bmi"),Male:mM.DataFactory.literal("Male"),Female:mM.DataFactory.literal("Female"),consortiumName:xM("entity")("consortium_name"),providerName:xM("entity")("provider_name"),providerUUID:xM("entity")("provider_uuid"),donor:xM("entity")("has_donor"),sections:xM("entity")("has_tissue_section"),datasets:xM("entity")("has_dataset"),sampleType:xM("entity")("sample_type"),TissueBlock:mM.DataFactory.literal("Tissue Block"),TissueSection:mM.DataFactory.literal("Tissue Section"),NonStandard:mM.DataFactory.literal("Non-standard"),sectionCount:xM("entity")("section_count"),sectionSize:xM("entity")("section_size"),sectionUnits:xM("entity")("section_units"),sectionNumber:xM("entity")("section_number"),spatialEntity:xM("entity")("has_spatial_entity"),ontologyTerms:xM("entity")("has_ontology_term"),technology:xM("entity")("technology"),thumbnail:xM("entity")("has_thumbnail")},kM=xM("ccf"),TM={x:kM,ontologyNode:{label:kM("ccf_preferred_label"),parent:kM("ccf_part_of"),children:kM("ccf_part_of"),rui_rank:kM("ccf_rui_rank"),synonymLabels:mM.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},spatial:{Female:kM("VHFemale"),Male:kM("VHMale"),BothSexes:kM("VHBothSexes"),FemaleOrgans:kM("VHFemaleOrgans"),MaleOrgans:kM("VHMaleOrgans")},SpatialObjectReference:kM("SpatialObjectReference"),SpatialEntity:kM("SpatialEntity"),SpatialPlacement:kM("SpatialPlacement"),spatialObjectReference:{file:kM("has_object_file"),file_format:kM("has_object_file_format"),file_subpath:kM("has_object_file_subpath")},extractionSet:{label:SM.label,rui_rank:kM("ccf_rui_rank")},spatialEntity:{label:SM.label,comment:SM.comment,creator:xM("dc")("creator"),creator_first_name:kM("creator_first_name"),creator_last_name:kM("creator_last_name"),creator_orcid:kM("creator_orcid"),creation_date:kM("creation_date"),updated_date:kM("updated_date"),ccf_annotations:kM("ccf_annotation"),representation_of:kM("ccf_representation_of"),reference_organ:kM("anatomical_structure_of"),extraction_set_for:kM("extraction_set_for"),extraction_set:kM("extraction_site_for"),sex:kM("has_sex"),side:kM("has_side"),rui_rank:kM("ccf_rui_rank"),slice_thickness:kM("ccf_slice_thickness"),slice_count:kM("ccf_slice_count"),x_dimension:kM("has_x_dimension"),y_dimension:kM("has_y_dimension"),z_dimension:kM("has_z_dimension"),dimension_units:kM("has_dimension_units"),object:kM("has_object_reference")},spatialPlacement:{source:kM("has_placement_source"),target:kM("has_placement_target"),placement_date:kM("has_placement_date"),x_scaling:kM("has_x_scaling"),y_scaling:kM("has_y_scaling"),z_scaling:kM("has_z_scaling"),scaling_units:kM("has_scaling_units"),x_rotation:kM("has_x_rotation"),y_rotation:kM("has_y_rotation"),z_rotation:kM("has_z_rotation"),w_rotation:kM("has_theta_rotation"),rotation_order:kM("has_rotation_order"),rotation_units:kM("has_rotation_units"),x_translation:kM("has_x_translation"),y_translation:kM("has_y_translation"),z_translation:kM("has_z_translation"),translation_units:kM("has_translation_units")}},OM={x:xM("uberon")},IM=(xM("lmha"),{bladder:OM.x("0001255"),body:OM.x("0013702"),brain:OM.x("0000955"),colon:OM.x("0001155"),heart:OM.x("0000948"),kidney:OM.x("0002113"),large_intestine:OM.x("0000059"),left_kidney:OM.x("0004538"),left_lung:OM.x("0002168"),left_ureter:OM.x("0001223"),liver:OM.x("0002107"),lung:OM.x("0002048"),lymph_node:OM.x("0000029"),pelvis:OM.x("0001270"),rectum:OM.x("0001052"),right_kidney:OM.x("0004539"),right_lung:OM.x("0002167"),right_ureter:OM.x("0001222"),skin:OM.x("0002097"),small_intestine:OM.x("0002108"),spleen:OM.x("0002106"),thymus:OM.x("0002370"),ureter:OM.x("0000056"),vasculature:OM.x("0002049")});function CM(e){const t={};return Object.entries(e).forEach(([e,n])=>{t[n.id]=e}),t}const DM={spatialObjectReference:CM(TM.spatialObjectReference),spatialEntity:CM(TM.spatialEntity),spatialPlacement:CM(TM.spatialPlacement)};function jM(e,t,n,r){const i={"@id":t,"@type":n};return e.some(e=>{const t=r[e.predicate.id];if(t){const n="Literal"===e.object.termType?(0,wM.fromRdf)(e.object):e.object.id;(0,_M.set)(i,t,n)}return!1},mM.DataFactory.namedNode(t),null,null,null),i}const PM=(0,_M.memoize)(function(e,t){return jM(e,t,"SpatialObjectReference",DM.spatialObjectReference)},(e,t)=>t),MM=(0,_M.memoize)(function(e,t){const n=jM(e,t,"ExtractionSet",DM.spatialEntity);return n.extractionSites=(0,_M.sortBy)(e.getSubjects(TM.spatialEntity.extraction_set,t,null).map(t=>FM(e,t.id)),["rui_rank"]),n},(e,t)=>t),RM=(0,_M.memoize)(function(e,t){return(0,_M.sortBy)(e.getSubjects(TM.spatialEntity.extraction_set_for,t,null).map(t=>MM(e,t.id)),["rui_rank"])},(e,t)=>t),NM=(0,_M.memoize)(function(e,t){return(0,_M.sortBy)(e.getSubjects(TM.spatialEntity.reference_organ,t,null).map(t=>FM(e,t.id)).filter(e=>e["@id"]!==t),["rui_rank"])},(e,t)=>t),LM=(0,_M.memoize)(function(e){const t=[];return e.forEach(n=>{n.subject.id===n.object.id&&t.push(FM(e,n.subject.id))},null,TM.spatialEntity.reference_organ,null,null),(0,_M.sortBy)(t,["rui_rank"])}),FM=(0,_M.memoize)(function(e,t){const n=jM(e,t,"SpatialEntity",DM.spatialEntity);return n.object&&(n.object=PM(e,n.object)),n.ccf_annotations&&(n.ccf_annotations=e.getObjects(t,TM.spatialEntity.ccf_annotations,null).map(e=>e.id)),e.forSubjects(e=>n.entityId=e.id,AM.spatialEntity,t,null),n},(e,t)=>t),BM=(0,_M.memoize)(function(e,t){const n=jM(e,t,"SpatialPlacement",DM.spatialPlacement);return n.source&&(n.source=FM(e,n.source)),n.target&&(n.target=FM(e,n.target)),n},(e,t)=>t),zM=(0,_M.memoize)(function(e,t){const n=e.getObjects(mM.DataFactory.namedNode(t),AM.spatialEntity,null);return n.length>0?FM(e,n[0].id):void 0},(e,t)=>t);function UM(e,t){const n=t;let r;switch(n.translation_units){case"centimeter":r=.01;break;case"millimeter":r=.001;break;case"meter":default:r=1}const i=[n.x_translation,n.y_translation,n.z_translation].map(e=>e*r),o=[n.x_rotation,n.y_rotation,n.z_rotation].map(Hf),s=[n.x_scaling,n.y_scaling,n.z_scaling];return e.translate(i).rotateXYZ(o).scale(s)}class VM{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new yM.DirectedGraph;const e=this.db.store;e.forSubjects(t=>{this.addSpatialObjectReference(PM(e,t.id))},EM.type,TM.SpatialObjectReference,null),e.forSubjects(t=>{this.addSpatialEntity(FM(e,t.id))},EM.type,TM.SpatialEntity,null),e.forSubjects(t=>{this.addSpatialPlacement(BM(e,t.id))},EM.type,TM.SpatialPlacement,null)}addSpatialEntity(e){this.graph.mergeNode(e["@id"],{type:"SpatialEntity",object:e})}addSpatialObjectReference(e){this.graph.mergeNode(e["@id"],{type:"SpatialObjectReference",object:e})}addSpatialPlacement(e){this.graph.mergeDirectedEdge(e.source["@id"],e.target["@id"],{type:"SpatialPlacement",placement:e})}getTransformationMatrix(e,t){if(e===t)return new Qy(Qy.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const n=new Qy(Qy.IDENTITY),r=bM()(this.graph,e,t);if(r&&r.length>0){r.reverse();let e="";for(const t of r)e&&UM(n,this.graph.getEdgeAttribute(t,e,"placement")),e=t;return n}}}class GM{constructor(e){this.db=e}getSpatialEntity(e){return FM(this.db.store,e)}getExtractionSets(e){return RM(this.db.store,e)}getExtractionSet(e){return MM(this.db.store,e)}getAnatomicalStructures(e){return NM(this.db.store,e)}getReferenceOrgans(){return LM(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=TM.spatial.Male.id;break;case"Female":t=TM.spatial.Female.id;break;case"Both":default:t=TM.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(e=>"Male"===e.sex);break;case"Female":t=t.filter(e=>"Female"===e.sex)}return(null==e?void 0:e.debug)&&(t=t.map(e=>[[e],this.getAnatomicalStructures(e["@id"])]).reduce((e,[t,n])=>e.concat(n.length>0?n:t),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e);let n=[...this.getReferenceOrganSets(e).map(e=>{const n="http://purl.obolibrary.org/obo/UBERON_0002097"===e.representation_of;return this.getSceneNode(e,t,{color:[255,255,255,255],opacity:n?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!n})})];return(null==e?void 0:e.debug)&&(n=n.concat([this.getSceneNode(this.getSpatialEntity(TM.x("VHRightKidney").id),t,{color:[0,0,255,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(TM.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(TM.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(TM.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(TM.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],wireframe:!0})])),n.filter(e=>void 0!==e)}getReferenceOrganScene(e,t){var n;const r=this.getReferenceOrgans().filter(n=>n.representation_of===e&&n.sex===(null==t?void 0:t.sex));if(r.length>0){const e=r[0],i=this.getSceneNode(e,e,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===e.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),o=(null!==(n=this.db.getSpatialEntities(t))&&void 0!==n?n:[]).map(t=>this.getSceneNode(t,e,{color:[255,255,255,229.5]}));return[i].concat(o).filter(e=>void 0!==e)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(e=>this.getSceneNode(e,t,{color:[255,255,255,229.5]})).filter(e=>void 0!==e)}getSceneNode(e,t,n={}){var r,i,o,s;const a=null===(i=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===i?void 0:i.startsWith("model/gltf");let u=this.db.graph.getTransformationMatrix(a&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(u){if(a)u=new Qy(Qy.IDENTITY).rotateX(Hf(90)).multiplyLeft(u);else{let t;switch(e.dimension_units){case"centimeter":t=.01;break;case"millimeter":t=.001;break;case"meter":default:t=1}const n=[e.x_dimension,e.y_dimension,e.z_dimension].map(e=>e*t/2);u.scale(n)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:a?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:a?null===(s=e.object)||void 0===s?void 0:s.file_subpath:void 0,transformMatrix:u,tooltip:e.label},n)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const HM="https://entity.api.hubmapconsortium.org/entities/",qM=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),WM={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},$M={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford"},XM=function(){const e={};return Object.entries(IM).forEach(([t,n])=>e[t]=n.id),e}(),KM={BL:[XM.body,XM.bladder],RK:[XM.body,XM.kidney,XM.right_kidney],LK:[XM.body,XM.kidney,XM.left_kidney],HT:[XM.body,XM.heart],LI:[XM.body,XM.large_intestine,XM.colon],SI:[XM.body,XM.small_instestine],LL:[XM.body,XM.lung,XM.left_lung],RL:[XM.body,XM.lung,XM.right_lung],LY:[XM.body,XM.lymph_node],SP:[XM.body,XM.spleen],TH:[XM.body,XM.thymus],UR:[XM.body,XM.ureter],LV:[XM.body,XM.liver],OT:[XM.body]},ZM={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class YM{constructor(e,t="",n="",r){var i,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const s=this.data.descendants||[],a=(this.data.ancestors||[]).find(e=>"Donor"===e.entity_type);this.donor=this.getDonor(a,n);const u=this.getRuiLocation(e,this.donor);u?this.rui_location=u:this.bad=!0;const c=new Date(e.last_modified_timestamp).toLocaleDateString(),l=$M[e.group_uuid]||e.group_name,h=e.created_by_user_displayname;this["@id"]=HM+e.uuid,this.label=`Registered ${c}, ${h}, ${l}`,this.link=`${n}browse/sample/${e.uuid}`;const d={},f=[];this.sections=f;const p=[];this.datasets=p;for(const b of s.filter(e=>"Sample"===e.entity_type)){const t=this.getSection(b,e,n);d[b.submission_id]=t,f.push(t),t.section_number=null!==(i=t.section_number)&&void 0!==i?i:f.length}for(const b of s)if("Dataset"===b.entity_type){const e=this.getDataset(b,t,n,r),i=(0,_M.get)(b,["ingest_metadata","metadata","tissue_id"]);d[i]?null===(o=d[i].datasets)||void 0===o||o.push(e):p.push(e)}const g=null!=u?u:{},m=`${g.x_dimension} x ${g.y_dimension} x ${g.z_dimension} ${g.dimension_units}`;this.section_count=g.slice_count||f.length;const y=parseFloat((g.slice_thickness||(g.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=y;const v=g.dimension_units||"millimeter";this.section_units=v,this.description=`${m}, ${y} ${v}, ${e.specimen_type}, ${this.section_count} Sections`,f.forEach((e,t)=>{e.description=`${g.x_dimension} x ${g.y_dimension} x ${y} ${v}, ${y} ${v}, ${e.description}`,e.section_number=t+1})}getSection(e,t,n){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":HM+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${$M[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${n}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",n="",r){var i;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),s=$M[e.group_uuid]||e.group_name,a=e.created_by_user_displayname,u=[...e.data_types,(0,_M.get)(e,["ingest_metadata","metadata","assay_type"],"")],c=u.join("|").toLowerCase();let l,h="assets/icons/ico-unknown.svg";return-1!==c.indexOf("10x")?(l="10x",h="assets/icons/ico-bulk-10x.svg"):-1!==c.indexOf("af")?(l="AF",h="assets/icons/ico-spatial-af.svg"):-1!==c.indexOf("codex")?(l="CODEX",h="assets/icons/ico-spatial-codex.svg"):-1!==c.indexOf("imc")?(l="IMC",h="assets/icons/ico-spatial-imc.svg"):-1!==c.indexOf("lc")&&-1===c.indexOf("af")?(l="LC",h="assets/icons/ico-bulk-lc.svg"):l=-1!==c.indexOf("maldi")?"MALDI":-1!==c.indexOf("pas")?"PAS":"OTHER",h=null!==(i=this.getDatasetThumbnail(e,t,r))&&void 0!==i?i:h,{"@id":HM+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${a}, ${s}`,description:`Data/Assay Types: ${u.join(", ")}`,link:`${n}browse/dataset/${e.uuid}`,technology:l,thumbnail:h}}getDatasetThumbnail(e,t,n){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(n?`?token=${n}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,_M.get)(e,"metadata.files",[]).filter(e=>/\.(ome\.tif|ome\.tiff)$/.test(e.rel_path)).filter(e=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(e.rel_path)).filter(e=>qM.has(e.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(r=>`${t}/${e.uuid}/${r.rel_path}`+(n?`?token=${n}`:""));if(r.length>0){const e=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(qM.has(e))return`assets/thumbnails/TMC-Vanderbilt/DR1/${e}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const t=WM[e.hubmap_id];if(t)return`assets/thumbnails/TMC-Florida/${t}`}}getDonor(e,t){const n=(e.description||"").toLowerCase();let r;n.includes("female")?r="Female":n.includes("male")&&(r="Male");const i=n.match(/age ([0-9]+)/);let o,s;i&&(o=(0,_M.toNumber)(i[1]));for(const l of(0,_M.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===l.preferred_term||"Female"===l.preferred_term?r="Female":"Masculine gender"===l.preferred_term||"Male"===l.preferred_term?r="Male":"Current chronological age"===l.preferred_term||"Age"===l.preferred_term?o=(0,_M.toNumber)(l.data_value):"Body mass index"===l.preferred_term&&(s=(0,_M.toNumber)(l.data_value));let a="";r&&o&&(a+=`${r}, Age ${o}`,s&&(a+=`, BMI ${s.toFixed(1)}`));const u=new Date(e.last_modified_timestamp).toLocaleDateString(),c=$M[e.group_uuid]||e.group_name;return{"@id":HM+e.uuid,"@type":"Donor",label:a,description:`Entered ${u}, ${e.created_by_user_displayname}, ${c}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:s,consortium_name:"HuBMAP",provider_name:c,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var n;const r=(e.ancestors||[]).find(e=>"Sample"===e.entity_type&&"organ"===e.specimen_type),i=KM[null==r?void 0:r.organ]||[XM.body];let o,s=e.rui_location;if(s&&("string"==typeof s&&(s=JSON.parse(s)),s.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):s["@id"]&&(o=s)),o){o.ccf_annotations=i.concat(o.ccf_annotations||[]);const e=null!==(n=(0,_M.get)(o,["placement","target"]))&&void 0!==n?n:"";e.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")&&(0,_M.set)(o,["placement","target"],e.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")),"http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"!==e&&"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"!==e||(0,_M.set)(o,["placement","target"],"Male"===t.sex?e.replace("#VH","#VHM")+"_Patch":e.replace("#VH","#VHF")+"_Patch")}return o}getTissueBlock(){return(0,_M.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}function QM(e,t,n){var r;const i=new Map,o=new Set;e.some(e=>{var n;return t.has(e.subject.id)&&(o.add(e.object.id),i.has(e.object.id)?null===(n=i.get(e.object.id))||void 0===n||n.push(e.subject.id):i.set(e.object.id,[e.subject.id])),!1},null,AM.donor,null,null);const s=n(o),a=new Set;for(const u of s)for(const e of null!==(r=i.get(u))&&void 0!==r?r:[])a.add(e);return a}function JM(e,t){return n=>e.has(n.id)?t.add(n.id):void 0}const eR={[TM.ontologyNode.label.id]:"label",[TM.ontologyNode.parent.id]:"parent",[TM.ontologyNode.synonymLabels.id]:"synonymLabels"};function tR(e,t){const n=mM.DataFactory.namedNode(t),r={"@id":t,"@type":"OntologyTreeNode",id:t,parent:"",children:[],synonymLabels:[],label:""};return e.some(e=>{const t=eR[e.predicate.id];if(t){const n="Literal"===e.object.termType?(0,wM.fromRdf)(e.object):e.object.id;"synonymLabels"===t?r.synonymLabels.push(n):(0,_M.set)(r,t,n)}return!1},n,null,null,null),r.children=e.getSubjects(TM.ontologyNode.children,n,null).map(e=>e.id),r}const nR={[AM.label.id]:"label",[AM.description.id]:"description",[AM.link.id]:"link"},rR=Object.assign(Object.assign({},nR),{[AM.providerName.id]:"providerName"}),iR=Object.assign(Object.assign({},nR),{[AM.technology.id]:"technology",[AM.thumbnail.id]:"thumbnail"}),oR=Object.assign(Object.assign({},nR),{[AM.sampleType.id]:"sampleType",[AM.sectionNumber.id]:"sectionNumber",[AM.datasets.id]:"datasets"}),sR=Object.assign(Object.assign({},nR),{[AM.sampleType.id]:"sampleType",[AM.sectionCount.id]:"sectionCount",[AM.sectionSize.id]:"sectionSize",[AM.sectionUnits.id]:"sectionUnits",[AM.donor.id]:"donor",[AM.spatialEntity.id]:"spatialEntityId",[AM.sections.id]:"sections",[AM.datasets.id]:"datasets"}),aR=(0,_M.memoize)(function(e,t){const n={"@id":t,"@type":"Donor"};return e.some(e=>{const t=rR[e.predicate.id];if(t){const r="Literal"===e.object.termType?(0,wM.fromRdf)(e.object):e.object.id;(0,_M.set)(n,t,r)}return!1},mM.DataFactory.namedNode(t),null,null,null),n},(e,t)=>t);function uR(e,t){const n={"@id":t,"@type":"Dataset"};return e.some(e=>{const t=iR[e.predicate.id];if(t){const r="Literal"===e.object.termType?(0,wM.fromRdf)(e.object):e.object.id;(0,_M.set)(n,t,r)}return!1},mM.DataFactory.namedNode(t),null,null,null),n}const cR=(0,_M.memoize)(function(e,t){const n={"@id":t,"@type":"Sample",sections:[],datasets:[]};return e.some(t=>{const r=sR[t.predicate.id];if(r){const i="Literal"===t.object.termType?(0,wM.fromRdf)(t.object):t.object.id;if("sections"===r){const t=function(e,t){const n={"@id":t,"@type":"Sample",datasets:[]};return e.some(t=>{const r=oR[t.predicate.id];if(r){const i="Literal"===t.object.termType?(0,wM.fromRdf)(t.object):t.object.id;if("datasets"===r){const t=uR(e,i);n[r].push(t)}else(0,_M.set)(n,r,i)}return!1},mM.DataFactory.namedNode(t),null,null,null),n}(e,i);n[r].push(t)}else if("datasets"===r){const t=uR(e,i);n[r].push(t)}else"donor"===r?n[r]=aR(e,i):(0,_M.set)(n,r,i)}return!1},mM.DataFactory.namedNode(t),null,null,null),n},(e,t)=>t),lR={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class hR{constructor(e=lR){this.options=e,this.store=new mM.Store(void 0,{factory:mM.DataFactory}),this.graph=new VM(this),this.scene=new GM(this)}connect(e){return Sl(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=this.doConnect()),yield this.initializing,this.store.size>0})}doConnect(){var e,t;return Sl(this,void 0,void 0,function*(){const n=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],i=this.options.ccfOwlUrl;if(i.endsWith(".n3store.json")){const e=yield fetch(i).then(e=>e.text()).catch(()=>console.log("Couldn't locate serialized store."));e&&(this.store=(0,mM.deserializeN3Store)(e,mM.DataFactory))}else(null==i?void 0:i.length)>0&&r.push(i);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):n.push(function(e,t,n,r,i="",o=""){return Sl(this,void 0,void 0,function*(){let s;if("static"===t)s=yield fetch(e).then(e=>e.ok?e.json():void 0).catch(()=>{});else if("search-api"===t){const t={"Content-type":"application/json"};r&&r.length>0&&(t.Authorization=`Bearer ${r}`),s=yield fetch(e,{method:"POST",headers:t,body:JSON.stringify({version:!0,size:1e4,_source:{excludes:["donor","immediate_ancestors","immediate_descendants","origin_sample","portal_metadata_upload_files","image_file_metadata","ancestor_ids","descendant_ids"]},stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=n?n:{exists:{field:"rui_location"}}})}).then(e=>e.ok?e.json():void 0).catch(()=>{})}return s?function(e,t="",n="",r,i=!1){const o={},s=(0,_M.get)(e,"hits.hits",[]).map(e=>(0,_M.get)(e,"_source",{})).map(e=>new YM(e,t,n,r).toJsonLd());for(const u of s){const e=u["@id"];o[e]?o[e].samples.push(u.samples[0]):o[e]=u}const a=Object.values(o);return i&&(function(e){let t=[],n=0;for(const r of e.filter(e=>e.samples.length>1)){const e=r.samples;for(let r=0;r<e.length;r++){const i=e[r]["@id"];t=t.concat(e[r].datasets);for(const n of e[r].sections)t=t.concat(n.datasets);for(let t=r+1;t<e.length;t++)e[t].sections.find(e=>e["@id"]===i)&&(e[r].deleteMe=!0,n++)}r.samples=e.filter(e=>!0!==e.deleteMe)}n>0&&console.log(`\u26a0 ${n} sections identified as blocks`)}(a),console.log(a.map(e=>Object.assign({"@context":ZM},e)))),{"@context":ZM,"@graph":a}}(s,i,o,r):void console.warn(`Unable to load ${e} as HuBMAP Data`)})}(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(e=>e?this.addDataSources([e]):void 0))),n.push(this.addDataSources(r)),yield Promise.all(n),yield this.synchronize()})}addDataSources(e,t){return Sl(this,void 0,void 0,function*(){const n=null!=t?t:this.store;return yield Promise.all(e.map(e=>Sl(this,void 0,void 0,function*(){"string"==typeof e?e.endsWith("jsonld")?yield(0,mM.addJsonLdToStore)(e,n):e.endsWith("n3")?yield(0,mM.addN3ToStore)(e,n):(e.endsWith("rdf")||e.endsWith("owl")||e.endsWith("xml"))&&(yield(0,mM.addRdfXmlToStore)(e,n)):yield(0,mM.addJsonLdToStore)(e,n)}))),this})}synchronize(){return Sl(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),this})}getIds(e={}){return function(e,t){var n,r,i,o,s;let a=function(e){const t=new Set;return e.forSubjects(e=>t.add(e.id),AM.spatialEntity,null,null),t}(e);if(a.size>0&&(a=function(e,t,n=!0){const r=new Set;if(e.forSubjects(JM(t,r),AM.spatialEntity,null,null),!n){const e=new Set;return t.forEach(t=>r.has(t)?void 0:e.add(t)),e}return r}(e,a)),a.size>0&&("Male"===t.sex||"Female"===t.sex)){const n=t.sex;a=QM(e,a,t=>function(e,t,n){const r=new Set;return e.forSubjects(JM(t,r),AM.sex,AM[n],null),r}(e,t,n))}if(a.size>0&&(null===(n=t.tmc)||void 0===n?void 0:n.length)>0&&(a=QM(e,a,n=>function(e,t,n){const r=new Set;for(const i of n){const n=mM.DataFactory.literal(i);e.forSubjects(JM(t,r),AM.providerName,n,null)}return r}(e,n,t.tmc))),a.size>0&&(null===(r=t.technologies)||void 0===r?void 0:r.length)>0&&(a=function(e,t,n){var r;const i=new Map,o=new Set,s=new Set;e.some(e=>(t.has(e.subject.id)&&s.add(e.object.id),!1),null,AM.sections,null,null),e.some(e=>{var n;return(t.has(e.subject.id)||s.has(e.subject.id))&&(o.add(e.object.id),i.has(e.object.id)?null===(n=i.get(e.object.id))||void 0===n||n.push(e.subject.id):i.set(e.object.id,[e.subject.id])),!1},null,AM.datasets,null,null);const a=n(o),u=new Set;for(const c of a)for(const e of null!==(r=i.get(c))&&void 0!==r?r:[])u.add(e);return u}(e,a,n=>function(e,t,n){const r=new Set;for(const i of n){const n=mM.DataFactory.literal(i);e.forSubjects(JM(t,r),AM.technology,n,null)}return r}(e,n,t.technologies))),a.size>0&&(null===(i=t.ontologyTerms)||void 0===i?void 0:i.length)>0&&(a=function(e,t,n){var r;const i=new Map,o=new Set;e.some(e=>{var n;return t.has(e.subject.id)&&(o.add(e.object.id),i.has(e.object.id)?null===(n=i.get(e.object.id))||void 0===n||n.push(e.subject.id):i.set(e.object.id,[e.subject.id])),!1},null,AM.spatialEntity,null,null);const s=n(o),a=new Set;for(const u of s)for(const e of null!==(r=i.get(u))&&void 0!==r?r:[])a.add(e);return a}(e,a,n=>function(e,t,n){const r=new Set;for(const i of n){const n=mM.DataFactory.namedNode(i);e.forSubjects(JM(t,r),TM.spatialEntity.ccf_annotations,n,null)}return r}(e,n,t.ontologyTerms))),a.size>0&&2===(null===(o=t.ageRange)||void 0===o?void 0:o.length)&&(0,_M.isFinite)(t.ageRange[0])&&(0,_M.isFinite)(t.ageRange[1])){const n=Math.max(...t.ageRange),r=Math.min(...t.ageRange);1===r&&110===n||(a=QM(e,a,t=>function(e,t,n,r){const i=new Set;return e.some(e=>{if(t.has(e.subject.id)){const t=(0,wM.fromRdf)(e.object);t>=n&&t<=r&&i.add(e.subject.id)}return!1},null,AM.age,null,null),i}(e,t,r,n)))}if(a.size>0&&2===(null===(s=t.bmiRange)||void 0===s?void 0:s.length)&&(0,_M.isFinite)(t.bmiRange[0])&&(0,_M.isFinite)(t.bmiRange[1])){const n=Math.max(...t.bmiRange),r=Math.min(...t.bmiRange);13===r&&83===n||(a=QM(e,a,t=>function(e,t,n,r){const i=new Set;return e.some(e=>{if(t.has(e.subject.id)){const t=(0,wM.fromRdf)(e.object);t>=n&&t<=r&&i.add(e.subject.id)}return!1},null,AM.bmi,null,null),i}(e,t,r,n)))}return a}(this.store,e)}get(e){return this.store.getQuads(mM.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(e=>this.get(e))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(e=>zM(this.store,e))}getTissueBlockResults(e){return Sl(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(e=>cR(this.store,e))})}getAggregateResults(e){return Sl(this,void 0,void 0,function*(){return function(e,t){const n=new Set;t.some(t=>(e.has(t.subject.id)&&n.add(t.object.id),!1),null,AM.donor,null,null);const r=new Set;t.some(e=>(n.has(e.subject.id)&&r.add(e.object.id),!1),null,AM.providerUUID,null,null);const i=new Set;t.forSubjects(t=>{e.has(t.id)&&i.add(t.id)},AM.spatialEntity,null,null);const o=new Set;t.some(e=>(i.has(e.subject.id)&&o.add(e.object.id),!1),null,AM.sections,null,null);const s=new Set;return t.some(e=>{const t=e.subject;return(i.has(t.id)||o.has(t.id))&&s.add(e.object.id),!1},null,AM.datasets,null,null),Object.entries({"Tissue Data Providers":r.size,Donors:n.size,"Tissue Blocks":i.size,"Tissue Sections":o.size,"Tissue Datasets":s.size}).map(([e,t])=>({label:e,count:t}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return Sl(this,void 0,void 0,function*(){return function(e,t){const n=new Map;t.some(t=>(e.has(t.subject.id)&&(n.has(t.object.id)?n.get(t.object.id).push(t.subject.id):n.set(t.object.id,[t.subject.id])),!1),null,AM.spatialEntity,null,null);const r={};return t.some(e=>{var t,i;if(n.has(e.subject.id)){const o=null!==(i=null===(t=n.get(e.subject.id))||void 0===t?void 0:t.length)&&void 0!==i?i:0;r[e.object.id]=o+(r[e.object.id]||0)}return!1},null,TM.spatialEntity.ccf_annotations,null,null),r}(this.getIds(e),this.store)})}getOntologyTreeModel(){return Sl(this,void 0,void 0,function*(){return function(e){const t={root:IM.body.id,nodes:{}},n=new Set;e.some(e=>(n.add(e.subject.id),n.add(e.predicate.id),!1),null,TM.ontologyNode.parent,null,null);for(const r of n)t.nodes[r]=tR(e,r);return t}(this.store)})}getReferenceOrgans(){return Sl(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return Sl(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return Sl(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}}let dR=(()=>{class e{constructor(e){var t,n;this.locator=e,this.subscriptions=new g,this.dbOptions=eh.dbOptions,this.dataSource=(t=()=>this.createDataSource(),n=e=>this.connectDataSource(e.source,this.dbOptions),new x(e=>{let r,i;try{r=t()}catch(VR){return void e.error(VR)}try{i=n(r)}catch(VR){return void e.error(VR)}const o=(i?B(i):nl).subscribe(e);return()=>{o.unsubscribe(),r&&r.unsubscribe()}})).pipe(HD(1)),this.subscriptions.add(this.dataSource.subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}getTissueBlockResults(e){return this.dataSource.pipe(dl(t=>t.getTissueBlockResults(e)),Tl(1))}getAggregateResults(e){return this.dataSource.pipe(dl(t=>t.getAggregateResults(e)),Tl(1))}getOntologyTermOccurences(e){return this.dataSource.pipe(dl(t=>t.getOntologyTermOccurences(e)),Tl(1))}getOntologyTreeModel(){return this.dataSource.pipe(dl(e=>e.getOntologyTreeModel()),Tl(1))}getReferenceOrgans(){return this.dataSource.pipe(dl(e=>e.getReferenceOrgans()),Tl(1))}getScene(e){return this.dataSource.pipe(dl(t=>t.getScene(e).then(t=>t.filter(t=>e.ontologyTerms.includes(t.representation_of)))),Tl(1))}getReferenceOrganScene(e,t){return this.dataSource.pipe(dl(n=>n.getReferenceOrganScene(e,t)),Tl(1))}createDataSource(){return{source:new hR(this.dbOptions),unsubscribe:()=>{}}}connectDataSource(e,t){return Sl(this,void 0,void 0,function*(){eh.production||(globalThis.db=e);const n=(new Date).getTime();return yield e.connect(t),eh.production||console.info(`Loaded CCF database in ${((new Date).getTime()-n)/1e3}s`),e})}}return e.\u0275fac=function(t){return new(t||e)(ur(ic))},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const fR=["thumbContainer"],pR=["toggleBar"],gR=["input"],mR=function(e){return{enterDuration:e}},yR=["*"],vR=new Wn("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let bR=0;const _R={provide:qj,useExisting:ae(()=>ER),multi:!0};class wR{constructor(e,t){this.source=e,this.checked=t}}const xR=WP(HP(qP(GP(class{constructor(e){this._elementRef=e}}))));let ER=(()=>{class e extends xR{constructor(e,t,n,r,i,o){super(e),this._focusMonitor=t,this._changeDetectorRef=n,this.defaults=i,this._onChange=e=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++bR,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new za,this.toggleChange=new za,this.tabIndex=parseInt(r)||0,this.color=this.defaultColor=i.color||"accent",this._noopAnimations="NoopAnimations"===o}get required(){return this._required}set required(e){this._required=Zj(e)}get checked(){return this._checked}set checked(e){this._checked=Zj(e),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{"keyboard"===e||"program"===e?this._inputElement.nativeElement.focus():e||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(e){e.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(e){e.stopPropagation()}writeValue(e){this.checked=!!e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck()}focus(e,t){t?this._focusMonitor.focusVia(this._inputElement,t,e):this._inputElement.nativeElement.focus(e)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new wR(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(No(Bs),No(vP),No(ca),("tabindex",function(e,t){const n=e.attrs;if(n){const e=n.length;let r=0;for(;r<e;){const i=n[r];if(mn(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<e&&"string"==typeof n[r];)r++;else{if(i===t)return n[r+1];r+=2}}}return null}(Rt(),"tabindex")),No(vR),No(FP,8))},e.\u0275cmp=qe({type:e,selectors:[["mat-slide-toggle"]],viewQuery:function(e,t){if(1&e&&(Ja(fR,5),Ja(pR,5),Ja(gR,5)),2&e){let e;Qa(e=eu())&&(t._thumbEl=e.first),Qa(e=eu())&&(t._thumbBarEl=e.first),Qa(e=eu())&&(t._inputElement=e.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(e,t){2&e&&(ms("id",t.id),Po("tabindex",t.disabled?null:-1)("aria-label",null)("aria-labelledby",null),ns("mat-checked",t.checked)("mat-disabled",t.disabled)("mat-slide-toggle-label-before","before"==t.labelPosition)("_mat-animation-noopable",t._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[js([_R]),wo],ngContentSelectors:yR,decls:16,vars:19,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(e,t){if(1&e&&(function(e){const t=jt()[16][6];if(!t.projection){const e=t.projection=Yn(1,null),n=e.slice();let r=t.child;for(;null!==r;){const t=0;null!==t&&(n[t]?n[t].projectionNext=r:e[t]=r,n[t]=r),r=r.next}}}(),Bo(0,"label",0,1),Bo(2,"div",2,3),Bo(4,"input",4,5),Wo("change",function(e){return t._onChangeEvent(e)})("click",function(e){return t._onInputClick(e)}),zo(),Bo(6,"div",6,7),Uo(8,"div",8),Bo(9,"div",9),Uo(10,"div",10),zo(),zo(),zo(),Bo(11,"span",11,12),Wo("cdkObserveContent",function(){return t._onLabelTextChange()}),Bo(13,"span",13),fs(14,"\xa0"),zo(),function(e,t=0,n){const r=jt(),i=Pt(),o=bi(i,tt+e,16,null,n||null);null===o.projection&&(o.projection=t),Bt(),64!=(64&o.flags)&&function(e,t,n){Xr(t[11],0,t,n,Rr(e,n,t),zr(n.parent||t[6],n,t))}(i,r,o)}(15),zo(),zo()),2&e){const e=Ro(1),i=Ro(12);Po("for",t.inputId),ci(2),ns("mat-slide-toggle-bar-no-side-margin",!i.textContent||!i.textContent.trim()),ci(2),Lo("id",t.inputId)("required",t.required)("tabIndex",t.tabIndex)("checked",t.checked)("disabled",t.disabled),Po("name",t.name)("aria-checked",t.checked.toString())("aria-label",t.ariaLabel)("aria-labelledby",t.ariaLabelledby),ci(5),Lo("matRippleTrigger",e)("matRippleDisabled",t.disableRipple||t.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",(17,n=mR,r=t._noopAnimations?0:150,Na(jt(),Vt(),17,n,r,undefined)))}var n,r},directives:[eM,uP],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),e})(),SR=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({}),e})(),AR=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[SR,tM,VP,cP],SR,VP]}),e})(),kR=(()=>{class e{constructor(){this.clsName="ccf-slide-toggle",this.labels=["Left","Right"],this.value="Left",this.disabled=!1,this.valueChange=new za}get left(){const{value:e,labels:t}=this;return e!==t[1]}updateToggle(e){this.value=e?this.labels[0]:this.labels[1],this.valueChange.emit(this.value)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=qe({type:e,selectors:[["ccf-slide-toggle"]],hostVars:2,hostBindings:function(e,t){2&e&&rs(t.clsName)},inputs:{labels:"labels",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:6,vars:12,consts:[[1,"slide-label",3,"click"],[1,"slider",3,"disabled","checked","change"],["toggle",""]],template:function(e,t){if(1&e){const e=Vo();Bo(0,"span",0),Wo("click",function(){Mt(e);const n=Ro(3);return!t.left&&n.toggle(),t.updateToggle(!0)}),fs(1),zo(),Bo(2,"mat-slide-toggle",1,2),Wo("change",function(e){return t.updateToggle(!e.checked)}),zo(),Bo(4,"span",0),Wo("click",function(){Mt(e);const n=Ro(3);return t.left&&n.toggle(),t.updateToggle(!1)}),fs(5),zo()}2&e&&(ns("disabled",t.disabled)("highlighted",t.left),ci(1),ps(t.labels[0].charAt(0).toUpperCase()+t.labels[0].slice(1)),ci(1),Lo("disabled",t.disabled)("checked",!t.left),ci(2),ns("disabled",t.disabled)("highlighted",!t.left),ci(1),ps(t.labels[1].charAt(0).toUpperCase()+t.labels[1].slice(1)))},directives:[ER],styles:["[_nghost-%COMP%]   .slide-label[_ngcontent-%COMP%]{margin:0 1rem;transition:color .6s;cursor:pointer;opacity:50%}[_nghost-%COMP%]   .slide-label.highlighted[_ngcontent-%COMP%]{opacity:100%}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:30%!important;cursor:not-allowed}[_nghost-%COMP%]     .slider .mat-slide-toggle-bar{background-color:rgba(67,71,101,.5)}[_nghost-%COMP%]     .slider .mat-slide-toggle-thumb{background-color:#434765}"],changeDetection:0}),e})();const TR=["bodyUI"],OR=function(){return["Male","Female"]},IR=function(){return["Left","Right"]};let CR=(()=>{class e{constructor(e,t,n){this.source=e,this.ga=t,this.cdr=n,this.sexChange=new za,this.sideChange=new za,this.referenceOrgans$=this.source.getReferenceOrgans().pipe(HD(1))}ngOnChanges(){this.referenceOrgans$.pipe(Tl(1)).subscribe(e=>{const t=e.find(e=>e.representation_of===this.organIri&&e.sex===this.sex);t?(this.resetView({x:t.x_dimension/1e3,y:t.y_dimension/1e3,z:t.z_dimension/1e3}),t.side||(this.side=void 0),this.scene$=this.source.getReferenceOrganScene(this.organIri,{sex:this.sex,ontologyTerms:[this.organIri]})):this.scene$=il([{color:[0,0,0,0],opacity:.001}]),this.cdr.markForCheck()})}resetView(e){const t=this.bodyUI;t.rotation=0,t.rotationX=0,t.bounds={x:1.25*e.x,y:1.25*e.y,z:1.25*e.z},t.target=[e.x/2,e.y/2,e.z/2]}updateSex(e){this.sex=e,this.sexChange.emit(this.sex),this.cdr.markForCheck()}updateSide(e){this.side=e,this.sideChange.emit(this.side),this.cdr.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(No(dR),No(Kl),No(ca))},e.\u0275cmp=qe({type:e,selectors:[["ccf-organ"]],viewQuery:function(e,t){if(1&e&&Ja(TR,5),2&e){let e;Qa(e=eu())&&(t.bodyUI=e.first)}},inputs:{organIri:"organIri",sex:"sex",side:"side"},outputs:{sexChange:"sexChange",sideChange:"sideChange"},features:[ht],decls:6,vars:11,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick"],["bodyUI",""],[1,"stage-options"],[1,"view-slider",3,"labels","value","valueChange"],[1,"view-slider",3,"labels","value","disabled","valueChange"]],template:function(e,t){1&e&&(Bo(0,"ccf-body-ui",0,1),Wo("nodeClick",function(e){return t.ga.event("node_click","organ",e.node["@id"])}),La(2,"async"),zo(),Bo(3,"div",2),Bo(4,"ccf-slide-toggle",3),Wo("valueChange",function(e){return t.updateSex(e)}),zo(),Bo(5,"ccf-slide-toggle",4),Wo("valueChange",function(e){return t.updateSide(e)}),zo(),zo()),2&e&&(Lo("scene",Fa(2,7,t.scene$))("interactive",!0),ci(4),Lo("labels",Ra(9,OR))("value",t.sex),ci(1),Lo("labels",Ra(10,IR))("value",t.side)("disabled",!t.side))},directives:[fM,kR],pipes:[vc],styles:["[_nghost-%COMP%]{display:block;background-color:#000;border-radius:.5rem;color:#fff;padding:1rem}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{height:525px}"],changeDetection:0}),e})();function DR(e,t){if(1&e&&(Bo(0,"div",3),Bo(1,"div",4),fs(2),zo(),Bo(3,"div",5),fs(4),zo(),zo()),2&e){const e=t.$implicit;ci(2),ps(e.count),ci(2),ps(e.label)}}let jR=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=qe({type:e,selectors:[["ccf-stats-list"]],inputs:{statsLabel:"statsLabel",stats:"stats"},decls:4,vars:2,consts:[[1,"stats-container"],[1,"header"],["class","stats-row",4,"ngFor","ngForOf"],[1,"stats-row"],[1,"stat"],[1,"label"]],template:function(e,t){1&e&&(Bo(0,"div",0),Bo(1,"div",1),fs(2),zo(),Mo(3,DR,5,2,"div",2),zo()),2&e&&(ci(2),gs(" ",t.statsLabel," "),ci(1),Lo("ngForOf",t.stats))},directives:[dc],styles:[".stats-container[_ngcontent-%COMP%]{margin-bottom:2rem;min-height:9rem}.stats-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:1rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:2rem;margin-right:1rem;text-align:right}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"],changeDetection:0}),e})();function PR(e,t){if(1&e){const e=Vo();Bo(0,"div",6),Bo(1,"div",7),Bo(2,"div",8),fs(3),zo(),Bo(4,"div",9),Wo("click",function(){const t=Mt(e).$implicit;return Ko().goToURL(t.buttonUrl)}),fs(5),zo(),zo(),zo()}if(2&e){const e=t.$implicit;ci(3),ps(e.body),ci(1),Lo("gaLabel",e.buttonUrl),ci(1),gs(" ",e.buttonTitle,"")}}function MR(e,t){if(1&e){const e=Vo();Bo(0,"div",10),Wo("click",function(){const t=Mt(e).$implicit;return Ko().goToURL(t.buttonUrl)}),fs(1),zo()}if(2&e){const e=t.$implicit;Lo("gaLabel",e.buttonUrl),ci(1),ps(e.buttonTitle)}}let RR=(()=>{class e{constructor(){this.linkCards=[{body:"Add tissue blocks using the CCF Registration User Interface (RUI).",buttonTitle:"Register Tissue",buttonUrl:"https://hubmapconsortium.github.io/ccf-ui/rui/"},{body:"Explore tissue sections in tissue blocks with the CCF Exploration User Interface (EUI).",buttonTitle:"Explore Tissue",buttonUrl:"https://portal.hubmapconsortium.org/ccf-eui"},{body:"View linkages between anatomical structures, cell types, and common biomarkers (ASCT+B).",buttonTitle:"ASCT+B Reporter",buttonUrl:"https://hubmapconsortium.github.io/ccf-asct-reporter/"}],this.deepDives=[{body:"",buttonTitle:"CCF Portal",buttonUrl:"https://hubmapconsortium.github.io/ccf/"},{body:"",buttonTitle:"Online Course",buttonUrl:"https://expand.iu.edu/browse/sice/cns/courses/hubmap-visible-human-mooc"},{body:"",buttonTitle:"Paper",buttonUrl:"https://www.biorxiv.org/content/10.1101/2021.05.31.446440v2"}]}goToURL(e){window.open(e,"_blank")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=qe({type:e,selectors:[["ccf-link-cards"]],decls:7,vars:2,consts:[["gaCategory","link-cards",1,"link-cards-container"],["class","link-card",4,"ngFor","ngForOf"],["gaCategory","deep-dive",1,"deep-dive-section"],[1,"title"],[1,"button-container"],["class","btn-outline btn","gaEvent","visit-link",3,"gaLabel","click",4,"ngFor","ngForOf"],[1,"link-card"],[1,"link-card-content"],[1,"body"],["gaEvent","visit-link",1,"link-button","btn",3,"gaLabel","click"],["gaEvent","visit-link",1,"btn-outline","btn",3,"gaLabel","click"]],template:function(e,t){1&e&&(Bo(0,"div",0),Mo(1,PR,6,3,"div",1),zo(),Bo(2,"div",2),Bo(3,"div",3),fs(4,"Common Coordinate Framework (CCF) Deep Dive"),zo(),Bo(5,"div",4),Mo(6,MR,2,2,"div",5),zo(),zo()),2&e&&(ci(1),Lo("ngForOf",t.linkCards),ci(5),Lo("ngForOf",t.deepDives))},directives:[Hl,dc,Zl],styles:[".link-cards-container[_ngcontent-%COMP%]{max-width:30rem}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:1px;padding-bottom:1px}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid #e0e0e0}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]{align-items:center;padding:1rem 0 1rem 1rem;display:flex;flex-direction:row;justify-content:space-between;border-left:6px solid #444a65}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]{margin-left:2rem;background-color:#444a65;color:#fff}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]:hover{background-color:#2f3346}.deep-dive-section[_ngcontent-%COMP%]{margin-top:2rem}.deep-dive-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{color:#444a65;border:1px solid #444a65;background-color:#fff}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:not(:last-of-type){margin-right:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn[_ngcontent-%COMP%]{min-width:9rem!important;max-height:2.28125rem;text-align:center;white-space:nowrap;cursor:pointer;font-size:.875rem;font-weight:500;border-radius:2px;line-height:2.75;transition:background-color .25s cubic-bezier(.4,0,.2,1) 0ms,box-shadow .25s cubic-bezier(.4,0,.2,1) 0ms,border .25s cubic-bezier(.4,0,.2,1) 0ms;font-family:Inter Variable,Helvetica,Arial,sans-serif}"],changeDetection:0}),e})(),NR=(()=>{class e{constructor(e,t,n){this.source=e,this.ga=t,this.cdr=n,this.sex="Female",this.side="Left",this.statsLabel="Loading...",this.referenceOrgans$=this.source.getReferenceOrgans().pipe(HD(1))}get organIri(){return this._organIri}set organIri(e){var t;this._organIri=e,null===(t=this.ga)||void 0===t||t.event("update_iri","organ",e),this.cdr.markForCheck()}ngOnChanges(){this.referenceOrgans$.pipe(Tl(1)).subscribe(e=>{var t;let n=gM.find(e=>e.id===this.organIri);if(n){if(n.side&&n.side!==(null===(t=this.side)||void 0===t?void 0:t.toLowerCase())){const e=gM.find(e=>{var t;return e.organ===(null==n?void 0:n.organ)&&e.side===(null===(t=this.side)||void 0===t?void 0:t.toLowerCase())});e&&(n=e,this._organIri=e.id,this.ga.event("update_iri","organ",this.organIri))}this.statsLabel=[this.sex,n.organ,this.side].filter(e=>!!e).join(", "),this.stats$=this.source.getAggregateResults({sex:this.sex,ontologyTerms:[n.id]})}else this.statsLabel=`Unknown IRI: ${this.organIri}`,this.stats$=il([]),this.ga.exception(this.statsLabel,!1);this.cdr.markForCheck()})}updateSex(e){this.sex=e,this.ga.event("update_sex","organ",e.toLowerCase()),this.ngOnChanges()}updateSide(e){this.side=e,this.ga.event("update_side","organ",e.toLowerCase()),this.ngOnChanges()}}return e.\u0275fac=function(t){return new(t||e)(No(dR),No(Kl),No(ca))},e.\u0275cmp=qe({type:e,selectors:[["ccf-root"]],inputs:{organIri:"organIri",sex:"sex",side:"side"},features:[ht],decls:7,vars:7,consts:[[1,"container"],[1,"left"],[3,"sex","side","organIri","sexChange","sideChange"],[1,"right"],[3,"statsLabel","stats"]],template:function(e,t){1&e&&(Bo(0,"div",0),Bo(1,"div",1),Bo(2,"ccf-organ",2),Wo("sexChange",function(e){return t.updateSex(e)})("sideChange",function(e){return t.updateSide(e)}),zo(),zo(),Bo(3,"div",3),Uo(4,"ccf-stats-list",4),La(5,"async"),Uo(6,"ccf-link-cards"),zo(),zo()),2&e&&(ci(2),Lo("sex",t.sex)("side",t.side)("organIri",t.organIri),ci(2),Lo("statsLabel",t.statsLabel)("stats",Fa(5,5,t.stats$)))},directives:[CR,jR,RR],pipes:[vc],styles:[".container[_ngcontent-%COMP%]{width:100%;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:row;padding:1rem;font-family:Inter;font-size:.95rem;line-height:1.5;text-align:left;position:relative;background-color:#fff;color:#000}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:auto}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:2rem;width:29rem}"],changeDetection:0}),e})(),LR=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[bc,AR]]}),e})(),FR=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[bc,pM,LR]]}),e})(),BR=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[bc,Ql]]}),e})(),zR=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({imports:[[bc]]}),e})(),UR=(()=>{class e{constructor(e){this.injector=e}ngDoBootstrap(){const e=function(e,t){const n=function(e,t){return t.get(Rs).resolveComponentFactory(e).inputs}(e,t.injector),r=t.strategyFactory||new vl(e,t.injector),i=function(e){const t={};return e.forEach(({propName:e,templateName:n})=>{var r;t[(r=n,r.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`))]=e}),t}(n);class o extends _l{constructor(e){super(),this.injector=e}get ngElementStrategy(){if(!this._ngElementStrategy){const e=this._ngElementStrategy=r.create(this.injector||t.injector);n.forEach(({propName:t})=>{if(!this.hasOwnProperty(t))return;const n=this[t];delete this[t],e.setInputValue(t,n)})}return this._ngElementStrategy}attributeChangedCallback(e,t,n,r){this.ngElementStrategy.setInputValue(i[e],n)}connectedCallback(){let e=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),e=!0),this.ngElementStrategy.connect(this),e||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(e=>{const t=function(e,t,n){if("function"!=typeof CustomEvent){const r=e.createEvent("CustomEvent");return r.initCustomEvent(t,!1,!1,n),r}return new CustomEvent(t,{bubbles:!1,cancelable:!1,detail:n})}(this.ownerDocument,e.name,e.value);this.dispatchEvent(t)})}}return o.observedAttributes=Object.keys(i),n.forEach(({propName:e})=>{Object.defineProperty(o.prototype,e,{get(){return this.ngElementStrategy.getInputValue(e)},set(t){this.ngElementStrategy.setInputValue(e,t)},configurable:!0,enumerable:!0})}),o}(NR,{injector:this.injector});customElements.define("ccf-organ-info",e)}}return e.\u0275fac=function(t){return new(t||e)(ur(bo))},e.\u0275mod=Ke({type:e}),e.\u0275inj=ge({providers:[],imports:[[Zc,BR,zR,FR,Jl.forRoot({gaToken:eh.googleAnalyticsToken,appName:"organ-info",projectName:"ccf",developmentMode:!eh.production})]]}),e})();eh.production&&function(){if(Lu)throw new Error("Cannot enable prod mode after platform setup.");Nu=!1}(),Xc().bootstrapModule(UR).catch(e=>console.error(e))},948:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},321:e=>{function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=t=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),t(n)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0},774:(e,t,n)=>{e.exports=n(941)},82:e=>{function t(e){return Promise.resolve().then(()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=82,e.exports=t},540:()=>{},207:()=>{},307:()=>{}},e=>{"use strict";e(e.s=481)}]);