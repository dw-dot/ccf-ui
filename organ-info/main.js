var hIe=Object.defineProperty,fIe=Object.defineProperties,pIe=Object.getOwnPropertyDescriptors,gx=Object.getOwnPropertySymbols,iW=Object.prototype.hasOwnProperty,rW=Object.prototype.propertyIsEnumerable,fr=Math.pow,sW=(Vt,it,tt)=>it in Vt?hIe(Vt,it,{enumerable:!0,configurable:!0,writable:!0,value:tt}):Vt[it]=tt,ht=(Vt,it)=>{for(var tt in it||(it={}))iW.call(it,tt)&&sW(Vt,tt,it[tt]);if(gx)for(var tt of gx(it))rW.call(it,tt)&&sW(Vt,tt,it[tt]);return Vt},jn=(Vt,it)=>fIe(Vt,pIe(it)),oW=(Vt,it)=>{var tt={};for(var gt in Vt)iW.call(Vt,gt)&&it.indexOf(gt)<0&&(tt[gt]=Vt[gt]);if(null!=Vt&&gx)for(var gt of gx(Vt))it.indexOf(gt)<0&&rW.call(Vt,gt)&&(tt[gt]=Vt[gt]);return tt};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:(Vt,it,tt)=>{var gt=tt(52).default;Vt.exports=function Y(Ae,he,W){function j($,b){if(!he[$]){if(!Ae[$]){if(L)return L($,!0);var R=new Error("Cannot find module '"+$+"'");throw R.code="MODULE_NOT_FOUND",R}var A=he[$]={exports:{}};Ae[$][0].call(A.exports,function(v){return j(Ae[$][1][v]||v)},A,A.exports,Y,Ae,he,W)}return he[$].exports}for(var L=void 0,re=0;re<W.length;re++)j(W[re]);return j}({1:[function(Y,Ae,he){var W,j;W=this,j=function(W,j,L,re,$){"use strict";function D(Ee,Ie,Ue,qe){return new(Ue||(Ue=Promise))(function(z,X){function be(wt){try{Pe(qe.next(wt))}catch(pt){X(pt)}}function ce(wt){try{Pe(qe.throw(wt))}catch(pt){X(pt)}}function Pe(wt){wt.done?z(wt.value):function(z){return z instanceof Ue?z:new Ue(function(X){X(z)})}(wt.value).then(be,ce)}Pe((qe=qe.apply(Ee,Ie||[])).next())})}function V(Ee,Ie){var qe,Be,z,X,Ue={label:0,sent:function(){if(1&z[0])throw z[1];return z[1]},trys:[],ops:[]};return X={next:be(0),throw:be(1),return:be(2)},"function"==typeof Symbol&&(X[Symbol.iterator]=function(){return this}),X;function be(Pe){return function(wt){return function(Pe){if(qe)throw new TypeError("Generator is already executing.");for(;Ue;)try{if(qe=1,Be&&(z=2&Pe[0]?Be.return:Pe[0]?Be.throw||((z=Be.return)&&z.call(Be),0):Be.next)&&!(z=z.call(Be,Pe[1])).done)return z;switch(Be=0,z&&(Pe=[2&Pe[0],z.value]),Pe[0]){case 0:case 1:z=Pe;break;case 4:return Ue.label++,{value:Pe[1],done:!1};case 5:Ue.label++,Be=Pe[1],Pe=[0];continue;case 7:Pe=Ue.ops.pop(),Ue.trys.pop();continue;default:if(!(z=(z=Ue.trys).length>0&&z[z.length-1])&&(6===Pe[0]||2===Pe[0])){Ue=0;continue}if(3===Pe[0]&&(!z||Pe[1]>z[0]&&Pe[1]<z[3])){Ue.label=Pe[1];break}if(6===Pe[0]&&Ue.label<z[1]){Ue.label=z[1],z=Pe;break}if(z&&Ue.label<z[2]){Ue.label=z[2],Ue.ops.push(Pe);break}z[2]&&Ue.ops.pop(),Ue.trys.pop();continue}Pe=Ie.call(Ee,Ue)}catch(wt){Pe=[6,wt],Be=0}finally{qe=z=0}if(5&Pe[0])throw Pe[1];return{value:Pe[0]?Pe[1]:void 0,done:!0}}([Pe,wt])}}}function nt(Ee){var Ie=Ee.length,Ue=0;return new $.Readable({objectMode:!0,read:function(){this.push(Ue<Ie?Ee[Ue++]:null)}})}W.addJsonLdToStore=function(Ee,Ie){return D(this,void 0,void 0,function(){var Ue,qe,Be;return V(this,function(z){switch(z.label){case 0:return"string"!=typeof Ee?[3,4]:[4,fetch(Ee,{redirect:"follow"})];case 1:return(qe=z.sent()).ok?[4,qe.json()]:[3,3];case 2:Ue=z.sent(),z.label=3;case 3:return[3,5];case 4:Ue=Ee,z.label=5;case 5:return Ue?[4,j.toRDF(Ue)]:[3,7];case 6:Be=z.sent(),Ie.import(nt(Be)),z.label=7;case 7:return[2,Ie]}})})},W.addN3ToStore=function(Ee,Ie){return D(this,void 0,void 0,function(){var Ue,qe,Be;return V(this,function(z){switch(z.label){case 0:return"string"==typeof Ee&&(null==Ee?void 0:Ee.startsWith("http"))?[4,fetch(Ee,{redirect:"follow"})]:[3,4];case 1:return(qe=z.sent()).ok?[4,qe.text()]:[3,3];case 2:Ue=z.sent(),z.label=3;case 3:return[3,5];case 4:Ue=Ee,z.label=5;case 5:return Ue&&(Be=new L.Parser({format:"n3"}).parse(Ue),Ie.import(nt(Be))),[2,Ie]}})})},W.addRdfXmlToStore=function(Ee,Ie){return D(this,void 0,void 0,function(){var Ue,qe,Be,z;return V(this,function(X){switch(X.label){case 0:return"string"==typeof Ee&&(null==Ee?void 0:Ee.startsWith("http"))?[4,fetch(Ee,{redirect:"follow"})]:[3,4];case 1:return(qe=X.sent()).ok?[4,qe.text()]:[3,3];case 2:Ue=X.sent(),X.label=3;case 3:return[3,5];case 4:Ue=Ee,X.label=5;case 5:return Ue?(Be=new re.RdfXmlParser({dataFactory:L.DataFactory,strict:!0}),z=new Promise(function(be){Be.once("end",function(){return be(Ie)})}),Ie.import(Be),Be.write(Ue),Be.end(),[2,z]):[2,Ie]}})})},W.arrayToStream=nt,W.deserializeN3Store=function(Ee,Ie){var Ue=JSON.parse(Ee),qe=new L.Store;return Object.assign(qe,Ue,{_factory:null!=Ie?Ie:L.DataFactory}),qe},W.serializeN3Store=function(Ee){var Ie=Object.assign({},Ee);return delete Ie._factory,JSON.stringify(Ie)},W.streamToArray=function(Ee){return new Promise(function(Ie,Ue){var qe=[];Ee.on("data",function(Be){qe.push(Be)}).once("end",function(){Ie(qe)}).once("error",function(Be){Ue(Be)})})},Object.keys(L).forEach(function(Ee){"default"!==Ee&&!W.hasOwnProperty(Ee)&&Object.defineProperty(W,Ee,{enumerable:!0,get:function(){return L[Ee]}})}),Object.defineProperty(W,"__esModule",{value:!0})},"object"==typeof he&&void 0!==Ae?j(he,Y("jsonld"),Y("n3"),Y("rdfxml-streaming-parser"),Y("readable-stream")):j((W="undefined"!=typeof globalThis?globalThis:W||self).tripleStoreUtils={},W.jsonld,W.n3,W.rdfxmlStreamingParser,W.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(Y,Ae,he){"use strict";he.byteLength=function(V){var I=S(V),K=I[1];return 3*(I[0]+K)/4-K},he.toByteArray=function(V){var I,U,H=S(V),K=H[0],M=H[1],F=new L(function(V,I,H){return 3*(I+H)/4-H}(0,K,M)),Q=0,E=M>0?K-4:K;for(U=0;U<E;U+=4)I=j[V.charCodeAt(U)]<<18|j[V.charCodeAt(U+1)]<<12|j[V.charCodeAt(U+2)]<<6|j[V.charCodeAt(U+3)],F[Q++]=I>>16&255,F[Q++]=I>>8&255,F[Q++]=255&I;return 2===M&&(I=j[V.charCodeAt(U)]<<2|j[V.charCodeAt(U+1)]>>4,F[Q++]=255&I),1===M&&(I=j[V.charCodeAt(U)]<<10|j[V.charCodeAt(U+1)]<<4|j[V.charCodeAt(U+2)]>>2,F[Q++]=I>>8&255,F[Q++]=255&I),F},he.fromByteArray=function(V){for(var I,H=V.length,K=H%3,M=[],F=16383,Q=0,E=H-K;Q<E;Q+=F)M.push(w(V,Q,Q+F>E?E:Q+F));return 1===K?M.push(W[(I=V[H-1])>>2]+W[I<<4&63]+"=="):2===K&&M.push(W[(I=(V[H-2]<<8)+V[H-1])>>10]+W[I>>4&63]+W[I<<2&63]+"="),M.join("")};for(var W=[],j=[],L="undefined"!=typeof Uint8Array?Uint8Array:Array,re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$=0,b=re.length;$<b;++$)W[$]=re[$],j[re.charCodeAt($)]=$;function S(V){var I=V.length;if(I%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var H=V.indexOf("=");return-1===H&&(H=I),[H,H===I?0:4-H%4]}function y(V){return W[V>>18&63]+W[V>>12&63]+W[V>>6&63]+W[63&V]}function w(V,I,H){for(var M=[],F=I;F<H;F+=3)M.push(y((V[F]<<16&16711680)+(V[F+1]<<8&65280)+(255&V[F+2])));return M.join("")}j["-".charCodeAt(0)]=62,j["_".charCodeAt(0)]=63},{}],3:[function(Y,Ae,he){},{}],4:[function(Y,Ae,he){var W=Y("buffer"),j=W.Buffer;function L($,b){for(var S in $)b[S]=$[S]}function re($,b,S){return j($,b,S)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Ae.exports=W:(L(W,he),he.Buffer=re),L(j,re),re.from=function($,b,S){if("number"==typeof $)throw new TypeError("Argument must not be a number");return j($,b,S)},re.alloc=function($,b,S){if("number"!=typeof $)throw new TypeError("Argument must be a number");var R=j($);return void 0!==b?"string"==typeof S?R.fill(b,S):R.fill(b):R.fill(0),R},re.allocUnsafe=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return j($)},re.allocUnsafeSlow=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return W.SlowBuffer($)}},{buffer:6}],5:[function(Y,Ae,he){"use strict";var W=Y("safe-buffer").Buffer,j=W.isEncoding||function(M){switch((M=""+M)&&M.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function $(M){var F;switch(this.encoding=function(M){var F=function(M){if(!M)return"utf8";for(var F;;)switch(M){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return M;default:if(F)return;M=(""+M).toLowerCase(),F=!0}}(M);if("string"!=typeof F&&(W.isEncoding===j||!j(M)))throw new Error("Unknown encoding: "+M);return F||M}(M),this.encoding){case"utf16le":this.text=w,this.end=D,F=4;break;case"utf8":this.fillLast=A,F=4;break;case"base64":this.text=V,this.end=I,F=3;break;default:return this.write=H,void(this.end=K)}this.lastNeed=0,this.lastTotal=0,this.lastChar=W.allocUnsafe(F)}function b(M){return M<=127?0:M>>5==6?2:M>>4==14?3:M>>3==30?4:M>>6==2?-1:-2}function A(M){var F=this.lastTotal-this.lastNeed,Q=function(M,F,Q){if(128!=(192&F[0]))return M.lastNeed=0,"\ufffd";if(M.lastNeed>1&&F.length>1){if(128!=(192&F[1]))return M.lastNeed=1,"\ufffd";if(M.lastNeed>2&&F.length>2&&128!=(192&F[2]))return M.lastNeed=2,"\ufffd"}}(this,M);return void 0!==Q?Q:this.lastNeed<=M.length?(M.copy(this.lastChar,F,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(M.copy(this.lastChar,F,0,M.length),void(this.lastNeed-=M.length))}function w(M,F){if((M.length-F)%2==0){var Q=M.toString("utf16le",F);if(Q){var E=Q.charCodeAt(Q.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=M[M.length-2],this.lastChar[1]=M[M.length-1],Q.slice(0,-1)}return Q}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=M[M.length-1],M.toString("utf16le",F,M.length-1)}function D(M){var F=M&&M.length?this.write(M):"";return this.lastNeed?F+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):F}function V(M,F){var Q=(M.length-F)%3;return 0===Q?M.toString("base64",F):(this.lastNeed=3-Q,this.lastTotal=3,1===Q?this.lastChar[0]=M[M.length-1]:(this.lastChar[0]=M[M.length-2],this.lastChar[1]=M[M.length-1]),M.toString("base64",F,M.length-Q))}function I(M){var F=M&&M.length?this.write(M):"";return this.lastNeed?F+this.lastChar.toString("base64",0,3-this.lastNeed):F}function H(M){return M.toString(this.encoding)}function K(M){return M&&M.length?this.write(M):""}he.StringDecoder=$,$.prototype.write=function(M){if(0===M.length)return"";var F,Q;if(this.lastNeed){if(void 0===(F=this.fillLast(M)))return"";Q=this.lastNeed,this.lastNeed=0}else Q=0;return Q<M.length?F?F+this.text(M,Q):this.text(M,Q):F||""},$.prototype.end=function(M){var F=M&&M.length?this.write(M):"";return this.lastNeed?F+"\ufffd":F},$.prototype.text=function(M,F){var Q=function(M,F,Q){var E=F.length-1;if(E<Q)return 0;var U=b(F[E]);return U>=0?(U>0&&(M.lastNeed=U-1),U):--E<Q||-2===U?0:(U=b(F[E]))>=0?(U>0&&(M.lastNeed=U-2),U):--E<Q||-2===U?0:(U=b(F[E]))>=0?(U>0&&(2===U?U=0:M.lastNeed=U-3),U):0}(this,M,F);if(!this.lastNeed)return M.toString("utf8",F);this.lastTotal=Q;var E=M.length-(Q-this.lastNeed);return M.copy(this.lastChar,0,E),M.toString("utf8",F,E)},$.prototype.fillLast=function(M){if(this.lastNeed<=M.length)return M.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);M.copy(this.lastChar,this.lastTotal-this.lastNeed,0,M.length),this.lastNeed-=M.length}},{"safe-buffer":4}],6:[function(Y,Ae,he){(function(W){(function(){"use strict";var j=Y("base64-js"),L=Y("ieee754");he.Buffer=S,he.SlowBuffer=function(B){return+B!=B&&(B=0),S.alloc(+B)},he.INSPECT_MAX_BYTES=50;var re=2147483647;function b(B){if(B>re)throw new RangeError('The value "'+B+'" is invalid for option "size"');var O=new Uint8Array(B);return O.__proto__=S.prototype,O}function S(B,O,k){if("number"==typeof B){if("string"==typeof O)throw new TypeError('The "string" argument must be of type string. Received type number');return y(B)}return R(B,O,k)}function R(B,O,k){if("string"==typeof B)return function(B,O){if(("string"!=typeof O||""===O)&&(O="utf8"),!S.isEncoding(O))throw new TypeError("Unknown encoding: "+O);var k=0|M(B,O),Oe=b(k),Xe=Oe.write(B,O);return Xe!==k&&(Oe=Oe.slice(0,Xe)),Oe}(B,O);if(ArrayBuffer.isView(B))return D(B);if(null==B)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(pt(B,ArrayBuffer)||B&&pt(B.buffer,ArrayBuffer))return function(B,O,k){if(O<0||B.byteLength<O)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<O+(k||0))throw new RangeError('"length" is outside of buffer bounds');var Oe;return(Oe=void 0===O&&void 0===k?new Uint8Array(B):void 0===k?new Uint8Array(B,O):new Uint8Array(B,O,k)).__proto__=S.prototype,Oe}(B,O,k);if("number"==typeof B)throw new TypeError('The "value" argument must not be of type number. Received type number');var Oe=B.valueOf&&B.valueOf();if(null!=Oe&&Oe!==B)return S.from(Oe,O,k);var Xe=function(B){if(S.isBuffer(B)){var O=0|H(B.length),k=b(O);return 0===k.length||B.copy(k,0,0,O),k}return void 0!==B.length?"number"!=typeof B.length||pe(B.length)?b(0):D(B):"Buffer"===B.type&&Array.isArray(B.data)?D(B.data):void 0}(B);if(Xe)return Xe;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof B[Symbol.toPrimitive])return S.from(B[Symbol.toPrimitive]("string"),O,k);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function A(B){if("number"!=typeof B)throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function y(B){return A(B),b(B<0?0:0|H(B))}function D(B){for(var O=B.length<0?0:0|H(B.length),k=b(O),Oe=0;Oe<O;Oe+=1)k[Oe]=255&B[Oe];return k}function H(B){if(B>=re)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+re.toString(16)+" bytes");return 0|B}function M(B,O){if(S.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||pt(B,ArrayBuffer))return B.byteLength;if("string"!=typeof B)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var k=B.length,Oe=arguments.length>2&&!0===arguments[2];if(!Oe&&0===k)return 0;for(var Xe=!1;;)switch(O){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":return X(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*k;case"hex":return k>>>1;case"base64":return Pe(B).length;default:if(Xe)return Oe?-1:X(B).length;O=(""+O).toLowerCase(),Xe=!0}}function F(B,O,k){var Oe=!1;if((void 0===O||O<0)&&(O=0),O>this.length||((void 0===k||k>this.length)&&(k=this.length),k<=0)||(k>>>=0)<=(O>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return Je(this,O,k);case"utf8":case"utf-8":return _e(this,O,k);case"ascii":return nt(this,O,k);case"latin1":case"binary":return Ze(this,O,k);case"base64":return te(this,O,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ke(this,O,k);default:if(Oe)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),Oe=!0}}function Q(B,O,k){var Oe=B[O];B[O]=B[k],B[k]=Oe}function E(B,O,k,Oe,Xe){if(0===B.length)return-1;if("string"==typeof k?(Oe=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),pe(k=+k)&&(k=Xe?0:B.length-1),k<0&&(k=B.length+k),k>=B.length){if(Xe)return-1;k=B.length-1}else if(k<0){if(!Xe)return-1;k=0}if("string"==typeof O&&(O=S.from(O,Oe)),S.isBuffer(O))return 0===O.length?-1:U(B,O,k,Oe,Xe);if("number"==typeof O)return O&=255,"function"==typeof Uint8Array.prototype.indexOf?Xe?Uint8Array.prototype.indexOf.call(B,O,k):Uint8Array.prototype.lastIndexOf.call(B,O,k):U(B,[O],k,Oe,Xe);throw new TypeError("val must be string, number or Buffer")}function U(B,O,k,Oe,Xe){var zn,yt=1,It=B.length,An=O.length;if(void 0!==Oe&&("ucs2"===(Oe=String(Oe).toLowerCase())||"ucs-2"===Oe||"utf16le"===Oe||"utf-16le"===Oe)){if(B.length<2||O.length<2)return-1;yt=2,It/=2,An/=2,k/=2}function Rn(Is,ss){return 1===yt?Is[ss]:Is.readUInt16BE(ss*yt)}if(Xe){var _i=-1;for(zn=k;zn<It;zn++)if(Rn(B,zn)===Rn(O,-1===_i?0:zn-_i)){if(-1===_i&&(_i=zn),zn-_i+1===An)return _i*yt}else-1!==_i&&(zn-=zn-_i),_i=-1}else for(k+An>It&&(k=It-An),zn=k;zn>=0;zn--){for(var ci=!0,jr=0;jr<An;jr++)if(Rn(B,zn+jr)!==Rn(O,jr)){ci=!1;break}if(ci)return zn}return-1}function ie(B,O,k,Oe){k=Number(k)||0;var Xe=B.length-k;Oe?(Oe=Number(Oe))>Xe&&(Oe=Xe):Oe=Xe;var yt=O.length;Oe>yt/2&&(Oe=yt/2);for(var It=0;It<Oe;++It){var An=parseInt(O.substr(2*It,2),16);if(pe(An))return It;B[k+It]=An}return It}function ue(B,O,k,Oe){return wt(X(O,B.length-k),B,k,Oe)}function ee(B,O,k,Oe){return wt(function(B){for(var O=[],k=0;k<B.length;++k)O.push(255&B.charCodeAt(k));return O}(O),B,k,Oe)}function se(B,O,k,Oe){return ee(B,O,k,Oe)}function Te(B,O,k,Oe){return wt(Pe(O),B,k,Oe)}function ve(B,O,k,Oe){return wt(function(B,O){for(var k,Oe,yt=[],It=0;It<B.length&&!((O-=2)<0);++It)Oe=(k=B.charCodeAt(It))>>8,yt.push(k%256),yt.push(Oe);return yt}(O,B.length-k),B,k,Oe)}function te(B,O,k){return j.fromByteArray(0===O&&k===B.length?B:B.slice(O,k))}function _e(B,O,k){k=Math.min(B.length,k);for(var Oe=[],Xe=O;Xe<k;){var Rn,zn,_i,ci,yt=B[Xe],It=null,An=yt>239?4:yt>223?3:yt>191?2:1;if(Xe+An<=k)switch(An){case 1:yt<128&&(It=yt);break;case 2:128==(192&(Rn=B[Xe+1]))&&(ci=(31&yt)<<6|63&Rn)>127&&(It=ci);break;case 3:zn=B[Xe+2],128==(192&(Rn=B[Xe+1]))&&128==(192&zn)&&(ci=(15&yt)<<12|(63&Rn)<<6|63&zn)>2047&&(ci<55296||ci>57343)&&(It=ci);break;case 4:zn=B[Xe+2],_i=B[Xe+3],128==(192&(Rn=B[Xe+1]))&&128==(192&zn)&&128==(192&_i)&&(ci=(15&yt)<<18|(63&Rn)<<12|(63&zn)<<6|63&_i)>65535&&ci<1114112&&(It=ci)}null===It?(It=65533,An=1):It>65535&&(Oe.push((It-=65536)>>>10&1023|55296),It=56320|1023&It),Oe.push(It),Xe+=An}return function(B){var O=B.length;if(O<=4096)return String.fromCharCode.apply(String,B);for(var k="",Oe=0;Oe<O;)k+=String.fromCharCode.apply(String,B.slice(Oe,Oe+=4096));return k}(Oe)}he.kMaxLength=re,!(S.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===B.foo()}catch(O){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(S.prototype,"parent",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.buffer}}),Object.defineProperty(S.prototype,"offset",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&S[Symbol.species]===S&&Object.defineProperty(S,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),S.poolSize=8192,S.from=function(B,O,k){return R(B,O,k)},S.prototype.__proto__=Uint8Array.prototype,S.__proto__=Uint8Array,S.alloc=function(B,O,k){return function(B,O,k){return A(B),B<=0?b(B):void 0!==O?"string"==typeof k?b(B).fill(O,k):b(B).fill(O):b(B)}(B,O,k)},S.allocUnsafe=function(B){return y(B)},S.allocUnsafeSlow=function(B){return y(B)},S.isBuffer=function(O){return null!=O&&!0===O._isBuffer&&O!==S.prototype},S.compare=function(O,k){if(pt(O,Uint8Array)&&(O=S.from(O,O.offset,O.byteLength)),pt(k,Uint8Array)&&(k=S.from(k,k.offset,k.byteLength)),!S.isBuffer(O)||!S.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(O===k)return 0;for(var Oe=O.length,Xe=k.length,yt=0,It=Math.min(Oe,Xe);yt<It;++yt)if(O[yt]!==k[yt]){Oe=O[yt],Xe=k[yt];break}return Oe<Xe?-1:Xe<Oe?1:0},S.isEncoding=function(O){switch(String(O).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},S.concat=function(O,k){if(!Array.isArray(O))throw new TypeError('"list" argument must be an Array of Buffers');if(0===O.length)return S.alloc(0);var Oe;if(void 0===k)for(k=0,Oe=0;Oe<O.length;++Oe)k+=O[Oe].length;var Xe=S.allocUnsafe(k),yt=0;for(Oe=0;Oe<O.length;++Oe){var It=O[Oe];if(pt(It,Uint8Array)&&(It=S.from(It)),!S.isBuffer(It))throw new TypeError('"list" argument must be an Array of Buffers');It.copy(Xe,yt),yt+=It.length}return Xe},S.byteLength=M,S.prototype._isBuffer=!0,S.prototype.swap16=function(){var O=this.length;if(O%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var k=0;k<O;k+=2)Q(this,k,k+1);return this},S.prototype.swap32=function(){var O=this.length;if(O%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var k=0;k<O;k+=4)Q(this,k,k+3),Q(this,k+1,k+2);return this},S.prototype.swap64=function(){var O=this.length;if(O%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var k=0;k<O;k+=8)Q(this,k,k+7),Q(this,k+1,k+6),Q(this,k+2,k+5),Q(this,k+3,k+4);return this},S.prototype.toLocaleString=S.prototype.toString=function(){var O=this.length;return 0===O?"":0===arguments.length?_e(this,0,O):F.apply(this,arguments)},S.prototype.equals=function(O){if(!S.isBuffer(O))throw new TypeError("Argument must be a Buffer");return this===O||0===S.compare(this,O)},S.prototype.inspect=function(){var O="",k=he.INSPECT_MAX_BYTES;return O=this.toString("hex",0,k).replace(/(.{2})/g,"$1 ").trim(),this.length>k&&(O+=" ... "),"<Buffer "+O+">"},S.prototype.compare=function(O,k,Oe,Xe,yt){if(pt(O,Uint8Array)&&(O=S.from(O,O.offset,O.byteLength)),!S.isBuffer(O))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof O);if(void 0===k&&(k=0),void 0===Oe&&(Oe=O?O.length:0),void 0===Xe&&(Xe=0),void 0===yt&&(yt=this.length),k<0||Oe>O.length||Xe<0||yt>this.length)throw new RangeError("out of range index");if(Xe>=yt&&k>=Oe)return 0;if(Xe>=yt)return-1;if(k>=Oe)return 1;if(this===O)return 0;for(var It=(yt>>>=0)-(Xe>>>=0),An=(Oe>>>=0)-(k>>>=0),Rn=Math.min(It,An),zn=this.slice(Xe,yt),_i=O.slice(k,Oe),ci=0;ci<Rn;++ci)if(zn[ci]!==_i[ci]){It=zn[ci],An=_i[ci];break}return It<An?-1:An<It?1:0},S.prototype.includes=function(O,k,Oe){return-1!==this.indexOf(O,k,Oe)},S.prototype.indexOf=function(O,k,Oe){return E(this,O,k,Oe,!0)},S.prototype.lastIndexOf=function(O,k,Oe){return E(this,O,k,Oe,!1)},S.prototype.write=function(O,k,Oe,Xe){if(void 0===k)Xe="utf8",Oe=this.length,k=0;else if(void 0===Oe&&"string"==typeof k)Xe=k,Oe=this.length,k=0;else{if(!isFinite(k))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");k>>>=0,isFinite(Oe)?(Oe>>>=0,void 0===Xe&&(Xe="utf8")):(Xe=Oe,Oe=void 0)}var yt=this.length-k;if((void 0===Oe||Oe>yt)&&(Oe=yt),O.length>0&&(Oe<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");Xe||(Xe="utf8");for(var It=!1;;)switch(Xe){case"hex":return ie(this,O,k,Oe);case"utf8":case"utf-8":return ue(this,O,k,Oe);case"ascii":return ee(this,O,k,Oe);case"latin1":case"binary":return se(this,O,k,Oe);case"base64":return Te(this,O,k,Oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ve(this,O,k,Oe);default:if(It)throw new TypeError("Unknown encoding: "+Xe);Xe=(""+Xe).toLowerCase(),It=!0}},S.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function nt(B,O,k){var Oe="";k=Math.min(B.length,k);for(var Xe=O;Xe<k;++Xe)Oe+=String.fromCharCode(127&B[Xe]);return Oe}function Ze(B,O,k){var Oe="";k=Math.min(B.length,k);for(var Xe=O;Xe<k;++Xe)Oe+=String.fromCharCode(B[Xe]);return Oe}function Je(B,O,k){var Oe=B.length;(!O||O<0)&&(O=0),(!k||k<0||k>Oe)&&(k=Oe);for(var Xe="",yt=O;yt<k;++yt)Xe+=z(B[yt]);return Xe}function Ke(B,O,k){for(var Oe=B.slice(O,k),Xe="",yt=0;yt<Oe.length;yt+=2)Xe+=String.fromCharCode(Oe[yt]+256*Oe[yt+1]);return Xe}function Ve(B,O,k){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+O>k)throw new RangeError("Trying to access beyond buffer length")}function Le(B,O,k,Oe,Xe,yt){if(!S.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(O>Xe||O<yt)throw new RangeError('"value" argument is out of bounds');if(k+Oe>B.length)throw new RangeError("Index out of range")}function Ee(B,O,k,Oe,Xe,yt){if(k+Oe>B.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function Ie(B,O,k,Oe,Xe){return O=+O,k>>>=0,Xe||Ee(B,0,k,4),L.write(B,O,k,Oe,23,4),k+4}function Ue(B,O,k,Oe,Xe){return O=+O,k>>>=0,Xe||Ee(B,0,k,8),L.write(B,O,k,Oe,52,8),k+8}S.prototype.slice=function(O,k){var Oe=this.length;(O=~~O)<0?(O+=Oe)<0&&(O=0):O>Oe&&(O=Oe),(k=void 0===k?Oe:~~k)<0?(k+=Oe)<0&&(k=0):k>Oe&&(k=Oe),k<O&&(k=O);var Xe=this.subarray(O,k);return Xe.__proto__=S.prototype,Xe},S.prototype.readUIntLE=function(O,k,Oe){O>>>=0,k>>>=0,Oe||Ve(O,k,this.length);for(var Xe=this[O],yt=1,It=0;++It<k&&(yt*=256);)Xe+=this[O+It]*yt;return Xe},S.prototype.readUIntBE=function(O,k,Oe){O>>>=0,k>>>=0,Oe||Ve(O,k,this.length);for(var Xe=this[O+--k],yt=1;k>0&&(yt*=256);)Xe+=this[O+--k]*yt;return Xe},S.prototype.readUInt8=function(O,k){return O>>>=0,k||Ve(O,1,this.length),this[O]},S.prototype.readUInt16LE=function(O,k){return O>>>=0,k||Ve(O,2,this.length),this[O]|this[O+1]<<8},S.prototype.readUInt16BE=function(O,k){return O>>>=0,k||Ve(O,2,this.length),this[O]<<8|this[O+1]},S.prototype.readUInt32LE=function(O,k){return O>>>=0,k||Ve(O,4,this.length),(this[O]|this[O+1]<<8|this[O+2]<<16)+16777216*this[O+3]},S.prototype.readUInt32BE=function(O,k){return O>>>=0,k||Ve(O,4,this.length),16777216*this[O]+(this[O+1]<<16|this[O+2]<<8|this[O+3])},S.prototype.readIntLE=function(O,k,Oe){O>>>=0,k>>>=0,Oe||Ve(O,k,this.length);for(var Xe=this[O],yt=1,It=0;++It<k&&(yt*=256);)Xe+=this[O+It]*yt;return Xe>=(yt*=128)&&(Xe-=Math.pow(2,8*k)),Xe},S.prototype.readIntBE=function(O,k,Oe){O>>>=0,k>>>=0,Oe||Ve(O,k,this.length);for(var Xe=k,yt=1,It=this[O+--Xe];Xe>0&&(yt*=256);)It+=this[O+--Xe]*yt;return It>=(yt*=128)&&(It-=Math.pow(2,8*k)),It},S.prototype.readInt8=function(O,k){return O>>>=0,k||Ve(O,1,this.length),128&this[O]?-1*(255-this[O]+1):this[O]},S.prototype.readInt16LE=function(O,k){O>>>=0,k||Ve(O,2,this.length);var Oe=this[O]|this[O+1]<<8;return 32768&Oe?4294901760|Oe:Oe},S.prototype.readInt16BE=function(O,k){O>>>=0,k||Ve(O,2,this.length);var Oe=this[O+1]|this[O]<<8;return 32768&Oe?4294901760|Oe:Oe},S.prototype.readInt32LE=function(O,k){return O>>>=0,k||Ve(O,4,this.length),this[O]|this[O+1]<<8|this[O+2]<<16|this[O+3]<<24},S.prototype.readInt32BE=function(O,k){return O>>>=0,k||Ve(O,4,this.length),this[O]<<24|this[O+1]<<16|this[O+2]<<8|this[O+3]},S.prototype.readFloatLE=function(O,k){return O>>>=0,k||Ve(O,4,this.length),L.read(this,O,!0,23,4)},S.prototype.readFloatBE=function(O,k){return O>>>=0,k||Ve(O,4,this.length),L.read(this,O,!1,23,4)},S.prototype.readDoubleLE=function(O,k){return O>>>=0,k||Ve(O,8,this.length),L.read(this,O,!0,52,8)},S.prototype.readDoubleBE=function(O,k){return O>>>=0,k||Ve(O,8,this.length),L.read(this,O,!1,52,8)},S.prototype.writeUIntLE=function(O,k,Oe,Xe){O=+O,k>>>=0,Oe>>>=0,Xe||Le(this,O,k,Oe,Math.pow(2,8*Oe)-1,0);var It=1,An=0;for(this[k]=255&O;++An<Oe&&(It*=256);)this[k+An]=O/It&255;return k+Oe},S.prototype.writeUIntBE=function(O,k,Oe,Xe){O=+O,k>>>=0,Oe>>>=0,Xe||Le(this,O,k,Oe,Math.pow(2,8*Oe)-1,0);var It=Oe-1,An=1;for(this[k+It]=255&O;--It>=0&&(An*=256);)this[k+It]=O/An&255;return k+Oe},S.prototype.writeUInt8=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,1,255,0),this[k]=255&O,k+1},S.prototype.writeUInt16LE=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,2,65535,0),this[k]=255&O,this[k+1]=O>>>8,k+2},S.prototype.writeUInt16BE=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,2,65535,0),this[k]=O>>>8,this[k+1]=255&O,k+2},S.prototype.writeUInt32LE=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,4,4294967295,0),this[k+3]=O>>>24,this[k+2]=O>>>16,this[k+1]=O>>>8,this[k]=255&O,k+4},S.prototype.writeUInt32BE=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,4,4294967295,0),this[k]=O>>>24,this[k+1]=O>>>16,this[k+2]=O>>>8,this[k+3]=255&O,k+4},S.prototype.writeIntLE=function(O,k,Oe,Xe){if(O=+O,k>>>=0,!Xe){var yt=Math.pow(2,8*Oe-1);Le(this,O,k,Oe,yt-1,-yt)}var It=0,An=1,Rn=0;for(this[k]=255&O;++It<Oe&&(An*=256);)O<0&&0===Rn&&0!==this[k+It-1]&&(Rn=1),this[k+It]=(O/An>>0)-Rn&255;return k+Oe},S.prototype.writeIntBE=function(O,k,Oe,Xe){if(O=+O,k>>>=0,!Xe){var yt=Math.pow(2,8*Oe-1);Le(this,O,k,Oe,yt-1,-yt)}var It=Oe-1,An=1,Rn=0;for(this[k+It]=255&O;--It>=0&&(An*=256);)O<0&&0===Rn&&0!==this[k+It+1]&&(Rn=1),this[k+It]=(O/An>>0)-Rn&255;return k+Oe},S.prototype.writeInt8=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,1,127,-128),O<0&&(O=255+O+1),this[k]=255&O,k+1},S.prototype.writeInt16LE=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,2,32767,-32768),this[k]=255&O,this[k+1]=O>>>8,k+2},S.prototype.writeInt16BE=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,2,32767,-32768),this[k]=O>>>8,this[k+1]=255&O,k+2},S.prototype.writeInt32LE=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,4,2147483647,-2147483648),this[k]=255&O,this[k+1]=O>>>8,this[k+2]=O>>>16,this[k+3]=O>>>24,k+4},S.prototype.writeInt32BE=function(O,k,Oe){return O=+O,k>>>=0,Oe||Le(this,O,k,4,2147483647,-2147483648),O<0&&(O=4294967295+O+1),this[k]=O>>>24,this[k+1]=O>>>16,this[k+2]=O>>>8,this[k+3]=255&O,k+4},S.prototype.writeFloatLE=function(O,k,Oe){return Ie(this,O,k,!0,Oe)},S.prototype.writeFloatBE=function(O,k,Oe){return Ie(this,O,k,!1,Oe)},S.prototype.writeDoubleLE=function(O,k,Oe){return Ue(this,O,k,!0,Oe)},S.prototype.writeDoubleBE=function(O,k,Oe){return Ue(this,O,k,!1,Oe)},S.prototype.copy=function(O,k,Oe,Xe){if(!S.isBuffer(O))throw new TypeError("argument should be a Buffer");if(Oe||(Oe=0),!Xe&&0!==Xe&&(Xe=this.length),k>=O.length&&(k=O.length),k||(k=0),Xe>0&&Xe<Oe&&(Xe=Oe),Xe===Oe||0===O.length||0===this.length)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(Oe<0||Oe>=this.length)throw new RangeError("Index out of range");if(Xe<0)throw new RangeError("sourceEnd out of bounds");Xe>this.length&&(Xe=this.length),O.length-k<Xe-Oe&&(Xe=O.length-k+Oe);var yt=Xe-Oe;if(this===O&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(k,Oe,Xe);else if(this===O&&Oe<k&&k<Xe)for(var It=yt-1;It>=0;--It)O[It+k]=this[It+Oe];else Uint8Array.prototype.set.call(O,this.subarray(Oe,Xe),k);return yt},S.prototype.fill=function(O,k,Oe,Xe){if("string"==typeof O){if("string"==typeof k?(Xe=k,k=0,Oe=this.length):"string"==typeof Oe&&(Xe=Oe,Oe=this.length),void 0!==Xe&&"string"!=typeof Xe)throw new TypeError("encoding must be a string");if("string"==typeof Xe&&!S.isEncoding(Xe))throw new TypeError("Unknown encoding: "+Xe);if(1===O.length){var yt=O.charCodeAt(0);("utf8"===Xe&&yt<128||"latin1"===Xe)&&(O=yt)}}else"number"==typeof O&&(O&=255);if(k<0||this.length<k||this.length<Oe)throw new RangeError("Out of range index");if(Oe<=k)return this;var It;if(k>>>=0,Oe=void 0===Oe?this.length:Oe>>>0,O||(O=0),"number"==typeof O)for(It=k;It<Oe;++It)this[It]=O;else{var An=S.isBuffer(O)?O:S.from(O,Xe),Rn=An.length;if(0===Rn)throw new TypeError('The value "'+O+'" is invalid for argument "value"');for(It=0;It<Oe-k;++It)this[It+k]=An[It%Rn]}return this};var qe=/[^+/0-9A-Za-z-_]/g;function z(B){return B<16?"0"+B.toString(16):B.toString(16)}function X(B,O){O=O||1/0;for(var k,Oe=B.length,Xe=null,yt=[],It=0;It<Oe;++It){if((k=B.charCodeAt(It))>55295&&k<57344){if(!Xe){if(k>56319){(O-=3)>-1&&yt.push(239,191,189);continue}if(It+1===Oe){(O-=3)>-1&&yt.push(239,191,189);continue}Xe=k;continue}if(k<56320){(O-=3)>-1&&yt.push(239,191,189),Xe=k;continue}k=65536+(Xe-55296<<10|k-56320)}else Xe&&(O-=3)>-1&&yt.push(239,191,189);if(Xe=null,k<128){if((O-=1)<0)break;yt.push(k)}else if(k<2048){if((O-=2)<0)break;yt.push(k>>6|192,63&k|128)}else if(k<65536){if((O-=3)<0)break;yt.push(k>>12|224,k>>6&63|128,63&k|128)}else{if(!(k<1114112))throw new Error("Invalid code point");if((O-=4)<0)break;yt.push(k>>18|240,k>>12&63|128,k>>6&63|128,63&k|128)}}return yt}function Pe(B){return j.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(qe,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(B))}function wt(B,O,k,Oe){for(var Xe=0;Xe<Oe&&!(Xe+k>=O.length||Xe>=B.length);++Xe)O[Xe+k]=B[Xe];return Xe}function pt(B,O){return B instanceof O||null!=B&&null!=B.constructor&&null!=B.constructor.name&&B.constructor.name===O.name}function pe(B){return B!=B}}).call(this)}).call(this,Y("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(Y,Ae,he){"use strict";Ae.exports=function W(j){return null===j||"object"!=typeof j||null!=j.toJSON?JSON.stringify(j):Array.isArray(j)?"["+j.reduce((L,re,$)=>L+(0===$?"":",")+W(void 0===re||"symbol"==typeof re?null:re),"")+"]":"{"+Object.keys(j).sort().reduce((L,re,$)=>void 0===j[re]||"symbol"==typeof j[re]?L:L+(0===L.length?"":",")+W(re)+":"+W(j[re]),"")+"}"}},{}],8:[function(Y,Ae,he){"use strict";var L,W="object"==typeof Reflect?Reflect:null,j=W&&"function"==typeof W.apply?W.apply:function(U,ie,ue){return Function.prototype.apply.call(U,ie,ue)};L=W&&"function"==typeof W.ownKeys?W.ownKeys:Object.getOwnPropertySymbols?function(U){return Object.getOwnPropertyNames(U).concat(Object.getOwnPropertySymbols(U))}:function(U){return Object.getOwnPropertyNames(U)};var $=Number.isNaN||function(U){return U!=U};function b(){b.init.call(this)}Ae.exports=b,Ae.exports.once=function(E,U){return new Promise(function(ie,ue){function ee(Te){E.removeListener(U,se),ue(Te)}function se(){"function"==typeof E.removeListener&&E.removeListener("error",ee),ie([].slice.call(arguments))}Q(E,U,se,{once:!0}),"error"!==U&&function(E,U,ie){"function"==typeof E.on&&Q(E,"error",U,ie)}(E,ee,{once:!0})})},b.EventEmitter=b,b.prototype._events=void 0,b.prototype._eventsCount=0,b.prototype._maxListeners=void 0;var S=10;function R(E){if("function"!=typeof E)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}function A(E){return void 0===E._maxListeners?b.defaultMaxListeners:E._maxListeners}function v(E,U,ie,ue){var ee,se,Te;if(R(ie),void 0===(se=E._events)?(se=E._events=Object.create(null),E._eventsCount=0):(void 0!==se.newListener&&(E.emit("newListener",U,ie.listener?ie.listener:ie),se=E._events),Te=se[U]),void 0===Te)Te=se[U]=ie,++E._eventsCount;else if("function"==typeof Te?Te=se[U]=ue?[ie,Te]:[Te,ie]:ue?Te.unshift(ie):Te.push(ie),(ee=A(E))>0&&Te.length>ee&&!Te.warned){Te.warned=!0;var ve=new Error("Possible EventEmitter memory leak detected. "+Te.length+" "+String(U)+" listeners added. Use emitter.setMaxListeners() to increase limit");ve.name="MaxListenersExceededWarning",ve.emitter=E,ve.type=U,ve.count=Te.length,function(E){console&&console.warn&&console.warn(E)}(ve)}return E}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w(E,U,ie){var ue={fired:!1,wrapFn:void 0,target:E,type:U,listener:ie},ee=y.bind(ue);return ee.listener=ie,ue.wrapFn=ee,ee}function D(E,U,ie){var ue=E._events;if(void 0===ue)return[];var ee=ue[U];return void 0===ee?[]:"function"==typeof ee?ie?[ee.listener||ee]:[ee]:ie?function(E){for(var U=new Array(E.length),ie=0;ie<U.length;++ie)U[ie]=E[ie].listener||E[ie];return U}(ee):I(ee,ee.length)}function V(E){var U=this._events;if(void 0!==U){var ie=U[E];if("function"==typeof ie)return 1;if(void 0!==ie)return ie.length}return 0}function I(E,U){for(var ie=new Array(U),ue=0;ue<U;++ue)ie[ue]=E[ue];return ie}function Q(E,U,ie,ue){if("function"==typeof E.on)ue.once?E.once(U,ie):E.on(U,ie);else{if("function"!=typeof E.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E);E.addEventListener(U,function ee(se){ue.once&&E.removeEventListener(U,ee),ie(se)})}}Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return S},set:function(E){if("number"!=typeof E||E<0||$(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");S=E}}),b.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function(U){if("number"!=typeof U||U<0||$(U))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+U+".");return this._maxListeners=U,this},b.prototype.getMaxListeners=function(){return A(this)},b.prototype.emit=function(U){for(var ie=[],ue=1;ue<arguments.length;ue++)ie.push(arguments[ue]);var ee="error"===U,se=this._events;if(void 0!==se)ee=ee&&void 0===se.error;else if(!ee)return!1;if(ee){var Te;if(ie.length>0&&(Te=ie[0]),Te instanceof Error)throw Te;var ve=new Error("Unhandled error."+(Te?" ("+Te.message+")":""));throw ve.context=Te,ve}var te=se[U];if(void 0===te)return!1;if("function"==typeof te)j(te,this,ie);else{var _e=te.length,Me=I(te,_e);for(ue=0;ue<_e;++ue)j(Me[ue],this,ie)}return!0},b.prototype.on=b.prototype.addListener=function(U,ie){return v(this,U,ie,!1)},b.prototype.prependListener=function(U,ie){return v(this,U,ie,!0)},b.prototype.once=function(U,ie){return R(ie),this.on(U,w(this,U,ie)),this},b.prototype.prependOnceListener=function(U,ie){return R(ie),this.prependListener(U,w(this,U,ie)),this},b.prototype.off=b.prototype.removeListener=function(U,ie){var ue,ee,se,Te,ve;if(R(ie),void 0===(ee=this._events))return this;if(void 0===(ue=ee[U]))return this;if(ue===ie||ue.listener===ie)0==--this._eventsCount?this._events=Object.create(null):(delete ee[U],ee.removeListener&&this.emit("removeListener",U,ue.listener||ie));else if("function"!=typeof ue){for(se=-1,Te=ue.length-1;Te>=0;Te--)if(ue[Te]===ie||ue[Te].listener===ie){ve=ue[Te].listener,se=Te;break}if(se<0)return this;0===se?ue.shift():function(E,U){for(;U+1<E.length;U++)E[U]=E[U+1];E.pop()}(ue,se),1===ue.length&&(ee[U]=ue[0]),void 0!==ee.removeListener&&this.emit("removeListener",U,ve||ie)}return this},b.prototype.removeAllListeners=function(U){var ie,ue,ee;if(void 0===(ue=this._events))return this;if(void 0===ue.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ue[U]&&(0==--this._eventsCount?this._events=Object.create(null):delete ue[U]),this;if(0===arguments.length){var Te,se=Object.keys(ue);for(ee=0;ee<se.length;++ee)"removeListener"!==(Te=se[ee])&&this.removeAllListeners(Te);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(ie=ue[U]))this.removeListener(U,ie);else if(void 0!==ie)for(ee=ie.length-1;ee>=0;ee--)this.removeListener(U,ie[ee]);return this},b.prototype.listeners=function(U){return D(this,U,!0)},b.prototype.rawListeners=function(U){return D(this,U,!1)},b.listenerCount=function(E,U){return"function"==typeof E.listenerCount?E.listenerCount(U):V.call(E,U)},b.prototype.listenerCount=V,b.prototype.eventNames=function(){return this._eventsCount>0?L(this._events):[]}},{}],9:[function(Y,Ae,he){he.read=function(W,j,L,re,$){var b,S,R=8*$-re-1,A=(1<<R)-1,v=A>>1,y=-7,w=L?$-1:0,D=L?-1:1,V=W[j+w];for(w+=D,b=V&(1<<-y)-1,V>>=-y,y+=R;y>0;b=256*b+W[j+w],w+=D,y-=8);for(S=b&(1<<-y)-1,b>>=-y,y+=re;y>0;S=256*S+W[j+w],w+=D,y-=8);if(0===b)b=1-v;else{if(b===A)return S?NaN:1/0*(V?-1:1);S+=Math.pow(2,re),b-=v}return(V?-1:1)*S*Math.pow(2,b-re)},he.write=function(W,j,L,re,$,b){var S,R,A,v=8*b-$-1,y=(1<<v)-1,w=y>>1,D=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,V=re?0:b-1,I=re?1:-1,H=j<0||0===j&&1/j<0?1:0;for(j=Math.abs(j),isNaN(j)||j===1/0?(R=isNaN(j)?1:0,S=y):(S=Math.floor(Math.log(j)/Math.LN2),j*(A=Math.pow(2,-S))<1&&(S--,A*=2),(j+=S+w>=1?D/A:D*Math.pow(2,1-w))*A>=2&&(S++,A/=2),S+w>=y?(R=0,S=y):S+w>=1?(R=(j*A-1)*Math.pow(2,$),S+=w):(R=j*Math.pow(2,w-1)*Math.pow(2,$),S=0));$>=8;W[L+V]=255&R,V+=I,R/=256,$-=8);for(S=S<<$|R,v+=$;v>0;W[L+V]=255&S,V+=I,S/=256,v-=8);W[L+V-I]|=128*H}},{}],10:[function(Y,Ae,he){Ae.exports="function"==typeof Object.create?function(j,L){L&&(j.super_=L,j.prototype=Object.create(L.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}))}:function(j,L){if(L){j.super_=L;var re=function(){};re.prototype=L.prototype,j.prototype=new re,j.prototype.constructor=j}}},{}],11:[function(Y,Ae,he){"use strict";const{isArray:W,isObject:j,isString:L}=Y("./types"),{asArray:re}=Y("./util"),{prependBase:$}=Y("./url"),b=Y("./JsonLdError"),S=Y("./ResolvedContext");function A(y){throw new b("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function v({context:y,base:w}){if(!y)return;const D=y["@context"];if(L(D))y["@context"]=$(w,D);else if(W(D))for(let V=0;V<D.length;++V){const I=D[V];L(I)?D[V]=$(w,I):j(I)&&v({context:{"@context":I},base:w})}else if(j(D))for(const V in D)v({context:D[V],base:w})}Ae.exports=class{constructor({sharedCache:w}){this.perOpCache=new Map,this.sharedCache=w}resolve({activeCtx:w,context:D,documentLoader:V,base:I,cycles:H=new Set}){var K=this;return gt(function*(){D&&j(D)&&D["@context"]&&(D=D["@context"]),D=re(D);const M=[];for(const F of D){if(L(F)){let U=K._get(F);U||(U=yield K._resolveRemoteContext({activeCtx:w,url:F,documentLoader:V,base:I,cycles:H})),W(U)?M.push(...U):M.push(U);continue}if(null===F){M.push(new S({document:null}));continue}j(F)||A(D);const Q=JSON.stringify(F);let E=K._get(Q);E||(E=new S({document:F}),K._cacheResolvedContext({key:Q,resolved:E,tag:"static"})),M.push(E)}return M})()}_get(w){let D=this.perOpCache.get(w);if(!D){const V=this.sharedCache.get(w);V&&(D=V.get("static"),D&&this.perOpCache.set(w,D))}return D}_cacheResolvedContext({key:w,resolved:D,tag:V}){if(this.perOpCache.set(w,D),void 0!==V){let I=this.sharedCache.get(w);I||(I=new Map,this.sharedCache.set(w,I)),I.set(V,D)}return D}_resolveRemoteContext({activeCtx:w,url:D,documentLoader:V,base:I,cycles:H}){var K=this;return gt(function*(){D=$(I,D);const{context:M,remoteDoc:F}=yield K._fetchContext({activeCtx:w,url:D,documentLoader:V,cycles:H});v({context:M,base:I=F.documentUrl||D});const Q=yield K.resolve({activeCtx:w,context:M,documentLoader:V,base:I,cycles:H});return K._cacheResolvedContext({key:D,resolved:Q,tag:F.tag}),Q})()}_fetchContext({activeCtx:w,url:D,documentLoader:V,cycles:I}){return gt(function*(){if(I.size>10)throw new b("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===w.processingMode?"loading remote context failed":"context overflow",max:10});if(I.has(D))throw new b("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===w.processingMode?"recursive context inclusion":"context overflow",url:D});let H,K;I.add(D);try{K=yield V(D),H=K.document||null,L(H)&&(H=JSON.parse(H))}catch(M){throw new b("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:D,cause:M})}if(!j(H))throw new b("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:D});return H="@context"in H?{"@context":H["@context"]}:{"@context":{}},K.contextUrl&&(W(H["@context"])||(H["@context"]=[H["@context"]]),H["@context"].push(K.contextUrl)),{context:H,remoteDoc:K}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(Y,Ae,he){"use strict";Ae.exports=class extends Error{constructor(j="An unspecified JSON-LD error occurred.",L="jsonld.Error",re={}){super(j),this.name=L,this.message=j,this.details=re}}},{}],13:[function(Y,Ae,he){"use strict";Ae.exports=W=>{class j{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(j,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(j.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:j}),j.compact=function(L,re){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):W.compact(L,re)},j.expand=function(L){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):W.expand(L)},j.flatten=function(L){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):W.flatten(L)},j}},{}],14:[function(Y,Ae,he){"use strict";Ae.exports=Y("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(Y,Ae,he){"use strict";Ae.exports=class{constructor(){this._requests={}}wrapLoader(j){const L=this;return L._loader=j,function(){return L.add.apply(L,arguments)}}add(j){var L=this;return gt(function*(){let re=L._requests[j];if(re)return Promise.resolve(re);re=L._requests[j]=L._loader(j);try{return yield re}finally{delete L._requests[j]}})()}}},{}],16:[function(Y,Ae,he){"use strict";const W=Y("lru-cache");Ae.exports=class{constructor({document:re}){this.document=re,this.cache=new W({max:10})}getProcessed(re){return this.cache.get(re)}setProcessed(re,$){this.cache.set(re,$)}}},{"lru-cache":33}],17:[function(Y,Ae,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:L,isString:re,isUndefined:$}=Y("./types"),{isList:b,isValue:S,isGraph:R,isSimpleGraph:A,isSubjectReference:v}=Y("./graphTypes"),{expandIri:y,getContextValue:w,isKeyword:D,process:V,processingMode:I}=Y("./context"),{removeBase:H,prependBase:K}=Y("./url"),{addValue:M,asArray:F,compareShortestLeast:Q}=Y("./util"),E={};function ie(ue,ee,se){if("@nest"!==y(ue,ee,{vocab:!0},se))throw new W("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}Ae.exports=E,E.compact=function(){var ue=gt(function*({activeCtx:ee,activeProperty:se=null,element:Te,options:ve={},compactionMap:te=(()=>{})}){if(j(Te)){let Me=[];for(let je=0;je<Te.length;++je){let nt=yield E.compact({activeCtx:ee,activeProperty:se,element:Te[je],options:ve,compactionMap:te});null===nt&&(nt=yield te({unmappedValue:Te[je],activeCtx:ee,activeProperty:se,parent:Te,index:je,options:ve}),void 0===nt)||Me.push(nt)}return ve.compactArrays&&1===Me.length&&0===(w(ee,se,"@container")||[]).length&&(Me=Me[0]),Me}const _e=w(ee,se,"@context");if($(_e)||(ee=yield V({activeCtx:ee,localCtx:_e,propagate:!0,overrideProtected:!0,options:ve})),L(Te)){if(ve.link&&"@id"in Te&&ve.link.hasOwnProperty(Te["@id"])){const Le=ve.link[Te["@id"]];for(let Ee=0;Ee<Le.length;++Ee)if(Le[Ee].expanded===Te)return Le[Ee].compacted}if(S(Te)||v(Te)){const Le=E.compactValue({activeCtx:ee,activeProperty:se,value:Te,options:ve});return ve.link&&v(Te)&&(ve.link.hasOwnProperty(Te["@id"])||(ve.link[Te["@id"]]=[]),ve.link[Te["@id"]].push({expanded:Te,compacted:Le})),Le}if(b(Te)&&(w(ee,se,"@container")||[]).includes("@list"))return E.compact({activeCtx:ee,activeProperty:se,element:Te["@list"],options:ve,compactionMap:te});const Me="@reverse"===se,je={},nt=ee;!S(Te)&&!v(Te)&&(ee=ee.revertToPreviousContext());const Ze=w(nt,se,"@context");$(Ze)||(ee=yield V({activeCtx:ee,localCtx:Ze,propagate:!0,overrideProtected:!0,options:ve})),ve.link&&"@id"in Te&&(ve.link.hasOwnProperty(Te["@id"])||(ve.link[Te["@id"]]=[]),ve.link[Te["@id"]].push({expanded:Te,compacted:je}));let Je=Te["@type"]||[];Je.length>1&&(Je=Array.from(Je).sort());const Ke=ee;for(const Le of Je){const Ee=E.compactIri({activeCtx:Ke,iri:Le,relativeTo:{vocab:!0}}),Ie=w(nt,Ee,"@context");$(Ie)||(ee=yield V({activeCtx:ee,localCtx:Ie,options:ve,propagate:!1}))}const Ve=Object.keys(Te).sort();for(const Le of Ve){const Ee=Te[Le];if("@id"!==Le)if("@type"!==Le)if("@reverse"!==Le)if("@preserve"!==Le)if("@index"!==Le)if("@graph"!==Le&&"@list"!==Le&&"@included"!==Le&&D(Le)){const Ie=E.compactIri({activeCtx:ee,iri:Le,relativeTo:{vocab:!0}});M(je,Ie,Ee)}else{if(!j(Ee))throw new W("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Ee.length){const Ie=E.compactIri({activeCtx:ee,iri:Le,value:Ee,relativeTo:{vocab:!0},reverse:Me}),Ue=ee.mappings.has(Ie)?ee.mappings.get(Ie)["@nest"]:null;let qe=je;Ue&&(ie(ee,Ue,ve),L(je[Ue])||(je[Ue]={}),qe=je[Ue]),M(qe,Ie,Ee,{propertyIsArray:!0})}for(const Ie of Ee){const Ue=E.compactIri({activeCtx:ee,iri:Le,value:Ie,relativeTo:{vocab:!0},reverse:Me}),qe=ee.mappings.has(Ue)?ee.mappings.get(Ue)["@nest"]:null;let Be=je;qe&&(ie(ee,qe,ve),L(je[qe])||(je[qe]={}),Be=je[qe]);const z=w(ee,Ue,"@container")||[],X=R(Ie),be=b(Ie);let ce;be?ce=Ie["@list"]:X&&(ce=Ie["@graph"]);let Pe=yield E.compact({activeCtx:ee,activeProperty:Ue,element:be||X?ce:Ie,options:ve,compactionMap:te});if(be){if(j(Pe)||(Pe=[Pe]),z.includes("@list")){M(Be,Ue,Pe,{valueIsArray:!0,allowDuplicate:!0});continue}Pe={[E.compactIri({activeCtx:ee,iri:"@list",relativeTo:{vocab:!0}})]:Pe},"@index"in Ie&&(Pe[E.compactIri({activeCtx:ee,iri:"@index",relativeTo:{vocab:!0}})]=Ie["@index"])}if(X)if(z.includes("@graph")&&(z.includes("@id")||z.includes("@index")&&A(Ie))){let wt;Be.hasOwnProperty(Ue)?wt=Be[Ue]:Be[Ue]=wt={};const pt=(z.includes("@id")?Ie["@id"]:Ie["@index"])||E.compactIri({activeCtx:ee,iri:"@none",relativeTo:{vocab:!0}});M(wt,pt,Pe,{propertyIsArray:!ve.compactArrays||z.includes("@set")})}else z.includes("@graph")&&A(Ie)?(j(Pe)&&Pe.length>1&&(Pe={"@included":Pe}),M(Be,Ue,Pe,{propertyIsArray:!ve.compactArrays||z.includes("@set")})):(j(Pe)&&1===Pe.length&&ve.compactArrays&&(Pe=Pe[0]),Pe={[E.compactIri({activeCtx:ee,iri:"@graph",relativeTo:{vocab:!0}})]:Pe},"@id"in Ie&&(Pe[E.compactIri({activeCtx:ee,iri:"@id",relativeTo:{vocab:!0}})]=Ie["@id"]),"@index"in Ie&&(Pe[E.compactIri({activeCtx:ee,iri:"@index",relativeTo:{vocab:!0}})]=Ie["@index"]),M(Be,Ue,Pe,{propertyIsArray:!ve.compactArrays||z.includes("@set")}));else if(z.includes("@language")||z.includes("@index")||z.includes("@id")||z.includes("@type")){let wt,pt;if(Be.hasOwnProperty(Ue)?wt=Be[Ue]:Be[Ue]=wt={},z.includes("@language"))S(Pe)&&(Pe=Pe["@value"]),pt=Ie["@language"];else if(z.includes("@index")){const pe=w(ee,Ue,"@index")||"@index",B=E.compactIri({activeCtx:ee,iri:pe,relativeTo:{vocab:!0}});if("@index"===pe)pt=Ie["@index"],delete Pe[B];else{let O;if([pt,...O]=F(Pe[pe]||[]),re(pt))switch(O.length){case 0:delete Pe[pe];break;case 1:Pe[pe]=O[0];break;default:Pe[pe]=O}else pt=null}}else if(z.includes("@id")){const pe=E.compactIri({activeCtx:ee,iri:"@id",relativeTo:{vocab:!0}});pt=Pe[pe],delete Pe[pe]}else if(z.includes("@type")){const pe=E.compactIri({activeCtx:ee,iri:"@type",relativeTo:{vocab:!0}});let B;switch([pt,...B]=F(Pe[pe]||[]),B.length){case 0:delete Pe[pe];break;case 1:Pe[pe]=B[0];break;default:Pe[pe]=B}1===Object.keys(Pe).length&&"@id"in Ie&&(Pe=yield E.compact({activeCtx:ee,activeProperty:Ue,element:{"@id":Ie["@id"]},options:ve,compactionMap:te}))}pt||(pt=E.compactIri({activeCtx:ee,iri:"@none",relativeTo:{vocab:!0}})),M(wt,pt,Pe,{propertyIsArray:z.includes("@set")})}else{const wt=!ve.compactArrays||z.includes("@set")||z.includes("@list")||j(Pe)&&0===Pe.length||"@list"===Le||"@graph"===Le;M(Be,Ue,Pe,{propertyIsArray:wt})}}}else{if((w(ee,se,"@container")||[]).includes("@index"))continue;const Ue=E.compactIri({activeCtx:ee,iri:Le,relativeTo:{vocab:!0}});M(je,Ue,Ee)}else{const Ie=yield E.compact({activeCtx:ee,activeProperty:se,element:Ee,options:ve,compactionMap:te});j(Ie)&&0===Ie.length||M(je,Le,Ie)}else{const Ie=yield E.compact({activeCtx:ee,activeProperty:"@reverse",element:Ee,options:ve,compactionMap:te});for(const Ue in Ie)if(ee.mappings.has(Ue)&&ee.mappings.get(Ue).reverse){const qe=Ie[Ue],z=(w(ee,Ue,"@container")||[]).includes("@set")||!ve.compactArrays;M(je,Ue,qe,{propertyIsArray:z}),delete Ie[Ue]}if(Object.keys(Ie).length>0){const Ue=E.compactIri({activeCtx:ee,iri:Le,relativeTo:{vocab:!0}});M(je,Ue,Ie)}}else{let Ie=F(Ee).map(X=>E.compactIri({activeCtx:nt,iri:X,relativeTo:{vocab:!0}}));1===Ie.length&&(Ie=Ie[0]);const Ue=E.compactIri({activeCtx:ee,iri:"@type",relativeTo:{vocab:!0}}),z=(w(ee,Ue,"@container")||[]).includes("@set")&&I(ee,1.1)||j(Ie)&&0===Ee.length;M(je,Ue,Ie,{propertyIsArray:z})}else{let Ie=F(Ee).map(qe=>E.compactIri({activeCtx:ee,iri:qe,relativeTo:{vocab:!1},base:ve.base}));1===Ie.length&&(Ie=Ie[0]),je[E.compactIri({activeCtx:ee,iri:"@id",relativeTo:{vocab:!0}})]=Ie}}return je}return Te});return function(ee){return ue.apply(this,arguments)}}(),E.compactIri=({activeCtx:ue,iri:ee,value:se=null,relativeTo:Te={vocab:!1},reverse:ve=!1,base:te=null})=>{if(null===ee)return ee;ue.isPropertyTermScoped&&ue.previousContext&&(ue=ue.previousContext);const _e=ue.getInverse();if(D(ee)&&ee in _e&&"@none"in _e[ee]&&"@type"in _e[ee]["@none"]&&"@none"in _e[ee]["@none"]["@type"])return _e[ee]["@none"]["@type"]["@none"];if(Te.vocab&&ee in _e){const Je=ue["@language"]||"@none",Ke=[];L(se)&&"@index"in se&&!("@graph"in se)&&Ke.push("@index","@index@set"),L(se)&&"@preserve"in se&&(se=se["@preserve"][0]),R(se)?("@index"in se&&Ke.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in se&&Ke.push("@graph@id","@graph@id@set"),Ke.push("@graph","@graph@set","@set"),"@index"in se||Ke.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in se||Ke.push("@graph@id","@graph@id@set")):L(se)&&!S(se)&&Ke.push("@id","@id@set","@type","@set@type");let Ve="@language",Le="@null";if(ve)Ve="@type",Le="@reverse",Ke.push("@set");else if(b(se)){"@index"in se||Ke.push("@list");const Ie=se["@list"];if(0===Ie.length)Ve="@any",Le="@none";else{let Ue=0===Ie.length?Je:null,qe=null;for(let Be=0;Be<Ie.length;++Be){const z=Ie[Be];let X="@none",be="@none";if(S(z)?"@direction"in z?X=`${(z["@language"]||"").toLowerCase()}_${z["@direction"]}`:"@language"in z?X=z["@language"].toLowerCase():"@type"in z?be=z["@type"]:X="@null":be="@id",null===Ue?Ue=X:X!==Ue&&S(z)&&(Ue="@none"),null===qe?qe=be:be!==qe&&(qe="@none"),"@none"===Ue&&"@none"===qe)break}Ue=Ue||"@none",qe=qe||"@none","@none"!==qe?(Ve="@type",Le=qe):Le=Ue}}else{if(S(se))if("@language"in se&&!("@index"in se)){Ke.push("@language","@language@set"),Le=se["@language"];const Ie=se["@direction"];Ie&&(Le=`${Le}_${Ie}`)}else"@direction"in se&&!("@index"in se)?Le=`_${se["@direction"]}`:"@type"in se&&(Ve="@type",Le=se["@type"]);else Ve="@type",Le="@id";Ke.push("@set")}Ke.push("@none"),L(se)&&!("@index"in se)&&Ke.push("@index","@index@set"),S(se)&&1===Object.keys(se).length&&Ke.push("@language","@language@set");const Ee=function(ue,ee,se,Te,ve,te){null===te&&(te="@null");const _e=[];if(("@id"===te||"@reverse"===te)&&L(se)&&"@id"in se){"@reverse"===te&&_e.push("@reverse");const je=E.compactIri({activeCtx:ue,iri:se["@id"],relativeTo:{vocab:!0}});ue.mappings.has(je)&&ue.mappings.get(je)&&ue.mappings.get(je)["@id"]===se["@id"]?_e.push.apply(_e,["@vocab","@id"]):_e.push.apply(_e,["@id","@vocab"])}else{_e.push(te);const je=_e.find(nt=>nt.includes("_"));je&&_e.push(je.replace(/^[^_]+_/,"_"))}_e.push("@none");const Me=ue.inverse[ee];for(const je of Te){if(!(je in Me))continue;const nt=Me[je][ve];for(const Ze of _e)if(Ze in nt)return nt[Ze]}return null}(ue,ee,se,Ke,Ve,Le);if(null!==Ee)return Ee}if(Te.vocab&&"@vocab"in ue){const Je=ue["@vocab"];if(0===ee.indexOf(Je)&&ee!==Je){const Ke=ee.substr(Je.length);if(!ue.mappings.has(Ke))return Ke}}let Me=null;const je=[];let nt=ue.fastCurieMap;const Ze=ee.length-1;for(let Je=0;Je<Ze&&ee[Je]in nt;++Je)nt=nt[ee[Je]],""in nt&&je.push(nt[""][0]);for(let Je=je.length-1;Je>=0;--Je){const Ke=je[Je],Ve=Ke.terms;for(const Le of Ve){const Ee=Le+":"+ee.substr(Ke.iri.length);ue.mappings.get(Le)._prefix&&(!ue.mappings.has(Ee)||null===se&&ue.mappings.get(Ee)["@id"]===ee)&&(null===Me||Q(Ee,Me)<0)&&(Me=Ee)}}if(null!==Me)return Me;for(const[Je,Ke]of ue.mappings)if(Ke&&Ke._prefix&&ee.startsWith(Je+":"))throw new W(`Absolute IRI "${ee}" confused with prefix "${Je}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:ue});return Te.vocab?ee:"@base"in ue?ue["@base"]?H(K(te,ue["@base"]),ee):ee:H(te,ee)},E.compactValue=({activeCtx:ue,activeProperty:ee,value:se,options:Te})=>{if(S(se)){const Me=w(ue,ee,"@type"),je=w(ue,ee,"@language"),nt=w(ue,ee,"@direction"),Ze=w(ue,ee,"@container")||[],Je="@index"in se&&!Ze.includes("@index");if(!Je&&"@none"!==Me&&(se["@type"]===Me||"@language"in se&&se["@language"]===je&&"@direction"in se&&se["@direction"]===nt||"@language"in se&&se["@language"]===je||"@direction"in se&&se["@direction"]===nt))return se["@value"];const Ke=Object.keys(se).length,Ve=1===Ke||2===Ke&&"@index"in se&&!Je,Le="@language"in ue,Ee=re(se["@value"]),Ie=ue.mappings.has(ee)&&null===ue.mappings.get(ee)["@language"];if(Ve&&"@none"!==Me&&(!Le||!Ee||Ie))return se["@value"];const Ue={};return Je&&(Ue[E.compactIri({activeCtx:ue,iri:"@index",relativeTo:{vocab:!0}})]=se["@index"]),"@type"in se?Ue[E.compactIri({activeCtx:ue,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:ue,iri:se["@type"],relativeTo:{vocab:!0}}):"@language"in se&&(Ue[E.compactIri({activeCtx:ue,iri:"@language",relativeTo:{vocab:!0}})]=se["@language"]),"@direction"in se&&(Ue[E.compactIri({activeCtx:ue,iri:"@direction",relativeTo:{vocab:!0}})]=se["@direction"]),Ue[E.compactIri({activeCtx:ue,iri:"@value",relativeTo:{vocab:!0}})]=se["@value"],Ue}const ve=y(ue,ee,{vocab:!0},Te),te=w(ue,ee,"@type"),_e=E.compactIri({activeCtx:ue,iri:se["@id"],relativeTo:{vocab:"@vocab"===te},base:Te.base});return"@id"===te||"@vocab"===te||"@graph"===ve?_e:{[E.compactIri({activeCtx:ue,iri:"@id",relativeTo:{vocab:!0}})]:_e}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(Y,Ae,he){"use strict";const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#";Ae.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:W,RDF_LIST:W+"List",RDF_FIRST:W+"first",RDF_REST:W+"rest",RDF_NIL:W+"nil",RDF_TYPE:W+"type",RDF_PLAIN_LITERAL:W+"PlainLiteral",RDF_XML_LITERAL:W+"XMLLiteral",RDF_JSON_LITERAL:W+"JSON",RDF_OBJECT:W+"object",RDF_LANGSTRING:W+"langString",XSD:j,XSD_BOOLEAN:j+"boolean",XSD_DOUBLE:j+"double",XSD_INTEGER:j+"integer",XSD_STRING:j+"string"}},{}],19:[function(Y,Ae,he){"use strict";const W=Y("./util"),j=Y("./JsonLdError"),{isArray:L,isObject:re,isString:$,isUndefined:b}=Y("./types"),{isAbsolute:S,isRelative:R,prependBase:A}=Y("./url"),{asArray:v,compareShortestLeast:y}=Y("./util"),w=new Map,V=/^@[a-zA-Z]+$/,I={};function H(M,F,Q,E,U,ie){if(null===F||!$(F)||I.isKeyword(F))return F;if(F.match(V))return null;if(E&&E.hasOwnProperty(F)&&!0!==U.get(F)&&I.createTermDefinition({activeCtx:M,localCtx:E,term:F,defined:U,options:ie}),(Q=Q||{}).vocab){const ee=M.mappings.get(F);if(null===ee)return null;if(re(ee)&&"@id"in ee)return ee["@id"]}const ue=F.indexOf(":");if(ue>0){const ee=F.substr(0,ue),se=F.substr(ue+1);if("_"===ee||0===se.indexOf("//"))return F;E&&E.hasOwnProperty(ee)&&I.createTermDefinition({activeCtx:M,localCtx:E,term:ee,defined:U,options:ie});const Te=M.mappings.get(ee);if(Te&&Te._prefix)return Te["@id"]+se;if(S(F))return F}if(Q.vocab&&"@vocab"in M)return M["@vocab"]+F;if(Q.base&&"@base"in M){if(M["@base"])return A(A(ie.base,M["@base"]),F)}else if(Q.base)return A(ie.base,F);return F}function K(M,F){if(!M||"object"!=typeof M||!F||"object"!=typeof F)return M===F;const Q=Array.isArray(M);if(Q!==Array.isArray(F))return!1;if(Q){if(M.length!==F.length)return!1;for(let ie=0;ie<M.length;++ie)if(!K(M[ie],F[ie]))return!1;return!0}const E=Object.keys(M),U=Object.keys(F);if(E.length!==U.length)return!1;for(const ie in M){let ue=M[ie],ee=F[ie];if("@container"===ie&&Array.isArray(ue)&&Array.isArray(ee)&&(ue=ue.slice().sort(),ee=ee.slice().sort()),!K(ue,ee))return!1}return!0}Ae.exports=I,I.process=function(){var M=gt(function*({activeCtx:F,localCtx:Q,options:E,propagate:U=!0,overrideProtected:ie=!1,cycles:ue=new Set}){if(re(Q)&&"@context"in Q&&L(Q["@context"])&&(Q=Q["@context"]),0===v(Q).length)return F;const se=yield E.contextResolver.resolve({activeCtx:F,context:Q,documentLoader:E.documentLoader,base:E.base});re(se[0].document)&&"boolean"==typeof se[0].document["@propagate"]&&(U=se[0].document["@propagate"]);let Te=F;!U&&!Te.previousContext&&(Te=Te.clone(),Te.previousContext=F);for(const ve of se){let{document:te}=ve;if(F=Te,null===te){if(!ie&&0!==Object.keys(F.protected).length){const je=E&&E.protectedMode||"error";if("error"===je)throw new j("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===je){console.warn("WARNING: invalid context nullification");const nt=ve.getProcessed(F);if(nt){Te=F=nt;continue}const Ze=F;Te=F=I.getInitialContext(E).clone();for(const[Je,Ke]of Object.entries(Ze.protected))Ke&&(F.mappings[Je]=W.clone(Ze.mappings[Je]));F.protected=W.clone(Ze.protected),ve.setProcessed(Ze,Te);continue}throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:Q,protectedMode:je})}Te=F=I.getInitialContext(E).clone();continue}const _e=ve.getProcessed(F);if(_e){Te=F=_e;continue}if(re(te)&&"@context"in te&&(te=te["@context"]),!re(te))throw new j("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:te});Te=Te.clone();const Me=new Map;if("@version"in te){if(1.1!==te["@version"])throw new j("Unsupported JSON-LD version: "+te["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:te});if(F.processingMode&&"json-ld-1.0"===F.processingMode)throw new j("@version: "+te["@version"]+" not compatible with "+F.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:te});Te.processingMode="json-ld-1.1",Te["@version"]=te["@version"],Me.set("@version",!0)}if(Te.processingMode=Te.processingMode||F.processingMode,"@base"in te){let je=te["@base"];if(null!==je&&!S(je)){if(!R(je))throw new j('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:te});je=A(Te["@base"],je)}Te["@base"]=je,Me.set("@base",!0)}if("@vocab"in te){const je=te["@vocab"];if(null===je)delete Te["@vocab"];else{if(!$(je))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});if(!S(je)&&I.processingMode(Te,1))throw new j('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});Te["@vocab"]=H(Te,je,{vocab:!0,base:!0},void 0,void 0,E)}Me.set("@vocab",!0)}if("@language"in te){const je=te["@language"];if(null===je)delete Te["@language"];else{if(!$(je))throw new j('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:te});Te["@language"]=je.toLowerCase()}Me.set("@language",!0)}if("@direction"in te){const je=te["@direction"];if("json-ld-1.0"===F.processingMode)throw new j("Invalid JSON-LD syntax; @direction not compatible with "+F.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:te});if(null===je)delete Te["@direction"];else{if("ltr"!==je&&"rtl"!==je)throw new j('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:te});Te["@direction"]=je}Me.set("@direction",!0)}if("@propagate"in te){const je=te["@propagate"];if("json-ld-1.0"===F.processingMode)throw new j("Invalid JSON-LD syntax; @propagate not compatible with "+F.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if("boolean"!=typeof je)throw new j("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:Q});Me.set("@propagate",!0)}if("@import"in te){const je=te["@import"];if("json-ld-1.0"===F.processingMode)throw new j("Invalid JSON-LD syntax; @import not compatible with "+F.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if(!$(je))throw new j("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:Q});const nt=yield E.contextResolver.resolve({activeCtx:F,context:je,documentLoader:E.documentLoader,base:E.base});if(1!==nt.length)throw new j("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:Q});const Ze=nt[0].getProcessed(F);if(Ze)te=Ze;else{const Je=nt[0].document;if("@import"in Je)throw new j("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:Q});for(const Ke in Je)te.hasOwnProperty(Ke)||(te[Ke]=Je[Ke]);nt[0].setProcessed(F,te)}Me.set("@import",!0)}Me.set("@protected",te["@protected"]||!1);for(const je in te)if(I.createTermDefinition({activeCtx:Te,localCtx:te,term:je,defined:Me,options:E,overrideProtected:ie}),re(te[je])&&"@context"in te[je]){const nt=te[je]["@context"];let Ze=!0;if($(nt)){const Je=A(E.base,nt);ue.has(Je)?Ze=!1:ue.add(Je)}if(Ze)try{yield I.process({activeCtx:Te.clone(),localCtx:te[je]["@context"],overrideProtected:!0,options:E,cycles:ue})}catch(Je){throw new j("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:te[je]["@context"],term:je})}}ve.setProcessed(F,Te)}return Te});return function(F){return M.apply(this,arguments)}}(),I.createTermDefinition=({activeCtx:M,localCtx:F,term:Q,defined:E,options:U,overrideProtected:ie=!1})=>{if(E.has(Q)){if(E.get(Q))return;throw new j("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:F,term:Q})}let ue;if(E.set(Q,!1),F.hasOwnProperty(Q)&&(ue=F[Q]),"@type"===Q&&re(ue)&&"@set"===(ue["@container"]||"@set")&&I.processingMode(M,1.1)){const Me=["@container","@id","@protected"],je=Object.keys(ue);if(0===je.length||je.some(nt=>!Me.includes(nt)))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:F,term:Q})}else{if(I.isKeyword(Q))throw new j("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:F,term:Q});if(Q.match(V))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:Q});if(""===Q)throw new j("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:F})}const ee=M.mappings.get(Q);M.mappings.has(Q)&&M.mappings.delete(Q);let se=!1;if(($(ue)||null===ue)&&(se=!0,ue={"@id":ue}),!re(ue))throw new j("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:F});const Te={};M.mappings.set(Q,Te),Te.reverse=!1;const ve=["@container","@id","@language","@reverse","@type"];I.processingMode(M,1.1)&&ve.push("@context","@direction","@index","@nest","@prefix","@protected");for(const Me in ue)if(!ve.includes(Me))throw new j("Invalid JSON-LD syntax; a term definition must not contain "+Me,"jsonld.SyntaxError",{code:"invalid term definition",context:F});const te=Q.indexOf(":");if(Te._termHasColon=te>0,"@reverse"in ue){if("@id"in ue)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:F});if("@nest"in ue)throw new j("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:F});const Me=ue["@reverse"];if(!$(Me))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});if(!I.isKeyword(Me)&&Me.match(V))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:Me}),void(ee?M.mappings.set(Q,ee):M.mappings.delete(Q));const je=H(M,Me,{vocab:!0,base:!1},F,E,U);if(!S(je))throw new j("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});Te["@id"]=je,Te.reverse=!0}else if("@id"in ue){let Me=ue["@id"];if(Me&&!$(Me))throw new j("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});if(null===Me)Te["@id"]=null;else{if(!I.isKeyword(Me)&&Me.match(V))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:Me}),void(ee?M.mappings.set(Q,ee):M.mappings.delete(Q));if(Me!==Q){if(Me=H(M,Me,{vocab:!0,base:!1},F,E,U),!S(Me)&&!I.isKeyword(Me))throw new j("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});if(Q.match(/(?::[^:])|\//)&&H(M,Q,{vocab:!0,base:!1},F,new Map(E).set(Q,!0),U)!==Me)throw new j("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F});Te["@id"]=Me,Te._prefix=se&&!Te._termHasColon&&Me.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in Te))if(Te._termHasColon){const Me=Q.substr(0,te);if(F.hasOwnProperty(Me)&&I.createTermDefinition({activeCtx:M,localCtx:F,term:Me,defined:E,options:U}),M.mappings.has(Me)){const je=Q.substr(te+1);Te["@id"]=M.mappings.get(Me)["@id"]+je}else Te["@id"]=Q}else if("@type"===Q)Te["@id"]=Q;else{if(!("@vocab"in M))throw new j("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:F,term:Q});Te["@id"]=M["@vocab"]+Q}if((!0===ue["@protected"]||!0===E.get("@protected")&&!1!==ue["@protected"])&&(M.protected[Q]=!0,Te.protected=!0),E.set(Q,!0),"@type"in ue){let Me=ue["@type"];if(!$(Me))throw new j("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:F});if("@json"===Me||"@none"===Me){if(I.processingMode(M,1))throw new j(`Invalid JSON-LD syntax; an @context @type value must not be "${Me}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:F})}else if("@id"!==Me&&"@vocab"!==Me){if(Me=H(M,Me,{vocab:!0,base:!1},F,E,U),!S(Me))throw new j("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:F});if(0===Me.indexOf("_:"))throw new j("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:F})}Te["@type"]=Me}if("@container"in ue){const Me=$(ue["@container"])?[ue["@container"]]:ue["@container"]||[],je=["@list","@set","@index","@language"];let nt=!0;const Ze=Me.includes("@set");if(I.processingMode(M,1.1)){if(je.push("@graph","@id","@type"),Me.includes("@list")){if(1!==Me.length)throw new j("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:F})}else if(Me.includes("@graph")){if(Me.some(Je=>"@graph"!==Je&&"@id"!==Je&&"@index"!==Je&&"@set"!==Je))throw new j("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:F})}else nt&=Me.length<=(Ze?2:1);if(Me.includes("@type")&&(Te["@type"]=Te["@type"]||"@id",!["@id","@vocab"].includes(Te["@type"])))throw new j("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:F})}else nt&=!L(ue["@container"]),nt&=Me.length<=1;if(nt&=Me.every(Je=>je.includes(Je)),nt&=!(Ze&&Me.includes("@list")),!nt)throw new j("Invalid JSON-LD syntax; @context @container value must be one of the following: "+je.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:F});if(Te.reverse&&!Me.every(Je=>["@index","@set"].includes(Je)))throw new j("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:F});Te["@container"]=Me}if("@index"in ue){if(!("@container"in ue)||!Te["@container"].includes("@index"))throw new j(`Invalid JSON-LD syntax; @index without @index in @container: "${ue["@index"]}" on term "${Q}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:F});if(!$(ue["@index"])||0===ue["@index"].indexOf("@"))throw new j(`Invalid JSON-LD syntax; @index must expand to an IRI: "${ue["@index"]}" on term "${Q}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:F});Te["@index"]=ue["@index"]}if("@context"in ue&&(Te["@context"]=ue["@context"]),"@language"in ue&&!("@type"in ue)){let Me=ue["@language"];if(null!==Me&&!$(Me))throw new j("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:F});null!==Me&&(Me=Me.toLowerCase()),Te["@language"]=Me}if("@prefix"in ue){if(Q.match(/:|\//))throw new j("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:F});if(I.isKeyword(Te["@id"]))throw new j("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:F});if("boolean"!=typeof ue["@prefix"])throw new j("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:F});Te._prefix=!0===ue["@prefix"]}if("@direction"in ue){const Me=ue["@direction"];if(null!==Me&&"ltr"!==Me&&"rtl"!==Me)throw new j('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:F});Te["@direction"]=Me}if("@nest"in ue){const Me=ue["@nest"];if(!$(Me)||"@nest"!==Me&&0===Me.indexOf("@"))throw new j("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:F});Te["@nest"]=Me}const _e=Te["@id"];if("@context"===_e||"@preserve"===_e)throw new j("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:F});if(ee&&ee.protected&&!ie&&(M.protected[Q]=!0,Te.protected=!0,!K(ee,Te))){const Me=U&&U.protectedMode||"error";if("error"===Me)throw new j(`Invalid JSON-LD syntax; tried to redefine "${Q}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:F,term:Q});if("warn"===Me)return void console.warn("WARNING: protected term redefinition",{term:Q});throw new j("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:F,term:Q,protectedMode:Me})}},I.expandIri=(M,F,Q,E)=>H(M,F,Q,void 0,void 0,E),I.getInitialContext=M=>{const F=JSON.stringify({processingMode:M.processingMode}),Q=w.get(F);if(Q)return Q;const E={processingMode:M.processingMode,mappings:new Map,inverse:null,getInverse:function(){const Te=this;if(Te.inverse)return Te.inverse;const ve=Te.inverse={},te=Te.fastCurieMap={},_e={},Me=(Te["@language"]||"@none").toLowerCase(),je=Te["@direction"],nt=Te.mappings,Ze=[...nt.keys()].sort(y);for(const Je of Ze){const Ke=nt.get(Je);if(null===Ke)continue;let Ve=Ke["@container"]||"@none";if(Ve=[].concat(Ve).sort().join(""),null===Ke["@id"])continue;const Le=v(Ke["@id"]);for(const Ee of Le){let Ie=ve[Ee];const Ue=I.isKeyword(Ee);if(Ie)!Ue&&!Ke._termHasColon&&_e[Ee].push(Je);else if(ve[Ee]=Ie={},!Ue&&!Ke._termHasColon){_e[Ee]=[Je];const qe={iri:Ee,terms:_e[Ee]};Ee[0]in te?te[Ee[0]].push(qe):te[Ee[0]]=[qe]}if(Ie[Ve]||(Ie[Ve]={"@language":{},"@type":{},"@any":{}}),Ie=Ie[Ve],ue(Je,Ie["@any"],"@none"),Ke.reverse)ue(Je,Ie["@type"],"@reverse");else if("@none"===Ke["@type"])ue(Je,Ie["@any"],"@none"),ue(Je,Ie["@language"],"@none"),ue(Je,Ie["@type"],"@none");else if("@type"in Ke)ue(Je,Ie["@type"],Ke["@type"]);else if("@language"in Ke&&"@direction"in Ke){const qe=Ke["@language"],Be=Ke["@direction"];ue(Je,Ie["@language"],qe&&Be?`${qe}_${Be}`.toLowerCase():qe?qe.toLowerCase():Be?`_${Be}`:"@null")}else"@language"in Ke?ue(Je,Ie["@language"],(Ke["@language"]||"@null").toLowerCase()):"@direction"in Ke?ue(Je,Ie["@language"],Ke["@direction"]?`_${Ke["@direction"]}`:"@none"):je?(ue(Je,Ie["@language"],`_${je}`),ue(Je,Ie["@language"],"@none"),ue(Je,Ie["@type"],"@none")):(ue(Je,Ie["@language"],Me),ue(Je,Ie["@language"],"@none"),ue(Je,Ie["@type"],"@none"))}}for(const Je in te)ie(te,Je,1);return ve},clone:function(){const Te={};return Te.mappings=W.clone(this.mappings),Te.clone=this.clone,Te.inverse=null,Te.getInverse=this.getInverse,Te.protected=W.clone(this.protected),this.previousContext&&(Te.previousContext=this.previousContext.clone()),Te.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(Te["@base"]=this["@base"]),"@language"in this&&(Te["@language"]=this["@language"]),"@vocab"in this&&(Te["@vocab"]=this["@vocab"]),Te},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===w.size&&w.clear(),w.set(F,E),E;function ie(Te,ve,te){const _e=Te[ve],Me=Te[ve]={};let je,nt;for(const Ze of _e)je=Ze.iri,nt=te>=je.length?"":je[te],nt in Me?Me[nt].push(Ze):Me[nt]=[Ze];for(const Ze in Me)""!==Ze&&ie(Me,Ze,te+1)}function ue(Te,ve,te){ve.hasOwnProperty(te)||(ve[te]=Te)}},I.getContextValue=(M,F,Q)=>{if(null===F)return"@context"===Q?void 0:null;if(M.mappings.has(F)){const E=M.mappings.get(F);if(b(Q))return E;if(E.hasOwnProperty(Q))return E[Q]}return"@language"===Q&&Q in M||"@direction"===Q&&Q in M?M[Q]:"@context"!==Q?null:void 0},I.processingMode=(M,F)=>F.toString()>="1.1"?!M.processingMode||M.processingMode>="json-ld-"+F.toString():"json-ld-1.0"===M.processingMode,I.isKeyword=M=>{if(!$(M)||"@"!==M[0])return!1;switch(M){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(Y,Ae,he){"use strict";const{parseLinkHeader:W,buildHeaders:j}=Y("../util"),{LINK_HEADER_CONTEXT:L}=Y("../constants"),re=Y("../JsonLdError"),$=Y("../RequestQueue"),{prependBase:b}=Y("../url"),S=/(^|(\r\n))link:/i;function R(A,v,y){const w=new(A=A||XMLHttpRequest);return new Promise((D,V)=>{w.onload=()=>D(w),w.onerror=I=>V(I),w.open("GET",v,!0);for(const I in y)w.setRequestHeader(I,y[I]);w.send()})}Ae.exports=({secure:A,headers:v={},xhr:y}={headers:{}})=>{return v=j(v),(new $).wrapLoader(D);function D(I){return V.apply(this,arguments)}function V(){return(V=gt(function*(I){if(0!==I.indexOf("http:")&&0!==I.indexOf("https:"))throw new re('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:I});if(A&&0!==I.indexOf("https"))throw new re('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:I});let H;try{H=yield R(y,I,v)}catch(E){throw new re("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:I,cause:E})}if(H.status>=400)throw new re("URL could not be dereferenced: "+H.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:I,httpStatusCode:H.status});let K={contextUrl:null,documentUrl:I,document:H.response},M=null;const F=H.getResponseHeader("Content-Type");let Q;if(S.test(H.getAllResponseHeaders())&&(Q=H.getResponseHeader("Link")),Q&&"application/ld+json"!==F){const E=W(Q),U=E[L];if(Array.isArray(U))throw new re("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:I});U&&(K.contextUrl=U.target),M=E.alternate,M&&"application/ld+json"==M.type&&!(F||"").match(/^application\/(\w*\+)?json$/)&&(K=yield D(b(I,M.target)))}return K})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(Y,Ae,he){"use strict";const W=Y("./JsonLdError"),{isArray:j,isObject:L,isEmptyObject:re,isString:$,isUndefined:b}=Y("./types"),{isList:S,isValue:R,isGraph:A,isSubject:v}=Y("./graphTypes"),{expandIri:y,getContextValue:w,isKeyword:D,process:V,processingMode:I}=Y("./context"),{isAbsolute:H}=Y("./url"),{addValue:K,asArray:M,getValues:F,validateTypeValue:Q}=Y("./util"),E={};Ae.exports=E;const U=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function ie(te){return ue.apply(this,arguments)}function ue(){return(ue=gt(function*({activeCtx:te,activeProperty:_e,expandedActiveProperty:Me,element:je,expandedParent:nt,options:Ze={},insideList:Je,typeKey:Ke,typeScopedContext:Ve,expansionMap:Le}){const Ee=Object.keys(je).sort(),Ie=[];let Ue;const qe=je[Ke]&&"@json"===y(te,j(je[Ke])?je[Ke][0]:je[Ke],{vocab:!0},Ze);for(const Be of Ee){let X,z=je[Be];if("@context"===Be)continue;let be=y(te,Be,{vocab:!0},Ze);if((null===be||!H(be)&&!D(be))&&(be=Le({unmappedProperty:Be,activeCtx:te,activeProperty:_e,parent:je,options:Ze,insideList:Je,value:z,expandedParent:nt}),void 0===be))continue;if(D(be)){if("@reverse"===Me)throw new W("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:z});if(be in nt&&"@included"!==be&&"@type"!==be)throw new W("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:be})}if("@id"===be){if(!$(z)){if(!Ze.isFrame)throw new W('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:z});if(L(z)){if(!re(z))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:z})}else{if(!j(z))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:z});if(!z.every(pt=>$(pt)))throw new W('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:z})}}K(nt,"@id",M(z).map(pt=>$(pt)?y(te,pt,{base:!0},Ze):pt),{propertyIsArray:Ze.isFrame});continue}if("@type"===be){L(z)&&(z=Object.fromEntries(Object.entries(z).map(([pt,pe])=>[y(Ve,pt,{vocab:!0}),M(pe).map(B=>y(Ve,B,{base:!0,vocab:!0}))]))),Q(z,Ze.isFrame),K(nt,"@type",M(z).map(pt=>$(pt)?y(Ve,pt,{base:!0,vocab:!0},Ze):pt),{propertyIsArray:Ze.isFrame});continue}if("@included"===be&&I(te,1.1)){const pt=M(yield E.expand({activeCtx:te,activeProperty:_e,element:z,options:Ze,expansionMap:Le}));if(!pt.every(pe=>v(pe)))throw new W("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:z});K(nt,"@included",pt,{propertyIsArray:!0});continue}if("@graph"===be&&!L(z)&&!j(z))throw new W('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:z});if("@value"===be){Ue=z,qe&&I(te,1.1)?nt["@value"]=z:K(nt,"@value",z,{propertyIsArray:Ze.isFrame});continue}if("@language"===be){if(null===z)continue;if(!$(z)&&!Ze.isFrame)throw new W('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:z});z=M(z).map(pt=>$(pt)?pt.toLowerCase():pt);for(const pt of z)$(pt)&&!pt.match(U)&&console.warn(`@language must be valid BCP47: ${pt}`);K(nt,"@language",z,{propertyIsArray:Ze.isFrame});continue}if("@direction"===be){if(!$(z)&&!Ze.isFrame)throw new W('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:z});z=M(z);for(const pt of z)if($(pt)&&"ltr"!==pt&&"rtl"!==pt)throw new W('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:z});K(nt,"@direction",z,{propertyIsArray:Ze.isFrame});continue}if("@index"===be){if(!$(z))throw new W('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:z});K(nt,"@index",z);continue}if("@reverse"===be){if(!L(z))throw new W('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:z});if(X=yield E.expand({activeCtx:te,activeProperty:"@reverse",element:z,options:Ze,expansionMap:Le}),"@reverse"in X)for(const pe in X["@reverse"])K(nt,pe,X["@reverse"][pe],{propertyIsArray:!0});let pt=nt["@reverse"]||null;for(const pe in X){if("@reverse"===pe)continue;null===pt&&(pt=nt["@reverse"]={}),K(pt,pe,[],{propertyIsArray:!0});const B=X[pe];for(let O=0;O<B.length;++O){const k=B[O];if(R(k)||S(k))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:X});K(pt,pe,k,{propertyIsArray:!0})}}continue}if("@nest"===be){Ie.push(Be);continue}let ce=te;const Pe=w(te,Be,"@context");b(Pe)||(ce=yield V({activeCtx:te,localCtx:Pe,propagate:!0,overrideProtected:!0,options:Ze}));const wt=w(ce,Be,"@container")||[];if(wt.includes("@language")&&L(z))X=se(ce,z,w(ce,Be,"@direction"),Ze);else if(wt.includes("@index")&&L(z)){const pt=wt.includes("@graph"),pe=w(ce,Be,"@index")||"@index",B="@index"!==pe&&y(te,pe,{vocab:!0},Ze);X=yield Te({activeCtx:ce,options:Ze,activeProperty:Be,value:z,expansionMap:Le,asGraph:pt,indexKey:pe,propertyIndex:B})}else if(wt.includes("@id")&&L(z)){const pt=wt.includes("@graph");X=yield Te({activeCtx:ce,options:Ze,activeProperty:Be,value:z,expansionMap:Le,asGraph:pt,indexKey:"@id"})}else if(wt.includes("@type")&&L(z))X=yield Te({activeCtx:ce.revertToPreviousContext(),options:Ze,activeProperty:Be,value:z,expansionMap:Le,asGraph:!1,indexKey:"@type"});else{const pt="@list"===be;if(pt||"@set"===be){let pe=_e;pt&&"@graph"===Me&&(pe=null),X=yield E.expand({activeCtx:ce,activeProperty:pe,element:z,options:Ze,insideList:pt,expansionMap:Le})}else X="@json"===w(te,Be,"@type")?{"@type":"@json","@value":z}:yield E.expand({activeCtx:ce,activeProperty:Be,element:z,options:Ze,insideList:!1,expansionMap:Le})}if(null!==X||"@value"===be||(X=Le({unmappedValue:z,expandedProperty:be,activeCtx:ce,activeProperty:_e,parent:je,options:Ze,insideList:Je,key:Be,expandedParent:nt}),void 0!==X)){if("@list"!==be&&!S(X)&&wt.includes("@list")&&(X={"@list":M(X)}),wt.includes("@graph")&&!wt.some(pt=>"@id"===pt||"@index"===pt)&&(X=M(X).map(pt=>({"@graph":M(pt)}))),ce.mappings.has(Be)&&ce.mappings.get(Be).reverse){const pt=nt["@reverse"]=nt["@reverse"]||{};X=M(X);for(let pe=0;pe<X.length;++pe){const B=X[pe];if(R(B)||S(B))throw new W('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:X});K(pt,be,B,{propertyIsArray:!0})}continue}K(nt,be,X,{propertyIsArray:!0})}}if("@value"in nt&&("@json"!==nt["@type"]||!I(te,1.1))&&(L(Ue)||j(Ue))&&!Ze.isFrame)throw new W('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:Ue});for(const Be of Ie){const z=j(je[Be])?je[Be]:[je[Be]];for(const X of z){if(!L(X)||Object.keys(X).some(be=>"@value"===y(te,be,{vocab:!0},Ze)))throw new W("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:X});yield ie({activeCtx:te,activeProperty:_e,expandedActiveProperty:Me,element:X,expandedParent:nt,options:Ze,insideList:Je,typeScopedContext:Ve,typeKey:Ke,expansionMap:Le})}}})).apply(this,arguments)}function ee({activeCtx:te,activeProperty:_e,value:Me,options:je}){if(null==Me)return null;const nt=y(te,_e,{vocab:!0},je);if("@id"===nt)return y(te,Me,{base:!0},je);if("@type"===nt)return y(te,Me,{vocab:!0,base:!0},je);const Ze=w(te,_e,"@type");if(("@id"===Ze||"@graph"===nt)&&$(Me))return{"@id":y(te,Me,{base:!0},je)};if("@vocab"===Ze&&$(Me))return{"@id":y(te,Me,{vocab:!0,base:!0},je)};if(D(nt))return Me;const Je={};if(Ze&&!["@id","@vocab","@none"].includes(Ze))Je["@type"]=Ze;else if($(Me)){const Ke=w(te,_e,"@language");null!==Ke&&(Je["@language"]=Ke);const Ve=w(te,_e,"@direction");null!==Ve&&(Je["@direction"]=Ve)}return["boolean","number","string"].includes(typeof Me)||(Me=Me.toString()),Je["@value"]=Me,Je}function se(te,_e,Me,je){const nt=[],Ze=Object.keys(_e).sort();for(const Je of Ze){const Ke=y(te,Je,{vocab:!0},je);let Ve=_e[Je];j(Ve)||(Ve=[Ve]);for(const Le of Ve){if(null===Le)continue;if(!$(Le))throw new W("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:_e});const Ee={"@value":Le};"@none"!==Ke&&(Ee["@language"]=Je.toLowerCase()),Me&&(Ee["@direction"]=Me),nt.push(Ee)}}return nt}function Te(te){return ve.apply(this,arguments)}function ve(){return(ve=gt(function*({activeCtx:te,options:_e,activeProperty:Me,value:je,expansionMap:nt,asGraph:Ze,indexKey:Je,propertyIndex:Ke}){const Ve=[],Le=Object.keys(je).sort(),Ee="@type"===Je;for(let Ie of Le){if(Ee){const Be=w(te,Ie,"@context");b(Be)||(te=yield V({activeCtx:te,localCtx:Be,propagate:!1,options:_e}))}let qe,Ue=je[Ie];j(Ue)||(Ue=[Ue]),Ue=yield E.expand({activeCtx:te,activeProperty:Me,element:Ue,options:_e,insideList:!1,insideIndex:!0,expansionMap:nt}),qe=Ke?"@none"===Ie?"@none":ee({activeCtx:te,activeProperty:Je,value:Ie,options:_e}):y(te,Ie,{vocab:!0},_e),"@id"===Je?Ie=y(te,Ie,{base:!0},_e):Ee&&(Ie=qe);for(let Be of Ue){if(Ze&&!A(Be)&&(Be={"@graph":[Be]}),"@type"===Je)"@none"===qe||(Be["@type"]=Be["@type"]?[Ie].concat(Be["@type"]):[Ie]);else{if(R(Be)&&!["@language","@type","@index"].includes(Je))throw new W(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${Je}".`,"jsonld.SyntaxError",{code:"invalid value object",value:Be});Ke?"@none"!==qe&&K(Be,Ke,qe,{propertyIsArray:!0,prependValue:!0}):"@none"!==qe&&!(Je in Be)&&(Be[Je]=Ie)}Ve.push(Be)}}return Ve})).apply(this,arguments)}E.expand=function(){var te=gt(function*({activeCtx:_e,activeProperty:Me=null,element:je,options:nt={},insideList:Ze=!1,insideIndex:Je=!1,typeScopedContext:Ke=null,expansionMap:Ve=(()=>{})}){if(null==je)return null;if("@default"===Me&&(nt=Object.assign({},nt,{isFrame:!1})),!j(je)&&!L(je)){if(!Ze&&(null===Me||"@graph"===y(_e,Me,{vocab:!0},nt))){const X=yield Ve({unmappedValue:je,activeCtx:_e,activeProperty:Me,options:nt,insideList:Ze});return void 0===X?null:X}return ee({activeCtx:_e,activeProperty:Me,value:je,options:nt})}if(j(je)){let X=[];const be=w(_e,Me,"@container")||[];Ze=Ze||be.includes("@list");for(let ce=0;ce<je.length;++ce){let Pe=yield E.expand({activeCtx:_e,activeProperty:Me,element:je[ce],options:nt,expansionMap:Ve,insideIndex:Je,typeScopedContext:Ke});Ze&&j(Pe)&&(Pe={"@list":Pe}),(null!==Pe||(Pe=yield Ve({unmappedValue:je[ce],activeCtx:_e,activeProperty:Me,parent:je,index:ce,options:nt,expandedParent:X,insideList:Ze}),void 0!==Pe))&&(j(Pe)?X=X.concat(Pe):X.push(Pe))}return X}const Le=y(_e,Me,{vocab:!0},nt),Ee=w(_e,Me,"@context");Ke=Ke||(_e.previousContext?_e:null);let Ie=Object.keys(je).sort(),Ue=!Je;if(Ue&&Ke&&Ie.length<=2&&!Ie.includes("@context"))for(const X of Ie){const be=y(Ke,X,{vocab:!0},nt);if("@value"===be){Ue=!1,_e=Ke;break}if("@id"===be&&1===Ie.length){Ue=!1;break}}Ue&&(_e=_e.revertToPreviousContext()),b(Ee)||(_e=yield V({activeCtx:_e,localCtx:Ee,propagate:!0,overrideProtected:!0,options:nt})),"@context"in je&&(_e=yield V({activeCtx:_e,localCtx:je["@context"],options:nt})),Ke=_e;let qe=null;for(const X of Ie)if("@type"===y(_e,X,{vocab:!0},nt)){qe=qe||X;const ce=je[X],Pe=Array.isArray(ce)?ce.length>1?ce.slice().sort():ce:[ce];for(const wt of Pe){const pt=w(Ke,wt,"@context");b(pt)||(_e=yield V({activeCtx:_e,localCtx:pt,options:nt,propagate:!1}))}}let Be={};yield ie({activeCtx:_e,activeProperty:Me,expandedActiveProperty:Le,element:je,expandedParent:Be,options:nt,insideList:Ze,typeKey:qe,typeScopedContext:Ke,expansionMap:Ve}),Ie=Object.keys(Be);let z=Ie.length;if("@value"in Be){if("@type"in Be&&("@language"in Be||"@direction"in Be))throw new W('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Be});let X=z-1;if("@type"in Be&&(X-=1),"@index"in Be&&(X-=1),"@language"in Be&&(X-=1),"@direction"in Be&&(X-=1),0!==X)throw new W('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Be});const be=null===Be["@value"]?[]:M(Be["@value"]),ce=F(Be,"@type");if(!I(_e,1.1)||!ce.includes("@json")||1!==ce.length)if(0===be.length){const Pe=yield Ve({unmappedValue:Be,activeCtx:_e,activeProperty:Me,element:je,options:nt,insideList:Ze});Be=void 0!==Pe?Pe:null}else{if(!be.every(Pe=>$(Pe)||re(Pe))&&"@language"in Be)throw new W("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:Be});if(!ce.every(Pe=>H(Pe)&&!($(Pe)&&0===Pe.indexOf("_:"))||re(Pe)))throw new W('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:Be})}}else if("@type"in Be&&!j(Be["@type"]))Be["@type"]=[Be["@type"]];else if("@set"in Be||"@list"in Be){if(z>1&&(2!==z||!("@index"in Be)))throw new W('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:Be});"@set"in Be&&(Be=Be["@set"],Ie=Object.keys(Be),z=Ie.length)}else if(1===z&&"@language"in Be){const X=yield Ve(Be,{unmappedValue:Be,activeCtx:_e,activeProperty:Me,element:je,options:nt,insideList:Ze});Be=void 0!==X?X:null}if(L(Be)&&!nt.keepFreeFloatingNodes&&!Ze&&(null===Me||"@graph"===Le)&&(0===z||"@value"in Be||"@list"in Be||1===z&&"@id"in Be)){const X=yield Ve({unmappedValue:Be,activeCtx:_e,activeProperty:Me,element:je,options:nt,insideList:Ze});Be=void 0!==X?X:null}return Be});return function(_e){return te.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(Y,Ae,he){"use strict";const{isSubjectReference:W}=Y("./graphTypes"),{createMergedNodeMap:j}=Y("./nodeMap"),L={};Ae.exports=L,L.flatten=re=>{const $=j(re),b=[],S=Object.keys($).sort();for(let R=0;R<S.length;++R){const A=$[S[R]];W(A)||b.push(A)}return b}},{"./graphTypes":25,"./nodeMap":27}],23:[function(Y,Ae,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),L=Y("./types"),re=Y("./util"),$=Y("./url"),b=Y("./JsonLdError"),{createNodeMap:S,mergeNodeMapGraphs:R}=Y("./nodeMap"),A={};function v(E){const U={};for(const ie in E)void 0!==E[ie]&&(U["@"+ie]=[E[ie]]);return[U]}function y(E,U,ie){for(let ue=ie.length-1;ue>=0;--ue){const ee=ie[ue];if(ee.graph===U&&ee.subject["@id"]===E["@id"])return!0}return!1}function w(E,U,ie){const ue="@"+ie;let ee=ue in E?E[ue][0]:U[ie];if("embed"===ie)if(!0===ee)ee="@once";else if(!1===ee)ee="@never";else if("@always"!==ee&&"@never"!==ee&&"@link"!==ee&&"@first"!==ee&&"@last"!==ee&&"@once"!==ee)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:E});return ee}function D(E){if(!L.isArray(E)||1!==E.length||!L.isObject(E[0]))throw new b("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:E});if("@id"in E[0])for(const U of re.asArray(E[0]["@id"]))if(!L.isObject(U)&&!$.isAbsolute(U)||L.isString(U)&&0===U.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E});if("@type"in E[0])for(const U of re.asArray(E[0]["@type"]))if(!L.isObject(U)&&!$.isAbsolute(U)||L.isString(U)&&0===U.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:E})}function I(E,U,ie,ue){let ee=!0,se=!1;for(const Te in ie){let ve=!1;const te=re.getValues(U,Te),_e=0===re.getValues(ie,Te).length;if("@id"===Te){if(L.isEmptyObject(ie["@id"][0]||{})?ve=!0:ie["@id"].length>=0&&(ve=ie["@id"].includes(te[0])),!ue.requireAll)return ve}else if("@type"===Te){if(ee=!1,_e){if(te.length>0)return!1;ve=!0}else if(1===ie["@type"].length&&L.isEmptyObject(ie["@type"][0]))ve=te.length>0;else for(const Me of ie["@type"])ve=!(!L.isObject(Me)||!("@default"in Me))||ve||te.some(je=>je===Me);if(!ue.requireAll)return ve}else{if(W(Te))continue;{const Me=re.getValues(ie,Te)[0];let je=!1;if(Me&&(D([Me]),je="@default"in Me),ee=!1,0===te.length&&je)continue;if(te.length>0&&_e)return!1;if(void 0===Me){if(te.length>0)return!1;ve=!0}else if(j.isList(Me)){const nt=Me["@list"][0];if(j.isList(te[0])){const Ze=te[0]["@list"];j.isValue(nt)?ve=Ze.some(Je=>Q(nt,Je)):(j.isSubject(nt)||j.isSubjectReference(nt))&&(ve=Ze.some(Je=>F(E,nt,Je,ue)))}}else ve=j.isValue(Me)?te.some(nt=>Q(Me,nt)):j.isSubjectReference(Me)?te.some(nt=>F(E,Me,nt,ue)):!!L.isObject(Me)&&te.length>0}}if(!ve&&ue.requireAll)return!1;se=se||ve}return ee||se}function H(E,U){const ie=E.uniqueEmbeds[E.graph],ue=ie[U],ee=ue.parent,se=ue.property,Te={"@id":U};if(L.isArray(ee)){for(let te=0;te<ee.length;++te)if(re.compareValues(ee[te],Te)){ee[te]=Te;break}}else{const te=L.isArray(ee[se]);re.removeValue(ee,se,Te,{propertyIsArray:te}),re.addValue(ee,se,Te,{propertyIsArray:te})}const ve=te=>{const _e=Object.keys(ie);for(const Me of _e)Me in ie&&L.isObject(ie[Me].parent)&&ie[Me].parent["@id"]===te&&(delete ie[Me],ve(Me))};ve(U)}function K(E,U){if(L.isArray(E))return E.map(ie=>K(ie,U));if(L.isObject(E)){if("@preserve"in E)return E["@preserve"][0];if(j.isValue(E))return E;if(j.isList(E))return E["@list"]=K(E["@list"],U),E;if("@id"in E){const ie=E["@id"];if(U.link.hasOwnProperty(ie)){const ue=U.link[ie].indexOf(E);if(-1!==ue)return U.link[ie][ue];U.link[ie].push(E)}else U.link[ie]=[E]}for(const ie in E)"@id"===ie&&U.bnodesToClear.includes(E[ie])?delete E["@id"]:E[ie]=K(E[ie],U)}return E}function M(E,U,ie){L.isObject(E)?re.addValue(E,U,ie,{propertyIsArray:!0}):E.push(ie)}function F(E,U,ie,ue){if(!("@id"in ie))return!1;const ee=E.subjects[ie["@id"]];return ee&&I(E,ee,U,ue)}function Q(E,U){const ie=U["@value"],ue=U["@type"],ee=U["@language"],se=E["@value"]?L.isArray(E["@value"])?E["@value"]:[E["@value"]]:[],Te=E["@type"]?L.isArray(E["@type"])?E["@type"]:[E["@type"]]:[],ve=E["@language"]?L.isArray(E["@language"])?E["@language"]:[E["@language"]]:[];return 0===se.length&&0===Te.length&&0===ve.length||!(!se.includes(ie)&&!L.isEmptyObject(se[0])||!(!ue&&0===Te.length||Te.includes(ue)||ue&&L.isEmptyObject(Te[0]))||!(!ee&&0===ve.length||ve.includes(ee)||ee&&L.isEmptyObject(ve[0])))}Ae.exports=A,A.frameMergedOrDefault=(E,U,ie)=>{const ue={options:ie,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},ee=new re.IdentifierIssuer("_:b");S(E,ue.graphMap,"@default",ee),ie.merged&&(ue.graphMap["@merged"]=R(ue.graphMap),ue.graph="@merged"),ue.subjects=ue.graphMap[ue.graph];const se=[];return A.frame(ue,Object.keys(ue.subjects).sort(),U,se),ie.pruneBlankNodeIdentifiers&&(ie.bnodesToClear=Object.keys(ue.bnodeMap).filter(Te=>1===ue.bnodeMap[Te].length)),ie.link={},K(se,ie)},A.frame=(E,U,ie,ue,ee=null)=>{D(ie);const se=E.options,Te={embed:w(ie=ie[0],se,"embed"),explicit:w(ie,se,"explicit"),requireAll:w(ie,se,"requireAll")};E.link.hasOwnProperty(E.graph)||(E.link[E.graph]={});const ve=E.link[E.graph],te=function(E,U,ie,ue){const ee={};for(const se of U){const Te=E.graphMap[E.graph][se];I(E,Te,ie,ue)&&(ee[se]=Te)}return ee}(E,U,ie,Te),_e=Object.keys(te).sort();for(const Me of _e){const je=te[Me];if(null===ee?E.uniqueEmbeds={[E.graph]:{}}:E.uniqueEmbeds[E.graph]=E.uniqueEmbeds[E.graph]||{},"@link"===Te.embed&&Me in ve){M(ue,ee,ve[Me]);continue}const nt={"@id":Me};if(0===Me.indexOf("_:")&&re.addValue(E.bnodeMap,Me,nt,{propertyIsArray:!0}),ve[Me]=nt,("@first"===Te.embed||"@last"===Te.embed)&&E.is11)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:ie});if(E.embedded||!E.uniqueEmbeds[E.graph].hasOwnProperty(Me)){if(E.embedded&&("@never"===Te.embed||y(je,E.graph,E.subjectStack))){M(ue,ee,nt);continue}if(E.embedded&&("@first"==Te.embed||"@once"==Te.embed)&&E.uniqueEmbeds[E.graph].hasOwnProperty(Me)){M(ue,ee,nt);continue}if("@last"===Te.embed&&Me in E.uniqueEmbeds[E.graph]&&H(E,Me),E.uniqueEmbeds[E.graph][Me]={parent:ue,property:ee},E.subjectStack.push({subject:je,graph:E.graph}),Me in E.graphMap){let Ze=!1,Je=null;"@graph"in ie?(Je=ie["@graph"][0],Ze=!("@merged"===Me||"@default"===Me),L.isObject(Je)||(Je={})):(Ze="@merged"!==E.graph,Je={}),Ze&&A.frame(jn(ht({},E),{graph:Me,embedded:!1}),Object.keys(E.graphMap[Me]).sort(),[Je],nt,"@graph")}"@included"in ie&&A.frame(jn(ht({},E),{embedded:!1}),U,ie["@included"],nt,"@included");for(const Ze of Object.keys(je).sort())if(W(Ze)){if(nt[Ze]=re.clone(je[Ze]),"@type"===Ze)for(const Je of je["@type"])0===Je.indexOf("_:")&&re.addValue(E.bnodeMap,Je,nt,{propertyIsArray:!0})}else if(!Te.explicit||Ze in ie)for(const Je of je[Ze]){const Ke=Ze in ie?ie[Ze]:v(Te);if(j.isList(Je)){const Ve=ie[Ze]&&ie[Ze][0]&&ie[Ze][0]["@list"]?ie[Ze][0]["@list"]:v(Te),Le={"@list":[]};M(nt,Ze,Le);const Ee=Je["@list"];for(const Ie of Ee)j.isSubjectReference(Ie)?A.frame(jn(ht({},E),{embedded:!0}),[Ie["@id"]],Ve,Le,"@list"):M(Le,"@list",re.clone(Ie))}else j.isSubjectReference(Je)?A.frame(jn(ht({},E),{embedded:!0}),[Je["@id"]],Ke,nt,Ze):Q(Ke[0],Je)&&M(nt,Ze,re.clone(Je))}for(const Ze of Object.keys(ie).sort()){if("@type"===Ze){if(!L.isObject(ie[Ze][0])||!("@default"in ie[Ze][0]))continue}else if(W(Ze))continue;const Je=ie[Ze][0]||{};if(!w(Je,se,"omitDefault")&&!(Ze in nt)){let Ve="@null";"@default"in Je&&(Ve=re.clone(Je["@default"])),L.isArray(Ve)||(Ve=[Ve]),nt[Ze]=[{"@preserve":Ve}]}}for(const Ze of Object.keys(ie["@reverse"]||{}).sort()){const Je=ie["@reverse"][Ze];for(const Ke of Object.keys(E.subjects))re.getValues(E.subjects[Ke],Ze).some(Le=>Le["@id"]===Me)&&(nt["@reverse"]=nt["@reverse"]||{},re.addValue(nt["@reverse"],Ze,[],{propertyIsArray:!0}),A.frame(jn(ht({},E),{embedded:!0}),[Ke],Je,nt["@reverse"][Ze],ee))}M(ue,ee,nt),E.subjectStack.pop()}}},A.cleanupNull=(E,U)=>{if(L.isArray(E))return E.map(ue=>A.cleanupNull(ue,U)).filter(ue=>ue);if("@null"===E)return null;if(L.isObject(E)){if("@id"in E){const ie=E["@id"];if(U.link.hasOwnProperty(ie)){const ue=U.link[ie].indexOf(E);if(-1!==ue)return U.link[ie][ue];U.link[ie].push(E)}else U.link[ie]=[E]}for(const ie in E)E[ie]=A.cleanupNull(E[ie],U)}return E}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(Y,Ae,he){"use strict";const W=Y("./JsonLdError"),j=Y("./graphTypes"),L=Y("./types"),re=Y("./util"),{RDF_LIST:$,RDF_FIRST:b,RDF_REST:S,RDF_NIL:R,RDF_TYPE:A,RDF_JSON_LITERAL:v,XSD_BOOLEAN:y,XSD_DOUBLE:w,XSD_INTEGER:D,XSD_STRING:V}=Y("./constants"),I=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,H={};function K(M,F,Q){if(M.termType.endsWith("Node"))return{"@id":M.value};const E={"@value":M.value};if(M.language)E["@language"]=M.language;else{let U=M.datatype.value;if(U||(U=V),U===v){U="@json";try{E["@value"]=JSON.parse(E["@value"])}catch(ie){throw new W("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:E["@value"],cause:ie})}}if(F){if(U===y)"true"===E["@value"]?E["@value"]=!0:"false"===E["@value"]&&(E["@value"]=!1);else if(L.isNumeric(E["@value"]))if(U===D){const ie=parseInt(E["@value"],10);ie.toFixed(0)===E["@value"]&&(E["@value"]=ie)}else U===w&&(E["@value"]=parseFloat(E["@value"]));[y,D,w,V].includes(U)||(E["@type"]=U)}else if("i18n-datatype"===Q&&U.startsWith("https://www.w3.org/ns/i18n#")){const[,ie,ue]=U.split(/[#_]/);ie.length>0&&(E["@language"]=ie,ie.match(I)||console.warn(`@language must be valid BCP47: ${ie}`)),E["@direction"]=ue}else U!==V&&(E["@type"]=U)}return E}Ae.exports=H,H.fromRDF=function(){var M=gt(function*(F,{useRdfType:Q=!1,useNativeTypes:E=!1,rdfDirection:U=null}){const ie={},ue={"@default":ie},ee={};for(const ve of F){const te="DefaultGraph"===ve.graph.termType?"@default":ve.graph.value;te in ue||(ue[te]={}),"@default"!==te&&!(te in ie)&&(ie[te]={"@id":te});const _e=ue[te],Me=ve.subject.value,je=ve.predicate.value,nt=ve.object;Me in _e||(_e[Me]={"@id":Me});const Ze=_e[Me],Je=nt.termType.endsWith("Node");if(Je&&!(nt.value in _e)&&(_e[nt.value]={"@id":nt.value}),je===A&&!Q&&Je){re.addValue(Ze,"@type",nt.value,{propertyIsArray:!0});continue}const Ke=K(nt,E,U);if(re.addValue(Ze,je,Ke,{propertyIsArray:!0}),Je)if(nt.value===R){const Ve=_e[nt.value];"usages"in Ve||(Ve.usages=[]),Ve.usages.push({node:Ze,property:je,value:Ke})}else ee[nt.value]=!(nt.value in ee)&&{node:Ze,property:je,value:Ke}}for(const ve in ue){const te=ue[ve];if(!(R in te))continue;const _e=te[R];if(_e.usages){for(let Me of _e.usages){let je=Me.node,nt=Me.property,Ze=Me.value;const Je=[],Ke=[];let Ve=Object.keys(je).length;for(;nt===S&&L.isObject(ee[je["@id"]])&&L.isArray(je[b])&&1===je[b].length&&L.isArray(je[S])&&1===je[S].length&&(3===Ve||4===Ve&&L.isArray(je["@type"])&&1===je["@type"].length&&je["@type"][0]===$)&&(Je.push(je[b][0]),Ke.push(je["@id"]),Me=ee[je["@id"]],je=Me.node,nt=Me.property,Ze=Me.value,Ve=Object.keys(je).length,j.isBlankNode(je)););delete Ze["@id"],Ze["@list"]=Je.reverse();for(const Le of Ke)delete te[Le]}delete _e.usages}}const se=[],Te=Object.keys(ie).sort();for(const ve of Te){const te=ie[ve];if(ve in ue){const _e=te["@graph"]=[],Me=ue[ve],je=Object.keys(Me).sort();for(const nt of je){const Ze=Me[nt];j.isSubjectReference(Ze)||_e.push(Ze)}}j.isSubjectReference(te)||se.push(te)}return se});return function(F,Q){return M.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(Y,Ae,he){"use strict";const W=Y("./types"),j={};Ae.exports=j,j.isSubject=L=>!(!W.isObject(L)||"@value"in L||"@set"in L||"@list"in L)&&(Object.keys(L).length>1||!("@id"in L)),j.isSubjectReference=L=>W.isObject(L)&&1===Object.keys(L).length&&"@id"in L,j.isValue=L=>W.isObject(L)&&"@value"in L,j.isList=L=>W.isObject(L)&&"@list"in L,j.isGraph=L=>W.isObject(L)&&"@graph"in L&&1===Object.keys(L).filter(re=>"@id"!==re&&"@index"!==re).length,j.isSimpleGraph=L=>j.isGraph(L)&&!("@id"in L),j.isBlankNode=L=>!!W.isObject(L)&&("@id"in L?0===L["@id"].indexOf("_:"):0===Object.keys(L).length||!("@value"in L||"@set"in L||"@list"in L))},{"./types":30}],26:[function(Y,Ae,he){const W=Y("rdf-canonize"),j=Y("./platform"),L=Y("./util"),re=Y("./ContextResolver"),$=L.IdentifierIssuer,b=Y("./JsonLdError"),S=Y("lru-cache"),R=Y("./NQuads"),{expand:A}=Y("./expand"),{flatten:v}=Y("./flatten"),{fromRDF:y}=Y("./fromRdf"),{toRDF:w}=Y("./toRdf"),{frameMergedOrDefault:D,cleanupNull:V}=Y("./frame"),{isArray:I,isObject:H,isString:K}=Y("./types"),{isSubjectReference:M}=Y("./graphTypes"),{expandIri:F,getInitialContext:Q,process:E,processingMode:U}=Y("./context"),{compact:ie,compactIri:ue}=Y("./compact"),{createNodeMap:ee,createMergedNodeMap:se,mergeNodeMaps:Te}=Y("./nodeMap"),ve=function(_e){const Me={},nt=new S({max:100});function Ze(Je,Le){var Ee=Le,{documentLoader:Ke=_e.documentLoader}=Ee,Ve=oW(Ee,["documentLoader"]);return Object.assign({},{documentLoader:Ke},Ve,Je)}return _e.compact=function(){var Je=gt(function*(Ke,Ve,Le){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===Ve)throw new b("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Ke)return null;let Ee;(Le=Ze(Le,{base:K(Ke)?Ke:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new $("_:b"),contextResolver:new re({sharedCache:nt})})).link&&(Le.skipExpansion=!0),Le.compactToRelative||delete Le.base,Ee=Le.skipExpansion?Ke:yield _e.expand(Ke,Le);const Ie=yield _e.processContext(Q(Le),Ve,Le);let Ue=yield ie({activeCtx:Ie,element:Ee,options:Le,compactionMap:Le.compactionMap});Le.compactArrays&&!Le.graph&&I(Ue)?1===Ue.length?Ue=Ue[0]:0===Ue.length&&(Ue={}):Le.graph&&H(Ue)&&(Ue=[Ue]),H(Ve)&&"@context"in Ve&&(Ve=Ve["@context"]),Ve=L.clone(Ve),I(Ve)||(Ve=[Ve]);const qe=Ve;Ve=[];for(let z=0;z<qe.length;++z)(!H(qe[z])||Object.keys(qe[z]).length>0)&&Ve.push(qe[z]);const Be=Ve.length>0;if(1===Ve.length&&(Ve=Ve[0]),I(Ue)){const z=ue({activeCtx:Ie,iri:"@graph",relativeTo:{vocab:!0}}),X=Ue;Ue={},Be&&(Ue["@context"]=Ve),Ue[z]=X}else if(H(Ue)&&Be){const z=Ue;Ue={"@context":Ve};for(const X in z)Ue[X]=z[X]}return Ue});return function(Ke,Ve,Le){return Je.apply(this,arguments)}}(),_e.expand=function(){var Je=gt(function*(Ke,Ve){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(Ve=Ze(Ve,{keepFreeFloatingNodes:!1,contextResolver:new re({sharedCache:nt})})).expansionMap&&(Ve.expansionMap=void 0);const Le={},Ee=[];if("expandContext"in Ve){const Be=L.clone(Ve.expandContext);Le.expandContext=H(Be)&&"@context"in Be?Be:{"@context":Be},Ee.push(Le.expandContext)}let Ie;if(K(Ke)){const Be=yield _e.get(Ke,Ve);Ie=Be.documentUrl,Le.input=Be.document,Be.contextUrl&&(Le.remoteContext={"@context":Be.contextUrl},Ee.push(Le.remoteContext))}else Le.input=L.clone(Ke);"base"in Ve||(Ve.base=Ie||"");let Ue=Q(Ve);for(const Be of Ee)Ue=yield E({activeCtx:Ue,localCtx:Be,options:Ve});let qe=yield A({activeCtx:Ue,element:Le.input,options:Ve,expansionMap:Ve.expansionMap});return H(qe)&&"@graph"in qe&&1===Object.keys(qe).length?qe=qe["@graph"]:null===qe&&(qe=[]),I(qe)||(qe=[qe]),qe});return function(Ke,Ve){return Je.apply(this,arguments)}}(),_e.flatten=function(){var Je=gt(function*(Ke,Ve,Le){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");Ve="function"==typeof Ve?null:Ve||null,Le=Ze(Le,{base:K(Ke)?Ke:"",contextResolver:new re({sharedCache:nt})});const Ee=yield _e.expand(Ke,Le),Ie=v(Ee);return null===Ve?Ie:(Le.graph=!0,Le.skipExpansion=!0,yield _e.compact(Ie,Ve,Le))});return function(Ke,Ve,Le){return Je.apply(this,arguments)}}(),_e.frame=function(){var Je=gt(function*(Ke,Ve,Le){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(Le=Ze(Le,{base:K(Ke)?Ke:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new re({sharedCache:nt})}),K(Ve)){const ce=yield _e.get(Ve,Le);if(Ve=ce.document,ce.contextUrl){let Pe=Ve["@context"];Pe?I(Pe)?Pe.push(ce.contextUrl):Pe=[Pe,ce.contextUrl]:Pe=ce.contextUrl,Ve["@context"]=Pe}}const Ee=Ve&&Ve["@context"]||{},Ie=yield _e.processContext(Q(Le),Ee,Le);Le.hasOwnProperty("omitGraph")||(Le.omitGraph=U(Ie,1.1)),Le.hasOwnProperty("pruneBlankNodeIdentifiers")||(Le.pruneBlankNodeIdentifiers=U(Ie,1.1));const Ue=yield _e.expand(Ke,Le),qe=ht({},Le);qe.isFrame=!0,qe.keepFreeFloatingNodes=!0;const Be=yield _e.expand(Ve,qe),z=Object.keys(Ve).map(ce=>F(Ie,ce,{vocab:!0}));qe.merged=!z.includes("@graph"),qe.is11=U(Ie,1.1);const X=D(Ue,Be,qe);qe.graph=!Le.omitGraph,qe.skipExpansion=!0,qe.link={},qe.framing=!0;let be=yield _e.compact(X,Ee,qe);return qe.link={},be=V(be,qe),be});return function(Ke,Ve,Le){return Je.apply(this,arguments)}}(),_e.link=function(){var Je=gt(function*(Ke,Ve,Le){const Ee={};return Ve&&(Ee["@context"]=Ve),Ee["@embed"]="@link",_e.frame(Ke,Ee,Le)});return function(Ke,Ve,Le){return Je.apply(this,arguments)}}(),_e.normalize=_e.canonize=function(){var Je=gt(function*(Ke,Ve){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(Ve=Ze(Ve,{base:K(Ke)?Ke:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new re({sharedCache:nt})}))){if("application/n-quads"!==Ve.inputFormat&&"application/nquads"!==Ve.inputFormat)throw new b("Unknown canonicalization input format.","jsonld.CanonizeError");const Ie=R.parse(Ke);return W.canonize(Ie,Ve)}const Le=ht({},Ve);delete Le.format,Le.produceGeneralizedRdf=!1;const Ee=yield _e.toRDF(Ke,Le);return W.canonize(Ee,Ve)});return function(Ke,Ve){return Je.apply(this,arguments)}}(),_e.fromRDF=function(){var Je=gt(function*(Ke,Ve){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");Ve=Ze(Ve,{format:K(Ke)?"application/n-quads":void 0});const{format:Le}=Ve;let{rdfParser:Ee}=Ve;if(Le){if(Ee=Ee||Me[Le],!Ee)throw new b("Unknown input format.","jsonld.UnknownFormat",{format:Le})}else Ee=()=>Ke;const Ie=yield Ee(Ke);return y(Ie,Ve)});return function(Ke,Ve){return Je.apply(this,arguments)}}(),_e.toRDF=function(){var Je=gt(function*(Ke,Ve){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let Le;Le=(Ve=Ze(Ve,{base:K(Ke)?Ke:"",skipExpansion:!1,contextResolver:new re({sharedCache:nt})})).skipExpansion?Ke:yield _e.expand(Ke,Ve);const Ee=w(Le,Ve);if(Ve.format){if("application/n-quads"===Ve.format||"application/nquads"===Ve.format)return R.serialize(Ee);throw new b("Unknown output format.","jsonld.UnknownFormat",{format:Ve.format})}return Ee});return function(Ke,Ve){return Je.apply(this,arguments)}}(),_e.createNodeMap=function(){var Je=gt(function*(Ke,Ve){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");Ve=Ze(Ve,{base:K(Ke)?Ke:"",contextResolver:new re({sharedCache:nt})});const Le=yield _e.expand(Ke,Ve);return se(Le,Ve)});return function(Ke,Ve){return Je.apply(this,arguments)}}(),_e.merge=function(){var Je=gt(function*(Ke,Ve,Le){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!I(Ke))throw new TypeError('Could not merge, "docs" must be an array.');Ve="function"==typeof Ve?null:Ve||null,Le=Ze(Le,{contextResolver:new re({sharedCache:nt})});const Ee=yield Promise.all(Ke.map(ce=>{const Pe=ht({},Le);return _e.expand(ce,Pe)}));let Ie=!0;"mergeNodes"in Le&&(Ie=Le.mergeNodes);const Ue=Le.issuer||new $("_:b"),qe={"@default":{}};for(let ce=0;ce<Ee.length;++ce){const Pe=L.relabelBlankNodes(Ee[ce],{issuer:new $("_:b"+ce+"-")}),wt=Ie||0===ce?qe:{"@default":{}};if(ee(Pe,wt,"@default",Ue),wt!==qe)for(const pt in wt){const pe=wt[pt];if(!(pt in qe)){qe[pt]=pe;continue}const B=qe[pt];for(const O in pe)O in B||(B[O]=pe[O])}}const Be=Te(qe),z=[],X=Object.keys(Be).sort();for(let ce=0;ce<X.length;++ce){const Pe=Be[X[ce]];M(Pe)||z.push(Pe)}return null===Ve?z:(Le.graph=!0,Le.skipExpansion=!0,yield _e.compact(z,Ve,Le))});return function(Ke,Ve,Le){return Je.apply(this,arguments)}}(),Object.defineProperty(_e,"documentLoader",{get:()=>_e._documentLoader,set:Je=>_e._documentLoader=Je}),_e.documentLoader=function(){var Je=gt(function*(Ke){throw new b("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Ke})});return function(Ke){return Je.apply(this,arguments)}}(),_e.get=function(){var Je=gt(function*(Ke,Ve){let Le;Le="function"==typeof Ve.documentLoader?Ve.documentLoader:_e.documentLoader;const Ee=yield Le(Ke);try{if(!Ee.document)throw new b("No remote document found at the given URL.","jsonld.NullRemoteDocument");K(Ee.document)&&(Ee.document=JSON.parse(Ee.document))}catch(Ie){throw new b("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:Ie,remoteDoc:Ee})}return Ee});return function(Ke,Ve){return Je.apply(this,arguments)}}(),_e.processContext=function(){var Je=gt(function*(Ke,Ve,Le){return Le=Ze(Le,{base:"",contextResolver:new re({sharedCache:nt})}),null===Ve?Q(Le):(Ve=L.clone(Ve),H(Ve)&&"@context"in Ve||(Ve={"@context":Ve}),E({activeCtx:Ke,localCtx:Ve,options:Le}))});return function(Ke,Ve,Le){return Je.apply(this,arguments)}}(),_e.getContextValue=Y("./context").getContextValue,_e.documentLoaders={},_e.useDocumentLoader=function(Je){if(!(Je in _e.documentLoaders))throw new b('Unknown document loader type: "'+Je+'"',"jsonld.UnknownDocumentLoader",{type:Je});_e.documentLoader=_e.documentLoaders[Je].apply(_e,Array.prototype.slice.call(arguments,1))},_e.registerRDFParser=function(Je,Ke){Me[Je]=Ke},_e.unregisterRDFParser=function(Je){delete Me[Je]},_e.registerRDFParser("application/n-quads",R.parse),_e.registerRDFParser("application/nquads",R.parse),_e.url=Y("./url"),_e.util=L,Object.assign(_e,L),_e.promises=_e,_e.RequestQueue=Y("./RequestQueue"),_e.JsonLdProcessor=Y("./JsonLdProcessor")(_e),j.setupGlobals(_e),j.setupDocumentLoaders(_e),_e},te=function(){return ve(function(){return te()})};ve(te),Ae.exports=te},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(Y,Ae,he){"use strict";const{isKeyword:W}=Y("./context"),j=Y("./graphTypes"),L=Y("./types"),re=Y("./util"),$=Y("./JsonLdError"),b={};Ae.exports=b,b.createMergedNodeMap=(S,R)=>{const A=(R=R||{}).issuer||new re.IdentifierIssuer("_:b"),v={"@default":{}};return b.createNodeMap(S,v,"@default",A),b.mergeNodeMaps(v)},b.createNodeMap=(S,R,A,v,y,w)=>{if(L.isArray(S)){for(const H of S)b.createNodeMap(H,R,A,v,void 0,w);return}if(!L.isObject(S))return void(w&&w.push(S));if(j.isValue(S)){if("@type"in S){let H=S["@type"];0===H.indexOf("_:")&&(S["@type"]=H=v.getId(H))}return void(w&&w.push(S))}if(w&&j.isList(S)){const H=[];return b.createNodeMap(S["@list"],R,A,v,y,H),void w.push({"@list":H})}if("@type"in S){const H=S["@type"];for(const K of H)0===K.indexOf("_:")&&v.getId(K)}L.isUndefined(y)&&(y=j.isBlankNode(S)?v.getId(S["@id"]):S["@id"]),w&&w.push({"@id":y});const D=R[A],V=D[y]=D[y]||{};V["@id"]=y;const I=Object.keys(S).sort();for(let H of I){if("@id"===H)continue;if("@reverse"===H){const M={"@id":y},F=S["@reverse"];for(const Q in F){const E=F[Q];for(const U of E){let ie=U["@id"];j.isBlankNode(U)&&(ie=v.getId(ie)),b.createNodeMap(U,R,A,v,ie),re.addValue(D[ie],Q,M,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===H){y in R||(R[y]={}),b.createNodeMap(S[H],R,y,v);continue}if("@included"===H){b.createNodeMap(S[H],R,A,v);continue}if("@type"!==H&&W(H)){if("@index"===H&&H in V&&(S[H]!==V[H]||S[H]["@id"]!==V[H]["@id"]))throw new $("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:V});V[H]=S[H];continue}const K=S[H];if(0===H.indexOf("_:")&&(H=v.getId(H)),0!==K.length)for(let M of K)if("@type"===H&&(M=0===M.indexOf("_:")?v.getId(M):M),j.isSubject(M)||j.isSubjectReference(M)){if("@id"in M&&!M["@id"])continue;const F=j.isBlankNode(M)?v.getId(M["@id"]):M["@id"];re.addValue(V,H,{"@id":F},{propertyIsArray:!0,allowDuplicate:!1}),b.createNodeMap(M,R,A,v,F)}else if(j.isValue(M))re.addValue(V,H,M,{propertyIsArray:!0,allowDuplicate:!1});else if(j.isList(M)){const F=[];b.createNodeMap(M["@list"],R,A,v,y,F),M={"@list":F},re.addValue(V,H,M,{propertyIsArray:!0,allowDuplicate:!1})}else b.createNodeMap(M,R,A,v,y),re.addValue(V,H,M,{propertyIsArray:!0,allowDuplicate:!1});else re.addValue(V,H,[],{propertyIsArray:!0})}},b.mergeNodeMapGraphs=S=>{const R={};for(const A of Object.keys(S).sort())for(const v of Object.keys(S[A]).sort()){const y=S[A][v];v in R||(R[v]={"@id":v});const w=R[v];for(const D of Object.keys(y).sort())if(W(D)&&"@type"!==D)w[D]=re.clone(y[D]);else for(const V of y[D])re.addValue(w,D,re.clone(V),{propertyIsArray:!0,allowDuplicate:!1})}return R},b.mergeNodeMaps=S=>{const R=S["@default"],A=Object.keys(S).sort();for(const v of A){if("@default"===v)continue;const y=S[v];let w=R[v];w?"@graph"in w||(w["@graph"]=[]):R[v]=w={"@id":v,"@graph":[]};const D=w["@graph"];for(const V of Object.keys(y).sort()){const I=y[V];j.isSubjectReference(I)||D.push(I)}}return R}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(Y,Ae,he){"use strict";const W=Y("./documentLoaders/xhr"),j={};Ae.exports=j,j.setupDocumentLoaders=function(L){"undefined"!=typeof XMLHttpRequest&&(L.documentLoaders.xhr=W,L.useDocumentLoader("xhr"))},j.setupGlobals=function(L){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:L.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(Y,Ae,he){"use strict";const{createNodeMap:W}=Y("./nodeMap"),{isKeyword:j}=Y("./context"),L=Y("./graphTypes"),re=Y("canonicalize"),$=Y("./types"),b=Y("./util"),{RDF_FIRST:S,RDF_REST:R,RDF_NIL:A,RDF_TYPE:v,RDF_JSON_LITERAL:y,RDF_LANGSTRING:w,XSD_BOOLEAN:D,XSD_DOUBLE:V,XSD_INTEGER:I,XSD_STRING:H}=Y("./constants"),{isAbsolute:K}=Y("./url"),M={};function F(U,ie,ue,ee,se){const Te=Object.keys(ie).sort();for(const ve of Te){const te=ie[ve],_e=Object.keys(te).sort();for(let Me of _e){const je=te[Me];if("@type"===Me)Me=v;else if(j(Me))continue;for(const nt of je){const Ze={termType:ve.startsWith("_:")?"BlankNode":"NamedNode",value:ve};if(!K(ve))continue;const Je={termType:Me.startsWith("_:")?"BlankNode":"NamedNode",value:Me};if(!K(Me)||"BlankNode"===Je.termType&&!se.produceGeneralizedRdf)continue;const Ke=E(nt,ee,U,ue,se.rdfDirection);Ke&&U.push({subject:Ze,predicate:Je,object:Ke,graph:ue})}}}}function E(U,ie,ue,ee,se){const Te={};if(L.isValue(U)){Te.termType="Literal",Te.value=void 0,Te.datatype={termType:"NamedNode"};let ve=U["@value"];const te=U["@type"]||null;"@json"===te?(Te.value=re(ve),Te.datatype.value=y):$.isBoolean(ve)?(Te.value=ve.toString(),Te.datatype.value=te||D):$.isDouble(ve)||te===V?($.isDouble(ve)||(ve=parseFloat(ve)),Te.value=ve.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Te.datatype.value=te||V):$.isNumber(ve)?(Te.value=ve.toFixed(0),Te.datatype.value=te||I):"i18n-datatype"===se&&"@direction"in U?(Te.datatype.value="https://www.w3.org/ns/i18n#"+(U["@language"]||"")+`_${U["@direction"]}`,Te.value=ve):"@language"in U?(Te.value=ve,Te.datatype.value=te||w,Te.language=U["@language"]):(Te.value=ve,Te.datatype.value=te||H)}else if(L.isList(U)){const ve=function(U,ie,ue,ee,se){const Te={termType:"NamedNode",value:S},ve={termType:"NamedNode",value:R},te={termType:"NamedNode",value:A},_e=U.pop(),Me=_e?{termType:"BlankNode",value:ie.getId()}:te;let je=Me;for(const nt of U){const Ze=E(nt,ie,ue,ee,se),Je={termType:"BlankNode",value:ie.getId()};ue.push({subject:je,predicate:Te,object:Ze,graph:ee}),ue.push({subject:je,predicate:ve,object:Je,graph:ee}),je=Je}if(_e){const nt=E(_e,ie,ue,ee,se);ue.push({subject:je,predicate:Te,object:nt,graph:ee}),ue.push({subject:je,predicate:ve,object:te,graph:ee})}return Me}(U["@list"],ie,ue,ee,se);Te.termType=ve.termType,Te.value=ve.value}else{const ve=$.isObject(U)?U["@id"]:U;Te.termType=ve.startsWith("_:")?"BlankNode":"NamedNode",Te.value=ve}return"NamedNode"!==Te.termType||K(Te.value)?Te:null}Ae.exports=M,M.toRDF=(U,ie)=>{const ue=new b.IdentifierIssuer("_:b"),ee={"@default":{}};W(U,ee,"@default",ue);const se=[],Te=Object.keys(ee).sort();for(const ve of Te){let te;if("@default"===ve)te={termType:"DefaultGraph",value:""};else{if(!K(ve))continue;te=ve.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},te.value=ve}F(se,ee[ve],te,ue,ie)}return se}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(Y,Ae,he){"use strict";const W={};Ae.exports=W,W.isArray=Array.isArray,W.isBoolean=j=>"boolean"==typeof j||"[object Boolean]"===Object.prototype.toString.call(j),W.isDouble=j=>W.isNumber(j)&&(-1!==String(j).indexOf(".")||Math.abs(j)>=1e21),W.isEmptyObject=j=>W.isObject(j)&&0===Object.keys(j).length,W.isNumber=j=>"number"==typeof j||"[object Number]"===Object.prototype.toString.call(j),W.isNumeric=j=>!isNaN(parseFloat(j))&&isFinite(j),W.isObject=j=>"[object Object]"===Object.prototype.toString.call(j),W.isString=j=>"string"==typeof j||"[object String]"===Object.prototype.toString.call(j),W.isUndefined=j=>void 0===j},{}],31:[function(Y,Ae,he){"use strict";const W=Y("./types"),j={};Ae.exports=j,j.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},j.parse=(re,$)=>{const b={},S=j.parsers[$||"full"],R=S.regex.exec(re);let A=S.keys.length;for(;A--;)b[S.keys[A]]=void 0===R[A]?null:R[A];return("https"===b.scheme&&"443"===b.port||"http"===b.scheme&&"80"===b.port)&&(b.href=b.href.replace(":"+b.port,""),b.authority=b.authority.replace(":"+b.port,""),b.port=null),b.normalizedPath=j.removeDotSegments(b.path),b},j.prependBase=(re,$)=>{if(null===re||j.isAbsolute($))return $;(!re||W.isString(re))&&(re=j.parse(re||""));const b=j.parse($),S={protocol:re.protocol||""};if(null!==b.authority)S.authority=b.authority,S.path=b.path,S.query=b.query;else if(S.authority=re.authority,""===b.path)S.path=re.path,S.query=null!==b.query?b.query:re.query;else{if(0===b.path.indexOf("/"))S.path=b.path;else{let A=re.path;A=A.substr(0,A.lastIndexOf("/")+1),(A.length>0||re.authority)&&"/"!==A.substr(-1)&&(A+="/"),A+=b.path,S.path=A}S.query=b.query}""!==b.path&&(S.path=j.removeDotSegments(S.path));let R=S.protocol;return null!==S.authority&&(R+="//"+S.authority),R+=S.path,null!==S.query&&(R+="?"+S.query),null!==b.fragment&&(R+="#"+b.fragment),""===R&&(R="./"),R},j.removeBase=(re,$)=>{if(null===re)return $;(!re||W.isString(re))&&(re=j.parse(re||""));let b="";if(""!==re.href?b+=(re.protocol||"")+"//"+(re.authority||""):$.indexOf("//")&&(b+="//"),0!==$.indexOf(b))return $;const S=j.parse($.substr(b.length)),R=re.normalizedPath.split("/"),A=S.normalizedPath.split("/"),v=S.fragment||S.query?0:1;for(;R.length>0&&A.length>v&&R[0]===A[0];)R.shift(),A.shift();let y="";if(R.length>0){R.pop();for(let w=0;w<R.length;++w)y+="../"}return y+=A.join("/"),null!==S.query&&(y+="?"+S.query),null!==S.fragment&&(y+="#"+S.fragment),""===y&&(y="./"),y},j.removeDotSegments=re=>{if(0===re.length)return"";const $=re.split("/"),b=[];for(;$.length>0;){const S=$.shift(),R=0===$.length;"."!==S?".."!==S?b.push(S):(b.pop(),R&&b.push("")):R&&b.push("")}return"/"===re[0]&&b.length>0&&""!==b[0]&&b.unshift(""),1===b.length&&""===b[0]?"/":b.join("/")};const L=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;j.isAbsolute=re=>W.isString(re)&&L.test(re),j.isRelative=re=>W.isString(re)},{"./types":30}],32:[function(Y,Ae,he){"use strict";const W=Y("./graphTypes"),j=Y("./types"),L=Y("rdf-canonize").IdentifierIssuer,re=Y("./JsonLdError"),$=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,b=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,S=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,R_headers={accept:"application/ld+json, application/json"},A={};function v(y,w){if(j.isArray(w))for(let D=0;D<w.length;++D)w[D]=v(y,w[D]);else if(W.isList(w))w["@list"]=v(y,w["@list"]);else if(j.isObject(w)){W.isBlankNode(w)&&(w["@id"]=y.getId(w["@id"]));const D=Object.keys(w).sort();for(let V=0;V<D.length;++V){const I=D[V];"@id"!==I&&(w[I]=v(y,w[I]))}}return w}Ae.exports=A,A.IdentifierIssuer=L,A.clone=function(y){if(y&&"object"==typeof y){let w;if(j.isArray(y)){w=[];for(let D=0;D<y.length;++D)w[D]=A.clone(y[D])}else if(y instanceof Map){w=new Map;for(const[D,V]of y)w.set(D,A.clone(V))}else if(y instanceof Set){w=new Set;for(const D of y)w.add(A.clone(D))}else if(j.isObject(y)){w={};for(const D in y)w[D]=A.clone(y[D])}else w=y.toString();return w}return y},A.asArray=function(y){return Array.isArray(y)?y:[y]},A.buildHeaders=(y={})=>{if(Object.keys(y).some(D=>"accept"===D.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+R_headers.accept+'" is supported.');return Object.assign({Accept:R_headers.accept},y)},A.parseLinkHeader=y=>{const w={},D=y.match($);for(let V=0;V<D.length;++V){let I=D[V].match(b);if(!I)continue;const H={target:I[1]},K=I[2];for(;I=S.exec(K);)H[I[1]]=void 0===I[2]?I[3]:I[2];const M=H.rel||"";Array.isArray(w[M])?w[M].push(H):w[M]=w.hasOwnProperty(M)?[w[M],H]:H}return w},A.validateTypeValue=(y,w)=>{if(!(j.isString(y)||j.isArray(y)&&y.every(D=>j.isString(D)))){if(w&&j.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&A.asArray(y["@default"]).every(D=>j.isString(D)))return}throw new re('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},A.hasProperty=(y,w)=>{if(y.hasOwnProperty(w)){const D=y[w];return!j.isArray(D)||D.length>0}return!1},A.hasValue=(y,w,D)=>{if(A.hasProperty(y,w)){let V=y[w];const I=W.isList(V);if(j.isArray(V)||I){I&&(V=V["@list"]);for(let H=0;H<V.length;++H)if(A.compareValues(D,V[H]))return!0}else if(!j.isArray(D))return A.compareValues(D,V)}return!1},A.addValue=(y,w,D,V)=>{if("propertyIsArray"in(V=V||{})||(V.propertyIsArray=!1),"valueIsArray"in V||(V.valueIsArray=!1),"allowDuplicate"in V||(V.allowDuplicate=!0),"prependValue"in V||(V.prependValue=!1),V.valueIsArray)y[w]=D;else if(j.isArray(D)){0===D.length&&V.propertyIsArray&&!y.hasOwnProperty(w)&&(y[w]=[]),V.prependValue&&(D=D.concat(y[w]),y[w]=[]);for(let I=0;I<D.length;++I)A.addValue(y,w,D[I],V)}else if(y.hasOwnProperty(w)){const I=!V.allowDuplicate&&A.hasValue(y,w,D);!j.isArray(y[w])&&(!I||V.propertyIsArray)&&(y[w]=[y[w]]),I||(V.prependValue?y[w].unshift(D):y[w].push(D))}else y[w]=V.propertyIsArray?[D]:D},A.getValues=(y,w)=>[].concat(y[w]||[]),A.removeProperty=(y,w)=>{delete y[w]},A.removeValue=(y,w,D,V)=>{"propertyIsArray"in(V=V||{})||(V.propertyIsArray=!1);const I=A.getValues(y,w).filter(H=>!A.compareValues(H,D));0===I.length?A.removeProperty(y,w):y[w]=1!==I.length||V.propertyIsArray?I:I[0]},A.relabelBlankNodes=(y,w)=>v((w=w||{}).issuer||new L("_:b"),y),A.compareValues=(y,w)=>!!(y===w||W.isValue(y)&&W.isValue(w)&&y["@value"]===w["@value"]&&y["@type"]===w["@type"]&&y["@language"]===w["@language"]&&y["@index"]===w["@index"])||!!(j.isObject(y)&&"@id"in y&&j.isObject(w)&&"@id"in w)&&y["@id"]===w["@id"],A.compareShortestLeast=(y,w)=>y.length<w.length?-1:w.length<y.length?1:y===w?0:y<w?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(Y,Ae,he){"use strict";const W=Y("yallist"),j=Symbol("max"),L=Symbol("length"),re=Symbol("lengthCalculator"),$=Symbol("allowStale"),b=Symbol("maxAge"),S=Symbol("dispose"),R=Symbol("noDisposeOnSet"),A=Symbol("lruList"),v=Symbol("cache"),y=Symbol("updateAgeOnGet"),w=()=>1;const V=(Q,E,U)=>{const ie=Q[v].get(E);if(ie){const ue=ie.value;if(I(Q,ue)){if(K(Q,ie),!Q[$])return}else U&&(Q[y]&&(ie.value.now=Date.now()),Q[A].unshiftNode(ie));return ue.value}},I=(Q,E)=>{if(!E||!E.maxAge&&!Q[b])return!1;const U=Date.now()-E.now;return E.maxAge?U>E.maxAge:Q[b]&&U>Q[b]},H=Q=>{if(Q[L]>Q[j])for(let E=Q[A].tail;Q[L]>Q[j]&&null!==E;){const U=E.prev;K(Q,E),E=U}},K=(Q,E)=>{if(E){const U=E.value;Q[S]&&Q[S](U.key,U.value),Q[L]-=U.length,Q[v].delete(U.key),Q[A].removeNode(E)}};class M{constructor(E,U,ie,ue,ee){this.key=E,this.value=U,this.length=ie,this.now=ue,this.maxAge=ee||0}}const F=(Q,E,U,ie)=>{let ue=U.value;I(Q,ue)&&(K(Q,U),Q[$]||(ue=void 0)),ue&&E.call(ie,ue.value,ue.key,Q)};Ae.exports=class{constructor(E){if("number"==typeof E&&(E={max:E}),E||(E={}),E.max&&("number"!=typeof E.max||E.max<0))throw new TypeError("max must be a non-negative number");this[j]=E.max||1/0;const ie=E.length||w;if(this[re]="function"!=typeof ie?w:ie,this[$]=E.stale||!1,E.maxAge&&"number"!=typeof E.maxAge)throw new TypeError("maxAge must be a number");this[b]=E.maxAge||0,this[S]=E.dispose,this[R]=E.noDisposeOnSet||!1,this[y]=E.updateAgeOnGet||!1,this.reset()}set max(E){if("number"!=typeof E||E<0)throw new TypeError("max must be a non-negative number");this[j]=E||1/0,H(this)}get max(){return this[j]}set allowStale(E){this[$]=!!E}get allowStale(){return this[$]}set maxAge(E){if("number"!=typeof E)throw new TypeError("maxAge must be a non-negative number");this[b]=E,H(this)}get maxAge(){return this[b]}set lengthCalculator(E){"function"!=typeof E&&(E=w),E!==this[re]&&(this[re]=E,this[L]=0,this[A].forEach(U=>{U.length=this[re](U.value,U.key),this[L]+=U.length})),H(this)}get lengthCalculator(){return this[re]}get length(){return this[L]}get itemCount(){return this[A].length}rforEach(E,U){U=U||this;for(let ie=this[A].tail;null!==ie;){const ue=ie.prev;F(this,E,ie,U),ie=ue}}forEach(E,U){U=U||this;for(let ie=this[A].head;null!==ie;){const ue=ie.next;F(this,E,ie,U),ie=ue}}keys(){return this[A].toArray().map(E=>E.key)}values(){return this[A].toArray().map(E=>E.value)}reset(){this[S]&&this[A]&&this[A].length&&this[A].forEach(E=>this[S](E.key,E.value)),this[v]=new Map,this[A]=new W,this[L]=0}dump(){return this[A].map(E=>!I(this,E)&&{k:E.key,v:E.value,e:E.now+(E.maxAge||0)}).toArray().filter(E=>E)}dumpLru(){return this[A]}set(E,U,ie){if((ie=ie||this[b])&&"number"!=typeof ie)throw new TypeError("maxAge must be a number");const ue=ie?Date.now():0,ee=this[re](U,E);if(this[v].has(E)){if(ee>this[j])return K(this,this[v].get(E)),!1;const ve=this[v].get(E).value;return this[S]&&(this[R]||this[S](E,ve.value)),ve.now=ue,ve.maxAge=ie,ve.value=U,this[L]+=ee-ve.length,ve.length=ee,this.get(E),H(this),!0}const se=new M(E,U,ee,ue,ie);return se.length>this[j]?(this[S]&&this[S](E,U),!1):(this[L]+=se.length,this[A].unshift(se),this[v].set(E,this[A].head),H(this),!0)}has(E){if(!this[v].has(E))return!1;const U=this[v].get(E).value;return!I(this,U)}get(E){return V(this,E,!0)}peek(E){return V(this,E,!1)}pop(){const E=this[A].tail;return E?(K(this,E),E.value):null}del(E){K(this,this[v].get(E))}load(E){this.reset();const U=Date.now();for(let ie=E.length-1;ie>=0;ie--){const ue=E[ie],ee=ue.e||0;if(0===ee)this.set(ue.k,ue.v);else{const se=ee-U;se>0&&this.set(ue.k,ue.v,se)}}}prune(){this[v].forEach((E,U)=>V(this,U,!1))}}},{yallist:92}],34:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;const W="http://www.w3.org/1999/02/22-rdf-syntax-ns#",j="http://www.w3.org/2001/XMLSchema#",L="http://www.w3.org/2000/10/swap/";he.default={xsd:{decimal:`${j}decimal`,boolean:`${j}boolean`,double:`${j}double`,integer:`${j}integer`,string:`${j}string`},rdf:{type:`${W}type`,nil:`${W}nil`,first:`${W}first`,rest:`${W}rest`,langString:`${W}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${L}reify#forSome`,forAll:`${L}reify#forAll`},log:{implies:`${L}log#implies`}}},{}],35:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.termFromId=function M(te,_e){if(_e=_e||v,!te)return _e.defaultGraph();switch(te[0]){case"?":return _e.variable(te.substr(1));case"_":return _e.blankNode(te.substr(2));case'"':if(_e===v)return new V(te);if('"'===te[te.length-1])return _e.literal(te.substr(1,te.length-2));const Me=te.lastIndexOf('"',te.length-1);return _e.literal(te.substr(1,Me-1),"@"===te[Me+1]?te.substr(Me+2):_e.namedNode(te.substr(Me+3)));case"<":const je=A.exec(te);return _e.quad(M(U(je[1]),_e),M(U(je[2]),_e),M(U(je[3]),_e),je[4]&&M(U(je[4]),_e));default:return _e.namedNode(te)}},he.termToId=function F(te){if("string"==typeof te)return te;if(te instanceof w&&"Quad"!==te.termType)return te.id;if(!te)return b.id;switch(te.termType){case"NamedNode":return te.value;case"BlankNode":return`_:${te.value}`;case"Variable":return`?${te.value}`;case"DefaultGraph":return"";case"Literal":return`"${te.value}"${te.language?`@${te.language}`:te.datatype&&te.datatype.value!==$.string?`^^${te.datatype.value}`:""}`;case"Quad":return`<<${E(F(te.subject))} ${E(F(te.predicate))} ${E(F(te.object))}${(0,j.isDefaultGraph)(te.graph)?"":` ${F(te.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${te.termType}`)}},he.escapeQuotes=E,he.unescapeQuotes=U,he.Triple=he.Quad=he.DefaultGraph=he.Variable=he.BlankNode=he.Literal=he.NamedNode=he.Term=he.default=void 0;var te,W=(te=Y("./IRIs"))&&te.__esModule?te:{default:te},j=Y("./N3Util");const{rdf:re,xsd:$}=W.default;let b,S=0;const R=/^"(.*".*)(?="[^"]*$)/,A=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,v={namedNode:function(te){return new D(te)},blankNode:function(te){return new I(te||"n3-"+S++)},variable:function(te){return new H(te)},literal:function(te,_e){if("string"==typeof _e)return new V(`"${te}"@${_e.toLowerCase()}`);let Me=_e?_e.value:"";return""===Me&&("boolean"==typeof te?Me=$.boolean:"number"==typeof te&&(Number.isFinite(te)?Me=Number.isInteger(te)?$.integer:$.double:(Me=$.double,Number.isNaN(te)||(te=te>0?"INF":"-INF")))),new V(""===Me||Me===$.string?`"${te}"`:`"${te}"^^${Me}`)},defaultGraph:function(){return b},quad:ve,triple:ve};he.default=v;class w{constructor(_e){this.id=_e}get value(){return this.id}equals(_e){return _e instanceof w?this.id===_e.id:!!_e&&this.termType===_e.termType&&this.value===_e.value}toJSON(){return{termType:this.termType,value:this.value}}}he.Term=w;class D extends w{get termType(){return"NamedNode"}}he.NamedNode=D;class V extends w{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const _e=this.id;let Me=_e.lastIndexOf('"')+1;return Me<_e.length&&"@"===_e[Me++]?_e.substr(Me).toLowerCase():""}get datatype(){return new D(this.datatypeString)}get datatypeString(){const _e=this.id,Me=_e.lastIndexOf('"')+1,je=Me<_e.length?_e[Me]:"";return"^"===je?_e.substr(Me+2):"@"!==je?$.string:re.langString}equals(_e){return _e instanceof V?this.id===_e.id:!!_e&&!!_e.datatype&&this.termType===_e.termType&&this.value===_e.value&&this.language===_e.language&&this.datatype.value===_e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}he.Literal=V;class I extends w{constructor(_e){super(`_:${_e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}he.BlankNode=I;class H extends w{constructor(_e){super(`?${_e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}he.Variable=H;class K extends w{constructor(){return super(""),b||this}get termType(){return"DefaultGraph"}equals(_e){return this===_e||!!_e&&this.termType===_e.termType}}he.DefaultGraph=K,b=new K;class Q extends w{constructor(_e,Me,je,nt){super(""),this._subject=_e,this._predicate=Me,this._object=je,this._graph=nt||b}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(_e){return!!_e&&this._subject.equals(_e.subject)&&this._predicate.equals(_e.predicate)&&this._object.equals(_e.object)&&this._graph.equals(_e.graph)}}function E(te){return te.replace(R,(_e,Me)=>`"${Me.replace(/"/g,'""')}`)}function U(te){return te.replace(R,(_e,Me)=>`"${Me.replace(/""/g,'"')}`)}function ve(te,_e,Me,je){return new Q(te,_e,Me,je)}he.Triple=he.Quad=Q},{"./IRIs":34,"./N3Util":41}],36:[function(Y,Ae,he){(function(W){(function(){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var j=re(Y("./IRIs")),L=re(Y("queue-microtask"));function re(w){return w&&w.__esModule?w:{default:w}}const{xsd:$}=j.default,b=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,S={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},R=/[\x00-\x20<>\\"\{\}\|\^\`]/,A={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},v=/$0^/;he.default=class{constructor(D){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(D=D||{}).lineMode){this._n3Mode=!1;for(const V in this)!(V in A)&&this[V]instanceof RegExp&&(this[V]=v)}else this._n3Mode=!1!==D.n3;this._comments=!!D.comments,this._literalClosingPos=0}_tokenizeToEnd(D,V){let I=this._input;const H=this._comments;for(;;){let M,F;for(;M=this._newline.exec(I);)H&&(F=this._comment.exec(M[0]))&&D(null,{line:this._line,type:"comment",value:F[1],prefix:""}),I=I.substr(M[0].length,I.length),this._line++;if(!M&&(M=this._whitespace.exec(I))&&(I=I.substr(M[0].length,I.length)),this._endOfFile.test(I))return V&&(H&&(F=this._comment.exec(I))&&D(null,{line:this._line,type:"comment",value:F[1],prefix:""}),D(I=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=I;const Q=this._line,E=I[0];let U="",ie="",ue="",ee=null,se=0,Te=!1;switch(E){case"^":if(I.length<3)break;if("^"!==I[1]){this._n3Mode&&(se=1,U="^");break}if(this._previousMarker="^^",I=I.substr(2),"<"!==I[0]){Te=!0;break}case"<":if(ee=this._unescapedIri.exec(I))U="IRI",ie=ee[1];else if(ee=this._iri.exec(I)){if(ie=this._unescape(ee[1]),null===ie||R.test(ie))return K(this);U="IRI"}else I.length>1&&"<"===I[1]?(U="<<",se=2):this._n3Mode&&I.length>1&&"="===I[1]&&(U="inverse",se=2,ie=">");break;case">":I.length>1&&">"===I[1]&&(U=">>",se=2);break;case"_":((ee=this._blank.exec(I))||V&&(ee=this._blank.exec(`${I} `)))&&(U="blank",ue="_",ie=ee[1]);break;case'"':if(ee=this._simpleQuotedString.exec(I))ie=ee[1];else if(({value:ie,matchLength:se}=this._parseLiteral(I)),null===ie)return K(this);(null!==ee||0!==se)&&(U="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(ee=this._simpleApostropheString.exec(I))ie=ee[1];else if(({value:ie,matchLength:se}=this._parseLiteral(I)),null===ie)return K(this);(null!==ee||0!==se)&&(U="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(ee=this._variable.exec(I))&&(U="var",ie=ee[0]);break;case"@":"literal"===this._previousMarker&&(ee=this._langcode.exec(I))?(U="langcode",ie=ee[1]):(ee=this._keyword.exec(I))&&(U=ee[0]);break;case".":if(1===I.length?V:I[1]<"0"||I[1]>"9"){U=".",se=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(ee=this._number.exec(I)||V&&(ee=this._number.exec(`${I} `)))&&(U="literal",ie=ee[0],ue="string"==typeof ee[1]?$.double:"string"==typeof ee[2]?$.decimal:$.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(ee=this._sparqlKeyword.exec(I))?U=ee[0].toUpperCase():Te=!0;break;case"f":case"t":(ee=this._boolean.exec(I))?(U="literal",ie=ee[0],ue=$.boolean):Te=!0;break;case"a":(ee=this._shortPredicates.exec(I))?(U="abbreviation",ie="a"):Te=!0;break;case"=":this._n3Mode&&I.length>1&&(U="abbreviation",">"!==I[1]?(se=1,ie="="):(se=2,ie=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(se=1,U=E);break;default:Te=!0}if(Te&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(ee=this._prefix.exec(I))?((ee=this._prefixed.exec(I))||V&&(ee=this._prefixed.exec(`${I} `)))&&(U="prefixed",ue=ee[1]||"",ie=this._unescape(ee[2])):(U="prefix",ie=ee[1]||"")),"^^"===this._previousMarker)switch(U){case"prefixed":U="type";break;case"IRI":U="typeIRI";break;default:U=""}if(!U)return V||!/^'''|^"""/.test(I)&&/\n|\r/.test(I)?K(this):this._input=I;const ve={line:Q,type:U,value:ie,prefix:ue};D(null,ve),this.previousToken=ve,this._previousMarker=U,I=I.substr(se||ee[0].length,I.length)}function K(M){D(M._syntaxError(/^\S*/.exec(I)[0]))}}_unescape(D){let V=!1;const I=D.replace(b,(H,K,M,F)=>{if("string"==typeof K)return String.fromCharCode(Number.parseInt(K,16));if("string"==typeof M){let Q=Number.parseInt(M,16);return Q<=65535?String.fromCharCode(Number.parseInt(M,16)):String.fromCharCode(55296+((Q-=65536)>>10),56320+(1023&Q))}return F in S?S[F]:(V=!0,"")});return V?null:I}_parseLiteral(D){if(D.length>=3){const V=D.match(/^(?:"""|"|'''|'|)/)[0],I=V.length;let H=Math.max(this._literalClosingPos,I);for(;(H=D.indexOf(V,H))>0;){let K=0;for(;"\\"===D[H-K-1];)K++;if(K%2==0){const M=D.substring(I,H),F=M.split(/\r\n|\r|\n/).length-1,Q=H+I;if(1===I&&0!==F||3===I&&this._lineMode)break;return this._line+=F,{value:this._unescape(M),matchLength:Q}}H++}this._literalClosingPos=D.length-I+1}return{value:"",matchLength:0}}_syntaxError(D){this._input=null;const V=new Error(`Unexpected "${D}" on line ${this._line}.`);return V.context={token:void 0,line:this._line,previousToken:this.previousToken},V}_readStartingBom(D){return D.startsWith("\ufeff")?D.substr(1):D}tokenize(D,V){if(this._line=1,"string"==typeof D){if(this._input=this._readStartingBom(D),"function"!=typeof V){const I=[];let H;if(this._tokenizeToEnd((K,M)=>K?H=K:I.push(M),!0),H)throw H;return I}(0,L.default)(()=>this._tokenizeToEnd(V,!0))}else this._pendingBuffer=null,"function"==typeof D.setEncoding&&D.setEncoding("utf8"),D.on("data",I=>{null!==this._input&&0!==I.length&&(this._pendingBuffer&&(I=W.concat([this._pendingBuffer,I]),this._pendingBuffer=null),128&I[I.length-1]?this._pendingBuffer=I:(void 0===this._input?this._input=this._readStartingBom("string"==typeof I?I:I.toString()):this._input+=I,this._tokenizeToEnd(V,!1)))}),D.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(V,!0)}),D.on("error",V)}}}).call(this)}).call(this,Y("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var W=re(Y("./N3Lexer")),j=re(Y("./N3DataFactory")),L=re(Y("./IRIs"));function re(A){return A&&A.__esModule?A:{default:A}}let $=0;class b{constructor(v){this._contextStack=[],this._graph=null,this._setBase((v=v||{}).baseIRI),v.factory&&R(this,v.factory);const y="string"==typeof v.format?v.format.match(/\w*$/)[0].toLowerCase():"",w=/turtle/.test(y),D=/trig/.test(y),V=/triple/.test(y),I=/quad/.test(y),H=this._n3Mode=/n3/.test(y),K=V||I;(this._supportsNamedGraphs=!(w||H))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(w||D||V||H),this._supportsRDFStar=""===y||/star|\*$/.test(y),K&&(this._resolveRelativeIRI=M=>null),this._blankNodePrefix="string"!=typeof v.blankNodePrefix?"":v.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=v.lexer||new W.default({lineMode:K,n3:H}),this._explicitQuantifiers=!!v.explicitQuantifiers}static _resetBlankNodePrefix(){$=0}_setBase(v){if(v){const y=v.indexOf("#");y>=0&&(v=v.substr(0,y)),this._base=v,this._basePath=v.indexOf("/")<0?v:v.replace(/[^\/?]*(?:\?.*)?$/,""),v=v.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=v[0],this._baseScheme=v[1]}else this._base="",this._basePath=""}_saveContext(v,y,w,D,V){const I=this._n3Mode;this._contextStack.push({subject:w,predicate:D,object:V,graph:y,type:v,inverse:!!I&&this._inversePredicate,blankPrefix:I?this._prefixes._:"",quantified:I?this._quantified:null}),I&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const v=this._contextStack.pop(),y=this._n3Mode;this._subject=v.subject,this._predicate=v.predicate,this._object=v.object,this._graph=v.graph,y&&(this._inversePredicate=v.inverse,this._prefixes._=v.blankPrefix,this._quantified=v.quantified)}_readInTopContext(v){switch(v.type){case"eof":return null!==this._graph?this._error("Unclosed graph",v):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(v)}}_readEntity(v,y){let w;switch(v.type){case"IRI":case"typeIRI":const D=this._resolveIRI(v.value);if(null===D)return this._error("Invalid IRI",v);w=this._namedNode(D);break;case"type":case"prefixed":const V=this._prefixes[v.prefix];if(void 0===V)return this._error(`Undefined prefix "${v.prefix}:"`,v);w=this._namedNode(V+v.value);break;case"blank":w=this._blankNode(this._prefixes[v.prefix]+v.value);break;case"var":w=this._variable(v.value.substr(1));break;default:return this._error(`Expected entity but got ${v.type}`,v)}return!y&&this._n3Mode&&w.id in this._quantified&&(w=this._quantified[w.id]),w}_readSubject(v){switch(this._predicate=null,v.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",v);case"}":return this._readPunctuation(v);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',v);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',v);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",v);if(0===v.prefix.length)return this._literalValue=v.value,this._completeSubjectLiteral;this._subject=this._literal(v.value,this._namedNode(v.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._subject=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(v){const y=v.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[v.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,v):(this._subject=null,"]"===y?this._readBlankNodeTail(v):this._readPunctuation(v));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",v);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",v);default:if(void 0===(this._predicate=this._readEntity(v)))return}return this._readObject}_readObject(v){switch(v.type){case"literal":if(0===v.prefix.length)return this._literalValue=v.value,this._readDataTypeOrLang;this._object=this._literal(v.value,this._namedNode(v.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._object=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(v){return"{"===v.type?this._readGraph(v):this._readPredicate(v)}_readGraph(v){return"{"!==v.type?this._error(`Expected graph but got ${v.type}`,v):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(v){return"]"===v.type?(this._subject=null,this._readBlankNodeTail(v)):(this._predicate=null,this._readPredicate(v))}_readBlankNodeTail(v){if("]"!==v.type)return this._readBlankNodePunctuation(v);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null===this._object?y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()}_readPredicateAfterBlank(v){switch(v.type){case".":case"}":return this._subject=null,this._readPunctuation(v);default:return this._readPredicate(v)}}_readListItem(v){let y=null,w=null,D=this._readListItem;const V=this._subject,I=this._contextStack,H=I[I.length-1];switch(v.type){case"[":this._saveContext("blank",this._graph,w=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),D=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,w=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==I.length&&"list"===I[I.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(D=this._readPredicate,this._subject===this.RDF_NIL)return D}else if(D=this._getContextEndReader(),this._object===this.RDF_NIL)return D;w=this.RDF_NIL;break;case"literal":0===v.prefix.length?(this._literalValue=v.value,D=this._readListItemDataTypeOrLang):(y=this._literal(v.value,this._namedNode(v.prefix)),D=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);default:if(void 0===(y=this._readEntity(v)))return}if(null===w&&(this._subject=w=this._blankNode()),null===V?null===H.predicate?H.subject=w:H.object=w:this._emit(V,this.RDF_REST,w,this._graph),null!==y){if(this._n3Mode&&("IRI"===v.type||"prefixed"===v.type))return this._saveContext("item",this._graph,w,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(w,this.RDF_FIRST,y,this._graph)}return D}_readDataTypeOrLang(v){return this._completeObjectLiteral(v,!1)}_readListItemDataTypeOrLang(v){return this._completeObjectLiteral(v,!0)}_completeLiteral(v){let y=this._literal(this._literalValue);switch(v.type){case"type":case"typeIRI":const w=this._readEntity(v);if(void 0===w)return;y=this._literal(this._literalValue,w),v=null;break;case"langcode":y=this._literal(this._literalValue,v.value),v=null}return{token:v,literal:y}}_completeSubjectLiteral(v){return this._subject=this._completeLiteral(v).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(v,y){const w=this._completeLiteral(v);if(w)return this._object=w.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===w.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(w.token))}_readFormulaTail(v){return"}"!==v.type?this._readPunctuation(v):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(v){let y,w=this._graph;const D=this._subject,V=this._inversePredicate;switch(v.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",v);if(this._n3Mode)return this._readFormulaTail(v);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,V&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(w=this._readEntity(v))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}if(null!==D){const I=this._predicate,H=this._object;V?this._emit(H,I,D,w):this._emit(D,I,H,w)}return y}_readBlankNodePunctuation(v){let y;switch(v.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(v){return"."!==v.type?this._error("Expected dot to follow quad",v):this._readInTopContext}_readPrefix(v){return"prefix"!==v.type?this._error("Expected prefix to follow @prefix",v):(this._prefix=v.value,this._readPrefixIRI)}_readPrefixIRI(v){if("IRI"!==v.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,v);const y=this._readEntity(v);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(v){const y="IRI"===v.type&&this._resolveIRI(v.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",v)}_readNamedGraphLabel(v){switch(v.type){case"IRI":case"blank":case"prefixed":return this._readSubject(v),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",v)}}_readNamedGraphBlankLabel(v){return"]"!==v.type?this._error("Invalid graph label",v):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(v){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(v)):"."!==v.type?this._error("Expected declaration to end with a dot",v):this._readInTopContext}_readQuantifierList(v){let y;switch(v.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(v,!0)))break;default:return this._error(`Unexpected ${v.type}`,v)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(v){return","===v.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(v))}_getPathReader(v){return this._afterPath=v,this._readPath}_readPath(v){switch(v.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,w=y.length&&y[y.length-1];if(w&&"item"===w.type){const D=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,D,this._graph)}return this._afterPath(v)}}_readForwardPath(v){let y,w;const D=this._blankNode();if(void 0!==(w=this._readEntity(v)))return null===this._predicate?(y=this._subject,this._subject=D):(y=this._object,this._object=D),this._emit(y,w,D,this._graph),this._readPath}_readBackwardPath(v){const y=this._blankNode();let w,D;if(void 0!==(w=this._readEntity(v)))return null===this._predicate?(D=this._subject,this._subject=y):(D=this._object,this._object=y),this._emit(y,w,D,this._graph),this._readPath}_readRDFStarTailOrGraph(v){return">>"!==v.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(v))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,v):this._readRDFStarTail(v)}_readRDFStarTail(v){if(">>"!==v.type)return this._error(`Expected >> but got ${v.type}`,v);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const v=this._contextStack;if(!v.length)return this._readPunctuation;switch(v[v.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(v,y,w,D){this._callback(null,this._quad(v,y,w,D||this.DEFAULTGRAPH))}_error(v,y){const w=new Error(`${v} on line ${y.line}.`);w.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(w),this._callback=S}_resolveIRI(v){return/^[a-z][a-z0-9+.-]*:/i.test(v)?v:this._resolveRelativeIRI(v)}_resolveRelativeIRI(v){if(!v.length)return this._base;switch(v[0]){case"#":return this._base+v;case"?":return this._base.replace(/(?:\?.*)?$/,v);case"/":return("/"===v[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(v);default:return/^[^/:]*:/.test(v)?null:this._removeDotSegments(this._basePath+v)}}_removeDotSegments(v){if(!/(^|\/)\.\.?($|[/#?])/.test(v))return v;const y=v.length;let w="",D=-1,V=-1,I=0,H="/";for(;D<y;){switch(H){case":":if(V<0&&"/"===v[++D]&&"/"===v[++D])for(;(V=D+1)<y&&"/"!==v[V];)D=V;break;case"?":case"#":D=y;break;case"/":if("."===v[D+1])switch(H=v[1+ ++D],H){case"/":w+=v.substring(I,D-1),I=D+1;break;case void 0:case"?":case"#":return w+v.substring(I,D)+v.substr(D+1);case".":if(H=v[1+ ++D],void 0===H||"/"===H||"?"===H||"#"===H){if(w+=v.substring(I,D-2),(I=w.lastIndexOf("/"))>=V&&(w=w.substr(0,I)),"/"!==H)return`${w}/${v.substr(D+1)}`;I=D+1}}}H=v[++D]}return w+v.substring(I)}parse(v,y,w){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${$++}_`,this._prefixCallback=w||S,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const D=[];let V;if(this._callback=(I,H)=>{I?V=I:H&&D.push(H)},this._lexer.tokenize(v).every(I=>this._readCallback=this._readCallback(I)),V)throw V;return D}this._callback=y,this._lexer.tokenize(v,(D,V)=>{null!==D?(this._callback(D),this._callback=S):this._readCallback&&(this._readCallback=this._readCallback(V))})}}function S(){}function R(A,v){const y=v.namedNode;A._namedNode=y,A._blankNode=v.blankNode,A._literal=v.literal,A._variable=v.variable,A._quad=v.quad,A.DEFAULTGRAPH=v.defaultGraph(),A.RDF_FIRST=y(L.default.rdf.first),A.RDF_REST=y(L.default.rdf.rest),A.RDF_NIL=y(L.default.rdf.nil),A.N3_FORALL=y(L.default.r.forAll),A.N3_FORSOME=y(L.default.r.forSome),A.ABBREVIATIONS={a:y(L.default.rdf.type),"=":y(L.default.owl.sameAs),">":y(L.default.log.implies)},A.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}he.default=b,R(b.prototype,j.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var v,W=function(v,y){if(!y&&v&&v.__esModule)return v;if(null===v||"object"!=typeof v&&"function"!=typeof v)return{default:v};var w=$(y);if(w&&w.has(v))return w.get(v);var D={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var I in v)if("default"!==I&&Object.prototype.hasOwnProperty.call(v,I)){var H=V?Object.getOwnPropertyDescriptor(v,I):null;H&&(H.get||H.set)?Object.defineProperty(D,I,H):D[I]=v[I]}return D.default=v,w&&w.set(v,D),D}(Y("./N3DataFactory")),j=Y("readable-stream"),L=(v=Y("./IRIs"))&&v.__esModule?v:{default:v};function $(v){if("function"!=typeof WeakMap)return null;var y=new WeakMap,w=new WeakMap;return($=function(D){return D?w:y})(v)}class S{constructor(y,w){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!w&&y&&!y[0]&&(w=y,y=null),this._factory=(w=w||{}).factory||W.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const w=this._graphs;let D,V;for(const I in w)for(const H in D=w[I].subjects)for(const K in V=D[H])y+=Object.keys(V[K]).length;return this._size=y}_addToIndex(y,w,D,V){const I=y[w]||(y[w]={}),H=I[D]||(I[D]={}),K=V in H;return K||(H[V]=null),!K}_removeFromIndex(y,w,D,V){const I=y[w],H=I[D];delete H[V];for(const K in H)return;delete I[D];for(const K in I)return;delete y[w]}_findInIndex(y,w,D,V,I,H,K,M,F,Q){let E,U,ie;const ee=!w+!D+!V>1?Object.keys(this._ids):this._entities;w&&((E=y,y={})[w]=E[w]);for(const se in y){const Te=ee[se];if(U=y[se]){D&&((E=U,U={})[D]=E[D]);for(const ve in U){const te=ee[ve];if(ie=U[ve]){const _e=V?V in ie?[V]:[]:Object.keys(ie);for(let Me=0;Me<_e.length;Me++){const je={subject:null,predicate:null,object:null};je[I]=(0,W.termFromId)(Te,this._factory),je[H]=(0,W.termFromId)(te,this._factory),je[K]=(0,W.termFromId)(ee[_e[Me]],this._factory);const nt=this._factory.quad(je.subject,je.predicate,je.object,(0,W.termFromId)(M,this._factory));if(Q)Q.push(nt);else if(F(nt))return!0}}}}}return Q}_loop(y,w){for(const D in y)w(D)}_loopByKey0(y,w,D){let V,I;if(V=y[w])for(I in V)D(I)}_loopByKey1(y,w,D){let V,I;for(V in y)I=y[V],I[w]&&D(V)}_loopBy2Keys(y,w,D,V){let I,H,K;if((I=y[w])&&(H=I[D]))for(K in H)V(K)}_countInIndex(y,w,D,V){let H,K,M,I=0;w&&((H=y,y={})[w]=H[w]);for(const F in y)if(K=y[F]){D&&((H=K,K={})[D]=H[D]);for(const Q in K)(M=K[Q])&&(V?V in M&&I++:I+=Object.keys(M).length)}return I}_getGraphs(y){if(!R(y))return this._graphs;const w={};return w[y]=this._graphs[y],w}_uniqueEntities(y){const w=Object.create(null);return D=>{D in w||(w[D]=!0,y((0,W.termFromId)(this._entities[D],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,w,D,V){w||(V=y.graph,D=y.object,w=y.predicate,y=y.subject),y=(0,W.termToId)(y),w=(0,W.termToId)(w),D=(0,W.termToId)(D),V=(0,W.termToId)(V);let I=this._graphs[V];I||(I=this._graphs[V]={subjects:{},predicates:{},objects:{}},Object.freeze(I));const H=this._ids,K=this._entities;y=H[y]||(H[K[++this._id]=y]=this._id),w=H[w]||(H[K[++this._id]=w]=this._id),D=H[D]||(H[K[++this._id]=D]=this._id);const M=this._addToIndex(I.subjects,y,w,D);return this._addToIndex(I.predicates,w,D,y),this._addToIndex(I.objects,D,y,w),this._size=null,M}addQuads(y){for(let w=0;w<y.length;w++)this.addQuad(y[w])}delete(y){return this.removeQuad(y),this}has(y){return 0!==this.getQuads(y.subject,y.predicate,y.object,y.graph).length}import(y){return y.on("data",w=>{this.addQuad(w)}),y}removeQuad(y,w,D,V){w||(V=y.graph,D=y.object,w=y.predicate,y=y.subject),y=(0,W.termToId)(y),w=(0,W.termToId)(w),D=(0,W.termToId)(D),V=(0,W.termToId)(V);const I=this._ids,H=this._graphs;let K,M,F;if(!((y=I[y])&&(w=I[w])&&(D=I[D])&&(K=H[V])&&(M=K.subjects[y])&&(F=M[w])&&D in F))return!1;for(y in this._removeFromIndex(K.subjects,y,w,D),this._removeFromIndex(K.predicates,w,D,y),this._removeFromIndex(K.objects,D,y,w),null!==this._size&&this._size--,K.subjects)return!0;return delete H[V],!0}removeQuads(y){for(let w=0;w<y.length;w++)this.removeQuad(y[w])}remove(y){return y.on("data",w=>{this.removeQuad(w)}),y}removeMatches(y,w,D,V){const I=new j.Readable({objectMode:!0});return I._read=()=>{for(const H of this.getQuads(y,w,D,V))I.push(H);I.push(null)},this.remove(I)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,w,D,V){y=y&&(0,W.termToId)(y),w=w&&(0,W.termToId)(w),D=D&&(0,W.termToId)(D),V=V&&(0,W.termToId)(V);const I=[],H=this._getGraphs(V),K=this._ids;let M,F,Q,E;if(R(y)&&!(F=K[y])||R(w)&&!(Q=K[w])||R(D)&&!(E=K[D]))return I;for(const U in H)(M=H[U])&&(F?E?this._findInIndex(M.objects,E,F,Q,"object","subject","predicate",U,null,I):this._findInIndex(M.subjects,F,Q,null,"subject","predicate","object",U,null,I):Q?this._findInIndex(M.predicates,Q,E,null,"predicate","object","subject",U,null,I):E?this._findInIndex(M.objects,E,null,null,"object","subject","predicate",U,null,I):this._findInIndex(M.subjects,null,null,null,"subject","predicate","object",U,null,I));return I}match(y,w,D,V){return new A(this,y,w,D,V)}countQuads(y,w,D,V){y=y&&(0,W.termToId)(y),w=w&&(0,W.termToId)(w),D=D&&(0,W.termToId)(D),V=V&&(0,W.termToId)(V);const I=this._getGraphs(V),H=this._ids;let M,F,Q,E,K=0;if(R(y)&&!(F=H[y])||R(w)&&!(Q=H[w])||R(D)&&!(E=H[D]))return 0;for(const U in I)(M=I[U])&&(K+=y?D?this._countInIndex(M.objects,E,F,Q):this._countInIndex(M.subjects,F,Q,E):w?this._countInIndex(M.predicates,Q,E,F):this._countInIndex(M.objects,E,F,Q));return K}forEach(y,w,D,V,I){this.some(H=>(y(H),!1),w,D,V,I)}every(y,w,D,V,I){let H=!1;const K=!this.some(M=>(H=!0,!y(M)),w,D,V,I);return H&&K}some(y,w,D,V,I){w=w&&(0,W.termToId)(w),D=D&&(0,W.termToId)(D),V=V&&(0,W.termToId)(V),I=I&&(0,W.termToId)(I);const H=this._getGraphs(I),K=this._ids;let M,F,Q,E;if(R(w)&&!(F=K[w])||R(D)&&!(Q=K[D])||R(V)&&!(E=K[V]))return!1;for(const U in H)if(M=H[U])if(F){if(E){if(this._findInIndex(M.objects,E,F,Q,"object","subject","predicate",U,y,null))return!0}else if(this._findInIndex(M.subjects,F,Q,null,"subject","predicate","object",U,y,null))return!0}else if(Q){if(this._findInIndex(M.predicates,Q,E,null,"predicate","object","subject",U,y,null))return!0}else if(E){if(this._findInIndex(M.objects,E,null,null,"object","subject","predicate",U,y,null))return!0}else if(this._findInIndex(M.subjects,null,null,null,"subject","predicate","object",U,y,null))return!0;return!1}getSubjects(y,w,D){const V=[];return this.forSubjects(I=>{V.push(I)},y,w,D),V}forSubjects(y,w,D,V){w=w&&(0,W.termToId)(w),D=D&&(0,W.termToId)(D),V=V&&(0,W.termToId)(V);const I=this._ids,H=this._getGraphs(V);let K,M,F;if(y=this._uniqueEntities(y),!(R(w)&&!(M=I[w])||R(D)&&!(F=I[D])))for(V in H)(K=H[V])&&(M?F?this._loopBy2Keys(K.predicates,M,F,y):this._loopByKey1(K.subjects,M,y):F?this._loopByKey0(K.objects,F,y):this._loop(K.subjects,y))}getPredicates(y,w,D){const V=[];return this.forPredicates(I=>{V.push(I)},y,w,D),V}forPredicates(y,w,D,V){w=w&&(0,W.termToId)(w),D=D&&(0,W.termToId)(D),V=V&&(0,W.termToId)(V);const I=this._ids,H=this._getGraphs(V);let K,M,F;if(y=this._uniqueEntities(y),!(R(w)&&!(M=I[w])||R(D)&&!(F=I[D])))for(V in H)(K=H[V])&&(M?F?this._loopBy2Keys(K.objects,F,M,y):this._loopByKey0(K.subjects,M,y):F?this._loopByKey1(K.predicates,F,y):this._loop(K.predicates,y))}getObjects(y,w,D){const V=[];return this.forObjects(I=>{V.push(I)},y,w,D),V}forObjects(y,w,D,V){w=w&&(0,W.termToId)(w),D=D&&(0,W.termToId)(D),V=V&&(0,W.termToId)(V);const I=this._ids,H=this._getGraphs(V);let K,M,F;if(y=this._uniqueEntities(y),!(R(w)&&!(M=I[w])||R(D)&&!(F=I[D])))for(V in H)(K=H[V])&&(M?F?this._loopBy2Keys(K.subjects,M,F,y):this._loopByKey1(K.objects,M,y):F?this._loopByKey0(K.predicates,F,y):this._loop(K.objects,y))}getGraphs(y,w,D){const V=[];return this.forGraphs(I=>{V.push(I)},y,w,D),V}forGraphs(y,w,D,V){for(const I in this._graphs)this.some(H=>(y(H.graph),!0),w,D,V,I)}createBlankNode(y){let w,D;if(y)for(w=y=`_:${y}`,D=1;this._ids[w];)w=y+D++;else do{w="_:b"+this._blankNodeIndex++}while(this._ids[w]);return this._ids[w]=++this._id,this._entities[this._id]=w,this._factory.blankNode(w.substr(2))}extractLists({remove:y=!1,ignoreErrors:w=!1}={}){const D={},V=w?()=>!0:(K,M)=>{throw new Error(`${K.value} ${M}`)},I=this.getQuads(null,L.default.rdf.rest,L.default.rdf.nil,null),H=y?[...I]:[];return I.forEach(K=>{const M=[];let Q,E,F=!1;const U=K.graph;let ie=K.subject;for(;ie&&!F;){const ue=this.getQuads(null,null,ie,null),ee=this.getQuads(ie,null,null,null);let se,Te=null,ve=null,te=null;for(let _e=0;_e<ee.length&&!F;_e++)se=ee[_e],se.graph.equals(U)?Q?F=V(ie,"has non-list arcs out"):se.predicate.value===L.default.rdf.first?Te?F=V(ie,"has multiple rdf:first arcs"):H.push(Te=se):se.predicate.value===L.default.rdf.rest?ve?F=V(ie,"has multiple rdf:rest arcs"):H.push(ve=se):ue.length?F=V(ie,"can't be subject and object"):(Q=se,E="subject"):F=V(ie,"not confined to single graph");for(let _e=0;_e<ue.length&&!F;++_e)se=ue[_e],Q?F=V(ie,"can't have coreferences"):se.predicate.value===L.default.rdf.rest?te?F=V(ie,"has incoming rdf:rest arcs"):te=se:(Q=se,E="object");Te?M.unshift(Te.object):F=V(ie,"has no list head"),ie=te&&te.subject}F?y=!1:Q&&(D[Q[E].value]=M)}),y&&this.removeQuads(H),D}*[Symbol.iterator](){yield*this.getQuads()}}function R(v){return"string"==typeof v||v instanceof String}he.default=S;class A extends j.Readable{constructor(y,w,D,V,I){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:w,predicate:D,object:V,graph:I})}get filtered(){if(!this._filtered){const{n3Store:y,graph:w,object:D,predicate:V,subject:I}=this,H=y.getQuads(I,V,D,w);this._filtered=new S(H,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this.filtered.getQuads())this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,w,D,V){return new A(this.filtered,y,w,D,V)}*[Symbol.iterator](){yield*this.filtered.getQuads()}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var $,W=($=Y("./N3Parser"))&&$.__esModule?$:{default:$},j=Y("readable-stream");he.default=class extends j.Transform{constructor(b){let R,A;super({decodeStrings:!0}),this._readableState.objectMode=!0,new W.default(b).parse({on:(v,y)=>{switch(v){case"data":R=y;break;case"end":A=y}}},(v,y)=>{v&&this.emit("error",v)||y&&this.push(y)},(v,y)=>{this.emit("prefix",v,y)}),this._transform=(v,y,w)=>{R(v),w()},this._flush=v=>{A(),v()}}import(b){return b.on("data",S=>{this.write(S)}),b.on("end",()=>{this.end()}),b.on("error",S=>{this.emit("error",S)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var $,W=Y("readable-stream"),j=($=Y("./N3Writer"))&&$.__esModule?$:{default:$};he.default=class extends W.Transform{constructor(b){super({encoding:"utf8",writableObjectMode:!0});const S=this._writer=new j.default({write:(R,A,v)=>{this.push(R),v&&v()},end:R=>{this.push(null),R&&R()}},b);this._transform=(R,A,v)=>{S.addQuad(R,v)},this._flush=R=>{S.end(R)}}import(b){return b.on("data",S=>{this.write(S)}),b.on("end",()=>{this.end()}),b.on("error",S=>{this.emit("error",S)}),b.on("prefix",(S,R)=>{this._writer.addPrefix(S,R)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},he.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},he.isLiteral=function(y){return!!y&&"Literal"===y.termType},he.isVariable=function(y){return!!y&&"Variable"===y.termType},he.isDefaultGraph=S,he.inDefaultGraph=function(y){return S(y.graph)},he.prefix=function(y,w){return v({"":y},w)("")},he.prefixes=v;var y,W=(y=Y("./N3DataFactory"))&&y.__esModule?y:{default:y};function S(y){return!!y&&"DefaultGraph"===y.termType}function v(y,w){const D=Object.create(null);for(const I in y)V(I,y[I]);function V(I,H){if("string"==typeof H){const K=Object.create(null);D[I]=M=>K[M]||(K[M]=w.namedNode(H+M))}else if(!(I in D))throw new Error(`Unknown prefix: ${I}`);return D[I]}return w=w||W.default,V}},{"./N3DataFactory":35}],42:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.default=void 0;var H,W=(H=Y("./IRIs"))&&H.__esModule?H:{default:H},j=function(H,K){if(!K&&H&&H.__esModule)return H;if(null===H||"object"!=typeof H&&"function"!=typeof H)return{default:H};var M=re(K);if(M&&M.has(H))return M.get(H);var F={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in H)if("default"!==E&&Object.prototype.hasOwnProperty.call(H,E)){var U=Q?Object.getOwnPropertyDescriptor(H,E):null;U&&(U.get||U.set)?Object.defineProperty(F,E,U):F[E]=H[E]}return F.default=H,M&&M.set(H,F),F}(Y("./N3DataFactory")),L=Y("./N3Util");function re(H){if("function"!=typeof WeakMap)return null;var K=new WeakMap,M=new WeakMap;return(re=function(F){return F?M:K})(H)}const S=j.default.defaultGraph(),{rdf:R,xsd:A}=W.default,v=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,w={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class D extends j.Term{equals(){return!1}}function I(H){let K=w[H];return void 0===K&&(1===H.length?(K=H.charCodeAt(0).toString(16),K="\\u0000".substr(0,6-K.length)+K):(K=(1024*(H.charCodeAt(0)-55296)+H.charCodeAt(1)+9216).toString(16),K="\\U00000000".substr(0,10-K.length)+K)),K}he.default=class{constructor(K,M){if(this._prefixRegex=/$0^/,K&&"function"!=typeof K.write&&(M=K,K=null),this._lists=(M=M||{}).lists,K)this._outputStream=K,this._endStream=void 0===M.end||!!M.end;else{let F="";this._outputStream={write(Q,E,U){F+=Q,U&&U()},end:Q=>{Q&&Q(null,F)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(M.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=S,this._baseIRI=M.baseIRI,this._prefixIRIs=Object.create(null),M.prefixes&&this.addPrefixes(M.prefixes))}get _inDefaultGraph(){return S.equals(this._graph)}_write(K,M){this._outputStream.write(K,"utf8",M)}_writeQuad(K,M,F,Q,E){try{Q.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(S.equals(Q)?"":`${this._encodeIriOrBlank(Q)} {\n`)),this._graph=Q,this._subject=null),K.equals(this._subject)?M.equals(this._predicate)?this._write(`, ${this._encodeObject(F)}`,E):this._write(`;\n    ${this._encodePredicate(this._predicate=M)} ${this._encodeObject(F)}`,E):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=K)} ${this._encodePredicate(this._predicate=M)} ${this._encodeObject(F)}`,E)}catch(U){E&&E(U)}}_writeQuadLine(K,M,F,Q,E){delete this._prefixMatch,this._write(this.quadToString(K,M,F,Q),E)}quadToString(K,M,F,Q){return`${this._encodeSubject(K)} ${this._encodeIriOrBlank(M)} ${this._encodeObject(F)}${Q&&Q.value?` ${this._encodeIriOrBlank(Q)} .\n`:" .\n"}`}quadsToString(K){return K.map(M=>this.quadToString(M.subject,M.predicate,M.object,M.graph)).join("")}_encodeSubject(K){return"Quad"===K.termType?this._encodeQuad(K):this._encodeIriOrBlank(K)}_encodeIriOrBlank(K){if("NamedNode"!==K.termType)return this._lists&&K.value in this._lists&&(K=this.list(this._lists[K.value])),"id"in K?K.id:`_:${K.value}`;let M=K.value;this._baseIRI&&M.startsWith(this._baseIRI)&&(M=M.substr(this._baseIRI.length)),v.test(M)&&(M=M.replace(y,I));const F=this._prefixRegex.exec(M);return F?F[1]?this._prefixIRIs[F[1]]+F[2]:M:`<${M}>`}_encodeLiteral(K){let M=K.value;if(v.test(M)&&(M=M.replace(y,I)),K.language)return`"${M}"@${K.language}`;if(this._lineMode){if(K.datatype.value===A.string)return`"${M}"`}else switch(K.datatype.value){case A.string:return`"${M}"`;case A.boolean:if("true"===M||"false"===M)return M;break;case A.integer:if(/^[+-]?\d+$/.test(M))return M;break;case A.decimal:if(/^[+-]?\d*\.\d+$/.test(M))return M;break;case A.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(M))return M}return`"${M}"^^${this._encodeIriOrBlank(K.datatype)}`}_encodePredicate(K){return K.value===R.type?"a":this._encodeIriOrBlank(K)}_encodeObject(K){switch(K.termType){case"Quad":return this._encodeQuad(K);case"Literal":return this._encodeLiteral(K);default:return this._encodeIriOrBlank(K)}}_encodeQuad({subject:K,predicate:M,object:F,graph:Q}){return`<<${this._encodeSubject(K)} ${this._encodePredicate(M)} ${this._encodeObject(F)}${(0,L.isDefaultGraph)(Q)?"":` ${this._encodeIriOrBlank(Q)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(K,M,F,Q,E){void 0===F?this._writeQuad(K.subject,K.predicate,K.object,K.graph,M):"function"==typeof Q?this._writeQuad(K,M,F,S,Q):this._writeQuad(K,M,F,Q||S,E)}addQuads(K){for(let M=0;M<K.length;M++)this.addQuad(K[M])}addPrefix(K,M,F){const Q={};Q[K]=M,this.addPrefixes(Q,F)}addPrefixes(K,M){if(!this._prefixIRIs)return M&&M();let F=!1;for(let Q in K){let E=K[Q];"string"!=typeof E&&(E=E.value),F=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[E]=Q+=":",this._write(`@prefix ${Q} <${E}>.\n`)}if(F){let Q="",E="";for(const U in this._prefixIRIs)Q+=Q?`|${U}`:U,E+=(E?"|":"")+this._prefixIRIs[U];Q=Q.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp(`^(?:${E})[^/]*$|^(${Q})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(F?"\n":"",M)}blank(K,M){let Q,E,F=K;switch(void 0===K?F=[]:K.termType?F=[{predicate:K,object:M}]:"length"in K||(F=[K]),E=F.length){case 0:return new D("[]");case 1:if(Q=F[0],!(Q.object instanceof D))return new D(`[ ${this._encodePredicate(Q.predicate)} ${this._encodeObject(Q.object)} ]`);default:let U="[";for(let ie=0;ie<E;ie++)Q=F[ie],Q.predicate.equals(K)?U+=`, ${this._encodeObject(Q.object)}`:(U+=`${(ie?";\n  ":"\n  ")+this._encodePredicate(Q.predicate)} ${this._encodeObject(Q.object)}`,K=Q.predicate);return new D(`${U}\n]`)}}list(K){const M=K&&K.length||0,F=new Array(M);for(let Q=0;Q<M;Q++)F[Q]=this._encodeObject(K[Q]);return new D(`(${F.join(" ")})`)}end(K){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let M=K&&((F,Q)=>{M=null,K(F,Q)});if(this._endStream)try{return this._outputStream.end(M)}catch(F){}M&&M()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),Object.defineProperty(he,"Lexer",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(he,"Parser",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(he,"Writer",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(he,"Store",{enumerable:!0,get:function(){return re.default}}),Object.defineProperty(he,"StreamParser",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(he,"StreamWriter",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(he,"DataFactory",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(he,"Term",{enumerable:!0,get:function(){return R.Term}}),Object.defineProperty(he,"NamedNode",{enumerable:!0,get:function(){return R.NamedNode}}),Object.defineProperty(he,"Literal",{enumerable:!0,get:function(){return R.Literal}}),Object.defineProperty(he,"BlankNode",{enumerable:!0,get:function(){return R.BlankNode}}),Object.defineProperty(he,"Variable",{enumerable:!0,get:function(){return R.Variable}}),Object.defineProperty(he,"DefaultGraph",{enumerable:!0,get:function(){return R.DefaultGraph}}),Object.defineProperty(he,"Quad",{enumerable:!0,get:function(){return R.Quad}}),Object.defineProperty(he,"Triple",{enumerable:!0,get:function(){return R.Triple}}),Object.defineProperty(he,"termFromId",{enumerable:!0,get:function(){return R.termFromId}}),Object.defineProperty(he,"termToId",{enumerable:!0,get:function(){return R.termToId}}),he.Util=void 0;var W=y(Y("./N3Lexer")),j=y(Y("./N3Parser")),L=y(Y("./N3Writer")),re=y(Y("./N3Store")),$=y(Y("./N3StreamParser")),b=y(Y("./N3StreamWriter")),S=v(Y("./N3Util"));he.Util=S;var R=v(Y("./N3DataFactory"));function A(w){if("function"!=typeof WeakMap)return null;var D=new WeakMap,V=new WeakMap;return(A=function(I){return I?V:D})(w)}function v(w,D){if(!D&&w&&w.__esModule)return w;if(null===w||"object"!=typeof w&&"function"!=typeof w)return{default:w};var V=A(D);if(V&&V.has(w))return V.get(w);var I={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in w)if("default"!==K&&Object.prototype.hasOwnProperty.call(w,K)){var M=H?Object.getOwnPropertyDescriptor(w,K):null;M&&(M.get||M.set)?Object.defineProperty(I,K,M):I[K]=w[K]}return I.default=w,V&&V.set(w,I),I}function y(w){return w&&w.__esModule?w:{default:w}}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(Y,Ae,he){var j,L,W=Ae.exports={};function re(){throw new Error("setTimeout has not been defined")}function $(){throw new Error("clearTimeout has not been defined")}function b(H){if(j===setTimeout)return setTimeout(H,0);if((j===re||!j)&&setTimeout)return j=setTimeout,setTimeout(H,0);try{return j(H,0)}catch(K){try{return j.call(null,H,0)}catch(M){return j.call(this,H,0)}}}!function(){try{j="function"==typeof setTimeout?setTimeout:re}catch(H){j=re}try{L="function"==typeof clearTimeout?clearTimeout:$}catch(H){L=$}}();var v,R=[],A=!1,y=-1;function w(){!A||!v||(A=!1,v.length?R=v.concat(R):y=-1,R.length&&D())}function D(){if(!A){var H=b(w);A=!0;for(var K=R.length;K;){for(v=R,R=[];++y<K;)v&&v[y].run();y=-1,K=R.length}v=null,A=!1,function(H){if(L===clearTimeout)return clearTimeout(H);if((L===$||!L)&&clearTimeout)return L=clearTimeout,clearTimeout(H);try{L(H)}catch(K){try{return L.call(null,H)}catch(M){return L.call(this,H)}}}(H)}}function V(H,K){this.fun=H,this.array=K}function I(){}W.nextTick=function(H){var K=new Array(arguments.length-1);if(arguments.length>1)for(var M=1;M<arguments.length;M++)K[M-1]=arguments[M];R.push(new V(H,K)),1===R.length&&!A&&b(D)},V.prototype.run=function(){this.fun.apply(null,this.array)},W.title="browser",W.browser=!0,W.env={},W.argv=[],W.version="",W.versions={},W.on=I,W.addListener=I,W.once=I,W.off=I,W.removeListener=I,W.removeAllListeners=I,W.emit=I,W.prependListener=I,W.prependOnceListener=I,W.listeners=function(H){return[]},W.binding=function(H){throw new Error("process.binding is not supported")},W.cwd=function(){return"/"},W.chdir=function(H){throw new Error("process.chdir is not supported")},W.umask=function(){return 0}},{}],45:[function(Y,Ae,he){(function(W){(function(){let j;Ae.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:W):L=>(j||(j=Promise.resolve())).then(L).catch(re=>setTimeout(()=>{throw re},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(Y,Ae,he){Ae.exports=Y("./lib")},{"./lib":55}],47:[function(Y,Ae,he){"use strict";Ae.exports=class aW{constructor(j,L=new Map,re=0){this.prefix=j,this._existing=L,this.counter=re}clone(){const{prefix:j,_existing:L,counter:re}=this;return new aW(j,new Map(L),re)}getId(j){const L=j&&this._existing.get(j);if(L)return L;const re=this.prefix+this.counter;return this.counter++,j&&this._existing.set(j,re),re}hasId(j){return this._existing.has(j)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(Y,Ae,he){"use strict";Y("setimmediate");const W=self.crypto||self.msCrypto;Ae.exports=class{constructor(L){if(!W||!W.subtle)throw new Error("crypto.subtle not found.");if("sha256"===L)this.algorithm={name:"SHA-256"};else{if("sha1"!==L)throw new Error(`Unsupport algorithm "${L}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(L){this._content+=L}digest(){var L=this;return gt(function*(){const re=(new TextEncoder).encode(L._content),$=new Uint8Array(yield W.subtle.digest(L.algorithm,re));let b="";for(let S=0;S<$.length;++S)b+=$[S].toString(16).padStart(2,"0");return b})()}}},{setimmediate:86}],49:[function(Y,Ae,he){"use strict";const L="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",re="http://www.w3.org/2001/XMLSchema#string",$="NamedNode",b="BlankNode",S="Literal",R="DefaultGraph",A={};function v(I,H){return I.subject.termType===H.subject.termType&&I.object.termType===H.object.termType&&I.subject.value===H.subject.value&&I.predicate.value===H.predicate.value&&I.object.value===H.object.value&&(I.object.termType!==S||I.object.datatype.termType===H.object.datatype.termType&&I.object.language===H.object.language&&I.object.datatype.value===H.object.datatype.value)}A.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,A.empty=new RegExp("^[ \\t]*$"),A.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),Ae.exports=class cP{static parse(H){const K=[],M={},F=H.split(A.eoln);let Q=0;for(const E of F){if(Q++,A.empty.test(E))continue;const U=E.match(A.quad);if(null===U)throw new Error("N-Quads parse error on line "+Q+".");const ie={subject:null,predicate:null,object:null,graph:null};if(ie.subject=void 0!==U[1]?{termType:$,value:U[1]}:{termType:b,value:U[2]},ie.predicate={termType:$,value:U[3]},void 0!==U[4]?ie.object={termType:$,value:U[4]}:void 0!==U[5]?ie.object={termType:b,value:U[5]}:(ie.object={termType:S,value:void 0,datatype:{termType:$}},void 0!==U[7]?ie.object.datatype.value=U[7]:void 0!==U[8]?(ie.object.datatype.value=L,ie.object.language=U[8]):ie.object.datatype.value=re,ie.object.value=U[6].replace(D,function(H,K,M,F){if(K)switch(K){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(M)return String.fromCharCode(parseInt(M,16));if(F)throw new Error("Unsupported U escape")})),ie.graph=void 0!==U[9]?{termType:$,value:U[9]}:void 0!==U[10]?{termType:b,value:U[10]}:{termType:R,value:""},ie.graph.value in M){let ue=!0;const ee=M[ie.graph.value];for(const se of ee)if(v(se,ie)){ue=!1;break}ue&&(ee.push(ie),K.push(ie))}else M[ie.graph.value]=[ie],K.push(ie)}return K}static serialize(H){Array.isArray(H)||(H=cP.legacyDatasetToQuads(H));const K=[];for(const M of H)K.push(cP.serializeQuad(M));return K.sort().join("")}static serializeQuad(H){const K=H.subject,F=H.object,Q=H.graph;let E="";return E+=K.termType===$?`<${K.value}>`:`${K.value}`,E+=` <${H.predicate.value}> `,F.termType===$?E+=`<${F.value}>`:F.termType===b?E+=F.value:(E+=`"${I=F.value,I.replace(y,function(H){switch(H){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,F.datatype.value===L?F.language&&(E+=`@${F.language}`):F.datatype.value!==re&&(E+=`^^<${F.datatype.value}>`)),Q.termType===$?E+=` <${Q.value}>`:Q.termType===b&&(E+=` ${Q.value}`),E+=" .\n",E;var I}static legacyDatasetToQuads(H){const K=[],M={"blank node":b,IRI:$,literal:S};for(const F in H)H[F].forEach(E=>{const U={};for(const ie in E){const ue=E[ie],ee={termType:M[ue.type],value:ue.value};ee.termType===S&&(ee.datatype={termType:$},"datatype"in ue&&(ee.datatype.value=ue.datatype),"language"in ue?("datatype"in ue||(ee.datatype.value=L),ee.language=ue.language):"datatype"in ue||(ee.datatype.value=re)),U[ie]=ee}U.graph="@default"===F?{termType:R,value:""}:{termType:F.startsWith("_:")?b:$,value:F},K.push(U)});return K}};const y=/["\\\n\r]/g;const D=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(Y,Ae,he){"use strict";Ae.exports=class{constructor(j){this.current=j.sort(),this.done=!1,this.dir=new Map;for(let L=0;L<j.length;++L)this.dir.set(j[L],!0)}hasNext(){return!this.done}next(){const{current:j,dir:L}=this,re=j.slice();let $=null,b=0;const S=j.length;for(let R=0;R<S;++R){const A=j[R],v=L.get(A);(null===$||A>$)&&(v&&R>0&&A>j[R-1]||!v&&R<S-1&&A>j[R+1])&&($=A,b=R)}if(null===$)this.done=!0;else{const R=L.get($)?b-1:b+1;j[b]=j[R],j[R]=$;for(const A of j)A>$&&L.set(A,!L.get(A))}return re}}},{}],51:[function(Y,Ae,he){(function(W){(function(){"use strict";const j=Y("./IdentifierIssuer"),L=Y("./MessageDigest"),re=Y("./Permuter"),$=Y("./NQuads");function b(S,R){return S.hash<R.hash?-1:S.hash>R.hash?1:0}Ae.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new j("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(R){var A=this;return gt(function*(){A.quads=R;for(const H of R)A._addBlankNodeQuadInfo({quad:H,component:H.subject}),A._addBlankNodeQuadInfo({quad:H,component:H.object}),A._addBlankNodeQuadInfo({quad:H,component:H.graph});const v=new Map,y=[...A.blankNodeInfo.keys()];let w=0;for(const H of y)++w%100==0&&(yield A._yield()),yield A._hashAndTrackBlankNode({id:H,hashToBlankNodes:v});const D=[...v.keys()].sort(),V=[];for(const H of D){const K=v.get(H);K.length>1?V.push(K):A.canonicalIssuer.getId(K[0])}for(const H of V){const K=[];for(const M of H){if(A.canonicalIssuer.hasId(M))continue;const F=new j("_:b");F.getId(M);const Q=yield A.hashNDegreeQuads(M,F);K.push(Q)}K.sort(b);for(const M of K){const F=M.issuer.getOldIds();for(const Q of F)A.canonicalIssuer.getId(Q)}}const I=[];for(const H of A.quads){const K=ht({},H);K.subject=A._useCanonicalId({component:K.subject}),K.object=A._useCanonicalId({component:K.object}),K.graph=A._useCanonicalId({component:K.graph}),I.push($.serializeQuad(K))}return I.sort(),I.join("")})()}hashFirstDegreeQuads(R){var A=this;return gt(function*(){const v=[],y=A.blankNodeInfo.get(R),w=y.quads;for(const V of w){const I={subject:null,predicate:V.predicate,object:null,graph:null};I.subject=A.modifyFirstDegreeComponent(R,V.subject,"subject"),I.object=A.modifyFirstDegreeComponent(R,V.object,"object"),I.graph=A.modifyFirstDegreeComponent(R,V.graph,"graph"),v.push($.serializeQuad(I))}v.sort();const D=new L(A.hashAlgorithm);for(const V of v)D.update(V);return y.hash=yield D.digest(),y.hash})()}hashRelatedBlankNode(R,A,v,y){var w=this;return gt(function*(){let D;D=w.canonicalIssuer.hasId(R)?w.canonicalIssuer.getId(R):v.hasId(R)?v.getId(R):w.blankNodeInfo.get(R).hash;const V=new L(w.hashAlgorithm);return V.update(y),"g"!==y&&V.update(w.getRelatedPredicate(A)),V.update(D),V.digest()})()}hashNDegreeQuads(R,A){var v=this;return gt(function*(){const y=new L(v.hashAlgorithm),w=yield v.createHashToRelated(R,A),D=[...w.keys()].sort();for(const V of D){y.update(V);let H,I="";const K=new re(w.get(V));let M=0;for(;K.hasNext();){const F=K.next();++M%3==0&&(yield v._yield());let Q=A.clone(),E="";const U=[];let ie=!1;for(const ue of F)if(v.canonicalIssuer.hasId(ue)?E+=v.canonicalIssuer.getId(ue):(Q.hasId(ue)||U.push(ue),E+=Q.getId(ue)),0!==I.length&&E>I){ie=!0;break}if(!ie){for(const ue of U){const ee=yield v.hashNDegreeQuads(ue,Q);if(E+=Q.getId(ue),E+=`<${ee.hash}>`,Q=ee.issuer,0!==I.length&&E>I){ie=!0;break}}ie||(0===I.length||E<I)&&(I=E,H=Q)}}y.update(I),A=H}return{hash:yield y.digest(),issuer:A}})()}modifyFirstDegreeComponent(R,A){return"BlankNode"!==A.termType?A:{termType:"BlankNode",value:A.value===R?"_:a":"_:z"}}getRelatedPredicate(R){return`<${R.predicate.value}>`}createHashToRelated(R,A){var v=this;return gt(function*(){const y=new Map,w=v.blankNodeInfo.get(R).quads;let D=0;for(const V of w)++D%100==0&&(yield v._yield()),yield Promise.all([v._addRelatedBlankNodeHash({quad:V,component:V.subject,position:"s",id:R,issuer:A,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:V,component:V.object,position:"o",id:R,issuer:A,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:V,component:V.graph,position:"g",id:R,issuer:A,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:R,hashToBlankNodes:A}){var v=this;return gt(function*(){const y=yield v.hashFirstDegreeQuads(R),w=A.get(y);w?w.push(R):A.set(y,[R])})()}_addBlankNodeQuadInfo({quad:R,component:A}){if("BlankNode"!==A.termType)return;const v=A.value,y=this.blankNodeInfo.get(v);y?y.quads.add(R):this.blankNodeInfo.set(v,{quads:new Set([R]),hash:null})}_addRelatedBlankNodeHash({quad:R,component:A,position:v,id:y,issuer:w,hashToRelated:D}){var V=this;return gt(function*(){if("BlankNode"!==A.termType||A.value===y)return;const I=A.value,H=yield V.hashRelatedBlankNode(I,R,w,v),K=D.get(H);K?K.push(I):D.set(H,[I])})()}_useCanonicalId({component:R}){return"BlankNode"!==R.termType||R.value.startsWith(this.canonicalIssuer.prefix)?R:{termType:"BlankNode",value:this.canonicalIssuer.getId(R.value)}}_yield(){return gt(function*(){return new Promise(R=>W(R))})()}}}).call(this)}).call(this,Y("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(Y,Ae,he){"use strict";const W=Y("./IdentifierIssuer"),j=Y("./MessageDigest"),L=Y("./Permuter"),re=Y("./NQuads");function $(b,S){return b.hash<S.hash?-1:b.hash>S.hash?1:0}Ae.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new W("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(S){this.quads=S;for(const D of S)this._addBlankNodeQuadInfo({quad:D,component:D.subject}),this._addBlankNodeQuadInfo({quad:D,component:D.object}),this._addBlankNodeQuadInfo({quad:D,component:D.graph});const R=new Map,A=[...this.blankNodeInfo.keys()];for(const D of A)this._hashAndTrackBlankNode({id:D,hashToBlankNodes:R});const v=[...R.keys()].sort(),y=[];for(const D of v){const V=R.get(D);V.length>1?y.push(V):this.canonicalIssuer.getId(V[0])}for(const D of y){const V=[];for(const I of D){if(this.canonicalIssuer.hasId(I))continue;const H=new W("_:b");H.getId(I);const K=this.hashNDegreeQuads(I,H);V.push(K)}V.sort($);for(const I of V){const H=I.issuer.getOldIds();for(const K of H)this.canonicalIssuer.getId(K)}}const w=[];for(const D of this.quads){const V=ht({},D);V.subject=this._useCanonicalId({component:V.subject}),V.object=this._useCanonicalId({component:V.object}),V.graph=this._useCanonicalId({component:V.graph}),w.push(re.serializeQuad(V))}return w.sort(),w.join("")}hashFirstDegreeQuads(S){const R=[],A=this.blankNodeInfo.get(S),v=A.quads;for(const w of v){const D={subject:null,predicate:w.predicate,object:null,graph:null};D.subject=this.modifyFirstDegreeComponent(S,w.subject,"subject"),D.object=this.modifyFirstDegreeComponent(S,w.object,"object"),D.graph=this.modifyFirstDegreeComponent(S,w.graph,"graph"),R.push(re.serializeQuad(D))}R.sort();const y=new j(this.hashAlgorithm);for(const w of R)y.update(w);return A.hash=y.digest(),A.hash}hashRelatedBlankNode(S,R,A,v){let y;y=this.canonicalIssuer.hasId(S)?this.canonicalIssuer.getId(S):A.hasId(S)?A.getId(S):this.blankNodeInfo.get(S).hash;const w=new j(this.hashAlgorithm);return w.update(v),"g"!==v&&w.update(this.getRelatedPredicate(R)),w.update(y),w.digest()}hashNDegreeQuads(S,R){const A=new j(this.hashAlgorithm),v=this.createHashToRelated(S,R),y=[...v.keys()].sort();for(const w of y){A.update(w);let V,D="";const I=new L(v.get(w));for(;I.hasNext();){const H=I.next();let K=R.clone(),M="";const F=[];let Q=!1;for(const E of H)if(this.canonicalIssuer.hasId(E)?M+=this.canonicalIssuer.getId(E):(K.hasId(E)||F.push(E),M+=K.getId(E)),0!==D.length&&M>D){Q=!0;break}if(!Q){for(const E of F){const U=this.hashNDegreeQuads(E,K);if(M+=K.getId(E),M+=`<${U.hash}>`,K=U.issuer,0!==D.length&&M>D){Q=!0;break}}Q||(0===D.length||M<D)&&(D=M,V=K)}}A.update(D),R=V}return{hash:A.digest(),issuer:R}}modifyFirstDegreeComponent(S,R){return"BlankNode"!==R.termType?R:{termType:"BlankNode",value:R.value===S?"_:a":"_:z"}}getRelatedPredicate(S){return`<${S.predicate.value}>`}createHashToRelated(S,R){const A=new Map,v=this.blankNodeInfo.get(S).quads;for(const y of v)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:S,issuer:R,hashToRelated:A}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:S,issuer:R,hashToRelated:A}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:S,issuer:R,hashToRelated:A});return A}_hashAndTrackBlankNode({id:S,hashToBlankNodes:R}){const A=this.hashFirstDegreeQuads(S),v=R.get(A);v?v.push(S):R.set(A,[S])}_addBlankNodeQuadInfo({quad:S,component:R}){if("BlankNode"!==R.termType)return;const A=R.value,v=this.blankNodeInfo.get(A);v?v.quads.add(S):this.blankNodeInfo.set(A,{quads:new Set([S]),hash:null})}_addRelatedBlankNodeHash({quad:S,component:R,position:A,id:v,issuer:y,hashToRelated:w}){if("BlankNode"!==R.termType||R.value===v)return;const D=R.value,V=this.hashRelatedBlankNode(D,S,y,A),I=w.get(V);I?I.push(D):w.set(V,[D])}_useCanonicalId({component:S}){return"BlankNode"!==S.termType||S.value.startsWith(this.canonicalIssuer.prefix)?S:{termType:"BlankNode",value:this.canonicalIssuer.getId(S.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(Y,Ae,he){"use strict";const W=Y("./URDNA2015");Ae.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(L,re,$){return"BlankNode"!==re.termType?re:"graph"===$?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:re.value===L?"_:a":"_:z"}}getRelatedPredicate(L){return L.predicate.value}createHashToRelated(L,re){var $=this;return gt(function*(){const b=new Map,S=$.blankNodeInfo.get(L).quads;let R=0;for(const A of S){let v,y;if("BlankNode"===A.subject.termType&&A.subject.value!==L)y=A.subject.value,v="p";else{if("BlankNode"!==A.object.termType||A.object.value===L)continue;y=A.object.value,v="r"}++R%100==0&&(yield $._yield());const w=yield $.hashRelatedBlankNode(y,A,re,v),D=b.get(w);D?D.push(y):b.set(w,[y])}return b})()}}},{"./URDNA2015":51}],54:[function(Y,Ae,he){"use strict";const W=Y("./URDNA2015Sync");Ae.exports=class extends W{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(L,re,$){return"BlankNode"!==re.termType?re:"graph"===$?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:re.value===L?"_:a":"_:z"}}getRelatedPredicate(L){return L.predicate.value}createHashToRelated(L,re){const $=new Map,b=this.blankNodeInfo.get(L).quads;for(const S of b){let R,A;if("BlankNode"===S.subject.termType&&S.subject.value!==L)A=S.subject.value,R="p";else{if("BlankNode"!==S.object.termType||S.object.value===L)continue;A=S.object.value,R="r"}const v=this.hashRelatedBlankNode(A,S,re,R),y=$.get(v);y?y.push(A):$.set(v,[A])}return $}}},{"./URDNA2015Sync":52}],55:[function(Y,Ae,he){"use strict";const W=Y("./URDNA2015"),j=Y("./URGNA2012"),L=Y("./URDNA2015Sync"),re=Y("./URGNA2012Sync");let $;try{$=Y("rdf-canonize-native")}catch(S){}const b={};Ae.exports=b,b.NQuads=Y("./NQuads"),b.IdentifierIssuer=Y("./IdentifierIssuer"),b._rdfCanonizeNative=function(S){return S&&($=S),$},b.canonize=function(){var S=gt(function*(R,A){if(Array.isArray(R)||(R=b.NQuads.legacyDatasetToQuads(R)),A.useNative){if(!$)throw new Error("rdf-canonize-native not available");return new Promise((v,y)=>$.canonize(R,A,(w,D)=>w?y(w):v(D)))}if("URDNA2015"===A.algorithm)return new W(A).main(R);if("URGNA2012"===A.algorithm)return new j(A).main(R);throw"algorithm"in A?new Error("Invalid RDF Dataset Canonicalization algorithm: "+A.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(R,A){return S.apply(this,arguments)}}(),b._canonizeSync=function(S,R){if(Array.isArray(S)||(S=b.NQuads.legacyDatasetToQuads(S)),R.useNative){if($)return $.canonizeSync(S,R);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===R.algorithm)return new L(R).main(S);if("URGNA2012"===R.algorithm)return new re(R).main(S);throw"algorithm"in R?new Error("Invalid RDF Dataset Canonicalization algorithm: "+R.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(Y,Ae,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(L,re,$,b){void 0===b&&(b=$),Object.defineProperty(L,b,{enumerable:!0,get:function(){return re[$]}})}:function(L,re,$,b){void 0===b&&(b=$),L[b]=re[$]}),j=this&&this.__exportStar||function(L,re){for(var $ in L)"default"!==$&&!Object.prototype.hasOwnProperty.call(re,$)&&W(re,L,$)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/BlankNode"),he),j(Y("./lib/DataFactory"),he),j(Y("./lib/DefaultGraph"),he),j(Y("./lib/Literal"),he),j(Y("./lib/NamedNode"),he),j(Y("./lib/Quad"),he),j(Y("./lib/Variable"),he)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.BlankNode=void 0;he.BlankNode=class{constructor(L){this.termType="BlankNode",this.value=L}equals(L){return!!L&&"BlankNode"===L.termType&&L.value===this.value}}},{}],58:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DataFactory=void 0;const W=Y("./BlankNode"),j=Y("./DefaultGraph"),L=Y("./Literal"),re=Y("./NamedNode"),$=Y("./Quad"),b=Y("./Variable");let S=0;he.DataFactory=class{constructor(v){this.blankNodeCounter=0,this.blankNodePrefix=(v=v||{}).blankNodePrefix||`df_${S++}_`}namedNode(v){return new re.NamedNode(v)}blankNode(v){return new W.BlankNode(v||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(v,y){return new L.Literal(v,y)}variable(v){return new b.Variable(v)}defaultGraph(){return j.DefaultGraph.INSTANCE}quad(v,y,w,D){return new $.Quad(v,y,w,D||this.defaultGraph())}fromTerm(v){switch(v.termType){case"NamedNode":return this.namedNode(v.value);case"BlankNode":return this.blankNode(v.value);case"Literal":return v.language?this.literal(v.value,v.language):v.datatype.equals(L.Literal.XSD_STRING)?this.literal(v.value):this.literal(v.value,this.fromTerm(v.datatype));case"Variable":return this.variable(v.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(v.subject),this.fromTerm(v.predicate),this.fromTerm(v.object),this.fromTerm(v.graph))}}fromQuad(v){return this.fromTerm(v)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.DefaultGraph=void 0;class W{constructor(){this.termType="DefaultGraph",this.value=""}equals(L){return!!L&&"DefaultGraph"===L.termType}}he.DefaultGraph=W,W.INSTANCE=new W},{}],60:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Literal=void 0;const W=Y("./NamedNode");class j{constructor(re,$){this.termType="Literal",this.value=re,"string"==typeof $?(this.language=$,this.datatype=j.RDF_LANGUAGE_STRING):$?(this.language="",this.datatype=$):(this.language="",this.datatype=j.XSD_STRING)}equals(re){return!!re&&"Literal"===re.termType&&re.value===this.value&&re.language===this.language&&re.datatype.equals(this.datatype)}}he.Literal=j,j.RDF_LANGUAGE_STRING=new W.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),j.XSD_STRING=new W.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.NamedNode=void 0;he.NamedNode=class{constructor(L){this.termType="NamedNode",this.value=L}equals(L){return!!L&&"NamedNode"===L.termType&&L.value===this.value}}},{}],62:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Quad=void 0;he.Quad=class{constructor(L,re,$,b){this.termType="Quad",this.value="",this.subject=L,this.predicate=re,this.object=$,this.graph=b}equals(L){return!!L&&("Quad"===L.termType||!L.termType)&&this.subject.equals(L.subject)&&this.predicate.equals(L.predicate)&&this.object.equals(L.object)&&this.graph.equals(L.graph)}}},{}],63:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.Variable=void 0;he.Variable=class{constructor(L){this.termType="Variable",this.value=L}equals(L){return!!L&&"Variable"===L.termType&&L.value===this.value}}},{}],64:[function(Y,Ae,he){"use strict";var W=this&&this.__createBinding||(Object.create?function(L,re,$,b){void 0===b&&(b=$),Object.defineProperty(L,b,{enumerable:!0,get:function(){return re[$]}})}:function(L,re,$,b){void 0===b&&(b=$),L[b]=re[$]}),j=this&&this.__exportStar||function(L,re){for(var $ in L)"default"!==$&&!Object.prototype.hasOwnProperty.call(re,$)&&W(re,L,$)};Object.defineProperty(he,"__esModule",{value:!0}),j(Y("./lib/RdfXmlParser"),he)},{"./lib/RdfXmlParser":66}],65:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseError=void 0;class W extends Error{constructor(L,re){const $=L.saxStream._parser;super(L.trackPosition?`Line ${$.line+1} column ${$.column+1}: ${re}`:re)}}he.ParseError=W},{}],66:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),he.ParseType=he.RdfXmlParser=void 0;const W=Y("relative-to-absolute-iri"),j=Y("sax"),L=Y("stream"),re=Y("./ParseError"),$=Y("rdf-data-factory");class b extends L.Transform{constructor(A){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},A&&(Object.assign(this,A),this.options=A),this.dataFactory||(this.dataFactory=new $.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=j.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(A,v){const y={};let w=!1;for(const V in A.attributes)V.startsWith("xmlns")&&(5===V.length?(w=!0,y[""]=A.attributes[V]):":"===V.charAt(5)&&(w=!0,y[V.substr(6)]=A.attributes[V]));const D=v&&v.ns?v.ns:[b.DEFAULT_NS];return w?D.concat([y]):D}static expandPrefixedTerm(A,v,y){const w=A.indexOf(":");let D,V;w>=0?(D=A.substr(0,w),V=A.substr(w+1)):(D="",V=A);let I=null,H=null;for(let K=v.length-1;K>=0;K--){const M=v[K][D];if(M){I=M;break}H||(H=v[K][""])}if(!I){if(D&&"xmlns"!==D)throw new re.ParseError(y,`The prefix '${D}' in term '${A}' was not bound.`);I=H||""}return{prefix:D,local:V,uri:I}}static isValidIri(A){return b.IRI_REGEX.test(A)}import(A){const v=new L.PassThrough({readableObjectMode:!0});A.on("error",w=>y.emit("error",w)),A.on("data",w=>v.push(w)),A.on("end",()=>v.push(null));const y=v.pipe(new b(this.options));return y}_transform(A,v,y){try{this.saxStream.write(A,v)}catch(w){return y(w)}y()}newParseError(A){return new re.ParseError(this,A)}valueToUri(A,v){return this.uriToNamedNode(W.resolve(A,v.baseIRI))}uriToNamedNode(A){if(!b.isValidIri(A))throw this.newParseError(`Invalid URI: ${A}`);return this.dataFactory.namedNode(A)}validateNcname(A){if(!b.NCNAME_MATCHER.test(A))throw this.newParseError(`Not a valid NCName: ${A}`)}attachSaxListeners(){this.saxStream.on("error",A=>this.emit("error",A)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(A){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=S.RESOURCE;if(v&&(v.hadChildren=!0,y=v.childrenParseType),v&&v.childrenStringTags){const D=A.name;let V="";for(const M in A.attributes)V+=` ${M}="${A.attributes[M]}"`;v.childrenStringTags.push(`<${D}${V}>`);const K={childrenStringTags:v.childrenStringTags};return K.childrenStringEmitClosingTag=`</${D}>`,void this.activeTagStack.push(K)}const w={};v?(w.language=v.language,w.baseIRI=v.baseIRI):w.baseIRI=this.baseIRI,this.activeTagStack.push(w),w.ns=b.parseNamespace(A,v),y===S.RESOURCE?this.onTagResource(A,w,v,!v):this.onTagProperty(A,w,v)}onTagResource(A,v,y,w){const D=b.expandPrefixedTerm(A.name,v.ns,this);v.childrenParseType=S.PROPERTY;let V=!0;if(D.uri===b.RDF){if(!w&&b.FORBIDDEN_NODE_ELEMENTS.indexOf(D.local)>=0)throw this.newParseError(`Illegal node element name: ${D.local}`);switch(D.local){case"RDF":v.childrenParseType=S.RESOURCE;case"Description":V=!1}}const I=[],H=[];let K=null,M=!1,F=!1,Q=null;for(const E in A.attributes){const U=A.attributes[E],ie=b.expandPrefixedTerm(E,v.ns,this);if(y&&ie.uri===b.RDF)switch(ie.local){case"about":if(K)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${U} and ${K} where found.`);K=U;continue;case"ID":if(K)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${U} and ${K} where found.`);this.validateNcname(U),K="#"+U,M=!0;continue;case"nodeID":if(K)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${U} and ${K} where found.`);this.validateNcname(U),K=U,F=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":Q=U;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(ie.uri===b.XML){if("lang"===ie.local){v.language=""===U?null:U.toLowerCase();continue}if("base"===ie.local){v.baseIRI=W.resolve(U,v.baseIRI);continue}}"xml"!==ie.prefix&&ie.uri&&(I.push(this.uriToNamedNode(ie.uri+ie.local)),H.push(U))}if(null!==K&&(v.subject=F?this.dataFactory.blankNode(K):this.valueToUri(K,v),M&&this.claimNodeId(v.subject)),v.subject||(v.subject=this.dataFactory.blankNode()),V){const E=this.uriToNamedNode(D.uri+D.local);this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),E,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const E=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,E,y.reifiedStatementId),this.emitTriple(E,this.dataFactory.namedNode(b.RDF+"first"),v.subject,v.reifiedStatementId),y.childrenCollectionSubject=E,y.childrenCollectionPredicate=this.dataFactory.namedNode(b.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,v.subject,y.reifiedStatementId);for(let E=0;E<y.predicateSubPredicates.length;E++)this.emitTriple(v.subject,y.predicateSubPredicates[E],y.predicateSubObjects[E],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let E=0;E<I.length;E++){const U=this.dataFactory.literal(H[E],v.datatype||v.language);this.emitTriple(v.subject,I[E],U,y.reifiedStatementId)}Q&&this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),this.uriToNamedNode(Q),null)}}onTagProperty(A,v,y){const w=b.expandPrefixedTerm(A.name,v.ns,this);if(v.childrenParseType=S.RESOURCE,v.subject=y.subject,w.uri===b.RDF&&"li"===w.local?(y.listItemCounter||(y.listItemCounter=1),v.predicate=this.uriToNamedNode(w.uri+"_"+y.listItemCounter++)):v.predicate=this.uriToNamedNode(w.uri+w.local),w.uri===b.RDF&&b.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(w.local)>=0)throw this.newParseError(`Illegal property element name: ${w.local}`);v.predicateSubPredicates=[],v.predicateSubObjects=[];let D=!1,V=!1,I=null,H=!0;const K=[],M=[];for(const F in A.attributes){const Q=A.attributes[F],E=b.expandPrefixedTerm(F,v.ns,this);if(E.uri===b.RDF)switch(E.local){case"resource":if(I)throw this.newParseError(`Found both rdf:resource (${Q}) and rdf:nodeID (${I}).`);if(D)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${Q})`);v.hadChildren=!0,I=Q,H=!1;continue;case"datatype":if(V)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${Q}).`);if(D)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${Q})`);v.datatype=this.valueToUri(Q,v);continue;case"nodeID":if(V)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${Q}).`);if(v.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${Q}).`);if(D)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${Q})`);this.validateNcname(Q),v.hadChildren=!0,I=Q,H=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(V)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(v.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${v.datatype.value})`);if(I)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${I})`);if("Resource"===Q){D=!0,v.childrenParseType=S.PROPERTY;const U=this.dataFactory.blankNode();this.emitTriple(v.subject,v.predicate,U,v.reifiedStatementId),v.subject=U,v.predicate=null}else"Collection"===Q?(D=!0,v.hadChildren=!0,v.childrenCollectionSubject=v.subject,v.childrenCollectionPredicate=v.predicate,H=!1):"Literal"===Q&&(D=!0,v.childrenTagsToString=!0,v.childrenStringTags=[]);continue;case"ID":this.validateNcname(Q),v.reifiedStatementId=this.valueToUri("#"+Q,v),this.claimNodeId(v.reifiedStatementId);continue}else if(E.uri===b.XML&&"lang"===E.local){v.language=""===Q?null:Q.toLowerCase();continue}if("xml"!==E.prefix&&"xmlns"!==E.prefix&&E.uri){if(D||v.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${Q}`);v.hadChildren=!0,V=!0,K.push(this.uriToNamedNode(E.uri+E.local)),M.push(this.dataFactory.literal(Q,v.datatype||v.language))}}if(null!==I){const F=v.subject;v.subject=H?this.dataFactory.blankNode(I):this.valueToUri(I,v),this.emitTriple(F,v.predicate,v.subject,v.reifiedStatementId);for(let Q=0;Q<K.length;Q++)this.emitTriple(v.subject,K[Q],M[Q],null);v.predicateEmitted=!0}else H&&(v.predicateSubPredicates=K,v.predicateSubObjects=M,v.predicateEmitted=!1)}emitTriple(A,v,y,w){this.push(this.dataFactory.quad(A,v,y,this.defaultGraph)),w&&(this.push(this.dataFactory.quad(w,this.dataFactory.namedNode(b.RDF+"type"),this.dataFactory.namedNode(b.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(w,this.dataFactory.namedNode(b.RDF+"subject"),A,this.defaultGraph)),this.push(this.dataFactory.quad(w,this.dataFactory.namedNode(b.RDF+"predicate"),v,this.defaultGraph)),this.push(this.dataFactory.quad(w,this.dataFactory.namedNode(b.RDF+"object"),y,this.defaultGraph)))}claimNodeId(A){if(!this.allowDuplicateRdfIds){if(this.nodeIds[A.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${A.value}'.`);this.nodeIds[A.value]=!0}}onText(A){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;v&&(v.childrenStringTags?v.childrenStringTags.push(A):v.predicate&&(v.text=A))}onCloseTag(){const A=this.activeTagStack.pop();if(A.childrenStringEmitClosingTag&&A.childrenStringTags.push(A.childrenStringEmitClosingTag),A.childrenTagsToString&&(A.datatype=this.dataFactory.namedNode(b.RDF+"XMLLiteral"),A.text=A.childrenStringTags.join(""),A.hadChildren=!1),A.childrenCollectionSubject)this.emitTriple(A.childrenCollectionSubject,A.childrenCollectionPredicate,this.dataFactory.namedNode(b.RDF+"nil"),A.reifiedStatementId);else if(A.predicate)if(A.hadChildren||A.childrenParseType===S.PROPERTY){if(!A.predicateEmitted){const v=this.dataFactory.blankNode();this.emitTriple(A.subject,A.predicate,v,A.reifiedStatementId);for(let y=0;y<A.predicateSubPredicates.length;y++)this.emitTriple(v,A.predicateSubPredicates[y],A.predicateSubObjects[y],null)}}else this.emitTriple(A.subject,A.predicate,this.dataFactory.literal(A.text||"",A.datatype||A.language),A.reifiedStatementId)}onDoctype(A){A.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(v,y,w)=>(this.saxStream._parser.ENTITIES[y]=w,""))}}var S,R;he.RdfXmlParser=b,b.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,b.MIME_TYPE="application/rdf+xml",b.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",b.XML="http://www.w3.org/XML/1998/namespace",b.XMLNS="http://www.w3.org/2000/xmlns/",b.DEFAULT_NS={xml:b.XML},b.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],b.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],b.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(R=S=he.ParseType||(he.ParseType={}))[R.RESOURCE=0]="RESOURCE",R[R.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(Y,Ae,he){"use strict";var j={};function L(R,A,v){v||(v=Error);var w=function(D){function V(I,H,K){return D.call(this,function(D,V,I){return"string"==typeof A?A:A(D,V,I)}(I,H,K))||this}return function(R,A){R.prototype=Object.create(A.prototype),R.prototype.constructor=R,R.__proto__=A}(V,D),V}(v);w.prototype.name=v.name,w.prototype.code=R,j[R]=w}function re(R,A){if(Array.isArray(R)){var v=R.length;return R=R.map(function(y){return String(y)}),v>2?"one of ".concat(A," ").concat(R.slice(0,v-1).join(", "),", or ")+R[v-1]:2===v?"one of ".concat(A," ").concat(R[0]," or ").concat(R[1]):"of ".concat(A," ").concat(R[0])}return"of ".concat(A," ").concat(String(R))}L("ERR_INVALID_OPT_VALUE",function(R,A){return'The value "'+A+'" is invalid for option "'+R+'"'},TypeError),L("ERR_INVALID_ARG_TYPE",function(R,A,v){var y,w;if("string"==typeof A&&function(R,A,v){return R.substr(!v||v<0?0:+v,A.length)===A}(A,"not ")?(y="must not be",A=A.replace(/^not /,"")):y="must be",function(R,A,v){return(void 0===v||v>R.length)&&(v=R.length),R.substring(v-A.length,v)===A}(R," argument"))w="The ".concat(R," ").concat(y," ").concat(re(A,"type"));else{var D=function(R,A,v){return"number"!=typeof v&&(v=0),!(v+A.length>R.length)&&-1!==R.indexOf(A,v)}(R,".")?"property":"argument";w='The "'.concat(R,'" ').concat(D," ").concat(y," ").concat(re(A,"type"))}return w+". Received type ".concat(typeof v)},TypeError),L("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),L("ERR_METHOD_NOT_IMPLEMENTED",function(R){return"The "+R+" method is not implemented"}),L("ERR_STREAM_PREMATURE_CLOSE","Premature close"),L("ERR_STREAM_DESTROYED",function(R){return"Cannot call "+R+" after a stream was destroyed"}),L("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),L("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),L("ERR_STREAM_WRITE_AFTER_END","write after end"),L("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),L("ERR_UNKNOWN_ENCODING",function(R){return"Unknown encoding: "+R},TypeError),L("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Ae.exports.codes=j},{}],68:[function(Y,Ae,he){(function(W){(function(){"use strict";var j=Object.keys||function(y){var w=[];for(var D in y)w.push(D);return w};Ae.exports=R;var L=Y("./_stream_readable"),re=Y("./_stream_writable");Y("inherits")(R,L);for(var $=j(re.prototype),b=0;b<$.length;b++){var S=$[b];R.prototype[S]||(R.prototype[S]=re.prototype[S])}function R(y){if(!(this instanceof R))return new R(y);L.call(this,y),re.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",A)))}function A(){this._writableState.ended||W.nextTick(v,this)}function v(y){y.end()}Object.defineProperty(R.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(R.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(R.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(w){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=w,this._writableState.destroyed=w)}})}).call(this)}).call(this,Y("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(Y,Ae,he){"use strict";Ae.exports=j;var W=Y("./_stream_transform");function j(L){if(!(this instanceof j))return new j(L);W.call(this,L)}Y("inherits")(j,W),j.prototype._transform=function(L,re,$){$(null,L)}},{"./_stream_transform":71,inherits:10}],70:[function(Y,Ae,he){(function(W,j){(function(){"use strict";var L;Ae.exports=te,te.ReadableState=ve,Y("events");var $=function(B,O){return B.listeners(O).length},b=Y("./internal/streams/stream"),S=Y("buffer").Buffer,R=j.Uint8Array||function(){};var w,y=Y("util");w=y&&y.debuglog?y.debuglog("stream"):function(){};var U,ie,ue,D=Y("./internal/streams/buffer_list"),V=Y("./internal/streams/destroy"),H=Y("./internal/streams/state").getHighWaterMark,K=Y("../errors").codes,M=K.ERR_INVALID_ARG_TYPE,F=K.ERR_STREAM_PUSH_AFTER_EOF,Q=K.ERR_METHOD_NOT_IMPLEMENTED,E=K.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;Y("inherits")(te,b);var ee=V.errorOrDestroy,se=["error","close","destroy","pause","resume"];function ve(pe,B,O){L=L||Y("./_stream_duplex"),"boolean"!=typeof O&&(O=B instanceof L),this.objectMode=!!(pe=pe||{}).objectMode,O&&(this.objectMode=this.objectMode||!!pe.readableObjectMode),this.highWaterMark=H(this,pe,"readableHighWaterMark",O),this.buffer=new D,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==pe.emitClose,this.autoDestroy=!!pe.autoDestroy,this.destroyed=!1,this.defaultEncoding=pe.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,pe.encoding&&(U||(U=Y("string_decoder/").StringDecoder),this.decoder=new U(pe.encoding),this.encoding=pe.encoding)}function te(pe){if(L=L||Y("./_stream_duplex"),!(this instanceof te))return new te(pe);this._readableState=new ve(pe,this,this instanceof L),this.readable=!0,pe&&("function"==typeof pe.read&&(this._read=pe.read),"function"==typeof pe.destroy&&(this._destroy=pe.destroy)),b.call(this)}function _e(pe,B,O,k,Oe){w("readableAddChunk",B);var yt,Xe=pe._readableState;if(null===B)Xe.reading=!1,function(pe,B){if(w("onEofChunk"),!B.ended){if(B.decoder){var O=B.decoder.end();O&&O.length&&(B.buffer.push(O),B.length+=B.objectMode?1:O.length)}B.ended=!0,B.sync?Ve(pe):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,Le(pe)))}}(pe,Xe);else if(Oe||(yt=function(pe,B){var O;return!function(pe){return S.isBuffer(pe)||pe instanceof R}(B)&&"string"!=typeof B&&void 0!==B&&!pe.objectMode&&(O=new M("chunk",["string","Buffer","Uint8Array"],B)),O}(Xe,B)),yt)ee(pe,yt);else if(Xe.objectMode||B&&B.length>0)if("string"!=typeof B&&!Xe.objectMode&&Object.getPrototypeOf(B)!==S.prototype&&(B=function(pe){return S.from(pe)}(B)),k)Xe.endEmitted?ee(pe,new E):Me(pe,Xe,B,!0);else if(Xe.ended)ee(pe,new F);else{if(Xe.destroyed)return!1;Xe.reading=!1,Xe.decoder&&!O?(B=Xe.decoder.write(B),Xe.objectMode||0!==B.length?Me(pe,Xe,B,!1):Ee(pe,Xe)):Me(pe,Xe,B,!1)}else k||(Xe.reading=!1,Ee(pe,Xe));return!Xe.ended&&(Xe.length<Xe.highWaterMark||0===Xe.length)}function Me(pe,B,O,k){B.flowing&&0===B.length&&!B.sync?(B.awaitDrain=0,pe.emit("data",O)):(B.length+=B.objectMode?1:O.length,k?B.buffer.unshift(O):B.buffer.push(O),B.needReadable&&Ve(pe)),Ee(pe,B)}Object.defineProperty(te.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(B){!this._readableState||(this._readableState.destroyed=B)}}),te.prototype.destroy=V.destroy,te.prototype._undestroy=V.undestroy,te.prototype._destroy=function(pe,B){B(pe)},te.prototype.push=function(pe,B){var k,O=this._readableState;return O.objectMode?k=!0:"string"==typeof pe&&((B=B||O.defaultEncoding)!==O.encoding&&(pe=S.from(pe,B),B=""),k=!0),_e(this,pe,B,!1,k)},te.prototype.unshift=function(pe){return _e(this,pe,null,!0,!1)},te.prototype.isPaused=function(){return!1===this._readableState.flowing},te.prototype.setEncoding=function(pe){U||(U=Y("string_decoder/").StringDecoder);var B=new U(pe);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var O=this._readableState.buffer.head,k="";null!==O;)k+=B.write(O.data),O=O.next;return this._readableState.buffer.clear(),""!==k&&this._readableState.buffer.push(k),this._readableState.length=k.length,this};var nt=1073741824;function Je(pe,B){return pe<=0||0===B.length&&B.ended?0:B.objectMode?1:pe!=pe?B.flowing&&B.length?B.buffer.head.data.length:B.length:(pe>B.highWaterMark&&(B.highWaterMark=function(pe){return pe>=nt?pe=nt:(pe--,pe|=pe>>>1,pe|=pe>>>2,pe|=pe>>>4,pe|=pe>>>8,pe|=pe>>>16,pe++),pe}(pe)),pe<=B.length?pe:B.ended?B.length:(B.needReadable=!0,0))}function Ve(pe){var B=pe._readableState;w("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(w("emitReadable",B.flowing),B.emittedReadable=!0,W.nextTick(Le,pe))}function Le(pe){var B=pe._readableState;w("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(pe.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,be(pe)}function Ee(pe,B){B.readingMore||(B.readingMore=!0,W.nextTick(Ie,pe,B))}function Ie(pe,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&0===B.length);){var O=B.length;if(w("maybeReadMore read 0"),pe.read(0),O===B.length)break}B.readingMore=!1}function qe(pe){var B=pe._readableState;B.readableListening=pe.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:pe.listenerCount("data")>0&&pe.resume()}function Be(pe){w("readable nexttick read 0"),pe.read(0)}function X(pe,B){w("resume",B.reading),B.reading||pe.read(0),B.resumeScheduled=!1,pe.emit("resume"),be(pe),B.flowing&&!B.reading&&pe.read(0)}function be(pe){var B=pe._readableState;for(w("flow",B.flowing);B.flowing&&null!==pe.read(););}function ce(pe,B){return 0===B.length?null:(B.objectMode?O=B.buffer.shift():!pe||pe>=B.length?(O=B.decoder?B.buffer.join(""):1===B.buffer.length?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):O=B.buffer.consume(pe,B.decoder),O);var O}function Pe(pe){var B=pe._readableState;w("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,W.nextTick(wt,B,pe))}function wt(pe,B){if(w("endReadableNT",pe.endEmitted,pe.length),!pe.endEmitted&&0===pe.length&&(pe.endEmitted=!0,B.readable=!1,B.emit("end"),pe.autoDestroy)){var O=B._writableState;(!O||O.autoDestroy&&O.finished)&&B.destroy()}}function pt(pe,B){for(var O=0,k=pe.length;O<k;O++)if(pe[O]===B)return O;return-1}te.prototype.read=function(pe){w("read",pe),pe=parseInt(pe,10);var B=this._readableState,O=pe;if(0!==pe&&(B.emittedReadable=!1),0===pe&&B.needReadable&&((0!==B.highWaterMark?B.length>=B.highWaterMark:B.length>0)||B.ended))return w("read: emitReadable",B.length,B.ended),0===B.length&&B.ended?Pe(this):Ve(this),null;if(0===(pe=Je(pe,B))&&B.ended)return 0===B.length&&Pe(this),null;var Oe,k=B.needReadable;return w("need readable",k),(0===B.length||B.length-pe<B.highWaterMark)&&w("length less than watermark",k=!0),B.ended||B.reading?w("reading or ended",k=!1):k&&(w("do read"),B.reading=!0,B.sync=!0,0===B.length&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(pe=Je(O,B))),null===(Oe=pe>0?ce(pe,B):null)?(B.needReadable=B.length<=B.highWaterMark,pe=0):(B.length-=pe,B.awaitDrain=0),0===B.length&&(B.ended||(B.needReadable=!0),O!==pe&&B.ended&&Pe(this)),null!==Oe&&this.emit("data",Oe),Oe},te.prototype._read=function(pe){ee(this,new Q("_read()"))},te.prototype.pipe=function(pe,B){var O=this,k=this._readableState;switch(k.pipesCount){case 0:k.pipes=pe;break;case 1:k.pipes=[k.pipes,pe];break;default:k.pipes.push(pe)}k.pipesCount+=1,w("pipe count=%d opts=%j",k.pipesCount,B);var Xe=B&&!1===B.end||pe===W.stdout||pe===W.stderr?ss:It;function yt(Os,Ur){w("onunpipe"),Os===O&&Ur&&!1===Ur.hasUnpiped&&(Ur.hasUnpiped=!0,w("cleanup"),pe.removeListener("close",jr),pe.removeListener("finish",Is),pe.removeListener("drain",An),pe.removeListener("error",ci),pe.removeListener("unpipe",yt),O.removeListener("end",It),O.removeListener("end",ss),O.removeListener("data",_i),Rn=!0,k.awaitDrain&&(!pe._writableState||pe._writableState.needDrain)&&An())}function It(){w("onend"),pe.end()}k.endEmitted?W.nextTick(Xe):O.once("end",Xe),pe.on("unpipe",yt);var An=function(pe){return function(){var O=pe._readableState;w("pipeOnDrain",O.awaitDrain),O.awaitDrain&&O.awaitDrain--,0===O.awaitDrain&&$(pe,"data")&&(O.flowing=!0,be(pe))}}(O);pe.on("drain",An);var Rn=!1;function _i(Os){w("ondata");var Ur=pe.write(Os);w("dest.write",Ur),!1===Ur&&((1===k.pipesCount&&k.pipes===pe||k.pipesCount>1&&-1!==pt(k.pipes,pe))&&!Rn&&(w("false write response, pause",k.awaitDrain),k.awaitDrain++),O.pause())}function ci(Os){w("onerror",Os),ss(),pe.removeListener("error",ci),0===$(pe,"error")&&ee(pe,Os)}function jr(){pe.removeListener("finish",Is),ss()}function Is(){w("onfinish"),pe.removeListener("close",jr),ss()}function ss(){w("unpipe"),O.unpipe(pe)}return O.on("data",_i),function(pe,B,O){if("function"==typeof pe.prependListener)return pe.prependListener(B,O);pe._events&&pe._events[B]?Array.isArray(pe._events[B])?pe._events[B].unshift(O):pe._events[B]=[O,pe._events[B]]:pe.on(B,O)}(pe,"error",ci),pe.once("close",jr),pe.once("finish",Is),pe.emit("pipe",O),k.flowing||(w("pipe resume"),O.resume()),pe},te.prototype.unpipe=function(pe){var B=this._readableState,O={hasUnpiped:!1};if(0===B.pipesCount)return this;if(1===B.pipesCount)return pe&&pe!==B.pipes||(pe||(pe=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,pe&&pe.emit("unpipe",this,O)),this;if(!pe){var k=B.pipes,Oe=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var Xe=0;Xe<Oe;Xe++)k[Xe].emit("unpipe",this,{hasUnpiped:!1});return this}var yt=pt(B.pipes,pe);return-1===yt||(B.pipes.splice(yt,1),B.pipesCount-=1,1===B.pipesCount&&(B.pipes=B.pipes[0]),pe.emit("unpipe",this,O)),this},te.prototype.addListener=te.prototype.on=function(pe,B){var O=b.prototype.on.call(this,pe,B),k=this._readableState;return"data"===pe?(k.readableListening=this.listenerCount("readable")>0,!1!==k.flowing&&this.resume()):"readable"===pe&&!k.endEmitted&&!k.readableListening&&(k.readableListening=k.needReadable=!0,k.flowing=!1,k.emittedReadable=!1,w("on readable",k.length,k.reading),k.length?Ve(this):k.reading||W.nextTick(Be,this)),O},te.prototype.removeListener=function(pe,B){var O=b.prototype.removeListener.call(this,pe,B);return"readable"===pe&&W.nextTick(qe,this),O},te.prototype.removeAllListeners=function(pe){var B=b.prototype.removeAllListeners.apply(this,arguments);return("readable"===pe||void 0===pe)&&W.nextTick(qe,this),B},te.prototype.resume=function(){var pe=this._readableState;return pe.flowing||(w("resume"),pe.flowing=!pe.readableListening,function(pe,B){B.resumeScheduled||(B.resumeScheduled=!0,W.nextTick(X,pe,B))}(this,pe)),pe.paused=!1,this},te.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},te.prototype.wrap=function(pe){var B=this,O=this._readableState,k=!1;for(var Oe in pe.on("end",function(){if(w("wrapped end"),O.decoder&&!O.ended){var yt=O.decoder.end();yt&&yt.length&&B.push(yt)}B.push(null)}),pe.on("data",function(yt){w("wrapped data"),O.decoder&&(yt=O.decoder.write(yt)),O.objectMode&&null==yt||!(O.objectMode||yt&&yt.length)||B.push(yt)||(k=!0,pe.pause())}),pe)void 0===this[Oe]&&"function"==typeof pe[Oe]&&(this[Oe]=function(It){return function(){return pe[It].apply(pe,arguments)}}(Oe));for(var Xe=0;Xe<se.length;Xe++)pe.on(se[Xe],this.emit.bind(this,se[Xe]));return this._read=function(yt){w("wrapped _read",yt),k&&(k=!1,pe.resume())},this},"function"==typeof Symbol&&(te.prototype[Symbol.asyncIterator]=function(){return void 0===ie&&(ie=Y("./internal/streams/async_iterator")),ie(this)}),Object.defineProperty(te.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(te.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(te.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),te._fromList=ce,Object.defineProperty(te.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(te.from=function(pe,B){return void 0===ue&&(ue=Y("./internal/streams/from")),ue(te,pe,B)})}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(Y,Ae,he){"use strict";Ae.exports=R;var W=Y("../errors").codes,j=W.ERR_METHOD_NOT_IMPLEMENTED,L=W.ERR_MULTIPLE_CALLBACK,re=W.ERR_TRANSFORM_ALREADY_TRANSFORMING,$=W.ERR_TRANSFORM_WITH_LENGTH_0,b=Y("./_stream_duplex");function S(y,w){var D=this._transformState;D.transforming=!1;var V=D.writecb;if(null===V)return this.emit("error",new L);D.writechunk=null,D.writecb=null,null!=w&&this.push(w),V(y);var I=this._readableState;I.reading=!1,(I.needReadable||I.length<I.highWaterMark)&&this._read(I.highWaterMark)}function R(y){if(!(this instanceof R))return new R(y);b.call(this,y),this._transformState={afterTransform:S.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",A)}function A(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?v(this,null,null):this._flush(function(w,D){v(y,w,D)})}function v(y,w,D){if(w)return y.emit("error",w);if(null!=D&&y.push(D),y._writableState.length)throw new $;if(y._transformState.transforming)throw new re;return y.push(null)}Y("inherits")(R,b),R.prototype.push=function(y,w){return this._transformState.needTransform=!1,b.prototype.push.call(this,y,w)},R.prototype._transform=function(y,w,D){D(new j("_transform()"))},R.prototype._write=function(y,w,D){var V=this._transformState;if(V.writecb=D,V.writechunk=y,V.writeencoding=w,!V.transforming){var I=this._readableState;(V.needTransform||I.needReadable||I.length<I.highWaterMark)&&this._read(I.highWaterMark)}},R.prototype._read=function(y){var w=this._transformState;null===w.writechunk||w.transforming?w.needTransform=!0:(w.transforming=!0,this._transform(w.writechunk,w.writeencoding,w.afterTransform))},R.prototype._destroy=function(y,w){b.prototype._destroy.call(this,y,function(D){w(D)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(Y,Ae,he){(function(W,j){(function(){"use strict";function re(be){var ce=this;this.next=null,this.entry=null,this.finish=function(){!function(be,ce,Pe){var wt=be.entry;for(be.entry=null;wt;){var pt=wt.callback;ce.pendingcb--,pt(Pe),wt=wt.next}ce.corkedRequestsFree.next=be}(ce,be)}}var $;Ae.exports=ve,ve.WritableState=se;var b={deprecate:Y("util-deprecate")},S=Y("./internal/streams/stream"),R=Y("buffer").Buffer,A=j.Uint8Array||function(){};var Te,w=Y("./internal/streams/destroy"),V=Y("./internal/streams/state").getHighWaterMark,I=Y("../errors").codes,H=I.ERR_INVALID_ARG_TYPE,K=I.ERR_METHOD_NOT_IMPLEMENTED,M=I.ERR_MULTIPLE_CALLBACK,F=I.ERR_STREAM_CANNOT_PIPE,Q=I.ERR_STREAM_DESTROYED,E=I.ERR_STREAM_NULL_VALUES,U=I.ERR_STREAM_WRITE_AFTER_END,ie=I.ERR_UNKNOWN_ENCODING,ue=w.errorOrDestroy;function ee(){}function se(be,ce,Pe){$=$||Y("./_stream_duplex"),"boolean"!=typeof Pe&&(Pe=ce instanceof $),this.objectMode=!!(be=be||{}).objectMode,Pe&&(this.objectMode=this.objectMode||!!be.writableObjectMode),this.highWaterMark=V(this,be,"writableHighWaterMark",Pe),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===be.decodeStrings),this.defaultEncoding=be.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(pt){!function(be,ce){var Pe=be._writableState,wt=Pe.sync,pt=Pe.writecb;if("function"!=typeof pt)throw new M;if(function(be){be.writing=!1,be.writecb=null,be.length-=be.writelen,be.writelen=0}(Pe),ce)!function(be,ce,Pe,wt,pt){--ce.pendingcb,Pe?(W.nextTick(pt,wt),W.nextTick(Be,be,ce),be._writableState.errorEmitted=!0,ue(be,wt)):(pt(wt),be._writableState.errorEmitted=!0,ue(be,wt),Be(be,ce))}(be,Pe,wt,ce,pt);else{var pe=Ie(Pe)||be.destroyed;!pe&&!Pe.corked&&!Pe.bufferProcessing&&Pe.bufferedRequest&&Ee(be,Pe),wt?W.nextTick(Ve,be,Pe,pe,pt):Ve(be,Pe,pe,pt)}}(ce,pt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==be.emitClose,this.autoDestroy=!!be.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new re(this)}function ve(be){var ce=this instanceof($=$||Y("./_stream_duplex"));if(!ce&&!Te.call(ve,this))return new ve(be);this._writableState=new se(be,this,ce),this.writable=!0,be&&("function"==typeof be.write&&(this._write=be.write),"function"==typeof be.writev&&(this._writev=be.writev),"function"==typeof be.destroy&&(this._destroy=be.destroy),"function"==typeof be.final&&(this._final=be.final)),S.call(this)}function je(be,ce,Pe,wt,pt,pe){if(!Pe){var B=function(be,ce,Pe){return!be.objectMode&&!1!==be.decodeStrings&&"string"==typeof ce&&(ce=R.from(ce,Pe)),ce}(ce,wt,pt);wt!==B&&(Pe=!0,pt="buffer",wt=B)}var O=ce.objectMode?1:wt.length;ce.length+=O;var k=ce.length<ce.highWaterMark;if(k||(ce.needDrain=!0),ce.writing||ce.corked){var Oe=ce.lastBufferedRequest;ce.lastBufferedRequest={chunk:wt,encoding:pt,isBuf:Pe,callback:pe,next:null},Oe?Oe.next=ce.lastBufferedRequest:ce.bufferedRequest=ce.lastBufferedRequest,ce.bufferedRequestCount+=1}else nt(be,ce,!1,O,wt,pt,pe);return k}function nt(be,ce,Pe,wt,pt,pe,B){ce.writelen=wt,ce.writecb=B,ce.writing=!0,ce.sync=!0,ce.destroyed?ce.onwrite(new Q("write")):Pe?be._writev(pt,ce.onwrite):be._write(pt,pe,ce.onwrite),ce.sync=!1}function Ve(be,ce,Pe,wt){Pe||function(be,ce){0===ce.length&&ce.needDrain&&(ce.needDrain=!1,be.emit("drain"))}(be,ce),ce.pendingcb--,wt(),Be(be,ce)}function Ee(be,ce){ce.bufferProcessing=!0;var Pe=ce.bufferedRequest;if(be._writev&&Pe&&Pe.next){var pt=new Array(ce.bufferedRequestCount),pe=ce.corkedRequestsFree;pe.entry=Pe;for(var B=0,O=!0;Pe;)pt[B]=Pe,Pe.isBuf||(O=!1),Pe=Pe.next,B+=1;pt.allBuffers=O,nt(be,ce,!0,ce.length,pt,"",pe.finish),ce.pendingcb++,ce.lastBufferedRequest=null,pe.next?(ce.corkedRequestsFree=pe.next,pe.next=null):ce.corkedRequestsFree=new re(ce),ce.bufferedRequestCount=0}else{for(;Pe;){var k=Pe.chunk;if(nt(be,ce,!1,ce.objectMode?1:k.length,k,Pe.encoding,Pe.callback),Pe=Pe.next,ce.bufferedRequestCount--,ce.writing)break}null===Pe&&(ce.lastBufferedRequest=null)}ce.bufferedRequest=Pe,ce.bufferProcessing=!1}function Ie(be){return be.ending&&0===be.length&&null===be.bufferedRequest&&!be.finished&&!be.writing}function Ue(be,ce){be._final(function(Pe){ce.pendingcb--,Pe&&ue(be,Pe),ce.prefinished=!0,be.emit("prefinish"),Be(be,ce)})}function Be(be,ce){var Pe=Ie(ce);if(Pe&&(function(be,ce){!ce.prefinished&&!ce.finalCalled&&("function"!=typeof be._final||ce.destroyed?(ce.prefinished=!0,be.emit("prefinish")):(ce.pendingcb++,ce.finalCalled=!0,W.nextTick(Ue,be,ce)))}(be,ce),0===ce.pendingcb&&(ce.finished=!0,be.emit("finish"),ce.autoDestroy))){var wt=be._readableState;(!wt||wt.autoDestroy&&wt.endEmitted)&&be.destroy()}return Pe}Y("inherits")(ve,S),se.prototype.getBuffer=function(){for(var ce=this.bufferedRequest,Pe=[];ce;)Pe.push(ce),ce=ce.next;return Pe},function(){try{Object.defineProperty(se.prototype,"buffer",{get:b.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(be){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Te=Function.prototype[Symbol.hasInstance],Object.defineProperty(ve,Symbol.hasInstance,{value:function(ce){return!!Te.call(this,ce)||this===ve&&ce&&ce._writableState instanceof se}})):Te=function(ce){return ce instanceof this},ve.prototype.pipe=function(){ue(this,new F)},ve.prototype.write=function(be,ce,Pe){var wt=this._writableState,pt=!1,pe=!wt.objectMode&&function(be){return R.isBuffer(be)||be instanceof A}(be);return pe&&!R.isBuffer(be)&&(be=function(be){return R.from(be)}(be)),"function"==typeof ce&&(Pe=ce,ce=null),pe?ce="buffer":ce||(ce=wt.defaultEncoding),"function"!=typeof Pe&&(Pe=ee),wt.ending?function(be,ce){var Pe=new U;ue(be,Pe),W.nextTick(ce,Pe)}(this,Pe):(pe||function(be,ce,Pe,wt){var pt;return null===Pe?pt=new E:"string"!=typeof Pe&&!ce.objectMode&&(pt=new H("chunk",["string","Buffer"],Pe)),!pt||(ue(be,pt),W.nextTick(wt,pt),!1)}(this,wt,be,Pe))&&(wt.pendingcb++,pt=je(this,wt,pe,be,ce,Pe)),pt},ve.prototype.cork=function(){this._writableState.corked++},ve.prototype.uncork=function(){var be=this._writableState;be.corked&&(be.corked--,!be.writing&&!be.corked&&!be.bufferProcessing&&be.bufferedRequest&&Ee(this,be))},ve.prototype.setDefaultEncoding=function(ce){if("string"==typeof ce&&(ce=ce.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ce+"").toLowerCase())>-1))throw new ie(ce);return this._writableState.defaultEncoding=ce,this},Object.defineProperty(ve.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(ve.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),ve.prototype._write=function(be,ce,Pe){Pe(new K("_write()"))},ve.prototype._writev=null,ve.prototype.end=function(be,ce,Pe){var wt=this._writableState;return"function"==typeof be?(Pe=be,be=null,ce=null):"function"==typeof ce&&(Pe=ce,ce=null),null!=be&&this.write(be,ce),wt.corked&&(wt.corked=1,this.uncork()),wt.ending||function(be,ce,Pe){ce.ending=!0,Be(be,ce),Pe&&(ce.finished?W.nextTick(Pe):be.once("finish",Pe)),ce.ended=!0,be.writable=!1}(this,wt,Pe),this},Object.defineProperty(ve.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(ve.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(ce){!this._writableState||(this._writableState.destroyed=ce)}}),ve.prototype.destroy=w.destroy,ve.prototype._undestroy=w.undestroy,ve.prototype._destroy=function(be,ce){ce(be)}}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(Y,Ae,he){(function(W){(function(){"use strict";var j;function L(F,Q,E){return Q in F?Object.defineProperty(F,Q,{value:E,enumerable:!0,configurable:!0,writable:!0}):F[Q]=E,F}var re=Y("./end-of-stream"),$=Symbol("lastResolve"),b=Symbol("lastReject"),S=Symbol("error"),R=Symbol("ended"),A=Symbol("lastPromise"),v=Symbol("handlePromise"),y=Symbol("stream");function w(F,Q){return{value:F,done:Q}}function D(F){var Q=F[$];if(null!==Q){var E=F[y].read();null!==E&&(F[A]=null,F[$]=null,F[b]=null,Q(w(E,!1)))}}function V(F){W.nextTick(D,F)}var H=Object.getPrototypeOf(function(){}),K=Object.setPrototypeOf((L(j={get stream(){return this[y]},next:function(){var Q=this,E=this[S];if(null!==E)return Promise.reject(E);if(this[R])return Promise.resolve(w(void 0,!0));if(this[y].destroyed)return new Promise(function(ee,se){W.nextTick(function(){Q[S]?se(Q[S]):ee(w(void 0,!0))})});var ie,U=this[A];if(U)ie=new Promise(function(F,Q){return function(E,U){F.then(function(){Q[R]?E(w(void 0,!0)):Q[v](E,U)},U)}}(U,this));else{var ue=this[y].read();if(null!==ue)return Promise.resolve(w(ue,!1));ie=new Promise(this[v])}return this[A]=ie,ie}},Symbol.asyncIterator,function(){return this}),L(j,"return",function(){var Q=this;return new Promise(function(E,U){Q[y].destroy(null,function(ie){ie?U(ie):E(w(void 0,!0))})})}),j),H);Ae.exports=function(Q){var E,U=Object.create(K,(L(E={},y,{value:Q,writable:!0}),L(E,$,{value:null,writable:!0}),L(E,b,{value:null,writable:!0}),L(E,S,{value:null,writable:!0}),L(E,R,{value:Q._readableState.endEmitted,writable:!0}),L(E,v,{value:function(ue,ee){var se=U[y].read();se?(U[A]=null,U[$]=null,U[b]=null,ue(w(se,!1))):(U[$]=ue,U[b]=ee)},writable:!0}),E));return U[A]=null,re(Q,function(ie){if(ie&&"ERR_STREAM_PREMATURE_CLOSE"!==ie.code){var ue=U[b];return null!==ue&&(U[A]=null,U[$]=null,U[b]=null,ue(ie)),void(U[S]=ie)}var ee=U[$];null!==ee&&(U[A]=null,U[$]=null,U[b]=null,ee(w(void 0,!0))),U[R]=!0}),Q.on("readable",V.bind(null,U)),U}}).call(this)}).call(this,Y("_process"))},{"./end-of-stream":76,_process:44}],74:[function(Y,Ae,he){"use strict";function W(D,V){var I=Object.keys(D);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(D);V&&(H=H.filter(function(K){return Object.getOwnPropertyDescriptor(D,K).enumerable})),I.push.apply(I,H)}return I}function L(D,V,I){return V in D?Object.defineProperty(D,V,{value:I,enumerable:!0,configurable:!0,writable:!0}):D[V]=I,D}function $(D,V){for(var I=0;I<V.length;I++){var H=V[I];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(D,H.key,H)}}var R=Y("buffer").Buffer,v=Y("util").inspect,y=v&&v.custom||"inspect";function w(D,V,I){R.prototype.copy.call(D,V,I)}Ae.exports=function(){function D(){(function(D,V){if(!(D instanceof V))throw new TypeError("Cannot call a class as a function")})(this,D),this.head=null,this.tail=null,this.length=0}return function(D,V,I){V&&$(D.prototype,V),I&&$(D,I)}(D,[{key:"push",value:function(I){var H={data:I,next:null};this.length>0?this.tail.next=H:this.head=H,this.tail=H,++this.length}},{key:"unshift",value:function(I){var H={data:I,next:this.head};0===this.length&&(this.tail=H),this.head=H,++this.length}},{key:"shift",value:function(){if(0!==this.length){var I=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,I}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(I){if(0===this.length)return"";for(var H=this.head,K=""+H.data;H=H.next;)K+=I+H.data;return K}},{key:"concat",value:function(I){if(0===this.length)return R.alloc(0);for(var H=R.allocUnsafe(I>>>0),K=this.head,M=0;K;)w(K.data,H,M),M+=K.data.length,K=K.next;return H}},{key:"consume",value:function(I,H){var K;return I<this.head.data.length?(K=this.head.data.slice(0,I),this.head.data=this.head.data.slice(I)):K=I===this.head.data.length?this.shift():H?this._getString(I):this._getBuffer(I),K}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(I){var H=this.head,K=1,M=H.data;for(I-=M.length;H=H.next;){var F=H.data,Q=I>F.length?F.length:I;if(M+=Q===F.length?F:F.slice(0,I),0==(I-=Q)){Q===F.length?(++K,this.head=H.next?H.next:this.tail=null):(this.head=H,H.data=F.slice(Q));break}++K}return this.length-=K,M}},{key:"_getBuffer",value:function(I){var H=R.allocUnsafe(I),K=this.head,M=1;for(K.data.copy(H),I-=K.data.length;K=K.next;){var F=K.data,Q=I>F.length?F.length:I;if(F.copy(H,H.length-I,0,Q),0==(I-=Q)){Q===F.length?(++M,this.head=K.next?K.next:this.tail=null):(this.head=K,K.data=F.slice(Q));break}++M}return this.length-=M,H}},{key:y,value:function(I,H){return v(this,function(D){for(var V=1;V<arguments.length;V++){var I=null!=arguments[V]?arguments[V]:{};V%2?W(Object(I),!0).forEach(function(H){L(D,H,I[H])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(I)):W(Object(I)).forEach(function(H){Object.defineProperty(D,H,Object.getOwnPropertyDescriptor(I,H))})}return D}({},H,{depth:0,customInspect:!1}))}}]),D}()},{buffer:6,util:3}],75:[function(Y,Ae,he){(function(W){(function(){"use strict";function L(R,A){b(R,A),re(R)}function re(R){R._writableState&&!R._writableState.emitClose||R._readableState&&!R._readableState.emitClose||R.emit("close")}function b(R,A){R.emit("error",A)}Ae.exports={destroy:function(R,A){var v=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(A?A(R):R&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,W.nextTick(b,this,R)):W.nextTick(b,this,R)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(R||null,function(D){!A&&D?v._writableState?v._writableState.errorEmitted?W.nextTick(re,v):(v._writableState.errorEmitted=!0,W.nextTick(L,v,D)):W.nextTick(L,v,D):A?(W.nextTick(re,v),A(D)):W.nextTick(re,v)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(R,A){var v=R._readableState,y=R._writableState;v&&v.autoDestroy||y&&y.autoDestroy?R.destroy(A):R.emit("error",A)}}}).call(this)}).call(this,Y("_process"))},{_process:44}],76:[function(Y,Ae,he){"use strict";var W=Y("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function L(){}Ae.exports=function $(b,S,R){if("function"==typeof S)return $(b,null,S);S||(S={}),R=function(b){var S=!1;return function(){if(!S){S=!0;for(var R=arguments.length,A=new Array(R),v=0;v<R;v++)A[v]=arguments[v];b.apply(this,A)}}}(R||L);var A=S.readable||!1!==S.readable&&b.readable,v=S.writable||!1!==S.writable&&b.writable,y=function(){b.writable||D()},w=b._writableState&&b._writableState.finished,D=function(){v=!1,w=!0,A||R.call(b)},V=b._readableState&&b._readableState.endEmitted,I=function(){A=!1,V=!0,v||R.call(b)},H=function(Q){R.call(b,Q)},K=function(){var Q;return A&&!V?((!b._readableState||!b._readableState.ended)&&(Q=new W),R.call(b,Q)):v&&!w?((!b._writableState||!b._writableState.ended)&&(Q=new W),R.call(b,Q)):void 0},M=function(){b.req.on("finish",D)};return function(b){return b.setHeader&&"function"==typeof b.abort}(b)?(b.on("complete",D),b.on("abort",K),b.req?M():b.on("request",M)):v&&!b._writableState&&(b.on("end",y),b.on("close",y)),b.on("end",I),b.on("finish",D),!1!==S.error&&b.on("error",H),b.on("close",K),function(){b.removeListener("complete",D),b.removeListener("abort",K),b.removeListener("request",M),b.req&&b.req.removeListener("finish",D),b.removeListener("end",y),b.removeListener("close",y),b.removeListener("finish",D),b.removeListener("end",I),b.removeListener("error",H),b.removeListener("close",K)}}},{"../../../errors":67}],77:[function(Y,Ae,he){Ae.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(Y,Ae,he){"use strict";var W;var L=Y("../../../errors").codes,re=L.ERR_MISSING_ARGS,$=L.ERR_STREAM_DESTROYED;function b(D){if(D)throw D}function R(D,V,I,H){H=function(D){var V=!1;return function(){V||(V=!0,D.apply(void 0,arguments))}}(H);var K=!1;D.on("close",function(){K=!0}),void 0===W&&(W=Y("./end-of-stream")),W(D,{readable:V,writable:I},function(F){if(F)return H(F);K=!0,H()});var M=!1;return function(F){if(!K&&!M){if(M=!0,function(D){return D.setHeader&&"function"==typeof D.abort}(D))return D.abort();if("function"==typeof D.destroy)return D.destroy();H(F||new $("pipe"))}}}function A(D){D()}function v(D,V){return D.pipe(V)}function y(D){return D.length&&"function"==typeof D[D.length-1]?D.pop():b}Ae.exports=function(){for(var D=arguments.length,V=new Array(D),I=0;I<D;I++)V[I]=arguments[I];var H=y(V);if(Array.isArray(V[0])&&(V=V[0]),V.length<2)throw new re("streams");var K,M=V.map(function(F,Q){var E=Q<V.length-1;return R(F,E,Q>0,function(ie){K||(K=ie),ie&&M.forEach(A),!E&&(M.forEach(A),H(K))})});return V.reduce(v)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(Y,Ae,he){"use strict";var W=Y("../../../errors").codes.ERR_INVALID_OPT_VALUE;Ae.exports={getHighWaterMark:function(re,$,b,S){var R=function(re,$,b){return null!=re.highWaterMark?re.highWaterMark:$?re[b]:null}($,S,b);if(null!=R){if(!isFinite(R)||Math.floor(R)!==R||R<0)throw new W(S?b:"highWaterMark",R);return Math.floor(R)}return re.objectMode?16:16384}}},{"../../../errors":67}],80:[function(Y,Ae,he){Ae.exports=Y("events").EventEmitter},{events:8}],81:[function(Y,Ae,he){(he=Ae.exports=Y("./lib/_stream_readable.js")).Stream=he,he.Readable=he,he.Writable=Y("./lib/_stream_writable.js"),he.Duplex=Y("./lib/_stream_duplex.js"),he.Transform=Y("./lib/_stream_transform.js"),he.PassThrough=Y("./lib/_stream_passthrough.js"),he.finished=Y("./lib/internal/streams/end-of-stream.js"),he.pipeline=Y("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(Y,Ae,he){"use strict";Object.defineProperty(he,"__esModule",{value:!0}),function(j){for(var L in j)he.hasOwnProperty(L)||(he[L]=j[L])}(Y("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(Y,Ae,he){"use strict";function j($){const b=[];let S=0;for(;S<$.length;)switch($[S]){case"/":if("."===$[S+1])if("."===$[S+2]){if(!re($[S+3])){b.push([]),S++;break}b.pop(),$[S+3]||b.push([]),S+=3}else{if(!re($[S+2])){b.push([]),S++;break}$[S+2]||b.push([]),S+=2}else b.push([]),S++;break;case"#":case"?":b.length||b.push([]),b[b.length-1].push($.substr(S)),S=$.length;break;default:b.length||b.push([]),b[b.length-1].push($[S]),S++}return"/"+b.map(R=>R.join("")).join("/")}function L($,b){let S=b+1;b>=0?"/"===$[b+1]&&"/"===$[b+2]&&(S=b+3):"/"===$[0]&&"/"===$[1]&&(S=2);const R=$.indexOf("/",S);return R<0?$:$.substr(0,R)+j($.substr(R))}function re($){return!$||"#"===$||"?"===$||"/"===$}Object.defineProperty(he,"__esModule",{value:!0}),he.resolve=function($,b){const S=(b=b||"").indexOf("#");if(S>0&&(b=b.substr(0,S)),!$.length){if(b.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${b}' for value '${$}'`);return b}if($.startsWith("?")){const V=b.indexOf("?");return V>0&&(b=b.substr(0,V)),b+$}if($.startsWith("#"))return b+$;if(!b.length){const V=$.indexOf(":");if(V<0)throw new Error(`Found invalid relative IRI '${$}' for a missing baseIRI`);return L($,V)}const R=$.indexOf(":");if(R>=0)return L($,R);const A=b.indexOf(":");if(A<0)throw new Error(`Found invalid baseIRI '${b}' for value '${$}'`);const v=b.substr(0,A+1);if(0===$.indexOf("//"))return v+L($,R);let y;if(b.indexOf("//",A)===A+1){if(y=b.indexOf("/",A+3),y<0)return b.length>A+3?b+"/"+L($,R):v+L($,R)}else if(y=b.indexOf("/",A+1),y<0)return v+L($,R);if(0===$.indexOf("/"))return b.substr(0,y)+j($);let w=b.substr(y);const D=w.lastIndexOf("/");return D>=0&&D<w.length-1&&(w=w.substr(0,D+1),"."===$[0]&&"."!==$[1]&&"/"!==$[1]&&$[2]&&($=$.substr(1))),$=j($=w+$),b.substr(0,y)+$},he.removeDotSegments=j,he.removeDotSegmentsOfPath=L},{}],84:[function(Y,Ae,he){var W=Y("buffer"),j=W.Buffer;function L($,b){for(var S in $)b[S]=$[S]}function re($,b,S){return j($,b,S)}j.from&&j.alloc&&j.allocUnsafe&&j.allocUnsafeSlow?Ae.exports=W:(L(W,he),he.Buffer=re),re.prototype=Object.create(j.prototype),L(j,re),re.from=function($,b,S){if("number"==typeof $)throw new TypeError("Argument must not be a number");return j($,b,S)},re.alloc=function($,b,S){if("number"!=typeof $)throw new TypeError("Argument must be a number");var R=j($);return void 0!==b?"string"==typeof S?R.fill(b,S):R.fill(b):R.fill(0),R},re.allocUnsafe=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return j($)},re.allocUnsafeSlow=function($){if("number"!=typeof $)throw new TypeError("Argument must be a number");return W.SlowBuffer($)}},{buffer:6}],85:[function(Y,Ae,he){(function(W){(function(){!function(j){j.parser=function(z,X){return new re(z,X)},j.SAXParser=re,j.SAXStream=y,j.createStream=function(z,X){return new y(z,X)},j.MAX_BUFFER_LENGTH=65536;var R,L=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function re(z,X){if(!(this instanceof re))return new re(z,X);var be=this;(function(z){for(var X=0,be=L.length;X<be;X++)z[L[X]]=""})(be),be.q=be.c="",be.bufferCheckPosition=j.MAX_BUFFER_LENGTH,be.opt=X||{},be.opt.lowercase=be.opt.lowercase||be.opt.lowercasetags,be.looseCase=be.opt.lowercase?"toLowerCase":"toUpperCase",be.tags=[],be.closed=be.closedRoot=be.sawRoot=!1,be.tag=be.error=null,be.strict=!!z,be.noscript=!(!z&&!be.opt.noscript),be.state=se.BEGIN,be.strictEntities=be.opt.strictEntities,be.ENTITIES=Object.create(be.strictEntities?j.XML_ENTITIES:j.ENTITIES),be.attribList=[],be.opt.xmlns&&(be.ns=Object.create(H)),be.trackPosition=!1!==be.opt.position,be.trackPosition&&(be.position=be.line=be.column=0),ve(be,"onready")}j.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(z){function X(){}return X.prototype=z,new X}),Object.keys||(Object.keys=function(z){var X=[];for(var be in z)z.hasOwnProperty(be)&&X.push(be);return X}),re.prototype={end:function(){nt(this)},write:function(z){var X=this;if(this.error)throw this.error;if(X.closed)return je(X,"Cannot write after close. Assign an onready handler.");if(null===z)return nt(X);"object"==typeof z&&(z=z.toString());for(var be=0,ce="";ce=qe(z,be++),X.c=ce,ce;)switch(X.trackPosition&&(X.position++,"\n"===ce?(X.line++,X.column=0):X.column++),X.state){case se.BEGIN:if(X.state=se.BEGIN_WHITESPACE,"\ufeff"===ce)continue;Ue(X,ce);continue;case se.BEGIN_WHITESPACE:Ue(X,ce);continue;case se.TEXT:if(X.sawRoot&&!X.closedRoot){for(var Pe=be-1;ce&&"<"!==ce&&"&"!==ce;)(ce=qe(z,be++))&&X.trackPosition&&(X.position++,"\n"===ce?(X.line++,X.column=0):X.column++);X.textNode+=z.substring(Pe,be-1)}"<"!==ce||X.sawRoot&&X.closedRoot&&!X.strict?(!E(ce)&&(!X.sawRoot||X.closedRoot)&&Ze(X,"Text data outside of root node."),"&"===ce?X.state=se.TEXT_ENTITY:X.textNode+=ce):(X.state=se.OPEN_WAKA,X.startTagPosition=X.position);continue;case se.SCRIPT:"<"===ce?X.state=se.SCRIPT_ENDING:X.script+=ce;continue;case se.SCRIPT_ENDING:"/"===ce?X.state=se.CLOSE_TAG:(X.script+="<"+ce,X.state=se.SCRIPT);continue;case se.OPEN_WAKA:"!"===ce?(X.state=se.SGML_DECL,X.sgmlDecl=""):E(ce)||(ue(K,ce)?(X.state=se.OPEN_TAG,X.tagName=ce):"/"===ce?(X.state=se.CLOSE_TAG,X.tagName=""):"?"===ce?(X.state=se.PROC_INST,X.procInstName=X.procInstBody=""):(Ze(X,"Unencoded <"),X.startTagPosition+1<X.position&&(ce=new Array(X.position-X.startTagPosition).join(" ")+ce),X.textNode+="<"+ce,X.state=se.TEXT));continue;case se.SGML_DECL:"[CDATA["===(X.sgmlDecl+ce).toUpperCase()?(te(X,"onopencdata"),X.state=se.CDATA,X.sgmlDecl="",X.cdata=""):X.sgmlDecl+ce==="--"?(X.state=se.COMMENT,X.comment="",X.sgmlDecl=""):"DOCTYPE"===(X.sgmlDecl+ce).toUpperCase()?(X.state=se.DOCTYPE,(X.doctype||X.sawRoot)&&Ze(X,"Inappropriately located doctype declaration"),X.doctype="",X.sgmlDecl=""):">"===ce?(te(X,"onsgmldeclaration",X.sgmlDecl),X.sgmlDecl="",X.state=se.TEXT):(U(ce)&&(X.state=se.SGML_DECL_QUOTED),X.sgmlDecl+=ce);continue;case se.SGML_DECL_QUOTED:ce===X.q&&(X.state=se.SGML_DECL,X.q=""),X.sgmlDecl+=ce;continue;case se.DOCTYPE:">"===ce?(X.state=se.TEXT,te(X,"ondoctype",X.doctype),X.doctype=!0):(X.doctype+=ce,"["===ce?X.state=se.DOCTYPE_DTD:U(ce)&&(X.state=se.DOCTYPE_QUOTED,X.q=ce));continue;case se.DOCTYPE_QUOTED:X.doctype+=ce,ce===X.q&&(X.q="",X.state=se.DOCTYPE);continue;case se.DOCTYPE_DTD:X.doctype+=ce,"]"===ce?X.state=se.DOCTYPE:U(ce)&&(X.state=se.DOCTYPE_DTD_QUOTED,X.q=ce);continue;case se.DOCTYPE_DTD_QUOTED:X.doctype+=ce,ce===X.q&&(X.state=se.DOCTYPE_DTD,X.q="");continue;case se.COMMENT:"-"===ce?X.state=se.COMMENT_ENDING:X.comment+=ce;continue;case se.COMMENT_ENDING:"-"===ce?(X.state=se.COMMENT_ENDED,X.comment=Me(X.opt,X.comment),X.comment&&te(X,"oncomment",X.comment),X.comment=""):(X.comment+="-"+ce,X.state=se.COMMENT);continue;case se.COMMENT_ENDED:">"!==ce?(Ze(X,"Malformed comment"),X.comment+="--"+ce,X.state=se.COMMENT):X.state=se.TEXT;continue;case se.CDATA:"]"===ce?X.state=se.CDATA_ENDING:X.cdata+=ce;continue;case se.CDATA_ENDING:"]"===ce?X.state=se.CDATA_ENDING_2:(X.cdata+="]"+ce,X.state=se.CDATA);continue;case se.CDATA_ENDING_2:">"===ce?(X.cdata&&te(X,"oncdata",X.cdata),te(X,"onclosecdata"),X.cdata="",X.state=se.TEXT):"]"===ce?X.cdata+="]":(X.cdata+="]]"+ce,X.state=se.CDATA);continue;case se.PROC_INST:"?"===ce?X.state=se.PROC_INST_ENDING:E(ce)?X.state=se.PROC_INST_BODY:X.procInstName+=ce;continue;case se.PROC_INST_BODY:if(!X.procInstBody&&E(ce))continue;"?"===ce?X.state=se.PROC_INST_ENDING:X.procInstBody+=ce;continue;case se.PROC_INST_ENDING:">"===ce?(te(X,"onprocessinginstruction",{name:X.procInstName,body:X.procInstBody}),X.procInstName=X.procInstBody="",X.state=se.TEXT):(X.procInstBody+="?"+ce,X.state=se.PROC_INST_BODY);continue;case se.OPEN_TAG:ue(M,ce)?X.tagName+=ce:(Je(X),">"===ce?Le(X):"/"===ce?X.state=se.OPEN_TAG_SLASH:(E(ce)||Ze(X,"Invalid character in tag name"),X.state=se.ATTRIB));continue;case se.OPEN_TAG_SLASH:">"===ce?(Le(X,!0),Ee(X)):(Ze(X,"Forward-slash in opening tag not followed by >"),X.state=se.ATTRIB);continue;case se.ATTRIB:if(E(ce))continue;">"===ce?Le(X):"/"===ce?X.state=se.OPEN_TAG_SLASH:ue(K,ce)?(X.attribName=ce,X.attribValue="",X.state=se.ATTRIB_NAME):Ze(X,"Invalid attribute name");continue;case se.ATTRIB_NAME:"="===ce?X.state=se.ATTRIB_VALUE:">"===ce?(Ze(X,"Attribute without value"),X.attribValue=X.attribName,Ve(X),Le(X)):E(ce)?X.state=se.ATTRIB_NAME_SAW_WHITE:ue(M,ce)?X.attribName+=ce:Ze(X,"Invalid attribute name");continue;case se.ATTRIB_NAME_SAW_WHITE:if("="===ce)X.state=se.ATTRIB_VALUE;else{if(E(ce))continue;Ze(X,"Attribute without value"),X.tag.attributes[X.attribName]="",X.attribValue="",te(X,"onattribute",{name:X.attribName,value:""}),X.attribName="",">"===ce?Le(X):ue(K,ce)?(X.attribName=ce,X.state=se.ATTRIB_NAME):(Ze(X,"Invalid attribute name"),X.state=se.ATTRIB)}continue;case se.ATTRIB_VALUE:if(E(ce))continue;U(ce)?(X.q=ce,X.state=se.ATTRIB_VALUE_QUOTED):(Ze(X,"Unquoted attribute value"),X.state=se.ATTRIB_VALUE_UNQUOTED,X.attribValue=ce);continue;case se.ATTRIB_VALUE_QUOTED:if(ce!==X.q){"&"===ce?X.state=se.ATTRIB_VALUE_ENTITY_Q:X.attribValue+=ce;continue}Ve(X),X.q="",X.state=se.ATTRIB_VALUE_CLOSED;continue;case se.ATTRIB_VALUE_CLOSED:E(ce)?X.state=se.ATTRIB:">"===ce?Le(X):"/"===ce?X.state=se.OPEN_TAG_SLASH:ue(K,ce)?(Ze(X,"No whitespace between attributes"),X.attribName=ce,X.attribValue="",X.state=se.ATTRIB_NAME):Ze(X,"Invalid attribute name");continue;case se.ATTRIB_VALUE_UNQUOTED:if(!ie(ce)){"&"===ce?X.state=se.ATTRIB_VALUE_ENTITY_U:X.attribValue+=ce;continue}Ve(X),">"===ce?Le(X):X.state=se.ATTRIB;continue;case se.CLOSE_TAG:if(X.tagName)">"===ce?Ee(X):ue(M,ce)?X.tagName+=ce:X.script?(X.script+="</"+X.tagName,X.tagName="",X.state=se.SCRIPT):(E(ce)||Ze(X,"Invalid tagname in closing tag"),X.state=se.CLOSE_TAG_SAW_WHITE);else{if(E(ce))continue;ee(K,ce)?X.script?(X.script+="</"+ce,X.state=se.SCRIPT):Ze(X,"Invalid tagname in closing tag."):X.tagName=ce}continue;case se.CLOSE_TAG_SAW_WHITE:if(E(ce))continue;">"===ce?Ee(X):Ze(X,"Invalid characters in closing tag");continue;case se.TEXT_ENTITY:case se.ATTRIB_VALUE_ENTITY_Q:case se.ATTRIB_VALUE_ENTITY_U:var pt,pe;switch(X.state){case se.TEXT_ENTITY:pt=se.TEXT,pe="textNode";break;case se.ATTRIB_VALUE_ENTITY_Q:pt=se.ATTRIB_VALUE_QUOTED,pe="attribValue";break;case se.ATTRIB_VALUE_ENTITY_U:pt=se.ATTRIB_VALUE_UNQUOTED,pe="attribValue"}";"===ce?(X[pe]+=Ie(X),X.entity="",X.state=pt):ue(X.entity.length?Q:F,ce)?X.entity+=ce:(Ze(X,"Invalid character in entity name"),X[pe]+="&"+X.entity+ce,X.entity="",X.state=pt);continue;default:throw new Error(X,"Unknown state: "+X.state)}return X.position>=X.bufferCheckPosition&&function(z){for(var X=Math.max(j.MAX_BUFFER_LENGTH,10),be=0,ce=0,Pe=L.length;ce<Pe;ce++){var wt=z[L[ce]].length;if(wt>X)switch(L[ce]){case"textNode":_e(z);break;case"cdata":te(z,"oncdata",z.cdata),z.cdata="";break;case"script":te(z,"onscript",z.script),z.script="";break;default:je(z,"Max buffer length exceeded: "+L[ce])}be=Math.max(be,wt)}z.bufferCheckPosition=j.MAX_BUFFER_LENGTH-be+z.position}(X),X},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(z){_e(z),""!==z.cdata&&(te(z,"oncdata",z.cdata),z.cdata=""),""!==z.script&&(te(z,"onscript",z.script),z.script="")}(this)}};try{R=Y("stream").Stream}catch(z){R=function(){}}var A=j.EVENTS.filter(function(z){return"error"!==z&&"end"!==z});function y(z,X){if(!(this instanceof y))return new y(z,X);R.apply(this),this._parser=new re(z,X),this.writable=!0,this.readable=!0;var be=this;this._parser.onend=function(){be.emit("end")},this._parser.onerror=function(ce){be.emit("error",ce),be._parser.error=null},this._decoder=null,A.forEach(function(ce){Object.defineProperty(be,"on"+ce,{get:function(){return be._parser["on"+ce]},set:function(Pe){if(!Pe)return be.removeAllListeners(ce),be._parser["on"+ce]=Pe,Pe;be.on(ce,Pe)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(R.prototype,{constructor:{value:y}})).write=function(z){if("function"==typeof W&&"function"==typeof W.isBuffer&&W.isBuffer(z)){if(!this._decoder){var X=Y("string_decoder").StringDecoder;this._decoder=new X("utf8")}z=this._decoder.write(z)}return this._parser.write(z.toString()),this.emit("data",z),!0},y.prototype.end=function(z){return z&&z.length&&this.write(z),this._parser.end(),!0},y.prototype.on=function(z,X){var be=this;return!be._parser["on"+z]&&-1!==A.indexOf(z)&&(be._parser["on"+z]=function(){var ce=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);ce.splice(0,0,z),be.emit.apply(be,ce)}),R.prototype.on.call(be,z,X)};var V="http://www.w3.org/XML/1998/namespace",I="http://www.w3.org/2000/xmlns/",H={xml:V,xmlns:I},K=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,M=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,F=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Q=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function E(z){return" "===z||"\n"===z||"\r"===z||"\t"===z}function U(z){return'"'===z||"'"===z}function ie(z){return">"===z||E(z)}function ue(z,X){return z.test(X)}function ee(z,X){return!ue(z,X)}var z,X,be,se=0;for(var Te in j.STATE={BEGIN:se++,BEGIN_WHITESPACE:se++,TEXT:se++,TEXT_ENTITY:se++,OPEN_WAKA:se++,SGML_DECL:se++,SGML_DECL_QUOTED:se++,DOCTYPE:se++,DOCTYPE_QUOTED:se++,DOCTYPE_DTD:se++,DOCTYPE_DTD_QUOTED:se++,COMMENT_STARTING:se++,COMMENT:se++,COMMENT_ENDING:se++,COMMENT_ENDED:se++,CDATA:se++,CDATA_ENDING:se++,CDATA_ENDING_2:se++,PROC_INST:se++,PROC_INST_BODY:se++,PROC_INST_ENDING:se++,OPEN_TAG:se++,OPEN_TAG_SLASH:se++,ATTRIB:se++,ATTRIB_NAME:se++,ATTRIB_NAME_SAW_WHITE:se++,ATTRIB_VALUE:se++,ATTRIB_VALUE_QUOTED:se++,ATTRIB_VALUE_CLOSED:se++,ATTRIB_VALUE_UNQUOTED:se++,ATTRIB_VALUE_ENTITY_Q:se++,ATTRIB_VALUE_ENTITY_U:se++,CLOSE_TAG:se++,CLOSE_TAG_SAW_WHITE:se++,SCRIPT:se++,SCRIPT_ENDING:se++},j.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},j.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(j.ENTITIES).forEach(function(z){var X=j.ENTITIES[z],be="number"==typeof X?String.fromCharCode(X):X;j.ENTITIES[z]=be}),j.STATE)j.STATE[j.STATE[Te]]=Te;function ve(z,X,be){z[X]&&z[X](be)}function te(z,X,be){z.textNode&&_e(z),ve(z,X,be)}function _e(z){z.textNode=Me(z.opt,z.textNode),z.textNode&&ve(z,"ontext",z.textNode),z.textNode=""}function Me(z,X){return z.trim&&(X=X.trim()),z.normalize&&(X=X.replace(/\s+/g," ")),X}function je(z,X){return _e(z),z.trackPosition&&(X+="\nLine: "+z.line+"\nColumn: "+z.column+"\nChar: "+z.c),X=new Error(X),z.error=X,ve(z,"onerror",X),z}function nt(z){return z.sawRoot&&!z.closedRoot&&Ze(z,"Unclosed root tag"),z.state!==se.BEGIN&&z.state!==se.BEGIN_WHITESPACE&&z.state!==se.TEXT&&je(z,"Unexpected end"),_e(z),z.c="",z.closed=!0,ve(z,"onend"),re.call(z,z.strict,z.opt),z}function Ze(z,X){if("object"!=typeof z||!(z instanceof re))throw new Error("bad call to strictFail");z.strict&&je(z,X)}function Je(z){z.strict||(z.tagName=z.tagName[z.looseCase]());var X=z.tags[z.tags.length-1]||z,be=z.tag={name:z.tagName,attributes:{}};z.opt.xmlns&&(be.ns=X.ns),z.attribList.length=0,te(z,"onopentagstart",be)}function Ke(z,X){var ce=z.indexOf(":")<0?["",z]:z.split(":"),Pe=ce[0],wt=ce[1];return X&&"xmlns"===z&&(Pe="xmlns",wt=""),{prefix:Pe,local:wt}}function Ve(z){if(z.strict||(z.attribName=z.attribName[z.looseCase]()),-1!==z.attribList.indexOf(z.attribName)||z.tag.attributes.hasOwnProperty(z.attribName))z.attribName=z.attribValue="";else{if(z.opt.xmlns){var X=Ke(z.attribName,!0),ce=X.local;if("xmlns"===X.prefix)if("xml"===ce&&z.attribValue!==V)Ze(z,"xml: prefix must be bound to "+V+"\nActual: "+z.attribValue);else if("xmlns"===ce&&z.attribValue!==I)Ze(z,"xmlns: prefix must be bound to "+I+"\nActual: "+z.attribValue);else{var Pe=z.tag,wt=z.tags[z.tags.length-1]||z;Pe.ns===wt.ns&&(Pe.ns=Object.create(wt.ns)),Pe.ns[ce]=z.attribValue}z.attribList.push([z.attribName,z.attribValue])}else z.tag.attributes[z.attribName]=z.attribValue,te(z,"onattribute",{name:z.attribName,value:z.attribValue});z.attribName=z.attribValue=""}}function Le(z,X){if(z.opt.xmlns){var be=z.tag,ce=Ke(z.tagName);be.prefix=ce.prefix,be.local=ce.local,be.uri=be.ns[ce.prefix]||"",be.prefix&&!be.uri&&(Ze(z,"Unbound namespace prefix: "+JSON.stringify(z.tagName)),be.uri=ce.prefix),be.ns&&(z.tags[z.tags.length-1]||z).ns!==be.ns&&Object.keys(be.ns).forEach(function(An){te(z,"onopennamespace",{prefix:An,uri:be.ns[An]})});for(var wt=0,pt=z.attribList.length;wt<pt;wt++){var pe=z.attribList[wt],B=pe[0],O=pe[1],k=Ke(B,!0),Oe=k.prefix,yt=""===Oe?"":be.ns[Oe]||"",It={name:B,value:O,prefix:Oe,local:k.local,uri:yt};Oe&&"xmlns"!==Oe&&!yt&&(Ze(z,"Unbound namespace prefix: "+JSON.stringify(Oe)),It.uri=Oe),z.tag.attributes[B]=It,te(z,"onattribute",It)}z.attribList.length=0}z.tag.isSelfClosing=!!X,z.sawRoot=!0,z.tags.push(z.tag),te(z,"onopentag",z.tag),X||(z.state=z.noscript||"script"!==z.tagName.toLowerCase()?se.TEXT:se.SCRIPT,z.tag=null,z.tagName=""),z.attribName=z.attribValue="",z.attribList.length=0}function Ee(z){if(!z.tagName)return Ze(z,"Weird empty close tag."),z.textNode+="</>",void(z.state=se.TEXT);if(z.script){if("script"!==z.tagName)return z.script+="</"+z.tagName+">",z.tagName="",void(z.state=se.SCRIPT);te(z,"onscript",z.script),z.script=""}var X=z.tags.length,be=z.tagName;z.strict||(be=be[z.looseCase]());for(var ce=be;X--&&z.tags[X].name!==ce;)Ze(z,"Unexpected close tag");if(X<0)return Ze(z,"Unmatched closing tag: "+z.tagName),z.textNode+="</"+z.tagName+">",void(z.state=se.TEXT);z.tagName=be;for(var wt=z.tags.length;wt-- >X;){var pt=z.tag=z.tags.pop();z.tagName=z.tag.name,te(z,"onclosetag",z.tagName);var pe={};for(var B in pt.ns)pe[B]=pt.ns[B];z.opt.xmlns&&pt.ns!==(z.tags[z.tags.length-1]||z).ns&&Object.keys(pt.ns).forEach(function(k){te(z,"onclosenamespace",{prefix:k,uri:pt.ns[k]})})}0===X&&(z.closedRoot=!0),z.tagName=z.attribValue=z.attribName="",z.attribList.length=0,z.state=se.TEXT}function Ie(z){var ce,X=z.entity,be=X.toLowerCase(),Pe="";return z.ENTITIES[X]?z.ENTITIES[X]:z.ENTITIES[be]?z.ENTITIES[be]:("#"===(X=be).charAt(0)&&("x"===X.charAt(1)?(X=X.slice(2),Pe=(ce=parseInt(X,16)).toString(16)):(X=X.slice(1),Pe=(ce=parseInt(X,10)).toString(10))),X=X.replace(/^0+/,""),isNaN(ce)||Pe.toLowerCase()!==X?(Ze(z,"Invalid character entity"),"&"+z.entity+";"):String.fromCodePoint(ce))}function Ue(z,X){"<"===X?(z.state=se.OPEN_WAKA,z.startTagPosition=z.position):E(X)||(Ze(z,"Non-whitespace before first tag."),z.textNode=X,z.state=se.TEXT)}function qe(z,X){var be="";return X<z.length&&(be=z.charAt(X)),be}se=j.STATE,String.fromCodePoint||(z=String.fromCharCode,X=Math.floor,be=function(){var ce=16384,Pe=[],pe=-1,B=arguments.length;if(!B)return"";for(var O="";++pe<B;){var k=Number(arguments[pe]);if(!isFinite(k)||k<0||k>1114111||X(k)!==k)throw RangeError("Invalid code point: "+k);k<=65535?Pe.push(k):Pe.push(55296+((k-=65536)>>10),k%1024+56320),(pe+1===B||Pe.length>ce)&&(O+=z.apply(null,Pe),Pe.length=0)}return O},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:be,configurable:!0,writable:!0}):String.fromCodePoint=be)}(void 0===he?this.sax={}:he)}).call(this)}).call(this,Y("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(Y,Ae,he){(function(W,j){(function(){!function(L,re){"use strict";if(!L.setImmediate){var A,$=1,b={},S=!1,R=L.document,Q=Object.getPrototypeOf&&Object.getPrototypeOf(L);Q=Q&&Q.setTimeout?Q:L,"[object process]"==={}.toString.call(L.process)?A=function(E){W.nextTick(function(){D(E)})}:function(){if(L.postMessage&&!L.importScripts){var E=!0,U=L.onmessage;return L.onmessage=function(){E=!1},L.postMessage("","*"),L.onmessage=U,E}}()?(E="setImmediate$"+Math.random()+"$",U=function(ie){ie.source===L&&"string"==typeof ie.data&&0===ie.data.indexOf(E)&&D(+ie.data.slice(E.length))},L.addEventListener?L.addEventListener("message",U,!1):L.attachEvent("onmessage",U),A=function(ie){L.postMessage(E+ie,"*")}):L.MessageChannel?function(){var E=new MessageChannel;E.port1.onmessage=function(U){D(U.data)},A=function(U){E.port2.postMessage(U)}}():R&&"onreadystatechange"in R.createElement("script")?function(){var E=R.documentElement;A=function(U){var ie=R.createElement("script");ie.onreadystatechange=function(){D(U),ie.onreadystatechange=null,E.removeChild(ie),ie=null},E.appendChild(ie)}}():A=function(E){setTimeout(D,0,E)},Q.setImmediate=function(E){"function"!=typeof E&&(E=new Function(""+E));for(var U=new Array(arguments.length-1),ie=0;ie<U.length;ie++)U[ie]=arguments[ie+1];return b[$]={callback:E,args:U},A($),$++},Q.clearImmediate=y}var E,U;function y(E){delete b[E]}function D(E){if(S)setTimeout(D,0,E);else{var U=b[E];if(U){S=!0;try{!function(E){var U=E.callback,ie=E.args;switch(ie.length){case 0:U();break;case 1:U(ie[0]);break;case 2:U(ie[0],ie[1]);break;case 3:U(ie[0],ie[1],ie[2]);break;default:U.apply(void 0,ie)}}(U)}finally{y(E),S=!1}}}}}("undefined"==typeof self?void 0===j?this:j:self)}).call(this)}).call(this,Y("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(Y,Ae,he){Ae.exports=L;var W=Y("events").EventEmitter;function L(){W.call(this)}Y("inherits")(L,W),L.Readable=Y("readable-stream/lib/_stream_readable.js"),L.Writable=Y("readable-stream/lib/_stream_writable.js"),L.Duplex=Y("readable-stream/lib/_stream_duplex.js"),L.Transform=Y("readable-stream/lib/_stream_transform.js"),L.PassThrough=Y("readable-stream/lib/_stream_passthrough.js"),L.finished=Y("readable-stream/lib/internal/streams/end-of-stream.js"),L.pipeline=Y("readable-stream/lib/internal/streams/pipeline.js"),L.Stream=L,L.prototype.pipe=function(re,$){var b=this;function S(V){re.writable&&!1===re.write(V)&&b.pause&&b.pause()}function R(){b.readable&&b.resume&&b.resume()}b.on("data",S),re.on("drain",R),!re._isStdio&&(!$||!1!==$.end)&&(b.on("end",v),b.on("close",y));var A=!1;function v(){A||(A=!0,re.end())}function y(){A||(A=!0,"function"==typeof re.destroy&&re.destroy())}function w(V){if(D(),0===W.listenerCount(this,"error"))throw V}function D(){b.removeListener("data",S),re.removeListener("drain",R),b.removeListener("end",v),b.removeListener("close",y),b.removeListener("error",w),re.removeListener("error",w),b.removeListener("end",D),b.removeListener("close",D),re.removeListener("close",D)}return b.on("error",w),re.on("error",w),b.on("end",D),b.on("close",D),re.on("close",D),re.emit("pipe",b),re}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(Y,Ae,he){arguments[4][5][0].apply(he,arguments)},{dup:5,"safe-buffer":84}],89:[function(Y,Ae,he){(function(W,j){(function(){var L=Y("process/browser.js").nextTick,re=Function.prototype.apply,$=Array.prototype.slice,b={},S=0;function R(A,v){this._id=A,this._clearFn=v}he.setTimeout=function(){return new R(re.call(setTimeout,window,arguments),clearTimeout)},he.setInterval=function(){return new R(re.call(setInterval,window,arguments),clearInterval)},he.clearTimeout=he.clearInterval=function(A){A.close()},R.prototype.unref=R.prototype.ref=function(){},R.prototype.close=function(){this._clearFn.call(window,this._id)},he.enroll=function(A,v){clearTimeout(A._idleTimeoutId),A._idleTimeout=v},he.unenroll=function(A){clearTimeout(A._idleTimeoutId),A._idleTimeout=-1},he._unrefActive=he.active=function(A){clearTimeout(A._idleTimeoutId);var v=A._idleTimeout;v>=0&&(A._idleTimeoutId=setTimeout(function(){A._onTimeout&&A._onTimeout()},v))},he.setImmediate="function"==typeof W?W:function(A){var v=S++,y=!(arguments.length<2)&&$.call(arguments,1);return b[v]=!0,L(function(){b[v]&&(y?A.apply(null,y):A.call(null),he.clearImmediate(v))}),v},he.clearImmediate="function"==typeof j?j:function(A){delete b[A]}}).call(this)}).call(this,Y("timers").setImmediate,Y("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(Y,Ae,he){(function(W){(function(){function L(re){try{if(!W.localStorage)return!1}catch(b){return!1}var $=W.localStorage[re];return null!=$&&"true"===String($).toLowerCase()}Ae.exports=function(re,$){if(L("noDeprecation"))return re;var b=!1;return function(){if(!b){if(L("throwDeprecation"))throw new Error($);L("traceDeprecation")?console.trace($):console.warn($),b=!0}return re.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(Y,Ae,he){"use strict";Ae.exports=function(W){W.prototype[Symbol.iterator]=function*(){for(let j=this.head;j;j=j.next)yield j.value}}},{}],92:[function(Y,Ae,he){"use strict";function W(b){var S=this;if(S instanceof W||(S=new W),S.tail=null,S.head=null,S.length=0,b&&"function"==typeof b.forEach)b.forEach(function(v){S.push(v)});else if(arguments.length>0)for(var R=0,A=arguments.length;R<A;R++)S.push(arguments[R]);return S}function j(b,S,R){var A=S===b.head?new $(R,null,S,b):new $(R,S,S.next,b);return null===A.next&&(b.tail=A),null===A.prev&&(b.head=A),b.length++,A}function L(b,S){b.tail=new $(S,b.tail,null,b),b.head||(b.head=b.tail),b.length++}function re(b,S){b.head=new $(S,null,b.head,b),b.tail||(b.tail=b.head),b.length++}function $(b,S,R,A){if(!(this instanceof $))return new $(b,S,R,A);this.list=A,this.value=b,S?(S.next=this,this.prev=S):this.prev=null,R?(R.prev=this,this.next=R):this.next=null}Ae.exports=W,W.Node=$,W.create=W,W.prototype.removeNode=function(b){if(b.list!==this)throw new Error("removing node which does not belong to this list");var S=b.next,R=b.prev;return S&&(S.prev=R),R&&(R.next=S),b===this.head&&(this.head=S),b===this.tail&&(this.tail=R),b.list.length--,b.next=null,b.prev=null,b.list=null,S},W.prototype.unshiftNode=function(b){if(b!==this.head){b.list&&b.list.removeNode(b);var S=this.head;b.list=this,b.next=S,S&&(S.prev=b),this.head=b,this.tail||(this.tail=b),this.length++}},W.prototype.pushNode=function(b){if(b!==this.tail){b.list&&b.list.removeNode(b);var S=this.tail;b.list=this,b.prev=S,S&&(S.next=b),this.tail=b,this.head||(this.head=b),this.length++}},W.prototype.push=function(){for(var b=0,S=arguments.length;b<S;b++)L(this,arguments[b]);return this.length},W.prototype.unshift=function(){for(var b=0,S=arguments.length;b<S;b++)re(this,arguments[b]);return this.length},W.prototype.pop=function(){if(this.tail){var b=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,b}},W.prototype.shift=function(){if(this.head){var b=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,b}},W.prototype.forEach=function(b,S){S=S||this;for(var R=this.head,A=0;null!==R;A++)b.call(S,R.value,A,this),R=R.next},W.prototype.forEachReverse=function(b,S){S=S||this;for(var R=this.tail,A=this.length-1;null!==R;A--)b.call(S,R.value,A,this),R=R.prev},W.prototype.get=function(b){for(var S=0,R=this.head;null!==R&&S<b;S++)R=R.next;if(S===b&&null!==R)return R.value},W.prototype.getReverse=function(b){for(var S=0,R=this.tail;null!==R&&S<b;S++)R=R.prev;if(S===b&&null!==R)return R.value},W.prototype.map=function(b,S){S=S||this;for(var R=new W,A=this.head;null!==A;)R.push(b.call(S,A.value,this)),A=A.next;return R},W.prototype.mapReverse=function(b,S){S=S||this;for(var R=new W,A=this.tail;null!==A;)R.push(b.call(S,A.value,this)),A=A.prev;return R},W.prototype.reduce=function(b,S){var R,A=this.head;if(arguments.length>1)R=S;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");A=this.head.next,R=this.head.value}for(var v=0;null!==A;v++)R=b(R,A.value,v),A=A.next;return R},W.prototype.reduceReverse=function(b,S){var R,A=this.tail;if(arguments.length>1)R=S;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");A=this.tail.prev,R=this.tail.value}for(var v=this.length-1;null!==A;v--)R=b(R,A.value,v),A=A.prev;return R},W.prototype.toArray=function(){for(var b=new Array(this.length),S=0,R=this.head;null!==R;S++)b[S]=R.value,R=R.next;return b},W.prototype.toArrayReverse=function(){for(var b=new Array(this.length),S=0,R=this.tail;null!==R;S++)b[S]=R.value,R=R.prev;return b},W.prototype.slice=function(b,S){(S=S||this.length)<0&&(S+=this.length),(b=b||0)<0&&(b+=this.length);var R=new W;if(S<b||S<0)return R;b<0&&(b=0),S>this.length&&(S=this.length);for(var A=0,v=this.head;null!==v&&A<b;A++)v=v.next;for(;null!==v&&A<S;A++,v=v.next)R.push(v.value);return R},W.prototype.sliceReverse=function(b,S){(S=S||this.length)<0&&(S+=this.length),(b=b||0)<0&&(b+=this.length);var R=new W;if(S<b||S<0)return R;b<0&&(b=0),S>this.length&&(S=this.length);for(var A=this.length,v=this.tail;null!==v&&A>S;A--)v=v.prev;for(;null!==v&&A>b;A--,v=v.prev)R.push(v.value);return R},W.prototype.splice=function(b,S,...R){b>this.length&&(b=this.length-1),b<0&&(b=this.length+b);for(var A=0,v=this.head;null!==v&&A<b;A++)v=v.next;var y=[];for(A=0;v&&A<S;A++)y.push(v.value),v=this.removeNode(v);for(null===v&&(v=this.tail),v!==this.head&&v!==this.tail&&(v=v.prev),A=0;A<R.length;A++)v=j(this,v,R[A]);return y},W.prototype.reverse=function(){for(var b=this.head,S=this.tail,R=b;null!==R;R=R.prev){var A=R.prev;R.prev=R.next,R.next=A}return this.head=S,this.tail=b,this};try{Y("./iterator.js")(W)}catch(b){}},{"./iterator.js":91}]},{},[1])(1)},322:Vt=>{Vt.exports=function(tt,gt){var J=gt.length;if(0!==J){var xt=tt.length;tt.length+=J;for(var ut=0;ut<J;ut++)tt[xt+ut]=gt[ut]}}},517:(Vt,it)=>{"use strict";var gt=(()=>{return(xt=gt||(gt={})).typeOfFunction="function",xt.boolTrue=!0,gt;var xt})();function J(xt,ut,Y){if(!Y||typeof Y.value!==gt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+ut+"> is not a method!");return{configurable:gt.boolTrue,get:function(){var Ae=Y.value.bind(this);return Object.defineProperty(this,ut,{value:Ae,configurable:gt.boolTrue,writable:gt.boolTrue}),Ae}}}it.ak=J,it.ZP=J},266:(Vt,it,tt)=>{Vt.exports={ResizeSensor:tt(835),ElementQueries:tt(845)}},845:function(Vt,it,tt){"use strict";var gt,J,xt;"undefined"!=typeof window&&window,J=[tt(835)],void 0!==(xt="function"==typeof(gt=function(ut){var Y=function(){var he,W={},j=[];function L(M){M||(M=document.documentElement);var F=window.getComputedStyle(M,null).fontSize;return parseFloat(F)||16}function $(M,F){var Q=F.split(/\d/),E=Q[Q.length-1];switch(F=parseFloat(F),E){case"px":return F;case"em":return F*L(M);case"rem":return F*L();case"vw":return F*document.documentElement.clientWidth/100;case"vh":return F*document.documentElement.clientHeight/100;case"vmin":case"vmax":var U=document.documentElement.clientWidth/100,ie=document.documentElement.clientHeight/100;return F*(0,Math["vmin"===E?"min":"max"])(U,ie);default:return F}}function b(M,F){this.element=M;var Q,E,U,ie,ue,ee,se,Te,ve=["min-width","min-height","max-width","max-height"];this.call=function(){for(Q in U=function(M){if(!M.getBoundingClientRect)return{width:M.offsetWidth,height:M.offsetHeight};var F=M.getBoundingClientRect();return{width:Math.round(F.width),height:Math.round(F.height)}}(this.element),ee={},W[F])!W[F].hasOwnProperty(Q)||(ie=$(this.element,(E=W[F][Q]).value),ue="width"===E.property?U.width:U.height,se="","min"===E.mode&&ue>=ie&&(se+=E.value),"max"===E.mode&&ue<=ie&&(se+=E.value),ee[Te=E.mode+"-"+E.property]||(ee[Te]=""),se&&-1===(" "+ee[Te]+" ").indexOf(" "+se+" ")&&(ee[Te]+=" "+se));for(var te in ve)!ve.hasOwnProperty(te)||(ee[ve[te]]?this.element.setAttribute(ve[te],ee[ve[te]].substr(1)):this.element.removeAttribute(ve[te]))}}function S(M,F){M.elementQueriesSetupInformation||(M.elementQueriesSetupInformation=new b(M,F)),M.elementQueriesSensor||(M.elementQueriesSensor=new ut(M,function(){M.elementQueriesSetupInformation.call()}))}function R(M,F,Q,E){if(void 0===W[M]){W[M]=[];var U=j.length;he.innerHTML+="\n"+M+" {animation: 0.1s element-queries;}",he.innerHTML+="\n"+M+" > .resize-sensor {min-width: "+U+"px;}",j.push(M)}W[M].push({mode:F,property:Q,value:E})}function A(M){var F;if(document.querySelectorAll&&(F=M?M.querySelectorAll.bind(M):document.querySelectorAll.bind(document)),!F&&"undefined"!=typeof $$&&(F=$$),!F&&"undefined"!=typeof jQuery&&(F=jQuery),!F)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return F}function y(M){var F=[],Q=[],E=[],U=0,ie=-1,ue=[];for(var ee in M.children)if(M.children.hasOwnProperty(ee)&&M.children[ee].tagName&&"img"===M.children[ee].tagName.toLowerCase()){F.push(M.children[ee]);var se=M.children[ee].getAttribute("min-width")||M.children[ee].getAttribute("data-min-width"),Te=M.children[ee].getAttribute("data-src")||M.children[ee].getAttribute("url");E.push(Te),Q.push({minWidth:se}),se?M.children[ee].style.display="none":(U=F.length-1,M.children[ee].style.display="block")}function te(){var Me,_e=!1;for(Me in F)!F.hasOwnProperty(Me)||Q[Me].minWidth&&M.offsetWidth>Q[Me].minWidth&&(_e=Me);if(_e||(_e=U),ie!==_e)if(ue[_e])F[ie].style.display="none",F[_e].style.display="block",ie=_e;else{var je=new Image;je.onload=function(){F[_e].src=E[_e],F[ie].style.display="none",F[_e].style.display="block",ue[_e]=!0,ie=_e},je.src=E[_e]}else F[_e].src=E[_e]}ie=U,M.resizeSensorInstance=new ut(M,te),te()}var D=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,V=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function I(M){var F,Q,E,U;for(M=M.replace(/'/g,'"');null!==(F=D.exec(M));)for(Q=F[1]+F[3],E=F[2];null!==(U=V.exec(E));)R(Q,U[1],U[2],U[3])}function H(M){var F="";if(M)if("string"==typeof M)(-1!==(M=M.toLowerCase()).indexOf("min-width")||-1!==M.indexOf("max-width"))&&I(M);else for(var Q=0,E=M.length;Q<E;Q++)1===M[Q].type?(-1!==(F=M[Q].selectorText||M[Q].cssText).indexOf("min-height")||-1!==F.indexOf("max-height")||-1!==F.indexOf("min-width")||-1!==F.indexOf("max-width"))&&I(F):4===M[Q].type?H(M[Q].cssRules||M[Q].rules):3===M[Q].type&&M[Q].styleSheet.hasOwnProperty("cssRules")&&H(M[Q].styleSheet.cssRules)}var K=!1;this.init=function(){var M="animationstart";void 0!==document.documentElement.style.webkitAnimationName?M="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?M="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(M="oanimationstart"),document.body.addEventListener(M,function(E){var U=E.target,ie=U&&window.getComputedStyle(U,null),ue=ie&&ie.getPropertyValue("animation-name");if(ue&&-1!==ue.indexOf("element-queries")){U.elementQueriesSensor=new ut(U,function(){U.elementQueriesSetupInformation&&U.elementQueriesSetupInformation.call()});var Te=window.getComputedStyle(U.resizeSensor,null).getPropertyValue("min-width");Te=parseInt(Te.replace("px","")),S(E.target,j[Te])}}),K||((he=document.createElement("style")).type="text/css",he.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",he.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(he),K=!0);for(var F=0,Q=document.styleSheets.length;F<Q;F++)try{document.styleSheets[F].href&&0===document.styleSheets[F].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[F].href),H(document.styleSheets[F].cssRules||document.styleSheets[F].rules||document.styleSheets[F].cssText)}catch(E){}!function(){for(var F=A()("[data-responsive-image],[responsive-image]"),Q=0,E=F.length;Q<E;Q++)y(F[Q])}()},this.findElementQueriesElements=function(M){!function(M){var F=A(M);for(var Q in W)if(W.hasOwnProperty(Q))for(var E=F(Q,M),U=0,ie=E.length;U<ie;U++)S(E[U],Q)}(M)},this.update=function(){this.init()}};Y.update=function(){Y.instance.update()},Y.detach=function(he){he.elementQueriesSetupInformation?(he.elementQueriesSensor.detach(),delete he.elementQueriesSetupInformation,delete he.elementQueriesSensor):he.resizeSensorInstance&&(he.resizeSensorInstance.detach(),delete he.resizeSensorInstance)},Y.init=function(){Y.instance||(Y.instance=new Y),Y.instance.init()};return Y.findElementQueriesElements=function(he){Y.instance.findElementQueriesElements(he)},Y.listen=function(){!function(he){if(document.addEventListener)document.addEventListener("DOMContentLoaded",he,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var W=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(he(),clearInterval(W))},10);else window.onload=he}(Y.init)},Y})?gt.apply(it,J):gt)&&(Vt.exports=xt)},835:function(Vt,it,tt){"use strict";var gt,J;"undefined"!=typeof window&&window,void 0!==(J="function"==typeof(gt=function(){if("undefined"==typeof window)return null;var xt="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),ut=xt.requestAnimationFrame||xt.mozRequestAnimationFrame||xt.webkitRequestAnimationFrame||function(re){return xt.setTimeout(re,20)},Y=xt.cancelAnimationFrame||xt.mozCancelAnimationFrame||xt.webkitCancelAnimationFrame||function(re){xt.clearTimeout(re)};function Ae(re,$){var b=Object.prototype.toString.call(re),S="[object Array]"===b||"[object NodeList]"===b||"[object HTMLCollection]"===b||"[object Object]"===b||"undefined"!=typeof jQuery&&re instanceof jQuery||"undefined"!=typeof Elements&&re instanceof Elements,R=0,A=re.length;if(S)for(;R<A;R++)$(re[R]);else $(re)}function he(re){if(!re.getBoundingClientRect)return{width:re.offsetWidth,height:re.offsetHeight};var $=re.getBoundingClientRect();return{width:Math.round($.width),height:Math.round($.height)}}function W(re,$){Object.keys($).forEach(function(b){re.style[b]=$[b]})}var j=function(re,$){var b=0;function S(){var v,y,A=[];this.add=function(w){A.push(w)},this.call=function(w){for(v=0,y=A.length;v<y;v++)A[v].call(this,w)},this.remove=function(w){var D=[];for(v=0,y=A.length;v<y;v++)A[v]!==w&&D.push(A[v]);A=D},this.length=function(){return A.length}}function R(A,v){if(A){if(A.resizedAttached)return void A.resizedAttached.add(v);A.resizedAttached=new S,A.resizedAttached.add(v),A.resizeSensor=document.createElement("div"),A.resizeSensor.dir="ltr",A.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},w={position:"absolute",left:"0px",top:"0px",transition:"0s"};W(A.resizeSensor,y);var D=document.createElement("div");D.className="resize-sensor-expand",W(D,y);var V=document.createElement("div");W(V,w),D.appendChild(V);var I=document.createElement("div");I.className="resize-sensor-shrink",W(I,y);var H=document.createElement("div");W(H,w),W(H,{width:"200%",height:"200%"}),I.appendChild(H),A.resizeSensor.appendChild(D),A.resizeSensor.appendChild(I),A.appendChild(A.resizeSensor);var K=window.getComputedStyle(A),M=K?K.getPropertyValue("position"):null;"absolute"!==M&&"relative"!==M&&"fixed"!==M&&"sticky"!==M&&(A.style.position="relative");var F=!1,Q=0,E=he(A),U=0,ie=0,ue=!0;b=0;var se=function(){if(ue){if(0===A.offsetWidth&&0===A.offsetHeight)return void(b||(b=ut(function(){b=0,se()})));ue=!1}var _e,Me;Me=A.offsetHeight,V.style.width=(_e=A.offsetWidth)+10+"px",V.style.height=Me+10+"px",D.scrollLeft=_e+10,D.scrollTop=Me+10,I.scrollLeft=_e+10,I.scrollTop=Me+10};A.resizeSensor.resetSensor=se;var Te=function(){Q=0,F&&(U=E.width,ie=E.height,A.resizedAttached&&A.resizedAttached.call(E))},ve=function(){E=he(A),(F=E.width!==U||E.height!==ie)&&!Q&&(Q=ut(Te)),se()},te=function(_e,Me,je){_e.attachEvent?_e.attachEvent("on"+Me,je):_e.addEventListener(Me,je)};te(D,"scroll",ve),te(I,"scroll",ve),b=ut(function(){b=0,se()})}}Ae(re,function(A){R(A,$)}),this.detach=function(A){b||(Y(b),b=0),j.detach(re,A)},this.reset=function(){re.resizeSensor.resetSensor()}};if(j.reset=function(re){Ae(re,function($){$.resizeSensor.resetSensor()})},j.detach=function(re,$){Ae(re,function(b){!b||b.resizedAttached&&"function"==typeof $&&(b.resizedAttached.remove($),b.resizedAttached.length())||b.resizeSensor&&(b.contains(b.resizeSensor)&&b.removeChild(b.resizeSensor),delete b.resizeSensor,delete b.resizedAttached)})},"undefined"!=typeof MutationObserver){var L=new MutationObserver(function(re){for(var $ in re)if(re.hasOwnProperty($))for(var b=re[$].addedNodes,S=0;S<b.length;S++)b[S].resizeSensor&&j.reset(b[S])});document.addEventListener("DOMContentLoaded",function(re){L.observe(document.body,{childList:!0,subtree:!0})})}return j})?gt.call(it,tt,it,Vt):gt)&&(Vt.exports=J)},445:(Vt,it,tt)=>{var gt=tt(910),J=tt(369),xt=tt(322);function ut(re,$,b){if(!gt(re))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!re.hasNode($))throw new Error('graphology-shortest-path: the "'+$+'" source node does not exist in the given graph.');if(!re.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" target node does not exist in the given graph.');if(($=""+$)==(b=""+b))return[$];var S=re.inboundNeighbors.bind(re),R=re.outboundNeighbors.bind(re),A={},v={};A[$]=null,v[b]=null;var D,V,I,H,K,M,F,Q,y=[$],w=[b],E=!1;e:for(;y.length&&w.length;)if(y.length<=w.length){for(D=y,y=[],K=0,F=D.length;K<F;K++)for(M=0,Q=(I=R(V=D[K])).length;M<Q;M++)if((H=I[M])in A||(y.push(H),A[H]=V),H in v){E=!0;break e}}else for(D=w,w=[],K=0,F=D.length;K<F;K++)for(V=D[K],I=S(V),M=0,Q=I.length;M<Q;M++)if(H=I[M],H in v||(w.push(H),v[H]=V),H in A){E=!0;break e}if(!E)return null;for(var U=[];H;)U.unshift(H),H=A[H];for(H=v[U[U.length-1]];H;)U.push(H),H=v[H];return U.length?U:null}function Y(re,$){if(!gt(re))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!re.hasNode($))throw new Error('graphology-shortest-path: the "'+$+'" source node does not exist in the given graph.');var R,A,v,y,w,D,b={},S={};for(b[$=""+$]=!0,S[$]=[$];Object.keys(b).length;)for(v in R=b,b={},R)for(w=0,D=(A=re.outboundNeighbors(v)).length;w<D;w++)S[y=A[w]]||(S[y]=S[v].concat(y),b[y]=!0);return S}function Ae(re,$,b){if(!gt($))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!$.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" source node does not exist in the given graph.');b=""+b;var S=new Set,R={},A=0;R[b]=0;for(var y,w,D,v=[b];0!==v.length;){var V=[];for(y=0,w=v.length;y<w;y++)!S.has(D=v[y])&&(S.add(D),xt(V,$[re](D)),R[D]=A);A++,v=V}return R}var he=Ae.bind(null,"outboundNeighbors"),W=Ae.bind(null,"neighbors");function j(re,$,b){return arguments.length<3?Y(re,$):ut(re,$,b)}j.bidirectional=ut,j.singleSource=Y,j.singleSourceLength=he,j.undirectedSingleSourceLength=W,j.brandes=function(re,$){$=""+$;var v,y,w,D,V,I,H,K,M,b=[],S={},R={},A=re.nodes();for(I=0,K=A.length;I<K;I++)S[D=A[I]]=[],R[D]=0;var F={};R[$]=1,F[$]=0;for(var Q=J.of($);Q.size;)for(D=Q.dequeue(),b.push(D),v=F[D],y=R[D],H=0,M=(w=re.outboundNeighbors(D)).length;H<M;H++)(V=w[H])in F||(Q.enqueue(V),F[V]=v+1),F[V]===v+1&&(R[V]+=y,S[V].push(D));return[b,S,R]},Vt.exports=j},910:Vt=>{Vt.exports=function(tt){return null!==tt&&"object"==typeof tt&&"function"==typeof tt.addUndirectedEdgeWithKey&&"function"==typeof tt.dropNode&&"boolean"==typeof tt.multi}},698:function(Vt){Vt.exports=function(){"use strict";function it(ne){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(de){return typeof de}:function(de){return de&&"function"==typeof Symbol&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de})(ne)}function tt(ne,de){ne.prototype=Object.create(de.prototype),ne.prototype.constructor=ne,J(ne,de)}function gt(ne){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(de){return de.__proto__||Object.getPrototypeOf(de)})(ne)}function J(ne,de){return(J=Object.setPrototypeOf||function(oe,C){return oe.__proto__=C,oe})(ne,de)}function xt(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ne){return!1}}function ut(ne,de,oe){return(ut=xt()?Reflect.construct:function(C,P,Z){var we=[null];we.push.apply(we,P);var Fe=new(Function.bind.apply(C,we));return Z&&J(Fe,Z.prototype),Fe}).apply(null,arguments)}function Y(ne){var de="function"==typeof Map?new Map:void 0;return(Y=function(oe){if(null===oe||-1===Function.toString.call(oe).indexOf("[native code]"))return oe;if("function"!=typeof oe)throw new TypeError("Super expression must either be null or a function");if(void 0!==de){if(de.has(oe))return de.get(oe);de.set(oe,P)}function P(){return ut(oe,arguments,gt(this).constructor)}return P.prototype=Object.create(oe.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),J(P,oe)})(ne)}function Ae(ne){if(void 0===ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne}var he=function(){for(var ne=arguments[0],de=1,oe=arguments.length;de<oe;de++)if(arguments[de])for(var C in arguments[de])ne[C]=arguments[de][C];return ne};function W(ne,de,oe,C){var P=ne._nodes.get(de),Z=null;return P?Z="mixed"===C?P.out&&P.out[oe]||P.undirected&&P.undirected[oe]:"directed"===C?P.out&&P.out[oe]:P.undirected&&P.undirected[oe]:Z}function j(ne){return null!==ne&&"object"===it(ne)&&"function"==typeof ne.addUndirectedEdgeWithKey&&"function"==typeof ne.dropNode}function L(ne){return"object"===it(ne)&&null!==ne&&ne.constructor===Object}function re(ne){var de;for(de in ne)return!1;return!0}function $(ne,de,oe){Object.defineProperty(ne,de,{enumerable:!1,configurable:!1,writable:!0,value:oe})}function b(ne,de,oe){var C={enumerable:!0,configurable:!0};"function"==typeof oe?C.get=oe:(C.value=oe,C.writable=!1),Object.defineProperty(ne,de,C)}function S(ne){return!(!L(ne)||ne.attributes&&!Array.isArray(ne.attributes))}"function"==typeof Object.assign&&(he=Object.assign);var R,A={exports:{}},v="object"==typeof Reflect?Reflect:null,y=v&&"function"==typeof v.apply?v.apply:function(ne,de,oe){return Function.prototype.apply.call(ne,de,oe)};R=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(ne){return Object.getOwnPropertyNames(ne).concat(Object.getOwnPropertySymbols(ne))}:function(ne){return Object.getOwnPropertyNames(ne)};var w=Number.isNaN||function(ne){return ne!=ne};function D(){D.init.call(this)}A.exports=D,A.exports.once=function(ne,de){return new Promise(function(oe,C){function P(we){ne.removeListener(de,Z),C(we)}function Z(){"function"==typeof ne.removeListener&&ne.removeListener("error",P),oe([].slice.call(arguments))}var we;ie(ne,de,Z,{once:!0}),"error"!==de&&("function"==typeof(we=ne).on&&ie(we,"error",P,{once:!0}))})},D.EventEmitter=D,D.prototype._events=void 0,D.prototype._eventsCount=0,D.prototype._maxListeners=void 0;var V=10;function I(ne){if("function"!=typeof ne)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ne)}function H(ne){return void 0===ne._maxListeners?D.defaultMaxListeners:ne._maxListeners}function K(ne,de,oe,C){var P,Z,we;if(I(oe),void 0===(Z=ne._events)?(Z=ne._events=Object.create(null),ne._eventsCount=0):(void 0!==Z.newListener&&(ne.emit("newListener",de,oe.listener?oe.listener:oe),Z=ne._events),we=Z[de]),void 0===we)we=Z[de]=oe,++ne._eventsCount;else if("function"==typeof we?we=Z[de]=C?[oe,we]:[we,oe]:C?we.unshift(oe):we.push(oe),(P=H(ne))>0&&we.length>P&&!we.warned){we.warned=!0;var et=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+String(de)+" listeners added. Use emitter.setMaxListeners() to increase limit");et.name="MaxListenersExceededWarning",et.emitter=ne,et.type=de,et.count=we.length,console&&console.warn&&console.warn(et)}return ne}function M(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function F(ne,de,oe){var C={fired:!1,wrapFn:void 0,target:ne,type:de,listener:oe},P=M.bind(C);return P.listener=oe,C.wrapFn=P,P}function Q(ne,de,oe){var C=ne._events;if(void 0===C)return[];var P=C[de];return void 0===P?[]:"function"==typeof P?oe?[P.listener||P]:[P]:oe?function(Z){for(var we=new Array(Z.length),Fe=0;Fe<we.length;++Fe)we[Fe]=Z[Fe].listener||Z[Fe];return we}(P):U(P,P.length)}function E(ne){var de=this._events;if(void 0!==de){var oe=de[ne];if("function"==typeof oe)return 1;if(void 0!==oe)return oe.length}return 0}function U(ne,de){for(var oe=new Array(de),C=0;C<de;++C)oe[C]=ne[C];return oe}function ie(ne,de,oe,C){if("function"==typeof ne.on)C.once?ne.once(de,oe):ne.on(de,oe);else{if("function"!=typeof ne.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ne);ne.addEventListener(de,function P(Z){C.once&&ne.removeEventListener(de,P),oe(Z)})}}function ue(ne){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:ne}),this.done=!1}Object.defineProperty(D,"defaultMaxListeners",{enumerable:!0,get:function(){return V},set:function(ne){if("number"!=typeof ne||ne<0||w(ne))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ne+".");V=ne}}),D.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},D.prototype.setMaxListeners=function(ne){if("number"!=typeof ne||ne<0||w(ne))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ne+".");return this._maxListeners=ne,this},D.prototype.getMaxListeners=function(){return H(this)},D.prototype.emit=function(ne){for(var de=[],oe=1;oe<arguments.length;oe++)de.push(arguments[oe]);var C="error"===ne,P=this._events;if(void 0!==P)C=C&&void 0===P.error;else if(!C)return!1;if(C){var Z;if(de.length>0&&(Z=de[0]),Z instanceof Error)throw Z;var we=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw we.context=Z,we}var Fe=P[ne];if(void 0===Fe)return!1;if("function"==typeof Fe)y(Fe,this,de);else{var et=Fe.length,Dt=U(Fe,et);for(oe=0;oe<et;++oe)y(Dt[oe],this,de)}return!0},D.prototype.on=D.prototype.addListener=function(ne,de){return K(this,ne,de,!1)},D.prototype.prependListener=function(ne,de){return K(this,ne,de,!0)},D.prototype.once=function(ne,de){return I(de),this.on(ne,F(this,ne,de)),this},D.prototype.prependOnceListener=function(ne,de){return I(de),this.prependListener(ne,F(this,ne,de)),this},D.prototype.off=D.prototype.removeListener=function(ne,de){var oe,C,P,Z,we;if(I(de),void 0===(C=this._events))return this;if(void 0===(oe=C[ne]))return this;if(oe===de||oe.listener===de)0==--this._eventsCount?this._events=Object.create(null):(delete C[ne],C.removeListener&&this.emit("removeListener",ne,oe.listener||de));else if("function"!=typeof oe){for(P=-1,Z=oe.length-1;Z>=0;Z--)if(oe[Z]===de||oe[Z].listener===de){we=oe[Z].listener,P=Z;break}if(P<0)return this;0===P?oe.shift():function(Fe,et){for(;et+1<Fe.length;et++)Fe[et]=Fe[et+1];Fe.pop()}(oe,P),1===oe.length&&(C[ne]=oe[0]),void 0!==C.removeListener&&this.emit("removeListener",ne,we||de)}return this},D.prototype.removeAllListeners=function(ne){var de,oe,C;if(void 0===(oe=this._events))return this;if(void 0===oe.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==oe[ne]&&(0==--this._eventsCount?this._events=Object.create(null):delete oe[ne]),this;if(0===arguments.length){var P,Z=Object.keys(oe);for(C=0;C<Z.length;++C)"removeListener"!==(P=Z[C])&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(de=oe[ne]))this.removeListener(ne,de);else if(void 0!==de)for(C=de.length-1;C>=0;C--)this.removeListener(ne,de[C]);return this},D.prototype.listeners=function(ne){return Q(this,ne,!0)},D.prototype.rawListeners=function(ne){return Q(this,ne,!1)},D.listenerCount=function(ne,de){return"function"==typeof ne.listenerCount?ne.listenerCount(de):E.call(ne,de)},D.prototype.listenerCount=E,D.prototype.eventNames=function(){return this._eventsCount>0?R(this._events):[]},ue.prototype.next=function(){if(this.done)return{done:!0};var ne=this._next();return ne.done&&(this.done=!0),ne},"undefined"!=typeof Symbol&&(ue.prototype[Symbol.iterator]=function(){return this}),ue.of=function(){var ne=arguments,de=ne.length,oe=0;return new ue(function(){return oe>=de?{done:!0}:{done:!1,value:ne[oe++]}})},ue.empty=function(){var ne=new ue(null);return ne.done=!0,ne},ue.is=function(ne){return ne instanceof ue||"object"==typeof ne&&null!==ne&&"function"==typeof ne.next};var ee=ue,se=function(ne,de){for(var oe,C=arguments.length>1?de:1/0,P=C!==1/0?new Array(C):[],Z=0;;){if(Z===C)return P;if((oe=ne.next()).done)return Z!==de?P.slice(0,Z):P;P[Z++]=oe.value}},Te=function(ne){function de(oe,C){var P;return(P=ne.call(this)||this).name="GraphError",P.message=oe||"",P.data=C||{},P}return tt(de,ne),de}(Y(Error)),ve=function(ne){function de(oe,C){var P;return(P=ne.call(this,oe,C)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(P),de.prototype.constructor),P}return tt(de,ne),de}(Te),te=function(ne){function de(oe,C){var P;return(P=ne.call(this,oe,C)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(P),de.prototype.constructor),P}return tt(de,ne),de}(Te),_e=function(ne){function de(oe,C){var P;return(P=ne.call(this,oe,C)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(P),de.prototype.constructor),P}return tt(de,ne),de}(Te);function Me(ne,de){this.key=ne,this.attributes=de,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function je(ne,de){this.key=ne,this.attributes=de,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function nt(ne,de){this.key=ne,this.attributes=de,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Ze(ne,de,oe,C,P,Z){this.key=de,this.attributes=Z,this.undirected=ne,this.source=C,this.target=P,this.generatedKey=oe}function Je(ne,de,oe,C,P,Z,we){var Fe,et,Dt="out",$e="in";if(de&&(Dt=$e="undirected"),ne.multi){if(void 0===(et=(Fe=Z[Dt])[P])&&(et=new Set,Fe[P]=et),et.add(oe),C===P&&de)return;void 0===(Fe=we[$e])[C]&&(Fe[C]=et)}else{if(Z[Dt][P]=oe,C===P&&de)return;we[$e][C]=oe}}function Ke(ne,de,oe){var C=ne.multi,P=oe.source,Z=oe.target,we=P.key,Fe=Z.key,et=P[de?"undirected":"out"],Dt=de?"undirected":"in";if(Fe in et)if(C){var $e=et[Fe];1===$e.size?(delete et[Fe],delete Z[Dt][we]):$e.delete(oe)}else delete et[Fe];C||delete Z[Dt][we]}je.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},nt.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var Ve=[{name:function(ne){return"get".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=W(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return Z.attributes[P]}}},{name:function(ne){return"get".concat(ne,"Attributes")},attacher:function(ne,de,oe){ne.prototype[de]=function(C){var P;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Z=""+C,we=""+arguments[1];if(!(P=W(this,Z,we,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Z,'" - "').concat(we,'").'))}else if(!(P=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&P.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return P.attributes}}},{name:function(ne){return"has".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=W(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return Z.attributes.hasOwnProperty(P)}}},{name:function(ne){return"set".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P,Z){var we;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+C,et=""+P;if(P=arguments[2],Z=arguments[3],!(we=W(this,Fe,et,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(et,'").'))}else if(!(we=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&we.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return we.attributes[P]=Z,this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:P}),this}}},{name:function(ne){return"update".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P,Z){var we;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+C,et=""+P;if(P=arguments[2],Z=arguments[3],!(we=W(this,Fe,et,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(et,'").'))}else if(!(we=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("function"!=typeof Z)throw new ve("Graph.".concat(de,": updater should be a function."));if("mixed"!==oe&&we.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return we.attributes[P]=Z(we.attributes[P]),this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:P}),this}}},{name:function(ne){return"remove".concat(ne,"Attribute")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=W(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return delete Z.attributes[P],this.emit("edgeAttributesUpdated",{key:Z.key,type:"remove",attributes:Z.attributes,name:P}),this}}},{name:function(ne){return"replace".concat(ne,"Attributes")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=W(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if(!L(P))throw new ve("Graph.".concat(de,": provided attributes are not a plain object."));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return Z.attributes=P,this.emit("edgeAttributesUpdated",{key:Z.key,type:"replace",attributes:Z.attributes}),this}}},{name:function(ne){return"merge".concat(ne,"Attributes")},attacher:function(ne,de,oe){ne.prototype[de]=function(C,P){var Z;if("mixed"!==this.type&&"mixed"!==oe&&oe!==this.type)throw new _e("Graph.".concat(de,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(de,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+C,Fe=""+P;if(P=arguments[2],!(Z=W(this,we,Fe,oe)))throw new te("Graph.".concat(de,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(C=""+C)))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" edge in the graph.'));if(!L(P))throw new ve("Graph.".concat(de,": provided attributes are not a plain object."));if("mixed"!==oe&&Z.undirected!==("undirected"===oe))throw new te("Graph.".concat(de,': could not find the "').concat(C,'" ').concat(oe," edge in the graph."));return he(Z.attributes,P),this.emit("edgeAttributesUpdated",{key:Z.key,type:"merge",attributes:Z.attributes,data:P}),this}}}],Le=ee,Ee=function(){var ne,de=arguments,oe=-1;return new Le(function C(){if(!ne){if(++oe>=de.length)return{done:!0};ne=de[oe]}var P=ne.next();return P.done?(ne=null,C()):P})},Ie=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Ue(ne,de){for(var oe in de)ne.push(de[oe].key)}function qe(ne,de){for(var oe in de)de[oe].forEach(function(C){return ne.push(C.key)})}function Be(ne,de,oe){for(var C in ne)if(C!==oe){var P=ne[C];de(P.key,P.attributes,P.source.key,P.target.key,P.source.attributes,P.target.attributes,P.undirected,P.generatedKey)}}function z(ne,de,oe){for(var C in ne)C!==oe&&ne[C].forEach(function(P){return de(P.key,P.attributes,P.source.key,P.target.key,P.source.attributes,P.target.attributes,P.undirected,P.generatedKey)})}function X(ne,de,oe){for(var C in ne)if(C!==oe){var P=ne[C];if(de(P.key,P.attributes,P.source.key,P.target.key,P.source.attributes,P.target.attributes,P.undirected,P.generatedKey))return!0}return!1}function be(ne,de,oe){var C,P,Z,we,Fe;for(var et in ne)if(et!==oe)for(C=ne[et].values();!0!==(P=C.next()).done;)if(we=(Z=P.value).source,de(Z.key,Z.attributes,we.key,(Fe=Z.target).key,we.attributes,Fe.attributes,Z.undirected,Z.generatedKey))return!0;return!1}function ce(ne,de){var oe=Object.keys(ne),C=oe.length,P=null,Z=0;return new ee(function we(){var Fe;if(P){var et=P.next();if(et.done)return P=null,Z++,we();Fe=et.value}else{if(Z>=C)return{done:!0};var Dt=oe[Z];if(Dt===de)return Z++,we();if((Fe=ne[Dt])instanceof Set)return P=Fe.values(),we();Z++}return{done:!1,value:[Fe.key,Fe.attributes,Fe.source.key,Fe.target.key,Fe.source.attributes,Fe.target.attributes]}})}function Pe(ne,de,oe){var C=de[oe];C&&ne.push(C.key)}function wt(ne,de,oe){var C=de[oe];C&&C.forEach(function(P){return ne.push(P.key)})}function pt(ne,de,oe){var C=ne[de];if(C){var P=C.source,Z=C.target;oe(C.key,C.attributes,P.key,Z.key,P.attributes,Z.attributes,C.undirected,C.generatedKey)}}function pe(ne,de,oe){var C=ne[de];C&&C.forEach(function(P){return oe(P.key,P.attributes,P.source.key,P.target.key,P.source.attributes,P.target.attributes,P.undirected,P.generatedKey)})}function B(ne,de,oe){var C=ne[de];if(C){var P=C.source,Z=C.target;return oe(C.key,C.attributes,P.key,Z.key,P.attributes,Z.attributes,C.undirected,C.generatedKey)}}function O(ne,de,oe){var C=ne[de];if(C){for(var P,Z,we=C.values();!0!==(P=we.next()).done;)if(oe((Z=P.value).key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes,Z.undirected,Z.generatedKey))return!0;return!1}}function k(ne,de){var oe=ne[de];if(oe instanceof Set){var C=oe.values();return new ee(function(){var P=C.next();if(P.done)return P;var Z=P.value;return{done:!1,value:[Z.key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes]}})}return ee.of([oe.key,oe.attributes,oe.source.key,oe.target.key,oe.source.attributes,oe.target.attributes])}function Oe(ne,de){if(0===ne.size)return[];if("mixed"===de||de===ne.type)return"function"==typeof Array.from?Array.from(ne._edges.keys()):se(ne._edges.keys(),ne._edges.size);for(var oe,C,Z=new Array("undirected"===de?ne.undirectedSize:ne.directedSize),we="undirected"===de,Fe=ne._edges.values(),et=0;!0!==(oe=Fe.next()).done;)(C=oe.value).undirected===we&&(Z[et++]=C.key);return Z}function Xe(ne,de,oe){if(0!==ne.size)for(var C,P,Z="mixed"!==de&&de!==ne.type,we="undirected"===de,Fe=ne._edges.values();!0!==(C=Fe.next()).done;)if(P=C.value,!Z||P.undirected===we){var Gt=P.source,Et=P.target;oe(P.key,P.attributes,Gt.key,Et.key,Gt.attributes,Et.attributes,P.undirected,P.generatedKey)}}function yt(ne,de,oe){if(0!==ne.size)for(var C,P,Z="mixed"!==de&&de!==ne.type,we="undirected"===de,Fe=ne._edges.values();!0!==(C=Fe.next()).done;)if(P=C.value,!Z||P.undirected===we){var Gt=P.source,Et=P.target;if(oe(P.key,P.attributes,Gt.key,Et.key,Gt.attributes,Et.attributes,P.undirected,P.generatedKey))break}}function It(ne,de){if(0===ne.size)return ee.empty();var oe="mixed"!==de&&de!==ne.type,C="undirected"===de,P=ne._edges.values();return new ee(function(){for(var Z,we;;){if((Z=P.next()).done)return Z;if(we=Z.value,!oe||we.undirected===C)break}return{value:[we.key,we.attributes,we.source.key,we.target.key,we.source.attributes,we.target.attributes],done:!1}})}function An(ne,de,oe,C){var P=[],Z=ne?qe:Ue;return"undirected"!==de&&("out"!==oe&&Z(P,C.in),"in"!==oe&&Z(P,C.out),!oe&&C.directedSelfLoops>0&&P.splice(P.lastIndexOf(C.key),1)),"directed"!==de&&Z(P,C.undirected),P}function Rn(ne,de,oe,C,P){var Z=ne?z:Be;"undirected"!==de&&("out"!==oe&&Z(C.in,P),"in"!==oe&&Z(C.out,P,oe?null:C.key)),"directed"!==de&&Z(C.undirected,P)}function zn(ne,de,oe,C,P){var Z=ne?be:X;"undirected"!==de&&("out"!==oe&&Z(C.in,P)||"in"!==oe&&Z(C.out,P,oe?null:C.key))||"directed"===de||Z(C.undirected,P)}function _i(ne,de,oe){var C=ee.empty();return"undirected"!==ne&&("out"!==de&&void 0!==oe.in&&(C=Ee(C,ce(oe.in))),"in"!==de&&void 0!==oe.out&&(C=Ee(C,ce(oe.out,de?null:oe.key)))),"directed"!==ne&&void 0!==oe.undirected&&(C=Ee(C,ce(oe.undirected))),C}function ci(ne,de,oe,C,P){var Z=de?wt:Pe,we=[];return"undirected"!==ne&&(void 0!==C.in&&"out"!==oe&&Z(we,C.in,P),void 0!==C.out&&"in"!==oe&&Z(we,C.out,P),!oe&&C.directedSelfLoops>0&&we.splice(we.lastIndexOf(C.key),1)),"directed"!==ne&&void 0!==C.undirected&&Z(we,C.undirected,P),we}function jr(ne,de,oe,C,P,Z){var we=de?pe:pt;"undirected"!==ne&&(void 0!==C.in&&"out"!==oe&&we(C.in,P,Z),C.key!==P&&void 0!==C.out&&"in"!==oe&&we(C.out,P,Z)),"directed"!==ne&&void 0!==C.undirected&&we(C.undirected,P,Z)}function Is(ne,de,oe,C,P,Z){var we=de?O:B;"undirected"!==ne&&(void 0!==C.in&&"out"!==oe&&we(C.in,P,Z)||C.key!==P&&void 0!==C.out&&"in"!==oe&&we(C.out,P,Z,oe?null:C.key))||"directed"===ne||void 0===C.undirected||we(C.undirected,P,Z)}function ss(ne,de,oe,C){var P=ee.empty();return"undirected"!==ne&&(void 0!==oe.in&&"out"!==de&&C in oe.in&&(P=Ee(P,k(oe.in,C))),void 0!==oe.out&&"in"!==de&&C in oe.out&&(P=Ee(P,k(oe.out,C)))),"directed"!==ne&&void 0!==oe.undirected&&C in oe.undirected&&(P=Ee(P,k(oe.undirected,C))),P}var Os=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Ur(ne,de){if(void 0!==de)for(var oe in de)ne.add(oe)}function Va(ne,de,oe){if("mixed"!==ne){if("undirected"===ne)return Object.keys(oe.undirected);if("string"==typeof de)return Object.keys(oe[de])}var C=new Set;return"undirected"!==ne&&("out"!==de&&Ur(C,oe.in),"in"!==de&&Ur(C,oe.out)),"directed"!==ne&&Ur(C,oe.undirected),se(C.values(),C.size)}function _l(ne,de,oe){for(var C in de){var P=de[C];P instanceof Set&&(P=P.values().next().value);var Z=P.source,Fe=Z===ne?P.target:Z;oe(Fe.key,Fe.attributes)}}function aa(ne,de,oe,C){for(var P in oe){var Z=oe[P];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===de?Z.target:we;ne.has(et.key)||(ne.add(et.key),C(et.key,et.attributes))}}function fs(ne,de,oe){for(var C in de){var P=de[C];P instanceof Set&&(P=P.values().next().value);var Z=P.source,Fe=Z===ne?P.target:Z;if(oe(Fe.key,Fe.attributes))return!0}return!1}function Zt(ne,de,oe,C){for(var P in oe){var Z=oe[P];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===de?Z.target:we;if(!ne.has(et.key)&&(ne.add(et.key),C(et.key,et.attributes)))return!0}return!1}function ja(ne,de){var oe=Object.keys(de),C=oe.length,P=0;return new ee(function(){if(P>=C)return{done:!0};var Z=de[oe[P++]];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===ne?Z.target:we;return{done:!1,value:[et.key,et.attributes]}})}function rt(ne,de,oe){var C=Object.keys(oe),P=C.length,Z=0;return new ee(function we(){if(Z>=P)return{done:!0};var Fe=oe[C[Z++]];Fe instanceof Set&&(Fe=Fe.values().next().value);var et=Fe.source,$e=et===de?Fe.target:et;return ne.has($e.key)?we():(ne.add($e.key),{done:!1,value:[$e.key,$e.attributes]})})}function ot(ne,de,oe,C,P){var Z=ne._nodes.get(C);if("undirected"!==de){if("out"!==oe&&void 0!==Z.in)for(var we in Z.in)if(we===P)return!0;if("in"!==oe&&void 0!==Z.out)for(var Fe in Z.out)if(Fe===P)return!0}if("directed"!==de&&void 0!==Z.undirected)for(var et in Z.undirected)if(et===P)return!0;return!1}function ke(ne,de,oe){for(var C,P,Z,we,Fe,et,Dt,$e=de._nodes.values(),Gt=de.type;!0!==(C=$e.next()).done;){if(P=C.value,"undirected"!==Gt)for(Z in we=P.out)if(et=(Fe=we[Z]).target,Dt=oe(P.key,et.key,P.attributes,et.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ne&&Dt)return;if("directed"!==Gt)for(Z in we=P.undirected)if((et=(Fe=we[Z]).target).key!==Z&&(et=Fe.source),Dt=oe(P.key,et.key,P.attributes,et.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ne&&Dt)return}}function lt(ne,de,oe){for(var C,P,Z,we,Fe,et,Dt,$e,Gt,Et=de._nodes.values(),gn=de.type;!0!==(C=Et.next()).done;){if(P=C.value,"undirected"!==gn)for(Z in et=P.out)for(we=et[Z].values();!0!==(Fe=we.next()).done;)if($e=(Dt=Fe.value).target,Gt=oe(P.key,$e.key,P.attributes,$e.attributes,Dt.key,Dt.attributes,Dt.undirected,Dt.generatedKey),ne&&Gt)return;if("directed"!==gn)for(Z in et=P.undirected)for(we=et[Z].values();!0!==(Fe=we.next()).done;)if(($e=(Dt=Fe.value).target).key!==Z&&($e=Dt.source),Gt=oe(P.key,$e.key,P.attributes,$e.attributes,Dt.key,Dt.attributes,Dt.undirected,Dt.generatedKey),ne&&Gt)return}}function Qe(ne,de){var oe={key:ne};return re(de.attributes)||(oe.attributes=he({},de.attributes)),oe}function vt(ne,de){var oe={source:de.source.key,target:de.target.key};return de.generatedKey||(oe.key=ne),re(de.attributes)||(oe.attributes=he({},de.attributes)),de.undirected&&(oe.undirected=!0),oe}function St(ne){return L(ne)?"key"in ne?!("attributes"in ne)||L(ne.attributes)&&null!==ne.attributes?null:"invalid-attributes":"no-key":"not-object"}function At(ne){return L(ne)?"source"in ne?"target"in ne?!("attributes"in ne)||L(ne.attributes)&&null!==ne.attributes?"undirected"in ne&&"boolean"!=typeof ne.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var qt=new Set(["directed","undirected","mixed"]),Bn=new Set(["domain","_events","_eventsCount","_maxListeners"]),ti={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function Dn(ne,de,oe){var C=new ne.NodeDataClass(de,oe);return ne._nodes.set(de,C),ne.emit("nodeAdded",{key:de,attributes:oe}),C}function pn(ne,de,oe,C,P,Z,we,Fe){if(!C&&"undirected"===ne.type)throw new _e("Graph.".concat(de,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(C&&"directed"===ne.type)throw new _e("Graph.".concat(de,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe&&!L(Fe))throw new ve("Graph.".concat(de,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));if(Z=""+Z,we=""+we,Fe=Fe||{},!ne.allowSelfLoops&&Z===we)throw new _e("Graph.".concat(de,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var et=ne._nodes.get(Z),Dt=ne._nodes.get(we);if(!et)throw new te("Graph.".concat(de,': source node "').concat(Z,'" not found.'));if(!Dt)throw new te("Graph.".concat(de,': target node "').concat(we,'" not found.'));var $e={key:null,undirected:C,source:Z,target:we,attributes:Fe};if(oe&&(P=ne._edgeKeyGenerator($e)),ne._edges.has(P=""+P))throw new _e("Graph.".concat(de,': the "').concat(P,'" edge already exists in the graph.'));if(!ne.multi&&(C?void 0!==et.undirected[we]:void 0!==et.out[we]))throw new _e("Graph.".concat(de,': an edge linking "').concat(Z,'" to "').concat(we,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var Gt=new Ze(C,P,oe,et,Dt,Fe);return ne._edges.set(P,Gt),Z===we?C?(et.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(et.directedSelfLoops++,ne._directedSelfLoopCount++):C?(et.undirectedDegree++,Dt.undirectedDegree++):(et.outDegree++,Dt.inDegree++),Je(ne,C,Gt,Z,we,et,Dt),C?ne._undirectedSize++:ne._directedSize++,$e.key=P,ne.emit("edgeAdded",$e),P}function Un(ne,de,oe,C,P,Z,we,Fe,et){if(!C&&"undirected"===ne.type)throw new _e("Graph.".concat(de,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(C&&"directed"===ne.type)throw new _e("Graph.".concat(de,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe)if(et){if("function"!=typeof Fe)throw new ve("Graph.".concat(de,': invalid updater function. Expecting a function but got "').concat(Fe,'"'))}else if(!L(Fe))throw new ve("Graph.".concat(de,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));var Dt;if(Z=""+Z,we=""+we,et&&(Dt=Fe,Fe=void 0),!ne.allowSelfLoops&&Z===we)throw new _e("Graph.".concat(de,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var $e,Gt,Et=ne._nodes.get(Z),gn=ne._nodes.get(we);if(!oe&&($e=ne._edges.get(P))){if($e.source.key!==Z||$e.target.key!==we||C&&($e.source.key!==we||$e.target.key!==Z))throw new _e("Graph.".concat(de,': inconsistency detected when attempting to merge the "').concat(P,'" edge with "').concat(Z,'" source & "').concat(we,'" target vs. ("').concat($e.source.key,'", "').concat($e.target.key,'").'));Gt=$e}if(Gt||ne.multi||!Et||(Gt=C?Et.undirected[we]:Et.out[we]),Gt)return(et?Dt:Fe)?(et?(Gt.attributes=Dt(Gt.attributes),ne.emit("edgeAttributesUpdated",{type:"replace",key:Gt.key,attributes:Gt.attributes})):(he(Gt.attributes,Fe),ne.emit("edgeAttributesUpdated",{type:"merge",key:Gt.key,attributes:Gt.attributes,data:Fe})),Gt.key):Gt.key;Fe=Fe||{},et&&Dt&&(Fe=Dt(Fe));var Hr={key:null,undirected:C,source:Z,target:we,attributes:Fe};if(oe&&(P=ne._edgeKeyGenerator(Hr)),ne._edges.has(P=""+P))throw new _e("Graph.".concat(de,': the "').concat(P,'" edge already exists in the graph.'));return Et||(Et=Dn(ne,Z,{}),Z===we&&(gn=Et)),gn||(gn=Dn(ne,we,{})),$e=new Ze(C,P,oe,Et,gn,Fe),ne._edges.set(P,$e),Z===we?C?(Et.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(Et.directedSelfLoops++,ne._directedSelfLoopCount++):C?(Et.undirectedDegree++,gn.undirectedDegree++):(Et.outDegree++,gn.inDegree++),Je(ne,C,$e,Z,we,Et,gn),C?ne._undirectedSize++:ne._directedSize++,Hr.key=P,ne.emit("edgeAdded",Hr),P}var ne,En=function(ne){function de(C){var P;if(P=ne.call(this)||this,(C=he({},ti,C)).edgeKeyGenerator&&"function"!=typeof C.edgeKeyGenerator)throw new ve("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(C.edgeKeyGenerator,'".'));if("boolean"!=typeof C.multi)throw new ve("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(C.multi,'".'));if(!qt.has(C.type))throw new ve('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(C.type,'".'));if("boolean"!=typeof C.allowSelfLoops)throw new ve("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(C.allowSelfLoops,'".'));var Z,we="mixed"===C.type?Me:"directed"===C.type?je:nt;return $(Ae(P),"NodeDataClass",we),$(Ae(P),"_attributes",{}),$(Ae(P),"_nodes",new Map),$(Ae(P),"_edges",new Map),$(Ae(P),"_directedSize",0),$(Ae(P),"_undirectedSize",0),$(Ae(P),"_directedSelfLoopCount",0),$(Ae(P),"_undirectedSelfLoopCount",0),$(Ae(P),"_edgeKeyGenerator",C.edgeKeyGenerator||(Z=0,function(){return Z++})),$(Ae(P),"_options",C),Bn.forEach(function(Fe){return $(Ae(P),Fe,P[Fe])}),b(Ae(P),"order",function(){return P._nodes.size}),b(Ae(P),"size",function(){return P._edges.size}),b(Ae(P),"directedSize",function(){return P._directedSize}),b(Ae(P),"undirectedSize",function(){return P._undirectedSize}),b(Ae(P),"selfLoopCount",function(){return P._directedSelfLoopCount+P._undirectedSelfLoopCount}),b(Ae(P),"directedSelfLoopCount",function(){return P._directedSelfLoopCount}),b(Ae(P),"undirectedSelfLoopCount",function(){return P._undirectedSelfLoopCount}),b(Ae(P),"multi",P._options.multi),b(Ae(P),"type",P._options.type),b(Ae(P),"allowSelfLoops",P._options.allowSelfLoops),b(Ae(P),"implementation",function(){return"graphology"}),P}tt(de,ne);var oe=de.prototype;return oe.hasNode=function(C){return this._nodes.has(""+C)},oe.hasDirectedEdge=function(C,P){if("undirected"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+C);return!!we&&!we.undirected}if(2===arguments.length){P=""+P;var Fe=this._nodes.get(C=""+C);if(!Fe)return!1;var et=Fe.out[P];return!(!et||this.multi&&!et.size)}throw new ve("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},oe.hasUndirectedEdge=function(C,P){if("directed"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+C);return!!we&&we.undirected}if(2===arguments.length){P=""+P;var Fe=this._nodes.get(C=""+C);if(!Fe)return!1;var et=Fe.undirected[P];return!(!et||this.multi&&!et.size)}throw new ve("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},oe.hasEdge=function(C,P){if(1===arguments.length)return this._edges.has(""+C);if(2===arguments.length){P=""+P;var we=this._nodes.get(C=""+C);if(!we)return!1;var Fe=void 0!==we.out&&we.out[P];return Fe||(Fe=void 0!==we.undirected&&we.undirected[P]),!(!Fe||this.multi&&!Fe.size)}throw new ve("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},oe.directedEdge=function(C,P){if("undirected"!==this.type){if(C=""+C,P=""+P,this.multi)throw new _e("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var Z=this._nodes.get(C);if(!Z)throw new te('Graph.directedEdge: could not find the "'.concat(C,'" source node in the graph.'));if(!this._nodes.has(P))throw new te('Graph.directedEdge: could not find the "'.concat(P,'" target node in the graph.'));var we=Z.out&&Z.out[P]||void 0;return we?we.key:void 0}},oe.undirectedEdge=function(C,P){if("directed"!==this.type){if(C=""+C,P=""+P,this.multi)throw new _e("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var Z=this._nodes.get(C);if(!Z)throw new te('Graph.undirectedEdge: could not find the "'.concat(C,'" source node in the graph.'));if(!this._nodes.has(P))throw new te('Graph.undirectedEdge: could not find the "'.concat(P,'" target node in the graph.'));var we=Z.undirected&&Z.undirected[P]||void 0;return we?we.key:void 0}},oe.edge=function(C,P){if(this.multi)throw new _e("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");P=""+P;var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.edge: could not find the "'.concat(C,'" source node in the graph.'));if(!this._nodes.has(P))throw new te('Graph.edge: could not find the "'.concat(P,'" target node in the graph.'));var we=Z.out&&Z.out[P]||Z.undirected&&Z.undirected[P]||void 0;if(we)return we.key},oe.inDegree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new ve('Graph.inDegree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.inDegree: could not find the "'.concat(C,'" node in the graph.'));return"undirected"===this.type?0:Z.inDegree+(P?Z.directedSelfLoops:0)},oe.outDegree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new ve('Graph.outDegree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.outDegree: could not find the "'.concat(C,'" node in the graph.'));return"undirected"===this.type?0:Z.outDegree+(P?Z.directedSelfLoops:0)},oe.directedDegree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new ve('Graph.directedDegree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.directedDegree: could not find the "'.concat(C,'" node in the graph.'));if("undirected"===this.type)return 0;var we=P?Z.directedSelfLoops:0;return Z.inDegree+we+(Z.outDegree+we)},oe.undirectedDegree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new ve('Graph.undirectedDegree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.undirectedDegree: could not find the "'.concat(C,'" node in the graph.'));return"directed"===this.type?0:Z.undirectedDegree+2*(P?Z.undirectedSelfLoops:0)},oe.degree=function(C){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof P)throw new ve('Graph.degree: Expecting a boolean but got "'.concat(P,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.degree: could not find the "'.concat(C,'" node in the graph.'));var we=0,Fe=0;return"directed"!==this.type&&(P&&(Fe=Z.undirectedSelfLoops),we+=Z.undirectedDegree+2*Fe),"undirected"!==this.type&&(P&&(Fe=Z.directedSelfLoops),we+=Z.inDegree+Z.outDegree+2*Fe),we},oe.source=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.source: could not find the "'.concat(C,'" edge in the graph.'));return P.source.key},oe.target=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.target: could not find the "'.concat(C,'" edge in the graph.'));return P.target.key},oe.extremities=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.extremities: could not find the "'.concat(C,'" edge in the graph.'));return[P.source.key,P.target.key]},oe.opposite=function(C,P){C=""+C;var Z=this._edges.get(P=""+P);if(!Z)throw new te('Graph.opposite: could not find the "'.concat(P,'" edge in the graph.'));var we=Z.source.key,Fe=Z.target.key;if(C!==we&&C!==Fe)throw new te('Graph.opposite: the "'.concat(C,'" node is not attached to the "').concat(P,'" edge (').concat(we,", ").concat(Fe,")."));return C===we?Fe:we},oe.hasExtremity=function(C,P){P=""+P;var Z=this._edges.get(C=""+C);if(!Z)throw new te('Graph.hasExtremity: could not find the "'.concat(C,'" edge in the graph.'));return Z.source.key===P||Z.target.key===P},oe.isUndirected=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.isUndirected: could not find the "'.concat(C,'" edge in the graph.'));return P.undirected},oe.isDirected=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.isDirected: could not find the "'.concat(C,'" edge in the graph.'));return!P.undirected},oe.isSelfLoop=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.isSelfLoop: could not find the "'.concat(C,'" edge in the graph.'));return P.source===P.target},oe.hasGeneratedKey=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.hasGeneratedKey: could not find the "'.concat(C,'" edge in the graph.'));return P.generatedKey},oe.addNode=function(C,P){return function(Z,we,Fe){if(Fe&&!L(Fe))throw new ve('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Fe,'"'));if(Fe=Fe||{},Z._nodes.has(we=""+we))throw new _e('Graph.addNode: the "'.concat(we,'" node already exist in the graph.'));var et=new Z.NodeDataClass(we,Fe);return Z._nodes.set(we,et),Z.emit("nodeAdded",{key:we,attributes:Fe}),et}(this,C,P).key},oe.mergeNode=function(C,P){if(P&&!L(P))throw new ve('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(P,'"'));P=P||{};var Z=this._nodes.get(C=""+C);return Z?(P&&(he(Z.attributes,P),this.emit("nodeAttributesUpdated",{type:"merge",key:C,attributes:Z.attributes,data:P})),C):(Z=new this.NodeDataClass(C,P),this._nodes.set(C,Z),this.emit("nodeAdded",{key:C,attributes:P}),C)},oe.updateNode=function(C,P){if(P&&"function"!=typeof P)throw new ve('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(P,'"'));var Z=this._nodes.get(C=""+C);if(Z)return P&&(Z.attributes=P(Z.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:C,attributes:Z.attributes})),C;var Fe=P?P({}):{};return Z=new this.NodeDataClass(C,Fe),this._nodes.set(C,Z),this.emit("nodeAdded",{key:C,attributes:Fe}),C},oe.dropNode=function(C){var P=this,Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.dropNode: could not find the "'.concat(C,'" node in the graph.'));this.forEachEdge(C,function(we){P.dropEdge(we)}),this._nodes.delete(C),this.emit("nodeDropped",{key:C,attributes:Z.attributes})},oe.dropEdge=function(C){var P;if(arguments.length>1){var Z=""+arguments[0],we=""+arguments[1];if(!(P=W(this,Z,we,this.type)))throw new te('Graph.dropEdge: could not find the "'.concat(Z,'" -> "').concat(we,'" edge in the graph.'))}else if(!(P=this._edges.get(C=""+C)))throw new te('Graph.dropEdge: could not find the "'.concat(C,'" edge in the graph.'));this._edges.delete(P.key);var et=P.source,Dt=P.target,$e=P.attributes,Gt=P.undirected;return et===Dt?Gt?(et.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(et.directedSelfLoops--,this._directedSelfLoopCount--):Gt?(et.undirectedDegree--,Dt.undirectedDegree--):(et.outDegree--,Dt.inDegree--),Ke(this,Gt,P),Gt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:C,attributes:$e,source:et.key,target:Dt.key,undirected:Gt}),this},oe.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},oe.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},oe.getAttribute=function(C){return this._attributes[C]},oe.getAttributes=function(){return this._attributes},oe.hasAttribute=function(C){return this._attributes.hasOwnProperty(C)},oe.setAttribute=function(C,P){return this._attributes[C]=P,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:C}),this},oe.updateAttribute=function(C,P){if("function"!=typeof P)throw new ve("Graph.updateAttribute: updater should be a function.");return this._attributes[C]=P(this._attributes[C]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:C}),this},oe.removeAttribute=function(C){return delete this._attributes[C],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:C}),this},oe.replaceAttributes=function(C){if(!L(C))throw new ve("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=C,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},oe.mergeAttributes=function(C){if(!L(C))throw new ve("Graph.mergeAttributes: provided attributes are not a plain object.");return he(this._attributes,C),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:C}),this},oe.getNodeAttribute=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.getNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));return Z.attributes[P]},oe.getNodeAttributes=function(C){var P=this._nodes.get(C=""+C);if(!P)throw new te('Graph.getNodeAttributes: could not find the "'.concat(C,'" node in the graph.'));return P.attributes},oe.hasNodeAttribute=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));return Z.attributes.hasOwnProperty(P)},oe.setNodeAttribute=function(C,P,Z){var we=this._nodes.get(C=""+C);if(!we)throw new te('Graph.setNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));if(arguments.length<3)throw new ve("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return we.attributes[P]=Z,this.emit("nodeAttributesUpdated",{key:C,type:"set",attributes:we.attributes,name:P}),this},oe.updateNodeAttribute=function(C,P,Z){var we=this._nodes.get(C=""+C);if(!we)throw new te('Graph.updateNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));if(arguments.length<3)throw new ve("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof Z)throw new ve("Graph.updateAttribute: updater should be a function.");var Fe=we.attributes,et=Z(Fe[P]);return Fe[P]=et,this.emit("nodeAttributesUpdated",{key:C,type:"set",attributes:we.attributes,name:P}),this},oe.removeNodeAttribute=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(C,'" node in the graph.'));return delete Z.attributes[P],this.emit("nodeAttributesUpdated",{key:C,type:"remove",attributes:Z.attributes,name:P}),this},oe.replaceNodeAttributes=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.replaceNodeAttributes: could not find the "'.concat(C,'" node in the graph.'));if(!L(P))throw new ve("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return Z.attributes=P,this.emit("nodeAttributesUpdated",{key:C,type:"replace",attributes:Z.attributes}),this},oe.mergeNodeAttributes=function(C,P){var Z=this._nodes.get(C=""+C);if(!Z)throw new te('Graph.mergeNodeAttributes: could not find the "'.concat(C,'" node in the graph.'));if(!L(P))throw new ve("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return he(Z.attributes,P),this.emit("nodeAttributesUpdated",{key:C,type:"merge",attributes:Z.attributes,data:P}),this},oe.updateEachNodeAttributes=function(C,P){if("function"!=typeof C)throw new ve("Graph.updateEachNodeAttributes: expecting an updater function.");if(P&&!S(P))throw new ve("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Fe=this._nodes.values();!0!==(Z=Fe.next()).done;)(we=Z.value).attributes=C(we.key,we.attributes);this.emit("eachNodeAttributesUpdated",{hints:P||null})},oe.updateEachEdgeAttributes=function(C,P){if("function"!=typeof C)throw new ve("Graph.updateEachEdgeAttributes: expecting an updater function.");if(P&&!S(P))throw new ve("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Fe=this._edges.values();!0!==(Z=Fe.next()).done;)(we=Z.value).attributes=C(we.key,we.attributes);this.emit("eachEdgeAttributesUpdated",{hints:P||null})},oe.forEach=function(C){if("function"!=typeof C)throw new ve("Graph.forEach: expecting a callback.");this.multi?lt(!1,this,C):ke(!1,this,C)},oe.forEachUntil=function(C){if("function"!=typeof C)throw new ve("Graph.forEach: expecting a callback.");this.multi?lt(!0,this,C):ke(!0,this,C)},oe.adjacency=function(){return this.multi?(et=(C=this)._nodes.values(),Dt=C.type,$e="outer",Gt=null,new ee(function Et(){var gn;if("outer"===$e)return!0===(gn=et.next()).done?gn:(P=gn.value,$e="directed",Et());if("directed"===$e)return"undirected"===Dt?($e="undirected",Et()):(we=P.out,Z=Object.keys(P.out),Fe=0,$e="inner-directed",Et());if("undirected"===$e){if("directed"===Dt)return $e="outer",Et();we=P.undirected,Z=Object.keys(P.undirected),Fe=0,$e="inner-undirected"}if(!Gt&&Fe>=Z.length)return $e="inner-undirected"===$e?"outer":"undirected",Et();if(!Gt){var ps=Z[Fe++];return Gt=we[ps].values(),Et()}if((gn=Gt.next()).done)return Gt=null,Et();var Hr=gn.value,Gs=Hr.target;return"inner-undirected"===$e&&Gs.key===P.key&&(Gs=Hr.source),{done:!1,value:[P.key,Gs.key,P.attributes,Gs.attributes,Hr.key,Hr.attributes]}})):(yl=(Et=this)._nodes.values(),io=Et.type,Rr="outer",new ee(function Rs(){var rc;if("outer"===Rr)return!0===(rc=yl.next()).done?rc:(gn=rc.value,Rr="directed",Rs());if("directed"===Rr)return"undirected"===io?(Rr="undirected",Rs()):(Hr=gn.out,ps=Object.keys(gn.out),Gs=0,Rr="inner-directed",Rs());if("undirected"===Rr){if("directed"===io)return Rr="outer",Rs();Hr=gn.undirected,ps=Object.keys(gn.undirected),Gs=0,Rr="inner-undirected"}if(Gs>=ps.length)return Rr="inner-undirected"===Rr?"outer":"undirected",Rs();var bn=ps[Gs++],ro=Hr[bn],vl=ro.target;return"inner-undirected"===Rr&&vl.key===gn.key&&(vl=ro.source),{done:!1,value:[gn.key,vl.key,gn.attributes,vl.attributes,ro.key,ro.attributes]}}));var Et,gn,ps,Hr,Gs,yl,io,Rr,C,P,Z,we,Fe,et,Dt,$e,Gt},oe.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):se(this._nodes.keys(),this._nodes.size)},oe.forEachNode=function(C){if("function"!=typeof C)throw new ve("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(P,Z){C(Z,P.attributes)})},oe.forEachNodeUntil=function(C){if("function"!=typeof C)throw new ve("Graph.forEachNode: expecting a callback.");for(var P,Z,we=this._nodes.values();!0!==(P=we.next())&&!C((Z=P.value).key,Z.attributes););},oe.nodeEntries=function(){var C=this._nodes.values();return new ee(function(){var P=C.next();if(P.done)return P;var Z=P.value;return{value:[Z.key,Z.attributes],done:!1}})},oe.exportNode=function(C){var P=this._nodes.get(C=""+C);if(!P)throw new te('Graph.exportNode: could not find the "'.concat(C,'" node in the graph.'));return Qe(C,P)},oe.exportEdge=function(C){var P=this._edges.get(C=""+C);if(!P)throw new te('Graph.exportEdge: could not find the "'.concat(C,'" edge in the graph.'));return vt(C,P)},oe.export=function(){var C=new Array(this._nodes.size),P=0;this._nodes.forEach(function(we,Fe){C[P++]=Qe(Fe,we)});var Z=new Array(this._edges.size);return P=0,this._edges.forEach(function(we,Fe){Z[P++]=vt(Fe,we)}),{attributes:this.getAttributes(),nodes:C,edges:Z,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},oe.importNode=function(C){var P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=St(C);if(Z){if("not-object"===Z)throw new ve('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===Z)throw new ve("Graph.importNode: no key provided.");if("invalid-attributes"===Z)throw new ve("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var we=C.key,Fe=C.attributes,et=void 0===Fe?{}:Fe;return P?this.mergeNode(we,et):this.addNode(we,et),this},oe.importEdge=function(C){var P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=At(C);if(Z){if("not-object"===Z)throw new ve('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===Z)throw new ve("Graph.importEdge: missing souce.");if("no-target"===Z)throw new ve("Graph.importEdge: missing target.");if("invalid-attributes"===Z)throw new ve("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===Z)throw new ve("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var we=C.source,Fe=C.target,et=C.attributes,Dt=void 0===et?{}:et,$e=C.undirected,Gt=void 0!==$e&&$e;return"key"in C?(P?Gt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:Gt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,C.key,we,Fe,Dt):(P?Gt?this.mergeUndirectedEdge:this.mergeDirectedEdge:Gt?this.addUndirectedEdge:this.addDirectedEdge).call(this,we,Fe,Dt),this},oe.import=function(C){var P,Z,we,Fe=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(j(C))return this.import(C.export(),Fe),this;if(!L(C))throw new ve("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(C.attributes){if(!L(C.attributes))throw new ve("Graph.import: invalid attributes. Expecting a plain object.");Fe?this.mergeAttributes(C.attributes):this.replaceAttributes(C.attributes)}if(C.nodes){if(we=C.nodes,!Array.isArray(we))throw new ve("Graph.import: invalid nodes. Expecting an array.");for(P=0,Z=we.length;P<Z;P++)this.importNode(we[P],Fe)}if(C.edges){if(we=C.edges,!Array.isArray(we))throw new ve("Graph.import: invalid edges. Expecting an array.");for(P=0,Z=we.length;P<Z;P++)this.importEdge(we[P],Fe)}return this},oe.nullCopy=function(C){return new de(he({},this._options,C))},oe.emptyCopy=function(C){var P=this.nullCopy(C);return this._nodes.forEach(function(Z,we){var Fe=he({},Z.attributes);Z=new P.NodeDataClass(we,Fe),P._nodes.set(we,Z)}),P},oe.copy=function(){var C=new de(this._options);return C.import(this),C},oe.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(C){return C.upgradeToMixed()}),this._options.type="mixed",b(this,"type",this._options.type),$(this,"NodeDataClass",Me)),this},oe.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,b(this,"multi",!0),(C=this)._nodes.forEach(function(P,Z){if(P.out)for(var we in P.out){var Fe=new Set;Fe.add(P.out[we]),P.out[we]=Fe,C._nodes.get(we).in[Z]=Fe}if(P.undirected)for(var et in P.undirected)if(!(et>Z)){var Dt=new Set;Dt.add(P.undirected[et]),P.undirected[et]=Dt,C._nodes.get(et).undirected[Z]=Dt}})),this;var C},oe.clearIndex=function(){return this._nodes.forEach(function(C){void 0!==C.in&&(C.in={},C.out={}),void 0!==C.undirected&&(C.undirected={})}),this},oe.toJSON=function(){return this.export()},oe.toString=function(){return"[object Graph]"},oe.inspect=function(){var C=this,P={};this._nodes.forEach(function(Dt,$e){P[$e]=Dt.attributes});var Z={},we={};this._edges.forEach(function(Dt,$e){var Gt=Dt.undirected?"--":"->",Et="",gn="(".concat(Dt.source.key,")").concat(Gt,"(").concat(Dt.target.key,")");Dt.generatedKey?C.multi&&(void 0===we[gn]?we[gn]=0:we[gn]++,Et+="".concat(we[gn],". ")):Et+="[".concat($e,"]: "),Z[Et+=gn]=Dt.attributes});var Fe={};for(var et in this)this.hasOwnProperty(et)&&!Bn.has(et)&&"function"!=typeof this[et]&&(Fe[et]=this[et]);return Fe.attributes=this._attributes,Fe.nodes=P,Fe.edges=Z,$(Fe,"constructor",this.constructor),Fe},de}(A.exports.EventEmitter);"undefined"!=typeof Symbol&&(En.prototype[Symbol.for("nodejs.util.inspect.custom")]=En.prototype.inspect),[{name:function(ne){return"".concat(ne,"Edge")},generateKey:!0},{name:function(ne){return"".concat(ne,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(ne){return"".concat(ne,"EdgeWithKey")}},{name:function(ne){return"".concat(ne,"DirectedEdgeWithKey")},type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(ne){["add","merge","update"].forEach(function(de){var oe=ne.name(de),C="add"===de?pn:Un;En.prototype[oe]=ne.generateKey?function(P,Z,we){return C(this,oe,!0,"undirected"===(ne.type||this.type),null,P,Z,we,"update"===de)}:function(P,Z,we,Fe){return C(this,oe,!1,"undirected"===(ne.type||this.type),P,Z,we,Fe,"update"===de)}})}),"undefined"!=typeof Symbol&&(En.prototype[Symbol.iterator]=En.prototype.adjacency),ne=En,Ve.forEach(function(de){var oe=de.name,C=de.attacher;C(ne,oe("Edge"),"mixed"),C(ne,oe("DirectedEdge"),"directed"),C(ne,oe("UndirectedEdge"),"undirected")}),function(ne){Ie.forEach(function(de){var C,P,Z,we;Z=(C=de).type,we=C.direction,ne.prototype[P=C.name]=function(Fe,et){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(!arguments.length)return Oe(this,Z);if(1===arguments.length){var Dt=this._nodes.get(Fe=""+Fe);if(void 0===Dt)throw new te("Graph.".concat(P,': could not find the "').concat(Fe,'" node in the graph.'));return An(this.multi,"mixed"===Z?this.type:Z,we,Dt)}if(2===arguments.length){et=""+et;var $e=this._nodes.get(Fe=""+Fe);if(!$e)throw new te("Graph.".concat(P,':  could not find the "').concat(Fe,'" source node in the graph.'));if(!this._nodes.has(et))throw new te("Graph.".concat(P,':  could not find the "').concat(et,'" target node in the graph.'));return ci(Z,this.multi,we,$e,et)}throw new ve("Graph.".concat(P,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(oe,C){var P=C.name,Z=C.type,we=C.direction,Fe="forEach"+P[0].toUpperCase()+P.slice(1,-1);oe.prototype[Fe]=function(et,Dt,$e){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return Xe(this,Z,$e=et);if(2===arguments.length){$e=Dt;var Gt=this._nodes.get(et=""+et);if(void 0===Gt)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return Rn(this.multi,"mixed"===Z?this.type:Z,we,Gt,$e)}if(3===arguments.length){Dt=""+Dt;var Et=this._nodes.get(et=""+et);if(!Et)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Dt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Dt,'" target node in the graph.'));return jr(Z,this.multi,we,Et,Dt,$e)}throw new ve("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,de),function(oe,C){var P=C.name,Z=C.type,we=C.direction,Fe="forEach"+P[0].toUpperCase()+P.slice(1,-1)+"Until";oe.prototype[Fe]=function(et,Dt,$e){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return yt(this,Z,$e=et);if(2===arguments.length){$e=Dt;var Gt=this._nodes.get(et=""+et);if(void 0===Gt)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return zn(this.multi,"mixed"===Z?this.type:Z,we,Gt,$e)}if(3===arguments.length){Dt=""+Dt;var Et=this._nodes.get(et=""+et);if(!Et)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Dt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Dt,'" target node in the graph.'));return Is(Z,this.multi,we,Et,Dt,$e)}throw new ve("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,de),function(oe,C){var Z=C.type,we=C.direction,Fe=C.name.slice(0,-1)+"Entries";oe.prototype[Fe]=function(et,Dt){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return ee.empty();if(!arguments.length)return It(this,Z);if(1===arguments.length){var $e=this._nodes.get(et=""+et);if(!$e)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return _i(Z,we,$e)}if(2===arguments.length){Dt=""+Dt;var Gt=this._nodes.get(et=""+et);if(!Gt)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Dt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Dt,'" target node in the graph.'));return ss(Z,we,Gt,Dt)}throw new ve("Graph.".concat(Fe,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(ne,de)})}(En),function(ne){Os.forEach(function(de){var C,P,Z,we;Z=(C=de).type,we=C.direction,ne.prototype[P=C.name]=function(Fe){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(2===arguments.length){var et=""+arguments[0],Dt=""+arguments[1];if(!this._nodes.has(et))throw new te("Graph.".concat(P,': could not find the "').concat(et,'" node in the graph.'));if(!this._nodes.has(Dt))throw new te("Graph.".concat(P,': could not find the "').concat(Dt,'" node in the graph.'));return ot(this,Z,we,et,Dt)}if(1===arguments.length){var $e=this._nodes.get(Fe=""+Fe);if(void 0===$e)throw new te("Graph.".concat(P,': could not find the "').concat(Fe,'" node in the graph.'));return Va("mixed"===Z?this.type:Z,we,$e)}throw new ve("Graph.".concat(P,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(ne,de){var oe=de.name,C=de.type,P=de.direction,Z="forEach"+oe[0].toUpperCase()+oe.slice(1,-1);ne.prototype[Z]=function(we,Fe){if("mixed"===C||"mixed"===this.type||C===this.type){var et=this._nodes.get(we=""+we);if(void 0===et)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Dt,$e,Gt,Et){if("mixed"!==Dt){if("undirected"===Dt)return _l(Gt,Gt.undirected,Et);if("string"==typeof $e)return _l(Gt,Gt[$e],Et)}var gn=new Set;"undirected"!==Dt&&("out"!==$e&&aa(gn,Gt,Gt.in,Et),"in"!==$e&&aa(gn,Gt,Gt.out,Et)),"directed"!==Dt&&aa(gn,Gt,Gt.undirected,Et)}("mixed"===C?this.type:C,P,et,Fe)}}}(ne,de),function(ne,de){var oe=de.name,C=de.type,P=de.direction,Z="forEach"+oe[0].toUpperCase()+oe.slice(1,-1)+"Until";ne.prototype[Z]=function(we,Fe){if("mixed"===C||"mixed"===this.type||C===this.type){var et=this._nodes.get(we=""+we);if(void 0===et)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Dt,$e,Gt,Et){if("mixed"!==Dt){if("undirected"===Dt)return fs(Gt,Gt.undirected,Et);if("string"==typeof $e)return fs(Gt,Gt[$e],Et)}var gn=new Set;"undirected"!==Dt&&("out"!==$e&&Zt(gn,Gt,Gt.in,Et)||"in"!==$e&&Zt(gn,Gt,Gt.out,Et))||"directed"===Dt||Zt(gn,Gt,Gt.undirected,Et)}("mixed"===C?this.type:C,P,et,Fe)}}}(ne,de),function(ne,de){var C=de.type,P=de.direction,Z=de.name.slice(0,-1)+"Entries";ne.prototype[Z]=function(we){if("mixed"!==C&&"mixed"!==this.type&&C!==this.type)return ee.empty();var Fe=this._nodes.get(we=""+we);if(void 0===Fe)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));return function(et,Dt,$e){if("mixed"!==et){if("undirected"===et)return ja($e,$e.undirected);if("string"==typeof Dt)return ja($e,$e[Dt])}var Gt=ee.empty(),Et=new Set;return"undirected"!==et&&("out"!==Dt&&(Gt=Ee(Gt,rt(Et,$e,$e.in))),"in"!==Dt&&(Gt=Ee(Gt,rt(Et,$e,$e.out)))),"directed"!==et&&(Gt=Ee(Gt,rt(Et,$e,$e.undirected))),Gt}("mixed"===C?this.type:C,P,Fe)}}(ne,de)})}(En);var Qi=function(ne){function de(oe){var C=he({type:"directed"},oe);if("multi"in C&&!1!==C.multi)throw new ve("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==C.type)throw new ve('DirectedGraph.from: inconsistent "'+C.type+'" type in given options!');return ne.call(this,C)||this}return tt(de,ne),de}(En),Zi=function(ne){function de(oe){var C=he({type:"undirected"},oe);if("multi"in C&&!1!==C.multi)throw new ve("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==C.type)throw new ve('UndirectedGraph.from: inconsistent "'+C.type+'" type in given options!');return ne.call(this,C)||this}return tt(de,ne),de}(En),$n=function(ne){function de(oe){var C=he({multi:!0},oe);if("multi"in C&&!0!==C.multi)throw new ve("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return ne.call(this,C)||this}return tt(de,ne),de}(En),Fi=function(ne){function de(oe){var C=he({type:"directed",multi:!0},oe);if("multi"in C&&!0!==C.multi)throw new ve("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==C.type)throw new ve('MultiDirectedGraph.from: inconsistent "'+C.type+'" type in given options!');return ne.call(this,C)||this}return tt(de,ne),de}(En),la=function(ne){function de(oe){var C=he({type:"undirected",multi:!0},oe);if("multi"in C&&!0!==C.multi)throw new ve("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==C.type)throw new ve('MultiUndirectedGraph.from: inconsistent "'+C.type+'" type in given options!');return ne.call(this,C)||this}return tt(de,ne),de}(En);function zr(ne){ne.from=function(de,oe){var C=he({},de.options,oe),P=new ne(C);return P.import(de),P}}return zr(En),zr(Qi),zr(Zi),zr($n),zr(Fi),zr(la),En.Graph=En,En.DirectedGraph=Qi,En.UndirectedGraph=Zi,En.MultiGraph=$n,En.MultiDirectedGraph=Fi,En.MultiUndirectedGraph=la,En.InvalidArgumentsGraphError=ve,En.NotFoundGraphError=te,En.UsageGraphError=_e,En}()},524:(Vt,it,tt)=>{var gt;!function(J,xt,ut,Y){"use strict";var A,Ae=["","webkit","Moz","MS","ms","o"],he=xt.createElement("div"),j=Math.round,L=Math.abs,re=Date.now;function $(me,xe,He){return setTimeout(D(me,He),xe)}function b(me,xe,He){return!!Array.isArray(me)&&(S(me,He[xe],He),!0)}function S(me,xe,He){var mt;if(me)if(me.forEach)me.forEach(xe,He);else if(me.length!==Y)for(mt=0;mt<me.length;)xe.call(He,me[mt],mt,me),mt++;else for(mt in me)me.hasOwnProperty(mt)&&xe.call(He,me[mt],mt,me)}function R(me,xe,He){var mt="DEPRECATED METHOD: "+xe+"\n"+He+" AT \n";return function(){var Ut=new Error("get-stack-trace"),$t=Ut&&Ut.stack?Ut.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ni=J.console&&(J.console.warn||J.console.log);return ni&&ni.call(J.console,mt,$t),me.apply(this,arguments)}}A="function"!=typeof Object.assign?function(xe){if(xe===Y||null===xe)throw new TypeError("Cannot convert undefined or null to object");for(var He=Object(xe),mt=1;mt<arguments.length;mt++){var Ut=arguments[mt];if(Ut!==Y&&null!==Ut)for(var $t in Ut)Ut.hasOwnProperty($t)&&(He[$t]=Ut[$t])}return He}:Object.assign;var v=R(function(xe,He,mt){for(var Ut=Object.keys(He),$t=0;$t<Ut.length;)(!mt||mt&&xe[Ut[$t]]===Y)&&(xe[Ut[$t]]=He[Ut[$t]]),$t++;return xe},"extend","Use `assign`."),y=R(function(xe,He){return v(xe,He,!0)},"merge","Use `assign`.");function w(me,xe,He){var Ut,mt=xe.prototype;(Ut=me.prototype=Object.create(mt)).constructor=me,Ut._super=mt,He&&A(Ut,He)}function D(me,xe){return function(){return me.apply(xe,arguments)}}function V(me,xe){return"function"==typeof me?me.apply(xe&&xe[0]||Y,xe):me}function I(me,xe){return me===Y?xe:me}function H(me,xe,He){S(Q(xe),function(mt){me.addEventListener(mt,He,!1)})}function K(me,xe,He){S(Q(xe),function(mt){me.removeEventListener(mt,He,!1)})}function M(me,xe){for(;me;){if(me==xe)return!0;me=me.parentNode}return!1}function F(me,xe){return me.indexOf(xe)>-1}function Q(me){return me.trim().split(/\s+/g)}function E(me,xe,He){if(me.indexOf&&!He)return me.indexOf(xe);for(var mt=0;mt<me.length;){if(He&&me[mt][He]==xe||!He&&me[mt]===xe)return mt;mt++}return-1}function U(me){return Array.prototype.slice.call(me,0)}function ie(me,xe,He){for(var mt=[],Ut=[],$t=0;$t<me.length;){var ni=xe?me[$t][xe]:me[$t];E(Ut,ni)<0&&mt.push(me[$t]),Ut[$t]=ni,$t++}return He&&(mt=xe?mt.sort(function(Gr,gs){return Gr[xe]>gs[xe]}):mt.sort()),mt}function ue(me,xe){for(var He,mt,Ut=xe[0].toUpperCase()+xe.slice(1),$t=0;$t<Ae.length;){if((mt=(He=Ae[$t])?He+Ut:xe)in me)return mt;$t++}return Y}var ee=1;function Te(me){var xe=me.ownerDocument||me;return xe.defaultView||xe.parentWindow||J}var te="ontouchstart"in J,_e=ue(J,"PointerEvent")!==Y,Me=te&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),je="touch",Ze="mouse",wt=["x","y"],pt=["clientX","clientY"];function pe(me,xe){var He=this;this.manager=me,this.callback=xe,this.element=me.element,this.target=me.options.inputTarget,this.domHandler=function(mt){V(me.options.enable,[me])&&He.handler(mt)},this.init()}function O(me,xe,He){var mt=He.pointers.length,Ut=He.changedPointers.length,$t=1&xe&&mt-Ut==0,ni=12&xe&&mt-Ut==0;He.isFirst=!!$t,He.isFinal=!!ni,$t&&(me.session={}),He.eventType=xe,function(me,xe){var He=me.session,mt=xe.pointers,Ut=mt.length;He.firstInput||(He.firstInput=yt(xe)),Ut>1&&!He.firstMultiple?He.firstMultiple=yt(xe):1===Ut&&(He.firstMultiple=!1);var $t=He.firstInput,ni=He.firstMultiple,Nr=ni?ni.center:$t.center,Gr=xe.center=It(mt);xe.timeStamp=re(),xe.deltaTime=xe.timeStamp-$t.timeStamp,xe.angle=_i(Nr,Gr),xe.distance=zn(Nr,Gr),function(me,xe){var He=xe.center,mt=me.offsetDelta||{},Ut=me.prevDelta||{},$t=me.prevInput||{};(1===xe.eventType||4===$t.eventType)&&(Ut=me.prevDelta={x:$t.deltaX||0,y:$t.deltaY||0},mt=me.offsetDelta={x:He.x,y:He.y}),xe.deltaX=Ut.x+(He.x-mt.x),xe.deltaY=Ut.y+(He.y-mt.y)}(He,xe),xe.offsetDirection=Rn(xe.deltaX,xe.deltaY);var gs=An(xe.deltaTime,xe.deltaX,xe.deltaY);xe.overallVelocityX=gs.x,xe.overallVelocityY=gs.y,xe.overallVelocity=L(gs.x)>L(gs.y)?gs.x:gs.y,xe.scale=ni?function(me,xe){return zn(xe[0],xe[1],pt)/zn(me[0],me[1],pt)}(ni.pointers,mt):1,xe.rotation=ni?function(me,xe){return _i(xe[1],xe[0],pt)+_i(me[1],me[0],pt)}(ni.pointers,mt):0,xe.maxPointers=He.prevInput?xe.pointers.length>He.prevInput.maxPointers?xe.pointers.length:He.prevInput.maxPointers:xe.pointers.length,function(me,xe){var Ut,$t,ni,Nr,He=me.lastInterval||xe,mt=xe.timeStamp-He.timeStamp;if(8!=xe.eventType&&(mt>25||He.velocity===Y)){var Gr=xe.deltaX-He.deltaX,gs=xe.deltaY-He.deltaY,Jn=An(mt,Gr,gs);$t=Jn.x,ni=Jn.y,Ut=L(Jn.x)>L(Jn.y)?Jn.x:Jn.y,Nr=Rn(Gr,gs),me.lastInterval=xe}else Ut=He.velocity,$t=He.velocityX,ni=He.velocityY,Nr=He.direction;xe.velocity=Ut,xe.velocityX=$t,xe.velocityY=ni,xe.direction=Nr}(He,xe);var Jn=me.element;M(xe.srcEvent.target,Jn)&&(Jn=xe.srcEvent.target),xe.target=Jn}(me,He),me.emit("hammer.input",He),me.recognize(He),me.session.prevInput=He}function yt(me){for(var xe=[],He=0;He<me.pointers.length;)xe[He]={clientX:j(me.pointers[He].clientX),clientY:j(me.pointers[He].clientY)},He++;return{timeStamp:re(),pointers:xe,center:It(xe),deltaX:me.deltaX,deltaY:me.deltaY}}function It(me){var xe=me.length;if(1===xe)return{x:j(me[0].clientX),y:j(me[0].clientY)};for(var He=0,mt=0,Ut=0;Ut<xe;)He+=me[Ut].clientX,mt+=me[Ut].clientY,Ut++;return{x:j(He/xe),y:j(mt/xe)}}function An(me,xe,He){return{x:xe/me||0,y:He/me||0}}function Rn(me,xe){return me===xe?1:L(me)>=L(xe)?me<0?2:4:xe<0?8:16}function zn(me,xe,He){He||(He=wt);var mt=xe[He[0]]-me[He[0]],Ut=xe[He[1]]-me[He[1]];return Math.sqrt(mt*mt+Ut*Ut)}function _i(me,xe,He){return He||(He=wt),180*Math.atan2(xe[He[1]]-me[He[1]],xe[He[0]]-me[He[0]])/Math.PI}pe.prototype={handler:function(){},init:function(){this.evEl&&H(this.element,this.evEl,this.domHandler),this.evTarget&&H(this.target,this.evTarget,this.domHandler),this.evWin&&H(Te(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&K(this.element,this.evEl,this.domHandler),this.evTarget&&K(this.target,this.evTarget,this.domHandler),this.evWin&&K(Te(this.element),this.evWin,this.domHandler)}};var Is={mousedown:1,mousemove:2,mouseup:4},ss="mousedown",Os="mousemove mouseup";function Ur(){this.evEl=ss,this.evWin=Os,this.pressed=!1,pe.apply(this,arguments)}w(Ur,pe,{handler:function(xe){var He=Is[xe.type];1&He&&0===xe.button&&(this.pressed=!0),2&He&&1!==xe.which&&(He=4),this.pressed&&(4&He&&(this.pressed=!1),this.callback(this.manager,He,{pointers:[xe],changedPointers:[xe],pointerType:Ze,srcEvent:xe}))}});var Va={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},_l={2:je,3:"pen",4:Ze,5:"kinect"},aa="pointerdown",fs="pointermove pointerup pointercancel";function Zt(){this.evEl=aa,this.evWin=fs,pe.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}J.MSPointerEvent&&!J.PointerEvent&&(aa="MSPointerDown",fs="MSPointerMove MSPointerUp MSPointerCancel"),w(Zt,pe,{handler:function(xe){var He=this.store,mt=!1,Ut=xe.type.toLowerCase().replace("ms",""),$t=Va[Ut],ni=_l[xe.pointerType]||xe.pointerType,Nr=ni==je,Gr=E(He,xe.pointerId,"pointerId");1&$t&&(0===xe.button||Nr)?Gr<0&&(He.push(xe),Gr=He.length-1):12&$t&&(mt=!0),!(Gr<0)&&(He[Gr]=xe,this.callback(this.manager,$t,{pointers:He,changedPointers:[xe],pointerType:ni,srcEvent:xe}),mt&&He.splice(Gr,1))}});var ja={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rt="touchstart",ot="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=rt,this.evWin=ot,this.started=!1,pe.apply(this,arguments)}function fe(me,xe){var He=U(me.touches),mt=U(me.changedTouches);return 12&xe&&(He=ie(He.concat(mt),"identifier",!0)),[He,mt]}w(ct,pe,{handler:function(xe){var He=ja[xe.type];if(1===He&&(this.started=!0),this.started){var mt=fe.call(this,xe,He);12&He&&mt[0].length-mt[1].length==0&&(this.started=!1),this.callback(this.manager,He,{pointers:mt[0],changedPointers:mt[1],pointerType:je,srcEvent:xe})}}});var ye={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ke="touchstart touchmove touchend touchcancel";function lt(){this.evTarget=ke,this.targetIds={},pe.apply(this,arguments)}function Qe(me,xe){var He=U(me.touches),mt=this.targetIds;if(3&xe&&1===He.length)return mt[He[0].identifier]=!0,[He,He];var Ut,$t,ni=U(me.changedTouches),Nr=[],Gr=this.target;if($t=He.filter(function(gs){return M(gs.target,Gr)}),1===xe)for(Ut=0;Ut<$t.length;)mt[$t[Ut].identifier]=!0,Ut++;for(Ut=0;Ut<ni.length;)mt[ni[Ut].identifier]&&Nr.push(ni[Ut]),12&xe&&delete mt[ni[Ut].identifier],Ut++;return Nr.length?[ie($t.concat(Nr),"identifier",!0),Nr]:void 0}function At(){pe.apply(this,arguments);var me=D(this.handler,this);this.touch=new lt(this.manager,me),this.mouse=new Ur(this.manager,me),this.primaryTouch=null,this.lastTouches=[]}function qt(me,xe){1&me?(this.primaryTouch=xe.changedPointers[0].identifier,Bn.call(this,xe)):12&me&&Bn.call(this,xe)}function Bn(me){var xe=me.changedPointers[0];if(xe.identifier===this.primaryTouch){var He={x:xe.clientX,y:xe.clientY};this.lastTouches.push(He);var mt=this.lastTouches;setTimeout(function(){var $t=mt.indexOf(He);$t>-1&&mt.splice($t,1)},2500)}}function ti(me){for(var xe=me.srcEvent.clientX,He=me.srcEvent.clientY,mt=0;mt<this.lastTouches.length;mt++){var Ut=this.lastTouches[mt],$t=Math.abs(xe-Ut.x),ni=Math.abs(He-Ut.y);if($t<=25&&ni<=25)return!0}return!1}w(lt,pe,{handler:function(xe){var He=ye[xe.type],mt=Qe.call(this,xe,He);!mt||this.callback(this.manager,He,{pointers:mt[0],changedPointers:mt[1],pointerType:je,srcEvent:xe})}}),w(At,pe,{handler:function(xe,He,mt){var $t=mt.pointerType==Ze;if(!($t&&mt.sourceCapabilities&&mt.sourceCapabilities.firesTouchEvents)){if(mt.pointerType==je)qt.call(this,He,mt);else if($t&&ti.call(this,mt))return;this.callback(xe,He,mt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Dn=ue(he.style,"touchAction"),pn=Dn!==Y,Un="compute",Qi="manipulation",Zi="none",$n="pan-x",Fi="pan-y",la=function(){if(!pn)return!1;var me={},xe=J.CSS&&J.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(He){me[He]=!xe||J.CSS.supports("touch-action",He)}),me}();function zr(me,xe){this.manager=me,this.set(xe)}function Dt(me){this.options=A({},this.defaults,me||{}),this.id=ee++,this.manager=null,this.options.enable=I(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function $e(me){return 16&me?"cancel":8&me?"end":4&me?"move":2&me?"start":""}function Gt(me){return 16==me?"down":8==me?"up":2==me?"left":4==me?"right":""}function Et(me,xe){var He=xe.manager;return He?He.get(me):me}function gn(){Dt.apply(this,arguments)}function ps(){gn.apply(this,arguments),this.pX=null,this.pY=null}function Hr(){gn.apply(this,arguments)}function Gs(){Dt.apply(this,arguments),this._timer=null,this._input=null}function yl(){gn.apply(this,arguments)}function io(){gn.apply(this,arguments)}function Rr(){Dt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Rs(me,xe){return(xe=xe||{}).recognizers=I(xe.recognizers,Rs.defaults.preset),new ro(me,xe)}function ro(me,xe){this.options=A({},Rs.defaults,xe||{}),this.options.inputTarget=this.options.inputTarget||me,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=me,this.input=function(me){return new(me.options.inputClass||(_e?Zt:Me?lt:te?At:Ur))(me,O)}(this),this.touchAction=new zr(this,this.options.touchAction),vl(this,!0),S(this.options.recognizers,function(He){var mt=this.add(new He[0](He[1]));He[2]&&mt.recognizeWith(He[2]),He[3]&&mt.requireFailure(He[3])},this)}function vl(me,xe){var mt,He=me.element;He.style&&(S(me.options.cssProps,function(Ut,$t){mt=ue(He.style,$t),xe?(me.oldCssProps[mt]=He.style[mt],He.style[mt]=Ut):He.style[mt]=me.oldCssProps[mt]||""}),xe||(me.oldCssProps={}))}zr.prototype={set:function(me){me==Un&&(me=this.compute()),pn&&this.manager.element.style&&la[me]&&(this.manager.element.style[Dn]=me),this.actions=me.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var me=[];return S(this.manager.recognizers,function(xe){V(xe.options.enable,[xe])&&(me=me.concat(xe.getTouchAction()))}),function(me){if(F(me,Zi))return Zi;var xe=F(me,$n),He=F(me,Fi);return xe&&He?Zi:xe||He?xe?$n:Fi:F(me,Qi)?Qi:"auto"}(me.join(" "))},preventDefaults:function(me){var xe=me.srcEvent,He=me.offsetDirection;if(!this.manager.session.prevented){var mt=this.actions,Ut=F(mt,Zi)&&!la[Zi],$t=F(mt,Fi)&&!la[Fi],ni=F(mt,$n)&&!la[$n];if(Ut&&1===me.pointers.length&&me.distance<2&&me.deltaTime<250)return;return ni&&$t||!(Ut||$t&&6&He||ni&&24&He)?void 0:this.preventSrc(xe)}xe.preventDefault()},preventSrc:function(me){this.manager.session.prevented=!0,me.preventDefault()}},Dt.prototype={defaults:{},set:function(me){return A(this.options,me),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(me){if(b(me,"recognizeWith",this))return this;var xe=this.simultaneous;return xe[(me=Et(me,this)).id]||(xe[me.id]=me,me.recognizeWith(this)),this},dropRecognizeWith:function(me){return b(me,"dropRecognizeWith",this)||(me=Et(me,this),delete this.simultaneous[me.id]),this},requireFailure:function(me){if(b(me,"requireFailure",this))return this;var xe=this.requireFail;return-1===E(xe,me=Et(me,this))&&(xe.push(me),me.requireFailure(this)),this},dropRequireFailure:function(me){if(b(me,"dropRequireFailure",this))return this;me=Et(me,this);var xe=E(this.requireFail,me);return xe>-1&&this.requireFail.splice(xe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(me){return!!this.simultaneous[me.id]},emit:function(me){var xe=this,He=this.state;function mt(Ut){xe.manager.emit(Ut,me)}He<8&&mt(xe.options.event+$e(He)),mt(xe.options.event),me.additionalEvent&&mt(me.additionalEvent),He>=8&&mt(xe.options.event+$e(He))},tryEmit:function(me){if(this.canEmit())return this.emit(me);this.state=32},canEmit:function(){for(var me=0;me<this.requireFail.length;){if(!(33&this.requireFail[me].state))return!1;me++}return!0},recognize:function(me){var xe=A({},me);if(!V(this.options.enable,[this,xe]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(xe),30&this.state&&this.tryEmit(xe)},process:function(me){},getTouchAction:function(){},reset:function(){}},w(gn,Dt,{defaults:{pointers:1},attrTest:function(me){var xe=this.options.pointers;return 0===xe||me.pointers.length===xe},process:function(me){var xe=this.state,He=me.eventType,mt=6&xe,Ut=this.attrTest(me);return mt&&(8&He||!Ut)?16|xe:mt||Ut?4&He?8|xe:2&xe?4|xe:2:32}}),w(ps,gn,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var me=this.options.direction,xe=[];return 6&me&&xe.push(Fi),24&me&&xe.push($n),xe},directionTest:function(me){var xe=this.options,He=!0,mt=me.distance,Ut=me.direction,$t=me.deltaX,ni=me.deltaY;return Ut&xe.direction||(6&xe.direction?(Ut=0===$t?1:$t<0?2:4,He=$t!=this.pX,mt=Math.abs(me.deltaX)):(Ut=0===ni?1:ni<0?8:16,He=ni!=this.pY,mt=Math.abs(me.deltaY))),me.direction=Ut,He&&mt>xe.threshold&&Ut&xe.direction},attrTest:function(me){return gn.prototype.attrTest.call(this,me)&&(2&this.state||!(2&this.state)&&this.directionTest(me))},emit:function(me){this.pX=me.deltaX,this.pY=me.deltaY;var xe=Gt(me.direction);xe&&(me.additionalEvent=this.options.event+xe),this._super.emit.call(this,me)}}),w(Hr,gn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Zi]},attrTest:function(me){return this._super.attrTest.call(this,me)&&(Math.abs(me.scale-1)>this.options.threshold||2&this.state)},emit:function(me){1!==me.scale&&(me.additionalEvent=this.options.event+(me.scale<1?"in":"out")),this._super.emit.call(this,me)}}),w(Gs,Dt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(me){var xe=this.options,He=me.pointers.length===xe.pointers,mt=me.distance<xe.threshold,Ut=me.deltaTime>xe.time;if(this._input=me,!mt||!He||12&me.eventType&&!Ut)this.reset();else if(1&me.eventType)this.reset(),this._timer=$(function(){this.state=8,this.tryEmit()},xe.time,this);else if(4&me.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(me){8===this.state&&(me&&4&me.eventType?this.manager.emit(this.options.event+"up",me):(this._input.timeStamp=re(),this.manager.emit(this.options.event,this._input)))}}),w(yl,gn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Zi]},attrTest:function(me){return this._super.attrTest.call(this,me)&&(Math.abs(me.rotation)>this.options.threshold||2&this.state)}}),w(io,gn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ps.prototype.getTouchAction.call(this)},attrTest:function(me){var He,xe=this.options.direction;return 30&xe?He=me.overallVelocity:6&xe?He=me.overallVelocityX:24&xe&&(He=me.overallVelocityY),this._super.attrTest.call(this,me)&&xe&me.offsetDirection&&me.distance>this.options.threshold&&me.maxPointers==this.options.pointers&&L(He)>this.options.velocity&&4&me.eventType},emit:function(me){var xe=Gt(me.offsetDirection);xe&&this.manager.emit(this.options.event+xe,me),this.manager.emit(this.options.event,me)}}),w(Rr,Dt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Qi]},process:function(me){var xe=this.options,He=me.pointers.length===xe.pointers,mt=me.distance<xe.threshold,Ut=me.deltaTime<xe.time;if(this.reset(),1&me.eventType&&0===this.count)return this.failTimeout();if(mt&&Ut&&He){if(4!=me.eventType)return this.failTimeout();var $t=!this.pTime||me.timeStamp-this.pTime<xe.interval,ni=!this.pCenter||zn(this.pCenter,me.center)<xe.posThreshold;if(this.pTime=me.timeStamp,this.pCenter=me.center,ni&&$t?this.count+=1:this.count=1,this._input=me,0==this.count%xe.taps)return this.hasRequireFailures()?(this._timer=$(function(){this.state=8,this.tryEmit()},xe.interval,this),2):8}return 32},failTimeout:function(){return this._timer=$(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Rs.VERSION="2.0.7",Rs.defaults={domEvents:!1,touchAction:Un,enable:!0,inputTarget:null,inputClass:null,preset:[[yl,{enable:!1}],[Hr,{enable:!1},["rotate"]],[io,{direction:6}],[ps,{direction:6},["swipe"]],[Rr],[Rr,{event:"doubletap",taps:2},["tap"]],[Gs]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},ro.prototype={set:function(me){return A(this.options,me),me.touchAction&&this.touchAction.update(),me.inputTarget&&(this.input.destroy(),this.input.target=me.inputTarget,this.input.init()),this},stop:function(me){this.session.stopped=me?2:1},recognize:function(me){var xe=this.session;if(!xe.stopped){this.touchAction.preventDefaults(me);var He,mt=this.recognizers,Ut=xe.curRecognizer;(!Ut||Ut&&8&Ut.state)&&(Ut=xe.curRecognizer=null);for(var $t=0;$t<mt.length;)He=mt[$t],2===xe.stopped||Ut&&He!=Ut&&!He.canRecognizeWith(Ut)?He.reset():He.recognize(me),!Ut&&14&He.state&&(Ut=xe.curRecognizer=He),$t++}},get:function(me){if(me instanceof Dt)return me;for(var xe=this.recognizers,He=0;He<xe.length;He++)if(xe[He].options.event==me)return xe[He];return null},add:function(me){if(b(me,"add",this))return this;var xe=this.get(me.options.event);return xe&&this.remove(xe),this.recognizers.push(me),me.manager=this,this.touchAction.update(),me},remove:function(me){if(b(me,"remove",this))return this;if(me=this.get(me)){var xe=this.recognizers,He=E(xe,me);-1!==He&&(xe.splice(He,1),this.touchAction.update())}return this},on:function(me,xe){if(me!==Y&&xe!==Y){var He=this.handlers;return S(Q(me),function(mt){He[mt]=He[mt]||[],He[mt].push(xe)}),this}},off:function(me,xe){if(me!==Y){var He=this.handlers;return S(Q(me),function(mt){xe?He[mt]&&He[mt].splice(E(He[mt],xe),1):delete He[mt]}),this}},emit:function(me,xe){this.options.domEvents&&function(me,xe){var He=xt.createEvent("Event");He.initEvent(me,!0,!0),He.gesture=xe,xe.target.dispatchEvent(He)}(me,xe);var He=this.handlers[me]&&this.handlers[me].slice();if(He&&He.length){xe.type=me,xe.preventDefault=function(){xe.srcEvent.preventDefault()};for(var mt=0;mt<He.length;)He[mt](xe),mt++}},destroy:function(){this.element&&vl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},A(Rs,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:ro,Input:pe,TouchAction:zr,TouchInput:lt,MouseInput:Ur,PointerEventInput:Zt,TouchMouseInput:At,SingleTouchInput:ct,Recognizer:Dt,AttrRecognizer:gn,Tap:Rr,Pan:ps,Swipe:io,Pinch:Hr,Rotate:yl,Press:Gs,on:H,off:K,each:S,merge:y,extend:v,assign:A,inherit:w,bindFn:D,prefixed:ue}),(void 0!==J?J:"undefined"!=typeof self?self:{}).Hammer=Rs,(gt=function(){return Rs}.call(it,tt,it,Vt))!==Y&&(Vt.exports=gt)}(window,document)},815:function(Vt,it,tt){var gt;Vt=tt.nmd(Vt),function(){var J,Ae="Expected a function",W="__lodash_hash_undefined__",L="__lodash_placeholder__",V=32,H=128,se=1/0,Te=9007199254740991,_e=4294967295,nt=[["ary",H],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",V],["partialRight",64],["rearg",256]],Ze="[object Arguments]",Je="[object Array]",Ve="[object Boolean]",Le="[object Date]",Ie="[object Error]",Ue="[object Function]",qe="[object GeneratorFunction]",Be="[object Map]",z="[object Number]",be="[object Object]",ce="[object Promise]",wt="[object RegExp]",pt="[object Set]",pe="[object String]",B="[object Symbol]",k="[object WeakMap]",Xe="[object ArrayBuffer]",yt="[object DataView]",It="[object Float32Array]",An="[object Float64Array]",Rn="[object Int8Array]",zn="[object Int16Array]",_i="[object Int32Array]",ci="[object Uint8Array]",jr="[object Uint8ClampedArray]",Is="[object Uint16Array]",ss="[object Uint32Array]",Os=/\b__p \+= '';/g,Ur=/\b(__p \+=) '' \+/g,Va=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_l=/&(?:amp|lt|gt|quot|#39);/g,aa=/[&<>"']/g,fs=RegExp(_l.source),Zt=RegExp(aa.source),ja=/<%-([\s\S]+?)%>/g,rt=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,ct=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fe=/^\w*$/,ye=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/[\\^$.*+?()[\]{}|]/g,lt=RegExp(ke.source),Qe=/^\s+/,vt=/\s/,St=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,At=/\{\n\/\* \[wrapped with (.+)\] \*/,qt=/,? & /,Bn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ti=/[()=,{}\[\]\/\s]/,Dn=/\\(\\)?/g,pn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Un=/\w*$/,En=/^[-+]0x[0-9a-f]+$/i,Qi=/^0b[01]+$/i,Zi=/^\[object .+?Constructor\]$/,$n=/^0o[0-7]+$/i,Fi=/^(?:0|[1-9]\d*)$/,la=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,zr=/($^)/,ne=/['\n\r\u2028\u2029\\]/g,de="\\ud800-\\udfff",Z="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",Fe="a-z\\xdf-\\xf6\\xf8-\\xff",Et="A-Z\\xc0-\\xd6\\xd8-\\xde",gn="\\ufe0e\\ufe0f",ps="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Gs="["+de+"]",yl="["+ps+"]",io="["+Z+"]",Rr="\\d+",Rs="["+we+"]",rc="["+Fe+"]",bn="[^"+de+ps+Rr+we+Fe+Et+"]",ro="\\ud83c[\\udffb-\\udfff]",ca="[^"+de+"]",Zu="(?:\\ud83c[\\udde6-\\uddff]){2}",me="[\\ud800-\\udbff][\\udc00-\\udfff]",xe="["+Et+"]",mt="(?:"+rc+"|"+bn+")",Ut="(?:"+xe+"|"+bn+")",$t="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ni="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Nr="(?:"+io+"|"+ro+")?",Gr="["+gn+"]?",mx=Gr+Nr+"(?:\\u200d(?:"+[ca,Zu,me].join("|")+")"+Gr+Nr+")*",Ju="(?:"+[Rs,Zu,me].join("|")+")"+mx,$i="(?:"+[ca+io+"?",io,Zu,me,Gs].join("|")+")",jf=RegExp("['\u2019]","g"),wm=RegExp(io,"g"),ch=RegExp(ro+"(?="+ro+")|"+$i+mx,"g"),ab=RegExp([xe+"?"+rc+"+"+$t+"(?="+[yl,xe,"$"].join("|")+")",Ut+"+"+ni+"(?="+[yl,xe+mt,"$"].join("|")+")",xe+"?"+mt+"+"+$t,xe+"+"+ni,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rr,Ju].join("|"),"g"),_x=RegExp("[\\u200d"+de+Z+gn+"]"),bl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,uh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yx=-1,yn={};yn[It]=yn[An]=yn[Rn]=yn[zn]=yn[_i]=yn[ci]=yn[jr]=yn[Is]=yn[ss]=!0,yn[Ze]=yn[Je]=yn[Xe]=yn[Ve]=yn[yt]=yn[Le]=yn[Ie]=yn[Ue]=yn[Be]=yn[z]=yn[be]=yn[wt]=yn[pt]=yn[pe]=yn[k]=!1;var Ji={};Ji[Ze]=Ji[Je]=Ji[Xe]=Ji[yt]=Ji[Ve]=Ji[Le]=Ji[It]=Ji[An]=Ji[Rn]=Ji[zn]=Ji[_i]=Ji[Be]=Ji[z]=Ji[be]=Ji[wt]=Ji[pt]=Ji[pe]=Ji[B]=Ji[ci]=Ji[jr]=Ji[Is]=Ji[ss]=!0,Ji[Ie]=Ji[Ue]=Ji[k]=!1;var cn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},vx=parseFloat,db=parseInt,Bt="object"==typeof global&&global&&global.Object===Object&&global,Ns="object"==typeof self&&self&&self.Object===Object&&self,Ii=Bt||Ns||Function("return this")(),wl=it&&!it.nodeType&&it,ua=wl&&Vt&&!Vt.nodeType&&Vt,bo=ua&&ua.exports===wl,Em=bo&&Bt.process,pr=function(){try{return ua&&ua.require&&ua.require("util").types||Em&&Em.binding&&Em.binding("util")}catch(Tt){}}(),tn=pr&&pr.isArrayBuffer,ii=pr&&pr.isDate,nr=pr&&pr.isMap,so=pr&&pr.isRegExp,sc=pr&&pr.isSet,Xr=pr&&pr.isTypedArray;function Qr(st,Tt,_t){switch(_t.length){case 0:return st.call(Tt);case 1:return st.call(Tt,_t[0]);case 2:return st.call(Tt,_t[0],_t[1]);case 3:return st.call(Tt,_t[0],_t[1],_t[2])}return st.apply(Tt,_t)}function Pr(st,Tt,_t,ln){for(var Cn=-1,Ti=null==st?0:st.length;++Cn<Ti;){var $r=st[Cn];Tt(ln,$r,_t($r),st)}return ln}function Ps(st,Tt){for(var _t=-1,ln=null==st?0:st.length;++_t<ln&&!1!==Tt(st[_t],_t,st););return st}function ed(st,Tt){for(var _t=null==st?0:st.length;_t--&&!1!==Tt(st[_t],_t,st););return st}function Qn(st,Tt){for(var _t=-1,ln=null==st?0:st.length;++_t<ln;)if(!Tt(st[_t],_t,st))return!1;return!0}function da(st,Tt){for(var _t=-1,ln=null==st?0:st.length,Cn=0,Ti=[];++_t<ln;){var $r=st[_t];Tt($r,_t,st)&&(Ti[Cn++]=$r)}return Ti}function El(st,Tt){return!(null==st||!st.length)&&Ua(st,Tt,0)>-1}function dh(st,Tt,_t){for(var ln=-1,Cn=null==st?0:st.length;++ln<Cn;)if(_t(Tt,st[ln]))return!0;return!1}function Li(st,Tt){for(var _t=-1,ln=null==st?0:st.length,Cn=Array(ln);++_t<ln;)Cn[_t]=Tt(st[_t],_t,st);return Cn}function Fr(st,Tt){for(var _t=-1,ln=Tt.length,Cn=st.length;++_t<ln;)st[Cn+_t]=Tt[_t];return st}function Jc(st,Tt,_t,ln){var Cn=-1,Ti=null==st?0:st.length;for(ln&&Ti&&(_t=st[++Cn]);++Cn<Ti;)_t=Tt(_t,st[Cn],Cn,st);return _t}function td(st,Tt,_t,ln){var Cn=null==st?0:st.length;for(ln&&Cn&&(_t=st[--Cn]);Cn--;)_t=Tt(_t,st[Cn],Cn,st);return _t}function wo(st,Tt){for(var _t=-1,ln=null==st?0:st.length;++_t<ln;)if(Tt(st[_t],_t,st))return!0;return!1}var er=Sm("length");function hh(st,Tt,_t){var ln;return _t(st,function(Cn,Ti,$r){if(Tt(Cn,Ti,$r))return ln=Ti,!1}),ln}function nd(st,Tt,_t,ln){for(var Cn=st.length,Ti=_t+(ln?1:-1);ln?Ti--:++Ti<Cn;)if(Tt(st[Ti],Ti,st))return Ti;return-1}function Ua(st,Tt,_t){return Tt==Tt?function(st,Tt,_t){for(var ln=_t-1,Cn=st.length;++ln<Cn;)if(st[ln]===Tt)return ln;return-1}(st,Tt,_t):nd(st,oc,_t)}function Uf(st,Tt,_t,ln){for(var Cn=_t-1,Ti=st.length;++Cn<Ti;)if(ln(st[Cn],Tt))return Cn;return-1}function oc(st){return st!=st}function ms(st,Tt){var _t=null==st?0:st.length;return _t?id(st,Tt)/_t:NaN}function Sm(st){return function(Tt){return null==Tt?J:Tt[st]}}function ko(st){return function(Tt){return null==st?J:st[Tt]}}function Bo(st,Tt,_t,ln,Cn){return Cn(st,function(Ti,$r,Bi){_t=ln?(ln=!1,Ti):Tt(_t,Ti,$r,Bi)}),_t}function id(st,Tt){for(var _t,ln=-1,Cn=st.length;++ln<Cn;){var Ti=Tt(st[ln]);Ti!==J&&(_t=_t===J?Ti:_t+Ti)}return _t}function rd(st,Tt){for(var _t=-1,ln=Array(st);++_t<st;)ln[_t]=Tt(_t);return ln}function hb(st){return st&&st.slice(0,ac(st)+1).replace(Qe,"")}function Vo(st){return function(Tt){return st(Tt)}}function xm(st,Tt){return Li(Tt,function(_t){return st[_t]})}function fh(st,Tt){return st.has(Tt)}function Ex(st,Tt){for(var _t=-1,ln=st.length;++_t<ln&&Ua(Tt,st[_t],0)>-1;);return _t}function Sx(st,Tt){for(var _t=st.length;_t--&&Ua(Tt,st[_t],0)>-1;);return _t}function dP(st,Tt){for(var _t=st.length,ln=0;_t--;)st[_t]===Tt&&++ln;return ln}var hP=ko({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),fP=ko({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function pP(st){return"\\"+cn[st]}function ph(st){return _x.test(st)}function fb(st){var Tt=-1,_t=Array(st.size);return st.forEach(function(ln,Cn){_t[++Tt]=[Cn,ln]}),_t}function Cx(st,Tt){return function(_t){return st(Tt(_t))}}function eu(st,Tt){for(var _t=-1,ln=st.length,Cn=0,Ti=[];++_t<ln;){var $r=st[_t];($r===Tt||$r===L)&&(st[_t]=L,Ti[Cn++]=_t)}return Ti}function Am(st){var Tt=-1,_t=Array(st.size);return st.forEach(function(ln){_t[++Tt]=ln}),_t}function gh(st){return ph(st)?function(st){for(var Tt=ch.lastIndex=0;ch.test(st);)++Tt;return Tt}(st):er(st)}function za(st){return ph(st)?function(st){return st.match(ch)||[]}(st):function(st){return st.split("")}(st)}function ac(st){for(var Tt=st.length;Tt--&&vt.test(st.charAt(Tt)););return Tt}var zf=ko({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),mh=function st(Tt){var u,_t=(Tt=null==Tt?Ii:mh.defaults(Ii.Object(),Tt,mh.pick(Ii,uh))).Array,ln=Tt.Date,Cn=Tt.Error,Ti=Tt.Function,$r=Tt.Math,Bi=Tt.Object,Dm=Tt.RegExp,Mm=Tt.String,fa=Tt.TypeError,ir=_t.prototype,tu=Bi.prototype,Hf=Tt["__core-js_shared__"],gr=Ti.prototype.toString,Vi=tu.hasOwnProperty,bP=0,_h=(u=/[^.]+$/.exec(Hf&&Hf.keys&&Hf.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"",$s=tu.toString,Tx=gr.call(Bi),Im=Ii._,sd=Dm("^"+gr.call(Vi).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fs=bo?Tt.Buffer:J,Sl=Tt.Symbol,od=Tt.Uint8Array,mb=Fs?Fs.allocUnsafe:J,pa=Cx(Bi.getPrototypeOf,Bi),Om=Bi.create,Gf=tu.propertyIsEnumerable,Pn=ir.splice,Dx=Sl?Sl.isConcatSpreadable:J,yh=Sl?Sl.iterator:J,nu=Sl?Sl.toStringTag:J,$f=function(){try{var u=_c(Bi,"defineProperty");return u({},"",{}),u}catch(h){}}(),_b=Tt.clearTimeout!==Ii.clearTimeout&&Tt.clearTimeout,Mx=ln&&ln.now!==Ii.Date.now&&ln.now,Ix=Tt.setTimeout!==Ii.setTimeout&&Tt.setTimeout,kt=$r.ceil,ui=$r.floor,jo=Bi.getOwnPropertySymbols,Zr=Fs?Fs.isBuffer:J,Rm=Tt.isFinite,vh=ir.join,Ha=Cx(Bi.keys,Bi),Lr=$r.max,os=$r.min,wP=ln.now,Ox=Tt.parseInt,bh=$r.random,Wf=ir.reverse,_s=_c(Tt,"DataView"),oo=_c(Tt,"Map"),qf=_c(Tt,"Promise"),ga=_c(Tt,"Set"),Eo=_c(Tt,"WeakMap"),wh=_c(Bi,"create"),Eh=Eo&&new Eo,ad={},Rx=pu(_s),Nm=pu(oo),Pm=pu(qf),yb=pu(ga),Fm=pu(Eo),Yf=Sl?Sl.prototype:J,ld=Yf?Yf.valueOf:J,Sh=Yf?Yf.toString:J;function Se(u){if(yr(u)&&!Tn(u)&&!(u instanceof ri)){if(u instanceof So)return u;if(Vi.call(u,"__wrapped__"))return yp(u)}return new So(u)}var iu=function(){function u(){}return function(h){if(!_r(h))return{};if(Om)return Om(h);u.prototype=h;var m=new u;return u.prototype=J,m}}();function Ch(){}function So(u,h){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=J}function ri(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function ao(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var N=u[h];this.set(N[0],N[1])}}function Cl(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var N=u[h];this.set(N[0],N[1])}}function Ga(u){var h=-1,m=null==u?0:u.length;for(this.clear();++h<m;){var N=u[h];this.set(N[0],N[1])}}function ma(u){var h=-1,m=null==u?0:u.length;for(this.__data__=new Ga;++h<m;)this.add(u[h])}function _a(u){var h=this.__data__=new Cl(u);this.size=h.size}function Ah(u,h){var m=Tn(u),N=!m&&Ja(u),ae=!m&&!N&&el(u),Ce=!m&&!N&&!ae&&Uh(u),ze=m||N||ae||Ce,Ye=ze?rd(u.length,Mm):[],at=Ye.length;for(var Rt in u)(h||Vi.call(u,Rt))&&(!ze||!("length"==Rt||ae&&("offset"==Rt||"parent"==Rt)||Ce&&("buffer"==Rt||"byteLength"==Rt||"byteOffset"==Rt)||Ao(Rt,at)))&&Ye.push(Rt);return Ye}function Vm(u){var h=u.length;return h?u[xl(0,h-1)]:J}function bb(u,h){return Sd(qs(u),ru(h,0,u.length))}function cd(u){return Sd(qs(u))}function jm(u,h,m){(m!==J&&!xn(u[h],m)||m===J&&!(h in u))&&Wa(u,h,m)}function $a(u,h,m){var N=u[h];(!Vi.call(u,h)||!xn(N,m)||m===J&&!(h in u))&&Wa(u,h,m)}function ud(u,h){for(var m=u.length;m--;)if(xn(u[m][0],h))return m;return-1}function Jf(u,h,m,N){return uc(u,function(ae,Ce,ze){h(N,ae,m(ae),ze)}),N}function Gx(u,h){return u&&va(h,Es(h),u)}function Wa(u,h,m){"__proto__"==h&&$f?$f(u,h,{configurable:!0,enumerable:!0,value:m,writable:!0}):u[h]=m}function Um(u,h){for(var m=-1,N=h.length,ae=_t(N),Ce=null==u;++m<N;)ae[m]=Ce?J:Gh(u,h[m]);return ae}function ru(u,h,m){return u==u&&(m!==J&&(u=u<=m?u:m),h!==J&&(u=u>=h?u:h)),u}function Ls(u,h,m,N,ae,Ce){var ze,Ye=1&h,at=2&h,Rt=4&h;if(m&&(ze=ae?m(u,N,ae,Ce):m(u)),ze!==J)return ze;if(!_r(u))return u;var Nt=Tn(u);if(Nt){if(ze=function(u){var h=u.length,m=new u.constructor(h);return h&&"string"==typeof u[0]&&Vi.call(u,"index")&&(m.index=u.index,m.input=u.input),m}(u),!Ye)return qs(u,ze)}else{var jt=Bs(u),en=jt==Ue||jt==qe;if(el(u))return ap(u,Ye);if(jt==be||jt==Ze||en&&!ae){if(ze=at||en?{}:Hb(u),!Ye)return at?function(u,h){return va(u,jb(u),h)}(u,function(u,h){return u&&va(h,Ks(h),u)}(ze,u)):function(u,h){return va(u,i_(u),h)}(u,Gx(ze,u))}else{if(!Ji[jt])return ae?u:{};ze=function(u,h,m){var N=u.constructor;switch(h){case Xe:return uu(u);case Ve:case Le:return new N(+u);case yt:return function(u,h){var m=h?uu(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.byteLength)}(u,m);case It:case An:case Rn:case zn:case _i:case ci:case jr:case Is:case ss:return Zm(u,m);case Be:return new N;case z:case pe:return new N(u);case wt:return function(u){var h=new u.constructor(u.source,Un.exec(u));return h.lastIndex=u.lastIndex,h}(u);case pt:return new N;case B:return function(u){return ld?Bi(ld.call(u)):{}}(u)}}(u,jt,Ye)}}Ce||(Ce=new _a);var vn=Ce.get(u);if(vn)return vn;Ce.set(u,ze),dA(u)?u.forEach(function(Fn){ze.add(Ls(Fn,h,m,Fn,u,Ce))}):aA(u)&&u.forEach(function(Fn,ai){ze.set(ai,Ls(Fn,h,m,ai,u,Ce))});var oi=Nt?J:(Rt?at?t_:Ml:at?Ks:Es)(u);return Ps(oi||u,function(Fn,ai){oi&&(Fn=u[ai=Fn]),$a(ze,ai,Ls(Fn,h,m,ai,u,Ce))}),ze}function ep(u,h,m){var N=m.length;if(null==u)return!N;for(u=Bi(u);N--;){var ae=m[N],ze=u[ae];if(ze===J&&!(ae in u)||!(0,h[ae])(ze))return!1}return!0}function Th(u,h,m){if("function"!=typeof u)throw new fa(Ae);return Ph(function(){u.apply(J,m)},h)}function cc(u,h,m,N){var ae=-1,Ce=El,ze=!0,Ye=u.length,at=[],Rt=h.length;if(!Ye)return at;m&&(h=Li(h,Vo(m))),N?(Ce=dh,ze=!1):h.length>=200&&(Ce=fh,ze=!1,h=new ma(h));e:for(;++ae<Ye;){var Nt=u[ae],jt=null==m?Nt:m(Nt);if(Nt=N||0!==Nt?Nt:0,ze&&jt==jt){for(var en=Rt;en--;)if(h[en]===jt)continue e;at.push(Nt)}else Ce(h,jt,N)||at.push(Nt)}return at}Se.templateSettings={escape:ja,evaluate:rt,interpolate:ot,variable:"",imports:{_:Se}},(Se.prototype=Ch.prototype).constructor=Se,(So.prototype=iu(Ch.prototype)).constructor=So,(ri.prototype=iu(Ch.prototype)).constructor=ri,ao.prototype.clear=function(){this.__data__=wh?wh(null):{},this.size=0},ao.prototype.delete=function(u){var h=this.has(u)&&delete this.__data__[u];return this.size-=h?1:0,h},ao.prototype.get=function(u){var h=this.__data__;if(wh){var m=h[u];return m===W?J:m}return Vi.call(h,u)?h[u]:J},ao.prototype.has=function(u){var h=this.__data__;return wh?h[u]!==J:Vi.call(h,u)},ao.prototype.set=function(u,h){var m=this.__data__;return this.size+=this.has(u)?0:1,m[u]=wh&&h===J?W:h,this},Cl.prototype.clear=function(){this.__data__=[],this.size=0},Cl.prototype.delete=function(u){var h=this.__data__,m=ud(h,u);return!(m<0||(m==h.length-1?h.pop():Pn.call(h,m,1),--this.size,0))},Cl.prototype.get=function(u){var h=this.__data__,m=ud(h,u);return m<0?J:h[m][1]},Cl.prototype.has=function(u){return ud(this.__data__,u)>-1},Cl.prototype.set=function(u,h){var m=this.__data__,N=ud(m,u);return N<0?(++this.size,m.push([u,h])):m[N][1]=h,this},Ga.prototype.clear=function(){this.size=0,this.__data__={hash:new ao,map:new(oo||Cl),string:new ao}},Ga.prototype.delete=function(u){var h=ks(this,u).delete(u);return this.size-=h?1:0,h},Ga.prototype.get=function(u){return ks(this,u).get(u)},Ga.prototype.has=function(u){return ks(this,u).has(u)},Ga.prototype.set=function(u,h){var m=ks(this,u),N=m.size;return m.set(u,h),this.size+=m.size==N?0:1,this},ma.prototype.add=ma.prototype.push=function(u){return this.__data__.set(u,W),this},ma.prototype.has=function(u){return this.__data__.has(u)},_a.prototype.clear=function(){this.__data__=new Cl,this.size=0},_a.prototype.delete=function(u){var h=this.__data__,m=h.delete(u);return this.size=h.size,m},_a.prototype.get=function(u){return this.__data__.get(u)},_a.prototype.has=function(u){return this.__data__.has(u)},_a.prototype.set=function(u,h){var m=this.__data__;if(m instanceof Cl){var N=m.__data__;if(!oo||N.length<199)return N.push([u,h]),this.size=++m.size,this;m=this.__data__=new Ga(N)}return m.set(u,h),this.size=m.size,this};var uc=Ka(qa),Hm=Ka(tp,!0);function Eb(u,h){var m=!0;return uc(u,function(N,ae,Ce){return m=!!h(N,ae,Ce)}),m}function Dh(u,h,m){for(var N=-1,ae=u.length;++N<ae;){var Ce=u[N],ze=h(Ce);if(null!=ze&&(Ye===J?ze==ze&&!Qo(ze):m(ze,Ye)))var Ye=ze,at=Ce}return at}function Cb(u,h){var m=[];return uc(u,function(N,ae,Ce){h(N,ae,Ce)&&m.push(N)}),m}function ys(u,h,m,N,ae){var Ce=-1,ze=u.length;for(m||(m=c1),ae||(ae=[]);++Ce<ze;){var Ye=u[Ce];h>0&&m(Ye)?h>1?ys(Ye,h-1,m,N,ae):Fr(ae,Ye):N||(ae[ae.length]=Ye)}return ae}var dd=Ob(),hd=Ob(!0);function qa(u,h){return u&&dd(u,h,Es)}function tp(u,h){return u&&hd(u,h,Es)}function Mh(u,h){return da(h,function(m){return Xo(u[m])})}function Uo(u,h){for(var m=0,N=(h=pc(h,u)).length;null!=u&&m<N;)u=u[Zn(h[m++])];return m&&m==N?u:J}function Yi(u,h,m){var N=h(u);return Tn(u)?N:Fr(N,m(u))}function vs(u){return null==u?u===J?"[object Undefined]":"[object Null]":nu&&nu in Bi(u)?function(u){var h=Vi.call(u,nu),m=u[nu];try{u[nu]=J;var N=!0}catch(Ce){}var ae=$s.call(u);return N&&(h?u[nu]=m:delete u[nu]),ae}(u):function(u){return $s.call(u)}(u)}function zo(u,h){return u>h}function fd(u,h){return null!=u&&Vi.call(u,h)}function pd(u,h){return null!=u&&h in Bi(u)}function su(u,h,m){for(var N=m?dh:El,ae=u[0].length,Ce=u.length,ze=Ce,Ye=_t(Ce),at=1/0,Rt=[];ze--;){var Nt=u[ze];ze&&h&&(Nt=Li(Nt,Vo(h))),at=os(Nt.length,at),Ye[ze]=!m&&(h||ae>=120&&Nt.length>=120)?new ma(ze&&Nt):J}Nt=u[0];var jt=-1,en=Ye[0];e:for(;++jt<ae&&Rt.length<at;){var vn=Nt[jt],Nn=h?h(vn):vn;if(vn=m||0!==vn?vn:0,!(en?fh(en,Nn):N(Rt,Nn,m))){for(ze=Ce;--ze;){var oi=Ye[ze];if(!(oi?fh(oi,Nn):N(u[ze],Nn,m)))continue e}en&&en.push(Nn),Rt.push(vn)}}return Rt}function ya(u,h,m){var N=null==(u=a_(u,h=pc(h,u)))?u:u[Zn(qo(h))];return null==N?J:Qr(N,u,m)}function $x(u){return yr(u)&&vs(u)==Ze}function np(u,h,m,N,ae){return u===h||(null==u||null==h||!yr(u)&&!yr(h)?u!=u&&h!=h:function(u,h,m,N,ae,Ce){var ze=Tn(u),Ye=Tn(h),at=ze?Je:Bs(u),Rt=Ye?Je:Bs(h),Nt=(at=at==Ze?be:at)==be,jt=(Rt=Rt==Ze?be:Rt)==be,en=at==Rt;if(en&&el(u)){if(!el(h))return!1;ze=!0,Nt=!1}if(en&&!Nt)return Ce||(Ce=new _a),ze||Uh(u)?fp(u,h,m,N,ae,Ce):function(u,h,m,N,ae,Ce,ze){switch(m){case yt:if(u.byteLength!=h.byteLength||u.byteOffset!=h.byteOffset)return!1;u=u.buffer,h=h.buffer;case Xe:return!(u.byteLength!=h.byteLength||!Ce(new od(u),new od(h)));case Ve:case Le:case z:return xn(+u,+h);case Ie:return u.name==h.name&&u.message==h.message;case wt:case pe:return u==h+"";case Be:var Ye=fb;case pt:if(Ye||(Ye=Am),u.size!=h.size&&!(1&N))return!1;var Rt=ze.get(u);if(Rt)return Rt==h;N|=2,ze.set(u,h);var Nt=fp(Ye(u),Ye(h),N,ae,Ce,ze);return ze.delete(u),Nt;case B:if(ld)return ld.call(u)==ld.call(h)}return!1}(u,h,at,m,N,ae,Ce);if(!(1&m)){var vn=Nt&&Vi.call(u,"__wrapped__"),Nn=jt&&Vi.call(h,"__wrapped__");if(vn||Nn){var oi=vn?u.value():u,Fn=Nn?h.value():h;return Ce||(Ce=new _a),ae(oi,Fn,m,N,Ce)}}return!!en&&(Ce||(Ce=new _a),function(u,h,m,N,ae,Ce){var ze=1&m,Ye=Ml(u),at=Ye.length;if(at!=Ml(h).length&&!ze)return!1;for(var jt=at;jt--;){var en=Ye[jt];if(!(ze?en in h:Vi.call(h,en)))return!1}var vn=Ce.get(u),Nn=Ce.get(h);if(vn&&Nn)return vn==h&&Nn==u;var oi=!0;Ce.set(u,h),Ce.set(h,u);for(var Fn=ze;++jt<at;){var ai=u[en=Ye[jt]],yi=h[en];if(N)var uo=ze?N(yi,ai,en,h,u,Ce):N(ai,yi,en,u,h,Ce);if(!(uo===J?ai===yi||ae(ai,yi,m,N,Ce):uo)){oi=!1;break}Fn||(Fn="constructor"==en)}if(oi&&!Fn){var js=u.constructor,Zo=h.constructor;js!=Zo&&"constructor"in u&&"constructor"in h&&!("function"==typeof js&&js instanceof js&&"function"==typeof Zo&&Zo instanceof Zo)&&(oi=!1)}return Ce.delete(u),Ce.delete(h),oi}(u,h,m,N,ae,Ce))}(u,h,m,N,np,ae))}function $m(u,h,m,N){var ae=m.length,Ce=ae,ze=!N;if(null==u)return!Ce;for(u=Bi(u);ae--;){var Ye=m[ae];if(ze&&Ye[2]?Ye[1]!==u[Ye[0]]:!(Ye[0]in u))return!1}for(;++ae<Ce;){var at=(Ye=m[ae])[0],Rt=u[at],Nt=Ye[1];if(ze&&Ye[2]){if(Rt===J&&!(at in u))return!1}else{var jt=new _a;if(N)var en=N(Rt,Nt,at,u,h,jt);if(!(en===J?np(Nt,Rt,3,N,jt):en))return!1}}return!0}function Wm(u){return!(!_r(u)||function(u){return!!_h&&_h in u}(u))&&(Xo(u)?sd:Zi).test(pu(u))}function Yx(u){return"function"==typeof u?u:null==u?Xs:"object"==typeof u?Tn(u)?md(u[0],u[1]):Xx(u):_u(u)}function xb(u){if(!mp(u))return Ha(u);var h=[];for(var m in Bi(u))Vi.call(u,m)&&"constructor"!=m&&h.push(m);return h}function Ab(u,h){return u<h}function Kx(u,h){var m=-1,N=lo(u)?_t(u.length):[];return uc(u,function(ae,Ce,ze){N[++m]=h(ae,Ce,ze)}),N}function Xx(u){var h=$o(u);return 1==h.length&&h[0][2]?d1(h[0][0],h[0][1]):function(m){return m===u||$m(m,u,h)}}function md(u,h){return Wo(u)&&u1(h)?d1(Zn(u),h):function(m){var N=Gh(m,u);return N===J&&N===h?Mp(m,u):np(h,N,3)}}function qm(u,h,m,N,ae){u!==h&&dd(h,function(Ce,ze){if(ae||(ae=new _a),_r(Ce))!function(u,h,m,N,ae,Ce,ze){var Ye=l_(u,m),at=l_(h,m),Rt=ze.get(at);if(Rt)jm(u,m,Rt);else{var Nt=Ce?Ce(Ye,at,m+"",u,h,ze):J,jt=Nt===J;if(jt){var en=Tn(at),vn=!en&&el(at),Nn=!en&&!vn&&Uh(at);Nt=at,en||vn||Nn?Tn(Ye)?Nt=Ye:mr(Ye)?Nt=qs(Ye):vn?(jt=!1,Nt=ap(at,!0)):Nn?(jt=!1,Nt=Zm(at,!0)):Nt=[]:Dp(at)||Ja(at)?(Nt=Ye,Ja(Ye)?Nt=L0(Ye):(!_r(Ye)||Xo(Ye))&&(Nt=Hb(at))):jt=!1}jt&&(ze.set(at,Nt),ae(Nt,at,N,Ce,ze),ze.delete(at)),jm(u,m,Nt)}}(u,h,ze,m,qm,N,ae);else{var Ye=N?N(l_(u,ze),Ce,ze+"",u,h,ae):J;Ye===J&&(Ye=Ce),jm(u,ze,Ye)}},Ks)}function ou(u,h){var m=u.length;if(m)return Ao(h+=h<0?m:0,m)?u[h]:J}function Ih(u,h,m){h=h.length?Li(h,function(Ce){return Tn(Ce)?function(ze){return Uo(ze,1===Ce.length?Ce[0]:Ce)}:Ce}):[Xs];var N=-1;return h=Li(h,Vo(On())),function(st,Tt){var _t=st.length;for(st.sort(function(Ce,ze){return function(u,h,m){for(var N=-1,ae=u.criteria,Ce=h.criteria,ze=ae.length,Ye=m.length;++N<ze;){var at=gc(ae[N],Ce[N]);if(at)return N>=Ye?at:at*("desc"==m[N]?-1:1)}return u.index-h.index}(Ce,ze,m)});_t--;)st[_t]=st[_t].value;return st}(Kx(u,function(Ce,ze,Ye){return{criteria:Li(h,function(Rt){return Rt(Ce)}),index:++N,value:Ce}}))}function Tb(u,h,m){for(var N=-1,ae=h.length,Ce={};++N<ae;){var ze=h[N],Ye=Uo(u,ze);m(Ye,ze)&&rp(Ce,pc(ze,u),Ye)}return Ce}function Go(u,h,m,N){var ae=N?Uf:Ua,Ce=-1,ze=h.length,Ye=u;for(u===h&&(h=qs(h)),m&&(Ye=Li(u,Vo(m)));++Ce<ze;)for(var at=0,Rt=h[Ce],Nt=m?m(Rt):Rt;(at=ae(Ye,Nt,at,N))>-1;)Ye!==u&&Pn.call(Ye,at,1),Pn.call(u,at,1);return u}function Oh(u,h){for(var m=u?h.length:0,N=m-1;m--;){var ae=h[m];if(m==N||ae!==Ce){var Ce=ae;Ao(ae)?Pn.call(u,ae,1):au(u,ae)}}return u}function xl(u,h){return u+ui(bh()*(h-u+1))}function ip(u,h){var m="";if(!u||h<1||h>Te)return m;do{h%2&&(m+=u),(h=ui(h/2))&&(u+=u)}while(h);return m}function si(u,h){return _p(h1(u,h,Xs),u+"")}function Qx(u){return Vm(Rd(u))}function IP(u,h){var m=Rd(u);return Sd(m,ru(h,0,m.length))}function rp(u,h,m,N){if(!_r(u))return u;for(var ae=-1,Ce=(h=pc(h,u)).length,ze=Ce-1,Ye=u;null!=Ye&&++ae<Ce;){var at=Zn(h[ae]),Rt=m;if("__proto__"===at||"constructor"===at||"prototype"===at)return u;if(ae!=ze){var Nt=Ye[at];(Rt=N?N(Nt,at,Ye):J)===J&&(Rt=_r(Nt)?Nt:Ao(h[ae+1])?[]:{})}$a(Ye,at,Rt),Ye=Ye[at]}return u}var Ym=Eh?function(u,h){return Eh.set(u,h),u}:Xs,Co=$f?function(u,h){return $f(u,"toString",{configurable:!0,enumerable:!1,value:K_(h),writable:!0})}:Xs;function Km(u){return Sd(Rd(u))}function bs(u,h,m){var N=-1,ae=u.length;h<0&&(h=-h>ae?0:ae+h),(m=m>ae?ae:m)<0&&(m+=ae),ae=h>m?0:m-h>>>0,h>>>=0;for(var Ce=_t(ae);++N<ae;)Ce[N]=u[N+h];return Ce}function OP(u,h){var m;return uc(u,function(N,ae,Ce){return!(m=h(N,ae,Ce))}),!!m}function Rh(u,h,m){var N=0,ae=null==u?N:u.length;if("number"==typeof h&&h==h&&ae<=2147483647){for(;N<ae;){var Ce=N+ae>>>1,ze=u[Ce];null!==ze&&!Qo(ze)&&(m?ze<=h:ze<h)?N=Ce+1:ae=Ce}return ae}return Xm(u,h,Xs,m)}function Xm(u,h,m,N){var ae=0,Ce=null==u?0:u.length;if(0===Ce)return 0;for(var ze=(h=m(h))!=h,Ye=null===h,at=Qo(h),Rt=h===J;ae<Ce;){var Nt=ui((ae+Ce)/2),jt=m(u[Nt]),en=jt!==J,vn=null===jt,Nn=jt==jt,oi=Qo(jt);if(ze)var Fn=N||Nn;else Fn=Rt?Nn&&(N||en):Ye?Nn&&en&&(N||!vn):at?Nn&&en&&!vn&&(N||!oi):!vn&&!oi&&(N?jt<=h:jt<h);Fn?ae=Nt+1:Ce=Nt}return os(Ce,4294967294)}function Db(u,h){for(var m=-1,N=u.length,ae=0,Ce=[];++m<N;){var ze=u[m],Ye=h?h(ze):ze;if(!m||!xn(Ye,at)){var at=Ye;Ce[ae++]=0===ze?0:ze}}return Ce}function Mb(u){return"number"==typeof u?u:Qo(u)?NaN:+u}function xo(u){if("string"==typeof u)return u;if(Tn(u))return Li(u,xo)+"";if(Qo(u))return Sh?Sh.call(u):"";var h=u+"";return"0"==h&&1/u==-se?"-0":h}function hc(u,h,m){var N=-1,ae=El,Ce=u.length,ze=!0,Ye=[],at=Ye;if(m)ze=!1,ae=dh;else if(Ce>=200){var Rt=h?null:e_(u);if(Rt)return Am(Rt);ze=!1,ae=fh,at=new ma}else at=h?[]:Ye;e:for(;++N<Ce;){var Nt=u[N],jt=h?h(Nt):Nt;if(Nt=m||0!==Nt?Nt:0,ze&&jt==jt){for(var en=at.length;en--;)if(at[en]===jt)continue e;h&&at.push(jt),Ye.push(Nt)}else ae(at,jt,m)||(at!==Ye&&at.push(jt),Ye.push(Nt))}return Ye}function au(u,h){return null==(u=a_(u,h=pc(h,u)))||delete u[Zn(qo(h))]}function sp(u,h,m,N){return rp(u,h,m(Uo(u,h)),N)}function lu(u,h,m,N){for(var ae=u.length,Ce=N?ae:-1;(N?Ce--:++Ce<ae)&&h(u[Ce],Ce,u););return m?bs(u,N?0:Ce,N?Ce+1:ae):bs(u,N?Ce+1:0,N?ae:Ce)}function Zx(u,h){var m=u;return m instanceof ri&&(m=m.value()),Jc(h,function(N,ae){return ae.func.apply(ae.thisArg,Fr([N],ae.args))},m)}function cu(u,h,m){var N=u.length;if(N<2)return N?hc(u[0]):[];for(var ae=-1,Ce=_t(N);++ae<N;)for(var ze=u[ae],Ye=-1;++Ye<N;)Ye!=ae&&(Ce[ae]=cc(Ce[ae]||ze,u[Ye],h,m));return hc(ys(Ce,1),h,m)}function op(u,h,m){for(var N=-1,ae=u.length,Ce=h.length,ze={};++N<ae;)m(ze,u[N],N<Ce?h[N]:J);return ze}function fc(u){return mr(u)?u:[]}function Qm(u){return"function"==typeof u?u:Xs}function pc(u,h){return Tn(u)?u:Wo(u,h)?[u]:qb(Oi(u))}var Jx=si;function Ya(u,h,m){var N=u.length;return m=m===J?N:m,!h&&m>=N?u:bs(u,h,m)}var e1=_b||function(u){return Ii.clearTimeout(u)};function ap(u,h){if(h)return u.slice();var m=u.length,N=mb?mb(m):new u.constructor(m);return u.copy(N),N}function uu(u){var h=new u.constructor(u.byteLength);return new od(h).set(new od(u)),h}function Zm(u,h){var m=h?uu(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.length)}function gc(u,h){if(u!==h){var m=u!==J,N=null===u,ae=u==u,Ce=Qo(u),ze=h!==J,Ye=null===h,at=h==h,Rt=Qo(h);if(!Ye&&!Rt&&!Ce&&u>h||Ce&&ze&&at&&!Ye&&!Rt||N&&ze&&at||!m&&at||!ae)return 1;if(!N&&!Ce&&!Rt&&u<h||Rt&&m&&ae&&!N&&!Ce||Ye&&m&&ae||!ze&&ae||!at)return-1}return 0}function yd(u,h,m,N){for(var ae=-1,Ce=u.length,ze=m.length,Ye=-1,at=h.length,Rt=Lr(Ce-ze,0),Nt=_t(at+Rt),jt=!N;++Ye<at;)Nt[Ye]=h[Ye];for(;++ae<ze;)(jt||ae<Ce)&&(Nt[m[ae]]=u[ae]);for(;Rt--;)Nt[Ye++]=u[ae++];return Nt}function Ib(u,h,m,N){for(var ae=-1,Ce=u.length,ze=-1,Ye=m.length,at=-1,Rt=h.length,Nt=Lr(Ce-Ye,0),jt=_t(Nt+Rt),en=!N;++ae<Nt;)jt[ae]=u[ae];for(var vn=ae;++at<Rt;)jt[vn+at]=h[at];for(;++ze<Ye;)(en||ae<Ce)&&(jt[vn+m[ze]]=u[ae++]);return jt}function qs(u,h){var m=-1,N=u.length;for(h||(h=_t(N));++m<N;)h[m]=u[m];return h}function va(u,h,m,N){var ae=!m;m||(m={});for(var Ce=-1,ze=h.length;++Ce<ze;){var Ye=h[Ce],at=N?N(m[Ye],u[Ye],Ye,m,u):J;at===J&&(at=u[Ye]),ae?Wa(m,Ye,at):$a(m,Ye,at)}return m}function Wr(u,h){return function(m,N){var ae=Tn(m)?Pr:Jf,Ce=h?h():{};return ae(m,u,On(N,2),Ce)}}function Al(u){return si(function(h,m){var N=-1,ae=m.length,Ce=ae>1?m[ae-1]:J,ze=ae>2?m[2]:J;for(Ce=u.length>3&&"function"==typeof Ce?(ae--,Ce):J,ze&&Vs(m[0],m[1],ze)&&(Ce=ae<3?J:Ce,ae=1),h=Bi(h);++N<ae;){var Ye=m[N];Ye&&u(h,Ye,N,Ce)}return h})}function Ka(u,h){return function(m,N){if(null==m)return m;if(!lo(m))return u(m,N);for(var ae=m.length,Ce=h?ae:-1,ze=Bi(m);(h?Ce--:++Ce<ae)&&!1!==N(ze[Ce],Ce,ze););return m}}function Ob(u){return function(h,m,N){for(var ae=-1,Ce=Bi(h),ze=N(h),Ye=ze.length;Ye--;){var at=ze[u?Ye:++ae];if(!1===m(Ce[at],at,Ce))break}return h}}function lp(u){return function(h){var m=ph(h=Oi(h))?za(h):J,N=m?m[0]:h.charAt(0),ae=m?Ya(m,1).join(""):h.slice(1);return N[u]()+ae}}function Tl(u){return function(h){return Jc(q_(j_(h).replace(jf,"")),u,"")}}function bd(u){return function(){var h=arguments;switch(h.length){case 0:return new u;case 1:return new u(h[0]);case 2:return new u(h[0],h[1]);case 3:return new u(h[0],h[1],h[2]);case 4:return new u(h[0],h[1],h[2],h[3]);case 5:return new u(h[0],h[1],h[2],h[3],h[4]);case 6:return new u(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new u(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var m=iu(u.prototype),N=u.apply(m,h);return _r(N)?N:m}}function Nb(u){return function(h,m,N){var ae=Bi(h);if(!lo(h)){var Ce=On(m,3);h=Es(h),m=function(Ye){return Ce(ae[Ye],Ye,ae)}}var ze=u(h,m,N);return ze>-1?ae[Ce?h[ze]:ze]:J}}function hu(u){return Xa(function(h){var m=h.length,N=m,ae=So.prototype.thru;for(u&&h.reverse();N--;){var Ce=h[N];if("function"!=typeof Ce)throw new fa(Ae);if(ae&&!ze&&"wrapper"==pp(Ce))var ze=new So([],!0)}for(N=ze?N:m;++N<m;){var Ye=pp(Ce=h[N]),at="wrapper"==Ye?n_(Ce):J;ze=at&&gp(at[0])&&424==at[1]&&!at[4].length&&1==at[9]?ze[pp(at[0])].apply(ze,at[3]):1==Ce.length&&gp(Ce)?ze[Ye]():ze.thru(Ce)}return function(){var Rt=arguments,Nt=Rt[0];if(ze&&1==Rt.length&&Tn(Nt))return ze.plant(Nt).value();for(var jt=0,en=m?h[jt].apply(this,Rt):Nt;++jt<m;)en=h[jt].call(this,en);return en}})}function mc(u,h,m,N,ae,Ce,ze,Ye,at,Rt){var Nt=h&H,jt=1&h,en=2&h,vn=24&h,Nn=512&h,oi=en?J:bd(u);return function Fn(){for(var ai=arguments.length,yi=_t(ai),uo=ai;uo--;)yi[uo]=arguments[uo];if(vn)var js=Ed(Fn),Zo=dP(yi,js);if(N&&(yi=yd(yi,N,ae,vn)),Ce&&(yi=Ib(yi,Ce,ze,vn)),ai-=Zo,vn&&ai<Rt){var Ri=eu(yi,js);return Lb(u,h,mc,Fn.placeholder,m,yi,Ri,Ye,at,Rt-ai)}var il=jt?m:this,wc=en?il[u]:u;return ai=yi.length,Ye?yi=f1(yi,Ye):Nn&&ai>1&&yi.reverse(),Nt&&at<ai&&(yi.length=at),this&&this!==Ii&&this instanceof Fn&&(wc=oi||bd(wc)),wc.apply(il,yi)}}function Pb(u,h){return function(m,N){return function(u,h,m,N){return qa(u,function(ae,Ce,ze){h(N,m(ae),Ce,ze)}),N}(m,u,h(N),{})}}function Jm(u,h){return function(m,N){var ae;if(m===J&&N===J)return h;if(m!==J&&(ae=m),N!==J){if(ae===J)return N;"string"==typeof m||"string"==typeof N?(m=xo(m),N=xo(N)):(m=Mb(m),N=Mb(N)),ae=u(m,N)}return ae}}function cp(u){return Xa(function(h){return h=Li(h,Vo(On())),si(function(m){var N=this;return u(h,function(ae){return Qr(ae,N,m)})})})}function up(u,h){var m=(h=h===J?" ":xo(h)).length;if(m<2)return m?ip(h,u):h;var N=ip(h,kt(u/gh(h)));return ph(h)?Ya(za(N),0,u).join(""):N.slice(0,u)}function Fb(u){return function(h,m,N){return N&&"number"!=typeof N&&Vs(h,m,N)&&(m=N=J),h=tl(h),m===J?(m=h,h=0):m=tl(m),function(u,h,m,N){for(var ae=-1,Ce=Lr(kt((h-u)/(m||1)),0),ze=_t(Ce);Ce--;)ze[N?Ce:++ae]=u,u+=m;return ze}(h,m,N=N===J?h<m?1:-1:tl(N),u)}}function dp(u){return function(h,m){return"string"==typeof h&&"string"==typeof m||(h=co(h),m=co(m)),u(h,m)}}function Lb(u,h,m,N,ae,Ce,ze,Ye,at,Rt){var Nt=8&h;h|=Nt?V:64,4&(h&=~(Nt?64:V))||(h&=-4);var oi=[u,h,ae,Nt?Ce:J,Nt?ze:J,Nt?J:Ce,Nt?J:ze,Ye,at,Rt],Fn=m.apply(J,oi);return gp(u)&&Wb(Fn,oi),Fn.placeholder=N,Fh(Fn,u,h)}function wd(u){var h=$r[u];return function(m,N){if(m=co(m),(N=null==N?0:os(Kn(N),292))&&Rm(m)){var ae=(Oi(m)+"e").split("e");return+((ae=(Oi(h(ae[0]+"e"+(+ae[1]+N)))+"e").split("e"))[0]+"e"+(+ae[1]-N))}return h(m)}}var e_=ga&&1/Am(new ga([,-0]))[1]==se?function(u){return new ga(u)}:Z_;function fu(u){return function(h){var m=Bs(h);return m==Be?fb(h):m==pt?function(st){var Tt=-1,_t=Array(st.size);return st.forEach(function(ln){_t[++Tt]=[ln,ln]}),_t}(h):function(st,Tt){return Li(Tt,function(_t){return[_t,st[_t]]})}(h,u(h))}}function Dl(u,h,m,N,ae,Ce,ze,Ye){var at=2&h;if(!at&&"function"!=typeof u)throw new fa(Ae);var Rt=N?N.length:0;if(Rt||(h&=-97,N=ae=J),ze=ze===J?ze:Lr(Kn(ze),0),Ye=Ye===J?Ye:Kn(Ye),Rt-=ae?ae.length:0,64&h){var Nt=N,jt=ae;N=ae=J}var en=at?J:n_(u),vn=[u,h,m,N,ae,Nt,jt,Ce,ze,Ye];if(en&&function(u,h){var m=u[1],N=h[1],ae=m|N;if(!(ae<131||(N==H&&8==m||N==H&&256==m&&u[7].length<=h[8]||384==N&&h[7].length<=h[8]&&8==m)))return u;1&N&&(u[2]=h[2],ae|=1&m?0:4);var Ye=h[3];if(Ye){var at=u[3];u[3]=at?yd(at,Ye,h[4]):Ye,u[4]=at?eu(u[3],L):h[4]}(Ye=h[5])&&(u[5]=(at=u[5])?Ib(at,Ye,h[6]):Ye,u[6]=at?eu(u[5],L):h[6]),(Ye=h[7])&&(u[7]=Ye),N&H&&(u[8]=null==u[8]?h[8]:os(u[8],h[8])),null==u[9]&&(u[9]=h[9]),u[0]=h[0],u[1]=ae}(vn,en),u=vn[0],h=vn[1],m=vn[2],N=vn[3],ae=vn[4],!(Ye=vn[9]=vn[9]===J?at?0:u.length:Lr(vn[9]-Rt,0))&&24&h&&(h&=-25),h&&1!=h)Nn=8==h||16==h?function(u,h,m){var N=bd(u);return function ae(){for(var Ce=arguments.length,ze=_t(Ce),Ye=Ce,at=Ed(ae);Ye--;)ze[Ye]=arguments[Ye];var Rt=Ce<3&&ze[0]!==at&&ze[Ce-1]!==at?[]:eu(ze,at);return(Ce-=Rt.length)<m?Lb(u,h,mc,ae.placeholder,J,ze,Rt,J,J,m-Ce):Qr(this&&this!==Ii&&this instanceof ae?N:u,this,ze)}}(u,h,Ye):h!=V&&33!=h||ae.length?mc.apply(J,vn):function(u,h,m,N){var ae=1&h,Ce=bd(u);return function ze(){for(var Ye=-1,at=arguments.length,Rt=-1,Nt=N.length,jt=_t(Nt+at),en=this&&this!==Ii&&this instanceof ze?Ce:u;++Rt<Nt;)jt[Rt]=N[Rt];for(;at--;)jt[Rt++]=arguments[++Ye];return Qr(en,ae?m:this,jt)}}(u,h,m,N);else var Nn=function(u,h,m){var N=1&h,ae=bd(u);return function Ce(){return(this&&this!==Ii&&this instanceof Ce?ae:u).apply(N?m:this,arguments)}}(u,h,m);return Fh((en?Ym:Wb)(Nn,vn),u,h)}function kb(u,h,m,N){return u===J||xn(u,tu[m])&&!Vi.call(N,m)?h:u}function r1(u,h,m,N,ae,Ce){return _r(u)&&_r(h)&&(Ce.set(h,u),qm(u,h,J,r1,Ce),Ce.delete(h)),u}function hp(u){return Dp(u)?J:u}function fp(u,h,m,N,ae,Ce){var ze=1&m,Ye=u.length,at=h.length;if(Ye!=at&&!(ze&&at>Ye))return!1;var Rt=Ce.get(u),Nt=Ce.get(h);if(Rt&&Nt)return Rt==h&&Nt==u;var jt=-1,en=!0,vn=2&m?new ma:J;for(Ce.set(u,h),Ce.set(h,u);++jt<Ye;){var Nn=u[jt],oi=h[jt];if(N)var Fn=ze?N(oi,Nn,jt,h,u,Ce):N(Nn,oi,jt,u,h,Ce);if(Fn!==J){if(Fn)continue;en=!1;break}if(vn){if(!wo(h,function(ai,yi){if(!fh(vn,yi)&&(Nn===ai||ae(Nn,ai,m,N,Ce)))return vn.push(yi)})){en=!1;break}}else if(Nn!==oi&&!ae(Nn,oi,m,N,Ce)){en=!1;break}}return Ce.delete(u),Ce.delete(h),en}function Xa(u){return _p(h1(u,J,ws),u+"")}function Ml(u){return Yi(u,Es,i_)}function t_(u){return Yi(u,Ks,jb)}var n_=Eh?function(u){return Eh.get(u)}:Z_;function pp(u){for(var h=u.name+"",m=ad[h],N=Vi.call(ad,h)?m.length:0;N--;){var ae=m[N],Ce=ae.func;if(null==Ce||Ce==u)return ae.name}return h}function Ed(u){return(Vi.call(Se,"placeholder")?Se:u).placeholder}function On(){var u=Se.iteratee||mu;return u=u===mu?Yx:u,arguments.length?u(arguments[0],arguments[1]):u}function ks(u,h){var m=u.__data__;return function(u){var h=typeof u;return"string"==h||"number"==h||"symbol"==h||"boolean"==h?"__proto__"!==u:null===u}(h)?m["string"==typeof h?"string":"hash"]:m.map}function $o(u){for(var h=Es(u),m=h.length;m--;){var N=h[m],ae=u[N];h[m]=[N,ae,u1(ae)]}return h}function _c(u,h){var m=function(st,Tt){return null==st?J:st[Tt]}(u,h);return Wm(m)?m:J}var i_=jo?function(u){return null==u?[]:(u=Bi(u),da(jo(u),function(h){return Gf.call(u,h)}))}:bc,jb=jo?function(u){for(var h=[];u;)Fr(h,i_(u)),u=pa(u);return h}:bc,Bs=vs;function zb(u,h,m){for(var N=-1,ae=(h=pc(h,u)).length,Ce=!1;++N<ae;){var ze=Zn(h[N]);if(!(Ce=null!=u&&m(u,ze)))break;u=u[ze]}return Ce||++N!=ae?Ce:!!(ae=null==u?0:u.length)&&O_(ae)&&Ao(ze,ae)&&(Tn(u)||Ja(u))}function Hb(u){return"function"!=typeof u.constructor||mp(u)?{}:iu(pa(u))}function c1(u){return Tn(u)||Ja(u)||!!(Dx&&u&&u[Dx])}function Ao(u,h){var m=typeof u;return!!(h=null==h?Te:h)&&("number"==m||"symbol"!=m&&Fi.test(u))&&u>-1&&u%1==0&&u<h}function Vs(u,h,m){if(!_r(m))return!1;var N=typeof h;return!!("number"==N?lo(m)&&Ao(h,m.length):"string"==N&&h in m)&&xn(m[h],u)}function Wo(u,h){if(Tn(u))return!1;var m=typeof u;return!("number"!=m&&"symbol"!=m&&"boolean"!=m&&null!=u&&!Qo(u))||fe.test(u)||!ct.test(u)||null!=h&&u in Bi(h)}function gp(u){var h=pp(u),m=Se[h];if("function"!=typeof m||!(h in ri.prototype))return!1;if(u===m)return!0;var N=n_(m);return!!N&&u===N[0]}(_s&&Bs(new _s(new ArrayBuffer(1)))!=yt||oo&&Bs(new oo)!=Be||qf&&Bs(qf.resolve())!=ce||ga&&Bs(new ga)!=pt||Eo&&Bs(new Eo)!=k)&&(Bs=function(u){var h=vs(u),m=h==be?u.constructor:J,N=m?pu(m):"";if(N)switch(N){case Rx:return yt;case Nm:return Be;case Pm:return ce;case yb:return pt;case Fm:return k}return h});var $b=Hf?Xo:ey;function mp(u){var h=u&&u.constructor;return u===("function"==typeof h&&h.prototype||tu)}function u1(u){return u==u&&!_r(u)}function d1(u,h){return function(m){return null!=m&&m[u]===h&&(h!==J||u in Bi(m))}}function h1(u,h,m){return h=Lr(h===J?u.length-1:h,0),function(){for(var N=arguments,ae=-1,Ce=Lr(N.length-h,0),ze=_t(Ce);++ae<Ce;)ze[ae]=N[h+ae];ae=-1;for(var Ye=_t(h+1);++ae<h;)Ye[ae]=N[ae];return Ye[h]=m(ze),Qr(u,this,Ye)}}function a_(u,h){return h.length<2?u:Uo(u,bs(h,0,-1))}function f1(u,h){for(var m=u.length,N=os(h.length,m),ae=qs(u);N--;){var Ce=h[N];u[N]=Ao(Ce,m)?ae[Ce]:J}return u}function l_(u,h){if(("constructor"!==h||"function"!=typeof u[h])&&"__proto__"!=h)return u[h]}var Wb=c_(Ym),Ph=Ix||function(u,h){return Ii.setTimeout(u,h)},_p=c_(Co);function Fh(u,h,m){var N=h+"";return _p(u,function(u,h){var m=h.length;if(!m)return u;var N=m-1;return h[N]=(m>1?"& ":"")+h[N],h=h.join(m>2?", ":" "),u.replace(St,"{\n/* [wrapped with "+h+"] */\n")}(N,function(u,h){return Ps(nt,function(m){var N="_."+m[0];h&m[1]&&!El(u,N)&&u.push(N)}),u.sort()}(function(u){var h=u.match(At);return h?h[1].split(qt):[]}(N),m)))}function c_(u){var h=0,m=0;return function(){var N=wP(),ae=16-(N-m);if(m=N,ae>0){if(++h>=800)return arguments[0]}else h=0;return u.apply(J,arguments)}}function Sd(u,h){var m=-1,N=u.length,ae=N-1;for(h=h===J?N:h;++m<h;){var Ce=xl(m,ae),ze=u[Ce];u[Ce]=u[m],u[m]=ze}return u.length=h,u}var h,m,qb=(h=jh(function(u){var h=[];return 46===u.charCodeAt(0)&&h.push(""),u.replace(ye,function(m,N,ae,Ce){h.push(ae?Ce.replace(Dn,"$1"):N||m)}),h},function(N){return 500===m.size&&m.clear(),N}),m=h.cache,h);function Zn(u){if("string"==typeof u||Qo(u))return u;var h=u+"";return"0"==h&&1/u==-se?"-0":h}function pu(u){if(null!=u){try{return gr.call(u)}catch(h){}try{return u+""}catch(h){}}return""}function yp(u){if(u instanceof ri)return u.clone();var h=new So(u.__wrapped__,u.__chain__);return h.__actions__=qs(u.__actions__),h.__index__=u.__index__,h.__values__=u.__values__,h}var _1=si(function(u,h){return mr(u)?cc(u,ys(h,1,mr,!0)):[]}),y1=si(function(u,h){var m=qo(h);return mr(m)&&(m=J),mr(u)?cc(u,ys(h,1,mr,!0),On(m,2)):[]}),v1=si(function(u,h){var m=qo(h);return mr(m)&&(m=J),mr(u)?cc(u,ys(h,1,mr,!0),J,m):[]});function d_(u,h,m){var N=null==u?0:u.length;if(!N)return-1;var ae=null==m?0:Kn(m);return ae<0&&(ae=Lr(N+ae,0)),nd(u,On(h,3),ae)}function h_(u,h,m){var N=null==u?0:u.length;if(!N)return-1;var ae=N-1;return m!==J&&(ae=Kn(m),ae=m<0?Lr(N+ae,0):os(ae,N-1)),nd(u,On(h,3),ae,!0)}function ws(u){return null!=u&&u.length?ys(u,1):[]}function Kb(u){return u&&u.length?u[0]:J}var Qb=si(function(u){var h=Li(u,fc);return h.length&&h[0]===u[0]?su(h):[]}),E1=si(function(u){var h=qo(u),m=Li(u,fc);return h===qo(m)?h=J:m.pop(),m.length&&m[0]===u[0]?su(m,On(h,2)):[]}),Zb=si(function(u){var h=qo(u),m=Li(u,fc);return(h="function"==typeof h?h:J)&&m.pop(),m.length&&m[0]===u[0]?su(m,J,h):[]});function qo(u){var h=null==u?0:u.length;return h?u[h-1]:J}var p_=si(g_);function g_(u,h){return u&&u.length&&h&&h.length?Go(u,h):u}var e0=Xa(function(u,h){var m=null==u?0:u.length,N=Um(u,h);return Oh(u,Li(h,function(ae){return Ao(ae,m)?+ae:ae}).sort(gc)),N});function m_(u){return null==u?u:Wf.call(u)}var r0=si(function(u){return hc(ys(u,1,mr,!0))}),P1=si(function(u){var h=qo(u);return mr(h)&&(h=J),hc(ys(u,1,mr,!0),On(h,2))}),F1=si(function(u){var h=qo(u);return h="function"==typeof h?h:J,hc(ys(u,1,mr,!0),J,h)});function s0(u){if(!u||!u.length)return[];var h=0;return u=da(u,function(m){if(mr(m))return h=Lr(m.length,h),!0}),rd(h,function(m){return Li(u,Sm(m))})}function k1(u,h){if(!u||!u.length)return[];var m=s0(u);return null==h?m:Li(m,function(N){return Qr(h,J,N)})}var o0=si(function(u,h){return mr(u)?cc(u,h):[]}),jP=si(function(u){return cu(da(u,mr))}),To=si(function(u){var h=qo(u);return mr(h)&&(h=J),cu(da(u,mr),On(h,2))}),__=si(function(u){var h=qo(u);return h="function"==typeof h?h:J,cu(da(u,mr),J,h)}),y_=si(s0),Bh=si(function(u){var h=u.length,m=h>1?u[h-1]:J;return m="function"==typeof m?(u.pop(),m):J,k1(u,m)});function v_(u){var h=Se(u);return h.__chain__=!0,h}function xd(u,h){return h(u)}var b_=Xa(function(u){var h=u.length,m=h?u[0]:0,N=this.__wrapped__,ae=function(Ce){return Um(Ce,u)};return!(h>1||this.__actions__.length)&&N instanceof ri&&Ao(m)?((N=N.slice(m,+m+(h?1:0))).__actions__.push({func:xd,args:[ae],thisArg:J}),new So(N,this.__chain__).thru(function(Ce){return h&&!Ce.length&&Ce.push(J),Ce})):this.thru(ae)}),j1=Wr(function(u,h,m){Vi.call(u,m)?++u[m]:Wa(u,m,1)}),H1=Nb(d_),G1=Nb(h_);function C_(u,h){return(Tn(u)?Ps:uc)(u,On(h,3))}function wp(u,h){return(Tn(u)?ed:Hm)(u,On(h,3))}var W1=Wr(function(u,h,m){Vi.call(u,m)?u[m].push(h):Wa(u,m,[h])}),h0=si(function(u,h,m){var N=-1,ae="function"==typeof h,Ce=lo(u)?_t(u.length):[];return uc(u,function(ze){Ce[++N]=ae?Qr(h,ze,m):ya(ze,h,m)}),Ce}),f0=Wr(function(u,h,m){Wa(u,m,h)});function Za(u,h){return(Tn(u)?Li:Kx)(u,On(h,3))}var g0=Wr(function(u,h,m){u[m?0:1].push(h)},function(){return[[],[]]}),Sp=si(function(u,h){if(null==u)return[];var m=h.length;return m>1&&Vs(u,h[0],h[1])?h=[]:m>2&&Vs(h[0],h[1],h[2])&&(h=[h[0]]),Ih(u,ys(h,1),[])}),gu=Mx||function(){return Ii.Date.now()};function Cp(u,h,m){return h=m?J:h,Dl(u,H,J,J,J,J,h=u&&null==h?u.length:h)}function A_(u,h){var m;if("function"!=typeof h)throw new fa(Ae);return u=Kn(u),function(){return--u>0&&(m=h.apply(this,arguments)),u<=1&&(h=J),m}}var Vh=si(function(u,h,m){var N=1;if(m.length){var ae=eu(m,Ed(Vh));N|=V}return Dl(u,N,h,m,ae)}),Td=si(function(u,h,m){var N=3;if(m.length){var ae=eu(m,Ed(Td));N|=V}return Dl(h,N,u,m,ae)});function E0(u,h,m){var N,ae,Ce,ze,Ye,at,Rt=0,Nt=!1,jt=!1,en=!0;if("function"!=typeof u)throw new fa(Ae);function vn(Ri){var il=N,wc=ae;return N=ae=J,Rt=Ri,ze=u.apply(wc,il)}function Nn(Ri){return Rt=Ri,Ye=Ph(ai,h),Nt?vn(Ri):ze}function Fn(Ri){var il=Ri-at;return at===J||il>=h||il<0||jt&&Ri-Rt>=Ce}function ai(){var Ri=gu();if(Fn(Ri))return yi(Ri);Ye=Ph(ai,function(Ri){var eT=h-(Ri-at);return jt?os(eT,Ce-(Ri-Rt)):eT}(Ri))}function yi(Ri){return Ye=J,en&&N?vn(Ri):(N=ae=J,ze)}function Zo(){var Ri=gu(),il=Fn(Ri);if(N=arguments,ae=this,at=Ri,il){if(Ye===J)return Nn(at);if(jt)return e1(Ye),Ye=Ph(ai,h),vn(at)}return Ye===J&&(Ye=Ph(ai,h)),ze}return h=co(h)||0,_r(m)&&(Nt=!!m.leading,Ce=(jt="maxWait"in m)?Lr(co(m.maxWait)||0,h):Ce,en="trailing"in m?!!m.trailing:en),Zo.cancel=function(){Ye!==J&&e1(Ye),Rt=0,N=at=ae=Ye=J},Zo.flush=function(){return Ye===J?ze:yi(gu())},Zo}var X1=si(function(u,h){return Th(u,1,h)}),S0=si(function(u,h,m){return Th(u,co(h)||0,m)});function jh(u,h){if("function"!=typeof u||null!=h&&"function"!=typeof h)throw new fa(Ae);var m=function(){var N=arguments,ae=h?h.apply(this,N):N[0],Ce=m.cache;if(Ce.has(ae))return Ce.get(ae);var ze=u.apply(this,N);return m.cache=Ce.set(ae,ze)||Ce,ze};return m.cache=new(jh.Cache||Ga),m}function M_(u){if("function"!=typeof u)throw new fa(Ae);return function(){var h=arguments;switch(h.length){case 0:return!u.call(this);case 1:return!u.call(this,h[0]);case 2:return!u.call(this,h[0],h[1]);case 3:return!u.call(this,h[0],h[1],h[2])}return!u.apply(this,h)}}jh.Cache=Ga;var Q1=Jx(function(u,h){var m=(h=1==h.length&&Tn(h[0])?Li(h[0],Vo(On())):Li(ys(h,1),Vo(On()))).length;return si(function(N){for(var ae=-1,Ce=os(N.length,m);++ae<Ce;)N[ae]=h[ae].call(this,N[ae]);return Qr(u,this,N)})}),xp=si(function(u,h){var m=eu(h,Ed(xp));return Dl(u,V,J,h,m)}),x0=si(function(u,h){var m=eu(h,Ed(x0));return Dl(u,64,J,h,m)}),Z1=Xa(function(u,h){return Dl(u,256,J,J,J,h)});function xn(u,h){return u===h||u!=u&&h!=h}var Yt=dp(zo),D0=dp(function(u,h){return u>=h}),Ja=$x(function(){return arguments}())?$x:function(u){return yr(u)&&Vi.call(u,"callee")&&!Gf.call(u,"callee")},Tn=_t.isArray,M0=tn?Vo(tn):function(u){return yr(u)&&vs(u)==Xe};function lo(u){return null!=u&&O_(u.length)&&!Xo(u)}function mr(u){return yr(u)&&lo(u)}var el=Zr||ey,I0=ii?Vo(ii):function(u){return yr(u)&&vs(u)==Le};function wa(u){if(!yr(u))return!1;var h=vs(u);return h==Ie||"[object DOMException]"==h||"string"==typeof u.message&&"string"==typeof u.name&&!Dp(u)}function Xo(u){if(!_r(u))return!1;var h=vs(u);return h==Ue||h==qe||"[object AsyncFunction]"==h||"[object Proxy]"==h}function Tp(u){return"number"==typeof u&&u==Kn(u)}function O_(u){return"number"==typeof u&&u>-1&&u%1==0&&u<=Te}function _r(u){var h=typeof u;return null!=u&&("object"==h||"function"==h)}function yr(u){return null!=u&&"object"==typeof u}var aA=nr?Vo(nr):function(u){return yr(u)&&Bs(u)==Be};function uA(u){return"number"==typeof u||yr(u)&&vs(u)==z}function Dp(u){if(!yr(u)||vs(u)!=be)return!1;var h=pa(u);if(null===h)return!0;var m=Vi.call(h,"constructor")&&h.constructor;return"function"==typeof m&&m instanceof m&&gr.call(m)==Tx}var P0=so?Vo(so):function(u){return yr(u)&&vs(u)==wt},dA=sc?Vo(sc):function(u){return yr(u)&&Bs(u)==pt};function N_(u){return"string"==typeof u||!Tn(u)&&yr(u)&&vs(u)==pe}function Qo(u){return"symbol"==typeof u||yr(u)&&vs(u)==B}var Uh=Xr?Vo(Xr):function(u){return yr(u)&&O_(u.length)&&!!yn[vs(u)]},yc=dp(Ab),P_=dp(function(u,h){return u<=h});function F0(u){if(!u)return[];if(lo(u))return N_(u)?za(u):qs(u);if(yh&&u[yh])return function(st){for(var Tt,_t=[];!(Tt=st.next()).done;)_t.push(Tt.value);return _t}(u[yh]());var h=Bs(u);return(h==Be?fb:h==pt?Am:Rd)(u)}function tl(u){return u?(u=co(u))===se||u===-se?17976931348623157e292*(u<0?-1:1):u==u?u:0:0===u?u:0}function Kn(u){var h=tl(u),m=h%1;return h==h?m?h-m:h:0}function F_(u){return u?ru(Kn(u),0,_e):0}function co(u){if("number"==typeof u)return u;if(Qo(u))return NaN;if(_r(u)){var h="function"==typeof u.valueOf?u.valueOf():u;u=_r(h)?h+"":h}if("string"!=typeof u)return 0===u?u:+u;u=hb(u);var m=Qi.test(u);return m||$n.test(u)?db(u.slice(2),m?2:8):En.test(u)?NaN:+u}function L0(u){return va(u,Ks(u))}function Oi(u){return null==u?"":xo(u)}var hA=Al(function(u,h){if(mp(h)||lo(h))va(h,Es(h),u);else for(var m in h)Vi.call(h,m)&&$a(u,m,h[m])}),fA=Al(function(u,h){va(h,Ks(h),u)}),Dd=Al(function(u,h,m,N){va(h,Ks(h),u,N)}),pA=Al(function(u,h,m,N){va(h,Es(h),u,N)}),k0=Xa(Um),mA=si(function(u,h){u=Bi(u);var m=-1,N=h.length,ae=N>2?h[2]:J;for(ae&&Vs(h[0],h[1],ae)&&(N=1);++m<N;)for(var Ce=h[m],ze=Ks(Ce),Ye=-1,at=ze.length;++Ye<at;){var Rt=ze[Ye],Nt=u[Rt];(Nt===J||xn(Nt,tu[Rt])&&!Vi.call(u,Rt))&&(u[Rt]=Ce[Rt])}return u}),zh=si(function(u){return u.push(J,r1),Qr(H0,J,u)});function Gh(u,h,m){var N=null==u?J:Uo(u,h);return N===J?m:N}function Mp(u,h){return null!=u&&zb(u,h,pd)}var Ip=Pb(function(u,h,m){null!=h&&"function"!=typeof h.toString&&(h=$s.call(h)),u[h]=m},K_(Xs)),yA=Pb(function(u,h,m){null!=h&&"function"!=typeof h.toString&&(h=$s.call(h)),Vi.call(u,h)?u[h].push(m):u[h]=[m]},On),j0=si(ya);function Es(u){return lo(u)?Ah(u):xb(u)}function Ks(u){return lo(u)?Ah(u,!0):function(u){if(!_r(u))return function(u){var h=[];if(null!=u)for(var m in Bi(u))h.push(m);return h}(u);var h=mp(u),m=[];for(var N in u)"constructor"==N&&(h||!Vi.call(u,N))||m.push(N);return m}(u)}var z0=Al(function(u,h,m){qm(u,h,m)}),H0=Al(function(u,h,m,N){qm(u,h,m,N)}),bA=Xa(function(u,h){var m={};if(null==u)return m;var N=!1;h=Li(h,function(Ce){return Ce=pc(Ce,u),N||(N=Ce.length>1),Ce}),va(u,t_(u),m),N&&(m=Ls(m,7,hp));for(var ae=h.length;ae--;)au(m,h[ae]);return m}),wA=Xa(function(u,h){return null==u?{}:function(u,h){return Tb(u,h,function(m,N){return Mp(u,N)})}(u,h)});function G0(u,h){if(null==u)return{};var m=Li(t_(u),function(N){return[N]});return h=On(h),Tb(u,m,function(N,ae){return h(N,ae[0])})}var EA=fu(Es),W0=fu(Ks);function Rd(u){return null==u?[]:xm(u,Es(u))}var TA=Tl(function(u,h,m){return h=h.toLowerCase(),u+(m?V_(h):h)});function V_(u){return Rp(Oi(u).toLowerCase())}function j_(u){return(u=Oi(u))&&u.replace(la,hP).replace(wm,"")}var MA=Tl(function(u,h,m){return u+(m?"-":"")+h.toLowerCase()}),IA=Tl(function(u,h,m){return u+(m?" ":"")+h.toLowerCase()}),QP=lp("toLowerCase"),FA=Tl(function(u,h,m){return u+(m?"_":"")+h.toLowerCase()}),H_=Tl(function(u,h,m){return u+(m?" ":"")+Rp(h)}),Z0=Tl(function(u,h,m){return u+(m?" ":"")+h.toUpperCase()}),Rp=lp("toUpperCase");function q_(u,h,m){return u=Oi(u),(h=m?J:h)===J?function(st){return bl.test(st)}(u)?function(st){return st.match(ab)||[]}(u):function(st){return st.match(Bn)||[]}(u):u.match(h)||[]}var Y_=si(function(u,h){try{return Qr(u,J,h)}catch(m){return wa(m)?m:new Cn(m)}}),J0=Xa(function(u,h){return Ps(h,function(m){m=Zn(m),Wa(u,m,Vh(u[m],u))}),u});function K_(u){return function(){return u}}var JP=hu(),Nd=hu(!0);function Xs(u){return u}function mu(u){return Yx("function"==typeof u?u:Ls(u,1))}var X_=si(function(u,h){return function(m){return ya(m,u,h)}}),ew=si(function(u,h){return function(m){return ya(u,m,h)}});function Q_(u,h,m){var N=Es(h),ae=Mh(h,N);null==m&&(!_r(h)||!ae.length&&N.length)&&(m=h,h=u,u=this,ae=Mh(h,Es(h)));var Ce=!(_r(m)&&"chain"in m&&!m.chain),ze=Xo(u);return Ps(ae,function(Ye){var at=h[Ye];u[Ye]=at,ze&&(u.prototype[Ye]=function(){var Rt=this.__chain__;if(Ce||Rt){var Nt=u(this.__wrapped__),jt=Nt.__actions__=qs(this.__actions__);return jt.push({func:at,args:arguments,thisArg:u}),Nt.__chain__=Rt,Nt}return at.apply(u,Fr([this.value()],arguments))})}),u}function Z_(){}var zA=cp(Li),HA=cp(Qn),nw=cp(wo);function _u(u){return Wo(u)?Sm(Zn(u)):function(u){return function(h){return Uo(h,u)}}(u)}var GA=Fb(),$A=Fb(!0);function bc(){return[]}function ey(){return!1}var Hn=Jm(function(u,h){return u+h},0),ty=wd("ceil"),tF=Jm(function(u,h){return u/h},1),Rl=wd("floor"),ow=Jm(function(u,h){return u*h},1),aw=wd("round"),lw=Jm(function(u,h){return u-h},0);return Se.after=function(u,h){if("function"!=typeof h)throw new fa(Ae);return u=Kn(u),function(){if(--u<1)return h.apply(this,arguments)}},Se.ary=Cp,Se.assign=hA,Se.assignIn=fA,Se.assignInWith=Dd,Se.assignWith=pA,Se.at=k0,Se.before=A_,Se.bind=Vh,Se.bindAll=J0,Se.bindKey=Td,Se.castArray=function(){if(!arguments.length)return[];var u=arguments[0];return Tn(u)?u:[u]},Se.chain=v_,Se.chunk=function(u,h,m){h=(m?Vs(u,h,m):h===J)?1:Lr(Kn(h),0);var N=null==u?0:u.length;if(!N||h<1)return[];for(var ae=0,Ce=0,ze=_t(kt(N/h));ae<N;)ze[Ce++]=bs(u,ae,ae+=h);return ze},Se.compact=function(u){for(var h=-1,m=null==u?0:u.length,N=0,ae=[];++h<m;){var Ce=u[h];Ce&&(ae[N++]=Ce)}return ae},Se.concat=function(){var u=arguments.length;if(!u)return[];for(var h=_t(u-1),m=arguments[0],N=u;N--;)h[N-1]=arguments[N];return Fr(Tn(m)?qs(m):[m],ys(h,1))},Se.cond=function(u){var h=null==u?0:u.length,m=On();return u=h?Li(u,function(N){if("function"!=typeof N[1])throw new fa(Ae);return[m(N[0]),N[1]]}):[],si(function(N){for(var ae=-1;++ae<h;){var Ce=u[ae];if(Qr(Ce[0],this,N))return Qr(Ce[1],this,N)}})},Se.conforms=function(u){return function(u){var h=Es(u);return function(m){return ep(m,u,h)}}(Ls(u,1))},Se.constant=K_,Se.countBy=j1,Se.create=function(u,h){var m=iu(u);return null==h?m:Gx(m,h)},Se.curry=function w0(u,h,m){var N=Dl(u,8,J,J,J,J,J,h=m?J:h);return N.placeholder=w0.placeholder,N},Se.curryRight=function T_(u,h,m){var N=Dl(u,16,J,J,J,J,J,h=m?J:h);return N.placeholder=T_.placeholder,N},Se.debounce=E0,Se.defaults=mA,Se.defaultsDeep=zh,Se.defer=X1,Se.delay=S0,Se.difference=_1,Se.differenceBy=y1,Se.differenceWith=v1,Se.drop=function(u,h,m){var N=null==u?0:u.length;return N?bs(u,(h=m||h===J?1:Kn(h))<0?0:h,N):[]},Se.dropRight=function(u,h,m){var N=null==u?0:u.length;return N?bs(u,0,(h=N-(h=m||h===J?1:Kn(h)))<0?0:h):[]},Se.dropRightWhile=function(u,h){return u&&u.length?lu(u,On(h,3),!0,!0):[]},Se.dropWhile=function(u,h){return u&&u.length?lu(u,On(h,3),!0):[]},Se.fill=function(u,h,m,N){var ae=null==u?0:u.length;return ae?(m&&"number"!=typeof m&&Vs(u,h,m)&&(m=0,N=ae),function(u,h,m,N){var ae=u.length;for((m=Kn(m))<0&&(m=-m>ae?0:ae+m),(N=N===J||N>ae?ae:Kn(N))<0&&(N+=ae),N=m>N?0:F_(N);m<N;)u[m++]=h;return u}(u,h,m,N)):[]},Se.filter=function(u,h){return(Tn(u)?da:Cb)(u,On(h,3))},Se.flatMap=function(u,h){return ys(Za(u,h),1)},Se.flatMapDeep=function(u,h){return ys(Za(u,h),se)},Se.flatMapDepth=function(u,h,m){return m=m===J?1:Kn(m),ys(Za(u,h),m)},Se.flatten=ws,Se.flattenDeep=function(u){return null!=u&&u.length?ys(u,se):[]},Se.flattenDepth=function(u,h){return null!=u&&u.length?ys(u,h=h===J?1:Kn(h)):[]},Se.flip=function(u){return Dl(u,512)},Se.flow=JP,Se.flowRight=Nd,Se.fromPairs=function(u){for(var h=-1,m=null==u?0:u.length,N={};++h<m;){var ae=u[h];N[ae[0]]=ae[1]}return N},Se.functions=function(u){return null==u?[]:Mh(u,Es(u))},Se.functionsIn=function(u){return null==u?[]:Mh(u,Ks(u))},Se.groupBy=W1,Se.initial=function(u){return null!=u&&u.length?bs(u,0,-1):[]},Se.intersection=Qb,Se.intersectionBy=E1,Se.intersectionWith=Zb,Se.invert=Ip,Se.invertBy=yA,Se.invokeMap=h0,Se.iteratee=mu,Se.keyBy=f0,Se.keys=Es,Se.keysIn=Ks,Se.map=Za,Se.mapKeys=function(u,h){var m={};return h=On(h,3),qa(u,function(N,ae,Ce){Wa(m,h(N,ae,Ce),N)}),m},Se.mapValues=function(u,h){var m={};return h=On(h,3),qa(u,function(N,ae,Ce){Wa(m,ae,h(N,ae,Ce))}),m},Se.matches=function(u){return Xx(Ls(u,1))},Se.matchesProperty=function(u,h){return md(u,Ls(h,1))},Se.memoize=jh,Se.merge=z0,Se.mergeWith=H0,Se.method=X_,Se.methodOf=ew,Se.mixin=Q_,Se.negate=M_,Se.nthArg=function(u){return u=Kn(u),si(function(h){return ou(h,u)})},Se.omit=bA,Se.omitBy=function(u,h){return G0(u,M_(On(h)))},Se.once=function(u){return A_(2,u)},Se.orderBy=function(u,h,m,N){return null==u?[]:(Tn(h)||(h=null==h?[]:[h]),Tn(m=N?J:m)||(m=null==m?[]:[m]),Ih(u,h,m))},Se.over=zA,Se.overArgs=Q1,Se.overEvery=HA,Se.overSome=nw,Se.partial=xp,Se.partialRight=x0,Se.partition=g0,Se.pick=wA,Se.pickBy=G0,Se.property=_u,Se.propertyOf=function(u){return function(h){return null==u?J:Uo(u,h)}},Se.pull=p_,Se.pullAll=g_,Se.pullAllBy=function(u,h,m){return u&&u.length&&h&&h.length?Go(u,h,On(m,2)):u},Se.pullAllWith=function(u,h,m){return u&&u.length&&h&&h.length?Go(u,h,J,m):u},Se.pullAt=e0,Se.range=GA,Se.rangeRight=$A,Se.rearg=Z1,Se.reject=function(u,h){return(Tn(u)?da:Cb)(u,M_(On(h,3)))},Se.remove=function(u,h){var m=[];if(!u||!u.length)return m;var N=-1,ae=[],Ce=u.length;for(h=On(h,3);++N<Ce;){var ze=u[N];h(ze,N,u)&&(m.push(ze),ae.push(N))}return Oh(u,ae),m},Se.rest=function(u,h){if("function"!=typeof u)throw new fa(Ae);return si(u,h=h===J?h:Kn(h))},Se.reverse=m_,Se.sampleSize=function(u,h,m){return h=(m?Vs(u,h,m):h===J)?1:Kn(h),(Tn(u)?bb:IP)(u,h)},Se.set=function(u,h,m){return null==u?u:rp(u,h,m)},Se.setWith=function(u,h,m,N){return N="function"==typeof N?N:J,null==u?u:rp(u,h,m,N)},Se.shuffle=function(u){return(Tn(u)?cd:Km)(u)},Se.slice=function(u,h,m){var N=null==u?0:u.length;return N?(m&&"number"!=typeof m&&Vs(u,h,m)?(h=0,m=N):(h=null==h?0:Kn(h),m=m===J?N:Kn(m)),bs(u,h,m)):[]},Se.sortBy=Sp,Se.sortedUniq=function(u){return u&&u.length?Db(u):[]},Se.sortedUniqBy=function(u,h){return u&&u.length?Db(u,On(h,2)):[]},Se.split=function(u,h,m){return m&&"number"!=typeof m&&Vs(u,h,m)&&(h=m=J),(m=m===J?_e:m>>>0)?(u=Oi(u))&&("string"==typeof h||null!=h&&!P0(h))&&!(h=xo(h))&&ph(u)?Ya(za(u),0,m):u.split(h,m):[]},Se.spread=function(u,h){if("function"!=typeof u)throw new fa(Ae);return h=null==h?0:Lr(Kn(h),0),si(function(m){var N=m[h],ae=Ya(m,0,h);return N&&Fr(ae,N),Qr(u,this,ae)})},Se.tail=function(u){var h=null==u?0:u.length;return h?bs(u,1,h):[]},Se.take=function(u,h,m){return u&&u.length?bs(u,0,(h=m||h===J?1:Kn(h))<0?0:h):[]},Se.takeRight=function(u,h,m){var N=null==u?0:u.length;return N?bs(u,(h=N-(h=m||h===J?1:Kn(h)))<0?0:h,N):[]},Se.takeRightWhile=function(u,h){return u&&u.length?lu(u,On(h,3),!1,!0):[]},Se.takeWhile=function(u,h){return u&&u.length?lu(u,On(h,3)):[]},Se.tap=function(u,h){return h(u),u},Se.throttle=function(u,h,m){var N=!0,ae=!0;if("function"!=typeof u)throw new fa(Ae);return _r(m)&&(N="leading"in m?!!m.leading:N,ae="trailing"in m?!!m.trailing:ae),E0(u,h,{leading:N,maxWait:h,trailing:ae})},Se.thru=xd,Se.toArray=F0,Se.toPairs=EA,Se.toPairsIn=W0,Se.toPath=function(u){return Tn(u)?Li(u,Zn):Qo(u)?[u]:qs(qb(Oi(u)))},Se.toPlainObject=L0,Se.transform=function(u,h,m){var N=Tn(u),ae=N||el(u)||Uh(u);if(h=On(h,4),null==m){var Ce=u&&u.constructor;m=ae?N?new Ce:[]:_r(u)&&Xo(Ce)?iu(pa(u)):{}}return(ae?Ps:qa)(u,function(ze,Ye,at){return h(m,ze,Ye,at)}),m},Se.unary=function(u){return Cp(u,1)},Se.union=r0,Se.unionBy=P1,Se.unionWith=F1,Se.uniq=function(u){return u&&u.length?hc(u):[]},Se.uniqBy=function(u,h){return u&&u.length?hc(u,On(h,2)):[]},Se.uniqWith=function(u,h){return h="function"==typeof h?h:J,u&&u.length?hc(u,J,h):[]},Se.unset=function(u,h){return null==u||au(u,h)},Se.unzip=s0,Se.unzipWith=k1,Se.update=function(u,h,m){return null==u?u:sp(u,h,Qm(m))},Se.updateWith=function(u,h,m,N){return N="function"==typeof N?N:J,null==u?u:sp(u,h,Qm(m),N)},Se.values=Rd,Se.valuesIn=function(u){return null==u?[]:xm(u,Ks(u))},Se.without=o0,Se.words=q_,Se.wrap=function(u,h){return xp(Qm(h),u)},Se.xor=jP,Se.xorBy=To,Se.xorWith=__,Se.zip=y_,Se.zipObject=function(u,h){return op(u||[],h||[],$a)},Se.zipObjectDeep=function(u,h){return op(u||[],h||[],rp)},Se.zipWith=Bh,Se.entries=EA,Se.entriesIn=W0,Se.extend=fA,Se.extendWith=Dd,Q_(Se,Se),Se.add=Hn,Se.attempt=Y_,Se.camelCase=TA,Se.capitalize=V_,Se.ceil=ty,Se.clamp=function(u,h,m){return m===J&&(m=h,h=J),m!==J&&(m=(m=co(m))==m?m:0),h!==J&&(h=(h=co(h))==h?h:0),ru(co(u),h,m)},Se.clone=function(u){return Ls(u,4)},Se.cloneDeep=function(u){return Ls(u,5)},Se.cloneDeepWith=function(u,h){return Ls(u,5,h="function"==typeof h?h:J)},Se.cloneWith=function(u,h){return Ls(u,4,h="function"==typeof h?h:J)},Se.conformsTo=function(u,h){return null==h||ep(u,h,Es(h))},Se.deburr=j_,Se.defaultTo=function(u,h){return null==u||u!=u?h:u},Se.divide=tF,Se.endsWith=function(u,h,m){u=Oi(u),h=xo(h);var N=u.length,ae=m=m===J?N:ru(Kn(m),0,N);return(m-=h.length)>=0&&u.slice(m,ae)==h},Se.eq=xn,Se.escape=function(u){return(u=Oi(u))&&Zt.test(u)?u.replace(aa,fP):u},Se.escapeRegExp=function(u){return(u=Oi(u))&&lt.test(u)?u.replace(ke,"\\$&"):u},Se.every=function(u,h,m){var N=Tn(u)?Qn:Eb;return m&&Vs(u,h,m)&&(h=J),N(u,On(h,3))},Se.find=H1,Se.findIndex=d_,Se.findKey=function(u,h){return hh(u,On(h,3),qa)},Se.findLast=G1,Se.findLastIndex=h_,Se.findLastKey=function(u,h){return hh(u,On(h,3),tp)},Se.floor=Rl,Se.forEach=C_,Se.forEachRight=wp,Se.forIn=function(u,h){return null==u?u:dd(u,On(h,3),Ks)},Se.forInRight=function(u,h){return null==u?u:hd(u,On(h,3),Ks)},Se.forOwn=function(u,h){return u&&qa(u,On(h,3))},Se.forOwnRight=function(u,h){return u&&tp(u,On(h,3))},Se.get=Gh,Se.gt=Yt,Se.gte=D0,Se.has=function(u,h){return null!=u&&zb(u,h,fd)},Se.hasIn=Mp,Se.head=Kb,Se.identity=Xs,Se.includes=function(u,h,m,N){u=lo(u)?u:Rd(u),m=m&&!N?Kn(m):0;var ae=u.length;return m<0&&(m=Lr(ae+m,0)),N_(u)?m<=ae&&u.indexOf(h,m)>-1:!!ae&&Ua(u,h,m)>-1},Se.indexOf=function(u,h,m){var N=null==u?0:u.length;if(!N)return-1;var ae=null==m?0:Kn(m);return ae<0&&(ae=Lr(N+ae,0)),Ua(u,h,ae)},Se.inRange=function(u,h,m){return h=tl(h),m===J?(m=h,h=0):m=tl(m),function(u,h,m){return u>=os(h,m)&&u<Lr(h,m)}(u=co(u),h,m)},Se.invoke=j0,Se.isArguments=Ja,Se.isArray=Tn,Se.isArrayBuffer=M0,Se.isArrayLike=lo,Se.isArrayLikeObject=mr,Se.isBoolean=function(u){return!0===u||!1===u||yr(u)&&vs(u)==Ve},Se.isBuffer=el,Se.isDate=I0,Se.isElement=function(u){return yr(u)&&1===u.nodeType&&!Dp(u)},Se.isEmpty=function(u){if(null==u)return!0;if(lo(u)&&(Tn(u)||"string"==typeof u||"function"==typeof u.splice||el(u)||Uh(u)||Ja(u)))return!u.length;var h=Bs(u);if(h==Be||h==pt)return!u.size;if(mp(u))return!xb(u).length;for(var m in u)if(Vi.call(u,m))return!1;return!0},Se.isEqual=function(u,h){return np(u,h)},Se.isEqualWith=function(u,h,m){var N=(m="function"==typeof m?m:J)?m(u,h):J;return N===J?np(u,h,J,m):!!N},Se.isError=wa,Se.isFinite=function(u){return"number"==typeof u&&Rm(u)},Se.isFunction=Xo,Se.isInteger=Tp,Se.isLength=O_,Se.isMap=aA,Se.isMatch=function(u,h){return u===h||$m(u,h,$o(h))},Se.isMatchWith=function(u,h,m){return m="function"==typeof m?m:J,$m(u,h,$o(h),m)},Se.isNaN=function(u){return uA(u)&&u!=+u},Se.isNative=function(u){if($b(u))throw new Cn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Wm(u)},Se.isNil=function(u){return null==u},Se.isNull=function(u){return null===u},Se.isNumber=uA,Se.isObject=_r,Se.isObjectLike=yr,Se.isPlainObject=Dp,Se.isRegExp=P0,Se.isSafeInteger=function(u){return Tp(u)&&u>=-Te&&u<=Te},Se.isSet=dA,Se.isString=N_,Se.isSymbol=Qo,Se.isTypedArray=Uh,Se.isUndefined=function(u){return u===J},Se.isWeakMap=function(u){return yr(u)&&Bs(u)==k},Se.isWeakSet=function(u){return yr(u)&&"[object WeakSet]"==vs(u)},Se.join=function(u,h){return null==u?"":vh.call(u,h)},Se.kebabCase=MA,Se.last=qo,Se.lastIndexOf=function(u,h,m){var N=null==u?0:u.length;if(!N)return-1;var ae=N;return m!==J&&(ae=(ae=Kn(m))<0?Lr(N+ae,0):os(ae,N-1)),h==h?function(st,Tt,_t){for(var ln=_t+1;ln--;)if(st[ln]===Tt)return ln;return ln}(u,h,ae):nd(u,oc,ae,!0)},Se.lowerCase=IA,Se.lowerFirst=QP,Se.lt=yc,Se.lte=P_,Se.max=function(u){return u&&u.length?Dh(u,Xs,zo):J},Se.maxBy=function(u,h){return u&&u.length?Dh(u,On(h,2),zo):J},Se.mean=function(u){return ms(u,Xs)},Se.meanBy=function(u,h){return ms(u,On(h,2))},Se.min=function(u){return u&&u.length?Dh(u,Xs,Ab):J},Se.minBy=function(u,h){return u&&u.length?Dh(u,On(h,2),Ab):J},Se.stubArray=bc,Se.stubFalse=ey,Se.stubObject=function(){return{}},Se.stubString=function(){return""},Se.stubTrue=function(){return!0},Se.multiply=ow,Se.nth=function(u,h){return u&&u.length?ou(u,Kn(h)):J},Se.noConflict=function(){return Ii._===this&&(Ii._=Im),this},Se.noop=Z_,Se.now=gu,Se.pad=function(u,h,m){u=Oi(u);var N=(h=Kn(h))?gh(u):0;if(!h||N>=h)return u;var ae=(h-N)/2;return up(ui(ae),m)+u+up(kt(ae),m)},Se.padEnd=function(u,h,m){u=Oi(u);var N=(h=Kn(h))?gh(u):0;return h&&N<h?u+up(h-N,m):u},Se.padStart=function(u,h,m){u=Oi(u);var N=(h=Kn(h))?gh(u):0;return h&&N<h?up(h-N,m)+u:u},Se.parseInt=function(u,h,m){return m||null==h?h=0:h&&(h=+h),Ox(Oi(u).replace(Qe,""),h||0)},Se.random=function(u,h,m){if(m&&"boolean"!=typeof m&&Vs(u,h,m)&&(h=m=J),m===J&&("boolean"==typeof h?(m=h,h=J):"boolean"==typeof u&&(m=u,u=J)),u===J&&h===J?(u=0,h=1):(u=tl(u),h===J?(h=u,u=0):h=tl(h)),u>h){var N=u;u=h,h=N}if(m||u%1||h%1){var ae=bh();return os(u+ae*(h-u+vx("1e-"+((ae+"").length-1))),h)}return xl(u,h)},Se.reduce=function(u,h,m){var N=Tn(u)?Jc:Bo,ae=arguments.length<3;return N(u,On(h,4),m,ae,uc)},Se.reduceRight=function(u,h,m){var N=Tn(u)?td:Bo,ae=arguments.length<3;return N(u,On(h,4),m,ae,Hm)},Se.repeat=function(u,h,m){return h=(m?Vs(u,h,m):h===J)?1:Kn(h),ip(Oi(u),h)},Se.replace=function(){var u=arguments,h=Oi(u[0]);return u.length<3?h:h.replace(u[1],u[2])},Se.result=function(u,h,m){var N=-1,ae=(h=pc(h,u)).length;for(ae||(ae=1,u=J);++N<ae;){var Ce=null==u?J:u[Zn(h[N])];Ce===J&&(N=ae,Ce=m),u=Xo(Ce)?Ce.call(u):Ce}return u},Se.round=aw,Se.runInContext=st,Se.sample=function(u){return(Tn(u)?Vm:Qx)(u)},Se.size=function(u){if(null==u)return 0;if(lo(u))return N_(u)?gh(u):u.length;var h=Bs(u);return h==Be||h==pt?u.size:xb(u).length},Se.snakeCase=FA,Se.some=function(u,h,m){var N=Tn(u)?wo:OP;return m&&Vs(u,h,m)&&(h=J),N(u,On(h,3))},Se.sortedIndex=function(u,h){return Rh(u,h)},Se.sortedIndexBy=function(u,h,m){return Xm(u,h,On(m,2))},Se.sortedIndexOf=function(u,h){var m=null==u?0:u.length;if(m){var N=Rh(u,h);if(N<m&&xn(u[N],h))return N}return-1},Se.sortedLastIndex=function(u,h){return Rh(u,h,!0)},Se.sortedLastIndexBy=function(u,h,m){return Xm(u,h,On(m,2),!0)},Se.sortedLastIndexOf=function(u,h){if(null!=u&&u.length){var N=Rh(u,h,!0)-1;if(xn(u[N],h))return N}return-1},Se.startCase=H_,Se.startsWith=function(u,h,m){return u=Oi(u),m=null==m?0:ru(Kn(m),0,u.length),h=xo(h),u.slice(m,m+h.length)==h},Se.subtract=lw,Se.sum=function(u){return u&&u.length?id(u,Xs):0},Se.sumBy=function(u,h){return u&&u.length?id(u,On(h,2)):0},Se.template=function(u,h,m){var N=Se.templateSettings;m&&Vs(u,h,m)&&(h=J),u=Oi(u),h=Dd({},h,N,kb);var Ye,at,ae=Dd({},h.imports,N.imports,kb),Ce=Es(ae),ze=xm(ae,Ce),Rt=0,Nt=h.interpolate||zr,jt="__p += '",en=Dm((h.escape||zr).source+"|"+Nt.source+"|"+(Nt===ot?pn:zr).source+"|"+(h.evaluate||zr).source+"|$","g"),vn="//# sourceURL="+(Vi.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++yx+"]")+"\n";u.replace(en,function(Fn,ai,yi,uo,js,Zo){return yi||(yi=uo),jt+=u.slice(Rt,Zo).replace(ne,pP),ai&&(Ye=!0,jt+="' +\n__e("+ai+") +\n'"),js&&(at=!0,jt+="';\n"+js+";\n__p += '"),yi&&(jt+="' +\n((__t = ("+yi+")) == null ? '' : __t) +\n'"),Rt=Zo+Fn.length,Fn}),jt+="';\n";var Nn=Vi.call(h,"variable")&&h.variable;if(Nn){if(ti.test(Nn))throw new Cn("Invalid `variable` option passed into `_.template`")}else jt="with (obj) {\n"+jt+"\n}\n";jt=(at?jt.replace(Os,""):jt).replace(Ur,"$1").replace(Va,"$1;"),jt="function("+(Nn||"obj")+") {\n"+(Nn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(Ye?", __e = _.escape":"")+(at?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+jt+"return __p\n}";var oi=Y_(function(){return Ti(Ce,vn+"return "+jt).apply(J,ze)});if(oi.source=jt,wa(oi))throw oi;return oi},Se.times=function(u,h){if((u=Kn(u))<1||u>Te)return[];var m=_e,N=os(u,_e);h=On(h),u-=_e;for(var ae=rd(N,h);++m<u;)h(m);return ae},Se.toFinite=tl,Se.toInteger=Kn,Se.toLength=F_,Se.toLower=function(u){return Oi(u).toLowerCase()},Se.toNumber=co,Se.toSafeInteger=function(u){return u?ru(Kn(u),-Te,Te):0===u?u:0},Se.toString=Oi,Se.toUpper=function(u){return Oi(u).toUpperCase()},Se.trim=function(u,h,m){if((u=Oi(u))&&(m||h===J))return hb(u);if(!u||!(h=xo(h)))return u;var N=za(u),ae=za(h);return Ya(N,Ex(N,ae),Sx(N,ae)+1).join("")},Se.trimEnd=function(u,h,m){if((u=Oi(u))&&(m||h===J))return u.slice(0,ac(u)+1);if(!u||!(h=xo(h)))return u;var N=za(u);return Ya(N,0,Sx(N,za(h))+1).join("")},Se.trimStart=function(u,h,m){if((u=Oi(u))&&(m||h===J))return u.replace(Qe,"");if(!u||!(h=xo(h)))return u;var N=za(u);return Ya(N,Ex(N,za(h))).join("")},Se.truncate=function(u,h){var m=30,N="...";if(_r(h)){var ae="separator"in h?h.separator:ae;m="length"in h?Kn(h.length):m,N="omission"in h?xo(h.omission):N}var Ce=(u=Oi(u)).length;if(ph(u)){var ze=za(u);Ce=ze.length}if(m>=Ce)return u;var Ye=m-gh(N);if(Ye<1)return N;var at=ze?Ya(ze,0,Ye).join(""):u.slice(0,Ye);if(ae===J)return at+N;if(ze&&(Ye+=at.length-Ye),P0(ae)){if(u.slice(Ye).search(ae)){var Rt,Nt=at;for(ae.global||(ae=Dm(ae.source,Oi(Un.exec(ae))+"g")),ae.lastIndex=0;Rt=ae.exec(Nt);)var jt=Rt.index;at=at.slice(0,jt===J?Ye:jt)}}else if(u.indexOf(xo(ae),Ye)!=Ye){var en=at.lastIndexOf(ae);en>-1&&(at=at.slice(0,en))}return at+N},Se.unescape=function(u){return(u=Oi(u))&&fs.test(u)?u.replace(_l,zf):u},Se.uniqueId=function(u){var h=++bP;return Oi(u)+h},Se.upperCase=Z0,Se.upperFirst=Rp,Se.each=C_,Se.eachRight=wp,Se.first=Kb,Q_(Se,function(){var u={};return qa(Se,function(h,m){Vi.call(Se.prototype,m)||(u[m]=h)}),u}(),{chain:!1}),Se.VERSION="4.17.21",Ps(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){Se[u].placeholder=Se}),Ps(["drop","take"],function(u,h){ri.prototype[u]=function(m){m=m===J?1:Lr(Kn(m),0);var N=this.__filtered__&&!h?new ri(this):this.clone();return N.__filtered__?N.__takeCount__=os(m,N.__takeCount__):N.__views__.push({size:os(m,_e),type:u+(N.__dir__<0?"Right":"")}),N},ri.prototype[u+"Right"]=function(m){return this.reverse()[u](m).reverse()}}),Ps(["filter","map","takeWhile"],function(u,h){var m=h+1,N=1==m||3==m;ri.prototype[u]=function(ae){var Ce=this.clone();return Ce.__iteratees__.push({iteratee:On(ae,3),type:m}),Ce.__filtered__=Ce.__filtered__||N,Ce}}),Ps(["head","last"],function(u,h){var m="take"+(h?"Right":"");ri.prototype[u]=function(){return this[m](1).value()[0]}}),Ps(["initial","tail"],function(u,h){var m="drop"+(h?"":"Right");ri.prototype[u]=function(){return this.__filtered__?new ri(this):this[m](1)}}),ri.prototype.compact=function(){return this.filter(Xs)},ri.prototype.find=function(u){return this.filter(u).head()},ri.prototype.findLast=function(u){return this.reverse().find(u)},ri.prototype.invokeMap=si(function(u,h){return"function"==typeof u?new ri(this):this.map(function(m){return ya(m,u,h)})}),ri.prototype.reject=function(u){return this.filter(M_(On(u)))},ri.prototype.slice=function(u,h){u=Kn(u);var m=this;return m.__filtered__&&(u>0||h<0)?new ri(m):(u<0?m=m.takeRight(-u):u&&(m=m.drop(u)),h!==J&&(m=(h=Kn(h))<0?m.dropRight(-h):m.take(h-u)),m)},ri.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},ri.prototype.toArray=function(){return this.take(_e)},qa(ri.prototype,function(u,h){var m=/^(?:filter|find|map|reject)|While$/.test(h),N=/^(?:head|last)$/.test(h),ae=Se[N?"take"+("last"==h?"Right":""):h],Ce=N||/^find/.test(h);!ae||(Se.prototype[h]=function(){var ze=this.__wrapped__,Ye=N?[1]:arguments,at=ze instanceof ri,Rt=Ye[0],Nt=at||Tn(ze),jt=function(ai){var yi=ae.apply(Se,Fr([ai],Ye));return N&&en?yi[0]:yi};Nt&&m&&"function"==typeof Rt&&1!=Rt.length&&(at=Nt=!1);var en=this.__chain__,vn=!!this.__actions__.length,Nn=Ce&&!en,oi=at&&!vn;if(!Ce&&Nt){ze=oi?ze:new ri(this);var Fn=u.apply(ze,Ye);return Fn.__actions__.push({func:xd,args:[jt],thisArg:J}),new So(Fn,en)}return Nn&&oi?u.apply(this,Ye):(Fn=this.thru(jt),Nn?N?Fn.value()[0]:Fn.value():Fn)})}),Ps(["pop","push","shift","sort","splice","unshift"],function(u){var h=ir[u],m=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",N=/^(?:pop|shift)$/.test(u);Se.prototype[u]=function(){var ae=arguments;if(N&&!this.__chain__){var Ce=this.value();return h.apply(Tn(Ce)?Ce:[],ae)}return this[m](function(ze){return h.apply(Tn(ze)?ze:[],ae)})}}),qa(ri.prototype,function(u,h){var m=Se[h];if(m){var N=m.name+"";Vi.call(ad,N)||(ad[N]=[]),ad[N].push({name:h,func:m})}}),ad[mc(J,2).name]=[{name:"wrapper",func:J}],ri.prototype.clone=function(){var u=new ri(this.__wrapped__);return u.__actions__=qs(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=qs(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=qs(this.__views__),u},ri.prototype.reverse=function(){if(this.__filtered__){var u=new ri(this);u.__dir__=-1,u.__filtered__=!0}else(u=this.clone()).__dir__*=-1;return u},ri.prototype.value=function(){var u=this.__wrapped__.value(),h=this.__dir__,m=Tn(u),N=h<0,ae=m?u.length:0,Ce=function(u,h,m){for(var N=-1,ae=m.length;++N<ae;){var Ce=m[N],ze=Ce.size;switch(Ce.type){case"drop":u+=ze;break;case"dropRight":h-=ze;break;case"take":h=os(h,u+ze);break;case"takeRight":u=Lr(u,h-ze)}}return{start:u,end:h}}(0,ae,this.__views__),ze=Ce.start,Ye=Ce.end,at=Ye-ze,Rt=N?Ye:ze-1,Nt=this.__iteratees__,jt=Nt.length,en=0,vn=os(at,this.__takeCount__);if(!m||!N&&ae==at&&vn==at)return Zx(u,this.__actions__);var Nn=[];e:for(;at--&&en<vn;){for(var oi=-1,Fn=u[Rt+=h];++oi<jt;){var ai=Nt[oi],uo=ai.type,js=(0,ai.iteratee)(Fn);if(2==uo)Fn=js;else if(!js){if(1==uo)continue e;break e}}Nn[en++]=Fn}return Nn},Se.prototype.at=b_,Se.prototype.chain=function(){return v_(this)},Se.prototype.commit=function(){return new So(this.value(),this.__chain__)},Se.prototype.next=function(){this.__values__===J&&(this.__values__=F0(this.value()));var u=this.__index__>=this.__values__.length;return{done:u,value:u?J:this.__values__[this.__index__++]}},Se.prototype.plant=function(u){for(var h,m=this;m instanceof Ch;){var N=yp(m);N.__index__=0,N.__values__=J,h?ae.__wrapped__=N:h=N;var ae=N;m=m.__wrapped__}return ae.__wrapped__=u,h},Se.prototype.reverse=function(){var u=this.__wrapped__;if(u instanceof ri){var h=u;return this.__actions__.length&&(h=new ri(this)),(h=h.reverse()).__actions__.push({func:xd,args:[m_],thisArg:J}),new So(h,this.__chain__)}return this.thru(m_)},Se.prototype.toJSON=Se.prototype.valueOf=Se.prototype.value=function(){return Zx(this.__wrapped__,this.__actions__)},Se.prototype.first=Se.prototype.head,yh&&(Se.prototype[yh]=function(){return this}),Se}();Ii._=mh,(gt=function(){return mh}.call(it,tt,it,Vt))!==J&&(Vt.exports=gt)}.call(this)},478:function(Vt){Vt.exports=function(){"use strict";function it(rt,ot){for(var ct=0;ct<ot.length;ct++){var fe=ot[ct];fe.enumerable=fe.enumerable||!1,fe.configurable=!0,"value"in fe&&(fe.writable=!0),Object.defineProperty(rt,fe.key,fe)}}function J(rt,ot){(null==ot||ot>rt.length)&&(ot=rt.length);for(var ct=0,fe=new Array(ot);ct<ot;ct++)fe[ct]=rt[ct];return fe}function xt(rt,ot){var ct="undefined"!=typeof Symbol&&rt[Symbol.iterator]||rt["@@iterator"];if(ct)return(ct=ct.call(rt)).next.bind(ct);if(Array.isArray(rt)||(ct=function(rt,ot){if(rt){if("string"==typeof rt)return J(rt,ot);var ct=Object.prototype.toString.call(rt).slice(8,-1);if("Object"===ct&&rt.constructor&&(ct=rt.constructor.name),"Map"===ct||"Set"===ct)return Array.from(rt);if("Arguments"===ct||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ct))return J(rt,ot)}}(rt))||ot&&rt&&"number"==typeof rt.length){ct&&(rt=ct);var fe=0;return function(){return fe>=rt.length?{done:!0}:{done:!1,value:rt[fe++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var ut={exports:{}};function Y(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}ut.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:Y,changeDefaults:function(rt){ut.exports.defaults=rt}};var he=/[&<>"']/,W=/[&<>"']/g,j=/[<>"']|&(?!#?\w+;)/,L=/[<>"']|&(?!#?\w+;)/g,re={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$=function(ot){return re[ot]};var S=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function R(rt){return rt.replace(S,function(ot,ct){return"colon"===(ct=ct.toLowerCase())?":":"#"===ct.charAt(0)?"x"===ct.charAt(1)?String.fromCharCode(parseInt(ct.substring(2),16)):String.fromCharCode(+ct.substring(1)):""})}var A=/(^|[^\[])\^/g;var y=/[^\w:]/g,w=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var V={},I=/^[^:]+:\/*[^/]*$/,H=/^([^:]+:)[\s\S]*$/,K=/^([^:]+:\/*[^/]*)[\s\S]*$/;function M(rt,ot){V[" "+rt]||(V[" "+rt]=I.test(rt)?rt+"/":U(rt,"/",!0));var ct=-1===(rt=V[" "+rt]).indexOf(":");return"//"===ot.substring(0,2)?ct?ot:rt.replace(H,"$1")+ot:"/"===ot.charAt(0)?ct?ot:rt.replace(K,"$1")+ot:rt+ot}function U(rt,ot,ct){var fe=rt.length;if(0===fe)return"";for(var ye=0;ye<fe;){var ke=rt.charAt(fe-ye-1);if(ke!==ot||ct){if(ke===ot||!ct)break;ye++}else ye++}return rt.substr(0,fe-ye)}var se_escape=function(rt,ot){if(ot){if(he.test(rt))return rt.replace(W,$)}else if(j.test(rt))return rt.replace(L,$);return rt},se_unescape=R,se_edit=function(rt,ot){rt=rt.source||rt,ot=ot||"";var ct={replace:function(ye,ke){return ke=(ke=ke.source||ke).replace(A,"$1"),rt=rt.replace(ye,ke),ct},getRegex:function(){return new RegExp(rt,ot)}};return ct},se_cleanUrl=function(rt,ot,ct){if(rt){var fe;try{fe=decodeURIComponent(R(ct)).replace(y,"").toLowerCase()}catch(ye){return null}if(0===fe.indexOf("javascript:")||0===fe.indexOf("vbscript:")||0===fe.indexOf("data:"))return null}ot&&!w.test(ct)&&(ct=M(ot,ct));try{ct=encodeURI(ct).replace(/%25/g,"%")}catch(ye){return null}return ct},se_noopTest={exec:function(){}},se_merge=function(rt){for(var ct,fe,ot=1;ot<arguments.length;ot++)for(fe in ct=arguments[ot])Object.prototype.hasOwnProperty.call(ct,fe)&&(rt[fe]=ct[fe]);return rt},se_checkSanitizeDeprecation=function(rt){rt&&rt.sanitize&&!rt.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},se_repeatString=function(rt,ot){if(ot<1)return"";for(var ct="";ot>1;)1&ot&&(ct+=rt),ot>>=1,rt+=rt;return ct+rt},Te=ut.exports.defaults,ve=U,te=function(rt,ot){var fe=rt.replace(/\|/g,function(ke,lt,Qe){for(var vt=!1,St=lt;--St>=0&&"\\"===Qe[St];)vt=!vt;return vt?"|":" |"}).split(/ \|/),ye=0;if(fe.length>ot)fe.splice(ot);else for(;fe.length<ot;)fe.push("");for(;ye<fe.length;ye++)fe[ye]=fe[ye].trim().replace(/\\\|/g,"|");return fe},_e=se_escape,Me=function(rt,ot){if(-1===rt.indexOf(ot[1]))return-1;for(var ct=rt.length,fe=0,ye=0;ye<ct;ye++)if("\\"===rt[ye])ye++;else if(rt[ye]===ot[0])fe++;else if(rt[ye]===ot[1]&&--fe<0)return ye;return-1};function je(rt,ot,ct){var fe=ot.href,ye=ot.title?_e(ot.title):null,ke=rt[1].replace(/\\([\[\]])/g,"$1");return"!"!==rt[0].charAt(0)?{type:"link",raw:ct,href:fe,title:ye,text:ke}:{type:"image",raw:ct,href:fe,title:ye,text:_e(ke)}}var Ze=function(){function rt(ct){this.options=ct||Te}var ot=rt.prototype;return ot.space=function(fe){var ye=this.rules.block.newline.exec(fe);if(ye)return ye[0].length>1?{type:"space",raw:ye[0]}:{raw:"\n"}},ot.code=function(fe){var ye=this.rules.block.code.exec(fe);if(ye){var ke=ye[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:ye[0],codeBlockStyle:"indented",text:this.options.pedantic?ke:ve(ke,"\n")}}},ot.fences=function(fe){var ye=this.rules.block.fences.exec(fe);if(ye){var ke=ye[0],lt=function(rt,ot){var ct=rt.match(/^(\s+)(?:```)/);if(null===ct)return ot;var fe=ct[1];return ot.split("\n").map(function(ye){var ke=ye.match(/^\s+/);return null===ke?ye:ke[0].length>=fe.length?ye.slice(fe.length):ye}).join("\n")}(ke,ye[3]||"");return{type:"code",raw:ke,lang:ye[2]?ye[2].trim():ye[2],text:lt}}},ot.heading=function(fe){var ye=this.rules.block.heading.exec(fe);if(ye){var ke=ye[2].trim();if(/#$/.test(ke)){var lt=ve(ke,"#");(this.options.pedantic||!lt||/ $/.test(lt))&&(ke=lt.trim())}return{type:"heading",raw:ye[0],depth:ye[1].length,text:ke}}},ot.nptable=function(fe){var ye=this.rules.block.nptable.exec(fe);if(ye){var ke={type:"table",header:te(ye[1].replace(/^ *| *\| *$/g,"")),align:ye[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ye[3]?ye[3].replace(/\n$/,"").split("\n"):[],raw:ye[0]};if(ke.header.length===ke.align.length){var Qe,lt=ke.align.length;for(Qe=0;Qe<lt;Qe++)ke.align[Qe]=/^ *-+: *$/.test(ke.align[Qe])?"right":/^ *:-+: *$/.test(ke.align[Qe])?"center":/^ *:-+ *$/.test(ke.align[Qe])?"left":null;for(lt=ke.cells.length,Qe=0;Qe<lt;Qe++)ke.cells[Qe]=te(ke.cells[Qe],ke.header.length);return ke}}},ot.hr=function(fe){var ye=this.rules.block.hr.exec(fe);if(ye)return{type:"hr",raw:ye[0]}},ot.blockquote=function(fe){var ye=this.rules.block.blockquote.exec(fe);if(ye){var ke=ye[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:ye[0],text:ke}}},ot.list=function(fe){var ye=this.rules.block.list.exec(fe);if(ye){var qt,Bn,ti,Dn,pn,Un,En,Qi,Zi,ke=ye[0],lt=ye[2],Qe=lt.length>1,vt={type:"list",raw:ke,ordered:Qe,start:Qe?+lt.slice(0,-1):"",loose:!1,items:[]},St=ye[0].match(this.rules.block.item),At=!1,$n=St.length;ti=this.rules.block.listItemStart.exec(St[0]);for(var Fi=0;Fi<$n;Fi++){if(ke=qt=St[Fi],this.options.pedantic||(Zi=qt.match(new RegExp("\\n\\s*\\n {0,"+(ti[0].length-1)+"}\\S")))&&(pn=qt.length-Zi.index+St.slice(Fi+1).join("\n").length,vt.raw=vt.raw.substring(0,vt.raw.length-pn),ke=qt=qt.substring(0,Zi.index),$n=Fi+1),Fi!==$n-1){if(Dn=this.rules.block.listItemStart.exec(St[Fi+1]),this.options.pedantic?Dn[1].length>ti[1].length:Dn[1].length>=ti[0].length||Dn[1].length>3){St.splice(Fi,2,St[Fi]+(!this.options.pedantic&&Dn[1].length<ti[0].length&&!St[Fi].match(/\n$/)?"":"\n")+St[Fi+1]),Fi--,$n--;continue}(!this.options.pedantic||this.options.smartLists?Dn[2][Dn[2].length-1]!==lt[lt.length-1]:Qe===(1===Dn[2].length))&&(pn=St.slice(Fi+1).join("\n").length,vt.raw=vt.raw.substring(0,vt.raw.length-pn),Fi=$n-1),ti=Dn}Bn=qt.length,~(qt=qt.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(Bn-=qt.length,qt=qt.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+Bn+"}","gm"),"")),qt=ve(qt,"\n"),Fi!==$n-1&&(ke+="\n"),Un=At||/\n\n(?!\s*$)/.test(ke),Fi!==$n-1&&(At="\n\n"===ke.slice(-2),Un||(Un=At)),Un&&(vt.loose=!0),this.options.gfm&&(Qi=void 0,(En=/^\[[ xX]\] /.test(qt))&&(Qi=" "!==qt[1],qt=qt.replace(/^\[[ xX]\] +/,""))),vt.items.push({type:"list_item",raw:ke,task:En,checked:Qi,loose:Un,text:qt})}return vt}},ot.html=function(fe){var ye=this.rules.block.html.exec(fe);if(ye)return{type:this.options.sanitize?"paragraph":"html",raw:ye[0],pre:!this.options.sanitizer&&("pre"===ye[1]||"script"===ye[1]||"style"===ye[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ye[0]):_e(ye[0]):ye[0]}},ot.def=function(fe){var ye=this.rules.block.def.exec(fe);if(ye)return ye[3]&&(ye[3]=ye[3].substring(1,ye[3].length-1)),{type:"def",tag:ye[1].toLowerCase().replace(/\s+/g," "),raw:ye[0],href:ye[2],title:ye[3]}},ot.table=function(fe){var ye=this.rules.block.table.exec(fe);if(ye){var ke={type:"table",header:te(ye[1].replace(/^ *| *\| *$/g,"")),align:ye[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ye[3]?ye[3].replace(/\n$/,"").split("\n"):[]};if(ke.header.length===ke.align.length){ke.raw=ye[0];var Qe,lt=ke.align.length;for(Qe=0;Qe<lt;Qe++)ke.align[Qe]=/^ *-+: *$/.test(ke.align[Qe])?"right":/^ *:-+: *$/.test(ke.align[Qe])?"center":/^ *:-+ *$/.test(ke.align[Qe])?"left":null;for(lt=ke.cells.length,Qe=0;Qe<lt;Qe++)ke.cells[Qe]=te(ke.cells[Qe].replace(/^ *\| *| *\| *$/g,""),ke.header.length);return ke}}},ot.lheading=function(fe){var ye=this.rules.block.lheading.exec(fe);if(ye)return{type:"heading",raw:ye[0],depth:"="===ye[2].charAt(0)?1:2,text:ye[1]}},ot.paragraph=function(fe){var ye=this.rules.block.paragraph.exec(fe);if(ye)return{type:"paragraph",raw:ye[0],text:"\n"===ye[1].charAt(ye[1].length-1)?ye[1].slice(0,-1):ye[1]}},ot.text=function(fe){var ye=this.rules.block.text.exec(fe);if(ye)return{type:"text",raw:ye[0],text:ye[0]}},ot.escape=function(fe){var ye=this.rules.inline.escape.exec(fe);if(ye)return{type:"escape",raw:ye[0],text:_e(ye[1])}},ot.tag=function(fe,ye,ke){var lt=this.rules.inline.tag.exec(fe);if(lt)return!ye&&/^<a /i.test(lt[0])?ye=!0:ye&&/^<\/a>/i.test(lt[0])&&(ye=!1),!ke&&/^<(pre|code|kbd|script)(\s|>)/i.test(lt[0])?ke=!0:ke&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(lt[0])&&(ke=!1),{type:this.options.sanitize?"text":"html",raw:lt[0],inLink:ye,inRawBlock:ke,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(lt[0]):_e(lt[0]):lt[0]}},ot.link=function(fe){var ye=this.rules.inline.link.exec(fe);if(ye){var ke=ye[2].trim();if(!this.options.pedantic&&/^</.test(ke)){if(!/>$/.test(ke))return;var lt=ve(ke.slice(0,-1),"\\");if((ke.length-lt.length)%2==0)return}else{var Qe=Me(ye[2],"()");if(Qe>-1){var St=(0===ye[0].indexOf("!")?5:4)+ye[1].length+Qe;ye[2]=ye[2].substring(0,Qe),ye[0]=ye[0].substring(0,St).trim(),ye[3]=""}}var At=ye[2],qt="";if(this.options.pedantic){var Bn=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(At);Bn&&(At=Bn[1],qt=Bn[3])}else qt=ye[3]?ye[3].slice(1,-1):"";return At=At.trim(),/^</.test(At)&&(At=this.options.pedantic&&!/>$/.test(ke)?At.slice(1):At.slice(1,-1)),je(ye,{href:At&&At.replace(this.rules.inline._escapes,"$1"),title:qt&&qt.replace(this.rules.inline._escapes,"$1")},ye[0])}},ot.reflink=function(fe,ye){var ke;if((ke=this.rules.inline.reflink.exec(fe))||(ke=this.rules.inline.nolink.exec(fe))){var lt=(ke[2]||ke[1]).replace(/\s+/g," ");if(!(lt=ye[lt.toLowerCase()])||!lt.href){var Qe=ke[0].charAt(0);return{type:"text",raw:Qe,text:Qe}}return je(ke,lt,ke[0])}},ot.emStrong=function(fe,ye,ke){void 0===ke&&(ke="");var lt=this.rules.inline.emStrong.lDelim.exec(fe);if(lt&&(!lt[3]||!ke.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Qe=lt[1]||lt[2]||"";if(!Qe||Qe&&(""===ke||this.rules.inline.punctuation.exec(ke))){var St,At,vt=lt[0].length-1,qt=vt,Bn=0,ti="*"===lt[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ti.lastIndex=0,ye=ye.slice(-1*fe.length+vt);null!=(lt=ti.exec(ye));)if(St=lt[1]||lt[2]||lt[3]||lt[4]||lt[5]||lt[6]){if(At=St.length,lt[3]||lt[4]){qt+=At;continue}if((lt[5]||lt[6])&&vt%3&&!((vt+At)%3)){Bn+=At;continue}if(!((qt-=At)>0))return At=Math.min(At,At+qt+Bn),Math.min(vt,At)%2?{type:"em",raw:fe.slice(0,vt+lt.index+At+1),text:fe.slice(1,vt+lt.index+At)}:{type:"strong",raw:fe.slice(0,vt+lt.index+At+1),text:fe.slice(2,vt+lt.index+At-1)}}}}},ot.codespan=function(fe){var ye=this.rules.inline.code.exec(fe);if(ye){var ke=ye[2].replace(/\n/g," "),lt=/[^ ]/.test(ke),Qe=/^ /.test(ke)&&/ $/.test(ke);return lt&&Qe&&(ke=ke.substring(1,ke.length-1)),ke=_e(ke,!0),{type:"codespan",raw:ye[0],text:ke}}},ot.br=function(fe){var ye=this.rules.inline.br.exec(fe);if(ye)return{type:"br",raw:ye[0]}},ot.del=function(fe){var ye=this.rules.inline.del.exec(fe);if(ye)return{type:"del",raw:ye[0],text:ye[2]}},ot.autolink=function(fe,ye){var lt,Qe,ke=this.rules.inline.autolink.exec(fe);if(ke)return Qe="@"===ke[2]?"mailto:"+(lt=_e(this.options.mangle?ye(ke[1]):ke[1])):lt=_e(ke[1]),{type:"link",raw:ke[0],text:lt,href:Qe,tokens:[{type:"text",raw:lt,text:lt}]}},ot.url=function(fe,ye){var ke;if(ke=this.rules.inline.url.exec(fe)){var lt,Qe;if("@"===ke[2])Qe="mailto:"+(lt=_e(this.options.mangle?ye(ke[0]):ke[0]));else{var vt;do{vt=ke[0],ke[0]=this.rules.inline._backpedal.exec(ke[0])[0]}while(vt!==ke[0]);lt=_e(ke[0]),Qe="www."===ke[1]?"http://"+lt:lt}return{type:"link",raw:ke[0],text:lt,href:Qe,tokens:[{type:"text",raw:lt,text:lt}]}}},ot.inlineText=function(fe,ye,ke){var Qe,lt=this.rules.inline.text.exec(fe);if(lt)return Qe=ye?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(lt[0]):_e(lt[0]):lt[0]:_e(this.options.smartypants?ke(lt[0]):lt[0]),{type:"text",raw:lt[0],text:Qe}},rt}(),Je=se_noopTest,Ke=se_edit,Ve=se_merge,Le={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:Je,table:Je,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Le.def=Ke(Le.def).replace("label",Le._label).replace("title",Le._title).getRegex(),Le.bullet=/(?:[*+-]|\d{1,9}[.)])/,Le.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,Le.item=Ke(Le.item,"gm").replace(/bull/g,Le.bullet).getRegex(),Le.listItemStart=Ke(/^( *)(bull) */).replace("bull",Le.bullet).getRegex(),Le.list=Ke(Le.list).replace(/bull/g,Le.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Le.def.source+")").getRegex(),Le._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Le._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Le.html=Ke(Le.html,"i").replace("comment",Le._comment).replace("tag",Le._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Le.paragraph=Ke(Le._paragraph).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.blockquote=Ke(Le.blockquote).replace("paragraph",Le.paragraph).getRegex(),Le.normal=Ve({},Le),Le.gfm=Ve({},Le.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Le.gfm.nptable=Ke(Le.gfm.nptable).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.gfm.table=Ke(Le.gfm.table).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.pedantic=Ve({},Le.normal,{html:Ke("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Le._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Je,paragraph:Ke(Le.normal._paragraph).replace("hr",Le.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Le.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Ee={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Je,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Je,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Ee.punctuation=Ke(Ee.punctuation).replace(/punctuation/g,Ee._punctuation).getRegex(),Ee.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Ee.escapedEmSt=/\\\*|\\_/g,Ee._comment=Ke(Le._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ee.emStrong.lDelim=Ke(Ee.emStrong.lDelim).replace(/punct/g,Ee._punctuation).getRegex(),Ee.emStrong.rDelimAst=Ke(Ee.emStrong.rDelimAst,"g").replace(/punct/g,Ee._punctuation).getRegex(),Ee.emStrong.rDelimUnd=Ke(Ee.emStrong.rDelimUnd,"g").replace(/punct/g,Ee._punctuation).getRegex(),Ee._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Ee._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Ee._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Ee.autolink=Ke(Ee.autolink).replace("scheme",Ee._scheme).replace("email",Ee._email).getRegex(),Ee._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Ee.tag=Ke(Ee.tag).replace("comment",Ee._comment).replace("attribute",Ee._attribute).getRegex(),Ee._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ee._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Ee._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Ee.link=Ke(Ee.link).replace("label",Ee._label).replace("href",Ee._href).replace("title",Ee._title).getRegex(),Ee.reflink=Ke(Ee.reflink).replace("label",Ee._label).getRegex(),Ee.reflinkSearch=Ke(Ee.reflinkSearch,"g").replace("reflink",Ee.reflink).replace("nolink",Ee.nolink).getRegex(),Ee.normal=Ve({},Ee),Ee.pedantic=Ve({},Ee.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ke(/^!?\[(label)\]\((.*?)\)/).replace("label",Ee._label).getRegex(),reflink:Ke(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ee._label).getRegex()}),Ee.gfm=Ve({},Ee.normal,{escape:Ke(Ee.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Ee.gfm.url=Ke(Ee.gfm.url,"i").replace("email",Ee.gfm._extended_email).getRegex(),Ee.breaks=Ve({},Ee.gfm,{br:Ke(Ee.br).replace("{2,}","*").getRegex(),text:Ke(Ee.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var Ie={block:Le,inline:Ee},Ue=Ze,qe=ut.exports.defaults,Be=Ie.block,z=Ie.inline,X=se_repeatString;function be(rt){return rt.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function ce(rt){var ct,fe,ot="",ye=rt.length;for(ct=0;ct<ye;ct++)fe=rt.charCodeAt(ct),Math.random()>.5&&(fe="x"+fe.toString(16)),ot+="&#"+fe+";";return ot}var Pe=function(){function rt(ct){this.tokens=[],this.tokens.links=Object.create(null),this.options=ct||qe,this.options.tokenizer=this.options.tokenizer||new Ue,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var fe={block:Be.normal,inline:z.normal};this.options.pedantic?(fe.block=Be.pedantic,fe.inline=z.pedantic):this.options.gfm&&(fe.block=Be.gfm,fe.inline=this.options.breaks?z.breaks:z.gfm),this.tokenizer.rules=fe}rt.lex=function(fe,ye){return new rt(ye).lex(fe)},rt.lexInline=function(fe,ye){return new rt(ye).inlineTokens(fe)};var ot=rt.prototype;return ot.lex=function(fe){return fe=fe.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(fe,this.tokens,!0),this.inline(this.tokens),this.tokens},ot.blockTokens=function(fe,ye,ke){var Qe,vt,St,At,qt,Bn,lt=this;for(void 0===ye&&(ye=[]),void 0===ke&&(ke=!0),this.options.pedantic&&(fe=fe.replace(/^ +$/gm,""));fe;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(Dn){return!!(Qe=Dn.call(lt,fe,ye))&&(fe=fe.substring(Qe.raw.length),ye.push(Qe),!0)}))){if(Qe=this.tokenizer.space(fe)){fe=fe.substring(Qe.raw.length),Qe.type&&ye.push(Qe);continue}if(Qe=this.tokenizer.code(fe)){fe=fe.substring(Qe.raw.length),(At=ye[ye.length-1])&&"paragraph"===At.type?(At.raw+="\n"+Qe.raw,At.text+="\n"+Qe.text):ye.push(Qe);continue}if(Qe=this.tokenizer.fences(fe)){fe=fe.substring(Qe.raw.length),ye.push(Qe);continue}if(Qe=this.tokenizer.heading(fe)){fe=fe.substring(Qe.raw.length),ye.push(Qe);continue}if(Qe=this.tokenizer.nptable(fe)){fe=fe.substring(Qe.raw.length),ye.push(Qe);continue}if(Qe=this.tokenizer.hr(fe)){fe=fe.substring(Qe.raw.length),ye.push(Qe);continue}if(Qe=this.tokenizer.blockquote(fe)){fe=fe.substring(Qe.raw.length),Qe.tokens=this.blockTokens(Qe.text,[],ke),ye.push(Qe);continue}if(Qe=this.tokenizer.list(fe)){for(fe=fe.substring(Qe.raw.length),St=Qe.items.length,vt=0;vt<St;vt++)Qe.items[vt].tokens=this.blockTokens(Qe.items[vt].text,[],!1);ye.push(Qe);continue}if(Qe=this.tokenizer.html(fe)){fe=fe.substring(Qe.raw.length),ye.push(Qe);continue}if(ke&&(Qe=this.tokenizer.def(fe))){fe=fe.substring(Qe.raw.length),this.tokens.links[Qe.tag]||(this.tokens.links[Qe.tag]={href:Qe.href,title:Qe.title});continue}if(Qe=this.tokenizer.table(fe)){fe=fe.substring(Qe.raw.length),ye.push(Qe);continue}if(Qe=this.tokenizer.lheading(fe)){fe=fe.substring(Qe.raw.length),ye.push(Qe);continue}if(qt=fe,this.options.extensions&&this.options.extensions.startBlock&&function(){var Dn=1/0,pn=fe.slice(1),Un=void 0;lt.options.extensions.startBlock.forEach(function(En){"number"==typeof(Un=En.call(this,pn))&&Un>=0&&(Dn=Math.min(Dn,Un))}),Dn<1/0&&Dn>=0&&(qt=fe.substring(0,Dn+1))}(),ke&&(Qe=this.tokenizer.paragraph(qt))){At=ye[ye.length-1],Bn&&"paragraph"===At.type?(At.raw+="\n"+Qe.raw,At.text+="\n"+Qe.text):ye.push(Qe),Bn=qt.length!==fe.length,fe=fe.substring(Qe.raw.length);continue}if(Qe=this.tokenizer.text(fe)){fe=fe.substring(Qe.raw.length),(At=ye[ye.length-1])&&"text"===At.type?(At.raw+="\n"+Qe.raw,At.text+="\n"+Qe.text):ye.push(Qe);continue}if(fe){var ti="Infinite loop on byte: "+fe.charCodeAt(0);if(this.options.silent){console.error(ti);break}throw new Error(ti)}}return ye},ot.inline=function(fe){var ye,ke,lt,Qe,vt,St,At=fe.length;for(ye=0;ye<At;ye++)switch(St=fe[ye],St.type){case"paragraph":case"text":case"heading":St.tokens=[],this.inlineTokens(St.text,St.tokens);break;case"table":for(St.tokens={header:[],cells:[]},Qe=St.header.length,ke=0;ke<Qe;ke++)St.tokens.header[ke]=[],this.inlineTokens(St.header[ke],St.tokens.header[ke]);for(Qe=St.cells.length,ke=0;ke<Qe;ke++)for(vt=St.cells[ke],St.tokens.cells[ke]=[],lt=0;lt<vt.length;lt++)St.tokens.cells[ke][lt]=[],this.inlineTokens(vt[lt],St.tokens.cells[ke][lt]);break;case"blockquote":this.inline(St.tokens);break;case"list":for(Qe=St.items.length,ke=0;ke<Qe;ke++)this.inline(St.items[ke].tokens)}return fe},ot.inlineTokens=function(fe,ye,ke,lt){var Qe=this;void 0===ye&&(ye=[]),void 0===ke&&(ke=!1),void 0===lt&&(lt=!1);var vt,St,At,Bn,ti,Dn,qt=fe;if(this.tokens.links){var pn=Object.keys(this.tokens.links);if(pn.length>0)for(;null!=(Bn=this.tokenizer.rules.inline.reflinkSearch.exec(qt));)pn.includes(Bn[0].slice(Bn[0].lastIndexOf("[")+1,-1))&&(qt=qt.slice(0,Bn.index)+"["+X("a",Bn[0].length-2)+"]"+qt.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(Bn=this.tokenizer.rules.inline.blockSkip.exec(qt));)qt=qt.slice(0,Bn.index)+"["+X("a",Bn[0].length-2)+"]"+qt.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(Bn=this.tokenizer.rules.inline.escapedEmSt.exec(qt));)qt=qt.slice(0,Bn.index)+"++"+qt.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;fe;)if(ti||(Dn=""),ti=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(En){return!!(vt=En.call(Qe,fe,ye))&&(fe=fe.substring(vt.raw.length),ye.push(vt),!0)}))){if(vt=this.tokenizer.escape(fe)){fe=fe.substring(vt.raw.length),ye.push(vt);continue}if(vt=this.tokenizer.tag(fe,ke,lt)){fe=fe.substring(vt.raw.length),ke=vt.inLink,lt=vt.inRawBlock,(St=ye[ye.length-1])&&"text"===vt.type&&"text"===St.type?(St.raw+=vt.raw,St.text+=vt.text):ye.push(vt);continue}if(vt=this.tokenizer.link(fe)){fe=fe.substring(vt.raw.length),"link"===vt.type&&(vt.tokens=this.inlineTokens(vt.text,[],!0,lt)),ye.push(vt);continue}if(vt=this.tokenizer.reflink(fe,this.tokens.links)){fe=fe.substring(vt.raw.length),St=ye[ye.length-1],"link"===vt.type?(vt.tokens=this.inlineTokens(vt.text,[],!0,lt),ye.push(vt)):St&&"text"===vt.type&&"text"===St.type?(St.raw+=vt.raw,St.text+=vt.text):ye.push(vt);continue}if(vt=this.tokenizer.emStrong(fe,qt,Dn)){fe=fe.substring(vt.raw.length),vt.tokens=this.inlineTokens(vt.text,[],ke,lt),ye.push(vt);continue}if(vt=this.tokenizer.codespan(fe)){fe=fe.substring(vt.raw.length),ye.push(vt);continue}if(vt=this.tokenizer.br(fe)){fe=fe.substring(vt.raw.length),ye.push(vt);continue}if(vt=this.tokenizer.del(fe)){fe=fe.substring(vt.raw.length),vt.tokens=this.inlineTokens(vt.text,[],ke,lt),ye.push(vt);continue}if(vt=this.tokenizer.autolink(fe,ce)){fe=fe.substring(vt.raw.length),ye.push(vt);continue}if(!ke&&(vt=this.tokenizer.url(fe,ce))){fe=fe.substring(vt.raw.length),ye.push(vt);continue}if(At=fe,this.options.extensions&&this.options.extensions.startInline&&function(){var En=1/0,Qi=fe.slice(1),Zi=void 0;Qe.options.extensions.startInline.forEach(function($n){"number"==typeof(Zi=$n.call(this,Qi))&&Zi>=0&&(En=Math.min(En,Zi))}),En<1/0&&En>=0&&(At=fe.substring(0,En+1))}(),vt=this.tokenizer.inlineText(At,lt,be)){fe=fe.substring(vt.raw.length),"_"!==vt.raw.slice(-1)&&(Dn=vt.raw.slice(-1)),ti=!0,(St=ye[ye.length-1])&&"text"===St.type?(St.raw+=vt.raw,St.text+=vt.text):ye.push(vt);continue}if(fe){var Un="Infinite loop on byte: "+fe.charCodeAt(0);if(this.options.silent){console.error(Un);break}throw new Error(Un)}}return ye},function(rt,ot,ct){ot&&it(rt.prototype,ot),ct&&it(rt,ct)}(rt,null,[{key:"rules",get:function(){return{block:Be,inline:z}}}]),rt}(),wt=ut.exports.defaults,pt=se_cleanUrl,pe=se_escape,B=function(){function rt(ct){this.options=ct||wt}var ot=rt.prototype;return ot.code=function(fe,ye,ke){var lt=(ye||"").match(/\S*/)[0];if(this.options.highlight){var Qe=this.options.highlight(fe,lt);null!=Qe&&Qe!==fe&&(ke=!0,fe=Qe)}return fe=fe.replace(/\n$/,"")+"\n",lt?'<pre><code class="'+this.options.langPrefix+pe(lt,!0)+'">'+(ke?fe:pe(fe,!0))+"</code></pre>\n":"<pre><code>"+(ke?fe:pe(fe,!0))+"</code></pre>\n"},ot.blockquote=function(fe){return"<blockquote>\n"+fe+"</blockquote>\n"},ot.html=function(fe){return fe},ot.heading=function(fe,ye,ke,lt){return this.options.headerIds?"<h"+ye+' id="'+this.options.headerPrefix+lt.slug(ke)+'">'+fe+"</h"+ye+">\n":"<h"+ye+">"+fe+"</h"+ye+">\n"},ot.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},ot.list=function(fe,ye,ke){var lt=ye?"ol":"ul";return"<"+lt+(ye&&1!==ke?' start="'+ke+'"':"")+">\n"+fe+"</"+lt+">\n"},ot.listitem=function(fe){return"<li>"+fe+"</li>\n"},ot.checkbox=function(fe){return"<input "+(fe?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},ot.paragraph=function(fe){return"<p>"+fe+"</p>\n"},ot.table=function(fe,ye){return ye&&(ye="<tbody>"+ye+"</tbody>"),"<table>\n<thead>\n"+fe+"</thead>\n"+ye+"</table>\n"},ot.tablerow=function(fe){return"<tr>\n"+fe+"</tr>\n"},ot.tablecell=function(fe,ye){var ke=ye.header?"th":"td";return(ye.align?"<"+ke+' align="'+ye.align+'">':"<"+ke+">")+fe+"</"+ke+">\n"},ot.strong=function(fe){return"<strong>"+fe+"</strong>"},ot.em=function(fe){return"<em>"+fe+"</em>"},ot.codespan=function(fe){return"<code>"+fe+"</code>"},ot.br=function(){return this.options.xhtml?"<br/>":"<br>"},ot.del=function(fe){return"<del>"+fe+"</del>"},ot.link=function(fe,ye,ke){if(null===(fe=pt(this.options.sanitize,this.options.baseUrl,fe)))return ke;var lt='<a href="'+pe(fe)+'"';return ye&&(lt+=' title="'+ye+'"'),lt+">"+ke+"</a>"},ot.image=function(fe,ye,ke){if(null===(fe=pt(this.options.sanitize,this.options.baseUrl,fe)))return ke;var lt='<img src="'+fe+'" alt="'+ke+'"';return ye&&(lt+=' title="'+ye+'"'),lt+(this.options.xhtml?"/>":">")},ot.text=function(fe){return fe},rt}(),O=function(){function rt(){}var ot=rt.prototype;return ot.strong=function(fe){return fe},ot.em=function(fe){return fe},ot.codespan=function(fe){return fe},ot.del=function(fe){return fe},ot.html=function(fe){return fe},ot.text=function(fe){return fe},ot.link=function(fe,ye,ke){return""+ke},ot.image=function(fe,ye,ke){return""+ke},ot.br=function(){return""},rt}(),k=function(){function rt(){this.seen={}}var ot=rt.prototype;return ot.serialize=function(fe){return fe.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},ot.getNextSafeSlug=function(fe,ye){var ke=fe,lt=0;if(this.seen.hasOwnProperty(ke)){lt=this.seen[fe];do{ke=fe+"-"+ ++lt}while(this.seen.hasOwnProperty(ke))}return ye||(this.seen[fe]=lt,this.seen[ke]=0),ke},ot.slug=function(fe,ye){void 0===ye&&(ye={});var ke=this.serialize(fe);return this.getNextSafeSlug(ke,ye.dryrun)},rt}(),Oe=B,Xe=O,yt=k,It=ut.exports.defaults,An=se_unescape,zn=Pe,_i=function(){function rt(ct){this.options=ct||It,this.options.renderer=this.options.renderer||new Oe,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Xe,this.slugger=new yt}rt.parse=function(fe,ye){return new rt(ye).parse(fe)},rt.parseInline=function(fe,ye){return new rt(ye).parseInline(fe)};var ot=rt.prototype;return ot.parse=function(fe,ye){void 0===ye&&(ye=!0);var lt,Qe,vt,St,At,qt,Bn,ti,Dn,pn,Un,En,Qi,Zi,$n,Fi,la,zr,ne,ke="",de=fe.length;for(lt=0;lt<de;lt++)if(pn=fe[lt],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[pn.type]&&(!1!==(ne=this.options.extensions.renderers[pn.type].call(this,pn))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(pn.type)))ke+=ne||"";else switch(pn.type){case"space":continue;case"hr":ke+=this.renderer.hr();continue;case"heading":ke+=this.renderer.heading(this.parseInline(pn.tokens),pn.depth,An(this.parseInline(pn.tokens,this.textRenderer)),this.slugger);continue;case"code":ke+=this.renderer.code(pn.text,pn.lang,pn.escaped);continue;case"table":for(ti="",Bn="",St=pn.header.length,Qe=0;Qe<St;Qe++)Bn+=this.renderer.tablecell(this.parseInline(pn.tokens.header[Qe]),{header:!0,align:pn.align[Qe]});for(ti+=this.renderer.tablerow(Bn),Dn="",St=pn.cells.length,Qe=0;Qe<St;Qe++){for(Bn="",At=(qt=pn.tokens.cells[Qe]).length,vt=0;vt<At;vt++)Bn+=this.renderer.tablecell(this.parseInline(qt[vt]),{header:!1,align:pn.align[vt]});Dn+=this.renderer.tablerow(Bn)}ke+=this.renderer.table(ti,Dn);continue;case"blockquote":Dn=this.parse(pn.tokens),ke+=this.renderer.blockquote(Dn);continue;case"list":for(Un=pn.ordered,En=pn.start,Qi=pn.loose,St=pn.items.length,Dn="",Qe=0;Qe<St;Qe++)Fi=($n=pn.items[Qe]).checked,la=$n.task,Zi="",$n.task&&(zr=this.renderer.checkbox(Fi),Qi?$n.tokens.length>0&&"text"===$n.tokens[0].type?($n.tokens[0].text=zr+" "+$n.tokens[0].text,$n.tokens[0].tokens&&$n.tokens[0].tokens.length>0&&"text"===$n.tokens[0].tokens[0].type&&($n.tokens[0].tokens[0].text=zr+" "+$n.tokens[0].tokens[0].text)):$n.tokens.unshift({type:"text",text:zr}):Zi+=zr),Zi+=this.parse($n.tokens,Qi),Dn+=this.renderer.listitem(Zi,la,Fi);ke+=this.renderer.list(Dn,Un,En);continue;case"html":ke+=this.renderer.html(pn.text);continue;case"paragraph":ke+=this.renderer.paragraph(this.parseInline(pn.tokens));continue;case"text":for(Dn=pn.tokens?this.parseInline(pn.tokens):pn.text;lt+1<de&&"text"===fe[lt+1].type;)Dn+="\n"+((pn=fe[++lt]).tokens?this.parseInline(pn.tokens):pn.text);ke+=ye?this.renderer.paragraph(Dn):Dn;continue;default:var oe='Token with "'+pn.type+'" type was not found.';if(this.options.silent)return void console.error(oe);throw new Error(oe)}return ke},ot.parseInline=function(fe,ye){ye=ye||this.renderer;var lt,Qe,vt,ke="",St=fe.length;for(lt=0;lt<St;lt++)if(Qe=fe[lt],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Qe.type]&&(!1!==(vt=this.options.extensions.renderers[Qe.type].call(this,Qe))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Qe.type)))ke+=vt||"";else switch(Qe.type){case"escape":ke+=ye.text(Qe.text);break;case"html":ke+=ye.html(Qe.text);break;case"link":ke+=ye.link(Qe.href,Qe.title,this.parseInline(Qe.tokens,ye));break;case"image":ke+=ye.image(Qe.href,Qe.title,Qe.text);break;case"strong":ke+=ye.strong(this.parseInline(Qe.tokens,ye));break;case"em":ke+=ye.em(this.parseInline(Qe.tokens,ye));break;case"codespan":ke+=ye.codespan(Qe.text);break;case"br":ke+=ye.br();break;case"del":ke+=ye.del(this.parseInline(Qe.tokens,ye));break;case"text":ke+=ye.text(Qe.text);break;default:var At='Token with "'+Qe.type+'" type was not found.';if(this.options.silent)return void console.error(At);throw new Error(At)}return ke},rt}(),ci=Ze,jr=B,Is=O,ss=k,Os=se_merge,Ur=se_checkSanitizeDeprecation,Va=se_escape,_l=ut.exports.getDefaults,aa=ut.exports.changeDefaults,fs=ut.exports.defaults;function Zt(rt,ot,ct){if(null==rt)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");if("function"==typeof ot&&(ct=ot,ot=null),ot=Os({},Zt.defaults,ot||{}),Ur(ot),ct){var ye,fe=ot.highlight;try{ye=zn.lex(rt,ot)}catch(vt){return ct(vt)}var ke=function(St){var At;if(!St)try{ot.walkTokens&&Zt.walkTokens(ye,ot.walkTokens),At=_i.parse(ye,ot)}catch(qt){St=qt}return ot.highlight=fe,St?ct(St):ct(null,At)};if(!fe||fe.length<3||(delete ot.highlight,!ye.length))return ke();var lt=0;return Zt.walkTokens(ye,function(vt){"code"===vt.type&&(lt++,setTimeout(function(){fe(vt.text,vt.lang,function(St,At){if(St)return ke(St);null!=At&&At!==vt.text&&(vt.text=At,vt.escaped=!0),0==--lt&&ke()})},0))}),void(0===lt&&ke())}try{var Qe=zn.lex(rt,ot);return ot.walkTokens&&Zt.walkTokens(Qe,ot.walkTokens),_i.parse(Qe,ot)}catch(vt){if(vt.message+="\nPlease report this to https://github.com/markedjs/marked.",ot.silent)return"<p>An error occurred:</p><pre>"+Va(vt.message+"",!0)+"</pre>";throw vt}}return Zt.options=Zt.setOptions=function(rt){return Os(Zt.defaults,rt),aa(Zt.defaults),Zt},Zt.getDefaults=_l,Zt.defaults=fs,Zt.use=function(){for(var rt=this,ot=arguments.length,ct=new Array(ot),fe=0;fe<ot;fe++)ct[fe]=arguments[fe];var lt,ye=Os.apply(void 0,[{}].concat(ct)),ke=Zt.defaults.extensions||{renderers:{},childTokens:{}};ct.forEach(function(Qe){if(Qe.extensions&&(lt=!0,Qe.extensions.forEach(function(St){if(!St.name)throw new Error("extension name required");if(St.renderer){var At=ke.renderers?ke.renderers[St.name]:null;ke.renderers[St.name]=At?function(){for(var qt=arguments.length,Bn=new Array(qt),ti=0;ti<qt;ti++)Bn[ti]=arguments[ti];var Dn=St.renderer.apply(this,Bn);return!1===Dn&&(Dn=At.apply(this,Bn)),Dn}:St.renderer}if(St.tokenizer){if(!St.level||"block"!==St.level&&"inline"!==St.level)throw new Error("extension level must be 'block' or 'inline'");ke[St.level]?ke[St.level].unshift(St.tokenizer):ke[St.level]=[St.tokenizer],St.start&&("block"===St.level?ke.startBlock?ke.startBlock.push(St.start):ke.startBlock=[St.start]:"inline"===St.level&&(ke.startInline?ke.startInline.push(St.start):ke.startInline=[St.start]))}St.childTokens&&(ke.childTokens[St.name]=St.childTokens)})),Qe.renderer&&function(){var St=Zt.defaults.renderer||new jr,At=function(ti){var Dn=St[ti];St[ti]=function(){for(var pn=arguments.length,Un=new Array(pn),En=0;En<pn;En++)Un[En]=arguments[En];var Qi=Qe.renderer[ti].apply(St,Un);return!1===Qi&&(Qi=Dn.apply(St,Un)),Qi}};for(var qt in Qe.renderer)At(qt);ye.renderer=St}(),Qe.tokenizer&&function(){var St=Zt.defaults.tokenizer||new ci,At=function(ti){var Dn=St[ti];St[ti]=function(){for(var pn=arguments.length,Un=new Array(pn),En=0;En<pn;En++)Un[En]=arguments[En];var Qi=Qe.tokenizer[ti].apply(St,Un);return!1===Qi&&(Qi=Dn.apply(St,Un)),Qi}};for(var qt in Qe.tokenizer)At(qt);ye.tokenizer=St}(),Qe.walkTokens){var vt=Zt.defaults.walkTokens;ye.walkTokens=function(St){Qe.walkTokens.call(rt,St),vt&&vt(St)}}lt&&(ye.extensions=ke),Zt.setOptions(ye)})},Zt.walkTokens=function(rt,ot){for(var ye,ct=function(){var lt=ye.value;switch(ot(lt),lt.type){case"table":for(var vt,Qe=xt(lt.tokens.header);!(vt=Qe()).done;)Zt.walkTokens(vt.value,ot);for(var qt,At=xt(lt.tokens.cells);!(qt=At()).done;)for(var Dn,ti=xt(qt.value);!(Dn=ti()).done;)Zt.walkTokens(Dn.value,ot);break;case"list":Zt.walkTokens(lt.items,ot);break;default:Zt.defaults.extensions&&Zt.defaults.extensions.childTokens&&Zt.defaults.extensions.childTokens[lt.type]?Zt.defaults.extensions.childTokens[lt.type].forEach(function(Un){Zt.walkTokens(lt[Un],ot)}):lt.tokens&&Zt.walkTokens(lt.tokens,ot)}},fe=xt(rt);!(ye=fe()).done;)ct()},Zt.parseInline=function(rt,ot){if(null==rt)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof rt)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(rt)+", string expected");ot=Os({},Zt.defaults,ot||{}),Ur(ot);try{var ct=zn.lexInline(rt,ot);return ot.walkTokens&&Zt.walkTokens(ct,ot.walkTokens),_i.parseInline(ct,ot)}catch(fe){if(fe.message+="\nPlease report this to https://github.com/markedjs/marked.",ot.silent)return"<p>An error occurred:</p><pre>"+Va(fe.message+"",!0)+"</pre>";throw fe}},Zt.Parser=_i,Zt.parser=_i.parse,Zt.Renderer=jr,Zt.TextRenderer=Is,Zt.Lexer=zn,Zt.lexer=zn.lex,Zt.Tokenizer=ci,Zt.Slugger=ss,Zt.parse=Zt,Zt}()},369:(Vt,it,tt)=>{var gt=tt(284),J=tt(830);function xt(){this.clear()}xt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},xt.prototype.enqueue=function(ut){return this.items.push(ut),++this.size},xt.prototype.dequeue=function(){if(this.size){var ut=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,ut}},xt.prototype.peek=function(){if(this.size)return this.items[this.offset]},xt.prototype.forEach=function(ut,Y){Y=arguments.length>1?Y:this;for(var Ae=this.offset,he=0,W=this.items.length;Ae<W;Ae++,he++)ut.call(Y,this.items[Ae],he,this)},xt.prototype.toArray=function(){return this.items.slice(this.offset)},xt.prototype.values=function(){var ut=this.items,Y=this.offset;return new gt(function(){if(Y>=ut.length)return{done:!0};var Ae=ut[Y];return Y++,{value:Ae,done:!1}})},xt.prototype.entries=function(){var ut=this.items,Y=this.offset,Ae=0;return new gt(function(){if(Y>=ut.length)return{done:!0};var he=ut[Y];return Y++,{value:[Ae++,he],done:!1}})},"undefined"!=typeof Symbol&&(xt.prototype[Symbol.iterator]=xt.prototype.values),xt.prototype.toString=function(){return this.toArray().join(",")},xt.prototype.toJSON=function(){return this.toArray()},xt.prototype.inspect=function(){var ut=this.toArray();return Object.defineProperty(ut,"constructor",{value:xt,enumerable:!1}),ut},"undefined"!=typeof Symbol&&(xt.prototype[Symbol.for("nodejs.util.inspect.custom")]=xt.prototype.inspect),xt.from=function(ut){var Y=new xt;return J(ut,function(Ae){Y.enqueue(Ae)}),Y},xt.of=function(){return xt.from(arguments)},Vt.exports=xt},830:Vt=>{var it="undefined"!=typeof ArrayBuffer,tt="undefined"!=typeof Symbol;function gt(J,xt){var ut,Y,Ae,he,W;if(!J)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof xt)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(J)||it&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Ae=0,he=J.length;Ae<he;Ae++)xt(J[Ae],Ae);else if("function"!=typeof J.forEach)if(tt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(Y in J)J.hasOwnProperty(Y)&&xt(J[Y],Y);else for(ut=J,Ae=0;!0!==(W=ut.next()).done;)xt(W.value,Ae),Ae++;else J.forEach(xt)}gt.forEachWithNullKeys=function(J,xt){var ut,Y,Ae,he,W;if(!J)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof xt)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(J)||it&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Ae=0,he=J.length;Ae<he;Ae++)xt(J[Ae],null);else if(J instanceof Set)J.forEach(function(j){xt(j,null)});else if("function"!=typeof J.forEach)if(tt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(Y in J)J.hasOwnProperty(Y)&&xt(J[Y],Y);else for(ut=J,Ae=0;!0!==(W=ut.next()).done;)xt(W.value,null),Ae++;else J.forEach(xt)},Vt.exports=gt},284:Vt=>{function it(tt){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:tt}),this.done=!1}it.prototype.next=function(){if(this.done)return{done:!0};var tt=this._next();return tt.done&&(this.done=!0),tt},"undefined"!=typeof Symbol&&(it.prototype[Symbol.iterator]=function(){return this}),it.of=function(){var tt=arguments,gt=tt.length,J=0;return new it(function(){return J>=gt?{done:!0}:{done:!1,value:tt[J++]}})},it.empty=function(){var tt=new it(null);return tt.done=!0,tt},it.is=function(tt){return tt instanceof it||"object"==typeof tt&&null!==tt&&"function"==typeof tt.next},Vt.exports=it},310:(Vt,it,tt)=>{"use strict";var gt=tt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.isMobile=function(){return void 0!==J.window.orientation},it.default=function(he){if(!he&&!(0,xt.default)())return"Node";if((0,ut.default)(he))return"Electron";var W="undefined"!=typeof navigator?navigator:{},j=he||W.userAgent||"";if(j.indexOf("Edge")>-1)return"Edge";var L=-1!==j.indexOf("MSIE "),re=-1!==j.indexOf("Trident/");return L||re?"IE":J.window.chrome?"Chrome":J.window.safari?"Safari":J.window.mozInnerScreenX?"Firefox":"Unknown"};var J=tt(151),xt=gt(tt(602)),ut=gt(tt(344))},151:(Vt,it,tt)=>{"use strict";var gt=tt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.console=it.process=it.document=it.global=it.window=it.self=void 0;var J=gt(tt(321)),xt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&process};it.self=xt.self||xt.window||xt.global,it.window=xt.window||xt.self||xt.global,it.global=xt.global||xt.self||xt.window,it.document=xt.document||{},it.process=xt.process||{};var j=console;it.console=j},761:(Vt,it,tt)=>{"use strict";var J=tt(948),xt=tt(321);Object.defineProperty(it,"CO",{enumerable:!0,get:function(){return ut.global}}),Object.defineProperty(it,"jU",{enumerable:!0,get:function(){return Y.default}}),Object.defineProperty(it,"qs",{enumerable:!0,get:function(){return Ae.default}});var ut=tt(151),Y=j(tt(602)),Ae=j(tt(310));J(tt(344));function W(L){if("function"!=typeof WeakMap)return null;var re=new WeakMap,$=new WeakMap;return(W=function(S){return S?$:re})(L)}function j(L,re){if(!re&&L&&L.__esModule)return L;if(null===L||"object"!==xt(L)&&"function"!=typeof L)return{default:L};var $=W(re);if($&&$.has(L))return $.get(L);var b={},S=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in L)if("default"!==R&&Object.prototype.hasOwnProperty.call(L,R)){var A=S?Object.getOwnPropertyDescriptor(L,R):null;A&&(A.get||A.set)?Object.defineProperty(b,R,A):b[R]=L[R]}return b.default=L,$&&$.set(L,b),b}},602:(Vt,it,tt)=>{"use strict";var gt=tt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=ut,it.isBrowserMainThread=function(){return ut()&&"undefined"!=typeof document};var J=gt(tt(321)),xt=gt(tt(344));function ut(){return!("object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,xt.default)()}},344:(Vt,it,tt)=>{"use strict";var gt=tt(948);Object.defineProperty(it,"__esModule",{value:!0}),it.default=function(ut){if("undefined"!=typeof window&&"object"===(0,J.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,J.default)(process.versions)&&Boolean(process.versions.electron))return!0;var Y="object"===("undefined"==typeof navigator?"undefined":(0,J.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,Ae=ut||Y;return!!(Ae&&Ae.indexOf("Electron")>=0)};var J=gt(tt(321))},991:function(Vt,it,tt){"use strict";var gt=this&&this.__createBinding||(Object.create?function(xt,ut,Y,Ae){void 0===Ae&&(Ae=Y),Object.defineProperty(xt,Ae,{enumerable:!0,get:function(){return ut[Y]}})}:function(xt,ut,Y,Ae){void 0===Ae&&(Ae=Y),xt[Ae]=ut[Y]}),J=this&&this.__exportStar||function(xt,ut){for(var Y in xt)"default"!==Y&&!Object.prototype.hasOwnProperty.call(ut,Y)&&gt(ut,xt,Y)};Object.defineProperty(it,"__esModule",{value:!0}),J(tt(180),it),J(tt(103),it),J(tt(965),it),J(tt(595),it),J(tt(417),it),J(tt(451),it),J(tt(735),it)},180:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.BlankNode=void 0,it.BlankNode=class{constructor(J){this.termType="BlankNode",this.value=J}equals(J){return!!J&&"BlankNode"===J.termType&&J.value===this.value}}},103:(Vt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DataFactory=void 0;const gt=tt(180),J=tt(965),xt=tt(595),ut=tt(417),Y=tt(451),Ae=tt(735);let he=0;it.DataFactory=class{constructor(L){this.blankNodeCounter=0,this.blankNodePrefix=(L=L||{}).blankNodePrefix||`df_${he++}_`}namedNode(L){return new ut.NamedNode(L)}blankNode(L){return new gt.BlankNode(L||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(L,re){return new xt.Literal(L,re)}variable(L){return new Ae.Variable(L)}defaultGraph(){return J.DefaultGraph.INSTANCE}quad(L,re,$,b){return new Y.Quad(L,re,$,b||this.defaultGraph())}fromTerm(L){switch(L.termType){case"NamedNode":return this.namedNode(L.value);case"BlankNode":return this.blankNode(L.value);case"Literal":return L.language?this.literal(L.value,L.language):L.datatype.equals(xt.Literal.XSD_STRING)?this.literal(L.value):this.literal(L.value,this.fromTerm(L.datatype));case"Variable":return this.variable(L.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(L.subject),this.fromTerm(L.predicate),this.fromTerm(L.object),this.fromTerm(L.graph))}}fromQuad(L){return this.fromTerm(L)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DefaultGraph=void 0;class tt{constructor(){this.termType="DefaultGraph",this.value=""}equals(J){return!!J&&"DefaultGraph"===J.termType}}it.DefaultGraph=tt,tt.INSTANCE=new tt},595:(Vt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Literal=void 0;const gt=tt(417);class J{constructor(ut,Y){this.termType="Literal",this.value=ut,"string"==typeof Y?(this.language=Y,this.datatype=J.RDF_LANGUAGE_STRING):Y?(this.language="",this.datatype=Y):(this.language="",this.datatype=J.XSD_STRING)}equals(ut){return!!ut&&"Literal"===ut.termType&&ut.value===this.value&&ut.language===this.language&&ut.datatype.equals(this.datatype)}}it.Literal=J,J.RDF_LANGUAGE_STRING=new gt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),J.XSD_STRING=new gt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.NamedNode=void 0,it.NamedNode=class{constructor(J){this.termType="NamedNode",this.value=J}equals(J){return!!J&&"NamedNode"===J.termType&&J.value===this.value}}},451:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Quad=void 0,it.Quad=class{constructor(J,xt,ut,Y){this.termType="Quad",this.value="",this.subject=J,this.predicate=xt,this.object=ut,this.graph=Y}equals(J){return!!J&&("Quad"===J.termType||!J.termType)&&this.subject.equals(J.subject)&&this.predicate.equals(J.predicate)&&this.object.equals(J.object)&&this.graph.equals(J.graph)}}},735:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Variable=void 0,it.Variable=class{constructor(J){this.termType="Variable",this.value=J}equals(J){return!!J&&"Variable"===J.termType&&J.value===this.value}}},609:function(Vt,it,tt){"use strict";var gt=this&&this.__createBinding||(Object.create?function(b,S,R,A){void 0===A&&(A=R),Object.defineProperty(b,A,{enumerable:!0,get:function(){return S[R]}})}:function(b,S,R,A){void 0===A&&(A=R),b[A]=S[R]}),J=this&&this.__exportStar||function(b,S){for(var R in b)"default"!==R&&!Object.prototype.hasOwnProperty.call(S,R)&&gt(S,b,R)};Object.defineProperty(it,"__esModule",{value:!0}),it.getSupportedJavaScriptPrimitives=it.getSupportedRdfDatatypes=it.getTermRaw=it.toRdf=it.fromRdf=void 0;const xt=tt(991),ut=tt(938),Y=tt(60);J(tt(938),it),J(tt(871),it),J(tt(60),it);const Ae=new xt.DataFactory,he=new Y.Translator;function W(b,S){return he.fromRdf(b,S)}he.registerHandler(new ut.TypeHandlerString,ut.TypeHandlerString.TYPES.map(b=>Ae.namedNode(b)),["string"]),he.registerHandler(new ut.TypeHandlerBoolean,[ut.TypeHandlerBoolean.TYPE].map(b=>Ae.namedNode(b)),["boolean"]),he.registerHandler(new ut.TypeHandlerNumberDouble,ut.TypeHandlerNumberDouble.TYPES.map(b=>Ae.namedNode(b)),["number"]),he.registerHandler(new ut.TypeHandlerNumberInteger,ut.TypeHandlerNumberInteger.TYPES.map(b=>Ae.namedNode(b)),["number"]),he.registerHandler(new ut.TypeHandlerDate,ut.TypeHandlerDate.TYPES.map(b=>Ae.namedNode(b)),["object"]),it.fromRdf=W,it.toRdf=function(b,S){return S&&"namedNode"in S&&(S={dataFactory:S}),(S=S||{})&&!S.dataFactory&&(S.dataFactory=Ae),he.toRdf(b,S)},it.getTermRaw=function(b,S){return"Literal"===b.termType?W(b,S):b.value},it.getSupportedRdfDatatypes=function(){return he.getSupportedRdfDatatypes()},it.getSupportedJavaScriptPrimitives=function(){return he.getSupportedJavaScriptPrimitives()}},871:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0})},60:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Translator=void 0,it.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(J){throw new Error(`Invalid RDF ${J.datatype.value} value: '${J.value}'`)}registerHandler(J,xt,ut){for(const Y of xt)this.supportedRdfDatatypes.push(Y),this.fromRdfHandlers[Y.value]=J;for(const Y of ut){let Ae=this.toRdfHandlers[Y];Ae||(this.toRdfHandlers[Y]=Ae=[]),Ae.push(J)}}fromRdf(J,xt){const ut=this.fromRdfHandlers[J.datatype.value];return ut?ut.fromRdf(J,xt):J.value}toRdf(J,xt){const ut=this.toRdfHandlers[typeof J];if(ut)for(const Y of ut){const Ae=Y.toRdf(J,xt);if(Ae)return Ae}throw new Error(`Invalid JavaScript value: '${J}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(Vt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerBoolean=void 0;const gt=tt(60);class J{fromRdf(ut,Y){switch(ut.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return Y&&gt.Translator.incorrectRdfDataType(ut),!1}toRdf(ut,{datatype:Y,dataFactory:Ae}){return Ae.literal(ut?"true":"false",Y||Ae.namedNode(J.TYPE))}}it.TypeHandlerBoolean=J,J.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},525:(Vt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerDate=void 0;const gt=tt(60);class J{fromRdf(ut,Y){switch(Y&&!ut.value.match(J.VALIDATORS[ut.datatype.value.substr(33,ut.datatype.value.length)])&&gt.Translator.incorrectRdfDataType(ut),ut.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(ut.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const Ae=ut.value.split("-");return new Date(0,parseInt(Ae[0],10)-1,parseInt(Ae[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(ut.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(ut.value+"-01");default:return new Date(ut.value)}}toRdf(ut,{datatype:Y,dataFactory:Ae}){if(Y=Y||Ae.namedNode(J.TYPES[0]),!(ut instanceof Date))return null;const he=ut;let W;switch(Y.value){case"http://www.w3.org/2001/XMLSchema#gDay":W=String(he.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":W=he.getUTCMonth()+1+"-"+he.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":W=String(he.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":W=he.getUTCFullYear()+"-"+(he.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":W=he.toISOString().replace(/T.*$/,"");break;default:W=he.toISOString()}return Ae.literal(W,Y)}}it.TypeHandlerDate=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],J.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(Vt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberDouble=void 0;const gt=tt(60);class J{fromRdf(ut,Y){const Ae=parseFloat(ut.value);return Y&&isNaN(Ae)&&gt.Translator.incorrectRdfDataType(ut),Ae}toRdf(ut,{datatype:Y,dataFactory:Ae}){return Y=Y||Ae.namedNode(J.TYPES[0]),isNaN(ut)?Ae.literal("NaN",Y):isFinite(ut)?ut%1==0?null:Ae.literal(ut.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Y):Ae.literal(ut>0?"INF":"-INF",Y)}}it.TypeHandlerNumberDouble=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(Vt,it,tt)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerNumberInteger=void 0;const gt=tt(60);class J{fromRdf(ut,Y){const Ae=parseInt(ut.value,10);return Y&&(isNaN(Ae)||ut.value.indexOf(".")>=0)&&gt.Translator.incorrectRdfDataType(ut),Ae}toRdf(ut,{datatype:Y,dataFactory:Ae}){return Ae.literal(String(ut),Y||Ae.namedNode(ut<=J.MAX_INT&&ut>=J.MIN_INT?J.TYPES[0]:J.TYPES[1]))}}it.TypeHandlerNumberInteger=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],J.MAX_INT=2147483647,J.MIN_INT=-2147483648},608:(Vt,it)=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.TypeHandlerString=void 0;class tt{fromRdf(J){return J.value}toRdf(J,{datatype:xt,dataFactory:ut}){return ut.literal(J,xt)}}it.TypeHandlerString=tt,tt.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:function(Vt,it,tt){"use strict";var gt=this&&this.__createBinding||(Object.create?function(xt,ut,Y,Ae){void 0===Ae&&(Ae=Y),Object.defineProperty(xt,Ae,{enumerable:!0,get:function(){return ut[Y]}})}:function(xt,ut,Y,Ae){void 0===Ae&&(Ae=Y),xt[Ae]=ut[Y]}),J=this&&this.__exportStar||function(xt,ut){for(var Y in xt)"default"!==Y&&!Object.prototype.hasOwnProperty.call(ut,Y)&&gt(ut,xt,Y)};Object.defineProperty(it,"__esModule",{value:!0}),J(tt(727),it),J(tt(525),it),J(tt(554),it),J(tt(750),it),J(tt(608),it)},888:(Vt,it,tt)=>{"use strict";var gt={};tt.r(gt),tt.d(gt,{decode:()=>Mge,encode:()=>Ige});var J={};tt.r(J),tt.d(J,{decode:()=>Fge,encode:()=>Lge});var xt={};tt.r(xt),tt.d(xt,{decode:()=>kge,encode:()=>Bge});var ut={};function Y(n){return"function"==typeof n}tt.r(ut),tt.d(ut,{decode:()=>Vge,encode:()=>jge});let Ae=!1;const he={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Ae&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Ae=n},get useDeprecatedSynchronousErrorHandling(){return Ae}};function W(n){setTimeout(()=>{throw n},0)}const j={closed:!0,next(n){},error(n){if(he.useDeprecatedSynchronousErrorHandling)throw n;W(n)},complete(){}},L=Array.isArray||(n=>n&&"number"==typeof n.length);function re(n){return null!==n&&"object"==typeof n}const b=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class S{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof S)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(Y(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof b?R(o.errors):[o]}}if(L(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(re(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof b?e=e.concat(R(c.errors)):e.push(c)}}}if(e)throw new b(e)}add(e){let t=e;if(!e)return S.EMPTY;switch(typeof e){case"function":t=new S(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof S)){const s=t;t=new S,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof S){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function R(n){return n.reduce((e,t)=>e.concat(t instanceof b?t.errors:t),[])}S.EMPTY=((n=new S).closed=!0,n);const A="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends S{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=j;break;case 1:if(!e){this.destination=j;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new w(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new w(this,e,t,i)}}[A](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class w extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;Y(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==j&&(o=Object.create(t),Y(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;he.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=he;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):W(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;W(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);he.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),he.useDeprecatedSynchronousErrorHandling)throw i;W(i)}}__tryOrSetError(e,t,i){if(!he.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return he.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(W(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const I="function"==typeof Symbol&&Symbol.observable||"@@observable";function H(n){return n}let F=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[A])return n[A]()}return n||e||t?new y(n,e,t):new y(j)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||he.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),he.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){he.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=Q(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[I](){return this}pipe(...t){return 0===t.length?this:function(n){return 0===n.length?H:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=Q(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Q(n){if(n||(n=he.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const U=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class ie extends S{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class ue extends y{constructor(e){super(e),this.destination=e}}let ee=(()=>{class n extends F{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[A](){return new ue(this)}lift(t){const i=new se(this,this);return i.operator=t,i}next(t){if(this.closed)throw new U;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new U;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new U;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new U;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new U;return this.hasError?(t.error(this.thrownError),S.EMPTY):this.isStopped?(t.complete(),S.EMPTY):(this.observers.push(t),new ie(this,t))}asObservable(){const t=new F;return t.source=this,t}}return n.create=(e,t)=>new se(e,t),n})();class se extends ee{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):S.EMPTY}}function Te(n){return n&&"function"==typeof n.schedule}function ve(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new te(n,e))}}class te{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new _e(e,this.project,this.thisArg))}}class _e extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Me=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Ze="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Le=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ee(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const Ie=n=>{if(n&&"function"==typeof n[I])return(n=>e=>{const t=n[I]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(Le(n))return Me(n);if(Ee(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,W),e))(n);if(n&&"function"==typeof n[Ze])return(n=>e=>{const t=n[Ze]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${re(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Be(n,e){return new F(t=>{const i=new S;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function Pe(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[I]}(n))return function(n,e){return new F(t=>{const i=new S;return i.add(e.schedule(()=>{const r=n[I]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Ee(n))return function(n,e){return new F(t=>{const i=new S;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(Le(n))return Be(n,e);if(function(n){return n&&"function"==typeof n[Ze]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new F(t=>{const i=new S;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Ze](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof F?n:new F(Ie(n))}class wt extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class pe extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function O(n,e){if(e.closed)return;if(n instanceof F)return n.subscribe(e);let t;try{t=Ie(n)(e)}catch(i){e.error(i)}return t}function k(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(k((r,s)=>Pe(n(r,s)).pipe(ve((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Oe(n,t)))}class Oe{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Xe(e,this.project,this.concurrent))}}class Xe extends pe{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new wt(this),i=this.destination;i.add(t);const r=O(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function It(n=Number.POSITIVE_INFINITY){return k(H,n)}function An(n,e){return e?Be(n,e):new F(Me(n))}function Rn(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return Te(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof F?n[0]:It(e)(An(n,t))}function zn(){return function(e){return e.lift(new _i(e))}}class _i{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new ci(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class ci extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class jr extends F{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new S,e.add(this.source.subscribe(new ss(this.getSubject(),this))),e.closed&&(this._connection=null,e=S.EMPTY)),e}refCount(){return zn()(this)}}const Is=(()=>{const n=jr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class ss extends ue{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}class _l{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function aa(){return new ee}function fs(){return n=>zn()(function(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new _l(r,e));const s=Object.create(i,Is);return s.source=i,s.subjectFactory=r,s}}(aa)(n))}function Zt(n){for(let e in n)if(n[e]===Zt)return e;throw Error("Could not find renamed property on target object.")}function ja(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function rt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(rt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function ot(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ct=Zt({__forward_ref__:Zt});function fe(n){return n.__forward_ref__=fe,n.toString=function(){return rt(this())},n}function ye(n){return ke(n)?n():n}function ke(n){return"function"==typeof n&&n.hasOwnProperty(ct)&&n.__forward_ref__===fe}class Qe extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function At(n){return"string"==typeof n?n:null==n?"":String(n)}function qt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():At(n)}function pn(n,e){const t=e?` in ${e}`:"";throw new Qe("201",`No provider for ${qt(n)} found${t}`)}function Z(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function $e(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Et(n){return{providers:n.providers||[],imports:n.imports||[]}}function gn(n){return ps(n,io)||ps(n,Rs)}function ps(n,e){return n.hasOwnProperty(e)?n[e]:null}function yl(n){return n&&(n.hasOwnProperty(Rr)||n.hasOwnProperty(rc))?n[Rr]:null}const io=Zt({\u0275prov:Zt}),Rr=Zt({\u0275inj:Zt}),Rs=Zt({ngInjectableDef:Zt}),rc=Zt({ngInjectorDef:Zt});var bn=(()=>((bn=bn||{})[bn.Default=0]="Default",bn[bn.Host=1]="Host",bn[bn.Self=2]="Self",bn[bn.SkipSelf=4]="SkipSelf",bn[bn.Optional=8]="Optional",bn))();let ro;function ca(n){const e=ro;return ro=n,e}function Zu(n,e,t){const i=gn(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&bn.Optional?null:void 0!==e?e:void pn(rt(n),"Injector")}function xe(n){return{toString:n}.toString()}var He=(()=>((He=He||{})[He.OnPush=0]="OnPush",He[He.Default=1]="Default",He))(),$t=(()=>(($t=$t||{})[$t.Emulated=0]="Emulated",$t[$t.None=2]="None",$t[$t.ShadowDom=3]="ShadowDom",$t))();const ni="undefined"!=typeof globalThis&&globalThis,Nr="undefined"!=typeof window&&window,Gr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,gs="undefined"!=typeof global&&global,Jn=ni||gs||Nr||Gr,Ju={},$i=[],jf=Zt({\u0275cmp:Zt}),wm=Zt({\u0275dir:Zt}),ch=Zt({\u0275pipe:Zt}),ab=Zt({\u0275mod:Zt}),_x=Zt({\u0275loc:Zt}),bl=Zt({\u0275fac:Zt}),uh=Zt({__NG_ELEMENT_ID__:Zt});let yx=0;function yn(n){return xe(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===He.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||$i,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||$t.Emulated,id:"c",styles:n.styles||$i,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=yx++,i.inputs=db(n.inputs,t),i.outputs=db(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(lb):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(cb):null,i})}function lb(n){return Ii(n)||function(n){return n[wm]||null}(n)}function cb(n){return function(n){return n[ch]||null}(n)}const ub={};function cn(n){return xe(()=>{const e={type:n.type,bootstrap:n.bootstrap||$i,declarations:n.declarations||$i,imports:n.imports||$i,exports:n.exports||$i,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(ub[n.id]=n.type),e})}function db(n,e){if(null==n)return Ju;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Bt=yn;function Ns(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Ii(n){return n[jf]||null}function bo(n,e){const t=n[ab]||null;if(!t&&!0===e)throw new Error(`Type ${rt(n)} does not have '\u0275mod' property.`);return t}function ko(n){return Array.isArray(n)&&"object"==typeof n[1]}function Bo(n){return Array.isArray(n)&&!0===n[1]}function Cm(n){return 0!=(8&n.flags)}function id(n){return 2==(2&n.flags)}function rd(n){return 1==(1&n.flags)}function ha(n){return null!==n.template}function hb(n){return 0!=(512&n[2])}function ac(n,e){return n.hasOwnProperty(bl)?n[bl]:null}class zf{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function ki(){return gb}function gb(n){return n.type.prototype.ngOnChanges&&(n.setInput=Ax),xx}function xx(){const n=st(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===Ju)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function Ax(n,e,t,i){const r=st(n)||function(n,e){return n[mh]=e}(n,{previous:Ju,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new zf(l&&l.currentValue,e,o===Ju),n[i]=e}ki.ngInherit=!0;const mh="__ngSimpleChanges__";function st(n){return n[mh]||null}let Bi;function ir(n){return!!n.listen}const tu={createRenderer:(n,e)=>void 0!==Bi?Bi:"undefined"!=typeof document?document:void 0};function gr(n){for(;Array.isArray(n);)n=n[0];return n}function _h(n,e){return gr(e[n])}function $s(n,e){return gr(e[n.index])}function Im(n,e){return n.data[e]}function sd(n,e){return n[e]}function Fs(n,e){const t=e[n];return ko(t)?t:t[0]}function Sl(n){return 4==(4&n[2])}function od(n){return 128==(128&n[2])}function pa(n,e){return null==e?null:n[e]}function Om(n){n[18]=0}function Gf(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Pn={lFrame:iu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function _b(){return Pn.bindingsEnabled}function kt(){return Pn.lFrame.lView}function ui(){return Pn.lFrame.tView}function jo(n){return Pn.lFrame.contextLView=n,n[8]}function Zr(){let n=Rm();for(;null!==n&&64===n.type;)n=n.parent;return n}function Rm(){return Pn.lFrame.currentTNode}function Ha(n,e){const t=Pn.lFrame;t.currentTNode=n,t.isParent=e}function Lr(){return Pn.lFrame.isParent}function os(){Pn.lFrame.isParent=!1}function bh(){return Pn.isInCheckNoChangesMode}function Wf(n){Pn.isInCheckNoChangesMode=n}function _s(){const n=Pn.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function ga(){return Pn.lFrame.bindingIndex++}function Eo(n){const e=Pn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function ad(n,e){const t=Pn.lFrame;t.bindingIndex=t.bindingRootIndex=n,Nm(e)}function Nm(n){Pn.lFrame.currentDirectiveIndex=n}function yb(){return Pn.lFrame.currentQueryIndex}function Fm(n){Pn.lFrame.currentQueryIndex=n}function Yf(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function ld(n,e,t){if(t&bn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&bn.Host||(r=Yf(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Pn.lFrame=Se();return i.currentTNode=e,i.lView=n,!0}function Sh(n){const e=Se(),t=n[1];Pn.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Se(){const n=Pn.lFrame,e=null===n?null:n.child;return null===e?iu(n):e}function iu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Ch(){const n=Pn.lFrame;return Pn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const So=Ch;function ri(){const n=Ch();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ws(){return Pn.lFrame.selectedIndex}function ao(n){Pn.lFrame.selectedIndex=n}function Dr(){const n=Pn.lFrame;return Im(n.tView,n.selectedIndex)}function Kf(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:d}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=d&&(n.destroyHooks||(n.destroyHooks=[])).push(t,d)}}function Xf(n,e,t){Ga(n,e,3,t)}function Qf(n,e,t,i){(3&n[2])===t&&Ga(n,e,t,i)}function Lm(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Ga(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(jx(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function jx(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class xh{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Zf(n,e,t){const i=ir(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];Bm(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function vb(n){return 3===n||4===n||6===n}function Bm(n){return 64===n.charCodeAt(0)}function Ah(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||Vm(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function Vm(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function bb(n){return-1!==n}function cd(n){return 32767&n}function $a(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let ud=!0;function Jf(n){const e=ud;return ud=n,e}let Um=0;function Ls(n,e){const t=ep(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,zm(i.data,n),zm(e,null),zm(i.blueprint,null));const r=Th(n,e),s=n.injectorIndex;if(bb(r)){const o=cd(r),a=$a(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function zm(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ep(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Th(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function cc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(uh)&&(i=t[uh]),null==i&&(i=t[uh]=Um++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function Hm(n,e,t){if(t&bn.Optional)return n;pn(e,"NodeInjector")}function Eb(n,e,t,i){if(t&bn.Optional&&void 0===i&&(i=null),0==(t&(bn.Self|bn.Host))){const r=n[9],s=ca(void 0);try{return r?r.get(e,i,t&bn.Optional):Zu(e,i,t&bn.Optional)}finally{ca(s)}}return Hm(i,e,t)}function Dh(n,e,t,i=bn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(uh)?n[uh]:void 0;return"number"==typeof e?e>=0?255&e:Cb:e}(t);if("function"==typeof s){if(!ld(e,n,i))return i&bn.Host?Hm(r,t,i):Eb(e,t,i,r);try{const o=s(i);if(null!=o||i&bn.Optional)return o;pn(t)}finally{So()}}else if("number"==typeof s){let o=null,a=ep(n,e),l=-1,c=i&bn.Host?e[16][6]:null;for((-1===a||i&bn.SkipSelf)&&(l=-1===a?Th(n,e):e[a+8],-1!==l&&Mh(i,!1)?(o=e[1],a=cd(l),e=$a(l,e)):a=-1);-1!==a;){const d=e[1];if(tp(s,a,d.data)){const f=ys(a,e,t,o,i,c);if(f!==Sb)return f}l=e[a+8],-1!==l&&Mh(i,e[1].data[a+8]===c)&&tp(s,a,e)?(o=d,a=cd(l),e=$a(l,e)):a=-1}}}return Eb(e,t,i,r)}const Sb={};function Cb(){return new Uo(Zr(),kt())}function ys(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],d=dd(a,o,t,null==i?id(a)&&ud:i!=o&&0!=(3&a.type),r&bn.Host&&s===a);return null!==d?hd(e,o,d,a):Sb}function dd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,d=s>>20,p=r?a+d:n.directiveEnd;for(let g=i?a:a+d;g<p;g++){const _=o[g];if(g<l&&t===_||g>=l&&_.type===t)return g}if(r){const g=o[l];if(g&&ha(g)&&g.type===t)return l}return null}function hd(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof xh}(r)){const o=r;o.resolving&&function(n,e){throw new Qe("200",`Circular dependency in DI detected for ${n}`)}(qt(s[t]));const a=Jf(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ca(o.injectImpl):null;ld(n,i,bn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=gb(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&ca(l),Jf(a),o.resolving=!1,So()}}return r}function tp(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Mh(n,e){return!(n&bn.Self||n&bn.Host&&e)}class Uo{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Dh(this._tNode,this._lView,e,void 0,t)}}function Yi(n){return xe(()=>{const e=n.prototype.constructor,t=e[bl]||vs(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[bl]||vs(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function vs(n){return ke(n)?()=>{const e=vs(ye(n));return e&&e()}:ac(n)}const pd="__parameters__";function ya(n,e,t){return xe(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,d){const f=l.hasOwnProperty(pd)?l[pd]:Object.defineProperty(l,pd,{value:[]})[pd];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class zt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=$e({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Ho(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),Ho(i,e)):e!==n&&e.push(i)}return e}function Go(n,e){n.forEach(t=>Array.isArray(t)?Go(t,e):e(t))}function Oh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function xl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function dc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Co(n,e,t){let i=bs(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Km(n,e){const t=bs(n,e);if(t>=0)return n[1|t]}function bs(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const cu={},op="__NG_DI_FLAG__",fc="ngTempTokenPath",pc=/\n/gm,Ya="__source",ap=Zt({provide:String,useValue:Zt});let uu;function _d(n){const e=uu;return uu=n,e}function t1(n,e=bn.Default){if(void 0===uu)throw new Error("inject() must be called from an injection context");return null===uu?Zu(n,void 0,e):uu.get(n,e&bn.Optional?null:void 0,e)}function Re(n,e=bn.Default){return(ro||t1)(ye(n),e)}const gc=Re;function du(n){const e=[];for(let t=0;t<n.length;t++){const i=ye(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=bn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=Ib(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Re(r,s))}else e.push(Re(i))}return e}function yd(n,e){return n[op]=e,n.prototype[op]=e,n}function Ib(n){return n[op]}function qs(n,e,t,i){const r=n[fc];throw e[Ya]&&r.unshift(e[Ya]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=rt(e);if(Array.isArray(e))r=e.map(rt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):rt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(pc,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[fc]=null,n}const vd=yd(ya("Inject",n=>({token:n})),-1),Wr=yd(ya("Optional"),8),Ka=yd(ya("SkipSelf"),4);function ks(n){return n instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}const h_="__ngContext__";function ws(n,e){n[h_]=e}function f_(n){const e=function(n){return n[h_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function vp(n){return n.ngOriginalError}function A1(n,...e){n.error(...e)}class Yo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||A1}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(vp(e)):null}_findOriginalError(e){let t=e&&vp(e);for(;t&&vp(t);)t=vp(t);return t||null}}const r0=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Jn))();function Qa(n){return n instanceof Function?n():n}var To=(()=>((To=To||{})[To.Important=1]="Important",To[To.DashCase=2]="DashCase",To))();function y_(n,e){return undefined(n,e)}function Bh(n){const e=n[3];return Bo(e)?e[3]:e}function xd(n){return c0(n[13])}function b_(n){return c0(n[4])}function c0(n){for(;null!==n&&!Bo(n);)n=n[4];return n}function Ad(n,e,t,i,r){if(null!=i){let s,o=!1;Bo(i)?s=i:ko(i)&&(o=!0,i=i[0]);const a=gr(i);0===n&&null!==t?null==r?p0(e,t,a):Za(e,t,a,r||null,!0):1===n&&null!==t?Za(e,t,a,r||null,!0):2===n?function(n,e,t){const i=Ep(n,e);i&&function(n,e,t,i){ir(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==gr(t)&&Ad(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Td(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function E_(n,e,t){return ir(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function d0(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Gf(r,-1)),t.splice(i,1)}function S_(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&d0(r,i),e>0&&(n[t-1][4]=i[4]);const s=xl(n,10+e);!function(n,e){Td(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function C_(n,e){if(!(256&e[2])){const t=e[11];ir(t)&&t.destroyNode&&Td(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return wp(n[1],n);for(;e;){let t=null;if(ko(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)ko(e)&&wp(e[1],e),e=e[3];null===e&&(e=n),ko(e)&&wp(e[1],e),t=e&&e[4]}e=t}}(e)}}function wp(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof xh)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):gr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&ir(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Bo(e[3])){t!==e[3]&&d0(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function h0(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===$t.None||r===$t.Emulated)return null}return $s(i,t)}(n,e.parent,t)}function Za(n,e,t,i,r){ir(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function p0(n,e,t){ir(n)?n.appendChild(e,t):e.appendChild(t)}function g0(n,e,t,i,r){null!==i?Za(n,e,t,i,r):p0(n,e,t)}function Ep(n,e){return ir(n)?n.parentNode(e):e.parentNode}function m0(n,e,t){return y0(n,e,t)}let y0=function(n,e,t){return 40&n.type?$s(n,t):null};function Sp(n,e,t,i){const r=h0(n,i,e),s=e[11],a=m0(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)g0(s,r,t[l],a,!1);else g0(s,r,t,a,!1)}function gu(n,e){if(null!==e){const t=e.type;if(3&t)return $s(e,n);if(4&t)return Cp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return gu(n,i);{const r=n[e.index];return Bo(r)?Cp(-1,r):gr(r)}}if(32&t)return y_(e,n)()||gr(n[e.index]);{const i=b0(n,e);return null!==i?Array.isArray(i)?i[0]:gu(Bh(n[16]),i):gu(n,e.next)}}return null}function b0(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Cp(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return gu(i,r)}return e[7]}function Vh(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&ws(gr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)Vh(n,e,t.child,i,r,s,!1),Ad(e,n,r,a,s);else if(32&l){const c=y_(t,i);let d;for(;d=c();)Ad(e,n,r,d,s);Ad(e,n,r,a,s)}else 16&l?T_(n,e,i,t,r,s):Ad(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Td(n,e,t,i,r,s){Vh(t,i,n.firstChild,e,r,s,!1)}function T_(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Ad(e,n,r,l[c],s);else Vh(n,e,l,o[3],r,s,!0)}function S0(n,e,t){ir(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function D_(n,e,t){ir(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function jh(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const C0="ng-template";function Q1(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==jh(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function xp(n){return 4===n.type&&n.value!==C0}function x0(n,e,t){return e===(4!==n.type||t?n.value:C0)}function Z1(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(vb(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!x0(n,l,t)||""===l&&1===e.length){if(ba(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!Q1(n.attrs,c,t)){if(ba(i))return!1;o=!0}continue}const f=J1(8&i?"class":l,r,xp(n),t);if(-1===f){if(ba(i))return!1;o=!0;continue}if(""!==c){let p;p=f>s?"":r[f+1].toLowerCase();const g=8&i?p:null;if(g&&-1!==jh(g,c,0)||2&i&&c!==p){if(ba(i))return!1;o=!0}}}}else{if(!o&&!ba(i)&&!ba(l))return!1;if(o&&ba(l))continue;o=!1,i=l|1&i}}return ba(i)||o}function ba(n){return 0==(1&n)}function J1(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function A0(n,e,t=!1){for(let i=0;i<e.length;i++)if(Z1(n,e[i],t))return!0;return!1}function iA(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function T0(n,e){return n?":not("+e.trim()+")":e}function rA(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!ba(o)&&(e+=T0(s,r),r=""),i=o,s=s||!ba(i);t++}return""!==r&&(e+=T0(s,r)),e}const xn={};function Yt(n){D0(ui(),kt(),Ws()+n,bh())}function D0(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&Xf(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Qf(e,s,0,t)}ao(t)}function Ja(n,e){return n<<17|e<<2}function Tn(n){return n>>17&32767}function mr(n){return 2|n}function Il(n){return(131068&n)>>2}function el(n,e){return-131069&n|e<<2}function I_(n){return 1|n}function k0(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];Fm(r),o.contentQueries(2,e[s],s)}}}function zh(n,e,t,i,r,s,o,a,l,c){const d=e.blueprint.slice();return d[0]=r,d[2]=140|i,Om(d),d[3]=d[15]=n,d[8]=t,d[10]=o||n&&n[10],d[11]=a||n&&n[11],d[12]=l||n&&n[12]||null,d[9]=c||n&&n[9]||null,d[6]=s,d[16]=2==e.type?n[16]:d,d}function Md(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=Rm(),o=Lr(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Pn.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Pn.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Ha(s,!0),s}function Id(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Hh(n,e,t){Sh(e);try{const i=n.viewQuery;null!==i&&W_(1,i,t);const r=n.template;null!==r&&B0(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&k0(n,e),n.staticViewQueries&&W_(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)PA(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,ri()}}function Od(n,e,t,i){const r=e[2];if(256==(256&r))return;Sh(e);const s=bh();try{Om(e),function(n){Pn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&B0(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&Xf(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Qf(e,c,0,null),Lm(e,0)}if(function(n){for(let e=xd(n);null!==e;e=b_(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&Gf(s,1),r[2]|=1024}}}(e),function(n){for(let e=xd(n);null!==e;e=b_(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];od(i)&&Od(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&k0(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&Xf(e,c)}else{const c=n.contentHooks;null!==c&&Qf(e,c,1),Lm(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)ao(~r);else{const s=r,o=t[++i],a=t[++i];ad(o,s),a(2,e[s])}}}finally{ao(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)NA(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&W_(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&Xf(e,c)}else{const c=n.viewHooks;null!==c&&Qf(e,c,2),Lm(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Gf(e[3],-1))}finally{ri()}}function _A(n,e,t,i){const r=e[10],s=!bh(),o=Sl(e);try{s&&!o&&r.begin&&r.begin(),o&&Hh(n,e,i),Od(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function B0(n,e,t,i,r){const s=Ws(),o=2&i;try{ao(-1),o&&e.length>20&&D0(n,e,20,bh()),t(i,r)}finally{ao(s)}}function Gh(n,e,t){!_b()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||Ls(t,e),ws(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=ha(l);c&&DA(e,t,l);const d=hd(e,n,a,t);ws(d,e),null!==o&&MA(0,a-r,d,l,0,o),c&&(Fs(t.index,e)[8]=d)}}(n,e,t,$s(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Pn.lFrame.currentDirectiveIndex;try{ao(o);for(let l=i;l<r;l++){const c=n.data[l],d=e[l];Nm(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&Y0(c,d)}}finally{ao(-1),Nm(a)}}(n,e,t))}function k_(n,e,t=$s){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Mp(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Ip(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Ip(n,e,t,i,r,s,o,a,l,c){const d=20+i,f=d+r,p=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:xn);return t}(d,f),g="function"==typeof c?c():c;return p[1]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function U0(n,e,t,i){const r=Z0(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Rp(n).push(i,r.length-1))}function z0(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function Do(n,e,t,i,r,s,o,a){const l=$s(e,t);let d,c=e.inputs;!a&&null!=c&&(d=c[i])?(J0(n,t,d,i,r),id(e)&&function(n,e){const t=Fs(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,ir(s)?s.setProperty(l,i,r):Bm(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function B_(n,e,t,i){let r=!1;if(_b()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];A0(t,o.selectors,!1)&&(r||(r=[]),cc(Ls(t,e),n,o.type),ha(o)?(K0(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,V_(t,n.data.length,s.length);for(let d=0;d<s.length;d++){const f=s[d];f.providersResolver&&f.providersResolver(f)}let a=!1,l=!1,c=Id(n,e,s.length,null);for(let d=0;d<s.length;d++){const f=s[d];t.mergedAttrs=Ah(t.mergedAttrs,f.hostAttrs),j_(n,t,e,c,f),TA(c,f,o),null!==f.contentQueries&&(t.flags|=8),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=128);const p=f.type.prototype;!a&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const d=r[c],f=d.inputs,p=null===s||xp(e)?null:IA(f,s);o.push(p),a=z0(f,c,a),l=z0(d.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Qe("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Ah(t.mergedAttrs,t.attrs),r}function q0(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function Y0(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function K0(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function TA(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ha(e)&&(t[""]=n)}}function V_(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function j_(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=ac(r.type)),o=new xh(s,ha(r),null);n.blueprint[i]=o,t[i]=o,q0(n,e,0,i,Id(n,t,r.hostVars,xn),r)}function DA(n,e,t){const i=$s(e,n),r=Mp(t),s=n[10],o=Op(n,zh(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function nl(n,e,t,i,r,s){const o=$s(n,e);!function(n,e,t,i,r,s,o){if(null==s)ir(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?At(s):o(s,i||"",r);ir(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function MA(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],d=o[l++],f=o[l++];null!==a?i.setInput(t,f,c,d):t[d]=f}}}function IA(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function X0(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function NA(n,e){const t=Fs(e,n);if(od(t)){const i=t[1];80&t[2]?Od(i,t,i.template,t[8]):t[5]>0&&z_(t)}}function z_(n){for(let i=xd(n);null!==i;i=b_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Od(o,s,o.template,s[8])}else s[5]>0&&z_(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Fs(t[i],n);od(r)&&r[5]>0&&z_(r)}}function PA(n,e){const t=Fs(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),Hh(i,t,t[8])}function Op(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function H_(n){for(;n;){n[2]|=64;const e=Bh(n);if(hb(n)&&!e)return n;n=e}return null}function $_(n,e,t){const i=e[10];i.begin&&i.begin();try{Od(n,e,n.template,t)}catch(r){throw Y_(e,r),r}finally{i.end&&i.end()}}function Q0(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=f_(t),r=i[1];_A(r,i,r.template,t)}}(n[8])}function W_(n,e,t){Fm(0),e(n,t)}const VA=(()=>Promise.resolve(null))();function Z0(n){return n[7]||(n[7]=[])}function Rp(n){return n.cleanup||(n.cleanup=[])}function Y_(n,e){const t=n[9],i=t?t.get(Yo,null):null;i&&i.handleError(e)}function J0(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Ol(n,e,t){const i=_h(e,n);!function(n,e,t){ir(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function Np(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=ot(r,a):2==s&&(i=ot(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Nd=new zt("INJECTOR",-1);class Xs{get(e,t=cu){if(t===cu){const i=new Error(`NullInjectorError: No provider for ${rt(e)}!`);throw i.name="NullInjectorError",i}return t}}const mu=new zt("Set Injector scope."),$h={},UA={};let X_;function ew(){return void 0===X_&&(X_=new Xs),X_}function tw(n,e=null,t=null,i){return new Z_(n,t,e||ew(),i)}class Z_{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Go(t,a=>this.processProvider(a,e,t)),Go([e],a=>this.processInjectorType(a,[],s)),this.records.set(Nd,_u(void 0,this));const o=this.records.get(mu);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:rt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=cu,i=bn.Default){this.assertNotDestroyed();const r=_d(this),s=ca(void 0);try{if(!(i&bn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof zt}(e)&&gn(e);a=l&&this.injectableDefInScope(l)?_u(J_(e),$h):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&bn.Self?ew():this.parent).get(e,t=i&bn.Optional&&t===cu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[fc]=o[fc]||[]).unshift(rt(e)),r)throw o;return qs(o,e,"R3InjectorError",this.source)}throw o}finally{ca(s),_d(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(rt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=ye(e)))return!1;let r=yl(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=yl(s)),null==r)return!1;if(null!=r.imports&&!a){let d;i.push(o);try{Go(r.imports,f=>{this.processInjectorType(f,t,i)&&(void 0===d&&(d=[]),d.push(f))})}finally{}if(void 0!==d)for(let f=0;f<d.length;f++){const{ngModule:p,providers:g}=d[f];Go(g,_=>this.processProvider(_,p,g||$i))}}this.injectorDefTypes.add(o);const l=ac(o)||(()=>new o);this.records.set(o,_u(l,$h));const c=r.providers;if(null!=c&&!a){const d=e;Go(c,f=>this.processProvider(f,d,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=bc(e=ye(e))?e:ye(e&&e.provide);const s=function(n,e,t){return iw(n)?_u(void 0,n.useValue):_u(nw(n),$h)}(e);if(bc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=_u(void 0,$h,!0),o.factory=()=>du(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===$h&&(t.value=UA,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ye(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function J_(n){const e=gn(n),t=null!==e?e.factory:ac(n);if(null!==t)return t;if(n instanceof zt)throw new Error(`Token ${rt(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=dc(e,"?");throw new Error(`Can't resolve all parameters for ${rt(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[io]||n[Rs]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function nw(n,e,t){let i;if(bc(n)){const r=ye(n);return ac(r)||J_(r)}if(iw(n))i=()=>ye(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...du(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>Re(ye(n.useExisting));else{const r=ye(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return ac(r)||J_(r);i=()=>new r(...du(n.deps))}return i}function _u(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function iw(n){return null!==n&&"object"==typeof n&&ap in n}function bc(n){return"function"==typeof n}const rw=function(n,e,t){return function(n,e=null,t=null,i){const r=tw(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class Hn{static create(e,t){return Array.isArray(e)?rw(e,t,""):rw(e.providers,e.parent,e.name||"")}}function lW(n,e){Kf(f_(n)[1],Zr())}function Mn(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(ha(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=tT(n.inputs),o.declaredInputs=tT(n.declaredInputs),o.outputs=tT(n.outputs);const a=r.hostBindings;a&&hW(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&uW(n,l),c&&dW(n,c),ja(n.inputs,r.inputs),ja(n.declaredInputs,r.declaredInputs),ja(n.outputs,r.outputs),ha(r)&&r.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Mn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Ah(r.hostAttrs,t=Ah(t,r.hostAttrs))}}(i)}function tT(n){return n===Ju?{}:n===$i?[]:n}function uW(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function dW(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function hW(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}Hn.THROW_IF_NOT_FOUND=cu,Hn.NULL=new Xs,Hn.\u0275prov=$e({token:Hn,providedIn:"any",factory:()=>Re(Nd)}),Hn.__NG_ELEMENT_ID__=-1;let cw=null;function Pp(){if(!cw){const n=Jn.Symbol;if(n&&n.iterator)cw=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(cw=i)}}}return cw}class Nl{constructor(e){this.wrapped=e}static wrap(e){return new Nl(e)}static unwrap(e){return Nl.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Nl}}function ry(n){return!!nT(n)&&(Array.isArray(n)||!(n instanceof Map)&&Pp()in n)}function nT(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Ec(n,e,t){return n[e]=t}function ho(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function ji(n,e,t,i){const r=kt();return ho(r,ga(),e)&&(ui(),nl(Dr(),r,n,e,t,i)),ji}function Di(n,e,t,i,r,s,o,a){const l=kt(),c=ui(),d=n+20,f=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,d=Md(e,n,4,o||null,pa(c,a));B_(e,t,d,pa(c,l)),Kf(e,d);const f=d.tViews=Ip(2,d,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}(d,c,l,e,t,i,r,s,o):c.data[d];Ha(f,!1);const p=l[11].createComment("");Sp(c,l,p,f),ws(p,l),Op(l,l[d]=X0(p,l,p,f)),rd(f)&&Gh(c,l,f),null!=o&&k_(l,f,a)}function Gp(n){return sd(Pn.lFrame.contextLView,20+n)}function De(n,e=bn.Default){const t=kt();return null===t?Re(n,e):Dh(Zr(),t,ye(n),e)}function an(n,e,t){const i=kt();return ho(i,ga(),e)&&Do(ui(),Dr(),i,n,e,i[11],t,!1),an}function aT(n,e,t,i,r){const o=r?"class":"style";J0(n,t,e.inputs[o],o,i)}function Pt(n,e,t,i){const r=kt(),s=ui(),o=20+n,a=r[11],l=r[o]=E_(a,e,Pn.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=Md(e,n,2,r,pa(a,s));return B_(e,t,c,pa(a,o)),null!==c.attrs&&Np(c,c.attrs,!1),null!==c.mergedAttrs&&Np(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Ha(c,!0);const d=c.mergedAttrs;null!==d&&Zf(a,l,d);const f=c.classes;null!==f&&D_(a,l,f);const p=c.styles;null!==p&&S0(a,l,p),64!=(64&c.flags)&&Sp(s,r,l,c),0===Pn.lFrame.elementDepthCount&&ws(l,r),Pn.lFrame.elementDepthCount++,rd(c)&&(Gh(s,r,c),function(n,e,t){if(Cm(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&k_(r,c)}function Ft(){let n=Zr();Lr()?os():(n=n.parent,Ha(n,!1));const e=n;Pn.lFrame.elementDepthCount--;const t=ui();t.firstCreatePass&&(Kf(t,n),Cm(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&aT(t,e,kt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&aT(t,e,kt(),e.stylesWithoutHost,!1)}function xi(n,e,t,i){Pt(n,e,t,i),Ft()}function yu(){return kt()}function oy(n){return!!n&&"function"==typeof n.then}function DF(n){return!!n&&"function"==typeof n.subscribe}const hw=DF;function kn(n,e,t,i){const r=kt(),s=ui(),o=Zr();return function(n,e,t,i,r,s,o,a){const l=rd(i),d=n.firstCreatePass&&Rp(n),f=e[8],p=Z0(e);let g=!0;if(3&i.type||a){const T=$s(i,e),q=a?a(T):T,G=p.length,ge=a?Ne=>a(gr(Ne[i.index])):i.index;if(ir(t)){let Ne=null;if(!a&&l&&(Ne=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Ne)(Ne.__ngLastListenerFn__||Ne).__ngNextListenerFn__=s,Ne.__ngLastListenerFn__=s,g=!1;else{s=lT(i,e,f,s,!1);const Ge=t.listen(q,r,s);p.push(s,Ge),d&&d.push(r,ge,G,G+1)}}else s=lT(i,e,f,s,!0),q.addEventListener(r,s,o),p.push(s),d&&d.push(r,ge,G,o)}else s=lT(i,e,f,s,!1);const _=i.outputs;let x;if(g&&null!==_&&(x=_[r])){const T=x.length;if(T)for(let q=0;q<T;q+=2){const We=e[x[q]][x[q+1]].subscribe(s),dt=p.length;p.push(s,We),d&&d.push(r,i.index,dt,-(dt+1))}}}(s,r,r[11],o,n,e,!!t,i),kn}function IF(n,e,t,i){try{return!1!==t(i)}catch(r){return Y_(n,r),!1}}function lT(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Fs(n.index,e):e;0==(32&e[2])&&H_(a);let l=IF(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=IF(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function vr(n=1){return function(n){return(Pn.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Pn.lFrame.contextLView))[8]}(n)}function qW(n,e){let t=null;const i=function(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?A0(n,s,!0):iA(i,s))return r}else t=r}return t}function VF(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Tn(s):Il(s),l=!1;for(;0!==a&&(!1===l||o);){const d=n[a+1];XW(n[a],e)&&(l=!0,n[a+1]=i?I_(d):mr(d)),a=i?Tn(d):Il(d)}l&&(n[t+1]=i?mr(s):I_(s))}function XW(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&bs(n,e)>=0}const Ss={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function jF(n){return n.substring(Ss.key,Ss.keyEnd)}function UF(n,e){const t=Ss.textEnd;return t===e?-1:(e=Ss.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Ss.key=e,t),Yp(n,e,t))}function Yp(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function wi(n,e){return function(n,e,t,i){const r=kt(),s=ui(),o=Eo(2);s.firstUpdatePass&&qF(s,n,o,i),e!==xn&&ho(r,o,e)&&KF(s,s.data[Ws()],r,r[11],n,r[o+1]=function(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=rt(ks(n)))),n}(e,t),i,o)}(n,e,null,!0),wi}function Sc(n){!function(n,e,t,i){const r=ui(),s=Eo(2);r.firstUpdatePass&&qF(r,null,s,i);const o=kt();if(t!==xn&&ho(o,s,t)){const a=r.data[Ws()];if(QF(a,i)&&!WF(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=ot(l,t||"")),aT(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===xn&&(r=$i);let l=0,c=0,d=0<r.length?r[0]:null,f=0<s.length?s[0]:null;for(;null!==d||null!==f;){const p=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let x,_=null;d===f?(l+=2,c+=2,p!==g&&(_=f,x=g)):null===f||null!==d&&d<f?(l+=2,_=d):(c+=2,_=f,x=g),null!==_&&KF(n,e,t,i,_,x,o,a),d=l<r.length?r[l]:null,f=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return $i;const i=[],r=ks(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(Co,Cc,n,!0)}function Cc(n,e){for(let t=function(n){return function(n){Ss.key=0,Ss.keyEnd=0,Ss.value=0,Ss.valueEnd=0,Ss.textEnd=n.length}(n),UF(n,Yp(n,0,Ss.textEnd))}(e);t>=0;t=UF(e,t))Co(n,jF(e),!0)}function WF(n,e){return e>=n.expandoStartIndex}function qF(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Ws()],o=WF(n,t);QF(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=function(n){const e=Pn.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=ly(t=uT(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=uT(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Il(i))return n[Tn(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=uT(null,n,e,l[1],i),l=ly(l,e.attrs,i),function(n,e,t,i){n[Tn(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=ly(i,n[s].hostAttrs,t);return ly(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Tn(o),l=Il(o);n[i]=t;let d,c=!1;if(Array.isArray(t)){const f=t;d=f[1],(null===d||bs(f,d)>0)&&(c=!0)}else d=t;if(r)if(0!==l){const p=Tn(n[a+1]);n[i+1]=Ja(p,a),0!==p&&(n[p+1]=el(n[p+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Ja(a,0),0!==a&&(n[a+1]=el(n[a+1],i)),a=i;else n[i+1]=Ja(l,0),0===a?a=i:n[l+1]=el(n[l+1],i),l=i;c&&(n[i+1]=mr(n[i+1])),VF(n,d,i,!0),VF(n,d,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&bs(s,e)>=0&&(t[i+1]=I_(t[i+1]))}(e,d,n,i,s),o=Ja(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function uT(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=ly(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function ly(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Co(n,o,!!t||e[++s]))}return void 0===n?null:n}function KF(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];gw(function(n){return 1==(1&n)}(c)?XF(l,e,t,r,Il(c),o):void 0)||(gw(s)||function(n){return 2==(2&n)}(c)&&(s=XF(l,null,t,r,a,o)),function(n,e,t,i,r){const s=ir(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:To.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=To.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,_h(Ws(),t),r,s))}function XF(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),d=c?l[1]:l,f=null===d;let p=t[r+1];p===xn&&(p=f?$i:void 0);let g=f?Km(p,i):d===i?p:void 0;if(c&&!gw(g)&&(g=Km(l,i)),gw(g)&&(a=g,o))return a;const _=n[r+1];r=o?Tn(_):Il(_)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Km(l,i))}return a}function gw(n){return void 0!==n}function QF(n,e){return 0!=(n.flags&(e?16:32))}function Ei(n,e=""){const t=kt(),i=ui(),r=n+20,s=i.firstCreatePass?Md(i,r,1,e,null):i.data[r],o=t[r]=function(n,e){return ir(n)?n.createText(e):n.createTextNode(e)}(t[11],e);Sp(i,t,o,s),Ha(s,!1)}function Cs(n){return xc("",n,""),Cs}function xc(n,e,t){const i=kt(),r=function(n,e,t,i){return ho(n,ga(),t)?e+At(t)+i:xn}(i,n,e,t);return r!==xn&&Ol(i,Ws(),r),xc}function vu(n,e,t){const i=kt();return ho(i,ga(),e)&&Do(ui(),Dr(),i,n,e,i[11],t,!0),vu}const qh=void 0;var I7=["en",[["a","p"],["AM","PM"],qh],[["AM","PM"],qh,qh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],qh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],qh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",qh,"{1} 'at' {0}",qh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let Kp={};function gL(n){return n in Kp||(Kp[n]=Jn.ng&&Jn.ng.common&&Jn.ng.common.locales&&Jn.ng.common.locales[n]),Kp[n]}var sn=(()=>((sn=sn||{})[sn.LocaleId=0]="LocaleId",sn[sn.DayPeriodsFormat=1]="DayPeriodsFormat",sn[sn.DayPeriodsStandalone=2]="DayPeriodsStandalone",sn[sn.DaysFormat=3]="DaysFormat",sn[sn.DaysStandalone=4]="DaysStandalone",sn[sn.MonthsFormat=5]="MonthsFormat",sn[sn.MonthsStandalone=6]="MonthsStandalone",sn[sn.Eras=7]="Eras",sn[sn.FirstDayOfWeek=8]="FirstDayOfWeek",sn[sn.WeekendRange=9]="WeekendRange",sn[sn.DateFormat=10]="DateFormat",sn[sn.TimeFormat=11]="TimeFormat",sn[sn.DateTimeFormat=12]="DateTimeFormat",sn[sn.NumberSymbols=13]="NumberSymbols",sn[sn.NumberFormats=14]="NumberFormats",sn[sn.CurrencyCode=15]="CurrencyCode",sn[sn.CurrencySymbol=16]="CurrencySymbol",sn[sn.CurrencyName=17]="CurrencyName",sn[sn.Currencies=18]="Currencies",sn[sn.Directionality=19]="Directionality",sn[sn.PluralCase=20]="PluralCase",sn[sn.ExtraData=21]="ExtraData",sn))();const _w="en-US";let mL=_w;function hT(n){Z(n,"Expected localeId to be defined"),"string"==typeof n&&(mL=n.toLowerCase().replace(/_/g,"-"))}function gT(n,e,t,i,r){if(n=ye(n),Array.isArray(n))for(let s=0;s<n.length;s++)gT(n[s],e,t,i,r);else{const s=ui(),o=kt();let a=bc(n)?n:ye(n.provide),l=nw(n);const c=Zr(),d=1048575&c.providerIndexes,f=c.directiveStart,p=c.providerIndexes>>20;if(bc(n)||!n.multi){const g=new xh(l,r,De),_=_T(a,e,r?d:d+p,f);-1===_?(cc(Ls(c,o),s,a),mT(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(g),o.push(g)):(t[_]=g,o[_]=g)}else{const g=_T(a,e,d+p,f),_=_T(a,e,d,d+p),x=g>=0&&t[g],T=_>=0&&t[_];if(r&&!T||!r&&!x){cc(Ls(c,o),s,a);const q=function(n,e,t,i,r){const s=new xh(n,t,De);return s.multi=[],s.index=e,s.componentProviders=0,jL(s,r,i&&!t),s}(r?T9:A9,t.length,r,i,l);!r&&T&&(t[_].providerFactory=q),mT(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(q),o.push(q)}else mT(s,n,g>-1?g:_,jL(t[r?_:g],l,!r&&i));!r&&i&&T&&t[_].componentProviders++}}}function mT(n,e,t,i){const r=bc(e);if(r||function(n){return!!n.useClass}(e)){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const a=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const l=a.indexOf(t);-1===l?a.push(t,[i,o]):a[l+1].push(i,o)}else a.push(t,o)}}}function jL(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function _T(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function A9(n,e,t,i){return yT(this.multi,[])}function T9(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=hd(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),yT(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],yT(r,s);return s}function yT(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Wn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function(n,e,t){const i=ui();if(i.firstCreatePass){const r=ha(n);gT(t,i.data,i.blueprint,r,!0),gT(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class UL{}const HL="ngComponent";class I9{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${rt(n)}. Did you add it to @NgModule.entryComponents?`);return e[HL]=n,e}(e)}}class sl{}function Ew(...n){}function Qp(n,e){return new wn($s(n,e))}sl.NULL=new I9;const N9=function(){return Qp(Zr(),kt())};let wn=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=N9,n})();function GL(n){return n instanceof wn?n.nativeElement:n}class Yh{}let bT=(()=>{class n{}return n.\u0275prov=$e({token:n,providedIn:"root",factory:()=>null}),n})();class wu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const $L=new wu("12.2.5");class WL{constructor(){}supports(e){return ry(e)}create(e){return new V9(e)}}const B9=(n,e)=>e;class V9{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||B9}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<YL(i,r,s)?t:i,a=YL(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,d=l-r;if(c!=d){for(let p=0;p<c;p++){const g=p<s.length?s[p]:s[p]=0,_=g+p;d<=_&&_<c&&(s[p]=g+1)}s[o.previousIndex]=d-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!ry(e))throw new Error(`Error trying to diff '${rt(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Pp()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new j9(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new qL),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new qL),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class j9{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class U9{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class qL{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new U9,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function YL(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class KL{constructor(){}supports(e){return e instanceof Map||nT(e)}create(){return new z9}}class z9{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||nT(e)))throw new Error(`Error trying to diff '${rt(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new H9(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class H9{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function XL(){return new Zp([new WL])}let Zp=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||XL()),deps:[[n,new Ka,new Wr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=$e({token:n,providedIn:"root",factory:XL}),n})();function QL(){return new Jp([new KL])}let Jp=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||QL()),deps:[[n,new Ka,new Wr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=$e({token:n,providedIn:"root",factory:QL}),n})();function Sw(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(gr(s)),Bo(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Sw(l[1],l,c,i)}const o=t.type;if(8&o)Sw(n,e,t.child,i);else if(32&o){const a=y_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=b0(e,t);if(Array.isArray(a))i.push(...a);else{const l=Bh(e[16]);Sw(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class fy{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Sw(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Bo(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(S_(e,i),xl(t,i))}this._attachedToViewContainer=!1}C_(this._lView[1],this._lView)}onDestroy(e){U0(this._lView[1],this._lView,null,e)}markForCheck(){H_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){$_(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){Wf(!0);try{$_(n,e,t)}finally{Wf(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){Td(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class $9 extends fy{constructor(e){super(e),this._view=e}detectChanges(){Q0(this._view)}checkNoChanges(){!function(n){Wf(!0);try{Q0(n)}finally{Wf(!1)}}(this._view)}get context(){return null}}const q9=function(n){return function(n,e,t){if(id(n)&&!t){const i=Fs(n.index,e);return new fy(i,i)}return 47&n.type?new fy(e[16],e):null}(Zr(),kt(),16==(16&n))};let as=(()=>{class n{}return n.__NG_ELEMENT_ID__=q9,n})();const X9=[new KL],Z9=new Zp([new WL]),J9=new Jp(X9),tq=function(){return Cw(Zr(),kt())};let Io=(()=>{class n{}return n.__NG_ELEMENT_ID__=tq,n})();const nq=Io,iq=class extends nq{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=zh(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),Hh(t,i,e),new fy(i)}};function Cw(n,e){return 4&n.type?new iq(e,n,Qp(n,e)):null}class Ac{}const oq=function(){return t2(Zr(),kt())};let xs=(()=>{class n{}return n.__NG_ELEMENT_ID__=oq,n})();const lq=xs,JL=class extends lq{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Qp(this._hostTNode,this._hostLView)}get injector(){return new Uo(this._hostTNode,this._hostLView)}get parentInjector(){const e=Th(this._hostTNode,this._hostLView);if(bb(e)){const t=$a(e,this._hostLView),i=cd(e);return new Uo(t[1].data[i+8],t)}return new Uo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=e2(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(Ac,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return Bo(n[3])}(i)){const d=this.indexOf(e);if(-1!==d)this.detach(d);else{const f=i[3],p=new JL(f,f[6],f[3]);p.detach(p.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Oh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Cp(s,o),l=i[11],c=Ep(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,Td(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Oh(wT(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=e2(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=S_(this._lContainer,t);i&&(xl(wT(this._lContainer),t),C_(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=S_(this._lContainer,t);return i&&null!=xl(wT(this._lContainer),t)?new fy(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function e2(n){return n[8]}function wT(n){return n[8]||(n[8]=[])}function t2(n,e){let t;const i=e[n.index];if(Bo(i))t=i;else{let r;if(8&n.type)r=gr(i);else{const s=e[11];r=s.createComment("");const o=$s(n,e);Za(s,Ep(s,o),r,function(n,e){return ir(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=X0(i,e,r,n),Op(e,t)}return new JL(t,n,e)}const ig={};class E2 extends sl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ii(e);return new C2(t,this.ngModule)}}function S2(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const rY=new zt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>r0});class C2 extends UL{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map(rA).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return S2(this.componentDef.inputs)}get outputs(){return S2(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,ig,r);return s!==ig||i===ig?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(Yh,tu),a=s.get(bT,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",d=i?function(n,e,t){if(ir(n))return n.selectRootElement(e,t===$t.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):E_(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),f=this.componentDef.onPush?576:528,p=function(n,e){return{components:[],scheduler:n||r0,clean:VA,playerHandler:e||null,flags:0}}(),g=Ip(0,null,null,1,0,null,null,null,null,null),_=zh(null,g,p,f,null,null,o,l,a,s);let x,T;Sh(_);try{const q=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=Md(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(Np(l,c,!0),null!==n&&(Zf(r,n,c),null!==l.classes&&D_(r,n,l.classes),null!==l.styles&&S0(r,n,l.styles)));const d=i.createRenderer(n,e),f=zh(t,Mp(e),null,e.onPush?64:16,t[20],l,i,d,s||null,null);return o.firstCreatePass&&(cc(Ls(l,t),o,e.type),K0(o,l),V_(l,t.length,1)),Op(t,f),t[20]=f}(d,this.componentDef,_,o,l);if(d)if(i)Zf(l,d,["ng-version",$L.full]);else{const{attrs:G,classes:ge}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!ba(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);G&&Zf(l,d,G),ge&&ge.length>0&&D_(l,d,ge.join(" "))}if(T=Im(g,20),void 0!==t){const G=T.projection=[];for(let ge=0;ge<this.ngContentSelectors.length;ge++){const Ne=t[ge];G.push(null!=Ne?Array.from(Ne):null)}}x=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=Zr();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),j_(n,i,e,Id(n,e,1,null),t));const r=hd(e,n,i.directiveStart,i);ws(r,e);const s=$s(i,e);return s&&ws(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=Zr();e.contentQueries(1,o,l.directiveStart)}const a=Zr();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(ao(a.index),q0(t[1],a,0,a.directiveStart,a.directiveEnd,e),Y0(e,o)),o}(q,this.componentDef,_,p,[lW]),Hh(g,_,null)}finally{ri()}return new aY(this.componentType,x,Qp(T,_),_,T)}}class aY extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new $9(r),this.componentType=e}get injector(){return new Uo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const rg=new Map;class uY extends Ac{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new E2(this);const i=bo(e),r=function(n){return n[_x]||null}(e);r&&hT(r),this._bootstrapComponents=Qa(i.bootstrap),this._r3Injector=tw(e,t,[{provide:Ac,useValue:this},{provide:sl,useValue:this.componentFactoryResolver}],rt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Hn.THROW_IF_NOT_FOUND,i=bn.Default){return e===Hn||e===Ac||e===Nd?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class PT extends class{}{constructor(e){super(),this.moduleType=e,null!==bo(e)&&function(n){const e=new Set;!function t(i){const r=bo(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${rt(e)} vs ${rt(e.name)}`)}(s,rg.get(s),i),rg.set(s,i));const o=Qa(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new uY(this.moduleType,e)}}function Mw(n,e,t){const i=_s()+n,r=kt();return r[i]===xn?Ec(r,i,t?e.call(t):e()):function(n,e){return n[e]}(r,i)}function D2(n,e,t,i,r,s){const o=e+t;return ho(n,o,r)?Ec(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===xn?void 0:t}(n,o+1)}function Fd(n,e){const t=ui();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Qe("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=ac(i.type)),o=ca(De);try{const a=Jf(!1),l=s();return Jf(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,kt(),r,l),l}finally{ca(o)}}function Ld(n,e,t){const i=n+20,r=kt(),s=sd(r,i);return function(n,e){Nl.isWrapped(e)&&(e=Nl.unwrap(e),n[Pn.lFrame.bindingIndex]=xn);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?D2(r,_s(),e,s.transform,t,s):s.transform(t))}function FT(n){return e=>{setTimeout(n,void 0,e)}}const mn=class extends ee{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const f=e;a=null===(r=f.next)||void 0===r?void 0:r.bind(f),l=null===(s=f.error)||void 0===s?void 0:s.bind(f),c=null===(o=f.complete)||void 0===o?void 0:o.bind(f)}this.__isAsync&&(l=FT(l),a&&(a=FT(a)),c&&(c=FT(c)));const d=super.subscribe({next:a,error:l,complete:c});return e instanceof S&&e.add(d),d}};function xY(){return this._results[Pp()]()}class Qh{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Pp(),i=Qh.prototype;i[t]||(i[t]=xY)}get changes(){return this._changes||(this._changes=new mn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=Ho(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class LT{constructor(e){this.queryList=e,this.matches=null}clone(){return new LT(this.queryList)}setDirty(){this.queryList.setDirty()}}class kT{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new kT(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==k2(e,t).matches&&this.queries[t].setDirty()}}class N2{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class BT{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new BT(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class VT{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new VT(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,DY(t,s)),this.matchTNodeWithReadOption(e,t,dd(t,e,s,!1,!1))}else i===Io?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,dd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===wn||r===xs||r===Io&&4&t.type)this.addMatch(t.index,-2);else{const s=dd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function DY(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function IY(n,e,t,i){return-1===t?function(n,e){return 11&n.type?Qp(n,e):4&n.type?Cw(n,e):null}(e,n):-2===t?function(n,e,t){return t===wn?Qp(e,n):t===Io?Cw(e,n):t===xs?t2(e,n):void 0}(n,e,i):hd(n,n[1],t,e)}function P2(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:IY(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function jT(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=P2(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],d=e[-l];for(let f=10;f<d.length;f++){const p=d[f];p[17]===p[3]&&jT(p[1],p,c,i)}if(null!==d[9]){const f=d[9];for(let p=0;p<f.length;p++){const g=f[p];jT(g[1],g,c,i)}}}}}return i}function di(n){const e=kt(),t=ui(),i=yb();Fm(i+1);const r=k2(t,i);if(n.dirty&&Sl(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?jT(t,e,i,[]):P2(t,e,r,i);n.reset(s,GL),n.notifyOnChanges()}return!0}return!1}function Mr(n,e,t){const i=ui();i.firstCreatePass&&(function(n,e,t){null===n.queries&&(n.queries=new BT),n.queries.track(new VT(e,t))}(i,new N2(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function(n,e,t){const i=new Qh(4==(4&t));U0(n,e,i,i.destroy),null===e[19]&&(e[19]=new kT),e[19].queries.push(new LT(i))}(i,kt(),e)}function hi(){return function(n,e){return n[19].queries[e].queryList}(kt(),yb())}function k2(n,e){return n.queries.getByIndex(e)}const og=new zt("Application Initializer");let ag=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Ew,this.reject=Ew,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(oy(s))t.push(s);else if(hw(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Re(og,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const xy=new zt("AppId"),aK={provide:xy,useFactory:function(){return`${WT()}${WT()}${WT()}`},deps:[]};function WT(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const tk=new zt("Platform Initializer"),Tc=new zt("Platform ID"),Rw=new zt("appBootstrapListener");let Nw=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const Eu=new zt("LocaleId"),nk=new zt("DefaultCurrencyCode");class cK{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const qT=function(n){return new PT(n)},uK=qT,dK=function(n){return Promise.resolve(qT(n))},ik=function(n){const e=qT(n),i=Qa(bo(n).declarations).reduce((r,s)=>{const o=Ii(s);return o&&r.push(new C2(o)),r},[]);return new cK(e,i)},hK=ik,fK=function(n){return Promise.resolve(ik(n))};let Zh=(()=>{class n{constructor(){this.compileModuleSync=uK,this.compileModuleAsync=dK,this.compileModuleAndAllComponentsSync=hK,this.compileModuleAndAllComponentsAsync=fK}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const rk=new zt("compilerOptions"),gK=(()=>Promise.resolve(0))();function KT(n){"undefined"==typeof Zone?gK.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class _n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new mn(!1),this.onMicrotaskEmpty=new mn(!1),this.onStable=new mn(!1),this.onError=new mn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=Jn.requestAnimationFrame,e=Jn.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Jn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,QT(n),n.isCheckStableRunning=!0,XT(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),QT(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return sk(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),ok(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return sk(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),ok(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,QT(n),XT(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!_n.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(_n.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,_K,Ew,Ew);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const _K={};function XT(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function QT(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function sk(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function ok(n){n._nesting--,XT(n)}class bK{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new mn,this.onMicrotaskEmpty=new mn,this.onStable=new mn,this.onError=new mn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let ZT=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{_n.assertNotInAngularZone(),KT(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())KT(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Re(_n))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),ak=(()=>{class n{constructor(){this._applications=new Map,JT.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return JT.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class wK{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let JT=new wK,lk=!0,ck=!1;function Ea(){return ck=!0,lk}let Vl;const uk=new zt("AllowMultipleToken");function dk(n,e,t=[]){const i=`Platform: ${e}`,r=new zt(i);return(s=[])=>{let o=tD();if(!o||o.injector.get(uk,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:mu,useValue:"platform"});!function(n){if(Vl&&!Vl.destroyed&&!Vl.injector.get(uk,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Vl=n.get(hk);const e=n.get(tk,null);e&&e.forEach(t=>t())}(Hn.create({providers:a,name:i}))}return function(n){const e=tD();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function tD(){return Vl&&!Vl.destroyed?Vl:null}let hk=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new bK:("zone.js"===n?void 0:n)||new _n({enableLongStackTrace:Ea(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:_n,useValue:a}];return a.run(()=>{const c=Hn.create({providers:l,parent:this.injector,name:t.moduleType.name}),d=t.create(c),f=d.injector.get(Yo,null);if(!f)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const p=a.onError.subscribe({next:g=>{f.handleError(g)}});d.onDestroy(()=>{nD(this._modules,d),p.unsubscribe()})}),function(n,e,t){try{const i=t();return oy(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(f,a,()=>{const p=d.injector.get(ag);return p.runInitializers(),p.donePromise.then(()=>(hT(d.injector.get(Eu,_w)||_w),this._moduleDoBootstrap(d),d))})})}bootstrapModule(t,i=[]){const r=fk({},i);return function(n,e,t){const i=new PT(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(kd);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${rt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Re(Hn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();function fk(n,e){return Array.isArray(e)?e.reduce(fk,n):Object.assign(Object.assign({},n),e)}let kd=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new F(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new F(c=>{let d;this._zone.runOutsideAngular(()=>{d=this._zone.onStable.subscribe(()=>{_n.assertNotInAngularZone(),KT(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const f=this._zone.onUnstable.subscribe(()=>{_n.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{d.unsubscribe(),f.unsubscribe()}});this.isStable=Rn(a,l.pipe(fs()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof UL?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Ac),a=r.create(Hn.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(ZT,null),d=c&&a.injector.get(ak);return c&&d&&d.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),nD(this.components,a),d&&d.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;nD(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Rw,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Re(_n),Re(Hn),Re(Yo),Re(sl),Re(ag))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();function nD(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const YK=dk(null,"core",[{provide:Tc,useValue:"unknown"},{provide:hk,deps:[Hn]},{provide:ak,deps:[]},{provide:Nw,deps:[]}]),JK=[{provide:kd,useClass:kd,deps:[_n,Hn,Yo,sl,ag]},{provide:rY,deps:[_n],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:ag,useClass:ag,deps:[[new Wr,og]]},{provide:Zh,useClass:Zh,deps:[]},aK,{provide:Zp,useFactory:function(){return Z9},deps:[]},{provide:Jp,useFactory:function(){return J9},deps:[]},{provide:Eu,useFactory:function(n){return hT(n=n||"undefined"!=typeof $localize&&$localize.locale||_w),n},deps:[[new vd(Eu),new Wr,new Ka]]},{provide:nk,useValue:"USD"}];let tX=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Re(kd))},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({providers:JK}),n})(),$w=null;function Dc(){return $w}const un=new zt("DocumentToken");let tf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({factory:eQ,token:n,providedIn:"platform"}),n})();function eQ(){return Re(Uk)}let Uk=(()=>{class n extends tf{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Dc().getBaseHref(this._doc)}onPopState(t){const i=Dc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Dc().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){zk()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){zk()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Re(un))},n.\u0275prov=$e({factory:nQ,token:n,providedIn:"platform"}),n})();function zk(){return!!window.history.pushState}function nQ(){return new Uk(Re(un))}function Cu(n){return n&&"?"!==n[0]?"?"+n:n}let nf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({factory:iQ,token:n,providedIn:"root"}),n})();function iQ(n){const e=Re(un).location;return new Gk(Re(tf),e&&e.origin||"")}const yD=new zt("appBaseHref");let Gk=(()=>{class n extends nf{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return function(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Cu(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Cu(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Cu(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Re(tf),Re(yD,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();var ls=(()=>((ls=ls||{})[ls.Zero=0]="Zero",ls[ls.One=1]="One",ls[ls.Two=2]="Two",ls[ls.Few=3]="Few",ls[ls.Many=4]="Many",ls[ls.Other=5]="Other",ls))();const fQ=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=gL(e);if(t)return t;const i=e.split("-")[0];if(t=gL(i),t)return t;if("en"===i)return I7;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[sn.PluralCase]};class tE{}let zQ=(()=>{class n extends tE{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(fQ(i||this.locale)(t)){case ls.Zero:return"zero";case ls.One:return"one";case ls.Two:return"two";case ls.Few:return"few";case ls.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(Re(Eu))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class GQ{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Vd=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(i){throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=[];t.forEachOperation((r,s,o)=>{if(null==r.previousIndex){const a=this._viewContainer.createEmbeddedView(this._template,new GQ(null,this._ngForOf,-1,-1),null===o?void 0:o),l=new t3(r,a);i.push(l)}else if(null==o)this._viewContainer.remove(null===s?void 0:s);else if(null!==s){const a=this._viewContainer.get(s);this._viewContainer.move(a,o);const l=new t3(r,a);i.push(l)}});for(let r=0;r<i.length;r++)this._perViewChange(i[r].view,i[r].record);for(let r=0,s=this._viewContainer.length;r<s;r++){const o=this._viewContainer.get(r);o.context.index=r,o.context.count=s,o.context.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{this._viewContainer.get(r.currentIndex).context.$implicit=r.item})}_perViewChange(t,i){t.context.$implicit=i.item}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(De(xs),De(Io),De(Zp))},n.\u0275dir=Bt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();class t3{constructor(e,t){this.record=e,this.view=t}}class XQ{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class QQ{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const ZQ=new QQ,JQ=new XQ;let iE=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(oy(t))return ZQ;if(DF(t))return JQ;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${rt(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(De(as,16))},n.\u0275pipe=Ns({name:"async",type:n,pure:!1}),n})(),Yr=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({providers:[{provide:tE,useClass:zQ}]}),n})();const c3="browser";function rf(n){return n===c3}class OD extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){$w||($w=n)}(new OD)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(Ry=Ry||document.querySelector("base"),Ry?Ry.getAttribute("href"):null);return null==t?null:function(n){rE=rE||document.createElement("a"),rE.setAttribute("href",n);const e=rE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Ry=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let rE,Ry=null;const f3=new zt("TRANSITION_ID"),CZ=[{provide:og,useFactory:function(n,e,t){return()=>{t.get(ag).donePromise.then(()=>{const i=Dc(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[f3,un,Hn],multi:!0}];class RD{static init(){!function(n){JT=n}(new RD)}addToWindow(e){Jn.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Jn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Jn.getAllAngularRootElements=()=>e.getAllRootElements(),Jn.frameworkStabilizers||(Jn.frameworkStabilizers=[]),Jn.frameworkStabilizers.push(i=>{const r=Jn.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Dc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let xZ=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const Ny=new zt("EventManagerPlugins");let oE=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Re(Ny),Re(_n))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class ND{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Dc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let g3=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),Py=(()=>{class n extends g3{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(m3),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(m3))}}return n.\u0275fac=function(t){return new(t||n)(Re(un))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();function m3(n){Dc().remove(n)}const PD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},FD=/%COMP%/g;function aE(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?aE(n,r,t):(r=r.replace(FD,n),t.push(r))}return t}function v3(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let lE=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new LD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case $t.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new jZ(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case $t.ShadowDom:return new UZ(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=aE(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Re(oE),Re(Py),Re(xy))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class LD{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(PD[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=PD[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=PD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(To.DashCase|To.Important)?e.style.setProperty(t,i,r&To.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&To.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,v3(i)):this.eventManager.addEventListener(e,t,v3(i))}}class jZ extends LD{constructor(e,t,i,r){super(e),this.component=i;const s=aE(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(FD,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(FD,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class UZ extends LD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=aE(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let zZ=(()=>{class n extends ND{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Re(un))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const E3=["alt","control","meta","shift"],KZ={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},S3={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},XZ={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let QZ=(()=>{class n extends ND{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Dc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(E3.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&S3.hasOwnProperty(e)&&(e=S3[e]))}return KZ[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),E3.forEach(s=>{s!=r&&XZ[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(Re(un))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const sJ=dk(YK,"browser",[{provide:Tc,useValue:c3},{provide:tk,useValue:function(){OD.makeCurrent(),RD.init()},multi:!0},{provide:un,useFactory:function(){return function(n){Bi=n}(document),document},deps:[]}]),oJ=[[],{provide:mu,useValue:"root"},{provide:Yo,useFactory:function(){return new Yo},deps:[]},{provide:Ny,useClass:zZ,multi:!0,deps:[un,_n,Tc]},{provide:Ny,useClass:QZ,multi:!0,deps:[un]},[],{provide:lE,useClass:lE,deps:[oE,Py,xy]},{provide:Yh,useExisting:lE},{provide:g3,useExisting:Py},{provide:Py,useClass:Py,deps:[un]},{provide:ZT,useClass:ZT,deps:[_n]},{provide:oE,useClass:oE,deps:[Ny,_n]},{provide:class{},useClass:xZ,deps:[]},[]];let VD=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:xy,useValue:t.appId},{provide:f3,useExisting:xy},CZ]}}}return n.\u0275fac=function(t){return new(t||n)(Re(n,12))},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({providers:oJ,imports:[Yr,tX]}),n})();"undefined"!=typeof window&&window;class pJ extends S{constructor(e,t){super()}schedule(e,t=0){return this}}class cE extends pJ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let x3=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class Gl extends x3{constructor(e,t=x3.now){super(e,()=>Gl.delegate&&Gl.delegate!==this?Gl.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return Gl.delegate&&Gl.delegate!==this?Gl.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const _J=new class extends Gl{}(class extends cE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),Mc=new F(n=>n.complete());function uE(n){return n?function(n){return new F(e=>n.schedule(()=>e.complete()))}(n):Mc}function on(...n){let e=n[n.length-1];return Te(e)?(n.pop(),Be(n,e)):An(n)}function dg(n,e){return new F(e?t=>e.schedule(vJ,0,{error:n,subscriber:t}):t=>t.error(n))}function vJ({error:n,subscriber:e}){e.error(n)}class ta{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return on(this.value);case"E":return dg(this.error);case"C":return uE()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new ta("N",e):ta.undefinedValueNotification}static createError(e){return new ta("E",void 0,e)}static createComplete(){return ta.completeNotification}}ta.completeNotification=new ta("C"),ta.undefinedValueNotification=new ta("N",void 0);class dE extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(dE.dispatch,this.delay,new wJ(e,this.destination)))}_next(e){this.scheduleMessage(ta.createNext(e))}_error(e){this.scheduleMessage(ta.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(ta.createComplete()),this.unsubscribe()}}class wJ{constructor(e,t){this.notification=e,this.destination=t}}class hg extends ee{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new EJ(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new U;if(this.isStopped||this.hasError?o=S.EMPTY:(this.observers.push(e),o=new ie(this,e)),r&&e.add(e=new dE(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||_J).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class EJ{constructor(e,t){this.time=e,this.value=t}}function br(n,e){return"function"==typeof e?t=>t.pipe(br((i,r)=>Pe(n(i,r)).pipe(ve((s,o)=>e(i,s,r,o))))):t=>t.lift(new SJ(n))}class SJ{constructor(e){this.project=e}call(e,t){return t.subscribe(new CJ(e,this.project))}}class CJ extends pe{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new wt(this),r=this.destination;r.add(i),this.innerSubscription=O(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const hE={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return hE.schedule(n,0);if(void 0===window.requestAnimationFrame)return hE.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let UD;function PJ(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!UD){const t=Element.prototype;UD=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&UD.call(n,e)}(n,r)||(i=s,0))),i}class LJ{constructor(e,t){this.componentFactory=t.get(sl).resolveComponentFactory(e)}create(e){return new kJ(this.componentFactory,e)}}class kJ{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new hg(1),this.events=this.eventEmitters.pipe(br(i=>Rn(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(_n),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=hE.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=Hn.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=PJ(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(as),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(kd).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(ve(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=hE.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new zf(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class BJ extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}function Au(n,e,t,i){return Y(t)&&(i=t,t=void 0),i?Au(n,e,t).pipe(ve(r=>L(r)?i(...r):i(r))):new F(r=>{A3(n,e,function(o){r.next(arguments.length>1?Array.prototype.slice.call(arguments):o)},r,t)})}function A3(n,e,t,i,r){let s;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){const o=n;n.addEventListener(e,t,r),s=()=>o.removeEventListener(e,t,r)}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){const o=n;n.on(e,t),s=()=>o.off(e,t)}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){const o=n;n.addListener(e,t),s=()=>o.removeListener(e,t)}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(let o=0,a=n.length;o<a;o++)A3(n[o],e,t,i,r)}i.add(s)}function Sa(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function wr(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(d){try{c(i.next(d))}catch(f){o(f)}}function l(d){try{c(i.throw(d))}catch(f){o(f)}}function c(d){d.done?s(d.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(d.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}class Ir extends ee{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new U;return this._value}next(e){super.next(this._value=e)}}class O3 extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class $J extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function R3(n,e,t,i,r=new $J(n,t,i)){if(!r.closed)return e instanceof F?e.subscribe(r):Ie(e)(r)}function gE(...n){return It(1)(on(...n))}Object.create(Error.prototype);const F3=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function Ki(n){return e=>0===n?uE():e.lift(new YJ(n))}class YJ{constructor(e){if(this.total=e,this.total<0)throw new F3}call(e,t){return t.subscribe(new KJ(e,this.total))}}class KJ extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function Xi(n,e){return function(i){return i.lift(new ZJ(n,e))}}class ZJ{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new JJ(e,this.predicate,this.thisArg))}}class JJ extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function Oc(n){return function(t){const i=new eee(n),r=t.lift(i);return i.caught=r}}class eee{constructor(e){this.selector=e}call(e,t){return t.subscribe(new tee(e,this.selector,this.caught))}}class tee extends pe{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new wt(this);this.add(i);const r=O(t,i);r!==i&&this.add(r)}}}function _E(n=null){return e=>e.lift(new aee(n))}class aee{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new lee(e,this.defaultValue))}}class lee extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function zd(){}function ts(n,e,t){return function(r){return r.lift(new uee(n,e,t))}}class uee{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new dee(e,this.nextOrObserver,this.error,this.complete))}}class dee extends y{constructor(e,t,i,r){super(e),this._tapNext=zd,this._tapError=zd,this._tapComplete=zd,this._tapError=i||zd,this._tapComplete=r||zd,Y(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||zd,this._tapError=t.error||zd,this._tapComplete=t.complete||zd)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}class yne{constructor(e){this.total=e}call(e,t){return t.subscribe(new vne(e,this.total))}}class vne extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}let BB=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Bt({type:n,selectors:[["","gaEvent","","gaCategory",""],["","gaCategory",""]],inputs:{gaCategory:"gaCategory"},exportAs:["gaCategory"]}),n})();const Gy=new zt("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),VB=new zt("ngx-window",{providedIn:"root",factory:()=>function(n){return rf(n)?window:null}(gc(Tc))}),Ene=new zt("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(gc(VB))}),fM=new zt("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(gc(VB),gc(Ene))});let PE=(()=>{class n{constructor(t,i,r){this.settings=t,this._document=i,this._gtag=r}get document(){return this._document}throw(t){(this.settings.enableTracing||Ea())&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((i,[r,s])=>Object.defineProperty(i,r,{value:s,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(i=>void 0!==i))}catch(i){this.throw(i)}}event(t,i,r,s,o){try{const a=new Map;i&&a.set("event_category",i),r&&a.set("event_label",r),s&&a.set("value",s),void 0!==o&&a.set("interaction",o);const l=this.toKeyValue(a);l?this.gtag("event",t,l):this.gtag("event",t)}catch(a){this.throw(a)}}pageView(t,i,r,s){try{const o=new Map([["page_path",t]]);i&&o.set("page_title",i),(r||this.document)&&o.set("page_location",r||this.document.location.href),s&&Object.entries(s).map(([a,l])=>o.set(a,l)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(t,i,r,s,o){try{const a=new Map([["screen_name",t],["app_name",i]]);r&&a.set("app_id",r),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...t){try{this._gtag("set",...t)}catch(i){this.throw(i)}}exception(t,i){try{const r=new Map;t&&r.set("description",t),i&&r.set("fatal",i),this.toKeyValue(r)?this.gtag("event","exception",this.toKeyValue(r)):this.gtag("event","exception")}catch(r){this.throw(r)}}}return n.\u0275fac=function(t){return new(t||n)(Re(Gy),Re(un),Re(fM))},n.\u0275prov=$e({factory:function(){return new n(Re(Gy),Re(un),Re(fM))},token:n,providedIn:"root"}),n})(),jB=(()=>{class n{constructor(t,i,r,s){this.gaCategoryDirective=t,this.gaService=i,this.settings=r,this.el=s,this.gaBind="click"}set gaBind(t){this.bindSubscription&&this.bindSubscription.unsubscribe(),this._gaBind=t,this.bindSubscription=Au(this.el.nativeElement,t).subscribe(()=>this.trigger())}get gaBind(){return this._gaBind}ngOnDestroy(){this.bindSubscription&&this.bindSubscription.unsubscribe()}trigger(){try{if(!this.gaAction&&!this.gaEvent)throw new Error("You must provide a gaAction attribute to identify this event.");this.gaService.event(this.gaAction||this.gaEvent,this.gaCategoryDirective?this.gaCategoryDirective.gaCategory:void 0,this.gaLabel||this.label,this.gaValue,this.gaInteraction)}catch(t){this.throw(t)}}throw(t){(Ea()||this.settings.enableTracing)&&console&&console.warn&&console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)(De(BB,8),De(PE),De(Gy),De(wn))},n.\u0275dir=Bt({type:n,selectors:[["","gaEvent",""]],inputs:{gaBind:"gaBind",gaAction:"gaAction",gaLabel:"gaLabel",label:"label",gaValue:"gaValue",gaInteraction:"gaInteraction",gaEvent:"gaEvent"},exportAs:["gaEvent"]}),n})();const Cne={provide:og,multi:!0,useFactory:function(n,e,t){return()=>wr(this,void 0,void 0,function*(){var i;if(!n.trackingCode)return void(Ea()||console.error("Empty tracking code for Google Analytics. Make sure to provide one when initializing NgxGoogleAnalyticsModule."));if(!e)return void(Ea()||console.error("Was not possible create or read gtag() fn. Make sure this module is running on a Browser w/ access to Window interface."));t||Ea()||console.error("Was not possible to access Document interface. Make sure this module is running on a Browser w/ access do Document interface."),n.uri=n.uri||`https://www.googletagmanager.com/gtag/js?id=${n.trackingCode}`,n.initCommands=null!==(i=null==n?void 0:n.initCommands)&&void 0!==i?i:[],n.initCommands.find(o=>"config"===o.command)||n.initCommands.unshift({command:"config",values:[n.trackingCode]}),n.initCommands.find(o=>"js"===o.command)||n.initCommands.unshift({command:"js",values:[new Date]});for(const o of n.initCommands)e(o.command,...o.values);const r=t.createElement("script");r.async=!0,r.src=n.uri,n.nonce&&r.setAttribute("nonce",n.nonce),t.getElementsByTagName("head")[0].appendChild(r)})},deps:[Gy,fM,un]};new zt("ngx-google-analytics-routing-settings",{factory:()=>({})});let FE=(()=>{class n{static forRoot(t,i=[],r,s,o){return{ngModule:n,providers:[{provide:Gy,useValue:{trackingCode:t,initCommands:i,uri:r,enableTracing:s,nonce:o}},Cne]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[]]}),n})();function Dne(n){return Object.entries(n).reduce((e,[t,i])=>(null!=i&&(e[t]=`${i}`),e),{})}let Ine=(()=>{class n{static forRoot(t){const{providers:i=[]}=FE.forRoot(t.gaToken,function(n){const{appName:e,projectName:t,developmentMode:i}=n;return[{command:"set",values:[Dne({appName:e,projectName:t,developmentMode:i})]}]}(t));return{ngModule:n,providers:i}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[FE]]}),n})();const vg={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],organNodes:["http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0002049"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org",hubmapToken:localStorage.getItem("HUBMAP_TOKEN")||""},googleAnalyticsToken:"G-ERNVZ1Q4KE"};function Mu(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(d){let f;s++,!r||a?(a=!1,r=new hg(n,e,i),f=r.subscribe(this),o=d.subscribe({next(p){r.next(p)},error(p){a=!0,r.error(p)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):f=r.subscribe(this),this.add(()=>{s--,f.unsubscribe(),f=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}function $y(...n){return e=>{let t;return"function"==typeof n[n.length-1]&&(t=n.pop()),e.lift(new Rne(n,t))}}class Rne{constructor(e,t){this.observables=e,this.project=t}call(e,t){return t.subscribe(new Nne(e,this.observables,this.project))}}class Nne extends O3{constructor(e,t,i){super(e),this.observables=t,this.project=i,this.toRespond=[];const r=t.length;this.values=new Array(r);for(let s=0;s<r;s++)this.toRespond.push(s);for(let s=0;s<r;s++)this.add(R3(this,t[s],void 0,s))}notifyNext(e,t,i){this.values[i]=t;const r=this.toRespond;if(r.length>0){const s=r.indexOf(i);-1!==s&&r.splice(s,1)}}notifyComplete(){}_next(e){if(0===this.toRespond.length){const t=[e,...this.values];this.project?this._tryProject(t):this.destination.next(t)}}_tryProject(e){let t;try{t=this.project.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function HB(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function pM(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||HB()}const GB="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",LE=pM();class Fne{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function gM(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const $B={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function WB(n){return"string"==typeof n?$B[n.toUpperCase()]||$B.WHITE:n}function kE(n,e){if(!n)throw new Error(e||"Assertion failed")}const Wl={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},Wy=Wl.window||Wl.self||Wl.global,qB=Wl.process||{};function bg(){let n;if(LE&&Wy.performance)n=Wy.performance.now();else if(qB.hrtime){const e=qB.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const wg={debug:LE&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},zne={enabled:!0,level:0};function dl(){}const YB={},KB={once:!0};function Hne(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let mM=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=GB,this._startTs=bg(),this._deltaTs=bg(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Fne("__probe-".concat(this.id,"__"),zne),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((bg()-this._startTs).toPrecision(10))}getDelta(){return Number((bg()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){kE(t,i)}warn(t){return this._getLogFunction(0,t,wg.warn,arguments,KB)}error(t){return this._getLogFunction(0,t,wg.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,wg.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,wg.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,wg.debug||wg.info,arguments,KB)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||dl,r&&[r],{tag:Hne(i)}):dl}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?LE?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=gM(r,e,t);console.log(...s)},r.src=n,dl}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...gM(n,e,t)),dl;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...gM(r,e,t)),r.src=n.toDataURL(),dl}return dl}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=tt(307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):dl}({image:r,message:s,scale:o}):dl}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||dl)}group(t,i,r={collapsed:!1}){r=QB({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||dl)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=XB(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=QB({logLevel:t,message:i,args:s,opts:o}),kE(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=bg();const a=o.tag||o.message;if(o.once){if(YB[a])return dl;YB[a]=bg()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!LE&&"string"==typeof n&&(e&&(e=WB(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=WB(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return dl}}return n.VERSION=GB,n})();function XB(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return kE(Number.isFinite(e)&&e>=0),e}function QB(n){const{logLevel:e,message:t}=n;n.logLevel=XB(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return kE("string"===r||"object"===r),Object.assign(n,n.opts)}const Ni=new mM({id:"deck"}),Mi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Mi,"IDENTITY",{get:()=>Ni.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const Pc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},ZB={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},dn=new mM({id:"luma.gl"});function Po(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function BE(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function fi(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function VE(n){return Po(BE(n),"Invalid WebGLRenderingContext"),n}function Fo(n){return Po(fi(n),"Requires WebGL2"),n}var Er=tt(761);const qy={};const Yy=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(Yy.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const df=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(qy[i]=!0)}while(0!==i);for(i in qy)if(qy[i])return delete qy[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,d){const f=t.currentVertexArrayObject;f.maxAttrib=Math.max(f.maxAttrib,s);const p=f.attribs[s];return p.buffer=t.currentArrayBuffer,p.size=o,p.type=a,p.normalized=l,p.stride=c,p.offset=d,p.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{Er.CO.console&&Er.CO.console.log&&Er.CO.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};df.prototype.VERTEX_ARRAY_BINDING_OES=34229,df.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new Yy(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},df.prototype.createVertexArrayOES=function(){const e=new Yy(this);return this.vertexArrayObjects.push(e),e},df.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},df.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Yy&&e.hasBeenBound&&e.ext===this)},df.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){qy[n]=!0,void 0!==e&&function(n){Er.CO.console&&Er.CO.console.error&&Er.CO.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],d=r?r.attribs[l]:null;if((!r||c.enabled!==d.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let f=!1;(!r||c.buffer!==d.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),f=!0),(f||c.cached!==d.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const JB="OES_element_index",eV="WEBGL_draw_buffers",tV="WEBGL_debug_renderer_info",lr=n=>fi(n)?void 0:0,uie={3074:n=>fi(n)?void 0:36064,35723:n=>fi(n)?void 0:4352,35977:lr,32937:lr,36795:(n,e)=>{const t=fi(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(tV);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(tV);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:lr,35071:lr,37447:lr,36063:(n,e)=>{if(!fi(n)){const t=n.getExtension(eV);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:lr,35374:lr,35377:lr,34852:n=>{if(!fi(n)){const e=n.getExtension(eV);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(JB)?2147483647:65535,33001:n=>n.getExtension(JB)?16777216:65535,33e3:n=>16777216,37157:lr,35373:lr,35657:lr,36183:lr,37137:lr,34045:lr,35978:lr,35979:lr,35968:lr,35376:lr,35375:lr,35659:lr,37154:lr,35371:lr,35658:lr,35076:lr,35077:lr,35380:lr},nV="ANGLE_instanced_arrays",iV={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Po(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[nV]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){Po(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Po(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Po(!1)},deleteQuery:()=>{Po(!1)},beginQuery:()=>{Po(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},_M={readBuffer:(n,e,t)=>{fi(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:fi(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!fi(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!fi(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=uie[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function Sie(n,{extension:e,target:t,target2:i}){const r=iV[e];Po(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let d=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?d=(...f)=>a[c](...f):"function"==typeof r[l]&&(d=r[l].bind(t))),d&&(t[l]=d,i[l]=d)}}("undefined"!=typeof global?global:window).polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new df(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&Sie(n,{extension:t,target:n.luma,target2:n})}(n,iV),function(n,{target:e,target2:t}){Object.keys(_M).forEach(i=>{if("function"==typeof _M[i]){const r=n[i]?n[i].bind(n):()=>{},s=_M[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const yM={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Gd=(n,e,t)=>e?n.enable(t):n.disable(t),rV=(n,e,t)=>n.hint(t,e),Ca=(n,e,t)=>n.pixelStorei(t,e);function Ky(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const Aie={3042:Gd,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:Gd,2885:(n,e)=>n.cullFace(e),2929:Gd,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:Gd,35723:rV,36006:(n,e)=>{const t=fi(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:rV,2849:(n,e)=>n.lineWidth(e),32823:Gd,32824:"polygonOffset",10752:"polygonOffset",35977:Gd,32938:"sampleCoverage",32939:"sampleCoverage",3089:Gd,3088:(n,e)=>n.scissor(...e),2960:Gd,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Ca,3317:Ca,37440:Ca,37441:Ca,37443:Ca,3330:Ca,3332:Ca,3331:Ca,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Ca,32878:Ca,3316:Ca,3315:Ca,32877:Ca,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=Ky(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=Ky(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=Ky(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=Ky(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=Ky(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function Kr(n,e,t){return void 0!==e[n]?e[n]:t[n]}const Tie={blendEquation:(n,e,t)=>n.blendEquationSeparate(Kr(32777,e,t),Kr(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(Kr(32969,e,t),Kr(32968,e,t),Kr(32971,e,t),Kr(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(Kr(32824,e,t),Kr(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(Kr(32938,e,t),Kr(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,Kr(2962,e,t),Kr(2967,e,t),Kr(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,Kr(34816,e,t),Kr(36003,e,t),Kr(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,Kr(2964,e,t),Kr(2965,e,t),Kr(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,Kr(34817,e,t),Kr(34818,e,t),Kr(34819,e,t))},sV={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Fc=(n,e)=>n.isEnabled(e),oV={3042:Fc,2884:Fc,2929:Fc,3024:Fc,32823:Fc,32926:Fc,32928:Fc,3089:Fc,2960:Fc,35977:Fc};function aV(n){for(const e in n)return!1;return!0}function Die(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function lV(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache||(n.state.cache[s]=t(...r)),n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function Mie(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class Oie{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||yM)){const r=e,s=oV[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=oV[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},yM),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Po(this.stateStack.length>0),Iu(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Po(void 0!==s);const o=e[s],a=this.cache[s];Die(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function cV(n,e={}){const{enable:t=!0,copyState:i}=e;if(Po(void 0!==i),!n.state){const r="undefined"!=typeof global?global:window,{polyfillContext:s}=r;s&&s(n),n.state=new Oie(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const o in sV)Mie(n,o,sV[o]);lV(n,"getParameter"),lV(n,"isEnabled")}return n.state.enable=t,n}function uV(n){Po(n.state),n.state.pop()}function Iu(n,e){if(Po(BE(n),"setParameters requires a WebGL context"),aV(e))return;const t={};for(const r in e){const s=Number(r),o=Aie[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)Tie[r](n,e,i)}function ql(n,e,t){if(aV(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||cV(n,{copyState:!1}),n.state.push()}(n),Iu(n,e),i)r=t(n),uV(n);else try{r=t(n)}finally{uV(n)}return r}function Eg(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function vM(n,e,t=!0){return function(n,e,t,i,r){const s=dV(n[0],e,t);let o=hV(n[1],e,i,r),a=dV(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=hV(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,Eg(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function dV(n,e,t){return Math.min(Math.round(n*e),t-1)}function hV(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const bM=(0,Er.jU)(),kie=bM&&"undefined"!=typeof document,fV={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function pV(n={}){Po(bM,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},fV,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(kie&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=wM(r,n),function(n){const e=fi(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);dn.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function wM(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},fV,e);const{manageState:t,debug:i}=e;return t&&cV(n,{copyState:!1,log:(...r)=>dn.log(1,...r)()}),bM&&i&&(Er.CO.makeDebugContext?(n=Er.CO.makeDebugContext(n,e),dn.level=Math.max(dn.level,1)):dn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function gV(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class mV{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=gV(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(gV()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class EM{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof mV?e:new mV(t,i)),this.stats[t]}}const Xy="8.5.7",hf=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new EM({id:e})),this.stats.get(e)}};if(Er.CO.luma&&Er.CO.luma.VERSION!==Xy)throw new Error(`luma.gl - multiple VERSIONs detected: ${Er.CO.luma.VERSION} vs 8.5.7`);function nn(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function SM(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return nn(void 0!==i,`Accessing undefined constant GL.${e}`),i}function $d(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}Er.CO.luma||((0,Er.jU)()&&dn.log(1,"luma.gl 8.5.7 - set luma.log.level=1 (or higher) to trace rendering")(),Er.CO.luma=Er.CO.luma||{VERSION:Xy,version:Xy,log:dn,stats:hf,globals:{modules:{},nodeIO:{}}});const CM={};function Lc(n="id"){return CM[n]=CM[n]||1,`${n}-${CM[n]++}`}function _V(n){return nn("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function Sg(n){let e=!0;for(const t in n){e=!1;break}return e}function yV(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw dn.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const Cg="Resource subclass must define virtual methods";class Ou{constructor(e,t={}){VE(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||Lc(this.constructor.name),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){nn(e=SM(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=fi(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=fi(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const f=i?$d(this.gl,l):l;o[f]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[f]=$d(this.gl,o[f]))}}return o}setParameter(e,t){nn(e=SM(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=fi(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=SM(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return yV(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Cg)}_deleteHandle(){throw new Error(Cg)}_bindHandle(e){throw new Error(Cg)}_getOptsFromHandle(){throw new Error(Cg)}_getParameter(e,t){throw new Error(Cg)}_setParameter(e,t){throw new Error(Cg)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,t=hf.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this.constructor.name;hf.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this.constructor.name){const i=hf.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this.constructor.name){const t=hf.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function xM(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Qy(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Kie({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function AM(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&dn.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&dn.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];dn.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const Xie={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Qie={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ia{static getBytesPerElement(e){return Qy(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return nn(e.size),Qy(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new ia(...[Xie,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ia.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ia.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=AM("Accessor",e,Qie)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const bV={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Zie={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:bV},Jie={removedProps:bV};class tr extends Ou{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/ia.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/ia.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=AM("Buffer",e,Zie),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=AM("Buffer",e,Jie))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new ia(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;nn(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(Fo(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return Fo(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){Fo(this.gl);const s=Qy(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const d=Math.min(o,l);return nn((r=r||d)<=d),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(nn(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){nn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=xM(e);return nn(s),this.setAccessor(new ia(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){nn(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/Qy(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new ia(this.accessor,{type:xM(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return dn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return dn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return dn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return dn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ia(this.accessor,e),this}}const TM={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},wV={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},EV={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},nre=[9729,9728],SV=Er.CO.WebGLBuffer||function(){};class xg extends Ou{static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=TM[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=fi(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=TM[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=Lc("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(G=>this.initialize(Object.assign({},e,{pixels:G,data:G}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:d}=e;t||(t=r);let{width:f,height:p,dataFormat:g,type:_,compressed:x=!1,mipmaps:T=!0}=e;const{depth:q=0}=e;return({width:f,height:p,compressed:x,dataFormat:g,type:_}=this._deduceParameters({format:s,type:_,dataFormat:g,compressed:x,data:t,width:f,height:p})),this.width=f,this.height=p,this.depth=q,this.format=s,this.type=_,this.dataFormat=g,this.border=o,this.textureUnit=d,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),T&&this._isNPOT()&&(dn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),T=!1,this._updateForNPOT(l)),this.mipmaps=T,this.setImageData({data:t,width:f,height:p,depth:q,format:s,type:_,dataFormat:g,border:o,mipmaps:T,parameters:c,compressed:x}),T&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(dn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),ql(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:d=this.type,width:f=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:_=!1}=e;c||(c=i),({type:d,dataFormat:g,compressed:_,width:f,height:p}=this._deduceParameters({format:s,type:d,dataFormat:g,compressed:_,data:c,width:f,height:p}));const{gl:x}=this;x.bindTexture(this.target,this.handle);let q,T=null;return({data:c,dataType:T}=this._getDataType({data:c,compressed:_})),ql(this.gl,l,()=>{switch(T){case"null":x.texImage2D(t,r,s,f,p,o,g,d,c);break;case"typed-array":x.texImage2D(t,r,s,f,p,o,g,d,c,a);break;case"buffer":q=Fo(x),q.bindBuffer(35052,c.handle||c),q.texImage2D(t,r,s,f,p,o,g,d,a),q.bindBuffer(35052,null);break;case"browser-object":fi(x)?x.texImage2D(t,r,s,f,p,o,g,d,c):x.texImage2D(t,r,s,g,d,c);break;case"compressed":for(const[G,ge]of c.entries())x.compressedTexImage2D(t,G,ge.format,ge.width,ge.height,o,ge.data);break;default:nn(!1,"Unknown image data type")}}),this._trackAllocatedMemory(c&&c.byteLength?c.byteLength:this.width*this.height*(wV[this.dataFormat]||4)*(EV[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:d=this.type,dataFormat:f=this.dataFormat,compressed:p=!1,offset:g=0,border:_=this.border,parameters:x={}}){if(({type:d,dataFormat:f,compressed:p,width:o,height:a}=this._deduceParameters({format:c,type:d,dataFormat:f,compressed:p,data:i,width:o,height:a})),nn(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const T=i;i=T.data,o=T.shape[0],a=T.shape[1]}i instanceof tr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),ql(this.gl,x,()=>{if(p)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,f,d,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,f,d,i,g);else if(i instanceof SV){const T=Fo(this.gl);T.bindBuffer(35052,i),T.texSubImage2D(e,l,r,s,o,a,f,d,g),T.bindBuffer(35052,null)}else fi(this.gl)?Fo(this.gl).texSubImage2D(e,l,r,s,o,a,f,d,i):this.gl.texSubImage2D(e,l,r,s,f,d,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return dn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof tr?{data:e.handle,dataType:"buffer"}:e instanceof SV?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=TM[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},nn(r,"Could not deduced texture size"),nn(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),nn(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:nn(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(fi(this.gl)||!this.width||!this.height||_V(this.width)&&_V(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===nre.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function ire(n,e){return nn("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class xa extends xg{static isSupported(e,t){return xg.isSupported(e,t)}constructor(e,t={}){VE(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:ire(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const ff="EXT_color_buffer_float",CV={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:ff,bpp:2},33327:{gl2:ff,bpp:4},34842:{gl2:ff,bpp:8},33326:{gl2:ff,bpp:4},33328:{gl2:ff,bpp:8},34836:{gl2:ff,bpp:16},35898:{gl2:ff,bpp:4}};class Ag extends Ou{static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=fi(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,CV)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return nn(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&fi(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*CV[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const MV="clear: bad arguments";function MM(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),nn(0!==o,MV),ql(n,s,()=>{n.clear(o)})}function IV(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function ei(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){IV(s,i,r,o,a,"next",l)}function a(l){IV(s,i,r,o,a,"throw",l)}o(void 0)})}}const IM=[34069,34070,34071,34072,34073,34074];let ure=(()=>{class n extends xg{constructor(t,i={}){VE(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return ei(function*(){const{gl:d}=c,f=r||s,p=yield Promise.all(IM.map(g=>{const _=f[g];return Promise.all(Array.isArray(_)?_:[_])}));c.bind(),IM.forEach((g,_)=>{p[_].length>1&&!1!==c.opts.mipmaps&&dn.warn(`${c.id} has mipmap and multiple LODs.`)(),p[_].forEach((x,T)=>{t&&i?d.texImage2D(g,T,a,t,i,o,a,l,x):d.texImage2D(g,T,a,a,l,x)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:d=5121}=t,{gl:f}=this,p=o||a;return this.bind(),p instanceof Promise?p.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?f.texImage2D(i,0,c,r,s,l,c,d,p):f.texImage2D(i,0,c,c,d,p),this}}return n.FACES=IM,n})();class dre extends xg{static isSupported(e){return fi(e)}constructor(e,t={}){Fo(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:d,parameters:f={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),ql(this.gl,f,()=>{ArrayBuffer.isView(d)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,d),d instanceof tr&&(this.gl.bindBuffer(35052,d.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(d&&d.byteLength?d.byteLength:this.width*this.height*this.depth*(wV[this.dataFormat]||4)*(EV[this.type]||1),"Texture"),this.loaded=!0,this}}function fre(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Ts(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function jE(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:d,deleteFramebuffer:f}=function(n){return n instanceof Ts?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:fre(n),deleteFramebuffer:!0}}(n);nn(d);const{gl:p,handle:g,attachments:_}=d;a=a||d.width,l=l||d.height,36064===s&&null===g&&(s=1028),nn(_[s]),c=c||_[s].type,o=function(n,e,t,i,r){if(n)return n;return new(Qy(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return nn(!1),0}}(t))}(o,c,r,a,l),c=c||xM(o);const x=p.bindFramebuffer(36160,g);return p.readPixels(t,i,a,l,r,c,o),p.bindFramebuffer(36160,x||null),f&&d.delete(),o}function OM(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=jE(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=Kie({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}const OV="Multiple render targets not supported";class Ts extends Ou{static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Ts(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Fo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Fo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(nn(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const d in i){const f=i[d];(Array.isArray(f)?f[0]:f).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return nn(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&dn.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){nn(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof Ag)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[d,f=0,p=0]=l;c=d,this._attachTexture({attachment:a,texture:d,layer:f,level:p})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(Ts.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&MM(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){Fo(n),ql(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:nn(!1,MV)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return dn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return dn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return dn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return dn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return dn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return dn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=Fo(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=$d(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?$d(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?$d(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(OM(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>dn.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=OM(this,{targetMaxHeight:100});return dn.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new xa(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new Ag(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new Ag(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&nn(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof Ag?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:Fo(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:nn(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return fi(n)?n:null}(this.gl);t?t.readBuffer(e):nn(36064===e||1029===e,OV),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=Fo(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):nn(1===e.length&&(36064===e[0]||1029===e[0]),OV)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in RV)void 0===n.luma.caps[e]&&(n.luma.caps[e]=PV(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Ts.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const RV={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new xa(n,{format:6408,type:5126,dataFormat:6408}),t=new Ts(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function RM(n,e){return NV(n,e)}function NV(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>PV(n,t))}function PV(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=RV[e];let i;nn(t,e);const r=fi(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:nn(!1);return i}(n,e)),n.luma.caps[e]||dn.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class NM{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return ht(ht({},this.source.getAccessor()),this.opts)}}const Jy=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,d=t*i+s;if(ArrayBuffer.isView(e)){if(d<=e.length)return e;if(d*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,d)}let f;l&&(f=l*i+s);const p=this._allocate(c,d,a,f);return e&&o?p.set(e):a||p.fill(0,0,4),this._release(e),p}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},xre=(Math,1/180*Math.PI),Sr={};function Tre(n,{precision:e=Sr.precision||4}={}){return n=function(n){return Math.round(n/Sr.EPSILON)*Sr.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function Wd(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Ru(n,e,t){if(Wd(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function FV(n){return function(n,e){return Ru(n,t=>t*xre,void 0)}(n)}function pf(n,e,t){return Ru(n,i=>Math.max(e,Math.min(t,i)))}function UE(n,e,t){return Wd(n)?n.map((i,r)=>UE(i,e[r],t)):t*e+(1-t)*n}function ev(n,e,t){const i=Sr.EPSILON;t&&(Sr.EPSILON=t);try{if(n===e)return!0;if(Wd(n)&&Wd(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!ev(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Sr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Sr.EPSILON=i}}function Nu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}Sr.EPSILON=1e-12,Sr.debug=!1,Sr.precision=4,Sr.printTypes=!1,Sr.printDegrees=!1,Sr.printRowMajor=!0;class PM extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return Nu(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:Wd(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Sr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+Tre(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!ev(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Sr.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function Zs(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function zE(n,e,t=""){if(Sr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const LV={};function FM(n,e){LV[n]||(LV[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class Pre extends PM{get ELEMENTS(){return Nu(!1),0}copy(e){return Nu(!1),this}get x(){return this[0]}set x(e){this[0]=Zs(e)}get y(){return this[1]}set y(e){this[1]=Zs(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return Zs(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return Zs(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Nu(e>=0&&e<this.ELEMENTS,"index is out of range"),Zs(this[e])}setComponent(e,t){return Nu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var ur=1e-6,ra="undefined"!=typeof Float32Array?Float32Array:Array;function kV(){var n=new ra(3);return ra!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function BV(n,e,t){var i=new ra(3);return i[0]=n,i[1]=e,i[2]=t,i}function VV(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function HE(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function jV(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function UV(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}kV();const LM=[0,0,0],zV={};class mo extends Pre{static get ZERO(){return zV.ZERO=zV.ZERO||Object.freeze(new mo(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&Wd(e)?this.copy(e):(Sr.debug&&(Zs(e),Zs(t),Zs(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Sr.debug&&(Zs(e.x),Zs(e.y),Zs(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Zs(e)}angle(e){return function(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],d=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),f=d&&VV(n,e)/d;return Math.acos(Math.min(Math.max(f,-1),1))}(this,e)}cross(e){return HE(this,this,e),this.check()}rotateX({radians:e,origin:t=LM}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=LM}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=LM}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return jV(this,this,e),this.check()}transformAsVector(e){return UV(this,this,e),this.check()}transformByMatrix3(e){return function(n,e,t){var i=e[0],r=e[1],s=e[2];n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8]}(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],d=r*c-s*l,f=s*a-i*c,p=i*l-r*a,g=r*p-s*f,_=s*d-i*p,x=i*f-r*d,T=2*t[3];f*=T,p*=T,_*=2,x*=2,n[0]=a+(d*=T)+(g*=2),n[1]=l+f+_,n[2]=c+p+x}(this,this,e),this.check()}}const HV=new mo;function Tg(n,e,t,i){HV.set(n,e,t);const r=HV.len();return{distance:i/r,normal:new mo(-n/r,-e/r,-t/r)}}function nse(n){return n-Math.fround(n)}let nv;function kM(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;nv=Jy.allocate(nv,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];nv[o+a]=l,nv[o+a+e]=nse(l)}o+=2*e}return nv.subarray(0,r*e*2)}function GE(n){return n.stride||n.size*n.bytesPerElement}function GV(n,e){e.offset&&Ni.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=GE(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return jn(ht({},e),{offset:s,stride:t})}function Yl(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const $V=[],WV=[];function qV(n,e=0,t=1/0){let i=$V;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(WV.length=n.length,i=WV):i=$V,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function YV(n){return n&&n[Symbol.asyncIterator]}function BM(n,e=(()=>!0)){return Array.isArray(n)?KV(n,e,[]):e(n)?[n]:[]}function KV(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?KV(r,e,t):e(r)&&t.push(r)}return t}function ose({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const ase=[],$E=[[0,1/0]];function VM({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let d=0;d<r;d++)e[t+l]=c[d]||0,l++}}const use={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function XV(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",ht(ht(ht({},use[n.type]),e),n)):null}function QV(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function ZV(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function JV(n){n.push(n.shift())}function jM(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function ej({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,d=r&&c,f=jM(t,e),p=t.state.constant;if(!d&&i>=f)return;const g=p?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!p){const q=s;s=(G,ge)=>t._normalizeConstant(q(G,ge))}const _=p?(q,G)=>s(g,G):(q,G)=>s(g.subarray(q,q+a),G),x=n.getData({length:i}),T=new Float32Array(f);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return VM({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((d,f)=>i(d+a,f)),c=Math.min(r.length,s.length);for(let d=1;d<c;d++){const f=r[d]*t,p=s[d]*t;VM({source:n.subarray(o,f),target:e,start:a,end:p,size:t,getData:l}),o=f,a=p}a<e.length&&VM({source:[],target:e,start:a,size:t,getData:l})})({source:x,target:T,sourceStartIndices:r,targetStartIndices:c,size:a,getData:_}),n.byteLength<T.byteLength+l&&n.reallocate(T.byteLength+l),n.subData({data:T,offset:l})}class UM extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&RM(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new tr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*GE(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Jy.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=GV(n,e);return{high:t,low:jn(ht({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new NM(this,s.high),i["".concat(e,"64Low")]=r?new NM(this,s.low):new Float32Array(this.size),i}if(t){const i=GV(this.getAccessor(),t);return{[e]:new NM(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof tr&&(e={buffer:e});const i=ht(ht({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=GE(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=GE(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=kM(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?kM(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=Jy.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?kM(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Ni.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:$E,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return XV(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===$E||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=$E}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=ase}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==$E}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,d]of s)o.call(r,this,{data:t,startRow:c,endRow:d,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,d]of s){const f=Number.isFinite(c)?this.getVertexOffset(c):0,p=Number.isFinite(d)?this.getVertexOffset(d):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:p})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(Yl(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(d,{index:f,target:p})=>{if(!r){const T=f*a+l;for(let q=0;q<e;q++)p[q]=n[T+q];return p}const g=r[f],_=r[f+1]||c;let x;if(s){x=new Array(_-g);for(let T=g;T<_;T++){const q=T*a+l;p=new Array(e);for(let G=0;G<e;G++)p[G]=n[q+G];x[T-g]=p}}else if(a===e)x=n.subarray(g*e+l,_*e+l);else{x=new n.constructor((_-g)*e);let T=0;for(let q=g;q<_;q++){const G=q*a+l;for(let ge=0;ge<e;ge++)x[T++]=n[G+ge]}}return x}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:d,startIndices:f}=e,{accessor:p,transform:g}=a,_=l.binaryAccessor||("function"==typeof p?p:s[p]);Yl("function"==typeof _,'accessor "'.concat(p,'" is not a function'));let x=e.getVertexOffset(i);const{iterable:T,objectInfo:q}=qV(t,i,r);for(const G of T){q.index++;let ge=_(G,q);if(g&&(ge=g.call(this,ge)),f){const Ne=(q.index<f.length-1?f[q.index+1]:o)-f[q.index];if(ge&&Array.isArray(ge[0])){let Ge=x;for(const We of ge)e._normalizeValue(We,c,Ge),Ge+=d}else ge&&ge.length>d?c.set(ge,x):(e._normalizeValue(ge,q.target,0),ose({target:c,source:q.target,start:x,count:Ne}));x+=Ne*d}else e._normalizeValue(ge,c,x),x+=d}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let zM={};function _o(n){Ni.level>0&&zM[n]&&zM[n].call(...arguments)}function Aa(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const tj="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",fse=`#version 300 es\n${tj}`;function nj(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function ij(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?fse:e>300?`#version ${e}\n${tj}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return Aa(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class rj extends Ou{static isSupported(e){return fi(e)}constructor(e,t={}){Fo(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Sg(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,dn.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof tr?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class _se{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof tr?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&nn(fi(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new rj(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],nn(i[s]instanceof tr)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new tr(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function sj(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const iv="vs",bse={[iv]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},WE="__LUMA_INJECT_DECLARATIONS__",oj=/void\s+main\s*\([^)]*\)\s*\{\n?/,aj=/}\n?[^{}]*$/,GM=[];function lj(n,e,t,i=!1){const r=e===iv;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),GM.length=o.length;for(let l=0,c=o.length;l<c;++l)GM[l]=o[l].injection;const a=`${GM.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(WE,a));break;case"vs:#main-start":r&&(n=n.replace(oj,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(aj,l=>a+l));break;case"fs:#decl":r||(n=n.replace(WE,a));break;case"fs:#main-start":r||(n=n.replace(oj,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(aj,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(WE,""),i&&(n=n.replace(/\}\s*$/,s=>s+bse[e])),n}function $M(n){const e={};return Aa(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const wse={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},qE="transform_uSize_",cj="transform_position";const Mse={10241:9728,10240:9728,10242:33071,10243:33071};class Ose{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const f in this.samplerTextureMap)a[f]=i[this.samplerTextureMap[f]];this._setSourceTextureParameters();const d=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${qE}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${qE}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,d)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=jE(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Aa(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof xa)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new tr(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Ts(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(Mse)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function(n,e){nn(n instanceof xa||n instanceof ure||n instanceof dre);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:d}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:d},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(e);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const d=l.split("\n"),f=d.slice();if(d.forEach((p,g,_)=>{if(s>0){const x=function(n,e){const t={},i=function(n){return nj(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${qE}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),f=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Aa(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":f},samplerTextureMap:t}}return null}(p,e);if(x){const{updatedLine:T,inject:q}=x;f[g]=T,c=$M([c,q]),Object.assign(a,x.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=nj(n,["varying","out"]);return t&&t.name===e?t.type:null}(p,t))}),t){nn(i);const p=`${qE}${t}`;c=$M([c,{"vs:#decl":`uniform vec2 ${p};\n`,"vs:#main-start":`     vec2 ${cj} = transform_getPos(${p});\n     gl_Position = vec4(${cj}, 0, 1.);\n`}])}l=f.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=$M([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||ij({version:sj(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[wse].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const WM={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function Nse(n){let e=uj(n);return"object"===e?n?"type"in n?Object.assign({},n,WM[n.type]):"value"in n?(e=uj(n.value),Object.assign({type:e},n,WM[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},WM[e])}function uj(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class qM{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:d,fragmentShader:f}){Aa("string"==typeof e),this.name=e,this.vs=t||d,this.fs=i||f,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=Nse(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Aa(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Aa(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function kse(n){return function(n){const e={},t={};return YM({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(hj(n))}function YM({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&YM({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function hj(n,e){return n.map(t=>(t instanceof qM||(Aa("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),Aa(t.name,"shader module has no name"),(t=new qM(t)).dependencies=hj(t.dependencies)),t))}const KM={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},gf={};function $se(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/Apple/i)||e.match(/Apple/i)?"APPLE":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN"}Object.keys(KM).forEach(n=>{gf[n]=n});const XM={};function fj(n,e,t={}){const i=KM[e];if(Aa(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in XM)return XM[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),XM[e]=l,l}function YE(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=KM[e];Aa(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return Aa(!1===r||!0===r),r}(n,t))}function Dg(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const pj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Kse=[...pj,[Dg("attribute"),"in $1"],[Dg("varying"),"out $1"]],Xse=[...pj,[Dg("varying"),"in $1"]],gj=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Qse=[...gj,[Dg("in"),"attribute $1"],[Dg("out"),"varying $1"]],Zse=[...gj,[Dg("in"),"varying $1"]],QM="gl_FragColor",ZM=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Jse=/void\s+main\s*\([^)]*\)\s*\{\n?/;function KE(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const ioe=`\n\n${WE}\n\n`,mj={[iv]:"vertex",fs:"fragment"};function _j(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:d}){Aa("string"==typeof t,"shader source must be a string");const f=i===iv,p=t.split("\n");let g=100,_="",x=t;0===p[0].indexOf("#version ")?(g=300,_=p[0],x=p.slice(1).join("\n")):_=`#version ${g}`;const T={};r.forEach(We=>{Object.assign(T,We.getDefines())}),Object.assign(T,s);let q=c?`${_}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${mj[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${mj[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:$se(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return YE(n,gf.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),YE(n,gf.GLSL_DERIVATIVES)&&fj(n,gf.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),YE(n,gf.GLSL_FRAG_DATA)&&fj(n,gf.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),YE(n,gf.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(T)}\n${f?"":"precision highp float;\n\n"}\n`:`${_}\n`;const G=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),ge={},Ne={},Ge={};for(const We in a){const dt="string"==typeof a[We]?{injection:a[We],order:0}:a[We],Mt=We.match(/^(v|f)s:(#)?([\w-]+)$/);if(Mt){const Lt=Mt[3];Mt[2]?"decl"===Lt?Ne[We]=[dt]:Ge[We]=[dt]:ge[We]=[dt]}else Ge[We]=[dt]}for(const We of r){d&&We.checkDeprecations(x,d),q+=We.getModuleSource(i,g);const Mt=We.injections[i];for(const Ot in Mt){const Lt=Ot.match(/^(v|f)s:#([\w-]+)$/);if(Lt){const Jt="decl"===Lt[2]?Ne:Ge;Jt[Ot]=Jt[Ot]||[],Jt[Ot].push(Mt[Ot])}else ge[Ot]=ge[Ot]||[],ge[Ot].push(Mt[Ot])}}return q+=ioe,q=lj(q,i,Ne),q+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(G[i],ge),q+=x,q=lj(q,i,Ge),q=function(n,e,t){switch(e){case 300:return t?KE(n,Kse):function(n){const e=(n=KE(n,Xse)).match(ZM);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${QM}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace(Jse,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${QM}\\b`,"g"),t)}return n}(n);case 100:return t?KE(n,Qse):function(n){const e=(n=KE(n,Zse)).match(ZM);if(e){const t=e[1];n=n.replace(ZM,"").replace(new RegExp(`\\b${t}\\b`,"g"),QM)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(q,l?100:g,f),q}function ooe(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const hoe={5126:Cr.bind(null,"uniform1fv",Ta,1,yo),35664:Cr.bind(null,"uniform2fv",Ta,2,yo),35665:Cr.bind(null,"uniform3fv",Ta,3,yo),35666:Cr.bind(null,"uniform4fv",Ta,4,yo),5124:Cr.bind(null,"uniform1iv",qd,1,yo),35667:Cr.bind(null,"uniform2iv",qd,2,yo),35668:Cr.bind(null,"uniform3iv",qd,3,yo),35669:Cr.bind(null,"uniform4iv",qd,4,yo),35670:Cr.bind(null,"uniform1iv",qd,1,yo),35671:Cr.bind(null,"uniform2iv",qd,2,yo),35672:Cr.bind(null,"uniform3iv",qd,3,yo),35673:Cr.bind(null,"uniform4iv",qd,4,yo),35674:Cr.bind(null,"uniformMatrix2fv",Ta,4,Pu),35675:Cr.bind(null,"uniformMatrix3fv",Ta,9,Pu),35676:Cr.bind(null,"uniformMatrix4fv",Ta,16,Pu),35678:Js,35680:Js,5125:Cr.bind(null,"uniform1uiv",XE,1,yo),36294:Cr.bind(null,"uniform2uiv",XE,2,yo),36295:Cr.bind(null,"uniform3uiv",XE,3,yo),36296:Cr.bind(null,"uniform4uiv",XE,4,yo),35685:Cr.bind(null,"uniformMatrix2x3fv",Ta,6,Pu),35686:Cr.bind(null,"uniformMatrix2x4fv",Ta,8,Pu),35687:Cr.bind(null,"uniformMatrix3x2fv",Ta,6,Pu),35688:Cr.bind(null,"uniformMatrix3x4fv",Ta,12,Pu),35689:Cr.bind(null,"uniformMatrix4x2fv",Ta,8,Pu),35690:Cr.bind(null,"uniformMatrix4x3fv",Ta,12,Pu),35678:Js,35680:Js,35679:Js,35682:Js,36289:Js,36292:Js,36293:Js,36298:Js,36299:Js,36300:Js,36303:Js,36306:Js,36307:Js,36308:Js,36311:Js},foe={},poe={},goe={},yj=[0];function JM(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(yj[0]=n,n=yj);const r=n.length;if(r%e&&dn.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Ta(n,e){return JM(n,e,Float32Array,foe)}function qd(n,e){return JM(n,e,Int32Array,poe)}function XE(n,e){return JM(n,e,Uint32Array,goe)}function vj(n,e,t){const i=hoe[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function moe(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function yoe(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof xg||n instanceof Ag)||n instanceof Ts&&Boolean(n.texture)}function voe(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function Js(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Cr(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),d=c.length;let f=!1;if(null===r)r=new Float32Array(d),s=d,f=!0;else{nn(s===d,"Uniform length cannot change.");for(let p=0;p<d;++p)if(c[p]!==r[p]){f=!0;break}}return f&&(i(o,n,a,c),r.set(c)),f}}function yo(n,e,t,i){n[e](t,i)}function Pu(n,e,t,i){n[e](t,!1,i)}function QE(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function wj(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=Ej(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function Ej(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class rv extends Ou{static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return nn(!1),"unknown"}}constructor(e,t){VE(e),nn("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:QE(t.source,null)||t.id||Lc(`unnamed ${rv.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=QE(e,null);t&&(this.id=Lc(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${rv.getTypeName(this.shaderType)}:${this.id}`}getName(){return QE(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||QE(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let d=0;d<r.length;d++){const f=r[d];if(f.length<=1)continue;const p=f.split(":"),g=p[0],_=parseInt(p[2],10);if(isNaN(_))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[_]=f:o[_]=f}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return Ej(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:wj(s,c),warnings:wj(o,c)}}(i,this.source,this.shaderType,this.id);throw dn.error(`GLSL compilation errors in ${r}\n${s}`)(),dn.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class eI extends rv{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class tI extends rv{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Ds=5126,sv=5124,ov=5125,nI={[Ds]:[Ds,1,"float"],35664:[Ds,2,"vec2"],35665:[Ds,3,"vec3"],35666:[Ds,4,"vec4"],[sv]:[sv,1,"int"],35667:[sv,2,"ivec2"],35668:[sv,3,"ivec3"],35669:[sv,4,"ivec4"],[ov]:[ov,1,"uint"],36294:[ov,2,"uvec2"],36295:[ov,3,"uvec3"],36296:[ov,4,"uvec4"],35670:[Ds,1,"bool"],35671:[Ds,2,"bvec2"],35672:[Ds,3,"bvec3"],35673:[Ds,4,"bvec4"],35674:[Ds,8,"mat2"],35685:[Ds,8,"mat2x3"],35686:[Ds,8,"mat2x4"],35675:[Ds,12,"mat3"],35687:[Ds,12,"mat3x2"],35688:[Ds,12,"mat3x4"],35676:[Ds,16,"mat4"],35689:[Ds,16,"mat4x2"],35690:[Ds,16,"mat4x3"]};function Dj(n){const e=nI[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function Mj(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Ds}for(const t in nI){const[i,r,s]=nI[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class Joe{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!fi(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=Dj(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new ia(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=Dj(i),l={location:e,name:t,accessor:new ia({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const eae=35981,tae=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Oj extends Ou{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",tae),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=eae}=e;return this.hash=t||"",this.vs="string"==typeof i?new eI(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new tI(this.gl,{id:`${e.id}-fs`,source:r}):r,nn(this.vs instanceof eI),nn(this.fs instanceof tI),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Fo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Joe(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:d=c>0,vertexArray:f=null,transformFeedback:p,framebuffer:g,parameters:_={},uniforms:x,samplers:T}){if((x||T)&&(dn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(x||{})),dn.priority>=e){const q=g?g.id:"default",G=`mode=${$d(this.gl,t)} verts=${i} instances=${c} indexType=${$d(this.gl,l)} isInstanced=${d} isIndexed=${a} Framebuffer=${q}`;dn.log(e,G)()}return nn(f),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||d&&0===c||(f.bindForDraw(i,c,()=>{if(void 0!==g&&(_=Object.assign({},_,{framebuffer:g})),p){const q=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return nn(!1),0}}(t);p.begin(q)}this._bindTextures(),ql(this.gl,_,()=>{a&&d?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&fi(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):d?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),p&&p.end()}),0))}setUniforms(e={}){dn.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!yoe(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Ts&&(s=s.texture),s instanceof xg)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&voe(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new eI({handle:r});break;case 35632:i.fs=new tI({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=Lc(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),dn.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),dn.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||dn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=moe(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=vj(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=vj(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class av{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new av(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),d=this._getHash(t),f=this._getHash(i),p=c.map(ge=>this._getHash(ge.name)).sort(),g=o.map(ge=>this._getHash(ge)),_=Object.keys(r).sort(),x=Object.keys(s).sort(),T=[],q=[];for(const ge of _)T.push(this._getHash(ge)),T.push(this._getHash(r[ge]));for(const ge of x)q.push(this._getHash(ge)),q.push(this._getHash(s[ge]));const G=`${d}/${f}D${T.join("/")}M${p.join("/")}I${q.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[G]){const ge=function(n,e){const{vs:t,fs:i}=e,r=kse(e.modules||[]);return{gl:n,vs:_j(n,Object.assign({},e,{source:t,type:iv,modules:r})),fs:_j(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:ooe(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[G]=new Oj(this.gl,{hash:G,vs:ge.vs,fs:ge.fs,varyings:o,bufferMode:a}),this._getUniforms[G]=ge.getUniforms||(Ne=>{}),this._useCounts[G]=0}return this._useCounts[G]++,this._programCache[G]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let JE=null;class Da extends Ou{static isSupported(e,t={}){return!t.constantAttributeZero||fi(e)||"Chrome"===function(n){if(!pM())return"Node";if(HB(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":Wy.chrome?"Chrome":Wy.safari?"Safari":Wy.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Da(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Da.MAX_ATTRIBUTES=Da.MAX_ATTRIBUTES||e.getParameter(34921),Da.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:Da._setConstantFloatArray(e,t,i);break;case Int32Array:Da._setConstantIntArray(e,t,i);break;case Uint32Array:Da._setConstantUintArray(e,t,i);break;default:nn(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Da.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return nn(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:d}=i,{gl:f,gl2:p}=this;return e=Number(e),this.bind(()=>{f.bindBuffer(34962,t.handle),c?(nn(fi(f)),p.vertexAttribIPointer(e,r,s,o,a)):f.vertexAttribPointer(e,r,s,l,o,a),f.enableVertexAttribArray(e),p.vertexAttribDivisor(e,d||0)}),this}enable(e,t=!0){return!t&&0===e&&!Da.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new tr(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!JE||JE.byteLength<n)&&(JE=new ArrayBuffer(n)),JE}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:nn(!1)}}static _setConstantIntArray(e,t,i){switch(nn(fi(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:nn(!1)}}static _setConstantUintArray(e,t,i){switch(nn(fi(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:nn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return nn(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const lae=/^(.+)__LOCATION_([0-9]+)$/,cae=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class uae{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Da(e),yV(this,"VertexArray","v6.0",cae),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new tr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof tr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof tr&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,dn.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const d=ia.resolve(l.accessor,this.accessors[o]||{},i,r),{size:f,type:p}=d;return nn(Number.isFinite(f)&&Number.isFinite(p)),{location:o,accessor:d}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=lae.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof tr)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof tr)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof tr))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(Da.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){Da.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof tr){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return dn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function lv(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=lv(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function Rj(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,d,f,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof tr){const p=e,{data:g,changed:_}=p.getDebugData();let x;return d=_?"*":"",f=g,l=p.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?x=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${$d(r,s)})`:(c=!0,x=`${l} bytes`),{[i]:`${d}${lv(f,{size:o,isInteger:c})}`,"Format ":x}}return f=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${lv(f,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function fae(n,e){const{type:t,size:i}=e,r=Mj(t,i);return r?`${n} (${r.name})`:n}function Nj({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){nn(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const p of l)!p.match(".*_.*")&&!p.match(s)&&iI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)p.match(s)&&iI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)a[p]||iI({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;let d=0;const f={};if(!i)for(const p in t){const g=t[p];a[p]||(d++,f[p]={Type:`NOT USED: ${g}`,[n]:lv(g)})}return{table:a,count:c,unusedTable:f,unusedCount:d}}function iI({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?lv(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function Pj(n){const{type:e,size:t}=n.accessor,i=Mj(e,t);return i?`${i.name} ${n.name}`:n.name}const mae={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function yae(n,e){const{attributeMap:t=mae}=e||{};return t&&t[n]||n}function vae(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}nn(Number.isFinite(e.size),`attribute ${n} needs size`)}const Fj=()=>{},Eae={};class eS{constructor(e,t={}){const{id:i=Lc("model")}=t;nn(BE(e)),this.id=i,this.gl=e,this.id=t.id||Lc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||av.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},nn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:d},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return nn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return nn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=yae(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=ht({},o);delete c.value,i[a]=[new tr(n,l),c],vae(s,c)}}if(r){const s=r.value||r;nn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new tr(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(Sg(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return MM(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),dn.priority>=2&&(c=this._logDrawCallStart(2));const d=this.vertexArray.getDrawParams(),{isIndexed:f=d.isIndexed,indexType:p=d.indexType,indexOffset:g=d.indexOffset,vertexArrayInstanced:_=d.isInstanced}=this.props;_&&!this.isInstanced&&dn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:x,instanceCount:T}=this,{onBeforeRender:q=Fj,onAfterRender:G=Fj}=this.props;q(),this.program.setUniforms(this.uniforms);const ge=this.program.draw(Object.assign(Eae,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:f,indexType:p,isInstanced:x,instanceCount:T,offset:f?g:0}));return G(),dn.priority>=2&&this._logDrawCallEnd(c,l,i),ge}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return dn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:d}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:d}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}nn(t instanceof Oj,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new uae(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof tr&&t.delete()}}_setAnimationProps(e){this.animated&&nn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(Sg(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new rj(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),dn.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:dn.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=Rj(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${fae(s.name,a)}`),t[o]=Rj(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=Nj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:d}=Nj({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});d>0&&dn.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&dn.log("UNUSED UNIFORMS",Object.keys(a))();const f=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${Pj(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${Pj(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);dn.table(e,s)(),dn.table(e,o)(),dn.table(e+1,f)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),dn.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class rI{static isSupported(e){return fi(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();nn(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new eS(t,Object.assign({},e,{fs:e.fs||ij({version:sj(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(Sg(n.feedbackBuffers)&&Sg(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new _se(e,t)),function(n){return!(Sg(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new Ose(e,t)),nn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function tS(){}const xae={onStart:tS,onUpdate:tS,onInterrupt:tS,onEnd:tS};class cv{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=ht(ht({},xae),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Nae={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new cv(i),this.attribute=t,this.attributeInTransition=new UM(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=ZV(e.size);return new rI(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new tr(e,r),new tr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;JV(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)ej(ht({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=jM(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:QV(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new cv(i),this.attribute=t,this.attributeInTransition=new UM(e,jn(ht({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new xa(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new Ts(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=ZV(e.size);return new rI(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new tr(e,r),new tr(e,r),new tr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)ej(ht({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=jM(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:QV(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),JV(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),jE(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Pae{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=rI.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void Ni.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=Nae[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Ni.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const Lj="attributeManager.invalidate";class jae{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Pae(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);_o(Lj,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);_o(Lj,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;_o("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const d=this.attributes[c],f=d.settings.accessor;d.startIndices=i,s[c]&&Ni.removed("props.".concat(c),"data.attributes.".concat(c))(),d.setExternalBuffer(o[c])||d.setBinaryValue(o[f],e.startIndices)||!o[f]&&d.setConstantValue(s[f])||d.needsUpdate()&&(l=!0,this._updateAttribute({attribute:d,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=d.needsRedraw()}l&&_o("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=ht({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&Ni.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=jn(ht({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new UM(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;_o("attribute.updateStart",t),t.allocate(i)&&_o("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,_o("attribute.updateEnd",t,i))}}function Bj(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function Vj(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const Gae={interpolation:class extends cv{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=UE(t,i,o)}},spring:class extends cv{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=Bj(n[o],e[o],t[o],i,r);return s}return Bj(n,e,t,i,r)}(s,o,t,i,r);const l=Vj(a,t),c=Vj(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class $ae{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=XV(r)))return;const o=Gae[r.type];if(!o)return void Ni.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(jn(ht({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const nS={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:Wae}=nS;function Kae(n,e){if(!n.transitions)return null;const t={},i=oI(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&sI(n[r],e[r],s)&&(t[r]=!0)}return t}function jj({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=sI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=sI(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function sI(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Zae(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function Uj(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,jj({oldProps:r,newProps:i,triggerName:t})}function oI(n){const e=n[Wae],t=e&&e.constructor;return t?t._propTypes:{}}function rle(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function iS(n){let t,e={};return i=>{for(const r in i)if(!rle(i[r],e[r])){t=n(i),e=i;break}return t}}function sle(n,e){if(!e)return n;const t=ht(ht({},n),e);if("defines"in e&&(t.defines=ht(ht({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=ht({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function rS(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],d=e[8],f=e[9],p=e[10],g=e[11],_=e[12],x=e[13],T=e[14],q=e[15],G=t*a-i*o,ge=t*l-r*o,Ne=t*c-s*o,Ge=i*l-r*a,We=i*c-s*a,dt=r*c-s*l,Mt=d*x-f*_,Ot=d*T-p*_,Lt=d*q-g*_,Qt=f*T-p*x,Jt=f*q-g*x,bt=p*q-g*T,Ct=G*bt-ge*Jt+Ne*Qt+Ge*Lt-We*Ot+dt*Mt;return Ct?(n[0]=(a*bt-l*Jt+c*Qt)*(Ct=1/Ct),n[1]=(r*Jt-i*bt-s*Qt)*Ct,n[2]=(x*dt-T*We+q*Ge)*Ct,n[3]=(p*We-f*dt-g*Ge)*Ct,n[4]=(l*Lt-o*bt-c*Ot)*Ct,n[5]=(t*bt-r*Lt+s*Ot)*Ct,n[6]=(T*Ne-_*dt-q*ge)*Ct,n[7]=(d*dt-p*Ne+g*ge)*Ct,n[8]=(o*Jt-a*Lt+c*Mt)*Ct,n[9]=(i*Lt-t*Jt-s*Mt)*Ct,n[10]=(_*We-x*Ne+q*G)*Ct,n[11]=(f*Ne-d*We-g*G)*Ct,n[12]=(a*Ot-o*Qt-l*Mt)*Ct,n[13]=(t*Qt-i*Ot+r*Mt)*Ct,n[14]=(x*ge-_*Ge-T*G)*Ct,n[15]=(d*Ge-f*ge+p*G)*Ct,n):null}function kc(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],d=e[7],f=e[8],p=e[9],g=e[10],_=e[11],x=e[12],T=e[13],q=e[14],G=e[15],ge=t[0],Ne=t[1],Ge=t[2],We=t[3];return n[0]=ge*i+Ne*a+Ge*f+We*x,n[1]=ge*r+Ne*l+Ge*p+We*T,n[2]=ge*s+Ne*c+Ge*g+We*q,n[3]=ge*o+Ne*d+Ge*_+We*G,n[4]=(ge=t[4])*i+(Ne=t[5])*a+(Ge=t[6])*f+(We=t[7])*x,n[5]=ge*r+Ne*l+Ge*p+We*T,n[6]=ge*s+Ne*c+Ge*g+We*q,n[7]=ge*o+Ne*d+Ge*_+We*G,n[8]=(ge=t[8])*i+(Ne=t[9])*a+(Ge=t[10])*f+(We=t[11])*x,n[9]=ge*r+Ne*l+Ge*p+We*T,n[10]=ge*s+Ne*c+Ge*g+We*q,n[11]=ge*o+Ne*d+Ge*_+We*G,n[12]=(ge=t[12])*i+(Ne=t[13])*a+(Ge=t[14])*f+(We=t[15])*x,n[13]=ge*r+Ne*l+Ge*p+We*T,n[14]=ge*s+Ne*c+Ge*g+We*q,n[15]=ge*o+Ne*d+Ge*_+We*G,n}function uv(n,e,t){var o,a,l,c,d,f,p,g,_,x,T,q,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],d=e[4],f=e[5],p=e[6],g=e[7],_=e[8],x=e[9],T=e[10],q=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=d,n[5]=f,n[6]=p,n[7]=g,n[8]=_,n[9]=x,n[10]=T,n[11]=q,n[12]=o*i+d*r+_*s+e[12],n[13]=a*i+f*r+x*s+e[13],n[14]=l*i+p*r+T*s+e[14],n[15]=c*i+g*r+q*s+e[15]),n}function dv(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function zj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],d=e[9],f=e[10],p=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+d*i,n[6]=a*r+f*i,n[7]=l*r+p*i,n[8]=c*r-s*i,n[9]=d*r-o*i,n[10]=f*r-a*i,n[11]=p*r-l*i,n}function Hj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],d=e[5],f=e[6],p=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+d*i,n[2]=a*r+f*i,n[3]=l*r+p*i,n[4]=c*r-s*i,n[5]=d*r-o*i,n[6]=f*r-a*i,n[7]=p*r-l*i,n}function Gj(n,e,t,i,r){var o,s=1/Math.tan(e/2);return n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i),n}function $j(n,e){var t=n[0],i=n[1],r=n[2],s=n[3],o=n[4],a=n[5],l=n[6],c=n[7],d=n[8],f=n[9],p=n[10],g=n[11],_=n[12],x=n[13],T=n[14],q=n[15],G=e[0],ge=e[1],Ne=e[2],Ge=e[3],We=e[4],dt=e[5],Mt=e[6],Ot=e[7],Lt=e[8],Qt=e[9],Jt=e[10],bt=e[11],Ct=e[12],Ht=e[13],ft=e[14],Kt=e[15];return Math.abs(t-G)<=ur*Math.max(1,Math.abs(t),Math.abs(G))&&Math.abs(i-ge)<=ur*Math.max(1,Math.abs(i),Math.abs(ge))&&Math.abs(r-Ne)<=ur*Math.max(1,Math.abs(r),Math.abs(Ne))&&Math.abs(s-Ge)<=ur*Math.max(1,Math.abs(s),Math.abs(Ge))&&Math.abs(o-We)<=ur*Math.max(1,Math.abs(o),Math.abs(We))&&Math.abs(a-dt)<=ur*Math.max(1,Math.abs(a),Math.abs(dt))&&Math.abs(l-Mt)<=ur*Math.max(1,Math.abs(l),Math.abs(Mt))&&Math.abs(c-Ot)<=ur*Math.max(1,Math.abs(c),Math.abs(Ot))&&Math.abs(d-Lt)<=ur*Math.max(1,Math.abs(d),Math.abs(Lt))&&Math.abs(f-Qt)<=ur*Math.max(1,Math.abs(f),Math.abs(Qt))&&Math.abs(p-Jt)<=ur*Math.max(1,Math.abs(p),Math.abs(Jt))&&Math.abs(g-bt)<=ur*Math.max(1,Math.abs(g),Math.abs(bt))&&Math.abs(_-Ct)<=ur*Math.max(1,Math.abs(_),Math.abs(Ct))&&Math.abs(x-Ht)<=ur*Math.max(1,Math.abs(x),Math.abs(Ht))&&Math.abs(T-ft)<=ur*Math.max(1,Math.abs(T),Math.abs(ft))&&Math.abs(q-Kt)<=ur*Math.max(1,Math.abs(q),Math.abs(Kt))}function Wj(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function sS(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}!function(){var n=new ra(4);ra!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const qj=[0,0,0,0],Ole=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Rle=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Nle=[0,0,0],Ple=[0,0,0],Fle=iS(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=qj,l=qj,c=n.cameraPosition;const{geospatialOrigin:d,shaderCoordinateOrigin:f,offsetMode:p}=Yj(n,e,t);return p&&(l=n.projectPosition(d||f),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=sS([],l,o),s=i||s,o=kc([],r,s),o=kc([],o,Ole)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:d}}(n,t,i),d=n.getDistanceScales(),f=[n.width*e,n.height*e],p=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:p,project_uCommonUnitsPerMeter:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit:d.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Nle,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const _=n.getDistanceScales(c);switch(t){case Mi.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=_.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=_.unitsPerMeter2;break;case Mi.LNGLAT:case Mi.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=_.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=_.unitsPerDegree2;break;case Mi.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,_.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,_.unitsPerMeter2[2]]}}return g});function Yj(n,e,t=Ple){let r,i=t,s=!0;switch(r=e===Mi.LNGLAT_OFFSETS||e===Mi.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case Pc.WEB_MERCATOR:(e===Mi.LNGLAT||e===Mi.CARTESIAN)&&(s=!1);break;case Pc.WEB_MERCATOR_AUTO_OFFSET:e===Mi.LNGLAT?i=r:e===Mi.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case Pc.IDENTITY:i=n.position.map(Math.fround);break;case Pc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class Vle extends PM{get ELEMENTS(){return Nu(!1),0}get RANK(){return Nu(!1),0}toString(){let e="[";if(Sr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=Zs(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function Ng(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function aI(n,e){return n[0]=-e[0],n[1]=-e[1],n}function Kj(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}!function(){var n=new ra(2);ra!=Float32Array&&(n[0]=0,n[1]=0)}();const Xj=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),zle=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Hle=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Pg={};class Yn extends Vle{static get IDENTITY(){return Pg.IDENTITY=Pg.IDENTITY||Object.freeze(new Yn(Xj)),Pg.IDENTITY}static get ZERO(){return Pg.ZERO=Pg.ZERO||Object.freeze(new Yn(zle)),Pg.ZERO}get INDICES(){return Hle}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,d,f,p,g,_,x,T){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=d,this[10]=f,this[11]=p,this[12]=g,this[13]=_,this[14]=x,this[15]=T,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,d,f,p,g,_,x,T){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=d,this[7]=_,this[8]=i,this[9]=a,this[10]=f,this[11]=x,this[12]=r,this[13]=l,this[14]=p,this[15]=T,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Xj)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,d=i*o,f=i*a,p=r*o,g=r*a,_=r*l,x=s*o,T=s*a,q=s*l;n[0]=1-f-_,n[1]=d+q,n[2]=p-T,n[3]=0,n[4]=d-q,n[5]=1-c-_,n[6]=g+x,n[7]=0,n[8]=p+T,n[9]=g-x,n[10]=1-c-f,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?Yn._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),d=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=d,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,d,f,p,g,_=e[0],x=e[1],T=e[2],q=i[0],G=i[1],ge=i[2],Ne=t[0],Ge=t[1],We=t[2];Math.abs(_-Ne)<ur&&Math.abs(x-Ge)<ur&&Math.abs(T-We)<ur?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(d=_-Ne,f=x-Ge,p=T-We,r=G*(p*=g=1/Math.hypot(d,f,p))-ge*(f*=g),s=ge*(d*=g)-q*p,o=q*f-G*d,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=f*o-p*s,l=p*r-d*o,c=d*s-f*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=d,n[3]=0,n[4]=s,n[5]=l,n[6]=f,n[7]=0,n[8]=o,n[9]=c,n[10]=p,n[11]=0,n[12]=-(r*_+s*x+o*T),n[13]=-(a*_+l*x+c*T),n[14]=-(d*_+f*x+p*T),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new Yn).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return Gj(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],d=n[9],f=n[10],p=n[11],g=n[12],_=n[13],x=n[14],T=n[15];return(e*o-t*s)*(f*T-p*x)-(e*a-i*s)*(d*T-p*_)+(e*l-r*s)*(d*x-f*_)+(t*a-i*o)*(c*T-p*g)-(t*l-r*o)*(c*x-f*g)+(i*l-r*a)*(c*_-d*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return rS(this,this),this.check()}multiplyLeft(e){return kc(this,e,this),this.check()}multiplyRight(e){return kc(this,this,e),this.check()}rotateX(e){return zj(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],d=e[9],f=e[10],p=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-d*i,n[2]=a*r-f*i,n[3]=l*r-p*i,n[8]=s*i+c*r,n[9]=o*i+d*r,n[10]=a*i+f*r,n[11]=l*i+p*r}(this,this,e),this.check()}rotateZ(e){return Hj(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,d,f,p,g,_,x,T,q,G,ge,Ne,Ge,We,dt,Mt,Ot,Lt,Qt,Jt,bt,Ct,Ht,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<ur||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),p=e[1],g=e[2],_=e[3],T=e[5],q=e[6],G=e[7],Ne=e[9],Ge=e[10],We=e[11],Lt=r*s*(d=1-c)-o*l,Qt=s*s*d+c,Jt=o*s*d+r*l,bt=r*o*d+s*l,Ct=s*o*d-r*l,Ht=o*o*d+c,n[0]=(f=e[0])*(dt=r*r*d+c)+(x=e[4])*(Mt=s*r*d+o*l)+(ge=e[8])*(Ot=o*r*d-s*l),n[1]=p*dt+T*Mt+Ne*Ot,n[2]=g*dt+q*Mt+Ge*Ot,n[3]=_*dt+G*Mt+We*Ot,n[4]=f*Lt+x*Qt+ge*Jt,n[5]=p*Lt+T*Qt+Ne*Jt,n[6]=g*Lt+q*Qt+Ge*Jt,n[7]=_*Lt+G*Qt+We*Jt,n[8]=f*bt+x*Ct+ge*Ht,n[9]=p*bt+T*Ct+Ne*Ht,n[10]=g*bt+q*Ct+Ge*Ht,n[11]=_*bt+G*Ct+We*Ht,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?dv(this,this,e):dv(this,this,[e,e,e]),this.check()}translate(e){return uv(this,this,e),this.check()}transform(e,t){return 4===e.length?(zE(t=sS(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=jV(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return zE(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=UV(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return zE(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return FM("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return FM("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return FM("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Fg(n,e){const t=sS([],e,n);return Wj(t,t,1/t[3]),t}function Qj(n,e){const t=n%e;return t<0?e+t:t}const lI=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function Fu(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Kl=Math.PI,Zj=Kl/4,Xl=Kl/180,cI=180/Kl,uI=4003e4;function Lg([n,e]){return Fu(Number.isFinite(n)),Fu(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*Xl+Kl)/(2*Kl),512*(Kl+Math.log(Math.tan(Zj+e*Xl*.5)))/(2*Kl)]}function Yd([n,e]){const t=n/512*(2*Kl)-Kl,i=2*(Math.atan(Math.exp(e/512*(2*Kl)-Kl))-Zj);return[t*cI,i*cI]}function aS({latitude:n,longitude:e,highPrecision:t=!1}){Fu(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*Xl),o=512/360,a=o/s,l=512/uI/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=Xl*Math.tan(n*Xl)/s,f=512/uI*c,p=f/a*l;i.unitsPerDegree2=[0,o*c/2,f],i.unitsPerMeter2=[p,0,p]}return i}function eU(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=aS({longitude:t,latitude:i,highPrecision:!0}),d=Lg(n);d[0]+=s*(l[0]+c[0]*o),d[1]+=o*(l[1]+c[1]*o);const f=Yd(d),p=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[f[0],f[1],p]:f}function tU({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return uv(o,o,[0,0,-i]),zj(o,o,-e*Xl),Hj(o,o,t*Xl),dv(o,o,[r/=n,r,r]),s&&uv(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}function nU({width:n,height:e,fovy:t=lS(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=lS(i));const a=.5*t*Xl,l=iU(t),c=r*Xl,d=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*d+l)*o}}function lS(n){return 2*Math.atan(.5/n)*cI}function iU(n){return.5/Math.tan(.5*n*Xl)}function dI(n,e){const[t,i,r=0]=n;return Fu(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Fg(e,[t,i,r,1])}function mf(n,e,t=0){const[i,r,s]=n;if(Fu(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Fg(e,[i,r,s,1]);const o=Fg(e,[i,r,0,1]),a=Fg(e,[i,r,1,1]),l=o[2],c=a[2];return Kj([],o,a,l===c?0:((t||0)-l)/(c-l))}function rU({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,d]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:Fu(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const f=new cS({width:n,height:e,longitude:0,latitude:0,zoom:0}),p=f.project([a,d]),g=f.project([c,l]),_=[Math.max(Math.abs(g[0]-p[0]),i),Math.max(Math.abs(g[1]-p[1]),i)],x=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];Fu(x[0]>0&&x[1]>0);const T=x[0]/_[0],q=x[1]/_[1],Ge=f.unproject([(g[0]+p[0])/2+(s.right-s.left)/2/T,(g[1]+p[1])/2+(s.bottom-s.top)/2/q]),We=Math.min(r,f.zoom+lI(Math.abs(Math.min(T,q))));return Fu(Number.isFinite(We)),{longitude:Ge[0],latitude:Ge[1],zoom:We}}const sU=Math.PI/180;function oU(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*sU:Math.atan(.5/n.altitude))>(90-n.pitch)*sU-.01?(l=aU(n,0,e),c=aU(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}function aU(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Fg(i,[e,0,1,1]),s=Fg(i,[e,n.height,1,1]),c=Yd(Kj([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}class cS{constructor({width:e,height:t,latitude:i=0,longitude:r=0,zoom:s=0,pitch:o=0,bearing:a=0,altitude:l=null,fovy:c=null,position:d=null,nearZMultiplier:f=.02,farZMultiplier:p=1.01}={width:1,height:1}){e=e||1,t=t||1,null===c&&null===l?c=lS(l=1.5):null===c?c=lS(l):null===l&&(l=iU(c));const g=function(n){return Math.pow(2,n)}(s);l=Math.max(.75,l);const _=aS({longitude:r,latitude:i}),x=Lg([r,i]);x[2]=0,d&&function(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2]}(x,x,function(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n}([],d,_.unitsPerMeter)),this.projectionMatrix=function({width:n,height:e,pitch:t,altitude:i,fovy:r,nearZMultiplier:s,farZMultiplier:o}){const{fov:a,aspect:l,near:c,far:d}=nU({width:n,height:e,altitude:i,fovy:r,pitch:t,nearZMultiplier:s,farZMultiplier:o});return Gj([],a,l,c,d)}({width:e,height:t,pitch:o,fovy:c,nearZMultiplier:f,farZMultiplier:p}),this.viewMatrix=tU({height:t,scale:g,center:x,pitch:o,bearing:a,altitude:l}),this.width=e,this.height=t,this.scale=g,this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=l,this.fovy=c,this.center=x,this.meterOffset=d||[0,0,0],this.distanceScales=_,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:e,height:t,projectionMatrix:i,viewMatrix:r}=this,s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];kc(s,s,i),kc(s,s,r),this.viewProjectionMatrix=s;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];dv(o,o,[e/2,-t/2,1]),uv(o,o,[1,-1,0]),kc(o,o,s);const a=rS([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!a)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=a}equals(e){return e instanceof cS&&e.width===this.width&&e.height===this.height&&$j(e.projectionMatrix,this.projectionMatrix)&&$j(e.viewMatrix,this.viewMatrix)}project(e,{topLeft:t=!0}={}){const r=dI(this.projectPosition(e),this.pixelProjectionMatrix),[s,o]=r,a=t?o:this.height-o;return 2===e.length?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[r,s,o]=e,c=mf([r,t?s:this.height-s,o],this.pixelUnprojectionMatrix,i&&i*this.distanceScales.unitsPerMeter[2]),[d,f,p]=this.unprojectPosition(c);return Number.isFinite(o)?[d,f,p]:Number.isFinite(i)?[d,f,i]:[d,f]}projectPosition(e){const[t,i]=Lg(e);return[t,i,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,i]=Yd(e);return[t,i,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){return Lg(e)}unprojectFlat(e){return Yd(e)}getMapCenterByLngLatPosition({lngLat:e,pos:t}){const i=mf(t,this.pixelUnprojectionMatrix),s=Ng([],Lg(e),aI([],i));return Yd(Ng([],this.center,s))}getLocationAtPoint({lngLat:e,pos:t}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:t})}fitBounds(e,t={}){const{width:i,height:r}=this,{longitude:s,latitude:o,zoom:a}=rU(Object.assign({width:i,height:r,bounds:e},t));return new cS({width:i,height:r,longitude:s,latitude:o,zoom:a})}getBounds(e){const t=this.getBoundingRegion(e),i=Math.min(...t.map(a=>a[0])),r=Math.max(...t.map(a=>a[0]));return[[i,Math.min(...t.map(a=>a[1]))],[r,Math.max(...t.map(a=>a[1]))]]}getBoundingRegion(e={}){return oU(this,e.z||0)}}const Qle=Math.PI/180,Zle=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],hI=[0,0,0],ece={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let kg=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Pc.WEB_MERCATOR:Pc.WEB_MERCATOR_AUTO_OFFSET:Pc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&ev(t.projectionMatrix,this.projectionMatrix)&&ev(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=dI(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,d=mf([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[f,p,g]=this.unprojectPosition(d);return Number.isFinite(a)?[f,p,g]:Number.isFinite(r)?[f,p,r]:[f,p]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?Lg(t):t}unprojectFlat(t){return this.isGeospatial?Yd(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?aS({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=Tg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=Tg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=Tg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=Tg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=Tg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=Tg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new Yn).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new Yn).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=Zle,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:d=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){Fu(Number.isFinite(n));const e=Math.cos(n*Xl);return function(n){return lI(n)}(uI*e)-9}({latitude:s})+Math.log2(c):0);const f=Math.pow(2,this.zoom);this.scale=f,this.distanceScales=this.isGeospatial?aS({latitude:s,longitude:r}):d||ece,this.focalDistance=c,this.distanceScales.metersPerUnit=new mo(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new mo(this.distanceScales.unitsPerMeter),this.position=hI,this.meterOffset=hI,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new Yn).multiplyRight(this.viewMatrixUncentered).translate(new mo(this.center||hI).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new mo(this.projectPosition([t,i,0]));if(r){const a=new mo(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*Qle,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];kc(t,t,this.projectionMatrix),kc(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=rS([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];dv(i,i,[this.width/2,-this.height/2,1]),uv(i,i,[1,-1,0]),kc(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=rS([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ni.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),hU=(()=>{class n extends kg{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:d=!1,repeat:f=!1,worldOffset:p=0}=t;let{width:g,height:_,altitude:x=1.5}=t;const T=Math.pow(2,s);g=g||1,_=_||1,x=Math.max(.75,x);const{fov:q,aspect:G,focalDistance:ge,near:Ne,far:Ge}=nU({width:g,height:_,pitch:o,altitude:x,nearZMultiplier:l,farZMultiplier:c});let We=tU({height:_,pitch:o,bearing:a,scale:T,altitude:x});p&&(We=(new Yn).translate([512*p,0,0]).multiplyLeft(We)),super(jn(ht({},t),{width:g,height:_,viewMatrix:We,longitude:r,latitude:i,zoom:s,orthographic:d,fovyRadians:q,aspect:G,focalDistance:ge,near:Ne,far:Ge})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=x,this.orthographic=d,this._subViewports=f?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(jn(ht({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return eU(t,i)}panByPosition(t,i){const r=mf(i,this.pixelUnprojectionMatrix),o=Ng([],this.projectFlat(t),aI([],r)),a=Ng([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=oU(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=rU(ht({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function fI(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof hU){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function fU(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=sS([],[o,a,l,1],t)),i){case Mi.LNGLAT:return fI([o,a,l],e,s);case Mi.LNGLAT_OFFSETS:return fI([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Mi.METER_OFFSETS:return fI(eU(r,[o,a,l]),e,s);case Mi.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const ice={10241:9987,10240:9729,10242:33071,10243:33071},pI={},oce={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||pv(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>gI(n,e)},accessor:{validate(n,e){const t=uS(n);return"function"===t||t===uS(e.value)},equal:(n,e,t)=>"function"==typeof e||gI(n,e)},array:{validate:(n,e)=>e.optional&&!n||pv(n),equal:(n,e,t)=>t.compare?gI(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof xa)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new xa(t,jn(ht({},e),{parameters:ht(ht(ht({},ice),i),n.props.textureParameters)}));return pI[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof xa)||pI[n.id]&&(n.delete(),delete pI[n.id])}(n)}}};function gI(n,e){if(n===e)return!0;if(!pv(n)||!pv(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function lce(n,e){switch(uS(e)){case"object":return fv(n,e);case"array":return fv(n,{type:"array",value:e,compare:!1});case"boolean":return fv(n,{type:"boolean",value:e});case"number":return fv(n,{type:"number",value:e});case"function":return fv(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function fv(n,e){return"type"in e?ht(ht({name:n},oce[e.type]),e):"value"in e?ht({name:n,type:uS(e.value)},e):{name:n,type:"object",value:e}}function pv(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function uS(n){return pv(n)?"array":null===n?"null":typeof n}const{COMPONENT:mI,ASYNC_ORIGINAL:dS,ASYNC_RESOLVED:gv,ASYNC_DEFAULTS:hS}=nS;function cce(){const n=this,e=pU(n.constructor),t=Object.create(e);t[mI]=n,t[dS]={},t[gv]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function pU(n){return fS(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=pU(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=lce(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(fS(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=fS(n,"layerName")||fS(n,"componentName");return e||Ni.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=ht(ht({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=pce(o))}n[hS]=t,n[dS]={},Object.defineProperties(n,i)}(o,a);const l=ht(ht({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])gU(this,s)||(this[s]=i);Ni.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function pce(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||YV(e)?this[dS][n]=e:this[gv][n]=e},get(){if(this[gv]){if(n in this[gv])return this[gv][n]||this[hS][n];if(n in this[dS]){const e=this[mI]&&this[mI].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[hS][n]}}return this[hS][n]}}}function gU(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function fS(n,e){return gU(n,e)&&n[e]}function _I(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:mce,ASYNC_RESOLVED:_ce,ASYNC_DEFAULTS:yce}=nS,vce=Object.freeze({});class mU{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=vce,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[_ce]||{},i=e[mce]||e,r=e[yce]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(YV(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return ei(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var f,c=!0,d=!1;try{for(var g,_,p=_I(t);c=(g=yield p.next()).done,_=yield g.value,!c;c=!0){const T=_,{dataTransform:q}=i.component?i.component.props:{};a=q?q(T,a):a.concat(T),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(T){d=!0,f=T}finally{try{!c&&null!=p.return&&(yield p.return())}finally{if(d)throw f}}const x=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;x&&x(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:_U,ASYNC_RESOLVED:yU,ASYNC_DEFAULTS:bce}=nS,wce={};let Ece=0,Sce=(()=>{class n{constructor(){this.props=cce.apply(this,arguments),this.id=this.props.id,this.count=Ece++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[bce])s in i[yU]?r[s]=i[yU][s]:s in i[_U]&&(r[s]=i[_U][s]);return new this.constructor(ht(ht(ht({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new mU({})}}return n.componentName="Component",n.defaultProps=wce,n})();class Cce extends mU{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const Ql=n=>"function"==typeof n,Kd=n=>null!==n&&"object"==typeof n,bU=n=>Kd(n)&&n.constructor==={}.constructor,xce=n=>n&&"function"==typeof n[Symbol.iterator],Ace=n=>n&&"function"==typeof n[Symbol.asyncIterator],mv=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Bg=n=>"undefined"!=typeof Blob&&n instanceof Blob,wU=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||Kd(n)&&Ql(n.tee)&&Ql(n.cancel)&&Ql(n.getReader))(n)||(n=>Kd(n)&&Ql(n.read)&&Ql(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function _f(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function yI(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function vI(n){var e,t;let i;return _f(n,"null loader"),_f(yI(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=jn(ht({},n=n[0]),{options:ht(ht({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const Bc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},bI=Bc.global||Bc.self||Bc.window||{},Rce="object"!=typeof process||"[object process]"!==String(process)||process.browser,EU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);EU&&parseFloat(EU[1]);const EI={};function Nce(n){for(const e in EI)n.startsWith(e)&&(n=n.replace(e,EI[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const Pce=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Fce=/^([-\w.]+\/[-\w.+]+)/;function Lce(n){const e=Fce.exec(n);return e?e[1]:n}function SU(n){const e=Pce.exec(n);return e?e[1]:""}const kce=/\?.*/;function pS(n){if(mv(n)){const e=SI(n.url||"");return{url:e,type:Lce(n.headers.get("content-type")||"")||SU(e)}}return Bg(n)?{url:SI(n.name||""),type:n.type||""}:"string"==typeof n?{url:SI(n),type:SU(n)}:{url:"",type:""}}function Bce(n){return mv(n)?n.headers["content-length"]||-1:Bg(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function SI(n){return n.replace(kce,"")}function CU(n){return CI.apply(this,arguments)}function CI(){return(CI=ei(function*(n){if(mv(n))return n;const e={},t=Bce(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=pS(n);r&&(e["content-type"]=r);const s=yield Uce(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function Vce(n){return xI.apply(this,arguments)}function xI(){return(xI=ei(function*(n){if(!n.ok){const e=yield jce(n);throw new Error(e)}})).apply(this,arguments)}function jce(n){return AI.apply(this,arguments)}function AI(){return(AI=ei(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function Uce(n){return TI.apply(this,arguments)}function TI(){return(TI=ei(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${zce(n.slice(0,5))}`:null})).apply(this,arguments)}function zce(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function xU(n,e){return DI.apply(this,arguments)}function DI(){return(DI=ei(function*(n,e){if("string"==typeof n){n=Nce(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield CU(n)})).apply(this,arguments)}function Gn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const AU=new mM({id:"loaders.gl"});class Hce{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const TU={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){Gn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},$ce={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function MI(){bI.loaders=bI.loaders||{};const{loaders:n}=bI;return n._state=n._state||{},n._state}const II=()=>{const n=MI();return n.globalOptions=n.globalOptions||ht({},TU),n.globalOptions};function Wce(n,e,t,i){return t=t||[],function(n,e){MU(n,null,TU,$ce,e);for(const t of e)MU(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=ht({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new Hce),OU(r,II()),OU(r,e),r}(e,n,i)}function DU(n,e){const t=II(),i=n||t;return"function"==typeof i.fetch?i.fetch:Kd(i.fetch)?r=>xU(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:xU}function MU(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&Kd(n[a]),c="baseUri"===a&&!e,d="workerUrl"===a&&e;if(!(a in t)&&!c&&!d)if(a in i)AU.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const f=Yce(a,r);AU.warn(`${s} loader option '${o}${a}' not recognized. ${f}`)()}}}function Yce(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function OU(n,e){for(const t in e)t in e&&(n[t]=bU(e[t])&&bU(n[t])?ht(ht({},n[t]),e[t]):e[t])}function Vc(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function Qce(n,e="3.0.12"){return Vc(n,"no worker provided"),!(!e||!n.version)}const jc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Zce=jc.global||jc.self||jc.window||{},OI="object"!=typeof process||"[object process]"!==String(process)||process.browser,RI="function"==typeof importScripts,Jce="undefined"!=typeof window&&void 0!==window.orientation,RU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),NI=(RU&&parseFloat(RU[1]),new Map);function NU(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function PU(n,e=!0,t){const i=t||new Set;if(n)if(FU(n))i.add(n);else if(FU(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)PU(n[r],e,i);return void 0===t?Array.from(i):[]}function FU(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const PI=()=>{};class LU{static isSupported(){return"undefined"!=typeof Worker}constructor(e){Gn(this,"name",void 0),Gn(this,"source",void 0),Gn(this,"url",void 0),Gn(this,"terminated",!1),Gn(this,"worker",void 0),Gn(this,"onMessage",void 0),Gn(this,"onError",void 0),Gn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;Vc(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=PI,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=PI,this.onError=PI,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||PU(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){Vc(n.source&&!n.url||!n.source&&n.url);let e=NI.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?NU(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),NI.set(n.url,e)),n.source&&(e=NU(n.source),NI.set(n.source,e))),Vc(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class iue{constructor(e,t){Gn(this,"name",void 0),Gn(this,"workerThread",void 0),Gn(this,"isRunning",void 0),Gn(this,"result",void 0),Gn(this,"_resolve",void 0),Gn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Vc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Vc(this.isRunning),this.isRunning=!1,this._reject(e)}}class rue{constructor(e){Gn(this,"name","unnamed"),Gn(this,"source",void 0),Gn(this,"url",void 0),Gn(this,"maxConcurrency",1),Gn(this,"maxMobileConcurrency",1),Gn(this,"onDebug",()=>{}),Gn(this,"reuseWorkers",!0),Gn(this,"props",{}),Gn(this,"jobQueue",[]),Gn(this,"idleQueue",[]),Gn(this,"count",0),Gn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=ht(ht({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return ei(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return ei(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new iue(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new LU({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Jce?this.maxMobileConcurrency:this.maxConcurrency}}const sue={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Lu{static isSupported(){return LU.isSupported()}static getWorkerFarm(e={}){return Lu._workerFarm=Lu._workerFarm||new Lu({}),Lu._workerFarm.setProps(e),Lu._workerFarm}constructor(e){Gn(this,"props",void 0),Gn(this,"workerPools",new Map),this.props=ht({},sue),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=ht(ht({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new rue({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function aue(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return Vc(r),r}function lue(n,e){return!!Lu.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function cue(n,e,t,i,r){return FI.apply(this,arguments)}function FI(){return(FI=ei(function*(n,e,t,i,r){const s=n.id,o=aue(n,t),l=Lu.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",uue.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function uue(n,e,t,i){return LI.apply(this,arguments)}function LI(){return(LI=ei(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}Gn(Lu,"_workerFarm",void 0);var BU=tt(521);function VU(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return BU.toArrayBuffer?BU.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function pue(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function jU(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function gue(n){return BI.apply(this,arguments)}function BI(){return(BI=ei(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=_I(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return pue(...e)})).apply(this,arguments)}const yue=262144;function UU(n){this.wrapped=n}function _v(n){return new UU(n)}function yv(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,d=c instanceof UU;Promise.resolve(d?c.wrapped:c).then(function(f){d?r("return"===o?"return":"next",f):s(l.done?"return":"normal",f)},function(f){r("throw",f)})}catch(f){s("throw",f)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var d={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=d:(e=t=d,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function jI(n){return function(){return new yv(n.apply(this,arguments))}}function UI(){return(UI=jI(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield _v(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function zU(n,e){return Rce?function(n,e){return zI.apply(this,arguments)}(n,e):function(n,e){return HI.apply(this,arguments)}(n,e)}function zI(){return(zI=jI(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield _v(r);if(s)return;yield VU(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function HI(){return(HI=jI(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=_I(n);t=(o=yield _v(s.next())).done,a=yield _v(o.value),!t;t=!0)yield VU(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield _v(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function Cue(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=yue}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(Bg(n))return function(n,e){return UI.apply(this,arguments)}(n,e);if(wU(n))return zU(n,e);if(mv(n))return zU(n.body,e);throw new Error("makeIterator")}yv.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},yv.prototype.next=function(n){return this._invoke("next",n)},yv.prototype.throw=function(n){return this._invoke("throw",n)},yv.prototype.return=function(n){return this._invoke("return",n)};const GI="Cannot convert supplied data type";function xue(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(GI)}function Aue(n,e,t){return $I.apply(this,arguments)}function $I(){return($I=ei(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return xue(n,e);if(Bg(n)&&(n=yield CU(n)),mv(n)){const r=n;return yield Vce(r),e.binary?yield r.arrayBuffer():yield r.text()}if(wU(n)&&(n=Cue(n,t)),xce(n)||Ace(n))return gue(n);throw new Error(GI)})).apply(this,arguments)}function Due(n,e,t=null){if(t)return t;const i=ht({fetch:DU(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function Mue(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const HU=()=>{const n=MI();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function GU(n){const e=HU();n=Array.isArray(n)?n:[n];for(const t of n){const i=vI(t);e.find(r=>i===r)||e.unshift(i)}}const Oue=/\.([^.]+)$/;function Rue(n){return YI.apply(this,arguments)}function YI(){return(YI=ei(function*(n,e=[],t,i){if(!WU(n))return null;let r=$U(n,e,jn(ht({},t),{nothrow:!0}),i);if(r)return r;if(Bg(n)&&(r=$U(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(qU(n));return r})).apply(this,arguments)}function $U(n,e=[],t,i){if(!WU(n))return null;if(e&&!Array.isArray(e))return vI(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...HU()),function(n){for(const e of n)vI(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=pS(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=KI(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&Oue.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||KI(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(Bue(e,t))return t}else if(ArrayBuffer.isView(e)){if(YU(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&YU(e,0,t))return t;return null}(e,n),a=a||KI(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(qU(n));return s}function WU(n){return!(n instanceof Response&&204===n.status)}function qU(n){const{url:e,type:t}=pS(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?XI(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?XI(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function KI(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function Bue(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function YU(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===XI(n,e,i.length);default:return!1}}(n,e,t,r))}function XI(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function gS(n,e,t,i){return QI.apply(this,arguments)}function QI(){return(QI=ei(function*(n,e,t,i){Vc(!i||"object"==typeof i),e&&!Array.isArray(e)&&!yI(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=pS(n),o=Mue(e,i),a=yield Rue(n,o,t);return a?(i=Due({url:r,parse:gS,loaders:o},t=Wce(t,a,o,r),i),yield Uue(a,n,t,i)):null})).apply(this,arguments)}function Uue(n,e,t,i){return ZI.apply(this,arguments)}function ZI(){return(ZI=ei(function*(n,e,t,i){if(Qce(n),e=yield Aue(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(lue(n,t))return yield cue(n,e,t,i,gS);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw Vc(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function mS(n,e,t,i){return JI.apply(this,arguments)}function JI(){return(JI=ei(function*(n,e,t,i){!Array.isArray(e)&&!yI(e)&&(t=e,e=void 0);const r=DU(t);let s=n;return"string"==typeof n&&(s=yield r(n)),Bg(n)&&(s=yield r(n)),yield gS(s,e,t)})).apply(this,arguments)}const KU=fr(2,24)-1,que=Object.freeze([]),Yue=iS(({oldViewport:n,viewport:e})=>n.equals(e));let Uc=new Uint8ClampedArray(0);const Kue={data:{type:"data",value:que,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=jn(ht({},r),{fetch:jn(ht({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:mS(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):mS(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Mi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let eO=(()=>{class n extends Sce{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=fU(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=dI(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=ht({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Mi.DEFAULT&&(t=i.isGeospatial?Mi.LNGLAT:Mi.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:d}=Yj(t,i,r),f=fU(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:d});d&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(f,f,t.projectPosition(l||c));return f}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Mi.DEFAULT||t===Mi.LNGLAT||t===Mi.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){Yl(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=sle(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const d of c)o.invalidateAll(d);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:d}=o.attributes,f=c||d;f&&(l&&f.constant&&(f.constant=!1,o.invalidate(f.id)),!f.value&&!l&&(f.constant=!0,f.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!Yue({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(Uc.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>KU&&Ni.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Uc=Jy.allocate(Uc,i,{size:3,copy:!0,maxCount:Math.max(i,KU)});const s=Math.floor(Uc.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),Uc[3*a+0]=o[0],Uc[3*a+1]=o[1],Uc[3*a+2]=o[2]}t.value=Uc.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==Uc.buffer&&(r.value=Uc.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){_o("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();_o("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){_o("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];Iu(this.context.gl,{polygonOffset:l}),ql(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const d of this.props.extensions)d.draw.call(this,c,d);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&_o("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=jj({newProps:n,oldProps:e,propTypes:oI(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&Uj(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&Uj(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Zae(n,e),transitionsChanged:Kae(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=oI(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new jae(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){Yl(!this.internalState&&!this.state),Yl(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Cce({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ni.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new $ae(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){_o("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=Kue,n})(),Que=(()=>{class n extends eO{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:d,coordinateSystem:f,coordinateOrigin:p,wrapLongitude:g,positionFormat:_,modelMatrix:x,extensions:T,fetch:q,_subLayerProps:G}=this.props,ge={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:d,coordinateSystem:f,coordinateOrigin:p,wrapLongitude:g,positionFormat:_,modelMatrix:x,extensions:T,fetch:q},Ne=G&&G[t.id],Ge=Ne&&Ne.updateTriggers,We=t.id||"sublayer";if(Ne){const dt=this.constructor._propTypes,Mt=t.type?t.type._propTypes:{};for(const Ot in Ne){const Lt=Mt[Ot]||dt[Ot];Lt&&"accessor"===Lt.type&&(Ne[Ot]=this.getSubLayerAccessor(Ne[Ot]))}}Object.assign(ge,t,Ne),ge.id="".concat(this.props.id,"-").concat(We),ge.updateTriggers=ht(ht({all:this.props.updateTriggers.all},t.updateTriggers),Ge);for(const dt of T){const Mt=dt.getSubLayerProps.call(this,dt);Mt&&Object.assign(ge,Mt,{updateTriggers:Object.assign(ge.updateTriggers,Mt.updateTriggers)})}return ge}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=BM(t,Boolean),this.internalState.subLayers=t),_o("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const Zue=/([0-9]+\.?[0-9]*)(%|px)/;function _S(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match(Zue);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function yS(n,e){return n.relative?Math.round(n.position*e):n.position}function vv(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&vv(i,r)))return!1}return!0}class tO{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:d=1e3,modelMatrix:f=null,viewportInstance:p=null,type:g=kg}=e;Yl(!p||p instanceof kg),this.viewportInstance=p,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=jn(ht({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:d,modelMatrix:f}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):vv(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=ht({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:yS(this._x,e),y:yS(this._y,t),width:yS(this._width,e),height:yS(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),ht(ht({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(ht(ht(ht({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=_S(e),this._y=_S(t),this._width=_S(i),this._height=_S(r)}}const bv=()=>{},XU={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:bv,onTransitionInterrupt:bv,onTransitionEnd:bv};class Jue{constructor(e,t={}){this.ControllerState=e,this.props=ht(ht({},XU),t),this.propsInTransition=null,this.transition=new cv(t.timeline),this.onViewStateChange=t.onViewStateChange||bv,this.onStateChange=t.onStateChange||bv,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=ht(ht({},XU),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=ht(ht({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(ht(ht({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const QU=["longitude","latitude","zoom","bearing","pitch"],tde=["longitude","latitude","zoom"];class ZU extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!ev(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];Yl(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:QU,extract:QU,required:tde}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=UE(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(ht(ht({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,UE(e.around,t.around,i)))}return r}}const Xd={transitionDuration:0},nde={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},bS=n=>1-(1-n)*(1-n),Vg_WHEEL=["wheel"],Vg_PAN=["panstart","panmove","panend"],Vg_PINCH=["pinchstart","pinchmove","pinchend"],Vg_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],Vg_DOUBLE_TAP=["doubletap"],Vg_KEYBOARD=["keydown"];class nO{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new Jue(e,jn(ht({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&jn(ht({},nde),{transitionInterpolator:new ZU({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(ht(ht({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,d=Boolean(this.onViewStateChange);this.toggleEvents(Vg_WHEEL,d&&i),this.toggleEvents(Vg_PAN,d&&(r||s)),this.toggleEvents(Vg_PINCH,d&&(a||l)),this.toggleEvents(Vg_TRIPLE_PAN,d&&l),this.toggleEvents(Vg_DOUBLE_TAP,d&&o),this.toggleEvents(Vg_KEYBOARD,d&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=ht(ht({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,Xd,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,Xd,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,jn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:bS}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Xd,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,jn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:bS}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,jn(ht({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,Xd,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Xd,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,jn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:bS}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,Xd,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,Xd,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,jn(ht({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:bS}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?jn(ht({},t),{transitionInterpolator:new ZU(jn(ht({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:Xd}}class JU{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const Qd_target=[0,0,0];class wS extends JU{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=Qd_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:d=-(1/0),maxZoom:f=Infinity,startPanPosition:p,startRotatePos:g,startRotationX:_,startRotationOrbit:x,startZoomPosition:T,startZoom:q}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:d,maxZoom:f}),this._state={startPanPosition:p,startRotatePos:g,startRotationX:_,startRotationOrbit:x,startZoomPosition:T,startZoom:q},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let d=(e[0]-r[0])/a;(s<-90||s>90)&&(d*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*d}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=ht({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(jn(ht({},this._viewportProps),{zoom:a}));return this._getUpdatedState(ht({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),pf(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new wS(ht(ht(ht({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=pf(r,i,t),e.rotationX=pf(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class rde extends nO{constructor(e){super(wS,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class sde extends nO{constructor(e){e.dragMode=e.dragMode||"pan",super(wS,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const ode=(new Yn).lookAt({eye:[0,0,1]});function ade({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new Yn).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class lde extends kg{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(jn(ht({},e),{longitude:null,position:a,viewMatrix:ode.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:ade({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=Ng([],e,aI([],mf(t,this.pixelUnprojectionMatrix)));return{target:Ng([],this.center,r)}}}let cde=(()=>{class n extends tO{constructor(t){super(jn(ht({},t),{type:lde}))}get controller(){return this._getControllerProps({type:sde})}}return n.displayName="OrthographicView",n})();const ES=Math.PI/180;function ude({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*ES/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new Yn).lookAt({eye:l,up:a});c.rotateX(i*ES),"Z"===t?c.rotateZ(r*ES):c.rotateY(r*ES);const d=Math.pow(2,s)/(n||1);return c.scale(d),c}class dde extends kg{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(jn(ht({},e),{longitude:null,viewMatrix:ude({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=mf([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let hde=(()=>{class n extends tO{constructor(t={}){const{orbitAxis:i="Z"}=t;super(jn(ht({},t),{orbitAxis:i,type:dde}))}get controller(){return this._getControllerProps({type:rde})}}return n.displayName="OrbitView",n})();const fde=[255,255,255],pde=1;let gde=0;class ez{constructor(e={}){const{color:t=fde}=e,{intensity:i=pde}=e;this.id=e.id||"ambient-".concat(gde++),this.color=t,this.intensity=i,this.type="ambient"}}const mde=[255,255,255],_de=1,yde=[0,0,-1];let vde=0;class tz{constructor(e={}){const{color:t=mde}=e,{intensity:i=_de}=e,{direction:r=yde}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(vde++),this.color=t,this.intensity=i,this.type="directional",this.direction=new mo(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class nz{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=ht({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class iO extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=ht({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return Iu(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){Iu(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,d=i&&i[c.id];r(c);const f=this._getDrawLayerParams(c,e);e.view=d;const p=c.subViewports||[c];for(const g of p){e.viewport=g;const _=this._drawLayersInViewport(o,e,f);a.push(_)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=iz(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let d=0;d<t.length;d++){const f=t[d],p=this._shouldDrawLayer(f,c,r),_={shouldDrawLayer:p,layerRenderIndex:l(f,p)};p&&(_.moduleParameters=this._getModuleParameters(f,s,i,o),_.layerParameters=this.getLayerParameters(f,d)),a[d]=_}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=Eg(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;ql(e,{scissorTest:!0,scissor:a},()=>MM(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Iu(e,{viewport:a});for(let c=0;c<t.length;c++){const d=t[c],{shouldDrawLayer:f,layerRenderIndex:p,moduleParameters:g,layerParameters:_}=o[c];if(f&&d.props.pickable&&l.pickableCount++,d.isComposite)l.compositeCount++;else if(f){l.visibleCount++,g.viewport=r;try{d.drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:_})}catch(x){d.raiseError(x,"drawing ".concat(d," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Eg(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function iz(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const d=t[l]=t[l]||iz(e[l],e);c=d(r,s),t[a]=d}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class Sde extends iO{constructor(e,t){super(e,t),this.shadowMap=new xa(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Ag(e,{format:33189,width:1,height:1}),this.fbo=new Ts(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;ql(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=Eg(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(jn(ht({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const xde=Object.keys(Mi).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Mi[n],";")).join(""),Ade=Object.keys(Pc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(Pc[n],";")).join(""),Tde="".concat(xde,"\n").concat(Ade,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),Dde={},rO={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:Tde,getUniforms:function(n=Dde){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Mi.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Mi.DEFAULT&&(i=n.isGeospatial?Mi.LNGLAT:Mi.CARTESIAN);const o=Fle({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||Rle,o}(n):{}}},Rde=iS(function({viewport:n,center:e}){return new Yn(n.viewProjectionMatrix).invert().transform(e)}),Nde=iS(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=mf([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new mo(n.center).negate()),l=s.map(d=>a.transform(d)),c=(new Yn).ortho({left:Math.min(...l.map(d=>d[0])),right:Math.max(...l.map(d=>d[0])),bottom:Math.min(...l.map(d=>d[1])),top:Math.max(...l.map(d=>d[1])),near:Math.min(...l.map(d=>-d[2])),far:Math.max(...l.map(d=>-d[2]))});t.push(c.multiplyRight(o))}return t}),Pde=[0,0,0,1],Fde=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],sO={name:"shadow",dependencies:[rO],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Pde,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=Rde({viewport:n.viewport,center:e.project_uCenter}),r=[],s=Nde({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new mo(n.viewport.center).negate());e.project_uCoordinateSystem===Mi.LNGLAT&&e.project_uProjectionMode===Pc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(Fde),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},jde={color:[255,255,255],intensity:1},rz=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Ude=[0,0,0,200/255];class oO extends nz{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=Ude,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=av.getDefaultProgramManager(e),sO&&this.programManager.addDefaultModule(sO)),this.dummyShadowMap||(this.dummyShadowMap=new xa(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(sO),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new Yn).lookAt({eye:new mo(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new Sde(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new ez(jde),this.directionalLights.push(new tz(rz[0]),new tz(rz[1])))}}let zde=1,Hde=1;class sz{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=zde++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=Hde++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class Gde{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=mS(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class $de{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new Gde(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const Wde=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},rO],qde=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Yde(n){const e=av.getDefaultProgramManager(n);for(const t of Wde)e.addDefaultModule(t);for(const t of qde)e.addShaderHook(t);return e}const Qde=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class Zde{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new $de({gl:e,protocol:"deck://"}),this.context=jn(ht({},Qde),{layerManager:this,gl:e,deck:t,programManager:e&&Yde(e),stats:i||new EM({id:"deck.gl"}),viewport:r||new kg({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new sz,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){_o("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=BM(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return _o("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?Ni.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&Ni.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class Jde{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=BM(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!vv(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Ni.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(ht({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=jn(ht(ht(ht({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let d=r[a.id];a.controller&&!d&&(s=!0),(s||!a.controller)&&d&&(d.finalize(),d=null),this.controllers[a.id]=this._updateController(a,l,c,d),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class the extends JU{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:d=20,minZoom:f=0,maxPitch:p=60,minPitch:g=0,startPanLngLat:_,startZoomLngLat:x,startRotatePos:T,startBearing:q,startPitch:G,startZoom:ge,normalize:Ne}={}){Yl(Number.isFinite(s)),Yl(Number.isFinite(r)),Yl(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:d,minZoom:f,maxPitch:p,minPitch:g,normalize:Ne}),this._state={startPanLngLat:_,startZoomLngLat:x,startRotatePos:T,startBearing:q,startPitch:G,startZoom:ge},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(jn(ht({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(jn(ht({},this._viewportProps),{zoom:o}));return this._getUpdatedState(ht({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=ht({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(ht(ht(ht({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=pf(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=pf(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=Qj(t+180,360)-180),(o<-180||o>180)&&(o=Qj(o+180,360)-180);const a=lI(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=Yd([0,l])[1];if(i<c)i=c;else{const d=Yd([0,512-l])[1];i>d&&(i=d)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return pf(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=pf(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let d=0;return r>0?Math.abs(l-o)>5&&(d=r/(o-l)*1.2):r<0&&o>5&&(d=1-s/o),d=Math.min(1,Math.max(-1,d)),{deltaScaleX:c,deltaScaleY:d}}}class nhe extends nO{constructor(e){e.dragMode=e.dragMode||"pan",super(the,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(ht(ht({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let ihe=(()=>{class n extends tO{constructor(t){super(jn(ht({},t),{type:hU}))}get controller(){return this._getControllerProps({type:nhe})}}return n.displayName="MapView",n})();const rhe=new oO;class she{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!vv(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof oO)||this._internalEffects.push(rhe)}}class ohe extends iO{}const az={blendFunc:[1,0,32771,0],blendEquation:32774};class lz extends iO{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:d},pass:f="picking",redrawReason:p,pickZ:g}){const _=this.gl;return this.pickZ=g,ql(_,jn(ht({scissorTest:!0,scissor:[a,l,c,d],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},az),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:f,redrawReason:p})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:jn(ht({},az),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return ht(ht({},e.props.parameters),i)}}class lhe{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new ohe(e),this.pickLayersPass=new lz(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||Ts.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(jn(ht({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,_o("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Ts(this.gl),new Ts(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const che={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function uhe({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let d=r*r,f=-1,p=0;for(let g=0;g<c;g++){const _=g+a-i,x=_*_;if(x>d)p+=4*l;else for(let T=0;T<l;T++){if(n[p+3]-1>=0){const G=T+o-t,ge=G*G+x;ge<=d&&(d=ge,f=p)}p+=4}}if(f>=0){const g=n[f+3]-1,_=n.slice(f,f+4),x=e[g];if(x){const T=x.decodePickingColor(_),q=Math.floor(f/4/l);return{pickedColor:_,pickedLayer:x,pickedObjectIndex:T,pickedX:o+(f/4-q*l),pickedY:a+q}}Ni.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return che}function cz({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,d=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(p=>i({layer:l,viewport:p,isPicking:!0,renderPass:"picking:".concat(e)}))),f=d&&d.unproject([s-d.x,o-d.y],{targetZ:a});return{color:null,layer:null,viewport:d,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:f,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function hhe(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const f=t.index,p=t.layerId,g=o&&o.props.id;if(g!==p||a!==f){if(g!==p){const _=r.find(x=>x.props.id===p);_&&l.unshift(_)}t.layerId=g,t.index=a,t.info=null}}const c=cz(n),d=new Map;return d.set(null,c),l.forEach(f=>{let p=ht({},c);f===o&&(p.color=s,p.index=a,p.picked=!0),p=uz({layer:f,info:p,mode:i}),f===o&&"hover"===i&&(t.info=p),d.set(p.layer.id,p),"hover"===i&&p.layer.updateAutoHighlight(p)}),d}function uz({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class phe{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new lz(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(p=>p.id===o):null,c=a&&r.find(p=>p.id===a)||r[0],d=c&&c.unproject([e-c.x,t-c.y]),f={x:e,y:t,viewport:c,coordinate:d,layer:l};return l?ht(ht({},s),f):Object.assign(f,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Ts(e),Ts.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Ts(e),this.depthFBO.attach({36064:new xa(e,{format:fi(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(Ni.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:d}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:cz({viewports:i,x:r,y:s})};this._resizeBuffer();const f=Eg(this.gl),p=vM(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],_=Math.round(o*f),{width:x,height:T}=this.pickingFBO,q=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceWidth:x,deviceHeight:T});let G;const ge=[],Ne={};for(let Ge=0;Ge<a;Ge++){const dt=uhe({pickedColors:q&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:d,deviceRect:q,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:_,deviceRect:q});let Mt;if(dt.pickedLayer&&c&&this.depthFBO&&(Mt=this._drawAndSample({layers:[dt.pickedLayer],views:t,viewports:i,onViewportActive:d,deviceRect:{x:dt.pickedX,y:dt.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),dt.pickedColor&&Ge+1<a){const Ot=dt.pickedColor[3]-1;Ne[Ot]=!0,e[Ot].disablePickingIndex(dt.pickedObjectIndex)}G=hhe({pickInfo:dt,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:Mt,pixelRatio:f});for(const Ot of G.values())Ot.layer&&ge.push(Ot);if(!dt.pickedColor)break}for(const Ge in Ne)e[Ge].restorePickingColors();return{result:ge,emptyInfo:G&&G.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:d}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const f=Eg(this.gl),p=vM(this.gl,[r,s],!0),g=p.x,_=p.y+p.height,x=vM(this.gl,[r+o,s+a],!0),q=x.y,Ne=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):Ni.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:d,deviceRect:{x:g,y:q,width:x.x+x.width-g,height:_-q},pass:"picking:".concat(l),redrawReason:l}),layers:e}),Ge=new Map,We=Number.isFinite(c);for(let dt=0;dt<Ne.length&&!(We&&Ge.size>=c);dt++){const Mt=Ne[dt];let Ot={color:Mt.pickedColor,layer:null,index:Mt.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:f};Ot=uz({layer:Mt.pickedLayer,info:Ot,mode:l}),Ge.has(Ot.object)||Ge.set(Ot.object,Ot)}return Array.from(Ge.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:d,y:f,width:p,height:g}=s,_=new(l?Float32Array:Uint8Array)(p*g*4);return jE(c,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:_}),_}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const ghe={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class mhe{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,ghe),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function dz(n,e){if(!n)throw new Error(e)}const zc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},hz=zc.global||zc.self||zc.window,yhe="object"!=typeof process||"[object process]"!==String(process)||process.browser,fz="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:vhe}=(fz&&parseFloat(fz[1]),hz),aO="undefined"!=typeof Image,lO="undefined"!=typeof ImageBitmap,bhe=Boolean(vhe),cO=!!yhe||bhe;function pz(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function gz(n){switch(pz(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const She=/^data:image\/svg\+xml/,Che=/\.svg((\?|#).*)?$/;function uO(n){return n&&(She.test(n)||Che.test(n))}function xhe(n,e){if(uO(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return _z(n,e)}function _z(n,e){if(uO(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function yz(n,e,t){return dO.apply(this,arguments)}function dO(){return(dO=ei(function*(n,e,t){const i=xhe(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield Ahe(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function Ahe(n,e){return hO.apply(this,arguments)}function hO(){return(hO=ei(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const The={};let vz=!0;function Dhe(n,e,t){return fO.apply(this,arguments)}function fO(){return(fO=ei(function*(n,e,t){let i;i=uO(t)?yield yz(n,e,t):_z(n,t);const r=e&&e.imagebitmap;return yield Mhe(i,r)})).apply(this,arguments)}function Mhe(n){return pO.apply(this,arguments)}function pO(){return(pO=ei(function*(n,e=null){if((Ihe(e)||!vz)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),vz=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function Ihe(n){for(const e in n||The)return!1;return!0}const Hc=!1,wv=!0;function gO(n){const e=Ev(n);return function(n){const e=Ev(n);return e.byteLength>=24&&2303741511===e.getUint32(0,Hc)?{mimeType:"image/png",width:e.getUint32(16,Hc),height:e.getUint32(20,Hc)}:null}(e)||function(n){const e=Ev(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,Hc)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Hc);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Hc),width:e.getUint16(s+7,Hc)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,Hc)}return null}(e)||function(n){const e=Ev(n);return e.byteLength>=10&&1195984440===e.getUint32(0,Hc)?{mimeType:"image/gif",width:e.getUint16(6,wv),height:e.getUint16(8,wv)}:null}(e)||function(n){const e=Ev(n);return e.byteLength>=14&&16973===e.getUint16(0,Hc)&&e.getUint32(2,wv)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,wv),height:e.getUint32(22,wv)}:null}(e)}function Ev(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function Lhe(n,e){const{mimeType:t}=gO(n)||{},{_parseImageNode:i}=hz;return dz(i),i(n,t,e)}function mO(){return(mO=ei(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(Bhe(r)){case"imagebitmap":a=yield Dhe(n,e,s);break;case"image":a=yield yz(n,e,s);break;case"data":a=yield Lhe(n,e);break;default:dz(!1)}return"data"===r&&(a=gz(a)),a})).apply(this,arguments)}function Bhe(n){switch(n){case"auto":case"data":return function(){if(lO)return"imagebitmap";if(aO)return"image";if(cO)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return lO||aO||cO;case"imagebitmap":return lO;case"image":return aO;case"data":return cO;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const bz={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return mO.apply(this,arguments)},tests:[n=>Boolean(gO(new DataView(n)))],options:{image:{type:"auto",decode:!0}}},jhe={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},Sv="8.5.8",SS=Er.CO.deck&&Er.CO.deck.VERSION;if(SS&&SS!==Sv)throw new Error("deck.gl - multiple versions detected: ".concat(SS," vs ").concat(Sv));SS||(Ni.log(1,"deck.gl ".concat(Sv))(),Er.CO.deck=Object.assign(Er.CO.deck||{},{VERSION:Sv,version:Sv,log:Ni,_registerLoggers:function(n){zM=n}}),GU([jhe,[bz,{imagebitmap:{premultiplyAlpha:"none"}}]]));const Uhe=Er.CO.deck;class CS extends Ou{static isSupported(e,t=[]){const i=fi(e),r=NV(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:nn(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return CS.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const wz=(0,Er.jU)()&&"undefined"!=typeof document;let Qhe=0;class Zhe{constructor(e={}){const{onCreateContext:t=(T=>pV(T)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:d=!1,createFramebuffer:f=!1,autoResizeViewport:p=!0,autoResizeDrawingBuffer:g=!0,stats:_=hf.get("animation-loop-"+Qhe++)}=e;let{useDevicePixels:x=!0}=e;"useDevicePixelRatio"in e&&(dn.deprecated("useDevicePixelRatio","useDevicePixels")(),x=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:d,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=_,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:p,autoResizeDrawingBuffer:g,useDevicePixels:x}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return nn("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=CS.isSupported(this.gl,["timers"])?new CS(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return ei(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return dn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=wz?new Promise((e,t)=>{wz&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?wM(this.props.gl,e):this.onCreateContext(e),!BE(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){Iu(n,yM)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(dn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(dn.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Ts(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Jhe=tt(524),xS=tt.n(Jhe);const efe={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})(xS().PointerEventInput),function(n){n.prototype.handler=function(t){let i=efe[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(xS().MouseInput);const rfe=xS().Manager,Gc=xS(),sfe=Gc?[[Gc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Gc.Rotate,{enable:!1}],[Gc.Pinch,{enable:!1}],[Gc.Swipe,{enable:!1}],[Gc.Pan,{threshold:0,enable:!1}],[Gc.Press,{enable:!1}],[Gc.Tap,{event:"doubletap",taps:2,enable:!1}],[Gc.Tap,{event:"anytap",enable:!1}],[Gc.Tap,{enable:!1}]]:null,Cz={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},ofe={doubletap:["tap"]},afe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},yO={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},lfe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},xz={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},cfe="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",jg="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let Az=!1;try{const n={get passive(){return Az=!0,!0}};jg.addEventListener("test",n,n),jg.removeEventListener("test",n,n)}catch(n){}const ufe=-1!==cfe.indexOf("firefox"),{WHEEL_EVENTS:dfe}=yO,Dz=4.000244140625;class pfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=dfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!Az&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;jg.WheelEvent&&(ufe&&e.deltaMode===jg.WheelEvent.DOM_DELTA_PIXEL&&(t/=jg.devicePixelRatio),e.deltaMode===jg.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%Dz==0&&(t=Math.floor(t/Dz)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:gfe}=yO,Mz="pointermove",Iz="pointerover",Oz="pointerout",Rz="pointerleave";class mfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=gfe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Mz&&(this.enableMoveEvent=t),e===Iz&&(this.enableOverEvent=t),e===Oz&&(this.enableOutEvent=t),e===Rz&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:Iz,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:Oz,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:Rz,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:Mz,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:_fe}=yO,Nz="keydown";class yfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=_fe.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===Nz&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:Nz,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const Fz="contextmenu";class vfe{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===Fz&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:Fz,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const bfe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},Lz={srcElement:"root",priority:0};class Rfe{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},Lz,i):Lz;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let d=l.length-1;for(;d>=0&&!(l[d].priority>=c.priority);)d--;l.splice(d+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:d,once:f}=i[l];if(d(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),f&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:d}=a[l];this.remove(c,d)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=bfe[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const Nfe={events:null,recognizers:null,recognizerOptions:{},Manager:rfe,touchAction:"none",tabIndex:0};class Pfe{constructor(e=null,t={}){this.options=Object.assign({},Nfe,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||sfe}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(Cz).forEach(r=>{const s=this.manager.get(r);s&&Cz[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new pfe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new mfe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new yfe(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new vfe(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=ofe[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const d in e)this._addEventHandler(d,e[d],i,r,s);return}const{manager:o,events:a}=this,l=xz[e]||e;let c=a.get(l);c||(c=new Rfe(this),a.set(l,c),c.recognizerName=lfe[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(xz[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=afe[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function vf(){}const kz={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:vf,onResize:vf,onViewStateChange:vf,onInteractionStateChange:vf,onBeforeRender:vf,onAfterRender:vf,onLoad:vf,onError:(n,e)=>Ni.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class TS{constructor(e){e=ht(ht({},kz),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&Ni.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Er.qs)()&&Ni.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new EM({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Jy.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Ni.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Ni.removed("onLayerClick","onClick")(),e.initialViewState&&!vv(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](ht({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),Yl(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:d,autoResizeDrawingBuffer:f}=e;return new Zhe({width:t,height:i,useDevicePixels:d,autoResizeDrawingBuffer:f,autoResizeViewport:!1,gl:r,onCreateContext:p=>pV(jn(ht(ht({},s),p),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:p=>this._setGLContext(p.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new ihe({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,wM(e,{enable:!0,copyState:!0})),this.tooltip=new mhe(this.canvas),Iu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new sz;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Pfe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in ZB)this.eventManager.on(r,this._onEvent);this.viewManager=new Jde({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new Zde(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new she,this.deckRenderer=new lhe(e),this.deckPicker=new phe(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;Iu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(ht({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Ni.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=jn(ht({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=ZB[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=hf.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}TS.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(nz)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},TS.defaultProps=kz,TS.VERSION=Uhe.VERSION;const Bz={name:"project32",dependencies:[rO],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Vz="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",kfe={lightSources:{}};function wO({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const EO={name:"lights",vs:Vz,fs:Vz,getUniforms:function jz(n=kfe){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?wO(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=wO(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=wO(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return jz({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Vfe={};const Ufe={name:"phong-lighting",dependencies:[EO],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=Vfe){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},Hfe={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},Hz=ht({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=Hfe){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),Gz={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class DS{static get DRAW_MODE(){return Gz}constructor(e={}){const{id:t=Lc("geometry"),drawMode:i=Gz.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?ht({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,nn(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(nn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return nn(Number.isFinite(i)),i}}const SO=Math.PI/180,MS=new Float32Array(16),$z=new Float32Array(12);function Wz(n,e,t){const i=e[0]*SO,r=e[1]*SO,s=e[2]*SO,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),d=Math.cos(i),f=Math.cos(r),p=t[0],g=t[1],_=t[2];n[0]=p*f*d,n[1]=p*l*d,n[2]=p*-a,n[3]=g*(-l*c+f*a*o),n[4]=g*(f*c+l*a*o),n[5]=g*d*o,n[6]=_*(l*o+f*a*c),n[7]=_*(-f*o+l*a*c),n[8]=_*d*c}function qz(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const Yz={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,d=Array.isArray(s),f=Array.isArray(r),p=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:f&&d&&p;const _=n.value;if(n.constant){let x;g?(MS.set(a),x=qz(MS)):(x=$z,Wz(x,r,s),x.set(o,9)),n.value=new Float32Array(x)}else{let x=e*n.size;const{iterable:T,objectInfo:q}=qV(i,e,t);for(const G of T){let ge;q.index++,g?(MS.set(c?a:a(G,q)),ge=qz(MS)):(ge=$z,Wz(ge,f?r:r(G,q),d?s:s(G,q)),ge.set(p?o:o(G,q),9)),_[x++]=ge[0],_[x++]=ge[1],_[x++]=ge[2],_[x++]=ge[3],_[x++]=ge[4],_[x++]=ge[5],_[x++]=ge[6],_[x++]=ge[7],_[x++]=ge[8],_[x++]=ge[9],_[x++]=ge[10],_[x++]=ge[11]}}}};function Kz(n,e){return e===Mi.CARTESIAN||e===Mi.METER_OFFSETS||e===Mi.DEFAULT&&!n.isGeospatial}function Xz(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),Ni.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function qfe(n,e){if(n.attributes)return Xz(n.attributes,e),n instanceof DS?n:new DS(n);if(n.positions||n.POSITION)return Xz(n,e),new DS({attributes:n});throw Error("Invalid mesh")}const Yfe={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let Kfe=(()=>{class n extends eO{getShaders(){const t=!fi(this.context.gl),i={};return RM(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[Bz,Ufe,Hz],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:Yz}),this.setState({emptyTexture:new xa(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||Kz(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new eS(this.context.gl,jn(ht({},this.getShaders()),{id:this.props.id,geometry:qfe(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=Yfe,n})();const Qz={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[EO]};class Ug{constructor(e={}){const{id:t}=e;this.id=t||Lc(this.constructor.name),this.display=!0,this.position=new mo,this.rotation=new mo,this.scale=new mo(1,1,1),this.matrix=new Yn,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return nn(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return nn(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return nn(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){nn(e),t=t||this.matrix;const i=new Yn(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class Cv extends Ug{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;dn.assert(t.every(i=>i instanceof Ug),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new Yn}={}){const i=new Yn(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof Cv?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function Zz(){var n=new ra(4);return ra!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Jz(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function e4(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],d=t[3];return n[0]=i*d+o*a+r*c-s*l,n[1]=r*d+o*l+s*a-i*c,n[2]=s*d+o*c+i*l-r*a,n[3]=o*d-i*a-r*l-s*c,n}var n4=Wj,upe=function(){var n=kV(),e=BV(1,0,0),t=BV(0,1,0);return function(i,r,s){var o=VV(r,s);return o<-.999999?(HE(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&HE(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),Jz(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(HE(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();Zz(),Zz(),function(){var n=new ra(9);ra!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const dpe=[0,0,0,1],fpe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ppe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function s4(n){if(!n._animation){const e=ppe[n.componentType],t=fpe[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const gpe=new Yn,CO=new class extends PM{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return function(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}}(this,e),this.check()}identity(){return function(n){n[0]=0,n[1]=0,n[2]=0,n[3]=1}(this),this.check()}fromAxisRotation(e,t){return Jz(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Zs(e)}get y(){return this[1]}set y(e){this[1]=Zs(e)}get z(){return this[2]}set z(e){this[2]=Zs(e)}get w(){return this[3]}set w(e){this[3]=Zs(e)}len(){return function(n){return Math.hypot(n[0],n[1],n[2],n[3])}(this)}lengthSquared(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r}(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}(this,e)}rotationTo(e,t){return upe(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return function(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3]}(this,this,e),this.check()}calculateW(){return function(n,e){var t=e[0],i=e[1],r=e[2];n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r))}(this,this),this.check()}conjugate(){return function(n,e){n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3]}(this,this),this.check()}invert(){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a}(this,this),this.check()}lerp(e,t,i){return function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a)}(this,e,t,i),this.check()}multiplyRight(e,t){return Nu(!t),e4(this,this,e),this.check()}multiplyLeft(e,t){return Nu(!t),e4(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a}(this,this,e),this.check()}rotateY(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a}(this,this,e),this.check()}rotateZ(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a}(this,this,e),this.check()}scale(e){return n4(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=dpe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return function(n,e,t,i){var p,g,_,x,T,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],d=t[2],f=t[3];(g=r*l+s*c+o*d+a*f)<0&&(g=-g,l=-l,c=-c,d=-d,f=-f),1-g>ur?(p=Math.acos(g),_=Math.sin(p),x=Math.sin((1-i)*p)/_,T=Math.sin(i*p)/_):(x=1-i,T=i),n[0]=x*r+T*l,n[1]=x*s+T*c,n[2]=x*o+T*d,n[3]=x*a+T*f}(this,e,t,i),this.check()}transformVector4(e,t=e){return function(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],d=c*i+a*s-l*r,f=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;n[0]=d*c+g*-o+f*-l-p*-a,n[1]=f*c+g*-a+p*-o-d*-l,n[2]=p*c+g*-l+d*-a-f*-o,n[3]=e[3]}(t,e,this),zE(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}};class wpe{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(p=>p>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:dn.warn(`Bad animation path ${s}`)()}nn(r[s].length===i[c].length);const d=e[c],f=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":f>d&&function(n,e,t,i,r){if("rotation"===e){CO.slerp({start:t,target:i,ratio:r});for(let s=0;s<CO.length;s++)n[e][s]=CO[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-d)/(f-d));break;case"CUBICSPLINE":f>d&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,d=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*d}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:f-d,ratio:(a-d)/(f-d)});break;default:dn.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=gpe.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class Epe{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:s4(e.accessors[a]),interpolation:l,output:s4(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new wpe({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class Spe extends Ug{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof eS?(this.model=e,this._setModelNodeProps(t)):this.model=new eS(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class Cpe{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},RM(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new xa(this.gl,ht({id:e.name||e.id,parameters:ht(ht({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(dn.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function o4(n,e){return fi(n)?`#version 300 es\n${e}`:e}const Dpe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mpe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Ipe{constructor(e,t={}){this.gl=e,this.options=Object.assign({},Mpe,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new Epe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new Cv({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new Cv({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new Yn).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new Cv({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){dn.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new Cpe(n,e);dn.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(d=>d.buffer));const c=new Spe(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[Qz],defines:a.defines,parameters:a.parameters,vs:o4(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:o4(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),dn.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new tr(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new ia({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Dpe[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function a4(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Ma(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function l4(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function c4(n,e,t){const i=n.bufferViews[t];Ma(i);const s=e[i.buffer];return Ma(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const u4={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class zg{constructor(e,t){Gn(this,"fields",void 0),Gn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new zg(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new zg(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof zg){const o=e;t=o.fields,i=d4(d4(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new zg(s,i)}}function d4(n,e){return new Map([...n||new Map,...e||new Map])}let Or,h4,f4,p4,g4,m4,_4,y4;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(Or||(Or={}));class xO{static isNull(e){return e&&e.typeId===Or.Null}static isInt(e){return e&&e.typeId===Or.Int}static isFloat(e){return e&&e.typeId===Or.Float}static isBinary(e){return e&&e.typeId===Or.Binary}static isUtf8(e){return e&&e.typeId===Or.Utf8}static isBool(e){return e&&e.typeId===Or.Bool}static isDecimal(e){return e&&e.typeId===Or.Decimal}static isDate(e){return e&&e.typeId===Or.Date}static isTime(e){return e&&e.typeId===Or.Time}static isTimestamp(e){return e&&e.typeId===Or.Timestamp}static isInterval(e){return e&&e.typeId===Or.Interval}static isList(e){return e&&e.typeId===Or.List}static isStruct(e){return e&&e.typeId===Or.Struct}static isUnion(e){return e&&e.typeId===Or.Union}static isFixedSizeBinary(e){return e&&e.typeId===Or.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Or.FixedSizeList}static isMap(e){return e&&e.typeId===Or.Map}static isDictionary(e){return e&&e.typeId===Or.Dictionary}get typeId(){return Or.NONE}compareTo(e){return this===e}}Symbol,Symbol,h4=Symbol.toStringTag;class Hg extends xO{constructor(e,t){super(),Gn(this,"isSigned",void 0),Gn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Or.Int}get[h4](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class jpe extends Hg{constructor(){super(!0,8)}}class Upe extends Hg{constructor(){super(!0,16)}}class zpe extends Hg{constructor(){super(!0,32)}}class Hpe extends Hg{constructor(){super(!1,8)}}class Gpe extends Hg{constructor(){super(!1,16)}}class $pe extends Hg{constructor(){super(!1,32)}}f4=Symbol.toStringTag;class v4 extends xO{constructor(e){super(),Gn(this,"precision",void 0),this.precision=e}get typeId(){return Or.Float}get[f4](){return"Float"}toString(){return`Float${this.precision}`}}class Wpe extends v4{constructor(){super(32)}}class qpe extends v4{constructor(){super(64)}}Symbol,Symbol,p4=Symbol.toStringTag,g4=Symbol.toStringTag,m4=Symbol.toStringTag,_4=Symbol.toStringTag,y4=Symbol.toStringTag;class Ype extends xO{constructor(e,t){super(),Gn(this,"listSize",void 0),Gn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Or.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[y4](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class OS{constructor(e,t,i=!1,r=new Map){Gn(this,"name",void 0),Gn(this,"type",void 0),Gn(this,"nullable",void 0),Gn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new OS(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function b4(n,e,t){const i=t?w4(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new jpe;case Uint8Array:return new Hpe;case Int16Array:return new Upe;case Uint16Array:return new Gpe;case Int32Array:return new zpe;case Uint32Array:return new $pe;case Float32Array:return new Wpe;case Float64Array:return new qpe;default:throw new Error("array type not supported")}}(e.value);return new OS(n,new Ype(e.size,new OS("value",r)),!1,i)}function w4(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const E4={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Zpe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class ege{constructor(e){Gn(this,"draco",void 0),Gn(this,"decoder",void 0),Gn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const p=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(p)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const d=a[c],f=a[c+1],p=a[c+2];e=d<e?d:e,t=f<t?f:t,i=p<i?p:i,r=d>r?d:r,s=f>s?f:s,o=p>o?p:o}return[[e,t,i],[r,s,o]]}(l.attributes),d=function(n,e,t){const i=w4(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=b4(o,n[o],s[o]);r.push(l)}if(t){const o=b4("indices",t);r.push(o)}return new zg(r,i)}(l.attributes,a,l.indices);return jn(ht({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:d})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=Zpe[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const d=this.draco._malloc(a);try{const f=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,f,l,a,d),c=new i(this.draco.HEAPF32.buffer,d,o).slice()}finally{this.draco._free(d)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in E4)if(this.draco[o]===r)return E4[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var RS=tt(125);const MO={};function IO(n){return OO.apply(this,arguments)}function OO(){return(OO=ei(function*(n,e=null,t={}){return e&&(n=sge(n,e,t)),MO[n]=MO[n]||oge(n),yield MO[n]})).apply(this,arguments)}function sge(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:OI?t.CDN?(Vc(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):RI?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function oge(n){return RO.apply(this,arguments)}function RO(){return(RO=ei(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():OI?RI?importScripts(n):age(yield(yield fetch(n)).text(),n):RS.requireFromFile&&(yield RS.requireFromFile(n))})).apply(this,arguments)}function age(n,e){if(!OI)return RS.requireFromString&&RS.requireFromString(n,e);if(RI)return eval.call(Zce,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const lge="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",cge="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",uge="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let xv;function hge(n){return NO.apply(this,arguments)}function NO(){return(NO=ei(function*(n){const e=n.modules||{};return xv=e.draco3d?xv||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):xv||fge(n),yield xv})).apply(this,arguments)}function fge(n){return FO.apply(this,arguments)}function FO(){return(FO=ei(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield IO(lge,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield IO(cge,"draco",n),yield IO(uge,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield pge(e,t)})).apply(this,arguments)}function pge(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(jn(ht({},t),{onModuleLoaded:r=>i({draco:r})}))})}const kO=jn(ht({},u4),{parse:function(n,e){return BO.apply(this,arguments)}});function BO(){return(BO=ei(function*(n,e){const{draco:t}=yield hge(e),i=new ege(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function Tv(n,e){return _f(n>=0),_f(e>0),n+(e-1)&~(e-1)}function _ge(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+Tv(i.byteLength,4)}const S4=["SCALAR","VEC2","VEC3","VEC4"],yge=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],vge=new Map(yge),bge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wge={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ege={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function C4(n){return S4[n-1]||S4[0]}function x4(n){const e=vge.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function A4(n,e){const t=Ege[n.componentType],i=bge[n.type],s=n.count*i,o=n.count*i*wge[n.componentType];return Ma(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const Sge={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class Jd{constructor(e){Gn(this,"gltf",void 0),Gn(this,"sourceBuffers",void 0),Gn(this,"byteLength",void 0),this.gltf=e||{json:ht({},Sge),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return Ma(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=A4(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return Ma(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Ma(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=gO(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Ma(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Tv(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:C4(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:x4(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=_ge(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const T4="KHR_binary_glTF",Dv="KHR_draco_mesh_compression",Gg="KHR_lights_punctual",PS="KHR_materials_unlit",FS="KHR_techniques_webgl";function Age(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=D4(i);e[t]=r}}return e}function D4(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:C4(t),componentType:x4(e)}}function Mge(n,e,t){return VO.apply(this,arguments)}function VO(){return(VO=ei(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new Jd(n),s=[];for(const o of Pge(r))r.getObjectExtension(o,Dv)&&s.push(Oge(r,o,e,t));yield Promise.all(s),r.removeExtension(Dv)})).apply(this,arguments)}function Ige(n,e={}){const t=new Jd(n);for(const i of t.json.meshes||[])Rge(i),t.addRequiredExtension(Dv)}function Oge(n,e,t,i){return jO.apply(this,arguments)}function jO(){return(jO=ei(function*(n,e,t,i){const r=n.getObjectExtension(e,Dv);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=jU(s.buffer,s.byteOffset),{parse:a}=i,l=ht({},t);delete l["3d-tiles"];const c=yield a(o,kO,l,i),d=Age(c.attributes);for(const[f,p]of Object.entries(d))if(f in e.attributes){const _=n.getAccessor(e.attributes[f]);null!=_&&_.min&&null!=_&&_.max&&(p.min=_.min,p.max=_.max)}e.attributes=d,c.indices&&(e.indices=D4(c.indices)),Nge(e)})).apply(this,arguments)}function Rge(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[Dv]:{bufferView:c,attributes:l}}}]}}function Nge(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Pge(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function Fge(n){return UO.apply(this,arguments)}function UO(){return(UO=ei(function*(n){const e=new Jd(n),{json:t}=e;e.removeExtension(PS);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,PS)})).apply(this,arguments)}function Lge(n){const e=new Jd(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,PS,{}),e.addExtension(PS))}function kge(n){return zO.apply(this,arguments)}function zO(){return(zO=ei(function*(n){const e=new Jd(n),{json:t}=e,i=e.getExtension(Gg);i&&(e.json.lights=i.lights,e.removeExtension(Gg));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,Gg);s&&(r.light=s.light),e.removeObjectExtension(r,Gg)}})).apply(this,arguments)}function Bge(n){return HO.apply(this,arguments)}function HO(){return(HO=ei(function*(n){const e=new Jd(n),{json:t}=e;if(t.lights){const i=e.addExtension(Gg);Ma(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,Gg,i);delete e.json.lights}})).apply(this,arguments)}function Vge(n){return GO.apply(this,arguments)}function GO(){return(GO=ei(function*(n){const e=new Jd(n),{json:t}=e,i=e.getExtension(FS);if(i){const r=Uge(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,FS);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=zge(s.technique,e)),e.removeObjectExtension(s,FS)}e.removeExtension(FS)}})).apply(this,arguments)}function jge(n,e){return $O.apply(this,arguments)}function $O(){return($O=ei(function*(n,e){})).apply(this,arguments)}function Uge(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function zge(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const M4={KHR_draco_mesh_compression:gt,KHR_materials_unlit:J,KHR_lights_punctual:xt,KHR_techniques_webgl:ut};function Hge(n){return WO.apply(this,arguments)}function WO(){return(WO=ei(function*(n,e={},t){for(const r in M4){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield M4[r].decode(n,e,t))}})).apply(this,arguments)}const I4={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},$ge={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Wge{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new Jd(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,T4);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(T4)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in I4)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in I4)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=$ge[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function qge(n,e={}){return(new Wge).normalize(n,e)}const Yge={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kge={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},hl={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Xge={magFilter:hl.TEXTURE_MAG_FILTER,minFilter:hl.TEXTURE_MIN_FILTER,wrapS:hl.TEXTURE_WRAP_S,wrapT:hl.TEXTURE_WRAP_T},Qge={[hl.TEXTURE_MAG_FILTER]:hl.LINEAR,[hl.TEXTURE_MIN_FILTER]:hl.NEAREST_MIPMAP_LINEAR,[hl.TEXTURE_WRAP_S]:hl.REPEAT,[hl.TEXTURE_WRAP_]:hl.REPEAT};class eme{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return Ma(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=ht({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=ht({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ht({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ht({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ht({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=ht({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=ht({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return Kge[n]}(e.componentType),e.components=function(n){return Yge[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=A4(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):Qge,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return Xge[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function tme(n,e){return(new eme).postProcess(n,e)}const O4=1735152710,$g=!0;function YO(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),Tv(i,4)}function KO(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),Tv(i,4)}function fme(n,e){return XO.apply(this,arguments)}function XO(){return(XO=ei(function*(n,e,t=0,i,r){var s,o,a,l;pme(n,e,t,i),qge(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield gme(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const f=mme(n,i,r);c.push(f)}const d=Hge(n,i,r);return c.push(d),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?tme(n,i):n})).apply(this,arguments)}function pme(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=O4}=t,s=i.getUint32(e,!1);return s===r||s===O4}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?a4(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?a4(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,$g),a=r.getUint32(t+8,$g);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){_f(n.header.byteLength>20);const i=e.getUint32(t+0,$g),r=e.getUint32(t+4,$g);return t+=8,_f(0===r),YO(n,e,t,i),(t+=i)+KO(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return _f(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,$g),s=e.getUint32(t+4,$g);switch(t+=8,s){case 1313821514:YO(n,e,t,r);break;case 5130562:KO(n,e,t,r);break;case 0:i.strict||YO(n,e,t,r);break;case 1:i.strict||KO(n,e,t,r)}t+=Tv(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),Ma("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else Ma(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function gme(n,e,t){return QO.apply(this,arguments)}function QO(){return(QO=ei(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;Ma(a);const l=l4(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),d=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:d,byteOffset:0,byteLength:d.byteLength},delete o.uri}}})).apply(this,arguments)}function mme(n,e,t){return ZO.apply(this,arguments)}function ZO(){return(ZO=ei(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(_me(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function _me(n,e,t,i,r){return JO.apply(this,arguments)}function JO(){return(JO=ei(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=l4(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=c4(n.json,n.buffers,e.bufferView);a=jU(c.buffer,c.byteOffset,c.byteLength)}Ma(a,"glTF image has no data");const l=yield o(a,bz,{},r);n.images[t]=l})).apply(this,arguments)}const Wg={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return eR.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function eR(){return(eR=ei(function*(n,e={},t){(e=ht(ht({},Wg.options),e)).gltf=ht(ht({},Wg.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield fme({},n,i,e,t)})).apply(this,arguments)}function tR(){return(tR=ei(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield bme(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function bme(n){return nR.apply(this,arguments)}function nR(){return(nR=ei(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const R4=[255,255,255,255],Sme={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:R4},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Wg]};let Cme=(()=>{class n extends eO{getShaders(){const t=[Bz,Hz];return"pbr"===this.props._lighting&&t.push(Qz),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:R4,transition:!0},instanceModelMatrix:Yz})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof Ug)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new Ipe(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=ht({gltf:l},c),function(n){return tR.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Ni.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof Ug?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&Ni.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):Ni.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):Ni.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof Ug&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:ht({isInstanced:!0,transpileToGLSL100:!fi(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:d}=this.props,f=this.getNumInstances();this.state.scenegraph.traverse((p,{worldMatrix:g})=>{p.model.setInstanceCount(f),p.updateModuleSettings(t),p.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:Kz(s,d),sceneModelMatrix:g,u_Camera:p.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=Sme,n})();const xme=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Ame=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),Tme=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),Dme=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),Mme={POSITION:{size:3,value:new Float32Array(Ame)},NORMAL:{size:3,value:new Float32Array(Tme)},TEXCOORD_0:{size:2,value:new Float32Array(Dme)}};class Ime extends DS{constructor(e={}){const{id:t=Lc("cube-geometry")}=e;super(jn(ht({},e),{id:t,indices:{size:1,value:new Uint16Array(xme)},attributes:ht(ht({},Mme),e.attributes)}))}}class $c{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new le){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new le){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new $c){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],d=i[4],f=i[5],p=i[6],g=i[7],_=i[8],x=r[0],T=r[1],q=r[2],G=r[3],ge=r[4],Ne=r[5],Ge=r[6],We=r[7],dt=r[8];return s[0]=o*x+a*G+l*Ge,s[1]=o*T+a*ge+l*We,s[2]=o*q+a*Ne+l*dt,s[3]=c*x+d*G+f*Ge,s[4]=c*T+d*ge+f*We,s[5]=c*q+d*Ne+f*dt,s[6]=p*x+g*G+_*Ge,s[7]=p*T+g*ge+_*We,s[8]=p*q+g*Ne+_*dt,t}scale(e,t=new $c){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new le){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let d,p;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){d=4;do{p=4-d,s[p+4*o]+=s[p+4*a]}while(--d);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];d=4;do{p=4-d,s[p+4*a]=p<=o?0:s[p+4*a]-s[p+4*o]*g}while(--d)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new $c){const r=Ome;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,f;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{f=6-c,r[f+6*s]+=r[f+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const p=r[s+6*o]/r[s+6*s];c=6;do{f=6-c,r[f+6*o]=f<=s?0:r[f+6*o]-r[f+6*s]*p}while(--c)}}while(--a);s=2;do{o=s-1;do{const p=r[s+6*o]/r[s+6*s];c=6;do{f=6-c,r[f+6*o]=r[f+6*o]-r[f+6*s]*p}while(--c)}while(o--)}while(--s);s=2;do{const p=1/r[s+6*s];c=6;do{f=6-c,r[f+6*s]=r[f+6*s]*p}while(--c)}while(s--);s=2;do{o=2;do{if(f=r[3+o+6*s],isNaN(f)||f===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,f)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,d=t*a,f=t*l,p=i*a,g=i*l,_=r*l,x=s*o,T=s*a,q=s*l,G=this.elements;return G[0]=1-(p+_),G[1]=d-q,G[2]=f+T,G[3]=d+q,G[4]=1-(c+_),G[5]=g-x,G[6]=f-T,G[7]=g+x,G[8]=1-(c+p),this}transpose(e=new $c){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const Ome=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class le{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new le(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new le(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new $c([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new le){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new le){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new le){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new le){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new le){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=Rme,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=Nme;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(N4),N4.almostEquals(e,t)}clone(){return new le(this.x,this.y,this.z)}}le.ZERO=void 0,le.UNIT_X=void 0,le.UNIT_Y=void 0,le.UNIT_Z=void 0,le.ZERO=new le(0,0,0),le.UNIT_X=new le(1,0,0),le.UNIT_Y=new le(0,1,0),le.UNIT_Z=new le(0,0,1);const Rme=new le,Nme=new le,N4=new le;class sr{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new le,this.upperBound=new le,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,P4),c=P4),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new sr).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,d=this.upperBound;e.copy(c),t.set(d.x,c.y,c.z),i.set(d.x,d.y,c.z),r.set(c.x,d.y,d.z),s.set(d.x,c.y,d.z),o.set(c.x,d.y,c.z),a.set(c.x,c.y,d.z),l.copy(d)}toLocalFrame(e,t){const i=F4;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=F4;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,d=(this.upperBound.y-i.y)*s,f=(this.lowerBound.z-i.z)*o,p=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,d)),Math.min(f,p)),_=Math.min(Math.min(Math.max(a,l),Math.max(c,d)),Math.max(f,p));return!(_<0||g>_)}}const P4=new le,F4=[new le,new le,new le,new le,new le,new le,new le,new le];class ns{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new le){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=Fme;e.tangents(i,Lme),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(fr(e.length(),2)*fr(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new ns){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,d=e.w;return t.x=i*d+o*a+r*c-s*l,t.y=r*d+o*l+s*a-i*c,t.z=s*d+o*c+i*l-r*a,t.w=o*d-i*a-r*l-s*c,t}inverse(e=new ns){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new ns){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,d=c*i+a*s-l*r,f=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=d*c+g*-o+f*-l-p*-a,t.y=f*c+g*-a+p*-o-d*-l,t.z=p*c+g*-l+d*-a-f*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const d=o*a+l*c;if(d>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),d<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const f=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*d),s=Math.atan2(2*o*c-2*a*l,1-2*f-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),d=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a-l*c*d):"YXZ"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a+l*c*d):"ZXY"===r?(this.x=l*o*a-s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a-l*c*d):"ZYX"===r?(this.x=l*o*a-s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a+l*c*d):"YZX"===r?(this.x=l*o*a+s*c*d,this.y=s*c*a+l*o*d,this.z=s*o*d-l*c*a,this.w=s*o*a-l*c*d):"XZY"===r&&(this.x=l*o*a-s*c*d,this.y=s*c*a-l*o*d,this.z=s*o*d+l*c*a,this.w=s*o*a+l*c*d),this}clone(){return new ns(this.x,this.y,this.z,this.w)}slerp(e,t,i=new ns){const r=this.x,s=this.y,o=this.z,a=this.w;let p,g,_,x,T,l=e.x,c=e.y,d=e.z,f=e.w;return g=r*l+s*c+o*d+a*f,g<0&&(g=-g,l=-l,c=-c,d=-d,f=-f),1-g>1e-6?(p=Math.acos(g),_=Math.sin(p),x=Math.sin((1-t)*p)/_,T=Math.sin(t*p)/_):(x=1-t,T=t),i.x=x*r+T*l,i.y=x*s+T*c,i.z=x*o+T*d,i.w=x*a+T*f,i}integrate(e,t,i,r=new ns){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,d=this.z,f=this.w,p=.5*t;return r.x+=p*(s*f+o*d-a*c),r.y+=p*(o*f+a*l-s*d),r.z+=p*(a*f+s*c-o*l),r.w+=p*(-s*l-o*c-a*d),r}}const Fme=new le,Lme=new le,kme={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let hn=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=kme,n})();class Pi{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new le,this.quaternion=new ns,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return Pi.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return Pi.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new le){return i.vsub(e,r),t.conjugate(k4),k4.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new le){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new le){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new le){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const k4=new ns;class bf extends hn{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:hn.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new le;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let d=!1;for(let f=0;f!==i.length;f++)if(i[f].almostEquals(r)||i[f].almostEquals(r)){d=!0;break}d||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new le;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];bf.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new le,o=new le;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const d=new le;let f=-1,p=-Number.MAX_VALUE;for(let _=0;_<i.faces.length;_++){d.copy(i.faceNormals[_]),s.vmult(d,d);const x=d.dot(o);x>p&&(p=x,f=_)}const g=[];for(let _=0;_<i.faces[f].length;_++){const x=i.vertices[i.faces[f][_]],T=new le;T.copy(x),s.vmult(T,T),r.vadd(T,T),g.push(T)}f>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new le,d=new le,f=new le,p=new le,g=new le,_=new le;let x=Number.MAX_VALUE;const T=this;if(T.uniqueAxes)for(let q=0;q!==T.uniqueAxes.length;q++){i.vmult(T.uniqueAxes[q],c);const G=T.testSepAxis(c,e,t,i,r,s);if(!1===G)return!1;G<x&&(x=G,o.copy(c))}else{const q=a?a.length:T.faces.length;for(let G=0;G<q;G++){c.copy(T.faceNormals[a?a[G]:G]),i.vmult(c,c);const Ne=T.testSepAxis(c,e,t,i,r,s);if(!1===Ne)return!1;Ne<x&&(x=Ne,o.copy(c))}}if(e.uniqueAxes)for(let q=0;q!==e.uniqueAxes.length;q++){s.vmult(e.uniqueAxes[q],d);const G=T.testSepAxis(d,e,t,i,r,s);if(!1===G)return!1;G<x&&(x=G,o.copy(d))}else{const q=l?l.length:e.faces.length;for(let G=0;G<q;G++){d.copy(e.faceNormals[l?l[G]:G]),s.vmult(d,d);const Ne=T.testSepAxis(d,e,t,i,r,s);if(!1===Ne)return!1;Ne<x&&(x=Ne,o.copy(d))}}for(let q=0;q!==T.uniqueEdges.length;q++){i.vmult(T.uniqueEdges[q],p);for(let G=0;G!==e.uniqueEdges.length;G++)if(s.vmult(e.uniqueEdges[G],g),p.cross(g,_),!_.almostZero()){_.normalize();const ge=T.testSepAxis(_,e,t,i,r,s);if(!1===ge)return!1;ge<x&&(x=ge,o.copy(_))}}return r.vsub(t,f),f.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){bf.project(this,e,i,r,iR),bf.project(t,e,s,o,rR);const l=iR[0],c=iR[1],d=rR[0],f=rR[1];if(l<f||d<c)return!1;const p=l-f,g=d-c;return p<g?p:g}calculateLocalInertia(e,t){const i=new le,r=new le;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new le,c=new le,d=new le,f=new le,p=new le,g=new le,_=new le,x=new le,T=this,G=r,ge=[];let Ne=-1,Ge=Number.MAX_VALUE;for(let Lt=0;Lt<T.faces.length;Lt++){l.copy(T.faceNormals[Lt]),i.vmult(l,l);const Qt=l.dot(e);Qt<Ge&&(Ge=Qt,Ne=Lt)}if(Ne<0)return;const We=T.faces[Ne];We.connectedFaces=[];for(let Lt=0;Lt<T.faces.length;Lt++)for(let Qt=0;Qt<T.faces[Lt].length;Qt++)-1!==We.indexOf(T.faces[Lt][Qt])&&Lt!==Ne&&-1===We.connectedFaces.indexOf(Lt)&&We.connectedFaces.push(Lt);const dt=We.length;for(let Lt=0;Lt<dt;Lt++){const Qt=T.vertices[We[Lt]];Qt.vsub(T.vertices[We[(Lt+1)%dt]],c),d.copy(c),i.vmult(d,d),t.vadd(d,d),f.copy(this.faceNormals[Ne]),i.vmult(f,f),t.vadd(f,f),d.cross(f,p),p.negate(p),g.copy(Qt),i.vmult(g,g),t.vadd(g,g);const bt=We.connectedFaces[Lt];_.copy(this.faceNormals[bt]);const Ct=this.getPlaneConstantOfFace(bt);x.copy(_),i.vmult(x,x);const Ht=Ct-x.dot(t);for(this.clipFaceAgainstPlane(G,ge,x,Ht);G.length;)G.shift();for(;ge.length;)G.push(ge.shift())}_.copy(this.faceNormals[Ne]);const Mt=this.getPlaneConstantOfFace(Ne);x.copy(_),i.vmult(x,x);const Ot=Mt-x.dot(t);for(let Lt=0;Lt<G.length;Lt++){let Qt=x.dot(G[Lt])+Ot;if(Qt<=s&&(console.log("clamped: depth="+Qt+" to minDist="+s),Qt=s),Qt<=o){const Jt=G[Lt];Qt<=1e-6&&a.push({point:Jt,normal:x,depth:Qt})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let d=0;d<a;d++){if(c=e[d],o=i.dot(c)+r,s<0)if(o<0){const f=new le;f.copy(c),t.push(f)}else{const f=new le;l.lerp(c,s/(s-o),f),t.push(f)}else if(o<0){const f=new le;l.lerp(c,s/(s-o),f),t.push(f),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new le);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new le);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,d,f,p=new le;for(let g=0;g<s.length;g++){p.copy(s[g]),t.vmult(p,p),e.vadd(p,p);const _=p;(void 0===o||_.x<o)&&(o=_.x),(void 0===c||_.x>c)&&(c=_.x),(void 0===a||_.y<a)&&(a=_.y),(void 0===d||_.y>d)&&(d=_.y),(void 0===l||_.z<l)&&(l=_.z),(void 0===f||_.z>f)&&(f=_.z)}i.set(o,a,l),r.set(c,d,f)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new le){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new le;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new le;e.vsub(l,c);const d=a.dot(c),f=new le;s.vsub(l,f);const p=a.dot(f);if(d<0&&p>0||d>0&&p<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=Bme;let l=0,c=0;const d=Vme,f=e.vertices;d.setZero(),Pi.vectorToLocalFrame(i,r,t,a),Pi.pointToLocalFrame(i,r,d,d);const p=d.dot(a);c=l=f[0].dot(a);for(let g=1;g<o;g++){const _=f[g].dot(a);_>l&&(l=_),_<c&&(c=_)}if(c-=p,l-=p,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const iR=[],rR=[],Bme=new le,Vme=new le;class kS extends hn{constructor(e){super({type:hn.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=le,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new bf({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new le){return kS.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)eh.set(s[o][0],s[o][1],s[o][2]),t.vmult(eh,eh),e.vadd(eh,eh),i(eh.x,eh.y,eh.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;Wc[0].set(s.x,s.y,s.z),Wc[1].set(-s.x,s.y,s.z),Wc[2].set(-s.x,-s.y,s.z),Wc[3].set(-s.x,-s.y,-s.z),Wc[4].set(s.x,-s.y,-s.z),Wc[5].set(s.x,s.y,-s.z),Wc[6].set(-s.x,s.y,-s.z),Wc[7].set(s.x,-s.y,s.z);const o=Wc[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=Wc[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,d=l.y,f=l.z;c>r.x&&(r.x=c),d>r.y&&(r.y=d),f>r.z&&(r.z=f),c<i.x&&(i.x=c),d<i.y&&(i.y=d),f<i.z&&(i.z=f)}}}const eh=new le,Wc=[new le,new le,new le,new le,new le,new le,new le,new le];class fn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=fn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new le,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new le,this.previousPosition=new le,this.interpolatedPosition=new le,this.initPosition=new le,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new le,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new le,this.force=new le;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?fn.STATIC:fn.DYNAMIC,typeof e.type==typeof fn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=fn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new le,this.quaternion=new ns,this.initQuaternion=new ns,this.previousQuaternion=new ns,this.interpolatedQuaternion=new ns,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new le,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new le,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new le,this.invInertia=new le,this.invInertiaWorld=new $c,this.invMassSolve=0,this.invInertiaSolve=new le,this.invInertiaWorldSolve=new $c,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new le(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new le(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new sr,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new le,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=fn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===fn.SLEEPING&&this.dispatchEvent(fn.wakeupEvent)}sleep(){this.sleepState=fn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=fr(this.sleepSpeedLimit,2);t===fn.AWAKE&&i<r?(this.sleepState=fn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(fn.sleepyEvent)):t===fn.SLEEPY&&i>r?this.wakeUp():t===fn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(fn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===fn.SLEEPING||this.type===fn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new le){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new le){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new le,s=new ns;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=jme,o=Ume,a=this.quaternion,l=this.aabb,c=zme;for(let d=0;d!==r;d++){const f=e[d];a.vmult(t[d],s),s.vadd(this.position,s),a.mult(i[d],o),f.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===d?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=Hme,r=Gme;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new le){if(this.type!==fn.DYNAMIC)return;this.sleepState===fn.SLEEPING&&this.wakeUp();const i=$me;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new le){if(this.type!==fn.DYNAMIC)return;const i=Wme,r=qme;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===fn.DYNAMIC&&(this.sleepState===fn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new le){if(this.type!==fn.DYNAMIC)return;this.sleepState===fn.SLEEPING&&this.wakeUp();const i=t,r=Yme;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=Kme;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new le){if(this.type!==fn.DYNAMIC)return;const i=Xme,r=Qme;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=Zme;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),kS.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new le;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==fn.DYNAMIC&&this.type!==fn.KINEMATIC||this.sleepState===fn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,f=this.invInertiaWorld,p=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*p.x,r.y+=a.y*g*p.y,r.z+=a.z*g*p.z;const _=f.elements,x=this.angularFactor,T=l.x*x.x,q=l.y*x.y,G=l.z*x.z;s.x+=e*(_[0]*T+_[1]*q+_[2]*G),s.y+=e*(_[3]*T+_[4]*q+_[5]*G),s.z+=e*(_[6]*T+_[7]*q+_[8]*G),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}fn.idCounter=0,fn.COLLIDE_EVENT_NAME="collide",fn.DYNAMIC=1,fn.STATIC=2,fn.KINEMATIC=4,fn.AWAKE=0,fn.SLEEPY=1,fn.SLEEPING=2,fn.wakeupEvent={type:"wakeup"},fn.sleepyEvent={type:"sleepy"},fn.sleepEvent={type:"sleep"};const jme=new le,Ume=new ns,zme=new sr,Hme=new $c,Gme=new $c,$me=new le,Wme=new le,qme=new le,Yme=new le,Kme=new le,Xme=new le,Qme=new le,Zme=new le;new le,new le;class BS{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new le,this.rayToWorld=new le,this.hitNormalWorld=new le,this.hitPointWorld=new le,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let B4,V4,j4,U4,z4,H4,G4;B4=hn.types.SPHERE,V4=hn.types.PLANE,j4=hn.types.BOX,U4=hn.types.CYLINDER,z4=hn.types.CONVEXPOLYHEDRON,H4=hn.types.HEIGHTFIELD,G4=hn.types.TRIMESH;class us{get[B4](){return this._intersectSphere}get[V4](){return this._intersectPlane}get[j4](){return this._intersectBox}get[U4](){return this._intersectConvex}get[z4](){return this._intersectConvex}get[H4](){return this._intersectHeightfield}get[G4](){return this._intersectTrimesh}constructor(e=new le,t=new le){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new le,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=us.ANY,this.result=new BS,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||us.ANY,this.result=t.result||new BS,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB($4),lR.length=0,e.broadphase.aabbQuery(e,$4,lR),this.intersectBodies(lR),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=s_e,s=o_e;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,wf);const i=wf.dot(e);return e.scale(i,jS),jS.vadd(n,jS),t.distanceTo(jS)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new le(0,0,1);t.vmult(c,c);const d=new le;o.vsub(i,d);const f=d.dot(c);if(a.vsub(i,d),f*d.dot(c)>0||o.distanceTo(a)<f)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const _=new le,x=new le,T=new le;o.vsub(i,_);const q=-c.dot(_)/g;l.scale(q,x),o.vadd(x,T),this.reportIntersection(c,T,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=a_e;o.from.copy(this.from),o.to.copy(this.to),Pi.pointToLocalFrame(i,t,o.from,o.from),Pi.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=l_e;let l,c,d,f;l=c=0,d=f=e.data.length-1;const p=new sr;o.getAABB(p),e.getIndexOfPosition(p.lowerBound.x,p.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(p.upperBound.x,p.upperBound.y,a,!0),d=Math.min(d,a[0]+1),f=Math.min(f,a[1]+1);for(let g=l;g<d;g++)for(let _=c;_<f;_++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,_,p),p.overlapsRay(o)){if(e.getConvexTrianglePillar(g,_,!1),Pi.pointToWorldFrame(i,t,e.pillarOffset,VS),this._intersectConvex(e.pillarConvex,t,VS,r,s,W4),this.result.shouldStop)return;e.getConvexTrianglePillar(g,_,!0),Pi.pointToWorldFrame(i,t,e.pillarOffset,VS),this._intersectConvex(e.pillarConvex,t,VS,r,s,W4)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=fr(a.x-o.x,2)+fr(a.y-o.y,2)+fr(a.z-o.z,2),d=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),f=fr(o.x-i.x,2)+fr(o.y-i.y,2)+fr(o.z-i.z,2)-fr(l,2),p=fr(d,2)-4*c*f,g=c_e,_=u_e;if(!(p<0))if(0===p)o.lerp(a,p,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1);else{const x=(-d-Math.sqrt(p))/(2*c),T=(-d+Math.sqrt(p))/(2*c);if(x>=0&&x<=1&&(o.lerp(a,x,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1)),this.result.shouldStop)return;T>=0&&T<=1&&(o.lerp(a,T,g),g.vsub(i,_),_.normalize(),this.reportIntersection(_,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=d_e,l=q4,c=o&&o.faceList||null,d=e.faces,f=e.vertices,p=e.faceNormals,g=this.direction,_=this.from,T=_.distanceTo(this.to),q=c?c.length:d.length,G=this.result;for(let ge=0;!G.shouldStop&&ge<q;ge++){const Ne=c?c[ge]:ge,Ge=d[Ne],We=p[Ne],dt=t,Mt=i;l.copy(f[Ge[0]]),dt.vmult(l,l),l.vadd(Mt,l),l.vsub(_,l),dt.vmult(We,a);const Ot=g.dot(a);if(Math.abs(Ot)<this.precision)continue;const Lt=a.dot(l)/Ot;if(!(Lt<0)){g.scale(Lt,sa),sa.vadd(_,sa),Zl.copy(f[Ge[0]]),dt.vmult(Zl,Zl),Mt.vadd(Zl,Zl);for(let Qt=1;!G.shouldStop&&Qt<Ge.length-1;Qt++){qc.copy(f[Ge[Qt]]),Yc.copy(f[Ge[Qt+1]]),dt.vmult(qc,qc),dt.vmult(Yc,Yc),Mt.vadd(qc,qc),Mt.vadd(Yc,Yc);const Jt=sa.distanceTo(_);!us.pointInTriangle(sa,Zl,qc,Yc)&&!us.pointInTriangle(sa,qc,Zl,Yc)||Jt>T||this.reportIntersection(a,sa,s,r,Ne)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=h_e,l=y_e,c=v_e,d=q4,f=f_e,p=p_e,g=g_e,_=__e,x=m_e,T=e.indices,q=this.from,G=this.to,ge=this.direction;c.position.copy(i),c.quaternion.copy(t),Pi.vectorToLocalFrame(i,t,ge,f),Pi.pointToLocalFrame(i,t,q,p),Pi.pointToLocalFrame(i,t,G,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,p.x*=e.scale.x,p.y*=e.scale.y,p.z*=e.scale.z,g.vsub(p,f),f.normalize();const Ne=p.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let Ge=0,We=l.length;!this.result.shouldStop&&Ge!==We;Ge++){const dt=l[Ge];e.getNormal(dt,a),e.getVertex(T[3*dt],Zl),Zl.vsub(p,d);const Mt=f.dot(a),Ot=a.dot(d)/Mt;if(Ot<0)continue;f.scale(Ot,sa),sa.vadd(p,sa),e.getVertex(T[3*dt+1],qc),e.getVertex(T[3*dt+2],Yc);const Lt=sa.distanceSquared(p);!us.pointInTriangle(sa,qc,Zl,Yc)&&!us.pointInTriangle(sa,Zl,qc,Yc)||Lt>Ne||(Pi.vectorToWorldFrame(t,a,x),Pi.pointToWorldFrame(i,t,sa,_),this.reportIntersection(x,_,s,r,dt))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case us.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case us.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case us.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,wf),i.vsub(t,Mv),e.vsub(t,cR);const s=wf.dot(wf),o=wf.dot(Mv),a=wf.dot(cR),l=Mv.dot(Mv),c=Mv.dot(cR);let d,f;return(d=l*a-o*c)>=0&&(f=s*c-o*a)>=0&&d+f<s*l-o*o}}us.CLOSEST=1,us.ANY=2,us.ALL=4;const $4=new sr,lR=[],Mv=new le,cR=new le,s_e=new le,o_e=new ns,sa=new le,Zl=new le,qc=new le,Yc=new le,W4={faceList:[0]},VS=new le,a_e=new us,l_e=[],c_e=new le,u_e=new le,d_e=new le,q4=new le,h_e=new le,f_e=new le,p_e=new le,g_e=new le,m_e=new le,__e=new le;new sr;const y_e=[],v_e=new Pi,wf=new le,jS=new le;let l8,c8,u8,d8,h8,f8,p8,g8,m8,_8,y8,v8,b8,w8,E8,S8,C8,x8,A8,T8,D8,M8,I8,O8,R8;new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new us,new le,new le,new le(1,0,0),new le(0,1,0),new le(0,0,1),new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new sr,new le,new sr,new le,new le,new le,new le,new le,new le,new le,new sr,new le,new Pi,new sr;const xr={sphereSphere:hn.types.SPHERE,spherePlane:hn.types.SPHERE|hn.types.PLANE,boxBox:hn.types.BOX|hn.types.BOX,sphereBox:hn.types.SPHERE|hn.types.BOX,planeBox:hn.types.PLANE|hn.types.BOX,convexConvex:hn.types.CONVEXPOLYHEDRON,sphereConvex:hn.types.SPHERE|hn.types.CONVEXPOLYHEDRON,planeConvex:hn.types.PLANE|hn.types.CONVEXPOLYHEDRON,boxConvex:hn.types.BOX|hn.types.CONVEXPOLYHEDRON,sphereHeightfield:hn.types.SPHERE|hn.types.HEIGHTFIELD,boxHeightfield:hn.types.BOX|hn.types.HEIGHTFIELD,convexHeightfield:hn.types.CONVEXPOLYHEDRON|hn.types.HEIGHTFIELD,sphereParticle:hn.types.PARTICLE|hn.types.SPHERE,planeParticle:hn.types.PLANE|hn.types.PARTICLE,boxParticle:hn.types.BOX|hn.types.PARTICLE,convexParticle:hn.types.PARTICLE|hn.types.CONVEXPOLYHEDRON,cylinderCylinder:hn.types.CYLINDER,sphereCylinder:hn.types.SPHERE|hn.types.CYLINDER,planeCylinder:hn.types.PLANE|hn.types.CYLINDER,boxCylinder:hn.types.BOX|hn.types.CYLINDER,convexCylinder:hn.types.CONVEXPOLYHEDRON|hn.types.CYLINDER,heightfieldCylinder:hn.types.HEIGHTFIELD|hn.types.CYLINDER,particleCylinder:hn.types.PARTICLE|hn.types.CYLINDER,sphereTrimesh:hn.types.SPHERE|hn.types.TRIMESH,planeTrimesh:hn.types.PLANE|hn.types.TRIMESH};l8=xr.sphereSphere,c8=xr.spherePlane,u8=xr.boxBox,d8=xr.sphereBox,h8=xr.planeBox,f8=xr.convexConvex,p8=xr.sphereConvex,g8=xr.planeConvex,m8=xr.boxConvex,_8=xr.sphereHeightfield,y8=xr.boxHeightfield,v8=xr.convexHeightfield,b8=xr.sphereParticle,w8=xr.planeParticle,E8=xr.boxParticle,S8=xr.convexParticle,C8=xr.cylinderCylinder,x8=xr.sphereCylinder,A8=xr.planeCylinder,T8=xr.boxCylinder,D8=xr.convexCylinder,M8=xr.heightfieldCylinder,I8=xr.particleCylinder,O8=xr.sphereTrimesh,R8=xr.planeTrimesh,new le,new le,new le,new le,new le,new ns,new ns,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new sr,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new ns,new le,new le,new le,new le,new le,new le,new le,new le,new sr,new us;const Hs=globalThis.performance||{};if(!Hs.now){let n=Date.now();Hs.timing&&Hs.timing.navigationStart&&(n=Hs.timing.navigationStart),Hs.now=()=>Date.now()-n}var xf=tt(517);function Xg(n,e,t){e||(e=new Yn(Yn.IDENTITY));const i=new Yn(Yn.IDENTITY);if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new Yn(Yn.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new Yn(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===Xg(s,r,t))return!1;return!0}function B8(){GU([u4,Wg])}function V8(n,e){const t=e.nodes.find(i=>i.name===n);if(t){let i=!1;for(const r of e.scenes)i||Xg(r,new Yn(Yn.IDENTITY),(s,o)=>s!==t||(s.matrix=o,s.translation=void 0,s.rotation=void 0,s.scale=void 0,i=!0,!1));return e.scene={id:n,name:n,nodes:[t]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function hR(n,e){return wr(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield gS(i,Wg,{DracoLoader:kO,gltf:{decompressMeshes:!0,postProcess:!0}});return V8(n.scenegraphNode,r)})}function bbe(n,e){return wr(this,void 0,void 0,function*(){return V8(n,yield e)})}function fR(n,e,t){if(e&&0!==e.length)return new Kfe(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Mi.CARTESIAN,data:e,mesh:new Ime,wireframe:!1,getTransformMatrix:i=>i.transformMatrix,getColor:i=>i.color||[255,255,255,229.5]},t))}let Ebe=(()=>{class n extends Que{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),B8()}renderLayers(){const t=this.state,i=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&l.unpickable),r=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&!l.unpickable),s=t.data.filter(l=>!l.scenegraph&&l.wireframe),o=t.data.filter(l=>!!l.scenegraph);t.doCollisions&&function(n){wr(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&!o.wireframe).map(o=>{const a=new Yn(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new sr({lowerBound:new le(...l.map((d,f)=>Math.min(d,c[f]))),upperBound:new le(...c.map((d,f)=>Math.max(d,l[f])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield mS(o.scenegraph,Wg,{DracoLoader:kO,decompress:!0,postProcess:!0});for(const l of a.scenes)Xg(l,new Yn(o.transformMatrix),(c,d)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const f of c.mesh.primitives)if(f.attributes.POSITION&&f.attributes.POSITION.min){const p=d.transformAsPoint(f.attributes.POSITION.min,[]),g=d.transformAsPoint(f.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new sr({lowerBound:new le(...p.map((_,x)=>Math.min(_,g[x]))),upperBound:new le(...g.map((_,x)=>Math.max(_,p[x])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(t.data);const a={};for(const l of o)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(a,l.scenegraph)&&(a[l.scenegraph]=hR({scenegraph:l.scenegraph},n.gltfCache));return[fR("cubes",i,{wireframe:!1,pickable:!1}),fR("pickableCubes",r,{wireframe:!1,pickable:!0}),fR("wireframes",s,{wireframe:!0,pickable:!1}),...o.map(l=>{var c;return new Cme({id:"models-"+l["@id"],opacity:l.zoomBasedOpacity?t.zoomOpacity:void 0!==l.opacity?l.opacity:1,pickable:!l.unpickable,coordinateSystem:Mi.CARTESIAN,data:[l],scenegraph:l.scenegraphNode?bbe(l.scenegraphNode,a[l.scenegraph]):l.scenegraph,_lighting:l._lighting,getTransformMatrix:l.transformMatrix,getColor:null!==(c=l.color)&&void 0!==c?c:[0,255,0,127.5],parameters:{depthMask:!l.zoomBasedOpacity&&(void 0===l.opacity||1===l.opacity)}})})].filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function j8(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),j8(t,e);return e}let Cbe=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new Ebe({}),this.nodeClickSubject=new ee,this.nodeHoverStartSubject=new ee,this.nodeHoverStopSubject=new ee,this.sceneRotationSubject=new Ir([0,0]),this.nodeDragStartSubject=new ee,this.nodeDragSubject=new ee,this.nodeDragEndSubject=new ee,this.nodeClick$=this.nodeClickSubject.pipe(fs()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(fs()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(fs()),this.sceneRotation$=this.sceneRotationSubject.pipe(fs()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(fs()),this.nodeDrag$=this.nodeDragSubject.pipe(fs()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(fs());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new cde({flipY:!1,near:-1e3}):new hde({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var d;return null!==(d=this.cursor)&&void 0!==d?d:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new oO({ambientLight:new ez({color:[255,255,255],intensity:10})})]),this.deck=new TS(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return wr(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new Yn([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t){return wr(this,void 0,void 0,function*(){B8();const i=yield hR({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},s=[];for(const o of i.scenes)Xg(o,e=new Yn(e||Yn.IDENTITY),(a,l)=>{const c={"@id":a.name||a.id,"@type":"ProcessedNode",transformMatrix:new Yn(l),wireframe:!0,node:a};if(s.push({"@id":`GLTF:${c["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:c["@id"],transformMatrix:new Yn(e||Yn.IDENTITY),tooltip:a.name||a.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:a}),a.mesh&&a.mesh.primitives&&a.mesh.primitives.length>0)for(const d of a.mesh.primitives)if(d.attributes.POSITION&&d.attributes.POSITION.min){const f=l.transformAsPoint(d.attributes.POSITION.min,[]),p=l.transformAsPoint(d.attributes.POSITION.max,[]);c.bbox=new sr({lowerBound:new le(...f.map((g,_)=>Math.min(g,p[_]))),upperBound:new le(...p.map((g,_)=>Math.max(g,f[_])))})}return r[c["@id"]]=c,!0});for(const o of Object.values(r).filter(a=>!a.bbox)){for(const a of j8(o.node).map(l=>r[l]).filter(l=>l.bbox))o.bbox?o.bbox.extend(a.bbox):o.bbox=a.bbox.clone();o.bbox||delete r[o["@id"]]}for(const o of Object.values(r)){const a=o.bbox.lowerBound,d=(o.size=o.bbox.upperBound.clone().vsub(a)).clone().vmul(new le(.5,.5,.5)),f=o.center=a.clone().vadd(d);o.transformMatrix=(new Yn).translate(f.toArray()).scale(d.toArray())}for(const o of s)r[o["@id"]]=o;return r})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new Yn(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return Sa([xf.ZP],n.prototype,"_onHover",null),Sa([xf.ZP],n.prototype,"_onClick",null),Sa([xf.ZP],n.prototype,"_onViewStateChange",null),Sa([xf.ZP],n.prototype,"_onDragStart",null),Sa([xf.ZP],n.prototype,"_onDrag",null),Sa([xf.ZP],n.prototype,"_onDragEnd",null),n})();function xbe(n,e){return n===e}function Abe(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function U8(n,e=xbe){let t=null,i=null;function r(){return Abe(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const Dbe=U8(function(){const n=tD();if(!n)return!1;const e=n.injector.get(rk,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let pR=(()=>{class n{constructor(){this.bootstrap$=new hg(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const gR=new zt("INITIAL_STATE_TOKEN");let Mbe=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const z8=new zt("Internals.StateContextFactory"),H8=new zt("Internals.StateFactory");function Fv(...n){if(1===n.length){const e=n[0];if(L(e))return qS(e,null);if(re(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return qS(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return qS(n=1===n.length&&L(n[0])?n[0]:n,null).pipe(ve(t=>e(...t)))}return qS(n,null)}function qS(n,e){return new F(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=Pe(n[a]);let c=!1;t.add(l.subscribe({next:d=>{c||(c=!0,o++),r[a]=d},error:d=>t.error(d),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((d,f,p)=>(d[f]=r[p],d),{}):r),t.complete())}}))}})}function G8(n,e){return e?t=>t.pipe(G8((i,r)=>Pe(n(i,r)).pipe(ve((s,o)=>e(i,s,r,o))))):t=>t.lift(new Ibe(n))}class Ibe{constructor(e){this.project=e}call(e,t){return t.subscribe(new Obe(e,this.project))}}class Obe extends pe{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new wt(this),i=this.destination;i.add(t);const r=O(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function is(n){return e=>e.lift(new Rbe(n))}class Rbe{constructor(e){this.notifier=e}call(e,t){const i=new Nbe(e),r=O(this.notifier,new wt(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class Nbe extends pe{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function Qg(n,e){return t=>t.lift(new Pbe(n,e))}class Pbe{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new Fbe(e,this.compare,this.keySelector))}}class Fbe extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const Ia={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let $8=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return _n.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return _n.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof _n||console.warn(Ia.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(Re(_n),Re(Tc))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const W8=new zt("ROOT_STATE_TOKEN"),q8=new zt("FEATURE_STATE_TOKEN"),Lbe=new zt("NGXS_PLUGINS"),Y8=new zt("NG_TEST_MODE"),K8=new zt("NG_DEV_MODE"),Hu="NGXS_META";let Af=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=$8}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class kbe{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const Q8=new zt("NGXS_EXECUTION_STRATEGY");function Zg(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const Z8=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},YS=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),_R=n=>n&&"object"==typeof n&&!Array.isArray(n),yR=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(_R(n)&&_R(t))for(const i in t)_R(t[i])?(n[i]||Object.assign(n,{[i]:{}}),yR(n[i],t[i])):Object.assign(n,{[i]:t[i]});return yR(n,...e)};function Lv(n){return n[Hu]}function eH(n,e){const t=YS(e.currentAppState,n.path),i=YS(e.newAppState,n.path);return new kbe(t,i,!n.isInitialised)}function $be(...n){return function(n,e,t=Ybe){const i=function(n){return n.reduce((e,t)=>(e[Zg(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return Xi(t=>{const i=Zg(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function Ybe(){return ve(n=>n.action)}function KS(n){return e=>new F(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let XS=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(Re(Q8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class Qbe extends ee{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let QS=(()=>{class n extends Qbe{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Yi(n)))(i||n)}}(),n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),Zbe=(()=>{class n extends F{constructor(t,i){super(r=>{const s=t.pipe(KS(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(Re(QS),Re(XS))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const tH=n=>(...e)=>n.shift()(...e,(...i)=>tH(n)(...i));let ZS=(()=>{class n extends Ir{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),ER=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(Re(n,12),Re(Lbe,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),SR=(()=>{class n extends ee{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Yi(n)))(i||n)}}(),n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),nH=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(Yo),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(KS(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?on(this._stateStream.getValue()):Fv(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!Zg(t))return dg(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return tH([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(Mu())}getActionResultStream(t){return this._actionResults.pipe(Xi(i=>i.action===t&&"DISPATCHED"!==i.status),Ki(1),Mu())}createDispatchObservable(t){return t.pipe(G8(i=>{switch(i.status){case"SUCCESSFUL":return on(this._stateStream.getValue());case"ERRORED":return dg(i.error);default:return Mc}})).pipe(Mu())}}return n.\u0275fac=function(t){return new(t||n)(Re(Hn),Re(QS),Re(SR),Re(ER),Re(ZS),Re(XS))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const iH=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&iH(n[i])}),n};let rH=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(Re(K8),Re(Y8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),sH=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(Ia.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(Ia.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(Re(rH),Re(Af))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),em=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=iH(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(Re(ZS),Re(nH),Re(Af),Re(sH))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),JS=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return YS(l,t.path)}function s(l,c){const d=Z8(l,t.path,c),f=t.instance;if(f.ngxsOnChanges){const p=eH(t,{currentAppState:l,newAppState:d});f.ngxsOnChanges(p)}return i.setState(d),d}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error(Ia.PATCHING_ARRAY());if("object"!=typeof n)throw new Error(Ia.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(Re(em))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class eC{static stateNameErrorMessage(e){return Ia.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(Ia.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error(Ia.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=Lv(e);if(!t)throw new Error(Ia.STATE_DECORATOR());return t}}eC.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let tm=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=U8(()=>{const c=this;function d(p){const g=c.statePaths[p];return g?function(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(p){let g=d(p);return g||((..._)=>(g||(g=d(p)),g?g(..._):void 0))},getSelectorOptions:p=>Object.assign({},c._config.selectorOptions,p||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach(eC.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[Hu].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[Hu];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[Hu].name]=t,e),{})}(i),l=[];for(const c of s){const d=a[c],f=o[c],p=d[Hu];this.addRuntimeInfoToMeta(p,f);const g={name:c,path:f,isInitialised:!1,actions:p.actions,instance:this._injector.get(d),defaults:n.cloneDefaults(p.defaults)};this.hasBeenMountedAndBootstrapped(c,f)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>Z8(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(Xi(t=>"DISPATCHED"===t.status),k(({action:t})=>this.invokeActions(this._actions,t).pipe(ve(()=>({action:t,status:"SUCCESSFUL"})),_E({action:t,status:"CANCELED"}),Oc(i=>on({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=Zg(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let d=o.instance[l.fn](c,i);d instanceof Promise&&(d=Pe(d)),d instanceof F?(d=d.pipe(_E({})),l.options.cancelUncompleted&&(d=d.pipe(is(t.pipe($be(i)))))):d=on({}).pipe(Mu()),s.push(d)}catch(d){s.push(dg(d))}}}return s.length||s.push(on({})),Fv(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=eC.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==YS(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(Re(Hn),Re(Af),Re(n,12),Re(QS),Re(SR),Re(JS),Re(gR,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),CR=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(Xi(()=>!!i),ts(()=>this.invokeInit(i.states)),k(()=>this.bootstrapper.appBootstrapped$),Xi(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=eH(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(Re(em),Re(JS),Re(pR))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();let Tf=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(ve(i),Oc(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?on(void 0):dg(r)}),Qg(),KS(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(Ki(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(KS(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return function(n){const e=function(n){return n.NGXS_SELECTOR_META}(n)||Lv(n);return e&&e.makeRootSelector||(()=>n)}(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(Re(ZS),Re(em),Re(Af),Re(XS),Re(tm),Re(gR,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),kv=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(Re(Tf),Re(Af))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class s0e{static get type(){return"@@INIT"}}class o0e{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const nC=new hg(1);let l0e=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&Ea();nC.next(t)}catch(n){nC.next(!1)}finally{nC.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new s0e,l)}}return n.\u0275fac=function(t){return new(t||n)(Re(tm),Re(em),Re(Tf),Re(kv),Re(W8,8),Re(CR))},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({}),n})(),c0e=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new o0e(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(Re(Tf),Re(em),Re(tm),Re(q8,8),Re(CR))},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({}),n})();class Oa{static forRoot(e=[],t={}){return{ngModule:l0e,providers:[tm,JS,Zbe,QS,pR,sH,rH,CR,nH,SR,em,XS,Tf,ZS,kv,ER,...e,...Oa.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:c0e,providers:[tm,ER,...e,{provide:q8,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:Y8,useValue:Dbe},{provide:K8,useValue:Ea},{provide:Q8,useClass:t.executionStrategy||$8},{provide:W8,useValue:e},{provide:Oa.ROOT_OPTIONS,useValue:t},{provide:Af,useFactory:Oa.ngxsConfigFactory,deps:[Oa.ROOT_OPTIONS]},{provide:Rw,useFactory:Oa.appBootstrapListenerFactory,multi:!0,deps:[pR]},{provide:gR,useFactory:Oa.getInitialState},{provide:z8,useExisting:JS},{provide:H8,useExisting:tm}]}static ngxsConfigFactory(e){return yR(new Af,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return Mbe.pop()}}Oa.\u0275fac=function(e){return new(e||Oa)},Oa.\u0275mod=cn({type:Oa}),Oa.\u0275inj=Et({}),Oa.ROOT_OPTIONS=new zt("ROOT_OPTIONS");const Ra=new zt("NgValueAccessor"),pC=new Gl(cE);class vwe{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new bwe(e,this.dueTime,this.scheduler))}}class bwe extends y{constructor(e,t,i){super(e),this.dueTime=t,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(wwe,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function wwe(n){n.debouncedNext()}function Ui(n){return null!=n&&"false"!=`${n}`}function Na(n,e=0){return function(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function $u(n){return n instanceof wn?n.nativeElement:n}let KR;try{KR="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){KR=!1}let Wv,XR,zi=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?rf(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!KR)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(Re(Tc))},n.\u0275prov=$e({factory:function(){return new n(Re(Tc))},token:n,providedIn:"root"}),n})(),$v=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({}),n})();function rm(n){return function(){if(null==Wv&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Wv=!0}))}finally{Wv=Wv||!1}return Wv}()?n:!!n.capture}function If(n){return n.composedPath?n.composedPath()[0]:n.target}let QR=(()=>{class n{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({factory:function(){return new n},token:n,providedIn:"root"}),n})(),_6=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=$u(t);return new F(r=>{const o=this._observeElement(i).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new ee,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(Re(QR))},n.\u0275prov=$e({factory:function(){return new n(Re(QR))},token:n,providedIn:"root"}),n})(),y6=(()=>{class n{constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new mn,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=Ui(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=Na(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(function(n,e=pC){return t=>t.lift(new vwe(n,e))}(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){var t;null===(t=this._currentSubscription)||void 0===t||t.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(De(_6),De(wn),De(_n))},n.\u0275dir=Bt({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),ZR=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({providers:[QR]}),n})();function M6(n){return 0===n.offsetX&&0===n.offsetY}function I6(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}"undefined"!=typeof Element&&Element;const O6=new zt("cdk-input-modality-detector-options"),qwe={ignoreKeys:[18,17,224,91,16]},sm=rm({passive:!0,capture:!0});let N6=(()=>{class n{constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Ir(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=If(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(M6(o)?"keyboard":"mouse"),this._mostRecentTarget=If(o))},this._onTouchstart=o=>{I6(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=If(o))},this._options=Object.assign(Object.assign({},qwe),s),this.modalityDetected=this._modality.pipe(function(n){return e=>e.lift(new yne(n))}(1)),this.modalityChanged=this.modalityDetected.pipe(Qg()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,sm),r.addEventListener("mousedown",this._onMousedown,sm),r.addEventListener("touchstart",this._onTouchstart,sm)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){!this._platform.isBrowser||(document.removeEventListener("keydown",this._onKeydown,sm),document.removeEventListener("mousedown",this._onMousedown,sm),document.removeEventListener("touchstart",this._onTouchstart,sm))}}return n.\u0275fac=function(t){return new(t||n)(Re(zi),Re(_n),Re(un),Re(O6,8))},n.\u0275prov=$e({factory:function(){return new n(Re(zi),Re(_n),Re(un),Re(O6,8))},token:n,providedIn:"root"}),n})();const L6=new zt("cdk-focus-monitor-default-options"),bC=rm({passive:!0,capture:!0});let Wu=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new ee,this._rootNodeFocusAndBlurListener=a=>{const l=If(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let d=l;d;d=d.parentElement)c.call(this,a,d)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,i=!1){const r=$u(t);if(!this._platform.isBrowser||1!==r.nodeType)return on(null);const s=function(n){if(function(){if(null==XR){const n="undefined"!=typeof document?document.head:null;XR=!(!n||!n.createShadowRoot&&!n.attachShadow)}return XR}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new ee,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=$u(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=$u(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,i,r){r?t.classList.add(i):t.classList.remove(i)}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,i){this._toggleClass(t,"cdk-focused",!!i),this._toggleClass(t,"cdk-touch-focused","touch"===i),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===i),this._toggleClass(t,"cdk-mouse-focused","mouse"===i),this._toggleClass(t,"cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=If(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r.subject,null))}_emitOrigin(t,i){this._ngZone.run(()=>t.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,bC),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,bC)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(is(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,bC),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,bC),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r.subject,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}}return n.\u0275fac=function(t){return new(t||n)(Re(_n),Re(zi),Re(N6),Re(un,8),Re(L6,8))},n.\u0275prov=$e({factory:function(){return new n(Re(_n),Re(zi),Re(N6),Re(un,8),Re(L6,8))},token:n,providedIn:"root"}),n})();const k6="cdk-high-contrast-black-on-white",B6="cdk-high-contrast-white-on-black",eN="cdk-high-contrast-active";let V6=(()=>{class n{constructor(t,i){this._platform=t,this._document=i}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(eN),t.remove(k6),t.remove(B6),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?(t.add(eN),t.add(k6)):2===i&&(t.add(eN),t.add(B6))}}}return n.\u0275fac=function(t){return new(t||n)(Re(zi),Re(un))},n.\u0275prov=$e({factory:function(){return new n(Re(zi),Re(un))},token:n,providedIn:"root"}),n})(),Yv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({}),n})();const U6=new wu("12.2.5");function G6(n){Promise.resolve(null).then(n)}class am{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){G6(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function W6(){return"undefined"!=typeof window&&void 0!==window.document}function nN(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let oN=(n,e)=>!1,aN=(n,e)=>!1,K6=(n,e,t)=>[];const X6=nN();(X6||"undefined"!=typeof Element)&&(oN=W6()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),aN=(()=>{if(X6||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):aN}})(),K6=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let Of=null,Q6=!1;function lN(n){Of||(Of=("undefined"!=typeof document?document.body:null)||{},Q6=!!Of.style&&"WebkitAppearance"in Of.style);let e=!0;return Of.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Of.style,!e&&Q6&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Of.style)),e}const cN=aN,uN=oN,dN=K6;let J6=(()=>{class n{validateStyleProperty(t){return lN(t)}matchesElement(t,i){return cN(t,i)}containsElement(t,i){return uN(t,i)}query(t,i,r){return dN(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new am(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class wC{}wC.NOOP=new J6;function i5(n,e,t){return t?e+":"+t+";":""}function r5(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=i5(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=i5(0,aEe(t),n.style[t]));n.setAttribute("style",e)}function Qc(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=mN(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),nN()&&r5(n))}function Nf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=mN(t);n.style[i]=""}),nN()&&r5(n))}const oEe=/-+([a-z0-9])/g;function mN(n){return n.replace(oEe,(...e)=>e[1].toUpperCase())}function aEe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class um{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=um.initialStylesByElement.get(e);r||um.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&Qc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Qc(this._element,this._initialStyles),this._endStyles&&(Qc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(um.initialStylesByElement.delete(this._element),this._startStyles&&(Nf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Nf(this._element,this._endStyles),this._endStyles=null),Qc(this._element,this._initialStyles),this._state=3)}}um.initialStylesByElement=new WeakMap;const ec=new zt("AnimationModuleType"),z5=new wu("12.2.5"),DSe=new zt("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let Ff,hr=(()=>{class n{constructor(t,i,r){this._hasDoneGlobalChecks=!1,this._document=r,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=i,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const t=this._document.defaultView||window;return"object"==typeof t&&t?t:null}_checkIsEnabled(t){return!(!Ea()||this._isTestEnv())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const i=getComputedStyle(t);i&&"none"!==i.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&z5.full!==U6.full&&console.warn("The Angular Material version ("+z5.full+") does not match the Angular CDK version ("+U6.full+").\nPlease ensure the versions of these two packages exactly match.")}}return n.\u0275fac=function(t){return new(t||n)(Re(V6),Re(DSe,8),Re(un))},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[Yv],Yv]}),n})();function jC(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=Ui(e)}}}function Qv(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function ON(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Ui(e)}}}function RN(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?Na(t):this.defaultTabIndex}}}try{Ff="undefined"!=typeof Intl}catch(n){Ff=!1}class USe{constructor(e,t,i){this._renderer=e,this.element=t,this.config=i,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const $5={enterDuration:225,exitDuration:150},NN=rm({passive:!0}),W5=["mousedown","touchstart"],q5=["mouseup","mouseleave","touchend","touchcancel"];class HSe{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=$u(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},$5),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,d=document.createElement("div");d.classList.add("mat-ripple-element"),d.style.left=a-o+"px",d.style.top=l-o+"px",d.style.height=2*o+"px",d.style.width=2*o+"px",null!=i.color&&(d.style.backgroundColor=i.color),d.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(d),function(n){window.getComputedStyle(n).getPropertyValue("opacity")}(d),d.style.transform="scale(1)";const f=new USe(this,d,i);return f.state=0,this._activeRipples.add(f),i.persistent||(this._mostRecentTransientRipple=f),this._runTimeoutOutsideZone(()=>{const p=f===this._mostRecentTransientRipple;f.state=1,!i.persistent&&(!p||!this._isPointerDown)&&f.fadeOut()},c),f}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const i=e.element,r=Object.assign(Object.assign({},$5),e.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,i.parentNode.removeChild(i)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=$u(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(W5))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(q5),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=M6(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!I6(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,NN)})})}_removeTriggerEvents(){this._triggerElement&&(W5.forEach(e=>{this._triggerElement.removeEventListener(e,this,NN)}),this._pointerUpEventsRegistered&&q5.forEach(e=>{this._triggerElement.removeEventListener(e,this,NN)}))}}const WSe=new zt("mat-ripple-global-options");let dm=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new HSe(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return n.\u0275fac=function(t){return new(t||n)(De(wn),De(_n),De(zi),De(WSe,8),De(ec,8))},n.\u0275dir=Bt({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&wi("mat-ripple-unbounded",i.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),n})(),zC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[hr,$v],hr]}),n})();new class extends Gl{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends cE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let rCe=1;const sCe=Promise.resolve(),HC={};function Z5(n){return n in HC&&(delete HC[n],!0)}const J5={setImmediate(n){const e=rCe++;return HC[e]=!0,sCe.then(()=>Z5(e)&&n()),e},clearImmediate(n){Z5(n)}};new class extends Gl{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends cE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=J5.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(J5.clearImmediate(t),e.scheduled=void 0)}});function La(n){return null==n}function ka(n){return!La(n)}"undefined"!=typeof window&&window,tt(266),tt(478),new zt("SECURITY_CONTEXT");let pTe=(()=>{class n{constructor(t){this.sequence$=new Ir(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(Re(Tf,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();let nc=(()=>{class n{constructor(t,i,r){n.store=t.get(Tf),n.ngZone=t.get(_n),n.factory=i,n.context=r,n.computed=t.get(pTe)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(Re(Hn),Re(H8),Re(z8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class Ms{constructor(){Ms.statesCachedMeta.clear()}static createStateContext(e){return nc.context.createStateContext(e)}static ensureMappedState(e){if(La(nc.factory)||La(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(ka(e.name)?Ms.statesCachedMeta.get(e.name):null)||Ms.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=function(n){return n.NGXS_DATA_META}(Ms.getStateClassByInstance(e)))&&void 0!==t?t:null;if(La(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=Ms.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);ka(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=Ms.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=ka(e.name)?null===(t=nc.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return ka(i)&&ka(e.name)&&Ms.statesCachedMeta.set(e.name,i),i}}Ms.statesCachedMeta=new Map,Ms.\u0275fac=function(e){return new(e||Ms)},Ms.\u0275prov=$e({token:Ms,factory:Ms.\u0275fac}),new hg(1),Error,Error;const QTe=["bodyCanvas"];let ZTe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new mn,this.nodeDrag=new mn,this.nodeClick=new mn,this.nodeHoverStart=new mn,this.nodeHoverStop=new mn,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return wr(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new Cbe({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))]})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&Mr(QTe,5,wn),2&t){let r;di(r=hi())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&Sc(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&xi(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),JTe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[Yr]]}),n})();new zt("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10});const j$=[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:large_intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:brain",organ:"Brain",name:"Allen Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{src:"app:lymph_nodes",organ:"Lymph Node",name:"Lymph Node, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph_nodes",organ:"Lymph Node",name:"Lymph Node, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:bone_marrow",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{src:"app:vasculature",organ:"Vasculature",name:"Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}];j$.filter(n=>!0!==n.disabled);!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}();function Zc(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let oP;function ic(){return oP||(oP=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),Zc(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),oP}function H$(n,e=ic()){return e("readonly",t=>Zc(t.get(n)))}var qi=tt(440),RDe=tt(698),NDe=tt(445),PDe=tt.n(NDe),pi=tt(815),lh=tt(609);const Hi=qi.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},qi.DataFactory),G$={x:Hi("rdf"),type:Hi("rdf")("type")},_m={x:Hi("rdfs"),label:Hi("rdfs")("label"),comment:Hi("rdfs")("comment"),isDefinedBy:Hi("rdfs")("isDefinedBy"),seeAlso:Hi("rdfs")("seeAlso")},bi={x:Hi("entity"),id:Hi("entity")("id"),label:_m.label,description:_m.comment,link:_m.seeAlso,sex:Hi("entity")("sex"),age:Hi("entity")("age"),bmi:Hi("entity")("bmi"),Male:qi.DataFactory.literal("Male"),Female:qi.DataFactory.literal("Female"),consortiumName:Hi("entity")("consortium_name"),providerName:Hi("entity")("provider_name"),providerUUID:Hi("entity")("provider_uuid"),donor:Hi("entity")("has_donor"),sections:Hi("entity")("has_tissue_section"),datasets:Hi("entity")("has_dataset"),sampleType:Hi("entity")("sample_type"),TissueBlock:qi.DataFactory.literal("Tissue Block"),TissueSection:qi.DataFactory.literal("Tissue Section"),NonStandard:qi.DataFactory.literal("Non-standard"),sectionCount:Hi("entity")("section_count"),sectionSize:Hi("entity")("section_size"),sectionUnits:Hi("entity")("section_units"),sectionNumber:Hi("entity")("section_number"),spatialEntity:Hi("entity")("has_spatial_entity"),ontologyTerms:Hi("entity")("has_ontology_term"),technology:Hi("entity")("technology"),thumbnail:Hi("entity")("has_thumbnail")},In=Hi("ccf"),or={x:In,ontologyNode:{label:In("ccf_preferred_label"),parent:In("ccf_part_of"),children:In("ccf_part_of"),rui_rank:In("ccf_rui_rank"),synonymLabels:qi.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},spatial:{Female:In("VHFemale"),Male:In("VHMale"),BothSexes:In("VHBothSexes"),FemaleOrgans:In("VHFemaleOrgans"),MaleOrgans:In("VHMaleOrgans")},SpatialObjectReference:In("SpatialObjectReference"),SpatialEntity:In("SpatialEntity"),SpatialPlacement:In("SpatialPlacement"),spatialObjectReference:{file:In("has_object_file"),file_format:In("has_object_file_format"),file_subpath:In("has_object_file_subpath")},extractionSet:{label:_m.label,rui_rank:In("ccf_rui_rank")},spatialEntity:{label:_m.label,comment:_m.comment,creator:Hi("dc")("creator"),creator_first_name:In("creator_first_name"),creator_last_name:In("creator_last_name"),creator_orcid:In("creator_orcid"),creation_date:In("creation_date"),updated_date:In("updated_date"),ccf_annotations:In("ccf_annotation"),representation_of:In("ccf_representation_of"),reference_organ:In("anatomical_structure_of"),extraction_set_for:In("extraction_set_for"),extraction_set:In("extraction_site_for"),sex:In("has_sex"),side:In("has_side"),rui_rank:In("ccf_rui_rank"),slice_thickness:In("ccf_slice_thickness"),slice_count:In("ccf_slice_count"),x_dimension:In("has_x_dimension"),y_dimension:In("has_y_dimension"),z_dimension:In("has_z_dimension"),dimension_units:In("has_dimension_units"),object:In("has_object_reference")},spatialPlacement:{source:In("has_placement_source"),target:In("has_placement_target"),placement_date:In("has_placement_date"),x_scaling:In("has_x_scaling"),y_scaling:In("has_y_scaling"),z_scaling:In("has_z_scaling"),scaling_units:In("has_scaling_units"),x_rotation:In("has_x_rotation"),y_rotation:In("has_y_rotation"),z_rotation:In("has_z_rotation"),w_rotation:In("has_theta_rotation"),rotation_order:In("has_rotation_order"),rotation_units:In("has_rotation_units"),x_translation:In("has_x_translation"),y_translation:In("has_y_translation"),z_translation:In("has_z_translation"),translation_units:In("has_translation_units")}},Ar={x:Hi("uberon")},W$=(Hi("lmha"),{bladder:Ar.x("0001255"),body:Ar.x("0013702"),brain:Ar.x("0000955"),colon:Ar.x("0001155"),heart:Ar.x("0000948"),kidney:Ar.x("0002113"),large_intestine:Ar.x("0000059"),left_kidney:Ar.x("0004538"),left_lung:Ar.x("0002168"),left_ureter:Ar.x("0001223"),liver:Ar.x("0002107"),lung:Ar.x("0002048"),respiratory_system:Ar.x("0001004"),lymph_node:Ar.x("0000029"),pelvis:Ar.x("0001270"),rectum:Ar.x("0001052"),right_kidney:Ar.x("0004539"),right_lung:Ar.x("0002167"),right_ureter:Ar.x("0001222"),skin:Ar.x("0002097"),small_intestine:Ar.x("0002108"),spleen:Ar.x("0002106"),thymus:Ar.x("0002370"),ureter:Ar.x("0000056"),vasculature:Ar.x("0002049")});function lP(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const cx={spatialObjectReference:lP(or.spatialObjectReference),spatialEntity:lP(or.spatialEntity),spatialPlacement:lP(or.spatialPlacement)};function ux(n,e,t,i){const r={"@id":e,"@type":t};return n.some(s=>{const o=i[s.predicate.id];if(o){const a="Literal"===s.object.termType?(0,lh.fromRdf)(s.object):s.object.id;(0,pi.set)(r,o,a)}return!1},qi.DataFactory.namedNode(e),null,null,null),r}const kDe=(0,pi.memoize)(function(n,e){return ux(n,e,"SpatialObjectReference",cx.spatialObjectReference)},(n,e)=>e),q$=(0,pi.memoize)(function(n,e){const t=ux(n,e,"ExtractionSet",cx.spatialEntity);return t.extractionSites=(0,pi.sortBy)(n.getSubjects(or.spatialEntity.extraction_set,e,null).map(i=>Vf(n,i.id)),["rui_rank"]),t},(n,e)=>e),jDe=(0,pi.memoize)(function(n,e){return(0,pi.sortBy)(n.getSubjects(or.spatialEntity.extraction_set_for,e,null).map(t=>q$(n,t.id)),["rui_rank"])},(n,e)=>e),zDe=(0,pi.memoize)(function(n,e){return(0,pi.sortBy)(n.getSubjects(or.spatialEntity.reference_organ,e,null).map(t=>Vf(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])},(n,e)=>e),GDe=(0,pi.memoize)(function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(Vf(n,t.subject.id))},null,or.spatialEntity.reference_organ,null,null),(0,pi.sortBy)(e,["rui_rank"])}),Vf=(0,pi.memoize)(function(n,e){const t=ux(n,e,"SpatialEntity",cx.spatialEntity);return t.object&&(t.object=kDe(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,or.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,bi.spatialEntity,e,null),t},(n,e)=>e),qDe=(0,pi.memoize)(function(n,e){const t=ux(n,e,"SpatialPlacement",cx.spatialPlacement);return t.source&&(t.source=Vf(n,t.source)),t.target&&(t.target=Vf(n,t.target)),t},(n,e)=>e),KDe=(0,pi.memoize)(function(n,e){const t=n.getObjects(qi.DataFactory.namedNode(e),bi.spatialEntity,null);if(t.length>0)return Vf(n,t[0].id)},(n,e)=>e);function XDe(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(FV),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class Y${constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new RDe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},G$.type,or.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},G$.type,or.SpatialEntity,null);const t={};e.some(i=>(t[i.subject.id]=i.object.id,!1),null,or.spatialPlacement.source,null,null),e.some(i=>{const r=t[i.subject.id];return r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement"),!1},null,or.spatialPlacement.target,null,null)}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new Yn(Yn.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new Yn(Yn.IDENTITY),s=PDe()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s){if(o){const l=this.graph.getEdgeAttribute(a,o,"id");XDe(r,qDe(i,l))}o=a}return r}}}class K${constructor(e){this.db=e}getSpatialEntity(e){return Vf(this.db.store,e)}getExtractionSets(e){return jDe(this.db.store,e)}getExtractionSet(e){return q$(this.db.store,e)}getAnatomicalStructures(e){return zDe(this.db.store,e)}getReferenceOrgans(){return GDe(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=or.spatial.Male.id;break;case"Female":t=or.spatial.Female.id;break;case"Both":default:t=or.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e);let i=[...this.getReferenceOrganSets(e).map(r=>{const s="http://purl.obolibrary.org/obo/UBERON_0002097"===r.representation_of;return this.getSceneNode(r,t,{color:[255,255,255,255],opacity:s?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!s})})];return(null==e?void 0:e.debug)&&(i=i.concat([this.getSceneNode(this.getSpatialEntity(or.x("VHRightKidney").id),t,{color:[0,0,255,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(or.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(or.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(or.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(or.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],wireframe:!0})])),i.filter(r=>void 0!==r)}getReferenceOrganScene(e,t){var i;const r=this.getReferenceOrgans().filter(s=>s.representation_of===e&&s.sex===(null==t?void 0:t.sex));if(r.length>0){const s=r[0],a=this.getSceneNode(s,s,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===s.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),l=(null!==(i=this.db.getSpatialEntities(t))&&void 0!==i?i:[]).map(c=>this.getSceneNode(c,s,{color:[255,255,255,229.5]}));return[a].concat(l).filter(c=>void 0!==c)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let d=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(d){if(l)d=new Yn(Yn.IDENTITY).rotateX(FV(90)).multiplyLeft(d);else{let f;switch(e.dimension_units){case"centimeter":f=.01;break;case"millimeter":f=.001;break;case"meter":default:f=1}const p=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*f/2);d.scale(p)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:d,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const dx="https://entity.api.hubmapconsortium.org/entities/",X$=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),QDe={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},hx={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford"},Ai=function(){const n={};return Object.entries(W$).forEach(([e,t])=>n[e]=t.id),n}(),JDe={BL:[Ai.body,Ai.bladder],RK:[Ai.body,Ai.kidney,Ai.right_kidney],LK:[Ai.body,Ai.kidney,Ai.left_kidney],HT:[Ai.body,Ai.heart],LI:[Ai.body,Ai.large_intestine,Ai.colon],SI:[Ai.body,Ai.small_instestine],LL:[Ai.body,Ai.respiratory_system,Ai.lung,Ai.left_lung],RL:[Ai.body,Ai.respiratory_system,Ai.lung,Ai.right_lung],LY:[Ai.body,Ai.lymph_node],SP:[Ai.body,Ai.spleen],TH:[Ai.body,Ai.thymus],UR:[Ai.body,Ai.ureter],LV:[Ai.body,Ai.liver],OT:[Ai.body]},Q$={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class nMe{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],d=(this.data.ancestors||[]).find(We=>"Donor"===We.entity_type);this.donor=this.getDonor(d,i);const f=this.getRuiLocation(e,this.donor);f?this.rui_location=f:this.bad=!0;const p=new Date(e.last_modified_timestamp).toLocaleDateString(),g=hx[e.group_uuid]||e.group_name,_=e.created_by_user_displayname;this["@id"]=dx+e.uuid,this.label=`Registered ${p}, ${_}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const x={},T=[];this.sections=T;const q=[];this.datasets=q;for(const We of c.filter(dt=>"Sample"===dt.entity_type)){const dt=this.getSection(We,e,i);x[We.submission_id]=dt,T.push(dt),dt.section_number=null!==(s=dt.section_number)&&void 0!==s?s:T.length}for(const We of c)if("Dataset"===We.entity_type){const dt=this.getDataset(We,t,i,r),Mt=(0,pi.get)(We,["ingest_metadata","metadata","tissue_id"]);x[Mt]?null===(o=x[Mt].datasets)||void 0===o||o.push(dt):q.push(dt)}const G=null!=f?f:{},ge=`${G.x_dimension} x ${G.y_dimension} x ${G.z_dimension} ${G.dimension_units}`;this.section_count=G.slice_count||T.length;const Ne=parseFloat((G.slice_thickness||(G.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=Ne;const Ge=G.dimension_units||"millimeter";this.section_units=Ge,this.description=`${ge}, ${Ne} ${Ge}, ${e.specimen_type}, ${this.section_count} Sections`,T.forEach((We,dt)=>{We.description=`${G.x_dimension} x ${G.y_dimension} x ${Ne} ${Ge}, ${Ne} ${Ge}, ${We.description}`,We.section_number=dt+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":dx+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${hx[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=hx[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,pi.get)(e,["ingest_metadata","metadata","assay_type"],"")],d=c.join("|").toLowerCase();let f,p="assets/icons/ico-unknown.svg";return-1!==d.indexOf("10x")?(f="10x",p="assets/icons/ico-bulk-10x.svg"):-1!==d.indexOf("af")?(f="AF",p="assets/icons/ico-spatial-af.svg"):-1!==d.indexOf("codex")?(f="CODEX",p="assets/icons/ico-spatial-codex.svg"):-1!==d.indexOf("imc")?(f="IMC",p="assets/icons/ico-spatial-imc.svg"):-1!==d.indexOf("lc")&&-1===d.indexOf("af")?(f="LC",p="assets/icons/ico-bulk-lc.svg"):f=-1!==d.indexOf("maldi")?"MALDI":-1!==d.indexOf("pas")?"PAS":"OTHER",p=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:p,{"@id":dx+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:f,thumbnail:p}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,pi.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>X$.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(X$.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=QDe[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,pi.toNumber)(s[1]));for(const p of(0,pi.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===p.preferred_term||"Female"===p.preferred_term?r="Female":"Masculine gender"===p.preferred_term||"Male"===p.preferred_term?r="Male":"Current chronological age"===p.preferred_term||"Age"===p.preferred_term?o=(0,pi.toNumber)(p.data_value):"Body mass index"===p.preferred_term&&(a=(0,pi.toNumber)(p.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),d=hx[e.group_uuid]||e.group_name;return{"@id":dx+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${d}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:d,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;const s=(e.ancestors||[]).find(c=>"Sample"===c.entity_type&&"organ"===c.specimen_type),o=JDe[null==s?void 0:s.organ]||[Ai.body];let a,l=e.rui_location;if(l&&("string"==typeof l&&(l=JSON.parse(l)),l.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):l["@id"]&&(a=l)),a){a.ccf_annotations=o.concat(a.ccf_annotations||[]);const c=null!==(i=(0,pi.get)(a,["placement","target"]))&&void 0!==i?i:"";c.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")&&(0,pi.set)(a,["placement","target"],c.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")),("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===c||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===c)&&(0,pi.set)(a,["placement","target"],"Male"===t.sex?c.replace("#VH","#VHM")+"_Patch":c.replace("#VH","#VHF")+"_Patch")}return a}getTissueBlock(){return(0,pi.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}function Z$(n,e,t,i,r="",s=""){return wr(this,void 0,void 0,function*(){let o;if("static"===e)o=yield fetch(n).then(a=>a.ok?a.json():void 0).catch(()=>{});else if("search-api"===e){const a={"Content-type":"application/json"};i&&i.length>0&&(a.Authorization=`Bearer ${i}`),o=yield fetch(n,{method:"POST",headers:a,body:JSON.stringify({version:!0,size:1e4,_source:{excludes:["donor","immediate_ancestors","immediate_descendants","origin_sample","portal_metadata_upload_files","image_file_metadata","ancestor_ids","descendant_ids"]},stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:{exists:{field:"rui_location"}}})}).then(l=>l.ok?l.json():void 0).catch(()=>{})}if(o)return function(n,e="",t="",i,r=!1){const o={},a=(0,pi.get)(n,"hits.hits",[]).map(c=>(0,pi.get)(c,"_source",{})).map(c=>new nMe(c,e,t,i).toJsonLd());for(const c of a){const d=c["@id"];o[d]?o[d].samples.push(c.samples[0]):o[d]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":Q$},c)))),{"@context":Q$,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function fx(n,e,t){var i;const r=new Map,s=new Set;n.some(l=>{var c;return e.has(l.subject.id)&&(s.add(l.object.id),r.has(l.object.id)?null===(c=r.get(l.object.id))||void 0===c||c.push(l.subject.id):r.set(l.object.id,[l.subject.id])),!1},null,bi.donor,null,null);const o=t(s),a=new Set;for(const l of o)for(const c of null!==(i=r.get(l))&&void 0!==i?i:[])a.add(c);return a}function ob(n,e){return t=>n.has(t.id)?e.add(t.id):void 0}const mMe={[or.ontologyNode.label.id]:"label",[or.ontologyNode.parent.id]:"parent",[or.ontologyNode.synonymLabels.id]:"synonymLabels"};function _Me(n,e){const t=qi.DataFactory.namedNode(e),i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""};return n.some(r=>{const s=mMe[r.predicate.id];if(s){const o="Literal"===r.object.termType?(0,lh.fromRdf)(r.object):r.object.id;"synonymLabels"===s?i.synonymLabels.push(o):(0,pi.set)(i,s,o)}return!1},t,null,null,null),i.children=n.getSubjects(or.ontologyNode.children,t,null).map(r=>r.id),i}const px={[bi.label.id]:"label",[bi.description.id]:"description",[bi.link.id]:"link"},vMe=Object.assign(Object.assign({},px),{[bi.providerName.id]:"providerName"}),bMe=Object.assign(Object.assign({},px),{[bi.technology.id]:"technology",[bi.thumbnail.id]:"thumbnail"}),wMe=Object.assign(Object.assign({},px),{[bi.sampleType.id]:"sampleType",[bi.sectionNumber.id]:"sectionNumber",[bi.datasets.id]:"datasets"}),EMe=Object.assign(Object.assign({},px),{[bi.sampleType.id]:"sampleType",[bi.sectionCount.id]:"sectionCount",[bi.sectionSize.id]:"sectionSize",[bi.sectionUnits.id]:"sectionUnits",[bi.donor.id]:"donor",[bi.spatialEntity.id]:"spatialEntityId",[bi.sections.id]:"sections",[bi.datasets.id]:"datasets"}),CMe=(0,pi.memoize)(function(n,e){const t={"@id":e,"@type":"Donor"};return n.some(i=>{const r=vMe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,lh.fromRdf)(i.object):i.object.id;(0,pi.set)(t,r,s)}return!1},qi.DataFactory.namedNode(e),null,null,null),t},(n,e)=>e);function J$(n,e){const t={"@id":e,"@type":"Dataset"};return n.some(i=>{const r=bMe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,lh.fromRdf)(i.object):i.object.id;(0,pi.set)(t,r,s)}return!1},qi.DataFactory.namedNode(e),null,null,null),t}const TMe=(0,pi.memoize)(function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};return n.some(i=>{const r=EMe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,lh.fromRdf)(i.object):i.object.id;if("sections"===r){const o=function(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};return n.some(i=>{const r=wMe[i.predicate.id];if(r){const s="Literal"===i.object.termType?(0,lh.fromRdf)(i.object):i.object.id;if("datasets"===r){const o=J$(n,s);t[r].push(o)}else(0,pi.set)(t,r,s)}return!1},qi.DataFactory.namedNode(e),null,null,null),t}(n,s);t[r].push(o)}else if("datasets"===r){const o=J$(n,s);t[r].push(o)}else"donor"===r?t[r]=CMe(n,s):(0,pi.set)(t,r,s)}return!1},qi.DataFactory.namedNode(e),null,null,null),t},(n,e)=>e),DMe={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class MMe{constructor(e=DMe){this.options=e,this.store=new qi.Store(void 0,{factory:qi.DataFactory}),this.graph=new Y$(this),this.scene=new K$(this)}connect(e,t=!1){return wr(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return wr(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield H$(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=ic()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),Zc(t.transaction)))}([i,t]).catch(()=>{}):s=yield H$(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=ic()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),Zc(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return wr(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,qi.deserializeN3Store)(o,qi.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(Z$(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return wr(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>wr(this,void 0,void 0,function*(){"string"==typeof r?r.endsWith("jsonld")?yield(0,qi.addJsonLdToStore)(r,i):r.endsWith("n3")?yield(0,qi.addN3ToStore)(r,i):(r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml"))&&(yield(0,qi.addRdfXmlToStore)(r,i)):yield(0,qi.addJsonLdToStore)(r,i)}))),this})}synchronize(){return wr(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),this})}serialize(){return(0,qi.serializeN3Store)(this.store)}deserialize(e){return wr(this,void 0,void 0,function*(){this.store=(0,qi.deserializeN3Store)(e,qi.DataFactory),this.graph=new Y$(this),this.scene=new K$(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e){var t,i,r,s,o;let a=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),bi.spatialEntity,null,null),e}(n);if(a.size>0&&(a=function(n,e,t=!0){const i=new Set;if(n.forSubjects(ob(e,i),bi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,a)),a.size>0&&("Male"===e.sex||"Female"===e.sex)){const l=e.sex;a=fx(n,a,c=>function(n,e,t){const i=new Set;return n.forSubjects(ob(e,i),bi.sex,bi[t],null),i}(n,c,l))}if(a.size>0&&(null===(t=e.tmc)||void 0===t?void 0:t.length)>0&&(a=fx(n,a,l=>function(n,e,t){const i=new Set;for(const r of t){const s=qi.DataFactory.literal(r);n.forSubjects(ob(e,i),bi.providerName,s,null)}return i}(n,l,e.tmc))),a.size>0&&(null===(i=e.technologies)||void 0===i?void 0:i.length)>0&&(a=function(n,e,t){var i;const r=new Map,s=new Set,o=new Set;n.some(c=>(e.has(c.subject.id)&&o.add(c.object.id),!1),null,bi.sections,null,null),n.some(c=>{var d;return(e.has(c.subject.id)||o.has(c.subject.id))&&(s.add(c.object.id),r.has(c.object.id)?null===(d=r.get(c.object.id))||void 0===d||d.push(c.subject.id):r.set(c.object.id,[c.subject.id])),!1},null,bi.datasets,null,null);const a=t(s),l=new Set;for(const c of a)for(const d of null!==(i=r.get(c))&&void 0!==i?i:[])l.add(d);return l}(n,a,l=>function(n,e,t){const i=new Set;for(const r of t){const s=qi.DataFactory.literal(r);n.forSubjects(ob(e,i),bi.technology,s,null)}return i}(n,l,e.technologies))),a.size>0&&(null===(r=e.ontologyTerms)||void 0===r?void 0:r.length)>0&&(a=function(n,e,t){var i;const r=new Map,s=new Set;n.some(l=>{var c;return e.has(l.subject.id)&&(s.add(l.object.id),r.has(l.object.id)?null===(c=r.get(l.object.id))||void 0===c||c.push(l.subject.id):r.set(l.object.id,[l.subject.id])),!1},null,bi.spatialEntity,null,null);const o=t(s),a=new Set;for(const l of o)for(const c of null!==(i=r.get(l))&&void 0!==i?i:[])a.add(c);return a}(n,a,l=>function(n,e,t){const i=new Set;for(const r of t){const s=qi.DataFactory.namedNode(r);n.forSubjects(ob(e,i),or.spatialEntity.ccf_annotations,s,null)}return i}(n,l,e.ontologyTerms))),a.size>0&&2===(null===(s=e.ageRange)||void 0===s?void 0:s.length)&&(0,pi.isFinite)(e.ageRange[0])&&(0,pi.isFinite)(e.ageRange[1])){const l=Math.max(...e.ageRange),c=Math.min(...e.ageRange);1===c&&110===l||(a=fx(n,a,d=>function(n,e,t,i){const r=new Set;return n.some(s=>{if(e.has(s.subject.id)){const o=(0,lh.fromRdf)(s.object);o>=t&&o<=i&&r.add(s.subject.id)}return!1},null,bi.age,null,null),r}(n,d,c,l)))}if(a.size>0&&2===(null===(o=e.bmiRange)||void 0===o?void 0:o.length)&&(0,pi.isFinite)(e.bmiRange[0])&&(0,pi.isFinite)(e.bmiRange[1])){const l=Math.max(...e.bmiRange),c=Math.min(...e.bmiRange);13===c&&83===l||(a=fx(n,a,d=>function(n,e,t,i){const r=new Set;return n.some(s=>{if(e.has(s.subject.id)){const o=(0,lh.fromRdf)(s.object);o>=t&&o<=i&&r.add(s.subject.id)}return!1},null,bi.bmi,null,null),r}(n,d,c,l)))}return a}(this.store,e)}get(e){return this.store.getQuads(qi.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>KDe(this.store,t))}getTissueBlockResults(e){return wr(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>TMe(this.store,t))})}getAggregateResults(e){return wr(this,void 0,void 0,function*(){return function(n,e){const t=new Set;e.some(l=>(n.has(l.subject.id)&&t.add(l.object.id),!1),null,bi.donor,null,null);const i=new Set;e.some(l=>(t.has(l.subject.id)&&i.add(l.object.id),!1),null,bi.providerUUID,null,null);const r=new Set;e.forSubjects(l=>{n.has(l.id)&&r.add(l.id)},bi.spatialEntity,null,null);const s=new Set;e.some(l=>(r.has(l.subject.id)&&s.add(l.object.id),!1),null,bi.sections,null,null);const o=new Set;return e.some(l=>{const c=l.subject;return(r.has(c.id)||s.has(c.id))&&o.add(l.object.id),!1},null,bi.datasets,null,null),Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return wr(this,void 0,void 0,function*(){return function(n,e){const t=new Map;e.some(r=>(n.has(r.subject.id)&&(t.has(r.object.id)?t.get(r.object.id).push(r.subject.id):t.set(r.object.id,[r.subject.id])),!1),null,bi.spatialEntity,null,null);const i={};return e.some(r=>{var s,o;if(t.has(r.subject.id)){const a=null!==(o=null===(s=t.get(r.subject.id))||void 0===s?void 0:s.length)&&void 0!==o?o:0;i[r.object.id]=a+(i[r.object.id]||0)}return!1},null,or.spatialEntity.ccf_annotations,null,null),i}(this.getIds(e),this.store)})}getOntologyTreeModel(){return wr(this,void 0,void 0,function*(){return function(n){const e={root:W$.body.id,nodes:{}},t=new Set;n.some(i=>(t.add(i.subject.id),t.add(i.predicate.id),!1),null,or.ontologyNode.parent,null,null);for(const i of t)e.nodes[i]=_Me(n,i);return e}(this.store)})}getReferenceOrgans(){return wr(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return wr(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return wr(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}}let OMe=(()=>{class n{constructor(t){this.locator=t,this.subscriptions=new S,this.dbOptions=vg.dbOptions,this.dataSource=function(n,e){return new F(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?Pe(r):Mc).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDataSource(),i=>this.connectDataSource(i.source,this.dbOptions)).pipe(Mu(1)),this.subscriptions.add(this.dataSource.subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}getTissueBlockResults(t){return this.dataSource.pipe(br(i=>i.getTissueBlockResults(t)),Ki(1))}getAggregateResults(t){return this.dataSource.pipe(br(i=>i.getAggregateResults(t)),Ki(1))}getOntologyTermOccurences(t){return this.dataSource.pipe(br(i=>i.getOntologyTermOccurences(t)),Ki(1))}getOntologyTreeModel(){return this.dataSource.pipe(br(t=>t.getOntologyTreeModel()),Ki(1))}getReferenceOrgans(){return this.dataSource.pipe(br(t=>t.getReferenceOrgans()),Ki(1))}getScene(t){return this.dataSource.pipe(br(i=>i.getScene(t).then(r=>r.filter(s=>t.ontologyTerms.includes(s.representation_of)))),Ki(1))}getReferenceOrganScene(t,i){return this.dataSource.pipe(br(r=>r.getReferenceOrganScene(t,i)),Ki(1))}createDataSource(){return{source:new MMe(this.dbOptions),unsubscribe:()=>{}}}connectDataSource(t,i){return wr(this,void 0,void 0,function*(){vg.production||(globalThis.db=t);const r=(new Date).getTime();return yield t.connect(i,!0),vg.production||console.info(`Loaded CCF database in ${((new Date).getTime()-r)/1e3}s`),t})}}return n.\u0275fac=function(t){return new(t||n)(Re(nf))},n.\u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),RMe=(()=>{class n{constructor(t){this.source=t,this.organs=j$}getOrganInfo(t,i,r="Female"){let s=this.organs.find(a=>a.id===t);if(!s)return on(void 0);const o=s.organ;return s.disabled&&(s=this.organs.find(a=>!a.disabled&&a.organ===o)),(null==s?void 0:s.side)&&i&&s.side!==i&&(s=this.organs.find(a=>!a.disabled&&a.organ===o&&a.side===i)),on(s)}getOrgan(t,i="Female"){return this.source.getReferenceOrgans().pipe(ve(r=>r.find(s=>s.representation_of===t.id&&("Both"===i||s.sex===i))))}getOrganScene(t,i="Female"){return this.source.getReferenceOrganScene(t.id,{ontologyTerms:[t.id],sex:i})}getOrganStats(t,i="Female"){return this.source.getAggregateResults({ontologyTerms:[t.id],sex:i})}}return n.\u0275fac=function(t){return new(t||n)(Re(OMe))},n.\u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const NMe=["thumbContainer"],PMe=["toggleBar"],FMe=["input"],LMe=function(n){return{enterDuration:n}},kMe=["*"],BMe=new zt("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let VMe=0;const jMe={provide:Ra,useExisting:fe(()=>eW),multi:!0};class UMe{constructor(e,t){this.source=e,this.checked=t}}const zMe=RN(Qv(ON(jC(class{constructor(n){this._elementRef=n}}))));let eW=(()=>{class n extends zMe{constructor(t,i,r,s,o,a){super(t),this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=l=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++VMe,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new mn,this.toggleChange=new mn,this.tabIndex=parseInt(s)||0,this.color=this.defaultColor=o.color||"accent",this._noopAnimations="NoopAnimations"===a}get required(){return this._required}set required(t){this._required=Ui(t)}get checked(){return this._checked}set checked(t){this._checked=Ui(t),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?this._inputElement.nativeElement.focus():t||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new UMe(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(t){return new(t||n)(De(wn),De(Wu),De(as),function(n){return function(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(vb(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Zr(),n)}("tabindex"),De(BMe),De(ec,8))},n.\u0275cmp=yn({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(t,i){if(1&t&&(Mr(NMe,5),Mr(PMe,5),Mr(FMe,5)),2&t){let r;di(r=hi())&&(i._thumbEl=r.first),di(r=hi())&&(i._thumbBarEl=r.first),di(r=hi())&&(i._inputElement=r.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(t,i){2&t&&(vu("id",i.id),ji("tabindex",i.disabled?null:-1)("aria-label",null)("aria-labelledby",null),wi("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked",ariaDescribedby:["aria-describedby","ariaDescribedby"]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Wn([jMe]),Mn],ngContentSelectors:kMe,decls:16,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,i){if(1&t&&(function(n){const e=kt()[16][6];if(!e.projection){const i=e.projection=dc(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?qW(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}(),Pt(0,"label",0,1),Pt(2,"div",2,3),Pt(4,"input",4,5),kn("change",function(s){return i._onChangeEvent(s)})("click",function(s){return i._onInputClick(s)}),Ft(),Pt(6,"div",6,7),xi(8,"div",8),Pt(9,"div",9),xi(10,"div",10),Ft(),Ft(),Ft(),Pt(11,"span",11,12),kn("cdkObserveContent",function(){return i._onLabelTextChange()}),Pt(13,"span",13),Ei(14,"\xa0"),Ft(),function(n,e=0,t){const i=kt(),r=ui(),s=Md(r,20+n,16,null,t||null);null===s.projection&&(s.projection=e),os(),64!=(64&s.flags)&&function(n,e,t){T_(e[11],0,e,t,h0(n,t,e),m0(t.parent||e[6],t,e))}(r,i,s)}(15),Ft(),Ft()),2&t){const r=Gp(1),s=Gp(12);ji("for",i.inputId),Yt(2),wi("mat-slide-toggle-bar-no-side-margin",!s.textContent||!s.textContent.trim()),Yt(2),an("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),ji("name",i.name)("aria-checked",i.checked.toString())("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),Yt(5),an("matRippleTrigger",r)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",function(n,e,t,i){return D2(kt(),_s(),n,e,t,i)}(18,LMe,i._noopAnimations?0:150))}},directives:[dm,y6],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),n})(),tW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({}),n})(),$Me=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[tW,zC,hr,ZR],tW,hr]}),n})(),WMe=(()=>{class n{constructor(){this.clsName="ccf-slide-toggle",this.labels=["Left","Right"],this.value="Left",this.disabled=!1,this.valueChange=new mn}get left(){const{value:t,labels:i}=this;return t!==i[1]}updateToggle(t){this.value=t?this.labels[0]:this.labels[1],this.valueChange.emit(this.value)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-slide-toggle"]],hostVars:2,hostBindings:function(t,i){2&t&&Sc(i.clsName)},inputs:{labels:"labels",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:6,vars:12,consts:[[1,"slide-label",3,"click"],[1,"slider",3,"disabled","checked","change"],["toggle",""]],template:function(t,i){if(1&t){const r=yu();Pt(0,"span",0),kn("click",function(){jo(r);const o=Gp(3);return i.left||o.toggle(),i.updateToggle(!0)}),Ei(1),Ft(),Pt(2,"mat-slide-toggle",1,2),kn("change",function(o){return i.updateToggle(!o.checked)}),Ft(),Pt(4,"span",0),kn("click",function(){jo(r);const o=Gp(3);return i.left&&o.toggle(),i.updateToggle(!1)}),Ei(5),Ft()}2&t&&(wi("disabled",i.disabled)("highlighted",i.left),Yt(1),Cs(i.labels[0].charAt(0).toUpperCase()+i.labels[0].slice(1)),Yt(1),an("disabled",i.disabled)("checked",!i.left),Yt(2),wi("disabled",i.disabled)("highlighted",!i.left),Yt(1),Cs(i.labels[1].charAt(0).toUpperCase()+i.labels[1].slice(1)))},directives:[eW],styles:["[_nghost-%COMP%]   .slide-label[_ngcontent-%COMP%]{margin:0 1rem;transition:color .6s;cursor:pointer;opacity:50%}[_nghost-%COMP%]   .slide-label.highlighted[_ngcontent-%COMP%]{opacity:100%}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:30%!important;cursor:not-allowed}[_nghost-%COMP%]     .slider .mat-slide-toggle-bar{background-color:#43476580}[_nghost-%COMP%]     .slider .mat-slide-toggle-thumb{background-color:#434765}"],changeDetection:0}),n})();const qMe=["bodyUI"],YMe=function(){return["Male","Female"]},KMe=function(){return["Left","Right"]};let XMe=(()=>{class n{constructor(t){this.ga=t,this.sexChange=new mn,this.sideChange=new mn}ngOnInit(){this.reset()}ngOnChanges(t){this.bodyUI&&"organ"in t&&this.reset()}updateSex(t){this.sex=t,this.sexChange.emit(this.sex)}updateSide(t){this.side=t,this.sideChange.emit(this.side)}reset(){const{bodyUI:t,organ:i}=this;if(i){i.side||(this.side=void 0);const{x_dimension:r,y_dimension:s,z_dimension:o}=i;t.rotation=t.rotationX=0,t.bounds={x:1.25*r/1e3,y:1.25*s/1e3,z:1.25*o/1e3},t.target=[r/1e3/2,s/1e3/2,o/1e3/2]}}}return n.\u0275fac=function(t){return new(t||n)(De(PE))},n.\u0275cmp=yn({type:n,selectors:[["ccf-organ"]],viewQuery:function(t,i){if(1&t&&Mr(qMe,7),2&t){let r;di(r=hi())&&(i.bodyUI=r.first)}},inputs:{organ:"organ",scene:"scene",organIri:"organIri",sex:"sex",side:"side"},outputs:{sexChange:"sexChange",sideChange:"sideChange"},features:[ki],decls:5,vars:9,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick"],["bodyUI",""],[1,"stage-options"],[1,"view-slider",3,"labels","value","valueChange"],[1,"view-slider",3,"labels","value","disabled","valueChange"]],template:function(t,i){1&t&&(Pt(0,"ccf-body-ui",0,1),kn("nodeClick",function(s){return i.ga.event("node_click","organ",s.node["@id"])}),Ft(),Pt(2,"div",2),Pt(3,"ccf-slide-toggle",3),kn("valueChange",function(s){return i.updateSex(s)}),Ft(),Pt(4,"ccf-slide-toggle",4),kn("valueChange",function(s){return i.updateSide(s)}),Ft(),Ft()),2&t&&(an("scene",i.scene)("interactive",!0),Yt(3),an("labels",Mw(7,YMe))("value",i.sex),Yt(1),an("labels",Mw(8,KMe))("value",i.side)("disabled",!i.side))},directives:[ZTe,WMe],styles:["[_nghost-%COMP%]{display:block;background-color:#000;border-radius:.5rem;color:#fff;height:100%}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{height:90%}[_nghost-%COMP%]   .stage-options[_ngcontent-%COMP%]{padding:1rem;min-width:352px}"],changeDetection:0}),n})();function QMe(n,e){if(1&n&&(Pt(0,"div",3),Pt(1,"div",4),Ei(2),Ft(),Pt(3,"div",5),Ei(4),Ft(),Ft()),2&n){const t=e.$implicit;Yt(2),Cs(t.count),Yt(2),Cs(t.label)}}let ZMe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-stats-list"]],inputs:{statsLabel:"statsLabel",stats:"stats"},decls:4,vars:2,consts:[[1,"stats-container"],[1,"header"],["class","stats-row",4,"ngFor","ngForOf"],[1,"stats-row"],[1,"stat"],[1,"label"]],template:function(t,i){1&t&&(Pt(0,"div",0),Pt(1,"div",1),Ei(2),Ft(),Di(3,QMe,5,2,"div",2),Ft()),2&t&&(Yt(2),xc(" ",i.statsLabel," "),Yt(1),an("ngForOf",i.stats))},directives:[Vd],styles:[".stats-container[_ngcontent-%COMP%]{margin-bottom:2rem;min-height:9rem}.stats-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:1rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:1.325rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:2rem;margin-right:1rem;text-align:right}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"],changeDetection:0}),n})();function JMe(n,e){if(1&n){const t=yu();Pt(0,"div",6),Pt(1,"div",7),Pt(2,"div",8),Ei(3),Ft(),Pt(4,"div",9),kn("click",function(){const s=jo(t).$implicit;return vr().goToURL(s.buttonUrl)}),Ei(5),Ft(),Ft(),Ft()}if(2&n){const t=e.$implicit;Yt(3),Cs(t.body),Yt(1),an("gaLabel",t.buttonUrl),Yt(1),xc(" ",t.buttonTitle,"")}}function eIe(n,e){if(1&n){const t=yu();Pt(0,"div",10),kn("click",function(){const s=jo(t).$implicit;return vr().goToURL(s.buttonUrl)}),Ei(1),Ft()}if(2&n){const t=e.$implicit;an("gaLabel",t.buttonUrl),Yt(1),Cs(t.buttonTitle)}}let tIe=(()=>{class n{constructor(){this.linkCards=[{body:"Add tissue blocks using the CCF Registration User Interface (RUI).",buttonTitle:"Register Tissue",buttonUrl:"https://hubmapconsortium.github.io/ccf-ui/rui/"},{body:"Explore tissue sections in tissue blocks with the CCF Exploration User Interface (EUI).",buttonTitle:"Explore Tissue",buttonUrl:"https://portal.hubmapconsortium.org/ccf-eui"},{body:"View linkages between anatomical structures, cell types, and common biomarkers (ASCT+B).",buttonTitle:"ASCT+B Reporter",buttonUrl:"https://hubmapconsortium.github.io/ccf-asct-reporter/"}],this.deepDives=[{body:"",buttonTitle:"CCF Portal",buttonUrl:"https://hubmapconsortium.github.io/ccf/"},{body:"",buttonTitle:"Online Course",buttonUrl:"https://expand.iu.edu/browse/sice/cns/courses/hubmap-visible-human-mooc"},{body:"",buttonTitle:"Paper",buttonUrl:"https://www.biorxiv.org/content/10.1101/2021.05.31.446440v2"}]}goToURL(t){window.open(t,"_blank")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-link-cards"]],decls:7,vars:2,consts:[["gaCategory","link-cards",1,"link-cards-container"],["class","link-card",4,"ngFor","ngForOf"],["gaCategory","deep-dive",1,"deep-dive-section"],[1,"title"],[1,"button-container"],["class","btn-outline btn","gaEvent","visit-link",3,"gaLabel","click",4,"ngFor","ngForOf"],[1,"link-card"],[1,"link-card-content"],[1,"body"],["gaEvent","visit-link",1,"link-button","btn",3,"gaLabel","click"],["gaEvent","visit-link",1,"btn-outline","btn",3,"gaLabel","click"]],template:function(t,i){1&t&&(Pt(0,"div",0),Di(1,JMe,6,3,"div",1),Ft(),Pt(2,"div",2),Pt(3,"div",3),Ei(4,"Common Coordinate Framework (CCF) Deep Dive"),Ft(),Pt(5,"div",4),Di(6,eIe,2,2,"div",5),Ft(),Ft()),2&t&&(Yt(1),an("ngForOf",i.linkCards),Yt(5),an("ngForOf",i.deepDives))},directives:[BB,Vd,jB],styles:[".link-cards-container[_ngcontent-%COMP%]{max-width:30rem}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:1px;padding-bottom:1px}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid #e0e0e0}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]{align-items:center;padding:1rem 0 1rem 1rem;display:flex;flex-direction:row;justify-content:space-between;border-left:6px solid #444A65}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]{margin-left:2rem;background-color:#444a65;color:#fff}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]:hover{background-color:#2f3346}.deep-dive-section[_ngcontent-%COMP%]{margin-top:2rem}.deep-dive-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{color:#444a65;border:1px solid #444A65;background-color:#fff}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:not(:last-of-type){margin-right:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn[_ngcontent-%COMP%]{min-width:9rem!important;max-height:2.28125rem;text-align:center;white-space:nowrap;cursor:pointer;font-size:.875rem;font-weight:500;border-radius:2px;line-height:2.75;transition:background-color .25s cubic-bezier(.4,0,.2,1) 0ms,box-shadow .25s cubic-bezier(.4,0,.2,1) 0ms,border .25s cubic-bezier(.4,0,.2,1) 0ms;font-family:Inter Variable,Helvetica,Arial,sans-serif}"],changeDetection:0}),n})();const nIe=["left"],iIe=["right"],rIe=function(){return[]},sIe=[{color:[0,0,0,0],opacity:.001}];let oIe=(()=>{class n{constructor(t,i){this.ga=i,this.sex="Female",this.side="Left",this.inputChangedTick$=new hg(1),this.organInfo$=this.inputChangedTick$.pipe(br(()=>{var r,s,o;return t.getOrganInfo(null!==(r=this.organIri)&&void 0!==r?r:"",null===(o=null===(s=this.side)||void 0===s?void 0:s.toLowerCase)||void 0===o?void 0:o.call(s),this.sex)}),ts(r=>this.logOrganLookup(r)),Mu(1)),this.organ$=this.organInfo$.pipe(br(r=>r?t.getOrgan(r,this.sex):on(void 0)),Mu(1)),this.scene$=this.organ$.pipe($y(this.organInfo$),br(([r,s])=>r&&s?t.getOrganScene(s,this.sex):on(sIe))),this.stats$=this.organInfo$.pipe(br(r=>r?t.getOrganStats(r,this.sex):on([]))),this.statsLabel$=this.stats$.pipe($y(this.organInfo$),ve(([r,s])=>this.makeStatsLabel(s)),function(...n){const e=n[n.length-1];return Te(e)?(n.pop(),t=>gE(n,t,e)):t=>gE(n,t)}("Loading..."))}ngAfterViewInit(){const{left:t,right:i}=this;t.nativeElement.style.height=`${i.nativeElement.offsetHeight}px`}ngOnChanges(t){this.handleInputChanges(t)}updateInput(t,i){const r={[t]:new zf(this[t],i,!1)};this[t]=i,this.handleInputChanges(r)}handleInputChanges(t){const i=["organIri","sex","side"];let r=!1;for(const s of i)s in t&&(this.logInputChange(s,t[s].currentValue),r=!0);r&&this.inputChangedTick$.next()}makeStatsLabel(t){let i=[`Unknown IRI: ${this.organIri}`];return t&&(i=[this.sex,t.organ,t.side]),i.filter(r=>!!r).join(", ")}logInputChange(t,i){const s=`update_${t.replace(/[A-Z]/g,o=>`_${o.toLowerCase()}`)}`;this.ga.event(s,"organ",`${i}`)}logOrganLookup(t){this.ga.event(t?"organ_lookup_success":"organ_lookup_failure","organ",`Iri: ${this.organIri} - Sex: ${this.sex} - Side: ${this.side}`)}}return n.\u0275fac=function(t){return new(t||n)(De(RMe),De(PE))},n.\u0275cmp=yn({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&(Mr(nIe,7,wn),Mr(iIe,7,wn)),2&t){let r;di(r=hi())&&(i.left=r.first),di(r=hi())&&(i.right=r.first)}},inputs:{organIri:"organIri",sex:"sex",side:"side"},features:[ki],decls:12,vars:15,consts:[[1,"container"],[1,"left"],["left",""],[3,"sex","side","organ","scene","sexChange","sideChange"],[1,"right"],["right",""],[3,"statsLabel","stats"]],template:function(t,i){if(1&t&&(Pt(0,"div",0),Pt(1,"div",1,2),Pt(3,"ccf-organ",3),kn("sexChange",function(s){return i.updateInput("sex",s)})("sideChange",function(s){return i.updateInput("side",s)}),Fd(4,"async"),Fd(5,"async"),Ft(),Ft(),Pt(6,"div",4,5),xi(8,"ccf-stats-list",6),Fd(9,"async"),Fd(10,"async"),xi(11,"ccf-link-cards"),Ft(),Ft()),2&t){let r;Yt(3),an("sex",i.sex)("side",i.side)("organ",Ld(4,6,i.organ$))("scene",null!==(r=Ld(5,8,i.scene$))&&void 0!==r?r:Mw(14,rIe)),Yt(5),an("statsLabel",Ld(9,10,i.statsLabel$))("stats",Ld(10,12,i.stats$))}},directives:[XMe,ZMe,tIe],pipes:[iE],styles:[".container[_ngcontent-%COMP%]{width:100%;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:row;padding:1rem;font-family:Inter;font-size:.95rem;line-height:1.5;text-align:left;position:relative;background-color:#fff;color:#000}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:auto;flex-grow:1}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:2rem;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:29rem}"],changeDetection:0}),n})(),aIe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[Yr,$Me]]}),n})(),lIe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[Yr,JTe,aIe]]}),n})(),cIe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[Yr,FE]]}),n})(),uIe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({imports:[[Yr]]}),n})(),dIe=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(sl).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new LJ(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends BJ{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,d){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(oIe,{injector:this.injector});customElements.define("ccf-organ-info",t)}}return n.\u0275fac=function(t){return new(t||n)(Re(Hn))},n.\u0275mod=cn({type:n}),n.\u0275inj=Et({providers:[],imports:[[VD,cIe,uIe,lIe,Ine.forRoot({gaToken:vg.googleAnalyticsToken,appName:"organ-info",projectName:"ccf",developmentMode:!vg.production})]]}),n})();vg.production&&function(){if(ck)throw new Error("Cannot enable prod mode after platform setup.");lk=!1}(),sJ().bootstrapModule(dIe).catch(n=>console.error(n))},52:Vt=>{function it(gt,J,xt,ut,Y,Ae,he){try{var W=gt[Ae](he),j=W.value}catch(L){return void xt(L)}W.done?J(j):Promise.resolve(j).then(ut,Y)}Vt.exports=function(gt){return function(){var J=this,xt=arguments;return new Promise(function(ut,Y){var Ae=gt.apply(J,xt);function he(j){it(Ae,ut,Y,he,W,"next",j)}function W(j){it(Ae,ut,Y,he,W,"throw",j)}he(void 0)})}},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},948:Vt=>{Vt.exports=function(tt){return tt&&tt.__esModule?tt:{default:tt}},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},321:Vt=>{function it(tt){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(Vt.exports=it=function(J){return typeof J},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0):(Vt.exports=it=function(J){return J&&"function"==typeof Symbol&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0),it(tt)}Vt.exports=it,Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},82:Vt=>{function it(tt){return Promise.resolve().then(()=>{var gt=new Error("Cannot find module '"+tt+"'");throw gt.code="MODULE_NOT_FOUND",gt})}it.keys=()=>[],it.resolve=it,it.id=82,Vt.exports=it},521:()=>{},125:()=>{},307:()=>{}},Vt=>{Vt(Vt.s=888)}]);