(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:t=>{t.exports=function t(e,n,r){function i(o,a){if(!n[o]){if(!e[o]){if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){return i(e[o][1][t]||t)},c,c.exports,t,e,n,r)}return n[o].exports}for(var s=void 0,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){!function(r,i){"object"==typeof n&&void 0!==e?i(n,t("jsonld"),t("n3"),t("rdfxml-streaming-parser"),t("readable-stream")):i((r="undefined"!=typeof globalThis?globalThis:r||self).tripleStoreUtils={},r.jsonld,r.n3,r.rdfxmlStreamingParser,r.readablestream)}(this,function(t,e,n,r,i){"use strict";function s(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(e){s(e)}}function a(t){try{u(r.throw(t))}catch(e){s(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}function o(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function a(t){var e=t.length,n=0;return new i.Readable({objectMode:!0,read:function(){this.push(n<e?t[n++]:null)}})}t.addJsonLdToStore=function(t,n){return s(this,void 0,void 0,function(){var r,i,s;return o(this,function(o){switch(o.label){case 0:return"string"!=typeof t?[3,4]:[4,fetch(t,{redirect:"follow"})];case 1:return(i=o.sent()).ok?[4,i.json()]:[3,3];case 2:r=o.sent(),o.label=3;case 3:return[3,5];case 4:r=t,o.label=5;case 5:return r?[4,e.toRDF(r)]:[3,7];case 6:s=o.sent(),n.import(a(s)),o.label=7;case 7:return[2,n]}})})},t.addN3ToStore=function(t,e){return s(this,void 0,void 0,function(){var r,i,s;return o(this,function(o){switch(o.label){case 0:return"string"==typeof t&&(null==t?void 0:t.startsWith("http"))?[4,fetch(t,{redirect:"follow"})]:[3,4];case 1:return(i=o.sent()).ok?[4,i.text()]:[3,3];case 2:r=o.sent(),o.label=3;case 3:return[3,5];case 4:r=t,o.label=5;case 5:return r&&(s=new n.Parser({format:"n3"}).parse(r),e.import(a(s))),[2,e]}})})},t.addRdfXmlToStore=function(t,e){return s(this,void 0,void 0,function(){var i,s,a,u;return o(this,function(o){switch(o.label){case 0:return"string"==typeof t&&(null==t?void 0:t.startsWith("http"))?[4,fetch(t,{redirect:"follow"})]:[3,4];case 1:return(s=o.sent()).ok?[4,s.text()]:[3,3];case 2:i=o.sent(),o.label=3;case 3:return[3,5];case 4:i=t,o.label=5;case 5:return i?(a=new r.RdfXmlParser({dataFactory:n.DataFactory,strict:!0}),u=new Promise(function(t){a.once("end",function(){return t(e)})}),e.import(a),a.write(i),a.end(),[2,u]):[2,e]}})})},t.arrayToStream=a,t.deserializeN3Store=function(t,e){var r=JSON.parse(t),i=new n.Store;return Object.assign(i,r,{_factory:null!=e?e:n.DataFactory}),i},t.serializeN3Store=function(t){var e=Object.assign({},t);return delete e._factory,JSON.stringify(e)},t.streamToArray=function(t){return new Promise(function(e,n){var r=[];t.on("data",function(t){r.push(t)}).once("end",function(){e(r)}).once("error",function(t){n(t)})})},Object.keys(n).forEach(function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}),Object.defineProperty(t,"__esModule",{value:!0})})},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(t,e,n){"use strict";n.byteLength=function(t){var e=c(t),n=e[1];return 3*(e[0]+n)/4-n},n.toByteArray=function(t){var e,n,r=c(t),o=r[0],a=r[1],u=new s(function(t,e,n){return 3*(e+n)/4-n}(0,o,a)),l=0,h=a>0?o-4:o;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;return 2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e),1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e),u},n.fromByteArray=function(t){for(var e,n=t.length,i=n%3,s=[],o=16383,a=0,u=n-i;a<u;a+=o)s.push(l(t,a,a+o>u?u:a+o));return 1===i?s.push(r[(e=t[n-1])>>2]+r[e<<4&63]+"=="):2===i&&s.push(r[(e=(t[n-2]<<8)+t[n-1])>>10]+r[e>>4&63]+r[e<<2&63]+"="),s.join("")};for(var r=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=o.length;a<u;++a)r[a]=o[a],i[o.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i=[],s=e;s<n;s+=3)i.push(r[(o=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]))>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);var o;return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],3:[function(t,e,n){},{}],4:[function(t,e,n){var r=t("buffer"),i=r.Buffer;function s(t,e){for(var n in t)e[n]=t[n]}function o(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(s(r,n),n.Buffer=o),s(i,o),o.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},o.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},{buffer:6}],5:[function(t,e,n){"use strict";var r=t("safe-buffer").Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=c,e=4;break;case"utf8":this.fillLast=a,e=4;break;case"base64":this.text=l,this.end=h,e=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function o(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function a(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"\ufffd";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"\ufffd";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"\ufffd"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function c(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):e}function l(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function h(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function d(t){return t.toString(this.encoding)}function f(t){return t&&t.length?this.write(t):""}n.StringDecoder=s,s.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},s.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\ufffd":e},s.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=o(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=o(e[r]))>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=o(e[r]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},s.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},{"safe-buffer":4}],6:[function(t,e,n){(function(e){(function(){"use strict";var e=t("base64-js"),r=t("ieee754");n.Buffer=o,n.SlowBuffer=function(t){return+t!=t&&(t=0),o.alloc(+t)},n.INSPECT_MAX_BYTES=50;var i=2147483647;function s(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=o.prototype,e}function o(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return c(t)}return a(t,e,n)}function a(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|d(t,e),r=s(n),i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}(t,e);if(ArrayBuffer.isView(t))return l(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(B(t,ArrayBuffer)||t&&B(t.buffer,ArrayBuffer))return function(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return(r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n)).__proto__=o.prototype,r}(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return o.from(r,e,n);var i=function(t){if(o.isBuffer(t)){var e=0|h(t.length),n=s(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||z(t.length)?s(0):l(t):"Buffer"===t.type&&Array.isArray(t.data)?l(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function c(t){return u(t),s(t<0?0:0|h(t))}function l(t){for(var e=t.length<0?0:0|h(t.length),n=s(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function h(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function d(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||B(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(t).length;default:if(i)return r?-1:j(t).length;e=(""+e).toLowerCase(),i=!0}}function f(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return T(this,e,n);case"latin1":case"binary":return C(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function p(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),z(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,i){var s,o=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,u/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var l=-1;for(s=n;s<a;s++)if(c(t,s)===c(e,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===u)return l*o}else-1!==l&&(s-=s-l),l=-1}else for(n+u>a&&(n=a-u),s=n;s>=0;s--){for(var h=!0,d=0;d<u;d++)if(c(t,s+d)!==c(e,d)){h=!1;break}if(h)return s}return-1}function y(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=e.length;r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(z(a))return o;t[n+o]=a}return o}function b(t,e,n,r){return F(j(e,t.length-n),t,n,r)}function _(t,e,n,r){return F(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function v(t,e,n,r){return _(t,e,n,r)}function w(t,e,n,r){return F(L(e),t,n,r)}function x(t,e,n,r){return F(function(t,e){for(var n,r,i=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i.push(n%256),i.push(r);return i}(e,t.length-n),t,n,r)}function E(t,n,r){return e.fromByteArray(0===n&&r===t.length?t:t.slice(n,r))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var s,o,a,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(s=t[i+1]))&&(u=(31&c)<<6|63&s)>127&&(l=u);break;case 3:o=t[i+2],128==(192&(s=t[i+1]))&&128==(192&o)&&(u=(15&c)<<12|(63&s)<<6|63&o)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+2],a=t[i+3],128==(192&(s=t[i+1]))&&128==(192&o)&&128==(192&a)&&(u=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(r.push((l-=65536)>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=A));return n}(r)}n.kMaxLength=i,(o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(t,e,n){return a(t,e,n)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(t,e,n){return function(t,e,n){return u(t),t<=0?s(t):void 0!==e?"string"==typeof n?s(t).fill(e,n):s(t).fill(e):s(t)}(t,e,n)},o.allocUnsafe=function(t){return c(t)},o.allocUnsafeSlow=function(t){return c(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(B(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),B(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=o.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(B(s,Uint8Array)&&(s=o.from(s)),!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},o.byteLength=d,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)p(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)p(this,e,e+3),p(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)p(this,e,e+7),p(this,e+1,e+6),p(this,e+2,e+5),p(this,e+3,e+4);return this},o.prototype.toLocaleString=o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?S(this,0,t):f.apply(this,arguments)},o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},o.prototype.compare=function(t,e,n,r,i){if(B(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),u=Math.min(s,a),c=this.slice(r,i),l=t.slice(e,n),h=0;h<u;++h)if(c[h]!==l[h]){s=c[h],a=l[h];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},o.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},o.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},o.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return v(this,t,e,n);case"base64":return w(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function T(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function I(t,e,n){var r,i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var s="",o=e;o<n;++o)s+=(r=t[o])<16?"0"+r.toString(16):r.toString(16);return s}function D(t,e,n){for(var r=t.slice(e,n),i="",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function k(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,n,r,i,s){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function M(t,e,n,r,i,s){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(t,e,n,i,s){return e=+e,n>>>=0,s||M(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function N(t,e,n,i,s){return e=+e,n>>>=0,s||M(t,0,n,8),r.write(t,e,n,i,52,8),n+8}o.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return r.__proto__=o.prototype,r},o.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||k(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r},o.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||k(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},o.prototype.readUInt8=function(t,e){return t>>>=0,e||k(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||k(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||k(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||k(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||k(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||k(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||k(t,e,this.length);for(var r=e,i=1,s=this[t+--r];r>0&&(i*=256);)s+=this[t+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},o.prototype.readInt8=function(t,e){return t>>>=0,e||k(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||k(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(t,e){t>>>=0,e||k(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||k(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||k(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||k(t,4,this.length),r.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||k(t,4,this.length),r.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||k(t,8,this.length),r.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||k(t,8,this.length),r.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||O(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[e]=255&t;++s<n&&(i*=256);)this[e+s]=t/i&255;return e+n},o.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||O(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+n},o.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);O(this,t,e,n,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},o.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);O(this,t,e,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,n){return P(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return P(this,t,e,!1,n)},o.prototype.writeDoubleLE=function(t,e,n){return N(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return N(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,r){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var s=i-1;s>=0;--s)t[s+e]=this[s+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return i},o.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var a=o.isBuffer(t)?t:o.from(t,r),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<n-e;++s)this[s+e]=a[s%u]}return this};var R=/[^+/0-9A-Za-z-_]/g;function j(t,e){var n;e=e||1/0;for(var r=t.length,i=null,s=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function L(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(R,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function F(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function B(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function z(t){return t!=t}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(t,e,n){"use strict";e.exports=function t(e){return null===e||"object"!=typeof e||null!=e.toJSON?JSON.stringify(e):Array.isArray(e)?"["+e.reduce((e,n,r)=>e+(0===r?"":",")+t(void 0===n||"symbol"==typeof n?null:n),"")+"]":"{"+Object.keys(e).sort().reduce((n,r,i)=>void 0===e[r]||"symbol"==typeof e[r]?n:n+(0===n.length?"":",")+t(r)+":"+t(e[r]),"")+"}"}},{}],8:[function(t,e,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,s=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(t,e){return new Promise(function(n,r){function i(n){t.removeListener(e,s),r(n)}function s(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}y(t,e,s,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&y(t,"error",e,{once:!0})}(t,i)})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var u=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function h(t,e,n,r){var i,s,o;if(c(n),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),void 0===o)o=s[e]=n,++t._eventsCount;else if("function"==typeof o?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=l(t))>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,console&&console.warn&&console.warn(a)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function p(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):m(i,i.length)}function g(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function y(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=i[t];if(void 0===u)return!1;if("function"==typeof u)s(u,this,e);else{var c=u.length,l=m(u,c);for(n=0;n<c;++n)s(l[n],this,e)}return!0},a.prototype.on=a.prototype.addListener=function(t,e){return h(this,t,e,!1)},a.prototype.prependListener=function(t,e){return h(this,t,e,!0)},a.prototype.once=function(t,e){return c(e),this.on(t,f(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,f(this,t,e)),this},a.prototype.off=a.prototype.removeListener=function(t,e){var n,r,i,s,o;if(c(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===e||n[s].listener===e){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,o||e)}return this},a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return p(this,t,!0)},a.prototype.rawListeners=function(t){return p(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},a.prototype.listenerCount=g,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},{}],9:[function(t,e,n){n.read=function(t,e,n,r,i){var s,o,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,d=n?-1:1,f=t[e+h];for(h+=d,s=f&(1<<-l)-1,f>>=-l,l+=a;l>0;s=256*s+t[e+h],h+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=r;l>0;o=256*o+t[e+h],h+=d,l-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),s-=c}return(f?-1:1)*o*Math.pow(2,s-r)},n.write=function(t,e,n,r,i,s){var o,a,u,c=8*s-i-1,l=(1<<c)-1,h=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:s-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(a=0,o=l):o+h>=1?(a=(e*u-1)*Math.pow(2,i),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[n+f]=255&a,f+=p,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;t[n+f]=255&o,f+=p,o/=256,c-=8);t[n+f-p]|=128*g}},{}],10:[function(t,e,n){e.exports="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},{}],11:[function(t,e,n){"use strict";const{isArray:r,isObject:i,isString:s}=t("./types"),{asArray:o}=t("./util"),{prependBase:a}=t("./url"),u=t("./JsonLdError"),c=t("./ResolvedContext");function l(t){throw new u("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:t})}function h({context:t,base:e}){if(!t)return;const n=t["@context"];if(s(n))t["@context"]=a(e,n);else if(r(n))for(let r=0;r<n.length;++r){const t=n[r];s(t)?n[r]=a(e,t):i(t)&&h({context:{"@context":t},base:e})}else if(i(n))for(const r in n)h({context:n[r],base:e})}e.exports=class{constructor({sharedCache:t}){this.perOpCache=new Map,this.sharedCache=t}async resolve({activeCtx:t,context:e,documentLoader:n,base:a,cycles:u=new Set}){e&&i(e)&&e["@context"]&&(e=e["@context"]),e=o(e);const h=[];for(const o of e){if(s(o)){let e=this._get(o);e||(e=await this._resolveRemoteContext({activeCtx:t,url:o,documentLoader:n,base:a,cycles:u})),r(e)?h.push(...e):h.push(e);continue}if(null===o){h.push(new c({document:null}));continue}i(o)||l(e);const d=JSON.stringify(o);let f=this._get(d);f||(f=new c({document:o}),this._cacheResolvedContext({key:d,resolved:f,tag:"static"})),h.push(f)}return h}_get(t){let e=this.perOpCache.get(t);if(!e){const n=this.sharedCache.get(t);n&&(e=n.get("static"),e&&this.perOpCache.set(t,e))}return e}_cacheResolvedContext({key:t,resolved:e,tag:n}){if(this.perOpCache.set(t,e),void 0!==n){let r=this.sharedCache.get(t);r||(r=new Map,this.sharedCache.set(t,r)),r.set(n,e)}return e}async _resolveRemoteContext({activeCtx:t,url:e,documentLoader:n,base:r,cycles:i}){e=a(r,e);const{context:s,remoteDoc:o}=await this._fetchContext({activeCtx:t,url:e,documentLoader:n,cycles:i});h({context:s,base:r=o.documentUrl||e});const u=await this.resolve({activeCtx:t,context:s,documentLoader:n,base:r,cycles:i});return this._cacheResolvedContext({key:e,resolved:u,tag:o.tag}),u}async _fetchContext({activeCtx:t,url:e,documentLoader:n,cycles:o}){if(o.size>10)throw new u("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===t.processingMode?"loading remote context failed":"context overflow",max:10});if(o.has(e))throw new u("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===t.processingMode?"recursive context inclusion":"context overflow",url:e});let a,c;o.add(e);try{c=await n(e),a=c.document||null,s(a)&&(a=JSON.parse(a))}catch(l){throw new u("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:e,cause:l})}if(!i(a))throw new u("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:e});return a="@context"in a?{"@context":a["@context"]}:{"@context":{}},c.contextUrl&&(r(a["@context"])||(a["@context"]=[a["@context"]]),a["@context"].push(c.contextUrl)),{context:a,remoteDoc:c}}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(t,e,n){"use strict";e.exports=class extends Error{constructor(t="An unspecified JSON-LD error occurred.",e="jsonld.Error",n={}){super(t),this.name=e,this.message=t,this.details=n}}},{}],13:[function(t,e,n){"use strict";e.exports=t=>{class e{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(e,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(e.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:e}),e.compact=function(e,n){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):t.compact(e,n)},e.expand=function(e){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):t.expand(e)},e.flatten=function(e){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):t.flatten(e)},e}},{}],14:[function(t,e,n){"use strict";e.exports=t("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(t,e,n){"use strict";e.exports=class{constructor(){this._requests={}}wrapLoader(t){const e=this;return e._loader=t,function(){return e.add.apply(e,arguments)}}async add(t){let e=this._requests[t];if(e)return Promise.resolve(e);e=this._requests[t]=this._loader(t);try{return await e}finally{delete this._requests[t]}}}},{}],16:[function(t,e,n){"use strict";const r=t("lru-cache");e.exports=class{constructor({document:t}){this.document=t,this.cache=new r({max:10})}getProcessed(t){return this.cache.get(t)}setProcessed(t,e){this.cache.set(t,e)}}},{"lru-cache":33}],17:[function(t,e,n){"use strict";const r=t("./JsonLdError"),{isArray:i,isObject:s,isString:o,isUndefined:a}=t("./types"),{isList:u,isValue:c,isGraph:l,isSimpleGraph:h,isSubjectReference:d}=t("./graphTypes"),{expandIri:f,getContextValue:p,isKeyword:g,process:m,processingMode:y}=t("./context"),{removeBase:b,prependBase:_}=t("./url"),{addValue:v,asArray:w,compareShortestLeast:x}=t("./util"),E={};function S(t,e,n){if("@nest"!==f(t,e,{vocab:!0},n))throw new r("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}e.exports=E,E.compact=async({activeCtx:t,activeProperty:e=null,element:n,options:f={},compactionMap:b=(()=>{})})=>{if(i(n)){let r=[];for(let i=0;i<n.length;++i){let s=await E.compact({activeCtx:t,activeProperty:e,element:n[i],options:f,compactionMap:b});null===s&&(s=await b({unmappedValue:n[i],activeCtx:t,activeProperty:e,parent:n,index:i,options:f}),void 0===s)||r.push(s)}return f.compactArrays&&1===r.length&&0===(p(t,e,"@container")||[]).length&&(r=r[0]),r}const _=p(t,e,"@context");if(a(_)||(t=await m({activeCtx:t,localCtx:_,propagate:!0,overrideProtected:!0,options:f})),s(n)){if(f.link&&"@id"in n&&f.link.hasOwnProperty(n["@id"])){const t=f.link[n["@id"]];for(let e=0;e<t.length;++e)if(t[e].expanded===n)return t[e].compacted}if(c(n)||d(n)){const r=E.compactValue({activeCtx:t,activeProperty:e,value:n,options:f});return f.link&&d(n)&&(f.link.hasOwnProperty(n["@id"])||(f.link[n["@id"]]=[]),f.link[n["@id"]].push({expanded:n,compacted:r})),r}if(u(n)&&(p(t,e,"@container")||[]).includes("@list"))return E.compact({activeCtx:t,activeProperty:e,element:n["@list"],options:f,compactionMap:b});const _="@reverse"===e,x={},A=t;c(n)||d(n)||(t=t.revertToPreviousContext());const T=p(A,e,"@context");a(T)||(t=await m({activeCtx:t,localCtx:T,propagate:!0,overrideProtected:!0,options:f})),f.link&&"@id"in n&&(f.link.hasOwnProperty(n["@id"])||(f.link[n["@id"]]=[]),f.link[n["@id"]].push({expanded:n,compacted:x}));let C=n["@type"]||[];C.length>1&&(C=Array.from(C).sort());const I=t;for(const e of C){const n=E.compactIri({activeCtx:I,iri:e,relativeTo:{vocab:!0}}),r=p(A,n,"@context");a(r)||(t=await m({activeCtx:t,localCtx:r,options:f,propagate:!1}))}const D=Object.keys(n).sort();for(const a of D){const d=n[a];if("@id"!==a)if("@type"!==a)if("@reverse"!==a)if("@preserve"!==a)if("@index"!==a)if("@graph"!==a&&"@list"!==a&&"@included"!==a&&g(a)){const e=E.compactIri({activeCtx:t,iri:a,relativeTo:{vocab:!0}});v(x,e,d)}else{if(!i(d))throw new r("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===d.length){const e=E.compactIri({activeCtx:t,iri:a,value:d,relativeTo:{vocab:!0},reverse:_}),n=t.mappings.has(e)?t.mappings.get(e)["@nest"]:null;let r=x;n&&(S(t,n,f),s(x[n])||(x[n]={}),r=x[n]),v(r,e,d,{propertyIsArray:!0})}for(const e of d){const n=E.compactIri({activeCtx:t,iri:a,value:e,relativeTo:{vocab:!0},reverse:_}),r=t.mappings.has(n)?t.mappings.get(n)["@nest"]:null;let d=x;r&&(S(t,r,f),s(x[r])||(x[r]={}),d=x[r]);const g=p(t,n,"@container")||[],m=l(e),y=u(e);let A;y?A=e["@list"]:m&&(A=e["@graph"]);let T=await E.compact({activeCtx:t,activeProperty:n,element:y||m?A:e,options:f,compactionMap:b});if(y){if(i(T)||(T=[T]),g.includes("@list")){v(d,n,T,{valueIsArray:!0,allowDuplicate:!0});continue}T={[E.compactIri({activeCtx:t,iri:"@list",relativeTo:{vocab:!0}})]:T},"@index"in e&&(T[E.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=e["@index"])}if(m)if(g.includes("@graph")&&(g.includes("@id")||g.includes("@index")&&h(e))){let r;d.hasOwnProperty(n)?r=d[n]:d[n]=r={};const i=(g.includes("@id")?e["@id"]:e["@index"])||E.compactIri({activeCtx:t,iri:"@none",relativeTo:{vocab:!0}});v(r,i,T,{propertyIsArray:!f.compactArrays||g.includes("@set")})}else g.includes("@graph")&&h(e)?(i(T)&&T.length>1&&(T={"@included":T}),v(d,n,T,{propertyIsArray:!f.compactArrays||g.includes("@set")})):(i(T)&&1===T.length&&f.compactArrays&&(T=T[0]),T={[E.compactIri({activeCtx:t,iri:"@graph",relativeTo:{vocab:!0}})]:T},"@id"in e&&(T[E.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]=e["@id"]),"@index"in e&&(T[E.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=e["@index"]),v(d,n,T,{propertyIsArray:!f.compactArrays||g.includes("@set")}));else if(g.includes("@language")||g.includes("@index")||g.includes("@id")||g.includes("@type")){let r,i;if(d.hasOwnProperty(n)?r=d[n]:d[n]=r={},g.includes("@language"))c(T)&&(T=T["@value"]),i=e["@language"];else if(g.includes("@index")){const r=p(t,n,"@index")||"@index",s=E.compactIri({activeCtx:t,iri:r,relativeTo:{vocab:!0}});if("@index"===r)i=e["@index"],delete T[s];else{let t;if([i,...t]=w(T[r]||[]),o(i))switch(t.length){case 0:delete T[r];break;case 1:T[r]=t[0];break;default:T[r]=t}else i=null}}else if(g.includes("@id")){const e=E.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}});i=T[e],delete T[e]}else if(g.includes("@type")){const r=E.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}});let s;switch([i,...s]=w(T[r]||[]),s.length){case 0:delete T[r];break;case 1:T[r]=s[0];break;default:T[r]=s}1===Object.keys(T).length&&"@id"in e&&(T=await E.compact({activeCtx:t,activeProperty:n,element:{"@id":e["@id"]},options:f,compactionMap:b}))}i||(i=E.compactIri({activeCtx:t,iri:"@none",relativeTo:{vocab:!0}})),v(r,i,T,{propertyIsArray:g.includes("@set")})}else{const t=!f.compactArrays||g.includes("@set")||g.includes("@list")||i(T)&&0===T.length||"@list"===a||"@graph"===a;v(d,n,T,{propertyIsArray:t})}}}else{if((p(t,e,"@container")||[]).includes("@index"))continue;const n=E.compactIri({activeCtx:t,iri:a,relativeTo:{vocab:!0}});v(x,n,d)}else{const n=await E.compact({activeCtx:t,activeProperty:e,element:d,options:f,compactionMap:b});i(n)&&0===n.length||v(x,a,n)}else{const e=await E.compact({activeCtx:t,activeProperty:"@reverse",element:d,options:f,compactionMap:b});for(const n in e)if(t.mappings.has(n)&&t.mappings.get(n).reverse){const r=e[n],i=(p(t,n,"@container")||[]).includes("@set")||!f.compactArrays;v(x,n,r,{propertyIsArray:i}),delete e[n]}if(Object.keys(e).length>0){const n=E.compactIri({activeCtx:t,iri:a,relativeTo:{vocab:!0}});v(x,n,e)}}else{let e=w(d).map(t=>E.compactIri({activeCtx:A,iri:t,relativeTo:{vocab:!0}}));1===e.length&&(e=e[0]);const n=E.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}}),r=(p(t,n,"@container")||[]).includes("@set")&&y(t,1.1)||i(e)&&0===d.length;v(x,n,e,{propertyIsArray:r})}else{let e=w(d).map(e=>E.compactIri({activeCtx:t,iri:e,relativeTo:{vocab:!1},base:f.base}));1===e.length&&(e=e[0]),x[E.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]=e}}return x}return n},E.compactIri=({activeCtx:t,iri:e,value:n=null,relativeTo:i={vocab:!1},reverse:o=!1,base:a=null})=>{if(null===e)return e;t.isPropertyTermScoped&&t.previousContext&&(t=t.previousContext);const h=t.getInverse();if(g(e)&&e in h&&"@none"in h[e]&&"@type"in h[e]["@none"]&&"@none"in h[e]["@none"]["@type"])return h[e]["@none"]["@type"]["@none"];if(i.vocab&&e in h){const r=t["@language"]||"@none",i=[];s(n)&&"@index"in n&&!("@graph"in n)&&i.push("@index","@index@set"),s(n)&&"@preserve"in n&&(n=n["@preserve"][0]),l(n)?("@index"in n&&i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n&&i.push("@graph@id","@graph@id@set"),i.push("@graph","@graph@set","@set"),"@index"in n||i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n||i.push("@graph@id","@graph@id@set")):s(n)&&!c(n)&&i.push("@id","@id@set","@type","@set@type");let a="@language",h="@null";if(o)a="@type",h="@reverse",i.push("@set");else if(u(n)){"@index"in n||i.push("@list");const t=n["@list"];if(0===t.length)a="@any",h="@none";else{let e=0===t.length?r:null,n=null;for(let r=0;r<t.length;++r){const i=t[r];let s="@none",o="@none";if(c(i)?"@direction"in i?s=`${(i["@language"]||"").toLowerCase()}_${i["@direction"]}`:"@language"in i?s=i["@language"].toLowerCase():"@type"in i?o=i["@type"]:s="@null":o="@id",null===e?e=s:s!==e&&c(i)&&(e="@none"),null===n?n=o:o!==n&&(n="@none"),"@none"===e&&"@none"===n)break}e=e||"@none",n=n||"@none","@none"!==n?(a="@type",h=n):h=e}}else{if(c(n))if("@language"in n&&!("@index"in n)){i.push("@language","@language@set"),h=n["@language"];const t=n["@direction"];t&&(h=`${h}_${t}`)}else"@direction"in n&&!("@index"in n)?h=`_${n["@direction"]}`:"@type"in n&&(a="@type",h=n["@type"]);else a="@type",h="@id";i.push("@set")}i.push("@none"),s(n)&&!("@index"in n)&&i.push("@index","@index@set"),c(n)&&1===Object.keys(n).length&&i.push("@language","@language@set");const d=function(t,e,n,r,i,o){null===o&&(o="@null");const a=[];if(("@id"===o||"@reverse"===o)&&s(n)&&"@id"in n){"@reverse"===o&&a.push("@reverse");const e=E.compactIri({activeCtx:t,iri:n["@id"],relativeTo:{vocab:!0}});t.mappings.has(e)&&t.mappings.get(e)&&t.mappings.get(e)["@id"]===n["@id"]?a.push.apply(a,["@vocab","@id"]):a.push.apply(a,["@id","@vocab"])}else{a.push(o);const t=a.find(t=>t.includes("_"));t&&a.push(t.replace(/^[^_]+_/,"_"))}a.push("@none");const u=t.inverse[e];for(const s of r){if(!(s in u))continue;const t=u[s][i];for(const e of a)if(e in t)return t[e]}return null}(t,e,n,i,a,h);if(null!==d)return d}if(i.vocab&&"@vocab"in t){const n=t["@vocab"];if(0===e.indexOf(n)&&e!==n){const r=e.substr(n.length);if(!t.mappings.has(r))return r}}let d=null;const f=[];let p=t.fastCurieMap;const m=e.length-1;for(let r=0;r<m&&e[r]in p;++r)p=p[e[r]],""in p&&f.push(p[""][0]);for(let r=f.length-1;r>=0;--r){const i=f[r],s=i.terms;for(const r of s){const s=r+":"+e.substr(i.iri.length);t.mappings.get(r)._prefix&&(!t.mappings.has(s)||null===n&&t.mappings.get(s)["@id"]===e)&&(null===d||x(s,d)<0)&&(d=s)}}if(null!==d)return d;for(const[s,u]of t.mappings)if(u&&u._prefix&&e.startsWith(s+":"))throw new r(`Absolute IRI "${e}" confused with prefix "${s}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:t});return i.vocab?e:"@base"in t?t["@base"]?b(_(a,t["@base"]),e):e:b(a,e)},E.compactValue=({activeCtx:t,activeProperty:e,value:n,options:r})=>{if(c(n)){const r=p(t,e,"@type"),i=p(t,e,"@language"),s=p(t,e,"@direction"),a=p(t,e,"@container")||[],u="@index"in n&&!a.includes("@index");if(!u&&"@none"!==r){if(n["@type"]===r)return n["@value"];if("@language"in n&&n["@language"]===i&&"@direction"in n&&n["@direction"]===s)return n["@value"];if("@language"in n&&n["@language"]===i)return n["@value"];if("@direction"in n&&n["@direction"]===s)return n["@value"]}const c=Object.keys(n).length,l=1===c||2===c&&"@index"in n&&!u,h="@language"in t,d=o(n["@value"]),f=t.mappings.has(e)&&null===t.mappings.get(e)["@language"];if(l&&"@none"!==r&&(!h||!d||f))return n["@value"];const g={};return u&&(g[E.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=n["@index"]),"@type"in n?g[E.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:t,iri:n["@type"],relativeTo:{vocab:!0}}):"@language"in n&&(g[E.compactIri({activeCtx:t,iri:"@language",relativeTo:{vocab:!0}})]=n["@language"]),"@direction"in n&&(g[E.compactIri({activeCtx:t,iri:"@direction",relativeTo:{vocab:!0}})]=n["@direction"]),g[E.compactIri({activeCtx:t,iri:"@value",relativeTo:{vocab:!0}})]=n["@value"],g}const i=f(t,e,{vocab:!0},r),s=p(t,e,"@type"),a=E.compactIri({activeCtx:t,iri:n["@id"],relativeTo:{vocab:"@vocab"===s},base:r.base});return"@id"===s||"@vocab"===s||"@graph"===i?a:{[E.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]:a}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(t,e,n){"use strict";const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#";e.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:r,RDF_LIST:r+"List",RDF_FIRST:r+"first",RDF_REST:r+"rest",RDF_NIL:r+"nil",RDF_TYPE:r+"type",RDF_PLAIN_LITERAL:r+"PlainLiteral",RDF_XML_LITERAL:r+"XMLLiteral",RDF_JSON_LITERAL:r+"JSON",RDF_OBJECT:r+"object",RDF_LANGSTRING:r+"langString",XSD:i,XSD_BOOLEAN:i+"boolean",XSD_DOUBLE:i+"double",XSD_INTEGER:i+"integer",XSD_STRING:i+"string"}},{}],19:[function(t,e,n){"use strict";const r=t("./util"),i=t("./JsonLdError"),{isArray:s,isObject:o,isString:a,isUndefined:u}=t("./types"),{isAbsolute:c,isRelative:l,prependBase:h}=t("./url"),{asArray:d,compareShortestLeast:f}=t("./util"),p=new Map,g=/^@[a-zA-Z]+$/,m={};function y(t,e,n,r,i,s){if(null===e||!a(e)||m.isKeyword(e))return e;if(e.match(g))return null;if(r&&r.hasOwnProperty(e)&&!0!==i.get(e)&&m.createTermDefinition({activeCtx:t,localCtx:r,term:e,defined:i,options:s}),(n=n||{}).vocab){const n=t.mappings.get(e);if(null===n)return null;if(o(n)&&"@id"in n)return n["@id"]}const u=e.indexOf(":");if(u>0){const n=e.substr(0,u),o=e.substr(u+1);if("_"===n||0===o.indexOf("//"))return e;r&&r.hasOwnProperty(n)&&m.createTermDefinition({activeCtx:t,localCtx:r,term:n,defined:i,options:s});const a=t.mappings.get(n);if(a&&a._prefix)return a["@id"]+o;if(c(e))return e}if(n.vocab&&"@vocab"in t)return t["@vocab"]+e;if(n.base&&"@base"in t){if(t["@base"])return h(h(s.base,t["@base"]),e)}else if(n.base)return h(s.base,e);return e}function b(t,e){if(!t||"object"!=typeof t||!e||"object"!=typeof e)return t===e;const n=Array.isArray(t);if(n!==Array.isArray(e))return!1;if(n){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!b(t[n],e[n]))return!1;return!0}const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s in t){let n=t[s],r=e[s];if("@container"===s&&Array.isArray(n)&&Array.isArray(r)&&(n=n.slice().sort(),r=r.slice().sort()),!b(n,r))return!1}return!0}e.exports=m,m.process=async({activeCtx:t,localCtx:e,options:n,propagate:u=!0,overrideProtected:f=!1,cycles:p=new Set})=>{if(o(e)&&"@context"in e&&s(e["@context"])&&(e=e["@context"]),0===d(e).length)return t;const g=await n.contextResolver.resolve({activeCtx:t,context:e,documentLoader:n.documentLoader,base:n.base});o(g[0].document)&&"boolean"==typeof g[0].document["@propagate"]&&(u=g[0].document["@propagate"]);let b=t;u||b.previousContext||(b=b.clone(),b.previousContext=t);for(const s of g){let{document:u}=s;if(t=b,null===u){if(!f&&0!==Object.keys(t.protected).length){const o=n&&n.protectedMode||"error";if("error"===o)throw new i("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===o){console.warn("WARNING: invalid context nullification");const e=s.getProcessed(t);if(e){b=t=e;continue}const i=t;b=t=m.getInitialContext(n).clone();for(const[n,s]of Object.entries(i.protected))s&&(t.mappings[n]=r.clone(i.mappings[n]));t.protected=r.clone(i.protected),s.setProcessed(i,b);continue}throw new i("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:e,protectedMode:o})}b=t=m.getInitialContext(n).clone();continue}const d=s.getProcessed(t);if(d){b=t=d;continue}if(o(u)&&"@context"in u&&(u=u["@context"]),!o(u))throw new i("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:u});b=b.clone();const g=new Map;if("@version"in u){if(1.1!==u["@version"])throw new i("Unsupported JSON-LD version: "+u["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:u});if(t.processingMode&&"json-ld-1.0"===t.processingMode)throw new i("@version: "+u["@version"]+" not compatible with "+t.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:u});b.processingMode="json-ld-1.1",b["@version"]=u["@version"],g.set("@version",!0)}if(b.processingMode=b.processingMode||t.processingMode,"@base"in u){let t=u["@base"];if(null===t||c(t));else{if(!l(t))throw new i('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:u});t=h(b["@base"],t)}b["@base"]=t,g.set("@base",!0)}if("@vocab"in u){const t=u["@vocab"];if(null===t)delete b["@vocab"];else{if(!a(t))throw new i('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:u});if(!c(t)&&m.processingMode(b,1))throw new i('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:u});b["@vocab"]=y(b,t,{vocab:!0,base:!0},void 0,void 0,n)}g.set("@vocab",!0)}if("@language"in u){const t=u["@language"];if(null===t)delete b["@language"];else{if(!a(t))throw new i('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:u});b["@language"]=t.toLowerCase()}g.set("@language",!0)}if("@direction"in u){const e=u["@direction"];if("json-ld-1.0"===t.processingMode)throw new i("Invalid JSON-LD syntax; @direction not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:u});if(null===e)delete b["@direction"];else{if("ltr"!==e&&"rtl"!==e)throw new i('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:u});b["@direction"]=e}g.set("@direction",!0)}if("@propagate"in u){const n=u["@propagate"];if("json-ld-1.0"===t.processingMode)throw new i("Invalid JSON-LD syntax; @propagate not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:u});if("boolean"!=typeof n)throw new i("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:e});g.set("@propagate",!0)}if("@import"in u){const r=u["@import"];if("json-ld-1.0"===t.processingMode)throw new i("Invalid JSON-LD syntax; @import not compatible with "+t.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:u});if(!a(r))throw new i("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:e});const s=await n.contextResolver.resolve({activeCtx:t,context:r,documentLoader:n.documentLoader,base:n.base});if(1!==s.length)throw new i("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:e});const o=s[0].getProcessed(t);if(o)u=o;else{const n=s[0].document;if("@import"in n)throw new i("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:e});for(const t in n)u.hasOwnProperty(t)||(u[t]=n[t]);s[0].setProcessed(t,u)}g.set("@import",!0)}g.set("@protected",u["@protected"]||!1);for(const t in u)if(m.createTermDefinition({activeCtx:b,localCtx:u,term:t,defined:g,options:n,overrideProtected:f}),o(u[t])&&"@context"in u[t]){const e=u[t]["@context"];let r=!0;if(a(e)){const t=h(n.base,e);p.has(t)?r=!1:p.add(t)}if(r)try{await m.process({activeCtx:b.clone(),localCtx:u[t]["@context"],overrideProtected:!0,options:n,cycles:p})}catch(_){throw new i("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:u[t]["@context"],term:t})}}s.setProcessed(t,b)}return b},m.createTermDefinition=({activeCtx:t,localCtx:e,term:n,defined:r,options:u,overrideProtected:l=!1})=>{if(r.has(n)){if(r.get(n))return;throw new i("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:e,term:n})}let h;if(r.set(n,!1),e.hasOwnProperty(n)&&(h=e[n]),"@type"===n&&o(h)&&"@set"===(h["@container"]||"@set")&&m.processingMode(t,1.1)){const t=["@container","@id","@protected"],r=Object.keys(h);if(0===r.length||r.some(e=>!t.includes(e)))throw new i("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:e,term:n})}else{if(m.isKeyword(n))throw new i("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:e,term:n});if(n.match(g))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:n});if(""===n)throw new i("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:e})}const d=t.mappings.get(n);t.mappings.has(n)&&t.mappings.delete(n);let f=!1;if((a(h)||null===h)&&(f=!0,h={"@id":h}),!o(h))throw new i("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:e});const p={};t.mappings.set(n,p),p.reverse=!1;const _=["@container","@id","@language","@reverse","@type"];m.processingMode(t,1.1)&&_.push("@context","@direction","@index","@nest","@prefix","@protected");for(const s in h)if(!_.includes(s))throw new i("Invalid JSON-LD syntax; a term definition must not contain "+s,"jsonld.SyntaxError",{code:"invalid term definition",context:e});const v=n.indexOf(":");if(p._termHasColon=v>0,"@reverse"in h){if("@id"in h)throw new i("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});if("@nest"in h)throw new i("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});const s=h["@reverse"];if(!a(s))throw new i("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(!m.isKeyword(s)&&s.match(g))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:s}),void(d?t.mappings.set(n,d):t.mappings.delete(n));const o=y(t,s,{vocab:!0,base:!1},e,r,u);if(!c(o))throw new i("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});p["@id"]=o,p.reverse=!0}else if("@id"in h){let s=h["@id"];if(s&&!a(s))throw new i("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(null===s)p["@id"]=null;else{if(!m.isKeyword(s)&&s.match(g))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:s}),void(d?t.mappings.set(n,d):t.mappings.delete(n));if(s!==n){if(s=y(t,s,{vocab:!0,base:!1},e,r,u),!c(s)&&!m.isKeyword(s))throw new i("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});if(n.match(/(?::[^:])|\//)&&y(t,n,{vocab:!0,base:!1},e,new Map(r).set(n,!0),u)!==s)throw new i("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e});p["@id"]=s,p._prefix=f&&!p._termHasColon&&s.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in p))if(p._termHasColon){const i=n.substr(0,v);if(e.hasOwnProperty(i)&&m.createTermDefinition({activeCtx:t,localCtx:e,term:i,defined:r,options:u}),t.mappings.has(i)){const e=n.substr(v+1);p["@id"]=t.mappings.get(i)["@id"]+e}else p["@id"]=n}else if("@type"===n)p["@id"]=n;else{if(!("@vocab"in t))throw new i("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:e,term:n});p["@id"]=t["@vocab"]+n}if((!0===h["@protected"]||!0===r.get("@protected")&&!1!==h["@protected"])&&(t.protected[n]=!0,p.protected=!0),r.set(n,!0),"@type"in h){let n=h["@type"];if(!a(n))throw new i("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:e});if("@json"===n||"@none"===n){if(m.processingMode(t,1))throw new i(`Invalid JSON-LD syntax; an @context @type value must not be "${n}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:e})}else if("@id"!==n&&"@vocab"!==n){if(n=y(t,n,{vocab:!0,base:!1},e,r,u),!c(n))throw new i("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:e});if(0===n.indexOf("_:"))throw new i("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:e})}p["@type"]=n}if("@container"in h){const n=a(h["@container"])?[h["@container"]]:h["@container"]||[],r=["@list","@set","@index","@language"];let o=!0;const u=n.includes("@set");if(m.processingMode(t,1.1)){if(r.push("@graph","@id","@type"),n.includes("@list")){if(1!==n.length)throw new i("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:e})}else if(n.includes("@graph")){if(n.some(t=>"@graph"!==t&&"@id"!==t&&"@index"!==t&&"@set"!==t))throw new i("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:e})}else o&=n.length<=(u?2:1);if(n.includes("@type")&&(p["@type"]=p["@type"]||"@id",!["@id","@vocab"].includes(p["@type"])))throw new i("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:e})}else o&=!s(h["@container"]),o&=n.length<=1;if(o&=n.every(t=>r.includes(t)),o&=!(u&&n.includes("@list")),!o)throw new i("Invalid JSON-LD syntax; @context @container value must be one of the following: "+r.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:e});if(p.reverse&&!n.every(t=>["@index","@set"].includes(t)))throw new i("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:e});p["@container"]=n}if("@index"in h){if(!("@container"in h)||!p["@container"].includes("@index"))throw new i(`Invalid JSON-LD syntax; @index without @index in @container: "${h["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:e});if(!a(h["@index"])||0===h["@index"].indexOf("@"))throw new i(`Invalid JSON-LD syntax; @index must expand to an IRI: "${h["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:e});p["@index"]=h["@index"]}if("@context"in h&&(p["@context"]=h["@context"]),"@language"in h&&!("@type"in h)){let t=h["@language"];if(null!==t&&!a(t))throw new i("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:e});null!==t&&(t=t.toLowerCase()),p["@language"]=t}if("@prefix"in h){if(n.match(/:|\//))throw new i("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:e});if(m.isKeyword(p["@id"]))throw new i("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:e});if("boolean"!=typeof h["@prefix"])throw new i("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:e});p._prefix=!0===h["@prefix"]}if("@direction"in h){const t=h["@direction"];if(null!==t&&"ltr"!==t&&"rtl"!==t)throw new i('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:e});p["@direction"]=t}if("@nest"in h){const t=h["@nest"];if(!a(t)||"@nest"!==t&&0===t.indexOf("@"))throw new i("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:e});p["@nest"]=t}const w=p["@id"];if("@context"===w||"@preserve"===w)throw new i("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:e});if(d&&d.protected&&!l&&(t.protected[n]=!0,p.protected=!0,!b(d,p))){const t=u&&u.protectedMode||"error";if("error"===t)throw new i(`Invalid JSON-LD syntax; tried to redefine "${n}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:e,term:n});if("warn"===t)return void console.warn("WARNING: protected term redefinition",{term:n});throw new i("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:e,term:n,protectedMode:t})}},m.expandIri=(t,e,n,r)=>y(t,e,n,void 0,void 0,r),m.getInitialContext=t=>{const e=JSON.stringify({processingMode:t.processingMode}),n=p.get(e);if(n)return n;const i={processingMode:t.processingMode,mappings:new Map,inverse:null,getInverse:function(){const t=this;if(t.inverse)return t.inverse;const e=t.inverse={},n=t.fastCurieMap={},r={},i=(t["@language"]||"@none").toLowerCase(),a=t["@direction"],u=t.mappings,c=[...u.keys()].sort(f);for(const s of c){const t=u.get(s);if(null===t)continue;let c=t["@container"]||"@none";if(c=[].concat(c).sort().join(""),null===t["@id"])continue;const l=d(t["@id"]);for(const u of l){let l=e[u];const h=m.isKeyword(u);if(l)h||t._termHasColon||r[u].push(s);else if(e[u]=l={},!h&&!t._termHasColon){r[u]=[s];const t={iri:u,terms:r[u]};u[0]in n?n[u[0]].push(t):n[u[0]]=[t]}if(l[c]||(l[c]={"@language":{},"@type":{},"@any":{}}),l=l[c],o(s,l["@any"],"@none"),t.reverse)o(s,l["@type"],"@reverse");else if("@none"===t["@type"])o(s,l["@any"],"@none"),o(s,l["@language"],"@none"),o(s,l["@type"],"@none");else if("@type"in t)o(s,l["@type"],t["@type"]);else if("@language"in t&&"@direction"in t){const e=t["@language"],n=t["@direction"];o(s,l["@language"],e&&n?`${e}_${n}`.toLowerCase():e?e.toLowerCase():n?`_${n}`:"@null")}else"@language"in t?o(s,l["@language"],(t["@language"]||"@null").toLowerCase()):"@direction"in t?o(s,l["@language"],t["@direction"]?`_${t["@direction"]}`:"@none"):a?(o(s,l["@language"],`_${a}`),o(s,l["@language"],"@none"),o(s,l["@type"],"@none")):(o(s,l["@language"],i),o(s,l["@language"],"@none"),o(s,l["@type"],"@none"))}}for(const o in n)s(n,o,1);return e},clone:function(){const t={};return t.mappings=r.clone(this.mappings),t.clone=this.clone,t.inverse=null,t.getInverse=this.getInverse,t.protected=r.clone(this.protected),this.previousContext&&(t.previousContext=this.previousContext.clone()),t.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(t["@base"]=this["@base"]),"@language"in this&&(t["@language"]=this["@language"]),"@vocab"in this&&(t["@vocab"]=this["@vocab"]),t},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===p.size&&p.clear(),p.set(e,i),i;function s(t,e,n){const r=t[e],i=t[e]={};let o,a;for(const s of r)o=s.iri,a=n>=o.length?"":o[n],a in i?i[a].push(s):i[a]=[s];for(const u in i)""!==u&&s(i,u,n+1)}function o(t,e,n){e.hasOwnProperty(n)||(e[n]=t)}},m.getContextValue=(t,e,n)=>{if(null===e){if("@context"===n)return;return null}if(t.mappings.has(e)){const r=t.mappings.get(e);if(u(n))return r;if(r.hasOwnProperty(n))return r[n]}return"@language"===n&&n in t||"@direction"===n&&n in t?t[n]:"@context"!==n?null:void 0},m.processingMode=(t,e)=>e.toString()>="1.1"?!t.processingMode||t.processingMode>="json-ld-"+e.toString():"json-ld-1.0"===t.processingMode,m.isKeyword=t=>{if(!a(t)||"@"!==t[0])return!1;switch(t){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(t,e,n){"use strict";const{parseLinkHeader:r,buildHeaders:i}=t("../util"),{LINK_HEADER_CONTEXT:s}=t("../constants"),o=t("../JsonLdError"),a=t("../RequestQueue"),{prependBase:u}=t("../url"),c=/(^|(\r\n))link:/i;e.exports=({secure:t,headers:e={},xhr:n}={headers:{}})=>(e=i(e),(new a).wrapLoader(async function i(a){if(0!==a.indexOf("http:")&&0!==a.indexOf("https:"))throw new o('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a});if(t&&0!==a.indexOf("https"))throw new o('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:a});let l;try{l=await function(t,e,n){const r=new(t=t||XMLHttpRequest);return new Promise((t,i)=>{r.onload=()=>t(r),r.onerror=t=>i(t),r.open("GET",e,!0);for(const e in n)r.setRequestHeader(e,n[e]);r.send()})}(n,a,e)}catch(g){throw new o("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:g})}if(l.status>=400)throw new o("URL could not be dereferenced: "+l.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:a,httpStatusCode:l.status});let h={contextUrl:null,documentUrl:a,document:l.response},d=null;const f=l.getResponseHeader("Content-Type");let p;if(c.test(l.getAllResponseHeaders())&&(p=l.getResponseHeader("Link")),p&&"application/ld+json"!==f){const t=r(p),e=t[s];if(Array.isArray(e))throw new o("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a});e&&(h.contextUrl=e.target),d=t.alternate,d&&"application/ld+json"==d.type&&!(f||"").match(/^application\/(\w*\+)?json$/)&&(h=await i(u(a,d.target)))}return h}))},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(t,e,n){"use strict";const r=t("./JsonLdError"),{isArray:i,isObject:s,isEmptyObject:o,isString:a,isUndefined:u}=t("./types"),{isList:c,isValue:l,isGraph:h,isSubject:d}=t("./graphTypes"),{expandIri:f,getContextValue:p,isKeyword:g,process:m,processingMode:y}=t("./context"),{isAbsolute:b}=t("./url"),{addValue:_,asArray:v,getValues:w,validateTypeValue:x}=t("./util"),E={};e.exports=E;const S=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;async function A({activeCtx:t,activeProperty:e,expandedActiveProperty:n,element:h,expandedParent:w,options:T={},insideList:D,typeKey:k,typeScopedContext:O,expansionMap:M}){const P=Object.keys(h).sort(),N=[];let R;const j=h[k]&&"@json"===f(t,i(h[k])?h[k][0]:h[k],{vocab:!0},T);for(const A of P){let k,P=h[A];if("@context"===A)continue;let L=f(t,A,{vocab:!0},T);if((null===L||!b(L)&&!g(L))&&(L=M({unmappedProperty:A,activeCtx:t,activeProperty:e,parent:h,options:T,insideList:D,value:P,expandedParent:w}),void 0===L))continue;if(g(L)){if("@reverse"===n)throw new r("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:P});if(L in w&&"@included"!==L&&"@type"!==L)throw new r("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:L})}if("@id"===L){if(!a(P)){if(!T.isFrame)throw new r('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:P});if(s(P)){if(!o(P))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:P})}else{if(!i(P))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:P});if(!P.every(t=>a(t)))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:P})}}_(w,"@id",v(P).map(e=>a(e)?f(t,e,{base:!0},T):e),{propertyIsArray:T.isFrame});continue}if("@type"===L){s(P)&&(P=Object.fromEntries(Object.entries(P).map(([t,e])=>[f(O,t,{vocab:!0}),v(e).map(t=>f(O,t,{base:!0,vocab:!0}))]))),x(P,T.isFrame),_(w,"@type",v(P).map(t=>a(t)?f(O,t,{base:!0,vocab:!0},T):t),{propertyIsArray:T.isFrame});continue}if("@included"===L&&y(t,1.1)){const n=v(await E.expand({activeCtx:t,activeProperty:e,element:P,options:T,expansionMap:M}));if(!n.every(t=>d(t)))throw new r("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:P});_(w,"@included",n,{propertyIsArray:!0});continue}if("@graph"===L&&!s(P)&&!i(P))throw new r('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:P});if("@value"===L){R=P,j&&y(t,1.1)?w["@value"]=P:_(w,"@value",P,{propertyIsArray:T.isFrame});continue}if("@language"===L){if(null===P)continue;if(!a(P)&&!T.isFrame)throw new r('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:P});P=v(P).map(t=>a(t)?t.toLowerCase():t);for(const t of P)a(t)&&!t.match(S)&&console.warn(`@language must be valid BCP47: ${t}`);_(w,"@language",P,{propertyIsArray:T.isFrame});continue}if("@direction"===L){if(!a(P)&&!T.isFrame)throw new r('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:P});P=v(P);for(const t of P)if(a(t)&&"ltr"!==t&&"rtl"!==t)throw new r('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:P});_(w,"@direction",P,{propertyIsArray:T.isFrame});continue}if("@index"===L){if(!a(P))throw new r('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:P});_(w,"@index",P);continue}if("@reverse"===L){if(!s(P))throw new r('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:P});if(k=await E.expand({activeCtx:t,activeProperty:"@reverse",element:P,options:T,expansionMap:M}),"@reverse"in k)for(const t in k["@reverse"])_(w,t,k["@reverse"][t],{propertyIsArray:!0});let e=w["@reverse"]||null;for(const t in k){if("@reverse"===t)continue;null===e&&(e=w["@reverse"]={}),_(e,t,[],{propertyIsArray:!0});const n=k[t];for(let i=0;i<n.length;++i){const s=n[i];if(l(s)||c(s))throw new r('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:k});_(e,t,s,{propertyIsArray:!0})}}continue}if("@nest"===L){N.push(A);continue}let F=t;const B=p(t,A,"@context");u(B)||(F=await m({activeCtx:t,localCtx:B,propagate:!0,overrideProtected:!0,options:T}));const z=p(F,A,"@container")||[];if(z.includes("@language")&&s(P))k=C(F,P,p(F,A,"@direction"),T);else if(z.includes("@index")&&s(P)){const e=z.includes("@graph"),n=p(F,A,"@index")||"@index",r="@index"!==n&&f(t,n,{vocab:!0},T);k=await I({activeCtx:F,options:T,activeProperty:A,value:P,expansionMap:M,asGraph:e,indexKey:n,propertyIndex:r})}else if(z.includes("@id")&&s(P)){const t=z.includes("@graph");k=await I({activeCtx:F,options:T,activeProperty:A,value:P,expansionMap:M,asGraph:t,indexKey:"@id"})}else if(z.includes("@type")&&s(P))k=await I({activeCtx:F.revertToPreviousContext(),options:T,activeProperty:A,value:P,expansionMap:M,asGraph:!1,indexKey:"@type"});else{const r="@list"===L;if(r||"@set"===L){let t=e;r&&"@graph"===n&&(t=null),k=await E.expand({activeCtx:F,activeProperty:t,element:P,options:T,insideList:r,expansionMap:M})}else k="@json"===p(t,A,"@type")?{"@type":"@json","@value":P}:await E.expand({activeCtx:F,activeProperty:A,element:P,options:T,insideList:!1,expansionMap:M})}if(null!==k||"@value"===L||(k=M({unmappedValue:P,expandedProperty:L,activeCtx:F,activeProperty:e,parent:h,options:T,insideList:D,key:A,expandedParent:w}),void 0!==k))if("@list"!==L&&!c(k)&&z.includes("@list")&&(k={"@list":v(k)}),z.includes("@graph")&&!z.some(t=>"@id"===t||"@index"===t)&&(k=v(k).map(t=>({"@graph":v(t)}))),F.mappings.has(A)&&F.mappings.get(A).reverse){const t=w["@reverse"]=w["@reverse"]||{};k=v(k);for(let e=0;e<k.length;++e){const n=k[e];if(l(n)||c(n))throw new r('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:k});_(t,L,n,{propertyIsArray:!0})}}else _(w,L,k,{propertyIsArray:!0})}if("@value"in w)if("@json"===w["@type"]&&y(t,1.1));else if((s(R)||i(R))&&!T.isFrame)throw new r('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:R});for(const o of N){const a=i(h[o])?h[o]:[h[o]];for(const i of a){if(!s(i)||Object.keys(i).some(e=>"@value"===f(t,e,{vocab:!0},T)))throw new r("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:i});await A({activeCtx:t,activeProperty:e,expandedActiveProperty:n,element:i,expandedParent:w,options:T,insideList:D,typeScopedContext:O,typeKey:k,expansionMap:M})}}}function T({activeCtx:t,activeProperty:e,value:n,options:r}){if(null==n)return null;const i=f(t,e,{vocab:!0},r);if("@id"===i)return f(t,n,{base:!0},r);if("@type"===i)return f(t,n,{vocab:!0,base:!0},r);const s=p(t,e,"@type");if(("@id"===s||"@graph"===i)&&a(n))return{"@id":f(t,n,{base:!0},r)};if("@vocab"===s&&a(n))return{"@id":f(t,n,{vocab:!0,base:!0},r)};if(g(i))return n;const o={};if(s&&!["@id","@vocab","@none"].includes(s))o["@type"]=s;else if(a(n)){const n=p(t,e,"@language");null!==n&&(o["@language"]=n);const r=p(t,e,"@direction");null!==r&&(o["@direction"]=r)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),o["@value"]=n,o}function C(t,e,n,s){const o=[],u=Object.keys(e).sort();for(const c of u){const u=f(t,c,{vocab:!0},s);let l=e[c];i(l)||(l=[l]);for(const t of l){if(null===t)continue;if(!a(t))throw new r("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:e});const i={"@value":t};"@none"!==u&&(i["@language"]=c.toLowerCase()),n&&(i["@direction"]=n),o.push(i)}}return o}async function I({activeCtx:t,options:e,activeProperty:n,value:s,expansionMap:o,asGraph:a,indexKey:c,propertyIndex:d}){const g=[],y=Object.keys(s).sort(),b="@type"===c;for(let v of y){if(b){const n=p(t,v,"@context");u(n)||(t=await m({activeCtx:t,localCtx:n,propagate:!1,options:e}))}let y,w=s[v];i(w)||(w=[w]),w=await E.expand({activeCtx:t,activeProperty:n,element:w,options:e,insideList:!1,insideIndex:!0,expansionMap:o}),y=d?"@none"===v?"@none":T({activeCtx:t,activeProperty:c,value:v,options:e}):f(t,v,{vocab:!0},e),"@id"===c?v=f(t,v,{base:!0},e):b&&(v=y);for(let t of w){if(a&&!h(t)&&(t={"@graph":[t]}),"@type"===c)"@none"===y||(t["@type"]=t["@type"]?[v].concat(t["@type"]):[v]);else{if(l(t)&&!["@language","@type","@index"].includes(c))throw new r(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${c}".`,"jsonld.SyntaxError",{code:"invalid value object",value:t});d?"@none"!==y&&_(t,d,y,{propertyIsArray:!0,prependValue:!0}):"@none"===y||c in t||(t[c]=v)}g.push(t)}}return g}E.expand=async({activeCtx:t,activeProperty:e=null,element:n,options:c={},insideList:l=!1,insideIndex:h=!1,typeScopedContext:d=null,expansionMap:g=(()=>{})})=>{if(null==n)return null;if("@default"===e&&(c=Object.assign({},c,{isFrame:!1})),!i(n)&&!s(n)){if(!l&&(null===e||"@graph"===f(t,e,{vocab:!0},c))){const r=await g({unmappedValue:n,activeCtx:t,activeProperty:e,options:c,insideList:l});return void 0===r?null:r}return T({activeCtx:t,activeProperty:e,value:n,options:c})}if(i(n)){let r=[];const s=p(t,e,"@container")||[];l=l||s.includes("@list");for(let o=0;o<n.length;++o){let s=await E.expand({activeCtx:t,activeProperty:e,element:n[o],options:c,expansionMap:g,insideIndex:h,typeScopedContext:d});l&&i(s)&&(s={"@list":s}),null===s&&(s=await g({unmappedValue:n[o],activeCtx:t,activeProperty:e,parent:n,index:o,options:c,expandedParent:r,insideList:l}),void 0===s)||(i(s)?r=r.concat(s):r.push(s))}return r}const _=f(t,e,{vocab:!0},c),x=p(t,e,"@context");d=d||(t.previousContext?t:null);let S=Object.keys(n).sort(),C=!h;if(C&&d&&S.length<=2&&!S.includes("@context"))for(const r of S){const e=f(d,r,{vocab:!0},c);if("@value"===e){C=!1,t=d;break}if("@id"===e&&1===S.length){C=!1;break}}C&&(t=t.revertToPreviousContext()),u(x)||(t=await m({activeCtx:t,localCtx:x,propagate:!0,overrideProtected:!0,options:c})),"@context"in n&&(t=await m({activeCtx:t,localCtx:n["@context"],options:c})),d=t;let I=null;for(const r of S)if("@type"===f(t,r,{vocab:!0},c)){I=I||r;const e=n[r],i=Array.isArray(e)?e.length>1?e.slice().sort():e:[e];for(const n of i){const e=p(d,n,"@context");u(e)||(t=await m({activeCtx:t,localCtx:e,options:c,propagate:!1}))}}let D={};await A({activeCtx:t,activeProperty:e,expandedActiveProperty:_,element:n,expandedParent:D,options:c,insideList:l,typeKey:I,typeScopedContext:d,expansionMap:g}),S=Object.keys(D);let k=S.length;if("@value"in D){if("@type"in D&&("@language"in D||"@direction"in D))throw new r('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:D});let i=k-1;if("@type"in D&&(i-=1),"@index"in D&&(i-=1),"@language"in D&&(i-=1),"@direction"in D&&(i-=1),0!==i)throw new r('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:D});const s=null===D["@value"]?[]:v(D["@value"]),u=w(D,"@type");if(y(t,1.1)&&u.includes("@json")&&1===u.length);else if(0===s.length){const r=await g({unmappedValue:D,activeCtx:t,activeProperty:e,element:n,options:c,insideList:l});D=void 0!==r?r:null}else{if(!s.every(t=>a(t)||o(t))&&"@language"in D)throw new r("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:D});if(!u.every(t=>b(t)&&!(a(t)&&0===t.indexOf("_:"))||o(t)))throw new r('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:D})}}else if("@type"in D&&!i(D["@type"]))D["@type"]=[D["@type"]];else if("@set"in D||"@list"in D){if(k>1&&(2!==k||!("@index"in D)))throw new r('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:D});"@set"in D&&(D=D["@set"],S=Object.keys(D),k=S.length)}else if(1===k&&"@language"in D){const r=await g(D,{unmappedValue:D,activeCtx:t,activeProperty:e,element:n,options:c,insideList:l});D=void 0!==r?r:null}if(s(D)&&!c.keepFreeFloatingNodes&&!l&&(null===e||"@graph"===_)&&(0===k||"@value"in D||"@list"in D||1===k&&"@id"in D)){const r=await g({unmappedValue:D,activeCtx:t,activeProperty:e,element:n,options:c,insideList:l});D=void 0!==r?r:null}return D}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(t,e,n){"use strict";const{isSubjectReference:r}=t("./graphTypes"),{createMergedNodeMap:i}=t("./nodeMap"),s={};e.exports=s,s.flatten=t=>{const e=i(t),n=[],s=Object.keys(e).sort();for(let i=0;i<s.length;++i){const t=e[s[i]];r(t)||n.push(t)}return n}},{"./graphTypes":25,"./nodeMap":27}],23:[function(t,e,n){"use strict";const{isKeyword:r}=t("./context"),i=t("./graphTypes"),s=t("./types"),o=t("./util"),a=t("./url"),u=t("./JsonLdError"),{createNodeMap:c,mergeNodeMapGraphs:l}=t("./nodeMap"),h={};function d(t){const e={};for(const n in t)void 0!==t[n]&&(e["@"+n]=[t[n]]);return[e]}function f(t,e,n){for(let r=n.length-1;r>=0;--r){const i=n[r];if(i.graph===e&&i.subject["@id"]===t["@id"])return!0}return!1}function p(t,e,n){const r="@"+n;let i=r in t?t[r][0]:e[n];if("embed"===n)if(!0===i)i="@once";else if(!1===i)i="@never";else if("@always"!==i&&"@never"!==i&&"@link"!==i&&"@first"!==i&&"@last"!==i&&"@once"!==i)throw new u("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:t});return i}function g(t){if(!s.isArray(t)||1!==t.length||!s.isObject(t[0]))throw new u("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:t});if("@id"in t[0])for(const e of o.asArray(t[0]["@id"]))if(!s.isObject(e)&&!a.isAbsolute(e)||s.isString(e)&&0===e.indexOf("_:"))throw new u("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:t});if("@type"in t[0])for(const e of o.asArray(t[0]["@type"]))if(!s.isObject(e)&&!a.isAbsolute(e)||s.isString(e)&&0===e.indexOf("_:"))throw new u("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:t})}function m(t,e,n,a){let u=!0,c=!1;for(const l in n){let h=!1;const d=o.getValues(e,l),f=0===o.getValues(n,l).length;if("@id"===l){if(s.isEmptyObject(n["@id"][0]||{})?h=!0:n["@id"].length>=0&&(h=n["@id"].includes(d[0])),!a.requireAll)return h}else if("@type"===l){if(u=!1,f){if(d.length>0)return!1;h=!0}else if(1===n["@type"].length&&s.isEmptyObject(n["@type"][0]))h=d.length>0;else for(const t of n["@type"])h=!(!s.isObject(t)||!("@default"in t))||h||d.some(e=>e===t);if(!a.requireAll)return h}else{if(r(l))continue;{const e=o.getValues(n,l)[0];let r=!1;if(e&&(g([e]),r="@default"in e),u=!1,0===d.length&&r)continue;if(d.length>0&&f)return!1;if(void 0===e){if(d.length>0)return!1;h=!0}else if(i.isList(e)){const n=e["@list"][0];if(i.isList(d[0])){const e=d[0]["@list"];i.isValue(n)?h=e.some(t=>w(n,t)):(i.isSubject(n)||i.isSubjectReference(n))&&(h=e.some(e=>v(t,n,e,a)))}}else h=i.isValue(e)?d.some(t=>w(e,t)):i.isSubjectReference(e)?d.some(n=>v(t,e,n,a)):!!s.isObject(e)&&d.length>0}}if(!h&&a.requireAll)return!1;c=c||h}return u||c}function y(t,e){const n=t.uniqueEmbeds[t.graph],r=n[e],i=r.parent,a=r.property,u={"@id":e};if(s.isArray(i)){for(let s=0;s<i.length;++s)if(o.compareValues(i[s],u)){i[s]=u;break}}else{const t=s.isArray(i[a]);o.removeValue(i,a,u,{propertyIsArray:t}),o.addValue(i,a,u,{propertyIsArray:t})}const c=t=>{const e=Object.keys(n);for(const r of e)r in n&&s.isObject(n[r].parent)&&n[r].parent["@id"]===t&&(delete n[r],c(r))};c(e)}function b(t,e){if(s.isArray(t))return t.map(t=>b(t,e));if(s.isObject(t)){if("@preserve"in t)return t["@preserve"][0];if(i.isValue(t))return t;if(i.isList(t))return t["@list"]=b(t["@list"],e),t;if("@id"in t){const n=t["@id"];if(e.link.hasOwnProperty(n)){const r=e.link[n].indexOf(t);if(-1!==r)return e.link[n][r];e.link[n].push(t)}else e.link[n]=[t]}for(const n in t)"@id"===n&&e.bnodesToClear.includes(t[n])?delete t["@id"]:t[n]=b(t[n],e)}return t}function _(t,e,n){s.isObject(t)?o.addValue(t,e,n,{propertyIsArray:!0}):t.push(n)}function v(t,e,n,r){if(!("@id"in n))return!1;const i=t.subjects[n["@id"]];return i&&m(t,i,e,r)}function w(t,e){const n=e["@value"],r=e["@type"],i=e["@language"],o=t["@value"]?s.isArray(t["@value"])?t["@value"]:[t["@value"]]:[],a=t["@type"]?s.isArray(t["@type"])?t["@type"]:[t["@type"]]:[],u=t["@language"]?s.isArray(t["@language"])?t["@language"]:[t["@language"]]:[];return 0===o.length&&0===a.length&&0===u.length||!(!o.includes(n)&&!s.isEmptyObject(o[0]))&&!!(!r&&0===a.length||a.includes(r)||r&&s.isEmptyObject(a[0]))&&!!(!i&&0===u.length||u.includes(i)||i&&s.isEmptyObject(u[0]))}e.exports=h,h.frameMergedOrDefault=(t,e,n)=>{const r={options:n,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},i=new o.IdentifierIssuer("_:b");c(t,r.graphMap,"@default",i),n.merged&&(r.graphMap["@merged"]=l(r.graphMap),r.graph="@merged"),r.subjects=r.graphMap[r.graph];const s=[];return h.frame(r,Object.keys(r.subjects).sort(),e,s),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(r.bnodeMap).filter(t=>1===r.bnodeMap[t].length)),n.link={},b(s,n)},h.frame=(t,e,n,a,c=null)=>{g(n);const l=t.options,b={embed:p(n=n[0],l,"embed"),explicit:p(n,l,"explicit"),requireAll:p(n,l,"requireAll")};t.link.hasOwnProperty(t.graph)||(t.link[t.graph]={});const v=t.link[t.graph],x=function(t,e,n,r){const i={};for(const s of e){const e=t.graphMap[t.graph][s];m(t,e,n,r)&&(i[s]=e)}return i}(t,e,n,b),E=Object.keys(x).sort();for(const g of E){const m=x[g];if(null===c?t.uniqueEmbeds={[t.graph]:{}}:t.uniqueEmbeds[t.graph]=t.uniqueEmbeds[t.graph]||{},"@link"===b.embed&&g in v){_(a,c,v[g]);continue}const E={"@id":g};if(0===g.indexOf("_:")&&o.addValue(t.bnodeMap,g,E,{propertyIsArray:!0}),v[g]=E,("@first"===b.embed||"@last"===b.embed)&&t.is11)throw new u("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:n});if(t.embedded||!t.uniqueEmbeds[t.graph].hasOwnProperty(g))if(!t.embedded||"@never"!==b.embed&&!f(m,t.graph,t.subjectStack))if(!t.embedded||"@first"!=b.embed&&"@once"!=b.embed||!t.uniqueEmbeds[t.graph].hasOwnProperty(g)){if("@last"===b.embed&&g in t.uniqueEmbeds[t.graph]&&y(t,g),t.uniqueEmbeds[t.graph][g]={parent:a,property:c},t.subjectStack.push({subject:m,graph:t.graph}),g in t.graphMap){let e=!1,r=null;"@graph"in n?(r=n["@graph"][0],e=!("@merged"===g||"@default"===g),s.isObject(r)||(r={})):(e="@merged"!==t.graph,r={}),e&&h.frame({...t,graph:g,embedded:!1},Object.keys(t.graphMap[g]).sort(),[r],E,"@graph")}"@included"in n&&h.frame({...t,embedded:!1},e,n["@included"],E,"@included");for(const e of Object.keys(m).sort())if(r(e)){if(E[e]=o.clone(m[e]),"@type"===e)for(const n of m["@type"])0===n.indexOf("_:")&&o.addValue(t.bnodeMap,n,E,{propertyIsArray:!0})}else if(!b.explicit||e in n)for(const r of m[e]){const s=e in n?n[e]:d(b);if(i.isList(r)){const s=n[e]&&n[e][0]&&n[e][0]["@list"]?n[e][0]["@list"]:d(b),a={"@list":[]};_(E,e,a);const u=r["@list"];for(const e of u)i.isSubjectReference(e)?h.frame({...t,embedded:!0},[e["@id"]],s,a,"@list"):_(a,"@list",o.clone(e))}else i.isSubjectReference(r)?h.frame({...t,embedded:!0},[r["@id"]],s,E,e):w(s[0],r)&&_(E,e,o.clone(r))}for(const t of Object.keys(n).sort()){if("@type"===t){if(!s.isObject(n[t][0])||!("@default"in n[t][0]))continue}else if(r(t))continue;const e=n[t][0]||{};if(!p(e,l,"omitDefault")&&!(t in E)){let n="@null";"@default"in e&&(n=o.clone(e["@default"])),s.isArray(n)||(n=[n]),E[t]=[{"@preserve":n}]}}for(const e of Object.keys(n["@reverse"]||{}).sort()){const r=n["@reverse"][e];for(const n of Object.keys(t.subjects))o.getValues(t.subjects[n],e).some(t=>t["@id"]===g)&&(E["@reverse"]=E["@reverse"]||{},o.addValue(E["@reverse"],e,[],{propertyIsArray:!0}),h.frame({...t,embedded:!0},[n],r,E["@reverse"][e],c))}_(a,c,E),t.subjectStack.pop()}else _(a,c,E);else _(a,c,E)}},h.cleanupNull=(t,e)=>{if(s.isArray(t))return t.map(t=>h.cleanupNull(t,e)).filter(t=>t);if("@null"===t)return null;if(s.isObject(t)){if("@id"in t){const n=t["@id"];if(e.link.hasOwnProperty(n)){const r=e.link[n].indexOf(t);if(-1!==r)return e.link[n][r];e.link[n].push(t)}else e.link[n]=[t]}for(const n in t)t[n]=h.cleanupNull(t[n],e)}return t}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(t,e,n){"use strict";const r=t("./JsonLdError"),i=t("./graphTypes"),s=t("./types"),o=t("./util"),{RDF_LIST:a,RDF_FIRST:u,RDF_REST:c,RDF_NIL:l,RDF_TYPE:h,RDF_JSON_LITERAL:d,XSD_BOOLEAN:f,XSD_DOUBLE:p,XSD_INTEGER:g,XSD_STRING:m}=t("./constants"),y=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,b={};function _(t,e,n){if(t.termType.endsWith("Node"))return{"@id":t.value};const i={"@value":t.value};if(t.language)i["@language"]=t.language;else{let a=t.datatype.value;if(a||(a=m),a===d){a="@json";try{i["@value"]=JSON.parse(i["@value"])}catch(o){throw new r("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:i["@value"],cause:o})}}if(e){if(a===f)"true"===i["@value"]?i["@value"]=!0:"false"===i["@value"]&&(i["@value"]=!1);else if(s.isNumeric(i["@value"]))if(a===g){const t=parseInt(i["@value"],10);t.toFixed(0)===i["@value"]&&(i["@value"]=t)}else a===p&&(i["@value"]=parseFloat(i["@value"]));[f,g,p,m].includes(a)||(i["@type"]=a)}else if("i18n-datatype"===n&&a.startsWith("https://www.w3.org/ns/i18n#")){const[,t,e]=a.split(/[#_]/);t.length>0&&(i["@language"]=t,t.match(y)||console.warn(`@language must be valid BCP47: ${t}`)),i["@direction"]=e}else a!==m&&(i["@type"]=a)}return i}e.exports=b,b.fromRDF=async(t,{useRdfType:e=!1,useNativeTypes:n=!1,rdfDirection:r=null})=>{const d={},f={"@default":d},p={};for(const i of t){const t="DefaultGraph"===i.graph.termType?"@default":i.graph.value;t in f||(f[t]={}),"@default"===t||t in d||(d[t]={"@id":t});const s=f[t],a=i.subject.value,u=i.predicate.value,c=i.object;a in s||(s[a]={"@id":a});const g=s[a],m=c.termType.endsWith("Node");if(m&&!(c.value in s)&&(s[c.value]={"@id":c.value}),u===h&&!e&&m){o.addValue(g,"@type",c.value,{propertyIsArray:!0});continue}const y=_(c,n,r);if(o.addValue(g,u,y,{propertyIsArray:!0}),m)if(c.value===l){const t=s[c.value];"usages"in t||(t.usages=[]),t.usages.push({node:g,property:u,value:y})}else p[c.value]=!(c.value in p)&&{node:g,property:u,value:y}}for(const o in f){const t=f[o];if(!(l in t))continue;const e=t[l];if(e.usages){for(let n of e.usages){let e=n.node,r=n.property,o=n.value;const l=[],h=[];let d=Object.keys(e).length;for(;r===c&&s.isObject(p[e["@id"]])&&s.isArray(e[u])&&1===e[u].length&&s.isArray(e[c])&&1===e[c].length&&(3===d||4===d&&s.isArray(e["@type"])&&1===e["@type"].length&&e["@type"][0]===a)&&(l.push(e[u][0]),h.push(e["@id"]),n=p[e["@id"]],e=n.node,r=n.property,o=n.value,d=Object.keys(e).length,i.isBlankNode(e)););delete o["@id"],o["@list"]=l.reverse();for(const n of h)delete t[n]}delete e.usages}}const g=[],m=Object.keys(d).sort();for(const s of m){const t=d[s];if(s in f){const e=t["@graph"]=[],n=f[s],r=Object.keys(n).sort();for(const t of r){const r=n[t];i.isSubjectReference(r)||e.push(r)}}i.isSubjectReference(t)||g.push(t)}return g}},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(t,e,n){"use strict";const r=t("./types"),i={};e.exports=i,i.isSubject=t=>!(!r.isObject(t)||"@value"in t||"@set"in t||"@list"in t)&&(Object.keys(t).length>1||!("@id"in t)),i.isSubjectReference=t=>r.isObject(t)&&1===Object.keys(t).length&&"@id"in t,i.isValue=t=>r.isObject(t)&&"@value"in t,i.isList=t=>r.isObject(t)&&"@list"in t,i.isGraph=t=>r.isObject(t)&&"@graph"in t&&1===Object.keys(t).filter(t=>"@id"!==t&&"@index"!==t).length,i.isSimpleGraph=t=>i.isGraph(t)&&!("@id"in t),i.isBlankNode=t=>!!r.isObject(t)&&("@id"in t?0===t["@id"].indexOf("_:"):0===Object.keys(t).length||!("@value"in t||"@set"in t||"@list"in t))},{"./types":30}],26:[function(t,e,n){const r=t("rdf-canonize"),i=t("./platform"),s=t("./util"),o=t("./ContextResolver"),a=s.IdentifierIssuer,u=t("./JsonLdError"),c=t("lru-cache"),l=t("./NQuads"),{expand:h}=t("./expand"),{flatten:d}=t("./flatten"),{fromRDF:f}=t("./fromRdf"),{toRDF:p}=t("./toRdf"),{frameMergedOrDefault:g,cleanupNull:m}=t("./frame"),{isArray:y,isObject:b,isString:_}=t("./types"),{isSubjectReference:v}=t("./graphTypes"),{expandIri:w,getInitialContext:x,process:E,processingMode:S}=t("./context"),{compact:A,compactIri:T}=t("./compact"),{createNodeMap:C,createMergedNodeMap:I,mergeNodeMaps:D}=t("./nodeMap"),k=function(e){const n={},k=new c({max:100});function O(t,{documentLoader:n=e.documentLoader,...r}){return Object.assign({},{documentLoader:n},r,t)}return e.compact=async function(t,n,r){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===n)throw new u("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===t)return null;let i;(r=O(r,{base:_(t)?t:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new a("_:b"),contextResolver:new o({sharedCache:k})})).link&&(r.skipExpansion=!0),r.compactToRelative||delete r.base,i=r.skipExpansion?t:await e.expand(t,r);const c=await e.processContext(x(r),n,r);let l=await A({activeCtx:c,element:i,options:r,compactionMap:r.compactionMap});r.compactArrays&&!r.graph&&y(l)?1===l.length?l=l[0]:0===l.length&&(l={}):r.graph&&b(l)&&(l=[l]),b(n)&&"@context"in n&&(n=n["@context"]),n=s.clone(n),y(n)||(n=[n]);const h=n;n=[];for(let e=0;e<h.length;++e)(!b(h[e])||Object.keys(h[e]).length>0)&&n.push(h[e]);const d=n.length>0;if(1===n.length&&(n=n[0]),y(l)){const t=T({activeCtx:c,iri:"@graph",relativeTo:{vocab:!0}}),e=l;l={},d&&(l["@context"]=n),l[t]=e}else if(b(l)&&d){const t=l;l={"@context":n};for(const e in t)l[e]=t[e]}return l},e.expand=async function(t,n){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(n=O(n,{keepFreeFloatingNodes:!1,contextResolver:new o({sharedCache:k})})).expansionMap&&(n.expansionMap=void 0);const r={},i=[];if("expandContext"in n){const t=s.clone(n.expandContext);r.expandContext=b(t)&&"@context"in t?t:{"@context":t},i.push(r.expandContext)}let a;if(_(t)){const s=await e.get(t,n);a=s.documentUrl,r.input=s.document,s.contextUrl&&(r.remoteContext={"@context":s.contextUrl},i.push(r.remoteContext))}else r.input=s.clone(t);"base"in n||(n.base=a||"");let u=x(n);for(const e of i)u=await E({activeCtx:u,localCtx:e,options:n});let c=await h({activeCtx:u,element:r.input,options:n,expansionMap:n.expansionMap});return b(c)&&"@graph"in c&&1===Object.keys(c).length?c=c["@graph"]:null===c&&(c=[]),y(c)||(c=[c]),c},e.flatten=async function(t,n,r){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");n="function"==typeof n?null:n||null,r=O(r,{base:_(t)?t:"",contextResolver:new o({sharedCache:k})});const i=await e.expand(t,r),s=d(i);return null===n?s:(r.graph=!0,r.skipExpansion=!0,await e.compact(s,n,r))},e.frame=async function(t,n,r){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(r=O(r,{base:_(t)?t:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new o({sharedCache:k})}),_(n)){const t=await e.get(n,r);if(n=t.document,t.contextUrl){let e=n["@context"];e?y(e)?e.push(t.contextUrl):e=[e,t.contextUrl]:e=t.contextUrl,n["@context"]=e}}const i=n&&n["@context"]||{},s=await e.processContext(x(r),i,r);r.hasOwnProperty("omitGraph")||(r.omitGraph=S(s,1.1)),r.hasOwnProperty("pruneBlankNodeIdentifiers")||(r.pruneBlankNodeIdentifiers=S(s,1.1));const a=await e.expand(t,r),u={...r};u.isFrame=!0,u.keepFreeFloatingNodes=!0;const c=await e.expand(n,u),l=Object.keys(n).map(t=>w(s,t,{vocab:!0}));u.merged=!l.includes("@graph"),u.is11=S(s,1.1);const h=g(a,c,u);u.graph=!r.omitGraph,u.skipExpansion=!0,u.link={},u.framing=!0;let d=await e.compact(h,i,u);return u.link={},d=m(d,u),d},e.link=async function(t,n,r){const i={};return n&&(i["@context"]=n),i["@embed"]="@link",e.frame(t,i,r)},e.normalize=e.canonize=async function(t,n){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(n=O(n,{base:_(t)?t:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new o({sharedCache:k})}))){if("application/n-quads"!==n.inputFormat&&"application/nquads"!==n.inputFormat)throw new u("Unknown canonicalization input format.","jsonld.CanonizeError");const e=l.parse(t);return r.canonize(e,n)}const i={...n};delete i.format,i.produceGeneralizedRdf=!1;const s=await e.toRDF(t,i);return r.canonize(s,n)},e.fromRDF=async function(t,e){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");e=O(e,{format:_(t)?"application/n-quads":void 0});const{format:r}=e;let{rdfParser:i}=e;if(r){if(i=i||n[r],!i)throw new u("Unknown input format.","jsonld.UnknownFormat",{format:r})}else i=()=>t;const s=await i(t);return f(s,e)},e.toRDF=async function(t,n){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let r;r=(n=O(n,{base:_(t)?t:"",skipExpansion:!1,contextResolver:new o({sharedCache:k})})).skipExpansion?t:await e.expand(t,n);const i=p(r,n);if(n.format){if("application/n-quads"===n.format||"application/nquads"===n.format)return l.serialize(i);throw new u("Unknown output format.","jsonld.UnknownFormat",{format:n.format})}return i},e.createNodeMap=async function(t,n){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");n=O(n,{base:_(t)?t:"",contextResolver:new o({sharedCache:k})});const r=await e.expand(t,n);return I(r,n)},e.merge=async function(t,n,r){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!y(t))throw new TypeError('Could not merge, "docs" must be an array.');n="function"==typeof n?null:n||null,r=O(r,{contextResolver:new o({sharedCache:k})});const i=await Promise.all(t.map(t=>{const n={...r};return e.expand(t,n)}));let u=!0;"mergeNodes"in r&&(u=r.mergeNodes);const c=r.issuer||new a("_:b"),l={"@default":{}};for(let e=0;e<i.length;++e){const t=s.relabelBlankNodes(i[e],{issuer:new a("_:b"+e+"-")}),n=u||0===e?l:{"@default":{}};if(C(t,n,"@default",c),n!==l)for(const e in n){const t=n[e];if(!(e in l)){l[e]=t;continue}const r=l[e];for(const e in t)e in r||(r[e]=t[e])}}const h=D(l),d=[],f=Object.keys(h).sort();for(let e=0;e<f.length;++e){const t=h[f[e]];v(t)||d.push(t)}return null===n?d:(r.graph=!0,r.skipExpansion=!0,await e.compact(d,n,r))},Object.defineProperty(e,"documentLoader",{get:()=>e._documentLoader,set:t=>e._documentLoader=t}),e.documentLoader=async t=>{throw new u("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:t})},e.get=async function(t,n){let r;r="function"==typeof n.documentLoader?n.documentLoader:e.documentLoader;const i=await r(t);try{if(!i.document)throw new u("No remote document found at the given URL.","jsonld.NullRemoteDocument");_(i.document)&&(i.document=JSON.parse(i.document))}catch(s){throw new u("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:s,remoteDoc:i})}return i},e.processContext=async function(t,e,n){return n=O(n,{base:"",contextResolver:new o({sharedCache:k})}),null===e?x(n):(e=s.clone(e),b(e)&&"@context"in e||(e={"@context":e}),E({activeCtx:t,localCtx:e,options:n}))},e.getContextValue=t("./context").getContextValue,e.documentLoaders={},e.useDocumentLoader=function(t){if(!(t in e.documentLoaders))throw new u('Unknown document loader type: "'+t+'"',"jsonld.UnknownDocumentLoader",{type:t});e.documentLoader=e.documentLoaders[t].apply(e,Array.prototype.slice.call(arguments,1))},e.registerRDFParser=function(t,e){n[t]=e},e.unregisterRDFParser=function(t){delete n[t]},e.registerRDFParser("application/n-quads",l.parse),e.registerRDFParser("application/nquads",l.parse),e.url=t("./url"),e.util=s,Object.assign(e,s),e.promises=e,e.RequestQueue=t("./RequestQueue"),e.JsonLdProcessor=t("./JsonLdProcessor")(e),i.setupGlobals(e),i.setupDocumentLoaders(e),e},O=function(){return k(function(){return O()})};k(O),e.exports=O},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(t,e,n){"use strict";const{isKeyword:r}=t("./context"),i=t("./graphTypes"),s=t("./types"),o=t("./util"),a=t("./JsonLdError"),u={};e.exports=u,u.createMergedNodeMap=(t,e)=>{const n=(e=e||{}).issuer||new o.IdentifierIssuer("_:b"),r={"@default":{}};return u.createNodeMap(t,r,"@default",n),u.mergeNodeMaps(r)},u.createNodeMap=(t,e,n,c,l,h)=>{if(s.isArray(t)){for(const r of t)u.createNodeMap(r,e,n,c,void 0,h);return}if(!s.isObject(t))return void(h&&h.push(t));if(i.isValue(t)){if("@type"in t){let e=t["@type"];0===e.indexOf("_:")&&(t["@type"]=e=c.getId(e))}return void(h&&h.push(t))}if(h&&i.isList(t)){const r=[];return u.createNodeMap(t["@list"],e,n,c,l,r),void h.push({"@list":r})}if("@type"in t){const e=t["@type"];for(const t of e)0===t.indexOf("_:")&&c.getId(t)}s.isUndefined(l)&&(l=i.isBlankNode(t)?c.getId(t["@id"]):t["@id"]),h&&h.push({"@id":l});const d=e[n],f=d[l]=d[l]||{};f["@id"]=l;const p=Object.keys(t).sort();for(let s of p){if("@id"===s)continue;if("@reverse"===s){const r={"@id":l},s=t["@reverse"];for(const t in s){const a=s[t];for(const s of a){let a=s["@id"];i.isBlankNode(s)&&(a=c.getId(a)),u.createNodeMap(s,e,n,c,a),o.addValue(d[a],t,r,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===s){l in e||(e[l]={}),u.createNodeMap(t[s],e,l,c);continue}if("@included"===s){u.createNodeMap(t[s],e,n,c);continue}if("@type"!==s&&r(s)){if("@index"===s&&s in f&&(t[s]!==f[s]||t[s]["@id"]!==f[s]["@id"]))throw new a("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:f});f[s]=t[s];continue}const h=t[s];if(0===s.indexOf("_:")&&(s=c.getId(s)),0!==h.length)for(let t of h)if("@type"===s&&(t=0===t.indexOf("_:")?c.getId(t):t),i.isSubject(t)||i.isSubjectReference(t)){if("@id"in t&&!t["@id"])continue;const r=i.isBlankNode(t)?c.getId(t["@id"]):t["@id"];o.addValue(f,s,{"@id":r},{propertyIsArray:!0,allowDuplicate:!1}),u.createNodeMap(t,e,n,c,r)}else if(i.isValue(t))o.addValue(f,s,t,{propertyIsArray:!0,allowDuplicate:!1});else if(i.isList(t)){const r=[];u.createNodeMap(t["@list"],e,n,c,l,r),t={"@list":r},o.addValue(f,s,t,{propertyIsArray:!0,allowDuplicate:!1})}else u.createNodeMap(t,e,n,c,l),o.addValue(f,s,t,{propertyIsArray:!0,allowDuplicate:!1});else o.addValue(f,s,[],{propertyIsArray:!0})}},u.mergeNodeMapGraphs=t=>{const e={};for(const n of Object.keys(t).sort())for(const i of Object.keys(t[n]).sort()){const s=t[n][i];i in e||(e[i]={"@id":i});const a=e[i];for(const t of Object.keys(s).sort())if(r(t)&&"@type"!==t)a[t]=o.clone(s[t]);else for(const e of s[t])o.addValue(a,t,o.clone(e),{propertyIsArray:!0,allowDuplicate:!1})}return e},u.mergeNodeMaps=t=>{const e=t["@default"],n=Object.keys(t).sort();for(const r of n){if("@default"===r)continue;const n=t[r];let s=e[r];s?"@graph"in s||(s["@graph"]=[]):e[r]=s={"@id":r,"@graph":[]};const o=s["@graph"];for(const t of Object.keys(n).sort()){const e=n[t];i.isSubjectReference(e)||o.push(e)}}return e}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(t,e,n){"use strict";const r=t("./documentLoaders/xhr"),i={};e.exports=i,i.setupDocumentLoaders=function(t){"undefined"!=typeof XMLHttpRequest&&(t.documentLoaders.xhr=r,t.useDocumentLoader("xhr"))},i.setupGlobals=function(t){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:t.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(t,e,n){"use strict";const{createNodeMap:r}=t("./nodeMap"),{isKeyword:i}=t("./context"),s=t("./graphTypes"),o=t("canonicalize"),a=t("./types"),u=t("./util"),{RDF_FIRST:c,RDF_REST:l,RDF_NIL:h,RDF_TYPE:d,RDF_JSON_LITERAL:f,RDF_LANGSTRING:p,XSD_BOOLEAN:g,XSD_DOUBLE:m,XSD_INTEGER:y,XSD_STRING:b}=t("./constants"),{isAbsolute:_}=t("./url"),v={};function w(t,e,n,r,s){const o=Object.keys(e).sort();for(const a of o){const o=e[a],u=Object.keys(o).sort();for(let e of u){const u=o[e];if("@type"===e)e=d;else if(i(e))continue;for(const i of u){const o={termType:a.startsWith("_:")?"BlankNode":"NamedNode",value:a};if(!_(a))continue;const u={termType:e.startsWith("_:")?"BlankNode":"NamedNode",value:e};if(!_(e))continue;if("BlankNode"===u.termType&&!s.produceGeneralizedRdf)continue;const c=x(i,r,t,n,s.rdfDirection);c&&t.push({subject:o,predicate:u,object:c,graph:n})}}}}function x(t,e,n,r,i){const u={};if(s.isValue(t)){u.termType="Literal",u.value=void 0,u.datatype={termType:"NamedNode"};let e=t["@value"];const n=t["@type"]||null;"@json"===n?(u.value=o(e),u.datatype.value=f):a.isBoolean(e)?(u.value=e.toString(),u.datatype.value=n||g):a.isDouble(e)||n===m?(a.isDouble(e)||(e=parseFloat(e)),u.value=e.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),u.datatype.value=n||m):a.isNumber(e)?(u.value=e.toFixed(0),u.datatype.value=n||y):"i18n-datatype"===i&&"@direction"in t?(u.datatype.value="https://www.w3.org/ns/i18n#"+(t["@language"]||"")+`_${t["@direction"]}`,u.value=e):"@language"in t?(u.value=e,u.datatype.value=n||p,u.language=t["@language"]):(u.value=e,u.datatype.value=n||b)}else if(s.isList(t)){const s=function(t,e,n,r,i){const s={termType:"NamedNode",value:c},o={termType:"NamedNode",value:l},a={termType:"NamedNode",value:h},u=t.pop(),d=u?{termType:"BlankNode",value:e.getId()}:a;let f=d;for(const c of t){const t=x(c,e,n,r,i),a={termType:"BlankNode",value:e.getId()};n.push({subject:f,predicate:s,object:t,graph:r}),n.push({subject:f,predicate:o,object:a,graph:r}),f=a}if(u){const t=x(u,e,n,r,i);n.push({subject:f,predicate:s,object:t,graph:r}),n.push({subject:f,predicate:o,object:a,graph:r})}return d}(t["@list"],e,n,r,i);u.termType=s.termType,u.value=s.value}else{const e=a.isObject(t)?t["@id"]:t;u.termType=e.startsWith("_:")?"BlankNode":"NamedNode",u.value=e}return"NamedNode"!==u.termType||_(u.value)?u:null}e.exports=v,v.toRDF=(t,e)=>{const n=new u.IdentifierIssuer("_:b"),i={"@default":{}};r(t,i,"@default",n);const s=[],o=Object.keys(i).sort();for(const r of o){let t;if("@default"===r)t={termType:"DefaultGraph",value:""};else{if(!_(r))continue;t=r.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},t.value=r}w(s,i[r],t,n,e)}return s}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(t,e,n){"use strict";const r={};e.exports=r,r.isArray=Array.isArray,r.isBoolean=t=>"boolean"==typeof t||"[object Boolean]"===Object.prototype.toString.call(t),r.isDouble=t=>r.isNumber(t)&&(-1!==String(t).indexOf(".")||Math.abs(t)>=1e21),r.isEmptyObject=t=>r.isObject(t)&&0===Object.keys(t).length,r.isNumber=t=>"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t),r.isNumeric=t=>!isNaN(parseFloat(t))&&isFinite(t),r.isObject=t=>"[object Object]"===Object.prototype.toString.call(t),r.isString=t=>"string"==typeof t||"[object String]"===Object.prototype.toString.call(t),r.isUndefined=t=>void 0===t},{}],31:[function(t,e,n){"use strict";const r=t("./types"),i={};e.exports=i,i.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},i.parse=(t,e)=>{const n={},r=i.parsers[e||"full"],s=r.regex.exec(t);let o=r.keys.length;for(;o--;)n[r.keys[o]]=void 0===s[o]?null:s[o];return("https"===n.scheme&&"443"===n.port||"http"===n.scheme&&"80"===n.port)&&(n.href=n.href.replace(":"+n.port,""),n.authority=n.authority.replace(":"+n.port,""),n.port=null),n.normalizedPath=i.removeDotSegments(n.path),n},i.prependBase=(t,e)=>{if(null===t)return e;if(i.isAbsolute(e))return e;t&&!r.isString(t)||(t=i.parse(t||""));const n=i.parse(e),s={protocol:t.protocol||""};if(null!==n.authority)s.authority=n.authority,s.path=n.path,s.query=n.query;else if(s.authority=t.authority,""===n.path)s.path=t.path,s.query=null!==n.query?n.query:t.query;else{if(0===n.path.indexOf("/"))s.path=n.path;else{let e=t.path;e=e.substr(0,e.lastIndexOf("/")+1),(e.length>0||t.authority)&&"/"!==e.substr(-1)&&(e+="/"),e+=n.path,s.path=e}s.query=n.query}""!==n.path&&(s.path=i.removeDotSegments(s.path));let o=s.protocol;return null!==s.authority&&(o+="//"+s.authority),o+=s.path,null!==s.query&&(o+="?"+s.query),null!==n.fragment&&(o+="#"+n.fragment),""===o&&(o="./"),o},i.removeBase=(t,e)=>{if(null===t)return e;t&&!r.isString(t)||(t=i.parse(t||""));let n="";if(""!==t.href?n+=(t.protocol||"")+"//"+(t.authority||""):e.indexOf("//")&&(n+="//"),0!==e.indexOf(n))return e;const s=i.parse(e.substr(n.length)),o=t.normalizedPath.split("/"),a=s.normalizedPath.split("/"),u=s.fragment||s.query?0:1;for(;o.length>0&&a.length>u&&o[0]===a[0];)o.shift(),a.shift();let c="";if(o.length>0){o.pop();for(let t=0;t<o.length;++t)c+="../"}return c+=a.join("/"),null!==s.query&&(c+="?"+s.query),null!==s.fragment&&(c+="#"+s.fragment),""===c&&(c="./"),c},i.removeDotSegments=t=>{if(0===t.length)return"";const e=t.split("/"),n=[];for(;e.length>0;){const t=e.shift(),r=0===e.length;"."!==t?".."!==t?n.push(t):(n.pop(),r&&n.push("")):r&&n.push("")}return"/"===t[0]&&n.length>0&&""!==n[0]&&n.unshift(""),1===n.length&&""===n[0]?"/":n.join("/")};const s=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;i.isAbsolute=t=>r.isString(t)&&s.test(t),i.isRelative=t=>r.isString(t)},{"./types":30}],32:[function(t,e,n){"use strict";const r=t("./graphTypes"),i=t("./types"),s=t("rdf-canonize").IdentifierIssuer,o=t("./JsonLdError"),a=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,u=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,c=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,l="application/ld+json, application/json",h={};function d(t,e){if(i.isArray(e))for(let n=0;n<e.length;++n)e[n]=d(t,e[n]);else if(r.isList(e))e["@list"]=d(t,e["@list"]);else if(i.isObject(e)){r.isBlankNode(e)&&(e["@id"]=t.getId(e["@id"]));const n=Object.keys(e).sort();for(let r=0;r<n.length;++r){const i=n[r];"@id"!==i&&(e[i]=d(t,e[i]))}}return e}e.exports=h,h.IdentifierIssuer=s,h.clone=function(t){if(t&&"object"==typeof t){let e;if(i.isArray(t)){e=[];for(let n=0;n<t.length;++n)e[n]=h.clone(t[n])}else if(t instanceof Map){e=new Map;for(const[n,r]of t)e.set(n,h.clone(r))}else if(t instanceof Set){e=new Set;for(const n of t)e.add(h.clone(n))}else if(i.isObject(t)){e={};for(const n in t)e[n]=h.clone(t[n])}else e=t.toString();return e}return t},h.asArray=function(t){return Array.isArray(t)?t:[t]},h.buildHeaders=(t={})=>{if(Object.keys(t).some(t=>"accept"===t.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+l+'" is supported.');return Object.assign({Accept:l},t)},h.parseLinkHeader=t=>{const e={},n=t.match(a);for(let r=0;r<n.length;++r){let t=n[r].match(u);if(!t)continue;const i={target:t[1]},s=t[2];for(;t=c.exec(s);)i[t[1]]=void 0===t[2]?t[3]:t[2];const o=i.rel||"";Array.isArray(e[o])?e[o].push(i):e[o]=e.hasOwnProperty(o)?[e[o],i]:i}return e},h.validateTypeValue=(t,e)=>{if(!(i.isString(t)||i.isArray(t)&&t.every(t=>i.isString(t)))){if(e&&i.isObject(t))switch(Object.keys(t).length){case 0:return;case 1:if("@default"in t&&h.asArray(t["@default"]).every(t=>i.isString(t)))return}throw new o('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:t})}},h.hasProperty=(t,e)=>{if(t.hasOwnProperty(e)){const n=t[e];return!i.isArray(n)||n.length>0}return!1},h.hasValue=(t,e,n)=>{if(h.hasProperty(t,e)){let s=t[e];const o=r.isList(s);if(i.isArray(s)||o){o&&(s=s["@list"]);for(let t=0;t<s.length;++t)if(h.compareValues(n,s[t]))return!0}else if(!i.isArray(n))return h.compareValues(n,s)}return!1},h.addValue=(t,e,n,r)=>{if("propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1),"valueIsArray"in r||(r.valueIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),"prependValue"in r||(r.prependValue=!1),r.valueIsArray)t[e]=n;else if(i.isArray(n)){0===n.length&&r.propertyIsArray&&!t.hasOwnProperty(e)&&(t[e]=[]),r.prependValue&&(n=n.concat(t[e]),t[e]=[]);for(let i=0;i<n.length;++i)h.addValue(t,e,n[i],r)}else if(t.hasOwnProperty(e)){const s=!r.allowDuplicate&&h.hasValue(t,e,n);i.isArray(t[e])||s&&!r.propertyIsArray||(t[e]=[t[e]]),s||(r.prependValue?t[e].unshift(n):t[e].push(n))}else t[e]=r.propertyIsArray?[n]:n},h.getValues=(t,e)=>[].concat(t[e]||[]),h.removeProperty=(t,e)=>{delete t[e]},h.removeValue=(t,e,n,r)=>{"propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1);const i=h.getValues(t,e).filter(t=>!h.compareValues(t,n));0===i.length?h.removeProperty(t,e):t[e]=1!==i.length||r.propertyIsArray?i:i[0]},h.relabelBlankNodes=(t,e)=>d((e=e||{}).issuer||new s("_:b"),t),h.compareValues=(t,e)=>t===e||!(!r.isValue(t)||!r.isValue(e)||t["@value"]!==e["@value"]||t["@type"]!==e["@type"]||t["@language"]!==e["@language"]||t["@index"]!==e["@index"])||!!(i.isObject(t)&&"@id"in t&&i.isObject(e)&&"@id"in e)&&t["@id"]===e["@id"],h.compareShortestLeast=(t,e)=>t.length<e.length?-1:e.length<t.length?1:t===e?0:t<e?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(t,e,n){"use strict";const r=t("yallist"),i=Symbol("max"),s=Symbol("length"),o=Symbol("lengthCalculator"),a=Symbol("allowStale"),u=Symbol("maxAge"),c=Symbol("dispose"),l=Symbol("noDisposeOnSet"),h=Symbol("lruList"),d=Symbol("cache"),f=Symbol("updateAgeOnGet"),p=()=>1,g=(t,e,n)=>{const r=t[d].get(e);if(r){const e=r.value;if(m(t,e)){if(b(t,r),!t[a])return}else n&&(t[f]&&(r.value.now=Date.now()),t[h].unshiftNode(r));return e.value}},m=(t,e)=>{if(!e||!e.maxAge&&!t[u])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[u]&&n>t[u]},y=t=>{if(t[s]>t[i])for(let e=t[h].tail;t[s]>t[i]&&null!==e;){const n=e.prev;b(t,e),e=n}},b=(t,e)=>{if(e){const n=e.value;t[c]&&t[c](n.key,n.value),t[s]-=n.length,t[d].delete(n.key),t[h].removeNode(e)}};class _{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const v=(t,e,n,r)=>{let i=n.value;m(t,i)&&(b(t,n),t[a]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};e.exports=class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[i]=t.max||1/0;const e=t.length||p;if(this[o]="function"!=typeof e?p:e,this[a]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[u]=t.maxAge||0,this[c]=t.dispose,this[l]=t.noDisposeOnSet||!1,this[f]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[i]=t||1/0,y(this)}get max(){return this[i]}set allowStale(t){this[a]=!!t}get allowStale(){return this[a]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[u]=t,y(this)}get maxAge(){return this[u]}set lengthCalculator(t){"function"!=typeof t&&(t=p),t!==this[o]&&(this[o]=t,this[s]=0,this[h].forEach(t=>{t.length=this[o](t.value,t.key),this[s]+=t.length})),y(this)}get lengthCalculator(){return this[o]}get length(){return this[s]}get itemCount(){return this[h].length}rforEach(t,e){e=e||this;for(let n=this[h].tail;null!==n;){const r=n.prev;v(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[h].head;null!==n;){const r=n.next;v(this,t,n,e),n=r}}keys(){return this[h].toArray().map(t=>t.key)}values(){return this[h].toArray().map(t=>t.value)}reset(){this[c]&&this[h]&&this[h].length&&this[h].forEach(t=>this[c](t.key,t.value)),this[d]=new Map,this[h]=new r,this[s]=0}dump(){return this[h].map(t=>!m(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[h]}set(t,e,n){if((n=n||this[u])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,a=this[o](e,t);if(this[d].has(t)){if(a>this[i])return b(this,this[d].get(t)),!1;const o=this[d].get(t).value;return this[c]&&(this[l]||this[c](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[s]+=a-o.length,o.length=a,this.get(t),y(this),!0}const f=new _(t,e,a,r,n);return f.length>this[i]?(this[c]&&this[c](t,e),!1):(this[s]+=f.length,this[h].unshift(f),this[d].set(t,this[h].head),y(this),!0)}has(t){if(!this[d].has(t))return!1;const e=this[d].get(t).value;return!m(this,e)}get(t){return g(this,t,!0)}peek(t){return g(this,t,!1)}pop(){const t=this[h].tail;return t?(b(this,t),t.value):null}del(t){b(this,this[d].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[d].forEach((t,e)=>g(this,e,!1))}}},{yallist:92}],34:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#",s="http://www.w3.org/2000/10/swap/";n.default={xsd:{decimal:`${i}decimal`,boolean:`${i}boolean`,double:`${i}double`,integer:`${i}integer`,string:`${i}string`},rdf:{type:`${r}type`,nil:`${r}nil`,first:`${r}first`,rest:`${r}rest`,langString:`${r}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${s}reify#forSome`,forAll:`${s}reify#forAll`},log:{implies:`${s}log#implies`}}},{}],35:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.termFromId=function t(e,n){if(n=n||d,!e)return n.defaultGraph();switch(e[0]){case"?":return n.variable(e.substr(1));case"_":return n.blankNode(e.substr(2));case'"':if(n===d)return new g(e);if('"'===e[e.length-1])return n.literal(e.substr(1,e.length-2));const r=e.lastIndexOf('"',e.length-1);return n.literal(e.substr(1,r-1),"@"===e[r+1]?e.substr(r+2):n.namedNode(e.substr(r+3)));case"<":const i=h.exec(e);return n.quad(t(w(i[1]),n),t(w(i[2]),n),t(w(i[3]),n),i[4]&&t(w(i[4]),n));default:return n.namedNode(e)}},n.termToId=function t(e){if("string"==typeof e)return e;if(e instanceof f&&"Quad"!==e.termType)return e.id;if(!e)return u.id;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return`_:${e.value}`;case"Variable":return`?${e.value}`;case"DefaultGraph":return"";case"Literal":return`"${e.value}"${e.language?`@${e.language}`:e.datatype&&e.datatype.value!==a.string?`^^${e.datatype.value}`:""}`;case"Quad":return`<<${v(t(e.subject))} ${v(t(e.predicate))} ${v(t(e.object))}${(0,s.isDefaultGraph)(e.graph)?"":` ${t(e.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${e.termType}`)}},n.escapeQuotes=v,n.unescapeQuotes=w,n.Triple=n.Quad=n.DefaultGraph=n.Variable=n.BlankNode=n.Literal=n.NamedNode=n.Term=n.default=void 0;var r,i=(r=t("./IRIs"))&&r.__esModule?r:{default:r},s=t("./N3Util");const{rdf:o,xsd:a}=i.default;let u,c=0;const l=/^"(.*".*)(?="[^"]*$)/,h=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,d={namedNode:function(t){return new p(t)},blankNode:function(t){return new m(t||"n3-"+c++)},variable:function(t){return new y(t)},literal:function(t,e){if("string"==typeof e)return new g(`"${t}"@${e.toLowerCase()}`);let n=e?e.value:"";return""===n&&("boolean"==typeof t?n=a.boolean:"number"==typeof t&&(Number.isFinite(t)?n=Number.isInteger(t)?a.integer:a.double:(n=a.double,Number.isNaN(t)||(t=t>0?"INF":"-INF")))),new g(""===n||n===a.string?`"${t}"`:`"${t}"^^${n}`)},defaultGraph:function(){return u},quad:x,triple:x};n.default=d;class f{constructor(t){this.id=t}get value(){return this.id}equals(t){return t instanceof f?this.id===t.id:!!t&&this.termType===t.termType&&this.value===t.value}toJSON(){return{termType:this.termType,value:this.value}}}n.Term=f;class p extends f{get termType(){return"NamedNode"}}n.NamedNode=p;class g extends f{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const t=this.id;let e=t.lastIndexOf('"')+1;return e<t.length&&"@"===t[e++]?t.substr(e).toLowerCase():""}get datatype(){return new p(this.datatypeString)}get datatypeString(){const t=this.id,e=t.lastIndexOf('"')+1,n=e<t.length?t[e]:"";return"^"===n?t.substr(e+2):"@"!==n?a.string:o.langString}equals(t){return t instanceof g?this.id===t.id:!!t&&!!t.datatype&&this.termType===t.termType&&this.value===t.value&&this.language===t.language&&this.datatype.value===t.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}n.Literal=g;class m extends f{constructor(t){super(`_:${t}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}n.BlankNode=m;class y extends f{constructor(t){super(`?${t}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}n.Variable=y;class b extends f{constructor(){return super(""),u||this}get termType(){return"DefaultGraph"}equals(t){return this===t||!!t&&this.termType===t.termType}}n.DefaultGraph=b,u=new b;class _ extends f{constructor(t,e,n,r){super(""),this._subject=t,this._predicate=e,this._object=n,this._graph=r||u}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(t){return!!t&&this._subject.equals(t.subject)&&this._predicate.equals(t.predicate)&&this._object.equals(t.object)&&this._graph.equals(t.graph)}}function v(t){return t.replace(l,(t,e)=>`"${e.replace(/"/g,'""')}`)}function w(t){return t.replace(l,(t,e)=>`"${e.replace(/""/g,'"')}`)}function x(t,e,n,r){return new _(t,e,n,r)}n.Triple=n.Quad=_},{"./IRIs":34,"./N3Util":41}],36:[function(t,e,n){(function(e){(function(){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=s(t("./IRIs")),i=s(t("queue-microtask"));function s(t){return t&&t.__esModule?t:{default:t}}const{xsd:o}=r.default,a=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,u={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},c=/[\x00-\x20<>\\"\{\}\|\^\`]/,l={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},h=/$0^/;n.default=class{constructor(t){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(t=t||{}).lineMode){this._n3Mode=!1;for(const t in this)!(t in l)&&this[t]instanceof RegExp&&(this[t]=h)}else this._n3Mode=!1!==t.n3;this._comments=!!t.comments,this._literalClosingPos=0}_tokenizeToEnd(t,e){let n=this._input;const r=this._comments;for(;;){let s,a;for(;s=this._newline.exec(n);)r&&(a=this._comment.exec(s[0]))&&t(null,{line:this._line,type:"comment",value:a[1],prefix:""}),n=n.substr(s[0].length,n.length),this._line++;if(!s&&(s=this._whitespace.exec(n))&&(n=n.substr(s[0].length,n.length)),this._endOfFile.test(n))return e&&(r&&(a=this._comment.exec(n))&&t(null,{line:this._line,type:"comment",value:a[1],prefix:""}),t(n=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=n;const u=this._line,l=n[0];let h="",d="",f="",p=null,g=0,m=!1;switch(l){case"^":if(n.length<3)break;if("^"!==n[1]){this._n3Mode&&(g=1,h="^");break}if(this._previousMarker="^^",n=n.substr(2),"<"!==n[0]){m=!0;break}case"<":if(p=this._unescapedIri.exec(n))h="IRI",d=p[1];else if(p=this._iri.exec(n)){if(d=this._unescape(p[1]),null===d||c.test(d))return i(this);h="IRI"}else n.length>1&&"<"===n[1]?(h="<<",g=2):this._n3Mode&&n.length>1&&"="===n[1]&&(h="inverse",g=2,d=">");break;case">":n.length>1&&">"===n[1]&&(h=">>",g=2);break;case"_":((p=this._blank.exec(n))||e&&(p=this._blank.exec(`${n} `)))&&(h="blank",f="_",d=p[1]);break;case'"':if(p=this._simpleQuotedString.exec(n))d=p[1];else if(({value:d,matchLength:g}=this._parseLiteral(n)),null===d)return i(this);null===p&&0===g||(h="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(p=this._simpleApostropheString.exec(n))d=p[1];else if(({value:d,matchLength:g}=this._parseLiteral(n)),null===d)return i(this);null===p&&0===g||(h="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(p=this._variable.exec(n))&&(h="var",d=p[0]);break;case"@":"literal"===this._previousMarker&&(p=this._langcode.exec(n))?(h="langcode",d=p[1]):(p=this._keyword.exec(n))&&(h=p[0]);break;case".":if(1===n.length?e:n[1]<"0"||n[1]>"9"){h=".",g=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(p=this._number.exec(n)||e&&(p=this._number.exec(`${n} `)))&&(h="literal",d=p[0],f="string"==typeof p[1]?o.double:"string"==typeof p[2]?o.decimal:o.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(p=this._sparqlKeyword.exec(n))?h=p[0].toUpperCase():m=!0;break;case"f":case"t":(p=this._boolean.exec(n))?(h="literal",d=p[0],f=o.boolean):m=!0;break;case"a":(p=this._shortPredicates.exec(n))?(h="abbreviation",d="a"):m=!0;break;case"=":this._n3Mode&&n.length>1&&(h="abbreviation",">"!==n[1]?(g=1,d="="):(g=2,d=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(g=1,h=l);break;default:m=!0}if(m&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(p=this._prefix.exec(n))?((p=this._prefixed.exec(n))||e&&(p=this._prefixed.exec(`${n} `)))&&(h="prefixed",f=p[1]||"",d=this._unescape(p[2])):(h="prefix",d=p[1]||"")),"^^"===this._previousMarker)switch(h){case"prefixed":h="type";break;case"IRI":h="typeIRI";break;default:h=""}if(!h)return e||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?i(this):this._input=n;const y={line:u,type:h,value:d,prefix:f};t(null,y),this.previousToken=y,this._previousMarker=h,n=n.substr(g||p[0].length,n.length)}function i(e){t(e._syntaxError(/^\S*/.exec(n)[0]))}}_unescape(t){let e=!1;const n=t.replace(a,(t,n,r,i)=>{if("string"==typeof n)return String.fromCharCode(Number.parseInt(n,16));if("string"==typeof r){let t=Number.parseInt(r,16);return t<=65535?String.fromCharCode(Number.parseInt(r,16)):String.fromCharCode(55296+((t-=65536)>>10),56320+(1023&t))}return i in u?u[i]:(e=!0,"")});return e?null:n}_parseLiteral(t){if(t.length>=3){const e=t.match(/^(?:"""|"|'''|'|)/)[0],n=e.length;let r=Math.max(this._literalClosingPos,n);for(;(r=t.indexOf(e,r))>0;){let e=0;for(;"\\"===t[r-e-1];)e++;if(e%2==0){const e=t.substring(n,r),i=e.split(/\r\n|\r|\n/).length-1,s=r+n;if(1===n&&0!==i||3===n&&this._lineMode)break;return this._line+=i,{value:this._unescape(e),matchLength:s}}r++}this._literalClosingPos=t.length-n+1}return{value:"",matchLength:0}}_syntaxError(t){this._input=null;const e=new Error(`Unexpected "${t}" on line ${this._line}.`);return e.context={token:void 0,line:this._line,previousToken:this.previousToken},e}_readStartingBom(t){return t.startsWith("\ufeff")?t.substr(1):t}tokenize(t,n){if(this._line=1,"string"==typeof t){if(this._input=this._readStartingBom(t),"function"!=typeof n){const t=[];let e;if(this._tokenizeToEnd((n,r)=>n?e=n:t.push(r),!0),e)throw e;return t}(0,i.default)(()=>this._tokenizeToEnd(n,!0))}else this._pendingBuffer=null,"function"==typeof t.setEncoding&&t.setEncoding("utf8"),t.on("data",t=>{null!==this._input&&0!==t.length&&(this._pendingBuffer&&(t=e.concat([this._pendingBuffer,t]),this._pendingBuffer=null),128&t[t.length-1]?this._pendingBuffer=t:(void 0===this._input?this._input=this._readStartingBom("string"==typeof t?t:t.toString()):this._input+=t,this._tokenizeToEnd(n,!1)))}),t.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(n,!0)}),t.on("error",n)}}}).call(this)}).call(this,t("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(t("./N3Lexer")),i=o(t("./N3DataFactory")),s=o(t("./IRIs"));function o(t){return t&&t.__esModule?t:{default:t}}let a=0;class u{constructor(t){this._contextStack=[],this._graph=null,this._setBase((t=t||{}).baseIRI),t.factory&&l(this,t.factory);const e="string"==typeof t.format?t.format.match(/\w*$/)[0].toLowerCase():"",n=/turtle/.test(e),i=/trig/.test(e),s=/triple/.test(e),o=/quad/.test(e),a=this._n3Mode=/n3/.test(e),u=s||o;(this._supportsNamedGraphs=!(n||a))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||i||s||a),this._supportsRDFStar=""===e||/star|\*$/.test(e),u&&(this._resolveRelativeIRI=t=>null),this._blankNodePrefix="string"!=typeof t.blankNodePrefix?"":t.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=t.lexer||new r.default({lineMode:u,n3:a}),this._explicitQuantifiers=!!t.explicitQuantifiers}static _resetBlankNodePrefix(){a=0}_setBase(t){if(t){const e=t.indexOf("#");e>=0&&(t=t.substr(0,e)),this._base=t,this._basePath=t.indexOf("/")<0?t:t.replace(/[^\/?]*(?:\?.*)?$/,""),t=t.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=t[0],this._baseScheme=t[1]}else this._base="",this._basePath=""}_saveContext(t,e,n,r,i){const s=this._n3Mode;this._contextStack.push({subject:n,predicate:r,object:i,graph:e,type:t,inverse:!!s&&this._inversePredicate,blankPrefix:s?this._prefixes._:"",quantified:s?this._quantified:null}),s&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const t=this._contextStack.pop(),e=this._n3Mode;this._subject=t.subject,this._predicate=t.predicate,this._object=t.object,this._graph=t.graph,e&&(this._inversePredicate=t.inverse,this._prefixes._=t.blankPrefix,this._quantified=t.quantified)}_readInTopContext(t){switch(t.type){case"eof":return null!==this._graph?this._error("Unclosed graph",t):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(t)}}_readEntity(t,e){let n;switch(t.type){case"IRI":case"typeIRI":const e=this._resolveIRI(t.value);if(null===e)return this._error("Invalid IRI",t);n=this._namedNode(e);break;case"type":case"prefixed":const r=this._prefixes[t.prefix];if(void 0===r)return this._error(`Undefined prefix "${t.prefix}:"`,t);n=this._namedNode(r+t.value);break;case"blank":n=this._blankNode(this._prefixes[t.prefix]+t.value);break;case"var":n=this._variable(t.value.substr(1));break;default:return this._error(`Expected entity but got ${t.type}`,t)}return!e&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}_readSubject(t){switch(this._predicate=null,t.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",t);case"}":return this._readPunctuation(t);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',t);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',t);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",t);if(0===t.prefix.length)return this._literalValue=t.value,this._completeSubjectLiteral;this._subject=this._literal(t.value,this._namedNode(t.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",t);default:if(void 0===(this._subject=this._readEntity(t)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(t){const e=t.type;switch(e){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[t.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${e}`,t):(this._subject=null,"]"===e?this._readBlankNodeTail(t):this._readPunctuation(t));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",t);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",t);default:if(void 0===(this._predicate=this._readEntity(t)))return}return this._readObject}_readObject(t){switch(t.type){case"literal":if(0===t.prefix.length)return this._literalValue=t.value,this._readDataTypeOrLang;this._object=this._literal(t.value,this._namedNode(t.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",t);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",t);default:if(void 0===(this._object=this._readEntity(t)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(t){return"{"===t.type?this._readGraph(t):this._readPredicate(t)}_readGraph(t){return"{"!==t.type?this._error(`Expected graph but got ${t.type}`,t):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(t){return"]"===t.type?(this._subject=null,this._readBlankNodeTail(t)):(this._predicate=null,this._readPredicate(t))}_readBlankNodeTail(t){if("]"!==t.type)return this._readBlankNodePunctuation(t);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const e=null===this._predicate;return this._restoreContext(),null===this._object?e?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()}_readPredicateAfterBlank(t){switch(t.type){case".":case"}":return this._subject=null,this._readPunctuation(t);default:return this._readPredicate(t)}}_readListItem(t){let e=null,n=null,r=this._readListItem;const i=this._subject,s=this._contextStack,o=s[s.length-1];switch(t.type){case"[":this._saveContext("blank",this._graph,n=this._blankNode(),this.RDF_FIRST,this._subject=e=this._blankNode()),r=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==s.length&&"list"===s[s.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(r=this._readPredicate,this._subject===this.RDF_NIL)return r}else if(r=this._getContextEndReader(),this._object===this.RDF_NIL)return r;n=this.RDF_NIL;break;case"literal":0===t.prefix.length?(this._literalValue=t.value,r=this._readListItemDataTypeOrLang):(e=this._literal(t.value,this._namedNode(t.prefix)),r=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",t);default:if(void 0===(e=this._readEntity(t)))return}if(null===n&&(this._subject=n=this._blankNode()),null===i?null===o.predicate?o.subject=n:o.object=n:this._emit(i,this.RDF_REST,n,this._graph),null!==e){if(this._n3Mode&&("IRI"===t.type||"prefixed"===t.type))return this._saveContext("item",this._graph,n,this.RDF_FIRST,e),this._subject=e,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,e,this._graph)}return r}_readDataTypeOrLang(t){return this._completeObjectLiteral(t,!1)}_readListItemDataTypeOrLang(t){return this._completeObjectLiteral(t,!0)}_completeLiteral(t){let e=this._literal(this._literalValue);switch(t.type){case"type":case"typeIRI":const n=this._readEntity(t);if(void 0===n)return;e=this._literal(this._literalValue,n),t=null;break;case"langcode":e=this._literal(this._literalValue,t.value),t=null}return{token:t,literal:e}}_completeSubjectLiteral(t){return this._subject=this._completeLiteral(t).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(t,e){const n=this._completeLiteral(t);if(n)return this._object=n.literal,e&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===n.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(n.token))}_readFormulaTail(t){return"}"!==t.type?this._readPunctuation(t):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(t){let e,n=this._graph;const r=this._subject,i=this._inversePredicate;switch(t.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",t);if(this._n3Mode)return this._readFormulaTail(t);this._graph=null;case".":this._subject=null,e=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":e=this._readPredicate;break;case",":e=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(t))){e=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,t)}if(null!==r){const t=this._predicate,e=this._object;i?this._emit(e,t,r,n):this._emit(r,t,e,n)}return e}_readBlankNodePunctuation(t){let e;switch(t.type){case";":e=this._readPredicate;break;case",":e=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,t)}return this._emit(this._subject,this._predicate,this._object,this._graph),e}_readQuadPunctuation(t){return"."!==t.type?this._error("Expected dot to follow quad",t):this._readInTopContext}_readPrefix(t){return"prefix"!==t.type?this._error("Expected prefix to follow @prefix",t):(this._prefix=t.value,this._readPrefixIRI)}_readPrefixIRI(t){if("IRI"!==t.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,t);const e=this._readEntity(t);return this._prefixes[this._prefix]=e.value,this._prefixCallback(this._prefix,e),this._readDeclarationPunctuation}_readBaseIRI(t){const e="IRI"===t.type&&this._resolveIRI(t.value);return e?(this._setBase(e),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",t)}_readNamedGraphLabel(t){switch(t.type){case"IRI":case"blank":case"prefixed":return this._readSubject(t),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",t)}}_readNamedGraphBlankLabel(t){return"]"!==t.type?this._error("Invalid graph label",t):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(t){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(t)):"."!==t.type?this._error("Expected declaration to end with a dot",t):this._readInTopContext}_readQuantifierList(t){let e;switch(t.type){case"IRI":case"prefixed":if(void 0!==(e=this._readEntity(t,!0)))break;default:return this._error(`Unexpected ${t.type}`,t)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,e,this.QUANTIFIERS_GRAPH)):this._quantified[e.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(t){return","===t.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(t))}_getPathReader(t){return this._afterPath=t,this._readPath}_readPath(t){switch(t.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const e=this._contextStack,n=e.length&&e[e.length-1];if(n&&"item"===n.type){const t=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,t,this._graph)}return this._afterPath(t)}}_readForwardPath(t){let e,n;const r=this._blankNode();if(void 0!==(n=this._readEntity(t)))return null===this._predicate?(e=this._subject,this._subject=r):(e=this._object,this._object=r),this._emit(e,n,r,this._graph),this._readPath}_readBackwardPath(t){const e=this._blankNode();let n,r;if(void 0!==(n=this._readEntity(t)))return null===this._predicate?(r=this._subject,this._subject=e):(r=this._object,this._object=e),this._emit(e,n,r,this._graph),this._readPath}_readRDFStarTailOrGraph(t){return">>"!==t.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(t))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,t):this._readRDFStarTail(t)}_readRDFStarTail(t){if(">>"!==t.type)return this._error(`Expected >> but got ${t.type}`,t);const e=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=e,this._readPredicate):(this._object=e,this._getContextEndReader())}_getContextEndReader(){const t=this._contextStack;if(!t.length)return this._readPunctuation;switch(t[t.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(t,e,n,r){this._callback(null,this._quad(t,e,n,r||this.DEFAULTGRAPH))}_error(t,e){const n=new Error(`${t} on line ${e.line}.`);n.context={token:e,line:e.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=c}_resolveIRI(t){return/^[a-z][a-z0-9+.-]*:/i.test(t)?t:this._resolveRelativeIRI(t)}_resolveRelativeIRI(t){if(!t.length)return this._base;switch(t[0]){case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return/^[^/:]*:/.test(t)?null:this._removeDotSegments(this._basePath+t)}}_removeDotSegments(t){if(!/(^|\/)\.\.?($|[/#?])/.test(t))return t;const e=t.length;let n="",r=-1,i=-1,s=0,o="/";for(;r<e;){switch(o){case":":if(i<0&&"/"===t[++r]&&"/"===t[++r])for(;(i=r+1)<e&&"/"!==t[i];)r=i;break;case"?":case"#":r=e;break;case"/":if("."===t[r+1])switch(o=t[1+ ++r],o){case"/":n+=t.substring(s,r-1),s=r+1;break;case void 0:case"?":case"#":return n+t.substring(s,r)+t.substr(r+1);case".":if(o=t[1+ ++r],void 0===o||"/"===o||"?"===o||"#"===o){if(n+=t.substring(s,r-2),(s=n.lastIndexOf("/"))>=i&&(n=n.substr(0,s)),"/"!==o)return`${n}/${t.substr(r+1)}`;s=r+1}}}o=t[++r]}return n+t.substring(s)}parse(t,e,n){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${a++}_`,this._prefixCallback=n||c,this._inversePredicate=!1,this._quantified=Object.create(null),!e){const e=[];let n;if(this._callback=(t,r)=>{t?n=t:r&&e.push(r)},this._lexer.tokenize(t).every(t=>this._readCallback=this._readCallback(t)),n)throw n;return e}this._callback=e,this._lexer.tokenize(t,(t,e)=>{null!==t?(this._callback(t),this._callback=c):this._readCallback&&(this._readCallback=this._readCallback(e))})}}function c(){}function l(t,e){const n=e.namedNode;t._namedNode=n,t._blankNode=e.blankNode,t._literal=e.literal,t._variable=e.variable,t._quad=e.quad,t.DEFAULTGRAPH=e.defaultGraph(),t.RDF_FIRST=n(s.default.rdf.first),t.RDF_REST=n(s.default.rdf.rest),t.RDF_NIL=n(s.default.rdf.nil),t.N3_FORALL=n(s.default.r.forAll),t.N3_FORSOME=n(s.default.r.forSome),t.ABBREVIATIONS={a:n(s.default.rdf.type),"=":n(s.default.owl.sameAs),">":n(s.default.log.implies)},t.QUANTIFIERS_GRAPH=n("urn:n3:quantifiers")}n.default=u,l(u.prototype,i.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=a(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var o=i?Object.getOwnPropertyDescriptor(t,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}(t("./N3DataFactory")),s=t("readable-stream"),o=(r=t("./IRIs"))&&r.__esModule?r:{default:r};function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(a=function(t){return t?n:e})(t)}class u{constructor(t,e){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,e||!t||t[0]||(e=t,t=null),this._factory=(e=e||{}).factory||i.default,t&&this.addQuads(t)}get size(){let t=this._size;if(null!==t)return t;t=0;const e=this._graphs;let n,r;for(const i in e)for(const s in n=e[i].subjects)for(const e in r=n[s])t+=Object.keys(r[e]).length;return this._size=t}_addToIndex(t,e,n,r){const i=t[e]||(t[e]={}),s=i[n]||(i[n]={}),o=r in s;return o||(s[r]=null),!o}_removeFromIndex(t,e,n,r){const i=t[e],s=i[n];delete s[r];for(const o in s)return;delete i[n];for(const o in i)return;delete t[e]}_findInIndex(t,e,n,r,s,o,a,u,c,l){let h,d,f;const p=!e+!n+!r>1?Object.keys(this._ids):this._entities;e&&((h=t,t={})[e]=h[e]);for(const g in t){const e=p[g];if(d=t[g]){n&&((h=d,d={})[n]=h[n]);for(const t in d){const n=p[t];if(f=d[t]){const t=r?r in f?[r]:[]:Object.keys(f);for(let r=0;r<t.length;r++){const h={subject:null,predicate:null,object:null};h[s]=(0,i.termFromId)(e,this._factory),h[o]=(0,i.termFromId)(n,this._factory),h[a]=(0,i.termFromId)(p[t[r]],this._factory);const d=this._factory.quad(h.subject,h.predicate,h.object,(0,i.termFromId)(u,this._factory));if(l)l.push(d);else if(c(d))return!0}}}}}return l}_loop(t,e){for(const n in t)e(n)}_loopByKey0(t,e,n){let r,i;if(r=t[e])for(i in r)n(i)}_loopByKey1(t,e,n){let r,i;for(r in t)i=t[r],i[e]&&n(r)}_loopBy2Keys(t,e,n,r){let i,s,o;if((i=t[e])&&(s=i[n]))for(o in s)r(o)}_countInIndex(t,e,n,r){let i,s,o,a=0;e&&((i=t,t={})[e]=i[e]);for(const u in t)if(s=t[u]){n&&((i=s,s={})[n]=i[n]);for(const t in s)(o=s[t])&&(r?r in o&&a++:a+=Object.keys(o).length)}return a}_getGraphs(t){if(!c(t))return this._graphs;const e={};return e[t]=this._graphs[t],e}_uniqueEntities(t){const e=Object.create(null);return n=>{n in e||(e[n]=!0,t((0,i.termFromId)(this._entities[n],this._factory)))}}add(t){return this.addQuad(t),this}addQuad(t,e,n,r){e||(r=t.graph,n=t.object,e=t.predicate,t=t.subject),t=(0,i.termToId)(t),e=(0,i.termToId)(e),n=(0,i.termToId)(n),r=(0,i.termToId)(r);let s=this._graphs[r];s||(s=this._graphs[r]={subjects:{},predicates:{},objects:{}},Object.freeze(s));const o=this._ids,a=this._entities;t=o[t]||(o[a[++this._id]=t]=this._id),e=o[e]||(o[a[++this._id]=e]=this._id),n=o[n]||(o[a[++this._id]=n]=this._id);const u=this._addToIndex(s.subjects,t,e,n);return this._addToIndex(s.predicates,e,n,t),this._addToIndex(s.objects,n,t,e),this._size=null,u}addQuads(t){for(let e=0;e<t.length;e++)this.addQuad(t[e])}delete(t){return this.removeQuad(t),this}has(t){return 0!==this.getQuads(t.subject,t.predicate,t.object,t.graph).length}import(t){return t.on("data",t=>{this.addQuad(t)}),t}removeQuad(t,e,n,r){e||(r=t.graph,n=t.object,e=t.predicate,t=t.subject),t=(0,i.termToId)(t),e=(0,i.termToId)(e),n=(0,i.termToId)(n),r=(0,i.termToId)(r);const s=this._ids,o=this._graphs;let a,u,c;if(!((t=s[t])&&(e=s[e])&&(n=s[n])&&(a=o[r])&&(u=a.subjects[t])&&(c=u[e])&&n in c))return!1;for(t in this._removeFromIndex(a.subjects,t,e,n),this._removeFromIndex(a.predicates,e,n,t),this._removeFromIndex(a.objects,n,t,e),null!==this._size&&this._size--,a.subjects)return!0;return delete o[r],!0}removeQuads(t){for(let e=0;e<t.length;e++)this.removeQuad(t[e])}remove(t){return t.on("data",t=>{this.removeQuad(t)}),t}removeMatches(t,e,n,r){const i=new s.Readable({objectMode:!0});return i._read=()=>{for(const s of this.getQuads(t,e,n,r))i.push(s);i.push(null)},this.remove(i)}deleteGraph(t){return this.removeMatches(null,null,null,t)}getQuads(t,e,n,r){t=t&&(0,i.termToId)(t),e=e&&(0,i.termToId)(e),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const s=[],o=this._getGraphs(r),a=this._ids;let u,l,h,d;if(c(t)&&!(l=a[t])||c(e)&&!(h=a[e])||c(n)&&!(d=a[n]))return s;for(const i in o)(u=o[i])&&(l?d?this._findInIndex(u.objects,d,l,h,"object","subject","predicate",i,null,s):this._findInIndex(u.subjects,l,h,null,"subject","predicate","object",i,null,s):h?this._findInIndex(u.predicates,h,d,null,"predicate","object","subject",i,null,s):d?this._findInIndex(u.objects,d,null,null,"object","subject","predicate",i,null,s):this._findInIndex(u.subjects,null,null,null,"subject","predicate","object",i,null,s));return s}match(t,e,n,r){return new l(this,t,e,n,r)}countQuads(t,e,n,r){t=t&&(0,i.termToId)(t),e=e&&(0,i.termToId)(e),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const s=this._getGraphs(r),o=this._ids;let a,u,l,h,d=0;if(c(t)&&!(u=o[t])||c(e)&&!(l=o[e])||c(n)&&!(h=o[n]))return 0;for(const i in s)(a=s[i])&&(d+=t?n?this._countInIndex(a.objects,h,u,l):this._countInIndex(a.subjects,u,l,h):e?this._countInIndex(a.predicates,l,h,u):this._countInIndex(a.objects,h,u,l));return d}forEach(t,e,n,r,i){this.some(e=>(t(e),!1),e,n,r,i)}every(t,e,n,r,i){let s=!1;const o=!this.some(e=>(s=!0,!t(e)),e,n,r,i);return s&&o}some(t,e,n,r,s){e=e&&(0,i.termToId)(e),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r),s=s&&(0,i.termToId)(s);const o=this._getGraphs(s),a=this._ids;let u,l,h,d;if(c(e)&&!(l=a[e])||c(n)&&!(h=a[n])||c(r)&&!(d=a[r]))return!1;for(const i in o)if(u=o[i])if(l){if(d){if(this._findInIndex(u.objects,d,l,h,"object","subject","predicate",i,t,null))return!0}else if(this._findInIndex(u.subjects,l,h,null,"subject","predicate","object",i,t,null))return!0}else if(h){if(this._findInIndex(u.predicates,h,d,null,"predicate","object","subject",i,t,null))return!0}else if(d){if(this._findInIndex(u.objects,d,null,null,"object","subject","predicate",i,t,null))return!0}else if(this._findInIndex(u.subjects,null,null,null,"subject","predicate","object",i,t,null))return!0;return!1}getSubjects(t,e,n){const r=[];return this.forSubjects(t=>{r.push(t)},t,e,n),r}forSubjects(t,e,n,r){e=e&&(0,i.termToId)(e),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const s=this._ids,o=this._getGraphs(r);let a,u,l;if(t=this._uniqueEntities(t),!(c(e)&&!(u=s[e])||c(n)&&!(l=s[n])))for(r in o)(a=o[r])&&(u?l?this._loopBy2Keys(a.predicates,u,l,t):this._loopByKey1(a.subjects,u,t):l?this._loopByKey0(a.objects,l,t):this._loop(a.subjects,t))}getPredicates(t,e,n){const r=[];return this.forPredicates(t=>{r.push(t)},t,e,n),r}forPredicates(t,e,n,r){e=e&&(0,i.termToId)(e),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const s=this._ids,o=this._getGraphs(r);let a,u,l;if(t=this._uniqueEntities(t),!(c(e)&&!(u=s[e])||c(n)&&!(l=s[n])))for(r in o)(a=o[r])&&(u?l?this._loopBy2Keys(a.objects,l,u,t):this._loopByKey0(a.subjects,u,t):l?this._loopByKey1(a.predicates,l,t):this._loop(a.predicates,t))}getObjects(t,e,n){const r=[];return this.forObjects(t=>{r.push(t)},t,e,n),r}forObjects(t,e,n,r){e=e&&(0,i.termToId)(e),n=n&&(0,i.termToId)(n),r=r&&(0,i.termToId)(r);const s=this._ids,o=this._getGraphs(r);let a,u,l;if(t=this._uniqueEntities(t),!(c(e)&&!(u=s[e])||c(n)&&!(l=s[n])))for(r in o)(a=o[r])&&(u?l?this._loopBy2Keys(a.subjects,u,l,t):this._loopByKey1(a.objects,u,t):l?this._loopByKey0(a.predicates,l,t):this._loop(a.objects,t))}getGraphs(t,e,n){const r=[];return this.forGraphs(t=>{r.push(t)},t,e,n),r}forGraphs(t,e,n,r){for(const i in this._graphs)this.some(e=>(t(e.graph),!0),e,n,r,i)}createBlankNode(t){let e,n;if(t)for(e=t=`_:${t}`,n=1;this._ids[e];)e=t+n++;else do{e="_:b"+this._blankNodeIndex++}while(this._ids[e]);return this._ids[e]=++this._id,this._entities[this._id]=e,this._factory.blankNode(e.substr(2))}extractLists({remove:t=!1,ignoreErrors:e=!1}={}){const n={},r=e?()=>!0:(t,e)=>{throw new Error(`${t.value} ${e}`)},i=this.getQuads(null,o.default.rdf.rest,o.default.rdf.nil,null),s=t?[...i]:[];return i.forEach(e=>{const i=[];let a,u,c=!1;const l=e.graph;let h=e.subject;for(;h&&!c;){const t=this.getQuads(null,null,h,null),e=this.getQuads(h,null,null,null);let n,d=null,f=null,p=null;for(let i=0;i<e.length&&!c;i++)n=e[i],n.graph.equals(l)?a?c=r(h,"has non-list arcs out"):n.predicate.value===o.default.rdf.first?d?c=r(h,"has multiple rdf:first arcs"):s.push(d=n):n.predicate.value===o.default.rdf.rest?f?c=r(h,"has multiple rdf:rest arcs"):s.push(f=n):t.length?c=r(h,"can't be subject and object"):(a=n,u="subject"):c=r(h,"not confined to single graph");for(let i=0;i<t.length&&!c;++i)n=t[i],a?c=r(h,"can't have coreferences"):n.predicate.value===o.default.rdf.rest?p?c=r(h,"has incoming rdf:rest arcs"):p=n:(a=n,u="object");d?i.unshift(d.object):c=r(h,"has no list head"),h=p&&p.subject}c?t=!1:a&&(n[a[u].value]=i)}),t&&this.removeQuads(s),n}*[Symbol.iterator](){yield*this.getQuads()}}function c(t){return"string"==typeof t||t instanceof String}n.default=u;class l extends s.Readable{constructor(t,e,n,r,i){super({objectMode:!0}),Object.assign(this,{n3Store:t,subject:e,predicate:n,object:r,graph:i})}get filtered(){if(!this._filtered){const{n3Store:t,graph:e,object:n,predicate:r,subject:i}=this,s=t.getQuads(i,r,n,e);this._filtered=new u(s,{factory:t._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const t of this.filtered.getQuads())this.push(t);this.push(null)}add(t){return this.filtered.add(t)}delete(t){return this.filtered.delete(t)}has(t){return this.filtered.has(t)}match(t,e,n,r){return new l(this.filtered,t,e,n,r)}*[Symbol.iterator](){yield*this.filtered.getQuads()}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=(r=t("./N3Parser"))&&r.__esModule?r:{default:r},s=t("readable-stream");n.default=class extends s.Transform{constructor(t){let e,n;super({decodeStrings:!0}),this._readableState.objectMode=!0,new i.default(t).parse({on:(t,r)=>{switch(t){case"data":e=r;break;case"end":n=r}}},(t,e)=>{t&&this.emit("error",t)||e&&this.push(e)},(t,e)=>{this.emit("prefix",t,e)}),this._transform=(t,n,r)=>{e(t),r()},this._flush=t=>{n(),t()}}import(t){return t.on("data",t=>{this.write(t)}),t.on("end",()=>{this.end()}),t.on("error",t=>{this.emit("error",t)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=t("readable-stream"),s=(r=t("./N3Writer"))&&r.__esModule?r:{default:r};n.default=class extends i.Transform{constructor(t){super({encoding:"utf8",writableObjectMode:!0});const e=this._writer=new s.default({write:(t,e,n)=>{this.push(t),n&&n()},end:t=>{this.push(null),t&&t()}},t);this._transform=(t,n,r)=>{e.addQuad(t,r)},this._flush=t=>{e.end(t)}}import(t){return t.on("data",t=>{this.write(t)}),t.on("end",()=>{this.end()}),t.on("error",t=>{this.emit("error",t)}),t.on("prefix",(t,e)=>{this._writer.addPrefix(t,e)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isNamedNode=function(t){return!!t&&"NamedNode"===t.termType},n.isBlankNode=function(t){return!!t&&"BlankNode"===t.termType},n.isLiteral=function(t){return!!t&&"Literal"===t.termType},n.isVariable=function(t){return!!t&&"Variable"===t.termType},n.isDefaultGraph=s,n.inDefaultGraph=function(t){return s(t.graph)},n.prefix=function(t,e){return o({"":t},e)("")},n.prefixes=o;var r,i=(r=t("./N3DataFactory"))&&r.__esModule?r:{default:r};function s(t){return!!t&&"DefaultGraph"===t.termType}function o(t,e){const n=Object.create(null);for(const i in t)r(i,t[i]);function r(t,r){if("string"==typeof r){const i=Object.create(null);n[t]=t=>i[t]||(i[t]=e.namedNode(r+t))}else if(!(t in n))throw new Error(`Unknown prefix: ${t}`);return n[t]}return e=e||i.default,r}},{"./N3DataFactory":35}],42:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=(r=t("./IRIs"))&&r.__esModule?r:{default:r},s=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=a(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var o=i?Object.getOwnPropertyDescriptor(t,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}(t("./N3DataFactory")),o=t("./N3Util");function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(a=function(t){return t?n:e})(t)}const u=s.default.defaultGraph(),{rdf:c,xsd:l}=i.default,h=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,d=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,f={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class p extends s.Term{equals(){return!1}}function g(t){let e=f[t];return void 0===e&&(1===t.length?(e=t.charCodeAt(0).toString(16),e="\\u0000".substr(0,6-e.length)+e):(e=(1024*(t.charCodeAt(0)-55296)+t.charCodeAt(1)+9216).toString(16),e="\\U00000000".substr(0,10-e.length)+e)),e}n.default=class{constructor(t,e){if(this._prefixRegex=/$0^/,t&&"function"!=typeof t.write&&(e=t,t=null),this._lists=(e=e||{}).lists,t)this._outputStream=t,this._endStream=void 0===e.end||!!e.end;else{let t="";this._outputStream={write(e,n,r){t+=e,r&&r()},end:e=>{e&&e(null,t)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(e.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=u,this._baseIRI=e.baseIRI,this._prefixIRIs=Object.create(null),e.prefixes&&this.addPrefixes(e.prefixes))}get _inDefaultGraph(){return u.equals(this._graph)}_write(t,e){this._outputStream.write(t,"utf8",e)}_writeQuad(t,e,n,r,i){try{r.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(u.equals(r)?"":`${this._encodeIriOrBlank(r)} {\n`)),this._graph=r,this._subject=null),t.equals(this._subject)?e.equals(this._predicate)?this._write(`, ${this._encodeObject(n)}`,i):this._write(`;\n    ${this._encodePredicate(this._predicate=e)} ${this._encodeObject(n)}`,i):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=t)} ${this._encodePredicate(this._predicate=e)} ${this._encodeObject(n)}`,i)}catch(s){i&&i(s)}}_writeQuadLine(t,e,n,r,i){delete this._prefixMatch,this._write(this.quadToString(t,e,n,r),i)}quadToString(t,e,n,r){return`${this._encodeSubject(t)} ${this._encodeIriOrBlank(e)} ${this._encodeObject(n)}${r&&r.value?` ${this._encodeIriOrBlank(r)} .\n`:" .\n"}`}quadsToString(t){return t.map(t=>this.quadToString(t.subject,t.predicate,t.object,t.graph)).join("")}_encodeSubject(t){return"Quad"===t.termType?this._encodeQuad(t):this._encodeIriOrBlank(t)}_encodeIriOrBlank(t){if("NamedNode"!==t.termType)return this._lists&&t.value in this._lists&&(t=this.list(this._lists[t.value])),"id"in t?t.id:`_:${t.value}`;let e=t.value;this._baseIRI&&e.startsWith(this._baseIRI)&&(e=e.substr(this._baseIRI.length)),h.test(e)&&(e=e.replace(d,g));const n=this._prefixRegex.exec(e);return n?n[1]?this._prefixIRIs[n[1]]+n[2]:e:`<${e}>`}_encodeLiteral(t){let e=t.value;if(h.test(e)&&(e=e.replace(d,g)),t.language)return`"${e}"@${t.language}`;if(this._lineMode){if(t.datatype.value===l.string)return`"${e}"`}else switch(t.datatype.value){case l.string:return`"${e}"`;case l.boolean:if("true"===e||"false"===e)return e;break;case l.integer:if(/^[+-]?\d+$/.test(e))return e;break;case l.decimal:if(/^[+-]?\d*\.\d+$/.test(e))return e;break;case l.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(e))return e}return`"${e}"^^${this._encodeIriOrBlank(t.datatype)}`}_encodePredicate(t){return t.value===c.type?"a":this._encodeIriOrBlank(t)}_encodeObject(t){switch(t.termType){case"Quad":return this._encodeQuad(t);case"Literal":return this._encodeLiteral(t);default:return this._encodeIriOrBlank(t)}}_encodeQuad({subject:t,predicate:e,object:n,graph:r}){return`<<${this._encodeSubject(t)} ${this._encodePredicate(e)} ${this._encodeObject(n)}${(0,o.isDefaultGraph)(r)?"":` ${this._encodeIriOrBlank(r)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(t,e,n,r,i){void 0===n?this._writeQuad(t.subject,t.predicate,t.object,t.graph,e):"function"==typeof r?this._writeQuad(t,e,n,u,r):this._writeQuad(t,e,n,r||u,i)}addQuads(t){for(let e=0;e<t.length;e++)this.addQuad(t[e])}addPrefix(t,e,n){const r={};r[t]=e,this.addPrefixes(r,n)}addPrefixes(t,e){if(!this._prefixIRIs)return e&&e();let n=!1;for(let r in t){let e=t[r];"string"!=typeof e&&(e=e.value),n=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[e]=r+=":",this._write(`@prefix ${r} <${e}>.\n`)}if(n){let t="",e="";for(const n in this._prefixIRIs)t+=t?`|${n}`:n,e+=(e?"|":"")+this._prefixIRIs[n];t=t.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp(`^(?:${e})[^/]*$|^(${t})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(n?"\n":"",e)}blank(t,e){let n,r,i=t;switch(void 0===t?i=[]:t.termType?i=[{predicate:t,object:e}]:"length"in t||(i=[t]),r=i.length){case 0:return new p("[]");case 1:if(n=i[0],!(n.object instanceof p))return new p(`[ ${this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)} ]`);default:let e="[";for(let s=0;s<r;s++)n=i[s],n.predicate.equals(t)?e+=`, ${this._encodeObject(n.object)}`:(e+=`${(s?";\n  ":"\n  ")+this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)}`,t=n.predicate);return new p(`${e}\n]`)}}list(t){const e=t&&t.length||0,n=new Array(e);for(let r=0;r<e;r++)n[r]=this._encodeObject(t[r]);return new p(`(${n.join(" ")})`)}end(t){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let e=t&&((n,r)=>{e=null,t(n,r)});if(this._endStream)try{return this._outputStream.end(e)}catch(n){}e&&e()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Lexer",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"Parser",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"Writer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"Store",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"StreamParser",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"StreamWriter",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"DataFactory",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"Term",{enumerable:!0,get:function(){return l.Term}}),Object.defineProperty(n,"NamedNode",{enumerable:!0,get:function(){return l.NamedNode}}),Object.defineProperty(n,"Literal",{enumerable:!0,get:function(){return l.Literal}}),Object.defineProperty(n,"BlankNode",{enumerable:!0,get:function(){return l.BlankNode}}),Object.defineProperty(n,"Variable",{enumerable:!0,get:function(){return l.Variable}}),Object.defineProperty(n,"DefaultGraph",{enumerable:!0,get:function(){return l.DefaultGraph}}),Object.defineProperty(n,"Quad",{enumerable:!0,get:function(){return l.Quad}}),Object.defineProperty(n,"Triple",{enumerable:!0,get:function(){return l.Triple}}),Object.defineProperty(n,"termFromId",{enumerable:!0,get:function(){return l.termFromId}}),Object.defineProperty(n,"termToId",{enumerable:!0,get:function(){return l.termToId}}),n.Util=void 0;var r=f(t("./N3Lexer")),i=f(t("./N3Parser")),s=f(t("./N3Writer")),o=f(t("./N3Store")),a=f(t("./N3StreamParser")),u=f(t("./N3StreamWriter")),c=d(t("./N3Util"));n.Util=c;var l=d(t("./N3DataFactory"));function h(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(h=function(t){return t?n:e})(t)}function d(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=h(e);if(n&&n.has(t))return n.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var o=i?Object.getOwnPropertyDescriptor(t,s):null;o&&(o.get||o.set)?Object.defineProperty(r,s,o):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}function f(t){return t&&t.__esModule?t:{default:t}}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(t,e,n){var r,i,s=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var c,l=[],h=!1,d=-1;function f(){h&&c&&(h=!1,c.length?l=c.concat(l):d=-1,l.length&&p())}function p(){if(!h){var t=u(f);h=!0;for(var e=l.length;e;){for(c=l,l=[];++d<e;)c&&c[d].run();d=-1,e=l.length}c=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function m(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new g(t,e)),1!==l.length||h||u(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],45:[function(t,e,n){(function(t){(function(){let n;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:t):t=>(n||(n=Promise.resolve())).then(t).catch(t=>setTimeout(()=>{throw t},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(t,e,n){e.exports=t("./lib")},{"./lib":55}],47:[function(t,e,n){"use strict";e.exports=class t{constructor(t,e=new Map,n=0){this.prefix=t,this._existing=e,this.counter=n}clone(){const{prefix:e,_existing:n,counter:r}=this;return new t(e,new Map(n),r)}getId(t){const e=t&&this._existing.get(t);if(e)return e;const n=this.prefix+this.counter;return this.counter++,t&&this._existing.set(t,n),n}hasId(t){return this._existing.has(t)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(t,e,n){"use strict";t("setimmediate");const r=self.crypto||self.msCrypto;e.exports=class{constructor(t){if(!r||!r.subtle)throw new Error("crypto.subtle not found.");if("sha256"===t)this.algorithm={name:"SHA-256"};else{if("sha1"!==t)throw new Error(`Unsupport algorithm "${t}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(t){this._content+=t}async digest(){const t=(new TextEncoder).encode(this._content),e=new Uint8Array(await r.subtle.digest(this.algorithm,t));let n="";for(let r=0;r<e.length;++r)n+=e[r].toString(16).padStart(2,"0");return n}}},{setimmediate:86}],49:[function(t,e,n){"use strict";const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",i="http://www.w3.org/2001/XMLSchema#string",s="NamedNode",o="BlankNode",a="Literal",u="DefaultGraph",c={eoln:/(?:\r\n)|(?:\n)|(?:\r)/g};c.empty=new RegExp("^[ \\t]*$"),c.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),e.exports=class t{static parse(t){const e=[],n={},l=t.split(c.eoln);let d=0;for(const g of l){if(d++,c.empty.test(g))continue;const t=g.match(c.quad);if(null===t)throw new Error("N-Quads parse error on line "+d+".");const l={subject:null,predicate:null,object:null,graph:null};if(l.subject=void 0!==t[1]?{termType:s,value:t[1]}:{termType:o,value:t[2]},l.predicate={termType:s,value:t[3]},void 0!==t[4]?l.object={termType:s,value:t[4]}:void 0!==t[5]?l.object={termType:o,value:t[5]}:(l.object={termType:a,value:void 0,datatype:{termType:s}},void 0!==t[7]?l.object.datatype.value=t[7]:void 0!==t[8]?(l.object.datatype.value=r,l.object.language=t[8]):l.object.datatype.value=i,l.object.value=t[6].replace(h,function(t,e,n,r){if(e)switch(e){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(n)return String.fromCharCode(parseInt(n,16));if(r)throw new Error("Unsupported U escape")})),l.graph=void 0!==t[9]?{termType:s,value:t[9]}:void 0!==t[10]?{termType:o,value:t[10]}:{termType:u,value:""},l.graph.value in n){let t=!0;const r=n[l.graph.value];for(const e of r)if((f=e).subject.termType===(p=l).subject.termType&&f.object.termType===p.object.termType&&f.subject.value===p.subject.value&&f.predicate.value===p.predicate.value&&f.object.value===p.object.value&&(f.object.termType!==a||f.object.datatype.termType===p.object.datatype.termType&&f.object.language===p.object.language&&f.object.datatype.value===p.object.datatype.value)){t=!1;break}t&&(r.push(l),e.push(l))}else n[l.graph.value]=[l],e.push(l)}var f,p;return e}static serialize(e){Array.isArray(e)||(e=t.legacyDatasetToQuads(e));const n=[];for(const r of e)n.push(t.serializeQuad(r));return n.sort().join("")}static serializeQuad(t){const e=t.subject,n=t.object,a=t.graph;let u="";return u+=e.termType===s?`<${e.value}>`:`${e.value}`,u+=` <${t.predicate.value}> `,n.termType===s?u+=`<${n.value}>`:n.termType===o?u+=n.value:(u+=`"${function(t){return t.replace(l,function(t){switch(t){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}(n.value)}"`,n.datatype.value===r?n.language&&(u+=`@${n.language}`):n.datatype.value!==i&&(u+=`^^<${n.datatype.value}>`)),a.termType===s?u+=` <${a.value}>`:a.termType===o&&(u+=` ${a.value}`),u+=" .\n",u}static legacyDatasetToQuads(t){const e=[],n={"blank node":o,IRI:s,literal:a};for(const c in t)t[c].forEach(t=>{const l={};for(const e in t){const o=t[e],u={termType:n[o.type],value:o.value};u.termType===a&&(u.datatype={termType:s},"datatype"in o&&(u.datatype.value=o.datatype),"language"in o?("datatype"in o||(u.datatype.value=r),u.language=o.language):"datatype"in o||(u.datatype.value=i)),l[e]=u}l.graph="@default"===c?{termType:u,value:""}:{termType:c.startsWith("_:")?o:s,value:c},e.push(l)});return e}};const l=/["\\\n\r]/g,h=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(t,e,n){"use strict";e.exports=class{constructor(t){this.current=t.sort(),this.done=!1,this.dir=new Map;for(let e=0;e<t.length;++e)this.dir.set(t[e],!0)}hasNext(){return!this.done}next(){const{current:t,dir:e}=this,n=t.slice();let r=null,i=0;const s=t.length;for(let o=0;o<s;++o){const n=t[o],a=e.get(n);(null===r||n>r)&&(a&&o>0&&n>t[o-1]||!a&&o<s-1&&n>t[o+1])&&(r=n,i=o)}if(null===r)this.done=!0;else{const n=e.get(r)?i-1:i+1;t[i]=t[n],t[n]=r;for(const i of t)i>r&&e.set(i,!e.get(i))}return n}}},{}],51:[function(t,e,n){(function(n){(function(){"use strict";const r=t("./IdentifierIssuer"),i=t("./MessageDigest"),s=t("./Permuter"),o=t("./NQuads");function a(t,e){return t.hash<e.hash?-1:t.hash>e.hash?1:0}e.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new r("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}async main(t){this.quads=t;for(const r of t)this._addBlankNodeQuadInfo({quad:r,component:r.subject}),this._addBlankNodeQuadInfo({quad:r,component:r.object}),this._addBlankNodeQuadInfo({quad:r,component:r.graph});const e=new Map,n=[...this.blankNodeInfo.keys()];let i=0;for(const r of n)++i%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:r,hashToBlankNodes:e});const s=[...e.keys()].sort(),u=[];for(const r of s){const t=e.get(r);t.length>1?u.push(t):this.canonicalIssuer.getId(t[0])}for(const o of u){const t=[];for(const e of o){if(this.canonicalIssuer.hasId(e))continue;const n=new r("_:b");n.getId(e);const i=await this.hashNDegreeQuads(e,n);t.push(i)}t.sort(a);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const c=[];for(const r of this.quads){const t={...r};t.subject=this._useCanonicalId({component:t.subject}),t.object=this._useCanonicalId({component:t.object}),t.graph=this._useCanonicalId({component:t.graph}),c.push(o.serializeQuad(t))}return c.sort(),c.join("")}async hashFirstDegreeQuads(t){const e=[],n=this.blankNodeInfo.get(t),r=n.quads;for(const i of r){const n={subject:null,predicate:i.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(t,i.subject,"subject"),n.object=this.modifyFirstDegreeComponent(t,i.object,"object"),n.graph=this.modifyFirstDegreeComponent(t,i.graph,"graph"),e.push(o.serializeQuad(n))}e.sort();const s=new i(this.hashAlgorithm);for(const i of e)s.update(i);return n.hash=await s.digest(),n.hash}async hashRelatedBlankNode(t,e,n,r){let s;s=this.canonicalIssuer.hasId(t)?this.canonicalIssuer.getId(t):n.hasId(t)?n.getId(t):this.blankNodeInfo.get(t).hash;const o=new i(this.hashAlgorithm);return o.update(r),"g"!==r&&o.update(this.getRelatedPredicate(e)),o.update(s),o.digest()}async hashNDegreeQuads(t,e){const n=new i(this.hashAlgorithm),r=await this.createHashToRelated(t,e),o=[...r.keys()].sort();for(const i of o){n.update(i);let t,o="";const a=new s(r.get(i));let u=0;for(;a.hasNext();){const n=a.next();++u%3==0&&await this._yield();let r=e.clone(),i="";const s=[];let c=!1;for(const t of n)if(this.canonicalIssuer.hasId(t)?i+=this.canonicalIssuer.getId(t):(r.hasId(t)||s.push(t),i+=r.getId(t)),0!==o.length&&i>o){c=!0;break}if(!c){for(const t of s){const e=await this.hashNDegreeQuads(t,r);if(i+=r.getId(t),i+=`<${e.hash}>`,r=e.issuer,0!==o.length&&i>o){c=!0;break}}c||(0===o.length||i<o)&&(o=i,t=r)}}n.update(o),e=t}return{hash:await n.digest(),issuer:e}}modifyFirstDegreeComponent(t,e){return"BlankNode"!==e.termType?e:{termType:"BlankNode",value:e.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return`<${t.predicate.value}>`}async createHashToRelated(t,e){const n=new Map,r=this.blankNodeInfo.get(t).quads;let i=0;for(const s of r)++i%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:s,component:s.subject,position:"s",id:t,issuer:e,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:s,component:s.object,position:"o",id:t,issuer:e,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:s,component:s.graph,position:"g",id:t,issuer:e,hashToRelated:n})]);return n}async _hashAndTrackBlankNode({id:t,hashToBlankNodes:e}){const n=await this.hashFirstDegreeQuads(t),r=e.get(n);r?r.push(t):e.set(n,[t])}_addBlankNodeQuadInfo({quad:t,component:e}){if("BlankNode"!==e.termType)return;const n=e.value,r=this.blankNodeInfo.get(n);r?r.quads.add(t):this.blankNodeInfo.set(n,{quads:new Set([t]),hash:null})}async _addRelatedBlankNodeHash({quad:t,component:e,position:n,id:r,issuer:i,hashToRelated:s}){if("BlankNode"!==e.termType||e.value===r)return;const o=e.value,a=await this.hashRelatedBlankNode(o,t,i,n),u=s.get(a);u?u.push(o):s.set(a,[o])}_useCanonicalId({component:t}){return"BlankNode"!==t.termType||t.value.startsWith(this.canonicalIssuer.prefix)?t:{termType:"BlankNode",value:this.canonicalIssuer.getId(t.value)}}async _yield(){return new Promise(t=>n(t))}}}).call(this)}).call(this,t("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(t,e,n){"use strict";const r=t("./IdentifierIssuer"),i=t("./MessageDigest"),s=t("./Permuter"),o=t("./NQuads");function a(t,e){return t.hash<e.hash?-1:t.hash>e.hash?1:0}e.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new r("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(t){this.quads=t;for(const r of t)this._addBlankNodeQuadInfo({quad:r,component:r.subject}),this._addBlankNodeQuadInfo({quad:r,component:r.object}),this._addBlankNodeQuadInfo({quad:r,component:r.graph});const e=new Map,n=[...this.blankNodeInfo.keys()];for(const r of n)this._hashAndTrackBlankNode({id:r,hashToBlankNodes:e});const i=[...e.keys()].sort(),s=[];for(const r of i){const t=e.get(r);t.length>1?s.push(t):this.canonicalIssuer.getId(t[0])}for(const o of s){const t=[];for(const e of o){if(this.canonicalIssuer.hasId(e))continue;const n=new r("_:b");n.getId(e);const i=this.hashNDegreeQuads(e,n);t.push(i)}t.sort(a);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const u=[];for(const r of this.quads){const t={...r};t.subject=this._useCanonicalId({component:t.subject}),t.object=this._useCanonicalId({component:t.object}),t.graph=this._useCanonicalId({component:t.graph}),u.push(o.serializeQuad(t))}return u.sort(),u.join("")}hashFirstDegreeQuads(t){const e=[],n=this.blankNodeInfo.get(t),r=n.quads;for(const i of r){const n={subject:null,predicate:i.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(t,i.subject,"subject"),n.object=this.modifyFirstDegreeComponent(t,i.object,"object"),n.graph=this.modifyFirstDegreeComponent(t,i.graph,"graph"),e.push(o.serializeQuad(n))}e.sort();const s=new i(this.hashAlgorithm);for(const i of e)s.update(i);return n.hash=s.digest(),n.hash}hashRelatedBlankNode(t,e,n,r){let s;s=this.canonicalIssuer.hasId(t)?this.canonicalIssuer.getId(t):n.hasId(t)?n.getId(t):this.blankNodeInfo.get(t).hash;const o=new i(this.hashAlgorithm);return o.update(r),"g"!==r&&o.update(this.getRelatedPredicate(e)),o.update(s),o.digest()}hashNDegreeQuads(t,e){const n=new i(this.hashAlgorithm),r=this.createHashToRelated(t,e),o=[...r.keys()].sort();for(const i of o){n.update(i);let t,o="";const a=new s(r.get(i));for(;a.hasNext();){const n=a.next();let r=e.clone(),i="";const s=[];let u=!1;for(const t of n)if(this.canonicalIssuer.hasId(t)?i+=this.canonicalIssuer.getId(t):(r.hasId(t)||s.push(t),i+=r.getId(t)),0!==o.length&&i>o){u=!0;break}if(!u){for(const t of s){const e=this.hashNDegreeQuads(t,r);if(i+=r.getId(t),i+=`<${e.hash}>`,r=e.issuer,0!==o.length&&i>o){u=!0;break}}u||(0===o.length||i<o)&&(o=i,t=r)}}n.update(o),e=t}return{hash:n.digest(),issuer:e}}modifyFirstDegreeComponent(t,e){return"BlankNode"!==e.termType?e:{termType:"BlankNode",value:e.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return`<${t.predicate.value}>`}createHashToRelated(t,e){const n=new Map,r=this.blankNodeInfo.get(t).quads;for(const i of r)this._addRelatedBlankNodeHash({quad:i,component:i.subject,position:"s",id:t,issuer:e,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:i,component:i.object,position:"o",id:t,issuer:e,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:i,component:i.graph,position:"g",id:t,issuer:e,hashToRelated:n});return n}_hashAndTrackBlankNode({id:t,hashToBlankNodes:e}){const n=this.hashFirstDegreeQuads(t),r=e.get(n);r?r.push(t):e.set(n,[t])}_addBlankNodeQuadInfo({quad:t,component:e}){if("BlankNode"!==e.termType)return;const n=e.value,r=this.blankNodeInfo.get(n);r?r.quads.add(t):this.blankNodeInfo.set(n,{quads:new Set([t]),hash:null})}_addRelatedBlankNodeHash({quad:t,component:e,position:n,id:r,issuer:i,hashToRelated:s}){if("BlankNode"!==e.termType||e.value===r)return;const o=e.value,a=this.hashRelatedBlankNode(o,t,i,n),u=s.get(a);u?u.push(o):s.set(a,[o])}_useCanonicalId({component:t}){return"BlankNode"!==t.termType||t.value.startsWith(this.canonicalIssuer.prefix)?t:{termType:"BlankNode",value:this.canonicalIssuer.getId(t.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(t,e,n){"use strict";const r=t("./URDNA2015");e.exports=class extends r{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(t,e,n){return"BlankNode"!==e.termType?e:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:e.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return t.predicate.value}async createHashToRelated(t,e){const n=new Map,r=this.blankNodeInfo.get(t).quads;let i=0;for(const s of r){let r,o;if("BlankNode"===s.subject.termType&&s.subject.value!==t)o=s.subject.value,r="p";else{if("BlankNode"!==s.object.termType||s.object.value===t)continue;o=s.object.value,r="r"}++i%100==0&&await this._yield();const a=await this.hashRelatedBlankNode(o,s,e,r),u=n.get(a);u?u.push(o):n.set(a,[o])}return n}}},{"./URDNA2015":51}],54:[function(t,e,n){"use strict";const r=t("./URDNA2015Sync");e.exports=class extends r{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(t,e,n){return"BlankNode"!==e.termType?e:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:e.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return t.predicate.value}createHashToRelated(t,e){const n=new Map,r=this.blankNodeInfo.get(t).quads;for(const i of r){let r,s;if("BlankNode"===i.subject.termType&&i.subject.value!==t)s=i.subject.value,r="p";else{if("BlankNode"!==i.object.termType||i.object.value===t)continue;s=i.object.value,r="r"}const o=this.hashRelatedBlankNode(s,i,e,r),a=n.get(o);a?a.push(s):n.set(o,[s])}return n}}},{"./URDNA2015Sync":52}],55:[function(t,e,n){"use strict";const r=t("./URDNA2015"),i=t("./URGNA2012"),s=t("./URDNA2015Sync"),o=t("./URGNA2012Sync");let a;try{a=t("rdf-canonize-native")}catch(c){}const u={};e.exports=u,u.NQuads=t("./NQuads"),u.IdentifierIssuer=t("./IdentifierIssuer"),u._rdfCanonizeNative=function(t){return t&&(a=t),a},u.canonize=async function(t,e){if(Array.isArray(t)||(t=u.NQuads.legacyDatasetToQuads(t)),e.useNative){if(!a)throw new Error("rdf-canonize-native not available");return new Promise((n,r)=>a.canonize(t,e,(t,e)=>t?r(t):n(e)))}if("URDNA2015"===e.algorithm)return new r(e).main(t);if("URGNA2012"===e.algorithm)return new i(e).main(t);if(!("algorithm"in e))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+e.algorithm)},u._canonizeSync=function(t,e){if(Array.isArray(t)||(t=u.NQuads.legacyDatasetToQuads(t)),e.useNative){if(a)return a.canonizeSync(t,e);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===e.algorithm)return new s(e).main(t);if("URGNA2012"===e.algorithm)return new o(e).main(t);if(!("algorithm"in e))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+e.algorithm)}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(t("./lib/BlankNode"),n),i(t("./lib/DataFactory"),n),i(t("./lib/DefaultGraph"),n),i(t("./lib/Literal"),n),i(t("./lib/NamedNode"),n),i(t("./lib/Quad"),n),i(t("./lib/Variable"),n)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.BlankNode=void 0,n.BlankNode=class{constructor(t){this.termType="BlankNode",this.value=t}equals(t){return!!t&&"BlankNode"===t.termType&&t.value===this.value}}},{}],58:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DataFactory=void 0;const r=t("./BlankNode"),i=t("./DefaultGraph"),s=t("./Literal"),o=t("./NamedNode"),a=t("./Quad"),u=t("./Variable");let c=0;n.DataFactory=class{constructor(t){this.blankNodeCounter=0,this.blankNodePrefix=(t=t||{}).blankNodePrefix||`df_${c++}_`}namedNode(t){return new o.NamedNode(t)}blankNode(t){return new r.BlankNode(t||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(t,e){return new s.Literal(t,e)}variable(t){return new u.Variable(t)}defaultGraph(){return i.DefaultGraph.INSTANCE}quad(t,e,n,r){return new a.Quad(t,e,n,r||this.defaultGraph())}fromTerm(t){switch(t.termType){case"NamedNode":return this.namedNode(t.value);case"BlankNode":return this.blankNode(t.value);case"Literal":return t.language?this.literal(t.value,t.language):t.datatype.equals(s.Literal.XSD_STRING)?this.literal(t.value):this.literal(t.value,this.fromTerm(t.datatype));case"Variable":return this.variable(t.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(t.subject),this.fromTerm(t.predicate),this.fromTerm(t.object),this.fromTerm(t.graph))}}fromQuad(t){return this.fromTerm(t)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DefaultGraph=void 0;class r{constructor(){this.termType="DefaultGraph",this.value=""}equals(t){return!!t&&"DefaultGraph"===t.termType}}n.DefaultGraph=r,r.INSTANCE=new r},{}],60:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Literal=void 0;const r=t("./NamedNode");class i{constructor(t,e){this.termType="Literal",this.value=t,"string"==typeof e?(this.language=e,this.datatype=i.RDF_LANGUAGE_STRING):e?(this.language="",this.datatype=e):(this.language="",this.datatype=i.XSD_STRING)}equals(t){return!!t&&"Literal"===t.termType&&t.value===this.value&&t.language===this.language&&t.datatype.equals(this.datatype)}}n.Literal=i,i.RDF_LANGUAGE_STRING=new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),i.XSD_STRING=new r.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NamedNode=void 0,n.NamedNode=class{constructor(t){this.termType="NamedNode",this.value=t}equals(t){return!!t&&"NamedNode"===t.termType&&t.value===this.value}}},{}],62:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Quad=void 0,n.Quad=class{constructor(t,e,n,r){this.termType="Quad",this.value="",this.subject=t,this.predicate=e,this.object=n,this.graph=r}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&this.subject.equals(t.subject)&&this.predicate.equals(t.predicate)&&this.object.equals(t.object)&&this.graph.equals(t.graph)}}},{}],63:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Variable=void 0,n.Variable=class{constructor(t){this.termType="Variable",this.value=t}equals(t){return!!t&&"Variable"===t.termType&&t.value===this.value}}},{}],64:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(t("./lib/RdfXmlParser"))},{"./lib/RdfXmlParser":66}],65:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends Error{constructor(t,e){const n=t.saxStream._parser;super(t.trackPosition?`Line ${n.line+1} column ${n.column+1}: ${e}`:e)}}n.ParseError=r},{}],66:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t("relative-to-absolute-iri"),i=t("sax"),s=t("stream"),o=t("./ParseError"),a=t("rdf-data-factory");class u extends s.Transform{constructor(t){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},t&&(Object.assign(this,t),this.options=t),this.dataFactory||(this.dataFactory=new a.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=i.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(t,e){const n={};let r=!1;for(const s in t.attributes)s.startsWith("xmlns")&&(5===s.length?(r=!0,n[""]=t.attributes[s]):":"===s.charAt(5)&&(r=!0,n[s.substr(6)]=t.attributes[s]));const i=e&&e.ns?e.ns:[u.DEFAULT_NS];return r?i.concat([n]):i}static expandPrefixedTerm(t,e,n){const r=t.indexOf(":");let i,s;r>=0?(i=t.substr(0,r),s=t.substr(r+1)):(i="",s=t);let a=null,u=null;for(let o=e.length-1;o>=0;o--){const t=e[o][i];if(t){a=t;break}u||(u=e[o][""])}if(!a){if(i&&"xmlns"!==i)throw new o.ParseError(n,`The prefix '${i}' in term '${t}' was not bound.`);a=u||""}return{prefix:i,local:s,uri:a}}static isValidIri(t){return u.IRI_REGEX.test(t)}import(t){const e=new s.PassThrough({readableObjectMode:!0});t.on("error",t=>n.emit("error",t)),t.on("data",t=>e.push(t)),t.on("end",()=>e.push(null));const n=e.pipe(new u(this.options));return n}_transform(t,e,n){try{this.saxStream.write(t,e)}catch(r){return n(r)}n()}newParseError(t){return new o.ParseError(this,t)}valueToUri(t,e){return this.uriToNamedNode(r.resolve(t,e.baseIRI))}uriToNamedNode(t){if(!u.isValidIri(t))throw this.newParseError(`Invalid URI: ${t}`);return this.dataFactory.namedNode(t)}validateNcname(t){if(!u.NCNAME_MATCHER.test(t))throw this.newParseError(`Not a valid NCName: ${t}`)}attachSaxListeners(){this.saxStream.on("error",t=>this.emit("error",t)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(t){const e=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let n=c.RESOURCE;if(e&&(e.hadChildren=!0,n=e.childrenParseType),e&&e.childrenStringTags){const n=t.name;let r="";for(const e in t.attributes)r+=` ${e}="${t.attributes[e]}"`;e.childrenStringTags.push(`<${n}${r}>`);const i={childrenStringTags:e.childrenStringTags};return i.childrenStringEmitClosingTag=`</${n}>`,void this.activeTagStack.push(i)}const r={};e?(r.language=e.language,r.baseIRI=e.baseIRI):r.baseIRI=this.baseIRI,this.activeTagStack.push(r),r.ns=u.parseNamespace(t,e),n===c.RESOURCE?this.onTagResource(t,r,e,!e):this.onTagProperty(t,r,e)}onTagResource(t,e,n,i){const s=u.expandPrefixedTerm(t.name,e.ns,this);e.childrenParseType=c.PROPERTY;let o=!0;if(s.uri===u.RDF){if(!i&&u.FORBIDDEN_NODE_ELEMENTS.indexOf(s.local)>=0)throw this.newParseError(`Illegal node element name: ${s.local}`);switch(s.local){case"RDF":e.childrenParseType=c.RESOURCE;case"Description":o=!1}}const a=[],l=[];let h=null,d=!1,f=!1,p=null;for(const c in t.attributes){const i=t.attributes[c],s=u.expandPrefixedTerm(c,e.ns,this);if(n&&s.uri===u.RDF)switch(s.local){case"about":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${i} and ${h} where found.`);h=i;continue;case"ID":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${i} and ${h} where found.`);this.validateNcname(i),h="#"+i,d=!0;continue;case"nodeID":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${i} and ${h} where found.`);this.validateNcname(i),h=i,f=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":p=i;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(s.uri===u.XML){if("lang"===s.local){e.language=""===i?null:i.toLowerCase();continue}if("base"===s.local){e.baseIRI=r.resolve(i,e.baseIRI);continue}}"xml"!==s.prefix&&s.uri&&(a.push(this.uriToNamedNode(s.uri+s.local)),l.push(i))}if(null!==h&&(e.subject=f?this.dataFactory.blankNode(h):this.valueToUri(h,e),d&&this.claimNodeId(e.subject)),e.subject||(e.subject=this.dataFactory.blankNode()),o){const t=this.uriToNamedNode(s.uri+s.local);this.emitTriple(e.subject,this.dataFactory.namedNode(u.RDF+"type"),t,n?n.reifiedStatementId:null)}if(n){if(n.predicate)if(n.childrenCollectionSubject){const t=this.dataFactory.blankNode();this.emitTriple(n.childrenCollectionSubject,n.childrenCollectionPredicate,t,n.reifiedStatementId),this.emitTriple(t,this.dataFactory.namedNode(u.RDF+"first"),e.subject,e.reifiedStatementId),n.childrenCollectionSubject=t,n.childrenCollectionPredicate=this.dataFactory.namedNode(u.RDF+"rest")}else{this.emitTriple(n.subject,n.predicate,e.subject,n.reifiedStatementId);for(let t=0;t<n.predicateSubPredicates.length;t++)this.emitTriple(e.subject,n.predicateSubPredicates[t],n.predicateSubObjects[t],null);n.predicateSubPredicates=[],n.predicateSubObjects=[],n.predicateEmitted=!0}for(let t=0;t<a.length;t++){const r=this.dataFactory.literal(l[t],e.datatype||e.language);this.emitTriple(e.subject,a[t],r,n.reifiedStatementId)}p&&this.emitTriple(e.subject,this.dataFactory.namedNode(u.RDF+"type"),this.uriToNamedNode(p),null)}}onTagProperty(t,e,n){const r=u.expandPrefixedTerm(t.name,e.ns,this);if(e.childrenParseType=c.RESOURCE,e.subject=n.subject,r.uri===u.RDF&&"li"===r.local?(n.listItemCounter||(n.listItemCounter=1),e.predicate=this.uriToNamedNode(r.uri+"_"+n.listItemCounter++)):e.predicate=this.uriToNamedNode(r.uri+r.local),r.uri===u.RDF&&u.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(r.local)>=0)throw this.newParseError(`Illegal property element name: ${r.local}`);e.predicateSubPredicates=[],e.predicateSubObjects=[];let i=!1,s=!1,o=null,a=!0;const l=[],h=[];for(const d in t.attributes){const n=t.attributes[d],r=u.expandPrefixedTerm(d,e.ns,this);if(r.uri===u.RDF)switch(r.local){case"resource":if(o)throw this.newParseError(`Found both rdf:resource (${n}) and rdf:nodeID (${o}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${n})`);e.hadChildren=!0,o=n,a=!1;continue;case"datatype":if(s)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${n}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${n})`);e.datatype=this.valueToUri(n,e);continue;case"nodeID":if(s)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${n}).`);if(e.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${n}).`);if(i)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${n})`);this.validateNcname(n),e.hadChildren=!0,o=n,a=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(s)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(e.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${e.datatype.value})`);if(o)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${o})`);if("Resource"===n){i=!0,e.childrenParseType=c.PROPERTY;const t=this.dataFactory.blankNode();this.emitTriple(e.subject,e.predicate,t,e.reifiedStatementId),e.subject=t,e.predicate=null}else"Collection"===n?(i=!0,e.hadChildren=!0,e.childrenCollectionSubject=e.subject,e.childrenCollectionPredicate=e.predicate,a=!1):"Literal"===n&&(i=!0,e.childrenTagsToString=!0,e.childrenStringTags=[]);continue;case"ID":this.validateNcname(n),e.reifiedStatementId=this.valueToUri("#"+n,e),this.claimNodeId(e.reifiedStatementId);continue}else if(r.uri===u.XML&&"lang"===r.local){e.language=""===n?null:n.toLowerCase();continue}if("xml"!==r.prefix&&"xmlns"!==r.prefix&&r.uri){if(i||e.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${n}`);e.hadChildren=!0,s=!0,l.push(this.uriToNamedNode(r.uri+r.local)),h.push(this.dataFactory.literal(n,e.datatype||e.language))}}if(null!==o){const t=e.subject;e.subject=a?this.dataFactory.blankNode(o):this.valueToUri(o,e),this.emitTriple(t,e.predicate,e.subject,e.reifiedStatementId);for(let n=0;n<l.length;n++)this.emitTriple(e.subject,l[n],h[n],null);e.predicateEmitted=!0}else a&&(e.predicateSubPredicates=l,e.predicateSubObjects=h,e.predicateEmitted=!1)}emitTriple(t,e,n,r){this.push(this.dataFactory.quad(t,e,n,this.defaultGraph)),r&&(this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(u.RDF+"type"),this.dataFactory.namedNode(u.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(u.RDF+"subject"),t,this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(u.RDF+"predicate"),e,this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(u.RDF+"object"),n,this.defaultGraph)))}claimNodeId(t){if(!this.allowDuplicateRdfIds){if(this.nodeIds[t.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${t.value}'.`);this.nodeIds[t.value]=!0}}onText(t){const e=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;e&&(e.childrenStringTags?e.childrenStringTags.push(t):e.predicate&&(e.text=t))}onCloseTag(){const t=this.activeTagStack.pop();if(t.childrenStringEmitClosingTag&&t.childrenStringTags.push(t.childrenStringEmitClosingTag),t.childrenTagsToString&&(t.datatype=this.dataFactory.namedNode(u.RDF+"XMLLiteral"),t.text=t.childrenStringTags.join(""),t.hadChildren=!1),t.childrenCollectionSubject)this.emitTriple(t.childrenCollectionSubject,t.childrenCollectionPredicate,this.dataFactory.namedNode(u.RDF+"nil"),t.reifiedStatementId);else if(t.predicate)if(t.hadChildren||t.childrenParseType===c.PROPERTY){if(!t.predicateEmitted){const e=this.dataFactory.blankNode();this.emitTriple(t.subject,t.predicate,e,t.reifiedStatementId);for(let n=0;n<t.predicateSubPredicates.length;n++)this.emitTriple(e,t.predicateSubPredicates[n],t.predicateSubObjects[n],null)}}else this.emitTriple(t.subject,t.predicate,this.dataFactory.literal(t.text||"",t.datatype||t.language),t.reifiedStatementId)}onDoctype(t){t.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(t,e,n)=>(this.saxStream._parser.ENTITIES[e]=n,""))}}var c;n.RdfXmlParser=u,u.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,u.MIME_TYPE="application/rdf+xml",u.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",u.XML="http://www.w3.org/XML/1998/namespace",u.XMLNS="http://www.w3.org/2000/xmlns/",u.DEFAULT_NS={xml:u.XML},u.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],u.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],u.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,function(t){t[t.RESOURCE=0]="RESOURCE",t[t.PROPERTY=1]="PROPERTY"}(c=n.ParseType||(n.ParseType={}))},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(t,e,n){"use strict";var r={};function i(t,e,n){n||(n=Error);var i=function(t){function n(n,r,i){return t.call(this,function(t,n,r){return"string"==typeof e?e:e(t,n,r)}(n,r,i))||this}return i=t,(r=n).prototype=Object.create(i.prototype),r.prototype.constructor=r,r.__proto__=i,n;var r,i}(n);i.prototype.name=n.name,i.prototype.code=t,r[t]=i}function s(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map(function(t){return String(t)}),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:2===n?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}i("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError),i("ERR_INVALID_ARG_TYPE",function(t,e,n){var r,i,o,a;if("string"==typeof e&&"not "===e.substr(0,"not ".length)?(r="must not be",e=e.replace(/^not /,"")):r="must be",function(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}(t," argument"))i="The ".concat(t," ").concat(r," ").concat(s(e,"type"));else{var u=("number"!=typeof a&&(a=0),a+".".length>(o=t).length||-1===o.indexOf(".",a)?"argument":"property");i='The "'.concat(t,'" ').concat(u," ").concat(r," ").concat(s(e,"type"))}return i+". Received type ".concat(typeof n)},TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"}),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"}),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=r},{}],68:[function(t,e,n){(function(n){(function(){"use strict";var r=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};e.exports=c;var i=t("./_stream_readable"),s=t("./_stream_writable");t("inherits")(c,i);for(var o=r(s.prototype),a=0;a<o.length;a++){var u=o[a];c.prototype[u]||(c.prototype[u]=s.prototype[u])}function c(t){if(!(this instanceof c))return new c(t);i.call(this,t),s.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||n.nextTick(h,this)}function h(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(t,e,n){"use strict";e.exports=i;var r=t("./_stream_transform");function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}t("inherits")(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":71,inherits:10}],70:[function(t,e,n){(function(n,r){(function(){"use strict";var i;e.exports=A,A.ReadableState=S,t("events");var s,o=function(t,e){return t.listeners(e).length},a=t("./internal/streams/stream"),u=t("buffer").Buffer,c=r.Uint8Array||function(){},l=t("util");s=l&&l.debuglog?l.debuglog("stream"):function(){};var h,d,f,p=t("./internal/streams/buffer_list"),g=t("./internal/streams/destroy"),m=t("./internal/streams/state").getHighWaterMark,y=t("../errors").codes,b=y.ERR_INVALID_ARG_TYPE,_=y.ERR_STREAM_PUSH_AFTER_EOF,v=y.ERR_METHOD_NOT_IMPLEMENTED,w=y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(A,a);var x=g.errorOrDestroy,E=["error","close","destroy","pause","resume"];function S(e,n,r){i=i||t("./_stream_duplex"),"boolean"!=typeof r&&(r=n instanceof i),this.objectMode=!!(e=e||{}).objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=m(this,e,"readableHighWaterMark",r),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=t("string_decoder/").StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function A(e){if(i=i||t("./_stream_duplex"),!(this instanceof A))return new A(e);this._readableState=new S(e,this,this instanceof i),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function T(t,e,n,r,i){s("readableAddChunk",e);var o,a=t._readableState;if(null===e)a.reading=!1,function(t,e){if(s("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?k(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,O(t)))}}(t,a);else if(i||(o=function(t,e){var n,r;return u.isBuffer(r=e)||r instanceof c||"string"==typeof e||void 0===e||t.objectMode||(n=new b("chunk",["string","Buffer","Uint8Array"],e)),n}(a,e)),o)x(t,o);else if(a.objectMode||e&&e.length>0)if("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===u.prototype||(e=function(t){return u.from(t)}(e)),r)a.endEmitted?x(t,new w):C(t,a,e,!0);else if(a.ended)x(t,new _);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?C(t,a,e,!1):M(t,a)):C(t,a,e,!1)}else r||(a.reading=!1,M(t,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function C(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&k(t)),M(t,e)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),A.prototype.destroy=g.destroy,A.prototype._undestroy=g.undestroy,A.prototype._destroy=function(t,e){e(t)},A.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=u.from(t,e),e=""),n=!0),T(this,t,e,!1,n)},A.prototype.unshift=function(t){return T(this,t,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(e){h||(h=t("string_decoder/").StringDecoder);var n=new h(e);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var I=1073741824;function D(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=I?t=I:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function k(t){var e=t._readableState;s("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(s("emitReadable",e.flowing),e.emittedReadable=!0,n.nextTick(O,t))}function O(t){var e=t._readableState;s("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,L(t)}function M(t,e){e.readingMore||(e.readingMore=!0,n.nextTick(P,t,e))}function P(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var n=e.length;if(s("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function N(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function R(t){s("readable nexttick read 0"),t.read(0)}function j(t,e){s("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),L(t),e.flowing&&!e.reading&&t.read(0)}function L(t){var e=t._readableState;for(s("flow",e.flowing);e.flowing&&null!==t.read(););}function F(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n);var n}function B(t){var e=t._readableState;s("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,n.nextTick(z,e,t))}function z(t,e){if(s("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function U(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}A.prototype.read=function(t){s("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return s("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?B(this):k(this),null;if(0===(t=D(t,e))&&e.ended)return 0===e.length&&B(this),null;var r,i=e.needReadable;return s("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&s("length less than watermark",i=!0),e.ended||e.reading?s("reading or ended",i=!1):i&&(s("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=D(n,e))),null===(r=t>0?F(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&B(this)),null!==r&&this.emit("data",r),r},A.prototype._read=function(t){x(this,new v("_read()"))},A.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t)}i.pipesCount+=1,s("pipe count=%d opts=%j",i.pipesCount,e);var a=e&&!1===e.end||t===n.stdout||t===n.stderr?g:u;function u(){s("onend"),t.end()}i.endEmitted?n.nextTick(a):r.once("end",a),t.on("unpipe",function e(n,o){s("onunpipe"),n===r&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,s("cleanup"),t.removeListener("close",f),t.removeListener("finish",p),t.removeListener("drain",c),t.removeListener("error",d),t.removeListener("unpipe",e),r.removeListener("end",u),r.removeListener("end",g),r.removeListener("data",h),l=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||c())});var c=function(t){return function(){var e=t._readableState;s("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,L(t))}}(r);t.on("drain",c);var l=!1;function h(e){s("ondata");var n=t.write(e);s("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==U(i.pipes,t))&&!l&&(s("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(e){s("onerror",e),g(),t.removeListener("error",d),0===o(t,"error")&&x(t,e)}function f(){t.removeListener("finish",p),g()}function p(){s("onfinish"),t.removeListener("close",f),g()}function g(){s("unpipe"),r.unpipe(t)}return r.on("data",h),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events.error?Array.isArray(t._events.error)?t._events.error.unshift(n):t._events.error=[n,t._events.error]:t.on(e,n)}(t,"error",d),t.once("close",f),t.once("finish",p),t.emit("pipe",r),i.flowing||(s("pipe resume"),r.resume()),t},A.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<i;s++)r[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(e.pipes,t);return-1===o||(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},A.prototype.addListener=A.prototype.on=function(t,e){var r=a.prototype.on.call(this,t,e),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,s("on readable",i.length,i.reading),i.length?k(this):i.reading||n.nextTick(R,this))),r},A.prototype.removeListener=function(t,e){var r=a.prototype.removeListener.call(this,t,e);return"readable"===t&&n.nextTick(N,this),r},A.prototype.removeAllListeners=function(t){var e=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||n.nextTick(N,this),e},A.prototype.resume=function(){var t=this._readableState;return t.flowing||(s("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,n.nextTick(j,t,e))}(this,t)),t.paused=!1,this},A.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",function(){if(s("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){s("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<E.length;o++)t.on(E[o],this.emit.bind(this,E[o]));return this._read=function(e){s("wrapped _read",e),r&&(r=!1,t.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=t("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),A._fromList=F,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(e,n){return void 0===f&&(f=t("./internal/streams/from")),f(A,e,n)})}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(t,e,n){"use strict";e.exports=l;var r=t("../errors").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,s=r.ERR_MULTIPLE_CALLBACK,o=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,u=t("./_stream_duplex");function c(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new s);n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(t){if(!(this instanceof l))return new l(t);u.call(this,t),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",h)}function h(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush(function(e,n){d(t,e,n)})}function d(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new a;if(t._transformState.transforming)throw new o;return t.push(null)}t("inherits")(l,u),l.prototype.push=function(t,e){return this._transformState.needTransform=!1,u.prototype.push.call(this,t,e)},l.prototype._transform=function(t,e,n){n(new i("_transform()"))},l.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},l.prototype._destroy=function(t,e){u.prototype._destroy.call(this,t,function(t){e(t)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(t,e,n){(function(n,r){(function(){"use strict";function i(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(undefined),r=r.next}e.corkedRequestsFree.next=t}(e,t)}}var s;e.exports=A,A.WritableState=S;var o,a={deprecate:t("util-deprecate")},u=t("./internal/streams/stream"),c=t("buffer").Buffer,l=r.Uint8Array||function(){},h=t("./internal/streams/destroy"),d=t("./internal/streams/state").getHighWaterMark,f=t("../errors").codes,p=f.ERR_INVALID_ARG_TYPE,g=f.ERR_METHOD_NOT_IMPLEMENTED,m=f.ERR_MULTIPLE_CALLBACK,y=f.ERR_STREAM_CANNOT_PIPE,b=f.ERR_STREAM_DESTROYED,_=f.ERR_STREAM_NULL_VALUES,v=f.ERR_STREAM_WRITE_AFTER_END,w=f.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function E(){}function S(e,r,o){s=s||t("./_stream_duplex"),"boolean"!=typeof o&&(o=r instanceof s),this.objectMode=!!(e=e||{}).objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===e.decodeStrings),this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var r=t._writableState,i=r.sync,s=r.writecb;if("function"!=typeof s)throw new m;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(r),e)!function(t,e,r,i,s){--e.pendingcb,r?(n.nextTick(s,i),n.nextTick(O,t,e),t._writableState.errorEmitted=!0,x(t,i)):(s(i),t._writableState.errorEmitted=!0,x(t,i),O(t,e))}(t,r,i,e,s);else{var o=D(r)||t.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||I(t,r),i?n.nextTick(C,t,r,o,s):C(t,r,o,s)}}(r,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function A(e){var n=this instanceof(s=s||t("./_stream_duplex"));if(!n&&!o.call(A,this))return new A(e);this._writableState=new S(e,this,n),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function T(t,e,n,r,i,s,o){e.writelen=r,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new b("write")):n?t._writev(i,e.onwrite):t._write(i,s,e.onwrite),e.sync=!1}function C(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),O(t,e)}function I(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=new Array(e.bufferedRequestCount),s=e.corkedRequestsFree;s.entry=n;for(var o=0,a=!0;n;)r[o]=n,n.isBuf||(a=!1),n=n.next,o+=1;r.allBuffers=a,T(t,e,!0,e.length,r,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new i(e),e.bufferedRequestCount=0}else{for(;n;){var u=n.chunk;if(T(t,e,!1,e.objectMode?1:u.length,u,n.encoding,n.callback),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function D(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function k(t,e){t._final(function(n){e.pendingcb--,n&&x(t,n),e.prefinished=!0,t.emit("prefinish"),O(t,e)})}function O(t,e){var r=D(e);if(r&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,n.nextTick(k,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return r}t("inherits")(A,u),S.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(S.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(t){return!!o.call(this,t)||this===A&&t&&t._writableState instanceof S}})):o=function(t){return t instanceof this},A.prototype.pipe=function(){x(this,new y)},A.prototype.write=function(t,e,r){var i,s=this._writableState,o=!1,a=!s.objectMode&&(c.isBuffer(i=t)||i instanceof l);return a&&!c.isBuffer(t)&&(t=function(t){return c.from(t)}(t)),"function"==typeof e&&(r=e,e=null),a?e="buffer":e||(e=s.defaultEncoding),"function"!=typeof r&&(r=E),s.ending?function(t,e){var r=new v;x(t,r),n.nextTick(e,r)}(this,r):(a||function(t,e,r,i){var s;return null===r?s=new _:"string"==typeof r||e.objectMode||(s=new p("chunk",["string","Buffer"],r)),!s||(x(t,s),n.nextTick(i,s),!1)}(this,s,t,r))&&(s.pendingcb++,o=function(t,e,n,r,i,s){if(!n){var o=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=c.from(e,n)),e}(e,r,i);r!==o&&(n=!0,i="buffer",r=o)}var a=e.objectMode?1:r.length;e.length+=a;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var l=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},l?l.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else T(t,e,!1,a,r,i,s);return u}(this,s,a,t,e,r)),o},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||I(this,t))},A.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new w(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(t,e,n){n(new g("_write()"))},A.prototype._writev=null,A.prototype.end=function(t,e,r){var i=this._writableState;return"function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),null!=t&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||function(t,e,r){e.ending=!0,O(t,e),r&&(e.finished?n.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}(this,i,r),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),A.prototype.destroy=h.destroy,A.prototype._undestroy=h.undestroy,A.prototype._destroy=function(t,e){e(t)}}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(t,e,n){(function(n){(function(){"use strict";var r;function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=t("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),u=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function f(t,e){return{value:t,done:e}}function p(t){var e=t[o];if(null!==e){var n=t[d].read();null!==n&&(t[l]=null,t[o]=null,t[a]=null,e(f(n,!1)))}}function g(t){n.nextTick(p,t)}var m=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((i(r={get stream(){return this[d]},next:function(){var t=this,e=this[u];if(null!==e)return Promise.reject(e);if(this[c])return Promise.resolve(f(void 0,!0));if(this[d].destroyed)return new Promise(function(e,r){n.nextTick(function(){t[u]?r(t[u]):e(f(void 0,!0))})});var r,i=this[l];if(i)r=new Promise(function(t,e){return function(n,r){t.then(function(){e[c]?n(f(void 0,!0)):e[h](n,r)},r)}}(i,this));else{var s=this[d].read();if(null!==s)return Promise.resolve(f(s,!1));r=new Promise(this[h])}return this[l]=r,r}},Symbol.asyncIterator,function(){return this}),i(r,"return",function(){var t=this;return new Promise(function(e,n){t[d].destroy(null,function(t){t?n(t):e(f(void 0,!0))})})}),r),m);e.exports=function(t){var e,n=Object.create(y,(i(e={},d,{value:t,writable:!0}),i(e,o,{value:null,writable:!0}),i(e,a,{value:null,writable:!0}),i(e,u,{value:null,writable:!0}),i(e,c,{value:t._readableState.endEmitted,writable:!0}),i(e,h,{value:function(t,e){var r=n[d].read();r?(n[l]=null,n[o]=null,n[a]=null,t(f(r,!1))):(n[o]=t,n[a]=e)},writable:!0}),e));return n[l]=null,s(t,function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=n[a];return null!==e&&(n[l]=null,n[o]=null,n[a]=null,e(t)),void(n[u]=t)}var r=n[o];null!==r&&(n[l]=null,n[o]=null,n[a]=null,r(f(void 0,!0))),n[c]=!0}),t.on("readable",g.bind(null,n)),n}}).call(this)}).call(this,t("_process"))},{"./end-of-stream":76,_process:44}],74:[function(t,e,n){"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("buffer").Buffer,a=t("util").inspect,u=a&&a.custom||"inspect";e.exports=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.head=null,this.tail=null,this.length=0}return e=t,(n=[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n}},{key:"concat",value:function(t){if(0===this.length)return o.alloc(0);for(var e=o.allocUnsafe(t>>>0),n=this.head,r=0;n;)o.prototype.copy.call(n.data,e,r),r+=n.data.length,n=n.next;return e}},{key:"consume",value:function(t,e){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):n=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,n=1,r=e.data;for(t-=r.length;e=e.next;){var i=e.data,s=t>i.length?i.length:t;if(r+=s===i.length?i:i.slice(0,t),0==(t-=s)){s===i.length?(++n,this.head=e.next?e.next:this.tail=null):(this.head=e,e.data=i.slice(s));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(t){var e=o.allocUnsafe(t),n=this.head,r=1;for(n.data.copy(e),t-=n.data.length;n=n.next;){var i=n.data,s=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,s),0==(t-=s)){s===i.length?(++r,this.head=n.next?n.next:this.tail=null):(this.head=n,n.data=i.slice(s));break}++r}return this.length-=r,e}},{key:u,value:function(t,e){return a(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},e,{depth:0,customInspect:!1}))}}])&&s(e.prototype,n),t;var e,n}()},{buffer:6,util:3}],75:[function(t,e,n){(function(t){(function(){"use strict";function n(t,e){i(t,e),r(t)}function r(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function i(t,e){t.emit("error",e)}e.exports={destroy:function(e,s){var o=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(s?s(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!s&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(r,o):(o._writableState.errorEmitted=!0,t.nextTick(n,o,e)):t.nextTick(n,o,e):s?(t.nextTick(r,o),s(e)):t.nextTick(r,o)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}}}).call(this)}).call(this,t("_process"))},{_process:44}],76:[function(t,e,n){"use strict";var r=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function t(e,n,s){if("function"==typeof n)return t(e,null,n);n||(n={}),s=function(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}(s||i);var o=n.readable||!1!==n.readable&&e.readable,a=n.writable||!1!==n.writable&&e.writable,u=function(){e.writable||l()},c=e._writableState&&e._writableState.finished,l=function(){a=!1,c=!0,o||s.call(e)},h=e._readableState&&e._readableState.endEmitted,d=function(){o=!1,h=!0,a||s.call(e)},f=function(t){s.call(e,t)},p=function(){var t;return o&&!h?(e._readableState&&e._readableState.ended||(t=new r),s.call(e,t)):a&&!c?(e._writableState&&e._writableState.ended||(t=new r),s.call(e,t)):void 0},g=function(){e.req.on("finish",l)};return function(t){return t.setHeader&&"function"==typeof t.abort}(e)?(e.on("complete",l),e.on("abort",p),e.req?g():e.on("request",g)):a&&!e._writableState&&(e.on("end",u),e.on("close",u)),e.on("end",d),e.on("finish",l),!1!==n.error&&e.on("error",f),e.on("close",p),function(){e.removeListener("complete",l),e.removeListener("abort",p),e.removeListener("request",g),e.req&&e.req.removeListener("finish",l),e.removeListener("end",u),e.removeListener("close",u),e.removeListener("finish",l),e.removeListener("end",d),e.removeListener("error",f),e.removeListener("close",p)}}},{"../../../errors":67}],77:[function(t,e,n){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(t,e,n){"use strict";var r,i=t("../../../errors").codes,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(t){if(t)throw t}function u(e,n,i,s){s=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(s);var a=!1;e.on("close",function(){a=!0}),void 0===r&&(r=t("./end-of-stream")),r(e,{readable:n,writable:i},function(t){if(t)return s(t);a=!0,s()});var u=!1;return function(t){if(!a&&!u)return u=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void s(t||new o("pipe"))}}function c(t){t()}function l(t,e){return t.pipe(e)}function h(t){return t.length?"function"!=typeof t[t.length-1]?a:t.pop():a}e.exports=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=h(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new s("streams");var o=e.map(function(t,n){var s=n<e.length-1;return u(t,s,n>0,function(t){r||(r=t),t&&o.forEach(c),s||(o.forEach(c),i(r))})});return e.reduce(l)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(t,e,n){"use strict";var r=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(t,e,n,i){var s=function(t,e,n){return null!=t.highWaterMark?t.highWaterMark:e?t[n]:null}(e,i,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new r(i?n:"highWaterMark",s);return Math.floor(s)}return t.objectMode?16:16384}}},{"../../../errors":67}],80:[function(t,e,n){e.exports=t("events").EventEmitter},{events:8}],81:[function(t,e,n){(n=e.exports=t("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js"),n.finished=t("./lib/internal/streams/end-of-stream.js"),n.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(t("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(t,e,n){"use strict";function r(t){const e=[];let n=0;for(;n<t.length;)switch(t[n]){case"/":if("."===t[n+1])if("."===t[n+2]){if(!s(t[n+3])){e.push([]),n++;break}e.pop(),t[n+3]||e.push([]),n+=3}else{if(!s(t[n+2])){e.push([]),n++;break}t[n+2]||e.push([]),n+=2}else e.push([]),n++;break;case"#":case"?":e.length||e.push([]),e[e.length-1].push(t.substr(n)),n=t.length;break;default:e.length||e.push([]),e[e.length-1].push(t[n]),n++}return"/"+e.map(t=>t.join("")).join("/")}function i(t,e){let n=e+1;e>=0?"/"===t[e+1]&&"/"===t[e+2]&&(n=e+3):"/"===t[0]&&"/"===t[1]&&(n=2);const i=t.indexOf("/",n);return i<0?t:t.substr(0,i)+r(t.substr(i))}function s(t){return!t||"#"===t||"?"===t||"/"===t}Object.defineProperty(n,"__esModule",{value:!0}),n.resolve=function(t,e){const n=(e=e||"").indexOf("#");if(n>0&&(e=e.substr(0,n)),!t.length){if(e.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${e}' for value '${t}'`);return e}if(t.startsWith("?")){const n=e.indexOf("?");return n>0&&(e=e.substr(0,n)),e+t}if(t.startsWith("#"))return e+t;if(!e.length){const e=t.indexOf(":");if(e<0)throw new Error(`Found invalid relative IRI '${t}' for a missing baseIRI`);return i(t,e)}const s=t.indexOf(":");if(s>=0)return i(t,s);const o=e.indexOf(":");if(o<0)throw new Error(`Found invalid baseIRI '${e}' for value '${t}'`);const a=e.substr(0,o+1);if(0===t.indexOf("//"))return a+i(t,s);let u;if(e.indexOf("//",o)===o+1){if(u=e.indexOf("/",o+3),u<0)return e.length>o+3?e+"/"+i(t,s):a+i(t,s)}else if(u=e.indexOf("/",o+1),u<0)return a+i(t,s);if(0===t.indexOf("/"))return e.substr(0,u)+r(t);let c=e.substr(u);const l=c.lastIndexOf("/");return l>=0&&l<c.length-1&&(c=c.substr(0,l+1),"."===t[0]&&"."!==t[1]&&"/"!==t[1]&&t[2]&&(t=t.substr(1))),t=r(t=c+t),e.substr(0,u)+t},n.removeDotSegments=r,n.removeDotSegmentsOfPath=i},{}],84:[function(t,e,n){var r=t("buffer"),i=r.Buffer;function s(t,e){for(var n in t)e[n]=t[n]}function o(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(s(r,n),n.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},o.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},{buffer:6}],85:[function(t,e,n){(function(e){(function(){!function(n){n.parser=function(t,e){return new s(t,e)},n.SAXParser=s,n.SAXStream=a,n.createStream=function(t,e){return new a(t,e)},n.MAX_BUFFER_LENGTH=65536;var r,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function s(t,e){if(!(this instanceof s))return new s(t,e);var r=this;(function(t){for(var e=0,n=i.length;e<n;e++)t[i[e]]=""})(r),r.q=r.c="",r.bufferCheckPosition=n.MAX_BUFFER_LENGTH,r.opt=e||{},r.opt.lowercase=r.opt.lowercase||r.opt.lowercasetags,r.looseCase=r.opt.lowercase?"toLowerCase":"toUpperCase",r.tags=[],r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.strict=!!t,r.noscript=!(!t&&!r.opt.noscript),r.state=E.BEGIN,r.strictEntities=r.opt.strictEntities,r.ENTITIES=Object.create(r.strictEntities?n.XML_ENTITIES:n.ENTITIES),r.attribList=[],r.opt.xmlns&&(r.ns=Object.create(l)),r.trackPosition=!1!==r.opt.position,r.trackPosition&&(r.position=r.line=r.column=0),A(r,"onready")}n.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}),s.prototype={end:function(){k(this)},write:function(t){var e=this;if(this.error)throw this.error;if(e.closed)return D(e,"Cannot write after close. Assign an onready handler.");if(null===t)return k(e);"object"==typeof t&&(t=t.toString());for(var r=0,s="";s=B(t,r++),e.c=s,s;)switch(e.trackPosition&&(e.position++,"\n"===s?(e.line++,e.column=0):e.column++),e.state){case E.BEGIN:if(e.state=E.BEGIN_WHITESPACE,"\ufeff"===s)continue;F(e,s);continue;case E.BEGIN_WHITESPACE:F(e,s);continue;case E.TEXT:if(e.sawRoot&&!e.closedRoot){for(var o=r-1;s&&"<"!==s&&"&"!==s;)(s=B(t,r++))&&e.trackPosition&&(e.position++,"\n"===s?(e.line++,e.column=0):e.column++);e.textNode+=t.substring(o,r-1)}"<"!==s||e.sawRoot&&e.closedRoot&&!e.strict?(g(s)||e.sawRoot&&!e.closedRoot||O(e,"Text data outside of root node."),"&"===s?e.state=E.TEXT_ENTITY:e.textNode+=s):(e.state=E.OPEN_WAKA,e.startTagPosition=e.position);continue;case E.SCRIPT:"<"===s?e.state=E.SCRIPT_ENDING:e.script+=s;continue;case E.SCRIPT_ENDING:"/"===s?e.state=E.CLOSE_TAG:(e.script+="<"+s,e.state=E.SCRIPT);continue;case E.OPEN_WAKA:"!"===s?(e.state=E.SGML_DECL,e.sgmlDecl=""):g(s)||(b(h,s)?(e.state=E.OPEN_TAG,e.tagName=s):"/"===s?(e.state=E.CLOSE_TAG,e.tagName=""):"?"===s?(e.state=E.PROC_INST,e.procInstName=e.procInstBody=""):(O(e,"Unencoded <"),e.startTagPosition+1<e.position&&(s=new Array(e.position-e.startTagPosition).join(" ")+s),e.textNode+="<"+s,e.state=E.TEXT));continue;case E.SGML_DECL:"[CDATA["===(e.sgmlDecl+s).toUpperCase()?(T(e,"onopencdata"),e.state=E.CDATA,e.sgmlDecl="",e.cdata=""):e.sgmlDecl+s==="--"?(e.state=E.COMMENT,e.comment="",e.sgmlDecl=""):"DOCTYPE"===(e.sgmlDecl+s).toUpperCase()?(e.state=E.DOCTYPE,(e.doctype||e.sawRoot)&&O(e,"Inappropriately located doctype declaration"),e.doctype="",e.sgmlDecl=""):">"===s?(T(e,"onsgmldeclaration",e.sgmlDecl),e.sgmlDecl="",e.state=E.TEXT):m(s)?(e.state=E.SGML_DECL_QUOTED,e.sgmlDecl+=s):e.sgmlDecl+=s;continue;case E.SGML_DECL_QUOTED:s===e.q&&(e.state=E.SGML_DECL,e.q=""),e.sgmlDecl+=s;continue;case E.DOCTYPE:">"===s?(e.state=E.TEXT,T(e,"ondoctype",e.doctype),e.doctype=!0):(e.doctype+=s,"["===s?e.state=E.DOCTYPE_DTD:m(s)&&(e.state=E.DOCTYPE_QUOTED,e.q=s));continue;case E.DOCTYPE_QUOTED:e.doctype+=s,s===e.q&&(e.q="",e.state=E.DOCTYPE);continue;case E.DOCTYPE_DTD:e.doctype+=s,"]"===s?e.state=E.DOCTYPE:m(s)&&(e.state=E.DOCTYPE_DTD_QUOTED,e.q=s);continue;case E.DOCTYPE_DTD_QUOTED:e.doctype+=s,s===e.q&&(e.state=E.DOCTYPE_DTD,e.q="");continue;case E.COMMENT:"-"===s?e.state=E.COMMENT_ENDING:e.comment+=s;continue;case E.COMMENT_ENDING:"-"===s?(e.state=E.COMMENT_ENDED,e.comment=I(e.opt,e.comment),e.comment&&T(e,"oncomment",e.comment),e.comment=""):(e.comment+="-"+s,e.state=E.COMMENT);continue;case E.COMMENT_ENDED:">"!==s?(O(e,"Malformed comment"),e.comment+="--"+s,e.state=E.COMMENT):e.state=E.TEXT;continue;case E.CDATA:"]"===s?e.state=E.CDATA_ENDING:e.cdata+=s;continue;case E.CDATA_ENDING:"]"===s?e.state=E.CDATA_ENDING_2:(e.cdata+="]"+s,e.state=E.CDATA);continue;case E.CDATA_ENDING_2:">"===s?(e.cdata&&T(e,"oncdata",e.cdata),T(e,"onclosecdata"),e.cdata="",e.state=E.TEXT):"]"===s?e.cdata+="]":(e.cdata+="]]"+s,e.state=E.CDATA);continue;case E.PROC_INST:"?"===s?e.state=E.PROC_INST_ENDING:g(s)?e.state=E.PROC_INST_BODY:e.procInstName+=s;continue;case E.PROC_INST_BODY:if(!e.procInstBody&&g(s))continue;"?"===s?e.state=E.PROC_INST_ENDING:e.procInstBody+=s;continue;case E.PROC_INST_ENDING:">"===s?(T(e,"onprocessinginstruction",{name:e.procInstName,body:e.procInstBody}),e.procInstName=e.procInstBody="",e.state=E.TEXT):(e.procInstBody+="?"+s,e.state=E.PROC_INST_BODY);continue;case E.OPEN_TAG:b(d,s)?e.tagName+=s:(M(e),">"===s?R(e):"/"===s?e.state=E.OPEN_TAG_SLASH:(g(s)||O(e,"Invalid character in tag name"),e.state=E.ATTRIB));continue;case E.OPEN_TAG_SLASH:">"===s?(R(e,!0),j(e)):(O(e,"Forward-slash in opening tag not followed by >"),e.state=E.ATTRIB);continue;case E.ATTRIB:if(g(s))continue;">"===s?R(e):"/"===s?e.state=E.OPEN_TAG_SLASH:b(h,s)?(e.attribName=s,e.attribValue="",e.state=E.ATTRIB_NAME):O(e,"Invalid attribute name");continue;case E.ATTRIB_NAME:"="===s?e.state=E.ATTRIB_VALUE:">"===s?(O(e,"Attribute without value"),e.attribValue=e.attribName,N(e),R(e)):g(s)?e.state=E.ATTRIB_NAME_SAW_WHITE:b(d,s)?e.attribName+=s:O(e,"Invalid attribute name");continue;case E.ATTRIB_NAME_SAW_WHITE:if("="===s)e.state=E.ATTRIB_VALUE;else{if(g(s))continue;O(e,"Attribute without value"),e.tag.attributes[e.attribName]="",e.attribValue="",T(e,"onattribute",{name:e.attribName,value:""}),e.attribName="",">"===s?R(e):b(h,s)?(e.attribName=s,e.state=E.ATTRIB_NAME):(O(e,"Invalid attribute name"),e.state=E.ATTRIB)}continue;case E.ATTRIB_VALUE:if(g(s))continue;m(s)?(e.q=s,e.state=E.ATTRIB_VALUE_QUOTED):(O(e,"Unquoted attribute value"),e.state=E.ATTRIB_VALUE_UNQUOTED,e.attribValue=s);continue;case E.ATTRIB_VALUE_QUOTED:if(s!==e.q){"&"===s?e.state=E.ATTRIB_VALUE_ENTITY_Q:e.attribValue+=s;continue}N(e),e.q="",e.state=E.ATTRIB_VALUE_CLOSED;continue;case E.ATTRIB_VALUE_CLOSED:g(s)?e.state=E.ATTRIB:">"===s?R(e):"/"===s?e.state=E.OPEN_TAG_SLASH:b(h,s)?(O(e,"No whitespace between attributes"),e.attribName=s,e.attribValue="",e.state=E.ATTRIB_NAME):O(e,"Invalid attribute name");continue;case E.ATTRIB_VALUE_UNQUOTED:if(!y(s)){"&"===s?e.state=E.ATTRIB_VALUE_ENTITY_U:e.attribValue+=s;continue}N(e),">"===s?R(e):e.state=E.ATTRIB;continue;case E.CLOSE_TAG:if(e.tagName)">"===s?j(e):b(d,s)?e.tagName+=s:e.script?(e.script+="</"+e.tagName,e.tagName="",e.state=E.SCRIPT):(g(s)||O(e,"Invalid tagname in closing tag"),e.state=E.CLOSE_TAG_SAW_WHITE);else{if(g(s))continue;_(h,s)?e.script?(e.script+="</"+s,e.state=E.SCRIPT):O(e,"Invalid tagname in closing tag."):e.tagName=s}continue;case E.CLOSE_TAG_SAW_WHITE:if(g(s))continue;">"===s?j(e):O(e,"Invalid characters in closing tag");continue;case E.TEXT_ENTITY:case E.ATTRIB_VALUE_ENTITY_Q:case E.ATTRIB_VALUE_ENTITY_U:var a,u;switch(e.state){case E.TEXT_ENTITY:a=E.TEXT,u="textNode";break;case E.ATTRIB_VALUE_ENTITY_Q:a=E.ATTRIB_VALUE_QUOTED,u="attribValue";break;case E.ATTRIB_VALUE_ENTITY_U:a=E.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===s?(e[u]+=L(e),e.entity="",e.state=a):b(e.entity.length?p:f,s)?e.entity+=s:(O(e,"Invalid character in entity name"),e[u]+="&"+e.entity+s,e.entity="",e.state=a);continue;default:throw new Error(e,"Unknown state: "+e.state)}return e.position>=e.bufferCheckPosition&&function(t){for(var e=Math.max(n.MAX_BUFFER_LENGTH,10),r=0,s=0,o=i.length;s<o;s++){var a=t[i[s]].length;if(a>e)switch(i[s]){case"textNode":C(t);break;case"cdata":T(t,"oncdata",t.cdata),t.cdata="";break;case"script":T(t,"onscript",t.script),t.script="";break;default:D(t,"Max buffer length exceeded: "+i[s])}r=Math.max(r,a)}t.bufferCheckPosition=n.MAX_BUFFER_LENGTH-r+t.position}(e),e},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;C(t=this),""!==t.cdata&&(T(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(T(t,"onscript",t.script),t.script="")}};try{r=t("stream").Stream}catch(z){r=function(){}}var o=n.EVENTS.filter(function(t){return"error"!==t&&"end"!==t});function a(t,e){if(!(this instanceof a))return new a(t,e);r.apply(this),this._parser=new s(t,e),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(t){n.emit("error",t),n._parser.error=null},this._decoder=null,o.forEach(function(t){Object.defineProperty(n,"on"+t,{get:function(){return n._parser["on"+t]},set:function(e){if(!e)return n.removeAllListeners(t),n._parser["on"+t]=e,e;n.on(t,e)},enumerable:!0,configurable:!1})})}(a.prototype=Object.create(r.prototype,{constructor:{value:a}})).write=function(n){if("function"==typeof e&&"function"==typeof e.isBuffer&&e.isBuffer(n)){if(!this._decoder){var r=t("string_decoder").StringDecoder;this._decoder=new r("utf8")}n=this._decoder.write(n)}return this._parser.write(n.toString()),this.emit("data",n),!0},a.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},a.prototype.on=function(t,e){var n=this;return n._parser["on"+t]||-1===o.indexOf(t)||(n._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),n.emit.apply(n,e)}),r.prototype.on.call(n,t,e)};var u="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/2000/xmlns/",l={xml:u,xmlns:c},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function m(t){return'"'===t||"'"===t}function y(t){return">"===t||g(t)}function b(t,e){return t.test(e)}function _(t,e){return!b(t,e)}var v,w,x,E=0;for(var S in n.STATE={BEGIN:E++,BEGIN_WHITESPACE:E++,TEXT:E++,TEXT_ENTITY:E++,OPEN_WAKA:E++,SGML_DECL:E++,SGML_DECL_QUOTED:E++,DOCTYPE:E++,DOCTYPE_QUOTED:E++,DOCTYPE_DTD:E++,DOCTYPE_DTD_QUOTED:E++,COMMENT_STARTING:E++,COMMENT:E++,COMMENT_ENDING:E++,COMMENT_ENDED:E++,CDATA:E++,CDATA_ENDING:E++,CDATA_ENDING_2:E++,PROC_INST:E++,PROC_INST_BODY:E++,PROC_INST_ENDING:E++,OPEN_TAG:E++,OPEN_TAG_SLASH:E++,ATTRIB:E++,ATTRIB_NAME:E++,ATTRIB_NAME_SAW_WHITE:E++,ATTRIB_VALUE:E++,ATTRIB_VALUE_QUOTED:E++,ATTRIB_VALUE_CLOSED:E++,ATTRIB_VALUE_UNQUOTED:E++,ATTRIB_VALUE_ENTITY_Q:E++,ATTRIB_VALUE_ENTITY_U:E++,CLOSE_TAG:E++,CLOSE_TAG_SAW_WHITE:E++,SCRIPT:E++,SCRIPT_ENDING:E++},n.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},n.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(n.ENTITIES).forEach(function(t){var e=n.ENTITIES[t],r="number"==typeof e?String.fromCharCode(e):e;n.ENTITIES[t]=r}),n.STATE)n.STATE[n.STATE[S]]=S;function A(t,e,n){t[e]&&t[e](n)}function T(t,e,n){t.textNode&&C(t),A(t,e,n)}function C(t){t.textNode=I(t.opt,t.textNode),t.textNode&&A(t,"ontext",t.textNode),t.textNode=""}function I(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function D(t,e){return C(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,A(t,"onerror",e),t}function k(t){return t.sawRoot&&!t.closedRoot&&O(t,"Unclosed root tag"),t.state!==E.BEGIN&&t.state!==E.BEGIN_WHITESPACE&&t.state!==E.TEXT&&D(t,"Unexpected end"),C(t),t.c="",t.closed=!0,A(t,"onend"),s.call(t,t.strict,t.opt),t}function O(t,e){if("object"!=typeof t||!(t instanceof s))throw new Error("bad call to strictFail");t.strict&&D(t,e)}function M(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,n=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(n.ns=e.ns),t.attribList.length=0,T(t,"onopentagstart",n)}function P(t,e){var n=t.indexOf(":")<0?["",t]:t.split(":"),r=n[0],i=n[1];return e&&"xmlns"===t&&(r="xmlns",i=""),{prefix:r,local:i}}function N(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=P(t.attribName,!0),n=e.local;if("xmlns"===e.prefix)if("xml"===n&&t.attribValue!==u)O(t,"xml: prefix must be bound to "+u+"\nActual: "+t.attribValue);else if("xmlns"===n&&t.attribValue!==c)O(t,"xmlns: prefix must be bound to "+c+"\nActual: "+t.attribValue);else{var r=t.tag,i=t.tags[t.tags.length-1]||t;r.ns===i.ns&&(r.ns=Object.create(i.ns)),r.ns[n]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,T(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function R(t,e){if(t.opt.xmlns){var n=t.tag,r=P(t.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(O(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),n.uri=r.prefix),n.ns&&(t.tags[t.tags.length-1]||t).ns!==n.ns&&Object.keys(n.ns).forEach(function(e){T(t,"onopennamespace",{prefix:e,uri:n.ns[e]})});for(var i=0,s=t.attribList.length;i<s;i++){var o=t.attribList[i],a=o[0],u=o[1],c=P(a,!0),l=c.prefix,h=""===l?"":n.ns[l]||"",d={name:a,value:u,prefix:l,local:c.local,uri:h};l&&"xmlns"!==l&&!h&&(O(t,"Unbound namespace prefix: "+JSON.stringify(l)),d.uri=l),t.tag.attributes[a]=d,T(t,"onattribute",d)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),T(t,"onopentag",t.tag),e||(t.state=t.noscript||"script"!==t.tagName.toLowerCase()?E.TEXT:E.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function j(t){if(!t.tagName)return O(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=E.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=E.SCRIPT);T(t,"onscript",t.script),t.script=""}var e=t.tags.length,n=t.tagName;t.strict||(n=n[t.looseCase]());for(var r=n;e--&&t.tags[e].name!==r;)O(t,"Unexpected close tag");if(e<0)return O(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=E.TEXT);t.tagName=n;for(var i=t.tags.length;i-- >e;){var s=t.tag=t.tags.pop();t.tagName=t.tag.name,T(t,"onclosetag",t.tagName);var o={};for(var a in s.ns)o[a]=s.ns[a];t.opt.xmlns&&s.ns!==(t.tags[t.tags.length-1]||t).ns&&Object.keys(s.ns).forEach(function(e){T(t,"onclosenamespace",{prefix:e,uri:s.ns[e]})})}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=E.TEXT}function L(t){var e,n=t.entity,r=n.toLowerCase(),i="";return t.ENTITIES[n]?t.ENTITIES[n]:t.ENTITIES[r]?t.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(e=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(e=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),isNaN(e)||i.toLowerCase()!==n?(O(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function F(t,e){"<"===e?(t.state=E.OPEN_WAKA,t.startTagPosition=t.position):g(e)||(O(t,"Non-whitespace before first tag."),t.textNode=e,t.state=E.TEXT)}function B(t,e){var n="";return e<t.length&&(n=t.charAt(e)),n}E=n.STATE,String.fromCodePoint||(v=String.fromCharCode,w=Math.floor,x=function(){var t=16384,e=[],n=-1,r=arguments.length;if(!r)return"";for(var i="";++n<r;){var s=Number(arguments[n]);if(!isFinite(s)||s<0||s>1114111||w(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?e.push(s):e.push(55296+((s-=65536)>>10),s%1024+56320),(n+1===r||e.length>t)&&(i+=v.apply(null,e),e.length=0)}return i},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:x,configurable:!0,writable:!0}):String.fromCodePoint=x)}(void 0===n?this.sax={}:n)}).call(this)}).call(this,t("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(t,e,n){(function(t,e){(function(){!function(e,n){"use strict";if(!e.setImmediate){var r,i=1,s={},o=!1,a=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick(function(){p(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(h="setImmediate$"+Math.random()+"$",d=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(h)&&p(+t.data.slice(h.length))},e.addEventListener?e.addEventListener("message",d,!1):e.attachEvent("onmessage",d),r=function(t){e.postMessage(h+t,"*")}):e.MessageChannel?((l=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){l.port2.postMessage(t)}):a&&"onreadystatechange"in a.createElement("script")?(c=a.documentElement,r=function(t){var e=a.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,c.removeChild(e),e=null},c.appendChild(e)}):r=function(t){setTimeout(p,0,t)},u.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];return s[i]={callback:t,args:e},r(i),i++},u.clearImmediate=f}var c,l,h,d;function f(t){delete s[t]}function p(t){if(o)setTimeout(p,0,t);else{var e=s[t];if(e){o=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{f(t),o=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(t,e,n){e.exports=i;var r=t("events").EventEmitter;function i(){r.call(this)}t("inherits")(i,r),i.Readable=t("readable-stream/lib/_stream_readable.js"),i.Writable=t("readable-stream/lib/_stream_writable.js"),i.Duplex=t("readable-stream/lib/_stream_duplex.js"),i.Transform=t("readable-stream/lib/_stream_transform.js"),i.PassThrough=t("readable-stream/lib/_stream_passthrough.js"),i.finished=t("readable-stream/lib/internal/streams/end-of-stream.js"),i.pipeline=t("readable-stream/lib/internal/streams/pipeline.js"),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function s(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",s),t._isStdio||e&&!1===e.end||(n.on("end",a),n.on("close",u));var o=!1;function a(){o||(o=!0,t.end())}function u(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(l(),0===r.listenerCount(this,"error"))throw t}function l(){n.removeListener("data",i),t.removeListener("drain",s),n.removeListener("end",a),n.removeListener("close",u),n.removeListener("error",c),t.removeListener("error",c),n.removeListener("end",l),n.removeListener("close",l),t.removeListener("close",l)}return n.on("error",c),t.on("error",c),n.on("end",l),n.on("close",l),t.on("close",l),t.emit("pipe",n),t}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(t,e,n){arguments[4][5][0].apply(n,arguments)},{dup:5,"safe-buffer":84}],89:[function(t,e,n){(function(e,r){(function(){var i=t("process/browser.js").nextTick,s=Function.prototype.apply,o=Array.prototype.slice,a={},u=0;function c(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new c(s.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new c(s.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n.setImmediate="function"==typeof e?e:function(t){var e=u++,r=!(arguments.length<2)&&o.call(arguments,1);return a[e]=!0,i(function(){a[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))}),e},n.clearImmediate="function"==typeof r?r:function(t){delete a[t]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(t,e,n){(function(t){(function(){function n(e){try{if(!t.localStorage)return!1}catch(r){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(t,e,n){"use strict";e.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},{}],92:[function(t,e,n){"use strict";function r(t){var e=this;if(e instanceof r||(e=new r),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach(function(t){e.push(t)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)e.push(arguments[n]);return e}function i(t,e,n){var r=e===t.head?new a(n,null,e,t):new a(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function s(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function o(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,n,r){if(!(this instanceof a))return new a(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=a,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)s(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},r.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},r.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},r.prototype.map=function(t,e){e=e||this;for(var n=new r,i=this.head;null!==i;)n.push(t.call(e,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(t,e){e=e||this;for(var n=new r,i=this.tail;null!==i;)n.push(t.call(e,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},r.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,s=this.head;null!==s&&i<t;i++)s=s.next;for(;null!==s&&i<e;i++,s=s.next)n.push(s.value);return n},r.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,s=this.tail;null!==s&&i>e;i--)s=s.prev;for(;null!==s&&i>t;i--,s=s.prev)n.push(s.value);return n},r.prototype.splice=function(t,e,...n){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var r=0,s=this.head;null!==s&&r<t;r++)s=s.next;var o=[];for(r=0;s&&r<e;r++)o.push(s.value),s=this.removeNode(s);for(null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev),r=0;r<n.length;r++)s=i(this,s,n[r]);return o},r.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{t("./iterator.js")(r)}catch(u){}},{"./iterator.js":91}]},{},[1])(1)},322:t=>{t.exports=function(t,e){var n=e.length;if(0!==n){var r=t.length;t.length+=n;for(var i=0;i<n;i++)t[r+i]=e[i]}}},517:(t,e)=>{"use strict";var n=(()=>(function(t){t.typeOfFunction="function",t.boolTrue=!0}(n||(n={})),n))();function r(t,e,r){if(!r||typeof r.value!==n.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+e+"> is not a method!");return{configurable:n.boolTrue,get:function(){var t=r.value.bind(this);return Object.defineProperty(this,e,{value:t,configurable:n.boolTrue,writable:n.boolTrue}),t}}}e.ak=r,e.ZP=r},266:(t,e,n)=>{t.exports={ResizeSensor:n(835),ElementQueries:n(845)}},845:function(t,e,n){"use strict";var r,i,s;"undefined"!=typeof window&&window,i=[n(835)],void 0===(s="function"==typeof(r=function(t){var e=function(){var e,n={},r=[];function i(t){t||(t=document.documentElement);var e=window.getComputedStyle(t,null).fontSize;return parseFloat(e)||16}function s(t,e){var n=e.split(/\d/),r=n[n.length-1];switch(e=parseFloat(e),r){case"px":return e;case"em":return e*i(t);case"rem":return e*i();case"vw":return e*document.documentElement.clientWidth/100;case"vh":return e*document.documentElement.clientHeight/100;case"vmin":case"vmax":var s=document.documentElement.clientWidth/100,o=document.documentElement.clientHeight/100;return e*(0,Math["vmin"===r?"min":"max"])(s,o);default:return e}}function o(t,e){var r,i,o,a,u,c,l,h;this.element=t;var d=["min-width","min-height","max-width","max-height"];this.call=function(){for(r in o=function(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}(this.element),c={},n[e])n[e].hasOwnProperty(r)&&(a=s(this.element,(i=n[e][r]).value),u="width"===i.property?o.width:o.height,l="","min"===i.mode&&u>=a&&(l+=i.value),"max"===i.mode&&u<=a&&(l+=i.value),c[h=i.mode+"-"+i.property]||(c[h]=""),l&&-1===(" "+c[h]+" ").indexOf(" "+l+" ")&&(c[h]+=" "+l));for(var t in d)d.hasOwnProperty(t)&&(c[d[t]]?this.element.setAttribute(d[t],c[d[t]].substr(1)):this.element.removeAttribute(d[t]))}}function a(e,n){e.elementQueriesSetupInformation||(e.elementQueriesSetupInformation=new o(e,n)),e.elementQueriesSensor||(e.elementQueriesSensor=new t(e,function(){e.elementQueriesSetupInformation.call()}))}function u(t,i,s,o){if(void 0===n[t]){n[t]=[];var a=r.length;e.innerHTML+="\n"+t+" {animation: 0.1s element-queries;}",e.innerHTML+="\n"+t+" > .resize-sensor {min-width: "+a+"px;}",r.push(t)}n[t].push({mode:i,property:s,value:o})}function c(t){var e;if(document.querySelectorAll&&(e=t?t.querySelectorAll.bind(t):document.querySelectorAll.bind(document)),e||"undefined"==typeof $$||(e=$$),e||"undefined"==typeof jQuery||(e=jQuery),!e)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return e}function l(e){var n=[],r=[],i=[],s=0,o=-1,a=[];for(var u in e.children)if(e.children.hasOwnProperty(u)&&e.children[u].tagName&&"img"===e.children[u].tagName.toLowerCase()){n.push(e.children[u]);var c=e.children[u].getAttribute("min-width")||e.children[u].getAttribute("data-min-width"),l=e.children[u].getAttribute("data-src")||e.children[u].getAttribute("url");i.push(l),r.push({minWidth:c}),c?e.children[u].style.display="none":(s=n.length-1,e.children[u].style.display="block")}function h(){var t,u=!1;for(t in n)n.hasOwnProperty(t)&&r[t].minWidth&&e.offsetWidth>r[t].minWidth&&(u=t);if(u||(u=s),o!==u)if(a[u])n[o].style.display="none",n[u].style.display="block",o=u;else{var c=new Image;c.onload=function(){n[u].src=i[u],n[o].style.display="none",n[u].style.display="block",a[u]=!0,o=u},c.src=i[u]}else n[u].src=i[u]}o=s,e.resizeSensorInstance=new t(e,h),h()}var h=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,d=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function f(t){var e,n,r,i;for(t=t.replace(/'/g,'"');null!==(e=h.exec(t));)for(n=e[1]+e[3],r=e[2];null!==(i=d.exec(r));)u(n,i[1],i[2],i[3])}function p(t){var e="";if(t)if("string"==typeof t)-1===(t=t.toLowerCase()).indexOf("min-width")&&-1===t.indexOf("max-width")||f(t);else for(var n=0,r=t.length;n<r;n++)1===t[n].type?-1!==(e=t[n].selectorText||t[n].cssText).indexOf("min-height")||-1!==e.indexOf("max-height")?f(e):-1===e.indexOf("min-width")&&-1===e.indexOf("max-width")||f(e):4===t[n].type?p(t[n].cssRules||t[n].rules):3===t[n].type&&t[n].styleSheet.hasOwnProperty("cssRules")&&p(t[n].styleSheet.cssRules)}var g=!1;this.init=function(){var n="animationstart";void 0!==document.documentElement.style.webkitAnimationName?n="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?n="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(n="oanimationstart"),document.body.addEventListener(n,function(e){var n=e.target,i=n&&window.getComputedStyle(n,null),s=i&&i.getPropertyValue("animation-name");if(s&&-1!==s.indexOf("element-queries")){n.elementQueriesSensor=new t(n,function(){n.elementQueriesSetupInformation&&n.elementQueriesSetupInformation.call()});var o=window.getComputedStyle(n.resizeSensor,null).getPropertyValue("min-width");o=parseInt(o.replace("px","")),a(e.target,r[o])}}),g||((e=document.createElement("style")).type="text/css",e.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",e.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(e),g=!0);for(var i=0,s=document.styleSheets.length;i<s;i++)try{document.styleSheets[i].href&&0===document.styleSheets[i].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[i].href),p(document.styleSheets[i].cssRules||document.styleSheets[i].rules||document.styleSheets[i].cssText)}catch(o){}!function(){for(var t=c()("[data-responsive-image],[responsive-image]"),e=0,n=t.length;e<n;e++)l(t[e])}()},this.findElementQueriesElements=function(t){!function(t){var e=c(t);for(var r in n)if(n.hasOwnProperty(r))for(var i=e(r,t),s=0,o=i.length;s<o;s++)a(i[s],r)}(t)},this.update=function(){this.init()}};return e.update=function(){e.instance.update()},e.detach=function(t){t.elementQueriesSetupInformation?(t.elementQueriesSensor.detach(),delete t.elementQueriesSetupInformation,delete t.elementQueriesSensor):t.resizeSensorInstance&&(t.resizeSensorInstance.detach(),delete t.resizeSensorInstance)},e.init=function(){e.instance||(e.instance=new e),e.instance.init()},e.findElementQueriesElements=function(t){e.instance.findElementQueriesElements(t)},e.listen=function(){!function(t){if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var e=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(t(),clearInterval(e))},10);else window.onload=t}(e.init)},e})?r.apply(e,i):r)||(t.exports=s)},835:function(t,e,n){"use strict";var r,i;"undefined"!=typeof window&&window,void 0===(i="function"==typeof(r=function(){if("undefined"==typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},n=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||function(e){t.clearTimeout(e)};function r(t,e){var n=Object.prototype.toString.call(t),r="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,i=0,s=t.length;if(r)for(;i<s;i++)e(t[i]);else e(t)}function i(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}function s(t,e){Object.keys(e).forEach(function(n){t.style[n]=e[n]})}var o=function(t,a){var u=0;function c(){var t,e,n=[];this.add=function(t){n.push(t)},this.call=function(r){for(t=0,e=n.length;t<e;t++)n[t].call(this,r)},this.remove=function(r){var i=[];for(t=0,e=n.length;t<e;t++)n[t]!==r&&i.push(n[t]);n=i},this.length=function(){return n.length}}r(t,function(t){!function(t,n){if(t)if(t.resizedAttached)t.resizedAttached.add(n);else{t.resizedAttached=new c,t.resizedAttached.add(n),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var r={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},o={position:"absolute",left:"0px",top:"0px",transition:"0s"};s(t.resizeSensor,r);var a=document.createElement("div");a.className="resize-sensor-expand",s(a,r);var l=document.createElement("div");s(l,o),a.appendChild(l);var h=document.createElement("div");h.className="resize-sensor-shrink",s(h,r);var d=document.createElement("div");s(d,o),s(d,{width:"200%",height:"200%"}),h.appendChild(d),t.resizeSensor.appendChild(a),t.resizeSensor.appendChild(h),t.appendChild(t.resizeSensor);var f=window.getComputedStyle(t),p=f?f.getPropertyValue("position"):null;"absolute"!==p&&"relative"!==p&&"fixed"!==p&&"sticky"!==p&&(t.style.position="relative");var g=!1,m=0,y=i(t),b=0,_=0,v=!0;u=0;var w=function(){if(v){if(0===t.offsetWidth&&0===t.offsetHeight)return void(u||(u=e(function(){u=0,w()})));v=!1}var n,r;r=t.offsetHeight,l.style.width=(n=t.offsetWidth)+10+"px",l.style.height=r+10+"px",a.scrollLeft=n+10,a.scrollTop=r+10,h.scrollLeft=n+10,h.scrollTop=r+10};t.resizeSensor.resetSensor=w;var x=function(){m=0,g&&(b=y.width,_=y.height,t.resizedAttached&&t.resizedAttached.call(y))},E=function(){y=i(t),(g=y.width!==b||y.height!==_)&&!m&&(m=e(x)),w()},S=function(t,e,n){t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener(e,n)};S(a,"scroll",E),S(h,"scroll",E),u=e(function(){u=0,w()})}}(t,a)}),this.detach=function(e){u||(n(u),u=0),o.detach(t,e)},this.reset=function(){t.resizeSensor.resetSensor()}};if(o.reset=function(t){r(t,function(t){t.resizeSensor.resetSensor()})},o.detach=function(t,e){r(t,function(t){t&&(t.resizedAttached&&"function"==typeof e&&(t.resizedAttached.remove(e),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))})},"undefined"!=typeof MutationObserver){var a=new MutationObserver(function(t){for(var e in t)if(t.hasOwnProperty(e))for(var n=t[e].addedNodes,r=0;r<n.length;r++)n[r].resizeSensor&&o.reset(n[r])});document.addEventListener("DOMContentLoaded",function(t){a.observe(document.body,{childList:!0,subtree:!0})})}return o})?r.call(e,n,e,t):r)||(t.exports=i)},445:(t,e,n)=>{var r=n(910),i=n(369),s=n(322);function o(t,e,n){if(!r(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if((e=""+e)==(n=""+n))return[e];var i=t.inboundNeighbors.bind(t),s=t.outboundNeighbors.bind(t),o={},a={};o[e]=null,a[n]=null;var u,c,l,h,d,f,p,g,m=[e],y=[n],b=!1;t:for(;m.length&&y.length;)if(m.length<=y.length){for(u=m,m=[],d=0,p=u.length;d<p;d++)for(f=0,g=(l=s(c=u[d])).length;f<g;f++)if((h=l[f])in o||(m.push(h),o[h]=c),h in a){b=!0;break t}}else for(u=y,y=[],d=0,p=u.length;d<p;d++)for(f=0,g=(l=i(c=u[d])).length;f<g;f++)if((h=l[f])in a||(y.push(h),a[h]=c),h in o){b=!0;break t}if(!b)return null;for(var _=[];h;)_.unshift(h),h=o[h];for(h=a[_[_.length-1]];h;)_.push(h),h=a[h];return _.length?_:null}function a(t,e){if(!r(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');var n,i,s,o,a,u,c={},l={};for(c[e=""+e]=!0,l[e]=[e];Object.keys(c).length;)for(s in n=c,c={},n)for(a=0,u=(i=t.outboundNeighbors(s)).length;a<u;a++)l[o=i[a]]||(l[o]=l[s].concat(o),c[o]=!0);return l}function u(t,e,n){if(!r(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var i=new Set,o={},a=0;o[n]=0;for(var u,c,l,h=[n];0!==h.length;){var d=[];for(u=0,c=h.length;u<c;u++)i.has(l=h[u])||(i.add(l),s(d,e[t](l)),o[l]=a);a++,h=d}return o}var c=u.bind(null,"outboundNeighbors"),l=u.bind(null,"neighbors");function h(t,e,n){return arguments.length<3?a(t,e):o(t,e,n)}h.bidirectional=o,h.singleSource=a,h.singleSourceLength=c,h.undirectedSingleSourceLength=l,h.brandes=function(t,e){e=""+e;var n,r,s,o,a,u,c,l,h,d=[],f={},p={},g=t.nodes();for(u=0,l=g.length;u<l;u++)f[o=g[u]]=[],p[o]=0;var m={};p[e]=1,m[e]=0;for(var y=i.of(e);y.size;)for(o=y.dequeue(),d.push(o),n=m[o],r=p[o],c=0,h=(s=t.outboundNeighbors(o)).length;c<h;c++)(a=s[c])in m||(y.enqueue(a),m[a]=n+1),m[a]===n+1&&(p[a]+=r,f[a].push(o));return[d,f,p]},t.exports=h},910:t=>{t.exports=function(t){return null!==t&&"object"==typeof t&&"function"==typeof t.addUndirectedEdgeWithKey&&"function"==typeof t.dropNode&&"boolean"==typeof t.multi}},698:function(t){t.exports=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function s(t,e,n){return(s=i()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var s=new(Function.bind.apply(t,i));return n&&r(s,n.prototype),s}).apply(null,arguments)}function o(t){var e="function"==typeof Map?new Map:void 0;return(o=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return s(t,arguments,n(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),r(i,t)})(t)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var u=function(){for(var t=arguments[0],e=1,n=arguments.length;e<n;e++)if(arguments[e])for(var r in arguments[e])t[r]=arguments[e][r];return t};function c(t,e,n,r){var i=t._nodes.get(e),s=null;return i?s="mixed"===r?i.out&&i.out[n]||i.undirected&&i.undirected[n]:"directed"===r?i.out&&i.out[n]:i.undirected&&i.undirected[n]:s}function l(e){return null!==e&&"object"===t(e)&&"function"==typeof e.addUndirectedEdgeWithKey&&"function"==typeof e.dropNode}function h(e){return"object"===t(e)&&null!==e&&e.constructor===Object}function d(t){var e;for(e in t)return!1;return!0}function f(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function p(t,e,n){var r={enumerable:!0,configurable:!0};"function"==typeof n?r.get=n:(r.value=n,r.writable=!1),Object.defineProperty(t,e,r)}function g(t){return!(!h(t)||t.attributes&&!Array.isArray(t.attributes))}"function"==typeof Object.assign&&(u=Object.assign);var m,y={exports:{}},b="object"==typeof Reflect?Reflect:null,_=b&&"function"==typeof b.apply?b.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};m=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var v=Number.isNaN||function(t){return t!=t};function w(){w.init.call(this)}y.exports=w,y.exports.once=function(t,e){return new Promise(function(n,r){function i(n){t.removeListener(e,s),r(n)}function s(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}O(t,e,s,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&O(t,"error",e,{once:!0})}(t,i)})},w.EventEmitter=w,w.prototype._events=void 0,w.prototype._eventsCount=0,w.prototype._maxListeners=void 0;var x=10;function E(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function S(t){return void 0===t._maxListeners?w.defaultMaxListeners:t._maxListeners}function A(t,e,n,r){var i,s,o;if(E(n),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),void 0===o)o=s[e]=n,++t._eventsCount;else if("function"==typeof o?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=S(t))>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,console&&console.warn&&console.warn(a)}return t}function T(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=T.bind(r);return i.listener=n,r.wrapFn=i,i}function I(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):k(i,i.length)}function D(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function k(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function O(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)})}}function M(t){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:t}),this.done=!1}Object.defineProperty(w,"defaultMaxListeners",{enumerable:!0,get:function(){return x},set:function(t){if("number"!=typeof t||t<0||v(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");x=t}}),w.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},w.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||v(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},w.prototype.getMaxListeners=function(){return S(this)},w.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=i[t];if(void 0===a)return!1;if("function"==typeof a)_(a,this,e);else{var u=a.length,c=k(a,u);for(n=0;n<u;++n)_(c[n],this,e)}return!0},w.prototype.on=w.prototype.addListener=function(t,e){return A(this,t,e,!1)},w.prototype.prependListener=function(t,e){return A(this,t,e,!0)},w.prototype.once=function(t,e){return E(e),this.on(t,C(this,t,e)),this},w.prototype.prependOnceListener=function(t,e){return E(e),this.prependListener(t,C(this,t,e)),this},w.prototype.off=w.prototype.removeListener=function(t,e){var n,r,i,s,o;if(E(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===e||n[s].listener===e){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,o||e)}return this},w.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},w.prototype.listeners=function(t){return I(this,t,!0)},w.prototype.rawListeners=function(t){return I(this,t,!1)},w.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):D.call(t,e)},w.prototype.listenerCount=D,w.prototype.eventNames=function(){return this._eventsCount>0?m(this._events):[]},M.prototype.next=function(){if(this.done)return{done:!0};var t=this._next();return t.done&&(this.done=!0),t},"undefined"!=typeof Symbol&&(M.prototype[Symbol.iterator]=function(){return this}),M.of=function(){var t=arguments,e=t.length,n=0;return new M(function(){return n>=e?{done:!0}:{done:!1,value:t[n++]}})},M.empty=function(){var t=new M(null);return t.done=!0,t},M.is=function(t){return t instanceof M||"object"==typeof t&&null!==t&&"function"==typeof t.next};var P=M,N=function(t,e){for(var n,r=arguments.length>1?e:1/0,i=r!==1/0?new Array(r):[],s=0;;){if(s===r)return i;if((n=t.next()).done)return s!==e?i.slice(0,s):i;i[s++]=n.value}},R=function(t){function n(e,n){var r;return(r=t.call(this)||this).name="GraphError",r.message=e||"",r.data=n||{},r}return e(n,t),n}(o(Error)),j=function(t){function n(e,r){var i;return(i=t.call(this,e,r)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(i),n.prototype.constructor),i}return e(n,t),n}(R),L=function(t){function n(e,r){var i;return(i=t.call(this,e,r)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(i),n.prototype.constructor),i}return e(n,t),n}(R),F=function(t){function n(e,r){var i;return(i=t.call(this,e,r)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a(i),n.prototype.constructor),i}return e(n,t),n}(R);function B(t,e){this.key=t,this.attributes=e,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function z(t,e){this.key=t,this.attributes=e,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function U(t,e){this.key=t,this.attributes=e,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function V(t,e,n,r,i,s){this.key=e,this.attributes=s,this.undirected=t,this.source=r,this.target=i,this.generatedKey=n}function G(t,e,n,r,i,s,o){var a,u,c="out",l="in";if(e&&(c=l="undirected"),t.multi){if(void 0===(u=(a=s[c])[i])&&(u=new Set,a[i]=u),u.add(n),r===i&&e)return;void 0===(a=o[l])[r]&&(a[r]=u)}else{if(s[c][i]=n,r===i&&e)return;o[l][r]=n}}function H(t,e,n){var r=t.multi,i=n.source,s=n.target,o=i.key,a=s.key,u=i[e?"undirected":"out"],c=e?"undirected":"in";if(a in u)if(r){var l=u[a];1===l.size?(delete u[a],delete s[c][o]):l.delete(n)}else delete u[a];r||delete s[c][o]}z.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},U.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var $=[{name:function(t){return"get".concat(t,"Attribute")},attacher:function(t,e,n){t.prototype[e]=function(t,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(e,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(e,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var s=""+t,o=""+r;if(r=arguments[2],!(i=c(this,s,o,n)))throw new L("Graph.".concat(e,': could not find an edge for the given path ("').concat(s,'" - "').concat(o,'").'))}else if(!(i=this._edges.get(t=""+t)))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" edge in the graph.'));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" ').concat(n," edge in the graph."));return i.attributes[r]}}},{name:function(t){return"get".concat(t,"Attributes")},attacher:function(t,e,n){t.prototype[e]=function(t){var r;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(e,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new F("Graph.".concat(e,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var i=""+t,s=""+arguments[1];if(!(r=c(this,i,s,n)))throw new L("Graph.".concat(e,': could not find an edge for the given path ("').concat(i,'" - "').concat(s,'").'))}else if(!(r=this._edges.get(t=""+t)))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" edge in the graph.'));if("mixed"!==n&&r.undirected!==("undirected"===n))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" ').concat(n," edge in the graph."));return r.attributes}}},{name:function(t){return"has".concat(t,"Attribute")},attacher:function(t,e,n){t.prototype[e]=function(t,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(e,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(e,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var s=""+t,o=""+r;if(r=arguments[2],!(i=c(this,s,o,n)))throw new L("Graph.".concat(e,': could not find an edge for the given path ("').concat(s,'" - "').concat(o,'").'))}else if(!(i=this._edges.get(t=""+t)))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" edge in the graph.'));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" ').concat(n," edge in the graph."));return i.attributes.hasOwnProperty(r)}}},{name:function(t){return"set".concat(t,"Attribute")},attacher:function(t,e,n){t.prototype[e]=function(t,r,i){var s;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(e,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new F("Graph.".concat(e,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+t,a=""+r;if(r=arguments[2],i=arguments[3],!(s=c(this,o,a,n)))throw new L("Graph.".concat(e,': could not find an edge for the given path ("').concat(o,'" - "').concat(a,'").'))}else if(!(s=this._edges.get(t=""+t)))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" edge in the graph.'));if("mixed"!==n&&s.undirected!==("undirected"===n))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" ').concat(n," edge in the graph."));return s.attributes[r]=i,this.emit("edgeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:r}),this}}},{name:function(t){return"update".concat(t,"Attribute")},attacher:function(t,e,n){t.prototype[e]=function(t,r,i){var s;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(e,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new F("Graph.".concat(e,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var o=""+t,a=""+r;if(r=arguments[2],i=arguments[3],!(s=c(this,o,a,n)))throw new L("Graph.".concat(e,': could not find an edge for the given path ("').concat(o,'" - "').concat(a,'").'))}else if(!(s=this._edges.get(t=""+t)))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" edge in the graph.'));if("function"!=typeof i)throw new j("Graph.".concat(e,": updater should be a function."));if("mixed"!==n&&s.undirected!==("undirected"===n))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" ').concat(n," edge in the graph."));return s.attributes[r]=i(s.attributes[r]),this.emit("edgeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:r}),this}}},{name:function(t){return"remove".concat(t,"Attribute")},attacher:function(t,e,n){t.prototype[e]=function(t,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(e,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(e,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var s=""+t,o=""+r;if(r=arguments[2],!(i=c(this,s,o,n)))throw new L("Graph.".concat(e,': could not find an edge for the given path ("').concat(s,'" - "').concat(o,'").'))}else if(!(i=this._edges.get(t=""+t)))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" edge in the graph.'));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" ').concat(n," edge in the graph."));return delete i.attributes[r],this.emit("edgeAttributesUpdated",{key:i.key,type:"remove",attributes:i.attributes,name:r}),this}}},{name:function(t){return"replace".concat(t,"Attributes")},attacher:function(t,e,n){t.prototype[e]=function(t,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(e,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(e,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var s=""+t,o=""+r;if(r=arguments[2],!(i=c(this,s,o,n)))throw new L("Graph.".concat(e,': could not find an edge for the given path ("').concat(s,'" - "').concat(o,'").'))}else if(!(i=this._edges.get(t=""+t)))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" edge in the graph.'));if(!h(r))throw new j("Graph.".concat(e,": provided attributes are not a plain object."));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" ').concat(n," edge in the graph."));return i.attributes=r,this.emit("edgeAttributesUpdated",{key:i.key,type:"replace",attributes:i.attributes}),this}}},{name:function(t){return"merge".concat(t,"Attributes")},attacher:function(t,e,n){t.prototype[e]=function(t,r){var i;if("mixed"!==this.type&&"mixed"!==n&&n!==this.type)throw new F("Graph.".concat(e,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new F("Graph.".concat(e,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var s=""+t,o=""+r;if(r=arguments[2],!(i=c(this,s,o,n)))throw new L("Graph.".concat(e,': could not find an edge for the given path ("').concat(s,'" - "').concat(o,'").'))}else if(!(i=this._edges.get(t=""+t)))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" edge in the graph.'));if(!h(r))throw new j("Graph.".concat(e,": provided attributes are not a plain object."));if("mixed"!==n&&i.undirected!==("undirected"===n))throw new L("Graph.".concat(e,': could not find the "').concat(t,'" ').concat(n," edge in the graph."));return u(i.attributes,r),this.emit("edgeAttributesUpdated",{key:i.key,type:"merge",attributes:i.attributes,data:r}),this}}}],q=P,W=function(){var t,e=arguments,n=-1;return new q(function r(){if(!t){if(++n>=e.length)return{done:!0};t=e[n]}var i=t.next();return i.done?(t=null,r()):i})},X=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function K(t,e){for(var n in e)t.push(e[n].key)}function Z(t,e){for(var n in e)e[n].forEach(function(e){return t.push(e.key)})}function Y(t,e,n){for(var r in t)if(r!==n){var i=t[r];e(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected,i.generatedKey)}}function Q(t,e,n){for(var r in t)r!==n&&t[r].forEach(function(t){return e(t.key,t.attributes,t.source.key,t.target.key,t.source.attributes,t.target.attributes,t.undirected,t.generatedKey)})}function J(t,e,n){for(var r in t)if(r!==n){var i=t[r];if(e(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected,i.generatedKey))return!0}return!1}function tt(t,e,n){var r,i,s,o,a;for(var u in t)if(u!==n)for(r=t[u].values();!0!==(i=r.next()).done;)if(o=(s=i.value).source,e(s.key,s.attributes,o.key,(a=s.target).key,o.attributes,a.attributes,s.undirected,s.generatedKey))return!0;return!1}function et(t,e){var n=Object.keys(t),r=n.length,i=null,s=0;return new P(function o(){var a;if(i){var u=i.next();if(u.done)return i=null,s++,o();a=u.value}else{if(s>=r)return{done:!0};var c=n[s];if(c===e)return s++,o();if((a=t[c])instanceof Set)return i=a.values(),o();s++}return{done:!1,value:[a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes]}})}function nt(t,e,n){var r=e[n];r&&t.push(r.key)}function rt(t,e,n){var r=e[n];r&&r.forEach(function(e){return t.push(e.key)})}function it(t,e,n){var r=t[e];if(r){var i=r.source,s=r.target;n(r.key,r.attributes,i.key,s.key,i.attributes,s.attributes,r.undirected,r.generatedKey)}}function st(t,e,n){var r=t[e];r&&r.forEach(function(t){return n(t.key,t.attributes,t.source.key,t.target.key,t.source.attributes,t.target.attributes,t.undirected,t.generatedKey)})}function ot(t,e,n){var r=t[e];if(r){var i=r.source,s=r.target;return n(r.key,r.attributes,i.key,s.key,i.attributes,s.attributes,r.undirected,r.generatedKey)}}function at(t,e,n){var r=t[e];if(r){for(var i,s,o=r.values();!0!==(i=o.next()).done;)if(n((s=i.value).key,s.attributes,s.source.key,s.target.key,s.source.attributes,s.target.attributes,s.undirected,s.generatedKey))return!0;return!1}}function ut(t,e){var n=t[e];if(n instanceof Set){var r=n.values();return new P(function(){var t=r.next();if(t.done)return t;var e=t.value;return{done:!1,value:[e.key,e.attributes,e.source.key,e.target.key,e.source.attributes,e.target.attributes]}})}return P.of([n.key,n.attributes,n.source.key,n.target.key,n.source.attributes,n.target.attributes])}function ct(t,e){if(0===t.size)return[];if("mixed"===e||e===t.type)return"function"==typeof Array.from?Array.from(t._edges.keys()):N(t._edges.keys(),t._edges.size);for(var n,r,i=new Array("undirected"===e?t.undirectedSize:t.directedSize),s="undirected"===e,o=t._edges.values(),a=0;!0!==(n=o.next()).done;)(r=n.value).undirected===s&&(i[a++]=r.key);return i}function lt(t,e,n){if(0!==t.size)for(var r,i,s="mixed"!==e&&e!==t.type,o="undirected"===e,a=t._edges.values();!0!==(r=a.next()).done;)if(i=r.value,!s||i.undirected===o){var u=i.source,c=i.target;n(i.key,i.attributes,u.key,c.key,u.attributes,c.attributes,i.undirected,i.generatedKey)}}function ht(t,e,n){if(0!==t.size)for(var r,i,s="mixed"!==e&&e!==t.type,o="undirected"===e,a=t._edges.values();!0!==(r=a.next()).done;)if(i=r.value,!s||i.undirected===o){var u=i.source,c=i.target;if(n(i.key,i.attributes,u.key,c.key,u.attributes,c.attributes,i.undirected,i.generatedKey))break}}function dt(t,e){if(0===t.size)return P.empty();var n="mixed"!==e&&e!==t.type,r="undirected"===e,i=t._edges.values();return new P(function(){for(var t,e;;){if((t=i.next()).done)return t;if(e=t.value,!n||e.undirected===r)break}return{value:[e.key,e.attributes,e.source.key,e.target.key,e.source.attributes,e.target.attributes],done:!1}})}function ft(t,e,n,r){var i=[],s=t?Z:K;return"undirected"!==e&&("out"!==n&&s(i,r.in),"in"!==n&&s(i,r.out),!n&&r.directedSelfLoops>0&&i.splice(i.lastIndexOf(r.key),1)),"directed"!==e&&s(i,r.undirected),i}function pt(t,e,n,r,i){var s=t?Q:Y;"undirected"!==e&&("out"!==n&&s(r.in,i),"in"!==n&&s(r.out,i,n?null:r.key)),"directed"!==e&&s(r.undirected,i)}function gt(t,e,n,r,i){var s=t?tt:J;if("undirected"!==e){if("out"!==n&&s(r.in,i))return;if("in"!==n&&s(r.out,i,n?null:r.key))return}"directed"===e||s(r.undirected,i)}function mt(t,e,n){var r=P.empty();return"undirected"!==t&&("out"!==e&&void 0!==n.in&&(r=W(r,et(n.in))),"in"!==e&&void 0!==n.out&&(r=W(r,et(n.out,e?null:n.key)))),"directed"!==t&&void 0!==n.undirected&&(r=W(r,et(n.undirected))),r}function yt(t,e,n,r,i){var s=e?rt:nt,o=[];return"undirected"!==t&&(void 0!==r.in&&"out"!==n&&s(o,r.in,i),void 0!==r.out&&"in"!==n&&s(o,r.out,i),!n&&r.directedSelfLoops>0&&o.splice(o.lastIndexOf(r.key),1)),"directed"!==t&&void 0!==r.undirected&&s(o,r.undirected,i),o}function bt(t,e,n,r,i,s){var o=e?st:it;"undirected"!==t&&(void 0!==r.in&&"out"!==n&&o(r.in,i,s),r.key!==i&&void 0!==r.out&&"in"!==n&&o(r.out,i,s)),"directed"!==t&&void 0!==r.undirected&&o(r.undirected,i,s)}function _t(t,e,n,r,i,s){var o=e?at:ot;if("undirected"!==t){if(void 0!==r.in&&"out"!==n&&o(r.in,i,s))return;if(r.key!==i&&void 0!==r.out&&"in"!==n&&o(r.out,i,s,n?null:r.key))return}"directed"===t||void 0===r.undirected||o(r.undirected,i,s)}function vt(t,e,n,r){var i=P.empty();return"undirected"!==t&&(void 0!==n.in&&"out"!==e&&r in n.in&&(i=W(i,ut(n.in,r))),void 0!==n.out&&"in"!==e&&r in n.out&&(i=W(i,ut(n.out,r)))),"directed"!==t&&void 0!==n.undirected&&r in n.undirected&&(i=W(i,ut(n.undirected,r))),i}var wt=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function xt(t,e){if(void 0!==e)for(var n in e)t.add(n)}function Et(t,e,n){if("mixed"!==t){if("undirected"===t)return Object.keys(n.undirected);if("string"==typeof e)return Object.keys(n[e])}var r=new Set;return"undirected"!==t&&("out"!==e&&xt(r,n.in),"in"!==e&&xt(r,n.out)),"directed"!==t&&xt(r,n.undirected),N(r.values(),r.size)}function St(t,e,n){for(var r in e){var i=e[r];i instanceof Set&&(i=i.values().next().value);var s=i.source,o=s===t?i.target:s;n(o.key,o.attributes)}}function At(t,e,n,r){for(var i in n){var s=n[i];s instanceof Set&&(s=s.values().next().value);var o=s.source,a=o===e?s.target:o;t.has(a.key)||(t.add(a.key),r(a.key,a.attributes))}}function Tt(t,e,n){for(var r in e){var i=e[r];i instanceof Set&&(i=i.values().next().value);var s=i.source,o=s===t?i.target:s;if(n(o.key,o.attributes))return!0}return!1}function Ct(t,e,n,r){for(var i in n){var s=n[i];s instanceof Set&&(s=s.values().next().value);var o=s.source,a=o===e?s.target:o;if(!t.has(a.key)&&(t.add(a.key),r(a.key,a.attributes)))return!0}return!1}function It(t,e){var n=Object.keys(e),r=n.length,i=0;return new P(function(){if(i>=r)return{done:!0};var s=e[n[i++]];s instanceof Set&&(s=s.values().next().value);var o=s.source,a=o===t?s.target:o;return{done:!1,value:[a.key,a.attributes]}})}function Dt(t,e,n){var r=Object.keys(n),i=r.length,s=0;return new P(function o(){if(s>=i)return{done:!0};var a=n[r[s++]];a instanceof Set&&(a=a.values().next().value);var u=a.source,c=u===e?a.target:u;return t.has(c.key)?o():(t.add(c.key),{done:!1,value:[c.key,c.attributes]})})}function kt(t,e,n,r,i){var s=t._nodes.get(r);if("undirected"!==e){if("out"!==n&&void 0!==s.in)for(var o in s.in)if(o===i)return!0;if("in"!==n&&void 0!==s.out)for(var a in s.out)if(a===i)return!0}if("directed"!==e&&void 0!==s.undirected)for(var u in s.undirected)if(u===i)return!0;return!1}function Ot(t,e,n){for(var r,i,s,o,a,u,c,l=e._nodes.values(),h=e.type;!0!==(r=l.next()).done;){if(i=r.value,"undirected"!==h)for(s in o=i.out)if(u=(a=o[s]).target,c=n(i.key,u.key,i.attributes,u.attributes,a.key,a.attributes,a.undirected,a.generatedKey),t&&c)return;if("directed"!==h)for(s in o=i.undirected)if((u=(a=o[s]).target).key!==s&&(u=a.source),c=n(i.key,u.key,i.attributes,u.attributes,a.key,a.attributes,a.undirected,a.generatedKey),t&&c)return}}function Mt(t,e,n){for(var r,i,s,o,a,u,c,l,h,d=e._nodes.values(),f=e.type;!0!==(r=d.next()).done;){if(i=r.value,"undirected"!==f)for(s in u=i.out)for(o=u[s].values();!0!==(a=o.next()).done;)if(l=(c=a.value).target,h=n(i.key,l.key,i.attributes,l.attributes,c.key,c.attributes,c.undirected,c.generatedKey),t&&h)return;if("directed"!==f)for(s in u=i.undirected)for(o=u[s].values();!0!==(a=o.next()).done;)if((l=(c=a.value).target).key!==s&&(l=c.source),h=n(i.key,l.key,i.attributes,l.attributes,c.key,c.attributes,c.undirected,c.generatedKey),t&&h)return}}function Pt(t,e){var n={key:t};return d(e.attributes)||(n.attributes=u({},e.attributes)),n}function Nt(t,e){var n={source:e.source.key,target:e.target.key};return e.generatedKey||(n.key=t),d(e.attributes)||(n.attributes=u({},e.attributes)),e.undirected&&(n.undirected=!0),n}function Rt(t){return h(t)?"key"in t?!("attributes"in t)||h(t.attributes)&&null!==t.attributes?null:"invalid-attributes":"no-key":"not-object"}function jt(t){return h(t)?"source"in t?"target"in t?!("attributes"in t)||h(t.attributes)&&null!==t.attributes?"undirected"in t&&"boolean"!=typeof t.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var Lt=new Set(["directed","undirected","mixed"]),Ft=new Set(["domain","_events","_eventsCount","_maxListeners"]),Bt={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function zt(t,e,n){var r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("nodeAdded",{key:e,attributes:n}),r}function Ut(t,e,n,r,i,s,o,a){if(!r&&"undirected"===t.type)throw new F("Graph.".concat(e,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(r&&"directed"===t.type)throw new F("Graph.".concat(e,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(a&&!h(a))throw new j("Graph.".concat(e,': invalid attributes. Expecting an object but got "').concat(a,'"'));if(s=""+s,o=""+o,a=a||{},!t.allowSelfLoops&&s===o)throw new F("Graph.".concat(e,': source & target are the same ("').concat(s,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var u=t._nodes.get(s),c=t._nodes.get(o);if(!u)throw new L("Graph.".concat(e,': source node "').concat(s,'" not found.'));if(!c)throw new L("Graph.".concat(e,': target node "').concat(o,'" not found.'));var l={key:null,undirected:r,source:s,target:o,attributes:a};if(n&&(i=t._edgeKeyGenerator(l)),t._edges.has(i=""+i))throw new F("Graph.".concat(e,': the "').concat(i,'" edge already exists in the graph.'));if(!t.multi&&(r?void 0!==u.undirected[o]:void 0!==u.out[o]))throw new F("Graph.".concat(e,': an edge linking "').concat(s,'" to "').concat(o,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var d=new V(r,i,n,u,c,a);return t._edges.set(i,d),s===o?r?(u.undirectedSelfLoops++,t._undirectedSelfLoopCount++):(u.directedSelfLoops++,t._directedSelfLoopCount++):r?(u.undirectedDegree++,c.undirectedDegree++):(u.outDegree++,c.inDegree++),G(t,r,d,s,o,u,c),r?t._undirectedSize++:t._directedSize++,l.key=i,t.emit("edgeAdded",l),i}function Vt(t,e,n,r,i,s,o,a,c){if(!r&&"undirected"===t.type)throw new F("Graph.".concat(e,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(r&&"directed"===t.type)throw new F("Graph.".concat(e,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(a)if(c){if("function"!=typeof a)throw new j("Graph.".concat(e,': invalid updater function. Expecting a function but got "').concat(a,'"'))}else if(!h(a))throw new j("Graph.".concat(e,': invalid attributes. Expecting an object but got "').concat(a,'"'));var l;if(s=""+s,o=""+o,c&&(l=a,a=void 0),!t.allowSelfLoops&&s===o)throw new F("Graph.".concat(e,': source & target are the same ("').concat(s,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var d,f,p=t._nodes.get(s),g=t._nodes.get(o);if(!n&&(d=t._edges.get(i))){if(d.source.key!==s||d.target.key!==o||r&&(d.source.key!==o||d.target.key!==s))throw new F("Graph.".concat(e,': inconsistency detected when attempting to merge the "').concat(i,'" edge with "').concat(s,'" source & "').concat(o,'" target vs. ("').concat(d.source.key,'", "').concat(d.target.key,'").'));f=d}if(f||t.multi||!p||(f=r?p.undirected[o]:p.out[o]),f)return(c?l:a)?(c?(f.attributes=l(f.attributes),t.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})):(u(f.attributes,a),t.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:a})),f.key):f.key;a=a||{},c&&l&&(a=l(a));var m={key:null,undirected:r,source:s,target:o,attributes:a};if(n&&(i=t._edgeKeyGenerator(m)),t._edges.has(i=""+i))throw new F("Graph.".concat(e,': the "').concat(i,'" edge already exists in the graph.'));return p||(p=zt(t,s,{}),s===o&&(g=p)),g||(g=zt(t,o,{})),d=new V(r,i,n,p,g,a),t._edges.set(i,d),s===o?r?(p.undirectedSelfLoops++,t._undirectedSelfLoopCount++):(p.directedSelfLoops++,t._directedSelfLoopCount++):r?(p.undirectedDegree++,g.undirectedDegree++):(p.outDegree++,g.inDegree++),G(t,r,d,s,o,p,g),r?t._undirectedSize++:t._directedSize++,m.key=i,t.emit("edgeAdded",m),i}var Gt=function(t){function n(e){var n;if(n=t.call(this)||this,(e=u({},Bt,e)).edgeKeyGenerator&&"function"!=typeof e.edgeKeyGenerator)throw new j("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(e.edgeKeyGenerator,'".'));if("boolean"!=typeof e.multi)throw new j("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(e.multi,'".'));if(!Lt.has(e.type))throw new j('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(e.type,'".'));if("boolean"!=typeof e.allowSelfLoops)throw new j("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(e.allowSelfLoops,'".'));var r,i="mixed"===e.type?B:"directed"===e.type?z:U;return f(a(n),"NodeDataClass",i),f(a(n),"_attributes",{}),f(a(n),"_nodes",new Map),f(a(n),"_edges",new Map),f(a(n),"_directedSize",0),f(a(n),"_undirectedSize",0),f(a(n),"_directedSelfLoopCount",0),f(a(n),"_undirectedSelfLoopCount",0),f(a(n),"_edgeKeyGenerator",e.edgeKeyGenerator||(r=0,function(){return r++})),f(a(n),"_options",e),Ft.forEach(function(t){return f(a(n),t,n[t])}),p(a(n),"order",function(){return n._nodes.size}),p(a(n),"size",function(){return n._edges.size}),p(a(n),"directedSize",function(){return n._directedSize}),p(a(n),"undirectedSize",function(){return n._undirectedSize}),p(a(n),"selfLoopCount",function(){return n._directedSelfLoopCount+n._undirectedSelfLoopCount}),p(a(n),"directedSelfLoopCount",function(){return n._directedSelfLoopCount}),p(a(n),"undirectedSelfLoopCount",function(){return n._undirectedSelfLoopCount}),p(a(n),"multi",n._options.multi),p(a(n),"type",n._options.type),p(a(n),"allowSelfLoops",n._options.allowSelfLoops),p(a(n),"implementation",function(){return"graphology"}),n}e(n,t);var r=n.prototype;return r.hasNode=function(t){return this._nodes.has(""+t)},r.hasDirectedEdge=function(t,e){if("undirected"===this.type)return!1;if(1===arguments.length){var n=this._edges.get(""+t);return!!n&&!n.undirected}if(2===arguments.length){e=""+e;var r=this._nodes.get(t=""+t);if(!r)return!1;var i=r.out[e];return!(!i||this.multi&&!i.size)}throw new j("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},r.hasUndirectedEdge=function(t,e){if("directed"===this.type)return!1;if(1===arguments.length){var n=this._edges.get(""+t);return!!n&&n.undirected}if(2===arguments.length){e=""+e;var r=this._nodes.get(t=""+t);if(!r)return!1;var i=r.undirected[e];return!(!i||this.multi&&!i.size)}throw new j("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},r.hasEdge=function(t,e){if(1===arguments.length)return this._edges.has(""+t);if(2===arguments.length){e=""+e;var n=this._nodes.get(t=""+t);if(!n)return!1;var r=void 0!==n.out&&n.out[e];return r||(r=void 0!==n.undirected&&n.undirected[e]),!(!r||this.multi&&!r.size)}throw new j("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},r.directedEdge=function(t,e){if("undirected"!==this.type){if(t=""+t,e=""+e,this.multi)throw new F("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var n=this._nodes.get(t);if(!n)throw new L('Graph.directedEdge: could not find the "'.concat(t,'" source node in the graph.'));if(!this._nodes.has(e))throw new L('Graph.directedEdge: could not find the "'.concat(e,'" target node in the graph.'));var r=n.out&&n.out[e]||void 0;return r?r.key:void 0}},r.undirectedEdge=function(t,e){if("directed"!==this.type){if(t=""+t,e=""+e,this.multi)throw new F("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var n=this._nodes.get(t);if(!n)throw new L('Graph.undirectedEdge: could not find the "'.concat(t,'" source node in the graph.'));if(!this._nodes.has(e))throw new L('Graph.undirectedEdge: could not find the "'.concat(e,'" target node in the graph.'));var r=n.undirected&&n.undirected[e]||void 0;return r?r.key:void 0}},r.edge=function(t,e){if(this.multi)throw new F("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e;var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.edge: could not find the "'.concat(t,'" source node in the graph.'));if(!this._nodes.has(e))throw new L('Graph.edge: could not find the "'.concat(e,'" target node in the graph.'));var r=n.out&&n.out[e]||n.undirected&&n.undirected[e]||void 0;if(r)return r.key},r.inDegree=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof e)throw new j('Graph.inDegree: Expecting a boolean but got "'.concat(e,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.inDegree: could not find the "'.concat(t,'" node in the graph.'));return"undirected"===this.type?0:n.inDegree+(e?n.directedSelfLoops:0)},r.outDegree=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof e)throw new j('Graph.outDegree: Expecting a boolean but got "'.concat(e,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.outDegree: could not find the "'.concat(t,'" node in the graph.'));return"undirected"===this.type?0:n.outDegree+(e?n.directedSelfLoops:0)},r.directedDegree=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof e)throw new j('Graph.directedDegree: Expecting a boolean but got "'.concat(e,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.directedDegree: could not find the "'.concat(t,'" node in the graph.'));if("undirected"===this.type)return 0;var r=e?n.directedSelfLoops:0;return n.inDegree+r+(n.outDegree+r)},r.undirectedDegree=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof e)throw new j('Graph.undirectedDegree: Expecting a boolean but got "'.concat(e,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.undirectedDegree: could not find the "'.concat(t,'" node in the graph.'));return"directed"===this.type?0:n.undirectedDegree+2*(e?n.undirectedSelfLoops:0)},r.degree=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof e)throw new j('Graph.degree: Expecting a boolean but got "'.concat(e,'" for the second parameter (allowing self-loops to be counted).'));var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.degree: could not find the "'.concat(t,'" node in the graph.'));var r=0,i=0;return"directed"!==this.type&&(e&&(i=n.undirectedSelfLoops),r+=n.undirectedDegree+2*i),"undirected"!==this.type&&(e&&(i=n.directedSelfLoops),r+=n.inDegree+n.outDegree+2*i),r},r.source=function(t){var e=this._edges.get(t=""+t);if(!e)throw new L('Graph.source: could not find the "'.concat(t,'" edge in the graph.'));return e.source.key},r.target=function(t){var e=this._edges.get(t=""+t);if(!e)throw new L('Graph.target: could not find the "'.concat(t,'" edge in the graph.'));return e.target.key},r.extremities=function(t){var e=this._edges.get(t=""+t);if(!e)throw new L('Graph.extremities: could not find the "'.concat(t,'" edge in the graph.'));return[e.source.key,e.target.key]},r.opposite=function(t,e){t=""+t;var n=this._edges.get(e=""+e);if(!n)throw new L('Graph.opposite: could not find the "'.concat(e,'" edge in the graph.'));var r=n.source.key,i=n.target.key;if(t!==r&&t!==i)throw new L('Graph.opposite: the "'.concat(t,'" node is not attached to the "').concat(e,'" edge (').concat(r,", ").concat(i,")."));return t===r?i:r},r.hasExtremity=function(t,e){e=""+e;var n=this._edges.get(t=""+t);if(!n)throw new L('Graph.hasExtremity: could not find the "'.concat(t,'" edge in the graph.'));return n.source.key===e||n.target.key===e},r.isUndirected=function(t){var e=this._edges.get(t=""+t);if(!e)throw new L('Graph.isUndirected: could not find the "'.concat(t,'" edge in the graph.'));return e.undirected},r.isDirected=function(t){var e=this._edges.get(t=""+t);if(!e)throw new L('Graph.isDirected: could not find the "'.concat(t,'" edge in the graph.'));return!e.undirected},r.isSelfLoop=function(t){var e=this._edges.get(t=""+t);if(!e)throw new L('Graph.isSelfLoop: could not find the "'.concat(t,'" edge in the graph.'));return e.source===e.target},r.hasGeneratedKey=function(t){var e=this._edges.get(t=""+t);if(!e)throw new L('Graph.hasGeneratedKey: could not find the "'.concat(t,'" edge in the graph.'));return e.generatedKey},r.addNode=function(t,e){return function(t,e,n){if(n&&!h(n))throw new j('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(n,'"'));if(n=n||{},t._nodes.has(e=""+e))throw new F('Graph.addNode: the "'.concat(e,'" node already exist in the graph.'));var r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("nodeAdded",{key:e,attributes:n}),r}(this,t,e).key},r.mergeNode=function(t,e){if(e&&!h(e))throw new j('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(e,'"'));e=e||{};var n=this._nodes.get(t=""+t);return n?(e&&(u(n.attributes,e),this.emit("nodeAttributesUpdated",{type:"merge",key:t,attributes:n.attributes,data:e})),t):(n=new this.NodeDataClass(t,e),this._nodes.set(t,n),this.emit("nodeAdded",{key:t,attributes:e}),t)},r.updateNode=function(t,e){if(e&&"function"!=typeof e)throw new j('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(e,'"'));var n=this._nodes.get(t=""+t);if(n)return e&&(n.attributes=e(n.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:t,attributes:n.attributes})),t;var r=e?e({}):{};return n=new this.NodeDataClass(t,r),this._nodes.set(t,n),this.emit("nodeAdded",{key:t,attributes:r}),t},r.dropNode=function(t){var e=this,n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.dropNode: could not find the "'.concat(t,'" node in the graph.'));this.forEachEdge(t,function(t){e.dropEdge(t)}),this._nodes.delete(t),this.emit("nodeDropped",{key:t,attributes:n.attributes})},r.dropEdge=function(t){var e;if(arguments.length>1){var n=""+arguments[0],r=""+arguments[1];if(!(e=c(this,n,r,this.type)))throw new L('Graph.dropEdge: could not find the "'.concat(n,'" -> "').concat(r,'" edge in the graph.'))}else if(!(e=this._edges.get(t=""+t)))throw new L('Graph.dropEdge: could not find the "'.concat(t,'" edge in the graph.'));this._edges.delete(e.key);var i=e.source,s=e.target,o=e.attributes,a=e.undirected;return i===s?a?(i.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(i.directedSelfLoops--,this._directedSelfLoopCount--):a?(i.undirectedDegree--,s.undirectedDegree--):(i.outDegree--,s.inDegree--),H(this,a,e),a?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:t,attributes:o,source:i.key,target:s.key,undirected:a}),this},r.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},r.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},r.getAttribute=function(t){return this._attributes[t]},r.getAttributes=function(){return this._attributes},r.hasAttribute=function(t){return this._attributes.hasOwnProperty(t)},r.setAttribute=function(t,e){return this._attributes[t]=e,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this},r.updateAttribute=function(t,e){if("function"!=typeof e)throw new j("Graph.updateAttribute: updater should be a function.");return this._attributes[t]=e(this._attributes[t]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this},r.removeAttribute=function(t){return delete this._attributes[t],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:t}),this},r.replaceAttributes=function(t){if(!h(t))throw new j("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=t,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},r.mergeAttributes=function(t){if(!h(t))throw new j("Graph.mergeAttributes: provided attributes are not a plain object.");return u(this._attributes,t),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:t}),this},r.getNodeAttribute=function(t,e){var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.getNodeAttribute: could not find the "'.concat(t,'" node in the graph.'));return n.attributes[e]},r.getNodeAttributes=function(t){var e=this._nodes.get(t=""+t);if(!e)throw new L('Graph.getNodeAttributes: could not find the "'.concat(t,'" node in the graph.'));return e.attributes},r.hasNodeAttribute=function(t,e){var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.hasNodeAttribute: could not find the "'.concat(t,'" node in the graph.'));return n.attributes.hasOwnProperty(e)},r.setNodeAttribute=function(t,e,n){var r=this._nodes.get(t=""+t);if(!r)throw new L('Graph.setNodeAttribute: could not find the "'.concat(t,'" node in the graph.'));if(arguments.length<3)throw new j("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return r.attributes[e]=n,this.emit("nodeAttributesUpdated",{key:t,type:"set",attributes:r.attributes,name:e}),this},r.updateNodeAttribute=function(t,e,n){var r=this._nodes.get(t=""+t);if(!r)throw new L('Graph.updateNodeAttribute: could not find the "'.concat(t,'" node in the graph.'));if(arguments.length<3)throw new j("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof n)throw new j("Graph.updateAttribute: updater should be a function.");var i=r.attributes,s=n(i[e]);return i[e]=s,this.emit("nodeAttributesUpdated",{key:t,type:"set",attributes:r.attributes,name:e}),this},r.removeNodeAttribute=function(t,e){var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.hasNodeAttribute: could not find the "'.concat(t,'" node in the graph.'));return delete n.attributes[e],this.emit("nodeAttributesUpdated",{key:t,type:"remove",attributes:n.attributes,name:e}),this},r.replaceNodeAttributes=function(t,e){var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.replaceNodeAttributes: could not find the "'.concat(t,'" node in the graph.'));if(!h(e))throw new j("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return n.attributes=e,this.emit("nodeAttributesUpdated",{key:t,type:"replace",attributes:n.attributes}),this},r.mergeNodeAttributes=function(t,e){var n=this._nodes.get(t=""+t);if(!n)throw new L('Graph.mergeNodeAttributes: could not find the "'.concat(t,'" node in the graph.'));if(!h(e))throw new j("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return u(n.attributes,e),this.emit("nodeAttributesUpdated",{key:t,type:"merge",attributes:n.attributes,data:e}),this},r.updateEachNodeAttributes=function(t,e){if("function"!=typeof t)throw new j("Graph.updateEachNodeAttributes: expecting an updater function.");if(e&&!g(e))throw new j("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var n,r,i=this._nodes.values();!0!==(n=i.next()).done;)(r=n.value).attributes=t(r.key,r.attributes);this.emit("eachNodeAttributesUpdated",{hints:e||null})},r.updateEachEdgeAttributes=function(t,e){if("function"!=typeof t)throw new j("Graph.updateEachEdgeAttributes: expecting an updater function.");if(e&&!g(e))throw new j("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var n,r,i=this._edges.values();!0!==(n=i.next()).done;)(r=n.value).attributes=t(r.key,r.attributes);this.emit("eachEdgeAttributesUpdated",{hints:e||null})},r.forEach=function(t){if("function"!=typeof t)throw new j("Graph.forEach: expecting a callback.");this.multi?Mt(!1,this,t):Ot(!1,this,t)},r.forEachUntil=function(t){if("function"!=typeof t)throw new j("Graph.forEach: expecting a callback.");this.multi?Mt(!0,this,t):Ot(!0,this,t)},r.adjacency=function(){return this.multi?(s=(t=this)._nodes.values(),o=t.type,a="outer",u=null,new P(function t(){var c;if("outer"===a)return!0===(c=s.next()).done?c:(e=c.value,a="directed",t());if("directed"===a)return"undirected"===o?(a="undirected",t()):(r=e.out,n=Object.keys(e.out),i=0,a="inner-directed",t());if("undirected"===a){if("directed"===o)return a="outer",t();r=e.undirected,n=Object.keys(e.undirected),i=0,a="inner-undirected"}if(!u&&i>=n.length)return a="inner-undirected"===a?"outer":"undirected",t();if(!u){var l=n[i++];return u=r[l].values(),t()}if((c=u.next()).done)return u=null,t();var h=c.value,d=h.target;return"inner-undirected"===a&&d.key===e.key&&(d=h.source),{done:!1,value:[e.key,d.key,e.attributes,d.attributes,h.key,h.attributes]}})):function(t){var e,n,r,i,s=t._nodes.values(),o=t.type,a="outer";return new P(function t(){var u;if("outer"===a)return!0===(u=s.next()).done?u:(e=u.value,a="directed",t());if("directed"===a)return"undirected"===o?(a="undirected",t()):(r=e.out,n=Object.keys(e.out),i=0,a="inner-directed",t());if("undirected"===a){if("directed"===o)return a="outer",t();r=e.undirected,n=Object.keys(e.undirected),i=0,a="inner-undirected"}if(i>=n.length)return a="inner-undirected"===a?"outer":"undirected",t();var c=n[i++],l=r[c],h=l.target;return"inner-undirected"===a&&h.key===e.key&&(h=l.source),{done:!1,value:[e.key,h.key,e.attributes,h.attributes,l.key,l.attributes]}})}(this);var t,e,n,r,i,s,o,a,u},r.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):N(this._nodes.keys(),this._nodes.size)},r.forEachNode=function(t){if("function"!=typeof t)throw new j("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(e,n){t(n,e.attributes)})},r.forEachNodeUntil=function(t){if("function"!=typeof t)throw new j("Graph.forEachNode: expecting a callback.");for(var e,n,r=this._nodes.values();!0!==(e=r.next())&&!t((n=e.value).key,n.attributes););},r.nodeEntries=function(){var t=this._nodes.values();return new P(function(){var e=t.next();if(e.done)return e;var n=e.value;return{value:[n.key,n.attributes],done:!1}})},r.exportNode=function(t){var e=this._nodes.get(t=""+t);if(!e)throw new L('Graph.exportNode: could not find the "'.concat(t,'" node in the graph.'));return Pt(t,e)},r.exportEdge=function(t){var e=this._edges.get(t=""+t);if(!e)throw new L('Graph.exportEdge: could not find the "'.concat(t,'" edge in the graph.'));return Nt(t,e)},r.export=function(){var t=new Array(this._nodes.size),e=0;this._nodes.forEach(function(n,r){t[e++]=Pt(r,n)});var n=new Array(this._edges.size);return e=0,this._edges.forEach(function(t,r){n[e++]=Nt(r,t)}),{attributes:this.getAttributes(),nodes:t,edges:n,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},r.importNode=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Rt(t);if(n){if("not-object"===n)throw new j('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===n)throw new j("Graph.importNode: no key provided.");if("invalid-attributes"===n)throw new j("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var r=t.key,i=t.attributes,s=void 0===i?{}:i;return e?this.mergeNode(r,s):this.addNode(r,s),this},r.importEdge=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=jt(t);if(n){if("not-object"===n)throw new j('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===n)throw new j("Graph.importEdge: missing souce.");if("no-target"===n)throw new j("Graph.importEdge: missing target.");if("invalid-attributes"===n)throw new j("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===n)throw new j("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var r=t.source,i=t.target,s=t.attributes,o=void 0===s?{}:s,a=t.undirected,u=void 0!==a&&a;return"key"in t?(e?u?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:u?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,t.key,r,i,o):(e?u?this.mergeUndirectedEdge:this.mergeDirectedEdge:u?this.addUndirectedEdge:this.addDirectedEdge).call(this,r,i,o),this},r.import=function(t){var e,n,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(l(t))return this.import(t.export(),i),this;if(!h(t))throw new j("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(t.attributes){if(!h(t.attributes))throw new j("Graph.import: invalid attributes. Expecting a plain object.");i?this.mergeAttributes(t.attributes):this.replaceAttributes(t.attributes)}if(t.nodes){if(r=t.nodes,!Array.isArray(r))throw new j("Graph.import: invalid nodes. Expecting an array.");for(e=0,n=r.length;e<n;e++)this.importNode(r[e],i)}if(t.edges){if(r=t.edges,!Array.isArray(r))throw new j("Graph.import: invalid edges. Expecting an array.");for(e=0,n=r.length;e<n;e++)this.importEdge(r[e],i)}return this},r.nullCopy=function(t){return new n(u({},this._options,t))},r.emptyCopy=function(t){var e=this.nullCopy(t);return this._nodes.forEach(function(t,n){var r=u({},t.attributes);t=new e.NodeDataClass(n,r),e._nodes.set(n,t)}),e},r.copy=function(){var t=new n(this._options);return t.import(this),t},r.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(t){return t.upgradeToMixed()}),this._options.type="mixed",p(this,"type",this._options.type),f(this,"NodeDataClass",B)),this},r.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,p(this,"multi",!0),(t=this)._nodes.forEach(function(e,n){if(e.out)for(var r in e.out){var i=new Set;i.add(e.out[r]),e.out[r]=i,t._nodes.get(r).in[n]=i}if(e.undirected)for(var s in e.undirected)if(!(s>n)){var o=new Set;o.add(e.undirected[s]),e.undirected[s]=o,t._nodes.get(s).undirected[n]=o}})),this;var t},r.clearIndex=function(){return this._nodes.forEach(function(t){void 0!==t.in&&(t.in={},t.out={}),void 0!==t.undirected&&(t.undirected={})}),this},r.toJSON=function(){return this.export()},r.toString=function(){return"[object Graph]"},r.inspect=function(){var t=this,e={};this._nodes.forEach(function(t,n){e[n]=t.attributes});var n={},r={};this._edges.forEach(function(e,i){var s=e.undirected?"--":"->",o="",a="(".concat(e.source.key,")").concat(s,"(").concat(e.target.key,")");e.generatedKey?t.multi&&(void 0===r[a]?r[a]=0:r[a]++,o+="".concat(r[a],". ")):o+="[".concat(i,"]: "),n[o+=a]=e.attributes});var i={};for(var s in this)this.hasOwnProperty(s)&&!Ft.has(s)&&"function"!=typeof this[s]&&(i[s]=this[s]);return i.attributes=this._attributes,i.nodes=e,i.edges=n,f(i,"constructor",this.constructor),i},n}(y.exports.EventEmitter);"undefined"!=typeof Symbol&&(Gt.prototype[Symbol.for("nodejs.util.inspect.custom")]=Gt.prototype.inspect),[{name:function(t){return"".concat(t,"Edge")},generateKey:!0},{name:function(t){return"".concat(t,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(t){return"".concat(t,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(t){return"".concat(t,"EdgeWithKey")}},{name:function(t){return"".concat(t,"DirectedEdgeWithKey")},type:"directed"},{name:function(t){return"".concat(t,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(t){["add","merge","update"].forEach(function(e){var n=t.name(e),r="add"===e?Ut:Vt;Gt.prototype[n]=t.generateKey?function(i,s,o){return r(this,n,!0,"undirected"===(t.type||this.type),null,i,s,o,"update"===e)}:function(i,s,o,a){return r(this,n,!1,"undirected"===(t.type||this.type),i,s,o,a,"update"===e)}})}),"undefined"!=typeof Symbol&&(Gt.prototype[Symbol.iterator]=Gt.prototype.adjacency),function(t){$.forEach(function(e){var n=e.name,r=e.attacher;r(t,n("Edge"),"mixed"),r(t,n("DirectedEdge"),"directed"),r(t,n("UndirectedEdge"),"undirected")})}(Gt),function(t){X.forEach(function(e){!function(t,e){var n=e.name,r=e.type,i=e.direction;t.prototype[n]=function(t,e){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return[];if(!arguments.length)return ct(this,r);if(1===arguments.length){var s=this._nodes.get(t=""+t);if(void 0===s)throw new L("Graph.".concat(n,': could not find the "').concat(t,'" node in the graph.'));return ft(this.multi,"mixed"===r?this.type:r,i,s)}if(2===arguments.length){e=""+e;var o=this._nodes.get(t=""+t);if(!o)throw new L("Graph.".concat(n,':  could not find the "').concat(t,'" source node in the graph.'));if(!this._nodes.has(e))throw new L("Graph.".concat(n,':  could not find the "').concat(e,'" target node in the graph.'));return yt(r,this.multi,i,o,e)}throw new j("Graph.".concat(n,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(t,e),function(t,e){var n=e.name,r=e.type,i=e.direction,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(t,e,n){if("mixed"===r||"mixed"===this.type||r===this.type){if(1===arguments.length)return lt(this,r,n=t);if(2===arguments.length){n=e;var o=this._nodes.get(t=""+t);if(void 0===o)throw new L("Graph.".concat(s,': could not find the "').concat(t,'" node in the graph.'));return pt(this.multi,"mixed"===r?this.type:r,i,o,n)}if(3===arguments.length){e=""+e;var a=this._nodes.get(t=""+t);if(!a)throw new L("Graph.".concat(s,':  could not find the "').concat(t,'" source node in the graph.'));if(!this._nodes.has(e))throw new L("Graph.".concat(s,':  could not find the "').concat(e,'" target node in the graph.'));return bt(r,this.multi,i,a,e,n)}throw new j("Graph.".concat(s,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(t,e),function(t,e){var n=e.name,r=e.type,i=e.direction,s="forEach"+n[0].toUpperCase()+n.slice(1,-1)+"Until";t.prototype[s]=function(t,e,n){if("mixed"===r||"mixed"===this.type||r===this.type){if(1===arguments.length)return ht(this,r,n=t);if(2===arguments.length){n=e;var o=this._nodes.get(t=""+t);if(void 0===o)throw new L("Graph.".concat(s,': could not find the "').concat(t,'" node in the graph.'));return gt(this.multi,"mixed"===r?this.type:r,i,o,n)}if(3===arguments.length){e=""+e;var a=this._nodes.get(t=""+t);if(!a)throw new L("Graph.".concat(s,':  could not find the "').concat(t,'" source node in the graph.'));if(!this._nodes.has(e))throw new L("Graph.".concat(s,':  could not find the "').concat(e,'" target node in the graph.'));return _t(r,this.multi,i,a,e,n)}throw new j("Graph.".concat(s,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(t,e),function(t,e){var n=e.type,r=e.direction,i=e.name.slice(0,-1)+"Entries";t.prototype[i]=function(t,e){if("mixed"!==n&&"mixed"!==this.type&&n!==this.type)return P.empty();if(!arguments.length)return dt(this,n);if(1===arguments.length){var s=this._nodes.get(t=""+t);if(!s)throw new L("Graph.".concat(i,': could not find the "').concat(t,'" node in the graph.'));return mt(n,r,s)}if(2===arguments.length){e=""+e;var o=this._nodes.get(t=""+t);if(!o)throw new L("Graph.".concat(i,':  could not find the "').concat(t,'" source node in the graph.'));if(!this._nodes.has(e))throw new L("Graph.".concat(i,':  could not find the "').concat(e,'" target node in the graph.'));return vt(n,r,o,e)}throw new j("Graph.".concat(i,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(t,e)})}(Gt),function(t){wt.forEach(function(e){!function(t,e){var n=e.name,r=e.type,i=e.direction;t.prototype[n]=function(t){if("mixed"!==r&&"mixed"!==this.type&&r!==this.type)return[];if(2===arguments.length){var e=""+arguments[0],s=""+arguments[1];if(!this._nodes.has(e))throw new L("Graph.".concat(n,': could not find the "').concat(e,'" node in the graph.'));if(!this._nodes.has(s))throw new L("Graph.".concat(n,': could not find the "').concat(s,'" node in the graph.'));return kt(this,r,i,e,s)}if(1===arguments.length){var o=this._nodes.get(t=""+t);if(void 0===o)throw new L("Graph.".concat(n,': could not find the "').concat(t,'" node in the graph.'));return Et("mixed"===r?this.type:r,i,o)}throw new j("Graph.".concat(n,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))}}(t,e),function(t,e){var n=e.name,r=e.type,i=e.direction,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(t,e){if("mixed"===r||"mixed"===this.type||r===this.type){var n=this._nodes.get(t=""+t);if(void 0===n)throw new L("Graph.".concat(s,': could not find the "').concat(t,'" node in the graph.'));!function(t,e,n,r){if("mixed"!==t){if("undirected"===t)return St(n,n.undirected,r);if("string"==typeof e)return St(n,n[e],r)}var i=new Set;"undirected"!==t&&("out"!==e&&At(i,n,n.in,r),"in"!==e&&At(i,n,n.out,r)),"directed"!==t&&At(i,n,n.undirected,r)}("mixed"===r?this.type:r,i,n,e)}}}(t,e),function(t,e){var n=e.name,r=e.type,i=e.direction,s="forEach"+n[0].toUpperCase()+n.slice(1,-1)+"Until";t.prototype[s]=function(t,e){if("mixed"===r||"mixed"===this.type||r===this.type){var n=this._nodes.get(t=""+t);if(void 0===n)throw new L("Graph.".concat(s,': could not find the "').concat(t,'" node in the graph.'));!function(t,e,n,r){if("mixed"!==t){if("undirected"===t)return Tt(n,n.undirected,r);if("string"==typeof e)return Tt(n,n[e],r)}var i=new Set;if("undirected"!==t){if("out"!==e&&Ct(i,n,n.in,r))return;if("in"!==e&&Ct(i,n,n.out,r))return}"directed"===t||Ct(i,n,n.undirected,r)}("mixed"===r?this.type:r,i,n,e)}}}(t,e),function(t,e){var n=e.type,r=e.direction,i=e.name.slice(0,-1)+"Entries";t.prototype[i]=function(t){if("mixed"!==n&&"mixed"!==this.type&&n!==this.type)return P.empty();var e=this._nodes.get(t=""+t);if(void 0===e)throw new L("Graph.".concat(i,': could not find the "').concat(t,'" node in the graph.'));return function(t,e,n){if("mixed"!==t){if("undirected"===t)return It(n,n.undirected);if("string"==typeof e)return It(n,n[e])}var r=P.empty(),i=new Set;return"undirected"!==t&&("out"!==e&&(r=W(r,Dt(i,n,n.in))),"in"!==e&&(r=W(r,Dt(i,n,n.out)))),"directed"!==t&&(r=W(r,Dt(i,n,n.undirected))),r}("mixed"===n?this.type:n,r,e)}}(t,e)})}(Gt);var Ht=function(t){function n(e){var n=u({type:"directed"},e);if("multi"in n&&!1!==n.multi)throw new j("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==n.type)throw new j('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return t.call(this,n)||this}return e(n,t),n}(Gt),$t=function(t){function n(e){var n=u({type:"undirected"},e);if("multi"in n&&!1!==n.multi)throw new j("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==n.type)throw new j('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return t.call(this,n)||this}return e(n,t),n}(Gt),qt=function(t){function n(e){var n=u({multi:!0},e);if("multi"in n&&!0!==n.multi)throw new j("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return t.call(this,n)||this}return e(n,t),n}(Gt),Wt=function(t){function n(e){var n=u({type:"directed",multi:!0},e);if("multi"in n&&!0!==n.multi)throw new j("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==n.type)throw new j('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return t.call(this,n)||this}return e(n,t),n}(Gt),Xt=function(t){function n(e){var n=u({type:"undirected",multi:!0},e);if("multi"in n&&!0!==n.multi)throw new j("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==n.type)throw new j('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');return t.call(this,n)||this}return e(n,t),n}(Gt);function Kt(t){t.from=function(e,n){var r=u({},e.options,n),i=new t(r);return i.import(e),i}}return Kt(Gt),Kt(Ht),Kt($t),Kt(qt),Kt(Wt),Kt(Xt),Gt.Graph=Gt,Gt.DirectedGraph=Ht,Gt.UndirectedGraph=$t,Gt.MultiGraph=qt,Gt.MultiDirectedGraph=Wt,Gt.MultiUndirectedGraph=Xt,Gt.InvalidArgumentsGraphError=j,Gt.NotFoundGraphError=L,Gt.UsageGraphError=F,Gt}()},524:(t,e,n)=>{var r;!function(i,s,o,a){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=s.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(t,e,n){return setTimeout(w(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=i.console&&(i.console.warn||i.console.log);return s&&s.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var b=y(function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===a)&&(t[r[i]]=e[r[i]]),i++;return t},"extend","Use `assign`."),_=y(function(t,e){return b(t,e,!0)},"merge","Use `assign`.");function v(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function w(t,e){return function(){return t.apply(e,arguments)}}function x(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function E(t,e){return t===a?e:t}function S(t,e,n){m(I(e),function(e){t.addEventListener(e,n,!1)})}function A(t,e,n){m(I(e),function(e){t.removeEventListener(e,n,!1)})}function T(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function C(t,e){return t.indexOf(e)>-1}function I(t){return t.trim().split(/\s+/g)}function D(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function k(t){return Array.prototype.slice.call(t,0)}function O(t,e,n){for(var r=[],i=[],s=0;s<t.length;){var o=e?t[s][e]:t[s];D(i,o)<0&&r.push(t[s]),i[s]=o,s++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function M(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),s=0;s<c.length;){if((r=(n=c[s])?n+i:e)in t)return r;s++}return a}var P=1;function N(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var R="ontouchstart"in i,j=M(i,"PointerEvent")!==a,L=R&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F="touch",B="mouse",z=["x","y"],U=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){x(t.options.enable,[t])&&n.handler(e)},this.init()}function G(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,s=1&e&&r-i==0,o=12&e&&r-i==0;n.isFirst=!!s,n.isFinal=!!o,s&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=H(e)),i>1&&!n.firstMultiple?n.firstMultiple=H(e):1===i&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,u=o?o.center:s.center,c=e.center=$(r);e.timeStamp=f(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=K(u,c),e.distance=X(u,c),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},s=t.prevInput||{};1!==e.eventType&&4!==s.eventType||(i=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=W(e.deltaX,e.deltaY);var l,h,p=q(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=p.x,e.overallVelocityY=p.y,e.overallVelocity=d(p.x)>d(p.y)?p.x:p.y,e.scale=o?(l=o.pointers,X((h=r)[0],h[1],U)/X(l[0],l[1],U)):1,e.rotation=o?function(t,e){return K(e[1],e[0],U)+K(t[1],t[0],U)}(o.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,s,o=t.lastInterval||e,u=e.timeStamp-o.timeStamp;if(8!=e.eventType&&(u>25||o.velocity===a)){var c=e.deltaX-o.deltaX,l=e.deltaY-o.deltaY,h=q(u,c,l);r=h.x,i=h.y,n=d(h.x)>d(h.y)?h.x:h.y,s=W(c,l),t.lastInterval=e}else n=o.velocity,r=o.velocityX,i=o.velocityY,s=o.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=s}(n,e);var g=t.element;T(e.srcEvent.target,g)&&(g=e.srcEvent.target),e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function H(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:$(e),deltaX:t.deltaX,deltaY:t.deltaY}}function $(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:h(n/e),y:h(r/e)}}function q(t,e,n){return{x:e/t||0,y:n/t||0}}function W(t,e){return t===e?1:d(t)>=d(e)?t<0?2:4:e<0?8:16}function X(t,e,n){n||(n=z);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function K(t,e,n){return n||(n=z),180*Math.atan2(e[n[1]]-t[n[1]],e[n[0]]-t[n[0]])/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(N(this.element),this.evWin,this.domHandler)}};var Z={mousedown:1,mousemove:2,mouseup:4},Y="mousedown",Q="mousemove mouseup";function J(){this.evEl=Y,this.evWin=Q,this.pressed=!1,V.apply(this,arguments)}v(J,V,{handler:function(t){var e=Z[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:B,srcEvent:t}))}});var tt={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},et={2:F,3:"pen",4:B,5:"kinect"},nt="pointerdown",rt="pointermove pointerup pointercancel";function it(){this.evEl=nt,this.evWin=rt,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(nt="MSPointerDown",rt="MSPointerMove MSPointerUp MSPointerCancel"),v(it,V,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=tt[r],s=et[t.pointerType]||t.pointerType,o=s==F,a=D(e,t.pointerId,"pointerId");1&i&&(0===t.button||o)?a<0&&(e.push(t),a=e.length-1):12&i&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),n&&e.splice(a,1))}});var st={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ot="touchstart",at="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=ot,this.evWin=at,this.started=!1,V.apply(this,arguments)}function ct(t,e){var n=k(t.touches),r=k(t.changedTouches);return 12&e&&(n=O(n.concat(r),"identifier",!0)),[n,r]}v(ut,V,{handler:function(t){var e=st[t.type];if(1===e&&(this.started=!0),this.started){var n=ct.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:t})}}});var lt={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ht="touchstart touchmove touchend touchcancel";function dt(){this.evTarget=ht,this.targetIds={},V.apply(this,arguments)}function ft(t,e){var n=k(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,s,o=k(t.changedTouches),a=[],u=this.target;if(s=n.filter(function(t){return T(t.target,u)}),1===e)for(i=0;i<s.length;)r[s[i].identifier]=!0,i++;for(i=0;i<o.length;)r[o[i].identifier]&&a.push(o[i]),12&e&&delete r[o[i].identifier],i++;return a.length?[O(s.concat(a),"identifier",!0),a]:void 0}function pt(){V.apply(this,arguments);var t=w(this.handler,this);this.touch=new dt(this.manager,t),this.mouse=new J(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function gt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,mt.call(this,e)):12&t&&mt.call(this,e)}function mt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)},2500)}}function yt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],s=Math.abs(e-i.x),o=Math.abs(n-i.y);if(s<=25&&o<=25)return!0}return!1}v(dt,V,{handler:function(t){var e=lt[t.type],n=ft.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:F,srcEvent:t})}}),v(pt,V,{handler:function(t,e,n){var r=n.pointerType==B;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(n.pointerType==F)gt.call(this,e,n);else if(r&&yt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var bt=M(l.style,"touchAction"),_t=bt!==a,vt="compute",wt="auto",xt="manipulation",Et="none",St="pan-x",At="pan-y",Tt=function(){if(!_t)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){t[n]=!e||i.CSS.supports("touch-action",n)}),t}();function Ct(t,e){this.manager=t,this.set(e)}Ct.prototype={set:function(t){t==vt&&(t=this.compute()),_t&&this.manager.element.style&&Tt[t]&&(this.manager.element.style[bt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,function(e){x(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(C(t,Et))return Et;var e=C(t,St),n=C(t,At);return e&&n?Et:e||n?e?St:At:C(t,xt)?xt:wt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=C(r,Et)&&!Tt.none,s=C(r,At)&&!Tt["pan-y"],o=C(r,St)&&!Tt["pan-x"];if(i&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!o||!s)return i||s&&6&n||o&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var It=32;function Dt(t){this.options=u({},this.defaults,t||{}),this.id=P++,this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function kt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Ot(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Mt(t,e){var n=e.manager;return n?n.get(t):t}function Pt(){Dt.apply(this,arguments)}function Nt(){Pt.apply(this,arguments),this.pX=null,this.pY=null}function Rt(){Pt.apply(this,arguments)}function jt(){Dt.apply(this,arguments),this._timer=null,this._input=null}function Lt(){Pt.apply(this,arguments)}function Ft(){Pt.apply(this,arguments)}function Bt(){Dt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function zt(t,e){return(e=e||{}).recognizers=E(e.recognizers,zt.defaults.preset),new Ut(t,e)}function Ut(t,e){this.options=u({},zt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(j?it:L?dt:R?pt:J))(this,G),this.touchAction=new Ct(this,this.options.touchAction),Vt(this,!0),m(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function Vt(t,e){var n,r=t.element;r.style&&(m(t.options.cssProps,function(i,s){n=M(r.style,s),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""}),e||(t.oldCssProps={}))}Dt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Mt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=Mt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===D(e,t=Mt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Mt(t,this);var e=D(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+kt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+kt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=It},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!x(this.options.enable,[this,e]))return this.reset(),void(this.state=It);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},v(Pt,Dt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:It}}),v(Nt,Pt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(At),24&t&&e.push(St),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,s=t.deltaX,o=t.deltaY;return i&e.direction||(6&e.direction?(i=0===s?1:s<0?2:4,n=s!=this.pX,r=Math.abs(t.deltaX)):(i=0===o?1:o<0?8:16,n=o!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Pt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Ot(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),v(Rt,Pt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Et]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){1!==t.scale&&(t.additionalEvent=this.options.event+(t.scale<1?"in":"out")),this._super.emit.call(this,t)}}),v(jt,Dt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=p(function(){this.state=8,this.tryEmit()},e.time,this);else if(4&t.eventType)return 8;return It},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),v(Lt,Pt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Et]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),v(Ft,Pt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Nt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Ot(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),v(Bt,Dt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<e.interval,o=!this.pCenter||X(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,o&&s?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=p(function(){this.state=8,this.tryEmit()},e.interval,this),2):8}return It},failTimeout:function(){return this._timer=p(function(){this.state=It},this.options.interval,this),It},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),zt.VERSION="2.0.7",zt.defaults={domEvents:!1,touchAction:vt,enable:!0,inputTarget:null,inputClass:null,preset:[[Lt,{enable:!1}],[Rt,{enable:!1},["rotate"]],[Ft,{direction:6}],[Nt,{direction:6},["swipe"]],[Bt],[Bt,{event:"doubletap",taps:2},["tap"]],[jt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ut.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var s=0;s<r.length;)n=r[s],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),s++}},get:function(t){if(t instanceof Dt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=D(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return m(I(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(t!==a){var n=this.handlers;return m(I(t),function(t){e?n[t]&&n[t].splice(D(n[t],e),1):delete n[t]}),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=s.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Vt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(zt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:It,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ut,Input:V,TouchAction:Ct,TouchInput:dt,MouseInput:J,PointerEventInput:it,TouchMouseInput:pt,SingleTouchInput:ut,Recognizer:Dt,AttrRecognizer:Pt,Tap:Bt,Pan:Nt,Swipe:Ft,Pinch:Rt,Rotate:Lt,Press:jt,on:S,off:A,each:m,merge:_,extend:b,assign:u,inherit:v,bindFn:w,prefixed:M}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=zt,(r=(function(){return zt}).call(e,n,e,t))===a||(t.exports=r)}(window,document)},815:function(t,e,n){var r;t=n.nmd(t),(function(){var i,s="Expected a function",o="__lodash_hash_undefined__",a="__lodash_placeholder__",u=32,c=128,l=1/0,h=9007199254740991,d=NaN,f=4294967295,p=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",u],["partialRight",64],["rearg",256]],g="[object Arguments]",m="[object Array]",y="[object Boolean]",b="[object Date]",_="[object Error]",v="[object Function]",w="[object GeneratorFunction]",x="[object Map]",E="[object Number]",S="[object Object]",A="[object Promise]",T="[object RegExp]",C="[object Set]",I="[object String]",D="[object Symbol]",k="[object WeakMap]",O="[object ArrayBuffer]",M="[object DataView]",P="[object Float32Array]",N="[object Float64Array]",R="[object Int8Array]",j="[object Int16Array]",L="[object Int32Array]",F="[object Uint8Array]",B="[object Uint8ClampedArray]",z="[object Uint16Array]",U="[object Uint32Array]",V=/\b__p \+= '';/g,G=/\b(__p \+=) '' \+/g,H=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$=/&(?:amp|lt|gt|quot|#39);/g,q=/[&<>"']/g,W=RegExp($.source),X=RegExp(q.source),K=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,Y=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),rt=/^\s+/,it=/\s/,st=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ot=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,ut=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ct=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dt=/\w*$/,ft=/^[-+]0x[0-9a-f]+$/i,pt=/^0b[01]+$/i,gt=/^\[object .+?Constructor\]$/,mt=/^0o[0-7]+$/i,yt=/^(?:0|[1-9]\d*)$/,bt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,vt=/['\n\r\u2028\u2029\\]/g,wt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",xt="a-z\\xdf-\\xf6\\xf8-\\xff",Et="A-Z\\xc0-\\xd6\\xd8-\\xde",St="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",At="["+St+"]",Tt="["+wt+"]",Ct="\\d+",It="["+xt+"]",Dt="[^\\ud800-\\udfff"+St+Ct+"\\u2700-\\u27bf"+xt+Et+"]",kt="\\ud83c[\\udffb-\\udfff]",Ot="[^\\ud800-\\udfff]",Mt="(?:\\ud83c[\\udde6-\\uddff]){2}",Pt="[\\ud800-\\udbff][\\udc00-\\udfff]",Nt="["+Et+"]",Rt="(?:"+It+"|"+Dt+")",jt="(?:"+Nt+"|"+Dt+")",Lt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Ft="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Bt="(?:"+Tt+"|"+kt+")?",zt="[\\ufe0e\\ufe0f]?",Ut=zt+Bt+"(?:\\u200d(?:"+[Ot,Mt,Pt].join("|")+")"+zt+Bt+")*",Vt="(?:"+["[\\u2700-\\u27bf]",Mt,Pt].join("|")+")"+Ut,Gt="(?:"+[Ot+Tt+"?",Tt,Mt,Pt,"[\\ud800-\\udfff]"].join("|")+")",Ht=RegExp("['\u2019]","g"),$t=RegExp(Tt,"g"),qt=RegExp(kt+"(?="+kt+")|"+Gt+Ut,"g"),Wt=RegExp([Nt+"?"+It+"+"+Lt+"(?="+[At,Nt,"$"].join("|")+")",jt+"+"+Ft+"(?="+[At,Nt+Rt,"$"].join("|")+")",Nt+"?"+Rt+"+"+Lt,Nt+"+"+Ft,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ct,Vt].join("|"),"g"),Xt=RegExp("[\\u200d\\ud800-\\udfff"+wt+"\\ufe0e\\ufe0f]"),Kt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Zt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Yt=-1,Qt={};Qt[P]=Qt[N]=Qt[R]=Qt[j]=Qt[L]=Qt[F]=Qt[B]=Qt[z]=Qt[U]=!0,Qt[g]=Qt[m]=Qt[O]=Qt[y]=Qt[M]=Qt[b]=Qt[_]=Qt[v]=Qt[x]=Qt[E]=Qt[S]=Qt[T]=Qt[C]=Qt[I]=Qt[k]=!1;var Jt={};Jt[g]=Jt[m]=Jt[O]=Jt[M]=Jt[y]=Jt[b]=Jt[P]=Jt[N]=Jt[R]=Jt[j]=Jt[L]=Jt[x]=Jt[E]=Jt[S]=Jt[T]=Jt[C]=Jt[I]=Jt[D]=Jt[F]=Jt[B]=Jt[z]=Jt[U]=!0,Jt[_]=Jt[v]=Jt[k]=!1;var te={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ee=parseFloat,ne=parseInt,re="object"==typeof global&&global&&global.Object===Object&&global,ie="object"==typeof self&&self&&self.Object===Object&&self,se=re||ie||Function("return this")(),oe=e&&!e.nodeType&&e,ae=oe&&t&&!t.nodeType&&t,ue=ae&&ae.exports===oe,ce=ue&&re.process,le=function(){try{return ae&&ae.require&&ae.require("util").types||ce&&ce.binding&&ce.binding("util")}catch(t){}}(),he=le&&le.isArrayBuffer,de=le&&le.isDate,fe=le&&le.isMap,pe=le&&le.isRegExp,ge=le&&le.isSet,me=le&&le.isTypedArray;function ye(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function be(t,e,n,r){for(var i=-1,s=null==t?0:t.length;++i<s;){var o=t[i];e(r,o,n(o),t)}return r}function _e(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function ve(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function we(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function xe(t,e){for(var n=-1,r=null==t?0:t.length,i=0,s=[];++n<r;){var o=t[n];e(o,n,t)&&(s[i++]=o)}return s}function Ee(t,e){return!(null==t||!t.length)&&Pe(t,e,0)>-1}function Se(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Ae(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Te(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Ce(t,e,n,r){var i=-1,s=null==t?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}function Ie(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function De(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var ke=Le("length");function Oe(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function Me(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}function Pe(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):Me(t,Re,n)}function Ne(t,e,n,r){for(var i=n-1,s=t.length;++i<s;)if(r(t[i],e))return i;return-1}function Re(t){return t!=t}function je(t,e){var n=null==t?0:t.length;return n?ze(t,e)/n:d}function Le(t){return function(e){return null==e?i:e[t]}}function Fe(t){return function(e){return null==t?i:t[e]}}function Be(t,e,n,r,i){return i(t,function(t,i,s){n=r?(r=!1,t):e(n,t,i,s)}),n}function ze(t,e){for(var n,r=-1,s=t.length;++r<s;){var o=e(t[r]);o!==i&&(n=n===i?o:n+o)}return n}function Ue(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ve(t){return t?t.slice(0,an(t)+1).replace(rt,""):t}function Ge(t){return function(e){return t(e)}}function He(t,e){return Ae(e,function(e){return t[e]})}function $e(t,e){return t.has(e)}function qe(t,e){for(var n=-1,r=t.length;++n<r&&Pe(e,t[n],0)>-1;);return n}function We(t,e){for(var n=t.length;n--&&Pe(e,t[n],0)>-1;);return n}function Xe(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var Ke=Fe({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),Ze=Fe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ye(t){return"\\"+te[t]}function Qe(t){return Xt.test(t)}function Je(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function tn(t,e){return function(n){return t(e(n))}}function en(t,e){for(var n=-1,r=t.length,i=0,s=[];++n<r;){var o=t[n];o!==e&&o!==a||(t[n]=a,s[i++]=n)}return s}function nn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function rn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function sn(t){return Qe(t)?function(t){for(var e=qt.lastIndex=0;qt.test(t);)++e;return e}(t):ke(t)}function on(t){return Qe(t)?function(t){return t.match(qt)||[]}(t):function(t){return t.split("")}(t)}function an(t){for(var e=t.length;e--&&it.test(t.charAt(e)););return e}var un=Fe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),cn=function t(e){var n,r=(e=null==e?se:cn.defaults(se.Object(),e,cn.pick(se,Zt))).Array,it=e.Date,wt=e.Error,xt=e.Function,Et=e.Math,St=e.Object,At=e.RegExp,Tt=e.String,Ct=e.TypeError,It=r.prototype,Dt=St.prototype,kt=e["__core-js_shared__"],Ot=xt.prototype.toString,Mt=Dt.hasOwnProperty,Pt=0,Nt=(n=/[^.]+$/.exec(kt&&kt.keys&&kt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Rt=Dt.toString,jt=Ot.call(St),Lt=se._,Ft=At("^"+Ot.call(Mt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bt=ue?e.Buffer:i,zt=e.Symbol,Ut=e.Uint8Array,Vt=Bt?Bt.allocUnsafe:i,Gt=tn(St.getPrototypeOf,St),qt=St.create,Xt=Dt.propertyIsEnumerable,te=It.splice,re=zt?zt.isConcatSpreadable:i,ie=zt?zt.iterator:i,oe=zt?zt.toStringTag:i,ae=function(){try{var t=us(St,"defineProperty");return t({},"",{}),t}catch(e){}}(),ce=e.clearTimeout!==se.clearTimeout&&e.clearTimeout,le=it&&it.now!==se.Date.now&&it.now,ke=e.setTimeout!==se.setTimeout&&e.setTimeout,Fe=Et.ceil,ln=Et.floor,hn=St.getOwnPropertySymbols,dn=Bt?Bt.isBuffer:i,fn=e.isFinite,pn=It.join,gn=tn(St.keys,St),mn=Et.max,yn=Et.min,bn=it.now,_n=e.parseInt,vn=Et.random,wn=It.reverse,xn=us(e,"DataView"),En=us(e,"Map"),Sn=us(e,"Promise"),An=us(e,"Set"),Tn=us(e,"WeakMap"),Cn=us(St,"create"),In=Tn&&new Tn,Dn={},kn=Ls(xn),On=Ls(En),Mn=Ls(Sn),Pn=Ls(An),Nn=Ls(Tn),Rn=zt?zt.prototype:i,jn=Rn?Rn.valueOf:i,Ln=Rn?Rn.toString:i;function Fn(t){if(ea(t)&&!Ho(t)&&!(t instanceof Vn)){if(t instanceof Un)return t;if(Mt.call(t,"__wrapped__"))return Fs(t)}return new Un(t)}var Bn=function(){function t(){}return function(e){if(!ta(e))return{};if(qt)return qt(e);t.prototype=e;var n=new t;return t.prototype=i,n}}();function zn(){}function Un(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}function Vn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function Gn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Hn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function $n(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function qn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new $n;++e<n;)this.add(t[e])}function Wn(t){var e=this.__data__=new Hn(t);this.size=e.size}function Xn(t,e){var n=Ho(t),r=!n&&Go(t),i=!n&&!r&&Xo(t),s=!n&&!r&&!i&&ca(t),o=n||r||i||s,a=o?Ue(t.length,Tt):[],u=a.length;for(var c in t)!e&&!Mt.call(t,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||gs(c,u))||a.push(c);return a}function Kn(t){var e=t.length;return e?t[$r(0,e-1)]:i}function Zn(t,e){return Ms(Ti(t),sr(e,0,t.length))}function Yn(t){return Ms(Ti(t))}function Qn(t,e,n){(n!==i&&!zo(t[e],n)||n===i&&!(e in t))&&rr(t,e,n)}function Jn(t,e,n){var r=t[e];Mt.call(t,e)&&zo(r,n)&&(n!==i||e in t)||rr(t,e,n)}function tr(t,e){for(var n=t.length;n--;)if(zo(t[n][0],e))return n;return-1}function er(t,e,n,r){return lr(t,function(t,i,s){e(r,t,n(t),s)}),r}function nr(t,e){return t&&Ci(e,Oa(e),t)}function rr(t,e,n){"__proto__"==e&&ae?ae(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ir(t,e){for(var n=-1,s=e.length,o=r(s),a=null==t;++n<s;)o[n]=a?i:Ta(t,e[n]);return o}function sr(t,e,n){return t==t&&(n!==i&&(t=t<=n?t:n),e!==i&&(t=t>=e?t:e)),t}function or(t,e,n,r,s,o){var a,u=1&e,c=2&e,l=4&e;if(n&&(a=s?n(t,r,s,o):n(t)),a!==i)return a;if(!ta(t))return t;var h=Ho(t);if(h){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Mt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!u)return Ti(t,a)}else{var d=hs(t),f=d==v||d==w;if(Xo(t))return vi(t,u);if(d==S||d==g||f&&!s){if(a=c||f?{}:fs(t),!u)return c?function(t,e){return Ci(t,ls(t),e)}(t,function(t,e){return t&&Ci(e,Ma(e),t)}(a,t)):function(t,e){return Ci(t,cs(t),e)}(t,nr(a,t))}else{if(!Jt[d])return s?t:{};a=function(t,e,n){var r=t.constructor;switch(e){case O:return wi(t);case y:case b:return new r(+t);case M:return function(t,e){var n=e?wi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case P:case N:case R:case j:case L:case F:case B:case z:case U:return xi(t,n);case x:return new r;case E:case I:return new r(t);case T:return function(t){var e=new t.constructor(t.source,dt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case C:return new r;case D:return jn?St(jn.call(t)):{}}}(t,d,u)}}o||(o=new Wn);var p=o.get(t);if(p)return p;o.set(t,a),oa(t)?t.forEach(function(r){a.add(or(r,e,n,r,t,o))}):na(t)&&t.forEach(function(r,i){a.set(i,or(r,e,n,i,t,o))});var m=h?i:(l?c?es:ts:c?Ma:Oa)(t);return _e(m||t,function(r,i){m&&(r=t[i=r]),Jn(a,i,or(r,e,n,i,t,o))}),a}function ar(t,e,n){var r=n.length;if(null==t)return!r;for(t=St(t);r--;){var s=n[r],o=t[s];if(o===i&&!(s in t)||!(0,e[s])(o))return!1}return!0}function ur(t,e,n){if("function"!=typeof t)throw new Ct(s);return Is(function(){t.apply(i,n)},e)}function cr(t,e,n,r){var i=-1,s=Ee,o=!0,a=t.length,u=[],c=e.length;if(!a)return u;n&&(e=Ae(e,Ge(n))),r?(s=Se,o=!1):e.length>=200&&(s=$e,o=!1,e=new qn(e));t:for(;++i<a;){var l=t[i],h=null==n?l:n(l);if(l=r||0!==l?l:0,o&&h==h){for(var d=c;d--;)if(e[d]===h)continue t;u.push(l)}else s(e,h,r)||u.push(l)}return u}Fn.templateSettings={escape:K,evaluate:Z,interpolate:Y,variable:"",imports:{_:Fn}},(Fn.prototype=zn.prototype).constructor=Fn,(Un.prototype=Bn(zn.prototype)).constructor=Un,(Vn.prototype=Bn(zn.prototype)).constructor=Vn,Gn.prototype.clear=function(){this.__data__=Cn?Cn(null):{},this.size=0},Gn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Gn.prototype.get=function(t){var e=this.__data__;if(Cn){var n=e[t];return n===o?i:n}return Mt.call(e,t)?e[t]:i},Gn.prototype.has=function(t){var e=this.__data__;return Cn?e[t]!==i:Mt.call(e,t)},Gn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Cn&&e===i?o:e,this},Hn.prototype.clear=function(){this.__data__=[],this.size=0},Hn.prototype.delete=function(t){var e=this.__data__,n=tr(e,t);return!(n<0||(n==e.length-1?e.pop():te.call(e,n,1),--this.size,0))},Hn.prototype.get=function(t){var e=this.__data__,n=tr(e,t);return n<0?i:e[n][1]},Hn.prototype.has=function(t){return tr(this.__data__,t)>-1},Hn.prototype.set=function(t,e){var n=this.__data__,r=tr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new Gn,map:new(En||Hn),string:new Gn}},$n.prototype.delete=function(t){var e=os(this,t).delete(t);return this.size-=e?1:0,e},$n.prototype.get=function(t){return os(this,t).get(t)},$n.prototype.has=function(t){return os(this,t).has(t)},$n.prototype.set=function(t,e){var n=os(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},qn.prototype.add=qn.prototype.push=function(t){return this.__data__.set(t,o),this},qn.prototype.has=function(t){return this.__data__.has(t)},Wn.prototype.clear=function(){this.__data__=new Hn,this.size=0},Wn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Wn.prototype.get=function(t){return this.__data__.get(t)},Wn.prototype.has=function(t){return this.__data__.has(t)},Wn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Hn){var r=n.__data__;if(!En||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new $n(r)}return n.set(t,e),this.size=n.size,this};var lr=ki(br),hr=ki(_r,!0);function dr(t,e){var n=!0;return lr(t,function(t,r,i){return n=!!e(t,r,i)}),n}function fr(t,e,n){for(var r=-1,s=t.length;++r<s;){var o=t[r],a=e(o);if(null!=a&&(u===i?a==a&&!ua(a):n(a,u)))var u=a,c=o}return c}function pr(t,e){var n=[];return lr(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function gr(t,e,n,r,i){var s=-1,o=t.length;for(n||(n=ps),i||(i=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?gr(a,e-1,n,r,i):Te(i,a):r||(i[i.length]=a)}return i}var mr=Oi(),yr=Oi(!0);function br(t,e){return t&&mr(t,e,Oa)}function _r(t,e){return t&&yr(t,e,Oa)}function vr(t,e){return xe(e,function(e){return Yo(t[e])})}function wr(t,e){for(var n=0,r=(e=mi(e,t)).length;null!=t&&n<r;)t=t[js(e[n++])];return n&&n==r?t:i}function xr(t,e,n){var r=e(t);return Ho(t)?r:Te(r,n(t))}function Er(t){return null==t?t===i?"[object Undefined]":"[object Null]":oe&&oe in St(t)?function(t){var e=Mt.call(t,oe),n=t[oe];try{t[oe]=i;var r=!0}catch(o){}var s=Rt.call(t);return r&&(e?t[oe]=n:delete t[oe]),s}(t):function(t){return Rt.call(t)}(t)}function Sr(t,e){return t>e}function Ar(t,e){return null!=t&&Mt.call(t,e)}function Tr(t,e){return null!=t&&e in St(t)}function Cr(t,e,n){for(var s=n?Se:Ee,o=t[0].length,a=t.length,u=a,c=r(a),l=1/0,h=[];u--;){var d=t[u];u&&e&&(d=Ae(d,Ge(e))),l=yn(d.length,l),c[u]=!n&&(e||o>=120&&d.length>=120)?new qn(u&&d):i}d=t[0];var f=-1,p=c[0];t:for(;++f<o&&h.length<l;){var g=d[f],m=e?e(g):g;if(g=n||0!==g?g:0,!(p?$e(p,m):s(h,m,n))){for(u=a;--u;){var y=c[u];if(!(y?$e(y,m):s(t[u],m,n)))continue t}p&&p.push(m),h.push(g)}}return h}function Ir(t,e,n){var r=null==(t=Ss(t,e=mi(e,t)))?t:t[js(Ks(e))];return null==r?i:ye(r,t,n)}function Dr(t){return ea(t)&&Er(t)==g}function kr(t,e,n,r,s){return t===e||(null==t||null==e||!ea(t)&&!ea(e)?t!=t&&e!=e:function(t,e,n,r,s,o){var a=Ho(t),u=Ho(e),c=a?m:hs(t),l=u?m:hs(e),h=(c=c==g?S:c)==S,d=(l=l==g?S:l)==S,f=c==l;if(f&&Xo(t)){if(!Xo(e))return!1;a=!0,h=!1}if(f&&!h)return o||(o=new Wn),a||ca(t)?Qi(t,e,n,r,s,o):function(t,e,n,r,i,s,o){switch(n){case M:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!s(new Ut(t),new Ut(e)));case y:case b:case E:return zo(+t,+e);case _:return t.name==e.name&&t.message==e.message;case T:case I:return t==e+"";case x:var a=Je;case C:if(a||(a=nn),t.size!=e.size&&!(1&r))return!1;var u=o.get(t);if(u)return u==e;r|=2,o.set(t,e);var c=Qi(a(t),a(e),r,i,s,o);return o.delete(t),c;case D:if(jn)return jn.call(t)==jn.call(e)}return!1}(t,e,c,n,r,s,o);if(!(1&n)){var p=h&&Mt.call(t,"__wrapped__"),v=d&&Mt.call(e,"__wrapped__");if(p||v){var w=p?t.value():t,A=v?e.value():e;return o||(o=new Wn),s(w,A,n,r,o)}}return!!f&&(o||(o=new Wn),function(t,e,n,r,s,o){var a=1&n,u=ts(t),c=u.length;if(c!=ts(e).length&&!a)return!1;for(var l=c;l--;){var h=u[l];if(!(a?h in e:Mt.call(e,h)))return!1}var d=o.get(t),f=o.get(e);if(d&&f)return d==e&&f==t;var p=!0;o.set(t,e),o.set(e,t);for(var g=a;++l<c;){var m=t[h=u[l]],y=e[h];if(r)var b=a?r(y,m,h,e,t,o):r(m,y,h,t,e,o);if(!(b===i?m===y||s(m,y,n,r,o):b)){p=!1;break}g||(g="constructor"==h)}if(p&&!g){var _=t.constructor,v=e.constructor;_==v||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof v&&v instanceof v||(p=!1)}return o.delete(t),o.delete(e),p}(t,e,n,r,s,o))}(t,e,n,r,kr,s))}function Or(t,e,n,r){var s=n.length,o=s,a=!r;if(null==t)return!o;for(t=St(t);s--;){var u=n[s];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++s<o;){var c=(u=n[s])[0],l=t[c],h=u[1];if(a&&u[2]){if(l===i&&!(c in t))return!1}else{var d=new Wn;if(r)var f=r(l,h,c,t,e,d);if(!(f===i?kr(h,l,3,r,d):f))return!1}}return!0}function Mr(t){return!(!ta(t)||(e=t,Nt&&Nt in e))&&(Yo(t)?Ft:gt).test(Ls(t));var e}function Pr(t){return"function"==typeof t?t:null==t?ru:"object"==typeof t?Ho(t)?Fr(t[0],t[1]):Lr(t):du(t)}function Nr(t){if(!vs(t))return gn(t);var e=[];for(var n in St(t))Mt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Rr(t,e){return t<e}function jr(t,e){var n=-1,i=qo(t)?r(t.length):[];return lr(t,function(t,r,s){i[++n]=e(t,r,s)}),i}function Lr(t){var e=as(t);return 1==e.length&&e[0][2]?xs(e[0][0],e[0][1]):function(n){return n===t||Or(n,t,e)}}function Fr(t,e){return ys(t)&&ws(e)?xs(js(t),e):function(n){var r=Ta(n,t);return r===i&&r===e?Ca(n,t):kr(e,r,3)}}function Br(t,e,n,r,s){t!==e&&mr(e,function(o,a){if(s||(s=new Wn),ta(o))!function(t,e,n,r,s,o,a){var u=Ts(t,n),c=Ts(e,n),l=a.get(c);if(l)Qn(t,n,l);else{var h=o?o(u,c,n+"",t,e,a):i,d=h===i;if(d){var f=Ho(c),p=!f&&Xo(c),g=!f&&!p&&ca(c);h=c,f||p||g?Ho(u)?h=u:Wo(u)?h=Ti(u):p?(d=!1,h=vi(c,!0)):g?(d=!1,h=xi(c,!0)):h=[]:ia(c)||Go(c)?(h=u,Go(u)?h=ya(u):ta(u)&&!Yo(u)||(h=fs(c))):d=!1}d&&(a.set(c,h),s(h,c,r,o,a),a.delete(c)),Qn(t,n,h)}}(t,e,a,n,Br,r,s);else{var u=r?r(Ts(t,a),o,a+"",t,e,s):i;u===i&&(u=o),Qn(t,a,u)}},Ma)}function zr(t,e){var n=t.length;if(n)return gs(e+=e<0?n:0,n)?t[e]:i}function Ur(t,e,n){e=e.length?Ae(e,function(t){return Ho(t)?function(e){return wr(e,1===t.length?t[0]:t)}:t}):[ru];var r=-1;return e=Ae(e,Ge(ss())),function(t,e){var r=t.length;for(t.sort(function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,s=e.criteria,o=i.length,a=n.length;++r<o;){var u=Ei(i[r],s[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)});r--;)t[r]=t[r].value;return t}(jr(t,function(t,n,i){return{criteria:Ae(e,function(e){return e(t)}),index:++r,value:t}}))}function Vr(t,e,n){for(var r=-1,i=e.length,s={};++r<i;){var o=e[r],a=wr(t,o);n(a,o)&&Zr(s,mi(o,t),a)}return s}function Gr(t,e,n,r){var i=r?Ne:Pe,s=-1,o=e.length,a=t;for(t===e&&(e=Ti(e)),n&&(a=Ae(t,Ge(n)));++s<o;)for(var u=0,c=e[s],l=n?n(c):c;(u=i(a,l,u,r))>-1;)a!==t&&te.call(a,u,1),te.call(t,u,1);return t}function Hr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==s){var s=i;gs(i)?te.call(t,i,1):ui(t,i)}}return t}function $r(t,e){return t+ln(vn()*(e-t+1))}function qr(t,e){var n="";if(!t||e<1||e>h)return n;do{e%2&&(n+=t),(e=ln(e/2))&&(t+=t)}while(e);return n}function Wr(t,e){return Ds(Es(t,e,ru),t+"")}function Xr(t){return Kn(za(t))}function Kr(t,e){var n=za(t);return Ms(n,sr(e,0,n.length))}function Zr(t,e,n,r){if(!ta(t))return t;for(var s=-1,o=(e=mi(e,t)).length,a=o-1,u=t;null!=u&&++s<o;){var c=js(e[s]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(s!=a){var h=u[c];(l=r?r(h,c,u):i)===i&&(l=ta(h)?h:gs(e[s+1])?[]:{})}Jn(u,c,l),u=u[c]}return t}var Yr=In?function(t,e){return In.set(t,e),t}:ru,Qr=ae?function(t,e){return ae(t,"toString",{configurable:!0,enumerable:!1,value:tu(e),writable:!0})}:ru;function Jr(t){return Ms(za(t))}function ti(t,e,n){var i=-1,s=t.length;e<0&&(e=-e>s?0:s+e),(n=n>s?s:n)<0&&(n+=s),s=e>n?0:n-e>>>0,e>>>=0;for(var o=r(s);++i<s;)o[i]=t[i+e];return o}function ei(t,e){var n;return lr(t,function(t,r,i){return!(n=e(t,r,i))}),!!n}function ni(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var s=r+i>>>1,o=t[s];null!==o&&!ua(o)&&(n?o<=e:o<e)?r=s+1:i=s}return i}return ri(t,e,ru,n)}function ri(t,e,n,r){var s=0,o=null==t?0:t.length;if(0===o)return 0;for(var a=(e=n(e))!=e,u=null===e,c=ua(e),l=e===i;s<o;){var h=ln((s+o)/2),d=n(t[h]),f=d!==i,p=null===d,g=d==d,m=ua(d);if(a)var y=r||g;else y=l?g&&(r||f):u?g&&f&&(r||!p):c?g&&f&&!p&&(r||!m):!p&&!m&&(r?d<=e:d<e);y?s=h+1:o=h}return yn(o,4294967294)}function ii(t,e){for(var n=-1,r=t.length,i=0,s=[];++n<r;){var o=t[n],a=e?e(o):o;if(!n||!zo(a,u)){var u=a;s[i++]=0===o?0:o}}return s}function si(t){return"number"==typeof t?t:ua(t)?d:+t}function oi(t){if("string"==typeof t)return t;if(Ho(t))return Ae(t,oi)+"";if(ua(t))return Ln?Ln.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ai(t,e,n){var r=-1,i=Ee,s=t.length,o=!0,a=[],u=a;if(n)o=!1,i=Se;else if(s>=200){var c=e?null:qi(t);if(c)return nn(c);o=!1,i=$e,u=new qn}else u=e?[]:a;t:for(;++r<s;){var l=t[r],h=e?e(l):l;if(l=n||0!==l?l:0,o&&h==h){for(var d=u.length;d--;)if(u[d]===h)continue t;e&&u.push(h),a.push(l)}else i(u,h,n)||(u!==a&&u.push(h),a.push(l))}return a}function ui(t,e){return null==(t=Ss(t,e=mi(e,t)))||delete t[js(Ks(e))]}function ci(t,e,n,r){return Zr(t,e,n(wr(t,e)),r)}function li(t,e,n,r){for(var i=t.length,s=r?i:-1;(r?s--:++s<i)&&e(t[s],s,t););return n?ti(t,r?0:s,r?s+1:i):ti(t,r?s+1:0,r?i:s)}function hi(t,e){var n=t;return n instanceof Vn&&(n=n.value()),Ce(e,function(t,e){return e.func.apply(e.thisArg,Te([t],e.args))},n)}function di(t,e,n){var i=t.length;if(i<2)return i?ai(t[0]):[];for(var s=-1,o=r(i);++s<i;)for(var a=t[s],u=-1;++u<i;)u!=s&&(o[s]=cr(o[s]||a,t[u],e,n));return ai(gr(o,1),e,n)}function fi(t,e,n){for(var r=-1,s=t.length,o=e.length,a={};++r<s;)n(a,t[r],r<o?e[r]:i);return a}function pi(t){return Wo(t)?t:[]}function gi(t){return"function"==typeof t?t:ru}function mi(t,e){return Ho(t)?t:ys(t,e)?[t]:Rs(ba(t))}var yi=Wr;function bi(t,e,n){var r=t.length;return n=n===i?r:n,!e&&n>=r?t:ti(t,e,n)}var _i=ce||function(t){return se.clearTimeout(t)};function vi(t,e){if(e)return t.slice();var n=t.length,r=Vt?Vt(n):new t.constructor(n);return t.copy(r),r}function wi(t){var e=new t.constructor(t.byteLength);return new Ut(e).set(new Ut(t)),e}function xi(t,e){var n=e?wi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ei(t,e){if(t!==e){var n=t!==i,r=null===t,s=t==t,o=ua(t),a=e!==i,u=null===e,c=e==e,l=ua(e);if(!u&&!l&&!o&&t>e||o&&a&&c&&!u&&!l||r&&a&&c||!n&&c||!s)return 1;if(!r&&!o&&!l&&t<e||l&&n&&s&&!r&&!o||u&&n&&s||!a&&s||!c)return-1}return 0}function Si(t,e,n,i){for(var s=-1,o=t.length,a=n.length,u=-1,c=e.length,l=mn(o-a,0),h=r(c+l),d=!i;++u<c;)h[u]=e[u];for(;++s<a;)(d||s<o)&&(h[n[s]]=t[s]);for(;l--;)h[u++]=t[s++];return h}function Ai(t,e,n,i){for(var s=-1,o=t.length,a=-1,u=n.length,c=-1,l=e.length,h=mn(o-u,0),d=r(h+l),f=!i;++s<h;)d[s]=t[s];for(var p=s;++c<l;)d[p+c]=e[c];for(;++a<u;)(f||s<o)&&(d[p+n[a]]=t[s++]);return d}function Ti(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function Ci(t,e,n,r){var s=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var u=e[o],c=r?r(n[u],t[u],u,n,t):i;c===i&&(c=t[u]),s?rr(n,u,c):Jn(n,u,c)}return n}function Ii(t,e){return function(n,r){var i=Ho(n)?be:er,s=e?e():{};return i(n,t,ss(r,2),s)}}function Di(t){return Wr(function(e,n){var r=-1,s=n.length,o=s>1?n[s-1]:i,a=s>2?n[2]:i;for(o=t.length>3&&"function"==typeof o?(s--,o):i,a&&ms(n[0],n[1],a)&&(o=s<3?i:o,s=1),e=St(e);++r<s;){var u=n[r];u&&t(e,u,r,o)}return e})}function ki(t,e){return function(n,r){if(null==n)return n;if(!qo(n))return t(n,r);for(var i=n.length,s=e?i:-1,o=St(n);(e?s--:++s<i)&&!1!==r(o[s],s,o););return n}}function Oi(t){return function(e,n,r){for(var i=-1,s=St(e),o=r(e),a=o.length;a--;){var u=o[t?a:++i];if(!1===n(s[u],u,s))break}return e}}function Mi(t){return function(e){var n=Qe(e=ba(e))?on(e):i,r=n?n[0]:e.charAt(0),s=n?bi(n,1).join(""):e.slice(1);return r[t]()+s}}function Pi(t){return function(e){return Ce(Ya(Ga(e).replace(Ht,"")),t,"")}}function Ni(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Bn(t.prototype),r=t.apply(n,e);return ta(r)?r:n}}function Ri(t){return function(e,n,r){var s=St(e);if(!qo(e)){var o=ss(n,3);e=Oa(e),n=function(t){return o(s[t],t,s)}}var a=t(e,n,r);return a>-1?s[o?e[a]:a]:i}}function ji(t){return Ji(function(e){var n=e.length,r=n,o=Un.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new Ct(s);if(o&&!u&&"wrapper"==rs(a))var u=new Un([],!0)}for(r=u?r:n;++r<n;){var c=rs(a=e[r]),l="wrapper"==c?ns(a):i;u=l&&bs(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[rs(l[0])].apply(u,l[3]):1==a.length&&bs(a)?u[c]():u.thru(a)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&Ho(r))return u.plant(r).value();for(var i=0,s=n?e[i].apply(this,t):r;++i<n;)s=e[i].call(this,s);return s}})}function Li(t,e,n,s,o,a,u,l,h,d){var f=e&c,p=1&e,g=2&e,m=24&e,y=512&e,b=g?i:Ni(t);return function i(){for(var c=arguments.length,_=r(c),v=c;v--;)_[v]=arguments[v];if(m)var w=is(i),x=Xe(_,w);if(s&&(_=Si(_,s,o,m)),a&&(_=Ai(_,a,u,m)),c-=x,m&&c<d){var E=en(_,w);return Hi(t,e,Li,i.placeholder,n,_,E,l,h,d-c)}var S=p?n:this,A=g?S[t]:t;return c=_.length,l?_=As(_,l):y&&c>1&&_.reverse(),f&&h<c&&(_.length=h),this&&this!==se&&this instanceof i&&(A=b||Ni(A)),A.apply(S,_)}}function Fi(t,e){return function(n,r){return function(t,e,n,r){return br(t,function(t,i,s){e(r,n(t),i,s)}),r}(n,t,e(r),{})}}function Bi(t,e){return function(n,r){var s;if(n===i&&r===i)return e;if(n!==i&&(s=n),r!==i){if(s===i)return r;"string"==typeof n||"string"==typeof r?(n=oi(n),r=oi(r)):(n=si(n),r=si(r)),s=t(n,r)}return s}}function zi(t){return Ji(function(e){return e=Ae(e,Ge(ss())),Wr(function(n){var r=this;return t(e,function(t){return ye(t,r,n)})})})}function Ui(t,e){var n=(e=e===i?" ":oi(e)).length;if(n<2)return n?qr(e,t):e;var r=qr(e,Fe(t/sn(e)));return Qe(e)?bi(on(r),0,t).join(""):r.slice(0,t)}function Vi(t){return function(e,n,s){return s&&"number"!=typeof s&&ms(e,n,s)&&(n=s=i),e=fa(e),n===i?(n=e,e=0):n=fa(n),function(t,e,n,i){for(var s=-1,o=mn(Fe((e-t)/(n||1)),0),a=r(o);o--;)a[i?o:++s]=t,t+=n;return a}(e,n,s=s===i?e<n?1:-1:fa(s),t)}}function Gi(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ma(e),n=ma(n)),t(e,n)}}function Hi(t,e,n,r,s,o,a,c,l,h){var d=8&e;e|=d?u:64,4&(e&=~(d?64:u))||(e&=-4);var f=[t,e,s,d?o:i,d?a:i,d?i:o,d?i:a,c,l,h],p=n.apply(i,f);return bs(t)&&Cs(p,f),p.placeholder=r,ks(p,t,e)}function $i(t){var e=Et[t];return function(t,n){if(t=ma(t),(n=null==n?0:yn(pa(n),292))&&fn(t)){var r=(ba(t)+"e").split("e");return+((r=(ba(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var qi=An&&1/nn(new An([,-0]))[1]==l?function(t){return new An(t)}:uu;function Wi(t){return function(e){var n=hs(e);return n==x?Je(e):n==C?rn(e):function(t,e){return Ae(e,function(e){return[e,t[e]]})}(e,t(e))}}function Xi(t,e,n,o,l,h,d,f){var p=2&e;if(!p&&"function"!=typeof t)throw new Ct(s);var g=o?o.length:0;if(g||(e&=-97,o=l=i),d=d===i?d:mn(pa(d),0),f=f===i?f:pa(f),g-=l?l.length:0,64&e){var m=o,y=l;o=l=i}var b=p?i:ns(t),_=[t,e,n,o,l,m,y,h,d,f];if(b&&function(t,e){var n=t[1],r=e[1],i=n|r;if(!(i<131||r==c&&8==n||r==c&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n))return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var s=e[3];if(s){var o=t[3];t[3]=o?Si(o,s,e[4]):s,t[4]=o?en(t[3],a):e[4]}(s=e[5])&&(t[5]=(o=t[5])?Ai(o,s,e[6]):s,t[6]=o?en(t[5],a):e[6]),(s=e[7])&&(t[7]=s),r&c&&(t[8]=null==t[8]?e[8]:yn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(_,b),t=_[0],e=_[1],n=_[2],o=_[3],l=_[4],!(f=_[9]=_[9]===i?p?0:t.length:mn(_[9]-g,0))&&24&e&&(e&=-25),e&&1!=e)v=8==e||16==e?function(t,e,n){var s=Ni(t);return function o(){for(var a=arguments.length,u=r(a),c=a,l=is(o);c--;)u[c]=arguments[c];var h=a<3&&u[0]!==l&&u[a-1]!==l?[]:en(u,l);return(a-=h.length)<n?Hi(t,e,Li,o.placeholder,i,u,h,i,i,n-a):ye(this&&this!==se&&this instanceof o?s:t,this,u)}}(t,e,f):e!=u&&33!=e||l.length?Li.apply(i,_):function(t,e,n,i){var s=1&e,o=Ni(t);return function e(){for(var a=-1,u=arguments.length,c=-1,l=i.length,h=r(l+u),d=this&&this!==se&&this instanceof e?o:t;++c<l;)h[c]=i[c];for(;u--;)h[c++]=arguments[++a];return ye(d,s?n:this,h)}}(t,e,n,o);else var v=function(t,e,n){var r=1&e,i=Ni(t);return function e(){return(this&&this!==se&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,n);return ks((b?Yr:Cs)(v,_),t,e)}function Ki(t,e,n,r){return t===i||zo(t,Dt[n])&&!Mt.call(r,n)?e:t}function Zi(t,e,n,r,s,o){return ta(t)&&ta(e)&&(o.set(e,t),Br(t,e,i,Zi,o),o.delete(e)),t}function Yi(t){return ia(t)?i:t}function Qi(t,e,n,r,s,o){var a=1&n,u=t.length,c=e.length;if(u!=c&&!(a&&c>u))return!1;var l=o.get(t),h=o.get(e);if(l&&h)return l==e&&h==t;var d=-1,f=!0,p=2&n?new qn:i;for(o.set(t,e),o.set(e,t);++d<u;){var g=t[d],m=e[d];if(r)var y=a?r(m,g,d,e,t,o):r(g,m,d,t,e,o);if(y!==i){if(y)continue;f=!1;break}if(p){if(!De(e,function(t,e){if(!$e(p,e)&&(g===t||s(g,t,n,r,o)))return p.push(e)})){f=!1;break}}else if(g!==m&&!s(g,m,n,r,o)){f=!1;break}}return o.delete(t),o.delete(e),f}function Ji(t){return Ds(Es(t,i,Hs),t+"")}function ts(t){return xr(t,Oa,cs)}function es(t){return xr(t,Ma,ls)}var ns=In?function(t){return In.get(t)}:uu;function rs(t){for(var e=t.name+"",n=Dn[e],r=Mt.call(Dn,e)?n.length:0;r--;){var i=n[r],s=i.func;if(null==s||s==t)return i.name}return e}function is(t){return(Mt.call(Fn,"placeholder")?Fn:t).placeholder}function ss(){var t=Fn.iteratee||iu;return t=t===iu?Pr:t,arguments.length?t(arguments[0],arguments[1]):t}function os(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function as(t){for(var e=Oa(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,ws(i)]}return e}function us(t,e){var n=function(t,e){return null==t?i:t[e]}(t,e);return Mr(n)?n:i}var cs=hn?function(t){return null==t?[]:(t=St(t),xe(hn(t),function(e){return Xt.call(t,e)}))}:gu,ls=hn?function(t){for(var e=[];t;)Te(e,cs(t)),t=Gt(t);return e}:gu,hs=Er;function ds(t,e,n){for(var r=-1,i=(e=mi(e,t)).length,s=!1;++r<i;){var o=js(e[r]);if(!(s=null!=t&&n(t,o)))break;t=t[o]}return s||++r!=i?s:!!(i=null==t?0:t.length)&&Jo(i)&&gs(o,i)&&(Ho(t)||Go(t))}function fs(t){return"function"!=typeof t.constructor||vs(t)?{}:Bn(Gt(t))}function ps(t){return Ho(t)||Go(t)||!!(re&&t&&t[re])}function gs(t,e){var n=typeof t;return!!(e=null==e?h:e)&&("number"==n||"symbol"!=n&&yt.test(t))&&t>-1&&t%1==0&&t<e}function ms(t,e,n){if(!ta(n))return!1;var r=typeof e;return!!("number"==r?qo(n)&&gs(e,n.length):"string"==r&&e in n)&&zo(n[e],t)}function ys(t,e){if(Ho(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ua(t))||J.test(t)||!Q.test(t)||null!=e&&t in St(e)}function bs(t){var e=rs(t),n=Fn[e];if("function"!=typeof n||!(e in Vn.prototype))return!1;if(t===n)return!0;var r=ns(n);return!!r&&t===r[0]}(xn&&hs(new xn(new ArrayBuffer(1)))!=M||En&&hs(new En)!=x||Sn&&hs(Sn.resolve())!=A||An&&hs(new An)!=C||Tn&&hs(new Tn)!=k)&&(hs=function(t){var e=Er(t),n=e==S?t.constructor:i,r=n?Ls(n):"";if(r)switch(r){case kn:return M;case On:return x;case Mn:return A;case Pn:return C;case Nn:return k}return e});var _s=kt?Yo:mu;function vs(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Dt)}function ws(t){return t==t&&!ta(t)}function xs(t,e){return function(n){return null!=n&&n[t]===e&&(e!==i||t in St(n))}}function Es(t,e,n){return e=mn(e===i?t.length-1:e,0),function(){for(var i=arguments,s=-1,o=mn(i.length-e,0),a=r(o);++s<o;)a[s]=i[e+s];s=-1;for(var u=r(e+1);++s<e;)u[s]=i[s];return u[e]=n(a),ye(t,this,u)}}function Ss(t,e){return e.length<2?t:wr(t,ti(e,0,-1))}function As(t,e){for(var n=t.length,r=yn(e.length,n),s=Ti(t);r--;){var o=e[r];t[r]=gs(o,n)?s[o]:i}return t}function Ts(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Cs=Os(Yr),Is=ke||function(t,e){return se.setTimeout(t,e)},Ds=Os(Qr);function ks(t,e,n){var r=e+"";return Ds(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(st,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return _e(p,function(n){var r="_."+n[0];e&n[1]&&!Ee(t,r)&&t.push(r)}),t.sort()}(function(t){var e=t.match(ot);return e?e[1].split(at):[]}(r),n)))}function Os(t){var e=0,n=0;return function(){var r=bn(),s=16-(r-n);if(n=r,s>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Ms(t,e){var n=-1,r=t.length,s=r-1;for(e=e===i?r:e;++n<e;){var o=$r(n,s),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}var Ps,Ns,Rs=(Ps=No(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,function(t,n,r,i){e.push(r?i.replace(lt,"$1"):n||t)}),e},function(t){return 500===Ns.size&&Ns.clear(),t}),Ns=Ps.cache,Ps);function js(t){if("string"==typeof t||ua(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ls(t){if(null!=t){try{return Ot.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Fs(t){if(t instanceof Vn)return t.clone();var e=new Un(t.__wrapped__,t.__chain__);return e.__actions__=Ti(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Bs=Wr(function(t,e){return Wo(t)?cr(t,gr(e,1,Wo,!0)):[]}),zs=Wr(function(t,e){var n=Ks(e);return Wo(n)&&(n=i),Wo(t)?cr(t,gr(e,1,Wo,!0),ss(n,2)):[]}),Us=Wr(function(t,e){var n=Ks(e);return Wo(n)&&(n=i),Wo(t)?cr(t,gr(e,1,Wo,!0),i,n):[]});function Vs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=mn(r+i,0)),Me(t,ss(e,3),i)}function Gs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var s=r-1;return n!==i&&(s=pa(n),s=n<0?mn(r+s,0):yn(s,r-1)),Me(t,ss(e,3),s,!0)}function Hs(t){return null!=t&&t.length?gr(t,1):[]}function $s(t){return t&&t.length?t[0]:i}var qs=Wr(function(t){var e=Ae(t,pi);return e.length&&e[0]===t[0]?Cr(e):[]}),Ws=Wr(function(t){var e=Ks(t),n=Ae(t,pi);return e===Ks(n)?e=i:n.pop(),n.length&&n[0]===t[0]?Cr(n,ss(e,2)):[]}),Xs=Wr(function(t){var e=Ks(t),n=Ae(t,pi);return(e="function"==typeof e?e:i)&&n.pop(),n.length&&n[0]===t[0]?Cr(n,i,e):[]});function Ks(t){var e=null==t?0:t.length;return e?t[e-1]:i}var Zs=Wr(Ys);function Ys(t,e){return t&&t.length&&e&&e.length?Gr(t,e):t}var Qs=Ji(function(t,e){var n=null==t?0:t.length,r=ir(t,e);return Hr(t,Ae(e,function(t){return gs(t,n)?+t:t}).sort(Ei)),r});function Js(t){return null==t?t:wn.call(t)}var to=Wr(function(t){return ai(gr(t,1,Wo,!0))}),eo=Wr(function(t){var e=Ks(t);return Wo(e)&&(e=i),ai(gr(t,1,Wo,!0),ss(e,2))}),no=Wr(function(t){var e=Ks(t);return e="function"==typeof e?e:i,ai(gr(t,1,Wo,!0),i,e)});function ro(t){if(!t||!t.length)return[];var e=0;return t=xe(t,function(t){if(Wo(t))return e=mn(t.length,e),!0}),Ue(e,function(e){return Ae(t,Le(e))})}function io(t,e){if(!t||!t.length)return[];var n=ro(t);return null==e?n:Ae(n,function(t){return ye(e,i,t)})}var so=Wr(function(t,e){return Wo(t)?cr(t,e):[]}),oo=Wr(function(t){return di(xe(t,Wo))}),ao=Wr(function(t){var e=Ks(t);return Wo(e)&&(e=i),di(xe(t,Wo),ss(e,2))}),uo=Wr(function(t){var e=Ks(t);return e="function"==typeof e?e:i,di(xe(t,Wo),i,e)}),co=Wr(ro),lo=Wr(function(t){var e=t.length,n=e>1?t[e-1]:i;return n="function"==typeof n?(t.pop(),n):i,io(t,n)});function ho(t){var e=Fn(t);return e.__chain__=!0,e}function fo(t,e){return e(t)}var po=Ji(function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,s=function(e){return ir(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Vn&&gs(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:fo,args:[s],thisArg:i}),new Un(r,this.__chain__).thru(function(t){return e&&!t.length&&t.push(i),t})):this.thru(s)}),go=Ii(function(t,e,n){Mt.call(t,n)?++t[n]:rr(t,n,1)}),mo=Ri(Vs),yo=Ri(Gs);function bo(t,e){return(Ho(t)?_e:lr)(t,ss(e,3))}function _o(t,e){return(Ho(t)?ve:hr)(t,ss(e,3))}var vo=Ii(function(t,e,n){Mt.call(t,n)?t[n].push(e):rr(t,n,[e])}),wo=Wr(function(t,e,n){var i=-1,s="function"==typeof e,o=qo(t)?r(t.length):[];return lr(t,function(t){o[++i]=s?ye(e,t,n):Ir(t,e,n)}),o}),xo=Ii(function(t,e,n){rr(t,n,e)});function Eo(t,e){return(Ho(t)?Ae:jr)(t,ss(e,3))}var So=Ii(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),Ao=Wr(function(t,e){if(null==t)return[];var n=e.length;return n>1&&ms(t,e[0],e[1])?e=[]:n>2&&ms(e[0],e[1],e[2])&&(e=[e[0]]),Ur(t,gr(e,1),[])}),To=le||function(){return se.Date.now()};function Co(t,e,n){return e=n?i:e,Xi(t,c,i,i,i,i,e=t&&null==e?t.length:e)}function Io(t,e){var n;if("function"!=typeof e)throw new Ct(s);return t=pa(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=i),n}}var Do=Wr(function(t,e,n){var r=1;if(n.length){var i=en(n,is(Do));r|=u}return Xi(t,r,e,n,i)}),ko=Wr(function(t,e,n){var r=3;if(n.length){var i=en(n,is(ko));r|=u}return Xi(e,r,t,n,i)});function Oo(t,e,n){var r,o,a,u,c,l,h=0,d=!1,f=!1,p=!0;if("function"!=typeof t)throw new Ct(s);function g(e){var n=r,s=o;return r=o=i,h=e,u=t.apply(s,n)}function m(t){return h=t,c=Is(b,e),d?g(t):u}function y(t){var n=t-l;return l===i||n>=e||n<0||f&&t-h>=a}function b(){var t=To();if(y(t))return _(t);c=Is(b,function(t){var n=e-(t-l);return f?yn(n,a-(t-h)):n}(t))}function _(t){return c=i,p&&r?g(t):(r=o=i,u)}function v(){var t=To(),n=y(t);if(r=arguments,o=this,l=t,n){if(c===i)return m(l);if(f)return _i(c),c=Is(b,e),g(l)}return c===i&&(c=Is(b,e)),u}return e=ma(e)||0,ta(n)&&(d=!!n.leading,a=(f="maxWait"in n)?mn(ma(n.maxWait)||0,e):a,p="trailing"in n?!!n.trailing:p),v.cancel=function(){c!==i&&_i(c),h=0,r=l=o=c=i},v.flush=function(){return c===i?u:_(To())},v}var Mo=Wr(function(t,e){return ur(t,1,e)}),Po=Wr(function(t,e,n){return ur(t,ma(e)||0,n)});function No(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Ct(s);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=t.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(No.Cache||$n),n}function Ro(t){if("function"!=typeof t)throw new Ct(s);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}No.Cache=$n;var jo=yi(function(t,e){var n=(e=1==e.length&&Ho(e[0])?Ae(e[0],Ge(ss())):Ae(gr(e,1),Ge(ss()))).length;return Wr(function(r){for(var i=-1,s=yn(r.length,n);++i<s;)r[i]=e[i].call(this,r[i]);return ye(t,this,r)})}),Lo=Wr(function(t,e){var n=en(e,is(Lo));return Xi(t,u,i,e,n)}),Fo=Wr(function(t,e){var n=en(e,is(Fo));return Xi(t,64,i,e,n)}),Bo=Ji(function(t,e){return Xi(t,256,i,i,i,e)});function zo(t,e){return t===e||t!=t&&e!=e}var Uo=Gi(Sr),Vo=Gi(function(t,e){return t>=e}),Go=Dr(function(){return arguments}())?Dr:function(t){return ea(t)&&Mt.call(t,"callee")&&!Xt.call(t,"callee")},Ho=r.isArray,$o=he?Ge(he):function(t){return ea(t)&&Er(t)==O};function qo(t){return null!=t&&Jo(t.length)&&!Yo(t)}function Wo(t){return ea(t)&&qo(t)}var Xo=dn||mu,Ko=de?Ge(de):function(t){return ea(t)&&Er(t)==b};function Zo(t){if(!ea(t))return!1;var e=Er(t);return e==_||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ia(t)}function Yo(t){if(!ta(t))return!1;var e=Er(t);return e==v||e==w||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Qo(t){return"number"==typeof t&&t==pa(t)}function Jo(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}function ta(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ea(t){return null!=t&&"object"==typeof t}var na=fe?Ge(fe):function(t){return ea(t)&&hs(t)==x};function ra(t){return"number"==typeof t||ea(t)&&Er(t)==E}function ia(t){if(!ea(t)||Er(t)!=S)return!1;var e=Gt(t);if(null===e)return!0;var n=Mt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ot.call(n)==jt}var sa=pe?Ge(pe):function(t){return ea(t)&&Er(t)==T},oa=ge?Ge(ge):function(t){return ea(t)&&hs(t)==C};function aa(t){return"string"==typeof t||!Ho(t)&&ea(t)&&Er(t)==I}function ua(t){return"symbol"==typeof t||ea(t)&&Er(t)==D}var ca=me?Ge(me):function(t){return ea(t)&&Jo(t.length)&&!!Qt[Er(t)]},la=Gi(Rr),ha=Gi(function(t,e){return t<=e});function da(t){if(!t)return[];if(qo(t))return aa(t)?on(t):Ti(t);if(ie&&t[ie])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[ie]());var e=hs(t);return(e==x?Je:e==C?nn:za)(t)}function fa(t){return t?(t=ma(t))===l||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function pa(t){var e=fa(t),n=e%1;return e==e?n?e-n:e:0}function ga(t){return t?sr(pa(t),0,f):0}function ma(t){if("number"==typeof t)return t;if(ua(t))return d;if(ta(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ta(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ve(t);var n=pt.test(t);return n||mt.test(t)?ne(t.slice(2),n?2:8):ft.test(t)?d:+t}function ya(t){return Ci(t,Ma(t))}function ba(t){return null==t?"":oi(t)}var _a=Di(function(t,e){if(vs(e)||qo(e))Ci(e,Oa(e),t);else for(var n in e)Mt.call(e,n)&&Jn(t,n,e[n])}),va=Di(function(t,e){Ci(e,Ma(e),t)}),wa=Di(function(t,e,n,r){Ci(e,Ma(e),t,r)}),xa=Di(function(t,e,n,r){Ci(e,Oa(e),t,r)}),Ea=Ji(ir),Sa=Wr(function(t,e){t=St(t);var n=-1,r=e.length,s=r>2?e[2]:i;for(s&&ms(e[0],e[1],s)&&(r=1);++n<r;)for(var o=e[n],a=Ma(o),u=-1,c=a.length;++u<c;){var l=a[u],h=t[l];(h===i||zo(h,Dt[l])&&!Mt.call(t,l))&&(t[l]=o[l])}return t}),Aa=Wr(function(t){return t.push(i,Zi),ye(Na,i,t)});function Ta(t,e,n){var r=null==t?i:wr(t,e);return r===i?n:r}function Ca(t,e){return null!=t&&ds(t,e,Tr)}var Ia=Fi(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Rt.call(e)),t[e]=n},tu(ru)),Da=Fi(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Rt.call(e)),Mt.call(t,e)?t[e].push(n):t[e]=[n]},ss),ka=Wr(Ir);function Oa(t){return qo(t)?Xn(t):Nr(t)}function Ma(t){return qo(t)?Xn(t,!0):function(t){if(!ta(t))return function(t){var e=[];if(null!=t)for(var n in St(t))e.push(n);return e}(t);var e=vs(t),n=[];for(var r in t)("constructor"!=r||!e&&Mt.call(t,r))&&n.push(r);return n}(t)}var Pa=Di(function(t,e,n){Br(t,e,n)}),Na=Di(function(t,e,n,r){Br(t,e,n,r)}),Ra=Ji(function(t,e){var n={};if(null==t)return n;var r=!1;e=Ae(e,function(e){return e=mi(e,t),r||(r=e.length>1),e}),Ci(t,es(t),n),r&&(n=or(n,7,Yi));for(var i=e.length;i--;)ui(n,e[i]);return n}),ja=Ji(function(t,e){return null==t?{}:function(t,e){return Vr(t,e,function(e,n){return Ca(t,n)})}(t,e)});function La(t,e){if(null==t)return{};var n=Ae(es(t),function(t){return[t]});return e=ss(e),Vr(t,n,function(t,n){return e(t,n[0])})}var Fa=Wi(Oa),Ba=Wi(Ma);function za(t){return null==t?[]:He(t,Oa(t))}var Ua=Pi(function(t,e,n){return e=e.toLowerCase(),t+(n?Va(e):e)});function Va(t){return Za(ba(t).toLowerCase())}function Ga(t){return(t=ba(t))&&t.replace(bt,Ke).replace($t,"")}var Ha=Pi(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),$a=Pi(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),qa=Mi("toLowerCase"),Wa=Pi(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Xa=Pi(function(t,e,n){return t+(n?" ":"")+Za(e)}),Ka=Pi(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Za=Mi("toUpperCase");function Ya(t,e,n){return t=ba(t),(e=n?i:e)===i?function(t){return Kt.test(t)}(t)?function(t){return t.match(Wt)||[]}(t):function(t){return t.match(ut)||[]}(t):t.match(e)||[]}var Qa=Wr(function(t,e){try{return ye(t,i,e)}catch(n){return Zo(n)?n:new wt(n)}}),Ja=Ji(function(t,e){return _e(e,function(e){e=js(e),rr(t,e,Do(t[e],t))}),t});function tu(t){return function(){return t}}var eu=ji(),nu=ji(!0);function ru(t){return t}function iu(t){return Pr("function"==typeof t?t:or(t,1))}var su=Wr(function(t,e){return function(n){return Ir(n,t,e)}}),ou=Wr(function(t,e){return function(n){return Ir(t,n,e)}});function au(t,e,n){var r=Oa(e),i=vr(e,r);null!=n||ta(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=vr(e,Oa(e)));var s=!(ta(n)&&"chain"in n&&!n.chain),o=Yo(t);return _e(i,function(n){var r=e[n];t[n]=r,o&&(t.prototype[n]=function(){var e=this.__chain__;if(s||e){var n=t(this.__wrapped__),i=n.__actions__=Ti(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Te([this.value()],arguments))})}),t}function uu(){}var cu=zi(Ae),lu=zi(we),hu=zi(De);function du(t){return ys(t)?Le(js(t)):function(t){return function(e){return wr(e,t)}}(t)}var fu=Vi(),pu=Vi(!0);function gu(){return[]}function mu(){return!1}var yu,bu=Bi(function(t,e){return t+e},0),_u=$i("ceil"),vu=Bi(function(t,e){return t/e},1),wu=$i("floor"),xu=Bi(function(t,e){return t*e},1),Eu=$i("round"),Su=Bi(function(t,e){return t-e},0);return Fn.after=function(t,e){if("function"!=typeof e)throw new Ct(s);return t=pa(t),function(){if(--t<1)return e.apply(this,arguments)}},Fn.ary=Co,Fn.assign=_a,Fn.assignIn=va,Fn.assignInWith=wa,Fn.assignWith=xa,Fn.at=Ea,Fn.before=Io,Fn.bind=Do,Fn.bindAll=Ja,Fn.bindKey=ko,Fn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ho(t)?t:[t]},Fn.chain=ho,Fn.chunk=function(t,e,n){e=(n?ms(t,e,n):e===i)?1:mn(pa(e),0);var s=null==t?0:t.length;if(!s||e<1)return[];for(var o=0,a=0,u=r(Fe(s/e));o<s;)u[a++]=ti(t,o,o+=e);return u},Fn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var s=t[e];s&&(i[r++]=s)}return i},Fn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return Te(Ho(n)?Ti(n):[n],gr(e,1))},Fn.cond=function(t){var e=null==t?0:t.length,n=ss();return t=e?Ae(t,function(t){if("function"!=typeof t[1])throw new Ct(s);return[n(t[0]),t[1]]}):[],Wr(function(n){for(var r=-1;++r<e;){var i=t[r];if(ye(i[0],this,n))return ye(i[1],this,n)}})},Fn.conforms=function(t){return function(t){var e=Oa(t);return function(n){return ar(n,t,e)}}(or(t,1))},Fn.constant=tu,Fn.countBy=go,Fn.create=function(t,e){var n=Bn(t);return null==e?n:nr(n,e)},Fn.curry=function t(e,n,r){var s=Xi(e,8,i,i,i,i,i,n=r?i:n);return s.placeholder=t.placeholder,s},Fn.curryRight=function t(e,n,r){var s=Xi(e,16,i,i,i,i,i,n=r?i:n);return s.placeholder=t.placeholder,s},Fn.debounce=Oo,Fn.defaults=Sa,Fn.defaultsDeep=Aa,Fn.defer=Mo,Fn.delay=Po,Fn.difference=Bs,Fn.differenceBy=zs,Fn.differenceWith=Us,Fn.drop=function(t,e,n){var r=null==t?0:t.length;return r?ti(t,(e=n||e===i?1:pa(e))<0?0:e,r):[]},Fn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?ti(t,0,(e=r-(e=n||e===i?1:pa(e)))<0?0:e):[]},Fn.dropRightWhile=function(t,e){return t&&t.length?li(t,ss(e,3),!0,!0):[]},Fn.dropWhile=function(t,e){return t&&t.length?li(t,ss(e,3),!0):[]},Fn.fill=function(t,e,n,r){var s=null==t?0:t.length;return s?(n&&"number"!=typeof n&&ms(t,e,n)&&(n=0,r=s),function(t,e,n,r){var s=t.length;for((n=pa(n))<0&&(n=-n>s?0:s+n),(r=r===i||r>s?s:pa(r))<0&&(r+=s),r=n>r?0:ga(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Fn.filter=function(t,e){return(Ho(t)?xe:pr)(t,ss(e,3))},Fn.flatMap=function(t,e){return gr(Eo(t,e),1)},Fn.flatMapDeep=function(t,e){return gr(Eo(t,e),l)},Fn.flatMapDepth=function(t,e,n){return n=n===i?1:pa(n),gr(Eo(t,e),n)},Fn.flatten=Hs,Fn.flattenDeep=function(t){return null!=t&&t.length?gr(t,l):[]},Fn.flattenDepth=function(t,e){return null!=t&&t.length?gr(t,e=e===i?1:pa(e)):[]},Fn.flip=function(t){return Xi(t,512)},Fn.flow=eu,Fn.flowRight=nu,Fn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},Fn.functions=function(t){return null==t?[]:vr(t,Oa(t))},Fn.functionsIn=function(t){return null==t?[]:vr(t,Ma(t))},Fn.groupBy=vo,Fn.initial=function(t){return null!=t&&t.length?ti(t,0,-1):[]},Fn.intersection=qs,Fn.intersectionBy=Ws,Fn.intersectionWith=Xs,Fn.invert=Ia,Fn.invertBy=Da,Fn.invokeMap=wo,Fn.iteratee=iu,Fn.keyBy=xo,Fn.keys=Oa,Fn.keysIn=Ma,Fn.map=Eo,Fn.mapKeys=function(t,e){var n={};return e=ss(e,3),br(t,function(t,r,i){rr(n,e(t,r,i),t)}),n},Fn.mapValues=function(t,e){var n={};return e=ss(e,3),br(t,function(t,r,i){rr(n,r,e(t,r,i))}),n},Fn.matches=function(t){return Lr(or(t,1))},Fn.matchesProperty=function(t,e){return Fr(t,or(e,1))},Fn.memoize=No,Fn.merge=Pa,Fn.mergeWith=Na,Fn.method=su,Fn.methodOf=ou,Fn.mixin=au,Fn.negate=Ro,Fn.nthArg=function(t){return t=pa(t),Wr(function(e){return zr(e,t)})},Fn.omit=Ra,Fn.omitBy=function(t,e){return La(t,Ro(ss(e)))},Fn.once=function(t){return Io(2,t)},Fn.orderBy=function(t,e,n,r){return null==t?[]:(Ho(e)||(e=null==e?[]:[e]),Ho(n=r?i:n)||(n=null==n?[]:[n]),Ur(t,e,n))},Fn.over=cu,Fn.overArgs=jo,Fn.overEvery=lu,Fn.overSome=hu,Fn.partial=Lo,Fn.partialRight=Fo,Fn.partition=So,Fn.pick=ja,Fn.pickBy=La,Fn.property=du,Fn.propertyOf=function(t){return function(e){return null==t?i:wr(t,e)}},Fn.pull=Zs,Fn.pullAll=Ys,Fn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Gr(t,e,ss(n,2)):t},Fn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Gr(t,e,i,n):t},Fn.pullAt=Qs,Fn.range=fu,Fn.rangeRight=pu,Fn.rearg=Bo,Fn.reject=function(t,e){return(Ho(t)?xe:pr)(t,Ro(ss(e,3)))},Fn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],s=t.length;for(e=ss(e,3);++r<s;){var o=t[r];e(o,r,t)&&(n.push(o),i.push(r))}return Hr(t,i),n},Fn.rest=function(t,e){if("function"!=typeof t)throw new Ct(s);return Wr(t,e=e===i?e:pa(e))},Fn.reverse=Js,Fn.sampleSize=function(t,e,n){return e=(n?ms(t,e,n):e===i)?1:pa(e),(Ho(t)?Zn:Kr)(t,e)},Fn.set=function(t,e,n){return null==t?t:Zr(t,e,n)},Fn.setWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:Zr(t,e,n,r)},Fn.shuffle=function(t){return(Ho(t)?Yn:Jr)(t)},Fn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&ms(t,e,n)?(e=0,n=r):(e=null==e?0:pa(e),n=n===i?r:pa(n)),ti(t,e,n)):[]},Fn.sortBy=Ao,Fn.sortedUniq=function(t){return t&&t.length?ii(t):[]},Fn.sortedUniqBy=function(t,e){return t&&t.length?ii(t,ss(e,2)):[]},Fn.split=function(t,e,n){return n&&"number"!=typeof n&&ms(t,e,n)&&(e=n=i),(n=n===i?f:n>>>0)?(t=ba(t))&&("string"==typeof e||null!=e&&!sa(e))&&!(e=oi(e))&&Qe(t)?bi(on(t),0,n):t.split(e,n):[]},Fn.spread=function(t,e){if("function"!=typeof t)throw new Ct(s);return e=null==e?0:mn(pa(e),0),Wr(function(n){var r=n[e],i=bi(n,0,e);return r&&Te(i,r),ye(t,this,i)})},Fn.tail=function(t){var e=null==t?0:t.length;return e?ti(t,1,e):[]},Fn.take=function(t,e,n){return t&&t.length?ti(t,0,(e=n||e===i?1:pa(e))<0?0:e):[]},Fn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?ti(t,(e=r-(e=n||e===i?1:pa(e)))<0?0:e,r):[]},Fn.takeRightWhile=function(t,e){return t&&t.length?li(t,ss(e,3),!1,!0):[]},Fn.takeWhile=function(t,e){return t&&t.length?li(t,ss(e,3)):[]},Fn.tap=function(t,e){return e(t),t},Fn.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Ct(s);return ta(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Oo(t,e,{leading:r,maxWait:e,trailing:i})},Fn.thru=fo,Fn.toArray=da,Fn.toPairs=Fa,Fn.toPairsIn=Ba,Fn.toPath=function(t){return Ho(t)?Ae(t,js):ua(t)?[t]:Ti(Rs(ba(t)))},Fn.toPlainObject=ya,Fn.transform=function(t,e,n){var r=Ho(t),i=r||Xo(t)||ca(t);if(e=ss(e,4),null==n){var s=t&&t.constructor;n=i?r?new s:[]:ta(t)&&Yo(s)?Bn(Gt(t)):{}}return(i?_e:br)(t,function(t,r,i){return e(n,t,r,i)}),n},Fn.unary=function(t){return Co(t,1)},Fn.union=to,Fn.unionBy=eo,Fn.unionWith=no,Fn.uniq=function(t){return t&&t.length?ai(t):[]},Fn.uniqBy=function(t,e){return t&&t.length?ai(t,ss(e,2)):[]},Fn.uniqWith=function(t,e){return e="function"==typeof e?e:i,t&&t.length?ai(t,i,e):[]},Fn.unset=function(t,e){return null==t||ui(t,e)},Fn.unzip=ro,Fn.unzipWith=io,Fn.update=function(t,e,n){return null==t?t:ci(t,e,gi(n))},Fn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:ci(t,e,gi(n),r)},Fn.values=za,Fn.valuesIn=function(t){return null==t?[]:He(t,Ma(t))},Fn.without=so,Fn.words=Ya,Fn.wrap=function(t,e){return Lo(gi(e),t)},Fn.xor=oo,Fn.xorBy=ao,Fn.xorWith=uo,Fn.zip=co,Fn.zipObject=function(t,e){return fi(t||[],e||[],Jn)},Fn.zipObjectDeep=function(t,e){return fi(t||[],e||[],Zr)},Fn.zipWith=lo,Fn.entries=Fa,Fn.entriesIn=Ba,Fn.extend=va,Fn.extendWith=wa,au(Fn,Fn),Fn.add=bu,Fn.attempt=Qa,Fn.camelCase=Ua,Fn.capitalize=Va,Fn.ceil=_u,Fn.clamp=function(t,e,n){return n===i&&(n=e,e=i),n!==i&&(n=(n=ma(n))==n?n:0),e!==i&&(e=(e=ma(e))==e?e:0),sr(ma(t),e,n)},Fn.clone=function(t){return or(t,4)},Fn.cloneDeep=function(t){return or(t,5)},Fn.cloneDeepWith=function(t,e){return or(t,5,e="function"==typeof e?e:i)},Fn.cloneWith=function(t,e){return or(t,4,e="function"==typeof e?e:i)},Fn.conformsTo=function(t,e){return null==e||ar(t,e,Oa(e))},Fn.deburr=Ga,Fn.defaultTo=function(t,e){return null==t||t!=t?e:t},Fn.divide=vu,Fn.endsWith=function(t,e,n){t=ba(t),e=oi(e);var r=t.length,s=n=n===i?r:sr(pa(n),0,r);return(n-=e.length)>=0&&t.slice(n,s)==e},Fn.eq=zo,Fn.escape=function(t){return(t=ba(t))&&X.test(t)?t.replace(q,Ze):t},Fn.escapeRegExp=function(t){return(t=ba(t))&&nt.test(t)?t.replace(et,"\\$&"):t},Fn.every=function(t,e,n){var r=Ho(t)?we:dr;return n&&ms(t,e,n)&&(e=i),r(t,ss(e,3))},Fn.find=mo,Fn.findIndex=Vs,Fn.findKey=function(t,e){return Oe(t,ss(e,3),br)},Fn.findLast=yo,Fn.findLastIndex=Gs,Fn.findLastKey=function(t,e){return Oe(t,ss(e,3),_r)},Fn.floor=wu,Fn.forEach=bo,Fn.forEachRight=_o,Fn.forIn=function(t,e){return null==t?t:mr(t,ss(e,3),Ma)},Fn.forInRight=function(t,e){return null==t?t:yr(t,ss(e,3),Ma)},Fn.forOwn=function(t,e){return t&&br(t,ss(e,3))},Fn.forOwnRight=function(t,e){return t&&_r(t,ss(e,3))},Fn.get=Ta,Fn.gt=Uo,Fn.gte=Vo,Fn.has=function(t,e){return null!=t&&ds(t,e,Ar)},Fn.hasIn=Ca,Fn.head=$s,Fn.identity=ru,Fn.includes=function(t,e,n,r){t=qo(t)?t:za(t),n=n&&!r?pa(n):0;var i=t.length;return n<0&&(n=mn(i+n,0)),aa(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&Pe(t,e,n)>-1},Fn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=mn(r+i,0)),Pe(t,e,i)},Fn.inRange=function(t,e,n){return e=fa(e),n===i?(n=e,e=0):n=fa(n),function(t,e,n){return t>=yn(e,n)&&t<mn(e,n)}(t=ma(t),e,n)},Fn.invoke=ka,Fn.isArguments=Go,Fn.isArray=Ho,Fn.isArrayBuffer=$o,Fn.isArrayLike=qo,Fn.isArrayLikeObject=Wo,Fn.isBoolean=function(t){return!0===t||!1===t||ea(t)&&Er(t)==y},Fn.isBuffer=Xo,Fn.isDate=Ko,Fn.isElement=function(t){return ea(t)&&1===t.nodeType&&!ia(t)},Fn.isEmpty=function(t){if(null==t)return!0;if(qo(t)&&(Ho(t)||"string"==typeof t||"function"==typeof t.splice||Xo(t)||ca(t)||Go(t)))return!t.length;var e=hs(t);if(e==x||e==C)return!t.size;if(vs(t))return!Nr(t).length;for(var n in t)if(Mt.call(t,n))return!1;return!0},Fn.isEqual=function(t,e){return kr(t,e)},Fn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:i)?n(t,e):i;return r===i?kr(t,e,i,n):!!r},Fn.isError=Zo,Fn.isFinite=function(t){return"number"==typeof t&&fn(t)},Fn.isFunction=Yo,Fn.isInteger=Qo,Fn.isLength=Jo,Fn.isMap=na,Fn.isMatch=function(t,e){return t===e||Or(t,e,as(e))},Fn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:i,Or(t,e,as(e),n)},Fn.isNaN=function(t){return ra(t)&&t!=+t},Fn.isNative=function(t){if(_s(t))throw new wt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Mr(t)},Fn.isNil=function(t){return null==t},Fn.isNull=function(t){return null===t},Fn.isNumber=ra,Fn.isObject=ta,Fn.isObjectLike=ea,Fn.isPlainObject=ia,Fn.isRegExp=sa,Fn.isSafeInteger=function(t){return Qo(t)&&t>=-9007199254740991&&t<=h},Fn.isSet=oa,Fn.isString=aa,Fn.isSymbol=ua,Fn.isTypedArray=ca,Fn.isUndefined=function(t){return t===i},Fn.isWeakMap=function(t){return ea(t)&&hs(t)==k},Fn.isWeakSet=function(t){return ea(t)&&"[object WeakSet]"==Er(t)},Fn.join=function(t,e){return null==t?"":pn.call(t,e)},Fn.kebabCase=Ha,Fn.last=Ks,Fn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var s=r;return n!==i&&(s=(s=pa(n))<0?mn(r+s,0):yn(s,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,s):Me(t,Re,s,!0)},Fn.lowerCase=$a,Fn.lowerFirst=qa,Fn.lt=la,Fn.lte=ha,Fn.max=function(t){return t&&t.length?fr(t,ru,Sr):i},Fn.maxBy=function(t,e){return t&&t.length?fr(t,ss(e,2),Sr):i},Fn.mean=function(t){return je(t,ru)},Fn.meanBy=function(t,e){return je(t,ss(e,2))},Fn.min=function(t){return t&&t.length?fr(t,ru,Rr):i},Fn.minBy=function(t,e){return t&&t.length?fr(t,ss(e,2),Rr):i},Fn.stubArray=gu,Fn.stubFalse=mu,Fn.stubObject=function(){return{}},Fn.stubString=function(){return""},Fn.stubTrue=function(){return!0},Fn.multiply=xu,Fn.nth=function(t,e){return t&&t.length?zr(t,pa(e)):i},Fn.noConflict=function(){return se._===this&&(se._=Lt),this},Fn.noop=uu,Fn.now=To,Fn.pad=function(t,e,n){t=ba(t);var r=(e=pa(e))?sn(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Ui(ln(i),n)+t+Ui(Fe(i),n)},Fn.padEnd=function(t,e,n){t=ba(t);var r=(e=pa(e))?sn(t):0;return e&&r<e?t+Ui(e-r,n):t},Fn.padStart=function(t,e,n){t=ba(t);var r=(e=pa(e))?sn(t):0;return e&&r<e?Ui(e-r,n)+t:t},Fn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),_n(ba(t).replace(rt,""),e||0)},Fn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&ms(t,e,n)&&(e=n=i),n===i&&("boolean"==typeof e?(n=e,e=i):"boolean"==typeof t&&(n=t,t=i)),t===i&&e===i?(t=0,e=1):(t=fa(t),e===i?(e=t,t=0):e=fa(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var s=vn();return yn(t+s*(e-t+ee("1e-"+((s+"").length-1))),e)}return $r(t,e)},Fn.reduce=function(t,e,n){var r=Ho(t)?Ce:Be,i=arguments.length<3;return r(t,ss(e,4),n,i,lr)},Fn.reduceRight=function(t,e,n){var r=Ho(t)?Ie:Be,i=arguments.length<3;return r(t,ss(e,4),n,i,hr)},Fn.repeat=function(t,e,n){return e=(n?ms(t,e,n):e===i)?1:pa(e),qr(ba(t),e)},Fn.replace=function(){var t=arguments,e=ba(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Fn.result=function(t,e,n){var r=-1,s=(e=mi(e,t)).length;for(s||(s=1,t=i);++r<s;){var o=null==t?i:t[js(e[r])];o===i&&(r=s,o=n),t=Yo(o)?o.call(t):o}return t},Fn.round=Eu,Fn.runInContext=t,Fn.sample=function(t){return(Ho(t)?Kn:Xr)(t)},Fn.size=function(t){if(null==t)return 0;if(qo(t))return aa(t)?sn(t):t.length;var e=hs(t);return e==x||e==C?t.size:Nr(t).length},Fn.snakeCase=Wa,Fn.some=function(t,e,n){var r=Ho(t)?De:ei;return n&&ms(t,e,n)&&(e=i),r(t,ss(e,3))},Fn.sortedIndex=function(t,e){return ni(t,e)},Fn.sortedIndexBy=function(t,e,n){return ri(t,e,ss(n,2))},Fn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=ni(t,e);if(r<n&&zo(t[r],e))return r}return-1},Fn.sortedLastIndex=function(t,e){return ni(t,e,!0)},Fn.sortedLastIndexBy=function(t,e,n){return ri(t,e,ss(n,2),!0)},Fn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=ni(t,e,!0)-1;if(zo(t[n],e))return n}return-1},Fn.startCase=Xa,Fn.startsWith=function(t,e,n){return t=ba(t),n=null==n?0:sr(pa(n),0,t.length),e=oi(e),t.slice(n,n+e.length)==e},Fn.subtract=Su,Fn.sum=function(t){return t&&t.length?ze(t,ru):0},Fn.sumBy=function(t,e){return t&&t.length?ze(t,ss(e,2)):0},Fn.template=function(t,e,n){var r=Fn.templateSettings;n&&ms(t,e,n)&&(e=i),t=ba(t),e=wa({},e,r,Ki);var s,o,a=wa({},e.imports,r.imports,Ki),u=Oa(a),c=He(a,u),l=0,h=e.interpolate||_t,d="__p += '",f=At((e.escape||_t).source+"|"+h.source+"|"+(h===Y?ht:_t).source+"|"+(e.evaluate||_t).source+"|$","g"),p="//# sourceURL="+(Mt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Yt+"]")+"\n";t.replace(f,function(e,n,r,i,a,u){return r||(r=i),d+=t.slice(l,u).replace(vt,Ye),n&&(s=!0,d+="' +\n__e("+n+") +\n'"),a&&(o=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+e.length,e}),d+="';\n";var g=Mt.call(e,"variable")&&e.variable;if(g){if(ct.test(g))throw new wt("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(V,""):d).replace(G,"$1").replace(H,"$1;"),d="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=Qa(function(){return xt(u,p+"return "+d).apply(i,c)});if(m.source=d,Zo(m))throw m;return m},Fn.times=function(t,e){if((t=pa(t))<1||t>h)return[];var n=f,r=yn(t,f);e=ss(e),t-=f;for(var i=Ue(r,e);++n<t;)e(n);return i},Fn.toFinite=fa,Fn.toInteger=pa,Fn.toLength=ga,Fn.toLower=function(t){return ba(t).toLowerCase()},Fn.toNumber=ma,Fn.toSafeInteger=function(t){return t?sr(pa(t),-9007199254740991,h):0===t?t:0},Fn.toString=ba,Fn.toUpper=function(t){return ba(t).toUpperCase()},Fn.trim=function(t,e,n){if((t=ba(t))&&(n||e===i))return Ve(t);if(!t||!(e=oi(e)))return t;var r=on(t),s=on(e);return bi(r,qe(r,s),We(r,s)+1).join("")},Fn.trimEnd=function(t,e,n){if((t=ba(t))&&(n||e===i))return t.slice(0,an(t)+1);if(!t||!(e=oi(e)))return t;var r=on(t);return bi(r,0,We(r,on(e))+1).join("")},Fn.trimStart=function(t,e,n){if((t=ba(t))&&(n||e===i))return t.replace(rt,"");if(!t||!(e=oi(e)))return t;var r=on(t);return bi(r,qe(r,on(e))).join("")},Fn.truncate=function(t,e){var n=30,r="...";if(ta(e)){var s="separator"in e?e.separator:s;n="length"in e?pa(e.length):n,r="omission"in e?oi(e.omission):r}var o=(t=ba(t)).length;if(Qe(t)){var a=on(t);o=a.length}if(n>=o)return t;var u=n-sn(r);if(u<1)return r;var c=a?bi(a,0,u).join(""):t.slice(0,u);if(s===i)return c+r;if(a&&(u+=c.length-u),sa(s)){if(t.slice(u).search(s)){var l,h=c;for(s.global||(s=At(s.source,ba(dt.exec(s))+"g")),s.lastIndex=0;l=s.exec(h);)var d=l.index;c=c.slice(0,d===i?u:d)}}else if(t.indexOf(oi(s),u)!=u){var f=c.lastIndexOf(s);f>-1&&(c=c.slice(0,f))}return c+r},Fn.unescape=function(t){return(t=ba(t))&&W.test(t)?t.replace($,un):t},Fn.uniqueId=function(t){var e=++Pt;return ba(t)+e},Fn.upperCase=Ka,Fn.upperFirst=Za,Fn.each=bo,Fn.eachRight=_o,Fn.first=$s,au(Fn,(yu={},br(Fn,function(t,e){Mt.call(Fn.prototype,e)||(yu[e]=t)}),yu),{chain:!1}),Fn.VERSION="4.17.21",_e(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){Fn[t].placeholder=Fn}),_e(["drop","take"],function(t,e){Vn.prototype[t]=function(n){n=n===i?1:mn(pa(n),0);var r=this.__filtered__&&!e?new Vn(this):this.clone();return r.__filtered__?r.__takeCount__=yn(n,r.__takeCount__):r.__views__.push({size:yn(n,f),type:t+(r.__dir__<0?"Right":"")}),r},Vn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),_e(["filter","map","takeWhile"],function(t,e){var n=e+1,r=1==n||3==n;Vn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ss(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),_e(["head","last"],function(t,e){var n="take"+(e?"Right":"");Vn.prototype[t]=function(){return this[n](1).value()[0]}}),_e(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");Vn.prototype[t]=function(){return this.__filtered__?new Vn(this):this[n](1)}}),Vn.prototype.compact=function(){return this.filter(ru)},Vn.prototype.find=function(t){return this.filter(t).head()},Vn.prototype.findLast=function(t){return this.reverse().find(t)},Vn.prototype.invokeMap=Wr(function(t,e){return"function"==typeof t?new Vn(this):this.map(function(n){return Ir(n,t,e)})}),Vn.prototype.reject=function(t){return this.filter(Ro(ss(t)))},Vn.prototype.slice=function(t,e){t=pa(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Vn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==i&&(n=(e=pa(e))<0?n.dropRight(-e):n.take(e-t)),n)},Vn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Vn.prototype.toArray=function(){return this.take(f)},br(Vn.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),s=Fn[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);s&&(Fn.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,u=e instanceof Vn,c=a[0],l=u||Ho(e),h=function(t){var e=s.apply(Fn,Te([t],a));return r&&d?e[0]:e};l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var d=this.__chain__,f=!!this.__actions__.length,p=o&&!d,g=u&&!f;if(!o&&l){e=g?e:new Vn(this);var m=t.apply(e,a);return m.__actions__.push({func:fo,args:[h],thisArg:i}),new Un(m,d)}return p&&g?t.apply(this,a):(m=this.thru(h),p?r?m.value()[0]:m.value():m)})}),_e(["pop","push","shift","sort","splice","unshift"],function(t){var e=It[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Fn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Ho(i)?i:[],t)}return this[n](function(n){return e.apply(Ho(n)?n:[],t)})}}),br(Vn.prototype,function(t,e){var n=Fn[e];if(n){var r=n.name+"";Mt.call(Dn,r)||(Dn[r]=[]),Dn[r].push({name:e,func:n})}}),Dn[Li(i,2).name]=[{name:"wrapper",func:i}],Vn.prototype.clone=function(){var t=new Vn(this.__wrapped__);return t.__actions__=Ti(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ti(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ti(this.__views__),t},Vn.prototype.reverse=function(){if(this.__filtered__){var t=new Vn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Vn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ho(t),r=e<0,i=n?t.length:0,s=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var s=n[r],o=s.size;switch(s.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=yn(e,t+o);break;case"takeRight":t=mn(t,e-o)}}return{start:t,end:e}}(0,i,this.__views__),o=s.start,a=s.end,u=a-o,c=r?a:o-1,l=this.__iteratees__,h=l.length,d=0,f=yn(u,this.__takeCount__);if(!n||!r&&i==u&&f==u)return hi(t,this.__actions__);var p=[];t:for(;u--&&d<f;){for(var g=-1,m=t[c+=e];++g<h;){var y=l[g],b=y.type,_=(0,y.iteratee)(m);if(2==b)m=_;else if(!_){if(1==b)continue t;break t}}p[d++]=m}return p},Fn.prototype.at=po,Fn.prototype.chain=function(){return ho(this)},Fn.prototype.commit=function(){return new Un(this.value(),this.__chain__)},Fn.prototype.next=function(){this.__values__===i&&(this.__values__=da(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?i:this.__values__[this.__index__++]}},Fn.prototype.plant=function(t){for(var e,n=this;n instanceof zn;){var r=Fs(n);r.__index__=0,r.__values__=i,e?s.__wrapped__=r:e=r;var s=r;n=n.__wrapped__}return s.__wrapped__=t,e},Fn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Vn){var e=t;return this.__actions__.length&&(e=new Vn(this)),(e=e.reverse()).__actions__.push({func:fo,args:[Js],thisArg:i}),new Un(e,this.__chain__)}return this.thru(Js)},Fn.prototype.toJSON=Fn.prototype.valueOf=Fn.prototype.value=function(){return hi(this.__wrapped__,this.__actions__)},Fn.prototype.first=Fn.prototype.head,ie&&(Fn.prototype[ie]=function(){return this}),Fn}();se._=cn,(r=(function(){return cn}).call(e,n,e,t))===i||(t.exports=r)}).call(this)},478:function(t){t.exports=function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function n(t,n){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r={exports:{}};r.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:function(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}},changeDefaults:function(t){r.exports.defaults=t}};var i=/[&<>"']/,s=/[&<>"']/g,o=/[<>"']|&(?!#?\w+;)/,a=/[<>"']|&(?!#?\w+;)/g,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=function(t){return u[t]},l=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function h(t){return t.replace(l,function(t,e){return"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""})}var d=/(^|[^\[])\^/g,f=/[^\w:]/g,p=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i,g={},m=/^[^:]+:\/*[^/]*$/,y=/^([^:]+:)[\s\S]*$/,b=/^([^:]+:\/*[^/]*)[\s\S]*$/;function _(t,e,n){var r=t.length;if(0===r)return"";for(var i=0;i<r;){var s=t.charAt(r-i-1);if(s!==e||n){if(s===e||!n)break;i++}else i++}return t.substr(0,r-i)}var v=function(t,e){if(e){if(i.test(t))return t.replace(s,c)}else if(o.test(t))return t.replace(a,c);return t},w=h,x=function(t){for(var e,n,r=1;r<arguments.length;r++)for(n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},E=r.exports.defaults,S=_,A=function(t,e){var n=t.replace(/\|/g,function(t,e,n){for(var r=!1,i=e;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"}).split(/ \|/),r=0;if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n},T=v;function C(t,e,n){var r=e.href,i=e.title?T(e.title):null,s=t[1].replace(/\\([\[\]])/g,"$1");return"!"!==t[0].charAt(0)?{type:"link",raw:n,href:r,title:i,text:s}:{type:"image",raw:n,href:r,title:i,text:T(s)}}var I=function(){function t(t){this.options=t||E}var e=t.prototype;return e.space=function(t){var e=this.rules.block.newline.exec(t);if(e)return e[0].length>1?{type:"space",raw:e[0]}:{raw:"\n"}},e.code=function(t){var e=this.rules.block.code.exec(t);if(e){var n=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:S(n,"\n")}}},e.fences=function(t){var e=this.rules.block.fences.exec(t);if(e){var n=e[0],r=function(t,e){var n=t.match(/^(\s+)(?:```)/);if(null===n)return e;var r=n[1];return e.split("\n").map(function(t){var e=t.match(/^\s+/);return null===e?t:e[0].length>=r.length?t.slice(r.length):t}).join("\n")}(n,e[3]||"");return{type:"code",raw:n,lang:e[2]?e[2].trim():e[2],text:r}}},e.heading=function(t){var e=this.rules.block.heading.exec(t);if(e){var n=e[2].trim();if(/#$/.test(n)){var r=S(n,"#");this.options.pedantic?n=r.trim():r&&!/ $/.test(r)||(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n}}},e.nptable=function(t){var e=this.rules.block.nptable.exec(t);if(e){var n={type:"table",header:A(e[1].replace(/^ *| *\| *$/g,"")),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:e[3]?e[3].replace(/\n$/,"").split("\n"):[],raw:e[0]};if(n.header.length===n.align.length){var r,i=n.align.length;for(r=0;r<i;r++)n.align[r]=/^ *-+: *$/.test(n.align[r])?"right":/^ *:-+: *$/.test(n.align[r])?"center":/^ *:-+ *$/.test(n.align[r])?"left":null;for(i=n.cells.length,r=0;r<i;r++)n.cells[r]=A(n.cells[r],n.header.length);return n}}},e.hr=function(t){var e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}},e.blockquote=function(t){var e=this.rules.block.blockquote.exec(t);if(e){var n=e[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:e[0],text:n}}},e.list=function(t){var e=this.rules.block.list.exec(t);if(e){var n,r,i,s,o,a,u,c,l,h=e[0],d=e[2],f=d.length>1,p={type:"list",raw:h,ordered:f,start:f?+d.slice(0,-1):"",loose:!1,items:[]},g=e[0].match(this.rules.block.item),m=!1,y=g.length;i=this.rules.block.listItemStart.exec(g[0]);for(var b=0;b<y;b++){if(h=n=g[b],this.options.pedantic||(l=n.match(new RegExp("\\n\\s*\\n {0,"+(i[0].length-1)+"}\\S")))&&(o=n.length-l.index+g.slice(b+1).join("\n").length,p.raw=p.raw.substring(0,p.raw.length-o),h=n=n.substring(0,l.index),y=b+1),b!==y-1){if(s=this.rules.block.listItemStart.exec(g[b+1]),this.options.pedantic?s[1].length>i[1].length:s[1].length>=i[0].length||s[1].length>3){g.splice(b,2,g[b]+(!this.options.pedantic&&s[1].length<i[0].length&&!g[b].match(/\n$/)?"":"\n")+g[b+1]),b--,y--;continue}(!this.options.pedantic||this.options.smartLists?s[2][s[2].length-1]!==d[d.length-1]:f===(1===s[2].length))&&(o=g.slice(b+1).join("\n").length,p.raw=p.raw.substring(0,p.raw.length-o),b=y-1),i=s}r=n.length,~(n=n.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(r-=n.length,n=n.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+r+"}","gm"),"")),n=S(n,"\n"),b!==y-1&&(h+="\n"),a=m||/\n\n(?!\s*$)/.test(h),b!==y-1&&(m="\n\n"===h.slice(-2),a||(a=m)),a&&(p.loose=!0),this.options.gfm&&(c=void 0,(u=/^\[[ xX]\] /.test(n))&&(c=" "!==n[1],n=n.replace(/^\[[ xX]\] +/,""))),p.items.push({type:"list_item",raw:h,task:u,checked:c,loose:a,text:n})}return p}},e.html=function(t){var e=this.rules.block.html.exec(t);if(e)return{type:this.options.sanitize?"paragraph":"html",raw:e[0],pre:!this.options.sanitizer&&("pre"===e[1]||"script"===e[1]||"style"===e[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):T(e[0]):e[0]}},e.def=function(t){var e=this.rules.block.def.exec(t);if(e)return e[3]&&(e[3]=e[3].substring(1,e[3].length-1)),{type:"def",tag:e[1].toLowerCase().replace(/\s+/g," "),raw:e[0],href:e[2],title:e[3]}},e.table=function(t){var e=this.rules.block.table.exec(t);if(e){var n={type:"table",header:A(e[1].replace(/^ *| *\| *$/g,"")),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:e[3]?e[3].replace(/\n$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=e[0];var r,i=n.align.length;for(r=0;r<i;r++)n.align[r]=/^ *-+: *$/.test(n.align[r])?"right":/^ *:-+: *$/.test(n.align[r])?"center":/^ *:-+ *$/.test(n.align[r])?"left":null;for(i=n.cells.length,r=0;r<i;r++)n.cells[r]=A(n.cells[r].replace(/^ *\| *| *\| *$/g,""),n.header.length);return n}}},e.lheading=function(t){var e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:"="===e[2].charAt(0)?1:2,text:e[1]}},e.paragraph=function(t){var e=this.rules.block.paragraph.exec(t);if(e)return{type:"paragraph",raw:e[0],text:"\n"===e[1].charAt(e[1].length-1)?e[1].slice(0,-1):e[1]}},e.text=function(t){var e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0]}},e.escape=function(t){var e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:T(e[1])}},e.tag=function(t,e,n){var r=this.rules.inline.tag.exec(t);if(r)return!e&&/^<a /i.test(r[0])?e=!0:e&&/^<\/a>/i.test(r[0])&&(e=!1),!n&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?n=!0:n&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(n=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:e,inRawBlock:n,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):T(r[0]):r[0]}},e.link=function(t){var e=this.rules.inline.link.exec(t);if(e){var n=e[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;var r=S(n.slice(0,-1),"\\");if((n.length-r.length)%2==0)return}else{var i=function(t,e){if(-1===t.indexOf(e[1]))return-1;for(var n=t.length,r=0,i=0;i<n;i++)if("\\"===t[i])i++;else if(t[i]===e[0])r++;else if(t[i]===e[1]&&--r<0)return i;return-1}(e[2],"()");if(i>-1){var s=(0===e[0].indexOf("!")?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,s).trim(),e[3]=""}}var o=e[2],a="";if(this.options.pedantic){var u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(o);u&&(o=u[1],a=u[3])}else a=e[3]?e[3].slice(1,-1):"";return o=o.trim(),/^</.test(o)&&(o=this.options.pedantic&&!/>$/.test(n)?o.slice(1):o.slice(1,-1)),C(e,{href:o?o.replace(this.rules.inline._escapes,"$1"):o,title:a?a.replace(this.rules.inline._escapes,"$1"):a},e[0])}},e.reflink=function(t,e){var n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){var r=(n[2]||n[1]).replace(/\s+/g," ");if(!(r=e[r.toLowerCase()])||!r.href){var i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return C(n,r,n[0])}},e.emStrong=function(t,e,n){void 0===n&&(n="");var r=this.rules.inline.emStrong.lDelim.exec(t);if(r&&(!r[3]||!n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var i=r[1]||r[2]||"";if(!i||i&&(""===n||this.rules.inline.punctuation.exec(n))){var s,o,a=r[0].length-1,u=a,c=0,l="*"===r[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(l.lastIndex=0,e=e.slice(-1*t.length+a);null!=(r=l.exec(e));)if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6])if(o=s.length,r[3]||r[4])u+=o;else if(!((r[5]||r[6])&&a%3)||(a+o)%3){if(!((u-=o)>0))return o=Math.min(o,o+u+c),Math.min(a,o)%2?{type:"em",raw:t.slice(0,a+r.index+o+1),text:t.slice(1,a+r.index+o)}:{type:"strong",raw:t.slice(0,a+r.index+o+1),text:t.slice(2,a+r.index+o-1)}}else c+=o}}},e.codespan=function(t){var e=this.rules.inline.code.exec(t);if(e){var n=e[2].replace(/\n/g," "),r=/[^ ]/.test(n),i=/^ /.test(n)&&/ $/.test(n);return r&&i&&(n=n.substring(1,n.length-1)),n=T(n,!0),{type:"codespan",raw:e[0],text:n}}},e.br=function(t){var e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}},e.del=function(t){var e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2]}},e.autolink=function(t,e){var n,r,i=this.rules.inline.autolink.exec(t);if(i)return r="@"===i[2]?"mailto:"+(n=T(this.options.mangle?e(i[1]):i[1])):n=T(i[1]),{type:"link",raw:i[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}},e.url=function(t,e){var n;if(n=this.rules.inline.url.exec(t)){var r,i;if("@"===n[2])i="mailto:"+(r=T(this.options.mangle?e(n[0]):n[0]));else{var s;do{s=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(s!==n[0]);r=T(n[0]),i="www."===n[1]?"http://"+r:r}return{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}},e.inlineText=function(t,e,n){var r,i=this.rules.inline.text.exec(t);if(i)return r=e?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):T(i[0]):i[0]:T(this.options.smartypants?n(i[0]):i[0]),{type:"text",raw:i[0],text:r}},t}(),D={exec:function(){}},k=function(t,e){t=t.source||t,e=e||"";var n={replace:function(e,r){return r=(r=r.source||r).replace(d,"$1"),t=t.replace(e,r),n},getRegex:function(){return new RegExp(t,e)}};return n},O=x,M={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:D,table:D,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};M.def=k(M.def).replace("label",M._label).replace("title",M._title).getRegex(),M.bullet=/(?:[*+-]|\d{1,9}[.)])/,M.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,M.item=k(M.item,"gm").replace(/bull/g,M.bullet).getRegex(),M.listItemStart=k(/^( *)(bull) */).replace("bull",M.bullet).getRegex(),M.list=k(M.list).replace(/bull/g,M.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+M.def.source+")").getRegex(),M._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",M._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,M.html=k(M.html,"i").replace("comment",M._comment).replace("tag",M._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),M.paragraph=k(M._paragraph).replace("hr",M.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",M._tag).getRegex(),M.blockquote=k(M.blockquote).replace("paragraph",M.paragraph).getRegex(),M.normal=O({},M),M.gfm=O({},M.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),M.gfm.nptable=k(M.gfm.nptable).replace("hr",M.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",M._tag).getRegex(),M.gfm.table=k(M.gfm.table).replace("hr",M.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",M._tag).getRegex(),M.pedantic=O({},M.normal,{html:k("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",M._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:D,paragraph:k(M.normal._paragraph).replace("hr",M.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",M.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var P={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:D,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:D,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};P.punctuation=k(P.punctuation).replace(/punctuation/g,P._punctuation).getRegex(),P.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,P.escapedEmSt=/\\\*|\\_/g,P._comment=k(M._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),P.emStrong.lDelim=k(P.emStrong.lDelim).replace(/punct/g,P._punctuation).getRegex(),P.emStrong.rDelimAst=k(P.emStrong.rDelimAst,"g").replace(/punct/g,P._punctuation).getRegex(),P.emStrong.rDelimUnd=k(P.emStrong.rDelimUnd,"g").replace(/punct/g,P._punctuation).getRegex(),P._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,P._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,P._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,P.autolink=k(P.autolink).replace("scheme",P._scheme).replace("email",P._email).getRegex(),P._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,P.tag=k(P.tag).replace("comment",P._comment).replace("attribute",P._attribute).getRegex(),P._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,P._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,P._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,P.link=k(P.link).replace("label",P._label).replace("href",P._href).replace("title",P._title).getRegex(),P.reflink=k(P.reflink).replace("label",P._label).getRegex(),P.reflinkSearch=k(P.reflinkSearch,"g").replace("reflink",P.reflink).replace("nolink",P.nolink).getRegex(),P.normal=O({},P),P.pedantic=O({},P.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:k(/^!?\[(label)\]\((.*?)\)/).replace("label",P._label).getRegex(),reflink:k(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",P._label).getRegex()}),P.gfm=O({},P.normal,{escape:k(P.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),P.gfm.url=k(P.gfm.url,"i").replace("email",P.gfm._extended_email).getRegex(),P.breaks=O({},P.gfm,{br:k(P.br).replace("{2,}","*").getRegex(),text:k(P.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var N={block:M,inline:P},R=I,j=r.exports.defaults,L=N.block,F=N.inline,B=function(t,e){if(e<1)return"";for(var n="";e>1;)1&e&&(n+=t),e>>=1,t+=t;return n+t};function z(t){return t.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function U(t){var e,n,r="",i=t.length;for(e=0;e<i;e++)n=t.charCodeAt(e),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}var V=function(){function e(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||j,this.options.tokenizer=this.options.tokenizer||new R,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var e={block:L.normal,inline:F.normal};this.options.pedantic?(e.block=L.pedantic,e.inline=F.pedantic):this.options.gfm&&(e.block=L.gfm,e.inline=this.options.breaks?F.breaks:F.gfm),this.tokenizer.rules=e}e.lex=function(t,n){return new e(n).lex(t)},e.lexInline=function(t,n){return new e(n).inlineTokens(t)};var n,r,i=e.prototype;return i.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(t,this.tokens,!0),this.inline(this.tokens),this.tokens},i.blockTokens=function(t,e,n){var r,i,s,o,a,u,c=this;for(void 0===e&&(e=[]),void 0===n&&(n=!0),this.options.pedantic&&(t=t.replace(/^ +$/gm,""));t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(n){return!!(r=n.call(c,t,e))&&(t=t.substring(r.raw.length),e.push(r),!0)})))if(r=this.tokenizer.space(t))t=t.substring(r.raw.length),r.type&&e.push(r);else if(r=this.tokenizer.code(t))t=t.substring(r.raw.length),(o=e[e.length-1])&&"paragraph"===o.type?(o.raw+="\n"+r.raw,o.text+="\n"+r.text):e.push(r);else if(r=this.tokenizer.fences(t))t=t.substring(r.raw.length),e.push(r);else if(r=this.tokenizer.heading(t))t=t.substring(r.raw.length),e.push(r);else if(r=this.tokenizer.nptable(t))t=t.substring(r.raw.length),e.push(r);else if(r=this.tokenizer.hr(t))t=t.substring(r.raw.length),e.push(r);else if(r=this.tokenizer.blockquote(t))t=t.substring(r.raw.length),r.tokens=this.blockTokens(r.text,[],n),e.push(r);else if(r=this.tokenizer.list(t)){for(t=t.substring(r.raw.length),s=r.items.length,i=0;i<s;i++)r.items[i].tokens=this.blockTokens(r.items[i].text,[],!1);e.push(r)}else if(r=this.tokenizer.html(t))t=t.substring(r.raw.length),e.push(r);else if(n&&(r=this.tokenizer.def(t)))t=t.substring(r.raw.length),this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});else if(r=this.tokenizer.table(t))t=t.substring(r.raw.length),e.push(r);else if(r=this.tokenizer.lheading(t))t=t.substring(r.raw.length),e.push(r);else if(a=t,this.options.extensions&&this.options.extensions.startBlock&&function(){var e=1/0,n=t.slice(1),r=void 0;c.options.extensions.startBlock.forEach(function(t){"number"==typeof(r=t.call(this,n))&&r>=0&&(e=Math.min(e,r))}),e<1/0&&e>=0&&(a=t.substring(0,e+1))}(),n&&(r=this.tokenizer.paragraph(a)))o=e[e.length-1],u&&"paragraph"===o.type?(o.raw+="\n"+r.raw,o.text+="\n"+r.text):e.push(r),u=a.length!==t.length,t=t.substring(r.raw.length);else if(r=this.tokenizer.text(t))t=t.substring(r.raw.length),(o=e[e.length-1])&&"text"===o.type?(o.raw+="\n"+r.raw,o.text+="\n"+r.text):e.push(r);else if(t){var l="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(l);break}throw new Error(l)}return e},i.inline=function(t){var e,n,r,i,s,o,a=t.length;for(e=0;e<a;e++)switch((o=t[e]).type){case"paragraph":case"text":case"heading":o.tokens=[],this.inlineTokens(o.text,o.tokens);break;case"table":for(o.tokens={header:[],cells:[]},i=o.header.length,n=0;n<i;n++)o.tokens.header[n]=[],this.inlineTokens(o.header[n],o.tokens.header[n]);for(i=o.cells.length,n=0;n<i;n++)for(s=o.cells[n],o.tokens.cells[n]=[],r=0;r<s.length;r++)o.tokens.cells[n][r]=[],this.inlineTokens(s[r],o.tokens.cells[n][r]);break;case"blockquote":this.inline(o.tokens);break;case"list":for(i=o.items.length,n=0;n<i;n++)this.inline(o.items[n].tokens)}return t},i.inlineTokens=function(t,e,n,r){var i,s,o,a=this;void 0===e&&(e=[]),void 0===n&&(n=!1),void 0===r&&(r=!1);var u,c,l,h=t;if(this.tokens.links){var d=Object.keys(this.tokens.links);if(d.length>0)for(;null!=(u=this.tokenizer.rules.inline.reflinkSearch.exec(h));)d.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(h=h.slice(0,u.index)+"["+B("a",u[0].length-2)+"]"+h.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(u=this.tokenizer.rules.inline.blockSkip.exec(h));)h=h.slice(0,u.index)+"["+B("a",u[0].length-2)+"]"+h.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(u=this.tokenizer.rules.inline.escapedEmSt.exec(h));)h=h.slice(0,u.index)+"++"+h.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;t;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(n){return!!(i=n.call(a,t,e))&&(t=t.substring(i.raw.length),e.push(i),!0)})))if(i=this.tokenizer.escape(t))t=t.substring(i.raw.length),e.push(i);else if(i=this.tokenizer.tag(t,n,r))t=t.substring(i.raw.length),n=i.inLink,r=i.inRawBlock,(s=e[e.length-1])&&"text"===i.type&&"text"===s.type?(s.raw+=i.raw,s.text+=i.text):e.push(i);else if(i=this.tokenizer.link(t))t=t.substring(i.raw.length),"link"===i.type&&(i.tokens=this.inlineTokens(i.text,[],!0,r)),e.push(i);else if(i=this.tokenizer.reflink(t,this.tokens.links))t=t.substring(i.raw.length),s=e[e.length-1],"link"===i.type?(i.tokens=this.inlineTokens(i.text,[],!0,r),e.push(i)):s&&"text"===i.type&&"text"===s.type?(s.raw+=i.raw,s.text+=i.text):e.push(i);else if(i=this.tokenizer.emStrong(t,h,l))t=t.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],n,r),e.push(i);else if(i=this.tokenizer.codespan(t))t=t.substring(i.raw.length),e.push(i);else if(i=this.tokenizer.br(t))t=t.substring(i.raw.length),e.push(i);else if(i=this.tokenizer.del(t))t=t.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],n,r),e.push(i);else if(i=this.tokenizer.autolink(t,U))t=t.substring(i.raw.length),e.push(i);else if(n||!(i=this.tokenizer.url(t,U))){if(o=t,this.options.extensions&&this.options.extensions.startInline&&function(){var e=1/0,n=t.slice(1),r=void 0;a.options.extensions.startInline.forEach(function(t){"number"==typeof(r=t.call(this,n))&&r>=0&&(e=Math.min(e,r))}),e<1/0&&e>=0&&(o=t.substring(0,e+1))}(),i=this.tokenizer.inlineText(o,r,z))t=t.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(l=i.raw.slice(-1)),c=!0,(s=e[e.length-1])&&"text"===s.type?(s.raw+=i.raw,s.text+=i.text):e.push(i);else if(t){var f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}throw new Error(f)}}else t=t.substring(i.raw.length),e.push(i);return e},n=e,r=[{key:"rules",get:function(){return{block:L,inline:F}}}],null&&t(n.prototype,null),r&&t(n,r),e}(),G=r.exports.defaults,H=function(t,e,n){if(t){var r;try{r=decodeURIComponent(h(n)).replace(f,"").toLowerCase()}catch(i){return null}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return null}e&&!p.test(n)&&(n=function(t,e){g[" "+t]||(g[" "+t]=m.test(t)?t+"/":_(t,"/",!0));var n=-1===(t=g[" "+t]).indexOf(":");return"//"===e.substring(0,2)?n?e:t.replace(y,"$1")+e:"/"===e.charAt(0)?n?e:t.replace(b,"$1")+e:t+e}(e,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(i){return null}return n},$=v,q=function(){function t(t){this.options=t||G}var e=t.prototype;return e.code=function(t,e,n){var r=(e||"").match(/\S*/)[0];if(this.options.highlight){var i=this.options.highlight(t,r);null!=i&&i!==t&&(n=!0,t=i)}return t=t.replace(/\n$/,"")+"\n",r?'<pre><code class="'+this.options.langPrefix+$(r,!0)+'">'+(n?t:$(t,!0))+"</code></pre>\n":"<pre><code>"+(n?t:$(t,!0))+"</code></pre>\n"},e.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},e.html=function(t){return t},e.heading=function(t,e,n,r){return this.options.headerIds?"<h"+e+' id="'+this.options.headerPrefix+r.slug(n)+'">'+t+"</h"+e+">\n":"<h"+e+">"+t+"</h"+e+">\n"},e.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},e.list=function(t,e,n){var r=e?"ol":"ul";return"<"+r+(e&&1!==n?' start="'+n+'"':"")+">\n"+t+"</"+r+">\n"},e.listitem=function(t){return"<li>"+t+"</li>\n"},e.checkbox=function(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},e.paragraph=function(t){return"<p>"+t+"</p>\n"},e.table=function(t,e){return e&&(e="<tbody>"+e+"</tbody>"),"<table>\n<thead>\n"+t+"</thead>\n"+e+"</table>\n"},e.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},e.tablecell=function(t,e){var n=e.header?"th":"td";return(e.align?"<"+n+' align="'+e.align+'">':"<"+n+">")+t+"</"+n+">\n"},e.strong=function(t){return"<strong>"+t+"</strong>"},e.em=function(t){return"<em>"+t+"</em>"},e.codespan=function(t){return"<code>"+t+"</code>"},e.br=function(){return this.options.xhtml?"<br/>":"<br>"},e.del=function(t){return"<del>"+t+"</del>"},e.link=function(t,e,n){if(null===(t=H(this.options.sanitize,this.options.baseUrl,t)))return n;var r='<a href="'+$(t)+'"';return e&&(r+=' title="'+e+'"'),r+">"+n+"</a>"},e.image=function(t,e,n){if(null===(t=H(this.options.sanitize,this.options.baseUrl,t)))return n;var r='<img src="'+t+'" alt="'+n+'"';return e&&(r+=' title="'+e+'"'),r+(this.options.xhtml?"/>":">")},e.text=function(t){return t},t}(),W=function(){function t(){}var e=t.prototype;return e.strong=function(t){return t},e.em=function(t){return t},e.codespan=function(t){return t},e.del=function(t){return t},e.html=function(t){return t},e.text=function(t){return t},e.link=function(t,e,n){return""+n},e.image=function(t,e,n){return""+n},e.br=function(){return""},t}(),X=function(){function t(){this.seen={}}var e=t.prototype;return e.serialize=function(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},e.getNextSafeSlug=function(t,e){var n=t,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[t];do{n=t+"-"+ ++r}while(this.seen.hasOwnProperty(n))}return e||(this.seen[t]=r,this.seen[n]=0),n},e.slug=function(t,e){void 0===e&&(e={});var n=this.serialize(t);return this.getNextSafeSlug(n,e.dryrun)},t}(),K=q,Z=W,Y=X,Q=r.exports.defaults,J=w,tt=V,et=function(){function t(t){this.options=t||Q,this.options.renderer=this.options.renderer||new K,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Z,this.slugger=new Y}t.parse=function(e,n){return new t(n).parse(e)},t.parseInline=function(e,n){return new t(n).parseInline(e)};var e=t.prototype;return e.parse=function(t,e){void 0===e&&(e=!0);var n,r,i,s,o,a,u,c,l,h,d,f,p,g,m,y,b,_,v,w="",x=t.length;for(n=0;n<x;n++)if(h=t[n],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[h.type])||!1===(v=this.options.extensions.renderers[h.type].call(this,h))&&["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(h.type))switch(h.type){case"space":continue;case"hr":w+=this.renderer.hr();continue;case"heading":w+=this.renderer.heading(this.parseInline(h.tokens),h.depth,J(this.parseInline(h.tokens,this.textRenderer)),this.slugger);continue;case"code":w+=this.renderer.code(h.text,h.lang,h.escaped);continue;case"table":for(c="",u="",s=h.header.length,r=0;r<s;r++)u+=this.renderer.tablecell(this.parseInline(h.tokens.header[r]),{header:!0,align:h.align[r]});for(c+=this.renderer.tablerow(u),l="",s=h.cells.length,r=0;r<s;r++){for(u="",o=(a=h.tokens.cells[r]).length,i=0;i<o;i++)u+=this.renderer.tablecell(this.parseInline(a[i]),{header:!1,align:h.align[i]});l+=this.renderer.tablerow(u)}w+=this.renderer.table(c,l);continue;case"blockquote":l=this.parse(h.tokens),w+=this.renderer.blockquote(l);continue;case"list":for(d=h.ordered,f=h.start,p=h.loose,s=h.items.length,l="",r=0;r<s;r++)y=(m=h.items[r]).checked,b=m.task,g="",m.task&&(_=this.renderer.checkbox(y),p?m.tokens.length>0&&"text"===m.tokens[0].type?(m.tokens[0].text=_+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=_+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:_}):g+=_),g+=this.parse(m.tokens,p),l+=this.renderer.listitem(g,b,y);w+=this.renderer.list(l,d,f);continue;case"html":w+=this.renderer.html(h.text);continue;case"paragraph":w+=this.renderer.paragraph(this.parseInline(h.tokens));continue;case"text":for(l=h.tokens?this.parseInline(h.tokens):h.text;n+1<x&&"text"===t[n+1].type;)l+="\n"+((h=t[++n]).tokens?this.parseInline(h.tokens):h.text);w+=e?this.renderer.paragraph(l):l;continue;default:var E='Token with "'+h.type+'" type was not found.';if(this.options.silent)return void console.error(E);throw new Error(E)}else w+=v||"";return w},e.parseInline=function(t,e){e=e||this.renderer;var n,r,i,s="",o=t.length;for(n=0;n<o;n++)if(r=t[n],!(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type])||!1===(i=this.options.extensions.renderers[r.type].call(this,r))&&["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type))switch(r.type){case"escape":s+=e.text(r.text);break;case"html":s+=e.html(r.text);break;case"link":s+=e.link(r.href,r.title,this.parseInline(r.tokens,e));break;case"image":s+=e.image(r.href,r.title,r.text);break;case"strong":s+=e.strong(this.parseInline(r.tokens,e));break;case"em":s+=e.em(this.parseInline(r.tokens,e));break;case"codespan":s+=e.codespan(r.text);break;case"br":s+=e.br();break;case"del":s+=e.del(this.parseInline(r.tokens,e));break;case"text":s+=e.text(r.text);break;default:var a='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(a);throw new Error(a)}else s+=i||"";return s},t}(),nt=I,rt=q,it=W,st=X,ot=x,at=function(t){t&&t.sanitize&&!t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},ut=v,ct=r.exports.getDefaults,lt=r.exports.changeDefaults,ht=r.exports.defaults;function dt(t,e,n){if(null==t)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof t)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");if("function"==typeof e&&(n=e,e=null),e=ot({},dt.defaults,e||{}),at(e),n){var r,i=e.highlight;try{r=tt.lex(t,e)}catch(u){return n(u)}var s=function(t){var s;if(!t)try{e.walkTokens&&dt.walkTokens(r,e.walkTokens),s=et.parse(r,e)}catch(u){t=u}return e.highlight=i,t?n(t):n(null,s)};if(!i||i.length<3)return s();if(delete e.highlight,!r.length)return s();var o=0;return dt.walkTokens(r,function(t){"code"===t.type&&(o++,setTimeout(function(){i(t.text,t.lang,function(e,n){if(e)return s(e);null!=n&&n!==t.text&&(t.text=n,t.escaped=!0),0==--o&&s()})},0))}),void(0===o&&s())}try{var a=tt.lex(t,e);return e.walkTokens&&dt.walkTokens(a,e.walkTokens),et.parse(a,e)}catch(u){if(u.message+="\nPlease report this to https://github.com/markedjs/marked.",e.silent)return"<p>An error occurred:</p><pre>"+ut(u.message+"",!0)+"</pre>";throw u}}return dt.options=dt.setOptions=function(t){return ot(dt.defaults,t),lt(dt.defaults),dt},dt.getDefaults=ct,dt.defaults=ht,dt.use=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i,s=ot.apply(void 0,[{}].concat(n)),o=dt.defaults.extensions||{renderers:{},childTokens:{}};n.forEach(function(e){if(e.extensions&&(i=!0,e.extensions.forEach(function(t){if(!t.name)throw new Error("extension name required");if(t.renderer){var e=o.renderers?o.renderers[t.name]:null;o.renderers[t.name]=e?function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var s=t.renderer.apply(this,r);return!1===s&&(s=e.apply(this,r)),s}:t.renderer}if(t.tokenizer){if(!t.level||"block"!==t.level&&"inline"!==t.level)throw new Error("extension level must be 'block' or 'inline'");o[t.level]?o[t.level].unshift(t.tokenizer):o[t.level]=[t.tokenizer],t.start&&("block"===t.level?o.startBlock?o.startBlock.push(t.start):o.startBlock=[t.start]:"inline"===t.level&&(o.startInline?o.startInline.push(t.start):o.startInline=[t.start]))}t.childTokens&&(o.childTokens[t.name]=t.childTokens)})),e.renderer&&function(){var t=dt.defaults.renderer||new rt,n=function(n){var r=t[n];t[n]=function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];var a=e.renderer[n].apply(t,s);return!1===a&&(a=r.apply(t,s)),a}};for(var r in e.renderer)n(r);s.renderer=t}(),e.tokenizer&&function(){var t=dt.defaults.tokenizer||new nt,n=function(n){var r=t[n];t[n]=function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];var a=e.tokenizer[n].apply(t,s);return!1===a&&(a=r.apply(t,s)),a}};for(var r in e.tokenizer)n(r);s.tokenizer=t}(),e.walkTokens){var n=dt.defaults.walkTokens;s.walkTokens=function(r){e.walkTokens.call(t,r),n&&n(r)}}i&&(s.extensions=o),dt.setOptions(s)})},dt.walkTokens=function(t,e){for(var r,i=function(){var t=r.value;switch(e(t),t.type){case"table":for(var i,s=n(t.tokens.header);!(i=s()).done;)dt.walkTokens(i.value,e);for(var o,a=n(t.tokens.cells);!(o=a()).done;)for(var u,c=n(o.value);!(u=c()).done;)dt.walkTokens(u.value,e);break;case"list":dt.walkTokens(t.items,e);break;default:dt.defaults.extensions&&dt.defaults.extensions.childTokens&&dt.defaults.extensions.childTokens[t.type]?dt.defaults.extensions.childTokens[t.type].forEach(function(n){dt.walkTokens(t[n],e)}):t.tokens&&dt.walkTokens(t.tokens,e)}},s=n(t);!(r=s()).done;)i()},dt.parseInline=function(t,e){if(null==t)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof t)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");e=ot({},dt.defaults,e||{}),at(e);try{var n=tt.lexInline(t,e);return e.walkTokens&&dt.walkTokens(n,e.walkTokens),et.parseInline(n,e)}catch(r){if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",e.silent)return"<p>An error occurred:</p><pre>"+ut(r.message+"",!0)+"</pre>";throw r}},dt.Parser=et,dt.parser=et.parse,dt.Renderer=rt,dt.TextRenderer=it,dt.Lexer=tt,dt.lexer=tt.lex,dt.Tokenizer=nt,dt.Slugger=st,dt.parse=dt,dt}()},369:(t,e,n)=>{var r=n(284),i=n(830);function s(){this.clear()}s.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},s.prototype.enqueue=function(t){return this.items.push(t),++this.size},s.prototype.dequeue=function(){if(this.size){var t=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,t}},s.prototype.peek=function(){if(this.size)return this.items[this.offset]},s.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var n=this.offset,r=0,i=this.items.length;n<i;n++,r++)t.call(e,this.items[n],r,this)},s.prototype.toArray=function(){return this.items.slice(this.offset)},s.prototype.values=function(){var t=this.items,e=this.offset;return new r(function(){if(e>=t.length)return{done:!0};var n=t[e];return e++,{value:n,done:!1}})},s.prototype.entries=function(){var t=this.items,e=this.offset,n=0;return new r(function(){if(e>=t.length)return{done:!0};var r=t[e];return e++,{value:[n++,r],done:!1}})},"undefined"!=typeof Symbol&&(s.prototype[Symbol.iterator]=s.prototype.values),s.prototype.toString=function(){return this.toArray().join(",")},s.prototype.toJSON=function(){return this.toArray()},s.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:s,enumerable:!1}),t},"undefined"!=typeof Symbol&&(s.prototype[Symbol.for("nodejs.util.inspect.custom")]=s.prototype.inspect),s.from=function(t){var e=new s;return i(t,function(t){e.enqueue(t)}),e},s.of=function(){return s.from(arguments)},t.exports=s},830:t=>{var e="undefined"!=typeof ArrayBuffer,n="undefined"!=typeof Symbol;function r(t,r){var i,s,o,a,u;if(!t)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof r)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(t)||e&&ArrayBuffer.isView(t)||"string"==typeof t||"[object Arguments]"===t.toString())for(o=0,a=t.length;o<a;o++)r(t[o],o);else if("function"!=typeof t.forEach)if(n&&Symbol.iterator in t&&"function"!=typeof t.next&&(t=t[Symbol.iterator]()),"function"!=typeof t.next)for(s in t)t.hasOwnProperty(s)&&r(t[s],s);else for(i=t,o=0;!0!==(u=i.next()).done;)r(u.value,o),o++;else t.forEach(r)}r.forEachWithNullKeys=function(t,r){var i,s,o,a,u;if(!t)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof r)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(t)||e&&ArrayBuffer.isView(t)||"string"==typeof t||"[object Arguments]"===t.toString())for(o=0,a=t.length;o<a;o++)r(t[o],null);else if(t instanceof Set)t.forEach(function(t){r(t,null)});else if("function"!=typeof t.forEach)if(n&&Symbol.iterator in t&&"function"!=typeof t.next&&(t=t[Symbol.iterator]()),"function"!=typeof t.next)for(s in t)t.hasOwnProperty(s)&&r(t[s],s);else for(i=t,o=0;!0!==(u=i.next()).done;)r(u.value,null),o++;else t.forEach(r)},t.exports=r},284:t=>{function e(t){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:t}),this.done=!1}e.prototype.next=function(){if(this.done)return{done:!0};var t=this._next();return t.done&&(this.done=!0),t},"undefined"!=typeof Symbol&&(e.prototype[Symbol.iterator]=function(){return this}),e.of=function(){var t=arguments,n=t.length,r=0;return new e(function(){return r>=n?{done:!0}:{done:!1,value:t[r++]}})},e.empty=function(){var t=new e(null);return t.done=!0,t},e.is=function(t){return t instanceof e||"object"==typeof t&&null!==t&&"function"==typeof t.next},t.exports=e},310:(t,e,n)=>{"use strict";var r=n(948);Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=function(){return void 0!==i.window.orientation},e.default=function(t){if(!t&&!(0,s.default)())return"Node";if((0,o.default)(t))return"Electron";var e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"};var i=n(151),s=r(n(602)),o=r(n(344))},151:(t,e,n)=>{"use strict";var r=n(948);Object.defineProperty(e,"__esModule",{value:!0}),e.console=e.process=e.document=e.global=e.window=e.self=void 0;var i=r(n(321)),s={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&process};e.self=s.self||s.window||s.global,e.window=s.window||s.self||s.global,e.global=s.global||s.self||s.window,e.document=s.document||{},e.process=s.process||{};var o=console;e.console=o},761:(t,e,n)=>{"use strict";var r=n(948),i=n(321);Object.defineProperty(e,"CO",{enumerable:!0,get:function(){return s.global}}),Object.defineProperty(e,"jU",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"qs",{enumerable:!0,get:function(){return a.default}});var s=n(151),o=c(n(602)),a=c(n(310));function u(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(u=function(t){return t?n:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=u(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var a=s?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}r(n(344))},602:(t,e,n)=>{"use strict";var r=n(948);Object.defineProperty(e,"__esModule",{value:!0}),e.default=o,e.isBrowserMainThread=function(){return o()&&"undefined"!=typeof document};var i=r(n(321)),s=r(n(344));function o(){return!("object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,s.default)()}},344:(t,e,n)=>{"use strict";var r=n(948);Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"!=typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===(0,i.default)(process.versions)&&Boolean(process.versions.electron))return!0;var e="object"===("undefined"==typeof navigator?"undefined":(0,i.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)};var i=r(n(321))},991:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(180),e),i(n(103),e),i(n(965),e),i(n(595),e),i(n(417),e),i(n(451),e),i(n(735),e)},180:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlankNode=void 0,e.BlankNode=class{constructor(t){this.termType="BlankNode",this.value=t}equals(t){return!!t&&"BlankNode"===t.termType&&t.value===this.value}}},103:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataFactory=void 0;const r=n(180),i=n(965),s=n(595),o=n(417),a=n(451),u=n(735);let c=0;e.DataFactory=class{constructor(t){this.blankNodeCounter=0,this.blankNodePrefix=(t=t||{}).blankNodePrefix||`df_${c++}_`}namedNode(t){return new o.NamedNode(t)}blankNode(t){return new r.BlankNode(t||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(t,e){return new s.Literal(t,e)}variable(t){return new u.Variable(t)}defaultGraph(){return i.DefaultGraph.INSTANCE}quad(t,e,n,r){return new a.Quad(t,e,n,r||this.defaultGraph())}fromTerm(t){switch(t.termType){case"NamedNode":return this.namedNode(t.value);case"BlankNode":return this.blankNode(t.value);case"Literal":return t.language?this.literal(t.value,t.language):t.datatype.equals(s.Literal.XSD_STRING)?this.literal(t.value):this.literal(t.value,this.fromTerm(t.datatype));case"Variable":return this.variable(t.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(t.subject),this.fromTerm(t.predicate),this.fromTerm(t.object),this.fromTerm(t.graph))}}fromQuad(t){return this.fromTerm(t)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultGraph=void 0;class n{constructor(){this.termType="DefaultGraph",this.value=""}equals(t){return!!t&&"DefaultGraph"===t.termType}}e.DefaultGraph=n,n.INSTANCE=new n},595:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Literal=void 0;const r=n(417);class i{constructor(t,e){this.termType="Literal",this.value=t,"string"==typeof e?(this.language=e,this.datatype=i.RDF_LANGUAGE_STRING):e?(this.language="",this.datatype=e):(this.language="",this.datatype=i.XSD_STRING)}equals(t){return!!t&&"Literal"===t.termType&&t.value===this.value&&t.language===this.language&&t.datatype.equals(this.datatype)}}e.Literal=i,i.RDF_LANGUAGE_STRING=new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),i.XSD_STRING=new r.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NamedNode=void 0,e.NamedNode=class{constructor(t){this.termType="NamedNode",this.value=t}equals(t){return!!t&&"NamedNode"===t.termType&&t.value===this.value}}},451:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quad=void 0,e.Quad=class{constructor(t,e,n,r){this.termType="Quad",this.value="",this.subject=t,this.predicate=e,this.object=n,this.graph=r}equals(t){return!!t&&("Quad"===t.termType||!t.termType)&&this.subject.equals(t.subject)&&this.predicate.equals(t.predicate)&&this.object.equals(t.object)&&this.graph.equals(t.graph)}}},735:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Variable=void 0,e.Variable=class{constructor(t){this.termType="Variable",this.value=t}equals(t){return!!t&&"Variable"===t.termType&&t.value===this.value}}},609:(t,e,n)=>{"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0});const i=n(991),s=n(938),o=n(60);r(n(938)),r(n(60));const a=new i.DataFactory,u=new o.Translator;function c(t,e){return u.fromRdf(t,e)}u.registerHandler(new s.TypeHandlerString,s.TypeHandlerString.TYPES.map(t=>a.namedNode(t)),["string"]),u.registerHandler(new s.TypeHandlerBoolean,[s.TypeHandlerBoolean.TYPE].map(t=>a.namedNode(t)),["boolean"]),u.registerHandler(new s.TypeHandlerNumberDouble,s.TypeHandlerNumberDouble.TYPES.map(t=>a.namedNode(t)),["number"]),u.registerHandler(new s.TypeHandlerNumberInteger,s.TypeHandlerNumberInteger.TYPES.map(t=>a.namedNode(t)),["number"]),u.registerHandler(new s.TypeHandlerDate,s.TypeHandlerDate.TYPES.map(t=>a.namedNode(t)),["object"]),e.fromRdf=c,e.toRdf=function(t,e){return e&&"namedNode"in e&&(e={dataFactory:e}),(e=e||{})&&!e.dataFactory&&(e.dataFactory=a),u.toRdf(t,e)},e.getTermRaw=function(t,e){return"Literal"===t.termType?c(t,e):t.value},e.getSupportedRdfDatatypes=function(){return u.getSupportedRdfDatatypes()},e.getSupportedJavaScriptPrimitives=function(){return u.getSupportedJavaScriptPrimitives()}},60:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(t){throw new Error(`Invalid RDF ${t.datatype.value} value: '${t.value}'`)}registerHandler(t,e,n){for(const r of e)this.supportedRdfDatatypes.push(r),this.fromRdfHandlers[r.value]=t;for(const r of n){let e=this.toRdfHandlers[r];e||(this.toRdfHandlers[r]=e=[]),e.push(t)}}fromRdf(t,e){const n=this.fromRdfHandlers[t.datatype.value];return n?n.fromRdf(t,e):t.value}toRdf(t,e){const n=this.toRdfHandlers[typeof t];if(n)for(const r of n){const n=r.toRdf(t,e);if(n)return n}throw new Error(`Invalid JavaScript value: '${t}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(60);class i{fromRdf(t,e){switch(t.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return e&&r.Translator.incorrectRdfDataType(t),!1}toRdf(t,{datatype:e,dataFactory:n}){return n.literal(t?"true":"false",e||n.namedNode(i.TYPE))}}e.TypeHandlerBoolean=i,i.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},525:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(60);class i{fromRdf(t,e){switch(e&&!t.value.match(i.VALIDATORS[t.datatype.value.substr(33,t.datatype.value.length)])&&r.Translator.incorrectRdfDataType(t),t.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(t.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const e=t.value.split("-");return new Date(0,parseInt(e[0],10)-1,parseInt(e[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(t.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(t.value+"-01");default:return new Date(t.value)}}toRdf(t,{datatype:e,dataFactory:n}){if(e=e||n.namedNode(i.TYPES[0]),!(t instanceof Date))return null;const r=t;let s;switch(e.value){case"http://www.w3.org/2001/XMLSchema#gDay":s=String(r.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":s=r.getUTCMonth()+1+"-"+r.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":s=String(r.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":s=r.getUTCFullYear()+"-"+(r.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":s=r.toISOString().replace(/T.*$/,"");break;default:s=r.toISOString()}return n.literal(s,e)}}e.TypeHandlerDate=i,i.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],i.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(60);class i{fromRdf(t,e){const n=parseFloat(t.value);return e&&isNaN(n)&&r.Translator.incorrectRdfDataType(t),n}toRdf(t,{datatype:e,dataFactory:n}){return e=e||n.namedNode(i.TYPES[0]),isNaN(t)?n.literal("NaN",e):isFinite(t)?t%1==0?null:n.literal(t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),e):n.literal(t>0?"INF":"-INF",e)}}e.TypeHandlerNumberDouble=i,i.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(60);class i{fromRdf(t,e){const n=parseInt(t.value,10);return e&&(isNaN(n)||t.value.indexOf(".")>=0)&&r.Translator.incorrectRdfDataType(t),n}toRdf(t,{datatype:e,dataFactory:n}){return n.literal(String(t),e||n.namedNode(t<=i.MAX_INT&&t>=i.MIN_INT?i.TYPES[0]:i.TYPES[1]))}}e.TypeHandlerNumberInteger=i,i.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],i.MAX_INT=2147483647,i.MIN_INT=-2147483648},608:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{fromRdf(t){return t.value}toRdf(t,{datatype:e,dataFactory:n}){return n.literal(t,e)}}e.TypeHandlerString=n,n.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:(t,e,n)=>{"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(727)),r(n(525)),r(n(554)),r(n(750)),r(n(608))},434:(t,e,n)=>{"use strict";var r={};n.r(r),n.d(r,{decode:()=>VS,encode:()=>GS});var i={};n.r(i),n.d(i,{decode:()=>qS,encode:()=>WS});var s={};n.r(s),n.d(s,{decode:()=>XS,encode:()=>KS});var o={};function a(t){return"function"==typeof t}n.r(o),n.d(o,{decode:()=>ZS,encode:()=>YS});let u=!1;const c={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else u&&console.log("RxJS: Back to a better error behavior. Thank you. <3");u=t},get useDeprecatedSynchronousErrorHandling(){return u}};function l(t){setTimeout(()=>{throw t},0)}const h={closed:!0,next(t){},error(t){if(c.useDeprecatedSynchronousErrorHandling)throw t;l(t)},complete(){}},d=Array.isArray||(t=>t&&"number"==typeof t.length);function f(t){return null!==t&&"object"==typeof t}const p=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();class g{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:e,_ctorUnsubscribe:n,_unsubscribe:r,_subscriptions:i}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,e instanceof g)e.remove(this);else if(null!==e)for(let o=0;o<e.length;++o)e[o].remove(this);if(a(r)){n&&(this._unsubscribe=void 0);try{r.call(this)}catch(s){t=s instanceof p?m(s.errors):[s]}}if(d(i)){let e=-1,n=i.length;for(;++e<n;){const n=i[e];if(f(n))try{n.unsubscribe()}catch(s){t=t||[],s instanceof p?t=t.concat(m(s.errors)):t.push(s)}}}if(t)throw new p(t)}add(t){let e=t;if(!t)return g.EMPTY;switch(typeof t){case"function":e=new g(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof g)){const t=e;e=new g,e._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:n}=e;if(null===n)e._parentOrParents=this;else if(n instanceof g){if(n===this)return e;e._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return e;n.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[e]:r.push(e),e}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}function m(t){return t.reduce((t,e)=>t.concat(e instanceof p?e.errors:e),[])}g.EMPTY=function(t){return t.closed=!0,t}(new g);const y="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class b extends g{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=h;break;case 1:if(!t){this.destination=h;break}if("object"==typeof t){t instanceof b?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new _(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new _(this,t,e,n)}}[y](){return this}static create(t,e,n){const r=new b(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class _ extends b{constructor(t,e,n,r){let i;super(),this._parentSubscriber=t;let s=this;a(e)?i=e:e&&(i=e.next,n=e.error,r=e.complete,e!==h&&(s=Object.create(e),a(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=i,this._error=n,this._complete=r}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;c.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=c;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):l(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;l(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);c.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),c.useDeprecatedSynchronousErrorHandling)throw n;l(n)}}__tryOrSetError(t,e,n){if(!c.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return c.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(l(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const v="function"==typeof Symbol&&Symbol.observable||"@@observable";function w(t){return t}let x=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof b)return t;if(t[y])return t[y]()}return t||e||n?new b(t,e,n):new b(h)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||c.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),c.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){c.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof b?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=E(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[v](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?w:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=E(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function E(t){if(t||(t=c.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const S=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class A extends g{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class T extends b{constructor(t){super(t),this.destination=t}}let C=(()=>{class t extends x{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[y](){return new T(this)}lift(t){const e=new I(this,this);return e.operator=t,e}next(t){if(this.closed)throw new S;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new S;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new S;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new S;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new S;return this.hasError?(t.error(this.thrownError),g.EMPTY):this.isStopped?(t.complete(),g.EMPTY):(this.observers.push(t),new A(this,t))}asObservable(){const t=new x;return t.source=this,t}}return t.create=(t,e)=>new I(t,e),t})();class I extends C{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):g.EMPTY}}function D(t){return t&&"function"==typeof t.schedule}function k(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new O(t,e))}}class O{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new M(t,this.project,this.thisArg))}}class M extends b{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const P=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()},N="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",R=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function j(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const L=t=>{if(t&&"function"==typeof t[v])return n=t,t=>{const e=n[v]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(R(t))return P(t);if(j(t))return(t=>e=>(t.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,l),e))(t);if(t&&"function"==typeof t[N])return e=t,t=>{const n=e[N]();for(;;){let e;try{e=n.next()}catch(r){return t.error(r),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=f(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n};function F(t,e){return new x(n=>{const r=new g;let i=0;return r.add(e.schedule(function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()})),r})}function B(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[v]}(t))return function(t,e){return new x(n=>{const r=new g;return r.add(e.schedule(()=>{const i=t[v]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(j(t))return function(t,e){return new x(n=>{const r=new g;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r})}(t,e);if(R(t))return F(t,e);if(function(t){return t&&"function"==typeof t[N]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new x(n=>{const r=new g;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[N](),r.add(e.schedule(function(){if(n.closed)return;let t,e;try{const n=i.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof x?t:new x(L(t))}class z extends b{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class U extends b{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function V(t,e){if(e.closed)return;if(t instanceof x)return t.subscribe(e);let n;try{n=L(t)(e)}catch(r){e.error(r)}return n}function G(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(G((n,r)=>B(t(n,r)).pipe(k((t,i)=>e(n,t,r,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new H(t,n)))}class H{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new $(t,this.project,this.concurrent))}}class $ extends U{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e)}_innerSub(t){const e=new z(this),n=this.destination;n.add(e);const r=V(t,e);r!==e&&n.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function q(t=Number.POSITIVE_INFINITY){return G(w,t)}function W(t,e){return e?F(t,e):new x(P(t))}function X(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return D(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof x?t[0]:q(e)(W(t,n))}function K(){return function(t){return t.lift(new Z(t))}}class Z{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new Y(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class Y extends b{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}class Q extends x{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new g,t.add(this.source.subscribe(new tt(this.getSubject(),this))),t.closed&&(this._connection=null,t=g.EMPTY)),t}refCount(){return K()(this)}}const J=(()=>{const t=Q.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class tt extends T{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function et(){return new C}function nt(){return t=>{return K()((e=et,function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,J);return r.source=t,r.subjectFactory=n,r})(t));var e}}function rt(t){for(let e in t)if(t[e]===rt)return e;throw Error("Could not find renamed property on target object.")}function it(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function st(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(st).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function ot(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const at=rt({__forward_ref__:rt});function ut(t){return t.__forward_ref__=ut,t.toString=function(){return st(this())},t}function ct(t){return lt(t)?t():t}function lt(t){return"function"==typeof t&&t.hasOwnProperty(at)&&t.__forward_ref__===ut}class ht extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function dt(t){return"string"==typeof t?t:null==t?"":String(t)}function ft(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():dt(t)}function pt(t,e){const n=e?` in ${e}`:"";throw new ht("201",`No provider for ${ft(t)} found${n}`)}function gt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function mt(t){return{providers:t.providers||[],imports:t.imports||[]}}function yt(t){return bt(t,vt)||bt(t,xt)}function bt(t,e){return t.hasOwnProperty(e)?t[e]:null}function _t(t){return t&&(t.hasOwnProperty(wt)||t.hasOwnProperty(Et))?t[wt]:null}const vt=rt({"\u0275prov":rt}),wt=rt({"\u0275inj":rt}),xt=rt({ngInjectableDef:rt}),Et=rt({ngInjectorDef:rt});var St=(()=>((St=St||{})[St.Default=0]="Default",St[St.Host=1]="Host",St[St.Self=2]="Self",St[St.SkipSelf=4]="SkipSelf",St[St.Optional=8]="Optional",St))();let At;function Tt(t){const e=At;return At=t,e}function Ct(t,e,n){const r=yt(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&St.Optional?null:void 0!==e?e:void pt(st(t),"Injector")}function It(t){return{toString:t}.toString()}var Dt=(()=>((Dt=Dt||{})[Dt.OnPush=0]="OnPush",Dt[Dt.Default=1]="Default",Dt))(),kt=(()=>((kt=kt||{})[kt.Emulated=0]="Emulated",kt[kt.None=2]="None",kt[kt.ShadowDom=3]="ShadowDom",kt))();const Ot="undefined"!=typeof globalThis&&globalThis,Mt="undefined"!=typeof window&&window,Pt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Nt="undefined"!=typeof global&&global,Rt=Ot||Nt||Mt||Pt,jt={},Lt=[],Ft=rt({"\u0275cmp":rt}),Bt=rt({"\u0275dir":rt}),zt=rt({"\u0275pipe":rt}),Ut=rt({"\u0275mod":rt}),Vt=rt({"\u0275loc":rt}),Gt=rt({"\u0275fac":rt}),Ht=rt({__NG_ELEMENT_ID__:rt});let $t=0;function qt(t){return It(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Dt.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||Lt,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||kt.Emulated,id:"c",styles:t.styles||Lt,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,i=t.features,s=t.pipes;return n.id+=$t++,n.inputs=Yt(t.inputs,e),n.outputs=Yt(t.outputs),i&&i.forEach(t=>t(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(Wt):null,n.pipeDefs=s?()=>("function"==typeof s?s():s).map(Xt):null,n})}function Wt(t){return te(t)||function(t){return t[Bt]||null}(t)}function Xt(t){return function(t){return t[zt]||null}(t)}const Kt={};function Zt(t){return It(()=>{const e={type:t.type,bootstrap:t.bootstrap||Lt,declarations:t.declarations||Lt,imports:t.imports||Lt,exports:t.exports||Lt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(Kt[t.id]=t.type),e})}function Yt(t,e){if(null==t)return jt;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}const Qt=qt;function Jt(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function te(t){return t[Ft]||null}function ee(t,e){const n=t[Ut]||null;if(!n&&!0===e)throw new Error(`Type ${st(t)} does not have '\u0275mod' property.`);return n}const ne=20,re=10;function ie(t){return Array.isArray(t)&&"object"==typeof t[1]}function se(t){return Array.isArray(t)&&!0===t[1]}function oe(t){return 0!=(8&t.flags)}function ae(t){return 2==(2&t.flags)}function ue(t){return 1==(1&t.flags)}function ce(t){return null!==t.template}function le(t,e){return t.hasOwnProperty(Gt)?t[Gt]:null}class he{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function de(){return fe}function fe(t){return t.type.prototype.ngOnChanges&&(t.setInput=ge),pe}function pe(){const t=me(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===jt)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function ge(t,e,n,r){const i=me(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:jt,current:null}),s=i.current||(i.current={}),o=i.previous,a=this.declaredInputs[n],u=o[a];s[a]=new he(u&&u.currentValue,e,o===jt),t[r]=e}function me(t){return t.__ngSimpleChanges__||null}let ye;function be(t){return!!t.listen}de.ngInherit=!0;const _e={createRenderer:(t,e)=>void 0!==ye?ye:"undefined"!=typeof document?document:void 0};function ve(t){for(;Array.isArray(t);)t=t[0];return t}function we(t,e){return ve(e[t])}function xe(t,e){return ve(e[t.index])}function Ee(t,e){return t.data[e]}function Se(t,e){return t[e]}function Ae(t,e){const n=e[t];return ie(n)?n:n[0]}function Te(t){return 4==(4&t[2])}function Ce(t){return 128==(128&t[2])}function Ie(t,e){return null==e?null:t[e]}function De(t){t[18]=0}function ke(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const Oe={lFrame:tn(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Me(){return Oe.bindingsEnabled}function Pe(){return Oe.lFrame.lView}function Ne(){return Oe.lFrame.tView}function Re(t){return Oe.lFrame.contextLView=t,t[8]}function je(){let t=Le();for(;null!==t&&64===t.type;)t=t.parent;return t}function Le(){return Oe.lFrame.currentTNode}function Fe(t,e){const n=Oe.lFrame;n.currentTNode=t,n.isParent=e}function Be(){return Oe.lFrame.isParent}function ze(){Oe.lFrame.isParent=!1}function Ue(){return Oe.isInCheckNoChangesMode}function Ve(t){Oe.isInCheckNoChangesMode=t}function Ge(){const t=Oe.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function He(){return Oe.lFrame.bindingIndex++}function $e(t){const e=Oe.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function qe(t,e){const n=Oe.lFrame;n.bindingIndex=n.bindingRootIndex=t,We(e)}function We(t){Oe.lFrame.currentDirectiveIndex=t}function Xe(){return Oe.lFrame.currentQueryIndex}function Ke(t){Oe.lFrame.currentQueryIndex=t}function Ze(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Ye(t,e,n){if(n&St.SkipSelf){let r=e,i=t;for(;r=r.parent,!(null!==r||n&St.Host||(r=Ze(i),null===r)||(i=i[15],10&r.type)););if(null===r)return!1;e=r,t=i}const r=Oe.lFrame=Je();return r.currentTNode=e,r.lView=t,!0}function Qe(t){const e=Je(),n=t[1];Oe.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Je(){const t=Oe.lFrame,e=null===t?null:t.child;return null===e?tn(t):e}function tn(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function en(){const t=Oe.lFrame;return Oe.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const nn=en;function rn(){const t=en();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function sn(){return Oe.lFrame.selectedIndex}function on(t){Oe.lFrame.selectedIndex=t}function an(){const t=Oe.lFrame;return Ee(t.tView,t.selectedIndex)}function un(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=e;r&&(t.contentHooks||(t.contentHooks=[])).push(-n,r),i&&((t.contentHooks||(t.contentHooks=[])).push(n,i),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,i)),s&&(t.viewHooks||(t.viewHooks=[])).push(-n,s),o&&((t.viewHooks||(t.viewHooks=[])).push(n,o),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,o)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(n,a)}}function cn(t,e,n){dn(t,e,3,n)}function ln(t,e,n,r){(3&t[2])===n&&dn(t,e,n,r)}function hn(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function dn(t,e,n,r){const i=null!=r?r:-1,s=e.length-1;let o=0;for(let a=void 0!==r?65535&t[18]:0;a<s;a++)if("number"==typeof e[a+1]){if(o=e[a],null!=r&&o>=r)break}else e[a]<0&&(t[18]+=65536),(o<i||-1==i)&&(fn(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function fn(t,e,n,r){const i=n[r]<0,s=n[r+1],o=t[i?-n[r]:n[r]];if(i){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{s.call(o)}finally{}}}else try{s.call(o)}finally{}}const pn=-1;class gn{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function mn(t,e,n){const r=be(t);let i=0;for(;i<n.length;){const s=n[i];if("number"==typeof s){if(0!==s)break;i++;const o=n[i++],a=n[i++],u=n[i++];r?t.setAttribute(e,a,u,o):e.setAttributeNS(o,a,u)}else{const o=s,a=n[++i];bn(o)?r&&t.setProperty(e,o,a):r?t.setAttribute(e,o,a):e.setAttribute(o,a),i++}}return i}function yn(t){return 3===t||4===t||6===t}function bn(t){return 64===t.charCodeAt(0)}function _n(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||vn(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function vn(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const n=t[s++];if("number"==typeof n){if(n===e){o=-1;break}if(n>e){o=s-1;break}}}for(;s<t.length;){const e=t[s];if("number"==typeof e)break;if(e===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}function wn(t){return t!==pn}function xn(t){return 32767&t}function En(t,e){let n=t>>16,r=e;for(;n>0;)r=r[15],n--;return r}let Sn=!0;function An(t){const e=Sn;return Sn=t,e}let Tn=0;function Cn(t,e){const n=Dn(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,In(r.data,t),In(e,null),In(r.blueprint,null));const i=kn(t,e),s=t.injectorIndex;if(wn(i)){const t=xn(i),n=En(i,e),r=n[1].data;for(let i=0;i<8;i++)e[s+i]=n[t+i]|r[t+i]}return e[s+8]=i,s}function In(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Dn(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function kn(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){const t=i[1],e=t.type;if(r=2===e?t.declTNode:1===e?i[6]:null,null===r)return pn;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return pn}function On(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Ht)&&(r=n[Ht]),null==r&&(r=n[Ht]=Tn++);const i=255&r;e.data[t+(i>>5)]|=1<<i}(t,e,n)}function Mn(t,e,n){if(n&St.Optional)return t;pt(e,"NodeInjector")}function Pn(t,e,n,r){if(n&St.Optional&&void 0===r&&(r=null),0==(n&(St.Self|St.Host))){const i=t[9],s=Tt(void 0);try{return i?i.get(e,r,n&St.Optional):Ct(e,r,n&St.Optional)}finally{Tt(s)}}return Mn(r,e,n)}function Nn(t,e,n,r=St.Default,i){if(null!==t){const s=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Ht)?t[Ht]:void 0;return"number"==typeof e?e>=0?255&e:jn:e}(n);if("function"==typeof s){if(!Ye(e,t,r))return r&St.Host?Mn(i,n,r):Pn(e,n,r,i);try{const t=s(r);if(null!=t||r&St.Optional)return t;pt(n)}finally{nn()}}else if("number"==typeof s){let i=null,o=Dn(t,e),a=pn,u=r&St.Host?e[16][6]:null;for((-1===o||r&St.SkipSelf)&&(a=-1===o?kn(t,e):e[o+8],a!==pn&&Un(r,!1)?(i=e[1],o=xn(a),e=En(a,e)):o=-1);-1!==o;){const t=e[1];if(zn(s,o,t.data)){const t=Ln(o,e,n,i,r,u);if(t!==Rn)return t}a=e[o+8],a!==pn&&Un(r,e[1].data[o+8]===u)&&zn(s,o,e)?(i=t,o=xn(a),e=En(a,e)):o=-1}}}return Pn(e,n,r,i)}const Rn={};function jn(){return new Vn(je(),Pe())}function Ln(t,e,n,r,i,s){const o=e[1],a=o.data[t+8],u=Fn(a,o,n,null==r?ae(a)&&Sn:r!=o&&0!=(3&a.type),i&St.Host&&s===a);return null!==u?Bn(e,o,u,a):Rn}function Fn(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,u=t.directiveStart,c=s>>20,l=i?a+c:t.directiveEnd;for(let h=r?a:a+c;h<l;h++){const t=o[h];if(h<u&&n===t||h>=u&&t.type===n)return h}if(i){const t=o[u];if(t&&ce(t)&&t.type===n)return u}return null}function Bn(t,e,n,r){let i=t[n];const s=e.data;if(i instanceof gn){const o=i;o.resolving&&function(t,e){throw new ht("200",`Circular dependency in DI detected for ${t}`)}(ft(s[n]));const a=An(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?Tt(o.injectImpl):null;Ye(t,r,St.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const r=fe(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==u&&Tt(u),An(a),o.resolving=!1,nn()}}return i}function zn(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function Un(t,e){return!(t&St.Self||t&St.Host&&e)}class Vn{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return Nn(this._tNode,this._lView,t,void 0,e)}}function Gn(t){return It(()=>{const e=t.prototype.constructor,n=e[Gt]||Hn(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const t=i[Gt]||Hn(i);if(t&&t!==n)return t;i=Object.getPrototypeOf(i)}return t=>new t})}function Hn(t){return lt(t)?()=>{const e=Hn(ct(t));return e&&e()}:le(t)}const $n="__parameters__";function qn(t,e,n){return It(()=>{const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty($n)?t[$n]:Object.defineProperty(t,$n,{value:[]})[$n];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class Wn{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=gt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Xn(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?(e===t&&(e=t.slice(0,n)),Xn(r,e)):e!==t&&e.push(r)}return e}function Kn(t,e){t.forEach(t=>Array.isArray(t)?Kn(t,e):e(t))}function Zn(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Yn(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Qn(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function Jn(t,e,n){let r=er(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function tr(t,e){const n=er(t,e);if(n>=0)return t[1|n]}function er(t,e){return function(t,e,n){let r=0,i=t.length>>1;for(;i!==r;){const n=r+(i-r>>1),s=t[n<<1];if(e===s)return n<<1;s>e?i=n:r=n+1}return~(i<<1)}(t,e)}const nr={},rr=/\n/gm,ir="__source",sr=rt({provide:String,useValue:rt});let or;function ar(t){const e=or;return or=t,e}function ur(t,e=St.Default){if(void 0===or)throw new Error("inject() must be called from an injection context");return null===or?Ct(t,void 0,e):or.get(t,e&St.Optional?null:void 0,e)}function cr(t,e=St.Default){return(At||ur)(ct(t),e)}const lr=cr;function hr(t){const e=[];for(let n=0;n<t.length;n++){const r=ct(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let t,n=St.Default;for(let e=0;e<r.length;e++){const i=r[e],s=i.__NG_DI_FLAG__;"number"==typeof s?-1===s?t=i.token:n|=s:t=i}e.push(cr(t,n))}else e.push(cr(r))}return e}function dr(t,e){return t.__NG_DI_FLAG__=e,t.prototype.__NG_DI_FLAG__=e,t}const fr=dr(qn("Inject",t=>({token:t})),-1),pr=dr(qn("Optional"),8),gr=dr(qn("SkipSelf"),4);function mr(t){return t instanceof class{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?t.changingThisBreaksApplicationSecurity:t}function yr(t,e){t.__ngContext__=e}function br(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function _r(t){return t.ngOriginalError}function vr(t,...e){t.error(...e)}class wr{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||vr}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?function(t){return t.ngDebugContext}(t)||this._findContext(_r(t)):null}_findOriginalError(t){let e=_r(t);for(;e&&_r(e);)e=_r(e);return e}}const xr=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Rt))();function Er(t){return t instanceof Function?t():t}var Sr=(()=>((Sr=Sr||{})[Sr.Important=1]="Important",Sr[Sr.DashCase=2]="DashCase",Sr))();function Ar(t,e){return(void 0)(t,e)}function Tr(t){const e=t[3];return se(e)?e[3]:e}function Cr(t){return Dr(t[13])}function Ir(t){return Dr(t[4])}function Dr(t){for(;null!==t&&!se(t);)t=t[4];return t}function kr(t,e,n,r,i){if(null!=r){let s,o=!1;se(r)?s=r:ie(r)&&(o=!0,r=r[0]);const a=ve(r);0===t&&null!==n?null==i?Fr(e,n,a):Lr(e,n,a,i||null,!0):1===t&&null!==n?Lr(e,n,a,i||null,!0):2===t?function(t,e,n){const r=zr(t,e);r&&function(t,e,n,r){be(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function(t,e,n,r,i){const s=n[7];s!==ve(n)&&kr(e,t,r,s,i);for(let o=re;o<n.length;o++){const i=n[o];Xr(i[1],i,t,e,r,s)}}(e,t,s,n,i)}}function Or(t,e,n){return be(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Mr(t,e){const n=t[9],r=n.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,ke(i,-1)),n.splice(r,1)}function Pr(t,e){if(t.length<=re)return;const n=re+e,r=t[n];if(r){const s=r[17];null!==s&&s!==t&&Mr(s,r),e>0&&(t[n-1][4]=r[4]);const o=Yn(t,re+e);Xr(r[1],i=r,i[11],2,null,null),i[0]=null,i[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}var i;return r}function Nr(t,e){if(!(256&e[2])){const n=e[11];be(n)&&n.destroyNode&&Xr(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return Rr(t[1],t);for(;e;){let n=null;if(ie(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)ie(e)&&Rr(e[1],e),e=e[3];null===e&&(e=t),ie(e)&&Rr(e[1],e),n=e&&e[4]}e=n}}(e)}}function Rr(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const t=e[n[r]];if(!(t instanceof gn)){const e=n[r+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2){const r=t[e[n]],i=e[n+1];try{i.call(r)}finally{}}else try{e.call(t)}finally{}}}}(t,e),function(t,e){const n=t.cleanup,r=e[7];let i=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const t=n[s+1],o="function"==typeof t?t(e):ve(e[t]),a=r[i=n[s+2]],u=n[s+3];"boolean"==typeof u?o.removeEventListener(n[s],a,u):u>=0?r[i=u]():r[i=-u].unsubscribe(),s+=2}else{const t=r[i=n[s+1]];n[s].call(t)}if(null!==r){for(let t=i+1;t<r.length;t++)(0,r[t])();e[7]=null}}(t,e),1===e[1].type&&be(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&se(e[3])){n!==e[3]&&Mr(n,e);const r=e[19];null!==r&&r.detachView(t)}}}function jr(t,e,n){return function(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const e=t.data[r.directiveStart].encapsulation;if(e===kt.None||e===kt.Emulated)return null}return xe(r,n)}(t,e.parent,n)}function Lr(t,e,n,r,i){be(t)?t.insertBefore(e,n,r,i):e.insertBefore(n,r,i)}function Fr(t,e,n){be(t)?t.appendChild(e,n):e.appendChild(n)}function Br(t,e,n,r,i){null!==r?Lr(t,e,n,r,i):Fr(t,e,n)}function zr(t,e){return be(t)?t.parentNode(e):e.parentNode}function Ur(t,e,n){return Vr(t,e,n)}let Vr=function(t,e,n){return 40&t.type?xe(t,n):null};function Gr(t,e,n,r){const i=jr(t,r,e),s=e[11],o=Ur(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(n))for(let a=0;a<n.length;a++)Br(s,i,n[a],o,!1);else Br(s,i,n,o,!1)}function Hr(t,e){if(null!==e){const n=e.type;if(3&n)return xe(e,t);if(4&n)return qr(-1,t[e.index]);if(8&n){const n=e.child;if(null!==n)return Hr(t,n);{const n=t[e.index];return se(n)?qr(-1,n):ve(n)}}if(32&n)return Ar(e,t)()||ve(t[e.index]);{const n=$r(t,e);return null!==n?Array.isArray(n)?n[0]:Hr(Tr(t[16]),n):Hr(t,e.next)}}return null}function $r(t,e){return null!==e?t[16][6].projection[e.projection]:null}function qr(t,e){const n=re+t+1;if(n<e.length){const t=e[n],r=t[1].firstChild;if(null!==r)return Hr(t,r)}return e[7]}function Wr(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],u=n.type;if(o&&0===e&&(a&&yr(ve(a),r),n.flags|=4),64!=(64&n.flags))if(8&u)Wr(t,e,n.child,r,i,s,!1),kr(e,t,i,a,s);else if(32&u){const o=Ar(n,r);let u;for(;u=o();)kr(e,t,i,u,s);kr(e,t,i,a,s)}else 16&u?Kr(t,e,r,n,i,s):kr(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Xr(t,e,n,r,i,s){Wr(n,r,t.firstChild,e,i,s,!1)}function Kr(t,e,n,r,i,s){const o=n[16],a=o[6].projection[r.projection];if(Array.isArray(a))for(let u=0;u<a.length;u++)kr(e,t,i,a[u],s);else Wr(t,e,a,o[3],i,s,!0)}function Zr(t,e,n){be(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Yr(t,e,n){be(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function Qr(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const n=e.length;if(i+n===r||t.charCodeAt(i+n)<=32)return i}n=i+1}}const Jr="ng-template";function ti(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==Qr(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function ei(t){return 4===t.type&&t.value!==Jr}function ni(t,e,n){return e===(4!==t.type||n?t.value:Jr)}function ri(t,e,n){let r=4;const i=t.attrs||[],s=function(t){for(let e=0;e<t.length;e++)if(yn(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!ni(t,u,n)||""===u&&1===e.length){if(ii(r))return!1;o=!0}}else{const c=8&r?u:e[++a];if(8&r&&null!==t.attrs){if(!ti(t.attrs,c,n)){if(ii(r))return!1;o=!0}continue}const l=si(8&r?"class":u,i,ei(t),n);if(-1===l){if(ii(r))return!1;o=!0;continue}if(""!==c){let t;t=l>s?"":i[l+1].toLowerCase();const e=8&r?t:null;if(e&&-1!==Qr(e,c,0)||2&r&&c!==t){if(ii(r))return!1;o=!0}}}}else{if(!o&&!ii(r)&&!ii(u))return!1;if(o&&ii(u))continue;o=!1,r=u|1&r}}return ii(r)||o}function ii(t){return 0==(1&t)}function si(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let n=!1;for(;i<e.length;){const r=e[i];if(r===t)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let t=e[++i];for(;"string"==typeof t;)t=e[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function oi(t,e,n=!1){for(let r=0;r<e.length;r++)if(ri(t,e[r],n))return!0;return!1}function ai(t,e){return t?":not("+e.trim()+")":e}function ui(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const e=t[++n];i+="["+o+(e.length>0?'="'+e+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""===i||ii(o)||(e+=ai(s,i),i=""),r=o,s=s||!ii(r);n++}return""!==i&&(e+=ai(s,i)),e}const ci={};function li(t){hi(Ne(),Pe(),sn()+t,Ue())}function hi(t,e,n,r){if(!r)if(3==(3&e[2])){const r=t.preOrderCheckHooks;null!==r&&cn(e,r,n)}else{const r=t.preOrderHooks;null!==r&&ln(e,r,0,n)}on(n)}function di(t,e){return t<<17|e<<2}function fi(t){return t>>17&32767}function pi(t){return 2|t}function gi(t){return(131068&t)>>2}function mi(t,e){return-131069&t|e<<2}function yi(t){return 1|t}function bi(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],s=n[r+1];if(-1!==s){const n=t.data[s];Ke(i),n.contentQueries(2,e[s],s)}}}function _i(t,e,n,r,i,s,o,a,u,c){const l=e.blueprint.slice();return l[0]=i,l[2]=140|r,De(l),l[3]=l[15]=t,l[8]=n,l[10]=o||t&&t[10],l[11]=a||t&&t[11],l[12]=u||t&&t[12]||null,l[9]=c||t&&t[9]||null,l[6]=s,l[16]=2==e.type?t[16]:l,l}function vi(t,e,n,r,i){let s=t.data[e];if(null===s)s=function(t,e,n,r,i){const s=Le(),o=Be(),a=t.data[e]=function(t,e,n,r,i,s){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}(t,e,n,r,i),Oe.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const t=function(){const t=Oe.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===t?-1:t.injectorIndex}return Fe(s,!0),s}function wi(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function xi(t,e,n){Qe(e);try{const r=t.viewQuery;null!==r&&Yi(1,r,n);const i=t.template;null!==i&&Ai(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&bi(t,e),t.staticViewQueries&&Yi(2,t.viewQuery,n);const s=t.components;null!==s&&function(t,e){for(let n=0;n<e.length;n++)qi(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),r}finally{e[2]&=-5,rn()}}function Ei(t,e,n,r){const i=e[2];if(256==(256&i))return;Qe(e);const s=Ue();try{De(e),Oe.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&Ai(t,e,n,2,r);const o=3==(3&i);if(!s)if(o){const n=t.preOrderCheckHooks;null!==n&&cn(e,n,null)}else{const n=t.preOrderHooks;null!==n&&ln(e,n,0,null),hn(e,0)}if(function(t){for(let e=Cr(t);null!==e;e=Ir(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],r=n[3];0==(1024&n[2])&&ke(r,1),n[2]|=1024}}}(e),function(t){for(let e=Cr(t);null!==e;e=Ir(e))for(let t=re;t<e.length;t++){const n=e[t],r=n[1];Ce(n)&&Ei(r,n,r.template,n[8])}}(e),null!==t.contentQueries&&bi(t,e),!s)if(o){const n=t.contentCheckHooks;null!==n&&cn(e,n)}else{const n=t.contentHooks;null!==n&&ln(e,n,1),hn(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let t=0;t<n.length;t++){const r=n[t];if(r<0)on(~r);else{const i=r,s=n[++t],o=n[++t];qe(s,i),o(2,e[i])}}}finally{on(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)Hi(t,e[n])}(e,a);const u=t.viewQuery;if(null!==u&&Yi(2,u,r),!s)if(o){const n=t.viewCheckHooks;null!==n&&cn(e,n)}else{const n=t.viewHooks;null!==n&&ln(e,n,2),hn(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,ke(e[3],-1))}finally{rn()}}function Si(t,e,n,r){const i=e[10],s=!Ue(),o=Te(e);try{s&&!o&&i.begin&&i.begin(),o&&xi(t,e,r),Ei(t,e,n,r)}finally{s&&!o&&i.end&&i.end()}}function Ai(t,e,n,r,i){const s=sn(),o=2&r;try{on(-1),o&&e.length>ne&&hi(t,e,ne,Ue()),n(r,i)}finally{on(s)}}function Ti(t,e,n){Me()&&(function(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||Cn(n,e),yr(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const r=t.data[a],s=ce(r);s&&zi(e,n,r);const u=Bn(e,t,a,n);yr(u,e),null!==o&&Ui(0,a-i,u,r,0,o),s&&(Ae(n.index,e)[8]=u)}}(t,e,n,xe(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=Oe.lFrame.currentDirectiveIndex;try{on(s);for(let n=r;n<i;n++){const r=t.data[n],i=e[n];We(n),null===r.hostBindings&&0===r.hostVars&&null===r.hostAttrs||Ri(r,i)}}finally{on(-1),We(o)}}(t,e,n))}function Ci(t,e,n=xe){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}function Ii(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Di(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Di(t,e,n,r,i,s,o,a,u,c){const l=ne+r,h=l+i,d=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:ci);return n}(l,h),f="function"==typeof c?c():c;return d[1]={type:t,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:f,incompleteFirstPass:!1}}function ki(t,e,n,r){const i=Ji(e);null===n?i.push(r):(i.push(n),t.firstCreatePass&&ts(t).push(r,i.length-1))}function Oi(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function Mi(t,e,n,r,i,s,o,a){const u=xe(e,n);let c,l=e.inputs;var h;!a&&null!=l&&(c=l[r])?(ns(t,n,c,r,i),ae(e)&&function(t,e){const n=Ae(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r="class"===(h=r)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,i=null!=o?o(i,e.value||"",r):i,be(s)?s.setProperty(u,r,i):bn(r)||(u.setProperty?u.setProperty(r,i):u[r]=i))}function Pi(t,e,n,r){let i=!1;if(Me()){const s=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let s=0;s<r.length;s++){const o=r[s];oi(n,o.selectors,!1)&&(i||(i=[]),On(Cn(n,e),t,o.type),ce(o)?(ji(t,n),i.unshift(o)):i.push(o))}return i}(t,e,n),o=null===r?null:{"":-1};if(null!==s){i=!0,Fi(n,t.data.length,s.length);for(let t=0;t<s.length;t++){const e=s[t];e.providersResolver&&e.providersResolver(e)}let r=!1,a=!1,u=wi(t,e,s.length,null);for(let i=0;i<s.length;i++){const c=s[i];n.mergedAttrs=_n(n.mergedAttrs,c.hostAttrs),Bi(t,n,e,u,c),Li(u,c,o),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const l=c.type.prototype;!r&&(l.ngOnChanges||l.ngOnInit||l.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),r=!0),a||!l.ngOnChanges&&!l.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),a=!0),u++}!function(t,e){const n=e.directiveEnd,r=t.data,i=e.attrs,s=[];let o=null,a=null;for(let u=e.directiveStart;u<n;u++){const t=r[u],n=t.inputs,c=null===i||ei(e)?null:Vi(n,i);s.push(c),o=Oi(n,u,o),a=Oi(t.outputs,u,a)}null!==o&&(o.hasOwnProperty("class")&&(e.flags|=16),o.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=o,e.outputs=a}(t,n)}o&&function(t,e,n){if(e){const r=t.localNames=[];for(let t=0;t<e.length;t+=2){const i=n[e[t+1]];if(null==i)throw new ht("301",`Export of name '${e[t+1]}' not found!`);r.push(e[t],i)}}}(n,r,o)}return n.mergedAttrs=_n(n.mergedAttrs,n.attrs),i}function Ni(t,e,n,r,i,s){const o=s.hostBindings;if(o){let n=t.hostBindingOpCodes;null===n&&(n=t.hostBindingOpCodes=[]);const s=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(n)!=s&&n.push(s),n.push(r,i,o)}}function Ri(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function ji(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Li(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;ce(e)&&(n[""]=t)}}function Fi(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Bi(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=le(i.type)),o=new gn(s,ce(i),null);t.blueprint[r]=o,n[r]=o,Ni(t,e,0,r,wi(t,n,i.hostVars,ci),i)}function zi(t,e,n){const r=xe(e,t),i=Ii(n),s=t[10],o=Wi(t,_i(t,i,null,n.onPush?64:16,r,e,s,s.createRenderer(r,n),null,null));t[e.index]=o}function Ui(t,e,n,r,i,s){const o=s[e];if(null!==o){const t=r.setInput;for(let e=0;e<o.length;){const i=o[e++],s=o[e++],a=o[e++];null!==t?r.setInput(n,a,i,s):n[s]=a}}}function Vi(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function Gi(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function Hi(t,e){const n=Ae(e,t);if(Ce(n)){const t=n[1];80&n[2]?Ei(t,n,t.template,n[8]):n[5]>0&&$i(n)}}function $i(t){for(let n=Cr(t);null!==n;n=Ir(n))for(let t=re;t<n.length;t++){const e=n[t];if(1024&e[2]){const t=e[1];Ei(t,e,t.template,e[8])}else e[5]>0&&$i(e)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const r=Ae(e[n],t);Ce(r)&&r[5]>0&&$i(r)}}function qi(t,e){const n=Ae(e,t),r=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),xi(r,n,n[8])}function Wi(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function Xi(t){for(;t;){t[2]|=64;const e=Tr(t);if(0!=(512&t[2])&&!e)return t;t=e}return null}function Ki(t,e,n){const r=e[10];r.begin&&r.begin();try{Ei(t,e,t.template,n)}catch(i){throw es(e,i),i}finally{r.end&&r.end()}}function Zi(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=br(n),i=r[1];Si(i,r,i.template,n)}}(t[8])}function Yi(t,e,n){Ke(0),e(t,n)}const Qi=(()=>Promise.resolve(null))();function Ji(t){return t[7]||(t[7]=[])}function ts(t){return t.cleanup||(t.cleanup=[])}function es(t,e){const n=t[9],r=n?n.get(wr,null):null;r&&r.handleError(e)}function ns(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],u=e[o],c=t.data[o];null!==c.setInput?c.setInput(u,i,r,a):u[a]=i}}function rs(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const t=e[o];"number"==typeof t?s=t:1==s?i=ot(i,t):2==s&&(r=ot(r,t+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}const is=new Wn("INJECTOR",-1);class ss{get(t,e=nr){if(e===nr){const e=new Error(`NullInjectorError: No provider for ${st(t)}!`);throw e.name="NullInjectorError",e}return e}}const os=new Wn("Set Injector scope."),as={},us={};let cs;function ls(){return void 0===cs&&(cs=new ss),cs}function hs(t,e=null,n=null,r){return new ds(t,n,e||ls(),r)}class ds{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];e&&Kn(e,n=>this.processProvider(n,t,e)),Kn([t],t=>this.processInjectorType(t,[],i)),this.records.set(is,gs(void 0,this));const s=this.records.get(os);this.scope=null!=s?s.value:null,this.source=r||("object"==typeof t?null:st(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=nr,n=St.Default){this.assertNotDestroyed();const r=ar(this),i=Tt(void 0);try{if(!(n&St.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(s=t)||"object"==typeof s&&s instanceof Wn)&&yt(t);e=n&&this.injectableDefInScope(n)?gs(fs(t),as):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&St.Self?ls():this.parent).get(t,e=n&St.Optional&&e===nr?null:e)}catch(o){if("NullInjectorError"===o.name){if((o.ngTempTokenPath=o.ngTempTokenPath||[]).unshift(st(t)),r)throw o;return function(t,e,n,r){const i=t.ngTempTokenPath;throw e[ir]&&i.unshift(e[ir]),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=st(e);if(Array.isArray(e))i=e.map(st).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):st(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(rr,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(o,t,"R3InjectorError",this.source)}throw o}finally{Tt(i),ar(r)}var s}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(st(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=ct(t)))return!1;let r=_t(t);const i=null==r&&t.ngModule||void 0,s=void 0===i?t:i,o=-1!==n.indexOf(s);if(void 0!==i&&(r=_t(i)),null==r)return!1;if(null!=r.imports&&!o){let t;n.push(s);try{Kn(r.imports,r=>{this.processInjectorType(r,e,n)&&(void 0===t&&(t=[]),t.push(r))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:r}=t[e];Kn(r,t=>this.processProvider(t,n,r||Lt))}}this.injectorDefTypes.add(s);const a=le(s)||(()=>new s);this.records.set(s,gs(a,as));const u=r.providers;if(null!=u&&!o){const e=t;Kn(u,t=>this.processProvider(t,e,u))}return void 0!==i&&void 0!==t.providers}processProvider(t,e,n){let r=ys(t=ct(t))?t:ct(t&&t.provide);const i=function(t,e,n){return ms(t)?gs(void 0,t.useValue):gs(ps(t),as)}(t);if(ys(t)||!0!==t.multi)this.records.get(r);else{let e=this.records.get(r);e||(e=gs(void 0,as,!0),e.factory=()=>hr(e.multi),this.records.set(r,e)),r=t,e.multi.push(t)}this.records.set(r,i)}hydrate(t,e){var n;return e.value===as&&(e.value=us,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=ct(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function fs(t){const e=yt(t),n=null!==e?e.factory:le(t);if(null!==n)return n;if(t instanceof Wn)throw new Error(`Token ${st(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=Qn(e,"?");throw new Error(`Can't resolve all parameters for ${st(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[vt]||t[xt]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function ps(t,e,n){let r;if(ys(t)){const e=ct(t);return le(e)||fs(e)}if(ms(t))r=()=>ct(t.useValue);else if((i=t)&&i.useFactory)r=()=>t.useFactory(...hr(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>cr(ct(t.useExisting));else{const e=ct(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return le(e)||fs(e);r=()=>new e(...hr(t.deps))}var i;return r}function gs(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function ms(t){return null!==t&&"object"==typeof t&&sr in t}function ys(t){return"function"==typeof t}const bs=function(t,e,n){return function(t,e=null,n=null,r){const i=hs(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};class _s{static create(t,e){return Array.isArray(t)?bs(t,e,""):bs(t.providers,t.parent,t.name||"")}}function vs(t,e){un(br(t)[1],je())}function ws(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const r=[t];for(;e;){let i;if(ce(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");i=e.\u0275dir}if(i){if(n){r.push(i);const e=t;e.inputs=xs(t.inputs),e.declaredInputs=xs(t.declaredInputs),e.outputs=xs(t.outputs);const n=i.hostBindings;n&&As(t,n);const s=i.viewQuery,o=i.contentQueries;if(s&&Es(t,s),o&&Ss(t,o),it(t.inputs,i.inputs),it(t.declaredInputs,i.declaredInputs),it(t.outputs,i.outputs),ce(i)&&i.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(i.data.animation)}}const e=i.features;if(e)for(let r=0;r<e.length;r++){const i=e[r];i&&i.ngInherit&&i(t),i===ws&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=_n(i.hostAttrs,n=_n(n,i.hostAttrs))}}(r)}function xs(t){return t===jt?{}:t===Lt?[]:t}function Es(t,e){const n=t.viewQuery;t.viewQuery=n?(t,r)=>{e(t,r),n(t,r)}:e}function Ss(t,e){const n=t.contentQueries;t.contentQueries=n?(t,r,i)=>{e(t,r,i),n(t,r,i)}:e}function As(t,e){const n=t.hostBindings;t.hostBindings=n?(t,r)=>{e(t,r),n(t,r)}:e}_s.THROW_IF_NOT_FOUND=nr,_s.NULL=new ss,_s.\u0275prov=gt({token:_s,providedIn:"any",factory:()=>cr(is)}),_s.__NG_ELEMENT_ID__=-1;let Ts=null;function Cs(){if(!Ts){const t=Rt.Symbol;if(t&&t.iterator)Ts=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Ts=n)}}}return Ts}class Is{constructor(t){this.wrapped=t}static wrap(t){return new Is(t)}static unwrap(t){return Is.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Is}}function Ds(t){return!!ks(t)&&(Array.isArray(t)||!(t instanceof Map)&&Cs()in t)}function ks(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Os(t,e,n){return t[e]=n}function Ms(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Ps(t,e,n,r){const i=Pe();return Ms(i,He(),e)&&(Ne(),function(t,e,n,r,i,s){const o=xe(t,e);!function(t,e,n,r,i,s,o){if(null==s)be(t)?t.removeAttribute(e,i,n):e.removeAttribute(i);else{const a=null==o?dt(s):o(s,r||"",i);be(t)?t.setAttribute(e,i,a,n):n?e.setAttributeNS(n,i,a):e.setAttribute(i,a)}}(e[11],o,s,t.value,n,r,i)}(an(),i,t,e,n,r)),Ps}function Ns(t,e,n,r,i,s,o,a){const u=Pe(),c=Ne(),l=t+ne,h=c.firstCreatePass?function(t,e,n,r,i,s,o,a,u){const c=e.consts,l=vi(e,t,4,o||null,Ie(c,a));Pi(e,n,l,Ie(c,u)),un(e,l);const h=l.tViews=Di(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,l),h.queries=e.queries.embeddedTView(l)),l}(l,c,u,e,n,r,i,s,o):c.data[l];Fe(h,!1);const d=u[11].createComment("");Gr(c,u,d,h),yr(d,u),Wi(u,u[l]=Gi(d,u,d,h)),ue(h)&&Ti(c,u,h),null!=o&&Ci(u,h,a)}function Rs(t){return Se(Oe.lFrame.contextLView,ne+t)}function js(t,e=St.Default){const n=Pe();return null===n?cr(t,e):Nn(je(),n,ct(t),e)}function Ls(t,e,n){const r=Pe();return Ms(r,He(),e)&&Mi(Ne(),an(),r,t,e,r[11],n,!1),Ls}function Fs(t,e,n,r,i){const s=i?"class":"style";ns(t,n,e.inputs[s],s,r)}function Bs(t,e,n,r){const i=Pe(),s=Ne(),o=ne+t,a=i[11],u=i[o]=Or(a,e,Oe.lFrame.currentNamespace),c=s.firstCreatePass?function(t,e,n,r,i,s,o){const a=e.consts,u=vi(e,t,2,i,Ie(a,s));return Pi(e,n,u,Ie(a,o)),null!==u.attrs&&rs(u,u.attrs,!1),null!==u.mergedAttrs&&rs(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,0,e,n,r):s.data[o];Fe(c,!0);const l=c.mergedAttrs;null!==l&&mn(a,u,l);const h=c.classes;null!==h&&Yr(a,u,h);const d=c.styles;null!==d&&Zr(a,u,d),64!=(64&c.flags)&&Gr(s,i,u,c),0===Oe.lFrame.elementDepthCount&&yr(u,i),Oe.lFrame.elementDepthCount++,ue(c)&&(Ti(s,i,c),function(t,e,n){if(oe(e)){const r=e.directiveEnd;for(let i=e.directiveStart;i<r;i++){const e=t.data[i];e.contentQueries&&e.contentQueries(1,n[i],i)}}}(s,c,i)),null!==r&&Ci(i,c)}function zs(){let t=je();Be()?ze():(t=t.parent,Fe(t,!1));const e=t;Oe.lFrame.elementDepthCount--;const n=Ne();n.firstCreatePass&&(un(n,t),oe(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Fs(n,e,Pe(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Fs(n,e,Pe(),e.stylesWithoutHost,!1)}function Us(t,e,n,r){Bs(t,e,n,r),zs()}function Vs(){return Pe()}function Gs(t){return!!t&&"function"==typeof t.then}function Hs(t){return!!t&&"function"==typeof t.subscribe}const $s=Hs;function qs(t,e,n,r){const i=Pe(),s=Ne(),o=je();return function(t,e,n,r,i,s,o,a){const u=ue(r),c=t.firstCreatePass&&ts(t),l=Ji(e);let h=!0;if(3&r.type||a){const d=xe(r,e),f=a?a(d):d,p=l.length,g=a?t=>a(ve(t[r.index])):r.index;if(be(n)){let o=null;if(!a&&u&&(o=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const t=i[s];if(t===n&&i[s+1]===r){const t=e[7],n=i[s+2];return t.length>n?t[n]:null}"string"==typeof t&&(s+=2)}return null}(t,e,i,r.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,h=!1;else{s=Xs(r,e,0,s,!1);const t=n.listen(f,i,s);l.push(s,t),c&&c.push(i,g,p,p+1)}}else s=Xs(r,e,0,s,!0),f.addEventListener(i,s,o),l.push(s),c&&c.push(i,g,p,o)}else s=Xs(r,e,0,s,!1);const d=r.outputs;let f;if(h&&null!==d&&(f=d[i])){const t=f.length;if(t)for(let n=0;n<t;n+=2){const t=e[f[n]][f[n+1]].subscribe(s),o=l.length;l.push(s,t),c&&c.push(i,r.index,o,-(o+1))}}}(s,i,i[11],o,t,e,!!n,r),qs}function Ws(t,e,n,r){try{return!1!==n(r)}catch(i){return es(t,i),!1}}function Xs(t,e,n,r,i){return function n(s){if(s===Function)return r;const o=2&t.flags?Ae(t.index,e):e;0==(32&e[2])&&Xi(o);let a=Ws(e,0,r,s),u=n.__ngNextListenerFn__;for(;u;)a=Ws(e,0,u,s)&&a,u=u.__ngNextListenerFn__;return i&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function Ks(t=1){return function(t){return(Oe.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Oe.lFrame.contextLView))[8]}(t)}function Zs(t,e,n,r,i){const s=t[n+1],o=null===e;let a=r?fi(s):gi(s),u=!1;for(;0!==a&&(!1===u||o);){const n=t[a+1];Ys(t[a],e)&&(u=!0,t[a+1]=r?yi(n):pi(n)),a=r?fi(n):gi(n)}u&&(t[n+1]=r?pi(s):yi(s))}function Ys(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&er(t,e)>=0}const Qs={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Js(t){return t.substring(Qs.key,Qs.keyEnd)}function to(t,e){const n=Qs.textEnd;return n===e?-1:(e=Qs.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,Qs.key=e,n),eo(t,e,n))}function eo(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function no(t,e){return function(t,e,n,r){const i=Pe(),s=Ne(),o=$e(2);s.firstUpdatePass&&oo(s,t,o,true),e!==ci&&Ms(i,o,e)&&co(s,s.data[sn()],i,i[11],t,i[o+1]=function(t,e){return null==t||"object"==typeof t&&(t=st(mr(t))),t}(e),true,o)}(t,e),no}function ro(t){!function(t,e,n,r){const i=Ne(),s=$e(2);i.firstUpdatePass&&oo(i,null,s,r);const o=Pe();if(n!==ci&&Ms(o,s,n)){const a=i.data[sn()];if(fo(a,r)&&!so(i,s)){let t=a.classesWithoutHost;null!==t&&(n=ot(t,n||"")),Fs(i,a,o,n,r)}else!function(t,e,n,r,i,s,o,a){i===ci&&(i=Lt);let u=0,c=0,l=0<i.length?i[0]:null,h=0<s.length?s[0]:null;for(;null!==l||null!==h;){const o=u<i.length?i[u+1]:void 0,d=c<s.length?s[c+1]:void 0;let f,p=null;l===h?(u+=2,c+=2,o!==d&&(p=h,f=d)):null===h||null!==l&&l<h?(u+=2,p=l):(c+=2,p=h,f=d),null!==p&&co(t,e,n,r,p,f,true,a),l=u<i.length?i[u]:null,h=c<s.length?s[c]:null}}(i,a,o,o[11],o[s+1],o[s+1]=function(t,e,n){if(null==n||""===n)return Lt;const r=[],i=mr(n);if(Array.isArray(i))for(let s=0;s<i.length;s++)t(r,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&t(r,s,i[s]);else"string"==typeof i&&e(r,i);return r}(t,e,n),0,s)}}(Jn,io,t,!0)}function io(t,e){for(let n=function(t){return function(t){Qs.key=0,Qs.keyEnd=0,Qs.value=0,Qs.valueEnd=0,Qs.textEnd=t.length}(t),to(t,eo(t,0,Qs.textEnd))}(e);n>=0;n=to(e,n))Jn(t,Js(e),!0)}function so(t,e){return e>=t.expandoStartIndex}function oo(t,e,n,r){const i=t.data;if(null===i[n+1]){const s=i[sn()],o=so(t,n);fo(s,r)&&null===e&&!o&&(e=!1),e=function(t,e,n,r){const i=function(t){const e=Oe.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=uo(n=ao(null,t,e,n,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==i)if(n=ao(i,t,e,n,r),null===s){let n=function(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==gi(r))return t[fi(r)]}(t,e,r);void 0!==n&&Array.isArray(n)&&(n=ao(null,t,e,n[1],r),n=uo(n,e.attrs,r),function(t,e,n,r){t[fi(n?e.classBindings:e.styleBindings)]=r}(t,e,r,n))}else s=function(t,e,n){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=uo(r,t[s].hostAttrs,n);return uo(r,e.attrs,n)}(t,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),n}(i,s,e,r),function(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=fi(o),u=gi(o);t[r]=n;let c,l=!1;if(Array.isArray(n)){const t=n;c=t[1],(null===c||er(t,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){const e=fi(t[a+1]);t[r+1]=di(e,a),0!==e&&(t[e+1]=mi(t[e+1],r)),t[a+1]=131071&t[a+1]|r<<17}else t[r+1]=di(a,0),0!==a&&(t[a+1]=mi(t[a+1],r)),a=r;else t[r+1]=di(u,0),0===a?a=r:t[u+1]=mi(t[u+1],r),u=r;l&&(t[r+1]=pi(t[r+1])),Zs(t,c,r,!0),Zs(t,c,r,!1),function(t,e,n,r,i){const s=i?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&er(s,e)>=0&&(n[r+1]=yi(n[r+1]))}(e,c,t,r,s),o=di(a,u),s?e.classBindings=o:e.styleBindings=o}(i,s,e,n,o,r)}}function ao(t,e,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],r=uo(r,s.hostAttrs,i),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function uo(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Jn(t,o,!!n||e[++s]))}return void 0===t?null:t}function co(t,e,n,r,i,s,o,a){if(!(3&e.type))return;const u=t.data,c=u[a+1];ho(1==(1&c)?lo(u,e,n,i,gi(c),o):void 0)||(ho(s)||2==(2&c)&&(s=lo(u,null,n,i,a,o)),function(t,e,n,r,i){const s=be(t);if(e)i?s?t.addClass(n,r):n.classList.add(r):s?t.removeClass(n,r):n.classList.remove(r);else{let e=-1===r.indexOf("-")?void 0:Sr.DashCase;if(null==i)s?t.removeStyle(n,r,e):n.style.removeProperty(r);else{const o="string"==typeof i&&i.endsWith("!important");o&&(i=i.slice(0,-10),e|=Sr.Important),s?t.setStyle(n,r,i,e):n.style.setProperty(r,i,o?"important":"")}}}(r,o,we(sn(),n),i,s))}function lo(t,e,n,r,i,s){const o=null===e;let a;for(;i>0;){const e=t[i],s=Array.isArray(e),u=s?e[1]:e,c=null===u;let l=n[i+1];l===ci&&(l=c?Lt:void 0);let h=c?tr(l,r):u===r?l:void 0;if(s&&!ho(h)&&(h=tr(e,r)),ho(h)&&(a=h,o))return a;const d=t[i+1];i=o?fi(d):gi(d)}if(null!==e){let t=s?e.residualClasses:e.residualStyles;null!=t&&(a=tr(t,r))}return a}function ho(t){return void 0!==t}function fo(t,e){return 0!=(t.flags&(e?16:32))}function po(t,e=""){const n=Pe(),r=Ne(),i=t+ne,s=r.firstCreatePass?vi(r,i,1,e,null):r.data[i],o=n[i]=function(t,e){return be(t)?t.createText(e):t.createTextNode(e)}(n[11],e);Gr(r,n,o,s),Fe(s,!1)}function go(t){return mo("",t,""),go}function mo(t,e,n){const r=Pe(),i=function(t,e,n,r){return Ms(t,He(),n)?e+dt(n)+r:ci}(r,t,e,n);return i!==ci&&function(t,e,n){const r=we(e,t);!function(t,e,n){be(t)?t.setValue(e,n):e.textContent=n}(t[11],r,n)}(r,sn(),i),mo}function yo(t,e,n){const r=Pe();return Ms(r,He(),e)&&Mi(Ne(),an(),r,t,e,r[11],n,!0),yo}const bo=void 0;var _o=["en",[["a","p"],["AM","PM"],bo],[["AM","PM"],bo,bo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],bo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],bo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",bo,"{1} 'at' {0}",bo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let vo={};function wo(t){return t in vo||(vo[t]=Rt.ng&&Rt.ng.common&&Rt.ng.common.locales&&Rt.ng.common.locales[t]),vo[t]}var xo=(()=>((xo=xo||{})[xo.LocaleId=0]="LocaleId",xo[xo.DayPeriodsFormat=1]="DayPeriodsFormat",xo[xo.DayPeriodsStandalone=2]="DayPeriodsStandalone",xo[xo.DaysFormat=3]="DaysFormat",xo[xo.DaysStandalone=4]="DaysStandalone",xo[xo.MonthsFormat=5]="MonthsFormat",xo[xo.MonthsStandalone=6]="MonthsStandalone",xo[xo.Eras=7]="Eras",xo[xo.FirstDayOfWeek=8]="FirstDayOfWeek",xo[xo.WeekendRange=9]="WeekendRange",xo[xo.DateFormat=10]="DateFormat",xo[xo.TimeFormat=11]="TimeFormat",xo[xo.DateTimeFormat=12]="DateTimeFormat",xo[xo.NumberSymbols=13]="NumberSymbols",xo[xo.NumberFormats=14]="NumberFormats",xo[xo.CurrencyCode=15]="CurrencyCode",xo[xo.CurrencySymbol=16]="CurrencySymbol",xo[xo.CurrencyName=17]="CurrencyName",xo[xo.Currencies=18]="Currencies",xo[xo.Directionality=19]="Directionality",xo[xo.PluralCase=20]="PluralCase",xo[xo.ExtraData=21]="ExtraData",xo))();const Eo="en-US";let So=Eo;function Ao(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t} [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(So=t.toLowerCase().replace(/_/g,"-"))}function To(t,e,n,r,i){if(t=ct(t),Array.isArray(t))for(let s=0;s<t.length;s++)To(t[s],e,n,r,i);else{const s=Ne(),o=Pe();let a=ys(t)?t:ct(t.provide),u=ps(t);const c=je(),l=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(ys(t)||!t.multi){const r=new gn(u,i,js),f=Do(a,e,i?l:l+d,h);-1===f?(On(Cn(c,o),s,a),Co(s,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(r),o.push(r)):(n[f]=r,o[f]=r)}else{const f=Do(a,e,l+d,h),p=Do(a,e,l,l+d),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){On(Cn(c,o),s,a);const l=function(t,e,n,r,i){const s=new gn(t,n,js);return s.multi=[],s.index=e,s.componentProviders=0,Io(s,i,r&&!n),s}(i?Oo:ko,n.length,i,r,u);!i&&m&&(n[p].providerFactory=l),Co(s,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(l),o.push(l)}else Co(s,t,f>-1?f:p,Io(n[i?p:f],u,!i&&r));!i&&r&&m&&n[p].componentProviders++}}}function Co(t,e,n,r){const i=ys(e);if(i||e.useClass){const s=(e.useClass||e).prototype.ngOnDestroy;if(s){const o=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const t=o.indexOf(n);-1===t?o.push(n,[r,s]):o[t+1].push(r,s)}else o.push(n,s)}}}function Io(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Do(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function ko(t,e,n,r){return Mo(this.multi,[])}function Oo(t,e,n,r){const i=this.multi;let s;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Bn(n,n[1],this.providerFactory.index,r);s=e.slice(0,t),Mo(i,s);for(let n=t;n<e.length;n++)s.push(e[n])}else s=[],Mo(i,s);return s}function Mo(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Po(t,e=[]){return n=>{n.providersResolver=(n,r)=>function(t,e,n){const r=Ne();if(r.firstCreatePass){const i=ce(t);To(n,r.data,r.blueprint,i,!0),To(e,r.data,r.blueprint,i,!1)}}(n,r?r(t):t,e)}}class No{}class Ro{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${st(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}class jo{}function Lo(...t){}function Fo(t,e){return new zo(xe(t,e))}jo.NULL=new Ro;const Bo=function(){return Fo(je(),Pe())};let zo=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=Bo,t})();function Uo(t){return t instanceof zo?t.nativeElement:t}class Vo{}let Go=(()=>{class t{}return t.\u0275prov=gt({token:t,providedIn:"root",factory:()=>null}),t})();class Ho{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const $o=new Ho("12.1.3");class qo{constructor(){}supports(t){return Ds(t)}create(t){return new Xo(t)}}const Wo=(t,e)=>e;class Xo{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Wo}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const s=!n||e&&e.currentIndex<Qo(n,r,i)?e:n,o=Qo(s,r,i),a=s.currentIndex;if(s===n)r--,n=n._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{i||(i=[]);const t=o-r,e=a-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,s=r+n;e<=s&&s<t&&(i[n]=r+1)}i[s.previousIndex]=e-t}}o!==a&&t(s,o,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Ds(t))throw new Error(`Error trying to diff '${st(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,s=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==i&&Object.is(i.trackById,r)?(s&&(i=this._verifyReinsertion(i,n,r,e)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),s=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Cs()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&Object.is(i.trackById,r)?(s&&(i=this._verifyReinsertion(i,t,r,e)),Object.is(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),s=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):t=this._addAfter(new Ko(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new Yo),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Yo),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Ko{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Zo{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class Yo{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Zo,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Qo(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class Jo{constructor(){}supports(t){return t instanceof Map||ks(t)}create(){return new ta}}class ta{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||ks(t)))throw new Error(`Error trying to diff '${st(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new ea(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class ea{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function na(){return new ra([new qo])}let ra=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||na()),deps:[[t,new gr,new pr]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=gt({token:t,providedIn:"root",factory:na}),t})();function ia(){return new sa([new Jo])}let sa=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||ia()),deps:[[t,new gr,new pr]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=gt({token:t,providedIn:"root",factory:ia}),t})();function oa(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&r.push(ve(s)),se(s))for(let t=re;t<s.length;t++){const e=s[t],n=e[1].firstChild;null!==n&&oa(e[1],e,n,r)}const o=n.type;if(8&o)oa(t,e,n.child,r);else if(32&o){const t=Ar(n,e);let i;for(;i=t();)r.push(i)}else if(16&o){const t=$r(e,n);if(Array.isArray(t))r.push(...t);else{const n=Tr(e[16]);oa(n[1],n,t,r,!0)}}n=i?n.projectionNext:n.next}return r}class aa{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return oa(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(se(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(Pr(t,n),Yn(e,n))}this._attachedToViewContainer=!1}Nr(this._lView[1],this._lView)}onDestroy(t){ki(this._lView[1],this._lView,null,t)}markForCheck(){Xi(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Ki(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Ve(!0);try{Ki(t,e,n)}finally{Ve(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,Xr(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class ua extends aa{constructor(t){super(t),this._view=t}detectChanges(){Zi(this._view)}checkNoChanges(){!function(t){Ve(!0);try{Zi(t)}finally{Ve(!1)}}(this._view)}get context(){return null}}const ca=function(t){return function(t,e,n){if(ae(t)&&!n){const n=Ae(t.index,e);return new aa(n,n)}return 47&t.type?new aa(e[16],e):null}(je(),Pe(),16==(16&t))};let la=(()=>{class t{}return t.__NG_ELEMENT_ID__=ca,t})();const ha=[new Jo],da=new ra([new qo]),fa=new sa(ha),pa=function(){return ba(je(),Pe())};let ga=(()=>{class t{}return t.__NG_ELEMENT_ID__=pa,t})();const ma=ga,ya=class extends ma{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=_i(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(e)),xi(e,n,t),new aa(n)}};function ba(t,e){return 4&t.type?new ya(e,t,Fo(t,e)):null}class _a{}const va=function(){return Ta(je(),Pe())};let wa=(()=>{class t{}return t.__NG_ELEMENT_ID__=va,t})();const xa=wa,Ea=class extends xa{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return Fo(this._hostTNode,this._hostLView)}get injector(){return new Vn(this._hostTNode,this._hostLView)}get parentInjector(){const t=kn(this._hostTNode,this._hostLView);if(wn(t)){const e=En(t,this._hostLView),n=xn(t);return new Vn(e[1].data[n+8],e)}return new Vn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=Sa(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-re}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const s=n||this.parentInjector;if(!i&&null==t.ngModule&&s){const t=s.get(_a,null);t&&(i=t)}const o=t.create(s,r,void 0,i);return this.insert(o.hostView,e),o}insert(t,e){const n=t._lView,r=n[1];if(se(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],r=new Ea(e,e[6],e[3]);r.detach(r.indexOf(t))}}const i=this._adjustIndex(e),s=this._lContainer;!function(t,e,n,r){const i=re+r,s=n.length;r>0&&(n[i-1][4]=e),r<s-re?(e[4]=n[i],Zn(n,re+r,e)):(n.push(e),e[4]=null),e[3]=n;const o=e[17];null!==o&&n!==o&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(r,n,s,i);const o=qr(i,s),a=n[11],u=zr(a,s[7]);return null!==u&&function(t,e,n,r,i,s){r[0]=i,r[6]=e,Xr(t,r,n,1,i,s)}(r,s[6],a,n,u,o),t.attachToViewContainerRef(),Zn(Aa(s),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=Sa(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=Pr(this._lContainer,e);n&&(Yn(Aa(this._lContainer),e),Nr(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=Pr(this._lContainer,e);return n&&null!=Yn(Aa(this._lContainer),e)?new aa(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function Sa(t){return t[8]}function Aa(t){return t[8]||(t[8]=[])}function Ta(t,e){let n;const r=e[t.index];if(se(r))n=r;else{let i;if(8&t.type)i=ve(r);else{const n=e[11];i=n.createComment("");const r=xe(t,e);Lr(n,zr(n,r),i,function(t,e){return be(t)?t.nextSibling(e):e.nextSibling}(n,r),!1)}e[t.index]=n=Gi(r,e,i,t),Wi(e,n)}return new Ea(n,t,e)}const Ca={};class Ia extends jo{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=te(t);return new Oa(e,this.ngModule)}}function Da(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const ka=new Wn("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>xr});class Oa extends No{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(ui).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Da(this.componentDef.inputs)}get outputs(){return Da(this.componentDef.outputs)}create(t,e,n,r){const i=(r=r||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const s=t.get(n,Ca,i);return s!==Ca||r===Ca?s:e.get(n,r,i)}}}(t,r.injector):t,s=i.get(Vo,_e),o=i.get(Go,null),a=s.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=n?function(t,e,n){if(be(t))return t.selectRootElement(e,n===kt.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(a,n,this.componentDef.encapsulation):Or(s.createRenderer(null,this.componentDef),u,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(u)),l=this.componentDef.onPush?576:528,h={components:[],scheduler:xr,clean:Qi,playerHandler:null,flags:0},d=Di(0,null,null,1,0,null,null,null,null,null),f=_i(null,d,h,l,null,null,s,a,o,i);let p,g;Qe(f);try{const t=function(t,e,n,r,i,s){const o=n[1];n[20]=t;const a=vi(o,20,2,"#host",null),u=a.mergedAttrs=e.hostAttrs;null!==u&&(rs(a,u,!0),null!==t&&(mn(i,t,u),null!==a.classes&&Yr(i,t,a.classes),null!==a.styles&&Zr(i,t,a.styles)));const c=r.createRenderer(t,e),l=_i(n,Ii(e),null,e.onPush?64:16,n[20],a,r,c,null,null);return o.firstCreatePass&&(On(Cn(a,n),o,e.type),ji(o,a),Fi(a,n.length,1)),Wi(n,l),n[20]=l}(c,this.componentDef,f,s,a);if(c)if(n)mn(a,c,["ng-version",$o.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!ii(i))break;i=s}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&mn(a,c,t),e&&e.length>0&&Yr(a,c,e.join(" "))}if(g=Ee(d,ne),void 0!==e){const t=g.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=e[n];t.push(null!=r?Array.from(r):null)}}p=function(t,e,n,r,i){const s=n[1],o=function(t,e,n){const r=je();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Bi(t,r,e,wi(t,e,1,null),n));const i=Bn(e,t,r.directiveStart,r);yr(i,e);const s=xe(r,e);return s&&yr(s,e),i}(s,n,e);if(r.components.push(o),t[8]=o,i&&i.forEach(t=>t(o,e)),e.contentQueries){const t=je();e.contentQueries(1,o,t.directiveStart)}const a=je();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(on(a.index),Ni(n[1],a,0,a.directiveStart,a.directiveEnd,e),Ri(e,o)),o}(t,this.componentDef,f,h,[vs]),xi(d,f,null)}finally{rn()}return new Ma(this.componentType,p,Fo(g,f),f,g)}}class Ma extends class{}{constructor(t,e,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new ua(r),this.componentType=t}get injector(){return new Vn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const Pa=new Map;class Na extends _a{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Ia(this);const n=ee(t),r=t[Vt]||null;r&&Ao(r),this._bootstrapComponents=Er(n.bootstrap),this._r3Injector=hs(t,e,[{provide:_a,useValue:this},{provide:jo,useValue:this.componentFactoryResolver}],st(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=_s.THROW_IF_NOT_FOUND,n=St.Default){return t===_s||t===_a||t===is?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Ra extends class{}{constructor(t){super(),this.moduleType=t,null!==ee(t)&&function(t){const e=new Set;!function t(n){const r=ee(n,!0),i=r.id;null!==i&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${st(e)} vs ${st(e.name)}`)}(i,Pa.get(i),n),Pa.set(i,n));const s=Er(r.imports);for(const o of s)e.has(o)||(e.add(o),t(o))}(t)}(t)}create(t){return new Na(this.moduleType,t)}}function ja(t,e,n){const r=Ge()+t,i=Pe();return i[r]===ci?Os(i,r,n?e.call(n):e()):function(t,e){return t[e]}(i,r)}function La(t,e,n,r,i,s){const o=e+n;return Ms(t,o,i)?Os(t,o+1,s?r.call(s,i):r(i)):function(t,e){const n=t[e];return n===ci?void 0:n}(t,o+1)}function Fa(t,e){const n=Ne();let r;const i=t+ne;n.firstCreatePass?(r=function(t,e){if(e)for(let n=e.length-1;n>=0;n--){const r=e[n];if(t===r.name)return r}throw new ht("302",`The pipe '${t}' could not be found!`)}(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const s=r.factory||(r.factory=le(r.type)),o=Tt(js);try{const t=An(!1),e=s();return An(t),function(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}(n,Pe(),i,e),e}finally{Tt(o)}}function Ba(t,e,n){const r=t+ne,i=Pe(),s=Se(i,r);return function(t,e){return Is.isWrapped(e)&&(e=Is.unwrap(e),t[Oe.lFrame.bindingIndex]=ci),e}(i,function(t,e){return t[1].data[e].pure}(i,r)?La(i,Ge(),e,s.transform,n,s):s.transform(n))}function za(t){return e=>{setTimeout(t,void 0,e)}}const Ua=class extends C{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){var r,i,s;let o=t,a=e||(()=>null),u=n;if(t&&"object"==typeof t){const e=t;o=null===(r=e.next)||void 0===r?void 0:r.bind(e),a=null===(i=e.error)||void 0===i?void 0:i.bind(e),u=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}this.__isAsync&&(a=za(a),o&&(o=za(o)),u&&(u=za(u)));const c=super.subscribe({next:o,error:a,complete:u});return t instanceof g&&t.add(c),c}};function Va(){return this._results[Cs()]()}class Ga{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Cs(),n=Ga.prototype;n[e]||(n[e]=Va)}get changes(){return this._changes||(this._changes=new Ua)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const n=this;n.dirty=!1;const r=Xn(t);(this._changesDetected=!function(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],s=e[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}(n._results,r,e))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class Ha{constructor(t){this.queryList=t,this.matches=null}clone(){return new Ha(this.queryList)}setDirty(){this.queryList.setDirty()}}class $a{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);r.push(this.queries[n.indexInDeclarationView].clone())}return new $a(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==nu(t,e).matches&&this.queries[e].setDirty()}}class qa{constructor(t,e,n=null){this.predicate=t,this.flags=e,this.read=n}}class Wa{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,i=this.getByIndex(n).embeddedTView(t,r);i&&(i.indexInDeclarationView=n,null!==e?e.push(i):e=[i])}return null!==e?new Wa(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Xa{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Xa(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const i=n[r];this.matchTNodeWithReadOption(t,e,Ka(e,i)),this.matchTNodeWithReadOption(t,e,Fn(e,t,i,!1,!1))}else n===ga?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Fn(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===zo||r===wa||r===ga&&4&e.type)this.addMatch(e.index,-2);else{const n=Fn(e,t,r,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function Ka(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function Za(t,e,n,r){return-1===n?function(t,e){return 11&t.type?Fo(t,e):4&t.type?ba(t,e):null}(e,t):-2===n?function(t,e,n){return n===zo?Fo(e,t):n===ga?ba(e,t):n===wa?Ta(e,t):void 0}(t,e,r):Bn(t,t[1],n,e)}function Ya(t,e,n,r){const i=e[19].queries[r];if(null===i.matches){const r=t.data,s=n.matches,o=[];for(let t=0;t<s.length;t+=2){const i=s[t];o.push(i<0?null:Za(e,r[i],s[t+1],n.metadata.read))}i.matches=o}return i.matches}function Qa(t,e,n,r){const i=t.queries.getByIndex(n),s=i.matches;if(null!==s){const o=Ya(t,e,i,n);for(let t=0;t<s.length;t+=2){const n=s[t];if(n>0)r.push(o[t/2]);else{const i=s[t+1],o=e[-n];for(let t=re;t<o.length;t++){const e=o[t];e[17]===e[3]&&Qa(e[1],e,i,r)}if(null!==o[9]){const t=o[9];for(let e=0;e<t.length;e++){const n=t[e];Qa(n[1],n,i,r)}}}}}return r}function Ja(t){const e=Pe(),n=Ne(),r=Xe();Ke(r+1);const i=nu(n,r);if(t.dirty&&Te(e)===(2==(2&i.metadata.flags))){if(null===i.matches)t.reset([]);else{const s=i.crossesNgTemplate?Qa(n,e,r,[]):Ya(n,e,i,r);t.reset(s,Uo),t.notifyOnChanges()}return!0}return!1}function tu(t,e,n){const r=Ne();r.firstCreatePass&&(function(t,e,n){null===t.queries&&(t.queries=new Wa),t.queries.track(new Xa(e,-1))}(r,new qa(t,e,n)),2==(2&e)&&(r.staticViewQueries=!0)),function(t,e,n){const r=new Ga(4==(4&n));ki(t,e,r,r.destroy),null===e[19]&&(e[19]=new $a),e[19].queries.push(new Ha(r))}(r,Pe(),e)}function eu(){return t=Pe(),e=Xe(),t[19].queries[e].queryList;var t,e}function nu(t,e){return t.queries.getByIndex(e)}const ru=new Wn("Application Initializer");let iu=(()=>{class t{constructor(t){this.appInits=t,this.resolve=Lo,this.reject=Lo,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();if(Gs(e))t.push(e);else if($s(e)){const n=new Promise((t,n)=>{e.subscribe({complete:t,error:n})});t.push(n)}}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(cr(ru,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const su=new Wn("AppId"),ou={provide:su,useFactory:function(){return`${au()}${au()}${au()}`},deps:[]};function au(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const uu=new Wn("Platform Initializer"),cu=new Wn("Platform ID"),lu=new Wn("appBootstrapListener");let hu=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const du=new Wn("LocaleId"),fu=new Wn("DefaultCurrencyCode");class pu{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const gu=function(t){return new Ra(t)},mu=gu,yu=function(t){return Promise.resolve(gu(t))},bu=function(t){const e=gu(t),n=Er(ee(t).declarations).reduce((t,e)=>{const n=te(e);return n&&t.push(new Oa(n)),t},[]);return new pu(e,n)},_u=bu,vu=function(t){return Promise.resolve(bu(t))};let wu=(()=>{class t{constructor(){this.compileModuleSync=mu,this.compileModuleAsync=yu,this.compileModuleAndAllComponentsSync=_u,this.compileModuleAndAllComponentsAsync=vu}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const xu=new Wn("compilerOptions"),Eu=(()=>Promise.resolve(0))();function Su(t){"undefined"==typeof Zone?Eu.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Au{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ua(!1),this.onMicrotaskEmpty=new Ua(!1),this.onStable=new Ua(!1),this.onError=new Ua(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&e,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let t=Rt.requestAnimationFrame,e=Rt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Rt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Iu(t),t.isCheckStableRunning=!0,Cu(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Iu(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{try{return Du(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),ku(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return Du(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),ku(t)}},onHasTask:(e,n,r,i)=>{e.hasTask(r,i),n===r&&("microTask"==i.change?(t._hasPendingMicrotasks=i.microTask,Iu(t),Cu(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,n,r,i)=>(e.handleError(r,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Au.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Au.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+r,t,Tu,Lo,Lo);try{return i.runTask(s,e,n)}finally{i.cancelTask(s)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const Tu={};function Cu(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Iu(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function Du(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function ku(t){t._nesting--,Cu(t)}class Ou{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ua,this.onMicrotaskEmpty=new Ua,this.onStable=new Ua,this.onError=new Ua}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let Mu=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Au.assertNotInAngularZone(),Su(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Su(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(cr(Au))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),Pu=(()=>{class t{constructor(){this._applications=new Map,ju.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return ju.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class Nu{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let Ru,ju=new Nu,Lu=!0,Fu=!1;function Bu(){return Fu=!0,Lu}const zu=new Wn("AllowMultipleToken");function Uu(t,e,n=[]){const r=`Platform: ${e}`,i=new Wn(r);return(e=[])=>{let s=Vu();if(!s||s.injector.get(zu,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0},{provide:os,useValue:"platform"});!function(t){if(Ru&&!Ru.destroyed&&!Ru.injector.get(zu,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ru=t.get(Gu);const e=t.get(uu,null);e&&e.forEach(t=>t())}(_s.create({providers:t,name:r}))}return function(t){const e=Vu();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function Vu(){return Ru&&!Ru.destroyed?Ru:null}let Gu=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new Ou:("zone.js"===t?void 0:t)||new Au({enableLongStackTrace:Bu(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(e?e.ngZone:void 0,{ngZoneEventCoalescing:e&&e.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:e&&e.ngZoneRunCoalescing||!1}),r=[{provide:Au,useValue:n}];return n.run(()=>{const e=_s.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),s=i.injector.get(wr,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const t=n.onError.subscribe({next:t=>{s.handleError(t)}});i.onDestroy(()=>{qu(this._modules,i),t.unsubscribe()})}),function(t,e,n){try{const r=n();return Gs(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(s,n,()=>{const t=i.injector.get(iu);return t.runInitializers(),t.donePromise.then(()=>(Ao(i.injector.get(du,Eo)||Eo),this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=Hu({},e);return function(t,e,n){const r=new Ra(n);return Promise.resolve(r)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get($u);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${st(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(cr(_s))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function Hu(t,e){return Array.isArray(e)?e.reduce(Hu,t):Object.assign(Object.assign({},t),e)}let $u=(()=>{class t{constructor(t,e,n,r,i){this._zone=t,this._injector=e,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new x(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),o=new x(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{Au.assertNotInAngularZone(),Su(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{Au.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=X(s,o.pipe(nt()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof No?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(_a),i=n.create(_s.NULL,[],e||n.selector,r),s=i.location.nativeElement,o=i.injector.get(Mu,null),a=o&&i.injector.get(Pu);return o&&a&&a.registerApplication(s,o),i.onDestroy(()=>{this.detachView(i.hostView),qu(this.components,i),a&&a.unregisterApplication(s)}),this._loadComponent(i),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;qu(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(lu,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(cr(Au),cr(_s),cr(wr),cr(jo),cr(iu))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function qu(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Wu=Uu(null,"core",[{provide:cu,useValue:"unknown"},{provide:Gu,deps:[_s]},{provide:Pu,deps:[]},{provide:hu,deps:[]}]),Xu=[{provide:$u,useClass:$u,deps:[Au,_s,wr,jo,iu]},{provide:ka,deps:[Au],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:iu,useClass:iu,deps:[[new pr,ru]]},{provide:wu,useClass:wu,deps:[]},ou,{provide:ra,useFactory:function(){return da},deps:[]},{provide:sa,useFactory:function(){return fa},deps:[]},{provide:du,useFactory:function(t){return Ao(t=t||"undefined"!=typeof $localize&&$localize.locale||Eo),t},deps:[[new fr(du),new pr,new gr]]},{provide:fu,useValue:"USD"}];let Ku=(()=>{class t{constructor(t){}}return t.\u0275fac=function(e){return new(e||t)(cr($u))},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({providers:Xu}),t})(),Zu=null;function Yu(){return Zu}const Qu=new Wn("DocumentToken");let Ju=(()=>{class t{historyGo(t){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({factory:tc,token:t,providedIn:"platform"}),t})();function tc(){return cr(ec)}let ec=(()=>{class t extends Ju{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Yu().getBaseHref(this._doc)}onPopState(t){const e=Yu().getGlobalEventTarget(this._doc,"window");return e.addEventListener("popstate",t,!1),()=>e.removeEventListener("popstate",t)}onHashChange(t){const e=Yu().getGlobalEventTarget(this._doc,"window");return e.addEventListener("hashchange",t,!1),()=>e.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){nc()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){nc()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(cr(Qu))},t.\u0275prov=gt({factory:rc,token:t,providedIn:"platform"}),t})();function nc(){return!!window.history.pushState}function rc(){return new ec(cr(Qu))}function ic(t){return t&&"?"!==t[0]?"?"+t:t}let sc=(()=>{class t{historyGo(t){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({factory:oc,token:t,providedIn:"root"}),t})();function oc(t){const e=cr(Qu).location;return new uc(cr(Ju),e&&e.origin||"")}const ac=new Wn("appBaseHref");let uc=(()=>{class t extends sc{constructor(t,e){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return function(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+ic(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+ic(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+ic(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformLocation).historyGo)||void 0===n||n.call(e,t)}}return t.\u0275fac=function(e){return new(e||t)(cr(Ju),cr(ac,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();var cc=(()=>((cc=cc||{})[cc.Zero=0]="Zero",cc[cc.One=1]="One",cc[cc.Two=2]="Two",cc[cc.Few=3]="Few",cc[cc.Many=4]="Many",cc[cc.Other=5]="Other",cc))();class lc{}let hc=(()=>{class t extends lc{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=wo(e);if(n)return n;const r=e.split("-")[0];if(n=wo(r),n)return n;if("en"===r)return _o;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[xo.PluralCase]}(e||this.locale)(t)){case cc.Zero:return"zero";case cc.One:return"one";case cc.Two:return"two";case cc.Few:return"few";case cc.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(cr(du))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class dc{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let fc=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new dc(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new pc(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const s=new pc(t,i);e.push(s)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(js(wa),js(ga),js(ra))},t.\u0275dir=Qt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class pc{constructor(t,e){this.record=t,this.view=e}}class gc{createSubscription(t,e){return t.subscribe({next:e,error:t=>{throw t}})}dispose(t){t.unsubscribe()}onDestroy(t){t.unsubscribe()}}class mc{createSubscription(t,e){return t.then(e,t=>{throw t})}dispose(t){}onDestroy(t){}}const yc=new mc,bc=new gc;let _c=(()=>{class t{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,e=>this._updateLatestValue(t,e))}_selectStrategy(e){if(Gs(e))return yc;if(Hs(e))return bc;throw Error(`InvalidPipeArgument: '${e}' for pipe '${st(t)}'`)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,e){t===this._obj&&(this._latestValue=e,this._ref.markForCheck())}}return t.\u0275fac=function(e){return new(e||t)(js(la,16))},t.\u0275pipe=Jt({name:"async",type:t,pure:!1}),t})(),vc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({providers:[{provide:lc,useClass:hc}]}),t})();function wc(t){return"browser"===t}class xc extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var t;t=new xc,Zu||(Zu=t)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=(Sc=Sc||document.querySelector("base"),Sc?Sc.getAttribute("href"):null);return null==e?null:function(t){Ec=Ec||document.createElement("a"),Ec.setAttribute("href",t);const e=Ec.pathname;return"/"===e.charAt(0)?e:`/${e}`}(e)}resetBaseElement(){Sc=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}(document.cookie,t)}}let Ec,Sc=null;const Ac=new Wn("TRANSITION_ID"),Tc=[{provide:ru,useFactory:function(t,e,n){return()=>{n.get(iu).donePromise.then(()=>{const n=Yu();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[Ac,Qu,_s],multi:!0}];class Cc{static init(){var t;t=new Cc,ju=t}addToWindow(t){Rt.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},Rt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Rt.getAllAngularRootElements=()=>t.getAllRootElements(),Rt.frameworkStabilizers||(Rt.frameworkStabilizers=[]),Rt.frameworkStabilizers.push(t=>{const e=Rt.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,n--,0==n&&t(r)};e.forEach(function(t){t.whenStable(i)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?Yu().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let Ic=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const Dc=new Wn("EventManagerPlugins");let kc=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}return t.\u0275fac=function(e){return new(e||t)(cr(Dc),cr(Au))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class Oc{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=Yu().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let Mc=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),Pc=(()=>{class t extends Mc{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,e,n){t.forEach(t=>{const r=this._doc.createElement("style");r.textContent=t,n.push(e.appendChild(r))})}addHost(t){const e=[];this._addStylesToHost(this._stylesSet,t,e),this._hostNodes.set(t,e)}removeHost(t){const e=this._hostNodes.get(t);e&&e.forEach(Nc),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((e,n)=>{this._addStylesToHost(t,n,e)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Nc))}}return t.\u0275fac=function(e){return new(e||t)(cr(Qu))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function Nc(t){Yu().remove(t)}const Rc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},jc=/%COMP%/g;function Lc(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Lc(t,i,n):(i=i.replace(jc,t),n.push(i))}return n}function Fc(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Bc=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new zc(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case kt.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new Uc(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case 1:case kt.ShadowDom:return new Vc(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=Lc(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(cr(kc),cr(Pc),cr(su))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class zc{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(Rc[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=Rc[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=Rc[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&(Sr.DashCase|Sr.Important)?t.style.setProperty(e,n,r&Sr.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&Sr.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,Fc(n)):this.eventManager.addEventListener(t,e,Fc(n))}}class Uc extends zc{constructor(t,e,n,r){super(t),this.component=n;const i=Lc(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(jc,r+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(jc,r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Vc extends zc{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=Lc(r.id,r.styles,[]);for(let s=0;s<i.length;s++){const t=document.createElement("style");t.textContent=i[s],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Gc=(()=>{class t extends Oc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(cr(Qu))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const Hc=["alt","control","meta","shift"],$c={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},qc={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Wc={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Xc=(()=>{class t extends Oc{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const i=t.parseEventName(n),s=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Yu().onAndCancel(e,i.domEventName,s))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=t._normalizeKey(n.pop());let s="";if(Hc.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),s+=t+".")}),s+=i,0!=n.length||0===i.length)return null;const o={};return o.domEventName=r,o.fullKey=s,o}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&qc.hasOwnProperty(e)&&(e=qc[e]))}return $c[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),Hc.forEach(r=>{r!=n&&(0,Wc[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(e,n,r){return i=>{t.getEventFullKey(i)===e&&r.runGuarded(()=>n(i))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(cr(Qu))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const Kc=Uu(Wu,"browser",[{provide:cu,useValue:"browser"},{provide:uu,useValue:function(){xc.makeCurrent(),Cc.init()},multi:!0},{provide:Qu,useFactory:function(){return function(t){ye=t}(document),document},deps:[]}]),Zc=[[],{provide:os,useValue:"root"},{provide:wr,useFactory:function(){return new wr},deps:[]},{provide:Dc,useClass:Gc,multi:!0,deps:[Qu,Au,cu]},{provide:Dc,useClass:Xc,multi:!0,deps:[Qu]},[],{provide:Bc,useClass:Bc,deps:[kc,Pc,su]},{provide:Vo,useExisting:Bc},{provide:Mc,useExisting:Pc},{provide:Pc,useClass:Pc,deps:[Qu]},{provide:Mu,useClass:Mu,deps:[Au]},{provide:kc,useClass:kc,deps:[Dc,Au]},{provide:class{},useClass:Ic,deps:[]},[]];let Yc=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:su,useValue:e.appId},{provide:Ac,useExisting:su},Tc]}}}return t.\u0275fac=function(e){return new(e||t)(cr(t,12))},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({providers:Zc,imports:[vc,Ku]}),t})();"undefined"!=typeof window&&window;class Qc extends g{constructor(t,e){super()}schedule(t,e=0){return this}}class Jc extends Qc{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n,r=!1;try{this.work(t)}catch(i){r=!0,n=!!i&&i||new Error(i)}if(r)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let tl=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class el extends tl{constructor(t,e=tl.now){super(t,()=>el.delegate&&el.delegate!==this?el.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return el.delegate&&el.delegate!==this?el.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const nl=new class extends el{}(class extends Jc{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}),rl=new x(t=>t.complete());function il(t){return t?function(t){return new x(e=>t.schedule(()=>e.complete()))}(t):rl}function sl(...t){let e=t[t.length-1];return D(e)?(t.pop(),F(t,e)):W(t)}function ol(t,e){return new x(e?n=>e.schedule(al,0,{error:t,subscriber:n}):e=>e.error(t))}function al({error:t,subscriber:e}){e.error(t)}class ul{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return sl(this.value);case"E":return ol(this.error);case"C":return il()}throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new ul("N",t):ul.undefinedValueNotification}static createError(t){return new ul("E",void 0,t)}static createComplete(){return ul.completeNotification}}ul.completeNotification=new ul("C"),ul.undefinedValueNotification=new ul("N",void 0);class cl extends b{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(cl.dispatch,this.delay,new ll(t,this.destination)))}_next(t){this.scheduleMessage(ul.createNext(t))}_error(t){this.scheduleMessage(ul.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(ul.createComplete()),this.unsubscribe()}}class ll{constructor(t,e){this.notification=t,this.destination=e}}class hl extends C{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new dl(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,n=e?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,i=n.length;let s;if(this.closed)throw new S;if(this.isStopped||this.hasError?s=g.EMPTY:(this.observers.push(t),s=new A(this,t)),r&&t.add(t=new cl(t,r)),e)for(let o=0;o<i&&!t.closed;o++)t.next(n[o]);else for(let o=0;o<i&&!t.closed;o++)t.next(n[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),s}_getNow(){return(this.scheduler||nl).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length;let s=0;for(;s<i&&!(t-r[s].time<n);)s++;return i>e&&(s=Math.max(s,i-e)),s>0&&r.splice(0,s),r}}class dl{constructor(t,e){this.time=t,this.value=e}}function fl(t,e){return"function"==typeof e?n=>n.pipe(fl((n,r)=>B(t(n,r)).pipe(k((t,i)=>e(n,t,r,i))))):e=>e.lift(new pl(t))}class pl{constructor(t){this.project=t}call(t,e){return e.subscribe(new gl(t,this.project))}}class gl extends U{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const n=new z(this),r=this.destination;r.add(n),this.innerSubscription=V(t,n),this.innerSubscription!==n&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}const ml={schedule(t,e){const n=setTimeout(t,e);return()=>clearTimeout(n)},scheduleBeforeRender(t){if("undefined"==typeof window)return ml.schedule(t,0);if(void 0===window.requestAnimationFrame)return ml.schedule(t,16);const e=window.requestAnimationFrame(t);return()=>window.cancelAnimationFrame(e)}};let yl;function bl(t,e,n){let r=n;return function(t){return!!t&&t.nodeType===Node.ELEMENT_NODE}(t)&&e.some((e,n)=>!("*"===e||!function(t,e){if(!yl){const t=Element.prototype;yl=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return t.nodeType===Node.ELEMENT_NODE&&yl.call(t,e)}(t,e)||(r=n,0))),r}class _l{constructor(t,e){this.componentFactory=e.get(jo).resolveComponentFactory(t)}create(t){return new vl(this.componentFactory,t)}}class vl{constructor(t,e){this.componentFactory=t,this.injector=e,this.eventEmitters=new hl(1),this.events=this.eventEmitters.pipe(fl(t=>X(...t))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:t})=>t)),this.ngZone=this.injector.get(Au),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(t){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(t)})}disconnect(){this.runInZone(()=>{null!==this.componentRef&&null===this.scheduledDestroyFn&&(this.scheduledDestroyFn=ml.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(t){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(t):this.componentRef.instance[t])}setInputValue(t,e){this.runInZone(()=>{var n,r;null!==this.componentRef?((n=e)!==(r=this.getInputValue(t))&&(n==n||r==r)||void 0===e&&this.unchangedInputs.has(t))&&(this.recordInputChange(t,e),this.unchangedInputs.delete(t),this.hasInputChanges=!0,this.componentRef.instance[t]=e,this.scheduleDetectChanges()):this.initialInputValues.set(t,e)})}initializeComponent(t){const e=_s.create({providers:[],parent:this.injector}),n=function(t,e){const n=t.childNodes,r=e.map(()=>[]);let i=-1;e.some((t,e)=>"*"===t&&(i=e,!0));for(let s=0,o=n.length;s<o;++s){const t=n[s],o=bl(t,e,i);-1!==o&&r[o].push(t)}return r}(t,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(e,n,t),this.viewChangeDetectorRef=this.componentRef.injector.get(la),this.implementsOnChanges="function"==typeof this.componentRef.instance.ngOnChanges,this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get($u).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:t})=>{this.initialInputValues.has(t)&&this.setInputValue(t,this.initialInputValues.get(t))}),this.initialInputValues.clear()}initializeOutputs(t){const e=this.componentFactory.outputs.map(({propName:e,templateName:n})=>t.instance[e].pipe(k(t=>({name:n,value:t}))));this.eventEmitters.next(e)}callNgOnChanges(t){if(!this.implementsOnChanges||null===this.inputChanges)return;const e=this.inputChanges;this.inputChanges=null,t.instance.ngOnChanges(e)}markViewForCheck(t){this.hasInputChanges&&(this.hasInputChanges=!1,t.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=ml.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(t,e){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const n=this.inputChanges[t];if(n)return void(n.currentValue=e);const r=this.unchangedInputs.has(t),i=r?void 0:this.getInputValue(t);this.inputChanges[t]=new he(i,e,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(t){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(t):t()}}class wl extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}function xl(t,e,n,r){return a(n)&&(r=n,n=void 0),r?xl(t,e,n).pipe(k(t=>d(t)?r(...t):r(t))):new x(r=>{El(t,e,function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)},r,n)})}function El(t,e,n,r,i){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const r=t;t.addEventListener(e,n,i),s=()=>r.removeEventListener(e,n,i)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const r=t;t.on(e,n),s=()=>r.off(e,n)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const r=t;t.addListener(e,n),s=()=>r.removeListener(e,n)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let s=0,o=t.length;s<o;s++)El(t[s],e,n,r,i)}r.add(s)}function Sl(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,n,o):i(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o}function Al(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(e){s(e)}}function a(t){try{u(r.throw(t))}catch(e){s(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}u((r=r.apply(t,e||[])).next())})}class Tl extends C{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new S;return this._value}next(t){super.next(this._value=t)}}class Cl extends b{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class Il extends b{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function Dl(t,e,n,r,i=new Il(t,n,r)){if(!i.closed)return e instanceof x?e.subscribe(i):L(e)(i)}function kl(...t){return q(1)(sl(...t))}Object.create(Error.prototype);const Ol=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function Ml(t){return e=>0===t?il():e.lift(new Pl(t))}class Pl{constructor(t){if(this.total=t,this.total<0)throw new Ol}call(t,e){return e.subscribe(new Nl(t,this.total))}}class Nl extends b{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function Rl(t,e){return function(n){return n.lift(new jl(t,e))}}class jl{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Ll(t,this.predicate,this.thisArg))}}class Ll extends b{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}function Fl(t){return function(e){const n=new Bl(t),r=e.lift(n);return n.caught=r}}class Bl{constructor(t){this.selector=t}call(t,e){return e.subscribe(new zl(t,this.selector,this.caught))}}class zl extends U{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new z(this);this.add(r);const i=V(n,r);i!==r&&this.add(i)}}}function Ul(t=null){return e=>e.lift(new Vl(t))}class Vl{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Gl(t,this.defaultValue))}}class Gl extends b{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function Hl(){}function $l(t,e,n){return function(r){return r.lift(new ql(t,e,n))}}class ql{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new Wl(t,this.nextOrObserver,this.error,this.complete))}}class Wl extends b{constructor(t,e,n,r){super(t),this._tapNext=Hl,this._tapError=Hl,this._tapComplete=Hl,this._tapError=n||Hl,this._tapComplete=r||Hl,a(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||Hl,this._tapError=e.error||Hl,this._tapComplete=e.complete||Hl)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}class Xl{constructor(t){this.total=t}call(t,e){return e.subscribe(new Kl(t,this.total))}}class Kl extends b{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){++this.count>this.total&&this.destination.next(t)}}let Zl=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Qt({type:t,selectors:[["","gaEvent","","gaCategory",""],["","gaCategory",""]],inputs:{gaCategory:"gaCategory"},exportAs:["gaCategory"]}),t})();const Yl=new Wn("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),Ql=new Wn("ngx-window",{providedIn:"root",factory:()=>wc(lr(cu))?window:null}),Jl=new Wn("ngx-data-layer",{providedIn:"root",factory:()=>function(t){return t?t.dataLayer=t.dataLayer||[]:null}(lr(Ql))}),th=new Wn("ngx-gtag-fn",{providedIn:"root",factory:()=>function(t,e){return t?t.gtag=t.gtag||function(){e.push(arguments)}:null}(lr(Ql),lr(Jl))});let eh=(()=>{class t{constructor(t,e,n){this.settings=t,this._document=e,this._gtag=n}get document(){return this._document}throw(t){(this.settings.enableTracing||Bu())&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((t,[e,n])=>Object.defineProperty(t,e,{value:n,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(t=>void 0!==t))}catch(e){this.throw(e)}}event(t,e,n,r,i){try{const s=new Map;e&&s.set("event_category",e),n&&s.set("event_label",n),r&&s.set("value",r),void 0!==i&&s.set("interaction",i);const o=this.toKeyValue(s);o?this.gtag("event",t,o):this.gtag("event",t)}catch(s){this.throw(s)}}pageView(t,e,n,r){try{const i=new Map([["page_path",t]]);e&&i.set("page_title",e),(n||this.document)&&i.set("page_location",n||this.document.location.href),r&&Object.entries(r).map(([t,e])=>i.set(t,e)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(i))}catch(i){this.throw(i)}}appView(t,e,n,r,i){try{const s=new Map([["screen_name",t],["app_name",e]]);n&&s.set("app_id",n),r&&s.set("app_version",r),i&&s.set("app_installer_id",i),this.gtag("event","screen_view",this.toKeyValue(s))}catch(s){this.throw(s)}}set(...t){try{this._gtag("set",...t)}catch(e){this.throw(e)}}exception(t,e){try{const n=new Map;t&&n.set("description",t),e&&n.set("fatal",e),this.toKeyValue(n)?this.gtag("event","exception",this.toKeyValue(n)):this.gtag("event","exception")}catch(n){this.throw(n)}}}return t.\u0275fac=function(e){return new(e||t)(cr(Yl),cr(Qu),cr(th))},t.\u0275prov=gt({factory:function(){return new t(cr(Yl),cr(Qu),cr(th))},token:t,providedIn:"root"}),t})(),nh=(()=>{class t{constructor(t,e,n,r){this.gaCategoryDirective=t,this.gaService=e,this.settings=n,this.el=r,this.gaBind="click"}set gaBind(t){this.bindSubscription&&this.bindSubscription.unsubscribe(),this._gaBind=t,this.bindSubscription=xl(this.el.nativeElement,t).subscribe(()=>this.trigger())}get gaBind(){return this._gaBind}ngOnDestroy(){this.bindSubscription&&this.bindSubscription.unsubscribe()}trigger(){try{if(!this.gaAction&&!this.gaEvent)throw new Error("You must provide a gaAction attribute to identify this event.");this.gaService.event(this.gaAction||this.gaEvent,this.gaCategoryDirective?this.gaCategoryDirective.gaCategory:void 0,this.gaLabel||this.label,this.gaValue,this.gaInteraction)}catch(t){this.throw(t)}}throw(t){(Bu()||this.settings.enableTracing)&&console&&console.warn&&console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)(js(Zl,8),js(eh),js(Yl),js(zo))},t.\u0275dir=Qt({type:t,selectors:[["","gaEvent",""]],inputs:{gaBind:"gaBind",gaAction:"gaAction",gaLabel:"gaLabel",label:"label",gaValue:"gaValue",gaInteraction:"gaInteraction",gaEvent:"gaEvent"},exportAs:["gaEvent"]}),t})();const rh={provide:ru,multi:!0,useFactory:function(t,e,n){return()=>Al(this,void 0,void 0,function*(){var r;if(!t.trackingCode)return void(Bu()||console.error("Empty tracking code for Google Analytics. Make sure to provide one when initializing NgxGoogleAnalyticsModule."));if(!e)return void(Bu()||console.error("Was not possible create or read gtag() fn. Make sure this module is running on a Browser w/ access to Window interface."));n||Bu()||console.error("Was not possible to access Document interface. Make sure this module is running on a Browser w/ access do Document interface."),t.uri=t.uri||`https://www.googletagmanager.com/gtag/js?id=${t.trackingCode}`,t.initCommands=null!==(r=null==t?void 0:t.initCommands)&&void 0!==r?r:[],t.initCommands.find(t=>"config"===t.command)||t.initCommands.unshift({command:"config",values:[t.trackingCode]}),t.initCommands.find(t=>"js"===t.command)||t.initCommands.unshift({command:"js",values:[new Date]});for(const n of t.initCommands)e(n.command,...n.values);const i=n.createElement("script");i.async=!0,i.src=t.uri,t.nonce&&i.setAttribute("nonce",t.nonce),n.getElementsByTagName("head")[0].appendChild(i)})},deps:[Yl,th,Qu]};new Wn("ngx-google-analytics-routing-settings",{factory:()=>({})});let ih=(()=>{class t{static forRoot(e,n=[],r,i,s){return{ngModule:t,providers:[{provide:Yl,useValue:{trackingCode:e,initCommands:n,uri:r,enableTracing:i,nonce:s}},rh]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[]]}),t})(),sh=(()=>{class t{static forRoot(e){const{providers:n=[]}=ih.forRoot(e.gaToken,function(t){const{appName:e,projectName:n,developmentMode:r}=t;return[{command:"set",values:[(i={appName:e,projectName:n,developmentMode:r},Object.entries(i).reduce((t,[e,n])=>(null!=n&&(t[e]=`${n}`),t),{}))]}];var i}(e));return{ngModule:t,providers:n}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[ih]]}),t})();const oh={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],organNodes:["http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0002049"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@1/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"search-api",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"https://search.api.hubmapconsortium.org/entities/search",hubmapAssetsUrl:"https://assets.hubmapconsortium.org",hubmapToken:localStorage.getItem("HUBMAP_TOKEN")||""},googleAnalyticsToken:"G-ERNVZ1Q4KE"};function ah(t,e,n){let r;return r=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},t=>t.lift(function({bufferSize:t=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:n,scheduler:r}){let i,s,o=0,a=!1,u=!1;return function(c){let l;o++,!i||a?(a=!1,i=new hl(t,e,r),l=i.subscribe(this),s=c.subscribe({next(t){i.next(t)},error(t){a=!0,i.error(t)},complete(){u=!0,s=void 0,i.complete()}}),u&&(s=void 0)):l=i.subscribe(this),this.add(()=>{o--,l.unsubscribe(),l=void 0,s&&!u&&n&&0===o&&(s.unsubscribe(),s=void 0,i=void 0)})}}(r))}function uh(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new ch(t,n))}}class ch{constructor(t,e){this.observables=t,this.project=e}call(t,e){return e.subscribe(new lh(t,this.observables,this.project))}}class lh extends Cl{constructor(t,e,n){super(t),this.observables=e,this.project=n,this.toRespond=[];const r=e.length;this.values=new Array(r);for(let i=0;i<r;i++)this.toRespond.push(i);for(let i=0;i<r;i++)this.add(Dl(this,e[i],void 0,i))}notifyNext(t,e,n){this.values[n]=e;const r=this.toRespond;if(r.length>0){const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}notifyComplete(){}_next(t){if(0===this.toRespond.length){const e=[t,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(t){let e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function hh(t){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function dh(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||hh()}const fh="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",ph=dh();class gh{constructor(t,e,n="sessionStorage"){this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(e){return null}}(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function mh(t,e,n,r=600){const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const yh={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function bh(t){return"string"==typeof t?yh[t.toUpperCase()]||yh.WHITE:t}function _h(t,e){if(!t)throw new Error(e||"Assertion failed")}const vh={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},wh=vh.window||vh.self||vh.global,xh=vh.process||{};function Eh(){let t;if(ph&&wh.performance)t=wh.performance.now();else if(xh.hrtime){const e=xh.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}console;const Sh={debug:ph&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Ah={enabled:!0,level:0};function Th(){}const Ch={},Ih={once:!0};function Dh(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}let kh=(()=>{class t{constructor({id:t}={id:""}){this.id=t,this.VERSION=fh,this._startTs=Eh(),this._deltaTs=Eh(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new gh("__probe-".concat(this.id,"__"),Ah),this.userData={},this.timeStamp("".concat(this.id," started")),function(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)"function"==typeof t[i]&&(e.find(t=>i===t)||(t[i]=t[i].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Eh()-this._startTs).toPrecision(10))}getDelta(){return Number((Eh()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,e){_h(t,e)}warn(t){return this._getLogFunction(0,t,Sh.warn,arguments,Ih)}error(t){return this._getLogFunction(0,t,Sh.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Sh.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Sh.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,Sh.debug||Sh.info,arguments,Ih)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||Th,n&&[n],{tag:Dh(e)}):Th}image({logLevel:t,priority:e,image:r,message:i="",scale:s=1}){return this._shouldLog(t||e)?ph?function({image:t,message:e="",scale:n=1}){if("string"==typeof t){const r=new Image;return r.onload=()=>{const t=mh(r,e,n);console.log(...t)},r.src=t,Th}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...mh(t,e,n)),Th;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...mh(r,e,n)),r.src=t.toDataURL(),Th}return Th}({image:r,message:i,scale:s}):function({image:t,message:e="",scale:r=1}){let i=null;try{i=n(307)}catch(s){}return i?()=>i(t,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then(t=>console.log(t)):Th}({image:r,message:i,scale:s}):Th}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||Th)}group(t,e,n={collapsed:!1}){n=Mh({logLevel:t,message:e,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(t,e,n={}){return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Th)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=Oh(t)}_getLogFunction(t,e,n,r=[],i){if(this._shouldLog(t)){i=Mh({logLevel:t,message:e,args:r,opts:i}),_h(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=Eh();const s=i.tag||i.message;if(i.once){if(Ch[s])return Th;Ch[s]=Eh()}return e=function(t,e,n){if("string"==typeof e){const o=n.time?function(t,e=8){const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";r=e=n.time?"".concat(t,": ").concat(o,"  ").concat(e):"".concat(t,": ").concat(e),i=n.color,s=n.background,ph||"string"!=typeof r||(i&&(i=bh(i),r="\x1b[".concat(i,"m").concat(r,"\x1b[39m")),s&&(i=bh(s),r="\x1b[".concat(s+10,"m").concat(r,"\x1b[49m"))),e=r}var r,i,s;return e}(this.id,i.message,i),n.bind(console,e,...i.args)}return Th}}return t.VERSION=fh,t})();function Oh(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return _h(Number.isFinite(e)&&e>=0),e}function Mh(t){const{logLevel:e,message:n}=t;t.logLevel=Oh(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(t.args=r,typeof e){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const i=typeof t.message;return _h("string"===i||"object"===i),Object.assign(t,t.opts)}const Ph=new kh({id:"deck"}),Nh={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Nh,"IDENTITY",{get:()=>Ph.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const Rh={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},jh={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Lh=new kh({id:"luma.gl"});function Fh(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Bh(t){return"undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version))}function zh(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function Uh(t){return Fh(Bh(t),"Invalid WebGLRenderingContext"),t}function Vh(t){return Fh(zh(t),"Requires WebGL2"),t}var Gh=n(761);const Hh={},$h=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const e=new t.VertexAttrib(n);this.attribs[r]=e}this.maxAttrib=0};($h.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const qh=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(Hh[n]=!0)}while(0!==n);for(n in Hh)if(Hh[n])return delete Hh[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,r){switch(t){case 34962:e.currentArrayBuffer=r;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,r){const i=e.currentVertexArrayObject,s=i.attribs[t];switch(r){case 34975:return s.buffer;case 34338:return s.enabled;case 34339:return s.size;case 34340:return s.stride;case 34341:return s.type;case 34922:return s.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,r,i,s,o,a){const u=e.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,t);const c=u.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=r,c.type=i,c.normalized=s,c.stride=o,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",()=>{Gh.CO.console&&Gh.CO.console.log&&Gh.CO.console.log("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};qh.prototype.VERTEX_ARRAY_BINDING_OES=34229,qh.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new $h(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},qh.prototype.createVertexArrayOES=function(){const t=new $h(this);return this.vertexArrayObjects.push(t),t},qh.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},qh.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof $h&&t.hasBeenBound&&t.ext===this)},qh.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return n="bindVertexArrayOES: attempt to bind deleted arrayObject",Hh[1282]=!0,void(Gh.CO.console&&Gh.CO.console.error&&Gh.CO.console.error(n));var n;const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;i&&s.elementArrayBuffer===i.elementArrayBuffer||r.bindBuffer.call(e,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let u=0;u<=a;u++){const t=s.attribs[u],n=i?i.attribs[u]:null;if(i&&t.enabled===n.enabled||(t.enabled?r.enableVertexAttribArray.call(e,u):r.disableVertexAttribArray.call(e,u)),t.enabled){let s=!1;i&&t.buffer===n.buffer||(o!==t.buffer&&(r.bindBuffer.call(e,34962,t.buffer),o=t.buffer),s=!0),(s||t.cached!==n.cached)&&r.vertexAttribPointer.call(e,u,t.size,t.type,t.normalized,t.stride,t.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(e,34962,this.currentArrayBuffer)};const Wh="OES_element_index",Xh="WEBGL_draw_buffers",Kh="WEBGL_debug_renderer_info",Zh=t=>zh(t)?void 0:0,Yh={3074:t=>zh(t)?void 0:36064,35723:t=>zh(t)?void 0:4352,35977:Zh,32937:Zh,36795:(t,e)=>{const n=zh(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(Kh);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(Kh);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Zh,35071:Zh,37447:Zh,36063:(t,e)=>{if(!zh(t)){const n=t.getExtension(Xh);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Zh,35374:Zh,35377:Zh,34852:t=>{if(!zh(t)){const e=t.getExtension(Xh);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(Wh)?2147483647:65535,33001:t=>t.getExtension(Wh)?16777216:65535,33e3:t=>16777216,37157:Zh,35373:Zh,35657:Zh,36183:Zh,37137:Zh,34045:Zh,35978:Zh,35979:Zh,35968:Zh,35376:Zh,35375:Zh,35659:Zh,37154:Zh,35371:Zh,35658:Zh,35076:Zh,35077:Zh,35380:Zh},Qh={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Fh(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},ANGLE_instanced_arrays:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Fh(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Fh(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Fh(!1)},deleteQuery:()=>{Fh(!1)},beginQuery:()=>{Fh(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Jh={readBuffer:(t,e,n)=>{zh(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=function(t,e){return{webgl2:zh(t),ext:t.getExtension("ANGLE_instanced_arrays")}}(t);let o;switch(r){case 35069:o=!!i&&void 0;break;case 35070:o=i||s?void 0:0}return void 0!==o?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!zh(t))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!zh(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;r=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,r)},getParameter:function(t,e,n){const r=Yh[n],i="function"==typeof r?r(t,e,n):r;return void 0!==i?i:e(n)},hint:(t,e,n,r)=>e(n,r)};function td(t,{extension:e,target:n,target2:r}){const i=Qh[e];Fh(i);const{meta:s={}}=i,{suffix:o=""}=s,a=t.getExtension(e);for(const u of Object.keys(i)){const e=`${u}${o}`;let s=null;"meta"===u||"function"==typeof t[u]||(a&&"function"==typeof a[e]?s=(...t)=>a[e](...t):"function"==typeof i[u]&&(s=i[u].bind(n))),s&&(n[u]=s,r[u]=s)}}("undefined"!=typeof global?global:window).polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(function(t){if("function"==typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new qh(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&td(t,{extension:n,target:t.luma,target2:t})}(t,Qh),function(t,{target:e,target2:n}){Object.keys(Jh).forEach(r=>{if("function"==typeof Jh[r]){const i=t[r]?t[r].bind(t):()=>{},s=Jh[r].bind(null,t,i);e[r]=s,n[r]=s}})}(t,{target:e,target2:t}),e.polyfilled=!0),t};const ed={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},nd=(t,e,n)=>e?t.enable(n):t.disable(n),rd=(t,e,n)=>t.hint(n,e),id=(t,e,n)=>t.pixelStorei(n,e);function sd(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const od={3042:nd,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:nd,2885:(t,e)=>t.cullFace(e),2929:nd,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:nd,35723:rd,36006:(t,e)=>{const n=zh(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:rd,2849:(t,e)=>t.lineWidth(e),32823:nd,32824:"polygonOffset",10752:"polygonOffset",35977:nd,32938:"sampleCoverage",32939:"sampleCoverage",3089:nd,3088:(t,e)=>t.scissor(...e),2960:nd,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:id,3317:id,37440:id,37441:id,37443:id,3330:id,3332:id,3331:id,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:id,32878:id,3316:id,3315:id,32877:id,framebuffer:(t,e)=>t.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=sd(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=sd(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=sd(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=sd(e)&&3===e.length?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=sd(e)&&3===e.length?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function ad(t,e,n){return void 0!==e[t]?e[t]:n[t]}const ud={blendEquation:(t,e,n)=>t.blendEquationSeparate(ad(32777,e,n),ad(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(ad(32969,e,n),ad(32968,e,n),ad(32971,e,n),ad(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(ad(32824,e,n),ad(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(ad(32938,e,n),ad(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,ad(2962,e,n),ad(2967,e,n),ad(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,ad(34816,e,n),ad(36003,e,n),ad(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,ad(2964,e,n),ad(2965,e,n),ad(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,ad(34817,e,n),ad(34818,e,n),ad(34819,e,n))},cd={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:r,[1028===e?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:r,[1028===e?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},ld=(t,e)=>t.isEnabled(e),hd={3042:ld,2884:ld,2929:ld,3024:ld,32823:ld,32926:ld,32928:ld,3089:ld,2960:ld,35977:ld};function dd(t){for(const e in t)return!1;return!0}function fd(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function pd(t,e){const n=t[e].bind(t);t[e]=function(...e){const r=e[0];return r in t.state.cache||(t.state.cache[r]=n(...e)),t.state.enable?t.state.cache[r]:n(...e)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function gd(t,e,n){const r=t[e].bind(t);t[e]=function(...e){const{valueChanged:i,oldValue:s}=n(t.state._updateCache,...e);return i&&r(...e),s},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}class md{constructor(t,{copyState:e=!1,log:n=(()=>{})}={}){this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?function(t,e){if("number"==typeof(e=e||ed)){const n=e,r=hd[n];return r?r(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const e=hd[i];r[i]=e?e(t,Number(i)):t.getParameter(Number(i))}return r}(t):Object.assign({},ed),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){Fh(this.stateStack.length>0),_d(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(t){let e,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const i in t){Fh(void 0!==i);const s=t[i],o=this.cache[i];fd(s,o)||(n=!0,e=o,r&&!(i in r)&&(r[i]=o),this.cache[i]=s)}return{valueChanged:n,oldValue:e}}}function yd(t,e={}){const{enable:n=!0,copyState:r}=e;if(Fh(void 0!==r),!t.state){const e="undefined"!=typeof global?global:window,{polyfillContext:n}=e;n&&n(t),t.state=new md(t,{copyState:r}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}(t);for(const r in cd)gd(t,r,cd[r]);pd(t,"getParameter"),pd(t,"isEnabled")}return t.state.enable=n,t}function bd(t){Fh(t.state),t.state.pop()}function _d(t,e){if(Fh(Bh(t),"setParameters requires a WebGL context"),dd(e))return;const n={};for(const i in e){const r=Number(i),s=od[i];s&&("string"==typeof s?n[s]=!0:s(t,e[i],r))}const r=t.state&&t.state.cache;if(r)for(const i in n)(0,ud[i])(t,e,r)}function vd(t,e,n){if(dd(e))return n(t);const{nocatch:r=!0}=e;let i;if(function(t){t.state||yd(t,{copyState:!1}),t.state.push()}(t),_d(t,e),r)i=n(t),bd(t);else try{i=n(t)}finally{bd(t)}return i}function wd(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function xd(t,e,n=!0){return function(t,e,n,r,i){const s=Ed(t[0],e,n);let o=Sd(t[1],e,r,i),a=Ed(t[0]+1,e,n);const u=a===n-1?a:a-1;let c;return a=Sd(t[1]+1,e,r,i),i?(a=0===a?a:a+1,c=o,o=a):c=a===r-1?a:a-1,{x:s,y:o,width:Math.max(u-s+1,1),height:Math.max(c-o+1,1)}}(e,wd(t),t.drawingBufferWidth,t.drawingBufferHeight,n)}function Ed(t,e,n){return Math.min(Math.round(t*e),n-1)}function Sd(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Ad=(0,Gh.jU)(),Td=Ad&&"undefined"!=typeof document,Cd={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Id(t={}){Fh(Ad,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},Cd,t);const{width:e,height:n}=t;function r(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let i;t.onError=r;const{canvas:s}=t;return i=function(t,e){const{onError:n}=e;let r=null;const i=t=>r=t.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${r||"Unknown error"}`)}(function({canvas:t,width:e=800,height:n=600,onError:r}){let i;return"string"==typeof t?(Td&&"complete"===document.readyState||r(`createGLContext called on canvas '${t}' before page was loaded`),i=document.getElementById(t)):t?i=t:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(n)?`${n}px`:"100%",document.body.insertBefore(i,document.body.firstChild)),i}({canvas:s,width:e,height:n,onError:r}),t),i?(i=Dd(i,t),function(t){const e=zh(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t);Lh.info(1,`${e}${t.debug?" debug":""} context ${n?`(${n.vendor},${n.renderer})`:""}`)()}(i),i):null}function Dd(t,e={}){if(!t||t._instrumented)return t;t._version=t._version||function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Cd,e);const{manageState:n,debug:r}=e;return n&&yd(t,{copyState:!1,log:(...t)=>Lh.log(1,...t)()}),Ad&&r&&(Gh.CO.makeDebugContext?(t=Gh.CO.makeDebugContext(t,e),Lh.level=Math.max(Lh.level,1)):Lh.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function kd(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class Od{constructor(t,e){this.name=t,this.type=e,this.sampleSize=1,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=kd(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(kd()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Md{constructor({id:t,stats:e}){this.id=t,this.stats={},this._initializeStats(e),Object.seal(this)}get(t,e="count"){return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(t=[]){t.forEach(t=>this._getOrCreate(t))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof Od?t:new Od(e,n)),this.stats[e]}}const Pd="8.5.7",Nd=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new Md({id:t})),this.stats.get(t)}};if(Gh.CO.luma&&Gh.CO.luma.VERSION!==Pd)throw new Error(`luma.gl - multiple VERSIONs detected: ${Gh.CO.luma.VERSION} vs 8.5.7`);function Rd(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function jd(t,e){if("string"!=typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const r=t[e=e.replace(/^.*\./,"")];return Rd(void 0!==r,`Accessing undefined constant GL.${e}`),r}function Ld(t,e){e=Number(e);for(const n in t)if(t[n]===e)return`GL.${n}`;return String(e)}Gh.CO.luma||((0,Gh.jU)()&&Lh.log(1,"luma.gl 8.5.7 - set luma.log.level=1 (or higher) to trace rendering")(),Gh.CO.luma=Gh.CO.luma||{VERSION:Pd,version:Pd,log:Lh,stats:Nd,globals:{modules:{},nodeIO:{}}});const Fd={};function Bd(t="id"){return Fd[t]=Fd[t]||1,`${t}-${Fd[t]++}`}function zd(t){return Rd("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function Ud(t){let e=!0;for(const n in t){e=!1;break}return e}function Vd(t,e,n,r){const i=`See luma.gl ${n} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(t);r.forEach(t=>{s.methodName||(s[t]=()=>{throw Lh.removed(`Calling removed method ${e}.${t}: `,i)(),new Error(t)})})}const Gd="Resource subclass must define virtual methods";class Hd{constructor(t,e={}){Uh(t);const{id:n,userData:r={}}=e;this.gl=t,this.gl2=t,this.id=n||Bd(this.constructor.name),this.userData=r,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:t=!1}={}){const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach(t=>t.delete()),this}bind(t=this.handle){if("function"!=typeof t)return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t,e={}){Rd(t=jd(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=zh(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension)){const e=n.webgl1,r="webgl2"in n?n.webgl2:n.webgl1;return t?r:e}}return this._getParameter(t,e)}getParameters(t={}){const{parameters:e,keys:n}=t,r=this.constructor.PARAMETERS||{},i=zh(this.gl),s={},o=e||Object.keys(r);for(const a of o){const e=r[a];if(e&&(!("webgl2"in e)||i)&&(!("extension"in e)||this.gl.getExtension(e.extension))){const r=n?Ld(this.gl,a):a;s[r]=this.getParameter(a,t),n&&"GLenum"===e.type&&(s[r]=Ld(this.gl,s[r]))}}return s}setParameter(t,e){Rd(t=jd(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=zh(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=jd(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return Vd(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(Gd)}_deleteHandle(){throw new Error(Gd)}_bindHandle(t){throw new Error(Gd)}_getOptsFromHandle(){throw new Error(Gd)}_getParameter(t,e){throw new Error(Gd)}_setParameter(t,e){throw new Error(Gd)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this.constructor.name,e=Nd.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}_removeStats(){const t=this.constructor.name;Nd.get("Resource Counts").get(`${t}s Active`).decrementCount()}_trackAllocatedMemory(t,e=this.constructor.name){const n=Nd.get("Memory Usage");n.get("GPU Memory").addCount(t),n.get(`${e} Memory`).addCount(t),this.byteLength=t}_trackDeallocatedMemory(t=this.constructor.name){const e=Nd.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get(`${t} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function $d(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function qd(t,{clamped:e=!0}={}){switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Wd({data:t,width:e,height:n}){const r=Math.round(e/2),i=Math.round(n/2),s=new Uint8Array(r*i*4);for(let o=0;o<i;o++)for(let n=0;n<r;n++)for(let i=0;i<4;i++)s[4*(o*r+n)+i]=t[4*(2*o*e+2*n)+i];return{data:s,width:r,height:i}}function Xd(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)a in e&&Lh.removed(`${t}.${a}`,r[a]?`${t}.${r[a]}`:"N/A")();for(const a in i)a in e&&Lh.deprecated(`${t}.${a}`,`${t}.${i[a]}`)();let o=null;for(const a in s)if(a in e){const n=s[a];Lh.deprecated(`${t}.${a}`,`${t}.${n}`)(),o=o||Object.assign({},e),o[n]=e[a],delete o[a]}return o||e}const Kd={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Zd={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Yd{static getBytesPerElement(t){return qd(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return Rd(t.size),qd(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new Yd(...[Kd,...t])}constructor(...t){t.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Yd.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Yd.getBytesPerVertex(this)}_assign(t={}){return void 0!==(t=Xd("Accessor",t,Zd)).type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&(this.index="boolean"==typeof t.index?t.index?1:0:t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}const Qd={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Jd={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:Qd},tf={removedProps:Qd};class ef extends Hd{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(t=this.accessor){return Math.round(this.byteLength/Yd.getBytesPerElement(t))}getVertexCount(t=this.accessor){return Math.round(this.byteLength/Yd.getBytesPerVertex(t))}initialize(t={}){return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=Xd("Buffer",t,Jd),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=Xd("Buffer",t,tf))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new Yd(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:r=0}=t,i=t.byteLength||t.length;Rd(e);const s=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(s,this.handle),0!==r||void 0!==i?(Vh(this.gl),this.gl.bufferSubData(this.target,n,e,r,i)):this.gl.bufferSubData(s,n,e),this.gl.bindBuffer(s,null),this.debugData=null,this._inferType(e),this}copyData({sourceBuffer:t,readOffset:e=0,writeOffset:n=0,size:r}){const{gl:i}=this;return Vh(i),i.bindBuffer(36662,t.handle),i.bindBuffer(36663,this.handle),i.copyBufferSubData(36662,36663,e,n,r),i.bindBuffer(36662,null),i.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:r=0}={}){Vh(this.gl);const i=qd(this.accessor.type||5126,{clamped:!1}),s=this._getAvailableElementCount(e),o=n;let a,u;t?(u=t.length,a=u-o):(a=Math.min(s,r||s),u=o+a);const c=Math.min(s,a);return Rd((r=r||c)<=c),t=t||new i(u),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,r),this.gl.bindBuffer(36662,null),t}bind({target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:r}={}){return 35345===t||35982===t?void 0!==r?this.gl.bindBufferRange(t,e,this.handle,n,r):(Rd(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind({target:t=this.target,index:e=this.accessor&&this.accessor.index}={}){return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t,e=0,n=t.byteLength+e){Rd(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,e,t),this.gl.bindBuffer(r,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const i=$d(t);return Rd(i),this.setAccessor(new Yd(this.accessor,{type:i})),this}_setByteLength(t,e=this.usage){Rd(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/qd(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new Yd(this.accessor,{type:$d(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return Lh.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Lh.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return Lh.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return Lh.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Yd(this.accessor,t),this}}const nf={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},rf={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},sf={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},of=[9729,9728],af=Gh.CO.WebGLBuffer||function(){};class uf extends Hd{static isSupported(t,e={}){const{format:n,linearFiltering:r}=e;let i=!0;return n&&(i=i&&function(t,e){const n=nf[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const r=zh(t)&&n.gl2||n.gl1;return"string"==typeof r?t.getExtension(r):r}(t,n),i=i&&(!r||function(t,e){const n=nf[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(t,n))),i}constructor(t,e){const{id:n=Bd("texture"),handle:r,target:i}=e;super(t,{id:n,handle:r}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(t={}){let e=t.data;if(e instanceof Promise)return e.then(e=>this.initialize(Object.assign({},t,{pixels:e,data:e}))),this;const n="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",()=>this.initialize(t)),this;const{pixels:r=null,format:i=6408,border:s=0,recreate:o=!1,parameters:a={},pixelStore:u={},textureUnit:c}=t;e||(e=r);let{width:l,height:h,dataFormat:d,type:f,compressed:p=!1,mipmaps:g=!0}=t;const{depth:m=0}=t;return({width:l,height:h,compressed:p,dataFormat:d,type:f}=this._deduceParameters({format:i,type:f,dataFormat:d,compressed:p,data:e,width:l,height:h})),this.width=l,this.height=h,this.depth=m,this.format=i,this.type=f,this.dataFormat=d,this.border=s,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(Lh.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:e,width:l,height:h,depth:m,format:i,type:f,dataFormat:d,border:s,mipmaps:g,parameters:u,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),o&&(this.data=e),n&&(this._video={video:e,parameters:a,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize({height:t,width:e,mipmaps:n=!1}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:n}):this}generateMipmap(t={}){return this._isNPOT()?(Lh.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),vd(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:r=0,format:i=this.format,border:s=this.border,offset:o=0,parameters:a={}}=t;let{data:u=null,type:c=this.type,width:l=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:f=!1}=t;u||(u=n),({type:c,dataFormat:d,compressed:f,width:l,height:h}=this._deduceParameters({format:i,type:c,dataFormat:d,compressed:f,data:u,width:l,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;return({data:u,dataType:m}=this._getDataType({data:u,compressed:f})),vd(this.gl,a,()=>{switch(m){case"null":p.texImage2D(e,r,i,l,h,s,d,c,u);break;case"typed-array":p.texImage2D(e,r,i,l,h,s,d,c,u,o);break;case"buffer":g=Vh(p),g.bindBuffer(35052,u.handle||u),g.texImage2D(e,r,i,l,h,s,d,c,o),g.bindBuffer(35052,null);break;case"browser-object":zh(p)?p.texImage2D(e,r,i,l,h,s,d,c,u):p.texImage2D(e,r,i,d,c,u);break;case"compressed":for(const[t,n]of u.entries())p.compressedTexImage2D(e,t,n.format,n.width,n.height,s,n.data);break;default:Rd(!1,"Unknown image data type")}}),this._trackAllocatedMemory(u&&u.byteLength?u.byteLength:this.width*this.height*(rf[this.dataFormat]||4)*(sf[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:e=null,data:n=null,x:r=0,y:i=0,width:s=this.width,height:o=this.height,level:a=0,format:u=this.format,type:c=this.type,dataFormat:l=this.dataFormat,compressed:h=!1,offset:d=0,border:f=this.border,parameters:p={}}){if(({type:c,dataFormat:l,compressed:h,width:s,height:o}=this._deduceParameters({format:u,type:c,dataFormat:l,compressed:h,data:n,width:s,height:o})),Rd(0===this.depth,"texSubImage not supported for 3D textures"),n||(n=e),n&&n.data){const t=n;n=t.data,s=t.shape[0],o=t.shape[1]}n instanceof ef&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),vd(this.gl,p,()=>{if(h)this.gl.compressedTexSubImage2D(t,a,r,i,s,o,u,n);else if(null===n)this.gl.texSubImage2D(t,a,r,i,s,o,l,c,null);else if(ArrayBuffer.isView(n))this.gl.texSubImage2D(t,a,r,i,s,o,l,c,n,d);else if(n instanceof af){const e=Vh(this.gl);e.bindBuffer(35052,n),e.texSubImage2D(t,a,r,i,s,o,l,c,d),e.bindBuffer(35052,null)}else zh(this.gl)?Vh(this.gl).texSubImage2D(t,a,r,i,s,o,l,c,n):this.gl.texSubImage2D(t,a,r,i,l,c,n)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return Lh.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType({data:t,compressed:e=!1}){return e?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof ef?{data:t.handle,dataType:"buffer"}:t instanceof af?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:r,height:i,dataFormat:s,type:o,compressed:a}=t;const u=nf[e];return s=s||u&&u.dataFormat,o=o||u&&u.types[0],a=a||u&&u.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:s,type:o,compressed:a,width:r,height:i,format:e,data:n}}_deduceImageSize(t,e,n){let r;return r="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},Rd(r,"Could not deduced texture size"),Rd(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),Rd(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Rd(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(zh(this.gl)||!this.width||!this.height||zd(this.width)&&zd(this.height))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===of.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}class cf extends uf{static isSupported(t,e){return uf.isSupported(t,e)}constructor(t,e={}){var n;Uh(t),(e instanceof Promise||"string"==typeof e)&&(e={data:e}),"string"==typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,Rd("string"==typeof n),n=""+n,new Promise((t,e)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>e(new Error(`Could not load image ${n}.`)),r.crossOrigin="anonymous",r.src=n}catch(r){e(r)}}))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const lf="EXT_color_buffer_float",hf={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:lf,bpp:2},33327:{gl2:lf,bpp:4},34842:{gl2:lf,bpp:8},33326:{gl2:lf,bpp:4},33328:{gl2:lf,bpp:8},34836:{gl2:lf,bpp:16},35898:{gl2:lf,bpp:4}};class df extends Hd{static isSupported(t,{format:e}={format:null}){return!e||function(t,e,n){const r=n[e];if(!r)return!1;const i=zh(t)&&r.gl2||r.gl1;return"string"==typeof i?t.getExtension(i):i}(t,e,hf)}static getSamplesForFormat(t,{format:e}){return t.getInternalformatParameter(36161,e,32937)}constructor(t,e={}){super(t,e),this.initialize(e),Object.seal(this)}initialize({format:t,width:e=1,height:n=1,samples:r=0}){return Rd(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&zh(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,t,e,n):this.gl.renderbufferStorage(36161,t,e,n),this.format=t,this.width=e,this.height=n,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*hf[this.format].bpp),this}resize({width:t,height:e}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}const ff="clear: bad arguments";function pf(t,{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}={}){const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=16384,!0!==n&&(s.clearColor=n)),r&&(o|=256,!0!==r&&(s.clearDepth=r)),i&&(o|=1024,!0!==r&&(s.clearStencil=r)),Rd(0!==o,ff),vd(t,s,()=>{t.clear(o)})}const gf=[34069,34070,34071,34072,34073,34074];let mf=(()=>{class t extends uf{constructor(t,e={}){Uh(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(t={}){const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)}),this}subImage({face:t,data:e,x:n=0,y:r=0,mipmapLevel:i=0}){return this._subImage({target:t,data:e,x:n,y:r,mipmapLevel:i})}async setCubeMapImageData({width:t,height:e,pixels:n,data:r,border:i=0,format:s=6408,type:o=5121}){const{gl:a}=this,u=n||r,c=await Promise.all(gf.map(t=>{const e=u[t];return Promise.all(Array.isArray(e)?e:[e])}));this.bind(),gf.forEach((n,r)=>{c[r].length>1&&!1!==this.opts.mipmaps&&Lh.warn(`${this.id} has mipmap and multiple LODs.`)(),c[r].forEach((r,u)=>{t&&e?a.texImage2D(n,u,s,t,e,i,s,o,r):a.texImage2D(n,u,s,s,o,r)})}),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:u=5121}=t,{gl:c}=this,l=i||s;return this.bind(),l instanceof Promise?l.then(n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n}))):this.width||this.height?c.texImage2D(e,0,a,n,r,o,a,u,l):c.texImage2D(e,0,a,a,u,l),this}}return t.FACES=gf,t})();class yf extends uf{static isSupported(t){return zh(t)}constructor(t,e={}){Vh(t),super(t,e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1})),this.initialize(e),Object.seal(this)}setImageData({level:t=0,dataFormat:e=6408,width:n,height:r,depth:i=1,border:s=0,format:o,type:a=5121,offset:u=0,data:c,parameters:l={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),vd(this.gl,l,()=>{ArrayBuffer.isView(c)&&this.gl.texImage3D(this.target,t,e,n,r,i,s,o,a,c),c instanceof ef&&(this.gl.bindBuffer(35052,c.handle),this.gl.texImage3D(this.target,t,e,n,r,i,s,o,a,u))}),this._trackAllocatedMemory(c&&c.byteLength?c.byteLength:this.width*this.height*this.depth*(rf[this.dataFormat]||4)*(sf[this.type]||1),"Texture"),this.loaded=!0,this}}function bf(t,e){const{gl:n,width:r,height:i,id:s}=t;return new xf(n,Object.assign({},e,{id:`framebuffer-for-${s}`,width:r,height:i,attachments:{36064:t}}))}function _f(t,e={}){const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:u,sourceType:c}=e;const{framebuffer:l,deleteFramebuffer:h}=function(t){return t instanceof xf?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:bf(t),deleteFramebuffer:!0}}(t);Rd(l);const{gl:d,handle:f,attachments:p}=l;var g,m,y,b;a=a||l.width,u=u||l.height,36064===s&&null===f&&(s=1028),Rd(p[s]),c=c||p[s].type,g=c,m=i,y=a,b=u,o=o||new(qd(g=g||5121,{clamped:!1}))(y*b*function(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Rd(!1),0}}(m)),c=c||$d(o);const _=d.bindFramebuffer(36160,f);return d.readPixels(n,r,a,u,i,c,o),d.bindFramebuffer(36160,_||null),h&&l.delete(),o}function vf(t,{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}={}){let r=_f(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=Wd({data:r,width:i,height:s}));!function({data:t,width:e,height:n,bytesPerPixel:r=4,temp:i}){const s=e*r;i=i||new Uint8Array(s);for(let o=0;o<n/2;++o){const e=o*s,r=(n-o-1)*s;i.set(t.subarray(e,e+s)),t.copyWithin(e,r,r+s),t.set(i,r)}}({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),u=a.createImageData(i,s);return u.data.set(r),a.putImageData(u,0,0),o.toDataURL()}const wf="Multiple render targets not supported";class xf extends Hd{static isSupported(t,e={}){const{colorBufferFloat:n,colorBufferHalfFloat:r}=e;let i=!0;return n&&(i=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new xf(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=Vh(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=Vh(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t,e={}){super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:t=1,height:e=1,attachments:n=null,color:r=!0,depth:i=!0,stencil:s=!1,check:o=!0,readBuffer:a,drawBuffers:u}){if(Rd(t>=0&&e>=0,"Width and height need to be integers"),this.width=t,this.height=e,n)for(const c in n){const r=n[c];(Array.isArray(r)?r[0]:r).resize({width:t,height:e})}else n=this._createDefaultAttachments(r,i,s,t,e);this.update({clearAttachments:!0,attachments:n,readBuffer:a,drawBuffers:u}),n&&o&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update({attachments:t={},readBuffer:e,drawBuffers:n,clearAttachments:r=!1,resizeAttachments:i=!0}){this.attach(t,{clearAttachments:r,resizeAttachments:i});const{gl:s}=this,o=s.bindFramebuffer(36160,this.handle);return e&&this._setReadBuffer(e),n&&this._setDrawBuffers(n),s.bindFramebuffer(36160,o||null),this}resize(t={}){let{width:e,height:n}=t;if(null===this.handle)return Rd(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&Lh.log(2,`Resizing framebuffer ${this.id} to ${e}x${n}`)();for(const r in this.attachments)this.attachments[r].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t,{clearAttachments:e=!1,resizeAttachments:n=!0}={}){const r={};e&&Object.keys(this.attachments).forEach(t=>{r[t]=null}),Object.assign(r,t);const i=this.gl.bindFramebuffer(36160,this.handle);for(const s in r){Rd(void 0!==s,"Misspelled framebuffer binding point?");const t=Number(s),e=r[t];let i=e;if(i)if(i instanceof df)this._attachRenderbuffer({attachment:t,renderbuffer:i});else if(Array.isArray(e)){const[n,r=0,s=0]=e;i=n,this._attachTexture({attachment:t,texture:n,layer:r,level:s})}else this._attachTexture({attachment:t,texture:i,layer:0,level:0});else this._unattach(t);n&&i&&i.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter(t=>!this.attachments[t]).forEach(t=>{delete this.attachments[t]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(t){return(xf.STATUS||{})[t]||`Framebuffer error ${t}`}(t));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(t={}){const{color:e,depth:n,stencil:r,drawBuffers:i=[]}=t,s=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&pf(this.gl,{color:e,depth:n,stencil:r}),i.forEach((t,e)=>{!function(t,{framebuffer:e=null,buffer:n=6144,drawBuffer:r=0,value:i=[0,0,0,0]}={}){Vh(t),vd(t,{framebuffer:e},()=>{switch(n){case 6144:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case 6145:t.clearBufferfv(6145,0,[i]);break;case 6146:t.clearBufferiv(6146,0,[i]);break;case 34041:const[e,s]=i;t.clearBufferfi(34041,0,e,s);break;default:Rd(!1,ff)}})}(this.gl,{drawBuffer:e,value:t})}),this.gl.bindFramebuffer(36160,s||null),this}readPixels(t={}){return Lh.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(t={}){return Lh.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(t={}){return Lh.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(t={}){return Lh.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(t={}){return Lh.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(t={}){return Lh.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:t=[],x:e=0,y:n=0,width:r,height:i}){const s=Vh(this.gl),o=s.bindFramebuffer(36008,this.handle);return 0===e&&0===n&&void 0===r&&void 0===i?s.invalidateFramebuffer(36008,t):s.invalidateFramebuffer(36008,t,e,n,r,i),s.bindFramebuffer(36008,o),this}getAttachmentParameter(t,e,n){let r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=Ld(this.gl,r)),r}getAttachmentParameters(t=36064,e,n=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const i of n)r[e?Ld(this.gl,i):i]=this.getAttachmentParameter(t,i,e);return r}getParameters(t=!0){const e=Object.keys(this.attachments),n={};for(const r of e){const e=Number(r);n[t?Ld(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!=typeof window&&window.open(vf(this),"luma-debug-texture"),this}log(t=0,e=""){if(t>Lh.level||"undefined"==typeof window)return this;e=e||`Framebuffer ${this.id}`;const n=vf(this,{targetMaxHeight:100});return Lh.image({logLevel:t,message:e,image:n},e)(),this}bind({target:t=36160}={}){return this.gl.bindFramebuffer(t,this.handle),this}unbind({target:t=36160}={}){return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,r,i){let s=null;return t&&(s=s||{},s[36064]=new cf(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(s[36064])),e&&n?(s=s||{},s[33306]=new df(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(s[33306])):e?(s=s||{},s[36096]=new df(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:i}),this.ownResources.push(s[36096])):n&&Rd(!1),s}_unattach(t){const e=this.attachments[t];e&&(e instanceof df?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer({attachment:t=36064,renderbuffer:e}){const{gl:n}=this;n.framebufferRenderbuffer(36160,t,36161,e.handle),this.attachments[t]=e}_attachTexture({attachment:t=36064,texture:e,layer:n,level:r}){const{gl:i}=this;switch(i.bindTexture(e.target,e.handle),e.target){case 35866:case 32879:Vh(i).framebufferTextureLayer(36160,t,e.target,r,n);break;case 34067:const s=function(t){return t<34069?t+34069:t}(n);i.framebufferTexture2D(36160,t,s,e.handle,r);break;case 3553:i.framebufferTexture2D(36160,t,3553,e.handle,r);break;default:Rd(!1,"Illegal texture type")}i.bindTexture(e.target,null),this.attachments[t]=e}_setReadBuffer(t){const e=zh(n=this.gl)?n:null;var n;e?e.readBuffer(t):Rd(36064===t||1029===t,wf),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=Vh(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):Rd(1===t.length&&(36064===t[0]||1029===t[0]),wf)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=function(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Cf)void 0===t.luma.caps[e]&&(t.luma.caps[e]=kf(t,e));return t.luma.caps}(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}xf.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Ef="TIMER_QUERY",Sf="ELEMENT_INDEX_UINT32",Af="GLSL_DERIVATIVES",Tf="GLSL_TEXTURE_LOD",Cf={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],[Ef]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],[Sf]:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(t){const e=new cf(t,{format:6408,type:5126,dataFormat:6408}),n=new xf(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),36053===r},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],[Af]:["OES_standard_derivatives",!0],[Tf]:["EXT_shader_texture_lod",!0]};function If(t,e){return Df(t,e)}function Df(t,e){return(e=Array.isArray(e)?e:[e]).every(e=>kf(t,e))}function kf(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=Cf[e];let r;Rd(n,e);const i=zh(t)&&n[1]||n[0];if("function"==typeof i)r=i(t);else if(Array.isArray(i)){r=!0;for(const e of i)r=r&&Boolean(t.getExtension(e))}else"string"==typeof i?r=Boolean(t.getExtension(i)):"boolean"==typeof i?r=i:Rd(!1);return r}(t,e)),t.luma.caps[e]||Lh.log(2,`Feature: ${e} not supported`)(),t.luma.caps[e]}class Of{constructor(t,e){this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:r}=e;let i=n;if(n&&n.length!==r){i=new Float32Array(r);const t=e.elementOffset||0;for(let e=0;e<r;++e)i[e]=n[t+e]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}const Mf=new class{constructor(t){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(t)}setProps(t){Object.assign(this.props,t)}allocate(t,e,{size:n=1,type:r,padding:i=0,copy:s=!1,initialize:o=!1,maxCount:a}){const u=r||t&&t.constructor||Float32Array,c=e*n+i;if(ArrayBuffer.isView(t)){if(c<=t.length)return t;if(c*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new u(t.buffer,0,c)}let l;a&&(l=a*n+i);const h=this._allocate(u,c,o,l);return t&&s?h.set(t):o||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,n,r){let i=Math.max(Math.ceil(e*this.props.overAlloc),1);i>r&&(i=r);const s=this._pool,o=t.BYTES_PER_ELEMENT*i,a=s.findIndex(t=>t.byteLength>=o);if(a>=0){const e=new t(s.splice(a,1)[0],0,i);return n&&e.fill(0),e}return new t(i)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:r}=n,i=e.findIndex(t=>t.byteLength>=r);i<0?e.push(n):(i>0||e.length<this.props.poolSize)&&e.splice(i,0,n),e.length>this.props.poolSize&&e.shift()}},Pf=(Math,1/180*Math.PI),Nf={};function Rf(t,{precision:e=Nf.precision||4}={}){return t=function(t){return Math.round(t/Nf.EPSILON)*Nf.EPSILON}(t),`${parseFloat(t.toPrecision(e))}`}function jf(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Lf(t,e,n){if(jf(t)){n=n||((r=t).clone?r.clone():new Array(r.length));for(let r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}var r;return e(t)}function Ff(t){return function(t,e){return Lf(t,t=>t*Pf,void 0)}(t)}function Bf(t,e,n){return Lf(t,t=>Math.max(e,Math.min(n,t)))}function zf(t,e,n){return jf(t)?t.map((t,r)=>zf(t,e[r],n)):n*e+(1-n)*t}function Uf(t,e,n){const r=Nf.EPSILON;n&&(Nf.EPSILON=n);try{if(t===e)return!0;if(jf(t)&&jf(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Uf(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=Nf.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{Nf.EPSILON=r}}function Vf(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}Nf.EPSILON=1e-12,Nf.debug=!1,Nf.precision=4,Nf.printTypes=!1,Nf.printDegrees=!1,Nf.printRowMajor=!0;class Gf extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return Vf(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}to(t){return t===this?this:jf(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Nf)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Rf(this[n],t);return`${t.printTypes?this.constructor.name:""}[${e}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Uf(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){void 0===n&&(n=e,e=t,t=this);for(let r=0;r<this.ELEMENTS;++r){const i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(Nf.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}function Hf(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${t}`);return t}function $f(t,e,n=""){if(Nf.debug&&!function(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}const qf={};function Wf(t,e){qf[t]||(qf[t]=!0,console.warn(`${t} has been removed in version ${e}, see upgrade guide for more information`))}class Xf extends Gf{get ELEMENTS(){return Vf(!1),0}copy(t){return Vf(!1),this}get x(){return this[0]}set x(t){this[0]=Hf(t)}get y(){return this[1]}set y(t){this[1]=Hf(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return Hf(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Hf(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Vf(t>=0&&t<this.ELEMENTS,"index is out of range"),Hf(this[t])}setComponent(t,e){return Vf(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var Kf=1e-6,Zf="undefined"!=typeof Float32Array?Float32Array:Array;function Yf(){var t=new Zf(3);return Zf!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Qf(t,e,n){var r=new Zf(3);return r[0]=t,r[1]=e,r[2]=n,r}function Jf(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function tp(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],u=n[2];return t[0]=i*u-s*a,t[1]=s*o-r*u,t[2]=r*a-i*o,t}function ep(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/(o=o||1),t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function np(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}Math,Math,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),Yf();const rp=[0,0,0],ip={};class sp extends Xf{static get ZERO(){return ip.ZERO=ip.ZERO||Object.freeze(new sp(0,0,0,0))}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&jf(t)?this.copy(t):(Nf.debug&&(Hf(t),Hf(e),Hf(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Nf.debug&&(Hf(t.x),Hf(t.y),Hf(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Hf(t)}angle(t){return function(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(s*s+o*o+a*a),c=u&&Jf(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}(this,t)}cross(t){return tp(this,this,t),this.check()}rotateX({radians:t,origin:e=rp}){return function(t,e,n,r){var i=[],s=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2]}(this,this,e,t),this.check()}rotateY({radians:t,origin:e=rp}){return function(t,e,n,r){var i=[],s=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2]}(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=rp}){return function(t,e,n,r){var i=[],s=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2]}(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return ep(this,this,t),this.check()}transformAsVector(t){return np(this,this,t),this.check()}transformByMatrix3(t){return function(t,e,n){var r=e[0],i=e[1],s=e[2];t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8]}(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return function(t,e,n){var r=n[0],i=n[1],s=n[2],o=e[0],a=e[1],u=e[2],c=i*u-s*a,l=s*o-r*u,h=r*a-i*o,d=i*h-s*l,f=s*c-r*h,p=r*l-i*c,g=2*n[3];l*=g,h*=g,f*=2,p*=2,t[0]=o+(c*=g)+(d*=2),t[1]=a+l+f,t[2]=u+h+p}(this,this,t),this.check()}}const op=new sp;function ap(t,e,n,r){op.set(t,e,n);const i=op.len();return{distance:r/i,normal:new sp(-t/i,-e/i,-n/i)}}let up;function cp(t,{size:e=1,startIndex:n=0,endIndex:r}){Number.isFinite(r)||(r=t.length);const i=(r-n)/e;up=Mf.allocate(up,i,{type:Float32Array,size:2*e});let s=n,o=0;for(;s<r;){for(let n=0;n<e;n++){const r=t[s++];up[o+n]=r,up[o+n+e]=(a=r)-Math.fround(a)}o+=2*e}var a;return up.subarray(0,i*e*2)}function lp(t){return t.stride||t.size*t.bytesPerElement}function hp(t,e){e.offset&&Ph.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=lp(t),r=("vertexOffset"in e?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:r,stride:n}}function dp(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}const fp=[],pp=[];function gp(t,e=0,n=1/0){let r=fp;const i={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?r=t:t.length>0&&(pp.length=t.length,r=pp):r=fp,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function mp(t){return t&&t[Symbol.asyncIterator]}function yp(t,e=(()=>!0)){return Array.isArray(t)?bp(t,e,[]):e(t)?[t]:[]}function bp(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?bp(i,e,n):e(i)&&n.push(i)}return n}function _p({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}const vp=[],wp=[[0,1/0]];function xp({source:t,target:e,start:n=0,end:r,size:i,getData:s}){const o=t.length,a=(r=r||e.length)-n;if(o>a)return void e.set(t.subarray(0,a),n);if(e.set(t,n),!s)return;let u=o;for(;u<a;){const r=s(u,t);for(let t=0;t<i;t++)e[n+u]=r[t]||0,u++}}const Ep={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function Sp(t,e){return t?(Number.isFinite(t)&&(t={duration:t}),t.type=t.type||"interpolation",{...Ep[t.type],...e,...t}):null}function Ap(t,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Tp(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Cp(t){t.push(t.shift())}function Ip(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function Dp({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=(t=>t)}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,u=n.byteOffset,c=n.startIndices,l=i&&c,h=Ip(n,e),d=n.state.constant;if(!l&&r>=h)return;const f=d?n.value:n.getBuffer().getData({srcByteOffset:u});if(n.settings.normalized&&!d){const t=s;s=(e,r)=>n._normalizeConstant(t(e,r))}const p=d?(t,e)=>s(f,e):(t,e)=>s(f.subarray(t,t+a),e),g=t.getData({length:r}),m=new Float32Array(h);!function({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return xp({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const u=r&&((t,e)=>r(t+a,e)),c=Math.min(i.length,s.length);for(let l=1;l<c;l++){const r=i[l]*n,c=s[l]*n;xp({source:t.subarray(o,r),target:e,start:a,end:c,size:n,getData:u}),o=r,a=c}a<e.length&&xp({source:[],target:e,start:a,size:n,getData:u})}({source:g,target:m,sourceStartIndices:i,targetStartIndices:c,size:a,getData:p}),t.byteLength<m.byteLength+u&&t.reallocate(m.byteLength+u),t.subData({data:m,offset:u})}class kp extends class{constructor(t,e){this.gl=t,this.id=e.id,this.size=e.size;const n=e.logicalType||e.type,r=5130===n;let{defaultValue:i}=e;i=Number.isFinite(i)?[i]:i||new Array(this.size).fill(0),e.defaultValue=i;let s=n;r?s=5126:!s&&e.isIndexed?s=t&&If(t,Sf)?5125:5123:s||(s=5126),e.logicalType=n,e.type=s;let o=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(n||s||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===e.fp64&&(o=Float32Array),e.bytesPerElement=o.BYTES_PER_ELEMENT,this.defaultType=o,this.value=null,this.settings=e,this.state={externalBuffer:null,bufferAccessor:e,allocatedValue:null,constant:!1},this._buffer=null,this.setData(e)}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new ef(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*lp(t):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Mf.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,i=function(t,e){const n=hp(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new Of(this,i.high),n["".concat(t,"64Low")]=r?new Of(this,i.low):new Float32Array(this.size),n}if(e){const n=hp(this.getAccessor(),e);return{[t]:new Of(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(t){const{state:e}=this;ArrayBuffer.isView(t)?t={value:t}:t instanceof ef&&(t={buffer:t});const n={...this.settings,...t};if(e.bufferAccessor=n,t.constant){let n=t.value;if(n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this._normalizeConstant(n)),e.constant&&this._areValuesEqual(n,this.value))return!1;e.externalBuffer=null,e.constant=!0,this.value=n}else if(t.buffer){const r=t.buffer;e.externalBuffer=r,e.constant=!1,this.value=t.value;const i=t.value instanceof Float64Array;n.type=t.type||r.accessor.type,n.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(i?2:1),n.stride=lp(n)}else if(t.value){this._checkExternalBuffer(t);let r=t.value;e.externalBuffer=null,e.constant=!1,this.value=r,n.bytesPerElement=r.BYTES_PER_ELEMENT,n.stride=lp(n);const{buffer:i,byteOffset:s}=this;this.doublePrecision&&r instanceof Float64Array&&(r=cp(r,n));const o=r.byteLength+s+2*n.stride;i.byteLength<o&&i.reallocate(o),i.setAccessor(null),i.subData({data:r,offset:s}),n.type=t.type||i.accessor.type}return!0}updateSubBuffer(t={}){const{value:e}=this,{startOffset:n=0,endOffset:r}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?cp(e,{size:this.size,startIndex:n,endIndex:r}):e.subarray(n,r),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:t,copy:e=!1}){const{state:n}=this,r=n.allocatedValue,i=Mf.allocate(r,t+1,{size:this.size,type:this.defaultType,copy:e});this.value=i;const{buffer:s,byteOffset:o}=this;return s.byteLength<i.byteLength+o&&(s.reallocate(i.byteLength+o),e&&r&&s.subData({data:r instanceof Float64Array?cp(r,this):r,offset:o})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!t.constant&&e){const n=this.defaultType;let r=!1;if(this.doublePrecision&&(r=e.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||Ph.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(t).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(t).map(t=>t/255);case 5123:return new Float32Array(t).map(t=>t/65535);default:return t}}_normalizeValue(t,e,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=r[0],e;switch(i){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0];break;default:let s=i;for(;--s>=0;)e[n+s]=Number.isFinite(t[s])?t[s]:r[s]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}}{constructor(t,e={}){super(t,e);const{transition:n=!1,noAlloc:r=!1,update:i=null,accessor:s=null,transform:o=null,startIndices:a=null}=e;Object.assign(this.settings,{transition:n,noAlloc:r,update:i||s&&this._autoUpdater,accessor:s,transform:o}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:wp,startIndices:a}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return Sp(Array.isArray(e)?t[e.find(e=>t[e])]:t[e],n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===wp)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const r=t[s];r[1]<e[0]?(n.push(r),i=s+1):r[0]>e[1]?n.push(r):e=[Math.min(r[0],e[0]),Math.max(r[1],e[1])]}return n.splice(i,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=wp}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=vp}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}update(t){this.setData(t)}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate({numInstances:t,copy:e.updateRanges!==wp}),!0)}updateBuffer({numInstances:t,data:e,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:s,noAlloc:o}}=this;let a=!0;if(s){for(const[o,a]of i)s.call(r,this,{data:e,startRow:o,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[e,n]of i){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):o||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:r}=this;return t?!(r.noAlloc||(n.binaryValue===t?(this.clearNeedsUpdate(),0):(n.binaryValue=t,this.setNeedsRedraw(),ArrayBuffer.isView(t)&&(t={value:t}),r.transform||e!==this.startIndices?(dp(ArrayBuffer.isView(t.value),"invalid ".concat(r.accessor)),n.binaryAccessor=function(t,{size:e,stride:n,offset:r,startIndices:i,nested:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:e,u=r?r/o:0,c=Math.floor((t.length-u)/a);return(n,{index:r,target:o})=>{if(!i){const n=r*a+u;for(let r=0;r<e;r++)o[r]=t[n+r];return o}const l=i[r],h=i[r+1]||c;let d;if(s){d=new Array(h-l);for(let n=l;n<h;n++){const r=n*a+u;o=new Array(e);for(let n=0;n<e;n++)o[n]=t[r+n];d[n-l]=o}}else if(a===e)d=t.subarray(l*e+u,h*e+u);else{d=new t.constructor((h-l)*e);let n=0;for(let r=l;r<h;r++){const i=r*a+u;for(let r=0;r<e;r++)d[n++]=t[i+r]}}return d}}(t.value,{size:t.size||this.size,stride:t.stride,offset:t.offset,startIndices:e,nested:t.size&&t.size!==this.size}),1):(this.clearNeedsUpdate(),this.setData(t),0)))):(n.binaryValue=null,n.binaryAccessor=null,!1)}getVertexOffset(t){const{startIndices:e}=this;return(e?e[t]:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:r,props:i,numInstances:s}){if(t.constant)return;const{settings:o,state:a,value:u,size:c,startIndices:l}=t,{accessor:h,transform:d}=o,f=a.binaryAccessor||("function"==typeof h?h:i[h]);dp("function"==typeof f,'accessor "'.concat(h,'" is not a function'));let p=t.getVertexOffset(n);const{iterable:g,objectInfo:m}=gp(e,n,r);for(const y of g){m.index++;let e=f(y,m);if(d&&(e=d.call(this,e)),l){const n=(m.index<l.length-1?l[m.index+1]:s)-l[m.index];if(e&&Array.isArray(e[0])){let n=p;for(const r of e)t._normalizeValue(r,u,n),n+=c}else e&&e.length>c?u.set(e,p):(t._normalizeValue(e,m.target,0),_p({target:u,source:m.target,start:p,count:n}));p+=n*c}else t._normalizeValue(e,u,p),p+=c}}_validateAttributeUpdaters(){const{settings:t}=this;if(!t.noAlloc&&"function"!=typeof t.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let Op={};function Mp(t){Ph.level>0&&Op[t]&&Op[t].call(...arguments)}function Pp(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Np="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",Rp=`#version 300 es\n${Np}`;function jp(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;return e.includes(r)&&i&&s?{qualifier:r,type:i,name:s.split(";")[0]}:null}function Lp(t={}){const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return 300===e?Rp:e>300?`#version ${e}\n${Np}`:"void main() {gl_FragColor = vec4(0);}";const s=function(t,e){switch(e){case"float":return`vec4(${t}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${t}, 0.0, 1.0)`;case"vec3":return`vec4(${t}, 1.0)`;case"vec4":return t;default:return Pp(!1),null}}(n,r);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${r} ${n};\nout vec4 ${i};\nvoid main() {\n  ${i} = ${s};\n}`:`varying ${r} ${n};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class Fp extends Hd{static isSupported(t){return zh(t)}constructor(t,e={}){Vh(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(t={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Ud(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(t={}){return this.bind(()=>{for(const e in t)this.setBuffer(e,t[e])}),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:r,byteSize:i,byteOffset:s}=this._getBufferParams(e);return n<0?(this.unused[t]=r,Lh.warn(()=>`${this.id} unused varying buffer ${t}`)(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,r,s,i),this)}begin(t=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,r;return t instanceof ef==0?(r=t.buffer,n=t.byteSize,e=t.byteOffset):r=t,void 0===e&&void 0===n||(e=e||0,n=n||r.byteLength-e),{buffer:r,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e,n=0,r){const i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}class Bp{constructor(t,e={}){this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(t={}){const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(t={}){const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof ef?n:n.buffer:null}getData(t={}){const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(t={}){this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Rd(zh(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const t=this.feedbackMap[r];r in e&&(n[t]=r)}Object.assign(n,t.feedbackBuffers);for(const r in n){const t=n[r];if("string"==typeof t){const i=e[t],{byteLength:s,usage:o,accessor:a}=i;n[r]=this._createNewBuffer(r,{byteLength:s,usage:o,accessor:a})}}return n}_setupBuffers(t={}){const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,{model:e}){const{program:n}=e;t.transformFeedback=new Fp(this.gl,{program:n,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const r in this.feedbackMap){const i=this.feedbackMap[r];e[r]=t.feedbackBuffers[i],n[i]=t.sourceBuffers[r],Rd(n[i]instanceof ef)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new ef(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function zp(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}const Up="vs",Vp="fs",Gp={[Up]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[Vp]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Hp="__LUMA_INJECT_DECLARATIONS__",$p=/void\s+main\s*\([^)]*\)\s*\{\n?/,qp=/}\n?[^{}]*$/,Wp=[];function Xp(t,e,n,r=!1){const i=e===Up;for(const s in n){const e=n[s];e.sort((t,e)=>t.order-e.order),Wp.length=e.length;for(let t=0,n=e.length;t<n;++t)Wp[t]=e[t].injection;const r=`${Wp.join("\n")}\n`;switch(s){case"vs:#decl":i&&(t=t.replace(Hp,r));break;case"vs:#main-start":i&&(t=t.replace($p,t=>t+r));break;case"vs:#main-end":i&&(t=t.replace(qp,t=>r+t));break;case"fs:#decl":i||(t=t.replace(Hp,r));break;case"fs:#main-start":i||(t=t.replace($p,t=>t+r));break;case"fs:#main-end":i||(t=t.replace(qp,t=>r+t));break;default:t=t.replace(s,t=>t+r)}}return t=t.replace(Hp,""),r&&(t=t.replace(/\}\s*$/,t=>t+Gp[e])),t}function Kp(t){const e={};return Pp(Array.isArray(t)&&t.length>1),t.forEach(t=>{for(const n in t)e[n]=e[n]?`${e[n]}\n${t[n]}`:t[n]}),e}const Zp={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},Yp={10241:9728,10240:9728,10242:33071,10243:33071};class Qp{constructor(t,e={}){this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(t={}){const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(t={}){const{sourceBuffers:e,sourceTextures:n,framebuffer:r,targetTexture:i}=this.bindings[this.currentIndex],s=Object.assign({},e,t.attributes),o=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let u=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){s.transform_elementID=this.elementIDBuffer;for(const e in this.samplerTextureMap)o[e]=n[this.samplerTextureMap[e]];this._setSourceTextureParameters();const t=function({sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}){const r={};let i,s;e&&(({width:i,height:s}=n),r[`transform_uSize_${e}`]=[i,s]);for(const o in t)({width:i,height:s}=t[o]),r[`transform_uSize_${o}`]=[i,s];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(o,t)}return this.hasTargetTexture&&(u=!1,a.viewport=[0,0,r.width,r.height]),{attributes:s,framebuffer:r,uniforms:o,discard:u,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData({packed:t=!1}={}){const{framebuffer:e}=this.bindings[this.currentIndex],n=_f(e);if(!t)return n;const r=n.constructor,i=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Pp(!1),null}}(this.targetTextureType),s=new r(n.length*i/4);let o=0;for(let a=0;a<n.length;a+=4)for(let t=0;t<i;t++)s[o++]=n[a+t];return s}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(t={}){const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof cf)return n;const r=e[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(t={}){const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:r}=t,i=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:i}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!=typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach((t,e,n)=>{n[e]=e}),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new ef(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:r,targetTexture:i}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,r),Object.assign(t.sourceBuffers,n),i){t.targetTexture=i;const{width:e,height:n}=i,{framebuffer:r}=t;r?(r.update({attachments:{36064:i},resizeAttachments:!1}),r.resize({width:e,height:n})):t.framebuffer=new xf(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:i}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(Yp)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);return e[this._swapTexture]=t.targetTexture,{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=function(t,e){Rd(t instanceof cf||t instanceof mf||t instanceof yf);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:u,border:c,mipmaps:l}=t;return new n(r,Object.assign({width:i,height:s,format:o,type:a,dataFormat:u,border:c,mipmaps:l},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(t);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(t={}){const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:r,uniforms:i,targetTextureType:s,inject:o,samplerTextureMap:a}=function({vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}){let i=Object.keys(e).length,s=null;const o={};let a=t,u={};if(i>0||n){const t=a.split("\n"),c=t.slice();if(t.forEach((t,r,a)=>{if(i>0){const n=function(t,e){const n={},r=function(t){return jp(t,["attribute","in"])}(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const e=`// ${t} => Replaced by Transform with a sampler`,{samplerName:r,sizeName:o,uniformDeclerations:a}=function(t){const e=`transform_uSampler_${t}`,n=`transform_uSize_${t}`;return{samplerName:e,sizeName:n,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${n};`}}(s),u=`  ${i} ${s} = transform_getInput(${r}, ${o}).${function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Pp(!1),null}}(i)};\n`;return n[r]=s,{updatedLine:e,inject:{"vs:#decl":a,"vs:#main-start":u},samplerTextureMap:n}}return null}(t,e);if(n){const{updatedLine:t,inject:e}=n;c[r]=t,u=Kp([u,e]),Object.assign(o,n.samplerTextureMap),i--}}n&&!s&&(s=function(t,e){const n=jp(t,["varying","out"]);return n&&n.name===e?n.type:null}(t,n))}),n){Rd(r);const t=`transform_uSize_${n}`;u=Kp([u,{"vs:#decl":`uniform vec2 ${t};\n`,"vs:#main-start":`     vec2 transform_position = transform_getPos(${t});\n     gl_Position = vec4(transform_position, 0, 1.);\n`}])}a=c.join("\n")}return{vs:a,targetTextureType:s,inject:u,samplerTextureMap:o}}({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),u=Kp([t.inject||{},o]);return this.targetTextureType=s,this.samplerTextureMap=a,{vs:r,fs:t._fs||Lp({version:zp(r),input:this.targetTextureVarying,inputType:s,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Zp].concat(t.modules||[]):t.modules,uniforms:i,inject:u}}}const Jp={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function tg(t){let e=eg(t);return"object"===e?t?"type"in t?Object.assign({},t,Jp[t.type]):"value"in t?(e=eg(t.value),Object.assign({type:e},t,Jp[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Jp[e])}function eg(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class ng{constructor({name:t,vs:e,fs:n,dependencies:r=[],uniforms:i,getUniforms:s,deprecations:o=[],defines:a={},inject:u={},vertexShader:c,fragmentShader:l}){Pp("string"==typeof t),this.name=t,this.vs=e||c,this.fs=n||l,this.getModuleUniforms=s,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(o),this.defines=a,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);"string"==typeof r&&(r={order:0,injection:r}),e[i][n]=r}return e}(u),i&&(this.uniforms=function(t){const e={};for(const n in t){const r=tg(t[n]);e[n]=r}return e}(i))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:Pp(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${e}// END MODULE_${this.name}\n\n`}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach(n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())})}_parseDeprecationDefinitions(t){return t.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),t}_defaultGetUniforms(t={}){const e={},n=this.uniforms;for(const r in n){const i=n[r];r in t&&!i.private?(i.validate&&Pp(i.validate(t[r],i),`${this.name}: invalid ${r}`),e[r]=t[r]):e[r]=i.value}return e}}function rg(t){return function(t){const e={},n={};return ig({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((t,e)=>n[e]-n[t]).map(t=>e[t])}(sg(t))}function ig({modules:t,level:e,moduleMap:n,moduleDepth:r}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)n[i.name]=i,(void 0===r[i.name]||r[i.name]<e)&&(r[i.name]=e);for(const i of t)i.dependencies&&ig({modules:i.dependencies,level:e+1,moduleMap:n,moduleDepth:r})}function sg(t,e){return t.map(t=>(t instanceof ng||(Pp("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),Pp(t.name,"shader module has no name"),(t=new ng(t)).dependencies=sg(t.dependencies)),t))}const og={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},ag={};Object.keys(og).forEach(t=>{ag[t]=t});const ug={};function cg(t,e,n={}){const r=og[e];if(Pp(r,e),!function(t={}){const e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(e in ug)return ug[e];const i=`#extension GL_${r[0]} : ${n.behavior||"enable"}\nvoid main(void) {}`,s=t.createShader(35633);t.shaderSource(s,i),t.compileShader(s);const o=t.getShaderParameter(s,35713);return t.deleteShader(s),ug[e]=o,o}function lg(t,e){return(e=Array.isArray(e)?e:[e]).every(e=>function(t,e){const n=og[e];Pp(n,e);const r=function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return Pp(!1===i||!0===i),i}(t,e))}function hg(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const dg=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],fg=[...dg,[hg("attribute"),"in $1"],[hg("varying"),"out $1"]],pg=[...dg,[hg("varying"),"in $1"]],gg=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],mg=[...gg,[hg("in"),"attribute $1"],[hg("out"),"varying $1"]],yg=[...gg,[hg("in"),"varying $1"]],bg=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,_g=/void\s+main\s*\([^)]*\)\s*\{\n?/;function vg(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}const wg={[Up]:"vertex",[Vp]:"fragment"};function xg(t,{id:e,source:n,type:r,modules:i,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:u=!1,prologue:c=!0,log:l}){Pp("string"==typeof n,"shader source must be a string");const h=r===Up,d=n.split("\n");let f=100,p="",g=n;0===d[0].indexOf("#version ")?(f=300,p=d[0],g=d.slice(1).join("\n")):p=`#version ${f}`;const m={};i.forEach(t=>{Object.assign(m,t.getDefines())}),Object.assign(m,s);let y=c?`${p}\n${function({id:t,source:e,type:n}){return t&&"string"==typeof t&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${t}_${wg[n]}\n\n`:""}({id:e,source:n,type:r})}\n${function({type:t}){return`\n#define SHADER_TYPE_${wg[t].toUpperCase()}\n`}({type:r})}\n${function(t){switch(function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/Apple/i)||e.match(/Apple/i)?"APPLE":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN"}(n,r),vendor:n,renderer:r,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n"}}(t)}\n${function(t,e,n){let r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return lg(t,ag.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),lg(t,ag.GLSL_DERIVATIVES)&&cg(t,ag.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),lg(t,ag.GLSL_FRAG_DATA)&&cg(t,ag.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),lg(t,ag.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}(t)}\n${function(t={}){let e=0,n="";for(const r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const i=t[r];(i||Number.isFinite(i))&&(n+=`#define ${r.toUpperCase()} ${t[r]}\n`)}return 0===e&&(n+="\n"),n}(m)}\n${h?"":"precision highp float;\n\n"}\n`:`${p}\n`;const b=function(t){const e={vs:{},fs:{}};return t.forEach(t=>{let n;"string"!=typeof t?(n=t,t=n.hook):n={},t=t.trim();const[r,i]=t.split(":"),s=t.replace(/\(.+/,"");e[r][s]=Object.assign(n,{signature:i})}),e}(o),_={},v={},w={};for(const x in a){const t="string"==typeof a[x]?{injection:a[x],order:0}:a[x],e=x.match(/^(v|f)s:(#)?([\w-]+)$/);if(e){const n=e[3];e[2]?"decl"===n?v[x]=[t]:w[x]=[t]:_[x]=[t]}else w[x]=[t]}for(const x of i){l&&x.checkDeprecations(g,l),y+=x.getModuleSource(r,f);const t=x.injections[r];for(const e in t){const n=e.match(/^(v|f)s:#([\w-]+)$/);if(n){const r="decl"===n[2]?v:w;r[e]=r[e]||[],r[e].push(t[e])}else _[e]=_[e]||[],_[e].push(t[e])}}return y+="\n\n__LUMA_INJECT_DECLARATIONS__\n\n",y=Xp(y,r,v),y+=function(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {\n`,i.header&&(n+=`  ${i.header}`),e[r]){const t=e[r];t.sort((t,e)=>t.order-e.order);for(const e of t)n+=`  ${e.injection}\n`}i.footer&&(n+=`  ${i.footer}`),n+="}\n"}return n}(b[r],_),y+=g,y=Xp(y,r,w),y=function(t,e,n){switch(e){case 300:return n?vg(t,fg):function(t){const e=(t=vg(t,pg)).match(bg);if(e){const n=e[1];t=t.replace(new RegExp("\\bgl_FragColor\\b","g"),n)}else{const e="fragmentColor";t=t.replace(_g,t=>`out vec4 ${e};\n${t}`).replace(new RegExp("\\bgl_FragColor\\b","g"),e)}return t}(t);case 100:return n?vg(t,mg):function(t){const e=(t=vg(t,yg)).match(bg);if(e){const n=e[1];t=t.replace(bg,"").replace(new RegExp(`\\b${n}\\b`,"g"),"gl_FragColor")}return t}(t);default:throw new Error(`unknown GLSL version ${e}`)}}(y,u?100:f,h),y}function Eg(t){return function(e){const n={};for(const r of t){const t=r.getUniforms(e,n);Object.assign(n,t)}return n}}const Sg={5126:Fg.bind(null,"uniform1fv",kg,1,Bg),35664:Fg.bind(null,"uniform2fv",kg,2,Bg),35665:Fg.bind(null,"uniform3fv",kg,3,Bg),35666:Fg.bind(null,"uniform4fv",kg,4,Bg),5124:Fg.bind(null,"uniform1iv",Og,1,Bg),35667:Fg.bind(null,"uniform2iv",Og,2,Bg),35668:Fg.bind(null,"uniform3iv",Og,3,Bg),35669:Fg.bind(null,"uniform4iv",Og,4,Bg),35670:Fg.bind(null,"uniform1iv",Og,1,Bg),35671:Fg.bind(null,"uniform2iv",Og,2,Bg),35672:Fg.bind(null,"uniform3iv",Og,3,Bg),35673:Fg.bind(null,"uniform4iv",Og,4,Bg),35674:Fg.bind(null,"uniformMatrix2fv",kg,4,zg),35675:Fg.bind(null,"uniformMatrix3fv",kg,9,zg),35676:Fg.bind(null,"uniformMatrix4fv",kg,16,zg),35678:Lg,35680:Lg,5125:Fg.bind(null,"uniform1uiv",Mg,1,Bg),36294:Fg.bind(null,"uniform2uiv",Mg,2,Bg),36295:Fg.bind(null,"uniform3uiv",Mg,3,Bg),36296:Fg.bind(null,"uniform4uiv",Mg,4,Bg),35685:Fg.bind(null,"uniformMatrix2x3fv",kg,6,zg),35686:Fg.bind(null,"uniformMatrix2x4fv",kg,8,zg),35687:Fg.bind(null,"uniformMatrix3x2fv",kg,6,zg),35688:Fg.bind(null,"uniformMatrix3x4fv",kg,12,zg),35689:Fg.bind(null,"uniformMatrix4x2fv",kg,8,zg),35690:Fg.bind(null,"uniformMatrix4x3fv",kg,12,zg),35678:Lg,35680:Lg,35679:Lg,35682:Lg,36289:Lg,36292:Lg,36293:Lg,36298:Lg,36299:Lg,36300:Lg,36303:Lg,36306:Lg,36307:Lg,36308:Lg,36311:Lg},Ag={},Tg={},Cg={},Ig=[0];function Dg(t,e,n,r){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(Ig[0]=t,t=Ig);const i=t.length;if(i%e&&Lh.warn(`Uniform size should be multiples of ${e}`,t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function kg(t,e){return Dg(t,e,Float32Array,Ag)}function Og(t,e){return Dg(t,e,Int32Array,Tg)}function Mg(t,e){return Dg(t,e,Uint32Array,Cg)}function Pg(t,e,n){const r=Sg[n.type];if(!r)throw new Error(`Unknown GLSL uniform type ${n.type}`);return r().bind(null,t,e)}function Ng(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function Rg(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||!0===t||!1===t||t instanceof uf||t instanceof df||t instanceof xf&&Boolean(t.texture)}function jg(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let t=0,e=n.length;t<e;++t)r[t]=n[t]}else t[e]=n.slice();else t[e]=n}function Lg(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Fg(t,e,n,r){let i=null,s=null;return(o,a,u)=>{const c=e(u,n),l=c.length;let h=!1;if(null===i)i=new Float32Array(l),s=l,h=!0;else{Rd(s===l,"Uniform length cannot change.");for(let t=0;t<l;++t)if(c[t]!==i[t]){h=!0;break}}return h&&(r(o,t,a,c),i.set(c)),h}}function Bg(t,e,n,r){t[e](n,r)}function zg(t,e,n,r){t[e](n,!1,r)}function Ug(t,e="unnamed"){const n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}function Vg(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+=`${i}\n`,t[r+1])){const e=t[r+1],i=e.split(":",3),s=i[0],o=parseInt(i[1],10)||0;n+=Gg(`^^^ ${s}: ${e.substring(i.join(":").length+1).trim()}\n\n`,o)}}return n}function Gg(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return`${n}${t}`}class Hg extends Hd{static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Rd(!1),"unknown"}}constructor(t,e){Uh(t),Rd("string"==typeof e.source,"Shader: GLSL source code must be a JavaScript string"),super(t,{id:Ug(e.source,null)||e.id||Bd(`unnamed ${Hg.getTypeName(e.shaderType)}`)}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize({source:t}){const e=Ug(t,null);e&&(this.id=Bd(e)),this._compile(t)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return`${Hg.getTypeName(this.shaderType)}:${this.id}`}getName(){return Ug(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(t=this.source){if(t.startsWith("#version ")||(t=`#version 100\n${t}`),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:r}=function(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||Ug(e)||"(unnamed)",u=`${function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)} shader ${a}`;for(let l=0;l<i.length;l++){const e=i[l];if(e.length<=1)continue;const n=e.split(":"),r=n[0],a=parseInt(n[2],10);if(isNaN(a))throw new Error(`GLSL compilation error in ${u}: ${t}`);"WARNING"!==r?s[a]=e:o[a]=e}const c=function(t,e=1,n=": "){const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((t,r)=>{const s=String(r+e);return Gg(s,i-s.length)+n+t})}(e);return{shaderName:u,errors:Vg(s,c),warnings:Vg(o,c)}}(t,this.source,this.shaderType,this.id);throw Lh.error(`GLSL compilation errors in ${e}\n${n}`)(),Lh.warn(`GLSL compilation warnings in ${e}\n${r}`)(),new Error(`GLSL compilation errors in ${e}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class $g extends Hg{constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class qg extends Hg{constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Wg=5126,Xg=5124,Kg=5125,Zg={[Wg]:[Wg,1,"float"],35664:[Wg,2,"vec2"],35665:[Wg,3,"vec3"],35666:[Wg,4,"vec4"],[Xg]:[Xg,1,"int"],35667:[Xg,2,"ivec2"],35668:[Xg,3,"ivec3"],35669:[Xg,4,"ivec4"],[Kg]:[Kg,1,"uint"],36294:[Kg,2,"uvec2"],36295:[Kg,3,"uvec3"],36296:[Kg,4,"uvec4"],35670:[Wg,1,"bool"],35671:[Wg,2,"bvec2"],35672:[Wg,3,"bvec3"],35673:[Wg,4,"bvec4"],35674:[Wg,8,"mat2"],35685:[Wg,8,"mat2x3"],35686:[Wg,8,"mat2x4"],35675:[Wg,12,"mat3"],35687:[Wg,12,"mat3x2"],35688:[Wg,12,"mat3x4"],35676:[Wg,16,"mat4"],35689:[Wg,16,"mat4x2"],35690:[Wg,16,"mat4x3"]};function Yg(t){const e=Zg[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function Qg(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=Wg}for(const n in Zg){const[r,i,s]=Zg[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class Jg{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let r=0;r<n;r++){const{name:n,type:i,size:s}=e.getActiveAttrib(t.handle,r),o=e.getAttribLocation(t.handle,n);o>=0&&this._addAttribute(o,n,i,s)}this.attributeInfos.sort((t,e)=>t.location-e.location)}_readVaryingsFromProgram(t){const{gl:e}=t;if(!zh(e))return;const n=e.getProgramParameter(t.handle,35971);for(let r=0;r<n;r++){const{name:n,type:i,size:s}=e.getTransformFeedbackVarying(t.handle,r);this._addVarying(r,n,i,s)}this.varyingInfos.sort((t,e)=>t.location-e.location)}_addAttribute(t,e,n,r){const{type:i,components:s}=Yg(n),o={type:i,size:r*s};this._inferProperties(t,e,o);const a={location:t,name:e,accessor:new Yd(o)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,r){const{type:i,components:s}=Yg(n),o={location:t,name:e,accessor:new Yd({type:i,size:r*s})};this.varyingInfos.push(o),this.varyingInfosByName[o.name]=o}}const tm=35981,em=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class nm extends Hd{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Program","v6.0",em),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(t={}){const{hash:e,vs:n,fs:r,varyings:i,bufferMode:s=tm}=t;return this.hash=e||"",this.vs="string"==typeof n?new $g(this.gl,{id:`${t.id}-vs`,source:n}):n,this.fs="string"==typeof r?new qg(this.gl,{id:`${t.id}-fs`,source:r}):r,Rd(this.vs instanceof $g),Rd(this.fs instanceof qg),this.uniforms={},this._textureUniforms={},i&&i.length>0&&(Vh(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,s)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Jg(this),this.setProps(t)}delete(t={}){return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw({logPriority:t,drawMode:e=4,vertexCount:n,offset:r=0,start:i,end:s,isIndexed:o=!1,indexType:a=5123,instanceCount:u=0,isInstanced:c=u>0,vertexArray:l=null,transformFeedback:h,framebuffer:d,parameters:f={},uniforms:p,samplers:g}){if((p||g)&&(Lh.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(p||{})),Lh.priority>=t){const r=d?d.id:"default",i=`mode=${Ld(this.gl,e)} verts=${n} instances=${u} indexType=${Ld(this.gl,a)} isInstanced=${c} isIndexed=${o} Framebuffer=${r}`;Lh.log(t,i)()}return Rd(l),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===n||c&&0===u||(l.bindForDraw(n,u,()=>{if(void 0!==d&&(f=Object.assign({},f,{framebuffer:d})),h){const t=function(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return Rd(!1),0}}(e);h.begin(t)}this._bindTextures(),vd(this.gl,f,()=>{o&&c?this.gl2.drawElementsInstanced(e,n,a,r,u):o&&zh(this.gl)&&!isNaN(i)&&!isNaN(s)?this.gl2.drawRangeElements(e,i,s,n,a,r):o?this.gl.drawElements(e,n,a,r):c?this.gl2.drawArraysInstanced(e,r,n,u):this.gl.drawArrays(e,r,n)}),h&&h.end()}),0))}setUniforms(t={}){Lh.priority>=2&&function(t,e,n){for(const r in t){const i=t[r];if((!n||Boolean(n[r]))&&!Rg(i))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${r}`,i),new Error(`${e} Bad uniform ${r}`)}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],r=this._uniformSetters[e];if(r){let t=n,i=!1;if(t instanceof xf&&(t=t.texture),t instanceof uf)if(i=this.uniforms[e]!==n,i){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:i}=r;n.bind(i),t=i,this._textureUniforms[e]=n}else t=r.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(r(t)||i)&&jg(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms)this._textureUniforms[t].bind(this._uniformSetters[t].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const r of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new $g({handle:r});break;case 35632:n.fs=new qg({handle:r})}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=Bd(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?`${t}-program`:"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),Lh.time(4,`linkProgram for ${this._getName()}`)(),t.linkProgram(this.handle),Lh.timeEnd(4,`linkProgram for ${this._getName()}`)(),t.debug||Lh.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${t.getProgramInfoLog(this.handle)}`);if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${t.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:r}=Ng(n.name);let i=t.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=Pg(t,i,n),n.size>1)for(let e=0;e<n.size;e++)i=t.getUniformLocation(this.handle,`${r}[${e}]`),this._uniformSetters[`${r}[${e}]`]=Pg(t,i,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}class rm{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new rm(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find(e=>e.name===t.name)||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter(t=>t.name!==e),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(t={}){const{vs:e="",fs:n="",defines:r={},inject:i={},varyings:s=[],bufferMode:o=35981,transpileToGLSL100:a=!1}=t,u=this._getModuleList(t.modules),c=this._getHash(e),l=this._getHash(n),h=u.map(t=>this._getHash(t.name)).sort(),d=s.map(t=>this._getHash(t)),f=Object.keys(r).sort(),p=Object.keys(i).sort(),g=[],m=[];for(const b of f)g.push(this._getHash(b)),g.push(this._getHash(r[b]));for(const b of p)m.push(this._getHash(b)),m.push(this._getHash(i[b]));const y=`${c}/${l}D${g.join("/")}M${h.join("/")}I${m.join("/")}V${d.join("/")}H${this.stateHash}B${o}${a?"T":""}`;if(!this._programCache[y]){const t=function(t,e){const{vs:n,fs:r}=e,i=rg(e.modules||[]);return{gl:t,vs:xg(t,Object.assign({},e,{source:n,type:Up,modules:i})),fs:xg(t,Object.assign({},e,{source:r,type:Vp,modules:i})),getUniforms:Eg(i)}}(this.gl,{vs:e,fs:n,modules:u,inject:i,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[y]=new nm(this.gl,{hash:y,vs:t.vs,fs:t.fs,varyings:s,bufferMode:o}),this._getUniforms[y]=t.getUniforms||(t=>{}),this._useCounts[y]=0}return this._useCounts[y]++,this._programCache[y]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(t=[]){const e=new Array(this._defaultModules.length+t.length),n={};let r=0;for(let i=0,s=this._defaultModules.length;i<s;++i){const t=this._defaultModules[i],s=t.name;e[r++]=t,n[s]=!0}for(let i=0,s=t.length;i<s;++i){const s=t[i],o=s.name;n[o]||(e[r++]=s,n[o]=!0)}return e.length=r,e}}let im=null;class sm extends Hd{static isSupported(t,e={}){return!e.constantAttributeZero||zh(t)||"Chrome"===function(t){if(!dh())return"Node";if(hh(void 0))return"Electron";const e=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";const n=-1!==e.indexOf("MSIE "),r=-1!==e.indexOf("Trident/");return n||r?"IE":wh.chrome?"Chrome":wh.safari?"Safari":wh.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new sm(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return sm.MAX_ATTRIBUTES=sm.MAX_ATTRIBUTES||t.getParameter(34921),sm.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:sm._setConstantFloatArray(t,e,n);break;case Int32Array:sm._setConstantIntArray(t,e,n);break;case Uint32Array:sm._setConstantUintArray(t,e,n);break;default:Rd(!1)}}constructor(t,e={}){super(t,Object.assign({},e,{id:e.id||e.program&&e.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return sm.getMaxAttributes(this.gl)}initialize(t={}){return this.setProps(t)}setProps(t){return this}setElementBuffer(t=null,e={}){return Rd(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,t?t.handle:null)}),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:r,type:i,stride:s,offset:o,normalized:a,integer:u,divisor:c}=n,{gl:l,gl2:h}=this;return t=Number(t),this.bind(()=>{l.bindBuffer(34962,e.handle),u?(Rd(zh(l)),h.vertexAttribIPointer(t,r,i,s,o)):l.vertexAttribPointer(t,r,i,a,s,o),l.enableVertexAttribArray(t),h.vertexAttribDivisor(t,c||0)}),this}enable(t,e=!0){return!e&&0===t&&!sm.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind(()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),r=n.byteLength*t,i=n.length*t;let s=!this.buffer;if(this.buffer=this.buffer||new ef(this.gl,r),s=s||this.buffer.reallocate(r),s=s||!this._compareConstantArrayValues(n,this.bufferValue),s){const t=function(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!im||im.byteLength<n)&&(im=new ArrayBuffer(n)),im),0,e)}(e.constructor,i);!function({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s)}({target:t,source:n,start:0,count:i}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:Rd(!1)}}static _setConstantIntArray(t,e,n){switch(Rd(zh(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:Rd(!1)}}static _setConstantUintArray(t,e,n){switch(Rd(zh(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:Rd(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,{location:e}){return Rd(Number.isFinite(e)),this.bind(()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(e,t);default:return this.gl.getVertexAttrib(e,t)}})}}const om=/^(.+)__LOCATION_([0-9]+)$/,am=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class um{constructor(t,e={}){this.id=e.id||e.program&&e.program.id,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new sm(t),Vd(this,"VertexArray","v6.0",am),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(t={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind(()=>{for(const e in t)this._setAttribute(e,t[e]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(t=null,e={}){return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e,n={}){if(34963===e.target)return this.setElementBuffer(e,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return r>=0&&(this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,e,i)),this}setConstant(t,e,n={}){const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return r>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ef(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof ef&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof ef&&this.setBuffer(t,e)}}),this}bindForDraw(t,e,n){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(t,e),r=n()}),r}_resolveLocationAndAccessor(t,e,n,r){const i={location:-1,accessor:null},{location:s,name:o}=this._getAttributeIndex(t);if(!Number.isFinite(s)||s<0)return this.unused[t]=e,Lh.once(3,()=>`unused value ${t} in ${this.id}`)(),i;const a=this._getAttributeInfo(o||s);if(!a)return i;const u=Yd.resolve(a.accessor,this.accessors[s]||{},n,r),{size:c,type:l}=u;return Rd(Number.isFinite(c)&&Number.isFinite(l)),{location:s,accessor:u}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=om.exec(t),r=n?n[1]:t,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(t,e){if(e instanceof ef)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof ef)this.setBuffer(t,e[0],e[1]);else if(ArrayBuffer.isView(e)||Array.isArray(e))this.setConstant(t,e);else{if(!(e.buffer instanceof ef))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(t,e.buffer,e)}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}_setConstantAttributeZero(t,e){if(sm.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){sm.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],r=this.accessors[e];if(!n)return;const{divisor:i}=r,s=i>0;if(t.isInstanced=t.isInstanced||s,n instanceof ef){const e=n;if(s){const n=e.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(t=null,e={}){return Lh.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function cm(t,e={}){const{isInteger:n=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let s=0;s<t.length&&s<n;++s)s>0&&(i+=","+(s%r==0?" ":"")),i+=cm(t[s],e);return`${i}${t.length>n?"...":"]"}`}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return n?"0":"0.";if(n)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function lm(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s,o,a,u="NOT PROVIDED",c=1,l=0,h=0;if(n&&(u=n.type,c=n.size,u=String(u).replace("Array",""),s=-1!==u.indexOf("nt")),e instanceof ef){const t=e,{data:d,changed:f}=t.getDebugData();let p;return o=f?"*":"",a=d,h=t.byteLength,l=h/d.BYTES_PER_ELEMENT/c,n?p=`${n.divisor>0?"I ":"P "} ${l} (x${c}=${h} bytes ${Ld(i,u)})`:(s=!0,p=`${h} bytes`),{[r]:`${o}${cm(a,{size:c,isInteger:s})}`,"Format ":p}}return a=e,c=e.length,u=String(e.constructor.name).replace("Array",""),s=-1!==u.indexOf("nt"),{[r]:`${cm(a,{size:c,isInteger:s})} (constant)`,"Format ":`${c}x${u} (constant)`}}function hm(t,e){const{type:n,size:r}=e,i=Qg(n,r);return i?`${t} (${i.name})`:t}function dm({header:t="Uniforms",program:e,uniforms:n,undefinedOnly:r=!1}){Rd(e);const i=".*Matrix",s={},o=Object.keys(e._uniformSetters).sort();let a=0;for(const l of o)l.match(".*_.*")||l.match(i)||fm({table:s,header:t,uniforms:n,uniformName:l,undefinedOnly:r})&&a++;for(const l of o)l.match(i)&&fm({table:s,header:t,uniforms:n,uniformName:l,undefinedOnly:r})&&a++;for(const l of o)s[l]||fm({table:s,header:t,uniforms:n,uniformName:l,undefinedOnly:r})&&a++;let u=0;const c={};if(!r)for(const l in n){const e=n[l];s[l]||(u++,c[l]={Type:`NOT USED: ${e}`,[t]:cm(e)})}return{table:s,count:a,unusedTable:c,unusedCount:u}}function fm({table:t,header:e,uniforms:n,uniformName:r,undefinedOnly:i}){const s=n[r],o=function(t){return null!=t}(s);return!(i&&o||(t[r]={[e]:o?cm(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function pm(t){const{type:e,size:n}=t.accessor,r=Qg(e,n);return r?`${r.name} ${t.name}`:t.name}const gm={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function mm(t,e){const{attributeMap:n=gm}=e||{};return n&&n[t]||t}function ym(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}Rd(Number.isFinite(e.size),`attribute ${t} needs size`)}const bm=()=>{},_m={};class vm{constructor(t,e={}){const{id:n=Bd("model")}=e;Rd(Bh(t)),this.id=n,this.gl=t,this.id=e.id||Bd("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||rm.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:r,modules:i,defines:s,inject:o,varyings:a,bufferMode:u,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:r,modules:i,defines:s,inject:o,varyings:a,bufferMode:u,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},Rd(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:r,modules:i,defines:s,inject:o,varyings:a,bufferMode:u,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:r,modules:i,defines:s,inject:o,varyings:a,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return Rd(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return Rd(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const n=e.attributes[s],o=mm(s,void 0);if("indices"===s)i=n;else if(n.constant)r[o]=n.value;else{const e=n.value,i={...n};delete i.value,r[o]=[new ef(t,e),i],ym(s,i)}}if(i){const e=i.value||i;Rd(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new ef(t,{data:e,target:34963}),n]}return r}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(t={}){if(Ud(t))return this;const e={};for(const n in t){const r=t[n];e[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(e),this}setUniforms(t={}){return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return pf(this.program.gl,t),this}draw(t={}){this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:r={},attributes:i={},transformFeedback:s=this.transformFeedback,parameters:o={},vertexArray:a=this.vertexArray}=t;let u;this.setAttributes(i),this.updateModuleSettings(e),this.setUniforms(r),Lh.priority>=2&&(u=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:l=c.isIndexed,indexType:h=c.indexType,indexOffset:d=c.indexOffset,vertexArrayInstanced:f=c.isInstanced}=this.props;f&&!this.isInstanced&&Lh.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=bm,onAfterRender:y=bm}=this.props;m(),this.program.setUniforms(this.uniforms);const b=this.program.draw(Object.assign(_m,t,{logPriority:u,uniforms:null,framebuffer:n,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:s,isIndexed:l,indexType:h,isInstanced:p,instanceCount:g,offset:l?d:0}));return y(),Lh.priority>=2&&this._logDrawCallEnd(u,a,n),b}transform(t={}){const{discard:e=!0,feedbackBuffers:n,unbindModels:r=[]}=t;let{parameters:i}=t;n&&this._setFeedbackBuffers(n),e&&(i=Object.assign({},i,{35977:e})),r.forEach(t=>t.vertexArray.unbindBuffers());try{this.draw(Object.assign({},t,{parameters:i}))}finally{r.forEach(t=>t.vertexArray.bindBuffers())}return this}render(t={}){return Lh.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:r,inject:i,defines:s,varyings:o,bufferMode:a,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:r,inject:i,defines:s,varyings:o,bufferMode:a,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Rd(t instanceof nm,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new um(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof ef&&e.delete()}}_setAnimationProps(t){this.animated&&Rd(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(t={}){if(Ud(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new Fp(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),Lh.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:Lh.level<=2})(),t}_logDrawCallEnd(t,e,n,r){if(void 0===t)return;const i=function({vertexArray:t,header:e="Attributes"}){if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=lm(t,t.elements,null,e));const r=t.values;for(const i in r){const s=t._getAttributeInfo(i);if(s){let o=`${i}: ${s.name}`;const a=t.accessors[s.location];a&&(o=`${i}: ${hm(s.name,a)}`),n[o]=lm(t,r[i],a,e)}}return n}({vertexArray:e,header:`${this.id} attributes`,attributes:this._attributes}),{table:s,unusedTable:o,unusedCount:a}=dm({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:u,count:c}=dm({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});c>0&&Lh.log("MISSING UNIFORMS",Object.keys(u))(),a>0&&Lh.log("UNUSED UNIFORMS",Object.keys(o))();const l=function(t){const e={},n=`Accessors for ${t.id}`;for(const r of t.attributeInfos)r&&(e[`in ${pm(r)}`]={[n]:JSON.stringify(r.accessor)});for(const r of t.varyingInfos)r&&(e[`out ${pm(r)}`]={[n]:JSON.stringify(r.accessor)});return e}(this.vertexArray.configuration);Lh.table(t,i)(),Lh.table(t,s)(),Lh.table(t+1,l)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),Lh.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class wm{static isSupported(t){return zh(t)}constructor(t,e={}){this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(t={}){const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();Rd(t,"Nothing to swap")}getBuffer(t=null){return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(t={}){const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(t={}){"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(t={}){const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new vm(e,Object.assign({},t,{fs:t.fs||Lp({version:zp(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=r.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){return!(Ud(t.feedbackBuffers)&&Ud(t.feedbackMap)&&!(t.varyings&&t.varyings.length>0))})(e)&&(this.bufferTransform=new Bp(t,e)),function(t){return!(Ud(t._sourceTextures)&&!t._targetTexture&&!t._targetTextureVarying)}(e)&&(this.textureTransform=new Qp(t,e)),Rd(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=Object.assign(e,r.getDrawOptions(e));return e}}function xm(){}const Em={onStart:xm,onUpdate:xm,onInterrupt:xm,onEnd:xm};class Sm{constructor(t){this._inProgress=!1,this._handle=null,this.timeline=t,this.settings={}}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings={...Em,...t},this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Am={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="interpolation",this.transition=new Sm(n),this.attribute=e,this.attributeInTransition=new kp(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=Tp(e.size);return new wm(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const r={byteLength:0,usage:35050};this.buffers=[new ef(t,r),new ef(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();const{buffers:n,attribute:r}=this;Cp(n);const i={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of n)Dp({buffer:s,...i});this.currentStartIndices=r.startIndices,this.currentLength=Ip(r,e),this.attributeInTransition.update({buffer:n[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:n[0],aTo:Ap(0,r)},feedbackBuffers:{vCurrent:n[1]}})}update(){const t=this.transition.update();if(t){const{time:t,settings:{duration:e,easing:n}}=this.transition,r=n(t/e);this.transform.run({uniforms:{time:r}})}return t}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="spring",this.transition=new Sm(n),this.attribute=e,this.attributeInTransition=new kp(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new cf(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new xf(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const r=Tp(e.size);return new wm(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new ef(t,r),new ef(t,r),new ef(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{buffers:n,attribute:r}=this,i={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of n)Dp({buffer:s,...i});this.currentStartIndices=r.startIndices,this.currentLength=Ip(r,e),this.attributeInTransition.update({buffer:n[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aTo:Ap(0,r)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:r}=this;return!!r.update()&&(e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Cp(t),this.attributeInTransition.update({buffer:t[1],value:this.attribute.value}),_f(n)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Tm{constructor(t,{id:e,timeline:n}){this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=wm.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const r in t){const n=t[r],i=n.getTransitionSetting(e);i&&this._updateAttribute(r,n,i)}for(const r in this.transitions){const n=t[r];n&&n.getTransitionSetting(e)||this._removeTransition(r)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const e in this.transitions)this.transitions[e].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const r=this.transitions[t];let i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void Ph.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();r&&this._removeTransition(t);const s=Am[n.type];s?this.transitions[t]=new s({attribute:e,timeline:this.timeline,gl:this.gl}):(Ph.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const Cm="attributeManager.invalidate";class Im{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Tm(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(t=!0){return this.needsRedraw=!0,this}add(t,e){this._add(t,e)}addInstanced(t,e){this._add(t,e,{instanced:1})}remove(t){for(let e=0;e<t.length;e++){const n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}invalidate(t,e){const n=this._invalidateTrigger(t,e);Mp(Cm,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);Mp(Cm,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:r,props:i={},buffers:s={},context:o={}}={}){let a=!1;Mp("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const r=this.attributes[u],c=r.settings.accessor;r.startIndices=n,i[u]&&Ph.removed("props.".concat(u),"data.attributes.".concat(u))(),r.setExternalBuffer(s[u])||r.setBinaryValue(s[c],t.startIndices)||!s[c]&&r.setConstantValue(i[c])||r.needsUpdate()&&(a=!0,this._updateAttribute({attribute:r,numInstances:e,data:t,props:i,context:o})),this.needsRedraw|=r.needsRedraw()}a&&Mp("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:r})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in e){const s=e[i];s.needsRedraw(t)&&!n.hasAttribute(i)&&(r[i]=s)}return r}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const r in t)e[r]||Object.assign(n,t[r].getShaderAttributes());return n}getAccessors(){return this.updateTriggers}_add(t,e,n={}){e&&Ph.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in t)this.attributes[r]=this._createAttribute(r,t[r],n);this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const r={...e,id:t,isIndexed:e.isIndexed||e.elements||!1,constant:e.constant||!1,size:(e.elements?1:e.size)||1,value:e.value||null,divisor:e.instanced||n.instanced?1:e.divisor||0};return new kp(this.gl,r)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach(n=>{t[n]||(t[n]=[]),t[n].push(e)});this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:r}=this,i=r[t];return i&&i.forEach(t=>{const r=n[t];r&&r.setNeedsUpdate(r.id,e)}),i}_updateAttribute(t){const{attribute:e,numInstances:n}=t;Mp("attribute.updateStart",e),e.allocate(n)&&Mp("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,Mp("attribute.updateEnd",e,n))}}const Dm=1e-5;function km(t,e,n,r,i){const s=e-t;return(n-e)*i+-s*r+s+e}function Om(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}const Mm={interpolation:class extends Sm{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:r,easing:i}}=this,s=i(t/r);this._value=zf(e,n,s)}},spring:class extends Sm{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:r}=this.settings,{_prevValue:i=t,_currValue:s=t}=this;let o=function(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=km(t[o],e[o],n[o],r,i);return s}return km(t,e,n,r,i)}(i,s,e,n,r);const a=Om(o,e),u=Om(o,s);a<Dm&&u<Dm&&(o=e,this.end()),this._prevValue=s,this._currValue=o}}};class Pm{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,r){const{transitions:i}=this;if(i.has(t)){const n=i.get(t),{value:r=n.settings.fromValue}=n;e=r,this.remove(t)}if(!(r=Sp(r)))return;const s=Mm[r.type];if(!s)return void Ph.error("unsupported transition type '".concat(r.type,"'"))();const o=new s(this.timeline);o.start({...r,fromValue:e,toValue:n}),i.set(t,o)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}const Nm={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:Rm}=Nm;function jm(t,e){if(!t.transitions)return null;const n={},r=Um(t);for(const i in t.transitions){const s=r[i],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&Fm(t[i],e[i],s)&&(n[i]=!0)}return n}function Lm({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}={}){if(e===t)return null;if("object"!=typeof t||null===t)return"".concat(i," changed shallowly");if("object"!=typeof e||null===e)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const n=Fm(t[s],e[s],r[s]);if(n)return"".concat(i,".").concat(s," ").concat(n)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const n=Fm(t[s],e[s],r[s]);if(n)return"".concat(i,".").concat(s," ").concat(n)}}return null}function Fm(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)?"changed deeply":r||(r=t&&e&&t.equals,!r||r.call(t,e))?r||e===t?null:"changed shallowly":"changed deeply"}function Bm(t,e){if(null===e)return"oldProps is null, initial diff";const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function zm(t,e,n){let r=t.updateTriggers[n];r=null==r?{}:r;let i=e.updateTriggers[n];return i=null==i?{}:i,Lm({oldProps:i,newProps:r,triggerName:n})}function Um(t){const e=t[Rm],n=e&&e.constructor;return n?n._propTypes:{}}function Vm(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Gm(t){let e,n={};return r=>{for(const i in r)if(!Vm(r[i],n[i])){e=t(r),n=r;break}return e}}function Hm(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(t=>"project64"===t.name))){const t=n.modules.findIndex(t=>"project32"===t.name);t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const r={...t.inject};for(const t in e.inject)r[t]=(r[t]||"")+e.inject[t];n.inject=r}else n.inject=e.inject;return n}function $m(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],m=e[14],y=e[15],b=n*a-r*o,_=n*u-i*o,v=n*c-s*o,w=r*u-i*a,x=r*c-s*a,E=i*c-s*u,S=l*g-h*p,A=l*m-d*p,T=l*y-f*p,C=h*m-d*g,I=h*y-f*g,D=d*y-f*m,k=b*D-_*I+v*C+w*T-x*A+E*S;return k?(t[0]=(a*D-u*I+c*C)*(k=1/k),t[1]=(i*I-r*D-s*C)*k,t[2]=(g*E-m*x+y*w)*k,t[3]=(d*x-h*E-f*w)*k,t[4]=(u*T-o*D-c*A)*k,t[5]=(n*D-i*T+s*A)*k,t[6]=(m*v-p*E-y*_)*k,t[7]=(l*E-d*v+f*_)*k,t[8]=(o*I-a*T+c*S)*k,t[9]=(r*T-n*I-s*S)*k,t[10]=(p*x-g*v+y*b)*k,t[11]=(h*v-l*x-f*b)*k,t[12]=(a*A-o*C-u*S)*k,t[13]=(n*C-r*A+i*S)*k,t[14]=(g*_-p*w-m*b)*k,t[15]=(l*w-h*_+d*b)*k,t):null}function qm(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],m=e[13],y=e[14],b=e[15],_=n[0],v=n[1],w=n[2],x=n[3];return t[0]=_*r+v*a+w*h+x*g,t[1]=_*i+v*u+w*d+x*m,t[2]=_*s+v*c+w*f+x*y,t[3]=_*o+v*l+w*p+x*b,t[4]=(_=n[4])*r+(v=n[5])*a+(w=n[6])*h+(x=n[7])*g,t[5]=_*i+v*u+w*d+x*m,t[6]=_*s+v*c+w*f+x*y,t[7]=_*o+v*l+w*p+x*b,t[8]=(_=n[8])*r+(v=n[9])*a+(w=n[10])*h+(x=n[11])*g,t[9]=_*i+v*u+w*d+x*m,t[10]=_*s+v*c+w*f+x*y,t[11]=_*o+v*l+w*p+x*b,t[12]=(_=n[12])*r+(v=n[13])*a+(w=n[14])*h+(x=n[15])*g,t[13]=_*i+v*u+w*d+x*m,t[14]=_*s+v*c+w*f+x*y,t[15]=_*o+v*l+w*p+x*b,t}function Wm(t,e,n){var r,i,s,o,a,u,c,l,h,d,f,p,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=r=e[0],t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=r*g+a*m+h*y+e[12],t[13]=i*g+u*m+d*y+e[13],t[14]=s*g+c*m+f*y+e[14],t[15]=o*g+l*m+p*y+e[15]),t}function Xm(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Km(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+l*r,t[6]=a*i+h*r,t[7]=u*i+d*r,t[8]=c*i-s*r,t[9]=l*i-o*r,t[10]=h*i-a*r,t[11]=d*i-u*r,t}function Zm(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],u=e[3],c=e[4],l=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+l*r,t[2]=a*i+h*r,t[3]=u*i+d*r,t[4]=c*i-s*r,t[5]=l*i-o*r,t[6]=h*i-a*r,t[7]=d*i-u*r,t}function Ym(t,e,n,r,i){var s,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(t[10]=(i+r)*(s=1/(r-i)),t[14]=2*i*r*s):(t[10]=-1,t[14]=-2*r),t}function Qm(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],u=t[6],c=t[7],l=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],m=t[14],y=t[15],b=e[0],_=e[1],v=e[2],w=e[3],x=e[4],E=e[5],S=e[6],A=e[7],T=e[8],C=e[9],I=e[10],D=e[11],k=e[12],O=e[13],M=e[14],P=e[15];return Math.abs(n-b)<=Kf*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-_)<=Kf*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-v)<=Kf*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(s-w)<=Kf*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-x)<=Kf*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-E)<=Kf*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(u-S)<=Kf*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-A)<=Kf*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(l-T)<=Kf*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(h-C)<=Kf*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(d-I)<=Kf*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-D)<=Kf*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(p-k)<=Kf*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(g-O)<=Kf*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(m-M)<=Kf*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(y-P)<=Kf*Math.max(1,Math.abs(y),Math.abs(P))}function Jm(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function ty(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}!function(){var t;t=new Zf(4),Zf!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();const ey=[0,0,0,0],ny=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],ry=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],iy=[0,0,0],sy=[0,0,0],oy=Gm(function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,cameraPosCommon:o,shaderCoordinateOrigin:a,geospatialOrigin:u}=function(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=ey,u=t.cameraPosition;const{geospatialOrigin:c,shaderCoordinateOrigin:l,offsetMode:h}=ay(t,e,n);if(h){const e=t.projectPosition(c||l);u=[u[0]-e[0],u[1]-e[1],u[2]-e[2]],e[3]=1,a=ty([],e,o),s=r||s,o=qm([],i,s),o=qm([],o,ny)}return{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,cameraPosCommon:u,shaderCoordinateOrigin:l,geospatialOrigin:c}}(t,n,r),c=t.getDistanceScales(),l=[t.width*e,t.height*e],h=t.projectionMatrix.transform([0,0,-t.focalDistance,1])[3]||1,d={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:a,project_uCenter:i,project_uViewportSize:l,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:iy,project_uScale:t.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:o};if(u){const e=t.getDistanceScales(u);switch(n){case Nh.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case Nh.LNGLAT:case Nh.LNGLAT_OFFSETS:d.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case Nh.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return d});function ay(t,e,n=sy){let r,i=n,s=!0;switch(r=e===Nh.LNGLAT_OFFSETS||e===Nh.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Rh.WEB_MERCATOR:e!==Nh.LNGLAT&&e!==Nh.CARTESIAN||(s=!1);break;case Rh.WEB_MERCATOR_AUTO_OFFSET:e===Nh.LNGLAT?i=r:e===Nh.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case Rh.IDENTITY:i=t.position.map(Math.fround);break;case Rh.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class uy extends Gf{get ELEMENTS(){return Vf(!1),0}get RANK(){return Vf(!1),0}toString(){let t="[";if(Nf.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+e]}`}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=` ${this[e]}`}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Hf(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let r=0;r<this.RANK;++r)e[r]=this[n+r];return e}setColumn(t,e){const n=t*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}function cy(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function ly(t,e){return t[0]=-e[0],t[1]=-e[1],t}function hy(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}!function(){var t;t=new Zf(2),Zf!=Float32Array&&(t[0]=0,t[1]=0)}();const dy=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),fy=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),py=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),gy={};class my extends uy{static get IDENTITY(){return gy.IDENTITY=gy.IDENTITY||Object.freeze(new my(dy)),gy.IDENTITY}static get ZERO(){return gy.ZERO=gy.ZERO||Object.freeze(new my(fy)),gy.ZERO}get INDICES(){return py}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,i,s,o,a,u,c,l,h,d,f,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=u,this[9]=c,this[10]=l,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,r,i,s,o,a,u,c,l,h,d,f,p,g){return this[0]=t,this[1]=i,this[2]=u,this[3]=d,this[4]=e,this[5]=s,this[6]=c,this[7]=f,this[8]=n,this[9]=o,this[10]=l,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(dy)}fromQuaternion(t){return function(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,u=i+i,c=n*o,l=r*o,h=r*a,d=i*o,f=i*a,p=i*u,g=s*o,m=s*a,y=s*u;t[0]=1-h-p,t[1]=l+y,t[2]=d-m,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=f+g,t[7]=0,t[8]=d+m,t[9]=f-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum({left:t,right:e,bottom:n,top:r,near:i,far:s}){return s===1/0?my._computeInfinitePerspectiveOffCenter(this,t,e,n,r,i):function(t,e,n,r,i,s,o){var a=1/(n-e),u=1/(i-r),c=1/(s-o);t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*u,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*u,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0}(this,t,e,n,r,i,s),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,n,r,i,s){const o=2*s/(i-r),a=(n+e)/(n-e),u=(i+r)/(i-r),c=-2*s;return t[0]=2*s/(n-e),t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=a,t[9]=u,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=c,t[15]=0,t}lookAt(t,e,n){return 1===arguments.length&&({eye:t,center:e,up:n}=t),function(t,e,n,r){var i,s,o,a,u,c,l,h,d,f,p=e[0],g=e[1],m=e[2],y=r[0],b=r[1],_=r[2],v=n[0],w=n[1],x=n[2];Math.abs(p-v)<Kf&&Math.abs(g-w)<Kf&&Math.abs(m-x)<Kf?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(l=p-v,h=g-w,d=m-x,i=b*(d*=f=1/Math.hypot(l,h,d))-_*(h*=f),s=_*(l*=f)-y*d,o=y*h-b*l,(f=Math.hypot(i,s,o))?(i*=f=1/f,s*=f,o*=f):(i=0,s=0,o=0),a=h*o-d*s,u=d*i-l*o,c=l*s-h*i,(f=Math.hypot(a,u,c))?(a*=f=1/f,u*=f,c*=f):(a=0,u=0,c=0),t[0]=i,t[1]=a,t[2]=l,t[3]=0,t[4]=s,t[5]=u,t[6]=h,t[7]=0,t[8]=o,t[9]=c,t[10]=d,t[11]=0,t[12]=-(i*p+s*g+o*m),t[13]=-(a*p+u*g+c*m),t[14]=-(l*p+h*g+d*m),t[15]=1)}(this,t,e=e||[0,0,0],n=n||[0,1,0]),this.check()}ortho({left:t,right:e,bottom:n,top:r,near:i=.1,far:s=500}){return function(t,e,n,r,i,s,o){var a=1/(e-n),u=1/(r-i),c=1/(s-o);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*u,t[14]=(o+s)*c,t[15]=1}(this,t,e,n,r,i,s),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:n=1,near:r=.1,far:i=500}){if(t>2*Math.PI)throw Error("radians");const s=n*Math.tan(t/2),o=s*e;return(new my).ortho({left:-o,right:o,bottom:-s,top:s,near:r,far:i})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}={}){if((t=t||e)>2*Math.PI)throw Error("radians");return Ym(this,t,n,r,i),this.check()}determinant(){return function(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],u=t[7],c=t[8],l=t[9],h=t[10],d=t[11],f=t[12],p=t[13],g=t[14],m=t[15];return(e*o-n*s)*(h*m-d*g)-(e*a-r*s)*(l*m-d*p)+(e*u-i*s)*(l*g-h*p)+(n*a-r*o)*(c*m-d*f)-(n*u-i*o)*(c*g-h*f)+(r*u-i*a)*(c*p-l*f)}(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],s=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*s,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*s,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],s=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*s,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*s,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*s,t}transpose(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return $m(this,this),this.check()}multiplyLeft(t){return qm(this,t,this),this.check()}multiplyRight(t){return qm(this,this,t),this.check()}rotateX(t){return Km(this,this,t),this.check()}rotateY(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],u=e[3],c=e[8],l=e[9],h=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-l*r,t[2]=a*i-h*r,t[3]=u*i-d*r,t[8]=s*r+c*i,t[9]=o*r+l*i,t[10]=a*r+h*i,t[11]=u*r+d*i}(this,this,t),this.check()}rotateZ(t){return Zm(this,this,t),this.check()}rotateXYZ([t,e,n]){return this.rotateX(t).rotateY(e).rotateZ(n)}rotateAxis(t,e){return function(t,e,n,r){var i,s,o,a,u,c,l,h,d,f,p,g,m,y,b,_,v,w,x,E,S,A,T,C,I=r[0],D=r[1],k=r[2],O=Math.hypot(I,D,k);O<Kf||(I*=O=1/O,D*=O,k*=O,i=Math.sin(n),s=Math.cos(n),u=e[1],c=e[2],l=e[3],d=e[5],f=e[6],p=e[7],m=e[9],y=e[10],b=e[11],x=I*D*(o=1-s)-k*i,E=D*D*o+s,S=k*D*o+I*i,A=I*k*o+D*i,T=D*k*o-I*i,C=k*k*o+s,t[0]=(a=e[0])*(_=I*I*o+s)+(h=e[4])*(v=D*I*o+k*i)+(g=e[8])*(w=k*I*o-D*i),t[1]=u*_+d*v+m*w,t[2]=c*_+f*v+y*w,t[3]=l*_+p*v+b*w,t[4]=a*x+h*E+g*S,t[5]=u*x+d*E+m*S,t[6]=c*x+f*E+y*S,t[7]=l*x+p*E+b*S,t[8]=a*A+h*T+g*C,t[9]=u*A+d*T+m*C,t[10]=c*A+f*T+y*C,t[11]=l*A+p*T+b*C,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?Xm(this,this,t):Xm(this,this,[t,t,t]),this.check()}translate(t){return Wm(this,this,t),this.check()}transform(t,e){return 4===t.length?($f(e=ty(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;switch(n){case 2:e=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(e||[-0,-0],t,this);break;case 3:e=ep(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return $f(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=function(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}(e||[-0,-0],t,this);break;case 3:e=np(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return $f(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}transformPoint(t,e){return Wf("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return Wf("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return Wf("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}function yy(t,e){const n=ty([],e,t);return Jm(n,n,1/n[3]),n}function by(t,e){const n=t%e;return n<0?e+n:n}const _y=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function vy(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const wy=Math.PI,xy=wy/4,Ey=wy/180,Sy=180/wy,Ay=512;function Ty([t,e]){return vy(Number.isFinite(t)),vy(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[Ay*(t*Ey+wy)/(2*wy),Ay*(wy+Math.log(Math.tan(xy+e*Ey*.5)))/(2*wy)]}function Cy([t,e]){const n=t/Ay*(2*wy)-wy,r=2*(Math.atan(Math.exp(e/Ay*(2*wy)-wy))-xy);return[n*Sy,r*Sy]}function Iy({latitude:t,longitude:e,highPrecision:n=!1}){vy(Number.isFinite(t)&&Number.isFinite(e));const r={},i=Math.cos(t*Ey),s=512/360,o=s/i,a=12790407194604047e-21/i;if(r.unitsPerMeter=[a,a,a],r.metersPerUnit=[1/a,1/a,1/a],r.unitsPerDegree=[s,o,a],r.degreesPerUnit=[.703125,1/o,1/a],n){const e=Ey*Math.tan(t*Ey)/i,n=12790407194604047e-21*e,u=n/o*a;r.unitsPerDegree2=[0,s*e/2,n],r.unitsPerMeter2=[u,0,u]}return r}function Dy(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:u,unitsPerMeter2:c}=Iy({longitude:n,latitude:r,highPrecision:!0}),l=Ty(t);l[0]+=s*(u[0]+c[0]*o),l[1]+=o*(u[1]+c[1]*o);const h=Cy(l),d=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],d]:h}function ky({height:t,pitch:e,bearing:n,altitude:r,scale:i,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return Wm(o,o,[0,0,-r]),Km(o,o,-e*Ey),Zm(o,o,n*Ey),Xm(o,o,[i/=t,i,i]),s&&Wm(o,o,function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}([],s)),o}function Oy({width:t,height:e,fovy:n=My(1.5),altitude:r,pitch:i=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==r&&(n=My(r));const a=.5*n*Ey,u=Py(n),c=i*Ey,l=Math.sin(a)*u/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:t/e,focalDistance:u,near:s,far:(Math.sin(c)*l+u)*o}}function My(t){return 2*Math.atan(.5/t)*Sy}function Py(t){return.5/Math.tan(.5*t*Ey)}function Ny(t,e){const[n,r,i=0]=t;return vy(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),yy(e,[n,r,i,1])}function Ry(t,e,n=0){const[r,i,s]=t;if(vy(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return yy(e,[r,i,s,1]);const o=yy(e,[r,i,0,1]),a=yy(e,[r,i,1,1]),u=o[2],c=a[2];return hy([],o,a,u===c?0:((n||0)-u)/(c-u))}function jy({width:t,height:e,bounds:n,minExtent:r=0,maxZoom:i=24,padding:s=0,offset:o=[0,0]}){const[[a,u],[c,l]]=n;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:vy(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const h=new zy({width:t,height:e,longitude:0,latitude:0,zoom:0}),d=h.project([a,l]),f=h.project([c,u]),p=[Math.max(Math.abs(f[0]-d[0]),r),Math.max(Math.abs(f[1]-d[1]),r)],g=[t-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];vy(g[0]>0&&g[1]>0);const m=g[0]/p[0],y=g[1]/p[1],b=h.unproject([(f[0]+d[0])/2+(s.right-s.left)/2/m,(f[1]+d[1])/2+(s.bottom-s.top)/2/y]),_=Math.min(i,h.zoom+_y(Math.abs(Math.min(m,y))));return vy(Number.isFinite(_)),{longitude:b[0],latitude:b[1],zoom:_}}const Ly=Math.PI/180;function Fy(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let u,c;return(t.fovy?.5*t.fovy*Ly:Math.atan(.5/t.altitude))>(90-t.pitch)*Ly-.01?(u=By(t,0,e),c=By(t,n,e)):(u=i([0,0],s),c=i([n,0],s)),[o,a,c,u]}function By(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=yy(r,[e,0,1,1]),s=yy(r,[e,t.height,1,1]),o=Cy(hy([],i,s,(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2])));return o[2]=n,o}class zy{constructor({width:t,height:e,latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,altitude:a=null,fovy:u=null,position:c=null,nearZMultiplier:l=.02,farZMultiplier:h=1.01}={width:1,height:1}){t=t||1,e=e||1,null===u&&null===a?u=My(a=1.5):null===u?u=My(a):null===a&&(a=Py(u));const d=function(t){return Math.pow(2,t)}(i);a=Math.max(.75,a);const f=Iy({longitude:r,latitude:n}),p=Ty([r,n]);p[2]=0,c&&function(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2]}(p,p,function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}([],c,f.unitsPerMeter)),this.projectionMatrix=function({width:t,height:e,pitch:n,altitude:r,fovy:i,nearZMultiplier:s,farZMultiplier:o}){const{fov:a,aspect:u,near:c,far:l}=Oy({width:t,height:e,altitude:r,fovy:i,pitch:n,nearZMultiplier:s,farZMultiplier:o});return Ym([],a,u,c,l)}({width:t,height:e,pitch:s,fovy:u,nearZMultiplier:l,farZMultiplier:h}),this.viewMatrix=ky({height:e,scale:d,center:p,pitch:s,bearing:o,altitude:a}),this.width=t,this.height=e,this.scale=d,this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=a,this.fovy=u,this.center=p,this.meterOffset=c||[0,0,0],this.distanceScales=f,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];qm(i,i,n),qm(i,i,r),this.viewProjectionMatrix=i;const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Xm(s,s,[t/2,-e/2,1]),Wm(s,s,[1,-1,0]),qm(s,s,i);const o=$m([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s);if(!o)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=s,this.pixelUnprojectionMatrix=o}equals(t){return t instanceof zy&&t.width===this.width&&t.height===this.height&&Qm(t.projectionMatrix,this.projectionMatrix)&&Qm(t.viewMatrix,this.viewMatrix)}project(t,{topLeft:e=!0}={}){const n=Ny(this.projectPosition(t),this.pixelProjectionMatrix),[r,i]=n,s=e?i:this.height-i;return 2===t.length?[r,s]:[r,s,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,s]=t,o=Ry([r,e?i:this.height-i,s],this.pixelUnprojectionMatrix,n&&n*this.distanceScales.unitsPerMeter[2]),[a,u,c]=this.unprojectPosition(o);return Number.isFinite(s)?[a,u,c]:Number.isFinite(n)?[a,u,n]:[a,u]}projectPosition(t){const[e,n]=Ty(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=Cy(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return Ty(t)}unprojectFlat(t){return Cy(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=Ry(e,this.pixelUnprojectionMatrix),r=cy([],Ty(t),ly([],n));return Cy(cy([],this.center,r))}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:i,latitude:s,zoom:o}=jy(Object.assign({width:n,height:r,bounds:t},e));return new zy({width:n,height:r,longitude:i,latitude:s,zoom:o})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map(t=>t[0])),r=Math.max(...e.map(t=>t[0]));return[[n,Math.min(...e.map(t=>t[1]))],[r,Math.max(...e.map(t=>t[1]))]]}getBoundingRegion(t={}){return Fy(this,t.z||0)}}const Uy=Math.PI/180,Vy=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Gy=[0,0,0],Hy={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let $y=(()=>{class t{constructor(t={}){const{id:e=null,x:n=0,y:r=0,width:i=1,height:s=1}=t;this.id=e||this.constructor.displayName||"viewport",this.x=n,this.y=r,this.width=i||1,this.height=s||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Rh.WEB_MERCATOR:Rh.WEB_MERCATOR_AUTO_OFFSET:Rh.IDENTITY}equals(e){return e instanceof t&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Uf(e.projectionMatrix,this.projectionMatrix)&&Uf(e.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=Ny(this.projectPosition(t),this.pixelProjectionMatrix),[r,i]=n,s=e?i:this.height-i;return 2===t.length?[r,s]:[r,s,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,s]=t,o=Ry([r,e?i:this.height-i,s],this.pixelUnprojectionMatrix,n&&n*this.distanceScales.unitsPerMeter[2]),[a,u,c]=this.unprojectPosition(o);return Number.isFinite(s)?[a,u,c]:Number.isFinite(n)?[a,u,n]:[a,u]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?Ty(t):t}unprojectFlat(t){return this.isGeospatial?Cy(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),r=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),s=this.unproject([this.width,this.height],e);return[Math.min(n[0],r[0],i[0],s[0]),Math.min(n[1],r[1],i[1],s[1]),Math.max(n[0],r[0],i[0],s[0]),Math.max(n[1],r[1],i[1],s[1])]}getDistanceScales(t=null){return t?Iy({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:r=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(t){const e={};return e.left=ap(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),e.right=ap(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),e.bottom=ap(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),e.top=ap(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),e.near=ap(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),e.far=ap(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:e,aspect:n,focalDistance:r,near:i,far:s}){return t?(new my).orthographic({fovy:e,aspect:n,focalDistance:r,near:i,far:s}):(new my).perspective({fovy:e,aspect:n,near:i,far:s})}_initViewMatrix(t){const{viewMatrix:e=Vy,longitude:n=null,latitude:r=null,zoom:i=null,position:s=null,modelMatrix:o=null,focalDistance:a=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this.zoom=i,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:t}){vy(Number.isFinite(t));const e=Math.cos(t*Ey);return _y(4003e4*e)-9}({latitude:r})+Math.log2(a):0);const c=Math.pow(2,this.zoom);this.scale=c,this.distanceScales=this.isGeospatial?Iy({latitude:r,longitude:n}):u||Hy,this.focalDistance=a,this.distanceScales.metersPerUnit=new sp(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new sp(this.distanceScales.unitsPerMeter),this.position=Gy,this.meterOffset=Gy,s&&(this.position=s,this.modelMatrix=o,this.meterOffset=o?o.transformVector(s):s),this.isGeospatial?(this.longitude=n,this.latitude=r,this.center=this._getCenterInWorld({longitude:n,latitude:r})):this.center=s?this.projectPosition(s):[0,0,0],this.viewMatrixUncentered=e,this.viewMatrix=(new my).multiplyRight(this.viewMatrixUncentered).translate(new sp(this.center||Gy).negate())}_getCenterInWorld({longitude:t,latitude:e}){const{meterOffset:n,distanceScales:r}=this,i=new sp(this.projectPosition([t,e,0]));if(n){const t=new sp(n).scale(r.unitsPerMeter);i.add(t)}return i}_initProjectionMatrix(t){const{projectionMatrix:e=null,orthographic:n=!1,fovyRadians:r,fovy:i=75,near:s=.1,far:o=1e3,focalDistance:a=1}=t;this.projectionMatrix=e||this._createProjectionMatrix({orthographic:n,fovyRadians:r||i*Uy,aspect:this.width/this.height,focalDistance:a,near:s,far:o})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var e;qm(t,t,this.projectionMatrix),qm(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=$m([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(e=this.viewMatrixInverse)[12],e[13],e[14]];const n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Xm(n,n,[this.width/2,-this.height/2,1]),Wm(n,n,[1,-1,0]),qm(r,n,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=n,this.pixelUnprojectionMatrix=$m([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ph.warn("Pixel project matrix not invertible")()}}return t.displayName="Viewport",t})(),qy=(()=>{class t extends $y{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=11,pitch:i=0,bearing:s=0,nearZMultiplier:o=.1,farZMultiplier:a=1.01,orthographic:u=!1,repeat:c=!1,worldOffset:l=0}=t;let{width:h,height:d,altitude:f=1.5}=t;const p=Math.pow(2,r);h=h||1,d=d||1,f=Math.max(.75,f);const{fov:g,aspect:m,focalDistance:y,near:b,far:_}=Oy({width:h,height:d,pitch:i,altitude:f,nearZMultiplier:o,farZMultiplier:a});let v=ky({height:d,pitch:i,bearing:s,scale:p,altitude:f});l&&(v=(new my).translate([512*l,0,0]).multiplyLeft(v)),super({...t,width:h,height:d,viewMatrix:v,longitude:n,latitude:e,zoom:r,orthographic:u,fovyRadians:g,aspect:m,focalDistance:y,near:b,far:_}),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=i,this.bearing=s,this.altitude=f,this.orthographic=u,this._subViewports=c?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const e=i?new t({...this,worldOffset:i}):this;this._subViewports.push(e)}}return this._subViewports}addMetersToLngLat(t,e){return Dy(t,e)}panByPosition(t,e){const n=Ry(e,this.pixelUnprojectionMatrix),r=cy([],this.projectFlat(t),ly([],n)),i=cy([],this.center,r),[s,o]=this.unprojectFlat(i);return{longitude:s,latitude:o}}getBounds(t={}){const e=Fy(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=jy({width:r,height:i,bounds:e,...n});return new t({width:r,height:i,longitude:s,latitude:o,zoom:a})}}return t.displayName="WebMercatorViewport",t})();function Wy(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof qy){const[n,i,s=0]=t,o=e.getDistanceScales([n,i]);r[2]=s*o.unitsPerMeter[2]}return r}function Xy(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,u=0]=t;switch(n&&([o,a,u]=ty([],[o,a,u,1],n)),r){case Nh.LNGLAT:return Wy([o,a,u],e,s);case Nh.LNGLAT_OFFSETS:return Wy([o+i[0],a+i[1],u+(i[2]||0)],e,s);case Nh.METER_OFFSETS:return Wy(Dy(i,[o,a,u]),e,s);case Nh.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],u+i[2]]:e.projectPosition([o,a,u])}}const Ky={10241:9987,10240:9729,10242:33071,10243:33071},Zy={},Yy={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||eb(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>Qy(t,e)},accessor:{validate(t,e){const n=nb(t);return"function"===n||n===nb(e.value)},equal:(t,e,n)=>"function"==typeof e||Qy(t,e)},array:{validate:(t,e)=>e.optional&&!t||eb(t),equal:(t,e,n)=>n.compare?Qy(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare||t===e},data:{transform:(t,e,n)=>{const{dataTransform:r}=n?n.props:{};return r&&t?r(t):t}},image:{transform:(t,e,n)=>function(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof cf)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let r=null;e.compressed&&(r={10241:e.data.length>1?9985:9729});const i=new cf(n,{...e,parameters:{...Ky,...r,...t.props.textureParameters}});return Zy[i.id]=!0,i}(n,t),release:t=>{var e;(e=t)&&e instanceof cf&&Zy[e.id]&&(e.delete(),delete Zy[e.id])}}};function Qy(t,e){if(t===e)return!0;if(!eb(t)||!eb(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function Jy(t,e){switch(nb(e)){case"object":return tb(t,e);case"array":return tb(t,{type:"array",value:e,compare:!1});case"boolean":return tb(t,{type:"boolean",value:e});case"number":return tb(t,{type:"number",value:e});case"function":return tb(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function tb(t,e){return"type"in e?{name:t,...Yy[e.type],...e}:"value"in e?{name:t,type:nb(e.value),...e}:{name:t,type:"object",value:e}}function eb(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function nb(t){return eb(t)?"array":null===t?"null":typeof t}const{COMPONENT:rb,ASYNC_ORIGINAL:ib,ASYNC_RESOLVED:sb,ASYNC_DEFAULTS:ob}=Nm;function ab(){const t=this,e=ub(t.constructor),n=Object.create(e);n[rb]=t,n[ib]={},n[sb]={};for(let r=0;r<arguments.length;++r){const t=arguments[r];for(const e in t)n[e]=t[e]}return Object.freeze(n),n}function ub(t){return hb(t,"_mergedDefaultProps")||(function(t){if(!t.prototype)return;const e=Object.getPrototypeOf(t),n=ub(e),r=function(t){const e={},n={},r={};for(const[i,s]of Object.entries(t))if(s&&s.deprecatedFor)r[i]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const t=Jy(i,s);e[i]=t,n[i]=t.value}return{propTypes:e,defaultProps:n,deprecatedProps:r}}(hb(t,"defaultProps")||{}),i=function(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=function(t){const e=hb(t,"layerName")||hb(t,"componentName");return e||Ph.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}(r.defaultProps,n,t),s={...e._propTypes,...r.propTypes};!function(t,e){const n={},r={};for(const i in e){const t=e[i],{name:s,value:o}=t;t.async&&(n[s]=o,r[s]=cb(s))}t[ob]=n,t[ib]={},Object.defineProperties(t,r)}(i,s);const o={...e._deprecatedProps,...r.deprecatedProps};(function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const r="".concat(this.id,": ").concat(n);for(const i of e[n])lb(this,i)||(this[i]=t);Ph.deprecated(r,e[n].join("/"))()}})})(i,o),t._mergedDefaultProps=i,t._propTypes=s,t._deprecatedProps=o}(t),t._mergedDefaultProps)}function cb(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||mp(e)?this[ib][t]=e:this[sb][t]=e},get(){if(this[sb]){if(t in this[sb])return this[sb][t]||this[ob][t];if(t in this[ib]){const e=this[rb]&&this[rb].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[ob][t]}}return this[ob][t]}}}function lb(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function hb(t,e){return lb(t,e)&&t[e]}const{ASYNC_ORIGINAL:db,ASYNC_RESOLVED:fb,ASYNC_DEFAULTS:pb}=Nm,gb=Object.freeze({});class mb{constructor(t=null){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=gb,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[fb]||{},n=t[db]||t,r=t[pb]||{};for(const i in e){const t=e[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,t),e[i]=this.getAsyncProp(i)}for(const i in n){const t=n[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,t)}}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"==typeof e){var n;const r=null===(n=this.layer)||void 0===n?void 0:n.props.fetch,i=e;r&&(e=r(i,{propName:t,layer:this.layer}))}e instanceof Promise?this._watchPromise(t,e):mp(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e)}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){const n=this.asyncProps[t];e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}_setAsyncPropValue(t,e,n){const r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&void 0!==e&&(this.freezeAsyncOldProps(),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];n.pendingLoadCount++;const r=n.pendingLoadCount;e.then(e=>{var i;e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,r);const s=null===(i=this.layer)||void 0===i?void 0:i.props.onDataLoad;"data"===t&&s&&s(e,{propName:t,layer:this.layer})}).catch(e=>{var n;null===(n=this.layer)||void 0===n||n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))})}async _resolveAsyncIterable(t,e){var n;"data"!==t&&this._setPropValue(t,e);const r=this.asyncProps[t];r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const u of e){const{dataTransform:e}=this.component?this.component.props:{};s=e?e(u,s):s.concat(u),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(t,s,i)}const a=null===(n=this.layer)||void 0===n?void 0:n.props.onDataLoad;a&&a(s,{propName:t,layer:this.layer})}_postProcessValue(t,e){const n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:yb,ASYNC_RESOLVED:bb,ASYNC_DEFAULTS:_b}=Nm,vb={};let wb=0,xb=(()=>{class t{constructor(){this.props=ab.apply(this,arguments),this.id=this.props.id,this.count=wb++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:e}=this,n={};for(const r in e[_b])r in e[bb]?n[r]=e[bb][r]:r in e[yb]&&(n[r]=e[yb][r]);return new this.constructor({...e,...n,...t})}get stats(){return this.internalState.stats}_initState(){this.internalState=new mb({})}}return t.componentName="Component",t.defaultProps=vb,t})();class Eb extends mb{constructor({attributeManager:t,layer:e}){super(e),this.attributeManager=t,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}}const Sb=t=>"function"==typeof t,Ab=t=>null!==t&&"object"==typeof t,Tb=t=>Ab(t)&&t.constructor==={}.constructor,Cb=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ib=t=>"undefined"!=typeof Blob&&t instanceof Blob,Db=t=>(t=>"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||Ab(t)&&Sb(t.tee)&&Sb(t.cancel)&&Sb(t.getReader))(t)||(t=>Ab(t)&&Sb(t.read)&&Sb(t.pipe)&&(t=>"boolean"==typeof t)(t.readable))(t);function kb(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function Ob(t){var e;return!!t&&(Array.isArray(t)&&(t=t[0]),Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions))}function Mb(t){var e,n;let r;return kb(t,"null loader"),kb(Ob(t),"invalid loader"),Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Pb={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Nb=Pb.global||Pb.self||Pb.window||{},Rb="object"!=typeof process||"[object process]"!==String(process)||process.browser,jb="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);jb&&parseFloat(jb[1]);const Lb={},Fb=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Bb=/^([-\w.]+\/[-\w.+]+)/;function zb(t){const e=Bb.exec(t);return e?e[1]:t}function Ub(t){const e=Fb.exec(t);return e?e[1]:""}const Vb=/\?.*/;function Gb(t){if(Cb(t)){const e=Hb(t.url||"");return{url:e,type:zb(t.headers.get("content-type")||"")||Ub(e)}}return Ib(t)?{url:Hb(t.name||""),type:t.type||""}:"string"==typeof t?{url:Hb(t),type:Ub(t)}:{url:"",type:""}}function Hb(t){return t.replace(Vb,"")}async function $b(t){if(Cb(t))return t;const e={},n=function(t){return Cb(t)?t.headers["content-length"]||-1:Ib(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=Gb(t);i&&(e["content-type"]=i);const s=await async function(t){if("string"==typeof t)return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const e=t.slice(0,5);return await new Promise(t=>{const n=new FileReader;n.onload=e=>{var n;return t(null==e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)})}return t instanceof ArrayBuffer?`data:base64,${function(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}(t.slice(0,5))}`:null}(t);s&&(e["x-first-bytes"]=s),"string"==typeof t&&(t=(new TextEncoder).encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function qb(t,e){if("string"==typeof t){t=function(t){for(const e in Lb)t.startsWith(e)&&(t=t.replace(e,Lb[e]));return t.startsWith("http://")||t.startsWith("https://")||(t=`${t}`),t}(t);let n=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await $b(t)}function Wb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Xb=new kh({id:"loaders.gl"});class Kb{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const Zb={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){Wb(this,"console",void 0),this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Yb={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Qb(){Nb.loaders=Nb.loaders||{};const{loaders:t}=Nb;return t._state=t._state||{},t._state}const Jb=()=>{const t=Qb();return t.globalOptions=t.globalOptions||{...Zb},t.globalOptions};function t_(t,e){const n=Jb(),r=t||n;return"function"==typeof r.fetch?r.fetch:Ab(r.fetch)?t=>qb(t,r):null!=e&&e.fetch?null==e?void 0:e.fetch:qb}function e_(t,e,n,r,i){const s=e||"Top level",o=e?`${e}.`:"";for(const a in t){const u=!e&&Ab(t[a]),c="baseUri"===a&&!e,l="workerUrl"===a&&e;if(!(a in n)&&!c&&!l)if(a in r)Xb.warn(`${s} loader option '${o}${a}' no longer supported, use '${r[a]}'`)();else if(!u){const t=n_(a,i);Xb.warn(`${s} loader option '${o}${a}' not recognized. ${t}`)()}}}function n_(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const e in i.options){if(t===e)return`Did you mean '${i.id}.${e}'?`;const s=e.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||`Did you mean '${i.id}.${e}'?`)}return r}function r_(t,e){for(const n in e)n in e&&(t[n]=Tb(e[n])&&Tb(t[n])?{...t[n],...e[n]}:e[n])}function i_(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const s_={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},o_=s_.global||s_.self||s_.window||{},a_="object"!=typeof process||"[object process]"!==String(process)||process.browser,u_="function"==typeof importScripts,c_="undefined"!=typeof window&&void 0!==window.orientation,l_="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),h_=(l_&&parseFloat(l_[1]),new Map);function d_(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function f_(t,e=!0,n){const r=n||new Set;if(t)if(p_(t))r.add(t);else if(p_(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const i in t)f_(t[i],e,r);return void 0===n?Array.from(r):[]}function p_(t){return!!t&&(t instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&t instanceof MessagePort||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)}const g_=()=>{};class m_{static isSupported(){return"undefined"!=typeof Worker}constructor(t){Wb(this,"name",void 0),Wb(this,"source",void 0),Wb(this,"url",void 0),Wb(this,"terminated",!1),Wb(this,"worker",void 0),Wb(this,"onMessage",void 0),Wb(this,"onError",void 0),Wb(this,"_loadableURL","");const{name:e,source:n,url:r}=t;i_(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=g_,this.onError=t=>console.log(t),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=g_,this.onError=g_,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||f_(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+=`worker ${this.name}. `,t.message&&(e+=`${t.message} in `),t.lineno&&(e+=`:${t.lineno}:${t.colno}`),new Error(e)}_createBrowserWorker(){this._loadableURL=function(t){i_(t.source&&!t.url||!t.source&&t.url);let e=h_.get(t.source||t.url);return e||(t.url&&(e=(n=t.url).startsWith("http")?d_(`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`):n,h_.set(t.url,e)),t.source&&(e=d_(t.source),h_.set(t.source,e))),i_(e),e;var n}({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}}class y_{constructor(t,e){Wb(this,"name",void 0),Wb(this,"workerThread",void 0),Wb(this,"isRunning",void 0),Wb(this,"result",void 0),Wb(this,"_resolve",void 0),Wb(this,"_reject",void 0),this.name=t,this.workerThread=e,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((t,e)=>{this._resolve=t,this._reject=e})}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){i_(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){i_(this.isRunning),this.isRunning=!1,this._reject(t)}}class b_{constructor(t){Wb(this,"name","unnamed"),Wb(this,"source",void 0),Wb(this,"url",void 0),Wb(this,"maxConcurrency",1),Wb(this,"maxMobileConcurrency",1),Wb(this,"onDebug",()=>{}),Wb(this,"reuseWorkers",!0),Wb(this,"props",{}),Wb(this,"jobQueue",[]),Wb(this,"idleQueue",[]),Wb(this,"count",0),Wb(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e=((t,e,n)=>t.done(n)),n=((t,e)=>t.error(e))){const r=new Promise(r=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:r}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new y_(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new m_({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return c_?this.maxMobileConcurrency:this.maxConcurrency}}const __={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class v_{static isSupported(){return m_.isSupported()}static getWorkerFarm(t={}){return v_._workerFarm=v_._workerFarm||new v_({}),v_._workerFarm.setProps(t),v_._workerFarm}constructor(t){Wb(this,"props",void 0),Wb(this,"workerPools",new Map),this.props={...__},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy()}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:r}=t;let i=this.workerPools.get(e);return i||(i=new b_({name:e,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}async function w_(t,e,n,r,i){const s=t.id,o=function(t,e={}){const n=`${t.id}-worker.js`;let r=(e[t.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${t.module}/dist/${n}`),!r){let e=t.version;"latest"===e&&(e="latest"),r=`https://unpkg.com/@loaders.gl/${t.module}${e?`@${e}`:""}/dist/${n}`}return i_(r),r}(t,n),a=v_.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n));const u=await a.startJob("process-on-worker",x_.bind(null,i));u.postMessage("process",{input:e,options:n});const c=await u.result;return await c.result}async function x_(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(r.error);break;case"process":const{id:s,input:o,options:a}=r;try{const n=await t(o,a);e.postMessage("done",{id:s,result:n})}catch(i){const t=i instanceof Error?i.message:"unknown error";e.postMessage("error",{id:s,error:t})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}Wb(v_,"_workerFarm",void 0);var E_=n(521);function S_(t){var e;if((e=t)&&"object"==typeof e&&e.isBuffer&&(t=function(t){return E_.toArrayBuffer?E_.toArrayBuffer(t):t}(t)),t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function A_(t,e,n){const r=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}const T_=262144;function C_(t,e){return Rb?async function*(t,e){const n=t.getReader();let r;try{for(;;){const t=r||n.read();null!=e&&e._streamReadAhead&&(r=n.read());const{done:i,value:s}=await t;if(i)return;yield S_(s)}}catch(i){n.releaseLock()}}(t,e):async function*(t,e){for await(const n of t)yield S_(n)}(t)}const I_="Cannot convert supplied data type";const D_=()=>{const t=Qb();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function k_(t){const e=D_();t=Array.isArray(t)?t:[t];for(const n of t){const t=Mb(n);e.find(e=>t===e)||e.unshift(t)}}const O_=/\.([^.]+)$/;function M_(t,e=[],n,r){if(!P_(t))return null;if(e&&!Array.isArray(e))return Mb(e);let i=[];e&&(i=i.concat(e)),null!=n&&n.ignoreRegisteredLoaders||i.push(...D_()),function(t){for(const e of t)Mb(e)}(i);const s=function(t,e,n,r){const{url:i,type:s}=Gb(t),o=i||(null==r?void 0:r.url);let a=null;return null!=n&&n.mimeType&&(a=R_(e,null==n?void 0:n.mimeType)),a=a||function(t,e){const n=e&&O_.exec(e),r=n&&n[1];return r?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,r):null}(e,o),a=a||R_(e,s),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(j_(e,n))return n}else if(ArrayBuffer.isView(e)){if(L_(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&L_(e,0,n))return n;return null}(e,t),a=a||R_(e,null==n?void 0:n.fallbackMimeType),a}(t,i,n,r);if(!(s||null!=n&&n.nothrow))throw new Error(N_(t));return s}function P_(t){return!(t instanceof Response&&204===t.status)}function N_(t){const{url:e,type:n}=Gb(t);let r="No valid loader found";return t&&(r+=` data: "${function(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?F_(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?F_(t,0,e):""}(t)}", contentType: "${n}"`),e&&(r+=` url: ${e}`),r}function R_(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e===`application/x.${n.id}`)return n}return null}function j_(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(e=>t.startsWith(e))}function L_(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>function(t,e,n,r){if(r instanceof ArrayBuffer)return function(t,e,n){if(t.byteLength<(n=n||t.byteLength)||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":return r===F_(t,e,r.length);default:return!1}}(t,e,n,r))}function F_(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}async function B_(t,e,n,r){i_(!r||"object"==typeof r),!e||Array.isArray(e)||Ob(e)||(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=Gb(t),s=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,r),o=await async function(t,e=[],n,r){if(!P_(t))return null;let i=M_(t,e,{...n,nothrow:!0},r);if(i)return i;if(Ib(t)&&(i=M_(t=await t.slice(0,10).arrayBuffer(),e,n,r)),!(i||null!=n&&n.nothrow))throw new Error(N_(t));return i}(t,s,n);return o?(r=function(t,e,n=null){if(n)return n;const r={fetch:t_(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}({url:i,parse:B_,loaders:s},n=function(t,e,n,r){return n=n||[],function(t,e){e_(t,null,Zb,Yb,e);for(const n of e)e_(t&&t[n.id]||{},n.id,n.options&&n.options[n.id]||{},n.deprecatedOptions&&n.deprecatedOptions[n.id]||{},e)}(t,n=Array.isArray(n)?n:[n]),function(t,e,n){const r={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(r,n),null===r.log&&(r.log=new Kb),r_(r,Jb()),r_(r,e),r}(e,t,r)}(n,o,s,i),r),await async function(t,e,n,r){if(i_(t,"no worker provided"),e=await async function(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||r)return function(t,e,n){if(e.text&&"string"==typeof t)return t;var r;if((r=t)&&"object"==typeof r&&r.isBuffer&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const r=t.byteLength||t.length;return 0===t.byteOffset&&r===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+r)),n}throw new Error(I_)}(t,e);if(Ib(t)&&(t=await $b(t)),Cb(t)){const n=t;return await async function(t){if(!t.ok){const e=await async function(t){let e=`Failed to fetch resource ${t.url} (${t.status}): `;try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=` ${await t.text()}`),e+=r,e=e.length>60?`${e.slice(60)}...`:e}catch(n){}return e}(t);throw new Error(e)}}(n),e.binary?await n.arrayBuffer():await n.text()}if(Db(t)&&(t=function(t,e){if("string"==typeof t)return function*(t,e){const n=(null==e?void 0:e.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<t.length;){const e=Math.min(t.length-r,n),s=t.slice(r,r+e);r+=e,yield i.encode(s)}}(t,e);if(t instanceof ArrayBuffer)return function*(t,e={}){const{chunkSize:n=T_}=e;let r=0;for(;r<t.byteLength;){const e=Math.min(t.byteLength-r,n),i=new ArrayBuffer(e),s=new Uint8Array(t,r,e);new Uint8Array(i).set(s),r+=e,yield i}}(t,e);if(Ib(t))return async function*(t,e){const n=(null==e?void 0:e.chunkSize)||1048576;let r=0;for(;r<t.size;){const e=r+n,i=await t.slice(r,e).arrayBuffer();r=e,yield i}}(t,e);if(Db(t))return C_(t,e);if(Cb(t))return C_(t.body,e);throw new Error("makeIterator")}(t,n)),(i=t)&&"function"==typeof i[Symbol.iterator]||(t=>t&&"function"==typeof t[Symbol.asyncIterator])(t))return async function(t){const e=[];for await(const n of t)e.push(n);return function(...t){const e=t.map(t=>t instanceof ArrayBuffer?new Uint8Array(t):t),n=e.reduce((t,e)=>t+e.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}(...e)}(t);var i;throw new Error(I_)}(e,t,n),t.parseTextSync&&"string"==typeof e)return n.dataType="text",t.parseTextSync(e,n,r,t);if(function(t,e){return!!v_.isSupported()&&t.worker&&(null==e?void 0:e.worker)}(t,n))return await w_(t,e,n,0,B_);if(t.parseText&&"string"==typeof e)return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw i_(!t.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}(o,t,n,r)):null}async function z_(t,e,n,r){Array.isArray(e)||Ob(e)||(n=e,e=void 0);const i=t_(n);let s=t;return"string"==typeof t&&(s=await i(t)),Ib(t)&&(s=await i(t)),await B_(s,e,n)}const U_=2**24-1,V_=Object.freeze([]),G_=Gm(({oldViewport:t,viewport:e})=>t.equals(e));let H_=new Uint8ClampedArray(0);const $_={data:{type:"data",value:V_,async:!0},dataComparator:null,_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;var a;i=i||n.getLoadOptions(),r=r||n.props.loaders,s&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:s}});let u=o.contains(t);return u||i||(o.add({resourceId:t,data:z_(t,r),persistent:!1}),u=!0),u?o.subscribe({resourceId:t,onChange:t=>n.internalState.reloadAsyncProp(e,t),consumerId:n.id,requestId:e}):z_(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Nh.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let q_=(()=>{class t extends xb{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,e){var n,r,i,s;e&&(t.message="".concat(e,": ").concat(t.message)),(null===(n=(r=this.props).onError)||void 0===n?void 0:n.call(r,t))||null===(i=this.context)||void 0===i||null===(s=i.onError)||void 0===s||s.call(i,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:e}=this.context,n=Xy(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,s]=Ny(n,e.pixelProjectionMatrix);return 2===t.length?[r,i]:[r,i,s]}unproject(t){const{viewport:e}=this.context;return e.unproject(t)}projectPosition(t){return function(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(t){const e={...t};let{coordinateSystem:n}=t;const{viewport:r,coordinateOrigin:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return n===Nh.DEFAULT&&(n=r.isGeospatial?Nh.LNGLAT:Nh.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=n),void 0===o&&(e.fromCoordinateOrigin=i),e.coordinateSystem=n,e}(e),{geospatialOrigin:u,shaderCoordinateOrigin:c,offsetMode:l}=ay(n,r,i),h=Xy(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:l});return l&&function(t,e,n){t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2]}(h,h,n.projectPosition(u||c)),h}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Nh.DEFAULT||t===Nh.LNGLAT||t===Nh.CARTESIAN}onHover(t,e){return!!this.props.onHover&&this.props.onHover(t,e)}onClick(t,e){return!!this.props.onClick&&this.props.onClick(t,e)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){dp(t instanceof Uint8Array);const[e,n,r]=t;return e+256*n+65536*r-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const e of this.props.extensions)t=Hm(t,e.getShaders.call(this,e));return t}shouldUpdateState({changeFlags:t}){return t.propsOrDataChanged}updateState({oldProps:t,props:e,changeFlags:n}){const r=this.getAttributeManager();if(n.dataChanged&&r){const{dataChanged:t}=n;if(Array.isArray(t))for(const e of t)r.invalidateAll(e);else r.invalidateAll()}const i=e.highlightedObjectIndex>=0||e.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==i&&r){const{pickingColors:t,instancePickingColors:e}=r.attributes,n=t||e;n&&(i&&n.constant&&(n.constant=!1,r.invalidate(n.id)),n.value||i||(n.constant=!0,n.value=[0,0,0]))}}finalizeState(){for(const e of this.getModels())e.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t}){const{index:e}=t;return e>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[e]),t}activateViewport(t){const e=this.internalState.viewport;this.internalState.viewport=t,e&&G_({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",e=""){const n=this.getAttributeManager();n&&("all"===t?n.invalidateAll():n.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(t){const e=this.getAttributeManager();if(!e)return;const n=this.getNumInstances(t),r=this.getStartIndices(t);e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(H_.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>U_&&Ph.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),H_=Mf.allocate(H_,e,{size:3,copy:!0,maxCount:Math.max(e,U_)});const t=Math.floor(H_.length/3),r=[];for(let e=n;e<t;e++)this.encodePickingColor(e,r),H_[3*e+0]=r[0],H_[3*e+1]=r[1],H_[3*e+2]=r[2]}t.value=H_.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager().getShaderAttributes(e,t.userData.excludeAttributes||{});t.setAttributes(n)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n,i=r.getVertexOffset(t),s=r.getVertexOffset(t+1);r.buffer.subData({data:new Uint8Array(s-i),offset:i})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;this.internalState.usesPickingColorCache&&n.value.buffer!==H_.buffer&&(n.value=H_.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(t){if(null===(e=t)||"object"!=typeof e)throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){Mp("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();Mp("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,e=this.context.viewport,n=this._updateUniformTransition();this.internalState.propsInTransition=n,this.context.viewport=this.internalState.viewport||e,this.props=n;try{const n=this._getUpdateParams(),i=this.getModels();if(this.context.gl)this.updateState(n);else try{this.updateState(n)}catch(r){}for(const t of this.props.extensions)t.updateState.call(this,n,t);const s=this.getModels()[0]!==i[0];this._updateModules(n,s),this.isComposite?this._renderLayers(n):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=e,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){Mp("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const r=this.props;this.props=this.internalState.propsInTransition||r;const{opacity:i}=this.props;e.opacity=Math.pow(i,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:i}=this.props,s=i&&i(e)||[0,0];_d(this.context.gl,{polygonOffset:s}),vd(this.context.gl,n,()=>{const r={moduleParameters:t,uniforms:e,parameters:n,context:this.context};for(const t of this.props.extensions)t.draw.call(this,r,t);this.draw(r)})}finally{this.props=r}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:e}=this.internalState;for(const r in t)if(t[r]){let n=!1;switch(r){case"dataChanged":Array.isArray(e[r])&&(e[r]=Array.isArray(t[r])?e[r].concat(t[r]):t[r],n=!0);default:e[r]||(e[r]=t[r],n=!0)}n&&Mp("layer.changeFlag",this,r,t)}const n=e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged;e.propsOrDataChanged=n,e.somethingChanged=n||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,e){const n=function(t,e){const n=Lm({newProps:t,oldProps:e,propTypes:Um(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=null;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}(t,e);let i=!1;return r||(i=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers&&zm(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)"all"!==i&&zm(t,e,i)&&(n[i]=!0,r=n);return r}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Bm(t,e),transitionsChanged:jm(t,e)}}(t,e);if(n.updateTriggersChanged)for(const r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,e[r],t[r],t.transitions[r]);return this.setChangeFlags(n)}validateProps(){!function(t){const e=Um(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_updateModules({props:t,oldProps:e},n){const{autoHighlight:r,highlightedObjectIndex:i,highlightColor:s}=t;if(n||e.autoHighlight!==r||e.highlightedObjectIndex!==i||e.highlightColor!==s){const t={};r||(t.pickingSelectedColor=null),Array.isArray(s)&&(t.pickingHighlightColor=s),Number.isInteger(i)&&(t.pickingSelectedColor=i>=0?this.encodePickingColor(i):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const n=this.getAttributeManager(),r=n&&n.getNeedsRedraw(t);return e=e||r,e}_getAttributeManager(){return new Im(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){dp(!this.internalState&&!this.state),dp(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Eb({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ph.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new Pm(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){Mp("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return t.layerName="Layer",t.defaultProps=$_,t})(),W_=(()=>{class t extends q_{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}return t}getSubLayerProps(t={}){const{opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:a,highlightColor:u,coordinateSystem:c,coordinateOrigin:l,wrapLongitude:h,positionFormat:d,modelMatrix:f,extensions:p,fetch:g,_subLayerProps:m}=this.props,y={opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:s,highlightedObjectIndex:o,autoHighlight:a,highlightColor:u,coordinateSystem:c,coordinateOrigin:l,wrapLongitude:h,positionFormat:d,modelMatrix:f,extensions:p,fetch:g},b=m&&m[t.id],_=b&&b.updateTriggers,v=t.id||"sublayer";if(b){const e=this.constructor._propTypes,n=t.type?t.type._propTypes:{};for(const t in b){const r=n[t]||e[t];r&&"accessor"===r.type&&(b[t]=this.getSubLayerAccessor(b[t]))}}Object.assign(y,t,b),y.id="".concat(this.props.id,"-").concat(v),y.updateTriggers={all:this.props.updateTriggers.all,...t.updateTriggers,..._};for(const w of p){const t=w.getSubLayerProps.call(this,w);t&&Object.assign(y,t,{updateTriggers:Object.assign(y.updateTriggers,t.updateTriggers)})}return y}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const e=!t||this.needsUpdate();e&&(t=this.renderLayers(),t=yp(t,Boolean),this.internalState.subLayers=t),Mp("compositeLayer.renderLayers",this,e,t);for(const n of t)n.parent=this}}return t.layerName="CompositeLayer",t})();const X_=/([0-9]+\.?[0-9]*)(%|px)/;function K_(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=t.match(X_);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function Z_(t,e){return t.relative?Math.round(t.position*e):t.position}function Y_(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const r=t[n],i=e[n];if(!(r===i||Array.isArray(r)&&Array.isArray(i)&&Y_(r,i)))return!1}return!0}class Q_{constructor(t={}){const{id:e=null,x:n=0,y:r=0,width:i="100%",height:s="100%",projectionMatrix:o=null,fovy:a=50,near:u=.1,far:c=1e3,modelMatrix:l=null,viewportInstance:h=null,type:d=$y}=t;dp(!h||h instanceof $y),this.viewportInstance=h,this.id=e||this.constructor.displayName||"view",this.type=d,this.props={...t,id:this.id,projectionMatrix:o,fovy:a,near:u,far:c,modelMatrix:l},this._parseDimensions({x:n,y:r,width:i,height:s}),this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):Y_(this.props,t.props))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const r=this.getDimensions({width:t,height:e});return this._getViewport(n,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){return{x:Z_(this._x,t),y:Z_(this._y,e),width:Z_(this._width,t),height:Z_(this._height,e)}}_getControllerProps(t){let e=this.props.controller;return e?!0===e?t:("function"==typeof e&&(e={type:e}),{...t,...e}):null}_getViewport(t,e){const{type:n}=this;return new n({...t,...this.props,...e})}_parseDimensions({x:t,y:e,width:n,height:r}){this._x=K_(t),this._y=K_(e),this._width=K_(n),this._height=K_(r)}}const J_=()=>{},tv={transitionEasing:t=>t,transitionInterruption:1,onTransitionStart:J_,onTransitionInterrupt:J_,onTransitionEnd:J_};class ev{constructor(t,e={}){this.ControllerState=t,this.props={...tv,...e},this.propsInTransition=null,this.transition=new Sm(e.timeline),this.onViewStateChange=e.onViewStateChange||J_,this.onStateChange=e.onStateChange||J_,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(t={...tv,...t},this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){const{interruption:r,endProps:i}=this.transition.settings,s={...n,...2===r?i:this.propsInTransition||n};this._triggerTransition(s,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=new this.ControllerState(t),r=new this.ControllerState(e).shortestPathFrom(n),{transitionInterpolator:i}=e,s=i.getDuration?i.getDuration(t,e):e.transitionDuration;if(0===s)return;const o=e.transitionInterpolator.initializeProps(t,r);this.propsInTransition={},this.duration=s,this.transition.start({duration:s,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:o.start,endProps:o.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t(e)}}_onTransitionUpdate(t){const{time:e,settings:{interpolator:n,startProps:r,endProps:i,duration:s,easing:o}}=t,a=o(e/s),u=n.interpolateProps(r,i,a);this.propsInTransition=new this.ControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const nv=["longitude","latitude","zoom","bearing","pitch"],rv=["longitude","latitude","zoom"];class iv extends class{constructor(t={}){Array.isArray(t)&&(t={compare:t,extract:t,required:t});const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare||Object.keys(e))if(!(n in t)||!(n in e)||!Uf(t[n],e[n]))return!1;return!0}initializeProps(t,e){let n;if(this._propsToExtract){const r={},i={};for(const n of this._propsToExtract)r[n]=t[n],i[n]=e[n];n={start:r,end:i}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}interpolateProps(t,e,n){return e}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(e=>{const n=t[e];dp(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}{constructor(t={}){super((Array.isArray(t)?t:t.transitionProps)||{compare:nv,extract:nv,required:rv}),this.opts=t}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:r,around:i}=this.opts;if(r&&i){const s=r(t),o=r(e),a=s.unproject(i);n.start.around=i,Object.assign(n.end,{around:o.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const r={};for(const i of this._propsToExtract)r[i]=zf(t[i]||0,e[i]||0,n);if(e.aroundPosition){const i=this.opts.makeViewport({...e,...r});Object.assign(r,i.panByPosition(e.aroundPosition,zf(t.around,e.around,n)))}return r}}const sv={transitionDuration:0},ov={transitionDuration:300,transitionEasing:t=>t,transitionInterruption:1},av=t=>1-(1-t)*(1-t),uv=["wheel"],cv=["panstart","panmove","panend"],lv=["pinchstart","pinchmove","pinchend"],hv=["tripanstart","tripanmove","tripanend"],dv=["doubletap"],fv=["keydown"];class pv{constructor(t,e={}){this.ControllerState=t,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new ev(t,{...e,onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)});const n=this.linearTransitionProps;this._transition=n&&{...ov,transitionInterpolator:new iv({transitionProps:n})},this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(e)}get linearTransitionProps(){return null}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.setProps(this.controllerStateProps)}finalize(){for(const t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){const{ControllerState:e}=this;this.controllerState=new e({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state});const n=this._eventStartBlocked;switch(t.type){case"panstart":return!n&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!n&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!n&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}getCenter(t){const{x:e,y:n}=this.controllerStateProps,{offsetCenter:r}=t;return[r.x-e,r.y-n]}isPointInBounds(t,e){const{width:n,height:r}=this.controllerStateProps;if(e&&e.handled)return!1;const i=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r;return i&&e&&e.stopPropagation(),i}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(t){const e=setTimeout(()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=e}setProps(t){"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),"makeViewport"in t&&(this.makeViewport=t.makeViewport),"dragMode"in t&&(this.dragMode=t.dragMode),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:e}=t;!0===e&&(e=300),this.inertia=e;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:s=!0,touchZoom:o=!0,touchRotate:a=!1,keyboard:u=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(uv,c&&n),this.toggleEvents(cv,c&&(r||i)),this.toggleEvents(lv,c&&(o||a)),this.toggleEvents(hv,c&&a),this.toggleEvents(dv,c&&s),this.toggleEvents(fv,c&&u),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=s,this.touchZoom=o,this.touchRotate=a,this.keyboard=u}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach(t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))})}updateViewport(t,e={},n={}){const r={...t.getViewportProps(),...e},i=this.controllerState!==t;if(this._state=t.getState(),this._setInteractionState(n),i){const t=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange&&(t.interactionState=this._interactionState,this.onViewStateChange(t))}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(r,sv,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,sv,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),r=this.controllerState.pan({pos:[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2]}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:av},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,sv,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),r=this.controllerState.rotate({pos:[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2]}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:av},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:r=!1}=this.scrollZoom,{delta:i}=t;let s=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==s&&(s=1/s);const o=this.controllerState.zoom({pos:e,scale:s});return this.updateViewport(o,{...this._getTransitionProps({around:e}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,sv,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,sv,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),r=[n[0],n[1]+=t.velocityY*e/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:av},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,sv,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:this._startPinchRotation-n})}return this.updateViewport(e,sv,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e,_lastPinchEvent:n}=this;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const r=this.getCenter(t);let i=this.controllerState.rotateEnd();const s=Math.log2(t.scale),o=(s-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),a=Math.pow(2,s+o*e/2);i=i.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:e,transitionEasing:av},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:s}=this.keyboard,{controllerState:o}=this;let a;const u={};switch(t.srcEvent.code){case"Minus":a=e?o.zoomOut(n).zoomOut(n):o.zoomOut(n),u.isZooming=!0;break;case"Equal":a=e?o.zoomIn(n).zoomIn(n):o.zoomIn(n),u.isZooming=!0;break;case"ArrowLeft":e?(a=o.rotateLeft(i),u.isRotating=!0):(a=o.moveLeft(r),u.isPanning=!0);break;case"ArrowRight":e?(a=o.rotateRight(i),u.isRotating=!0):(a=o.moveRight(r),u.isPanning=!0);break;case"ArrowUp":e?(a=o.rotateUp(s),u.isRotating=!0):(a=o.moveUp(r),u.isPanning=!0);break;case"ArrowDown":e?(a=o.rotateDown(s),u.isRotating=!0):(a=o.moveDown(r),u.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),u),!0}_getTransitionProps(t){const{_transition:e}=this;return e?t?{...e,transitionInterpolator:new iv({...t,transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport})}:e:sv}}class gv{constructor(t){this._viewportProps=this._applyConstraints(t)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(t){return this._viewportProps}_applyConstraints(t){return t}}const mv=[0,0,0];class yv extends gv{constructor({makeViewport:t,width:e,height:n,rotationX:r=0,rotationOrbit:i=0,target:s=mv,zoom:o=0,minRotationX:a=-90,maxRotationX:u=90,minZoom:c=-1/0,maxZoom:l=1/0,startPanPosition:h,startRotatePos:d,startRotationX:f,startRotationOrbit:p,startZoomPosition:g,startZoom:m}){super({width:e,height:n,rotationX:r,rotationOrbit:i,target:s,zoom:o,minRotationX:a,maxRotationX:u,minZoom:c,maxZoom:l}),this._state={startPanPosition:h,startRotatePos:d,startRotationX:f,startRotationOrbit:p,startZoomPosition:g,startZoom:m},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:e}){const n=this._state.startPanPosition||e;if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startRotationX:i,startRotationOrbit:s}=this._state,{width:o,height:a}=this._viewportProps;if(!r||!Number.isFinite(i)||!Number.isFinite(s))return this;let u;if(t){let e=(t[0]-r[0])/o;(i<-90||i>90)&&(e*=-1),u={rotationX:i+(t[1]-r[1])/a*180,rotationOrbit:s+180*e}}else u={rotationX:i+n,rotationOrbit:s+e};return this._getUpdatedState(u)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{rotationOrbit:r}=n;return Math.abs(r-e.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){const{zoom:r}=this._viewportProps;let{startZoom:i,startZoomPosition:s}=this._state;Number.isFinite(i)||(i=r,s=this._unproject(e)||this._unproject(t));const o=this._calculateNewZoom({scale:n,startZoom:i}),a=this.makeViewport({...this._viewportProps,zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+t})}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps;return Number.isFinite(e)||(e=this._viewportProps.zoom),Bf(e+Math.log2(t),r,n)}_panFromCenter(t){const{width:e,height:n,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new yv({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r,maxRotationX:i,minRotationX:s,rotationOrbit:o}=t;return t.zoom=Bf(r,n,e),t.rotationX=Bf(t.rotationX,s,i),(o<-180||o>180)&&(t.rotationOrbit=function(t,e){const n=t%360;return n<0?360+n:n}(o+180)-180),t}}class bv extends pv{constructor(t){super(yv,t)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class _v extends pv{constructor(t){t.dragMode=t.dragMode||"pan",super(yv,t)}_onPanRotate(t){return!1}get linearTransitionProps(){return["target","zoom"]}}const vv=(new my).lookAt({eye:[0,0,1]});function wv({width:t,height:e,near:n,far:r}){return t=t||1,e=e||1,(new my).ortho({left:-t/2,right:t/2,bottom:-e/2,top:e/2,near:n,far:r})}class xv extends $y{constructor(t){const{width:e,height:n,near:r=.1,far:i=1e3,zoom:s=0,target:o=[0,0,0],flipY:a=!0}=t,u=Math.pow(2,s);super({...t,longitude:null,position:o,viewMatrix:vv.clone().scale([u,u*(a?-1:1),u]),projectionMatrix:wv({width:e,height:n,near:r,far:i}),zoom:s})}panByPosition(t,e){const n=cy([],t,ly([],Ry(e,this.pixelUnprojectionMatrix)));return{target:cy([],this.center,n)}}}let Ev=(()=>{class t extends Q_{constructor(t){super({...t,type:xv})}get controller(){return this._getControllerProps({type:_v})}}return t.displayName="OrthographicView",t})();const Sv=Math.PI/180;function Av({height:t,fovy:e,orbitAxis:n,rotationX:r,rotationOrbit:i,zoom:s}){const o=.5/Math.tan(e*Sv/2),a="Z"===n?[0,0,1]:[0,1,0],u="Z"===n?[0,-o,0]:[0,0,o],c=(new my).lookAt({eye:u,up:a});c.rotateX(r*Sv),"Z"===n?c.rotateZ(i*Sv):c.rotateY(i*Sv);const l=Math.pow(2,s)/(t||1);return c.scale(l),c}class Tv extends $y{constructor(t){const{height:e,fovy:n,orbitAxis:r,target:i=[0,0,0],rotationX:s=0,rotationOrbit:o=0,zoom:a=0}=t;super({...t,longitude:null,viewMatrix:Av({height:e,fovy:n,orbitAxis:r,rotationX:s,rotationOrbit:o,zoom:a}),fovy:n,position:i,zoom:a}),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:e=!0}={}){const[n,r,i=this.projectedCenter[2]]=t,s=e?r:this.height-r,[o,a,u]=Ry([n,s,i],this.pixelUnprojectionMatrix);return[o,a,u]}panByPosition(t,e){const n=this.project(t);return{target:this.unproject([this.width/2+n[0]-e[0],this.height/2+n[1]-e[1],this.projectedCenter[2]])}}}let Cv=(()=>{class t extends Q_{constructor(t={}){const{orbitAxis:e="Z"}=t;super({...t,orbitAxis:e,type:Tv})}get controller(){return this._getControllerProps({type:bv})}}return t.displayName="OrbitView",t})();const Iv=[255,255,255],Dv=1;let kv=0;class Ov{constructor(t={}){const{color:e=Iv}=t,{intensity:n=Dv}=t;this.id=t.id||"ambient-".concat(kv++),this.color=e,this.intensity=n,this.type="ambient"}}const Mv=[255,255,255],Pv=1,Nv=[0,0,-1];let Rv=0;class jv{constructor(t={}){const{color:e=Mv}=t,{intensity:n=Pv}=t,{direction:r=Nv}=t,{_shadow:i=!1}=t;this.id=t.id||"directional-".concat(Rv++),this.color=e,this.intensity=n,this.type="directional",this.direction=new sp(r).normalize().toArray(),this.shadow=i}getProjectedLight(){return this}}class Lv{constructor(t={}){const{id:e="effect"}=t;this.id=e,this.props={...t}}preRender(){}getModuleParameters(){}cleanup(){}}class Fv extends class{constructor(t,e={}){const{id:n="pass"}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(){}cleanup(){}}{render(t){return _d(this.gl,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{viewports:e,views:n,onViewportActive:r,clearCanvas:i=!0}=t;t.pass=t.pass||"unknown";const s=this.gl;i&&function(t){_d(t,{viewport:[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}),t.clear(16640)}(s);const o=[];for(const a of e){const e=a.viewport||a,i=n&&n[e.id];r(e);const u=this._getDrawLayerParams(e,t);t.view=i;const c=e.subViewports||[e];for(const n of c){t.viewport=n;const e=this._drawLayersInViewport(s,t,u);o.push(e)}}return o}_getDrawLayerParams(t,{layers:e,pass:n,layerFilter:r,effects:i,moduleParameters:s}){const o=[],a=Bv(),u={viewport:t,isPicking:n.startsWith("picking"),renderPass:n};for(let c=0;c<e.length;c++){const t=e[c],l=this._shouldDrawLayer(t,u,r),h={shouldDrawLayer:l,layerRenderIndex:a(t,l)};l&&(h.moduleParameters=this._getModuleParameters(t,i,n,s),h.layerParameters=this.getLayerParameters(t,c)),o[c]=h}return o}_drawLayersInViewport(t,{layers:e,pass:n,viewport:r,view:i},s){const o=function(t,{viewport:e}){const n=t.canvas?t.canvas.clientHeight||t.canvas.height:100,r=e,i=wd(t);return[r.x*i,(n-r.y-r.height)*i,r.width*i,r.height*i]}(t,{viewport:r});if(i&&i.props.clear){const e=!0===i.props.clear?{color:!0,depth:!0}:i.props.clear;vd(t,{scissorTest:!0,scissor:o},()=>pf(t,e))}const a={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};_d(t,{viewport:o});for(let c=0;c<e.length;c++){const t=e[c],{shouldDrawLayer:i,layerRenderIndex:o,moduleParameters:l,layerParameters:h}=s[c];if(i&&t.props.pickable&&a.pickableCount++,t.isComposite)a.compositeCount++;else if(i){a.visibleCount++,l.viewport=r;try{t.drawLayer({moduleParameters:l,uniforms:{layerIndex:o},parameters:h})}catch(u){t.raiseError(u,"drawing ".concat(t," to ").concat(n))}}}return a}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e){return t.props.parameters}_shouldDrawLayer(t,e,n){if(!this.shouldDrawLayer(t)||!t.props.visible)return!1;if(e.layer=t,n&&!n(e))return!1;let r=t.parent;for(;r;){if(!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,r){const i=Object.assign(Object.create(t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:wd(this.gl)});if(e)for(const s of e)Object.assign(i,s.getModuleParameters(t));return Object.assign(i,this.getModuleParameters(t,e),r)}}function Bv(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,u=i.parent&&i.parent.id;let c;if(u&&!(u in e)&&r(i.parent,!1),u in n){const t=n[u]=n[u]||Bv(e[u],e);c=t(i,s),n[a]=t}else Number.isFinite(o)?(c=o+(e[u]||0),n[a]=null):c=t;return s&&c>=t&&(t=c+1),e[a]=c,c};return r}class zv extends Fv{constructor(t,e){super(t,e),this.shadowMap=new cf(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new df(t,{format:33189,width:1,height:1}),this.fbo=new xf(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;vd(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const n=t.viewports[0],r=wd(this.gl),i=n.width*r,s=n.height*r;i===e.width&&s===e.height||e.resize({width:i,height:s}),super.render({...t,target:e,pass:"shadow"})})}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Uv=Object.keys(Nh).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Nh[t],";")).join(""),Vv=Object.keys(Rh).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Rh[t],";")).join(""),Gv="".concat(Uv,"\n").concat(Vv,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    dy = clamp(dy, -1., 1.);\n  }\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  );\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy) * WORLD_SCALE,\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),Hv={},$v={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:Gv,getUniforms:function(t=Hv){return t.viewport?function({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Nh.DEFAULT,coordinateOrigin:i,autoWrapLongitude:s=!1}={}){r===Nh.DEFAULT&&(r=t.isGeospatial?Nh.LNGLAT:Nh.CARTESIAN);const o=oy({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||ry,o}(t):{}}},qv=Gm(function({viewport:t,center:e}){return new my(t.viewProjectionMatrix).invert().transform(e)}),Wv=Gm(function({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(t=>function(t,e){const[n,r,i]=t,s=Ry([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}(t,r));for(const o of e){const e=o.clone().translate(new sp(t.center).negate()),r=s.map(t=>e.transform(t)),i=(new my).ortho({left:Math.min(...r.map(t=>t[0])),right:Math.max(...r.map(t=>t[0])),bottom:Math.min(...r.map(t=>t[1])),top:Math.max(...r.map(t=>t[1])),near:Math.min(...r.map(t=>-t[2])),far:Math.max(...r.map(t=>-t[2]))});n.push(i.multiplyRight(o))}return n}),Xv=[0,0,0,1],Kv=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Zv={name:"shadow",dependencies:[$v],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>{if(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0){const{shadowEnabled:n=!0}=t;return n&&t.shadowMatrices&&t.shadowMatrices.length>0?function(t={},e={}){const n={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||Xv,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=qv({viewport:t.viewport,center:e.project_uCenter}),i=[],s=Wv({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let o=0;o<t.shadowMatrices.length;o++){const n=s[o],a=n.clone().translate(new sp(t.viewport.center).negate());e.project_uCoordinateSystem===Nh.LNGLAT&&e.project_uProjectionMode===Rh.WEB_MERCATOR?(s[o]=a,i[o]=r):(s[o]=n.clone().multiplyRight(Kv),i[o]=a.transform(r))}for(let o=0;o<s.length;o++)n["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],n["shadow_uProjectCenters[".concat(o,"]")]=i[o],n["shadow_uShadowMap".concat(o)]=t.shadowMaps&&t.shadowMaps.length>0?t.shadowMaps[o]:t.dummyShadowMap;return n}(t,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},Yv={color:[255,255,255],intensity:1},Qv=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Jv=[0,0,0,200/255];class tw extends Lv{constructor(t){super(t),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=Jv,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(t,{layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=rm.getDefaultProgramManager(t),Zv&&this.programManager.addDefaultModule(Zv)),this.dummyShadowMap||(this.dummyShadowMap=new cf(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++)this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(e=>e.getProjectedLight({layer:t})),pointLights:this.pointLights.map(e=>e.getProjectedLight({layer:t}))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Zv),this.programManager=null)}_createLightMatrix(){const t=[];for(const e of this.directionalLights){const n=(new my).lookAt({eye:new sp(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new zv(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new Ov(Yv),this.directionalLights.push(new jv(Qv[0]),new jv(Qv[1])))}}let ew=1,nw=1;class rw{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:i=1}=t,s=ew++,o={time:0,delay:e,duration:n,rate:r,repeat:i};return this._setChannelTime(o,this.time),this.channels.set(s,o),s}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const r of e)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:t,channel:e}=r;t.setTime(this.getTime(e))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=nw++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}class iw{constructor(t,e,n){this.id=t,this.context=n,this._loadCount=0,this._subscribers=new Set,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let r=t;"string"==typeof t&&(r=z_(t)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=null,this._content=t)}).catch(t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)})):(this.isLoaded=!0,this._error=null,this._content=t);for(const i of this._subscribers)i.onChange(this.getData())}}class sw{constructor({gl:t,protocol:e}){this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:r=!0}){let i=this._resources[t];i?i.setData(e,n):(i=new iw(t,e,this._context),this._resources[t]=i),i.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t];n.resource&&n.resource.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:r="default"}){const{_resources:i,protocol:s}=this;t.startsWith(s)&&(i[t=t.replace(s,"")]||this.add({resourceId:t,data:null,persistent:!1}));const o=i[t];if(this._track(n,r,o,e),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,r){const i=this._consumers,s=i[t]=i[t]||{},o=s[e]||{};o.resource&&(o.resource.unsubscribe(o),o.resource=null,this.prune()),n&&(s[e]=o,o.onChange=r,o.resource=n,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}const ow=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},$v],aw=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function uw(t){const e=rm.getDefaultProgramManager(t);for(const n of ow)e.addDefaultModule(n);for(const n of aw)e.addShaderHook(n);return e}const cw=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class lw{constructor(t,{deck:e,stats:n,viewport:r,timeline:i}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new sw({gl:t,protocol:"deck://"}),this.context={...cw,layerManager:this,gl:t,deck:e,programManager:t&&uw(t),stats:n||new Md({id:"deck.gl"}),viewport:r||new $y({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:i||new rw,resourceManager:this.resourceManager},this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(t);e=e||r}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t=null}={}){return t?this.layers.filter(e=>t.find(t=>0===e.id.indexOf(t))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){Mp("layerManager.setLayers",this,e,t),this.lastRenderedLayers=t,t=yp(t,Boolean);for(const n of t)n.context=this.context;return this._updateLayers(this.layers,t),this}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this.lastRenderedLayers,t)),this._nextLayers=null}activateViewport(t){return Mp("layerManager.activateViewport",this,t),t&&(this.context.viewport=t),this}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const s of t)n[s.id]?Ph.warn("Multiple old layers with same id ".concat(s.id))():n[s.id]=s;const r=[];this._updateSublayersRecursively(e,n,r),this._finalizeOldLayers(n);let i=!1;for(const s of r)if(s.hasUniformTransition()){i=!0;break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&Ph.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let s=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),s=i.isComposite&&i.getSubLayers()}catch(r){this._handleError("matching",r,i)}s&&this._updateSublayersRecursively(s,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle="Initialized"}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle="Matched. State transferred from previous layer",e!==t&&(t.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle="No longer matched. Awaiting garbage collection";try{t._finalize(),t.lifecycle="Finalized! Awaiting garbage collection"}catch(e){this._handleError("finalization",e,t)}}}class hw{constructor(t={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter(e=>e.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(e=>{t[e.id]=e}),t}getView(t){return"string"==typeof t?this.views.find(e=>e.id===t):t}getViewState(t){const e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),r={x:t[0],y:t[1]};for(let i=n.length-1;i>=0;--i){const s=n[i];if(s.containsPixel(r)){const n=t.slice();return n[0]-=s.x,n[1]-=s.y,s.unproject(n,e)}}return null}setProps(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=yp(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!Y_(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):Ph.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(e)}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>t._getViewport(e,{width:e.width,height:e.height}),...e})}_updateController(t,e,n,r){let i=t.controller;return i?(i={...e,...t.props,...i,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height},r?r.setProps(i):r=this._createController(t,i),r):null}_rebuildViewports(){const{width:t,height:e,views:n}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let s=n.length;s--;){const o=n[s],a=this.getViewState(o),u=o.makeViewport({width:t,height:e,viewState:a});let c=r[o.id];o.controller&&!c&&(i=!0),!i&&o.controller||!c||(c.finalize(),c=null),this.controllers[o.id]=this._updateController(o,a,u,c),this._viewports.unshift(u)}for(const s in r)r[s]&&!this.controllers[s]&&r[s].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,e){return t.length!==e.length||t.some((n,r)=>!t[r].equals(e[r]))}}class dw extends gv{constructor({makeViewport:t,width:e,height:n,latitude:r,longitude:i,zoom:s,bearing:o=0,pitch:a=0,altitude:u=1.5,maxZoom:c=20,minZoom:l=0,maxPitch:h=60,minPitch:d=0,startPanLngLat:f,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:b,normalize:_}={}){dp(Number.isFinite(i)),dp(Number.isFinite(r)),dp(Number.isFinite(s)),super({width:e,height:n,latitude:r,longitude:i,zoom:s,bearing:o,pitch:a,altitude:u,maxZoom:c,minZoom:l,maxPitch:h,minPitch:d,normalize:_}),this._state={startPanLngLat:f,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:b},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this._state.startPanLngLat||this._unproject(e);if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:s}=this._state;if(!r||!Number.isFinite(i)||!Number.isFinite(s))return this;let o;return o=t?this._calculateNewPitchAndBearing({...this._getRotationParams(t,r),startBearing:i,startPitch:s}):{bearing:i+e,pitch:s+n},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomLngLat:i}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,i=this._unproject(e)||this._unproject(t));const s=this._calculateNewZoom({scale:n,startZoom:r}),o=this.makeViewport({...this._viewportProps,zoom:s});return this._getUpdatedState({zoom:s,...o.panByPosition(i,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_zoomFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=Bf(r,n,e);const{maxPitch:i,minPitch:s,pitch:o}=t;t.pitch=Bf(o,s,i);const{normalize:a=!0}=t;return a&&Object.assign(t,function({width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:s=0,bearing:o=0}){(n<-180||n>180)&&(n=by(n+180,360)-180),(o<-180||o>180)&&(o=by(o+180,360)-180);const a=_y(e/512);if(i<=a)i=a,r=0;else{const t=e/2/Math.pow(2,i),n=Cy([0,t])[1];if(r<n)r=n;else{const e=Cy([0,512-t])[1];r>e&&(r=e)}}return{width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:s,bearing:o}}(t)),t}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps;return Bf(e+Math.log2(t),r,n)}_calculateNewPitchAndBearing({deltaScaleX:t,deltaScaleY:e,startBearing:n,startPitch:r}){e=Bf(e,-1,1);const{minPitch:i,maxPitch:s}=this._viewportProps;let o=r;return e>0?o=r+e*(s-r):e<0&&(o=r-e*(i-r)),{pitch:o,bearing:n+180*t}}_getRotationParams(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[1],s=e[1],{width:o,height:a}=this._viewportProps,u=n/o;let c=0;return r>0?Math.abs(a-s)>5&&(c=r/(s-a)*1.2):r<0&&s>5&&(c=1-i/s),c=Math.min(1,Math.max(-1,c)),{deltaScaleX:u,deltaScaleY:c}}}class fw extends pv{constructor(t){t.dragMode=t.dragMode||"pan",super(dw,t)}setProps(t){const e=this.controllerStateProps;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state}))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let pw=(()=>{class t extends Q_{constructor(t){super({...t,type:qy})}get controller(){return this._getControllerProps({type:fw})}}return t.displayName="MapView",t})();const gw=new tw;class mw{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&Y_(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(t=[]){this.cleanup(),this.effects=t,this._createInternalEffects()}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(t=>t instanceof tw)||this._internalEffects.push(gw)}}class yw extends Fv{}const bw={blendFunc:[1,0,32771,0],blendEquation:32774};class _w extends Fv{render(t){t.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(t)):(this.useAlpha=!1,super.render(t))}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:i,pickingFBO:s,deviceRect:{x:o,y:a,width:u,height:c},pass:l="picking",redrawReason:h,pickZ:d}){const f=this.gl;return this.pickZ=d,vd(f,{scissorTest:!0,scissor:[o,a,u,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...bw,blend:!d},()=>{super.render({target:s,layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:i,pass:l,redrawReason:h})})}shouldDrawLayer(t){return t.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e){const n=this.pickZ?{blend:!1}:{...bw,blend:!0,blendColor:[0,0,0,this.useAlpha?(e+1)/255:1]};return{...t.props.parameters,...n}}}class vw{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new yw(t),this.pickLayersPass=new _w(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=this.layerFilter,t.effects=t.effects||[],t.target=t.target||xf.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,r=e.render({...t,target:n});this._postRender(t.effects,t),this.renderCount++,Mp("deckRenderer.renderLayers",this,r,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let n=null;for(const r of t)r.preRender(this.gl,e),r.postRender&&(n=r);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new xf(this.gl),new xf(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,r={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const i of t)if(i.postRender){if(i===this.lastPostProcessEffect){r.target=e.target,i.postRender(this.gl,r);break}const t=i.postRender(this.gl,r);r.inputBuffer=t,r.swapBuffer=t===n[0]?n[1]:n[0]}}}const ww={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function xw({pickedColors:t,layers:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){if(t){const{x:o,y:a,width:u,height:c}=s;let l=i*i,h=-1,d=0;for(let e=0;e<c;e++){const i=e+a-r,s=i*i;if(s>l)d+=4*u;else for(let e=0;e<u;e++){if(t[d+3]-1>=0){const t=e+o-n,r=t*t+s;r<=l&&(l=r,h=d)}d+=4}}if(h>=0){const n=t[h+3]-1,r=t.slice(h,h+4),i=e[n];if(i){const t=i.decodePickingColor(r),e=Math.floor(h/4/u);return{pickedColor:r,pickedLayer:i,pickedObjectIndex:t,pickedX:o+(h/4-e*u),pickedY:a+e}}Ph.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return ww}function Ew({pickInfo:t,mode:e,viewports:n,layerFilter:r,pixelRatio:i,x:s,y:o,z:a}){const u=t&&t.pickedLayer,c=function(t,e,n){for(let r=t.length-1;r>=0;r--){const i=t[r];if(i.containsPixel(e)&&(!n||n(i)))return i}return t[0]}(n,{x:s,y:o},r&&u&&(t=>r({layer:u,viewport:t,isPicking:!0,renderPass:"picking:".concat(e)}))),l=c&&c.unproject([s-c.x,o-c.y],{targetZ:a});return{color:null,layer:null,viewport:c,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:l,devicePixel:t&&[t.pickedX,t.pickedY],pixelRatio:i}}function Sw(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,u=o?[o]:[];if("hover"===r){const t=n.index,e=n.layerId,r=o&&o.props.id;if(r!==e||a!==t){if(r!==e){const t=i.find(t=>t.props.id===e);t&&u.unshift(t)}n.layerId=r,n.index=a,n.info=null}}const c=Ew(t),l=new Map;return l.set(null,c),u.forEach(t=>{let e={...c};t===o&&(e.color=s,e.index=a,e.picked=!0),e=Aw({layer:t,info:e,mode:r}),t===o&&"hover"===r&&(n.info=e),l.set(e.layer.id,e),"hover"===r&&e.layer.updateAutoHighlight(e)}),l}function Aw({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}class Tw{constructor(t){this.gl=t,this.pickingFBO=null,this.pickLayersPass=new _w(t),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:r},i=this.lastPickedInfo.info){const s=i&&i.layer&&i.layer.id,o=i&&i.viewport&&i.viewport.id,a=s?n.find(t=>t.id===s):null,u=o&&r.find(t=>t.id===o)||r[0],c=u&&u.unproject([t-u.x,e-u.y]),l={x:t,y:e,viewport:u,coordinate:c,layer:a};return a?{...i,...l}:Object.assign(l,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:t}=this;return this.pickingFBO||(this.pickingFBO=new xf(t),xf.isSupported(t,{colorBufferFloat:!0})&&(this.depthFBO=new xf(t),this.depthFBO.attach({36064:new cf(t,{format:zh(t)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.pickingFBO}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter(t=>t.isPickable()&&!t.isComposite);return e.length>255?(Ph.warn("Too many pickable layers, only picking the first 255")(),e.slice(0,255)):e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:r,y:i,radius:s=0,depth:o=1,mode:a="query",unproject3D:u,onViewportActive:c}){if(!(t=this._getPickable(t)))return{result:[],emptyInfo:Ew({viewports:n,x:r,y:i})};this._resizeBuffer();const l=wd(this.gl),h=xd(this.gl,[r,i],!0),d=[h.x+Math.floor(h.width/2),h.y+Math.floor(h.height/2)],f=Math.round(s*l),{width:p,height:g}=this.pickingFBO,m=this._getPickingRect({deviceX:d[0],deviceY:d[1],deviceRadius:f,deviceWidth:p,deviceHeight:g});let y;const b=[],_={};for(let v=0;v<o;v++){const s=xw({pickedColors:m&&this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:c,deviceRect:m,pass:"picking:".concat(a),redrawReason:a}),layers:t,deviceX:d[0],deviceY:d[1],deviceRadius:f,deviceRect:m});let h;if(s.pickedLayer&&u&&this.depthFBO&&(h=this._drawAndSample({layers:[s.pickedLayer],views:e,viewports:n,onViewportActive:c,deviceRect:{x:s.pickedX,y:s.pickedY,width:1,height:1},pass:"picking:".concat(a),redrawReason:"pick-z",pickZ:!0})[0]*n[0].distanceScales.metersPerUnit[2]+n[0].position[2]),s.pickedColor&&v+1<o){const e=s.pickedColor[3]-1;_[e]=!0,t[e].disablePickingIndex(s.pickedObjectIndex)}y=Sw({pickInfo:s,lastPickedInfo:this.lastPickedInfo,mode:a,layers:t,layerFilter:this.layerFilter,viewports:n,x:r,y:i,z:h,pixelRatio:l});for(const t of y.values())t.layer&&b.push(t);if(!s.pickedColor)break}for(const v in _)t[v].restorePickingColors();return{result:b,emptyInfo:y&&y.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:r,y:i,width:s=1,height:o=1,mode:a="query",maxObjects:u=null,onViewportActive:c}){if(!(t=this._getPickable(t)))return[];this._resizeBuffer();const l=wd(this.gl),h=xd(this.gl,[r,i],!0),d=h.x,f=h.y+h.height,p=xd(this.gl,[r+s,i+o],!0),g=p.y,m=function({pickedColors:t,layers:e}){const n=new Map;if(t)for(let r=0;r<t.length;r+=4){const i=t[r+3]-1;if(i>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const t=e[i];t?n.set(o,{pickedColor:s,pickedLayer:t,pickedObjectIndex:t.decodePickingColor(s)}):Ph.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}({pickedColors:this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:c,deviceRect:{x:d,y:g,width:p.x+p.width-d,height:f-g},pass:"picking:".concat(a),redrawReason:a}),layers:t}),y=new Map,b=Number.isFinite(u);for(let _=0;_<m.length&&!(b&&y.size>=u);_++){const t=m[_];let e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:r,y:i,width:s,height:o,pixelRatio:l};e=Aw({layer:t.pickedLayer,info:e,mode:a}),y.has(e.object)||y.set(e.object,e)}return Array.from(y.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:r,deviceRect:i,pass:s,redrawReason:o,pickZ:a}){if(t.length<1)return null;const u=a?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:r,pickingFBO:u,deviceRect:i,pass:s,redrawReason:o,pickZ:a});const{x:c,y:l,width:h,height:d}=i,f=new(a?Float32Array:Uint8Array)(h*d*4);return _f(u,{sourceX:c,sourceY:l,sourceWidth:h,sourceHeight:d,target:f}),f}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:r,deviceHeight:i}){const s=Math.max(0,t-n),o=Math.max(0,e-n),a=Math.min(r,t+n+1)-s,u=Math.min(i,e+n+1)-o;return a<=0||u<=0?null:{x:s,y:o,width:a,height:u}}}const Cw={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class Iw{constructor(t){const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Cw),e.appendChild(this.el)),this.isVisible=!1}setTooltip(t,e,n){const r=this.el;if("string"==typeof t)r.innerText=t;else{if(!t)return this.isVisible=!1,void(r.style.display="none");"text"in t&&(r.innerText=t.text),"html"in t&&(r.innerHTML=t.html),"className"in t&&(r.className=t.className),Object.assign(r.style,t.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}remove(){this.el&&this.el.remove()}}function Dw(t,e){if(!t)throw new Error(e)}const kw={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Ow=kw.global||kw.self||kw.window,Mw="object"!=typeof process||"[object process]"!==String(process)||process.browser,Pw="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:Nw}=(Pw&&parseFloat(Pw[1]),Ow),Rw="undefined"!=typeof Image,jw="undefined"!=typeof ImageBitmap,Lw=Boolean(Nw),Fw=!!Mw||Lw;const Bw=/^data:image\/svg\+xml/,zw=/\.svg((\?|#).*)?$/;function Uw(t){return t&&(Bw.test(t)||zw.test(t))}function Vw(t,e){if(Uw(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Gw(t,e,n){const r=function(t,e){if(Uw(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(e)}`}return Vw(t,e)}(t,n),i=self.URL||self.webkitURL,s="string"!=typeof r&&i.createObjectURL(r);try{return await async function(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((e,r)=>{try{n.onload=()=>e(n),n.onerror=e=>r(new Error(`Could not load image ${t}: ${e}`))}catch(i){r(i)}})}(s||r,e)}finally{s&&i.revokeObjectURL(s)}}const Hw={};let $w=!0;const qw=!1,Ww=!0;function Xw(t){const e=Kw(t);return function(t){const e=Kw(t);return e.byteLength>=24&&2303741511===e.getUint32(0,qw)?{mimeType:"image/png",width:e.getUint32(16,qw),height:e.getUint32(20,qw)}:null}(e)||function(t){const e=Kw(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,qw)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:r}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let i=2;for(;i+9<e.byteLength;){const t=e.getUint16(i,qw);if(r.has(t))return{mimeType:"image/jpeg",height:e.getUint16(i+5,qw),width:e.getUint16(i+7,qw)};if(!n.has(t))return null;i+=2,i+=e.getUint16(i,qw)}return null}(e)||function(t){const e=Kw(t);return e.byteLength>=10&&1195984440===e.getUint32(0,qw)?{mimeType:"image/gif",width:e.getUint16(6,Ww),height:e.getUint16(8,Ww)}:null}(e)||function(t){const e=Kw(t);return e.byteLength>=14&&16973===e.getUint16(0,qw)&&e.getUint32(2,Ww)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Ww),height:e.getUint32(22,Ww)}:null}(e)}function Kw(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const Zw={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,n){const r=((e=e||{}).image||{}).type||"auto",{url:i}=n||{};let s;switch(function(t){switch(t){case"auto":case"data":return function(){if(jw)return"imagebitmap";if(Rw)return"image";if(Fw)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return jw||Rw||Fw;case"imagebitmap":return jw;case"image":return Rw;case"data":return Fw;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}(t),t}}(r)){case"imagebitmap":s=await async function(t,e,n){let r;r=Uw(n)?await Gw(t,e,n):Vw(t,n);const i=e&&e.imagebitmap;return await async function(t,e=null){if(!function(t){for(const e in t||Hw)return!1;return!0}(e)&&$w||(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),$w=!1}return await createImageBitmap(t)}(r,i)}(t,e,i);break;case"image":s=await Gw(t,e,i);break;case"data":s=await function(t,e){const{mimeType:n}=Xw(t)||{},{_parseImageNode:r}=Ow;return Dw(r),r(t,n,e)}(t,e);break;default:Dw(!1)}return"data"===r&&(s=function(t){switch(function(t){const e=function(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(s)),s},tests:[t=>Boolean(Xw(new DataView(t)))],options:{image:{type:"auto",decode:!0}}},Yw={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},Qw="8.5.7",Jw=Gh.CO.deck&&Gh.CO.deck.VERSION;if(Jw&&Jw!==Qw)throw new Error("deck.gl - multiple versions detected: ".concat(Jw," vs ").concat(Qw));Jw||(Ph.log(1,"deck.gl ".concat(Qw))(),Gh.CO.deck=Object.assign(Gh.CO.deck||{},{VERSION:Qw,version:Qw,log:Ph,_registerLoggers:function(t){Op=t}}),k_([Yw,[Zw,{imagebitmap:{premultiplyAlpha:"none"}}]]));const tx=Gh.CO.deck;class ex extends Hd{static isSupported(t,e=[]){const n=zh(t),r=Df(t,Ef);let i=n||r;for(const s of e)switch(s){case"queries":i=i&&n;break;case"timers":i=i&&r;break;default:Rd(!1)}return i}constructor(t,e={}){super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:t=!1}={}){return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)}),this._pollingPromise}_createHandle(){return ex.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const nx=(0,Gh.jU)()&&"undefined"!=typeof document;let rx=0;class ix{constructor(t={}){const{onCreateContext:e=(t=>Id(t)),onAddHTML:n=null,onInitialize:r=(()=>{}),onRender:i=(()=>{}),onFinalize:s=(()=>{}),onError:o,gl:a=null,glOptions:u={},debug:c=!1,createFramebuffer:l=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:f=Nd.get("animation-loop-"+rx++)}=t;let{useDevicePixels:p=!0}=t;"useDevicePixelRatio"in t&&(Lh.deprecated("useDevicePixelRatio","useDevicePixels")(),p=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:r,onRender:i,onFinalize:s,onError:o,gl:a,glOptions:u,debug:c,createFramebuffer:l},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=f,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return Rd("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(t={}){if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=ex.isSupported(this.gl,["timers"])?new ex(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())});return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...t){return this.props.onCreateContext(...t)}onInitialize(...t){return this.props.onInitialize(...t)}onRender(...t){return this.props.onRender(...t)}onFinalize(...t){return this.props.onFinalize(...t)}getHTMLControlValue(t,e=1){const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return Lh.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=nx?new Promise((t,e)=>{nx&&"complete"===document.readyState?t(document):window.addEventListener("load",()=>{t(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(...t){this.display?this.display._renderFrame(...t):this.onRender(...t)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"==typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?Dd(this.props.gl,t):this.onCreateContext(t),!Bh(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");_d(this.gl,ed),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(t,e={}){if(t.canvas)return void function(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;r&&i||(Lh.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let n=e;const s=Math.floor(r*n),o=Math.floor(i*n);t.canvas.width=s,t.canvas.height=o,t.drawingBufferWidth===s&&t.drawingBufferHeight===o||(Lh.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*n),t.canvas.height=Math.floor(i*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}(t,function(t){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels),e);const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new xf(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var sx=n(524),ox=n.n(sx);const ax={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(e,n){for(let r=0;r<e.length;r++)if(e[r].pointerId===t.pointerId)return!0;return!1}(n)||n.push(t)),e.call(this,t)}}(ox().PointerEventInput),ox().MouseInput.prototype.handler=function(t){let e=ax[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const ux=ox().Manager,cx=ox(),lx=cx?[[cx.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[cx.Rotate,{enable:!1}],[cx.Pinch,{enable:!1}],[cx.Swipe,{enable:!1}],[cx.Pan,{threshold:0,enable:!1}],[cx.Press,{enable:!1}],[cx.Tap,{event:"doubletap",taps:2,enable:!1}],[cx.Tap,{event:"anytap",enable:!1}],[cx.Tap,{enable:!1}]]:null,hx={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},dx={doubletap:["tap"]},fx={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},px={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},gx={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},mx={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},yx="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",bx="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let _x=!1;try{const t={get passive(){return _x=!0,!0}};bx.addEventListener("test",t,t),bx.removeEventListener("test",t,t)}catch($O){}const vx=-1!==yx.indexOf("firefox"),{WHEEL_EVENTS:wx}=px,xx="wheel",Ex=4.000244140625;class Sx{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.events=wx.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(e=>t.addEventListener(e,this.handleEvent,!!_x&&{passive:!1}))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===xx&&(this.options.enable=e)}handleEvent(t){if(!this.options.enable)return;let e=t.deltaY;bx.WheelEvent&&(vx&&t.deltaMode===bx.WheelEvent.DOM_DELTA_PIXEL&&(e/=bx.devicePixelRatio),t.deltaMode===bx.WheelEvent.DOM_DELTA_LINE&&(e*=40));const n={x:t.clientX,y:t.clientY};0!==e&&e%Ex==0&&(e=Math.floor(e/Ex)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}_onWheel(t,e,n){this.callback({type:xx,center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}const{MOUSE_EVENTS:Ax}=px,Tx="pointermove",Cx="pointerover",Ix="pointerout",Dx="pointerleave";class kx{constructor(t,e,n={}){this.element=t,this.callback=e,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=Ax.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(e=>t.addEventListener(e,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===Tx&&(this.enableMoveEvent=e),t===Cx&&(this.enableOverEvent=e),t===Ix&&(this.enableOutEvent=e),t===Dx&&(this.enableLeaveEvent=e)}handleEvent(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:Cx,srcEvent:t,pointerType:"mouse",target:t.target})}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:Ix,srcEvent:t,pointerType:"mouse",target:t.target})}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:Dx,srcEvent:t,pointerType:"mouse",target:t.target})}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:Tx,srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:Ox}=px,Mx="keydown",Px="keyup";class Nx{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=Ox.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=n.tabIndex||0,t.style.outline="none",this.events.forEach(e=>t.addEventListener(e,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===Mx&&(this.enableDownEvent=e),t===Px&&(this.enableUpEvent=e)}handleEvent(t){const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:Mx,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:Px,srcEvent:t,key:t.key,target:t.target}))}}const Rx="contextmenu";class jx{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===Rx&&(this.options.enable=e)}handleEvent(t){this.options.enable&&this.callback({type:Rx,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const Lx={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},Fx={srcElement:"root",priority:0};class Bx{constructor(t){this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(t,e,n,r=!1,i=!1){const{handlers:s,handlersByElement:o}=this;n&&("object"!=typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},Fx,n):Fx;let a=o.get(n.srcElement);a||(a=[],o.set(n.srcElement,a));const u={type:t,handler:e,srcElement:n.srcElement,priority:n.priority};r&&(u.once=!0),i&&(u.passive=!0),s.push(u),this._active=this._active||!u.passive;let c=a.length-1;for(;c>=0&&!(a[c].priority>=u.priority);)c--;a.splice(c+1,0,u)}remove(t,e){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const s=n[i];if(s.type===t&&s.handler===e){n.splice(i,1);const t=r.get(s.srcElement);t.splice(t.indexOf(s),1),0===t.length&&r.delete(s.srcElement)}}this._active=n.some(t=>!t.passive)}handleEvent(t){if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const r=()=>{t.handled=!0},i=()=>{t.handled=!0,e=!0},s=[];for(let o=0;o<n.length;o++){const{type:a,handler:u,once:c}=n[o];if(u(Object.assign({},t,{type:a,stopPropagation:r,stopImmediatePropagation:i})),c&&s.push(n[o]),e)break}for(let t=0;t<s.length;t++){const{type:e,handler:n}=s[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.element;return Object.assign({},t,function(t){const e=Lx[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(n)?(s=1===i,o=2===i,a=3===i):2===e?(s=Boolean(1&n),o=Boolean(4&n),a=Boolean(2&n)):1===e&&(s=0===r,o=1===r,a=2===r),{leftButton:s,middleButton:o,rightButton:a}}(t),function(t,e){const{srcEvent:n}=t;if(!t.center&&!Number.isFinite(n.clientX))return null;const r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect();return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/(i.width/e.offsetWidth||1),y:(r.y-i.top-e.clientTop)/(i.height/e.offsetHeight||1)}}}(t,e),{handled:!1,rootElement:e})}}const zx={events:null,recognizers:null,recognizerOptions:{},Manager:ux,touchAction:"none",tabIndex:0};class Ux{constructor(t=null,e={}){this.options=Object.assign({},zx,e),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);const{events:n}=e;n&&this.on(n)}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this;this.manager=new(0,e.Manager)(t,{touchAction:e.touchAction,recognizers:e.recognizers||lx}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(hx).forEach(t=>{const e=this.manager.get(t);e&&hx[t].forEach(t=>{e.recognizeWith(t)})});for(const n in e.recognizerOptions){const t=this.manager.get(n);if(t){const r=e.recognizerOptions[n];delete r.enable,t.set(r)}}this.wheelInput=new Sx(t,this._onOtherEvent,{enable:!1}),this.moveInput=new kx(t,this._onOtherEvent,{enable:!1}),this.keyInput=new Nx(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new jx(t,this._onOtherEvent,{enable:!1});for(const[n,r]of this.events)r.isEmpty()||(this._toggleRecognizer(r.recognizerName,!0),this.manager.on(n,r.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});const i=dx[t];i&&!this.options.recognizers&&i.forEach(i=>{const s=n.get(i);e?(s.requireFailure(t),r.dropRequireFailure(i)):s.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,r,i){if("string"!=typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,r,i);return}const{manager:s,events:o}=this,a=mx[t]||t;let u=o.get(a);u||(u=new Bx(this),o.set(a,u),u.recognizerName=gx[a]||a,s&&s.on(a,u.handleEvent)),u.add(t,e,n,r,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,r=n.get(mx[t]||t);if(r&&(r.remove(t,e),r.isEmpty())){const{recognizerName:t}=r;let e=!1;for(const r of n.values())if(r.recognizerName===t&&!r.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}_onBasicInput(t){const{srcEvent:e}=t,n=fx[e.type];n&&this.manager.emit(n,t)}_onOtherEvent(t){this.manager.emit(t.type,t)}}function Vx(){}const Gx={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:Vx,onResize:Vx,onViewStateChange:Vx,onInteractionStateChange:Vx,onBeforeRender:Vx,onAfterRender:Vx,onLoad:Vx,onError:(t,e)=>Ph.error(t)(),_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",debug:!1,drawPickingColors:!1};class Hx{constructor(t){t={...Gx,...t},this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),t.viewState&&t.initialViewState&&Ph.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Gh.qs)()&&Ph.warn("IE 11 support will be deprecated in v8.0")(),t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new Md({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&Mf.setProps(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&Ph.removed("onLayerHover","onHover")(),"onLayerClick"in t&&Ph.removed("onLayerClick","onClick")(),t.initialViewState&&!Y_(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),r=this.layerManager.needsRedraw(t),i=this.effectManager.needsRedraw(t),s=this.deckRenderer.needsRedraw(t);return e=e||n||r||i||s,e}redraw(t){if(!this.layerManager)return;const e=t||this.needsRedraw({clearRedrawFlags:!0});e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}getViews(){return this.viewManager.views}getViewports(t){return this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,n){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(e).timeStart();const i=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,...n});return r.get(e).timeEnd(),i}_createCanvas(t){let e=t.canvas;return"string"==typeof e&&(e=document.getElementById(e),dp(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;let{width:e,height:n}=t;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:t,height:e}=this;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:t}=this;if(!t)return!1;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;return(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,!0)}_createAnimationLoop(t){const{width:e,height:n,gl:r,glOptions:i,debug:s,onError:o,onBeforeRender:a,onAfterRender:u,useDevicePixels:c,autoResizeDrawingBuffer:l}=t;return new ix({width:e,height:n,useDevicePixels:c,autoResizeDrawingBuffer:l,autoResizeViewport:!1,gl:r,onCreateContext:t=>Id({...i,...t,canvas:this.canvas,debug:s,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:u,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new pw({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_onPointerMove(t){const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t,e.mode="hover"}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:n}=this._pick("pickObject","pickObject Time",t);this.interactiveState.isHovering=e.length>0;let r=n,i=!1;for(const s of e)r=s,i=s.layer.onHover(s,t.event);if(!i&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,Dd(t,{enable:!0,copyState:!0})),this.tooltip=new Iw(this.canvas),_d(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new rw;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new Ux(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in jh)this.eventManager.on(r,this._onEvent);this.viewManager=new hw({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new lw(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new mw,this.deckRenderer=new vw(t),this.deckPicker=new Tw(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;_d(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Ph.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.interactiveState.isDragging=t.isDragging,this.props.onInteractionStateChange(t)}_onEvent(t){const e=jh[t.type],n=t.offsetCenter;if(!e||!n)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:s}=i,o=s&&(s[e.handler]||s.props[e.handler]),a=this.props[e.handler];let u=!1;o&&(u=o.call(s,i,t)),!u&&a&&a(i,t)}_onPointerDown(t){const e=t.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:e.x,y:e.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=Nd.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}Hx.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf(Lv)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.oneOfType([t.bool,t.number]),touchAction:t.string,eventRecognizerOptions:t.object,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onInteractionStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLoad:t.func,onError:t.func,debug:t.bool,drawPickingColors:t.bool,_framebuffer:t.object,_animate:t.bool,_pickable:t.bool,_typedArrayManagerProps:t.object}},Hx.defaultProps=Gx,Hx.VERSION=tx.VERSION;const $x={name:"project32",dependencies:[$v],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},qx="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Wx={lightSources:{}};function Xx({color:t=[0,0,0],intensity:e=1}={}){return t.map(t=>t*e/255)}const Kx={name:"lights",vs:qx,fs:qx,getUniforms:function t(e=Wx){if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:r}=e.lightSources||{};return t||n&&n.length>0||r&&r.length>0?Object.assign({},function({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};return r["lighting_uAmbientLight.color"]=t?Xx(t):[0,0,0],e.forEach((t,e)=>{r[`lighting_uPointLight[${e}].color`]=Xx(t),r[`lighting_uPointLight[${e}].position`]=t.position,r[`lighting_uPointLight[${e}].attenuation`]=t.attenuation||[1,0,0]}),r.lighting_uPointLightCount=e.length,n.forEach((t,e)=>{r[`lighting_uDirectionalLight[${e}].color`]=Xx(t),r[`lighting_uDirectionalLight[${e}].direction`]=t.direction}),r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:t,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}},Zx={},Yx={name:"phong-lighting",dependencies:[Kx],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(t=Zx){if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(t=>t/255)}}(e):{lighting_uEnabled:!1}}},Qx={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},Jx={inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(t=Qx){const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,t=>t/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}},tE={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class eE{static get DRAW_MODE(){return tE}constructor(t={}){const{id:e=Bd("geometry"),drawMode:n=tE.TRIANGLES,attributes:r={},indices:i=null,vertexCount:s=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(r,i),this.vertexCount=s||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let e=t[n];e=ArrayBuffer.isView(e)?{value:e}:e,Rd(ArrayBuffer.isView(e.value),`${this._print(n)}: must be typed array or object with value as typed array`),"POSITION"!==n&&"positions"!==n||e.size||(e.size=3),"indices"===n?(Rd(!this.indices),this.indices=e):this.attributes[n]=e}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const r in t){const e=t[r],{value:i,size:s,constant:o}=e;!o&&i&&s>=1&&(n=Math.min(n,i.length/s))}return Rd(Number.isFinite(n)),n}}const nE=Math.PI/180,rE=new Float32Array(16),iE=new Float32Array(12);function sE(t,e,n){const r=e[0]*nE,i=e[1]*nE,s=e[2]*nE,o=Math.sin(s),a=Math.sin(r),u=Math.sin(i),c=Math.cos(s),l=Math.cos(r),h=Math.cos(i),d=n[0],f=n[1],p=n[2];t[0]=d*h*l,t[1]=d*u*l,t[2]=d*-a,t[3]=f*(-u*c+h*a*o),t[4]=f*(h*c+u*a*o),t[5]=f*l*o,t[6]=p*(u*o+h*a*c),t[7]=p*(-h*o+u*a*c),t[8]=p*l*c}function oE(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const aE={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,u=Array.isArray(a),c=u&&16===a.length,l=Array.isArray(s),h=Array.isArray(i),d=Array.isArray(o),f=c||!u&&Boolean(a(r[0]));t.constant=f?c:h&&l&&d;const p=t.value;if(t.constant){let e;f?(rE.set(a),e=oE(rE)):(e=iE,sE(e,i,s),e.set(o,9)),t.value=new Float32Array(e)}else{let u=e*t.size;const{iterable:g,objectInfo:m}=gp(r,e,n);for(const t of g){let e;m.index++,f?(rE.set(c?a:a(t,m)),e=oE(rE)):(e=iE,sE(e,h?i:i(t,m),l?s:s(t,m)),e.set(d?o:o(t,m),9)),p[u++]=e[0],p[u++]=e[1],p[u++]=e[2],p[u++]=e[3],p[u++]=e[4],p[u++]=e[5],p[u++]=e[6],p[u++]=e[7],p[u++]=e[8],p[u++]=e[9],p[u++]=e[10],p[u++]=e[11]}}}};function uE(t,e){return e===Nh.CARTESIAN||e===Nh.METER_OFFSETS||e===Nh.DEFAULT&&!t.isGeospatial}function cE(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),Ph.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function lE(t,e){if(t.attributes)return cE(t.attributes,e),t instanceof eE?t:new eE(t);if(t.positions||t.POSITION)return cE(t,e),new eE({attributes:t});throw Error("Invalid mesh")}const hE={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let dE=(()=>{class t extends q_{getShaders(){const t=!zh(this.context.gl),e={};return If(this.context.gl,Af)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[$x,Yx,Jx],transpileToGLSL100:t,defines:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:aE}),this.setState({emptyTexture:new cf(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),t.mesh!==e.mesh||n.extensionsChanged){var r;if(null===(r=this.state.model)||void 0===r||r.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const e=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(e.NORMAL||e.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==e.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:e}=this.context,{sizeScale:n,coordinateSystem:r,_instanced:i}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:n,composeModelMatrix:!i||uE(e,r),flatShading:!this.state.hasNormals}).draw()}getModel(t){const e=new vm(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:lE(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:r}=this.state;return e.setUniforms({sampler:n||r,hasTexture:Boolean(n)}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;null==n||n.setUniforms({sampler:t||e,hasTexture:Boolean(t)})}}return t.layerName="SimpleMeshLayer",t.defaultProps=hE,t})();const fE={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[Kx]};class pE{constructor(t={}){const{id:e}=t;this.id=e||Bd(this.constructor.name),this.display=!0,this.position=new sp,this.rotation=new sp,this.scale=new sp(1,1,1),this.matrix=new my,this.userData={},this.props={},this._setScenegraphNodeProps(t)}delete(){}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(t){return Rd(3===t.length,"setPosition requires vector argument"),this.position=t,this}setRotation(t){return Rd(3===t.length,"setRotation requires vector argument"),this.rotation=t,this}setScale(t){return Rd(3===t.length,"setScale requires vector argument"),this.scale=t,this}setMatrix(t,e=!0){e?this.matrix.copy(t):this.matrix=t}setMatrixComponents({position:t,rotation:e,scale:n,update:r=!0}){return t&&this.setPosition(t),e&&this.setRotation(e),n&&this.setScale(n),r&&this.updateMatrix(),this}updateMatrix(){const t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}update(t={}){const{position:e,rotation:n,scale:r}=t;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(t,e){Rd(t),e=e||this.matrix;const n=new my(t).multiplyRight(e),r=n.invert(),i=r.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}_setScenegraphNodeProps(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}class gE extends pE{constructor(t={}){t=Array.isArray(t)?{children:t}:t;const{children:e=[]}=t;Lh.assert(e.every(t=>t instanceof pE),"every child must an instance of ScenegraphNode"),super(t),this.children=e}add(...t){for(const e of t)Array.isArray(e)?this.add(...e):this.children.push(e);return this}remove(t){const e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(t=>t.delete()),this.removeAll(),super.delete()}traverse(t,{worldMatrix:e=new my}={}){const n=new my(e).multiplyRight(this.matrix);for(const r of this.children)r instanceof gE?r.traverse(t,{worldMatrix:n}):t(r,{worldMatrix:n})}}function mE(){var t=new Zf(4);return Zf!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function yE(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function bE(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+o*a+i*c-s*u,t[1]=i*l+o*u+s*a-r*c,t[2]=s*l+o*c+r*u-i*a,t[3]=o*l-r*a-i*u-s*c,t}var _E,vE,wE,xE,EE=Jm,SE=(_E=Yf(),vE=Qf(1,0,0),wE=Qf(0,1,0),function(t,e,n){var r=Jf(e,n);return r<-.999999?(tp(_E,vE,e),function(t){return Math.hypot(t[0],t[1],t[2])}(_E)<1e-6&&tp(_E,wE,e),function(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s}(_E,_E),yE(t,_E,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(tp(_E,e,n),t[0]=_E[0],t[1]=_E[1],t[2]=_E[2],t[3]=1+r,function(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t}(t,t))});mE(),mE(),xE=new Zf(9),Zf!=Float32Array&&(xE[1]=0,xE[2]=0,xE[3]=0,xE[5]=0,xE[6]=0,xE[7]=0),xE[0]=1,xE[4]=1,xE[8]=1;const AE=[0,0,0,1],TE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},CE={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function IE(t){if(!t._animation){const e=CE[t.componentType],n=TE[t.type],r=n*t.count,{buffer:i,byteOffset:s}=t.bufferView.data,o=new e(i,s+(t.byteOffset||0),r);if(1===n)t._animation=Array.from(o);else{const e=[];for(let t=0;t<o.length;t+=n)e.push(Array.from(o.slice(t,t+n)));t._animation=e}}return t._animation}const DE=new my,kE=new class extends Gf{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromMatrix3(t){return function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,t[0]=(e[5]-e[7])*(n=.5/n),t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*s+s]-e[3*o+o]+1),t[i]=.5*n,t[3]=(e[3*s+o]-e[3*o+s])*(n=.5/n),t[s]=(e[3*s+i]+e[3*i+s])*n,t[o]=(e[3*o+i]+e[3*i+o])*n}}(this,t),this.check()}identity(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}fromAxisRotation(t,e){return yE(this,t,e),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=Hf(t)}get y(){return this[1]}set y(t){this[1]=Hf(t)}get z(){return this[2]}set z(t){this[2]=Hf(t)}get w(){return this[3]}set w(t){this[3]=Hf(t)}len(){return function(t){return Math.hypot(t[0],t[1],t[2],t[3])}(this)}lengthSquared(){return function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}(this)}dot(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(this,t)}rotationTo(t,e){return SE(this,t,e),this.check()}add(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return function(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3]}(this,this,t),this.check()}calculateW(){return function(t,e){var n=e[0],r=e[1],i=e[2];t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}conjugate(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=s*a}(this,this),this.check()}lerp(t,e,n){return function(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3];t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a)}(this,t,e,n),this.check()}multiplyRight(t,e){return Vf(!e),bE(this,this,t),this.check()}multiplyLeft(t,e){return Vf(!e),bE(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u+o*a,t[1]=i*u+s*a,t[2]=s*u-i*a,t[3]=o*u-r*a}(this,this,t),this.check()}rotateY(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u-s*a,t[1]=i*u+o*a,t[2]=s*u+r*a,t[3]=o*u-i*a}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u+i*a,t[1]=i*u-r*a,t[2]=s*u+o*a,t[3]=o*u-s*a}(this,this,t),this.check()}scale(t){return EE(this,this,t),this.check()}slerp(t,e,n){switch(arguments.length){case 1:({start:t=AE,target:e,ratio:n}=arguments[0]);break;case 2:[e,n]=arguments,t=this}return function(t,e,n,r){var i,s,o,a,u,c=e[0],l=e[1],h=e[2],d=e[3],f=n[0],p=n[1],g=n[2],m=n[3];(s=c*f+l*p+h*g+d*m)<0&&(s=-s,f=-f,p=-p,g=-g,m=-m),1-s>Kf?(i=Math.acos(s),o=Math.sin(i),a=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(a=1-r,u=r),t[0]=a*c+u*f,t[1]=a*l+u*p,t[2]=a*h+u*g,t[3]=a*d+u*m}(this,t,e,n),this.check()}transformVector4(t,e=t){return function(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],u=n[2],c=n[3],l=c*r+a*s-u*i,h=c*i+u*r-o*s,d=c*s+o*i-a*r,f=-o*r-a*i-u*s;t[0]=l*c+f*-o+h*-u-d*-a,t[1]=h*c+f*-a+d*-o-l*-u,t[2]=d*c+f*-u+l*-a-h*-o,t[3]=e[3]}(e,t,this),$f(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t,e){return this.multiplyLeft(t,e)}multiply(t,e){return this.multiplyRight(t,e)}};class OE{constructor(t){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}animate(t){if(!this.playing)return;const e=(t/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:t,target:n,path:r})=>{(function(t,{input:e,interpolation:n,output:r},i,s){const o=t%e[e.length-1],a=e.findIndex(t=>t>=o),u=Math.max(0,a-1);if(!Array.isArray(i[s]))switch(s){case"translation":i[s]=[0,0,0];break;case"rotation":i[s]=[0,0,0,1];break;case"scale":i[s]=[1,1,1];break;default:Lh.warn(`Bad animation path ${s}`)()}Rd(i[s].length===r[u].length);const c=e[u],l=e[a];switch(n){case"STEP":!function(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}(i,s,r[u]);break;case"LINEAR":l>c&&function(t,e,n,r,i){if("rotation"===e){kE.slerp({start:n,target:r,ratio:i});for(let n=0;n<kE.length;n++)t[e][n]=kE[n]}else for(let s=0;s<n.length;s++)t[e][s]=i*r[s]+(1-i)*n[s]}(i,s,r[u],r[a],(o-c)/(l-c));break;case"CUBICSPLINE":l>c&&function(t,e,{p0:n,outTangent0:r,inTangent1:i,p1:s,tDiff:o,ratio:a}){for(let u=0;u<t[e].length;u++){const c=r[u]*o,l=i[u]*o;t[e][u]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*n[u]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[u]+(Math.pow(a,3)-Math.pow(a,2))*l}}(i,s,{p0:r[3*u+1],outTangent0:r[3*u+2],inTangent1:r[3*a+0],p1:r[3*a+1],tDiff:l-c,ratio:(o-c)/(l-c)});break;default:Lh.warn(`Interpolation ${n} not supported`)()}})(e,t,n,r),function(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=DE.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}(n,n._node)})}}class ME{constructor(t){this.animations=t.animations.map((e,n)=>{const r=e.name||`Animation-${n}`,i=e.samplers.map(({input:e,interpolation:n="LINEAR",output:r})=>({input:IE(t.accessors[e]),interpolation:n,output:IE(t.accessors[r])})),s=e.channels.map(({sampler:e,target:n})=>({sampler:i[e],target:t.nodes[n.node],path:n.path}));return new OE({name:r,channels:s})})}animate(t){this.setTime(t)}setTime(t){this.animations.forEach(e=>e.animate(t))}getAnimations(){return this.animations}}class PE extends pE{constructor(t,e={}){super(e),this.onBeforeRender=null,this.AfterRender=null,t instanceof vm?(this.model=t,this._setModelNodeProps(e)):this.model=new vm(t,e),this.managedResources=e.managedResources||[]}setProps(t){return super.setProps(t),this._setModelNodeProps(t),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(t=>t.delete()),this.managedResources=[]}draw(...t){return this.model.draw(...t)}setUniforms(...t){return this.model.setUniforms(...t),this}setAttributes(...t){return this.model.setAttributes(...t),this}updateModuleSettings(...t){return this.model.updateModuleSettings(...t),this}_setModelNodeProps(t){this.model.setProps(t)}}class NE{constructor(t,{attributes:e,material:n,pbrDebug:r,imageBasedLightingEnvironment:i,lights:s,useTangents:o}){this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},If(t,Tf)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],i&&(this.uniforms.u_DiffuseEnvSampler=i.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=i.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=i.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(e.NORMAL,"HAS_NORMALS"),this.defineIfPresent(e.TANGENT&&o,"HAS_TANGENTS"),this.defineIfPresent(e.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(i,"USE_IBL"),this.defineIfPresent(s,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),n&&this.parseMaterial(n)}defineIfPresent(t,e){t&&(this.defines[e]=1)}parseTexture(t,e,n=null){const r=t.texture.source.image;let i,s={};r.compressed?(i=r,s={[this.gl.TEXTURE_MIN_FILTER]:r.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):i={data:r};const o=new cf(this.gl,{id:t.name||t.id,parameters:{...t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},...s},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...i});this.uniforms[e]=o,this.defineIfPresent(n,n),this.generatedTextures.push(o)}parsePbrMetallicRoughness(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:e=1,roughnessFactor:n=1}=t;this.uniforms.u_MetallicRoughnessValues=[e,n]}parseMaterial(t){if(this.uniforms.pbr_uUnlit=Boolean(t.unlit),t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:e=1}=t.normalTexture;this.uniforms.u_NormalScale=e}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:e=1}=t.occlusionTexture;this.uniforms.u_OcclusionStrength=e}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),"MASK"===t.alphaMode){const{alphaCutoff:e=.5}=t;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=e}else"BLEND"===t.alphaMode&&(Lh.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function RE(t,e){return zh(t)?`#version 300 es\n${e}`:e}const jE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},LE={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class FE{constructor(t,e={}){this.gl=t,this.options=Object.assign({},LE,e)}instantiate(t){return this.gltf=t,(t.scenes||[]).map(t=>this.createScene(t))}createAnimator(){return Array.isArray(this.gltf.animations)?new ME(this.gltf):null}createScene(t){const e=(t.nodes||[]).map(t=>this.createNode(t));return new gE({id:t.name||t.id,children:e})}createNode(t){if(!t._node){const e=(t.children||[]).map(t=>this.createNode(t));t.mesh&&e.push(this.createMesh(t.mesh));const n=new gE({id:t.name||t.id,children:e});if(t.matrix)n.setMatrix(t.matrix);else{if(n.matrix.identity(),t.translation&&n.matrix.translate(t.translation),t.rotation){const e=(new my).fromQuaternion(t.rotation);n.matrix.multiplyRight(e)}t.scale&&n.matrix.scale(t.scale)}t._node=n}return t._node}createMesh(t){if(!t._mesh){const e=(t.primitives||[]).map((e,n)=>this.createPrimitive(e,n,t)),n=new gE({id:t.name||t.id,children:e});t._mesh=n}return t._mesh}getVertexCount(t){Lh.warn("getVertexCount() not found")()}createPrimitive(t,e,n){return function(t,e){const{id:n,drawMode:r,vertexCount:i,attributes:s,modelOptions:o}=e,a=new NE(t,e);Lh.info(4,"createGLTFModel defines: ",a.defines)();const u=[];u.push(...a.generatedTextures),u.push(...Object.values(s).map(t=>t.buffer));const c=new PE(t,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[fE],defines:a.defines,parameters:a.parameters,vs:RE(t,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:RE(t,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:u},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:t.name||`${n.name||n.id}-primitive-${e}`,drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options))}createAttributes(t,e){const n={};return Object.keys(t).forEach(e=>{n[e]=this.createAccessor(t[e],this.createBuffer(t[e],this.gl.ARRAY_BUFFER))}),e&&(n.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),Lh.info(4,"glTF Attributes",{attributes:t,indices:e,generated:n})(),n}createBuffer(t,e){t.bufferView||(t.bufferView={});const{bufferView:n}=t;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new ef(this.gl,{id:`from-${n.id}`,data:n.data||t.value,target:e})),n.lumaBuffers[e]}createAccessor(t,e){return new Yd({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:jE[t.type]})}createSampler(t){return t}needsPOT(){return!1}}function BE(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}function zE(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function UE(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const n=e.baseUri||e.uri;if(!n)throw new Error(`'baseUri' must be provided to resolve relative url ${t}`);return n.substr(0,n.lastIndexOf("/")+1)+t}const VE={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class GE{constructor(t,e){Wb(this,"fields",void 0),Wb(this,"metadata",void 0),function(t,e){if(!t)throw new Error("loader assertion failed.")}(Array.isArray(t)),function(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}(t),this.fields=t,this.metadata=e||new Map}compareTo(t){if(this.metadata!==t.metadata)return!1;if(this.fields.length!==t.fields.length)return!1;for(let e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}select(...t){const e=Object.create(null);for(const r of t)e[r]=!0;const n=this.fields.filter(t=>e[t.name]);return new GE(n,this.metadata)}selectAt(...t){const e=t.map(t=>this.fields[t]).filter(Boolean);return new GE(e,this.metadata)}assign(t){let e,n=this.metadata;if(t instanceof GE){const r=t;e=r.fields,n=HE(HE(new Map,this.metadata),r.metadata)}else e=t;const r=Object.create(null);for(const s of this.fields)r[s.name]=s;for(const s of e)r[s.name]=s;const i=Object.values(r);return new GE(i,n)}}function HE(t,e){return new Map([...t||new Map,...e||new Map])}let $E,qE,WE,XE,KE,ZE,YE,QE;var JE;(JE=$E||($E={}))[JE.NONE=0]="NONE",JE[JE.Null=1]="Null",JE[JE.Int=2]="Int",JE[JE.Float=3]="Float",JE[JE.Binary=4]="Binary",JE[JE.Utf8=5]="Utf8",JE[JE.Bool=6]="Bool",JE[JE.Decimal=7]="Decimal",JE[JE.Date=8]="Date",JE[JE.Time=9]="Time",JE[JE.Timestamp=10]="Timestamp",JE[JE.Interval=11]="Interval",JE[JE.List=12]="List",JE[JE.Struct=13]="Struct",JE[JE.Union=14]="Union",JE[JE.FixedSizeBinary=15]="FixedSizeBinary",JE[JE.FixedSizeList=16]="FixedSizeList",JE[JE.Map=17]="Map",JE[JE.Dictionary=-1]="Dictionary",JE[JE.Int8=-2]="Int8",JE[JE.Int16=-3]="Int16",JE[JE.Int32=-4]="Int32",JE[JE.Int64=-5]="Int64",JE[JE.Uint8=-6]="Uint8",JE[JE.Uint16=-7]="Uint16",JE[JE.Uint32=-8]="Uint32",JE[JE.Uint64=-9]="Uint64",JE[JE.Float16=-10]="Float16",JE[JE.Float32=-11]="Float32",JE[JE.Float64=-12]="Float64",JE[JE.DateDay=-13]="DateDay",JE[JE.DateMillisecond=-14]="DateMillisecond",JE[JE.TimestampSecond=-15]="TimestampSecond",JE[JE.TimestampMillisecond=-16]="TimestampMillisecond",JE[JE.TimestampMicrosecond=-17]="TimestampMicrosecond",JE[JE.TimestampNanosecond=-18]="TimestampNanosecond",JE[JE.TimeSecond=-19]="TimeSecond",JE[JE.TimeMillisecond=-20]="TimeMillisecond",JE[JE.TimeMicrosecond=-21]="TimeMicrosecond",JE[JE.TimeNanosecond=-22]="TimeNanosecond",JE[JE.DenseUnion=-23]="DenseUnion",JE[JE.SparseUnion=-24]="SparseUnion",JE[JE.IntervalDayTime=-25]="IntervalDayTime",JE[JE.IntervalYearMonth=-26]="IntervalYearMonth";class tS{static isNull(t){return t&&t.typeId===$E.Null}static isInt(t){return t&&t.typeId===$E.Int}static isFloat(t){return t&&t.typeId===$E.Float}static isBinary(t){return t&&t.typeId===$E.Binary}static isUtf8(t){return t&&t.typeId===$E.Utf8}static isBool(t){return t&&t.typeId===$E.Bool}static isDecimal(t){return t&&t.typeId===$E.Decimal}static isDate(t){return t&&t.typeId===$E.Date}static isTime(t){return t&&t.typeId===$E.Time}static isTimestamp(t){return t&&t.typeId===$E.Timestamp}static isInterval(t){return t&&t.typeId===$E.Interval}static isList(t){return t&&t.typeId===$E.List}static isStruct(t){return t&&t.typeId===$E.Struct}static isUnion(t){return t&&t.typeId===$E.Union}static isFixedSizeBinary(t){return t&&t.typeId===$E.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===$E.FixedSizeList}static isMap(t){return t&&t.typeId===$E.Map}static isDictionary(t){return t&&t.typeId===$E.Dictionary}get typeId(){return $E.NONE}compareTo(t){return this===t}}Symbol,Symbol,qE=Symbol.toStringTag;class eS extends tS{constructor(t,e){super(),Wb(this,"isSigned",void 0),Wb(this,"bitWidth",void 0),this.isSigned=t,this.bitWidth=e}get typeId(){return $E.Int}get[qE](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class nS extends eS{constructor(){super(!0,8)}}class rS extends eS{constructor(){super(!0,16)}}class iS extends eS{constructor(){super(!0,32)}}class sS extends eS{constructor(){super(!1,8)}}class oS extends eS{constructor(){super(!1,16)}}class aS extends eS{constructor(){super(!1,32)}}WE=Symbol.toStringTag;class uS extends tS{constructor(t){super(),Wb(this,"precision",void 0),this.precision=t}get typeId(){return $E.Float}get[WE](){return"Float"}toString(){return`Float${this.precision}`}}class cS extends uS{constructor(){super(32)}}class lS extends uS{constructor(){super(64)}}Symbol,Symbol,XE=Symbol.toStringTag,KE=Symbol.toStringTag,ZE=Symbol.toStringTag,YE=Symbol.toStringTag,QE=Symbol.toStringTag;class hS extends tS{constructor(t,e){super(),Wb(this,"listSize",void 0),Wb(this,"children",void 0),this.listSize=t,this.children=[e]}get typeId(){return $E.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[QE](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class dS{constructor(t,e,n=!1,r=new Map){Wb(this,"name",void 0),Wb(this,"type",void 0),Wb(this,"nullable",void 0),Wb(this,"metadata",void 0),this.name=t,this.type=e,this.nullable=n,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new dS(this.name,this.type,this.nullable,this.metadata)}compareTo(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function fS(t,e,n){const r=n?pS(n.metadata):void 0,i=function(t){switch(t.constructor){case Int8Array:return new nS;case Uint8Array:return new sS;case Int16Array:return new rS;case Uint16Array:return new oS;case Int32Array:return new iS;case Uint32Array:return new aS;case Float32Array:return new cS;case Float64Array:return new lS;default:throw new Error("array type not supported")}}(e.value);return new dS(t,new hS(e.size,new dS("value",i)),!1,r)}function pS(t){const e=new Map;for(const n in t)e.set(`${n}.string`,JSON.stringify(t[n]));return e}const gS={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},mS={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class yS{constructor(t){Wb(this,"draco",void 0),Wb(this,"decoder",void 0),Wb(this,"metadataQuerier",void 0),this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t,e={}){const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);const r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let t;switch(r){case this.draco.TRIANGULAR_MESH:t=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:t=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!t.ok()||!i.ptr){const e=`DRACO decompression failed: ${t.error_msg()}`;throw new Error(e)}const s=this._getDracoLoaderData(i,r,e),o=this._getMeshData(i,s,e),a=function(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;const a=t.POSITION?t.POSITION.value:[],u=a&&a.length;for(let c=0;c<u;c+=3){const t=a[c],u=a[c+1],l=a[c+2];e=t<e?t:e,n=u<n?u:n,r=l<r?l:r,i=t>i?t:i,s=u>s?u:s,o=l>o?l:o}return[[e,n,r],[i,s,o]]}(o.attributes),u=function(t,e,n){const r=pS(e.metadata),i=[],s=function(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}(e.attributes);for(const o in t){const e=fS(o,t[o],s[o]);i.push(e)}if(n){const t=fS("indices",n);i.push(t)}return new GE(i,r)}(o.attributes,s,o.indices);return{loader:"draco",loaderData:s,header:{vertexCount:i.num_points(),boundingBox:a},...o,schema:u}}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}_getDracoLoaderData(t,e,n){const r=this._getTopLevelMetadata(t),i=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:r,attributes:i}}_getDracoAttributes(t,e){const n={};for(let r=0;r<t.num_attributes();r++){const i=this.decoder.GetAttribute(t,r),s=this._getAttributeMetadata(t,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:s};const o=this._getQuantizationTransform(i,e);o&&(n[i.unique_id()].quantization_transform=o);const a=this._getOctahedronTransform(i,e);a&&(n[i.unique_id()].octahedron_transform=a)}return n}_getMeshData(t,e,n){const r=this._getMeshAttributes(e,t,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(t,e,n){const r={};for(const i of Object.values(t.attributes)){const t=this._deduceAttributeName(i,n);i.name=t;const{value:s,size:o}=this._getAttributeValues(e,i);r[t]={value:s,size:o,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}return r}_getTriangleListIndices(t){const e=3*t.num_faces(),n=4*e,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(t,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,e).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(t){const e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(e)}finally{this.draco.destroy(e)}}_getAttributeValues(t,e){const n=mS[e.data_type],r=e.num_components,i=t.num_points()*r,s=i*n.BYTES_PER_ELEMENT,o=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}(this.draco,n);let a;const u=this.draco._malloc(s);try{const r=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,r,o,s,u),a=new n(this.draco.HEAPF32.buffer,u,i).slice()}finally{this.draco._free(u)}return{value:a,size:r}}_deduceAttributeName(t,e){const n=t.unique_id;for(const[s,o]of Object.entries(e.extraAttributes||{}))if(o===n)return s;const r=t.attribute_type;for(const s in gS)if(this.draco[s]===r)return gS[s];const i=e.attributeNameEntry||"name";return t.metadata[i]?t.metadata[i].string:`CUSTOM_ATTRIBUTE_${n}`}_getTopLevelMetadata(t){const e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}_getAttributeMetadata(t,e){const n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const e={},n=this.metadataQuerier.NumEntries(t);for(let r=0;r<n;r++){const n=this.metadataQuerier.GetEntryName(t,r);e[n]=this._getDracoMetadataField(t,n)}return e}_getDracoMetadataField(t,e){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);const r=function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:r}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){const{quantizedAttributes:e=[],octahedronAttributes:n=[]}=t,r=[...e,...n];for(const i of r)this.decoder.SkipAttributeTransform(this.draco[i])}_getQuantizationTransform(t,e){const{quantizedAttributes:n=[]}=e,r=t.attribute_type();if(n.map(t=>this.decoder[t]).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits(),range:e.range(),min_values:new Float32Array([1,2,3]).map(t=>e.min_value(t))}}finally{this.draco.destroy(e)}}return null}_getOctahedronTransform(t,e){const{octahedronAttributes:n=[]}=e,r=t.attribute_type();if(n.map(t=>this.decoder[t]).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits()}}finally{this.draco.destroy(e)}}return null}}var bS=n(125);const _S={};async function vS(t,e=null,n={}){return e&&(t=function(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:a_?n.CDN?(i_(n.CDN.startsWith("http")),`${n.CDN}/${e}@3.0.12/dist/libs/${t}`):u_?`../src/libs/${t}`:`modules/${e}/src/libs/${t}`:`modules/${e}/dist/libs/${t}`}(t,e,n)),_S[t]=_S[t]||async function(t){if(t.endsWith("wasm")){const e=await fetch(t);return await e.arrayBuffer()}if(!a_)return bS.requireFromFile&&await bS.requireFromFile(t);if(u_)return importScripts(t);const e=await fetch(t);return function(t,e){if(!a_)return bS.requireFromString&&bS.requireFromString(t,e);if(u_)return eval.call(o_,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch(r){n.text=t}return document.body.appendChild(n),null}(await e.text(),t)}(t),await _S[t]}let wS;const xS={...VE,parse:async function(t,e){const{draco:n}=await async function(t){const e=t.modules||{};return wS=e.draco3d?wS||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):wS||async function(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await vS("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js","draco",t);break;case"wasm":default:[e,n]=await Promise.all([await vS("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js","draco",t),await vS("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm","draco",t)])}return e=e||globalThis.DracoDecoderModule,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(e=>{t({...n,onModuleLoaded:t=>e({draco:t})})})}(e,n)}(t),await wS}(e),r=new yS(n);try{return r.parseSync(t,null==e?void 0:e.draco)}finally{r.destroy()}}};function ES(t,e){return kb(t>=0),kb(e>0),t+(e-1)&~(e-1)}function SS(t,e,n){let r;return r=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer||t.arrayBuffer,t.byteOffset,t.byteLength),e.set(r,n),n+ES(r.byteLength,4)}const AS=["SCALAR","VEC2","VEC3","VEC4"],TS=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],CS=new Map(TS),IS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},DS={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},kS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function OS(t){return AS[t-1]||AS[0]}function MS(t){const e=CS.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function PS(t,e){const n=kS[t.componentType],r=IS[t.type],i=t.count*r,s=t.count*r*DS[t.componentType];return zE(s>=0&&s<=e.byteLength),{ArrayType:n,length:i,byteLength:s}}const NS={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class RS{constructor(t){Wb(this,"gltf",void 0),Wb(this,"sourceBuffers",void 0),Wb(this,"byteLength",void 0),this.gltf=t||{json:{...NS},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){return this.getUsedExtensions().find(e=>e===t)?(this.json.extensions||{})[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find(e=>e===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error(`glTF file error: Could not find ${t}[${e}]`);return n}getTypedArrayForBufferView(t){t=this.getBufferView(t);const e=this.gltf.buffers[t.buffer];return zE(e),new Uint8Array(e.arrayBuffer,(t.byteOffset||0)+e.byteOffset,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,{ArrayType:r,length:i}=PS(t,e);return new r(n,e.byteOffset+t.byteOffset,i)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer);return new Uint8Array(n.data,e.byteOffset||0,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}setObjectExtension(t,e,n){(t.extensions||{})[e]=n}removeObjectExtension(t,e){const n=t.extensions||{},r=n[e];return delete n[e],r}addExtension(t,e={}){return zE(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t,e={}){return zE(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(e=>e===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(e=>e===t)||this.json.extensionsRequired.push(t)}removeExtension(t){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t]}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:e}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}addNode(t){const{meshIndex:e,matrix:n}=t;this.json.nodes=this.json.nodes||[];const r={mesh:e};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(t){const{attributes:e,indices:n,material:r,mode:i=4}=t,s={primitives:[{attributes:this._addAttributes(e),mode:i}]};if(n){const t=this._addIndices(n);s.primitives[0].indices=t}return Number.isFinite(r)&&(s.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(s),this.json.meshes.length-1}addPointCloud(t){const e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}addImage(t,e){const n=Xw(t),r=e||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(t),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}addBufferView(t){const e=t.byteLength;zE(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=ES(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:OS(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t,e={size:3}){const n=this.addBufferView(t);let r={min:e.min,max:e.max};r.min&&r.max||(r=this._getAccessorMinMax(t,e.size));const i={size:e.size,componentType:MS(t),count:Math.round(t.length/e.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,e))}addTexture(t){const{imageIndex:e}=t,n={source:e};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,e;this.gltf.buffers=[];const n=this.byteLength,r=new ArrayBuffer(n),i=new Uint8Array(r);let s=0;for(const o of this.sourceBuffers||[])s=SS(o,i,s);null!==(t=this.json)&&void 0!==t&&null!==(e=t.buffers)&&void 0!==e&&e[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(t,e){let n=!0;for(;n;){const r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}_addAttributes(t={}){const e={};for(const n in t){const r=t[n],i=this._getGltfAttributeName(n),s=this.addBinaryBuffer(r.value,r);e[i]=s}return e}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,e){const n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];const r=t.subarray(0,e);for(const i of r)n.min.push(i),n.max.push(i);for(let i=e;i<t.length;i+=e)for(let r=0;r<e;r++)n.min[0+r]=Math.min(n.min[0+r],t[i+r]),n.max[0+r]=Math.max(n.max[0+r],t[i+r]);return n}}const jS="KHR_binary_glTF",LS="KHR_draco_mesh_compression",FS="KHR_lights_punctual",BS="KHR_materials_unlit",zS="KHR_techniques_webgl";function US(t){const{buffer:e,size:n,count:r}=function(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=function(t,e,n=!1){return t?Array.isArray(t)?new e(t):!n||t instanceof e?t:new e(t):null}(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}(t);return{value:e,size:n,byteOffset:0,count:r,type:OS(n),componentType:MS(e)}}async function VS(t,e,n){var r;if(null==e||null===(r=e.gltf)||void 0===r||!r.decompressMeshes)return;const i=new RS(t),s=[];for(const o of function*(t){for(const e of t.json.meshes||[])for(const t of e.primitives)yield t}(i))i.getObjectExtension(o,LS)&&s.push(HS(i,o,e,n));await Promise.all(s),i.removeExtension(LS)}function GS(t,e={}){const n=new RS(t);for(const r of n.json.meshes||[])$S(r),n.addRequiredExtension(LS)}async function HS(t,e,n,r){const i=t.getObjectExtension(e,LS);if(!i)return;const s=t.getTypedArrayForBufferView(i.bufferView),o=A_(s.buffer,s.byteOffset),{parse:a}=r,u={...n};delete u["3d-tiles"];const c=await a(o,xS,u,r),l=function(t){const e={};for(const n in t){const r=t[n];if("indices"!==n){const t=US(r);e[n]=t}}return e}(c.attributes);for(const[h,d]of Object.entries(l))if(h in e.attributes){const n=t.getAccessor(e.attributes[h]);null!=n&&n.min&&null!=n&&n.max&&(d.min=n.min,d.max=n.max)}e.attributes=l,c.indices&&(e.indices=US(c.indices)),function(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(e)}function $S(t,e,n=4,r,i){var s;if(!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=r.DracoWriter.encodeSync({attributes:t}),a=null==i||null===(s=i.parseSync)||void 0===s?void 0:s.call(i,{attributes:t}),u=r._addFauxAttributes(a.attributes),c=r.addBufferView(o);return{primitives:[{attributes:u,mode:n,extensions:{[LS]:{bufferView:c,attributes:u}}}]}}async function qS(t){const e=new RS(t),{json:n}=e;e.removeExtension(BS);for(const r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,BS)}function WS(t){const e=new RS(t),{json:n}=e;if(e.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,BS,{}),e.addExtension(BS))}async function XS(t){const e=new RS(t),{json:n}=e,r=e.getExtension(FS);r&&(e.json.lights=r.lights,e.removeExtension(FS));for(const i of n.nodes||[]){const t=e.getObjectExtension(i,FS);t&&(i.light=t.light),e.removeObjectExtension(i,FS)}}async function KS(t){const e=new RS(t),{json:n}=e;if(n.lights){const t=e.addExtension(FS);zE(!t.lights),t.lights=n.lights,delete n.lights}if(e.json.lights){for(const t of e.json.lights)e.addObjectExtension(t.node,FS,t);delete e.json.lights}}async function ZS(t){const e=new RS(t),{json:n}=e,r=e.getExtension(zS);if(r){const t=function(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,s=new TextDecoder;return r.forEach(t=>{if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=s.decode(e.getTypedArrayForBufferView(t.bufferView))}),n.forEach(t=>{t.fragmentShader=r[t.fragmentShader],t.vertexShader=r[t.vertexShader]}),i.forEach(t=>{t.program=n[t.program]}),i}(r,e);for(const r of n.materials||[]){const n=e.getObjectExtension(r,zS);n&&(r.technique=Object.assign({},n,t[n.technique]),r.technique.values=QS(r.technique,e)),e.removeObjectExtension(r,zS)}e.removeExtension(zS)}}async function YS(t,e){}function QS(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(e=>{t.uniforms[e].value&&!(e in n)&&(n[e]=t.uniforms[e].value)}),Object.keys(n).forEach(t=>{"object"==typeof n[t]&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))}),n}const JS={KHR_draco_mesh_compression:r,KHR_materials_unlit:i,KHR_lights_punctual:s,KHR_techniques_webgl:o},tA={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},eA={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class nA{constructor(t){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(t,e){this.json=t.json;const n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${n.asset.version}`)}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(t){const e=new RS(t),{json:n}=e;for(const r of n.images||[]){const t=e.removeObjectExtension(r,jS);t&&Object.assign(r,t)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(jS)}(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in tA)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const n=t[e];if(n&&!Array.isArray(n)){t[e]=[];for(const r in n){const i=n[r];i.id=i.id||r;const s=t[e].length;t[e].push(i),this.idToIndexMap[e][r]=s}}}_convertObjectIdsToArrayIndices(t){for(const e in tA)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:t,indices:n,material:r}=e;for(const e in t)t[e]=this._convertIdToIndex(t[e],"accessor");n&&(e.indices=this._convertIdToIndex(n,"accessor")),r&&(e.material=this._convertIdToIndex(r,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map(t=>this._convertIdToIndex(t,"node"))),t.meshes&&(t.meshes=t.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(t,e){t[e]||(console.warn(`gltf v1: json doesn't contain attribute ${e}`),t[e]=[]);for(const n of t[e])for(const t in n){const e=this._convertIdToIndex(n[t],t);n[t]=e}}_convertIdToIndex(t,e){const n=eA[e];if(n in this.idToIndexMap){const r=this.idToIndexMap[n][t];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${e} with id ${t}`);return r}return t}_updateObjects(t){for(const e of this.json.buffers)delete e.type}_updateMaterial(t){for(const e of t.materials){e.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const n=e.values&&e.values.tex,r=t.textures.findIndex(t=>t.id===n);-1!==r&&(e.pbrMetallicRoughness.baseColorTexture={index:r})}}}const rA={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},iA={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},sA={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},oA={magFilter:sA.TEXTURE_MAG_FILTER,minFilter:sA.TEXTURE_MIN_FILTER,wrapS:sA.TEXTURE_WRAP_S,wrapT:sA.TEXTURE_WRAP_T},aA={[sA.TEXTURE_MAG_FILTER]:sA.LINEAR,[sA.TEXTURE_MIN_FILTER]:sA.NEAREST_MIPMAP_LINEAR,[sA.TEXTURE_WRAP_S]:sA.REPEAT,[sA.TEXTURE_WRAP_]:sA.REPEAT};class uA{postProcess(t,e={}){const{json:n,buffers:r=[],images:i=[],baseUri:s=""}=t;return zE(n),this.baseUri=s,this.json=n,this.buffers=r,this.images=i,this._resolveTree(this.json,e),this.json}_resolveTree(t,e={}){t.bufferViews&&(t.bufferViews=t.bufferViews.map((t,e)=>this._resolveBufferView(t,e))),t.images&&(t.images=t.images.map((t,e)=>this._resolveImage(t,e))),t.samplers&&(t.samplers=t.samplers.map((t,e)=>this._resolveSampler(t,e))),t.textures&&(t.textures=t.textures.map((t,e)=>this._resolveTexture(t,e))),t.accessors&&(t.accessors=t.accessors.map((t,e)=>this._resolveAccessor(t,e))),t.materials&&(t.materials=t.materials.map((t,e)=>this._resolveMaterial(t,e))),t.meshes&&(t.meshes=t.meshes.map((t,e)=>this._resolveMesh(t,e))),t.nodes&&(t.nodes=t.nodes.map((t,e)=>this._resolveNode(t,e))),t.skins&&(t.skins=t.skins.map((t,e)=>this._resolveSkin(t,e))),t.scenes&&(t.scenes=t.scenes.map((t,e)=>this._resolveScene(t,e))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];return n||console.warn(`glTF file error: Could not find ${t}[${e}]`),n}_resolveScene(t,e){return t.id=t.id||`scene-${e}`,t.nodes=(t.nodes||[]).map(t=>this.getNode(t)),t}_resolveNode(t,e){return t.id=t.id||`node-${e}`,t.children&&(t.children=t.children.map(t=>this.getNode(t))),void 0!==t.mesh?t.mesh=this.getMesh(t.mesh):void 0!==t.meshes&&t.meshes.length&&(t.mesh=t.meshes.reduce((t,e)=>{const n=this.getMesh(e);return t.id=n.id,t.primitives=t.primitives.concat(n.primitives),t},{primitives:[]})),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||`skin-${e}`,t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||`mesh-${e}`,t.primitives&&(t.primitives=t.primitives.map(t=>{const e=(t={...t}).attributes;t.attributes={};for(const n in e)t.attributes[n]=this.getAccessor(e[n]);return void 0!==t.indices&&(t.indices=this.getAccessor(t.indices)),void 0!==t.material&&(t.material=this.getMaterial(t.material)),t})),t}_resolveMaterial(t,e){if(t.id=t.id||`material-${e}`,t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const e=t.pbrMetallicRoughness;e.baseColorTexture&&(e.baseColorTexture={...e.baseColorTexture},e.baseColorTexture.texture=this.getTexture(e.baseColorTexture.index)),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture={...e.metallicRoughnessTexture},e.metallicRoughnessTexture.texture=this.getTexture(e.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){if(t.id=t.id||`accessor-${e}`,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=iA[t.componentType],t.components=rA[t.type],t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const e=t.bufferView.buffer,{ArrayType:n,byteLength:r}=PS(t,t.bufferView),i=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+e.byteOffset,s=e.arrayBuffer.slice(i,i+r);t.value=new n(s)}return t}_resolveTexture(t,e){return t.id=t.id||`texture-${e}`,t.sampler="sampler"in t?this.getSampler(t.sampler):aA,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||`sampler-${e}`,t.parameters={};for(const n in t){const e=this._enumSamplerParameter(n);void 0!==e&&(t.parameters[e]=t[n])}return t}_enumSamplerParameter(t){return oA[t]}_resolveImage(t,e){t.id=t.id||`image-${e}`,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));const n=this.images[e];return n&&(t.image=n),t}_resolveBufferView(t,e){t.id=t.id||`bufferView-${e}`;const n=t.buffer;t.buffer=this.buffers[n];let r=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(r+=t.byteOffset),t.data=new Uint8Array(this.buffers[n].arrayBuffer,r,t.byteLength),t}_resolveCamera(t,e){return t.id=t.id||`camera-${e}`,t}}const cA=1735152710,lA=!0;function hA(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),s=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(s),ES(r,4)}function dA(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),ES(r,4)}async function fA(t,e,n,r,i){const{fetch:s,parse:o}=i;let a;if(e.uri){const t=UE(e.uri,r),n=await s(t);a=await n.arrayBuffer()}if(Number.isFinite(e.bufferView)){const n=function(t,e,n){const r=t.bufferViews[n];zE(r);const i=e[r.buffer];return zE(i),new Uint8Array(i.arrayBuffer,(r.byteOffset||0)+i.byteOffset,r.byteLength)}(t.json,t.buffers,e.bufferView);a=A_(n.buffer,n.byteOffset,n.byteLength)}zE(a,"glTF image has no data");const u=await o(a,Zw,{},i);t.images[n]=u}const pA={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(t,e={},n){(e={...pA.options,...e}).gltf={...pA.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await async function(t,e,n=0,r,i){var s,o,a,u;!function(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!function(t,e=0,n={}){const r=new DataView(t),{magic:i=cA}=n,s=r.getUint32(e,!1);return s===i||s===cA}(e,n,r)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)t.json=function(t){try{return JSON.parse(t)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?BE(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?BE(t,0,e):""}(t)}"`)}}(e);else if(e instanceof ArrayBuffer){const i={};n=function(t,e,n=0,r={}){const i=new DataView(e),s=function(t,e=0){return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}(i,n+0),o=i.getUint32(n+4,lA),a=i.getUint32(n+8,lA);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),n+=12,t.version){case 1:return function(t,e,n){kb(t.header.byteLength>20);const r=e.getUint32(n+0,lA),i=e.getUint32(n+4,lA);return n+=8,kb(0===i),hA(t,e,n,r),(n+=r)+dA(t,e,n,t.header.byteLength)}(t,i,n);case 2:return function(t,e,n,r){return kb(t.header.byteLength>20),function(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,lA),s=e.getUint32(n+4,lA);switch(n+=8,s){case 1313821514:hA(t,e,n,i);break;case 5130562:dA(t,e,n,i);break;case 0:r.strict||hA(t,e,n,i);break;case 1:r.strict||dA(t,e,n,i)}n+=ES(i,4)}}(t,e,n,{}),n+t.header.byteLength}(t,i,n);default:throw new Error(`Invalid GLB version ${t.version}. Only supports v1 and v2.`)}}(i,e,n,r.glb),zE("glTF"===i.type,`Invalid GLB magic string ${i.type}`),t._glb=i,t.json=i.json}else zE(!1,"GLTF: must be ArrayBuffer or string");if(t.buffers=new Array((t.json.buffers||[]).length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:e}=t._glb;t.buffers[0]={arrayBuffer:e[0].arrayBuffer,byteOffset:e[0].byteOffset,byteLength:e[0].byteLength}}t.images=new Array((t.json.images||[]).length).fill({})}(t,e,n,r),function(t,e={}){(new nA).normalize(t,e)}(t,{normalize:null==r||null===(s=r.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=r&&null!==(o=r.gltf)&&void 0!==o&&o.loadBuffers&&t.json.buffers&&await async function(t,e,n){for(let s=0;s<t.json.buffers.length;++s){const o=t.json.buffers[s];if(o.uri){var r,i;const{fetch:a}=n;zE(a);const u=UE(o.uri,e),c=await(null==n||null===(r=n.fetch)||void 0===r?void 0:r.call(n,u)),l=await(null==c||null===(i=c.arrayBuffer)||void 0===i?void 0:i.call(c));t.buffers[s]={arrayBuffer:l,byteOffset:0,byteLength:l.byteLength},delete o.uri}}}(t,r,i),null!=r&&null!==(a=r.gltf)&&void 0!==a&&a.loadImages){const e=async function(t,e,n){const r=t.json.images||[],i=[];for(let s=0;s<r.length;++s)i.push(fA(t,r[s],s,e,n));return await Promise.all(i)}(t,r,i);c.push(e)}const l=async function(t,e={},n){for(const i in JS){var r;const s=(null==e||null===(r=e.gltf)||void 0===r?void 0:r.excludeExtensions)||{};if(!(i in s)||s[i]){const r=JS[i];await r.decode(t,e,n)}}}(t,r,i);return c.push(l),await Promise.all(c),null!=r&&null!==(u=r.gltf)&&void 0!==u&&u.postProcess?function(t,e){return(new uA).postProcess(t,e)}(t,r):t}({},t,r,e,n)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}},gA=[255,255,255,255],mA={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?"object"==typeof t.scene?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:gA},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[pA]};let yA=(()=>{class t extends q_{getShaders(){const t=[$x,Jx];return"pbr"===this.props._lighting&&t.push(fE),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:gA,transition:!0},instanceModelMatrix:aE})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.scenegraph!==n.scenegraph?this._updateScenegraph(e):e._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:e}=this.context;let n=null;if(t.scenegraph instanceof pE)n={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const r=t.scenegraph,i=function(t,e,n){const r=new FE(t,n);return{scenes:r.instantiate(e),animator:r.createAnimator()}}(e,r,this._getModelOptions());n={gltf:r,...i},async function(t){const e=[];return t.scenes.forEach(t=>{t.traverse(t=>{Object.values(t.model.getUniforms()).forEach(t=>{!1===t.loaded&&e.push(t)})})}),await async function(t){for(;e.some(t=>!t.loaded);)await new Promise(t=>requestAnimationFrame(t))}()}(i).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(Ph.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=t.scenegraph);const r={layer:this,gl:e},i=t.getScene(n,r),s=t.getAnimator(n,r);i instanceof pE?(this._deleteScenegraph(),this._applyAllAttributes(i),this._applyAnimationsProp(i,s,t._animations),this.setState({scenegraph:i,animator:s})):null!==i&&Ph.warn("invalid scenegraph:",i)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const e=this.getAttributeManager().getAttributes();t.traverse(t=>{this._setModelAttributes(t.model,e)})}}_applyAnimationsProp(t,e,n){if(!t||!e||!n)return;const r=e.getAnimations();Object.keys(n).sort().forEach(t=>{const e=n[t];if("*"===t)r.forEach(t=>{Object.assign(t,e)});else if(Number.isFinite(Number(t))){const n=Number(t);n>=0&&n<r.length?Object.assign(r[n],e):Ph.warn("animation ".concat(t," not found"))()}else{const n=r.find(({name:e})=>e===t);n?Object.assign(n,e):Ph.warn("animation ".concat(t," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof pE&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let e=null;return t&&(e="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:{isInstanced:!0,transpileToGLSL100:!zh(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(e=>{this._setModelAttributes(e.model,t)})}draw({moduleParameters:t=null,parameters:e={},context:n}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(n.timeline.getTime()),this.setNeedsRedraw());const{viewport:r}=this.context,{sizeScale:i,sizeMinPixels:s,sizeMaxPixels:o,opacity:a,coordinateSystem:u}=this.props,c=this.getNumInstances();this.state.scenegraph.traverse((n,{worldMatrix:l})=>{n.model.setInstanceCount(c),n.updateModuleSettings(t),n.draw({parameters:e,uniforms:{sizeScale:i,opacity:a,sizeMinPixels:s,sizeMaxPixels:o,composeModelMatrix:uE(r,u),sceneModelMatrix:l,u_Camera:n.model.getUniforms().project_uCameraPosition}})})}}return t.layerName="ScenegraphLayer",t.defaultProps=mA,t})();const bA=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),_A=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),vA=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),wA=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),xA={POSITION:{size:3,value:new Float32Array(_A)},NORMAL:{size:3,value:new Float32Array(vA)},TEXCOORD_0:{size:2,value:new Float32Array(wA)}};class EA extends eE{constructor(t={}){const{id:e=Bd("cube-geometry")}=t;super({...t,id:e,indices:{size:1,value:new Uint16Array(bA)},attributes:{...xA,...t.attributes}})}}class SA{constructor(t=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=t}identity(){const t=this.elements;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1}setZero(){const t=this.elements;t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0}setTrace(t){const e=this.elements;e[0]=t.x,e[4]=t.y,e[8]=t.z}getTrace(t=new TA){const e=this.elements;return t.x=e[0],t.y=e[4],t.z=e[8],t}vmult(t,e=new TA){const n=this.elements,r=t.x,i=t.y,s=t.z;return e.x=n[0]*r+n[1]*i+n[2]*s,e.y=n[3]*r+n[4]*i+n[5]*s,e.z=n[6]*r+n[7]*i+n[8]*s,e}smult(t){for(let e=0;e<this.elements.length;e++)this.elements[e]*=t}mmult(t,e=new SA){const n=this.elements,r=t.elements,i=e.elements,s=n[0],o=n[1],a=n[2],u=n[3],c=n[4],l=n[5],h=n[6],d=n[7],f=n[8],p=r[0],g=r[1],m=r[2],y=r[3],b=r[4],_=r[5],v=r[6],w=r[7],x=r[8];return i[0]=s*p+o*y+a*v,i[1]=s*g+o*b+a*w,i[2]=s*m+o*_+a*x,i[3]=u*p+c*y+l*v,i[4]=u*g+c*b+l*w,i[5]=u*m+c*_+l*x,i[6]=h*p+d*y+f*v,i[7]=h*g+d*b+f*w,i[8]=h*m+d*_+f*x,e}scale(t,e=new SA){const n=this.elements,r=e.elements;for(let i=0;3!==i;i++)r[3*i+0]=t.x*n[3*i+0],r[3*i+1]=t.y*n[3*i+1],r[3*i+2]=t.z*n[3*i+2];return e}solve(t,e=new TA){const n=[];let r,i;for(r=0;r<12;r++)n.push(0);for(r=0;r<3;r++)for(i=0;i<3;i++)n[r+4*i]=this.elements[r+3*i];n[3]=t.x,n[7]=t.y,n[11]=t.z;let s=3;const o=s;let a,u;do{if(r=o-s,0===n[r+4*r])for(i=r+1;i<o;i++)if(0!==n[r+4*i]){a=4;do{u=4-a,n[u+4*r]+=n[u+4*i]}while(--a);break}if(0!==n[r+4*r])for(i=r+1;i<o;i++){const t=n[r+4*i]/n[r+4*r];a=4;do{u=4-a,n[u+4*i]=u<=r?0:n[u+4*i]-n[u+4*r]*t}while(--a)}}while(--s);if(e.z=n[11]/n[10],e.y=(n[7]-n[6]*e.z)/n[5],e.x=(n[3]-n[2]*e.z-n[1]*e.y)/n[0],isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||e.x===1/0||e.y===1/0||e.z===1/0)throw"Could not solve equation! Got x=["+e.toString()+"], b=["+t.toString()+"], A=["+this.toString()+"]";return e}e(t,e,n){if(void 0===n)return this.elements[e+3*t];this.elements[e+3*t]=n}copy(t){for(let e=0;e<t.elements.length;e++)this.elements[e]=t.elements[e];return this}toString(){let t="";for(let e=0;e<9;e++)t+=this.elements[e]+",";return t}reverse(t=new SA){const e=AA;let n,r;for(n=0;n<3;n++)for(r=0;r<3;r++)e[n+6*r]=this.elements[n+3*r];e[3]=1,e[9]=0,e[15]=0,e[4]=0,e[10]=1,e[16]=0,e[5]=0,e[11]=0,e[17]=1;let i=3;const s=i;let o,a;do{if(n=s-i,0===e[n+6*n])for(r=n+1;r<s;r++)if(0!==e[n+6*r]){o=6;do{a=6-o,e[a+6*n]+=e[a+6*r]}while(--o);break}if(0!==e[n+6*n])for(r=n+1;r<s;r++){const t=e[n+6*r]/e[n+6*n];o=6;do{a=6-o,e[a+6*r]=a<=n?0:e[a+6*r]-e[a+6*n]*t}while(--o)}}while(--i);n=2;do{r=n-1;do{const t=e[n+6*r]/e[n+6*n];o=6;do{a=6-o,e[a+6*r]=e[a+6*r]-e[a+6*n]*t}while(--o)}while(r--)}while(--n);n=2;do{const t=1/e[n+6*n];o=6;do{a=6-o,e[a+6*n]=e[a+6*n]*t}while(--o)}while(n--);n=2;do{r=2;do{if(a=e[3+r+6*n],isNaN(a)||a===1/0)throw"Could not reverse! A=["+this.toString()+"]";t.e(n,r,a)}while(r--)}while(n--);return t}setRotationFromQuaternion(t){const e=t.x,n=t.y,r=t.z,i=t.w,s=e+e,o=n+n,a=r+r,u=e*s,c=e*o,l=e*a,h=n*o,d=n*a,f=r*a,p=i*s,g=i*o,m=i*a,y=this.elements;return y[0]=1-(h+f),y[1]=c-m,y[2]=l+g,y[3]=c+m,y[4]=1-(u+f),y[5]=d-p,y[6]=l-g,y[7]=d+p,y[8]=1-(u+h),this}transpose(t=new SA){const e=this.elements,n=t.elements;let r;return n[0]=e[0],n[4]=e[4],n[8]=e[8],r=e[1],n[1]=e[3],n[3]=r,r=e[2],n[2]=e[6],n[6]=r,r=e[5],n[5]=e[7],n[7]=r,t}}const AA=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class TA{constructor(t=0,e=0,n=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=t,this.y=e,this.z=n}cross(t,e=new TA){const n=t.x,r=t.y,i=t.z,s=this.x,o=this.y,a=this.z;return e.x=o*i-a*r,e.y=a*n-s*i,e.z=s*r-o*n,e}set(t,e,n){return this.x=t,this.y=e,this.z=n,this}setZero(){this.x=this.y=this.z=0}vadd(t,e){if(!e)return new TA(this.x+t.x,this.y+t.y,this.z+t.z);e.x=t.x+this.x,e.y=t.y+this.y,e.z=t.z+this.z}vsub(t,e){if(!e)return new TA(this.x-t.x,this.y-t.y,this.z-t.z);e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z}crossmat(){return new SA([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const t=this.x,e=this.y,n=this.z,r=Math.sqrt(t*t+e*e+n*n);if(r>0){const t=1/r;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return r}unit(t=new TA){const e=this.x,n=this.y,r=this.z;let i=Math.sqrt(e*e+n*n+r*r);return i>0?(i=1/i,t.x=e*i,t.y=n*i,t.z=r*i):(t.x=1,t.y=0,t.z=0),t}length(){const t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)}lengthSquared(){return this.dot(this)}distanceTo(t){const e=this.x,n=this.y,r=this.z,i=t.x,s=t.y,o=t.z;return Math.sqrt((i-e)*(i-e)+(s-n)*(s-n)+(o-r)*(o-r))}distanceSquared(t){const e=this.x,n=this.y,r=this.z,i=t.x,s=t.y,o=t.z;return(i-e)*(i-e)+(s-n)*(s-n)+(o-r)*(o-r)}scale(t,e=new TA){const n=this.y,r=this.z;return e.x=t*this.x,e.y=t*n,e.z=t*r,e}vmul(t,e=new TA){return e.x=t.x*this.x,e.y=t.y*this.y,e.z=t.z*this.z,e}addScaledVector(t,e,n=new TA){return n.x=this.x+t*e.x,n.y=this.y+t*e.y,n.z=this.z+t*e.z,n}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(t=new TA){return t.x=-this.x,t.y=-this.y,t.z=-this.z,t}tangents(t,e){const n=this.length();if(n>0){const r=CA,i=1/n;r.set(this.x*i,this.y*i,this.z*i);const s=IA;Math.abs(r.x)<.9?(s.set(1,0,0),r.cross(s,t)):(s.set(0,1,0),r.cross(s,t)),r.cross(t,e)}else t.set(1,0,0),e.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}lerp(t,e,n){const r=this.x,i=this.y,s=this.z;n.x=r+(t.x-r)*e,n.y=i+(t.y-i)*e,n.z=s+(t.z-s)*e}almostEquals(t,e=1e-6){return!(Math.abs(this.x-t.x)>e||Math.abs(this.y-t.y)>e||Math.abs(this.z-t.z)>e)}almostZero(t=1e-6){return!(Math.abs(this.x)>t||Math.abs(this.y)>t||Math.abs(this.z)>t)}isAntiparallelTo(t,e){return this.negate(DA),DA.almostEquals(t,e)}clone(){return new TA(this.x,this.y,this.z)}}TA.ZERO=void 0,TA.UNIT_X=void 0,TA.UNIT_Y=void 0,TA.UNIT_Z=void 0,TA.ZERO=new TA(0,0,0),TA.UNIT_X=new TA(1,0,0),TA.UNIT_Y=new TA(0,1,0),TA.UNIT_Z=new TA(0,0,1);const CA=new TA,IA=new TA,DA=new TA;class kA{constructor(t={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new TA,this.upperBound=new TA,t.lowerBound&&this.lowerBound.copy(t.lowerBound),t.upperBound&&this.upperBound.copy(t.upperBound)}setFromPoints(t,e,n,r){const i=this.lowerBound,s=this.upperBound,o=n;i.copy(t[0]),o&&o.vmult(i,i),s.copy(i);for(let a=1;a<t.length;a++){let e=t[a];o&&(o.vmult(e,OA),e=OA),e.x>s.x&&(s.x=e.x),e.x<i.x&&(i.x=e.x),e.y>s.y&&(s.y=e.y),e.y<i.y&&(i.y=e.y),e.z>s.z&&(s.z=e.z),e.z<i.z&&(i.z=e.z)}return e&&(e.vadd(i,i),e.vadd(s,s)),r&&(i.x-=r,i.y-=r,i.z-=r,s.x+=r,s.y+=r,s.z+=r),this}copy(t){return this.lowerBound.copy(t.lowerBound),this.upperBound.copy(t.upperBound),this}clone(){return(new kA).copy(this)}extend(t){this.lowerBound.x=Math.min(this.lowerBound.x,t.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,t.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,t.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,t.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,t.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,t.upperBound.z)}overlaps(t){const e=this.lowerBound,n=this.upperBound,r=t.lowerBound,i=t.upperBound;return(r.x<=n.x&&n.x<=i.x||e.x<=i.x&&i.x<=n.x)&&(r.y<=n.y&&n.y<=i.y||e.y<=i.y&&i.y<=n.y)&&(r.z<=n.z&&n.z<=i.z||e.z<=i.z&&i.z<=n.z)}volume(){const t=this.lowerBound,e=this.upperBound;return(e.x-t.x)*(e.y-t.y)*(e.z-t.z)}contains(t){const e=this.lowerBound,n=this.upperBound,r=t.lowerBound,i=t.upperBound;return e.x<=r.x&&n.x>=i.x&&e.y<=r.y&&n.y>=i.y&&e.z<=r.z&&n.z>=i.z}getCorners(t,e,n,r,i,s,o,a){const u=this.lowerBound,c=this.upperBound;t.copy(u),e.set(c.x,u.y,u.z),n.set(c.x,c.y,u.z),r.set(u.x,c.y,c.z),i.set(c.x,u.y,c.z),s.set(u.x,c.y,u.z),o.set(u.x,u.y,c.z),a.copy(c)}toLocalFrame(t,e){const n=MA;this.getCorners(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);for(let r=0;8!==r;r++){const e=n[r];t.pointToLocal(e,e)}return e.setFromPoints(n)}toWorldFrame(t,e){const n=MA;this.getCorners(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);for(let r=0;8!==r;r++){const e=n[r];t.pointToWorld(e,e)}return e.setFromPoints(n)}overlapsRay(t){const{direction:e,from:n}=t,r=1/e.x,i=1/e.y,s=1/e.z,o=(this.lowerBound.x-n.x)*r,a=(this.upperBound.x-n.x)*r,u=(this.lowerBound.y-n.y)*i,c=(this.upperBound.y-n.y)*i,l=(this.lowerBound.z-n.z)*s,h=(this.upperBound.z-n.z)*s,d=Math.max(Math.max(Math.min(o,a),Math.min(u,c)),Math.min(l,h)),f=Math.min(Math.min(Math.max(o,a),Math.max(u,c)),Math.max(l,h));return!(f<0||d>f)}}const OA=new TA,MA=[new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA];class PA{constructor(t=0,e=0,n=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=t,this.y=e,this.z=n,this.w=r}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(t,e){const n=Math.sin(.5*e);return this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this.w=Math.cos(.5*e),this}toAxisAngle(t=new TA){this.normalize();const e=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(t.x=this.x,t.y=this.y,t.z=this.z):(t.x=this.x/n,t.y=this.y/n,t.z=this.z/n),[t,e]}setFromVectors(t,e){if(t.isAntiparallelTo(e)){const e=NA;t.tangents(e,RA),this.setFromAxisAngle(e,Math.PI)}else{const n=t.cross(e);this.x=n.x,this.y=n.y,this.z=n.z,this.w=Math.sqrt(t.length()**2*e.length()**2)+t.dot(e),this.normalize()}return this}mult(t,e=new PA){const n=this.x,r=this.y,i=this.z,s=this.w,o=t.x,a=t.y,u=t.z,c=t.w;return e.x=n*c+s*o+r*u-i*a,e.y=r*c+s*a+i*o-n*u,e.z=i*c+s*u+n*a-r*o,e.w=s*c-n*o-r*a-i*u,e}inverse(t=new PA){const e=this.x,n=this.y,r=this.z,i=this.w;this.conjugate(t);const s=1/(e*e+n*n+r*r+i*i);return t.x*=s,t.y*=s,t.z*=s,t.w*=s,t}conjugate(t=new PA){return t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=this.w,t}normalize(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}normalizeFast(){const t=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}vmult(t,e=new TA){const n=t.x,r=t.y,i=t.z,s=this.x,o=this.y,a=this.z,u=this.w,c=u*n+o*i-a*r,l=u*r+a*n-s*i,h=u*i+s*r-o*n,d=-s*n-o*r-a*i;return e.x=c*u+d*-s+l*-a-h*-o,e.y=l*u+d*-o+h*-s-c*-a,e.z=h*u+d*-a+c*-o-l*-s,e}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}toEuler(t,e="YZX"){let n,r,i;const s=this.x,o=this.y,a=this.z,u=this.w;switch(e){case"YZX":const t=s*o+a*u;if(t>.499&&(n=2*Math.atan2(s,u),r=Math.PI/2,i=0),t<-.499&&(n=-2*Math.atan2(s,u),r=-Math.PI/2,i=0),void 0===n){const e=s*s,c=a*a;n=Math.atan2(2*o*u-2*s*a,1-o*o*2-2*c),r=Math.asin(2*t),i=Math.atan2(2*s*u-2*o*a,1-2*e-2*c)}break;default:throw new Error("Euler order "+e+" not supported yet.")}t.y=n,t.z=r,t.x=i}setFromEuler(t,e,n,r="XYZ"){const i=Math.cos(t/2),s=Math.cos(e/2),o=Math.cos(n/2),a=Math.sin(t/2),u=Math.sin(e/2),c=Math.sin(n/2);return"XYZ"===r?(this.x=a*s*o+i*u*c,this.y=i*u*o-a*s*c,this.z=i*s*c+a*u*o,this.w=i*s*o-a*u*c):"YXZ"===r?(this.x=a*s*o+i*u*c,this.y=i*u*o-a*s*c,this.z=i*s*c-a*u*o,this.w=i*s*o+a*u*c):"ZXY"===r?(this.x=a*s*o-i*u*c,this.y=i*u*o+a*s*c,this.z=i*s*c+a*u*o,this.w=i*s*o-a*u*c):"ZYX"===r?(this.x=a*s*o-i*u*c,this.y=i*u*o+a*s*c,this.z=i*s*c-a*u*o,this.w=i*s*o+a*u*c):"YZX"===r?(this.x=a*s*o+i*u*c,this.y=i*u*o+a*s*c,this.z=i*s*c-a*u*o,this.w=i*s*o-a*u*c):"XZY"===r&&(this.x=a*s*o-i*u*c,this.y=i*u*o-a*s*c,this.z=i*s*c+a*u*o,this.w=i*s*o+a*u*c),this}clone(){return new PA(this.x,this.y,this.z,this.w)}slerp(t,e,n=new PA){const r=this.x,i=this.y,s=this.z,o=this.w;let a,u,c,l,h,d=t.x,f=t.y,p=t.z,g=t.w;return u=r*d+i*f+s*p+o*g,u<0&&(u=-u,d=-d,f=-f,p=-p,g=-g),1-u>1e-6?(a=Math.acos(u),c=Math.sin(a),l=Math.sin((1-e)*a)/c,h=Math.sin(e*a)/c):(l=1-e,h=e),n.x=l*r+h*d,n.y=l*i+h*f,n.z=l*s+h*p,n.w=l*o+h*g,n}integrate(t,e,n,r=new PA){const i=t.x*n.x,s=t.y*n.y,o=t.z*n.z,a=this.x,u=this.y,c=this.z,l=this.w,h=.5*e;return r.x+=h*(i*l+s*c-o*u),r.y+=h*(s*l+o*a-i*c),r.z+=h*(o*l+i*u-s*a),r.w+=h*(-i*a-s*u-o*c),r}}const NA=new TA,RA=new TA,jA={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let LA=(()=>{class t{constructor(e={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=t.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=!e.collisionResponse||e.collisionResponse,this.collisionFilterGroup=void 0!==e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask=void 0!==e.collisionFilterMask?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,e){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,e,n,r){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return t.idCounter=0,t.types=jA,t})();class FA{constructor(t={}){this.position=void 0,this.quaternion=void 0,this.position=new TA,this.quaternion=new PA,t.position&&this.position.copy(t.position),t.quaternion&&this.quaternion.copy(t.quaternion)}pointToLocal(t,e){return FA.pointToLocalFrame(this.position,this.quaternion,t,e)}pointToWorld(t,e){return FA.pointToWorldFrame(this.position,this.quaternion,t,e)}vectorToWorldFrame(t,e=new TA){return this.quaternion.vmult(t,e),e}static pointToLocalFrame(t,e,n,r=new TA){return n.vsub(t,r),e.conjugate(BA),BA.vmult(r,r),r}static pointToWorldFrame(t,e,n,r=new TA){return e.vmult(n,r),r.vadd(t,r),r}static vectorToWorldFrame(t,e,n=new TA){return t.vmult(e,n),n}static vectorToLocalFrame(t,e,n,r=new TA){return e.w*=-1,e.vmult(n,r),e.w*=-1,r}}const BA=new PA;class zA extends LA{constructor(t={}){const{vertices:e=[],faces:n=[],normals:r=[],axes:i,boundingSphereRadius:s}=t;super({type:LA.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=e,this.faces=n,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),s?this.boundingSphereRadius=s:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=i?i.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const t=this.faces,e=this.vertices,n=this.uniqueEdges;n.length=0;const r=new TA;for(let i=0;i!==t.length;i++){const s=t[i],o=s.length;for(let t=0;t!==o;t++){e[s[t]].vsub(e[s[(t+1)%o]],r),r.normalize();let i=!1;for(let t=0;t!==n.length;t++)if(n[t].almostEquals(r)||n[t].almostEquals(r)){i=!0;break}i||n.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let t=0;t<this.faces.length;t++){for(let n=0;n<this.faces[t].length;n++)if(!this.vertices[this.faces[t][n]])throw new Error("Vertex "+this.faces[t][n]+" not found!");const e=this.faceNormals[t]||new TA;if(this.getFaceNormal(t,e),e.negate(e),this.faceNormals[t]=e,e.dot(this.vertices[this.faces[t][0]])<0){console.error(".faceNormals["+t+"] = Vec3("+e.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let e=0;e<this.faces[t].length;e++)console.warn(".vertices["+this.faces[t][e]+"] = Vec3("+this.vertices[this.faces[t][e]].toString()+")")}}}getFaceNormal(t,e){const n=this.faces[t];zA.computeNormal(this.vertices[n[0]],this.vertices[n[1]],this.vertices[n[2]],e)}static computeNormal(t,e,n,r){const i=new TA,s=new TA;e.vsub(t,s),n.vsub(e,i),i.cross(s,r),r.isZero()||r.normalize()}clipAgainstHull(t,e,n,r,i,s,o,a,u){const c=new TA;let l=-1,h=-Number.MAX_VALUE;for(let f=0;f<n.faces.length;f++){c.copy(n.faceNormals[f]),i.vmult(c,c);const t=c.dot(s);t>h&&(h=t,l=f)}const d=[];for(let f=0;f<n.faces[l].length;f++){const t=n.vertices[n.faces[l][f]],e=new TA;e.copy(t),i.vmult(e,e),r.vadd(e,e),d.push(e)}l>=0&&this.clipFaceAgainstHull(s,t,e,d,o,a,u)}findSeparatingAxis(t,e,n,r,i,s,o,a){const u=new TA,c=new TA,l=new TA,h=new TA,d=new TA,f=new TA;let p=Number.MAX_VALUE;const g=this;if(g.uniqueAxes)for(let m=0;m!==g.uniqueAxes.length;m++){n.vmult(g.uniqueAxes[m],u);const o=g.testSepAxis(u,t,e,n,r,i);if(!1===o)return!1;o<p&&(p=o,s.copy(u))}else{const a=o?o.length:g.faces.length;for(let c=0;c<a;c++){u.copy(g.faceNormals[o?o[c]:c]),n.vmult(u,u);const a=g.testSepAxis(u,t,e,n,r,i);if(!1===a)return!1;a<p&&(p=a,s.copy(u))}}if(t.uniqueAxes)for(let m=0;m!==t.uniqueAxes.length;m++){i.vmult(t.uniqueAxes[m],c);const o=g.testSepAxis(c,t,e,n,r,i);if(!1===o)return!1;o<p&&(p=o,s.copy(c))}else{const o=a?a.length:t.faces.length;for(let u=0;u<o;u++){c.copy(t.faceNormals[a?a[u]:u]),i.vmult(c,c);const o=g.testSepAxis(c,t,e,n,r,i);if(!1===o)return!1;o<p&&(p=o,s.copy(c))}}for(let m=0;m!==g.uniqueEdges.length;m++){n.vmult(g.uniqueEdges[m],h);for(let o=0;o!==t.uniqueEdges.length;o++)if(i.vmult(t.uniqueEdges[o],d),h.cross(d,f),!f.almostZero()){f.normalize();const o=g.testSepAxis(f,t,e,n,r,i);if(!1===o)return!1;o<p&&(p=o,s.copy(f))}}return r.vsub(e,l),l.dot(s)>0&&s.negate(s),!0}testSepAxis(t,e,n,r,i,s){zA.project(this,t,n,r,UA),zA.project(e,t,i,s,VA);const o=UA[0],a=UA[1],u=VA[0],c=VA[1];if(o<c||u<a)return!1;const l=o-c,h=u-a;return l<h?l:h}calculateLocalInertia(t,e){const n=new TA,r=new TA;this.computeLocalAABB(r,n);const i=n.x-r.x,s=n.y-r.y,o=n.z-r.z;e.x=1/12*t*(2*s*2*s+2*o*2*o),e.y=1/12*t*(2*i*2*i+2*o*2*o),e.z=1/12*t*(2*s*2*s+2*i*2*i)}getPlaneConstantOfFace(t){return-this.faceNormals[t].dot(this.vertices[this.faces[t][0]])}clipFaceAgainstHull(t,e,n,r,i,s,o){const a=new TA,u=new TA,c=new TA,l=new TA,h=new TA,d=new TA,f=new TA,p=new TA,g=this,m=r,y=[];let b=-1,_=Number.MAX_VALUE;for(let S=0;S<g.faces.length;S++){a.copy(g.faceNormals[S]),n.vmult(a,a);const e=a.dot(t);e<_&&(_=e,b=S)}if(b<0)return;const v=g.faces[b];v.connectedFaces=[];for(let S=0;S<g.faces.length;S++)for(let t=0;t<g.faces[S].length;t++)-1!==v.indexOf(g.faces[S][t])&&S!==b&&-1===v.connectedFaces.indexOf(S)&&v.connectedFaces.push(S);const w=v.length;for(let S=0;S<w;S++){const t=g.vertices[v[S]];t.vsub(g.vertices[v[(S+1)%w]],u),c.copy(u),n.vmult(c,c),e.vadd(c,c),l.copy(this.faceNormals[b]),n.vmult(l,l),e.vadd(l,l),c.cross(l,h),h.negate(h),d.copy(t),n.vmult(d,d),e.vadd(d,d);const r=v.connectedFaces[S];f.copy(this.faceNormals[r]);const i=this.getPlaneConstantOfFace(r);p.copy(f),n.vmult(p,p);const s=i-p.dot(e);for(this.clipFaceAgainstPlane(m,y,p,s);m.length;)m.shift();for(;y.length;)m.push(y.shift())}f.copy(this.faceNormals[b]);const x=this.getPlaneConstantOfFace(b);p.copy(f),n.vmult(p,p);const E=x-p.dot(e);for(let S=0;S<m.length;S++){let t=p.dot(m[S])+E;if(t<=i&&(console.log("clamped: depth="+t+" to minDist="+i),t=i),t<=s){const e=m[S];t<=1e-6&&o.push({point:e,normal:p,depth:t})}}}clipFaceAgainstPlane(t,e,n,r){let i,s;const o=t.length;if(o<2)return e;let a=t[t.length-1],u=t[0];i=n.dot(a)+r;for(let c=0;c<o;c++){if(u=t[c],s=n.dot(u)+r,i<0)if(s<0){const t=new TA;t.copy(u),e.push(t)}else{const t=new TA;a.lerp(u,i/(i-s),t),e.push(t)}else if(s<0){const t=new TA;a.lerp(u,i/(i-s),t),e.push(t),e.push(u)}a=u,i=s}return e}computeWorldVertices(t,e){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new TA);const n=this.vertices,r=this.worldVertices;for(let i=0;i!==this.vertices.length;i++)e.vmult(n[i],r[i]),t.vadd(r[i],r[i]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(t,e){const n=this.vertices;t.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const i=n[r];i.x<t.x?t.x=i.x:i.x>e.x&&(e.x=i.x),i.y<t.y?t.y=i.y:i.y>e.y&&(e.y=i.y),i.z<t.z?t.z=i.z:i.z>e.z&&(e.z=i.z)}}computeWorldFaceNormals(t){const e=this.faceNormals.length;for(;this.worldFaceNormals.length<e;)this.worldFaceNormals.push(new TA);const n=this.faceNormals,r=this.worldFaceNormals;for(let i=0;i!==e;i++)t.vmult(n[i],r[i]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let t=0;const e=this.vertices;for(let n=0;n!==e.length;n++){const r=e[n].lengthSquared();r>t&&(t=r)}this.boundingSphereRadius=Math.sqrt(t)}calculateWorldAABB(t,e,n,r){const i=this.vertices;let s,o,a,u,c,l,h=new TA;for(let d=0;d<i.length;d++){h.copy(i[d]),e.vmult(h,h),t.vadd(h,h);const n=h;(void 0===s||n.x<s)&&(s=n.x),(void 0===u||n.x>u)&&(u=n.x),(void 0===o||n.y<o)&&(o=n.y),(void 0===c||n.y>c)&&(c=n.y),(void 0===a||n.z<a)&&(a=n.z),(void 0===l||n.z>l)&&(l=n.z)}n.set(s,o,a),r.set(u,c,l)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(t=new TA){const e=this.vertices;for(let n=0;n<e.length;n++)t.vadd(e[n],t);return t.scale(1/e.length,t),t}transformAllPoints(t,e){const n=this.vertices.length,r=this.vertices;if(e){for(let t=0;t<n;t++){const n=r[t];e.vmult(n,n)}for(let t=0;t<this.faceNormals.length;t++){const n=this.faceNormals[t];e.vmult(n,n)}}if(t)for(let i=0;i<n;i++){const e=r[i];e.vadd(t,e)}}pointIsInside(t){const e=this.vertices,n=this.faces,r=this.faceNormals,i=new TA;this.getAveragePointLocal(i);for(let s=0;s<this.faces.length;s++){let o=r[s];const a=e[n[s][0]],u=new TA;t.vsub(a,u);const c=o.dot(u),l=new TA;i.vsub(a,l);const h=o.dot(l);if(c<0&&h>0||c>0&&h<0)return!1}return-1}static project(t,e,n,r,i){const s=t.vertices.length,o=GA;let a=0,u=0;const c=HA,l=t.vertices;c.setZero(),FA.vectorToLocalFrame(n,r,e,o),FA.pointToLocalFrame(n,r,c,c);const h=c.dot(o);u=a=l[0].dot(o);for(let d=1;d<s;d++){const t=l[d].dot(o);t>a&&(a=t),t<u&&(u=t)}if(u-=h,a-=h,u>a){const t=u;u=a,a=t}i[0]=a,i[1]=u}}const UA=[],VA=[],GA=new TA,HA=new TA;class $A extends LA{constructor(t){super({type:LA.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=t,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const t=this.halfExtents.x,e=this.halfExtents.y,n=this.halfExtents.z,r=TA,i=[new r(-t,-e,-n),new r(t,-e,-n),new r(t,e,-n),new r(-t,e,-n),new r(-t,-e,n),new r(t,-e,n),new r(t,e,n),new r(-t,e,n)],s=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],o=new zA({vertices:i,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:s});this.convexPolyhedronRepresentation=o,o.material=this.material}calculateLocalInertia(t,e=new TA){return $A.calculateInertia(this.halfExtents,t,e),e}static calculateInertia(t,e,n){const r=t;n.x=1/12*e*(2*r.y*2*r.y+2*r.z*2*r.z),n.y=1/12*e*(2*r.x*2*r.x+2*r.z*2*r.z),n.z=1/12*e*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(t,e){const n=t,r=this.halfExtents;if(n[0].set(r.x,0,0),n[1].set(0,r.y,0),n[2].set(0,0,r.z),n[3].set(-r.x,0,0),n[4].set(0,-r.y,0),n[5].set(0,0,-r.z),void 0!==e)for(let i=0;i!==n.length;i++)e.vmult(n[i],n[i]);return n}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(t,e,n){const r=this.halfExtents,i=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let s=0;s<i.length;s++)qA.set(i[s][0],i[s][1],i[s][2]),e.vmult(qA,qA),t.vadd(qA,qA),n(qA.x,qA.y,qA.z)}calculateWorldAABB(t,e,n,r){const i=this.halfExtents;WA[0].set(i.x,i.y,i.z),WA[1].set(-i.x,i.y,i.z),WA[2].set(-i.x,-i.y,i.z),WA[3].set(-i.x,-i.y,-i.z),WA[4].set(i.x,-i.y,-i.z),WA[5].set(i.x,i.y,-i.z),WA[6].set(-i.x,i.y,-i.z),WA[7].set(i.x,-i.y,i.z);const s=WA[0];e.vmult(s,s),t.vadd(s,s),r.copy(s),n.copy(s);for(let o=1;o<8;o++){const i=WA[o];e.vmult(i,i),t.vadd(i,i);const s=i.x,a=i.y,u=i.z;s>r.x&&(r.x=s),a>r.y&&(r.y=a),u>r.z&&(r.z=u),s<n.x&&(n.x=s),a<n.y&&(n.y=a),u<n.z&&(n.z=u)}}}const qA=new TA,WA=[new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA];class XA extends class{constructor(){this._listeners=void 0}addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;return void 0===n[t]&&(n[t]=[]),n[t].includes(e)||n[t].push(e),this}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return!(void 0===n[t]||!n[t].includes(e))}hasAnyEventListener(t){return void 0!==this._listeners&&void 0!==this._listeners[t]}removeEventListener(t,e){if(void 0===this._listeners)return this;const n=this._listeners;if(void 0===n[t])return this;const r=n[t].indexOf(e);return-1!==r&&n[t].splice(r,1),this}dispatchEvent(t){if(void 0===this._listeners)return this;const e=this._listeners[t.type];if(void 0!==e){t.target=this;for(let n=0,r=e.length;n<r;n++)e[n].call(this,t)}return this}}{constructor(t={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=XA.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new TA,this.collisionFilterGroup="number"==typeof t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof t.collisionResponse||t.collisionResponse,this.position=new TA,this.previousPosition=new TA,this.interpolatedPosition=new TA,this.initPosition=new TA,t.position&&(this.position.copy(t.position),this.previousPosition.copy(t.position),this.interpolatedPosition.copy(t.position),this.initPosition.copy(t.position)),this.velocity=new TA,t.velocity&&this.velocity.copy(t.velocity),this.initVelocity=new TA,this.force=new TA;const e="number"==typeof t.mass?t.mass:0;this.mass=e,this.invMass=e>0?1/e:0,this.material=t.material||null,this.linearDamping="number"==typeof t.linearDamping?t.linearDamping:.01,this.type=e<=0?XA.STATIC:XA.DYNAMIC,typeof t.type==typeof XA.STATIC&&(this.type=t.type),this.allowSleep=void 0===t.allowSleep||t.allowSleep,this.sleepState=XA.AWAKE,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new TA,this.quaternion=new PA,this.initQuaternion=new PA,this.previousQuaternion=new PA,this.interpolatedQuaternion=new PA,t.quaternion&&(this.quaternion.copy(t.quaternion),this.initQuaternion.copy(t.quaternion),this.previousQuaternion.copy(t.quaternion),this.interpolatedQuaternion.copy(t.quaternion)),this.angularVelocity=new TA,t.angularVelocity&&this.angularVelocity.copy(t.angularVelocity),this.initAngularVelocity=new TA,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new TA,this.invInertia=new TA,this.invInertiaWorld=new SA,this.invMassSolve=0,this.invInertiaSolve=new TA,this.invInertiaWorldSolve=new SA,this.fixedRotation=void 0!==t.fixedRotation&&t.fixedRotation,this.angularDamping=void 0!==t.angularDamping?t.angularDamping:.01,this.linearFactor=new TA(1,1,1),t.linearFactor&&this.linearFactor.copy(t.linearFactor),this.angularFactor=new TA(1,1,1),t.angularFactor&&this.angularFactor.copy(t.angularFactor),this.aabb=new kA,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new TA,this.isTrigger=Boolean(t.isTrigger),t.shape&&this.addShape(t.shape),this.updateMassProperties()}wakeUp(){const t=this.sleepState;this.sleepState=XA.AWAKE,this.wakeUpAfterNarrowphase=!1,t===XA.SLEEPING&&this.dispatchEvent(XA.wakeupEvent)}sleep(){this.sleepState=XA.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(t){if(this.allowSleep){const e=this.sleepState,n=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=this.sleepSpeedLimit**2;e===XA.AWAKE&&n<r?(this.sleepState=XA.SLEEPY,this.timeLastSleepy=t,this.dispatchEvent(XA.sleepyEvent)):e===XA.SLEEPY&&n>r?this.wakeUp():e===XA.SLEEPY&&t-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(XA.sleepEvent))}}updateSolveMassProperties(){this.sleepState===XA.SLEEPING||this.type===XA.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(t,e=new TA){return t.vsub(this.position,e),this.quaternion.conjugate().vmult(e,e),e}vectorToLocalFrame(t,e=new TA){return this.quaternion.conjugate().vmult(t,e),e}pointToWorldFrame(t,e=new TA){return this.quaternion.vmult(t,e),e.vadd(this.position,e),e}vectorToWorldFrame(t,e=new TA){return this.quaternion.vmult(t,e),e}addShape(t,e,n){const r=new TA,i=new PA;return e&&r.copy(e),n&&i.copy(n),this.shapes.push(t),this.shapeOffsets.push(r),this.shapeOrientations.push(i),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,t.body=this,this}removeShape(t){const e=this.shapes.indexOf(t);return-1===e?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(e,1),this.shapeOffsets.splice(e,1),this.shapeOrientations.splice(e,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,t.body=null,this)}updateBoundingRadius(){const t=this.shapes,e=this.shapeOffsets,n=t.length;let r=0;for(let i=0;i!==n;i++){const n=t[i];n.updateBoundingSphereRadius();const s=e[i].length(),o=n.boundingSphereRadius;s+o>r&&(r=s+o)}this.boundingRadius=r}updateAABB(){const t=this.shapes,e=this.shapeOffsets,n=this.shapeOrientations,r=t.length,i=KA,s=ZA,o=this.quaternion,a=this.aabb,u=YA;for(let c=0;c!==r;c++){const r=t[c];o.vmult(e[c],i),i.vadd(this.position,i),o.mult(n[c],s),r.calculateWorldAABB(i,s,u.lowerBound,u.upperBound),0===c?a.copy(u):a.extend(u)}this.aabbNeedsUpdate=!1}updateInertiaWorld(t){const e=this.invInertia;if(e.x!==e.y||e.y!==e.z||t){const t=QA,n=JA;t.setRotationFromQuaternion(this.quaternion),t.transpose(n),t.scale(e,t),t.mmult(n,this.invInertiaWorld)}}applyForce(t,e=new TA){if(this.type!==XA.DYNAMIC)return;this.sleepState===XA.SLEEPING&&this.wakeUp();const n=tT;e.cross(t,n),this.force.vadd(t,this.force),this.torque.vadd(n,this.torque)}applyLocalForce(t,e=new TA){if(this.type!==XA.DYNAMIC)return;const n=eT,r=nT;this.vectorToWorldFrame(t,n),this.vectorToWorldFrame(e,r),this.applyForce(n,r)}applyTorque(t){this.type===XA.DYNAMIC&&(this.sleepState===XA.SLEEPING&&this.wakeUp(),this.torque.vadd(t,this.torque))}applyImpulse(t,e=new TA){if(this.type!==XA.DYNAMIC)return;this.sleepState===XA.SLEEPING&&this.wakeUp();const n=e,r=rT;r.copy(t),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const i=iT;n.cross(t,i),this.invInertiaWorld.vmult(i,i),this.angularVelocity.vadd(i,this.angularVelocity)}applyLocalImpulse(t,e=new TA){if(this.type!==XA.DYNAMIC)return;const n=sT,r=oT;this.vectorToWorldFrame(t,n),this.vectorToWorldFrame(e,r),this.applyImpulse(n,r)}updateMassProperties(){const t=aT;this.invMass=this.mass>0?1/this.mass:0;const e=this.inertia,n=this.fixedRotation;this.updateAABB(),t.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),$A.calculateInertia(t,this.mass,e),this.invInertia.set(e.x>0&&!n?1/e.x:0,e.y>0&&!n?1/e.y:0,e.z>0&&!n?1/e.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(t,e){const n=new TA;return t.vsub(this.position,n),this.angularVelocity.cross(n,e),this.velocity.vadd(e,e),e}integrate(t,e,n){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==XA.DYNAMIC&&this.type!==XA.KINEMATIC||this.sleepState===XA.SLEEPING)return;const r=this.velocity,i=this.angularVelocity,s=this.position,o=this.force,a=this.torque,u=this.quaternion,c=this.invInertiaWorld,l=this.linearFactor,h=this.invMass*t;r.x+=o.x*h*l.x,r.y+=o.y*h*l.y,r.z+=o.z*h*l.z;const d=c.elements,f=this.angularFactor,p=a.x*f.x,g=a.y*f.y,m=a.z*f.z;i.x+=t*(d[0]*p+d[1]*g+d[2]*m),i.y+=t*(d[3]*p+d[4]*g+d[5]*m),i.z+=t*(d[6]*p+d[7]*g+d[8]*m),s.x+=r.x*t,s.y+=r.y*t,s.z+=r.z*t,u.integrate(this.angularVelocity,t,this.angularFactor,u),e&&(n?u.normalizeFast():u.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}XA.idCounter=0,XA.COLLIDE_EVENT_NAME="collide",XA.DYNAMIC=1,XA.STATIC=2,XA.KINEMATIC=4,XA.AWAKE=0,XA.SLEEPY=1,XA.SLEEPING=2,XA.wakeupEvent={type:"wakeup"},XA.sleepyEvent={type:"sleepy"},XA.sleepEvent={type:"sleep"};const KA=new TA,ZA=new PA,YA=new kA,QA=new SA,JA=new SA,tT=new TA,eT=new TA,nT=new TA,rT=new TA,iT=new TA,sT=new TA,oT=new TA,aT=new TA;new TA,new TA;class uT{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new TA,this.rayToWorld=new TA,this.hitNormalWorld=new TA,this.hitPointWorld=new TA,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(t,e,n,r,i,s,o){this.rayFromWorld.copy(t),this.rayToWorld.copy(e),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(r),this.shape=i,this.body=s,this.distance=o}}let cT,lT,hT,dT,fT,pT,gT;cT=LA.types.SPHERE,lT=LA.types.PLANE,hT=LA.types.BOX,dT=LA.types.CYLINDER,fT=LA.types.CONVEXPOLYHEDRON,pT=LA.types.HEIGHTFIELD,gT=LA.types.TRIMESH;class mT{get[cT](){return this._intersectSphere}get[lT](){return this._intersectPlane}get[hT](){return this._intersectBox}get[dT](){return this._intersectConvex}get[fT](){return this._intersectConvex}get[pT](){return this._intersectHeightfield}get[gT](){return this._intersectTrimesh}constructor(t=new TA,e=new TA){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=t.clone(),this.to=e.clone(),this.direction=new TA,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=mT.ANY,this.result=new uT,this.hasHit=!1,this.callback=t=>{}}intersectWorld(t,e){return this.mode=e.mode||mT.ANY,this.result=e.result||new uT,this.skipBackfaces=!!e.skipBackfaces,this.collisionFilterMask=void 0!==e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==e.collisionFilterGroup?e.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===e.checkCollisionResponse||e.checkCollisionResponse,e.from&&this.from.copy(e.from),e.to&&this.to.copy(e.to),this.callback=e.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(yT),bT.length=0,t.broadphase.aabbQuery(t,yT,bT),this.intersectBodies(bT),this.hasHit}intersectBody(t,e){e&&(this.result=e,this.updateDirection());const n=this.checkCollisionResponse;if(n&&!t.collisionResponse)return;if(0==(this.collisionFilterGroup&t.collisionFilterMask)||0==(t.collisionFilterGroup&this.collisionFilterMask))return;const r=wT,i=xT;for(let s=0,o=t.shapes.length;s<o;s++){const e=t.shapes[s];if((!n||e.collisionResponse)&&(t.quaternion.mult(t.shapeOrientations[s],i),t.quaternion.vmult(t.shapeOffsets[s],r),r.vadd(t.position,r),this.intersectShape(e,i,r,t),this.result.shouldStop))break}}intersectBodies(t,e){e&&(this.result=e,this.updateDirection());for(let n=0,r=t.length;!this.result.shouldStop&&n<r;n++)this.intersectBody(t[n])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(t,e,n,r){if(function(t,e,n){n.vsub(t,GT);const r=GT.dot(e);return e.scale(r,HT),HT.vadd(t,HT),n.distanceTo(HT)}(this.from,this.direction,n)>t.boundingSphereRadius)return;const i=this[t.type];i&&i.call(this,t,e,n,r,t)}_intersectBox(t,e,n,r,i){return this._intersectConvex(t.convexPolyhedronRepresentation,e,n,r,i)}_intersectPlane(t,e,n,r,i){const s=this.from,o=this.to,a=this.direction,u=new TA(0,0,1);e.vmult(u,u);const c=new TA;s.vsub(n,c);const l=c.dot(u);if(o.vsub(n,c),l*c.dot(u)>0)return;if(s.distanceTo(o)<l)return;const h=u.dot(a);if(Math.abs(h)<this.precision)return;const d=new TA,f=new TA,p=new TA;s.vsub(n,d);const g=-u.dot(d)/h;a.scale(g,f),s.vadd(f,p),this.reportIntersection(u,p,i,r,-1)}getAABB(t){const{lowerBound:e,upperBound:n}=t,r=this.to,i=this.from;e.x=Math.min(r.x,i.x),e.y=Math.min(r.y,i.y),e.z=Math.min(r.z,i.z),n.x=Math.max(r.x,i.x),n.y=Math.max(r.y,i.y),n.z=Math.max(r.z,i.z)}_intersectHeightfield(t,e,n,r,i){const s=DT;s.from.copy(this.from),s.to.copy(this.to),FA.pointToLocalFrame(n,e,s.from,s.from),FA.pointToLocalFrame(n,e,s.to,s.to),s.updateDirection();const o=kT;let a,u,c,l;a=u=0,c=l=t.data.length-1;const h=new kA;s.getAABB(h),t.getIndexOfPosition(h.lowerBound.x,h.lowerBound.y,o,!0),a=Math.max(a,o[0]),u=Math.max(u,o[1]),t.getIndexOfPosition(h.upperBound.x,h.upperBound.y,o,!0),c=Math.min(c,o[0]+1),l=Math.min(l,o[1]+1);for(let d=a;d<c;d++)for(let o=u;o<l;o++){if(this.result.shouldStop)return;if(t.getAabbAtIndex(d,o,h),h.overlapsRay(s)){if(t.getConvexTrianglePillar(d,o,!1),FA.pointToWorldFrame(n,e,t.pillarOffset,IT),this._intersectConvex(t.pillarConvex,e,IT,r,i,CT),this.result.shouldStop)return;t.getConvexTrianglePillar(d,o,!0),FA.pointToWorldFrame(n,e,t.pillarOffset,IT),this._intersectConvex(t.pillarConvex,e,IT,r,i,CT)}}}_intersectSphere(t,e,n,r,i){const s=this.from,o=this.to,a=(o.x-s.x)**2+(o.y-s.y)**2+(o.z-s.z)**2,u=2*((o.x-s.x)*(s.x-n.x)+(o.y-s.y)*(s.y-n.y)+(o.z-s.z)*(s.z-n.z)),c=u**2-4*a*((s.x-n.x)**2+(s.y-n.y)**2+(s.z-n.z)**2-t.radius**2),l=OT,h=MT;if(!(c<0))if(0===c)s.lerp(o,c,l),l.vsub(n,h),h.normalize(),this.reportIntersection(h,l,i,r,-1);else{const t=(-u-Math.sqrt(c))/(2*a),e=(-u+Math.sqrt(c))/(2*a);if(t>=0&&t<=1&&(s.lerp(o,t,l),l.vsub(n,h),h.normalize(),this.reportIntersection(h,l,i,r,-1)),this.result.shouldStop)return;e>=0&&e<=1&&(s.lerp(o,e,l),l.vsub(n,h),h.normalize(),this.reportIntersection(h,l,i,r,-1))}}_intersectConvex(t,e,n,r,i,s){const o=PT,a=NT,u=s&&s.faceList||null,c=t.faces,l=t.vertices,h=t.faceNormals,d=this.direction,f=this.from,p=f.distanceTo(this.to),g=u?u.length:c.length,m=this.result;for(let y=0;!m.shouldStop&&y<g;y++){const t=u?u[y]:y,s=c[t],g=h[t],b=e,_=n;a.copy(l[s[0]]),b.vmult(a,a),a.vadd(_,a),a.vsub(f,a),b.vmult(g,o);const v=d.dot(o);if(Math.abs(v)<this.precision)continue;const w=o.dot(a)/v;if(!(w<0)){d.scale(w,ET),ET.vadd(f,ET),ST.copy(l[s[0]]),b.vmult(ST,ST),_.vadd(ST,ST);for(let e=1;!m.shouldStop&&e<s.length-1;e++){AT.copy(l[s[e]]),TT.copy(l[s[e+1]]),b.vmult(AT,AT),b.vmult(TT,TT),_.vadd(AT,AT),_.vadd(TT,TT);const n=ET.distanceTo(f);!mT.pointInTriangle(ET,ST,AT,TT)&&!mT.pointInTriangle(ET,AT,ST,TT)||n>p||this.reportIntersection(o,ET,i,r,t)}}}}_intersectTrimesh(t,e,n,r,i,s){const o=RT,a=UT,u=VT,c=NT,l=jT,h=LT,d=FT,f=zT,p=BT,g=t.indices,m=this.from,y=this.to,b=this.direction;u.position.copy(n),u.quaternion.copy(e),FA.vectorToLocalFrame(n,e,b,l),FA.pointToLocalFrame(n,e,m,h),FA.pointToLocalFrame(n,e,y,d),d.x*=t.scale.x,d.y*=t.scale.y,d.z*=t.scale.z,h.x*=t.scale.x,h.y*=t.scale.y,h.z*=t.scale.z,d.vsub(h,l),l.normalize();const _=h.distanceSquared(d);t.tree.rayQuery(this,u,a);for(let v=0,w=a.length;!this.result.shouldStop&&v!==w;v++){const s=a[v];t.getNormal(s,o),t.getVertex(g[3*s],ST),ST.vsub(h,c);const u=l.dot(o),d=o.dot(c)/u;if(d<0)continue;l.scale(d,ET),ET.vadd(h,ET),t.getVertex(g[3*s+1],AT),t.getVertex(g[3*s+2],TT);const m=ET.distanceSquared(h);!mT.pointInTriangle(ET,AT,ST,TT)&&!mT.pointInTriangle(ET,ST,AT,TT)||m>_||(FA.vectorToWorldFrame(e,o,p),FA.pointToWorldFrame(n,e,ET,f),this.reportIntersection(p,f,i,r,s))}a.length=0}reportIntersection(t,e,n,r,i){const s=this.from,o=this.to,a=s.distanceTo(e),u=this.result;if(!(this.skipBackfaces&&t.dot(this.direction)>0))switch(u.hitFaceIndex=void 0!==i?i:-1,this.mode){case mT.ALL:this.hasHit=!0,u.set(s,o,t,e,n,r,a),u.hasHit=!0,this.callback(u);break;case mT.CLOSEST:(a<u.distance||!u.hasHit)&&(this.hasHit=!0,u.hasHit=!0,u.set(s,o,t,e,n,r,a));break;case mT.ANY:this.hasHit=!0,u.hasHit=!0,u.set(s,o,t,e,n,r,a),u.shouldStop=!0}}static pointInTriangle(t,e,n,r){r.vsub(e,GT),n.vsub(e,_T),t.vsub(e,vT);const i=GT.dot(GT),s=GT.dot(_T),o=GT.dot(vT),a=_T.dot(_T),u=_T.dot(vT);let c,l;return(c=a*o-s*u)>=0&&(l=i*u-s*o)>=0&&c+l<i*a-s*s}}mT.CLOSEST=1,mT.ANY=2,mT.ALL=4;const yT=new kA,bT=[],_T=new TA,vT=new TA,wT=new TA,xT=new PA,ET=new TA,ST=new TA,AT=new TA,TT=new TA,CT={faceList:[0]},IT=new TA,DT=new mT,kT=[],OT=new TA,MT=new TA,PT=new TA,NT=new TA,RT=new TA,jT=new TA,LT=new TA,FT=new TA,BT=new TA,zT=new TA;new kA;const UT=[],VT=new FA,GT=new TA,HT=new TA;let $T,qT,WT,XT,KT,ZT,YT,QT,JT,tC,eC,nC,rC,iC,sC,oC,aC,uC,cC,lC,hC,dC,fC,pC,gC;new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new mT,new TA,new TA,new TA(1,0,0),new TA(0,1,0),new TA(0,0,1),new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new kA,new TA,new kA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new kA,new TA,new FA,new kA;const mC={sphereSphere:LA.types.SPHERE,spherePlane:LA.types.SPHERE|LA.types.PLANE,boxBox:LA.types.BOX|LA.types.BOX,sphereBox:LA.types.SPHERE|LA.types.BOX,planeBox:LA.types.PLANE|LA.types.BOX,convexConvex:LA.types.CONVEXPOLYHEDRON,sphereConvex:LA.types.SPHERE|LA.types.CONVEXPOLYHEDRON,planeConvex:LA.types.PLANE|LA.types.CONVEXPOLYHEDRON,boxConvex:LA.types.BOX|LA.types.CONVEXPOLYHEDRON,sphereHeightfield:LA.types.SPHERE|LA.types.HEIGHTFIELD,boxHeightfield:LA.types.BOX|LA.types.HEIGHTFIELD,convexHeightfield:LA.types.CONVEXPOLYHEDRON|LA.types.HEIGHTFIELD,sphereParticle:LA.types.PARTICLE|LA.types.SPHERE,planeParticle:LA.types.PLANE|LA.types.PARTICLE,boxParticle:LA.types.BOX|LA.types.PARTICLE,convexParticle:LA.types.PARTICLE|LA.types.CONVEXPOLYHEDRON,cylinderCylinder:LA.types.CYLINDER,sphereCylinder:LA.types.SPHERE|LA.types.CYLINDER,planeCylinder:LA.types.PLANE|LA.types.CYLINDER,boxCylinder:LA.types.BOX|LA.types.CYLINDER,convexCylinder:LA.types.CONVEXPOLYHEDRON|LA.types.CYLINDER,heightfieldCylinder:LA.types.HEIGHTFIELD|LA.types.CYLINDER,particleCylinder:LA.types.PARTICLE|LA.types.CYLINDER,sphereTrimesh:LA.types.SPHERE|LA.types.TRIMESH,planeTrimesh:LA.types.PLANE|LA.types.TRIMESH};$T=mC.sphereSphere,qT=mC.spherePlane,WT=mC.boxBox,XT=mC.sphereBox,KT=mC.planeBox,ZT=mC.convexConvex,YT=mC.sphereConvex,QT=mC.planeConvex,JT=mC.boxConvex,tC=mC.sphereHeightfield,eC=mC.boxHeightfield,nC=mC.convexHeightfield,rC=mC.sphereParticle,iC=mC.planeParticle,sC=mC.boxParticle,oC=mC.convexParticle,aC=mC.cylinderCylinder,uC=mC.sphereCylinder,cC=mC.planeCylinder,lC=mC.boxCylinder,hC=mC.convexCylinder,dC=mC.heightfieldCylinder,fC=mC.particleCylinder,pC=mC.sphereTrimesh,gC=mC.planeTrimesh,new TA,new TA,new TA,new TA,new TA,new PA,new PA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new kA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new PA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new TA,new kA,new mT;const yC=globalThis.performance||{};if(!yC.now){let t=Date.now();yC.timing&&yC.timing.navigationStart&&(t=yC.timing.navigationStart),yC.now=()=>Date.now()-t}var bC=n(517);function _C(t,e,n){e||(e=new my(my.IDENTITY));const r=new my(my.IDENTITY);if(t.matrix)r.copy(t.matrix);else{if(r.identity(),t.translation&&r.translate(t.translation),t.rotation){const e=new my(my.IDENTITY).fromQuaternion(t.rotation);r.multiplyRight(e)}t.scale&&r.scale(t.scale)}const i=new my(e).multiplyRight(r);if(!1===n(t,i,e))return!1;for(const s of t.nodes||t.children||[])if(!1===_C(s,i,n))return!1;return!0}function vC(){k_([VE,pA])}function wC(t,e){const n=e.nodes.find(e=>e.name===t);if(n){let r=!1;for(const t of e.scenes)r||_C(t,new my(my.IDENTITY),(t,e)=>t!==n||(t.matrix=e,t.translation=void 0,t.rotation=void 0,t.scale=void 0,r=!0,!1));return e.scene={id:t,name:t,nodes:[n]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function xC(t,e){return Al(this,void 0,void 0,function*(){const n=t.scenegraph;let r;r=e?e[n]||(e[n]=fetch(n).then(t=>t.blob())):fetch(n);const i=yield B_(r,pA,{DracoLoader:xS,gltf:{decompressMeshes:!0,postProcess:!0}});return wC(t.scenegraphNode,i)})}function EC(t,e){return Al(this,void 0,void 0,function*(){return wC(t,yield e)})}function SC(t,e,n){return e&&0!==e.length?new dE(Object.assign({id:t,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Nh.CARTESIAN,data:e,mesh:new EA,wireframe:!1,getTransformMatrix:t=>t.transformMatrix,getColor:t=>t.color||[255,255,255,229.5]},n)):void 0}let AC=(()=>{class t extends W_{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),vC()}renderLayers(){const e=this.state,n=e.data.filter(t=>!t.scenegraph&&!t.wireframe&&t.unpickable),r=e.data.filter(t=>!t.scenegraph&&!t.wireframe&&!t.unpickable),i=e.data.filter(t=>!t.scenegraph&&t.wireframe),s=e.data.filter(t=>!!t.scenegraph);e.doCollisions&&function(t){Al(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=t.filter(t=>!t.scenegraph&&!t.wireframe).map(t=>{const e=new my(t.transformMatrix),n=e.transformAsPoint([-1,-1,-1],[]),r=e.transformAsPoint([1,1,1],[]);return{"@id":t["@id"],name:t.tooltip,entityId:t.entityId,bbox:new kA({lowerBound:new TA(...n.map((t,e)=>Math.min(t,r[e]))),upperBound:new TA(...r.map((t,e)=>Math.max(t,n[e])))})}}),n=[];for(const o of t.filter(t=>!!t.scenegraph)){const t=yield z_(o.scenegraph,pA,{DracoLoader:xS,decompress:!0,postProcess:!0});for(const e of t.scenes)_C(e,new my(o.transformMatrix),(e,r)=>{if(e.mesh&&e.mesh.primitives&&e.mesh.primitives.length>0)for(const i of e.mesh.primitives)if(i.attributes.POSITION&&i.attributes.POSITION.min){const s=r.transformAsPoint(i.attributes.POSITION.min,[]),a=r.transformAsPoint(i.attributes.POSITION.max,[]);n.push({"@id":o["@id"],name:e.name,entityId:o.entityId,bbox:new kA({lowerBound:new TA(...s.map((t,e)=>Math.min(t,a[e]))),upperBound:new TA(...a.map((t,e)=>Math.max(t,s[e])))}),gltf:t})}return!0})}const r=[],i=[];for(const t of e){const e=[];for(const r of n)t.bbox.overlaps(r.bbox)&&e.push({"@id":r["@id"],name:r.name});e.length>0?r.push({"@id":t.entityId,name:t.name,hits:e}):i.push(t)}console.log({sourceBoxes:e,targetBoxes:n,report:r,sad:i,maxHits:Math.max(...r.map(t=>t.hits.length))});const s=[];for(const t of r){s.push({"Tissue ID":t["@id"],"Tissue Name":t.name,"Hit ID":"","Hit Name":""});for(const e of t.hits)s.push({"Tissue ID":t["@id"],"Tissue Name":t.name,"Hit ID":e["@id"],"Hit Name":e.name})}return console.log(s),r})}(e.data);const o={};for(const a of s)a.scenegraph&&a.scenegraphNode&&!Object.prototype.hasOwnProperty.call(o,a.scenegraph)&&(o[a.scenegraph]=xC({scenegraph:a.scenegraph},t.gltfCache));return[SC("cubes",n,{wireframe:!1,pickable:!1}),SC("pickableCubes",r,{wireframe:!1,pickable:!0}),SC("wireframes",i,{wireframe:!0,pickable:!1}),...s.map(t=>{var n;return new yA({id:"models-"+t["@id"],opacity:t.zoomBasedOpacity?e.zoomOpacity:void 0!==t.opacity?t.opacity:1,pickable:!t.unpickable,coordinateSystem:Nh.CARTESIAN,data:[t],scenegraph:t.scenegraphNode?EC(t.scenegraphNode,o[t.scenegraph]):t.scenegraph,_lighting:t._lighting,getTransformMatrix:t.transformMatrix,getColor:null!==(n=t.color)&&void 0!==n?n:[0,255,0,127.5],parameters:{depthMask:!t.zoomBasedOpacity&&(void 0===t.opacity||1===t.opacity)}})})].filter(t=>!!t)}getPickingInfo(t){return t.info}}return t.layerName="BodyUILayer",t.gltfCache={},t})();function TC(t,e=[]){for(const n of t.nodes||t.children||[])e.push(n.name),TC(n,e);return e}let CC=(()=>{class t{constructor(t){var e,n,r,i,s;this.deckProps=t,this.bodyUILayer=new AC({}),this.nodeClickSubject=new C,this.nodeHoverStartSubject=new C,this.nodeHoverStopSubject=new C,this.sceneRotationSubject=new Tl([0,0]),this.nodeDragStartSubject=new C,this.nodeDragSubject=new C,this.nodeDragEndSubject=new C,this.nodeClick$=this.nodeClickSubject.pipe(nt()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(nt()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(nt()),this.sceneRotation$=this.sceneRotationSubject.pipe(nt()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(nt()),this.nodeDrag$=this.nodeDragSubject.pipe(nt()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(nt());const o=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new Ev({flipY:!1,near:-1e3}):new Cv({})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:t=>{var e;return null!==(e=this.cursor)&&void 0!==e?e:t.isDragging?"grabbing":"grab"}});t.legacyLighting&&(o.effects=[new tw({ambientLight:new Ov({color:[255,255,255],intensity:10})})]),this.deck=new Hx(o),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(e=t.minRotationX)&&void 0!==e?e:-15,maxRotationX:null!==(n=t.maxRotationX)&&void 0!==n?n:15,target:null!==(r=t.target)&&void 0!==r?r:[.5,.5,0],rotationX:0,rotationOrbit:null!==(i=t.rotation)&&void 0!==i?i:0,zoom:null!==(s=t.zoom)&&void 0!==s?s:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return Al(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let e=this.bodyUILayer.state.zoomOpacity,n=!1;for(const r of t)r.zoomToOnLoad&&(this.zoomTo(r),n=!0);e=n?.05:e,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,e):this.bodyUILayer.setState({data:t,zoomOpacity:e})}}debugSceneNodeProcessing(t,e){const n="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",r=new my([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(t,e,n){return Al(this,void 0,void 0,function*(){vC();const n=yield xC({scenegraph:t,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},i=[];for(const s of n.scenes)_C(s,e=new my(e||my.IDENTITY),(n,s)=>{const o={"@id":n.name||n.id,"@type":"ProcessedNode",transformMatrix:new my(s),wireframe:!0,node:n};if(i.push({"@id":`GLTF:${o["@id"]}`,"@type":"GLTFNode",scenegraph:t,scenegraphNode:o["@id"],transformMatrix:new my(e||my.IDENTITY),tooltip:n.name||n.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:n}),n.mesh&&n.mesh.primitives&&n.mesh.primitives.length>0)for(const t of n.mesh.primitives)if(t.attributes.POSITION&&t.attributes.POSITION.min){const e=s.transformAsPoint(t.attributes.POSITION.min,[]),n=s.transformAsPoint(t.attributes.POSITION.max,[]);o.bbox=new kA({lowerBound:new TA(...e.map((t,e)=>Math.min(t,n[e]))),upperBound:new TA(...n.map((t,n)=>Math.max(t,e[n])))})}return r[o["@id"]]=o,!0});for(const t of Object.values(r).filter(t=>!t.bbox)){for(const e of TC(t.node).map(t=>r[t]).filter(t=>t.bbox))t.bbox?t.bbox.extend(e.bbox):t.bbox=e.bbox.clone();t.bbox||delete r[t["@id"]]}for(const t of Object.values(r)){const e=t.bbox.lowerBound,n=(t.size=t.bbox.upperBound.clone().vsub(e)).clone().vmul(new TA(.5,.5,.5)),r=t.center=e.clone().vadd(n);t.transformMatrix=(new my).translate(r.toArray()).scale(n.toArray())}for(const t of i)r[t["@id"]]=t;return r})})(n,r).then(i=>{console.log("results",i),console.log("data",t),(t=t.concat(Object.values(i))).push({"@id":"TEST","@type":"TEST",scenegraph:n,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:r,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:e})})}zoomTo(t){const e=new my(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:e.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:e}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?e!==t.object&&(e&&this.nodeHoverStopSubject.next(e),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):e&&(this.nodeHoverStopSubject.next(e),this.lastHovered=void 0)}_onClick(t,e){var n,r;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(r=null===(n=null==e?void 0:e.srcEvent)||void 0===n?void 0:n.ctrlKey)&&void 0!==r?r:void 0})}_onViewStateChange(t){var e;if(null===(e=t.interactionState)||void 0===e?void 0:e.isZooming){const e=this.bodyUILayer.state,n=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);e.zoomOpacity!==n&&this.bodyUILayer.setState({data:e.data,zoomOpacity:n})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,e){this._dragEvent(t,e,this.nodeDragStartSubject)}_onDrag(t,e){this._dragEvent(t,e,this.nodeDragSubject)}_onDragEnd(t,e){this._dragEvent(t,e,this.nodeDragEndSubject)}_dragEvent(t,e,n){var r;(null===(r=null==t?void 0:t.object)||void 0===r?void 0:r["@id"])&&n.next({node:t.object,info:t,e:e})}}return Sl([bC.ZP],t.prototype,"_onHover",null),Sl([bC.ZP],t.prototype,"_onClick",null),Sl([bC.ZP],t.prototype,"_onViewStateChange",null),Sl([bC.ZP],t.prototype,"_onDragStart",null),Sl([bC.ZP],t.prototype,"_onDrag",null),Sl([bC.ZP],t.prototype,"_onDragEnd",null),t})();function IC(t,e){return t===e}function DC(t,e,n){if(null===e||null===n||e.length!==n.length)return!1;const r=e.length;for(let i=0;i<r;i++)if(!t(e[i],n[i]))return!1;return!0}function kC(t,e=IC){let n=null,r=null;function i(){return DC(e,n,arguments)||(r=t.apply(null,arguments)),n=arguments,r}return i.reset=function(){n=null,r=null},i}const OC=kC(function(){const t=Vu();if(!t)return!1;const e=t.injector.get(xu,null);return!!e&&e.some(t=>(t&&t.providers||[]).some(t=>t&&t.provide&&"MockNgModuleResolver"===t.provide.name||!1))});let MC=(()=>{class t{constructor(){this.bootstrap$=new hl(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const PC=new Wn("INITIAL_STATE_TOKEN");let NC=(()=>{class t{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return t.value={},t})();const RC=new Wn("Internals.StateContextFactory"),jC=new Wn("Internals.StateFactory");function LC(...t){if(1===t.length){const e=t[0];if(d(e))return FC(e,null);if(f(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return FC(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return FC(t=1===t.length&&d(t[0])?t[0]:t,null).pipe(k(t=>e(...t)))}return FC(t,null)}function FC(t,e){return new x(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let s=0,o=0;for(let a=0;a<r;a++){const u=B(t[a]);let c=!1;n.add(u.subscribe({next:t=>{c||(c=!0,o++),i[a]=t},error:t=>n.error(t),complete:()=>{s++,s!==r&&c||(o===r&&n.next(e?e.reduce((t,e,n)=>(t[e]=i[n],t),{}):i),n.complete())}}))}})}function BC(t,e){return e?n=>n.pipe(BC((n,r)=>B(t(n,r)).pipe(k((t,i)=>e(n,t,r,i))))):e=>e.lift(new zC(t))}class zC{constructor(t){this.project=t}call(t,e){return e.subscribe(new UC(t,this.project))}}class UC extends U{constructor(t,e){super(t),this.project=e,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(t){this.hasSubscription||this.tryNext(t)}tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch($O){return void this.destination.error($O)}this.hasSubscription=!0,this._innerSub(e)}_innerSub(t){const e=new z(this),n=this.destination;n.add(e);const r=V(t,e);r!==e&&n.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function VC(t){return e=>e.lift(new GC(t))}class GC{constructor(t){this.notifier=t}call(t,e){const n=new HC(t),r=V(this.notifier,new z(n));return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}class HC extends U{constructor(t){super(t),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function $C(t,e){return n=>n.lift(new qC(t,e))}class qC{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new WC(t,this.compare,this.keySelector))}}class WC extends b{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch($O){return this.destination.error($O)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch($O){return this.destination.error($O)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}const XC={STATE_NAME:t=>`${t} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(t,e,n)=>`State name '${t}' from ${e} already exists in ${n}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:t=>`'${t}' class should be decorated with @Injectable() right after the @State() decorator`};let KC=(()=>{class t{constructor(t,e){this._ngZone=t,this._platformId=e,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return"server"===this._platformId?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return Au.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return Au.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof Au||console.warn(XC.ZONE_WARNING())}}return t.\u0275fac=function(e){return new(e||t)(cr(Au),cr(cu))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const ZC=new Wn("ROOT_STATE_TOKEN"),YC=new Wn("FEATURE_STATE_TOKEN"),QC=new Wn("NGXS_PLUGINS"),JC=new Wn("NG_TEST_MODE"),tI=new Wn("NG_DEV_MODE");let eI=(()=>{class t{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=KC}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class nI{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}}const rI=new Wn("NGXS_EXECUTION_STRATEGY");function iI(t){return t.constructor&&t.constructor.type?t.constructor.type:t.type}const sI=(t,e,n)=>{t=Object.assign({},t);const r=e.split("."),i=r.length-1;return r.reduce((t,e,r)=>(t[e]=r===i?n:Array.isArray(t[e])?t[e].slice():Object.assign({},t[e]),t&&t[e]),t),t},oI=(t,e)=>e.split(".").reduce((t,e)=>t&&t[e],t),aI=t=>t&&"object"==typeof t&&!Array.isArray(t),uI=(t,...e)=>{if(!e.length)return t;const n=e.shift();if(aI(t)&&aI(n))for(const r in n)aI(n[r])?(t[r]||Object.assign(t,{[r]:{}}),uI(t[r],n[r])):Object.assign(t,{[r]:n[r]});return uI(t,...e)};function cI(t){return t.NGXS_META}function lI(t,e){const n=oI(e.currentAppState,t.path),r=oI(e.newAppState,t.path);return new nI(n,r,!t.isInitialised)}function hI(...t){return function(t,e,n=dI){const r=t.reduce((t,e)=>(t[iI(e)]=!0,t),{}),i=e&&function(t){return t.reduce((t,e)=>(t[e]=!0,t),{})}(e);return function(t){return t.pipe(function(t,e){return Rl(n=>{const r=iI(n.action);return t[r]&&(!e||e[n.status])})}(r,i),n())}}(t,["DISPATCHED"])}function dI(){return k(t=>t.action)}function fI(t){return e=>new x(n=>e.subscribe({next(e){t.leave(()=>n.next(e))},error(e){t.leave(()=>n.error(e))},complete(){t.leave(()=>n.complete())}}))}let pI=(()=>{class t{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return t.\u0275fac=function(e){return new(e||t)(cr(rI))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class gI extends C{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(t){if(this._busyPushingNext)this._itemQueue.unshift(t);else{for(this._busyPushingNext=!0,super.next(t);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let mI=(()=>{class t extends gI{}return t.\u0275fac=function(){let e;return function(n){return(e||(e=Gn(t)))(n||t)}}(),t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),yI=(()=>{class t extends x{constructor(t,e){super(n=>{const r=t.pipe(fI(e)).subscribe({next:t=>n.next(t),error:t=>n.error(t),complete:()=>n.complete()});n.add(r)})}}return t.\u0275fac=function(e){return new(e||t)(cr(mI),cr(pI))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const bI=t=>(...e)=>t.shift()(...e,(...e)=>bI(t)(...e));let _I=(()=>{class t extends Tl{constructor(){super({})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),vI=(()=>{class t{constructor(t,e){this._parentManager=t,this._pluginHandlers=e,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(t=>t.handle?t.handle.bind(t):t)}}return t.\u0275fac=function(e){return new(e||t)(cr(t,12),cr(QC,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),wI=(()=>{class t extends C{}return t.\u0275fac=function(){let e;return function(n){return(e||(e=Gn(t)))(n||t)}}(),t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),xI=(()=>{class t{constructor(t,e,n,r,i,s){this._injector=t,this._actions=e,this._actionResults=n,this._pluginManager=r,this._stateStream=i,this._ngxsExecutionStrategy=s}dispatch(t){const e=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return e.subscribe({error:t=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(wr),this._errorHandler.handleError(t)}catch(e){}})}),e.pipe(fI(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?sl(this._stateStream.getValue()):LC(t.map(t=>this.dispatchSingle(t))):this.dispatchSingle(t)}dispatchSingle(t){if(!iI(t))return ol(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const e=this._stateStream.getValue();return bI([...this._pluginManager.plugins,(t,n)=>{t!==e&&this._stateStream.next(t);const r=this.getActionResultStream(n);return r.subscribe(t=>this._actions.next(t)),this._actions.next({action:n,status:"DISPATCHED"}),this.createDispatchObservable(r)}])(e,t).pipe(ah())}getActionResultStream(t){return this._actionResults.pipe(Rl(e=>e.action===t&&"DISPATCHED"!==e.status),Ml(1),ah())}createDispatchObservable(t){return t.pipe(BC(t=>{switch(t.status){case"SUCCESSFUL":return sl(this._stateStream.getValue());case"ERRORED":return ol(t.error);default:return rl}})).pipe(ah())}}return t.\u0275fac=function(e){return new(e||t)(cr(_s),cr(mI),cr(wI),cr(vI),cr(_I),cr(pI))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const EI=t=>{Object.freeze(t);const e="function"==typeof t,n=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(t).forEach(function(r){!n.call(t,r)||e&&("caller"===r||"callee"===r||"arguments"===r)||null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||EI(t[r])}),t};let SI=(()=>{class t{constructor(t,e){this.isDevMode=t,this.isTestMode=e}}return t.\u0275fac=function(e){return new(e||t)(cr(tI),cr(JC))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),AI=(()=>{class t{constructor(t,e){this._host=t,this._config=e}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(XC.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(XC.INCORRECT_DEVELOPMENT()))}}return t.\u0275fac=function(e){return new(e||t)(cr(SI),cr(eI))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),TI=(()=>{class t{constructor(t,e,n,r){this._stateStream=t,this._dispatcher=e,this._config=n,r.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:t=>this._stateStream.next(t),dispatch:t=>this._dispatcher.dispatch(t)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:e=>{const n=EI(e);return t.setState(n)},dispatch:e=>t.dispatch(e)}}setStateToTheCurrentWithNew(t){const e=this.getRootStateOperations(),n=e.getState();e.setState(Object.assign({},n,t.defaults))}}return t.\u0275fac=function(e){return new(e||t)(cr(_I),cr(xI),cr(eI),cr(AI))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),CI=(()=>{class t{constructor(t){this._internalStateOperations=t}createStateContext(t){const e=this._internalStateOperations.getRootStateOperations();function n(e){return oI(e,t.path)}function r(n,r){const i=sI(n,t.path,r),s=t.instance;if(s.ngxsOnChanges){const e=lI(t,{currentAppState:n,newAppState:i});s.ngxsOnChanges(e)}return e.setState(i),i}function i(t,e){return r(t,e(n(t)))}return{getState:()=>n(e.getState()),patchState:t=>i(e.getState(),function(t){return e=>{if(Array.isArray(t))throw new Error(XC.PATCHING_ARRAY());if("object"!=typeof t)throw new Error(XC.PATCHING_PRIMITIVE());const n=Object.assign({},e);for(const r in t)n[r]=t[r];return n}}(t)),setState(t){const n=e.getState();return"function"==typeof t?i(n,t):r(n,t)},dispatch:t=>e.dispatch(t)}}}return t.\u0275fac=function(e){return new(e||t)(cr(TI))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class II{static stateNameErrorMessage(t){return XC.STATE_NAME(t)}static checkCorrectStateName(t){if(!t)throw new Error(XC.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(t))throw new Error(this.stateNameErrorMessage(t))}static checkStateNameIsUnique(t,e){const n=this.getValidStateMeta(t).name,r=e[n];if(r&&r!==t)throw new Error(XC.STATE_UNIQUE(n,t.name,r.name));return n}static getValidStateMeta(t){const e=cI(t);if(!e)throw new Error(XC.STATE_DECORATOR());return e}}II.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let DI=(()=>{class t{constructor(t,e,n,r,i,s,o){this._injector=t,this._config=e,this._parentFactory=n,this._actions=r,this._actionResults=i,this._stateContextFactory=s,this._initialState=o,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=kC(()=>{const t=this;function e(e){const n=t.statePaths[e];return n?function(t,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(t){const e=t.slice();return t=>e.reduce((t,e)=>t&&t[e],t)}(t):function(t){const e=t;let n="store."+e[0],r=0;const i=e.length;let s=n;for(;++r<i;)s=s+" && "+(n=n+"."+e[r]);return new Function("store","return "+s+";")}(t)}(n.split("."),t._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(t){let n=e(t);return n||((...r)=>(n||(n=e(t)),n?n(...r):void 0))},getSelectorOptions:e=>Object.assign({},t._config.selectorOptions,e||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let e={};var n;return e=Array.isArray(t)?t.slice():"object"==typeof(n=t)&&null!==n||"function"==typeof n?Object.assign({},t):void 0===t?{}:t,e}static checkStatesAreValid(t){t.forEach(II.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(e){t.checkStatesAreValid(e);const{newStates:n}=this.addToStatesMap(e);if(!n.length)return[];const r=function(t){const e=e=>{const n=t.find(t=>t===e);if(!n)throw new Error(`Child state not found: ${e}. \r\nYou may have forgotten to add states to module`);return n.NGXS_META.name};return t.reduce((t,n)=>{const{name:r,children:i}=n.NGXS_META;return t[r]=(i||[]).map(e),t},{})}(n),i=function(t){const e=[],n={},r=(i,s=[])=>{Array.isArray(s)||(s=[]),s.push(i),n[i]=!0,t[i].forEach(t=>{if(s.indexOf(t)>=0)throw new Error(`Circular dependency '${t}' is required by '${i}': ${s.join(" -> ")}`);n[t]||r(t,s.slice(0))}),e.indexOf(i)<0&&e.push(i)};return Object.keys(t).forEach(t=>r(t)),e.reverse()}(r),s=function(t,e={}){const n=(t,e)=>{for(const r in t)if(t.hasOwnProperty(r)&&t[r].indexOf(e)>=0){const e=n(t,r);return null!==e?`${e}.${r}`:r}return null};for(const r in t)if(t.hasOwnProperty(r)){const i=n(t,r);e[r]=i?`${i}.${r}`:r}return e}(r),o=n.reduce((t,e)=>(t[e.NGXS_META.name]=e,t),{}),a=[];for(const u of i){const e=o[u],n=s[u],r=e.NGXS_META;this.addRuntimeInfoToMeta(r,n);const i={name:u,path:n,isInitialised:!1,actions:r.actions,instance:this._injector.get(e),defaults:t.cloneDefaults(r.defaults)};this.hasBeenMountedAndBootstrapped(u,n)||a.push(i),this.states.push(i)}return a}addAndReturnDefaults(t){const e=this.add(t||[]);return{defaults:e.reduce((t,e)=>sI(t,e.path,e.defaults),{}),states:e}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(Rl(t=>"DISPATCHED"===t.status),G(({action:t})=>this.invokeActions(this._actions,t).pipe(k(()=>({action:t,status:"SUCCESSFUL"})),Ul({action:t,status:"CANCELED"}),Fl(e=>sl({action:t,status:"ERRORED",error:e}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,e){const n=iI(e),r=[];for(const s of this.states){const o=s.actions[n];if(o)for(const n of o){const o=this._stateContextFactory.createStateContext(s);try{let i=s.instance[n.fn](o,e);i instanceof Promise&&(i=B(i)),i instanceof x?(i=i.pipe(Ul({})),n.options.cancelUncompleted&&(i=i.pipe(VC(t.pipe(hI(e)))))):i=sl({}).pipe(ah()),r.push(i)}catch(i){r.push(ol(i))}}}return r.length||r.push(sl({})),LC(r)}addToStatesMap(t){const e=[],n=this.statesByName;for(const r of t){const t=II.checkStateNameIsUnique(r,n);!n[t]&&(e.push(r),n[t]=r)}return{newStates:e}}addRuntimeInfoToMeta(t,e){this.statePaths[t.name]=e,t.path=e}hasBeenMountedAndBootstrapped(t,e){const n=void 0!==oI(this._initialState,e);return this.statesByName[t]&&n}}return t.\u0275fac=function(e){return new(e||t)(cr(_s),cr(eI),cr(t,12),cr(mI),cr(wI),cr(CI),cr(PC,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),kI=(()=>{class t{constructor(t,e,n){this.internalStateOperations=t,this.stateContextFactory=e,this.bootstrapper=n}ngxsBootstrap(t,e){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(Rl(()=>!!e),$l(()=>this.invokeInit(e.states)),G(()=>this.bootstrapper.appBootstrapped$),Rl(t=>!!t)).subscribe(()=>this.invokeBootstrap(e.states))}invokeInit(t){for(const e of t){const t=e.instance;if(t.ngxsOnChanges){const n=lI(e,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});t.ngxsOnChanges(n)}t.ngxsOnInit&&t.ngxsOnInit(this.getStateContext(e)),e.isInitialised=!0}}invokeBootstrap(t){for(const e of t){const t=e.instance;t.ngxsAfterBootstrap&&t.ngxsAfterBootstrap(this.getStateContext(e))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return t.\u0275fac=function(e){return new(e||t)(cr(TI),cr(CI),cr(MC))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),OI=(()=>{class t{constructor(t,e,n,r,i,s){this._stateStream=t,this._internalStateOperations=e,this._config=n,this._internalExecutionStrategy=r,this._stateFactory=i,this.initStateStream(s)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const e=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(k(e),Fl(t=>{const{suppressErrors:e}=this._config.selectorOptions;return t instanceof TypeError&&e?sl(void 0):ol(t)}),$C(),fI(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(Ml(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(fI(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return function(t){const e=t.NGXS_SELECTOR_META||cI(t);return e&&e.makeRootSelector||(()=>t)}(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const e=this._stateStream.value;if(!e||0===Object.keys(e).length){const e=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(e)}}}return t.\u0275fac=function(e){return new(e||t)(cr(_I),cr(TI),cr(eI),cr(pI),cr(DI),cr(PC,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),MI=(()=>{class t{constructor(e,n){t.store=e,t.config=n}ngOnDestroy(){t.store=null,t.config=null}}return t.\u0275fac=function(e){return new(e||t)(cr(OI),cr(eI))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t.store=null,t.config=null,t})();class PI{static get type(){return"@@INIT"}}class NI{constructor(t){this.addedStates=t}static get type(){return"@@UPDATE_STATE"}}const RI=new hl(1);let jI=(()=>{class t{constructor(t,e,n,r,i=[],s){!function(){try{const t=window.ng,e=!(t.probe&&t.coreTokens)&&Bu();RI.next(e)}catch(t){RI.next(!1)}finally{RI.complete()}}();const o=t.addAndReturnDefaults(i);e.setStateToTheCurrentWithNew(o),t.connectActionHandlers(),s.ngxsBootstrap(new PI,o)}}return t.\u0275fac=function(e){return new(e||t)(cr(DI),cr(TI),cr(OI),cr(MI),cr(ZC,8),cr(kI))},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({}),t})(),LI=(()=>{class t{constructor(e,n,r,i=[],s){const o=t.flattenStates(i),a=r.addAndReturnDefaults(o);a.states.length&&(n.setStateToTheCurrentWithNew(a),s.ngxsBootstrap(new NI(a.defaults),a))}static flattenStates(t=[]){return t.reduce((t,e)=>t.concat(e),[])}}return t.\u0275fac=function(e){return new(e||t)(cr(OI),cr(TI),cr(DI),cr(YC,8),cr(kI))},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({}),t})();class FI{static forRoot(t=[],e={}){return{ngModule:jI,providers:[DI,CI,yI,mI,MC,AI,SI,kI,xI,wI,TI,pI,OI,_I,MI,vI,...t,...FI.ngxsTokenProviders(t,e)]}}static forFeature(t=[]){return{ngModule:LI,providers:[DI,vI,...t,{provide:YC,multi:!0,useValue:t}]}}static ngxsTokenProviders(t,e){return[{provide:JC,useValue:OC},{provide:tI,useValue:Bu},{provide:rI,useClass:e.executionStrategy||KC},{provide:ZC,useValue:t},{provide:FI.ROOT_OPTIONS,useValue:e},{provide:eI,useFactory:FI.ngxsConfigFactory,deps:[FI.ROOT_OPTIONS]},{provide:lu,useFactory:FI.appBootstrapListenerFactory,multi:!0,deps:[MC]},{provide:PC,useFactory:FI.getInitialState},{provide:RC,useExisting:CI},{provide:jC,useExisting:DI}]}static ngxsConfigFactory(t){return uI(new eI,t)}static appBootstrapListenerFactory(t){return()=>t.bootstrap()}static getInitialState(){return NC.pop()}}FI.\u0275fac=function(t){return new(t||FI)},FI.\u0275mod=Zt({type:FI}),FI.\u0275inj=mt({}),FI.ROOT_OPTIONS=new Wn("ROOT_OPTIONS");const BI=new Wn("NgValueAccessor"),zI=new el(Jc);class UI{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new VI(t,this.dueTime,this.scheduler))}}class VI extends b{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(GI,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function GI(t){t.debouncedNext()}function HI(t){return null!=t&&"false"!=`${t}`}function $I(t,e=0){return function(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):e}function qI(t){return t instanceof zo?t.nativeElement:t}let WI;try{WI="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(qO){WI=!1}let XI,KI,ZI=(()=>{class t{constructor(t){this._platformId=t,this.isBrowser=this._platformId?wc(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!WI)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(cr(cu))},t.\u0275prov=gt({factory:function(){return new t(cr(cu))},token:t,providedIn:"root"}),t})(),YI=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({}),t})();function QI(t){return function(){if(null==XI&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>XI=!0}))}finally{XI=XI||!1}return XI}()?t:!!t.capture}function JI(t){return t.composedPath?t.composedPath()[0]:t.target}let tD=(()=>{class t{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=gt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),eD=(()=>{class t{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,e)=>this._cleanupObserver(e))}observe(t){const e=qI(t);return new x(t=>{const n=this._observeElement(e).subscribe(t);return()=>{n.unsubscribe(),this._unobserveElement(e)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const e=new C,n=this._mutationObserverFactory.create(t=>e.next(t));n&&n.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:n,stream:e,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:e,stream:n}=this._observedElements.get(t);e&&e.disconnect(),n.complete(),this._observedElements.delete(t)}}}return t.\u0275fac=function(e){return new(e||t)(cr(tD))},t.\u0275prov=gt({factory:function(){return new t(cr(tD))},token:t,providedIn:"root"}),t})(),nD=(()=>{class t{constructor(t,e,n){this._contentObserver=t,this._elementRef=e,this._ngZone=n,this.event=new Ua,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=HI(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=$I(t),this._subscribe()}ngAfterContentInit(){this._currentSubscription||this.disabled||this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(function(t,e=zI){return n=>n.lift(new UI(t,e))}(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){var t;null===(t=this._currentSubscription)||void 0===t||t.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(js(eD),js(zo),js(Au))},t.\u0275dir=Qt({type:t,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),t})(),rD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({providers:[tD]}),t})();function iD(t){return 0===t.offsetX&&0===t.offsetY}function sD(t){const e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}"undefined"!=typeof Element&&Element;const oD=new Wn("cdk-input-modality-detector-options"),aD={ignoreKeys:[18,17,224,91,16]},uD=QI({passive:!0,capture:!0});let cD=(()=>{class t{constructor(t,e,n,r){this._platform=t,this._mostRecentTarget=null,this._modality=new Tl(null),this._lastTouchMs=0,this._onKeydown=t=>{var e,n;(null===(n=null===(e=this._options)||void 0===e?void 0:e.ignoreKeys)||void 0===n?void 0:n.some(e=>e===t.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=JI(t))},this._onMousedown=t=>{Date.now()-this._lastTouchMs<650||(this._modality.next(iD(t)?"keyboard":"mouse"),this._mostRecentTarget=JI(t))},this._onTouchstart=t=>{sD(t)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=JI(t))},this._options=Object.assign(Object.assign({},aD),r),this.modalityDetected=this._modality.pipe(t=>t.lift(new Xl(1))),this.modalityChanged=this.modalityDetected.pipe($C()),t.isBrowser&&e.runOutsideAngular(()=>{n.addEventListener("keydown",this._onKeydown,uD),n.addEventListener("mousedown",this._onMousedown,uD),n.addEventListener("touchstart",this._onTouchstart,uD)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,uD),document.removeEventListener("mousedown",this._onMousedown,uD),document.removeEventListener("touchstart",this._onTouchstart,uD))}}return t.\u0275fac=function(e){return new(e||t)(cr(ZI),cr(Au),cr(Qu),cr(oD,8))},t.\u0275prov=gt({factory:function(){return new t(cr(ZI),cr(Au),cr(Qu),cr(oD,8))},token:t,providedIn:"root"}),t})();const lD=new Wn("cdk-focus-monitor-default-options"),hD=QI({passive:!0,capture:!0});let dD=(()=>{class t{constructor(t,e,n,r,i){this._ngZone=t,this._platform=e,this._inputModalityDetector=n,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new C,this._rootNodeFocusAndBlurListener=t=>{const e=JI(t),n="focus"===t.type?this._onFocus:this._onBlur;for(let r=e;r;r=r.parentElement)n.call(this,t,r)},this._document=r,this._detectionMode=(null==i?void 0:i.detectionMode)||0}monitor(t,e=!1){const n=qI(t);if(!this._platform.isBrowser||1!==n.nodeType)return sl(null);const r=function(t){if(function(){if(null==KI){const t="undefined"!=typeof document?document.head:null;KI=!(!t||!t.createShadowRoot&&!t.attachShadow)}return KI}()){const e=t.getRootNode?t.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(n)||this._getDocument(),i=this._elementInfo.get(n);if(i)return e&&(i.checkChildren=!0),i.subject;const s={checkChildren:e,subject:new C,rootNode:r};return this._elementInfo.set(n,s),this._registerGlobalListeners(s),s.subject}stopMonitoring(t){const e=qI(t),n=this._elementInfo.get(e);n&&(n.subject.complete(),this._setClasses(e),this._elementInfo.delete(e),this._removeGlobalListeners(n))}focusVia(t,e,n){const r=qI(t);r===this._getDocument().activeElement?this._getClosestElementsInfo(r).forEach(([t,n])=>this._originChanged(t,e,n)):(this._setOrigin(e),"function"==typeof r.focus&&r.focus(n))}ngOnDestroy(){this._elementInfo.forEach((t,e)=>this.stopMonitoring(e))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,e,n){n?t.classList.add(e):t.classList.remove(e)}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,e){this._toggleClass(t,"cdk-focused",!!e),this._toggleClass(t,"cdk-touch-focused","touch"===e),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===e),this._toggleClass(t,"cdk-mouse-focused","mouse"===e),this._toggleClass(t,"cdk-program-focused","program"===e)}_setOrigin(t,e=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&e,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,e){const n=this._elementInfo.get(e),r=JI(t);n&&(n.checkChildren||e===r)&&this._originChanged(e,this._getFocusOrigin(r),n)}_onBlur(t,e){const n=this._elementInfo.get(e);!n||n.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(this._setClasses(e),this._emitOrigin(n.subject,null))}_emitOrigin(t,e){this._ngZone.run(()=>t.next(e))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const e=t.rootNode,n=this._rootNodeFocusListenerCount.get(e)||0;n||this._ngZone.runOutsideAngular(()=>{e.addEventListener("focus",this._rootNodeFocusAndBlurListener,hD),e.addEventListener("blur",this._rootNodeFocusAndBlurListener,hD)}),this._rootNodeFocusListenerCount.set(e,n+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(VC(this._stopInputModalityDetector)).subscribe(t=>{this._setOrigin(t,!0)}))}_removeGlobalListeners(t){const e=t.rootNode;if(this._rootNodeFocusListenerCount.has(e)){const t=this._rootNodeFocusListenerCount.get(e);t>1?this._rootNodeFocusListenerCount.set(e,t-1):(e.removeEventListener("focus",this._rootNodeFocusAndBlurListener,hD),e.removeEventListener("blur",this._rootNodeFocusAndBlurListener,hD),this._rootNodeFocusListenerCount.delete(e))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,e,n){this._setClasses(t,e),this._emitOrigin(n.subject,e),this._lastFocusOrigin=e}_getClosestElementsInfo(t){const e=[];return this._elementInfo.forEach((n,r)=>{(r===t||n.checkChildren&&r.contains(t))&&e.push([r,n])}),e}}return t.\u0275fac=function(e){return new(e||t)(cr(Au),cr(ZI),cr(cD),cr(Qu,8),cr(lD,8))},t.\u0275prov=gt({factory:function(){return new t(cr(Au),cr(ZI),cr(cD),cr(Qu,8),cr(lD,8))},token:t,providedIn:"root"}),t})();const fD="cdk-high-contrast-black-on-white",pD="cdk-high-contrast-white-on-black",gD="cdk-high-contrast-active";let mD=(()=>{class t{constructor(t,e){this._platform=t,this._document=e}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const e=this._document.defaultView||window,n=e&&e.getComputedStyle?e.getComputedStyle(t):null,r=(n&&n.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),r){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(gD),t.remove(fD),t.remove(pD),this._hasCheckedHighContrastMode=!0;const e=this.getHighContrastMode();1===e?(t.add(gD),t.add(fD)):2===e&&(t.add(gD),t.add(pD))}}}return t.\u0275fac=function(e){return new(e||t)(cr(ZI),cr(Qu))},t.\u0275prov=gt({factory:function(){return new t(cr(ZI),cr(Qu))},token:t,providedIn:"root"}),t})(),yD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({}),t})();const bD=new Ho("12.1.3");function _D(){return"undefined"!=typeof window&&void 0!==window.document}function vD(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let wD=(t,e)=>!1,xD=(t,e)=>!1,ED=(t,e,n)=>[];const SD=vD();(SD||"undefined"!=typeof Element)&&(wD=_D()?(t,e)=>{for(;e&&e!==document.documentElement;){if(e===t)return!0;e=e.parentNode||e.host}return!1}:(t,e)=>t.contains(e),xD=(()=>{if(SD||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):xD}})(),ED=(t,e,n)=>{let r=[];if(n){const n=t.querySelectorAll(e);for(let t=0;t<n.length;t++)r.push(n[t])}else{const n=t.querySelector(e);n&&r.push(n)}return r});function AD(t,e,n){return n?e+":"+n+";":""}function TD(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=AD(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=AD(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function CD(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const i=kD(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]}),vD()&&TD(t))}function ID(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=kD(e);t.style[n]=""}),vD()&&TD(t))}const DD=/-+([a-z0-9])/g;function kD(t){return t.replace(DD,(...t)=>t[1].toUpperCase())}class OD{constructor(t,e,n){this._element=t,this._startStyles=e,this._endStyles=n,this._state=0;let r=OD.initialStylesByElement.get(t);r||OD.initialStylesByElement.set(t,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&CD(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(CD(this._element,this._initialStyles),this._endStyles&&(CD(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(OD.initialStylesByElement.delete(this._element),this._startStyles&&(ID(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ID(this._element,this._endStyles),this._endStyles=null),CD(this._element,this._initialStyles),this._state=3)}}OD.initialStylesByElement=new WeakMap;const MD=new Wn("AnimationModuleType"),PD=new Ho("12.1.3"),ND=new Wn("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let RD,jD=(()=>{class t{constructor(t,e,n){this._hasDoneGlobalChecks=!1,this._document=n,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=e,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const t=this._document.defaultView||window;return"object"==typeof t&&t?t:null}_checksAreEnabled(){return Bu()&&!this._isTestEnv()}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype)&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const e=getComputedStyle(t);e&&"none"!==e.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&PD.full!==bD.full&&console.warn("The Angular Material version ("+PD.full+") does not match the Angular CDK version ("+bD.full+").\nPlease ensure the versions of these two packages exactly match.")}}return t.\u0275fac=function(e){return new(e||t)(cr(mD),cr(ND,8),cr(Qu))},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[yD],yD]}),t})();function LD(t){return class extends t{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=HI(t)}}}function FD(t,e){return class extends t{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const e=t||this.defaultColor;e!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),e&&this._elementRef.nativeElement.classList.add(`mat-${e}`),this._color=e)}}}function BD(t){return class extends t{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=HI(t)}}}function zD(t,e=0){return class extends t{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?$I(t):this.defaultTabIndex}}}try{RD="undefined"!=typeof Intl}catch(qO){RD=!1}class UD{constructor(t,e,n){this._renderer=t,this.element=e,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const VD={enterDuration:225,exitDuration:150},GD=QI({passive:!0}),HD=["mousedown","touchstart"],$D=["mouseup","mouseleave","touchend","touchcancel"];class qD{constructor(t,e,n,r){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=qI(n))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=Object.assign(Object.assign({},VD),n.animation);n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const s=n.radius||function(t,e,n){const r=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),i=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(r*r+i*i)}(t,e,r),o=t-r.left,a=e-r.top,u=i.enterDuration,c=document.createElement("div");c.classList.add("mat-ripple-element"),c.style.left=o-s+"px",c.style.top=a-s+"px",c.style.height=2*s+"px",c.style.width=2*s+"px",null!=n.color&&(c.style.backgroundColor=n.color),c.style.transitionDuration=`${u}ms`,this._containerElement.appendChild(c),window.getComputedStyle(c).getPropertyValue("opacity"),c.style.transform="scale(1)";const l=new UD(this,c,n);return l.state=0,this._activeRipples.add(l),n.persistent||(this._mostRecentTransientRipple=l),this._runTimeoutOutsideZone(()=>{const t=l===this._mostRecentTransientRipple;l.state=1,n.persistent||t&&this._isPointerDown||l.fadeOut()},u),l}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const n=t.element,r=Object.assign(Object.assign({},VD),t.config.animation);n.style.transitionDuration=`${r.exitDuration}ms`,n.style.opacity="0",t.state=2,this._runTimeoutOutsideZone(()=>{t.state=3,n.parentNode.removeChild(n)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=qI(t);e&&e!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(HD))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents($D),this._pointerUpEventsRegistered=!0)}_onMousedown(t){const e=iD(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||e||n||(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!sD(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let t=0;t<e.length;t++)this.fadeInRipple(e[t].clientX,e[t].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(t=>{this._triggerElement.addEventListener(t,this,GD)})})}_removeTriggerEvents(){this._triggerElement&&(HD.forEach(t=>{this._triggerElement.removeEventListener(t,this,GD)}),this._pointerUpEventsRegistered&&$D.forEach(t=>{this._triggerElement.removeEventListener(t,this,GD)}))}}const WD=new Wn("mat-ripple-global-options");let XD=(()=>{class t{constructor(t,e,n,r,i){this._elementRef=t,this._animationMode=i,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new qD(this,e,t,n)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,e=0,n){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,e,Object.assign(Object.assign({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return t.\u0275fac=function(e){return new(e||t)(js(zo),js(Au),js(ZI),js(WD,8),js(MD,8))},t.\u0275dir=Qt({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,e){2&t&&no("mat-ripple-unbounded",e.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),t})(),KD=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[jD,YI],jD]}),t})();new class extends el{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,r=-1,i=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++r<i&&(t=e.shift()));if(this.active=!1,n){for(;++r<i&&(t=e.shift());)t.unsubscribe();throw n}}}(class extends Jc{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(()=>t.flush(null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(cancelAnimationFrame(e),t.scheduled=void 0)}});let ZD=1;const YD=Promise.resolve(),QD={};function JD(t){return t in QD&&(delete QD[t],!0)}const tk={setImmediate(t){const e=ZD++;return QD[e]=!0,YD.then(()=>JD(e)&&t()),e},clearImmediate(t){JD(t)}};function ek(t){return null==t}function nk(t){return!ek(t)}new class extends el{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,r=-1,i=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++r<i&&(t=e.shift()));if(this.active=!1,n){for(;++r<i&&(t=e.shift());)t.unsubscribe();throw n}}}(class extends Jc{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=tk.setImmediate(t.flush.bind(t,null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(tk.clearImmediate(e),t.scheduled=void 0)}}),"undefined"!=typeof window&&window,n(266),n(478),new Wn("SECURITY_CONTEXT");let rk=(()=>{class t{constructor(t){this.sequence$=new Tl(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return t.\u0275fac=function(e){return new(e||t)(cr(OI,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),ik=(()=>{class t{constructor(e,n,r){t.store=e.get(OI),t.ngZone=e.get(Au),t.factory=n,t.context=r,t.computed=e.get(rk)}}return t.store=null,t.computed=null,t.context=null,t.factory=null,t.ngZone=null,t.\u0275fac=function(e){return new(e||t)(cr(_s),cr(jC),cr(RC))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class sk{constructor(){sk.statesCachedMeta.clear()}static createStateContext(t){return ik.context.createStateContext(t)}static ensureMappedState(t){if(ek(ik.factory)||ek(t))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(nk(t.name)?sk.statesCachedMeta.get(t.name):null)||sk.ensureMeta(t)}static getRepositoryByInstance(t){var e;const n=null!==(e=function(t){return t.NGXS_DATA_META}(sk.getStateClassByInstance(t)))&&void 0!==e?e:null;if(ek(n))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return n}static getStateClassByInstance(t){return(null!=t?t:{}).constructor}static clearMetaByInstance(t){const e=sk.getRepositoryByInstance(t);e.stateMeta.actions={},e.operations={}}static createPayload(t,e){const n={},r=Array.from(t);for(let i=0;i<r.length;i++){const t=null==e?void 0:e.getPayloadTypeByIndex(i);nk(t)&&(n[t]=r[i])}return Object.keys(n).length>0?n:null}static createAction(t,e,n){const r=sk.createPayload(e,n);var i;return new(i=t.type,class{constructor(t){t&&Object.keys(t).forEach(e=>{this[e]=t[e]})}static get type(){return i}})(r)}static ensureMeta(t){var e;const n=nk(t.name)?null===(e=ik.factory.states)||void 0===e?void 0:e.find(e=>e.name===t.name):null;return nk(n)&&nk(t.name)&&sk.statesCachedMeta.set(t.name,n),n}}sk.statesCachedMeta=new Map,sk.\u0275fac=function(t){return new(t||sk)},sk.\u0275prov=gt({token:sk,factory:sk.\u0275fac}),new hl(1),Error,Error;const ok=["bodyCanvas"];let ak=(()=>{class t{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new Ua,this.nodeDrag=new Ua,this.nodeClick=new Ua,this.nodeHoverStart=new Ua,this.nodeHoverStop=new Ua,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var e;this._scene=t,null===(e=this.bodyUI)||void 0===e||e.setScene(t)}get rotation(){return this._rotation}set rotation(t){var e;this._rotation=t,null===(e=this.bodyUI)||void 0===e||e.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var e;this._rotationX=t,null===(e=this.bodyUI)||void 0===e||e.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var e;this._zoom=t,null===(e=this.bodyUI)||void 0===e||e.setZoom(t)}get target(){return this._target}set target(t){var e;this._target=t,null===(e=this.bodyUI)||void 0===e||e.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,e={x:48,y:48}){if(this.bodyCanvas){const{width:n,height:r}=this.bodyCanvas.nativeElement,i=window.devicePixelRatio,s=Math.min(Math.log2((n-e.x)/i/t.x),Math.log2((r-e.y)/i/t.y));this.zoom=s}}setupBodyUI(){var t;return Al(this,void 0,void 0,function*(){const e=this.bodyCanvas.nativeElement,n=new CC({id:"body-ui",canvas:e,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});e.addEventListener("contextmenu",t=>t.preventDefault()),yield n.initialize(),this.bodyUI=n,window.bodyUI=n,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(t=>this.rotationChange.next(t)),this.bodyUI.nodeDrag$.subscribe(t=>this.nodeDrag.emit(t)),this.bodyUI.nodeClick$.subscribe(t=>this.nodeClick.emit(t)),this.bodyUI.nodeHoverStart$.subscribe(t=>this.nodeHoverStart.emit(t)),this.bodyUI.nodeHoverStop$.subscribe(t=>this.nodeHoverStop.emit(t))]})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=qt({type:t,selectors:[["ccf-body-ui"]],viewQuery:function(t,e){if(1&t&&tu(ok,5,zo),2&t){let t;Ja(t=eu())&&(e.bodyCanvas=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&ro(e.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,e){1&t&&Us(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-bottom-left-radius:.5rem;border-bottom-right-radius:.5rem;border-top-right-radius:.5rem;border-top-left-radius:.5rem}"]}),t})(),uk=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[vc]]}),t})();new Wn("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10});const ck=[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:large_intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:brain",organ:"Brain",name:"Allen Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lymph_nodes",organ:"Lymph Node",name:"Lymph Node, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph_nodes",organ:"Lymph Node",name:"Lymph Node, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:bone_marrow",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{src:"app:vasculature",organ:"Vasculature",name:"Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}];function lk(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}let hk;function dk(){return hk||(hk=function(t,e){const n=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let t;return new Promise(e=>{const n=()=>indexedDB.databases().finally(e);t=setInterval(n,100),n()}).finally(()=>clearInterval(t))}().then(()=>{const t=indexedDB.open("keyval-store");return t.onupgradeneeded=()=>t.result.createObjectStore(e),lk(t)});return(t,r)=>n.then(n=>r(n.transaction(e,t).objectStore(e)))}(0,"keyval")),hk}function fk(t,e=dk()){return e("readonly",e=>lk(e.get(t)))}ck.filter(t=>!0!==t.disabled),function(){const t=localStorage.getItem("ALLOW_TELEMETRY");null===t||t.toLowerCase()}();var pk=n(440),gk=n(698),mk=n(445),yk=n.n(mk),bk=n(815),_k=n(609);const vk=pk.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},pk.DataFactory),wk={x:vk("rdf"),type:vk("rdf")("type")},xk={x:vk("rdfs"),label:vk("rdfs")("label"),comment:vk("rdfs")("comment"),isDefinedBy:vk("rdfs")("isDefinedBy"),seeAlso:vk("rdfs")("seeAlso")},Ek={x:vk("entity"),id:vk("entity")("id"),label:xk.label,description:xk.comment,link:xk.seeAlso,sex:vk("entity")("sex"),age:vk("entity")("age"),bmi:vk("entity")("bmi"),Male:pk.DataFactory.literal("Male"),Female:pk.DataFactory.literal("Female"),consortiumName:vk("entity")("consortium_name"),providerName:vk("entity")("provider_name"),providerUUID:vk("entity")("provider_uuid"),donor:vk("entity")("has_donor"),sections:vk("entity")("has_tissue_section"),datasets:vk("entity")("has_dataset"),sampleType:vk("entity")("sample_type"),TissueBlock:pk.DataFactory.literal("Tissue Block"),TissueSection:pk.DataFactory.literal("Tissue Section"),NonStandard:pk.DataFactory.literal("Non-standard"),sectionCount:vk("entity")("section_count"),sectionSize:vk("entity")("section_size"),sectionUnits:vk("entity")("section_units"),sectionNumber:vk("entity")("section_number"),spatialEntity:vk("entity")("has_spatial_entity"),ontologyTerms:vk("entity")("has_ontology_term"),technology:vk("entity")("technology"),thumbnail:vk("entity")("has_thumbnail")},Sk=vk("ccf"),Ak={x:Sk,ontologyNode:{label:Sk("ccf_preferred_label"),parent:Sk("ccf_part_of"),children:Sk("ccf_part_of"),rui_rank:Sk("ccf_rui_rank"),synonymLabels:pk.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},spatial:{Female:Sk("VHFemale"),Male:Sk("VHMale"),BothSexes:Sk("VHBothSexes"),FemaleOrgans:Sk("VHFemaleOrgans"),MaleOrgans:Sk("VHMaleOrgans")},SpatialObjectReference:Sk("SpatialObjectReference"),SpatialEntity:Sk("SpatialEntity"),SpatialPlacement:Sk("SpatialPlacement"),spatialObjectReference:{file:Sk("has_object_file"),file_format:Sk("has_object_file_format"),file_subpath:Sk("has_object_file_subpath")},extractionSet:{label:xk.label,rui_rank:Sk("ccf_rui_rank")},spatialEntity:{label:xk.label,comment:xk.comment,creator:vk("dc")("creator"),creator_first_name:Sk("creator_first_name"),creator_last_name:Sk("creator_last_name"),creator_orcid:Sk("creator_orcid"),creation_date:Sk("creation_date"),updated_date:Sk("updated_date"),ccf_annotations:Sk("ccf_annotation"),representation_of:Sk("ccf_representation_of"),reference_organ:Sk("anatomical_structure_of"),extraction_set_for:Sk("extraction_set_for"),extraction_set:Sk("extraction_site_for"),sex:Sk("has_sex"),side:Sk("has_side"),rui_rank:Sk("ccf_rui_rank"),slice_thickness:Sk("ccf_slice_thickness"),slice_count:Sk("ccf_slice_count"),x_dimension:Sk("has_x_dimension"),y_dimension:Sk("has_y_dimension"),z_dimension:Sk("has_z_dimension"),dimension_units:Sk("has_dimension_units"),object:Sk("has_object_reference")},spatialPlacement:{source:Sk("has_placement_source"),target:Sk("has_placement_target"),placement_date:Sk("has_placement_date"),x_scaling:Sk("has_x_scaling"),y_scaling:Sk("has_y_scaling"),z_scaling:Sk("has_z_scaling"),scaling_units:Sk("has_scaling_units"),x_rotation:Sk("has_x_rotation"),y_rotation:Sk("has_y_rotation"),z_rotation:Sk("has_z_rotation"),w_rotation:Sk("has_theta_rotation"),rotation_order:Sk("has_rotation_order"),rotation_units:Sk("has_rotation_units"),x_translation:Sk("has_x_translation"),y_translation:Sk("has_y_translation"),z_translation:Sk("has_z_translation"),translation_units:Sk("has_translation_units")}},Tk={x:vk("uberon")},Ck=(vk("lmha"),{bladder:Tk.x("0001255"),body:Tk.x("0013702"),brain:Tk.x("0000955"),colon:Tk.x("0001155"),heart:Tk.x("0000948"),kidney:Tk.x("0002113"),large_intestine:Tk.x("0000059"),left_kidney:Tk.x("0004538"),left_lung:Tk.x("0002168"),left_ureter:Tk.x("0001223"),liver:Tk.x("0002107"),lung:Tk.x("0002048"),lymph_node:Tk.x("0000029"),pelvis:Tk.x("0001270"),rectum:Tk.x("0001052"),right_kidney:Tk.x("0004539"),right_lung:Tk.x("0002167"),right_ureter:Tk.x("0001222"),skin:Tk.x("0002097"),small_intestine:Tk.x("0002108"),spleen:Tk.x("0002106"),thymus:Tk.x("0002370"),ureter:Tk.x("0000056"),vasculature:Tk.x("0002049")});function Ik(t){const e={};return Object.entries(t).forEach(([t,n])=>{e[n.id]=t}),e}const Dk={spatialObjectReference:Ik(Ak.spatialObjectReference),spatialEntity:Ik(Ak.spatialEntity),spatialPlacement:Ik(Ak.spatialPlacement)};function kk(t,e,n,r){const i={"@id":e,"@type":n};return t.some(t=>{const e=r[t.predicate.id];if(e){const n="Literal"===t.object.termType?(0,_k.fromRdf)(t.object):t.object.id;(0,bk.set)(i,e,n)}return!1},pk.DataFactory.namedNode(e),null,null,null),i}const Ok=(0,bk.memoize)(function(t,e){return kk(t,e,"SpatialObjectReference",Dk.spatialObjectReference)},(t,e)=>e),Mk=(0,bk.memoize)(function(t,e){const n=kk(t,e,"ExtractionSet",Dk.spatialEntity);return n.extractionSites=(0,bk.sortBy)(t.getSubjects(Ak.spatialEntity.extraction_set,e,null).map(e=>jk(t,e.id)),["rui_rank"]),n},(t,e)=>e),Pk=(0,bk.memoize)(function(t,e){return(0,bk.sortBy)(t.getSubjects(Ak.spatialEntity.extraction_set_for,e,null).map(e=>Mk(t,e.id)),["rui_rank"])},(t,e)=>e),Nk=(0,bk.memoize)(function(t,e){return(0,bk.sortBy)(t.getSubjects(Ak.spatialEntity.reference_organ,e,null).map(e=>jk(t,e.id)).filter(t=>t["@id"]!==e),["rui_rank"])},(t,e)=>e),Rk=(0,bk.memoize)(function(t){const e=[];return t.forEach(n=>{n.subject.id===n.object.id&&e.push(jk(t,n.subject.id))},null,Ak.spatialEntity.reference_organ,null,null),(0,bk.sortBy)(e,["rui_rank"])}),jk=(0,bk.memoize)(function(t,e){const n=kk(t,e,"SpatialEntity",Dk.spatialEntity);return n.object&&(n.object=Ok(t,n.object)),n.ccf_annotations&&(n.ccf_annotations=t.getObjects(e,Ak.spatialEntity.ccf_annotations,null).map(t=>t.id)),t.forSubjects(t=>n.entityId=t.id,Ek.spatialEntity,e,null),n},(t,e)=>e),Lk=(0,bk.memoize)(function(t,e){const n=kk(t,e,"SpatialPlacement",Dk.spatialPlacement);return n.source&&(n.source=jk(t,n.source)),n.target&&(n.target=jk(t,n.target)),n},(t,e)=>e),Fk=(0,bk.memoize)(function(t,e){const n=t.getObjects(pk.DataFactory.namedNode(e),Ek.spatialEntity,null);return n.length>0?jk(t,n[0].id):void 0},(t,e)=>e);function Bk(t,e){const n=e;let r;switch(n.translation_units){case"centimeter":r=.01;break;case"millimeter":r=.001;break;case"meter":default:r=1}const i=[n.x_translation,n.y_translation,n.z_translation].map(t=>t*r),s=[n.x_rotation,n.y_rotation,n.z_rotation].map(Ff),o=[n.x_scaling,n.y_scaling,n.z_scaling];return t.translate(i).rotateXYZ(s).scale(o)}class zk{constructor(t){this.db=t,this.createGraph()}createGraph(){this.graph=new gk.DirectedGraph;const t=this.db.store;t.forSubjects(t=>{this.addNode(t.id,"SpatialObjectReference")},wk.type,Ak.SpatialObjectReference,null),t.forSubjects(t=>{this.addNode(t.id,"SpatialEntity")},wk.type,Ak.SpatialEntity,null);const e={};t.some(t=>(e[t.subject.id]=t.object.id,!1),null,Ak.spatialPlacement.source,null,null),t.some(t=>{const n=e[t.subject.id];return n&&this.addEdge(t.subject.id,n,t.object.id,"SpatialPlacement"),!1},null,Ak.spatialPlacement.target,null,null)}addNode(t,e){this.graph.mergeNode(t,{type:e})}addEdge(t,e,n,r){this.graph.mergeDirectedEdge(e,n,{type:r,id:t})}getTransformationMatrix(t,e){if(t===e)return new my(my.IDENTITY);if(!this.graph.hasNode(t)||!this.graph.hasNode(e))return;const n=this.db.store,r=new my(my.IDENTITY),i=yk()(this.graph,t,e);if(i&&i.length>0){i.reverse();let t="";for(const e of i){if(t){const i=this.graph.getEdgeAttribute(e,t,"id");Bk(r,Lk(n,i))}t=e}return r}}}class Uk{constructor(t){this.db=t}getSpatialEntity(t){return jk(this.db.store,t)}getExtractionSets(t){return Pk(this.db.store,t)}getExtractionSet(t){return Mk(this.db.store,t)}getAnatomicalStructures(t){return Nk(this.db.store,t)}getReferenceOrgans(){return Rk(this.db.store)}getReferenceBody(t){let e;switch(null==t?void 0:t.sex){case"Male":e=Ak.spatial.Male.id;break;case"Female":e=Ak.spatial.Female.id;break;case"Both":default:e=Ak.spatial.BothSexes.id}return this.getSpatialEntity(e)}getReferenceOrganSets(t){let e=this.getReferenceOrgans();switch(null==t?void 0:t.sex){case"Male":e=e.filter(t=>"Male"===t.sex);break;case"Female":e=e.filter(t=>"Female"===t.sex)}return(null==t?void 0:t.debug)&&(e=e.map(t=>[[t],this.getAnatomicalStructures(t["@id"])]).reduce((t,[e,n])=>t.concat(n.length>0?n:e),[])),e}getReferenceSceneNodes(t){const e=this.getReferenceBody(t);let n=[...this.getReferenceOrganSets(t).map(t=>{const n="http://purl.obolibrary.org/obo/UBERON_0002097"===t.representation_of;return this.getSceneNode(t,e,{color:[255,255,255,255],opacity:n?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!n})})];return(null==t?void 0:t.debug)&&(n=n.concat([this.getSceneNode(this.getSpatialEntity(Ak.x("VHRightKidney").id),e,{color:[0,0,255,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(Ak.x("VHLeftKidney").id),e,{color:[255,0,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(Ak.x("VHSpleenCC1").id),e,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(Ak.x("VHSpleenCC2").id),e,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(Ak.x("VHSpleenCC3").id),e,{color:[0,255,0,127.5],wireframe:!0})])),n.filter(t=>void 0!==t)}getReferenceOrganScene(t,e){var n;const r=this.getReferenceOrgans().filter(n=>n.representation_of===t&&n.sex===(null==e?void 0:e.sex));if(r.length>0){const t=r[0],i=this.getSceneNode(t,t,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===t.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),s=(null!==(n=this.db.getSpatialEntities(e))&&void 0!==n?n:[]).map(e=>this.getSceneNode(e,t,{color:[255,255,255,229.5]}));return[i].concat(s).filter(t=>void 0!==t)}return[]}getEntitySceneNodes(t){const e=this.getReferenceBody(t);return this.db.getSpatialEntities(t).map(t=>this.getSceneNode(t,e,{color:[255,255,255,229.5]})).filter(t=>void 0!==t)}getSceneNode(t,e,n={}){var r,i,s,o;const a=null===(i=null===(r=null==t?void 0:t.object)||void 0===r?void 0:r.file_format)||void 0===i?void 0:i.startsWith("model/gltf");let u=this.db.graph.getTransformationMatrix(a&&t.object?t.object["@id"]:t["@id"],e["@id"]);if(u){if(a)u=new my(my.IDENTITY).rotateX(Ff(90)).multiplyLeft(u);else{let e;switch(t.dimension_units){case"centimeter":e=.01;break;case"millimeter":e=.001;break;case"meter":default:e=1}const n=[t.x_dimension,t.y_dimension,t.z_dimension].map(t=>t*e/2);u.scale(n)}return Object.assign({"@id":t["@id"],"@type":"SpatialSceneNode",entityId:t.entityId,ccf_annotations:t.ccf_annotations,representation_of:t.representation_of,reference_organ:t.reference_organ,scenegraph:a?null===(s=t.object)||void 0===s?void 0:s.file:void 0,scenegraphNode:a?null===(o=t.object)||void 0===o?void 0:o.file_subpath:void 0,transformMatrix:u,tooltip:t.label},n)}}getScene(t){return[...this.getReferenceSceneNodes(t),...this.getEntitySceneNodes(t)]}}const Vk="https://entity.api.hubmapconsortium.org/entities/",Gk=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),Hk={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},$k={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford"},qk=function(){const t={};return Object.entries(Ck).forEach(([e,n])=>t[e]=n.id),t}(),Wk={BL:[qk.body,qk.bladder],RK:[qk.body,qk.kidney,qk.right_kidney],LK:[qk.body,qk.kidney,qk.left_kidney],HT:[qk.body,qk.heart],LI:[qk.body,qk.large_intestine,qk.colon],SI:[qk.body,qk.small_instestine],LL:[qk.body,qk.lung,qk.left_lung],RL:[qk.body,qk.lung,qk.right_lung],LY:[qk.body,qk.lymph_node],SP:[qk.body,qk.spleen],TH:[qk.body,qk.thymus],UR:[qk.body,qk.ureter],LV:[qk.body,qk.liver],OT:[qk.body]},Xk={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class Kk{constructor(t,e="",n="",r){var i,s;if(this.data=t,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const o=this.data.descendants||[],a=(this.data.ancestors||[]).find(t=>"Donor"===t.entity_type);this.donor=this.getDonor(a,n);const u=this.getRuiLocation(t,this.donor);u?this.rui_location=u:this.bad=!0;const c=new Date(t.last_modified_timestamp).toLocaleDateString(),l=$k[t.group_uuid]||t.group_name,h=t.created_by_user_displayname;this["@id"]=Vk+t.uuid,this.label=`Registered ${c}, ${h}, ${l}`,this.link=`${n}browse/sample/${t.uuid}`;const d={},f=[];this.sections=f;const p=[];this.datasets=p;for(const _ of o.filter(t=>"Sample"===t.entity_type)){const e=this.getSection(_,t,n);d[_.submission_id]=e,f.push(e),e.section_number=null!==(i=e.section_number)&&void 0!==i?i:f.length}for(const _ of o)if("Dataset"===_.entity_type){const t=this.getDataset(_,e,n,r),i=(0,bk.get)(_,["ingest_metadata","metadata","tissue_id"]);d[i]?null===(s=d[i].datasets)||void 0===s||s.push(t):p.push(t)}const g=null!=u?u:{},m=`${g.x_dimension} x ${g.y_dimension} x ${g.z_dimension} ${g.dimension_units}`;this.section_count=g.slice_count||f.length;const y=parseFloat((g.slice_thickness||(g.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=y;const b=g.dimension_units||"millimeter";this.section_units=b,this.description=`${m}, ${y} ${b}, ${t.specimen_type}, ${this.section_count} Sections`,f.forEach((t,e)=>{t.description=`${g.x_dimension} x ${g.y_dimension} x ${y} ${b}, ${y} ${b}, ${t.description}`,t.section_number=e+1})}getSection(t,e,n){const r=new Date(t.last_modified_timestamp).toLocaleDateString();return{"@id":Vk+t.uuid,"@type":"Sample",label:`Registered ${r}, ${t.created_by_user_displayname}, ${$k[t.group_uuid]||t.group_name}`,description:`${e.specimen_type}`,link:`${n}browse/sample/${t.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(t,e="",n="",r){var i;const s=new Date(t.last_modified_timestamp).toLocaleDateString(),o=$k[t.group_uuid]||t.group_name,a=t.created_by_user_displayname,u=[...t.data_types,(0,bk.get)(t,["ingest_metadata","metadata","assay_type"],"")],c=u.join("|").toLowerCase();let l,h="assets/icons/ico-unknown.svg";return-1!==c.indexOf("10x")?(l="10x",h="assets/icons/ico-bulk-10x.svg"):-1!==c.indexOf("af")?(l="AF",h="assets/icons/ico-spatial-af.svg"):-1!==c.indexOf("codex")?(l="CODEX",h="assets/icons/ico-spatial-codex.svg"):-1!==c.indexOf("imc")?(l="IMC",h="assets/icons/ico-spatial-imc.svg"):-1!==c.indexOf("lc")&&-1===c.indexOf("af")?(l="LC",h="assets/icons/ico-bulk-lc.svg"):l=-1!==c.indexOf("maldi")?"MALDI":-1!==c.indexOf("pas")?"PAS":"OTHER",h=null!==(i=this.getDatasetThumbnail(t,e,r))&&void 0!==i?i:h,{"@id":Vk+t.uuid,"@type":"Dataset",label:`Registered ${s}, ${a}, ${o}`,description:`Data/Assay Types: ${u.join(", ")}`,link:`${n}browse/dataset/${t.uuid}`,technology:l,thumbnail:h}}getDatasetThumbnail(t,e,n){if(t.thumbnail_file){const r=t.thumbnail_file;return`${e}/${r.file_uuid}/${r.filename}`+(n?`?token=${n}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===t.group_uuid){const r=(0,bk.get)(t,"metadata.files",[]).filter(t=>/\.(ome\.tif|ome\.tiff)$/.test(t.rel_path)).filter(t=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(t.rel_path)).filter(t=>Gk.has(t.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(r=>`${e}/${t.uuid}/${r.rel_path}`+(n?`?token=${n}`:""));if(r.length>0){const t=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(Gk.has(t))return`assets/thumbnails/TMC-Vanderbilt/DR1/${t}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===t.group_uuid){const e=Hk[t.hubmap_id];if(e)return`assets/thumbnails/TMC-Florida/${e}`}}getDonor(t,e){const n=(t.description||"").toLowerCase();let r;n.includes("female")?r="Female":n.includes("male")&&(r="Male");const i=n.match(/age ([0-9]+)/);let s,o;i&&(s=(0,bk.toNumber)(i[1]));for(const l of(0,bk.get)(t,"metadata.organ_donor_data",[]))"Feminine gender"===l.preferred_term||"Female"===l.preferred_term?r="Female":"Masculine gender"===l.preferred_term||"Male"===l.preferred_term?r="Male":"Current chronological age"===l.preferred_term||"Age"===l.preferred_term?s=(0,bk.toNumber)(l.data_value):"Body mass index"===l.preferred_term&&(o=(0,bk.toNumber)(l.data_value));let a="";r&&s&&(a+=`${r}, Age ${s}`,o&&(a+=`, BMI ${o.toFixed(1)}`));const u=new Date(t.last_modified_timestamp).toLocaleDateString(),c=$k[t.group_uuid]||t.group_name;return{"@id":Vk+t.uuid,"@type":"Donor",label:a,description:`Entered ${u}, ${t.created_by_user_displayname}, ${c}`,link:`${e}browse/donor/${t.uuid}`,age:s,sex:r,bmi:o,consortium_name:"HuBMAP",provider_name:c,provider_uuid:t.group_uuid,samples:[]}}getRuiLocation(t,e){var n;const r=(t.ancestors||[]).find(t=>"Sample"===t.entity_type&&"organ"===t.specimen_type),i=Wk[null==r?void 0:r.organ]||[qk.body];let s,o=t.rui_location;if(o&&("string"==typeof o&&(o=JSON.parse(o)),o.alignment_id?console.log("Detected a deprecated rui_location",t.uuid):o["@id"]&&(s=o)),s){s.ccf_annotations=i.concat(s.ccf_annotations||[]);const t=null!==(n=(0,bk.get)(s,["placement","target"]))&&void 0!==n?n:"";t.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")&&(0,bk.set)(s,["placement","target"],t.replace("#VHSpleenCC","Male"===e.sex?"#VHMSpleenCC":"#VHFSpleenCC")),"http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"!==t&&"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"!==t||(0,bk.set)(s,["placement","target"],"Male"===e.sex?t.replace("#VH","#VHM")+"_Patch":t.replace("#VH","#VHF")+"_Patch")}return s}getTissueBlock(){return(0,bk.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}function Zk(t,e,n){var r;const i=new Map,s=new Set;t.some(t=>{var n;return e.has(t.subject.id)&&(s.add(t.object.id),i.has(t.object.id)?null===(n=i.get(t.object.id))||void 0===n||n.push(t.subject.id):i.set(t.object.id,[t.subject.id])),!1},null,Ek.donor,null,null);const o=n(s),a=new Set;for(const u of o)for(const t of null!==(r=i.get(u))&&void 0!==r?r:[])a.add(t);return a}function Yk(t,e){return n=>t.has(n.id)?e.add(n.id):void 0}const Qk={[Ak.ontologyNode.label.id]:"label",[Ak.ontologyNode.parent.id]:"parent",[Ak.ontologyNode.synonymLabels.id]:"synonymLabels"};function Jk(t,e){const n=pk.DataFactory.namedNode(e),r={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""};return t.some(t=>{const e=Qk[t.predicate.id];if(e){const n="Literal"===t.object.termType?(0,_k.fromRdf)(t.object):t.object.id;"synonymLabels"===e?r.synonymLabels.push(n):(0,bk.set)(r,e,n)}return!1},n,null,null,null),r.children=t.getSubjects(Ak.ontologyNode.children,n,null).map(t=>t.id),r}const tO={[Ek.label.id]:"label",[Ek.description.id]:"description",[Ek.link.id]:"link"},eO=Object.assign(Object.assign({},tO),{[Ek.providerName.id]:"providerName"}),nO=Object.assign(Object.assign({},tO),{[Ek.technology.id]:"technology",[Ek.thumbnail.id]:"thumbnail"}),rO=Object.assign(Object.assign({},tO),{[Ek.sampleType.id]:"sampleType",[Ek.sectionNumber.id]:"sectionNumber",[Ek.datasets.id]:"datasets"}),iO=Object.assign(Object.assign({},tO),{[Ek.sampleType.id]:"sampleType",[Ek.sectionCount.id]:"sectionCount",[Ek.sectionSize.id]:"sectionSize",[Ek.sectionUnits.id]:"sectionUnits",[Ek.donor.id]:"donor",[Ek.spatialEntity.id]:"spatialEntityId",[Ek.sections.id]:"sections",[Ek.datasets.id]:"datasets"}),sO=(0,bk.memoize)(function(t,e){const n={"@id":e,"@type":"Donor"};return t.some(t=>{const e=eO[t.predicate.id];if(e){const r="Literal"===t.object.termType?(0,_k.fromRdf)(t.object):t.object.id;(0,bk.set)(n,e,r)}return!1},pk.DataFactory.namedNode(e),null,null,null),n},(t,e)=>e);function oO(t,e){const n={"@id":e,"@type":"Dataset"};return t.some(t=>{const e=nO[t.predicate.id];if(e){const r="Literal"===t.object.termType?(0,_k.fromRdf)(t.object):t.object.id;(0,bk.set)(n,e,r)}return!1},pk.DataFactory.namedNode(e),null,null,null),n}const aO=(0,bk.memoize)(function(t,e){const n={"@id":e,"@type":"Sample",sections:[],datasets:[]};return t.some(e=>{const r=iO[e.predicate.id];if(r){const i="Literal"===e.object.termType?(0,_k.fromRdf)(e.object):e.object.id;if("sections"===r){const e=function(t,e){const n={"@id":e,"@type":"Sample",datasets:[]};return t.some(e=>{const r=rO[e.predicate.id];if(r){const i="Literal"===e.object.termType?(0,_k.fromRdf)(e.object):e.object.id;if("datasets"===r){const e=oO(t,i);n[r].push(e)}else(0,bk.set)(n,r,i)}return!1},pk.DataFactory.namedNode(e),null,null,null),n}(t,i);n[r].push(e)}else if("datasets"===r){const e=oO(t,i);n[r].push(e)}else"donor"===r?n[r]=sO(t,i):(0,bk.set)(n,r,i)}return!1},pk.DataFactory.namedNode(e),null,null,null),n},(t,e)=>e),uO={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class cO{constructor(t=uO){this.options=t,this.store=new pk.Store(void 0,{factory:pk.DataFactory}),this.graph=new zk(this),this.scene=new Uk(this)}connect(t,e=!1){return Al(this,void 0,void 0,function*(){return t&&(this.options=t),this.initializing||(this.initializing=e?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return Al(this,void 0,void 0,function*(){const t=(new Date).getTime(),e="ccf-database.last_modified",n="ccf-database",r=yield fk(e).catch(()=>{});let i;r&&t-new Date(+r).getTime()>36e5?yield function(t,e=dk()){return e("readwrite",e=>(t.forEach(t=>e.delete(t)),lk(e.transaction)))}([n,e]).catch(()=>{}):i=yield fk(n).catch(()=>{}),i?yield this.deserialize(i):(yield this.doConnect(),function(t,e=dk()){return e("readwrite",e=>(t.forEach(t=>e.put(t[1],t[0])),lk(e.transaction)))}([[n,this.serialize()],[e,""+t]]).catch(()=>{}))})}doConnect(){var t,e;return Al(this,void 0,void 0,function*(){const n=[],r=null!==(e=null===(t=this.options.dataSources)||void 0===t?void 0:t.concat())&&void 0!==e?e:[],i=this.options.ccfOwlUrl;if(i.endsWith(".n3store.json")){const t=yield fetch(i).then(t=>t.text()).catch(()=>console.log("Couldn't locate serialized store."));t&&(this.store=(0,pk.deserializeN3Store)(t,pk.DataFactory))}else(null==i?void 0:i.length)>0&&r.push(i);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):n.push(function(t,e,n,r,i="",s=""){return Al(this,void 0,void 0,function*(){let o;if("static"===e)o=yield fetch(t).then(t=>t.ok?t.json():void 0).catch(()=>{});else if("search-api"===e){const e={"Content-type":"application/json"};r&&r.length>0&&(e.Authorization=`Bearer ${r}`),o=yield fetch(t,{method:"POST",headers:e,body:JSON.stringify({version:!0,size:1e4,_source:{excludes:["donor","immediate_ancestors","immediate_descendants","origin_sample","portal_metadata_upload_files","image_file_metadata","ancestor_ids","descendant_ids"]},stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=n?n:{exists:{field:"rui_location"}}})}).then(t=>t.ok?t.json():void 0).catch(()=>{})}return o?function(t,e="",n="",r,i=!1){const s={},o=(0,bk.get)(t,"hits.hits",[]).map(t=>(0,bk.get)(t,"_source",{})).map(t=>new Kk(t,e,n,r).toJsonLd());for(const u of o){const t=u["@id"];s[t]?s[t].samples.push(u.samples[0]):s[t]=u}const a=Object.values(s);return i&&(function(t){let e=[],n=0;for(const r of t.filter(t=>t.samples.length>1)){const t=r.samples;for(let r=0;r<t.length;r++){const i=t[r]["@id"];e=e.concat(t[r].datasets);for(const n of t[r].sections)e=e.concat(n.datasets);for(let e=r+1;e<t.length;e++)t[e].sections.find(t=>t["@id"]===i)&&(t[r].deleteMe=!0,n++)}r.samples=t.filter(t=>!0!==t.deleteMe)}n>0&&console.log(`\u26a0 ${n} sections identified as blocks`)}(a),console.log(a.map(t=>Object.assign({"@context":Xk},t)))),{"@context":Xk,"@graph":a}}(o,i,s,r):void console.warn(`Unable to load ${t} as HuBMAP Data`)})}(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(t=>t?this.addDataSources([t]):void 0))),n.push(this.addDataSources(r)),yield Promise.all(n),yield this.synchronize()})}addDataSources(t,e){return Al(this,void 0,void 0,function*(){const n=null!=e?e:this.store;return yield Promise.all(t.map(t=>Al(this,void 0,void 0,function*(){"string"==typeof t?t.endsWith("jsonld")?yield(0,pk.addJsonLdToStore)(t,n):t.endsWith("n3")?yield(0,pk.addN3ToStore)(t,n):(t.endsWith("rdf")||t.endsWith("owl")||t.endsWith("xml"))&&(yield(0,pk.addRdfXmlToStore)(t,n)):yield(0,pk.addJsonLdToStore)(t,n)}))),this})}synchronize(){return Al(this,void 0,void 0,function*(){return yield new Promise(t=>{setTimeout(t,500)}),this.graph.createGraph(),this})}serialize(){return(0,pk.serializeN3Store)(this.store)}deserialize(t){return Al(this,void 0,void 0,function*(){this.store=(0,pk.deserializeN3Store)(t,pk.DataFactory),this.graph=new zk(this),this.scene=new Uk(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(t={}){return function(t,e){var n,r,i,s,o;let a=function(t){const e=new Set;return t.forSubjects(t=>e.add(t.id),Ek.spatialEntity,null,null),e}(t);if(a.size>0&&(a=function(t,e,n=!0){const r=new Set;if(t.forSubjects(Yk(e,r),Ek.spatialEntity,null,null),!n){const t=new Set;return e.forEach(e=>r.has(e)?void 0:t.add(e)),t}return r}(t,a)),a.size>0&&("Male"===e.sex||"Female"===e.sex)){const n=e.sex;a=Zk(t,a,e=>function(t,e,n){const r=new Set;return t.forSubjects(Yk(e,r),Ek.sex,Ek[n],null),r}(t,e,n))}if(a.size>0&&(null===(n=e.tmc)||void 0===n?void 0:n.length)>0&&(a=Zk(t,a,n=>function(t,e,n){const r=new Set;for(const i of n){const n=pk.DataFactory.literal(i);t.forSubjects(Yk(e,r),Ek.providerName,n,null)}return r}(t,n,e.tmc))),a.size>0&&(null===(r=e.technologies)||void 0===r?void 0:r.length)>0&&(a=function(t,e,n){var r;const i=new Map,s=new Set,o=new Set;t.some(t=>(e.has(t.subject.id)&&o.add(t.object.id),!1),null,Ek.sections,null,null),t.some(t=>{var n;return(e.has(t.subject.id)||o.has(t.subject.id))&&(s.add(t.object.id),i.has(t.object.id)?null===(n=i.get(t.object.id))||void 0===n||n.push(t.subject.id):i.set(t.object.id,[t.subject.id])),!1},null,Ek.datasets,null,null);const a=n(s),u=new Set;for(const c of a)for(const t of null!==(r=i.get(c))&&void 0!==r?r:[])u.add(t);return u}(t,a,n=>function(t,e,n){const r=new Set;for(const i of n){const n=pk.DataFactory.literal(i);t.forSubjects(Yk(e,r),Ek.technology,n,null)}return r}(t,n,e.technologies))),a.size>0&&(null===(i=e.ontologyTerms)||void 0===i?void 0:i.length)>0&&(a=function(t,e,n){var r;const i=new Map,s=new Set;t.some(t=>{var n;return e.has(t.subject.id)&&(s.add(t.object.id),i.has(t.object.id)?null===(n=i.get(t.object.id))||void 0===n||n.push(t.subject.id):i.set(t.object.id,[t.subject.id])),!1},null,Ek.spatialEntity,null,null);const o=n(s),a=new Set;for(const u of o)for(const t of null!==(r=i.get(u))&&void 0!==r?r:[])a.add(t);return a}(t,a,n=>function(t,e,n){const r=new Set;for(const i of n){const n=pk.DataFactory.namedNode(i);t.forSubjects(Yk(e,r),Ak.spatialEntity.ccf_annotations,n,null)}return r}(t,n,e.ontologyTerms))),a.size>0&&2===(null===(s=e.ageRange)||void 0===s?void 0:s.length)&&(0,bk.isFinite)(e.ageRange[0])&&(0,bk.isFinite)(e.ageRange[1])){const n=Math.max(...e.ageRange),r=Math.min(...e.ageRange);1===r&&110===n||(a=Zk(t,a,e=>function(t,e,n,r){const i=new Set;return t.some(t=>{if(e.has(t.subject.id)){const e=(0,_k.fromRdf)(t.object);e>=n&&e<=r&&i.add(t.subject.id)}return!1},null,Ek.age,null,null),i}(t,e,r,n)))}if(a.size>0&&2===(null===(o=e.bmiRange)||void 0===o?void 0:o.length)&&(0,bk.isFinite)(e.bmiRange[0])&&(0,bk.isFinite)(e.bmiRange[1])){const n=Math.max(...e.bmiRange),r=Math.min(...e.bmiRange);13===r&&83===n||(a=Zk(t,a,e=>function(t,e,n,r){const i=new Set;return t.some(t=>{if(e.has(t.subject.id)){const e=(0,_k.fromRdf)(t.object);e>=n&&e<=r&&i.add(t.subject.id)}return!1},null,Ek.bmi,null,null),i}(t,e,r,n)))}return a}(this.store,t)}get(t){return this.store.getQuads(pk.DataFactory.namedNode(t),null,null,null)}search(t={}){return[...this.getIds(t)].map(t=>this.get(t))}getSpatialEntities(t){return t=Object.assign(Object.assign({},t),{hasSpatialEntity:!0}),[...this.getIds(t)].map(t=>Fk(this.store,t))}getTissueBlockResults(t){return Al(this,void 0,void 0,function*(){return t=Object.assign(Object.assign({},t),{hasSpatialEntity:!0}),[...this.getIds(t)].map(t=>aO(this.store,t))})}getAggregateResults(t){return Al(this,void 0,void 0,function*(){return function(t,e){const n=new Set;e.some(e=>(t.has(e.subject.id)&&n.add(e.object.id),!1),null,Ek.donor,null,null);const r=new Set;e.some(t=>(n.has(t.subject.id)&&r.add(t.object.id),!1),null,Ek.providerUUID,null,null);const i=new Set;e.forSubjects(e=>{t.has(e.id)&&i.add(e.id)},Ek.spatialEntity,null,null);const s=new Set;e.some(t=>(i.has(t.subject.id)&&s.add(t.object.id),!1),null,Ek.sections,null,null);const o=new Set;return e.some(t=>{const e=t.subject;return(i.has(e.id)||s.has(e.id))&&o.add(t.object.id),!1},null,Ek.datasets,null,null),Object.entries({"Tissue Data Providers":r.size,Donors:n.size,"Tissue Blocks":i.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([t,e])=>({label:t,count:e}))}(this.getIds(t),this.store)})}getOntologyTermOccurences(t){return Al(this,void 0,void 0,function*(){return function(t,e){const n=new Map;e.some(e=>(t.has(e.subject.id)&&(n.has(e.object.id)?n.get(e.object.id).push(e.subject.id):n.set(e.object.id,[e.subject.id])),!1),null,Ek.spatialEntity,null,null);const r={};return e.some(t=>{var e,i;if(n.has(t.subject.id)){const s=null!==(i=null===(e=n.get(t.subject.id))||void 0===e?void 0:e.length)&&void 0!==i?i:0;r[t.object.id]=s+(r[t.object.id]||0)}return!1},null,Ak.spatialEntity.ccf_annotations,null,null),r}(this.getIds(t),this.store)})}getOntologyTreeModel(){return Al(this,void 0,void 0,function*(){return function(t){const e={root:Ck.body.id,nodes:{}},n=new Set;t.some(t=>(n.add(t.subject.id),n.add(t.predicate.id),!1),null,Ak.ontologyNode.parent,null,null);for(const r of n)e.nodes[r]=Jk(t,r);return e}(this.store)})}getReferenceOrgans(){return Al(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(t){return Al(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(t)})}getReferenceOrganScene(t,e){return Al(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(t,e)})}}let lO=(()=>{class t{constructor(t){var e,n;this.locator=t,this.subscriptions=new g,this.dbOptions=oh.dbOptions,this.dataSource=(e=()=>this.createDataSource(),n=t=>this.connectDataSource(t.source,this.dbOptions),new x(t=>{let r,i;try{r=e()}catch($O){return void t.error($O)}try{i=n(r)}catch($O){return void t.error($O)}const s=(i?B(i):rl).subscribe(t);return()=>{s.unsubscribe(),r&&r.unsubscribe()}})).pipe(ah(1)),this.subscriptions.add(this.dataSource.subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}getTissueBlockResults(t){return this.dataSource.pipe(fl(e=>e.getTissueBlockResults(t)),Ml(1))}getAggregateResults(t){return this.dataSource.pipe(fl(e=>e.getAggregateResults(t)),Ml(1))}getOntologyTermOccurences(t){return this.dataSource.pipe(fl(e=>e.getOntologyTermOccurences(t)),Ml(1))}getOntologyTreeModel(){return this.dataSource.pipe(fl(t=>t.getOntologyTreeModel()),Ml(1))}getReferenceOrgans(){return this.dataSource.pipe(fl(t=>t.getReferenceOrgans()),Ml(1))}getScene(t){return this.dataSource.pipe(fl(e=>e.getScene(t).then(e=>e.filter(e=>t.ontologyTerms.includes(e.representation_of)))),Ml(1))}getReferenceOrganScene(t,e){return this.dataSource.pipe(fl(n=>n.getReferenceOrganScene(t,e)),Ml(1))}createDataSource(){return{source:new cO(this.dbOptions),unsubscribe:()=>{}}}connectDataSource(t,e){return Al(this,void 0,void 0,function*(){oh.production||(globalThis.db=t);const n=(new Date).getTime();return yield t.connect(e,!0),oh.production||console.info(`Loaded CCF database in ${((new Date).getTime()-n)/1e3}s`),t})}}return t.\u0275fac=function(e){return new(e||t)(cr(sc))},t.\u0275prov=gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),hO=(()=>{class t{constructor(t){this.source=t,this.organs=ck}getOrganInfo(t,e,n="Female"){let r=this.organs.find(e=>e.id===t);if(!r)return sl(void 0);if(r.disabled||r.side&&e&&r.side!==e){const t=r.organ;r=this.organs.find(n=>n.organ===t&&n.side===e)}return sl(r)}getOrgan(t,e="Female"){return this.source.getReferenceOrgans().pipe(k(n=>n.find(n=>n.representation_of===t.id&&("Both"===e||n.sex===e))))}getOrganScene(t,e="Female"){return this.source.getReferenceOrganScene(t.id,{ontologyTerms:[t.id],sex:e})}getOrganStats(t,e="Female"){return this.source.getAggregateResults({ontologyTerms:[t.id],sex:e})}}return t.\u0275fac=function(e){return new(e||t)(cr(lO))},t.\u0275prov=gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const dO=["thumbContainer"],fO=["toggleBar"],pO=["input"],gO=function(t){return{enterDuration:t}},mO=["*"],yO=new Wn("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let bO=0;const _O={provide:BI,useExisting:ut(()=>xO),multi:!0};class vO{constructor(t,e){this.source=t,this.checked=e}}const wO=zD(FD(BD(LD(class{constructor(t){this._elementRef=t}}))));let xO=(()=>{class t extends wO{constructor(t,e,n,r,i,s){super(t),this._focusMonitor=e,this._changeDetectorRef=n,this.defaults=i,this._onChange=t=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++bO,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new Ua,this.toggleChange=new Ua,this.tabIndex=parseInt(r)||0,this.color=this.defaultColor=i.color||"accent",this._noopAnimations="NoopAnimations"===s}get required(){return this._required}set required(t){this._required=HI(t)}get checked(){return this._checked}set checked(t){this._checked=HI(t),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?this._inputElement.nativeElement.focus():t||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}focus(t,e){e?this._focusMonitor.focusVia(this._inputElement,e,t):this._inputElement.nativeElement.focus(t)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new vO(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return t.\u0275fac=function(e){return new(e||t)(js(zo),js(dD),js(la),("tabindex",function(t,e){const n=t.attrs;if(n){const t=n.length;let r=0;for(;r<t;){const i=n[r];if(yn(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<t&&"string"==typeof n[r];)r++;else{if(i===e)return n[r+1];r+=2}}}return null}(je(),"tabindex")),js(yO),js(MD,8))},t.\u0275cmp=qt({type:t,selectors:[["mat-slide-toggle"]],viewQuery:function(t,e){if(1&t&&(tu(dO,5),tu(fO,5),tu(pO,5)),2&t){let t;Ja(t=eu())&&(e._thumbEl=t.first),Ja(t=eu())&&(e._thumbBarEl=t.first),Ja(t=eu())&&(e._inputElement=t.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(t,e){2&t&&(yo("id",e.id),Ps("tabindex",e.disabled?null:-1)("aria-label",null)("aria-labelledby",null),no("mat-checked",e.checked)("mat-disabled",e.disabled)("mat-slide-toggle-label-before","before"==e.labelPosition)("_mat-animation-noopable",e._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Po([_O]),ws],ngContentSelectors:mO,decls:16,vars:19,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,e){if(1&t&&(function(t){const e=Pe()[16][6];if(!e.projection){const t=e.projection=Qn(1,null),n=t.slice();let r=e.child;for(;null!==r;){const e=0;null!==e&&(n[e]?n[e].projectionNext=r:t[e]=r,n[e]=r),r=r.next}}}(),Bs(0,"label",0,1),Bs(2,"div",2,3),Bs(4,"input",4,5),qs("change",function(t){return e._onChangeEvent(t)})("click",function(t){return e._onInputClick(t)}),zs(),Bs(6,"div",6,7),Us(8,"div",8),Bs(9,"div",9),Us(10,"div",10),zs(),zs(),zs(),Bs(11,"span",11,12),qs("cdkObserveContent",function(){return e._onLabelTextChange()}),Bs(13,"span",13),po(14,"\xa0"),zs(),function(t,e=0,n){const r=Pe(),i=Ne(),s=vi(i,ne+t,16,null,n||null);null===s.projection&&(s.projection=e),ze(),64!=(64&s.flags)&&function(t,e,n){Kr(e[11],0,e,n,jr(t,n,e),Ur(n.parent||e[6],n,e))}(i,r,s)}(15),zs(),zs()),2&t){const t=Rs(1),i=Rs(12);Ps("for",e.inputId),li(2),no("mat-slide-toggle-bar-no-side-margin",!i.textContent||!i.textContent.trim()),li(2),Ls("id",e.inputId)("required",e.required)("tabIndex",e.tabIndex)("checked",e.checked)("disabled",e.disabled),Ps("name",e.name)("aria-checked",e.checked.toString())("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledby),li(5),Ls("matRippleTrigger",t)("matRippleDisabled",e.disableRipple||e.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",(17,n=gO,r=e._noopAnimations?0:150,La(Pe(),Ge(),17,n,r,undefined)))}var n,r},directives:[XD,nD],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),t})(),EO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({}),t})(),SO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[EO,KD,jD,rD],EO,jD]}),t})(),AO=(()=>{class t{constructor(){this.clsName="ccf-slide-toggle",this.labels=["Left","Right"],this.value="Left",this.disabled=!1,this.valueChange=new Ua}get left(){const{value:t,labels:e}=this;return t!==e[1]}updateToggle(t){this.value=t?this.labels[0]:this.labels[1],this.valueChange.emit(this.value)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=qt({type:t,selectors:[["ccf-slide-toggle"]],hostVars:2,hostBindings:function(t,e){2&t&&ro(e.clsName)},inputs:{labels:"labels",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:6,vars:12,consts:[[1,"slide-label",3,"click"],[1,"slider",3,"disabled","checked","change"],["toggle",""]],template:function(t,e){if(1&t){const t=Vs();Bs(0,"span",0),qs("click",function(){Re(t);const n=Rs(3);return!e.left&&n.toggle(),e.updateToggle(!0)}),po(1),zs(),Bs(2,"mat-slide-toggle",1,2),qs("change",function(t){return e.updateToggle(!t.checked)}),zs(),Bs(4,"span",0),qs("click",function(){Re(t);const n=Rs(3);return e.left&&n.toggle(),e.updateToggle(!1)}),po(5),zs()}2&t&&(no("disabled",e.disabled)("highlighted",e.left),li(1),go(e.labels[0].charAt(0).toUpperCase()+e.labels[0].slice(1)),li(1),Ls("disabled",e.disabled)("checked",!e.left),li(2),no("disabled",e.disabled)("highlighted",!e.left),li(1),go(e.labels[1].charAt(0).toUpperCase()+e.labels[1].slice(1)))},directives:[xO],styles:["[_nghost-%COMP%]   .slide-label[_ngcontent-%COMP%]{margin:0 1rem;transition:color .6s;cursor:pointer;opacity:50%}[_nghost-%COMP%]   .slide-label.highlighted[_ngcontent-%COMP%]{opacity:100%}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:30%!important;cursor:not-allowed}[_nghost-%COMP%]     .slider .mat-slide-toggle-bar{background-color:rgba(67,71,101,.5)}[_nghost-%COMP%]     .slider .mat-slide-toggle-thumb{background-color:#434765}"],changeDetection:0}),t})();const TO=["bodyUI"],CO=function(){return["Male","Female"]},IO=function(){return["Left","Right"]};let DO=(()=>{class t{constructor(t){this.ga=t,this.sexChange=new Ua,this.sideChange=new Ua}ngOnInit(){this.reset()}ngOnChanges(t){this.bodyUI&&"organ"in t&&this.reset()}updateSex(t){this.sex=t,this.sexChange.emit(this.sex)}updateSide(t){this.side=t,this.sideChange.emit(this.side)}reset(){const{bodyUI:t,organ:e}=this;if(e){e.side||(this.side=void 0);const{x_dimension:n,y_dimension:r,z_dimension:i}=e;t.rotation=t.rotationX=0,t.bounds={x:1.25*n/1e3,y:1.25*r/1e3,z:1.25*i/1e3},t.target=[n/1e3/2,r/1e3/2,i/1e3/2]}}}return t.\u0275fac=function(e){return new(e||t)(js(eh))},t.\u0275cmp=qt({type:t,selectors:[["ccf-organ"]],viewQuery:function(t,e){if(1&t&&tu(TO,7),2&t){let t;Ja(t=eu())&&(e.bodyUI=t.first)}},inputs:{organ:"organ",scene:"scene",organIri:"organIri",sex:"sex",side:"side"},outputs:{sexChange:"sexChange",sideChange:"sideChange"},features:[de],decls:5,vars:9,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick"],["bodyUI",""],[1,"stage-options"],[1,"view-slider",3,"labels","value","valueChange"],[1,"view-slider",3,"labels","value","disabled","valueChange"]],template:function(t,e){1&t&&(Bs(0,"ccf-body-ui",0,1),qs("nodeClick",function(t){return e.ga.event("node_click","organ",t.node["@id"])}),zs(),Bs(2,"div",2),Bs(3,"ccf-slide-toggle",3),qs("valueChange",function(t){return e.updateSex(t)}),zs(),Bs(4,"ccf-slide-toggle",4),qs("valueChange",function(t){return e.updateSide(t)}),zs(),zs()),2&t&&(Ls("scene",e.scene)("interactive",!0),li(3),Ls("labels",ja(7,CO))("value",e.sex),li(1),Ls("labels",ja(8,IO))("value",e.side)("disabled",!e.side))},directives:[ak,AO],styles:["[_nghost-%COMP%]{display:block;background-color:#000;border-radius:.5rem;color:#fff;height:100%}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{height:90%}[_nghost-%COMP%]   .stage-options[_ngcontent-%COMP%]{padding:1rem;min-width:352px}"],changeDetection:0}),t})();function kO(t,e){if(1&t&&(Bs(0,"div",3),Bs(1,"div",4),po(2),zs(),Bs(3,"div",5),po(4),zs(),zs()),2&t){const t=e.$implicit;li(2),go(t.count),li(2),go(t.label)}}let OO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=qt({type:t,selectors:[["ccf-stats-list"]],inputs:{statsLabel:"statsLabel",stats:"stats"},decls:4,vars:2,consts:[[1,"stats-container"],[1,"header"],["class","stats-row",4,"ngFor","ngForOf"],[1,"stats-row"],[1,"stat"],[1,"label"]],template:function(t,e){1&t&&(Bs(0,"div",0),Bs(1,"div",1),po(2),zs(),Ns(3,kO,5,2,"div",2),zs()),2&t&&(li(2),mo(" ",e.statsLabel," "),li(1),Ls("ngForOf",e.stats))},directives:[fc],styles:[".stats-container[_ngcontent-%COMP%]{margin-bottom:2rem;min-height:9rem}.stats-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:1rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:1.325rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:2rem;margin-right:1rem;text-align:right}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"],changeDetection:0}),t})();function MO(t,e){if(1&t){const t=Vs();Bs(0,"div",6),Bs(1,"div",7),Bs(2,"div",8),po(3),zs(),Bs(4,"div",9),qs("click",function(){const e=Re(t).$implicit;return Ks().goToURL(e.buttonUrl)}),po(5),zs(),zs(),zs()}if(2&t){const t=e.$implicit;li(3),go(t.body),li(1),Ls("gaLabel",t.buttonUrl),li(1),mo(" ",t.buttonTitle,"")}}function PO(t,e){if(1&t){const t=Vs();Bs(0,"div",10),qs("click",function(){const e=Re(t).$implicit;return Ks().goToURL(e.buttonUrl)}),po(1),zs()}if(2&t){const t=e.$implicit;Ls("gaLabel",t.buttonUrl),li(1),go(t.buttonTitle)}}let NO=(()=>{class t{constructor(){this.linkCards=[{body:"Add tissue blocks using the CCF Registration User Interface (RUI).",buttonTitle:"Register Tissue",buttonUrl:"https://hubmapconsortium.github.io/ccf-ui/rui/"},{body:"Explore tissue sections in tissue blocks with the CCF Exploration User Interface (EUI).",buttonTitle:"Explore Tissue",buttonUrl:"https://portal.hubmapconsortium.org/ccf-eui"},{body:"View linkages between anatomical structures, cell types, and common biomarkers (ASCT+B).",buttonTitle:"ASCT+B Reporter",buttonUrl:"https://hubmapconsortium.github.io/ccf-asct-reporter/"}],this.deepDives=[{body:"",buttonTitle:"CCF Portal",buttonUrl:"https://hubmapconsortium.github.io/ccf/"},{body:"",buttonTitle:"Online Course",buttonUrl:"https://expand.iu.edu/browse/sice/cns/courses/hubmap-visible-human-mooc"},{body:"",buttonTitle:"Paper",buttonUrl:"https://www.biorxiv.org/content/10.1101/2021.05.31.446440v2"}]}goToURL(t){window.open(t,"_blank")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=qt({type:t,selectors:[["ccf-link-cards"]],decls:7,vars:2,consts:[["gaCategory","link-cards",1,"link-cards-container"],["class","link-card",4,"ngFor","ngForOf"],["gaCategory","deep-dive",1,"deep-dive-section"],[1,"title"],[1,"button-container"],["class","btn-outline btn","gaEvent","visit-link",3,"gaLabel","click",4,"ngFor","ngForOf"],[1,"link-card"],[1,"link-card-content"],[1,"body"],["gaEvent","visit-link",1,"link-button","btn",3,"gaLabel","click"],["gaEvent","visit-link",1,"btn-outline","btn",3,"gaLabel","click"]],template:function(t,e){1&t&&(Bs(0,"div",0),Ns(1,MO,6,3,"div",1),zs(),Bs(2,"div",2),Bs(3,"div",3),po(4,"Common Coordinate Framework (CCF) Deep Dive"),zs(),Bs(5,"div",4),Ns(6,PO,2,2,"div",5),zs(),zs()),2&t&&(li(1),Ls("ngForOf",e.linkCards),li(5),Ls("ngForOf",e.deepDives))},directives:[Zl,fc,nh],styles:[".link-cards-container[_ngcontent-%COMP%]{max-width:30rem}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:1px;padding-bottom:1px}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid #e0e0e0}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]{align-items:center;padding:1rem 0 1rem 1rem;display:flex;flex-direction:row;justify-content:space-between;border-left:6px solid #444a65}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]{margin-left:2rem;background-color:#444a65;color:#fff}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]:hover{background-color:#2f3346}.deep-dive-section[_ngcontent-%COMP%]{margin-top:2rem}.deep-dive-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{color:#444a65;border:1px solid #444a65;background-color:#fff}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:not(:last-of-type){margin-right:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn[_ngcontent-%COMP%]{min-width:9rem!important;max-height:2.28125rem;text-align:center;white-space:nowrap;cursor:pointer;font-size:.875rem;font-weight:500;border-radius:2px;line-height:2.75;transition:background-color .25s cubic-bezier(.4,0,.2,1) 0ms,box-shadow .25s cubic-bezier(.4,0,.2,1) 0ms,border .25s cubic-bezier(.4,0,.2,1) 0ms;font-family:Inter Variable,Helvetica,Arial,sans-serif}"],changeDetection:0}),t})();const RO=["left"],jO=["right"],LO=function(){return[]},FO=[{color:[0,0,0,0],opacity:.001}];let BO=(()=>{class t{constructor(t,e){this.ga=e,this.sex="Female",this.side="Left",this.inputChangedTick$=new hl(1),this.organInfo$=this.inputChangedTick$.pipe(fl(()=>{var e,n,r;return t.getOrganInfo(null!==(e=this.organIri)&&void 0!==e?e:"",null===(r=null===(n=this.side)||void 0===n?void 0:n.toLowerCase)||void 0===r?void 0:r.call(n),this.sex)}),$l(t=>this.logOrganLookup(t)),ah(1)),this.organ$=this.organInfo$.pipe(fl(e=>e?t.getOrgan(e,this.sex):sl(void 0)),ah(1)),this.scene$=this.organ$.pipe(uh(this.organInfo$),fl(([e,n])=>e&&n?t.getOrganScene(n,this.sex):sl(FO))),this.stats$=this.organInfo$.pipe(fl(e=>e?t.getOrganStats(e,this.sex):sl([]))),this.statsLabel$=this.stats$.pipe(uh(this.organInfo$),k(([t,e])=>this.makeStatsLabel(e)),function(...t){const e=t[t.length-1];return D(e)?(t.pop(),n=>kl(t,n,e)):e=>kl(t,e)}("Loading..."))}ngAfterViewInit(){const{left:t,right:e}=this;t.nativeElement.style.height=`${e.nativeElement.offsetHeight}px`}ngOnChanges(t){this.handleInputChanges(t)}updateInput(t,e){const n={[t]:new he(this[t],e,!1)};this[t]=e,this.handleInputChanges(n)}handleInputChanges(t){const e=["organIri","sex","side"];let n=!1;for(const r of e)r in t&&(this.logInputChange(r,t[r].currentValue),n=!0);n&&this.inputChangedTick$.next()}makeStatsLabel(t){var e,n;let r=[`Unknown IRI: ${this.organIri}`];return t&&(r=[this.sex,t.organ,null===(n=null===(e=this.side)||void 0===e?void 0:e.toLowerCase)||void 0===n?void 0:n.call(e)]),r.filter(t=>!!t).join(", ")}logInputChange(t,e){const n=t.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`);this.ga.event(`update_${n}`,"organ",`${e}`)}logOrganLookup(t){this.ga.event(t?"organ_lookup_success":"organ_lookup_failure","organ",`Iri: ${this.organIri} - Sex: ${this.sex} - Side: ${this.side}`)}}return t.\u0275fac=function(e){return new(e||t)(js(hO),js(eh))},t.\u0275cmp=qt({type:t,selectors:[["ccf-root"]],viewQuery:function(t,e){if(1&t&&(tu(RO,7,zo),tu(jO,7,zo)),2&t){let t;Ja(t=eu())&&(e.left=t.first),Ja(t=eu())&&(e.right=t.first)}},inputs:{organIri:"organIri",sex:"sex",side:"side"},features:[de],decls:12,vars:15,consts:[[1,"container"],[1,"left"],["left",""],[3,"sex","side","organ","scene","sexChange","sideChange"],[1,"right"],["right",""],[3,"statsLabel","stats"]],template:function(t,e){if(1&t&&(Bs(0,"div",0),Bs(1,"div",1,2),Bs(3,"ccf-organ",3),qs("sexChange",function(t){return e.updateInput("sex",t)})("sideChange",function(t){return e.updateInput("side",t)}),Fa(4,"async"),Fa(5,"async"),zs(),zs(),Bs(6,"div",4,5),Us(8,"ccf-stats-list",6),Fa(9,"async"),Fa(10,"async"),Us(11,"ccf-link-cards"),zs(),zs()),2&t){let t;li(3),Ls("sex",e.sex)("side",e.side)("organ",Ba(4,6,e.organ$))("scene",null!==(t=Ba(5,8,e.scene$))&&void 0!==t?t:ja(14,LO)),li(5),Ls("statsLabel",Ba(9,10,e.statsLabel$))("stats",Ba(10,12,e.stats$))}},directives:[DO,OO,NO],pipes:[_c],styles:[".container[_ngcontent-%COMP%]{width:100%;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:row;padding:1rem;font-family:Inter;font-size:.95rem;line-height:1.5;text-align:left;position:relative;background-color:#fff;color:#000}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:auto;flex-grow:1}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:2rem;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:29rem}"],changeDetection:0}),t})(),zO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[vc,SO]]}),t})(),UO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[vc,uk,zO]]}),t})(),VO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[vc,ih]]}),t})(),GO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({imports:[[vc]]}),t})(),HO=(()=>{class t{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(t,e){const n=function(t,e){return e.get(jo).resolveComponentFactory(t).inputs}(t,e.injector),r=e.strategyFactory||new _l(t,e.injector),i=function(t){const e={};return t.forEach(({propName:t,templateName:n})=>{var r;e[(r=n,r.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`))]=t}),e}(n);class s extends wl{constructor(t){super(),this.injector=t}get ngElementStrategy(){if(!this._ngElementStrategy){const t=this._ngElementStrategy=r.create(this.injector||e.injector);n.forEach(({propName:e})=>{if(!this.hasOwnProperty(e))return;const n=this[e];delete this[e],t.setInputValue(e,n)})}return this._ngElementStrategy}attributeChangedCallback(t,e,n,r){this.ngElementStrategy.setInputValue(i[t],n)}connectedCallback(){let t=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),t=!0),this.ngElementStrategy.connect(this),t||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(t=>{const e=function(t,e,n){if("function"!=typeof CustomEvent){const r=t.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!1,n),r}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:n})}(this.ownerDocument,t.name,t.value);this.dispatchEvent(e)})}}return s.observedAttributes=Object.keys(i),n.forEach(({propName:t})=>{Object.defineProperty(s.prototype,t,{get(){return this.ngElementStrategy.getInputValue(t)},set(e){this.ngElementStrategy.setInputValue(t,e)},configurable:!0,enumerable:!0})}),s}(BO,{injector:this.injector});customElements.define("ccf-organ-info",t)}}return t.\u0275fac=function(e){return new(e||t)(cr(_s))},t.\u0275mod=Zt({type:t}),t.\u0275inj=mt({providers:[],imports:[[Yc,VO,GO,UO,sh.forRoot({gaToken:oh.googleAnalyticsToken,appName:"organ-info",projectName:"ccf",developmentMode:!oh.production})]]}),t})();oh.production&&function(){if(Fu)throw new Error("Cannot enable prod mode after platform setup.");Lu=!1}(),Kc().bootstrapModule(HO).catch(t=>console.error(t))},948:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.default=t.exports,t.exports.__esModule=!0},321:t=>{function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0},82:t=>{function e(t){return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=()=>[],e.resolve=e,e.id=82,t.exports=e},521:()=>{},125:()=>{},307:()=>{}},t=>{"use strict";t(t.s=434)}]);