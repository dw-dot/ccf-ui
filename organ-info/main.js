var UOe=Object.defineProperty,zOe=Object.defineProperties,HOe=Object.getOwnPropertyDescriptors,Mx=Object.getOwnPropertySymbols,UW=Object.prototype.hasOwnProperty,zW=Object.prototype.propertyIsEnumerable,mr=Math.pow,HW=(Vt,nt,tt)=>nt in Vt?UOe(Vt,nt,{enumerable:!0,configurable:!0,writable:!0,value:tt}):Vt[nt]=tt,ht=(Vt,nt)=>{for(var tt in nt||(nt={}))UW.call(nt,tt)&&HW(Vt,tt,nt[tt]);if(Mx)for(var tt of Mx(nt))zW.call(nt,tt)&&HW(Vt,tt,nt[tt]);return Vt},zn=(Vt,nt)=>zOe(Vt,HOe(nt)),GW=(Vt,nt)=>{var tt={};for(var mt in Vt)UW.call(Vt,mt)&&nt.indexOf(mt)<0&&(tt[mt]=Vt[mt]);if(null!=Vt&&Mx)for(var mt of Mx(Vt))nt.indexOf(mt)<0&&zW.call(Vt,mt)&&(tt[mt]=Vt[mt]);return tt};(self.webpackChunkccf_ui=self.webpackChunkccf_ui||[]).push([[179],{440:(Vt,nt,tt)=>{var mt=tt(52).default;Vt.exports=function K(Ae,pe,Y){function U(W,b){if(!pe[W]){if(!Ae[W]){if(k)return k(W,!0);var N=new Error("Cannot find module '"+W+"'");throw N.code="MODULE_NOT_FOUND",N}var M=pe[W]={exports:{}};Ae[W][0].call(M.exports,function(v){return U(Ae[W][1][v]||v)},M,M.exports,K,Ae,pe,Y)}return pe[W].exports}for(var k=void 0,ie=0;ie<Y.length;ie++)U(Y[ie]);return U}({1:[function(K,Ae,pe){var Y,U;Y=this,U=function(Y,U,k,ie,W){"use strict";function T(xe,je,We,Pe){return new(We||(We=Promise))(function(H,fe){function ue(ft){try{gt(Pe.next(ft))}catch(be){fe(be)}}function Ve(ft){try{gt(Pe.throw(ft))}catch(be){fe(be)}}function gt(ft){ft.done?H(ft.value):function(H){return H instanceof We?H:new We(function(fe){fe(H)})}(ft.value).then(ue,Ve)}gt((Pe=Pe.apply(xe,je||[])).next())})}function j(xe,je){var Pe,$,H,fe,We={label:0,sent:function(){if(1&H[0])throw H[1];return H[1]},trys:[],ops:[]};return fe={next:ue(0),throw:ue(1),return:ue(2)},"function"==typeof Symbol&&(fe[Symbol.iterator]=function(){return this}),fe;function ue(gt){return function(ft){return function(gt){if(Pe)throw new TypeError("Generator is already executing.");for(;We;)try{if(Pe=1,$&&(H=2&gt[0]?$.return:gt[0]?$.throw||((H=$.return)&&H.call($),0):$.next)&&!(H=H.call($,gt[1])).done)return H;switch($=0,H&&(gt=[2&gt[0],H.value]),gt[0]){case 0:case 1:H=gt;break;case 4:return We.label++,{value:gt[1],done:!1};case 5:We.label++,$=gt[1],gt=[0];continue;case 7:gt=We.ops.pop(),We.trys.pop();continue;default:if(!(H=(H=We.trys).length>0&&H[H.length-1])&&(6===gt[0]||2===gt[0])){We=0;continue}if(3===gt[0]&&(!H||gt[1]>H[0]&&gt[1]<H[3])){We.label=gt[1];break}if(6===gt[0]&&We.label<H[1]){We.label=H[1],H=gt;break}if(H&&We.label<H[2]){We.label=H[2],We.ops.push(gt);break}H[2]&&We.ops.pop(),We.trys.pop();continue}gt=je.call(xe,We)}catch(ft){gt=[6,ft],$=0}finally{Pe=H=0}if(5&gt[0])throw gt[1];return{value:gt[0]?gt[1]:void 0,done:!0}}([gt,ft])}}}function Xe(xe){var je=xe.length,We=0;return new W.Readable({objectMode:!0,read:function(){this.push(We<je?xe[We++]:null)}})}Y.addJsonLdToStore=function(xe,je){return T(this,void 0,void 0,function(){var We,Pe,$;return j(this,function(H){switch(H.label){case 0:return"string"!=typeof xe?[3,4]:[4,fetch(xe,{redirect:"follow"})];case 1:return(Pe=H.sent()).ok?[4,Pe.json()]:[3,3];case 2:We=H.sent(),H.label=3;case 3:return[3,5];case 4:We=xe,H.label=5;case 5:return We?[4,U.toRDF(We)]:[3,7];case 6:$=H.sent(),je.import(Xe($)),H.label=7;case 7:return[2,je]}})})},Y.addN3ToStore=function(xe,je){return T(this,void 0,void 0,function(){var We,Pe,$;return j(this,function(H){switch(H.label){case 0:return"string"==typeof xe&&(null==xe?void 0:xe.startsWith("http"))?[4,fetch(xe,{redirect:"follow"})]:[3,4];case 1:return(Pe=H.sent()).ok?[4,Pe.text()]:[3,3];case 2:We=H.sent(),H.label=3;case 3:return[3,5];case 4:We=xe,H.label=5;case 5:return We&&($=new k.Parser({format:"n3"}).parse(We),je.import(Xe($))),[2,je]}})})},Y.addRdfXmlToStore=function(xe,je){return T(this,void 0,void 0,function(){var We,Pe,$,H;return j(this,function(fe){switch(fe.label){case 0:return"string"==typeof xe&&(null==xe?void 0:xe.startsWith("http"))?[4,fetch(xe,{redirect:"follow"})]:[3,4];case 1:return(Pe=fe.sent()).ok?[4,Pe.text()]:[3,3];case 2:We=fe.sent(),fe.label=3;case 3:return[3,5];case 4:We=xe,fe.label=5;case 5:return We?($=new ie.RdfXmlParser({dataFactory:k.DataFactory,strict:!0}),H=new Promise(function(ue){$.once("end",function(){return ue(je)})}),je.import($),$.write(We),$.end(),[2,H]):[2,je]}})})},Y.arrayToStream=Xe,Y.deserializeN3Store=function(xe,je){var We=JSON.parse(xe),Pe=new k.Store;return Object.assign(Pe,We,{_factory:null!=je?je:k.DataFactory}),Pe},Y.readQuads=function(xe,je,We,Pe,$){return xe.readQuads(je,We,Pe,$)},Y.serializeN3Store=function(xe){var je=Object.assign({},xe);return delete je._factory,JSON.stringify(je)},Y.streamToArray=function(xe){return new Promise(function(je,We){var Pe=[];xe.on("data",function($){Pe.push($)}).once("end",function(){je(Pe)}).once("error",function($){We($)})})},Object.keys(k).forEach(function(xe){"default"!==xe&&!Y.hasOwnProperty(xe)&&Object.defineProperty(Y,xe,{enumerable:!0,get:function(){return k[xe]}})}),Object.defineProperty(Y,"__esModule",{value:!0})},"object"==typeof pe&&void 0!==Ae?U(pe,K("jsonld"),K("n3"),K("rdfxml-streaming-parser"),K("readable-stream")):U((Y="undefined"!=typeof globalThis?globalThis:Y||self).tripleStoreUtils={},Y.jsonld,Y.n3,Y.rdfxmlStreamingParser,Y.readablestream)},{jsonld:26,n3:43,"rdfxml-streaming-parser":64,"readable-stream":81}],2:[function(K,Ae,pe){"use strict";pe.byteLength=function(j){var O=x(j),ce=O[1];return 3*(O[0]+ce)/4-ce},pe.toByteArray=function(j){var O,G,q=x(j),ce=q[0],D=q[1],I=new k(function(j,O,q){return 3*(O+q)/4-q}(0,ce,D)),X=0,w=D>0?ce-4:ce;for(G=0;G<w;G+=4)O=U[j.charCodeAt(G)]<<18|U[j.charCodeAt(G+1)]<<12|U[j.charCodeAt(G+2)]<<6|U[j.charCodeAt(G+3)],I[X++]=O>>16&255,I[X++]=O>>8&255,I[X++]=255&O;return 2===D&&(O=U[j.charCodeAt(G)]<<2|U[j.charCodeAt(G+1)]>>4,I[X++]=255&O),1===D&&(O=U[j.charCodeAt(G)]<<10|U[j.charCodeAt(G+1)]<<4|U[j.charCodeAt(G+2)]>>2,I[X++]=O>>8&255,I[X++]=255&O),I},pe.fromByteArray=function(j){for(var O,q=j.length,ce=q%3,D=[],I=16383,X=0,w=q-ce;X<w;X+=I)D.push(S(j,X,X+I>w?w:X+I));return 1===ce?D.push(Y[(O=j[q-1])>>2]+Y[O<<4&63]+"=="):2===ce&&D.push(Y[(O=(j[q-2]<<8)+j[q-1])>>10]+Y[O>>4&63]+Y[O<<2&63]+"="),D.join("")};for(var Y=[],U=[],k="undefined"!=typeof Uint8Array?Uint8Array:Array,ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",W=0,b=ie.length;W<b;++W)Y[W]=ie[W],U[ie.charCodeAt(W)]=W;function x(j){var O=j.length;if(O%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var q=j.indexOf("=");return-1===q&&(q=O),[q,q===O?0:4-q%4]}function y(j){return Y[j>>18&63]+Y[j>>12&63]+Y[j>>6&63]+Y[63&j]}function S(j,O,q){for(var D=[],I=O;I<q;I+=3)D.push(y((j[I]<<16&16711680)+(j[I+1]<<8&65280)+(255&j[I+2])));return D.join("")}U["-".charCodeAt(0)]=62,U["_".charCodeAt(0)]=63},{}],3:[function(K,Ae,pe){},{}],4:[function(K,Ae,pe){var Y=K("buffer"),U=Y.Buffer;function k(W,b){for(var x in W)b[x]=W[x]}function ie(W,b,x){return U(W,b,x)}U.from&&U.alloc&&U.allocUnsafe&&U.allocUnsafeSlow?Ae.exports=Y:(k(Y,pe),pe.Buffer=ie),k(U,ie),ie.from=function(W,b,x){if("number"==typeof W)throw new TypeError("Argument must not be a number");return U(W,b,x)},ie.alloc=function(W,b,x){if("number"!=typeof W)throw new TypeError("Argument must be a number");var N=U(W);return void 0!==b?"string"==typeof x?N.fill(b,x):N.fill(b):N.fill(0),N},ie.allocUnsafe=function(W){if("number"!=typeof W)throw new TypeError("Argument must be a number");return U(W)},ie.allocUnsafeSlow=function(W){if("number"!=typeof W)throw new TypeError("Argument must be a number");return Y.SlowBuffer(W)}},{buffer:6}],5:[function(K,Ae,pe){"use strict";var Y=K("safe-buffer").Buffer,U=Y.isEncoding||function(D){switch((D=""+D)&&D.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function W(D){var I;switch(this.encoding=function(D){var I=function(D){if(!D)return"utf8";for(var I;;)switch(D){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return D;default:if(I)return;D=(""+D).toLowerCase(),I=!0}}(D);if("string"!=typeof I&&(Y.isEncoding===U||!U(D)))throw new Error("Unknown encoding: "+D);return I||D}(D),this.encoding){case"utf16le":this.text=S,this.end=T,I=4;break;case"utf8":this.fillLast=M,I=4;break;case"base64":this.text=j,this.end=O,I=3;break;default:return this.write=q,void(this.end=ce)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Y.allocUnsafe(I)}function b(D){return D<=127?0:D>>5==6?2:D>>4==14?3:D>>3==30?4:D>>6==2?-1:-2}function M(D){var I=this.lastTotal-this.lastNeed,X=function(D,I,X){if(128!=(192&I[0]))return D.lastNeed=0,"\ufffd";if(D.lastNeed>1&&I.length>1){if(128!=(192&I[1]))return D.lastNeed=1,"\ufffd";if(D.lastNeed>2&&I.length>2&&128!=(192&I[2]))return D.lastNeed=2,"\ufffd"}}(this,D);return void 0!==X?X:this.lastNeed<=D.length?(D.copy(this.lastChar,I,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(D.copy(this.lastChar,I,0,D.length),void(this.lastNeed-=D.length))}function S(D,I){if((D.length-I)%2==0){var X=D.toString("utf16le",I);if(X){var w=X.charCodeAt(X.length-1);if(w>=55296&&w<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1],X.slice(0,-1)}return X}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=D[D.length-1],D.toString("utf16le",I,D.length-1)}function T(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):I}function j(D,I){var X=(D.length-I)%3;return 0===X?D.toString("base64",I):(this.lastNeed=3-X,this.lastTotal=3,1===X?this.lastChar[0]=D[D.length-1]:(this.lastChar[0]=D[D.length-2],this.lastChar[1]=D[D.length-1]),D.toString("base64",I,D.length-X))}function O(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+this.lastChar.toString("base64",0,3-this.lastNeed):I}function q(D){return D.toString(this.encoding)}function ce(D){return D&&D.length?this.write(D):""}pe.StringDecoder=W,W.prototype.write=function(D){if(0===D.length)return"";var I,X;if(this.lastNeed){if(void 0===(I=this.fillLast(D)))return"";X=this.lastNeed,this.lastNeed=0}else X=0;return X<D.length?I?I+this.text(D,X):this.text(D,X):I||""},W.prototype.end=function(D){var I=D&&D.length?this.write(D):"";return this.lastNeed?I+"\ufffd":I},W.prototype.text=function(D,I){var X=function(D,I,X){var w=I.length-1;if(w<X)return 0;var G=b(I[w]);return G>=0?(G>0&&(D.lastNeed=G-1),G):--w<X||-2===G?0:(G=b(I[w]))>=0?(G>0&&(D.lastNeed=G-2),G):--w<X||-2===G?0:(G=b(I[w]))>=0?(G>0&&(2===G?G=0:D.lastNeed=G-3),G):0}(this,D,I);if(!this.lastNeed)return D.toString("utf8",I);this.lastTotal=X;var w=D.length-(X-this.lastNeed);return D.copy(this.lastChar,0,w),D.toString("utf8",I,w)},W.prototype.fillLast=function(D){if(this.lastNeed<=D.length)return D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);D.copy(this.lastChar,this.lastTotal-this.lastNeed,0,D.length),this.lastNeed-=D.length}},{"safe-buffer":4}],6:[function(K,Ae,pe){(function(Y){(function(){"use strict";var U=K("base64-js"),k=K("ieee754");pe.Buffer=x,pe.SlowBuffer=function(B){return+B!=B&&(B=0),x.alloc(+B)},pe.INSPECT_MAX_BYTES=50;var ie=2147483647;function b(B){if(B>ie)throw new RangeError('The value "'+B+'" is invalid for option "size"');var P=new Uint8Array(B);return P.__proto__=x.prototype,P}function x(B,P,V){if("number"==typeof B){if("string"==typeof P)throw new TypeError('The "string" argument must be of type string. Received type number');return y(B)}return N(B,P,V)}function N(B,P,V){if("string"==typeof B)return function(B,P){if(("string"!=typeof P||""===P)&&(P="utf8"),!x.isEncoding(P))throw new TypeError("Unknown encoding: "+P);var V=0|D(B,P),Re=b(V),Qe=Re.write(B,P);return Qe!==V&&(Re=Re.slice(0,Qe)),Re}(B,P);if(ArrayBuffer.isView(B))return T(B);if(null==B)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(ft(B,ArrayBuffer)||B&&ft(B.buffer,ArrayBuffer))return function(B,P,V){if(P<0||B.byteLength<P)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<P+(V||0))throw new RangeError('"length" is outside of buffer bounds');var Re;return(Re=void 0===P&&void 0===V?new Uint8Array(B):void 0===V?new Uint8Array(B,P):new Uint8Array(B,P,V)).__proto__=x.prototype,Re}(B,P,V);if("number"==typeof B)throw new TypeError('The "value" argument must not be of type number. Received type number');var Re=B.valueOf&&B.valueOf();if(null!=Re&&Re!==B)return x.from(Re,P,V);var Qe=function(B){if(x.isBuffer(B)){var P=0|q(B.length),V=b(P);return 0===V.length||B.copy(V,0,0,P),V}return void 0!==B.length?"number"!=typeof B.length||be(B.length)?b(0):T(B):"Buffer"===B.type&&Array.isArray(B.data)?T(B.data):void 0}(B);if(Qe)return Qe;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof B[Symbol.toPrimitive])return x.from(B[Symbol.toPrimitive]("string"),P,V);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function M(B){if("number"!=typeof B)throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function y(B){return M(B),b(B<0?0:0|q(B))}function T(B){for(var P=B.length<0?0:0|q(B.length),V=b(P),Re=0;Re<P;Re+=1)V[Re]=255&B[Re];return V}function q(B){if(B>=ie)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ie.toString(16)+" bytes");return 0|B}function D(B,P){if(x.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||ft(B,ArrayBuffer))return B.byteLength;if("string"!=typeof B)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var V=B.length,Re=arguments.length>2&&!0===arguments[2];if(!Re&&0===V)return 0;for(var Qe=!1;;)switch(P){case"ascii":case"latin1":case"binary":return V;case"utf8":case"utf-8":return H(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*V;case"hex":return V>>>1;case"base64":return Ve(B).length;default:if(Qe)return Re?-1:H(B).length;P=(""+P).toLowerCase(),Qe=!0}}function I(B,P,V){var Re=!1;if((void 0===P||P<0)&&(P=0),P>this.length||((void 0===V||V>this.length)&&(V=this.length),V<=0)||(V>>>=0)<=(P>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return Je(this,P,V);case"utf8":case"utf-8":return _e(this,P,V);case"ascii":return rt(this,P,V);case"latin1":case"binary":return Xe(this,P,V);case"base64":return te(this,P,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ye(this,P,V);default:if(Re)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),Re=!0}}function X(B,P,V){var Re=B[P];B[P]=B[V],B[V]=Re}function w(B,P,V,Re,Qe){if(0===B.length)return-1;if("string"==typeof V?(Re=V,V=0):V>2147483647?V=2147483647:V<-2147483648&&(V=-2147483648),be(V=+V)&&(V=Qe?0:B.length-1),V<0&&(V=B.length+V),V>=B.length){if(Qe)return-1;V=B.length-1}else if(V<0){if(!Qe)return-1;V=0}if("string"==typeof P&&(P=x.from(P,Re)),x.isBuffer(P))return 0===P.length?-1:G(B,P,V,Re,Qe);if("number"==typeof P)return P&=255,"function"==typeof Uint8Array.prototype.indexOf?Qe?Uint8Array.prototype.indexOf.call(B,P,V):Uint8Array.prototype.lastIndexOf.call(B,P,V):G(B,[P],V,Re,Qe);throw new TypeError("val must be string, number or Buffer")}function G(B,P,V,Re,Qe){var Hn,vt=1,It=B.length,Mn=P.length;if(void 0!==Re&&("ucs2"===(Re=String(Re).toLowerCase())||"ucs-2"===Re||"utf16le"===Re||"utf-16le"===Re)){if(B.length<2||P.length<2)return-1;vt=2,It/=2,Mn/=2,V/=2}function Rn(Ns,ds){return 1===vt?Ns[ds]:Ns.readUInt16BE(ds*vt)}if(Qe){var bi=-1;for(Hn=V;Hn<It;Hn++)if(Rn(B,Hn)===Rn(P,-1===bi?0:Hn-bi)){if(-1===bi&&(bi=Hn),Hn-bi+1===Mn)return bi*vt}else-1!==bi&&(Hn-=Hn-bi),bi=-1}else for(V+Mn>It&&(V=It-Mn),Hn=V;Hn>=0;Hn--){for(var fi=!0,Gr=0;Gr<Mn;Gr++)if(Rn(B,Hn+Gr)!==Rn(P,Gr)){fi=!1;break}if(fi)return Hn}return-1}function Q(B,P,V,Re){V=Number(V)||0;var Qe=B.length-V;Re?(Re=Number(Re))>Qe&&(Re=Qe):Re=Qe;var vt=P.length;Re>vt/2&&(Re=vt/2);for(var It=0;It<Re;++It){var Mn=parseInt(P.substr(2*It,2),16);if(be(Mn))return It;B[V+It]=Mn}return It}function oe(B,P,V,Re){return gt(H(P,B.length-V),B,V,Re)}function se(B,P,V,Re){return gt(function(B){for(var P=[],V=0;V<B.length;++V)P.push(255&B.charCodeAt(V));return P}(P),B,V,Re)}function ee(B,P,V,Re){return se(B,P,V,Re)}function Se(B,P,V,Re){return gt(Ve(P),B,V,Re)}function me(B,P,V,Re){return gt(function(B,P){for(var V,Re,vt=[],It=0;It<B.length&&!((P-=2)<0);++It)Re=(V=B.charCodeAt(It))>>8,vt.push(V%256),vt.push(Re);return vt}(P,B.length-V),B,V,Re)}function te(B,P,V){return U.fromByteArray(0===P&&V===B.length?B:B.slice(P,V))}function _e(B,P,V){V=Math.min(B.length,V);for(var Re=[],Qe=P;Qe<V;){var Rn,Hn,bi,fi,vt=B[Qe],It=null,Mn=vt>239?4:vt>223?3:vt>191?2:1;if(Qe+Mn<=V)switch(Mn){case 1:vt<128&&(It=vt);break;case 2:128==(192&(Rn=B[Qe+1]))&&(fi=(31&vt)<<6|63&Rn)>127&&(It=fi);break;case 3:Hn=B[Qe+2],128==(192&(Rn=B[Qe+1]))&&128==(192&Hn)&&(fi=(15&vt)<<12|(63&Rn)<<6|63&Hn)>2047&&(fi<55296||fi>57343)&&(It=fi);break;case 4:Hn=B[Qe+2],bi=B[Qe+3],128==(192&(Rn=B[Qe+1]))&&128==(192&Hn)&&128==(192&bi)&&(fi=(15&vt)<<18|(63&Rn)<<12|(63&Hn)<<6|63&bi)>65535&&fi<1114112&&(It=fi)}null===It?(It=65533,Mn=1):It>65535&&(Re.push((It-=65536)>>>10&1023|55296),It=56320|1023&It),Re.push(It),Qe+=Mn}return function(B){var P=B.length;if(P<=4096)return String.fromCharCode.apply(String,B);for(var V="",Re=0;Re<P;)V+=String.fromCharCode.apply(String,B.slice(Re,Re+=4096));return V}(Re)}pe.kMaxLength=ie,!(x.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===B.foo()}catch(P){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.buffer}}),Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&x[Symbol.species]===x&&Object.defineProperty(x,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),x.poolSize=8192,x.from=function(B,P,V){return N(B,P,V)},x.prototype.__proto__=Uint8Array.prototype,x.__proto__=Uint8Array,x.alloc=function(B,P,V){return function(B,P,V){return M(B),B<=0?b(B):void 0!==P?"string"==typeof V?b(B).fill(P,V):b(B).fill(P):b(B)}(B,P,V)},x.allocUnsafe=function(B){return y(B)},x.allocUnsafeSlow=function(B){return y(B)},x.isBuffer=function(P){return null!=P&&!0===P._isBuffer&&P!==x.prototype},x.compare=function(P,V){if(ft(P,Uint8Array)&&(P=x.from(P,P.offset,P.byteLength)),ft(V,Uint8Array)&&(V=x.from(V,V.offset,V.byteLength)),!x.isBuffer(P)||!x.isBuffer(V))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(P===V)return 0;for(var Re=P.length,Qe=V.length,vt=0,It=Math.min(Re,Qe);vt<It;++vt)if(P[vt]!==V[vt]){Re=P[vt],Qe=V[vt];break}return Re<Qe?-1:Qe<Re?1:0},x.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},x.concat=function(P,V){if(!Array.isArray(P))throw new TypeError('"list" argument must be an Array of Buffers');if(0===P.length)return x.alloc(0);var Re;if(void 0===V)for(V=0,Re=0;Re<P.length;++Re)V+=P[Re].length;var Qe=x.allocUnsafe(V),vt=0;for(Re=0;Re<P.length;++Re){var It=P[Re];if(ft(It,Uint8Array)&&(It=x.from(It)),!x.isBuffer(It))throw new TypeError('"list" argument must be an Array of Buffers');It.copy(Qe,vt),vt+=It.length}return Qe},x.byteLength=D,x.prototype._isBuffer=!0,x.prototype.swap16=function(){var P=this.length;if(P%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var V=0;V<P;V+=2)X(this,V,V+1);return this},x.prototype.swap32=function(){var P=this.length;if(P%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var V=0;V<P;V+=4)X(this,V,V+3),X(this,V+1,V+2);return this},x.prototype.swap64=function(){var P=this.length;if(P%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var V=0;V<P;V+=8)X(this,V,V+7),X(this,V+1,V+6),X(this,V+2,V+5),X(this,V+3,V+4);return this},x.prototype.toLocaleString=x.prototype.toString=function(){var P=this.length;return 0===P?"":0===arguments.length?_e(this,0,P):I.apply(this,arguments)},x.prototype.equals=function(P){if(!x.isBuffer(P))throw new TypeError("Argument must be a Buffer");return this===P||0===x.compare(this,P)},x.prototype.inspect=function(){var P="",V=pe.INSPECT_MAX_BYTES;return P=this.toString("hex",0,V).replace(/(.{2})/g,"$1 ").trim(),this.length>V&&(P+=" ... "),"<Buffer "+P+">"},x.prototype.compare=function(P,V,Re,Qe,vt){if(ft(P,Uint8Array)&&(P=x.from(P,P.offset,P.byteLength)),!x.isBuffer(P))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof P);if(void 0===V&&(V=0),void 0===Re&&(Re=P?P.length:0),void 0===Qe&&(Qe=0),void 0===vt&&(vt=this.length),V<0||Re>P.length||Qe<0||vt>this.length)throw new RangeError("out of range index");if(Qe>=vt&&V>=Re)return 0;if(Qe>=vt)return-1;if(V>=Re)return 1;if(this===P)return 0;for(var It=(vt>>>=0)-(Qe>>>=0),Mn=(Re>>>=0)-(V>>>=0),Rn=Math.min(It,Mn),Hn=this.slice(Qe,vt),bi=P.slice(V,Re),fi=0;fi<Rn;++fi)if(Hn[fi]!==bi[fi]){It=Hn[fi],Mn=bi[fi];break}return It<Mn?-1:Mn<It?1:0},x.prototype.includes=function(P,V,Re){return-1!==this.indexOf(P,V,Re)},x.prototype.indexOf=function(P,V,Re){return w(this,P,V,Re,!0)},x.prototype.lastIndexOf=function(P,V,Re){return w(this,P,V,Re,!1)},x.prototype.write=function(P,V,Re,Qe){if(void 0===V)Qe="utf8",Re=this.length,V=0;else if(void 0===Re&&"string"==typeof V)Qe=V,Re=this.length,V=0;else{if(!isFinite(V))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");V>>>=0,isFinite(Re)?(Re>>>=0,void 0===Qe&&(Qe="utf8")):(Qe=Re,Re=void 0)}var vt=this.length-V;if((void 0===Re||Re>vt)&&(Re=vt),P.length>0&&(Re<0||V<0)||V>this.length)throw new RangeError("Attempt to write outside buffer bounds");Qe||(Qe="utf8");for(var It=!1;;)switch(Qe){case"hex":return Q(this,P,V,Re);case"utf8":case"utf-8":return oe(this,P,V,Re);case"ascii":return se(this,P,V,Re);case"latin1":case"binary":return ee(this,P,V,Re);case"base64":return Se(this,P,V,Re);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,P,V,Re);default:if(It)throw new TypeError("Unknown encoding: "+Qe);Qe=(""+Qe).toLowerCase(),It=!0}},x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function rt(B,P,V){var Re="";V=Math.min(B.length,V);for(var Qe=P;Qe<V;++Qe)Re+=String.fromCharCode(127&B[Qe]);return Re}function Xe(B,P,V){var Re="";V=Math.min(B.length,V);for(var Qe=P;Qe<V;++Qe)Re+=String.fromCharCode(B[Qe]);return Re}function Je(B,P,V){var Re=B.length;(!P||P<0)&&(P=0),(!V||V<0||V>Re)&&(V=Re);for(var Qe="",vt=P;vt<V;++vt)Qe+=$(B[vt]);return Qe}function Ye(B,P,V){for(var Re=B.slice(P,V),Qe="",vt=0;vt<Re.length;vt+=2)Qe+=String.fromCharCode(Re[vt]+256*Re[vt+1]);return Qe}function Ue(B,P,V){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+P>V)throw new RangeError("Trying to access beyond buffer length")}function Le(B,P,V,Re,Qe,vt){if(!x.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(P>Qe||P<vt)throw new RangeError('"value" argument is out of bounds');if(V+Re>B.length)throw new RangeError("Index out of range")}function Ke(B,P,V,Re,Qe,vt){if(V+Re>B.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("Index out of range")}function xe(B,P,V,Re,Qe){return P=+P,V>>>=0,Qe||Ke(B,0,V,4),k.write(B,P,V,Re,23,4),V+4}function je(B,P,V,Re,Qe){return P=+P,V>>>=0,Qe||Ke(B,0,V,8),k.write(B,P,V,Re,52,8),V+8}x.prototype.slice=function(P,V){var Re=this.length;(P=~~P)<0?(P+=Re)<0&&(P=0):P>Re&&(P=Re),(V=void 0===V?Re:~~V)<0?(V+=Re)<0&&(V=0):V>Re&&(V=Re),V<P&&(V=P);var Qe=this.subarray(P,V);return Qe.__proto__=x.prototype,Qe},x.prototype.readUIntLE=function(P,V,Re){P>>>=0,V>>>=0,Re||Ue(P,V,this.length);for(var Qe=this[P],vt=1,It=0;++It<V&&(vt*=256);)Qe+=this[P+It]*vt;return Qe},x.prototype.readUIntBE=function(P,V,Re){P>>>=0,V>>>=0,Re||Ue(P,V,this.length);for(var Qe=this[P+--V],vt=1;V>0&&(vt*=256);)Qe+=this[P+--V]*vt;return Qe},x.prototype.readUInt8=function(P,V){return P>>>=0,V||Ue(P,1,this.length),this[P]},x.prototype.readUInt16LE=function(P,V){return P>>>=0,V||Ue(P,2,this.length),this[P]|this[P+1]<<8},x.prototype.readUInt16BE=function(P,V){return P>>>=0,V||Ue(P,2,this.length),this[P]<<8|this[P+1]},x.prototype.readUInt32LE=function(P,V){return P>>>=0,V||Ue(P,4,this.length),(this[P]|this[P+1]<<8|this[P+2]<<16)+16777216*this[P+3]},x.prototype.readUInt32BE=function(P,V){return P>>>=0,V||Ue(P,4,this.length),16777216*this[P]+(this[P+1]<<16|this[P+2]<<8|this[P+3])},x.prototype.readIntLE=function(P,V,Re){P>>>=0,V>>>=0,Re||Ue(P,V,this.length);for(var Qe=this[P],vt=1,It=0;++It<V&&(vt*=256);)Qe+=this[P+It]*vt;return Qe>=(vt*=128)&&(Qe-=Math.pow(2,8*V)),Qe},x.prototype.readIntBE=function(P,V,Re){P>>>=0,V>>>=0,Re||Ue(P,V,this.length);for(var Qe=V,vt=1,It=this[P+--Qe];Qe>0&&(vt*=256);)It+=this[P+--Qe]*vt;return It>=(vt*=128)&&(It-=Math.pow(2,8*V)),It},x.prototype.readInt8=function(P,V){return P>>>=0,V||Ue(P,1,this.length),128&this[P]?-1*(255-this[P]+1):this[P]},x.prototype.readInt16LE=function(P,V){P>>>=0,V||Ue(P,2,this.length);var Re=this[P]|this[P+1]<<8;return 32768&Re?4294901760|Re:Re},x.prototype.readInt16BE=function(P,V){P>>>=0,V||Ue(P,2,this.length);var Re=this[P+1]|this[P]<<8;return 32768&Re?4294901760|Re:Re},x.prototype.readInt32LE=function(P,V){return P>>>=0,V||Ue(P,4,this.length),this[P]|this[P+1]<<8|this[P+2]<<16|this[P+3]<<24},x.prototype.readInt32BE=function(P,V){return P>>>=0,V||Ue(P,4,this.length),this[P]<<24|this[P+1]<<16|this[P+2]<<8|this[P+3]},x.prototype.readFloatLE=function(P,V){return P>>>=0,V||Ue(P,4,this.length),k.read(this,P,!0,23,4)},x.prototype.readFloatBE=function(P,V){return P>>>=0,V||Ue(P,4,this.length),k.read(this,P,!1,23,4)},x.prototype.readDoubleLE=function(P,V){return P>>>=0,V||Ue(P,8,this.length),k.read(this,P,!0,52,8)},x.prototype.readDoubleBE=function(P,V){return P>>>=0,V||Ue(P,8,this.length),k.read(this,P,!1,52,8)},x.prototype.writeUIntLE=function(P,V,Re,Qe){P=+P,V>>>=0,Re>>>=0,Qe||Le(this,P,V,Re,Math.pow(2,8*Re)-1,0);var It=1,Mn=0;for(this[V]=255&P;++Mn<Re&&(It*=256);)this[V+Mn]=P/It&255;return V+Re},x.prototype.writeUIntBE=function(P,V,Re,Qe){P=+P,V>>>=0,Re>>>=0,Qe||Le(this,P,V,Re,Math.pow(2,8*Re)-1,0);var It=Re-1,Mn=1;for(this[V+It]=255&P;--It>=0&&(Mn*=256);)this[V+It]=P/Mn&255;return V+Re},x.prototype.writeUInt8=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,1,255,0),this[V]=255&P,V+1},x.prototype.writeUInt16LE=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,2,65535,0),this[V]=255&P,this[V+1]=P>>>8,V+2},x.prototype.writeUInt16BE=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,2,65535,0),this[V]=P>>>8,this[V+1]=255&P,V+2},x.prototype.writeUInt32LE=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,4,4294967295,0),this[V+3]=P>>>24,this[V+2]=P>>>16,this[V+1]=P>>>8,this[V]=255&P,V+4},x.prototype.writeUInt32BE=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,4,4294967295,0),this[V]=P>>>24,this[V+1]=P>>>16,this[V+2]=P>>>8,this[V+3]=255&P,V+4},x.prototype.writeIntLE=function(P,V,Re,Qe){if(P=+P,V>>>=0,!Qe){var vt=Math.pow(2,8*Re-1);Le(this,P,V,Re,vt-1,-vt)}var It=0,Mn=1,Rn=0;for(this[V]=255&P;++It<Re&&(Mn*=256);)P<0&&0===Rn&&0!==this[V+It-1]&&(Rn=1),this[V+It]=(P/Mn>>0)-Rn&255;return V+Re},x.prototype.writeIntBE=function(P,V,Re,Qe){if(P=+P,V>>>=0,!Qe){var vt=Math.pow(2,8*Re-1);Le(this,P,V,Re,vt-1,-vt)}var It=Re-1,Mn=1,Rn=0;for(this[V+It]=255&P;--It>=0&&(Mn*=256);)P<0&&0===Rn&&0!==this[V+It+1]&&(Rn=1),this[V+It]=(P/Mn>>0)-Rn&255;return V+Re},x.prototype.writeInt8=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,1,127,-128),P<0&&(P=255+P+1),this[V]=255&P,V+1},x.prototype.writeInt16LE=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,2,32767,-32768),this[V]=255&P,this[V+1]=P>>>8,V+2},x.prototype.writeInt16BE=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,2,32767,-32768),this[V]=P>>>8,this[V+1]=255&P,V+2},x.prototype.writeInt32LE=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,4,2147483647,-2147483648),this[V]=255&P,this[V+1]=P>>>8,this[V+2]=P>>>16,this[V+3]=P>>>24,V+4},x.prototype.writeInt32BE=function(P,V,Re){return P=+P,V>>>=0,Re||Le(this,P,V,4,2147483647,-2147483648),P<0&&(P=4294967295+P+1),this[V]=P>>>24,this[V+1]=P>>>16,this[V+2]=P>>>8,this[V+3]=255&P,V+4},x.prototype.writeFloatLE=function(P,V,Re){return xe(this,P,V,!0,Re)},x.prototype.writeFloatBE=function(P,V,Re){return xe(this,P,V,!1,Re)},x.prototype.writeDoubleLE=function(P,V,Re){return je(this,P,V,!0,Re)},x.prototype.writeDoubleBE=function(P,V,Re){return je(this,P,V,!1,Re)},x.prototype.copy=function(P,V,Re,Qe){if(!x.isBuffer(P))throw new TypeError("argument should be a Buffer");if(Re||(Re=0),!Qe&&0!==Qe&&(Qe=this.length),V>=P.length&&(V=P.length),V||(V=0),Qe>0&&Qe<Re&&(Qe=Re),Qe===Re||0===P.length||0===this.length)return 0;if(V<0)throw new RangeError("targetStart out of bounds");if(Re<0||Re>=this.length)throw new RangeError("Index out of range");if(Qe<0)throw new RangeError("sourceEnd out of bounds");Qe>this.length&&(Qe=this.length),P.length-V<Qe-Re&&(Qe=P.length-V+Re);var vt=Qe-Re;if(this===P&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(V,Re,Qe);else if(this===P&&Re<V&&V<Qe)for(var It=vt-1;It>=0;--It)P[It+V]=this[It+Re];else Uint8Array.prototype.set.call(P,this.subarray(Re,Qe),V);return vt},x.prototype.fill=function(P,V,Re,Qe){if("string"==typeof P){if("string"==typeof V?(Qe=V,V=0,Re=this.length):"string"==typeof Re&&(Qe=Re,Re=this.length),void 0!==Qe&&"string"!=typeof Qe)throw new TypeError("encoding must be a string");if("string"==typeof Qe&&!x.isEncoding(Qe))throw new TypeError("Unknown encoding: "+Qe);if(1===P.length){var vt=P.charCodeAt(0);("utf8"===Qe&&vt<128||"latin1"===Qe)&&(P=vt)}}else"number"==typeof P&&(P&=255);if(V<0||this.length<V||this.length<Re)throw new RangeError("Out of range index");if(Re<=V)return this;var It;if(V>>>=0,Re=void 0===Re?this.length:Re>>>0,P||(P=0),"number"==typeof P)for(It=V;It<Re;++It)this[It]=P;else{var Mn=x.isBuffer(P)?P:x.from(P,Qe),Rn=Mn.length;if(0===Rn)throw new TypeError('The value "'+P+'" is invalid for argument "value"');for(It=0;It<Re-V;++It)this[It+V]=Mn[It%Rn]}return this};var We=/[^+/0-9A-Za-z-_]/g;function $(B){return B<16?"0"+B.toString(16):B.toString(16)}function H(B,P){P=P||1/0;for(var V,Re=B.length,Qe=null,vt=[],It=0;It<Re;++It){if((V=B.charCodeAt(It))>55295&&V<57344){if(!Qe){if(V>56319){(P-=3)>-1&&vt.push(239,191,189);continue}if(It+1===Re){(P-=3)>-1&&vt.push(239,191,189);continue}Qe=V;continue}if(V<56320){(P-=3)>-1&&vt.push(239,191,189),Qe=V;continue}V=65536+(Qe-55296<<10|V-56320)}else Qe&&(P-=3)>-1&&vt.push(239,191,189);if(Qe=null,V<128){if((P-=1)<0)break;vt.push(V)}else if(V<2048){if((P-=2)<0)break;vt.push(V>>6|192,63&V|128)}else if(V<65536){if((P-=3)<0)break;vt.push(V>>12|224,V>>6&63|128,63&V|128)}else{if(!(V<1114112))throw new Error("Invalid code point");if((P-=4)<0)break;vt.push(V>>18|240,V>>12&63|128,V>>6&63|128,63&V|128)}}return vt}function Ve(B){return U.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(We,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(B))}function gt(B,P,V,Re){for(var Qe=0;Qe<Re&&!(Qe+V>=P.length||Qe>=B.length);++Qe)P[Qe+V]=B[Qe];return Qe}function ft(B,P){return B instanceof P||null!=B&&null!=B.constructor&&null!=B.constructor.name&&B.constructor.name===P.name}function be(B){return B!=B}}).call(this)}).call(this,K("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:9}],7:[function(K,Ae,pe){"use strict";Ae.exports=function Y(U){return null===U||"object"!=typeof U||null!=U.toJSON?JSON.stringify(U):Array.isArray(U)?"["+U.reduce((k,ie,W)=>k+(0===W?"":",")+Y(void 0===ie||"symbol"==typeof ie?null:ie),"")+"]":"{"+Object.keys(U).sort().reduce((k,ie,W)=>void 0===U[ie]||"symbol"==typeof U[ie]?k:k+(0===k.length?"":",")+Y(ie)+":"+Y(U[ie]),"")+"}"}},{}],8:[function(K,Ae,pe){"use strict";var k,Y="object"==typeof Reflect?Reflect:null,U=Y&&"function"==typeof Y.apply?Y.apply:function(G,Q,oe){return Function.prototype.apply.call(G,Q,oe)};k=Y&&"function"==typeof Y.ownKeys?Y.ownKeys:Object.getOwnPropertySymbols?function(G){return Object.getOwnPropertyNames(G).concat(Object.getOwnPropertySymbols(G))}:function(G){return Object.getOwnPropertyNames(G)};var W=Number.isNaN||function(G){return G!=G};function b(){b.init.call(this)}Ae.exports=b,Ae.exports.once=function(w,G){return new Promise(function(Q,oe){function se(Se){w.removeListener(G,ee),oe(Se)}function ee(){"function"==typeof w.removeListener&&w.removeListener("error",se),Q([].slice.call(arguments))}X(w,G,ee,{once:!0}),"error"!==G&&function(w,G,Q){"function"==typeof w.on&&X(w,"error",G,Q)}(w,se,{once:!0})})},b.EventEmitter=b,b.prototype._events=void 0,b.prototype._eventsCount=0,b.prototype._maxListeners=void 0;var x=10;function N(w){if("function"!=typeof w)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof w)}function M(w){return void 0===w._maxListeners?b.defaultMaxListeners:w._maxListeners}function v(w,G,Q,oe){var se,ee,Se;if(N(Q),void 0===(ee=w._events)?(ee=w._events=Object.create(null),w._eventsCount=0):(void 0!==ee.newListener&&(w.emit("newListener",G,Q.listener?Q.listener:Q),ee=w._events),Se=ee[G]),void 0===Se)Se=ee[G]=Q,++w._eventsCount;else if("function"==typeof Se?Se=ee[G]=oe?[Q,Se]:[Se,Q]:oe?Se.unshift(Q):Se.push(Q),(se=M(w))>0&&Se.length>se&&!Se.warned){Se.warned=!0;var me=new Error("Possible EventEmitter memory leak detected. "+Se.length+" "+String(G)+" listeners added. Use emitter.setMaxListeners() to increase limit");me.name="MaxListenersExceededWarning",me.emitter=w,me.type=G,me.count=Se.length,function(w){console&&console.warn&&console.warn(w)}(me)}return w}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function S(w,G,Q){var oe={fired:!1,wrapFn:void 0,target:w,type:G,listener:Q},se=y.bind(oe);return se.listener=Q,oe.wrapFn=se,se}function T(w,G,Q){var oe=w._events;if(void 0===oe)return[];var se=oe[G];return void 0===se?[]:"function"==typeof se?Q?[se.listener||se]:[se]:Q?function(w){for(var G=new Array(w.length),Q=0;Q<G.length;++Q)G[Q]=w[Q].listener||w[Q];return G}(se):O(se,se.length)}function j(w){var G=this._events;if(void 0!==G){var Q=G[w];if("function"==typeof Q)return 1;if(void 0!==Q)return Q.length}return 0}function O(w,G){for(var Q=new Array(G),oe=0;oe<G;++oe)Q[oe]=w[oe];return Q}function X(w,G,Q,oe){if("function"==typeof w.on)oe.once?w.once(G,Q):w.on(G,Q);else{if("function"!=typeof w.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof w);w.addEventListener(G,function se(ee){oe.once&&w.removeEventListener(G,se),Q(ee)})}}Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return x},set:function(w){if("number"!=typeof w||w<0||W(w))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+w+".");x=w}}),b.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},b.prototype.setMaxListeners=function(G){if("number"!=typeof G||G<0||W(G))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+G+".");return this._maxListeners=G,this},b.prototype.getMaxListeners=function(){return M(this)},b.prototype.emit=function(G){for(var Q=[],oe=1;oe<arguments.length;oe++)Q.push(arguments[oe]);var se="error"===G,ee=this._events;if(void 0!==ee)se=se&&void 0===ee.error;else if(!se)return!1;if(se){var Se;if(Q.length>0&&(Se=Q[0]),Se instanceof Error)throw Se;var me=new Error("Unhandled error."+(Se?" ("+Se.message+")":""));throw me.context=Se,me}var te=ee[G];if(void 0===te)return!1;if("function"==typeof te)U(te,this,Q);else{var _e=te.length,Oe=O(te,_e);for(oe=0;oe<_e;++oe)U(Oe[oe],this,Q)}return!0},b.prototype.on=b.prototype.addListener=function(G,Q){return v(this,G,Q,!1)},b.prototype.prependListener=function(G,Q){return v(this,G,Q,!0)},b.prototype.once=function(G,Q){return N(Q),this.on(G,S(this,G,Q)),this},b.prototype.prependOnceListener=function(G,Q){return N(Q),this.prependListener(G,S(this,G,Q)),this},b.prototype.off=b.prototype.removeListener=function(G,Q){var oe,se,ee,Se,me;if(N(Q),void 0===(se=this._events))return this;if(void 0===(oe=se[G]))return this;if(oe===Q||oe.listener===Q)0==--this._eventsCount?this._events=Object.create(null):(delete se[G],se.removeListener&&this.emit("removeListener",G,oe.listener||Q));else if("function"!=typeof oe){for(ee=-1,Se=oe.length-1;Se>=0;Se--)if(oe[Se]===Q||oe[Se].listener===Q){me=oe[Se].listener,ee=Se;break}if(ee<0)return this;0===ee?oe.shift():function(w,G){for(;G+1<w.length;G++)w[G]=w[G+1];w.pop()}(oe,ee),1===oe.length&&(se[G]=oe[0]),void 0!==se.removeListener&&this.emit("removeListener",G,me||Q)}return this},b.prototype.removeAllListeners=function(G){var Q,oe,se;if(void 0===(oe=this._events))return this;if(void 0===oe.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==oe[G]&&(0==--this._eventsCount?this._events=Object.create(null):delete oe[G]),this;if(0===arguments.length){var Se,ee=Object.keys(oe);for(se=0;se<ee.length;++se)"removeListener"!==(Se=ee[se])&&this.removeAllListeners(Se);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Q=oe[G]))this.removeListener(G,Q);else if(void 0!==Q)for(se=Q.length-1;se>=0;se--)this.removeListener(G,Q[se]);return this},b.prototype.listeners=function(G){return T(this,G,!0)},b.prototype.rawListeners=function(G){return T(this,G,!1)},b.listenerCount=function(w,G){return"function"==typeof w.listenerCount?w.listenerCount(G):j.call(w,G)},b.prototype.listenerCount=j,b.prototype.eventNames=function(){return this._eventsCount>0?k(this._events):[]}},{}],9:[function(K,Ae,pe){pe.read=function(Y,U,k,ie,W){var b,x,N=8*W-ie-1,M=(1<<N)-1,v=M>>1,y=-7,S=k?W-1:0,T=k?-1:1,j=Y[U+S];for(S+=T,b=j&(1<<-y)-1,j>>=-y,y+=N;y>0;b=256*b+Y[U+S],S+=T,y-=8);for(x=b&(1<<-y)-1,b>>=-y,y+=ie;y>0;x=256*x+Y[U+S],S+=T,y-=8);if(0===b)b=1-v;else{if(b===M)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,ie),b-=v}return(j?-1:1)*x*Math.pow(2,b-ie)},pe.write=function(Y,U,k,ie,W,b){var x,N,M,v=8*b-W-1,y=(1<<v)-1,S=y>>1,T=23===W?Math.pow(2,-24)-Math.pow(2,-77):0,j=ie?0:b-1,O=ie?1:-1,q=U<0||0===U&&1/U<0?1:0;for(U=Math.abs(U),isNaN(U)||U===1/0?(N=isNaN(U)?1:0,x=y):(x=Math.floor(Math.log(U)/Math.LN2),U*(M=Math.pow(2,-x))<1&&(x--,M*=2),(U+=x+S>=1?T/M:T*Math.pow(2,1-S))*M>=2&&(x++,M/=2),x+S>=y?(N=0,x=y):x+S>=1?(N=(U*M-1)*Math.pow(2,W),x+=S):(N=U*Math.pow(2,S-1)*Math.pow(2,W),x=0));W>=8;Y[k+j]=255&N,j+=O,N/=256,W-=8);for(x=x<<W|N,v+=W;v>0;Y[k+j]=255&x,j+=O,x/=256,v-=8);Y[k+j-O]|=128*q}},{}],10:[function(K,Ae,pe){Ae.exports="function"==typeof Object.create?function(U,k){k&&(U.super_=k,U.prototype=Object.create(k.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}))}:function(U,k){if(k){U.super_=k;var ie=function(){};ie.prototype=k.prototype,U.prototype=new ie,U.prototype.constructor=U}}},{}],11:[function(K,Ae,pe){"use strict";const{isArray:Y,isObject:U,isString:k}=K("./types"),{asArray:ie}=K("./util"),{prependBase:W}=K("./url"),b=K("./JsonLdError"),x=K("./ResolvedContext");function M(y){throw new b("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:y})}function v({context:y,base:S}){if(!y)return;const T=y["@context"];if(k(T))y["@context"]=W(S,T);else if(Y(T))for(let j=0;j<T.length;++j){const O=T[j];k(O)?T[j]=W(S,O):U(O)&&v({context:{"@context":O},base:S})}else if(U(T))for(const j in T)v({context:T[j],base:S})}Ae.exports=class{constructor({sharedCache:S}){this.perOpCache=new Map,this.sharedCache=S}resolve({activeCtx:S,context:T,documentLoader:j,base:O,cycles:q=new Set}){var ce=this;return mt(function*(){T&&U(T)&&T["@context"]&&(T=T["@context"]),T=ie(T);const D=[];for(const I of T){if(k(I)){let G=ce._get(I);G||(G=yield ce._resolveRemoteContext({activeCtx:S,url:I,documentLoader:j,base:O,cycles:q})),Y(G)?D.push(...G):D.push(G);continue}if(null===I){D.push(new x({document:null}));continue}U(I)||M(T);const X=JSON.stringify(I);let w=ce._get(X);w||(w=new x({document:I}),ce._cacheResolvedContext({key:X,resolved:w,tag:"static"})),D.push(w)}return D})()}_get(S){let T=this.perOpCache.get(S);if(!T){const j=this.sharedCache.get(S);j&&(T=j.get("static"),T&&this.perOpCache.set(S,T))}return T}_cacheResolvedContext({key:S,resolved:T,tag:j}){if(this.perOpCache.set(S,T),void 0!==j){let O=this.sharedCache.get(S);O||(O=new Map,this.sharedCache.set(S,O)),O.set(j,T)}return T}_resolveRemoteContext({activeCtx:S,url:T,documentLoader:j,base:O,cycles:q}){var ce=this;return mt(function*(){T=W(O,T);const{context:D,remoteDoc:I}=yield ce._fetchContext({activeCtx:S,url:T,documentLoader:j,cycles:q});v({context:D,base:O=I.documentUrl||T});const X=yield ce.resolve({activeCtx:S,context:D,documentLoader:j,base:O,cycles:q});return ce._cacheResolvedContext({key:T,resolved:X,tag:I.tag}),X})()}_fetchContext({activeCtx:S,url:T,documentLoader:j,cycles:O}){return mt(function*(){if(O.size>10)throw new b("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"loading remote context failed":"context overflow",max:10});if(O.has(T))throw new b("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===S.processingMode?"recursive context inclusion":"context overflow",url:T});let q,ce;O.add(T);try{ce=yield j(T),q=ce.document||null,k(q)&&(q=JSON.parse(q))}catch(D){throw new b("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:T,cause:D})}if(!U(q))throw new b("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:T});return q="@context"in q?{"@context":q["@context"]}:{"@context":{}},ce.contextUrl&&(Y(q["@context"])||(q["@context"]=[q["@context"]]),q["@context"].push(ce.contextUrl)),{context:q,remoteDoc:ce}})()}}},{"./JsonLdError":12,"./ResolvedContext":16,"./types":30,"./url":31,"./util":32}],12:[function(K,Ae,pe){"use strict";Ae.exports=class extends Error{constructor(U="An unspecified JSON-LD error occurred.",k="jsonld.Error",ie={}){super(U),this.name=k,this.message=U,this.details=ie}}},{}],13:[function(K,Ae,pe){"use strict";Ae.exports=Y=>{class U{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(U,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(U.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:U}),U.compact=function(k,ie){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):Y.compact(k,ie)},U.expand=function(k){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):Y.expand(k)},U.flatten=function(k){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):Y.flatten(k)},U}},{}],14:[function(K,Ae,pe){"use strict";Ae.exports=K("rdf-canonize").NQuads},{"rdf-canonize":46}],15:[function(K,Ae,pe){"use strict";Ae.exports=class{constructor(){this._requests={}}wrapLoader(U){const k=this;return k._loader=U,function(){return k.add.apply(k,arguments)}}add(U){var k=this;return mt(function*(){let ie=k._requests[U];if(ie)return Promise.resolve(ie);ie=k._requests[U]=k._loader(U);try{return yield ie}finally{delete k._requests[U]}})()}}},{}],16:[function(K,Ae,pe){"use strict";const Y=K("lru-cache");Ae.exports=class{constructor({document:ie}){this.document=ie,this.cache=new Y({max:10})}getProcessed(ie){return this.cache.get(ie)}setProcessed(ie,W){this.cache.set(ie,W)}}},{"lru-cache":33}],17:[function(K,Ae,pe){"use strict";const Y=K("./JsonLdError"),{isArray:U,isObject:k,isString:ie,isUndefined:W}=K("./types"),{isList:b,isValue:x,isGraph:N,isSimpleGraph:M,isSubjectReference:v}=K("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:T,process:j,processingMode:O}=K("./context"),{removeBase:q,prependBase:ce}=K("./url"),{addValue:D,asArray:I,compareShortestLeast:X}=K("./util"),w={};function Q(oe,se,ee){if("@nest"!==y(oe,se,{vocab:!0},ee))throw new Y("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}Ae.exports=w,w.compact=function(){var oe=mt(function*({activeCtx:se,activeProperty:ee=null,element:Se,options:me={},compactionMap:te=(()=>{})}){if(U(Se)){let Oe=[];for(let Ge=0;Ge<Se.length;++Ge){let rt=yield w.compact({activeCtx:se,activeProperty:ee,element:Se[Ge],options:me,compactionMap:te});null===rt&&(rt=yield te({unmappedValue:Se[Ge],activeCtx:se,activeProperty:ee,parent:Se,index:Ge,options:me}),void 0===rt)||Oe.push(rt)}return me.compactArrays&&1===Oe.length&&0===(S(se,ee,"@container")||[]).length&&(Oe=Oe[0]),Oe}const _e=S(se,ee,"@context");if(W(_e)||(se=yield j({activeCtx:se,localCtx:_e,propagate:!0,overrideProtected:!0,options:me})),k(Se)){if(me.link&&"@id"in Se&&me.link.hasOwnProperty(Se["@id"])){const Le=me.link[Se["@id"]];for(let Ke=0;Ke<Le.length;++Ke)if(Le[Ke].expanded===Se)return Le[Ke].compacted}if(x(Se)||v(Se)){const Le=w.compactValue({activeCtx:se,activeProperty:ee,value:Se,options:me});return me.link&&v(Se)&&(me.link.hasOwnProperty(Se["@id"])||(me.link[Se["@id"]]=[]),me.link[Se["@id"]].push({expanded:Se,compacted:Le})),Le}if(b(Se)&&(S(se,ee,"@container")||[]).includes("@list"))return w.compact({activeCtx:se,activeProperty:ee,element:Se["@list"],options:me,compactionMap:te});const Oe="@reverse"===ee,Ge={},rt=se;!x(Se)&&!v(Se)&&(se=se.revertToPreviousContext());const Xe=S(rt,ee,"@context");W(Xe)||(se=yield j({activeCtx:se,localCtx:Xe,propagate:!0,overrideProtected:!0,options:me})),me.link&&"@id"in Se&&(me.link.hasOwnProperty(Se["@id"])||(me.link[Se["@id"]]=[]),me.link[Se["@id"]].push({expanded:Se,compacted:Ge}));let Je=Se["@type"]||[];Je.length>1&&(Je=Array.from(Je).sort());const Ye=se;for(const Le of Je){const Ke=w.compactIri({activeCtx:Ye,iri:Le,relativeTo:{vocab:!0}}),xe=S(rt,Ke,"@context");W(xe)||(se=yield j({activeCtx:se,localCtx:xe,options:me,propagate:!1}))}const Ue=Object.keys(Se).sort();for(const Le of Ue){const Ke=Se[Le];if("@id"!==Le)if("@type"!==Le)if("@reverse"!==Le)if("@preserve"!==Le)if("@index"!==Le)if("@graph"!==Le&&"@list"!==Le&&"@included"!==Le&&T(Le)){const xe=w.compactIri({activeCtx:se,iri:Le,relativeTo:{vocab:!0}});D(Ge,xe,Ke)}else{if(!U(Ke))throw new Y("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Ke.length){const xe=w.compactIri({activeCtx:se,iri:Le,value:Ke,relativeTo:{vocab:!0},reverse:Oe}),je=se.mappings.has(xe)?se.mappings.get(xe)["@nest"]:null;let We=Ge;je&&(Q(se,je,me),k(Ge[je])||(Ge[je]={}),We=Ge[je]),D(We,xe,Ke,{propertyIsArray:!0})}for(const xe of Ke){const je=w.compactIri({activeCtx:se,iri:Le,value:xe,relativeTo:{vocab:!0},reverse:Oe}),We=se.mappings.has(je)?se.mappings.get(je)["@nest"]:null;let Pe=Ge;We&&(Q(se,We,me),k(Ge[We])||(Ge[We]={}),Pe=Ge[We]);const $=S(se,je,"@container")||[],H=N(xe),fe=b(xe);let ue;fe?ue=xe["@list"]:H&&(ue=xe["@graph"]);let Ve=yield w.compact({activeCtx:se,activeProperty:je,element:fe||H?ue:xe,options:me,compactionMap:te});if(fe){if(U(Ve)||(Ve=[Ve]),$.includes("@list")){D(Pe,je,Ve,{valueIsArray:!0,allowDuplicate:!0});continue}Ve={[w.compactIri({activeCtx:se,iri:"@list",relativeTo:{vocab:!0}})]:Ve},"@index"in xe&&(Ve[w.compactIri({activeCtx:se,iri:"@index",relativeTo:{vocab:!0}})]=xe["@index"])}if(H)if($.includes("@graph")&&($.includes("@id")||$.includes("@index")&&M(xe))){let gt;Pe.hasOwnProperty(je)?gt=Pe[je]:Pe[je]=gt={};const ft=($.includes("@id")?xe["@id"]:xe["@index"])||w.compactIri({activeCtx:se,iri:"@none",relativeTo:{vocab:!0}});D(gt,ft,Ve,{propertyIsArray:!me.compactArrays||$.includes("@set")})}else $.includes("@graph")&&M(xe)?(U(Ve)&&Ve.length>1&&(Ve={"@included":Ve}),D(Pe,je,Ve,{propertyIsArray:!me.compactArrays||$.includes("@set")})):(U(Ve)&&1===Ve.length&&me.compactArrays&&(Ve=Ve[0]),Ve={[w.compactIri({activeCtx:se,iri:"@graph",relativeTo:{vocab:!0}})]:Ve},"@id"in xe&&(Ve[w.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}})]=xe["@id"]),"@index"in xe&&(Ve[w.compactIri({activeCtx:se,iri:"@index",relativeTo:{vocab:!0}})]=xe["@index"]),D(Pe,je,Ve,{propertyIsArray:!me.compactArrays||$.includes("@set")}));else if($.includes("@language")||$.includes("@index")||$.includes("@id")||$.includes("@type")){let gt,ft;if(Pe.hasOwnProperty(je)?gt=Pe[je]:Pe[je]=gt={},$.includes("@language"))x(Ve)&&(Ve=Ve["@value"]),ft=xe["@language"];else if($.includes("@index")){const be=S(se,je,"@index")||"@index",B=w.compactIri({activeCtx:se,iri:be,relativeTo:{vocab:!0}});if("@index"===be)ft=xe["@index"],delete Ve[B];else{let P;if([ft,...P]=I(Ve[be]||[]),ie(ft))switch(P.length){case 0:delete Ve[be];break;case 1:Ve[be]=P[0];break;default:Ve[be]=P}else ft=null}}else if($.includes("@id")){const be=w.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}});ft=Ve[be],delete Ve[be]}else if($.includes("@type")){const be=w.compactIri({activeCtx:se,iri:"@type",relativeTo:{vocab:!0}});let B;switch([ft,...B]=I(Ve[be]||[]),B.length){case 0:delete Ve[be];break;case 1:Ve[be]=B[0];break;default:Ve[be]=B}1===Object.keys(Ve).length&&"@id"in xe&&(Ve=yield w.compact({activeCtx:se,activeProperty:je,element:{"@id":xe["@id"]},options:me,compactionMap:te}))}ft||(ft=w.compactIri({activeCtx:se,iri:"@none",relativeTo:{vocab:!0}})),D(gt,ft,Ve,{propertyIsArray:$.includes("@set")})}else{const gt=!me.compactArrays||$.includes("@set")||$.includes("@list")||U(Ve)&&0===Ve.length||"@list"===Le||"@graph"===Le;D(Pe,je,Ve,{propertyIsArray:gt})}}}else{if((S(se,ee,"@container")||[]).includes("@index"))continue;const je=w.compactIri({activeCtx:se,iri:Le,relativeTo:{vocab:!0}});D(Ge,je,Ke)}else{const xe=yield w.compact({activeCtx:se,activeProperty:ee,element:Ke,options:me,compactionMap:te});U(xe)&&0===xe.length||D(Ge,Le,xe)}else{const xe=yield w.compact({activeCtx:se,activeProperty:"@reverse",element:Ke,options:me,compactionMap:te});for(const je in xe)if(se.mappings.has(je)&&se.mappings.get(je).reverse){const We=xe[je],$=(S(se,je,"@container")||[]).includes("@set")||!me.compactArrays;D(Ge,je,We,{propertyIsArray:$}),delete xe[je]}if(Object.keys(xe).length>0){const je=w.compactIri({activeCtx:se,iri:Le,relativeTo:{vocab:!0}});D(Ge,je,xe)}}else{let xe=I(Ke).map(H=>w.compactIri({activeCtx:rt,iri:H,relativeTo:{vocab:!0}}));1===xe.length&&(xe=xe[0]);const je=w.compactIri({activeCtx:se,iri:"@type",relativeTo:{vocab:!0}}),$=(S(se,je,"@container")||[]).includes("@set")&&O(se,1.1)||U(xe)&&0===Ke.length;D(Ge,je,xe,{propertyIsArray:$})}else{let xe=I(Ke).map(We=>w.compactIri({activeCtx:se,iri:We,relativeTo:{vocab:!1},base:me.base}));1===xe.length&&(xe=xe[0]),Ge[w.compactIri({activeCtx:se,iri:"@id",relativeTo:{vocab:!0}})]=xe}}return Ge}return Se});return function(se){return oe.apply(this,arguments)}}(),w.compactIri=({activeCtx:oe,iri:se,value:ee=null,relativeTo:Se={vocab:!1},reverse:me=!1,base:te=null})=>{if(null===se)return se;oe.isPropertyTermScoped&&oe.previousContext&&(oe=oe.previousContext);const _e=oe.getInverse();if(T(se)&&se in _e&&"@none"in _e[se]&&"@type"in _e[se]["@none"]&&"@none"in _e[se]["@none"]["@type"])return _e[se]["@none"]["@type"]["@none"];if(Se.vocab&&se in _e){const Je=oe["@language"]||"@none",Ye=[];k(ee)&&"@index"in ee&&!("@graph"in ee)&&Ye.push("@index","@index@set"),k(ee)&&"@preserve"in ee&&(ee=ee["@preserve"][0]),N(ee)?("@index"in ee&&Ye.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in ee&&Ye.push("@graph@id","@graph@id@set"),Ye.push("@graph","@graph@set","@set"),"@index"in ee||Ye.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in ee||Ye.push("@graph@id","@graph@id@set")):k(ee)&&!x(ee)&&Ye.push("@id","@id@set","@type","@set@type");let Ue="@language",Le="@null";if(me)Ue="@type",Le="@reverse",Ye.push("@set");else if(b(ee)){"@index"in ee||Ye.push("@list");const xe=ee["@list"];if(0===xe.length)Ue="@any",Le="@none";else{let je=0===xe.length?Je:null,We=null;for(let Pe=0;Pe<xe.length;++Pe){const $=xe[Pe];let H="@none",fe="@none";if(x($)?"@direction"in $?H=`${($["@language"]||"").toLowerCase()}_${$["@direction"]}`:"@language"in $?H=$["@language"].toLowerCase():"@type"in $?fe=$["@type"]:H="@null":fe="@id",null===je?je=H:H!==je&&x($)&&(je="@none"),null===We?We=fe:fe!==We&&(We="@none"),"@none"===je&&"@none"===We)break}je=je||"@none",We=We||"@none","@none"!==We?(Ue="@type",Le=We):Le=je}}else{if(x(ee))if("@language"in ee&&!("@index"in ee)){Ye.push("@language","@language@set"),Le=ee["@language"];const xe=ee["@direction"];xe&&(Le=`${Le}_${xe}`)}else"@direction"in ee&&!("@index"in ee)?Le=`_${ee["@direction"]}`:"@type"in ee&&(Ue="@type",Le=ee["@type"]);else Ue="@type",Le="@id";Ye.push("@set")}Ye.push("@none"),k(ee)&&!("@index"in ee)&&Ye.push("@index","@index@set"),x(ee)&&1===Object.keys(ee).length&&Ye.push("@language","@language@set");const Ke=function(oe,se,ee,Se,me,te){null===te&&(te="@null");const _e=[];if(("@id"===te||"@reverse"===te)&&k(ee)&&"@id"in ee){"@reverse"===te&&_e.push("@reverse");const Ge=w.compactIri({activeCtx:oe,iri:ee["@id"],relativeTo:{vocab:!0}});oe.mappings.has(Ge)&&oe.mappings.get(Ge)&&oe.mappings.get(Ge)["@id"]===ee["@id"]?_e.push.apply(_e,["@vocab","@id"]):_e.push.apply(_e,["@id","@vocab"])}else{_e.push(te);const Ge=_e.find(rt=>rt.includes("_"));Ge&&_e.push(Ge.replace(/^[^_]+_/,"_"))}_e.push("@none");const Oe=oe.inverse[se];for(const Ge of Se){if(!(Ge in Oe))continue;const rt=Oe[Ge][me];for(const Xe of _e)if(Xe in rt)return rt[Xe]}return null}(oe,se,ee,Ye,Ue,Le);if(null!==Ke)return Ke}if(Se.vocab&&"@vocab"in oe){const Je=oe["@vocab"];if(0===se.indexOf(Je)&&se!==Je){const Ye=se.substr(Je.length);if(!oe.mappings.has(Ye))return Ye}}let Oe=null;const Ge=[];let rt=oe.fastCurieMap;const Xe=se.length-1;for(let Je=0;Je<Xe&&se[Je]in rt;++Je)rt=rt[se[Je]],""in rt&&Ge.push(rt[""][0]);for(let Je=Ge.length-1;Je>=0;--Je){const Ye=Ge[Je],Ue=Ye.terms;for(const Le of Ue){const Ke=Le+":"+se.substr(Ye.iri.length);oe.mappings.get(Le)._prefix&&(!oe.mappings.has(Ke)||null===ee&&oe.mappings.get(Ke)["@id"]===se)&&(null===Oe||X(Ke,Oe)<0)&&(Oe=Ke)}}if(null!==Oe)return Oe;for(const[Je,Ye]of oe.mappings)if(Ye&&Ye._prefix&&se.startsWith(Je+":"))throw new Y(`Absolute IRI "${se}" confused with prefix "${Je}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:oe});return Se.vocab?se:"@base"in oe?oe["@base"]?q(ce(te,oe["@base"]),se):se:q(te,se)},w.compactValue=({activeCtx:oe,activeProperty:se,value:ee,options:Se})=>{if(x(ee)){const Oe=S(oe,se,"@type"),Ge=S(oe,se,"@language"),rt=S(oe,se,"@direction"),Xe=S(oe,se,"@container")||[],Je="@index"in ee&&!Xe.includes("@index");if(!Je&&"@none"!==Oe&&(ee["@type"]===Oe||"@language"in ee&&ee["@language"]===Ge&&"@direction"in ee&&ee["@direction"]===rt||"@language"in ee&&ee["@language"]===Ge||"@direction"in ee&&ee["@direction"]===rt))return ee["@value"];const Ye=Object.keys(ee).length,Ue=1===Ye||2===Ye&&"@index"in ee&&!Je,Le="@language"in oe,Ke=ie(ee["@value"]),xe=oe.mappings.has(se)&&null===oe.mappings.get(se)["@language"];if(Ue&&"@none"!==Oe&&(!Le||!Ke||xe))return ee["@value"];const je={};return Je&&(je[w.compactIri({activeCtx:oe,iri:"@index",relativeTo:{vocab:!0}})]=ee["@index"]),"@type"in ee?je[w.compactIri({activeCtx:oe,iri:"@type",relativeTo:{vocab:!0}})]=w.compactIri({activeCtx:oe,iri:ee["@type"],relativeTo:{vocab:!0}}):"@language"in ee&&(je[w.compactIri({activeCtx:oe,iri:"@language",relativeTo:{vocab:!0}})]=ee["@language"]),"@direction"in ee&&(je[w.compactIri({activeCtx:oe,iri:"@direction",relativeTo:{vocab:!0}})]=ee["@direction"]),je[w.compactIri({activeCtx:oe,iri:"@value",relativeTo:{vocab:!0}})]=ee["@value"],je}const me=y(oe,se,{vocab:!0},Se),te=S(oe,se,"@type"),_e=w.compactIri({activeCtx:oe,iri:ee["@id"],relativeTo:{vocab:"@vocab"===te},base:Se.base});return"@id"===te||"@vocab"===te||"@graph"===me?_e:{[w.compactIri({activeCtx:oe,iri:"@id",relativeTo:{vocab:!0}})]:_e}}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],18:[function(K,Ae,pe){"use strict";const Y="http://www.w3.org/1999/02/22-rdf-syntax-ns#",U="http://www.w3.org/2001/XMLSchema#";Ae.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:Y,RDF_LIST:Y+"List",RDF_FIRST:Y+"first",RDF_REST:Y+"rest",RDF_NIL:Y+"nil",RDF_TYPE:Y+"type",RDF_PLAIN_LITERAL:Y+"PlainLiteral",RDF_XML_LITERAL:Y+"XMLLiteral",RDF_JSON_LITERAL:Y+"JSON",RDF_OBJECT:Y+"object",RDF_LANGSTRING:Y+"langString",XSD:U,XSD_BOOLEAN:U+"boolean",XSD_DOUBLE:U+"double",XSD_INTEGER:U+"integer",XSD_STRING:U+"string"}},{}],19:[function(K,Ae,pe){"use strict";const Y=K("./util"),U=K("./JsonLdError"),{isArray:k,isObject:ie,isString:W,isUndefined:b}=K("./types"),{isAbsolute:x,isRelative:N,prependBase:M}=K("./url"),{asArray:v,compareShortestLeast:y}=K("./util"),S=new Map,j=/^@[a-zA-Z]+$/,O={};function q(D,I,X,w,G,Q){if(null===I||!W(I)||O.isKeyword(I))return I;if(I.match(j))return null;if(w&&w.hasOwnProperty(I)&&!0!==G.get(I)&&O.createTermDefinition({activeCtx:D,localCtx:w,term:I,defined:G,options:Q}),(X=X||{}).vocab){const se=D.mappings.get(I);if(null===se)return null;if(ie(se)&&"@id"in se)return se["@id"]}const oe=I.indexOf(":");if(oe>0){const se=I.substr(0,oe),ee=I.substr(oe+1);if("_"===se||0===ee.indexOf("//"))return I;w&&w.hasOwnProperty(se)&&O.createTermDefinition({activeCtx:D,localCtx:w,term:se,defined:G,options:Q});const Se=D.mappings.get(se);if(Se&&Se._prefix)return Se["@id"]+ee;if(x(I))return I}if(X.vocab&&"@vocab"in D)return D["@vocab"]+I;if(X.base&&"@base"in D){if(D["@base"])return M(M(Q.base,D["@base"]),I)}else if(X.base)return M(Q.base,I);return I}function ce(D,I){if(!D||"object"!=typeof D||!I||"object"!=typeof I)return D===I;const X=Array.isArray(D);if(X!==Array.isArray(I))return!1;if(X){if(D.length!==I.length)return!1;for(let Q=0;Q<D.length;++Q)if(!ce(D[Q],I[Q]))return!1;return!0}const w=Object.keys(D),G=Object.keys(I);if(w.length!==G.length)return!1;for(const Q in D){let oe=D[Q],se=I[Q];if("@container"===Q&&Array.isArray(oe)&&Array.isArray(se)&&(oe=oe.slice().sort(),se=se.slice().sort()),!ce(oe,se))return!1}return!0}Ae.exports=O,O.process=function(){var D=mt(function*({activeCtx:I,localCtx:X,options:w,propagate:G=!0,overrideProtected:Q=!1,cycles:oe=new Set}){if(ie(X)&&"@context"in X&&k(X["@context"])&&(X=X["@context"]),0===v(X).length)return I;const ee=yield w.contextResolver.resolve({activeCtx:I,context:X,documentLoader:w.documentLoader,base:w.base});ie(ee[0].document)&&"boolean"==typeof ee[0].document["@propagate"]&&(G=ee[0].document["@propagate"]);let Se=I;!G&&!Se.previousContext&&(Se=Se.clone(),Se.previousContext=I);for(const me of ee){let{document:te}=me;if(I=Se,null===te){if(!Q&&0!==Object.keys(I.protected).length){const Ge=w&&w.protectedMode||"error";if("error"===Ge)throw new U("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===Ge){console.warn("WARNING: invalid context nullification");const rt=me.getProcessed(I);if(rt){Se=I=rt;continue}const Xe=I;Se=I=O.getInitialContext(w).clone();for(const[Je,Ye]of Object.entries(Xe.protected))Ye&&(I.mappings[Je]=Y.clone(Xe.mappings[Je]));I.protected=Y.clone(Xe.protected),me.setProcessed(Xe,Se);continue}throw new U("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:X,protectedMode:Ge})}Se=I=O.getInitialContext(w).clone();continue}const _e=me.getProcessed(I);if(_e){Se=I=_e;continue}if(ie(te)&&"@context"in te&&(te=te["@context"]),!ie(te))throw new U("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:te});Se=Se.clone();const Oe=new Map;if("@version"in te){if(1.1!==te["@version"])throw new U("Unsupported JSON-LD version: "+te["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:te});if(I.processingMode&&"json-ld-1.0"===I.processingMode)throw new U("@version: "+te["@version"]+" not compatible with "+I.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:te});Se.processingMode="json-ld-1.1",Se["@version"]=te["@version"],Oe.set("@version",!0)}if(Se.processingMode=Se.processingMode||I.processingMode,"@base"in te){let Ge=te["@base"];if(null!==Ge&&!x(Ge)){if(!N(Ge))throw new U('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:te});Ge=M(Se["@base"],Ge)}Se["@base"]=Ge,Oe.set("@base",!0)}if("@vocab"in te){const Ge=te["@vocab"];if(null===Ge)delete Se["@vocab"];else{if(!W(Ge))throw new U('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});if(!x(Ge)&&O.processingMode(Se,1))throw new U('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:te});Se["@vocab"]=q(Se,Ge,{vocab:!0,base:!0},void 0,void 0,w)}Oe.set("@vocab",!0)}if("@language"in te){const Ge=te["@language"];if(null===Ge)delete Se["@language"];else{if(!W(Ge))throw new U('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:te});Se["@language"]=Ge.toLowerCase()}Oe.set("@language",!0)}if("@direction"in te){const Ge=te["@direction"];if("json-ld-1.0"===I.processingMode)throw new U("Invalid JSON-LD syntax; @direction not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:te});if(null===Ge)delete Se["@direction"];else{if("ltr"!==Ge&&"rtl"!==Ge)throw new U('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:te});Se["@direction"]=Ge}Oe.set("@direction",!0)}if("@propagate"in te){const Ge=te["@propagate"];if("json-ld-1.0"===I.processingMode)throw new U("Invalid JSON-LD syntax; @propagate not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if("boolean"!=typeof Ge)throw new U("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:X});Oe.set("@propagate",!0)}if("@import"in te){const Ge=te["@import"];if("json-ld-1.0"===I.processingMode)throw new U("Invalid JSON-LD syntax; @import not compatible with "+I.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:te});if(!W(Ge))throw new U("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:X});const rt=yield w.contextResolver.resolve({activeCtx:I,context:Ge,documentLoader:w.documentLoader,base:w.base});if(1!==rt.length)throw new U("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:X});const Xe=rt[0].getProcessed(I);if(Xe)te=Xe;else{const Je=rt[0].document;if("@import"in Je)throw new U("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:X});for(const Ye in Je)te.hasOwnProperty(Ye)||(te[Ye]=Je[Ye]);rt[0].setProcessed(I,te)}Oe.set("@import",!0)}Oe.set("@protected",te["@protected"]||!1);for(const Ge in te)if(O.createTermDefinition({activeCtx:Se,localCtx:te,term:Ge,defined:Oe,options:w,overrideProtected:Q}),ie(te[Ge])&&"@context"in te[Ge]){const rt=te[Ge]["@context"];let Xe=!0;if(W(rt)){const Je=M(w.base,rt);oe.has(Je)?Xe=!1:oe.add(Je)}if(Xe)try{yield O.process({activeCtx:Se.clone(),localCtx:te[Ge]["@context"],overrideProtected:!0,options:w,cycles:oe})}catch(Je){throw new U("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:te[Ge]["@context"],term:Ge})}}me.setProcessed(I,Se)}return Se});return function(I){return D.apply(this,arguments)}}(),O.createTermDefinition=({activeCtx:D,localCtx:I,term:X,defined:w,options:G,overrideProtected:Q=!1})=>{if(w.has(X)){if(w.get(X))return;throw new U("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:I,term:X})}let oe;if(w.set(X,!1),I.hasOwnProperty(X)&&(oe=I[X]),"@type"===X&&ie(oe)&&"@set"===(oe["@container"]||"@set")&&O.processingMode(D,1.1)){const Oe=["@container","@id","@protected"],Ge=Object.keys(oe);if(0===Ge.length||Ge.some(rt=>!Oe.includes(rt)))throw new U("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:I,term:X})}else{if(O.isKeyword(X))throw new U("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:I,term:X});if(X.match(j))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:X});if(""===X)throw new U("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:I})}const se=D.mappings.get(X);D.mappings.has(X)&&D.mappings.delete(X);let ee=!1;if((W(oe)||null===oe)&&(ee=!0,oe={"@id":oe}),!ie(oe))throw new U("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:I});const Se={};D.mappings.set(X,Se),Se.reverse=!1;const me=["@container","@id","@language","@reverse","@type"];O.processingMode(D,1.1)&&me.push("@context","@direction","@index","@nest","@prefix","@protected");for(const Oe in oe)if(!me.includes(Oe))throw new U("Invalid JSON-LD syntax; a term definition must not contain "+Oe,"jsonld.SyntaxError",{code:"invalid term definition",context:I});const te=X.indexOf(":");if(Se._termHasColon=te>0,"@reverse"in oe){if("@id"in oe)throw new U("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});if("@nest"in oe)throw new U("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});const Oe=oe["@reverse"];if(!W(Oe))throw new U("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(!O.isKeyword(Oe)&&Oe.match(j))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:Oe}),void(se?D.mappings.set(X,se):D.mappings.delete(X));const Ge=q(D,Oe,{vocab:!0,base:!1},I,w,G);if(!x(Ge))throw new U("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});Se["@id"]=Ge,Se.reverse=!0}else if("@id"in oe){let Oe=oe["@id"];if(Oe&&!W(Oe))throw new U("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(null===Oe)Se["@id"]=null;else{if(!O.isKeyword(Oe)&&Oe.match(j))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:Oe}),void(se?D.mappings.set(X,se):D.mappings.delete(X));if(Oe!==X){if(Oe=q(D,Oe,{vocab:!0,base:!1},I,w,G),!x(Oe)&&!O.isKeyword(Oe))throw new U("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});if(X.match(/(?::[^:])|\//)&&q(D,X,{vocab:!0,base:!1},I,new Map(w).set(X,!0),G)!==Oe)throw new U("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I});Se["@id"]=Oe,Se._prefix=ee&&!Se._termHasColon&&Oe.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in Se))if(Se._termHasColon){const Oe=X.substr(0,te);if(I.hasOwnProperty(Oe)&&O.createTermDefinition({activeCtx:D,localCtx:I,term:Oe,defined:w,options:G}),D.mappings.has(Oe)){const Ge=X.substr(te+1);Se["@id"]=D.mappings.get(Oe)["@id"]+Ge}else Se["@id"]=X}else if("@type"===X)Se["@id"]=X;else{if(!("@vocab"in D))throw new U("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:I,term:X});Se["@id"]=D["@vocab"]+X}if((!0===oe["@protected"]||!0===w.get("@protected")&&!1!==oe["@protected"])&&(D.protected[X]=!0,Se.protected=!0),w.set(X,!0),"@type"in oe){let Oe=oe["@type"];if(!W(Oe))throw new U("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:I});if("@json"===Oe||"@none"===Oe){if(O.processingMode(D,1))throw new U(`Invalid JSON-LD syntax; an @context @type value must not be "${Oe}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:I})}else if("@id"!==Oe&&"@vocab"!==Oe){if(Oe=q(D,Oe,{vocab:!0,base:!1},I,w,G),!x(Oe))throw new U("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:I});if(0===Oe.indexOf("_:"))throw new U("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:I})}Se["@type"]=Oe}if("@container"in oe){const Oe=W(oe["@container"])?[oe["@container"]]:oe["@container"]||[],Ge=["@list","@set","@index","@language"];let rt=!0;const Xe=Oe.includes("@set");if(O.processingMode(D,1.1)){if(Ge.push("@graph","@id","@type"),Oe.includes("@list")){if(1!==Oe.length)throw new U("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:I})}else if(Oe.includes("@graph")){if(Oe.some(Je=>"@graph"!==Je&&"@id"!==Je&&"@index"!==Je&&"@set"!==Je))throw new U("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:I})}else rt&=Oe.length<=(Xe?2:1);if(Oe.includes("@type")&&(Se["@type"]=Se["@type"]||"@id",!["@id","@vocab"].includes(Se["@type"])))throw new U("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:I})}else rt&=!k(oe["@container"]),rt&=Oe.length<=1;if(rt&=Oe.every(Je=>Ge.includes(Je)),rt&=!(Xe&&Oe.includes("@list")),!rt)throw new U("Invalid JSON-LD syntax; @context @container value must be one of the following: "+Ge.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:I});if(Se.reverse&&!Oe.every(Je=>["@index","@set"].includes(Je)))throw new U("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:I});Se["@container"]=Oe}if("@index"in oe){if(!("@container"in oe)||!Se["@container"].includes("@index"))throw new U(`Invalid JSON-LD syntax; @index without @index in @container: "${oe["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:I});if(!W(oe["@index"])||0===oe["@index"].indexOf("@"))throw new U(`Invalid JSON-LD syntax; @index must expand to an IRI: "${oe["@index"]}" on term "${X}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:I});Se["@index"]=oe["@index"]}if("@context"in oe&&(Se["@context"]=oe["@context"]),"@language"in oe&&!("@type"in oe)){let Oe=oe["@language"];if(null!==Oe&&!W(Oe))throw new U("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:I});null!==Oe&&(Oe=Oe.toLowerCase()),Se["@language"]=Oe}if("@prefix"in oe){if(X.match(/:|\//))throw new U("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:I});if(O.isKeyword(Se["@id"]))throw new U("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:I});if("boolean"!=typeof oe["@prefix"])throw new U("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:I});Se._prefix=!0===oe["@prefix"]}if("@direction"in oe){const Oe=oe["@direction"];if(null!==Oe&&"ltr"!==Oe&&"rtl"!==Oe)throw new U('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:I});Se["@direction"]=Oe}if("@nest"in oe){const Oe=oe["@nest"];if(!W(Oe)||"@nest"!==Oe&&0===Oe.indexOf("@"))throw new U("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:I});Se["@nest"]=Oe}const _e=Se["@id"];if("@context"===_e||"@preserve"===_e)throw new U("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:I});if(se&&se.protected&&!Q&&(D.protected[X]=!0,Se.protected=!0,!ce(se,Se))){const Oe=G&&G.protectedMode||"error";if("error"===Oe)throw new U(`Invalid JSON-LD syntax; tried to redefine "${X}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:I,term:X});if("warn"===Oe)return void console.warn("WARNING: protected term redefinition",{term:X});throw new U("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:I,term:X,protectedMode:Oe})}},O.expandIri=(D,I,X,w)=>q(D,I,X,void 0,void 0,w),O.getInitialContext=D=>{const I=JSON.stringify({processingMode:D.processingMode}),X=S.get(I);if(X)return X;const w={processingMode:D.processingMode,mappings:new Map,inverse:null,getInverse:function(){const Se=this;if(Se.inverse)return Se.inverse;const me=Se.inverse={},te=Se.fastCurieMap={},_e={},Oe=(Se["@language"]||"@none").toLowerCase(),Ge=Se["@direction"],rt=Se.mappings,Xe=[...rt.keys()].sort(y);for(const Je of Xe){const Ye=rt.get(Je);if(null===Ye)continue;let Ue=Ye["@container"]||"@none";if(Ue=[].concat(Ue).sort().join(""),null===Ye["@id"])continue;const Le=v(Ye["@id"]);for(const Ke of Le){let xe=me[Ke];const je=O.isKeyword(Ke);if(xe)!je&&!Ye._termHasColon&&_e[Ke].push(Je);else if(me[Ke]=xe={},!je&&!Ye._termHasColon){_e[Ke]=[Je];const We={iri:Ke,terms:_e[Ke]};Ke[0]in te?te[Ke[0]].push(We):te[Ke[0]]=[We]}if(xe[Ue]||(xe[Ue]={"@language":{},"@type":{},"@any":{}}),xe=xe[Ue],oe(Je,xe["@any"],"@none"),Ye.reverse)oe(Je,xe["@type"],"@reverse");else if("@none"===Ye["@type"])oe(Je,xe["@any"],"@none"),oe(Je,xe["@language"],"@none"),oe(Je,xe["@type"],"@none");else if("@type"in Ye)oe(Je,xe["@type"],Ye["@type"]);else if("@language"in Ye&&"@direction"in Ye){const We=Ye["@language"],Pe=Ye["@direction"];oe(Je,xe["@language"],We&&Pe?`${We}_${Pe}`.toLowerCase():We?We.toLowerCase():Pe?`_${Pe}`:"@null")}else"@language"in Ye?oe(Je,xe["@language"],(Ye["@language"]||"@null").toLowerCase()):"@direction"in Ye?oe(Je,xe["@language"],Ye["@direction"]?`_${Ye["@direction"]}`:"@none"):Ge?(oe(Je,xe["@language"],`_${Ge}`),oe(Je,xe["@language"],"@none"),oe(Je,xe["@type"],"@none")):(oe(Je,xe["@language"],Oe),oe(Je,xe["@language"],"@none"),oe(Je,xe["@type"],"@none"))}}for(const Je in te)Q(te,Je,1);return me},clone:function(){const Se={};return Se.mappings=Y.clone(this.mappings),Se.clone=this.clone,Se.inverse=null,Se.getInverse=this.getInverse,Se.protected=Y.clone(this.protected),this.previousContext&&(Se.previousContext=this.previousContext.clone()),Se.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(Se["@base"]=this["@base"]),"@language"in this&&(Se["@language"]=this["@language"]),"@vocab"in this&&(Se["@vocab"]=this["@vocab"]),Se},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===S.size&&S.clear(),S.set(I,w),w;function Q(Se,me,te){const _e=Se[me],Oe=Se[me]={};let Ge,rt;for(const Xe of _e)Ge=Xe.iri,rt=te>=Ge.length?"":Ge[te],rt in Oe?Oe[rt].push(Xe):Oe[rt]=[Xe];for(const Xe in Oe)""!==Xe&&Q(Oe,Xe,te+1)}function oe(Se,me,te){me.hasOwnProperty(te)||(me[te]=Se)}},O.getContextValue=(D,I,X)=>{if(null===I)return"@context"===X?void 0:null;if(D.mappings.has(I)){const w=D.mappings.get(I);if(b(X))return w;if(w.hasOwnProperty(X))return w[X]}return"@language"===X&&X in D||"@direction"===X&&X in D?D[X]:"@context"!==X?null:void 0},O.processingMode=(D,I)=>I.toString()>="1.1"?!D.processingMode||D.processingMode>="json-ld-"+I.toString():"json-ld-1.0"===D.processingMode,O.isKeyword=D=>{if(!W(D)||"@"!==D[0])return!1;switch(D){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./JsonLdError":12,"./types":30,"./url":31,"./util":32}],20:[function(K,Ae,pe){"use strict";const{parseLinkHeader:Y,buildHeaders:U}=K("../util"),{LINK_HEADER_CONTEXT:k}=K("../constants"),ie=K("../JsonLdError"),W=K("../RequestQueue"),{prependBase:b}=K("../url"),x=/(^|(\r\n))link:/i;function N(M,v,y){const S=new(M=M||XMLHttpRequest);return new Promise((T,j)=>{S.onload=()=>T(S),S.onerror=O=>j(O),S.open("GET",v,!0);for(const O in y)S.setRequestHeader(O,y[O]);S.send()})}Ae.exports=({secure:M,headers:v={},xhr:y}={headers:{}})=>{return v=U(v),(new W).wrapLoader(T);function T(O){return j.apply(this,arguments)}function j(){return(j=mt(function*(O){if(0!==O.indexOf("http:")&&0!==O.indexOf("https:"))throw new ie('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:O});if(M&&0!==O.indexOf("https"))throw new ie('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:O});let q;try{q=yield N(y,O,v)}catch(w){throw new ie("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:O,cause:w})}if(q.status>=400)throw new ie("URL could not be dereferenced: "+q.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:O,httpStatusCode:q.status});let ce={contextUrl:null,documentUrl:O,document:q.response},D=null;const I=q.getResponseHeader("Content-Type");let X;if(x.test(q.getAllResponseHeaders())&&(X=q.getResponseHeader("Link")),X&&"application/ld+json"!==I){const w=Y(X),G=w[k];if(Array.isArray(G))throw new ie("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:O});G&&(ce.contextUrl=G.target),D=w.alternate,D&&"application/ld+json"==D.type&&!(I||"").match(/^application\/(\w*\+)?json$/)&&(ce=yield T(b(O,D.target)))}return ce})).apply(this,arguments)}}},{"../JsonLdError":12,"../RequestQueue":15,"../constants":18,"../url":31,"../util":32}],21:[function(K,Ae,pe){"use strict";const Y=K("./JsonLdError"),{isArray:U,isObject:k,isEmptyObject:ie,isString:W,isUndefined:b}=K("./types"),{isList:x,isValue:N,isGraph:M,isSubject:v}=K("./graphTypes"),{expandIri:y,getContextValue:S,isKeyword:T,process:j,processingMode:O}=K("./context"),{isAbsolute:q}=K("./url"),{addValue:ce,asArray:D,getValues:I,validateTypeValue:X}=K("./util"),w={};Ae.exports=w;const G=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function Q(te){return oe.apply(this,arguments)}function oe(){return(oe=mt(function*({activeCtx:te,activeProperty:_e,expandedActiveProperty:Oe,element:Ge,expandedParent:rt,options:Xe={},insideList:Je,typeKey:Ye,typeScopedContext:Ue,expansionMap:Le}){const Ke=Object.keys(Ge).sort(),xe=[];let je;const We=Ge[Ye]&&"@json"===y(te,U(Ge[Ye])?Ge[Ye][0]:Ge[Ye],{vocab:!0},Xe);for(const Pe of Ke){let H,$=Ge[Pe];if("@context"===Pe)continue;let fe=y(te,Pe,{vocab:!0},Xe);if((null===fe||!q(fe)&&!T(fe))&&(fe=Le({unmappedProperty:Pe,activeCtx:te,activeProperty:_e,parent:Ge,options:Xe,insideList:Je,value:$,expandedParent:rt}),void 0===fe))continue;if(T(fe)){if("@reverse"===Oe)throw new Y("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:$});if(fe in rt&&"@included"!==fe&&"@type"!==fe)throw new Y("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:fe})}if("@id"===fe){if(!W($)){if(!Xe.isFrame)throw new Y('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:$});if(k($)){if(!ie($))throw new Y('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:$})}else{if(!U($))throw new Y('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:$});if(!$.every(ft=>W(ft)))throw new Y('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:$})}}ce(rt,"@id",D($).map(ft=>W(ft)?y(te,ft,{base:!0},Xe):ft),{propertyIsArray:Xe.isFrame});continue}if("@type"===fe){k($)&&($=Object.fromEntries(Object.entries($).map(([ft,be])=>[y(Ue,ft,{vocab:!0}),D(be).map(B=>y(Ue,B,{base:!0,vocab:!0}))]))),X($,Xe.isFrame),ce(rt,"@type",D($).map(ft=>W(ft)?y(Ue,ft,{base:!0,vocab:!0},Xe):ft),{propertyIsArray:Xe.isFrame});continue}if("@included"===fe&&O(te,1.1)){const ft=D(yield w.expand({activeCtx:te,activeProperty:_e,element:$,options:Xe,expansionMap:Le}));if(!ft.every(be=>v(be)))throw new Y("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:$});ce(rt,"@included",ft,{propertyIsArray:!0});continue}if("@graph"===fe&&!k($)&&!U($))throw new Y('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:$});if("@value"===fe){je=$,We&&O(te,1.1)?rt["@value"]=$:ce(rt,"@value",$,{propertyIsArray:Xe.isFrame});continue}if("@language"===fe){if(null===$)continue;if(!W($)&&!Xe.isFrame)throw new Y('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:$});$=D($).map(ft=>W(ft)?ft.toLowerCase():ft);for(const ft of $)W(ft)&&!ft.match(G)&&console.warn(`@language must be valid BCP47: ${ft}`);ce(rt,"@language",$,{propertyIsArray:Xe.isFrame});continue}if("@direction"===fe){if(!W($)&&!Xe.isFrame)throw new Y('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:$});$=D($);for(const ft of $)if(W(ft)&&"ltr"!==ft&&"rtl"!==ft)throw new Y('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:$});ce(rt,"@direction",$,{propertyIsArray:Xe.isFrame});continue}if("@index"===fe){if(!W($))throw new Y('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:$});ce(rt,"@index",$);continue}if("@reverse"===fe){if(!k($))throw new Y('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:$});if(H=yield w.expand({activeCtx:te,activeProperty:"@reverse",element:$,options:Xe,expansionMap:Le}),"@reverse"in H)for(const be in H["@reverse"])ce(rt,be,H["@reverse"][be],{propertyIsArray:!0});let ft=rt["@reverse"]||null;for(const be in H){if("@reverse"===be)continue;null===ft&&(ft=rt["@reverse"]={}),ce(ft,be,[],{propertyIsArray:!0});const B=H[be];for(let P=0;P<B.length;++P){const V=B[P];if(N(V)||x(V))throw new Y('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:H});ce(ft,be,V,{propertyIsArray:!0})}}continue}if("@nest"===fe){xe.push(Pe);continue}let ue=te;const Ve=S(te,Pe,"@context");b(Ve)||(ue=yield j({activeCtx:te,localCtx:Ve,propagate:!0,overrideProtected:!0,options:Xe}));const gt=S(ue,Pe,"@container")||[];if(gt.includes("@language")&&k($))H=ee(ue,$,S(ue,Pe,"@direction"),Xe);else if(gt.includes("@index")&&k($)){const ft=gt.includes("@graph"),be=S(ue,Pe,"@index")||"@index",B="@index"!==be&&y(te,be,{vocab:!0},Xe);H=yield Se({activeCtx:ue,options:Xe,activeProperty:Pe,value:$,expansionMap:Le,asGraph:ft,indexKey:be,propertyIndex:B})}else if(gt.includes("@id")&&k($)){const ft=gt.includes("@graph");H=yield Se({activeCtx:ue,options:Xe,activeProperty:Pe,value:$,expansionMap:Le,asGraph:ft,indexKey:"@id"})}else if(gt.includes("@type")&&k($))H=yield Se({activeCtx:ue.revertToPreviousContext(),options:Xe,activeProperty:Pe,value:$,expansionMap:Le,asGraph:!1,indexKey:"@type"});else{const ft="@list"===fe;if(ft||"@set"===fe){let be=_e;ft&&"@graph"===Oe&&(be=null),H=yield w.expand({activeCtx:ue,activeProperty:be,element:$,options:Xe,insideList:ft,expansionMap:Le})}else H="@json"===S(te,Pe,"@type")?{"@type":"@json","@value":$}:yield w.expand({activeCtx:ue,activeProperty:Pe,element:$,options:Xe,insideList:!1,expansionMap:Le})}if(null!==H||"@value"===fe||(H=Le({unmappedValue:$,expandedProperty:fe,activeCtx:ue,activeProperty:_e,parent:Ge,options:Xe,insideList:Je,key:Pe,expandedParent:rt}),void 0!==H)){if("@list"!==fe&&!x(H)&&gt.includes("@list")&&(H={"@list":D(H)}),gt.includes("@graph")&&!gt.some(ft=>"@id"===ft||"@index"===ft)&&(H=D(H).map(ft=>({"@graph":D(ft)}))),ue.mappings.has(Pe)&&ue.mappings.get(Pe).reverse){const ft=rt["@reverse"]=rt["@reverse"]||{};H=D(H);for(let be=0;be<H.length;++be){const B=H[be];if(N(B)||x(B))throw new Y('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:H});ce(ft,fe,B,{propertyIsArray:!0})}continue}ce(rt,fe,H,{propertyIsArray:!0})}}if("@value"in rt&&("@json"!==rt["@type"]||!O(te,1.1))&&(k(je)||U(je))&&!Xe.isFrame)throw new Y('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:je});for(const Pe of xe){const $=U(Ge[Pe])?Ge[Pe]:[Ge[Pe]];for(const H of $){if(!k(H)||Object.keys(H).some(fe=>"@value"===y(te,fe,{vocab:!0},Xe)))throw new Y("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:H});yield Q({activeCtx:te,activeProperty:_e,expandedActiveProperty:Oe,element:H,expandedParent:rt,options:Xe,insideList:Je,typeScopedContext:Ue,typeKey:Ye,expansionMap:Le})}}})).apply(this,arguments)}function se({activeCtx:te,activeProperty:_e,value:Oe,options:Ge}){if(null==Oe)return null;const rt=y(te,_e,{vocab:!0},Ge);if("@id"===rt)return y(te,Oe,{base:!0},Ge);if("@type"===rt)return y(te,Oe,{vocab:!0,base:!0},Ge);const Xe=S(te,_e,"@type");if(("@id"===Xe||"@graph"===rt)&&W(Oe))return{"@id":y(te,Oe,{base:!0},Ge)};if("@vocab"===Xe&&W(Oe))return{"@id":y(te,Oe,{vocab:!0,base:!0},Ge)};if(T(rt))return Oe;const Je={};if(Xe&&!["@id","@vocab","@none"].includes(Xe))Je["@type"]=Xe;else if(W(Oe)){const Ye=S(te,_e,"@language");null!==Ye&&(Je["@language"]=Ye);const Ue=S(te,_e,"@direction");null!==Ue&&(Je["@direction"]=Ue)}return["boolean","number","string"].includes(typeof Oe)||(Oe=Oe.toString()),Je["@value"]=Oe,Je}function ee(te,_e,Oe,Ge){const rt=[],Xe=Object.keys(_e).sort();for(const Je of Xe){const Ye=y(te,Je,{vocab:!0},Ge);let Ue=_e[Je];U(Ue)||(Ue=[Ue]);for(const Le of Ue){if(null===Le)continue;if(!W(Le))throw new Y("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:_e});const Ke={"@value":Le};"@none"!==Ye&&(Ke["@language"]=Je.toLowerCase()),Oe&&(Ke["@direction"]=Oe),rt.push(Ke)}}return rt}function Se(te){return me.apply(this,arguments)}function me(){return(me=mt(function*({activeCtx:te,options:_e,activeProperty:Oe,value:Ge,expansionMap:rt,asGraph:Xe,indexKey:Je,propertyIndex:Ye}){const Ue=[],Le=Object.keys(Ge).sort(),Ke="@type"===Je;for(let xe of Le){if(Ke){const Pe=S(te,xe,"@context");b(Pe)||(te=yield j({activeCtx:te,localCtx:Pe,propagate:!1,options:_e}))}let We,je=Ge[xe];U(je)||(je=[je]),je=yield w.expand({activeCtx:te,activeProperty:Oe,element:je,options:_e,insideList:!1,insideIndex:!0,expansionMap:rt}),We=Ye?"@none"===xe?"@none":se({activeCtx:te,activeProperty:Je,value:xe,options:_e}):y(te,xe,{vocab:!0},_e),"@id"===Je?xe=y(te,xe,{base:!0},_e):Ke&&(xe=We);for(let Pe of je){if(Xe&&!M(Pe)&&(Pe={"@graph":[Pe]}),"@type"===Je)"@none"===We||(Pe["@type"]=Pe["@type"]?[xe].concat(Pe["@type"]):[xe]);else{if(N(Pe)&&!["@language","@type","@index"].includes(Je))throw new Y(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${Je}".`,"jsonld.SyntaxError",{code:"invalid value object",value:Pe});Ye?"@none"!==We&&ce(Pe,Ye,We,{propertyIsArray:!0,prependValue:!0}):"@none"!==We&&!(Je in Pe)&&(Pe[Je]=xe)}Ue.push(Pe)}}return Ue})).apply(this,arguments)}w.expand=function(){var te=mt(function*({activeCtx:_e,activeProperty:Oe=null,element:Ge,options:rt={},insideList:Xe=!1,insideIndex:Je=!1,typeScopedContext:Ye=null,expansionMap:Ue=(()=>{})}){if(null==Ge)return null;if("@default"===Oe&&(rt=Object.assign({},rt,{isFrame:!1})),!U(Ge)&&!k(Ge)){if(!Xe&&(null===Oe||"@graph"===y(_e,Oe,{vocab:!0},rt))){const H=yield Ue({unmappedValue:Ge,activeCtx:_e,activeProperty:Oe,options:rt,insideList:Xe});return void 0===H?null:H}return se({activeCtx:_e,activeProperty:Oe,value:Ge,options:rt})}if(U(Ge)){let H=[];const fe=S(_e,Oe,"@container")||[];Xe=Xe||fe.includes("@list");for(let ue=0;ue<Ge.length;++ue){let Ve=yield w.expand({activeCtx:_e,activeProperty:Oe,element:Ge[ue],options:rt,expansionMap:Ue,insideIndex:Je,typeScopedContext:Ye});Xe&&U(Ve)&&(Ve={"@list":Ve}),(null!==Ve||(Ve=yield Ue({unmappedValue:Ge[ue],activeCtx:_e,activeProperty:Oe,parent:Ge,index:ue,options:rt,expandedParent:H,insideList:Xe}),void 0!==Ve))&&(U(Ve)?H=H.concat(Ve):H.push(Ve))}return H}const Le=y(_e,Oe,{vocab:!0},rt),Ke=S(_e,Oe,"@context");Ye=Ye||(_e.previousContext?_e:null);let xe=Object.keys(Ge).sort(),je=!Je;if(je&&Ye&&xe.length<=2&&!xe.includes("@context"))for(const H of xe){const fe=y(Ye,H,{vocab:!0},rt);if("@value"===fe){je=!1,_e=Ye;break}if("@id"===fe&&1===xe.length){je=!1;break}}je&&(_e=_e.revertToPreviousContext()),b(Ke)||(_e=yield j({activeCtx:_e,localCtx:Ke,propagate:!0,overrideProtected:!0,options:rt})),"@context"in Ge&&(_e=yield j({activeCtx:_e,localCtx:Ge["@context"],options:rt})),Ye=_e;let We=null;for(const H of xe)if("@type"===y(_e,H,{vocab:!0},rt)){We=We||H;const ue=Ge[H],Ve=Array.isArray(ue)?ue.length>1?ue.slice().sort():ue:[ue];for(const gt of Ve){const ft=S(Ye,gt,"@context");b(ft)||(_e=yield j({activeCtx:_e,localCtx:ft,options:rt,propagate:!1}))}}let Pe={};yield Q({activeCtx:_e,activeProperty:Oe,expandedActiveProperty:Le,element:Ge,expandedParent:Pe,options:rt,insideList:Xe,typeKey:We,typeScopedContext:Ye,expansionMap:Ue}),xe=Object.keys(Pe);let $=xe.length;if("@value"in Pe){if("@type"in Pe&&("@language"in Pe||"@direction"in Pe))throw new Y('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Pe});let H=$-1;if("@type"in Pe&&(H-=1),"@index"in Pe&&(H-=1),"@language"in Pe&&(H-=1),"@direction"in Pe&&(H-=1),0!==H)throw new Y('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:Pe});const fe=null===Pe["@value"]?[]:D(Pe["@value"]),ue=I(Pe,"@type");if(!O(_e,1.1)||!ue.includes("@json")||1!==ue.length)if(0===fe.length){const Ve=yield Ue({unmappedValue:Pe,activeCtx:_e,activeProperty:Oe,element:Ge,options:rt,insideList:Xe});Pe=void 0!==Ve?Ve:null}else{if(!fe.every(Ve=>W(Ve)||ie(Ve))&&"@language"in Pe)throw new Y("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:Pe});if(!ue.every(Ve=>q(Ve)&&!(W(Ve)&&0===Ve.indexOf("_:"))||ie(Ve)))throw new Y('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:Pe})}}else if("@type"in Pe&&!U(Pe["@type"]))Pe["@type"]=[Pe["@type"]];else if("@set"in Pe||"@list"in Pe){if($>1&&(2!==$||!("@index"in Pe)))throw new Y('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:Pe});"@set"in Pe&&(Pe=Pe["@set"],xe=Object.keys(Pe),$=xe.length)}else if(1===$&&"@language"in Pe){const H=yield Ue(Pe,{unmappedValue:Pe,activeCtx:_e,activeProperty:Oe,element:Ge,options:rt,insideList:Xe});Pe=void 0!==H?H:null}if(k(Pe)&&!rt.keepFreeFloatingNodes&&!Xe&&(null===Oe||"@graph"===Le)&&(0===$||"@value"in Pe||"@list"in Pe||1===$&&"@id"in Pe)){const H=yield Ue({unmappedValue:Pe,activeCtx:_e,activeProperty:Oe,element:Ge,options:rt,insideList:Xe});Pe=void 0!==H?H:null}return Pe});return function(_e){return te.apply(this,arguments)}}()},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./url":31,"./util":32}],22:[function(K,Ae,pe){"use strict";const{isSubjectReference:Y}=K("./graphTypes"),{createMergedNodeMap:U}=K("./nodeMap"),k={};Ae.exports=k,k.flatten=ie=>{const W=U(ie),b=[],x=Object.keys(W).sort();for(let N=0;N<x.length;++N){const M=W[x[N]];Y(M)||b.push(M)}return b}},{"./graphTypes":25,"./nodeMap":27}],23:[function(K,Ae,pe){"use strict";const{isKeyword:Y}=K("./context"),U=K("./graphTypes"),k=K("./types"),ie=K("./util"),W=K("./url"),b=K("./JsonLdError"),{createNodeMap:x,mergeNodeMapGraphs:N}=K("./nodeMap"),M={};function v(w){const G={};for(const Q in w)void 0!==w[Q]&&(G["@"+Q]=[w[Q]]);return[G]}function y(w,G,Q){for(let oe=Q.length-1;oe>=0;--oe){const se=Q[oe];if(se.graph===G&&se.subject["@id"]===w["@id"])return!0}return!1}function S(w,G,Q){const oe="@"+Q;let se=oe in w?w[oe][0]:G[Q];if("embed"===Q)if(!0===se)se="@once";else if(!1===se)se="@never";else if("@always"!==se&&"@never"!==se&&"@link"!==se&&"@first"!==se&&"@last"!==se&&"@once"!==se)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:w});return se}function T(w){if(!k.isArray(w)||1!==w.length||!k.isObject(w[0]))throw new b("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:w});if("@id"in w[0])for(const G of ie.asArray(w[0]["@id"]))if(!k.isObject(G)&&!W.isAbsolute(G)||k.isString(G)&&0===G.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:w});if("@type"in w[0])for(const G of ie.asArray(w[0]["@type"]))if(!k.isObject(G)&&!W.isAbsolute(G)||k.isString(G)&&0===G.indexOf("_:"))throw new b("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:w})}function O(w,G,Q,oe){let se=!0,ee=!1;for(const Se in Q){let me=!1;const te=ie.getValues(G,Se),_e=0===ie.getValues(Q,Se).length;if("@id"===Se){if(k.isEmptyObject(Q["@id"][0]||{})?me=!0:Q["@id"].length>=0&&(me=Q["@id"].includes(te[0])),!oe.requireAll)return me}else if("@type"===Se){if(se=!1,_e){if(te.length>0)return!1;me=!0}else if(1===Q["@type"].length&&k.isEmptyObject(Q["@type"][0]))me=te.length>0;else for(const Oe of Q["@type"])me=!(!k.isObject(Oe)||!("@default"in Oe))||me||te.some(Ge=>Ge===Oe);if(!oe.requireAll)return me}else{if(Y(Se))continue;{const Oe=ie.getValues(Q,Se)[0];let Ge=!1;if(Oe&&(T([Oe]),Ge="@default"in Oe),se=!1,0===te.length&&Ge)continue;if(te.length>0&&_e)return!1;if(void 0===Oe){if(te.length>0)return!1;me=!0}else if(U.isList(Oe)){const rt=Oe["@list"][0];if(U.isList(te[0])){const Xe=te[0]["@list"];U.isValue(rt)?me=Xe.some(Je=>X(rt,Je)):(U.isSubject(rt)||U.isSubjectReference(rt))&&(me=Xe.some(Je=>I(w,rt,Je,oe)))}}else me=U.isValue(Oe)?te.some(rt=>X(Oe,rt)):U.isSubjectReference(Oe)?te.some(rt=>I(w,Oe,rt,oe)):!!k.isObject(Oe)&&te.length>0}}if(!me&&oe.requireAll)return!1;ee=ee||me}return se||ee}function q(w,G){const Q=w.uniqueEmbeds[w.graph],oe=Q[G],se=oe.parent,ee=oe.property,Se={"@id":G};if(k.isArray(se)){for(let te=0;te<se.length;++te)if(ie.compareValues(se[te],Se)){se[te]=Se;break}}else{const te=k.isArray(se[ee]);ie.removeValue(se,ee,Se,{propertyIsArray:te}),ie.addValue(se,ee,Se,{propertyIsArray:te})}const me=te=>{const _e=Object.keys(Q);for(const Oe of _e)Oe in Q&&k.isObject(Q[Oe].parent)&&Q[Oe].parent["@id"]===te&&(delete Q[Oe],me(Oe))};me(G)}function ce(w,G){if(k.isArray(w))return w.map(Q=>ce(Q,G));if(k.isObject(w)){if("@preserve"in w)return w["@preserve"][0];if(U.isValue(w))return w;if(U.isList(w))return w["@list"]=ce(w["@list"],G),w;if("@id"in w){const Q=w["@id"];if(G.link.hasOwnProperty(Q)){const oe=G.link[Q].indexOf(w);if(-1!==oe)return G.link[Q][oe];G.link[Q].push(w)}else G.link[Q]=[w]}for(const Q in w)"@id"===Q&&G.bnodesToClear.includes(w[Q])?delete w["@id"]:w[Q]=ce(w[Q],G)}return w}function D(w,G,Q){k.isObject(w)?ie.addValue(w,G,Q,{propertyIsArray:!0}):w.push(Q)}function I(w,G,Q,oe){if(!("@id"in Q))return!1;const se=w.subjects[Q["@id"]];return se&&O(w,se,G,oe)}function X(w,G){const Q=G["@value"],oe=G["@type"],se=G["@language"],ee=w["@value"]?k.isArray(w["@value"])?w["@value"]:[w["@value"]]:[],Se=w["@type"]?k.isArray(w["@type"])?w["@type"]:[w["@type"]]:[],me=w["@language"]?k.isArray(w["@language"])?w["@language"]:[w["@language"]]:[];return 0===ee.length&&0===Se.length&&0===me.length||!(!ee.includes(Q)&&!k.isEmptyObject(ee[0])||!(!oe&&0===Se.length||Se.includes(oe)||oe&&k.isEmptyObject(Se[0]))||!(!se&&0===me.length||me.includes(se)||se&&k.isEmptyObject(me[0])))}Ae.exports=M,M.frameMergedOrDefault=(w,G,Q)=>{const oe={options:Q,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},se=new ie.IdentifierIssuer("_:b");x(w,oe.graphMap,"@default",se),Q.merged&&(oe.graphMap["@merged"]=N(oe.graphMap),oe.graph="@merged"),oe.subjects=oe.graphMap[oe.graph];const ee=[];return M.frame(oe,Object.keys(oe.subjects).sort(),G,ee),Q.pruneBlankNodeIdentifiers&&(Q.bnodesToClear=Object.keys(oe.bnodeMap).filter(Se=>1===oe.bnodeMap[Se].length)),Q.link={},ce(ee,Q)},M.frame=(w,G,Q,oe,se=null)=>{T(Q);const ee=w.options,Se={embed:S(Q=Q[0],ee,"embed"),explicit:S(Q,ee,"explicit"),requireAll:S(Q,ee,"requireAll")};w.link.hasOwnProperty(w.graph)||(w.link[w.graph]={});const me=w.link[w.graph],te=function(w,G,Q,oe){const se={};for(const ee of G){const Se=w.graphMap[w.graph][ee];O(w,Se,Q,oe)&&(se[ee]=Se)}return se}(w,G,Q,Se),_e=Object.keys(te).sort();for(const Oe of _e){const Ge=te[Oe];if(null===se?w.uniqueEmbeds={[w.graph]:{}}:w.uniqueEmbeds[w.graph]=w.uniqueEmbeds[w.graph]||{},"@link"===Se.embed&&Oe in me){D(oe,se,me[Oe]);continue}const rt={"@id":Oe};if(0===Oe.indexOf("_:")&&ie.addValue(w.bnodeMap,Oe,rt,{propertyIsArray:!0}),me[Oe]=rt,("@first"===Se.embed||"@last"===Se.embed)&&w.is11)throw new b("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:Q});if(w.embedded||!w.uniqueEmbeds[w.graph].hasOwnProperty(Oe)){if(w.embedded&&("@never"===Se.embed||y(Ge,w.graph,w.subjectStack))){D(oe,se,rt);continue}if(w.embedded&&("@first"==Se.embed||"@once"==Se.embed)&&w.uniqueEmbeds[w.graph].hasOwnProperty(Oe)){D(oe,se,rt);continue}if("@last"===Se.embed&&Oe in w.uniqueEmbeds[w.graph]&&q(w,Oe),w.uniqueEmbeds[w.graph][Oe]={parent:oe,property:se},w.subjectStack.push({subject:Ge,graph:w.graph}),Oe in w.graphMap){let Xe=!1,Je=null;"@graph"in Q?(Je=Q["@graph"][0],Xe=!("@merged"===Oe||"@default"===Oe),k.isObject(Je)||(Je={})):(Xe="@merged"!==w.graph,Je={}),Xe&&M.frame(zn(ht({},w),{graph:Oe,embedded:!1}),Object.keys(w.graphMap[Oe]).sort(),[Je],rt,"@graph")}"@included"in Q&&M.frame(zn(ht({},w),{embedded:!1}),G,Q["@included"],rt,"@included");for(const Xe of Object.keys(Ge).sort())if(Y(Xe)){if(rt[Xe]=ie.clone(Ge[Xe]),"@type"===Xe)for(const Je of Ge["@type"])0===Je.indexOf("_:")&&ie.addValue(w.bnodeMap,Je,rt,{propertyIsArray:!0})}else if(!Se.explicit||Xe in Q)for(const Je of Ge[Xe]){const Ye=Xe in Q?Q[Xe]:v(Se);if(U.isList(Je)){const Ue=Q[Xe]&&Q[Xe][0]&&Q[Xe][0]["@list"]?Q[Xe][0]["@list"]:v(Se),Le={"@list":[]};D(rt,Xe,Le);const Ke=Je["@list"];for(const xe of Ke)U.isSubjectReference(xe)?M.frame(zn(ht({},w),{embedded:!0}),[xe["@id"]],Ue,Le,"@list"):D(Le,"@list",ie.clone(xe))}else U.isSubjectReference(Je)?M.frame(zn(ht({},w),{embedded:!0}),[Je["@id"]],Ye,rt,Xe):X(Ye[0],Je)&&D(rt,Xe,ie.clone(Je))}for(const Xe of Object.keys(Q).sort()){if("@type"===Xe){if(!k.isObject(Q[Xe][0])||!("@default"in Q[Xe][0]))continue}else if(Y(Xe))continue;const Je=Q[Xe][0]||{};if(!S(Je,ee,"omitDefault")&&!(Xe in rt)){let Ue="@null";"@default"in Je&&(Ue=ie.clone(Je["@default"])),k.isArray(Ue)||(Ue=[Ue]),rt[Xe]=[{"@preserve":Ue}]}}for(const Xe of Object.keys(Q["@reverse"]||{}).sort()){const Je=Q["@reverse"][Xe];for(const Ye of Object.keys(w.subjects))ie.getValues(w.subjects[Ye],Xe).some(Le=>Le["@id"]===Oe)&&(rt["@reverse"]=rt["@reverse"]||{},ie.addValue(rt["@reverse"],Xe,[],{propertyIsArray:!0}),M.frame(zn(ht({},w),{embedded:!0}),[Ye],Je,rt["@reverse"][Xe],se))}D(oe,se,rt),w.subjectStack.pop()}}},M.cleanupNull=(w,G)=>{if(k.isArray(w))return w.map(oe=>M.cleanupNull(oe,G)).filter(oe=>oe);if("@null"===w)return null;if(k.isObject(w)){if("@id"in w){const Q=w["@id"];if(G.link.hasOwnProperty(Q)){const oe=G.link[Q].indexOf(w);if(-1!==oe)return G.link[Q][oe];G.link[Q].push(w)}else G.link[Q]=[w]}for(const Q in w)w[Q]=M.cleanupNull(w[Q],G)}return w}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32}],24:[function(K,Ae,pe){"use strict";const Y=K("./JsonLdError"),U=K("./graphTypes"),k=K("./types"),ie=K("./util"),{RDF_LIST:W,RDF_FIRST:b,RDF_REST:x,RDF_NIL:N,RDF_TYPE:M,RDF_JSON_LITERAL:v,XSD_BOOLEAN:y,XSD_DOUBLE:S,XSD_INTEGER:T,XSD_STRING:j}=K("./constants"),O=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,q={};function ce(D,I,X){if(D.termType.endsWith("Node"))return{"@id":D.value};const w={"@value":D.value};if(D.language)w["@language"]=D.language;else{let G=D.datatype.value;if(G||(G=j),G===v){G="@json";try{w["@value"]=JSON.parse(w["@value"])}catch(Q){throw new Y("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:w["@value"],cause:Q})}}if(I){if(G===y)"true"===w["@value"]?w["@value"]=!0:"false"===w["@value"]&&(w["@value"]=!1);else if(k.isNumeric(w["@value"]))if(G===T){const Q=parseInt(w["@value"],10);Q.toFixed(0)===w["@value"]&&(w["@value"]=Q)}else G===S&&(w["@value"]=parseFloat(w["@value"]));[y,T,S,j].includes(G)||(w["@type"]=G)}else if("i18n-datatype"===X&&G.startsWith("https://www.w3.org/ns/i18n#")){const[,Q,oe]=G.split(/[#_]/);Q.length>0&&(w["@language"]=Q,Q.match(O)||console.warn(`@language must be valid BCP47: ${Q}`)),w["@direction"]=oe}else G!==j&&(w["@type"]=G)}return w}Ae.exports=q,q.fromRDF=function(){var D=mt(function*(I,{useRdfType:X=!1,useNativeTypes:w=!1,rdfDirection:G=null}){const Q={},oe={"@default":Q},se={};for(const me of I){const te="DefaultGraph"===me.graph.termType?"@default":me.graph.value;te in oe||(oe[te]={}),"@default"!==te&&!(te in Q)&&(Q[te]={"@id":te});const _e=oe[te],Oe=me.subject.value,Ge=me.predicate.value,rt=me.object;Oe in _e||(_e[Oe]={"@id":Oe});const Xe=_e[Oe],Je=rt.termType.endsWith("Node");if(Je&&!(rt.value in _e)&&(_e[rt.value]={"@id":rt.value}),Ge===M&&!X&&Je){ie.addValue(Xe,"@type",rt.value,{propertyIsArray:!0});continue}const Ye=ce(rt,w,G);if(ie.addValue(Xe,Ge,Ye,{propertyIsArray:!0}),Je)if(rt.value===N){const Ue=_e[rt.value];"usages"in Ue||(Ue.usages=[]),Ue.usages.push({node:Xe,property:Ge,value:Ye})}else se[rt.value]=!(rt.value in se)&&{node:Xe,property:Ge,value:Ye}}for(const me in oe){const te=oe[me];if(!(N in te))continue;const _e=te[N];if(_e.usages){for(let Oe of _e.usages){let Ge=Oe.node,rt=Oe.property,Xe=Oe.value;const Je=[],Ye=[];let Ue=Object.keys(Ge).length;for(;rt===x&&k.isObject(se[Ge["@id"]])&&k.isArray(Ge[b])&&1===Ge[b].length&&k.isArray(Ge[x])&&1===Ge[x].length&&(3===Ue||4===Ue&&k.isArray(Ge["@type"])&&1===Ge["@type"].length&&Ge["@type"][0]===W)&&(Je.push(Ge[b][0]),Ye.push(Ge["@id"]),Oe=se[Ge["@id"]],Ge=Oe.node,rt=Oe.property,Xe=Oe.value,Ue=Object.keys(Ge).length,U.isBlankNode(Ge)););delete Xe["@id"],Xe["@list"]=Je.reverse();for(const Le of Ye)delete te[Le]}delete _e.usages}}const ee=[],Se=Object.keys(Q).sort();for(const me of Se){const te=Q[me];if(me in oe){const _e=te["@graph"]=[],Oe=oe[me],Ge=Object.keys(Oe).sort();for(const rt of Ge){const Xe=Oe[rt];U.isSubjectReference(Xe)||_e.push(Xe)}}U.isSubjectReference(te)||ee.push(te)}return ee});return function(I,X){return D.apply(this,arguments)}}()},{"./JsonLdError":12,"./constants":18,"./graphTypes":25,"./types":30,"./util":32}],25:[function(K,Ae,pe){"use strict";const Y=K("./types"),U={};Ae.exports=U,U.isSubject=k=>!(!Y.isObject(k)||"@value"in k||"@set"in k||"@list"in k)&&(Object.keys(k).length>1||!("@id"in k)),U.isSubjectReference=k=>Y.isObject(k)&&1===Object.keys(k).length&&"@id"in k,U.isValue=k=>Y.isObject(k)&&"@value"in k,U.isList=k=>Y.isObject(k)&&"@list"in k,U.isGraph=k=>Y.isObject(k)&&"@graph"in k&&1===Object.keys(k).filter(ie=>"@id"!==ie&&"@index"!==ie).length,U.isSimpleGraph=k=>U.isGraph(k)&&!("@id"in k),U.isBlankNode=k=>!!Y.isObject(k)&&("@id"in k?0===k["@id"].indexOf("_:"):0===Object.keys(k).length||!("@value"in k||"@set"in k||"@list"in k))},{"./types":30}],26:[function(K,Ae,pe){const Y=K("rdf-canonize"),U=K("./platform"),k=K("./util"),ie=K("./ContextResolver"),W=k.IdentifierIssuer,b=K("./JsonLdError"),x=K("lru-cache"),N=K("./NQuads"),{expand:M}=K("./expand"),{flatten:v}=K("./flatten"),{fromRDF:y}=K("./fromRdf"),{toRDF:S}=K("./toRdf"),{frameMergedOrDefault:T,cleanupNull:j}=K("./frame"),{isArray:O,isObject:q,isString:ce}=K("./types"),{isSubjectReference:D}=K("./graphTypes"),{expandIri:I,getInitialContext:X,process:w,processingMode:G}=K("./context"),{compact:Q,compactIri:oe}=K("./compact"),{createNodeMap:se,createMergedNodeMap:ee,mergeNodeMaps:Se}=K("./nodeMap"),me=function(_e){const Oe={},rt=new x({max:100});function Xe(Je,Le){var Ke=Le,{documentLoader:Ye=_e.documentLoader}=Ke,Ue=GW(Ke,["documentLoader"]);return Object.assign({},{documentLoader:Ye},Ue,Je)}return _e.compact=function(){var Je=mt(function*(Ye,Ue,Le){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===Ue)throw new b("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===Ye)return null;let Ke;(Le=Xe(Le,{base:ce(Ye)?Ye:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new W("_:b"),contextResolver:new ie({sharedCache:rt})})).link&&(Le.skipExpansion=!0),Le.compactToRelative||delete Le.base,Ke=Le.skipExpansion?Ye:yield _e.expand(Ye,Le);const xe=yield _e.processContext(X(Le),Ue,Le);let je=yield Q({activeCtx:xe,element:Ke,options:Le,compactionMap:Le.compactionMap});Le.compactArrays&&!Le.graph&&O(je)?1===je.length?je=je[0]:0===je.length&&(je={}):Le.graph&&q(je)&&(je=[je]),q(Ue)&&"@context"in Ue&&(Ue=Ue["@context"]),Ue=k.clone(Ue),O(Ue)||(Ue=[Ue]);const We=Ue;Ue=[];for(let $=0;$<We.length;++$)(!q(We[$])||Object.keys(We[$]).length>0)&&Ue.push(We[$]);const Pe=Ue.length>0;if(1===Ue.length&&(Ue=Ue[0]),O(je)){const $=oe({activeCtx:xe,iri:"@graph",relativeTo:{vocab:!0}}),H=je;je={},Pe&&(je["@context"]=Ue),je[$]=H}else if(q(je)&&Pe){const $=je;je={"@context":Ue};for(const H in $)je[H]=$[H]}return je});return function(Ye,Ue,Le){return Je.apply(this,arguments)}}(),_e.expand=function(){var Je=mt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(Ue=Xe(Ue,{keepFreeFloatingNodes:!1,contextResolver:new ie({sharedCache:rt})})).expansionMap&&(Ue.expansionMap=void 0);const Le={},Ke=[];if("expandContext"in Ue){const Pe=k.clone(Ue.expandContext);Le.expandContext=q(Pe)&&"@context"in Pe?Pe:{"@context":Pe},Ke.push(Le.expandContext)}let xe;if(ce(Ye)){const Pe=yield _e.get(Ye,Ue);xe=Pe.documentUrl,Le.input=Pe.document,Pe.contextUrl&&(Le.remoteContext={"@context":Pe.contextUrl},Ke.push(Le.remoteContext))}else Le.input=k.clone(Ye);"base"in Ue||(Ue.base=xe||"");let je=X(Ue);for(const Pe of Ke)je=yield w({activeCtx:je,localCtx:Pe,options:Ue});let We=yield M({activeCtx:je,element:Le.input,options:Ue,expansionMap:Ue.expansionMap});return q(We)&&"@graph"in We&&1===Object.keys(We).length?We=We["@graph"]:null===We&&(We=[]),O(We)||(We=[We]),We});return function(Ye,Ue){return Je.apply(this,arguments)}}(),_e.flatten=function(){var Je=mt(function*(Ye,Ue,Le){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");Ue="function"==typeof Ue?null:Ue||null,Le=Xe(Le,{base:ce(Ye)?Ye:"",contextResolver:new ie({sharedCache:rt})});const Ke=yield _e.expand(Ye,Le),xe=v(Ke);return null===Ue?xe:(Le.graph=!0,Le.skipExpansion=!0,yield _e.compact(xe,Ue,Le))});return function(Ye,Ue,Le){return Je.apply(this,arguments)}}(),_e.frame=function(){var Je=mt(function*(Ye,Ue,Le){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(Le=Xe(Le,{base:ce(Ye)?Ye:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new ie({sharedCache:rt})}),ce(Ue)){const ue=yield _e.get(Ue,Le);if(Ue=ue.document,ue.contextUrl){let Ve=Ue["@context"];Ve?O(Ve)?Ve.push(ue.contextUrl):Ve=[Ve,ue.contextUrl]:Ve=ue.contextUrl,Ue["@context"]=Ve}}const Ke=Ue&&Ue["@context"]||{},xe=yield _e.processContext(X(Le),Ke,Le);Le.hasOwnProperty("omitGraph")||(Le.omitGraph=G(xe,1.1)),Le.hasOwnProperty("pruneBlankNodeIdentifiers")||(Le.pruneBlankNodeIdentifiers=G(xe,1.1));const je=yield _e.expand(Ye,Le),We=ht({},Le);We.isFrame=!0,We.keepFreeFloatingNodes=!0;const Pe=yield _e.expand(Ue,We),$=Object.keys(Ue).map(ue=>I(xe,ue,{vocab:!0}));We.merged=!$.includes("@graph"),We.is11=G(xe,1.1);const H=T(je,Pe,We);We.graph=!Le.omitGraph,We.skipExpansion=!0,We.link={},We.framing=!0;let fe=yield _e.compact(H,Ke,We);return We.link={},fe=j(fe,We),fe});return function(Ye,Ue,Le){return Je.apply(this,arguments)}}(),_e.link=function(){var Je=mt(function*(Ye,Ue,Le){const Ke={};return Ue&&(Ke["@context"]=Ue),Ke["@embed"]="@link",_e.frame(Ye,Ke,Le)});return function(Ye,Ue,Le){return Je.apply(this,arguments)}}(),_e.normalize=_e.canonize=function(){var Je=mt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(Ue=Xe(Ue,{base:ce(Ye)?Ye:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new ie({sharedCache:rt})}))){if("application/n-quads"!==Ue.inputFormat&&"application/nquads"!==Ue.inputFormat)throw new b("Unknown canonicalization input format.","jsonld.CanonizeError");const xe=N.parse(Ye);return Y.canonize(xe,Ue)}const Le=ht({},Ue);delete Le.format,Le.produceGeneralizedRdf=!1;const Ke=yield _e.toRDF(Ye,Le);return Y.canonize(Ke,Ue)});return function(Ye,Ue){return Je.apply(this,arguments)}}(),_e.fromRDF=function(){var Je=mt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");Ue=Xe(Ue,{format:ce(Ye)?"application/n-quads":void 0});const{format:Le}=Ue;let{rdfParser:Ke}=Ue;if(Le){if(Ke=Ke||Oe[Le],!Ke)throw new b("Unknown input format.","jsonld.UnknownFormat",{format:Le})}else Ke=()=>Ye;const xe=yield Ke(Ye);return y(xe,Ue)});return function(Ye,Ue){return Je.apply(this,arguments)}}(),_e.toRDF=function(){var Je=mt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let Le;Le=(Ue=Xe(Ue,{base:ce(Ye)?Ye:"",skipExpansion:!1,contextResolver:new ie({sharedCache:rt})})).skipExpansion?Ye:yield _e.expand(Ye,Ue);const Ke=S(Le,Ue);if(Ue.format){if("application/n-quads"===Ue.format||"application/nquads"===Ue.format)return N.serialize(Ke);throw new b("Unknown output format.","jsonld.UnknownFormat",{format:Ue.format})}return Ke});return function(Ye,Ue){return Je.apply(this,arguments)}}(),_e.createNodeMap=function(){var Je=mt(function*(Ye,Ue){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");Ue=Xe(Ue,{base:ce(Ye)?Ye:"",contextResolver:new ie({sharedCache:rt})});const Le=yield _e.expand(Ye,Ue);return ee(Le,Ue)});return function(Ye,Ue){return Je.apply(this,arguments)}}(),_e.merge=function(){var Je=mt(function*(Ye,Ue,Le){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!O(Ye))throw new TypeError('Could not merge, "docs" must be an array.');Ue="function"==typeof Ue?null:Ue||null,Le=Xe(Le,{contextResolver:new ie({sharedCache:rt})});const Ke=yield Promise.all(Ye.map(ue=>{const Ve=ht({},Le);return _e.expand(ue,Ve)}));let xe=!0;"mergeNodes"in Le&&(xe=Le.mergeNodes);const je=Le.issuer||new W("_:b"),We={"@default":{}};for(let ue=0;ue<Ke.length;++ue){const Ve=k.relabelBlankNodes(Ke[ue],{issuer:new W("_:b"+ue+"-")}),gt=xe||0===ue?We:{"@default":{}};if(se(Ve,gt,"@default",je),gt!==We)for(const ft in gt){const be=gt[ft];if(!(ft in We)){We[ft]=be;continue}const B=We[ft];for(const P in be)P in B||(B[P]=be[P])}}const Pe=Se(We),$=[],H=Object.keys(Pe).sort();for(let ue=0;ue<H.length;++ue){const Ve=Pe[H[ue]];D(Ve)||$.push(Ve)}return null===Ue?$:(Le.graph=!0,Le.skipExpansion=!0,yield _e.compact($,Ue,Le))});return function(Ye,Ue,Le){return Je.apply(this,arguments)}}(),Object.defineProperty(_e,"documentLoader",{get:()=>_e._documentLoader,set:Je=>_e._documentLoader=Je}),_e.documentLoader=function(){var Je=mt(function*(Ye){throw new b("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:Ye})});return function(Ye){return Je.apply(this,arguments)}}(),_e.get=function(){var Je=mt(function*(Ye,Ue){let Le;Le="function"==typeof Ue.documentLoader?Ue.documentLoader:_e.documentLoader;const Ke=yield Le(Ye);try{if(!Ke.document)throw new b("No remote document found at the given URL.","jsonld.NullRemoteDocument");ce(Ke.document)&&(Ke.document=JSON.parse(Ke.document))}catch(xe){throw new b("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:xe,remoteDoc:Ke})}return Ke});return function(Ye,Ue){return Je.apply(this,arguments)}}(),_e.processContext=function(){var Je=mt(function*(Ye,Ue,Le){return Le=Xe(Le,{base:"",contextResolver:new ie({sharedCache:rt})}),null===Ue?X(Le):(Ue=k.clone(Ue),q(Ue)&&"@context"in Ue||(Ue={"@context":Ue}),w({activeCtx:Ye,localCtx:Ue,options:Le}))});return function(Ye,Ue,Le){return Je.apply(this,arguments)}}(),_e.getContextValue=K("./context").getContextValue,_e.documentLoaders={},_e.useDocumentLoader=function(Je){if(!(Je in _e.documentLoaders))throw new b('Unknown document loader type: "'+Je+'"',"jsonld.UnknownDocumentLoader",{type:Je});_e.documentLoader=_e.documentLoaders[Je].apply(_e,Array.prototype.slice.call(arguments,1))},_e.registerRDFParser=function(Je,Ye){Oe[Je]=Ye},_e.unregisterRDFParser=function(Je){delete Oe[Je]},_e.registerRDFParser("application/n-quads",N.parse),_e.registerRDFParser("application/nquads",N.parse),_e.url=K("./url"),_e.util=k,Object.assign(_e,k),_e.promises=_e,_e.RequestQueue=K("./RequestQueue"),_e.JsonLdProcessor=K("./JsonLdProcessor")(_e),U.setupGlobals(_e),U.setupDocumentLoaders(_e),_e},te=function(){return me(function(){return te()})};me(te),Ae.exports=te},{"./ContextResolver":11,"./JsonLdError":12,"./JsonLdProcessor":13,"./NQuads":14,"./RequestQueue":15,"./compact":17,"./context":19,"./expand":21,"./flatten":22,"./frame":23,"./fromRdf":24,"./graphTypes":25,"./nodeMap":27,"./platform":28,"./toRdf":29,"./types":30,"./url":31,"./util":32,"lru-cache":33,"rdf-canonize":46}],27:[function(K,Ae,pe){"use strict";const{isKeyword:Y}=K("./context"),U=K("./graphTypes"),k=K("./types"),ie=K("./util"),W=K("./JsonLdError"),b={};Ae.exports=b,b.createMergedNodeMap=(x,N)=>{const M=(N=N||{}).issuer||new ie.IdentifierIssuer("_:b"),v={"@default":{}};return b.createNodeMap(x,v,"@default",M),b.mergeNodeMaps(v)},b.createNodeMap=(x,N,M,v,y,S)=>{if(k.isArray(x)){for(const q of x)b.createNodeMap(q,N,M,v,void 0,S);return}if(!k.isObject(x))return void(S&&S.push(x));if(U.isValue(x)){if("@type"in x){let q=x["@type"];0===q.indexOf("_:")&&(x["@type"]=q=v.getId(q))}return void(S&&S.push(x))}if(S&&U.isList(x)){const q=[];return b.createNodeMap(x["@list"],N,M,v,y,q),void S.push({"@list":q})}if("@type"in x){const q=x["@type"];for(const ce of q)0===ce.indexOf("_:")&&v.getId(ce)}k.isUndefined(y)&&(y=U.isBlankNode(x)?v.getId(x["@id"]):x["@id"]),S&&S.push({"@id":y});const T=N[M],j=T[y]=T[y]||{};j["@id"]=y;const O=Object.keys(x).sort();for(let q of O){if("@id"===q)continue;if("@reverse"===q){const D={"@id":y},I=x["@reverse"];for(const X in I){const w=I[X];for(const G of w){let Q=G["@id"];U.isBlankNode(G)&&(Q=v.getId(Q)),b.createNodeMap(G,N,M,v,Q),ie.addValue(T[Q],X,D,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===q){y in N||(N[y]={}),b.createNodeMap(x[q],N,y,v);continue}if("@included"===q){b.createNodeMap(x[q],N,M,v);continue}if("@type"!==q&&Y(q)){if("@index"===q&&q in j&&(x[q]!==j[q]||x[q]["@id"]!==j[q]["@id"]))throw new W("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:j});j[q]=x[q];continue}const ce=x[q];if(0===q.indexOf("_:")&&(q=v.getId(q)),0!==ce.length)for(let D of ce)if("@type"===q&&(D=0===D.indexOf("_:")?v.getId(D):D),U.isSubject(D)||U.isSubjectReference(D)){if("@id"in D&&!D["@id"])continue;const I=U.isBlankNode(D)?v.getId(D["@id"]):D["@id"];ie.addValue(j,q,{"@id":I},{propertyIsArray:!0,allowDuplicate:!1}),b.createNodeMap(D,N,M,v,I)}else if(U.isValue(D))ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1});else if(U.isList(D)){const I=[];b.createNodeMap(D["@list"],N,M,v,y,I),D={"@list":I},ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1})}else b.createNodeMap(D,N,M,v,y),ie.addValue(j,q,D,{propertyIsArray:!0,allowDuplicate:!1});else ie.addValue(j,q,[],{propertyIsArray:!0})}},b.mergeNodeMapGraphs=x=>{const N={};for(const M of Object.keys(x).sort())for(const v of Object.keys(x[M]).sort()){const y=x[M][v];v in N||(N[v]={"@id":v});const S=N[v];for(const T of Object.keys(y).sort())if(Y(T)&&"@type"!==T)S[T]=ie.clone(y[T]);else for(const j of y[T])ie.addValue(S,T,ie.clone(j),{propertyIsArray:!0,allowDuplicate:!1})}return N},b.mergeNodeMaps=x=>{const N=x["@default"],M=Object.keys(x).sort();for(const v of M){if("@default"===v)continue;const y=x[v];let S=N[v];S?"@graph"in S||(S["@graph"]=[]):N[v]=S={"@id":v,"@graph":[]};const T=S["@graph"];for(const j of Object.keys(y).sort()){const O=y[j];U.isSubjectReference(O)||T.push(O)}}return N}},{"./JsonLdError":12,"./context":19,"./graphTypes":25,"./types":30,"./util":32}],28:[function(K,Ae,pe){"use strict";const Y=K("./documentLoaders/xhr"),U={};Ae.exports=U,U.setupDocumentLoaders=function(k){"undefined"!=typeof XMLHttpRequest&&(k.documentLoaders.xhr=Y,k.useDocumentLoader("xhr"))},U.setupGlobals=function(k){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:k.JsonLdProcessor})}},{"./documentLoaders/xhr":20}],29:[function(K,Ae,pe){"use strict";const{createNodeMap:Y}=K("./nodeMap"),{isKeyword:U}=K("./context"),k=K("./graphTypes"),ie=K("canonicalize"),W=K("./types"),b=K("./util"),{RDF_FIRST:x,RDF_REST:N,RDF_NIL:M,RDF_TYPE:v,RDF_JSON_LITERAL:y,RDF_LANGSTRING:S,XSD_BOOLEAN:T,XSD_DOUBLE:j,XSD_INTEGER:O,XSD_STRING:q}=K("./constants"),{isAbsolute:ce}=K("./url"),D={};function I(G,Q,oe,se,ee){const Se=Object.keys(Q).sort();for(const me of Se){const te=Q[me],_e=Object.keys(te).sort();for(let Oe of _e){const Ge=te[Oe];if("@type"===Oe)Oe=v;else if(U(Oe))continue;for(const rt of Ge){const Xe={termType:me.startsWith("_:")?"BlankNode":"NamedNode",value:me};if(!ce(me))continue;const Je={termType:Oe.startsWith("_:")?"BlankNode":"NamedNode",value:Oe};if(!ce(Oe)||"BlankNode"===Je.termType&&!ee.produceGeneralizedRdf)continue;const Ye=w(rt,se,G,oe,ee.rdfDirection);Ye&&G.push({subject:Xe,predicate:Je,object:Ye,graph:oe})}}}}function w(G,Q,oe,se,ee){const Se={};if(k.isValue(G)){Se.termType="Literal",Se.value=void 0,Se.datatype={termType:"NamedNode"};let me=G["@value"];const te=G["@type"]||null;"@json"===te?(Se.value=ie(me),Se.datatype.value=y):W.isBoolean(me)?(Se.value=me.toString(),Se.datatype.value=te||T):W.isDouble(me)||te===j?(W.isDouble(me)||(me=parseFloat(me)),Se.value=me.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),Se.datatype.value=te||j):W.isNumber(me)?(Se.value=me.toFixed(0),Se.datatype.value=te||O):"i18n-datatype"===ee&&"@direction"in G?(Se.datatype.value="https://www.w3.org/ns/i18n#"+(G["@language"]||"")+`_${G["@direction"]}`,Se.value=me):"@language"in G?(Se.value=me,Se.datatype.value=te||S,Se.language=G["@language"]):(Se.value=me,Se.datatype.value=te||q)}else if(k.isList(G)){const me=function(G,Q,oe,se,ee){const Se={termType:"NamedNode",value:x},me={termType:"NamedNode",value:N},te={termType:"NamedNode",value:M},_e=G.pop(),Oe=_e?{termType:"BlankNode",value:Q.getId()}:te;let Ge=Oe;for(const rt of G){const Xe=w(rt,Q,oe,se,ee),Je={termType:"BlankNode",value:Q.getId()};oe.push({subject:Ge,predicate:Se,object:Xe,graph:se}),oe.push({subject:Ge,predicate:me,object:Je,graph:se}),Ge=Je}if(_e){const rt=w(_e,Q,oe,se,ee);oe.push({subject:Ge,predicate:Se,object:rt,graph:se}),oe.push({subject:Ge,predicate:me,object:te,graph:se})}return Oe}(G["@list"],Q,oe,se,ee);Se.termType=me.termType,Se.value=me.value}else{const me=W.isObject(G)?G["@id"]:G;Se.termType=me.startsWith("_:")?"BlankNode":"NamedNode",Se.value=me}return"NamedNode"!==Se.termType||ce(Se.value)?Se:null}Ae.exports=D,D.toRDF=(G,Q)=>{const oe=new b.IdentifierIssuer("_:b"),se={"@default":{}};Y(G,se,"@default",oe);const ee=[],Se=Object.keys(se).sort();for(const me of Se){let te;if("@default"===me)te={termType:"DefaultGraph",value:""};else{if(!ce(me))continue;te=me.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},te.value=me}I(ee,se[me],te,oe,Q)}return ee}},{"./constants":18,"./context":19,"./graphTypes":25,"./nodeMap":27,"./types":30,"./url":31,"./util":32,canonicalize:7}],30:[function(K,Ae,pe){"use strict";const Y={};Ae.exports=Y,Y.isArray=Array.isArray,Y.isBoolean=U=>"boolean"==typeof U||"[object Boolean]"===Object.prototype.toString.call(U),Y.isDouble=U=>Y.isNumber(U)&&(-1!==String(U).indexOf(".")||Math.abs(U)>=1e21),Y.isEmptyObject=U=>Y.isObject(U)&&0===Object.keys(U).length,Y.isNumber=U=>"number"==typeof U||"[object Number]"===Object.prototype.toString.call(U),Y.isNumeric=U=>!isNaN(parseFloat(U))&&isFinite(U),Y.isObject=U=>"[object Object]"===Object.prototype.toString.call(U),Y.isString=U=>"string"==typeof U||"[object String]"===Object.prototype.toString.call(U),Y.isUndefined=U=>void 0===U},{}],31:[function(K,Ae,pe){"use strict";const Y=K("./types"),U={};Ae.exports=U,U.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},U.parse=(ie,W)=>{const b={},x=U.parsers[W||"full"],N=x.regex.exec(ie);let M=x.keys.length;for(;M--;)b[x.keys[M]]=void 0===N[M]?null:N[M];return("https"===b.scheme&&"443"===b.port||"http"===b.scheme&&"80"===b.port)&&(b.href=b.href.replace(":"+b.port,""),b.authority=b.authority.replace(":"+b.port,""),b.port=null),b.normalizedPath=U.removeDotSegments(b.path),b},U.prependBase=(ie,W)=>{if(null===ie||U.isAbsolute(W))return W;(!ie||Y.isString(ie))&&(ie=U.parse(ie||""));const b=U.parse(W),x={protocol:ie.protocol||""};if(null!==b.authority)x.authority=b.authority,x.path=b.path,x.query=b.query;else if(x.authority=ie.authority,""===b.path)x.path=ie.path,x.query=null!==b.query?b.query:ie.query;else{if(0===b.path.indexOf("/"))x.path=b.path;else{let M=ie.path;M=M.substr(0,M.lastIndexOf("/")+1),(M.length>0||ie.authority)&&"/"!==M.substr(-1)&&(M+="/"),M+=b.path,x.path=M}x.query=b.query}""!==b.path&&(x.path=U.removeDotSegments(x.path));let N=x.protocol;return null!==x.authority&&(N+="//"+x.authority),N+=x.path,null!==x.query&&(N+="?"+x.query),null!==b.fragment&&(N+="#"+b.fragment),""===N&&(N="./"),N},U.removeBase=(ie,W)=>{if(null===ie)return W;(!ie||Y.isString(ie))&&(ie=U.parse(ie||""));let b="";if(""!==ie.href?b+=(ie.protocol||"")+"//"+(ie.authority||""):W.indexOf("//")&&(b+="//"),0!==W.indexOf(b))return W;const x=U.parse(W.substr(b.length)),N=ie.normalizedPath.split("/"),M=x.normalizedPath.split("/"),v=x.fragment||x.query?0:1;for(;N.length>0&&M.length>v&&N[0]===M[0];)N.shift(),M.shift();let y="";if(N.length>0){N.pop();for(let S=0;S<N.length;++S)y+="../"}return y+=M.join("/"),null!==x.query&&(y+="?"+x.query),null!==x.fragment&&(y+="#"+x.fragment),""===y&&(y="./"),y},U.removeDotSegments=ie=>{if(0===ie.length)return"";const W=ie.split("/"),b=[];for(;W.length>0;){const x=W.shift(),N=0===W.length;"."!==x?".."!==x?b.push(x):(b.pop(),N&&b.push("")):N&&b.push("")}return"/"===ie[0]&&b.length>0&&""!==b[0]&&b.unshift(""),1===b.length&&""===b[0]?"/":b.join("/")};const k=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;U.isAbsolute=ie=>Y.isString(ie)&&k.test(ie),U.isRelative=ie=>Y.isString(ie)},{"./types":30}],32:[function(K,Ae,pe){"use strict";const Y=K("./graphTypes"),U=K("./types"),k=K("rdf-canonize").IdentifierIssuer,ie=K("./JsonLdError"),W=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,b=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,x=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,N_headers={accept:"application/ld+json, application/json"},M={};function v(y,S){if(U.isArray(S))for(let T=0;T<S.length;++T)S[T]=v(y,S[T]);else if(Y.isList(S))S["@list"]=v(y,S["@list"]);else if(U.isObject(S)){Y.isBlankNode(S)&&(S["@id"]=y.getId(S["@id"]));const T=Object.keys(S).sort();for(let j=0;j<T.length;++j){const O=T[j];"@id"!==O&&(S[O]=v(y,S[O]))}}return S}Ae.exports=M,M.IdentifierIssuer=k,M.clone=function(y){if(y&&"object"==typeof y){let S;if(U.isArray(y)){S=[];for(let T=0;T<y.length;++T)S[T]=M.clone(y[T])}else if(y instanceof Map){S=new Map;for(const[T,j]of y)S.set(T,M.clone(j))}else if(y instanceof Set){S=new Set;for(const T of y)S.add(M.clone(T))}else if(U.isObject(y)){S={};for(const T in y)S[T]=M.clone(y[T])}else S=y.toString();return S}return y},M.asArray=function(y){return Array.isArray(y)?y:[y]},M.buildHeaders=(y={})=>{if(Object.keys(y).some(T=>"accept"===T.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+N_headers.accept+'" is supported.');return Object.assign({Accept:N_headers.accept},y)},M.parseLinkHeader=y=>{const S={},T=y.match(W);for(let j=0;j<T.length;++j){let O=T[j].match(b);if(!O)continue;const q={target:O[1]},ce=O[2];for(;O=x.exec(ce);)q[O[1]]=void 0===O[2]?O[3]:O[2];const D=q.rel||"";Array.isArray(S[D])?S[D].push(q):S[D]=S.hasOwnProperty(D)?[S[D],q]:q}return S},M.validateTypeValue=(y,S)=>{if(!(U.isString(y)||U.isArray(y)&&y.every(T=>U.isString(T)))){if(S&&U.isObject(y))switch(Object.keys(y).length){case 0:return;case 1:if("@default"in y&&M.asArray(y["@default"]).every(T=>U.isString(T)))return}throw new ie('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:y})}},M.hasProperty=(y,S)=>{if(y.hasOwnProperty(S)){const T=y[S];return!U.isArray(T)||T.length>0}return!1},M.hasValue=(y,S,T)=>{if(M.hasProperty(y,S)){let j=y[S];const O=Y.isList(j);if(U.isArray(j)||O){O&&(j=j["@list"]);for(let q=0;q<j.length;++q)if(M.compareValues(T,j[q]))return!0}else if(!U.isArray(T))return M.compareValues(T,j)}return!1},M.addValue=(y,S,T,j)=>{if("propertyIsArray"in(j=j||{})||(j.propertyIsArray=!1),"valueIsArray"in j||(j.valueIsArray=!1),"allowDuplicate"in j||(j.allowDuplicate=!0),"prependValue"in j||(j.prependValue=!1),j.valueIsArray)y[S]=T;else if(U.isArray(T)){0===T.length&&j.propertyIsArray&&!y.hasOwnProperty(S)&&(y[S]=[]),j.prependValue&&(T=T.concat(y[S]),y[S]=[]);for(let O=0;O<T.length;++O)M.addValue(y,S,T[O],j)}else if(y.hasOwnProperty(S)){const O=!j.allowDuplicate&&M.hasValue(y,S,T);!U.isArray(y[S])&&(!O||j.propertyIsArray)&&(y[S]=[y[S]]),O||(j.prependValue?y[S].unshift(T):y[S].push(T))}else y[S]=j.propertyIsArray?[T]:T},M.getValues=(y,S)=>[].concat(y[S]||[]),M.removeProperty=(y,S)=>{delete y[S]},M.removeValue=(y,S,T,j)=>{"propertyIsArray"in(j=j||{})||(j.propertyIsArray=!1);const O=M.getValues(y,S).filter(q=>!M.compareValues(q,T));0===O.length?M.removeProperty(y,S):y[S]=1!==O.length||j.propertyIsArray?O:O[0]},M.relabelBlankNodes=(y,S)=>v((S=S||{}).issuer||new k("_:b"),y),M.compareValues=(y,S)=>!!(y===S||Y.isValue(y)&&Y.isValue(S)&&y["@value"]===S["@value"]&&y["@type"]===S["@type"]&&y["@language"]===S["@language"]&&y["@index"]===S["@index"])||!!(U.isObject(y)&&"@id"in y&&U.isObject(S)&&"@id"in S)&&y["@id"]===S["@id"],M.compareShortestLeast=(y,S)=>y.length<S.length?-1:S.length<y.length?1:y===S?0:y<S?-1:1},{"./JsonLdError":12,"./graphTypes":25,"./types":30,"rdf-canonize":46}],33:[function(K,Ae,pe){"use strict";const Y=K("yallist"),U=Symbol("max"),k=Symbol("length"),ie=Symbol("lengthCalculator"),W=Symbol("allowStale"),b=Symbol("maxAge"),x=Symbol("dispose"),N=Symbol("noDisposeOnSet"),M=Symbol("lruList"),v=Symbol("cache"),y=Symbol("updateAgeOnGet"),S=()=>1;const j=(X,w,G)=>{const Q=X[v].get(w);if(Q){const oe=Q.value;if(O(X,oe)){if(ce(X,Q),!X[W])return}else G&&(X[y]&&(Q.value.now=Date.now()),X[M].unshiftNode(Q));return oe.value}},O=(X,w)=>{if(!w||!w.maxAge&&!X[b])return!1;const G=Date.now()-w.now;return w.maxAge?G>w.maxAge:X[b]&&G>X[b]},q=X=>{if(X[k]>X[U])for(let w=X[M].tail;X[k]>X[U]&&null!==w;){const G=w.prev;ce(X,w),w=G}},ce=(X,w)=>{if(w){const G=w.value;X[x]&&X[x](G.key,G.value),X[k]-=G.length,X[v].delete(G.key),X[M].removeNode(w)}};class D{constructor(w,G,Q,oe,se){this.key=w,this.value=G,this.length=Q,this.now=oe,this.maxAge=se||0}}const I=(X,w,G,Q)=>{let oe=G.value;O(X,oe)&&(ce(X,G),X[W]||(oe=void 0)),oe&&w.call(Q,oe.value,oe.key,X)};Ae.exports=class{constructor(w){if("number"==typeof w&&(w={max:w}),w||(w={}),w.max&&("number"!=typeof w.max||w.max<0))throw new TypeError("max must be a non-negative number");this[U]=w.max||1/0;const Q=w.length||S;if(this[ie]="function"!=typeof Q?S:Q,this[W]=w.stale||!1,w.maxAge&&"number"!=typeof w.maxAge)throw new TypeError("maxAge must be a number");this[b]=w.maxAge||0,this[x]=w.dispose,this[N]=w.noDisposeOnSet||!1,this[y]=w.updateAgeOnGet||!1,this.reset()}set max(w){if("number"!=typeof w||w<0)throw new TypeError("max must be a non-negative number");this[U]=w||1/0,q(this)}get max(){return this[U]}set allowStale(w){this[W]=!!w}get allowStale(){return this[W]}set maxAge(w){if("number"!=typeof w)throw new TypeError("maxAge must be a non-negative number");this[b]=w,q(this)}get maxAge(){return this[b]}set lengthCalculator(w){"function"!=typeof w&&(w=S),w!==this[ie]&&(this[ie]=w,this[k]=0,this[M].forEach(G=>{G.length=this[ie](G.value,G.key),this[k]+=G.length})),q(this)}get lengthCalculator(){return this[ie]}get length(){return this[k]}get itemCount(){return this[M].length}rforEach(w,G){G=G||this;for(let Q=this[M].tail;null!==Q;){const oe=Q.prev;I(this,w,Q,G),Q=oe}}forEach(w,G){G=G||this;for(let Q=this[M].head;null!==Q;){const oe=Q.next;I(this,w,Q,G),Q=oe}}keys(){return this[M].toArray().map(w=>w.key)}values(){return this[M].toArray().map(w=>w.value)}reset(){this[x]&&this[M]&&this[M].length&&this[M].forEach(w=>this[x](w.key,w.value)),this[v]=new Map,this[M]=new Y,this[k]=0}dump(){return this[M].map(w=>!O(this,w)&&{k:w.key,v:w.value,e:w.now+(w.maxAge||0)}).toArray().filter(w=>w)}dumpLru(){return this[M]}set(w,G,Q){if((Q=Q||this[b])&&"number"!=typeof Q)throw new TypeError("maxAge must be a number");const oe=Q?Date.now():0,se=this[ie](G,w);if(this[v].has(w)){if(se>this[U])return ce(this,this[v].get(w)),!1;const me=this[v].get(w).value;return this[x]&&(this[N]||this[x](w,me.value)),me.now=oe,me.maxAge=Q,me.value=G,this[k]+=se-me.length,me.length=se,this.get(w),q(this),!0}const ee=new D(w,G,se,oe,Q);return ee.length>this[U]?(this[x]&&this[x](w,G),!1):(this[k]+=ee.length,this[M].unshift(ee),this[v].set(w,this[M].head),q(this),!0)}has(w){if(!this[v].has(w))return!1;const G=this[v].get(w).value;return!O(this,G)}get(w){return j(this,w,!0)}peek(w){return j(this,w,!1)}pop(){const w=this[M].tail;return w?(ce(this,w),w.value):null}del(w){ce(this,this[v].get(w))}load(w){this.reset();const G=Date.now();for(let Q=w.length-1;Q>=0;Q--){const oe=w[Q],se=oe.e||0;if(0===se)this.set(oe.k,oe.v);else{const ee=se-G;ee>0&&this.set(oe.k,oe.v,ee)}}}prune(){this[v].forEach((w,G)=>j(this,G,!1))}}},{yallist:92}],34:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;const Y="http://www.w3.org/1999/02/22-rdf-syntax-ns#",U="http://www.w3.org/2001/XMLSchema#",k="http://www.w3.org/2000/10/swap/";pe.default={xsd:{decimal:`${U}decimal`,boolean:`${U}boolean`,double:`${U}double`,integer:`${U}integer`,string:`${U}string`},rdf:{type:`${Y}type`,nil:`${Y}nil`,first:`${Y}first`,rest:`${Y}rest`,langString:`${Y}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${k}reify#forSome`,forAll:`${k}reify#forAll`},log:{implies:`${k}log#implies`}}},{}],35:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=pe.Variable=pe.Triple=pe.Term=pe.Quad=pe.NamedNode=pe.Literal=pe.DefaultGraph=pe.BlankNode=void 0,pe.escapeQuotes=w,pe.termFromId=function D(te,_e){if(_e=_e||v,!te)return _e.defaultGraph();switch(te[0]){case"?":return _e.variable(te.substr(1));case"_":return _e.blankNode(te.substr(2));case'"':if(_e===v)return new j(te);if('"'===te[te.length-1])return _e.literal(te.substr(1,te.length-2));const Oe=te.lastIndexOf('"',te.length-1);return _e.literal(te.substr(1,Oe-1),"@"===te[Oe+1]?te.substr(Oe+2):_e.namedNode(te.substr(Oe+3)));case"<":const Ge=M.exec(te);return _e.quad(D(G(Ge[1]),_e),D(G(Ge[2]),_e),D(G(Ge[3]),_e),Ge[4]&&D(G(Ge[4]),_e));default:return _e.namedNode(te)}},pe.termToId=function I(te){if("string"==typeof te)return te;if(te instanceof S&&"Quad"!==te.termType)return te.id;if(!te)return b.id;switch(te.termType){case"NamedNode":return te.value;case"BlankNode":return`_:${te.value}`;case"Variable":return`?${te.value}`;case"DefaultGraph":return"";case"Literal":return`"${te.value}"${te.language?`@${te.language}`:te.datatype&&te.datatype.value!==W.string?`^^${te.datatype.value}`:""}`;case"Quad":return`<<${w(I(te.subject))} ${w(I(te.predicate))} ${w(I(te.object))}${(0,U.isDefaultGraph)(te.graph)?"":` ${I(te.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${te.termType}`)}},pe.unescapeQuotes=G;var te,Y=(te=K("./IRIs"))&&te.__esModule?te:{default:te},U=K("./N3Util");const{rdf:ie,xsd:W}=Y.default;let b,x=0;const N=/^"(.*".*)(?="[^"]*$)/,M=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,v={namedNode:function(te){return new T(te)},blankNode:function(te){return new O(te||"n3-"+x++)},variable:function(te){return new q(te)},literal:function(te,_e){if("string"==typeof _e)return new j(`"${te}"@${_e.toLowerCase()}`);let Oe=_e?_e.value:"";return""===Oe&&("boolean"==typeof te?Oe=W.boolean:"number"==typeof te&&(Number.isFinite(te)?Oe=Number.isInteger(te)?W.integer:W.double:(Oe=W.double,Number.isNaN(te)||(te=te>0?"INF":"-INF")))),new j(""===Oe||Oe===W.string?`"${te}"`:`"${te}"^^${Oe}`)},defaultGraph:function(){return b},quad:me,triple:me};pe.default=v;class S{constructor(_e){this.id=_e}get value(){return this.id}equals(_e){return _e instanceof S?this.id===_e.id:!!_e&&this.termType===_e.termType&&this.value===_e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}pe.Term=S;class T extends S{get termType(){return"NamedNode"}}pe.NamedNode=T;class j extends S{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const _e=this.id;let Oe=_e.lastIndexOf('"')+1;return Oe<_e.length&&"@"===_e[Oe++]?_e.substr(Oe).toLowerCase():""}get datatype(){return new T(this.datatypeString)}get datatypeString(){const _e=this.id,Oe=_e.lastIndexOf('"')+1,Ge=Oe<_e.length?_e[Oe]:"";return"^"===Ge?_e.substr(Oe+2):"@"!==Ge?W.string:ie.langString}equals(_e){return _e instanceof j?this.id===_e.id:!!_e&&!!_e.datatype&&this.termType===_e.termType&&this.value===_e.value&&this.language===_e.language&&this.datatype.value===_e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}pe.Literal=j;class O extends S{constructor(_e){super(`_:${_e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}pe.BlankNode=O;class q extends S{constructor(_e){super(`?${_e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}pe.Variable=q;class ce extends S{constructor(){return super(""),b||this}get termType(){return"DefaultGraph"}equals(_e){return this===_e||!!_e&&this.termType===_e.termType}}pe.DefaultGraph=ce,b=new ce;class X extends S{constructor(_e,Oe,Ge,rt){super(""),this._subject=_e,this._predicate=Oe,this._object=Ge,this._graph=rt||b}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(_e){return!!_e&&this._subject.equals(_e.subject)&&this._predicate.equals(_e.predicate)&&this._object.equals(_e.object)&&this._graph.equals(_e.graph)}}function w(te){return te.replace(N,(_e,Oe)=>`"${Oe.replace(/"/g,'""')}`)}function G(te){return te.replace(N,(_e,Oe)=>`"${Oe.replace(/""/g,'"')}`)}function me(te,_e,Oe,Ge){return new X(te,_e,Oe,Ge)}pe.Triple=pe.Quad=X},{"./IRIs":34,"./N3Util":41}],36:[function(K,Ae,pe){(function(Y){(function(){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var U=ie(K("./IRIs")),k=ie(K("queue-microtask"));function ie(S){return S&&S.__esModule?S:{default:S}}const{xsd:W}=U.default,b=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,x={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},N=/[\x00-\x20<>\\"\{\}\|\^\`]/,M={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},v=/$0^/;pe.default=class{constructor(T){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,this._lineMode=!!(T=T||{}).lineMode){this._n3Mode=!1;for(const j in this)!(j in M)&&this[j]instanceof RegExp&&(this[j]=v)}else this._n3Mode=!1!==T.n3;this._comments=!!T.comments,this._literalClosingPos=0}_tokenizeToEnd(T,j){let O=this._input,q=O.length;for(;;){let I,X;for(;I=this._newline.exec(O);)this._comments&&(X=this._comment.exec(I[0]))&&ce("comment",X[1],"",this._line,I[0].length),O=O.substr(I[0].length,O.length),q=O.length,this._line++;if(!I&&(I=this._whitespace.exec(O))&&(O=O.substr(I[0].length,O.length)),this._endOfFile.test(O))return j&&(this._comments&&(X=this._comment.exec(O))&&ce("comment",X[1],"",this._line,O.length),O=null,ce("eof","","",this._line,0)),this._input=O;const w=this._line,G=O[0];let Q="",oe="",se="",ee=null,Se=0,me=!1;switch(G){case"^":if(O.length<3)break;if("^"!==O[1]){this._n3Mode&&(Se=1,Q="^");break}if(this._previousMarker="^^",O=O.substr(2),"<"!==O[0]){me=!0;break}case"<":if(ee=this._unescapedIri.exec(O))Q="IRI",oe=ee[1];else if(ee=this._iri.exec(O)){if(oe=this._unescape(ee[1]),null===oe||N.test(oe))return D(this);Q="IRI"}else O.length>1&&"<"===O[1]?(Q="<<",Se=2):this._n3Mode&&O.length>1&&"="===O[1]&&(Q="inverse",Se=2,oe=">");break;case">":O.length>1&&">"===O[1]&&(Q=">>",Se=2);break;case"_":((ee=this._blank.exec(O))||j&&(ee=this._blank.exec(`${O} `)))&&(Q="blank",se="_",oe=ee[1]);break;case'"':if(ee=this._simpleQuotedString.exec(O))oe=ee[1];else if(({value:oe,matchLength:Se}=this._parseLiteral(O)),null===oe)return D(this);(null!==ee||0!==Se)&&(Q="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(ee=this._simpleApostropheString.exec(O))oe=ee[1];else if(({value:oe,matchLength:Se}=this._parseLiteral(O)),null===oe)return D(this);(null!==ee||0!==Se)&&(Q="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(ee=this._variable.exec(O))&&(Q="var",oe=ee[0]);break;case"@":"literal"===this._previousMarker&&(ee=this._langcode.exec(O))?(Q="langcode",oe=ee[1]):(ee=this._keyword.exec(O))&&(Q=ee[0]);break;case".":if(1===O.length?j:O[1]<"0"||O[1]>"9"){Q=".",Se=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(ee=this._number.exec(O)||j&&(ee=this._number.exec(`${O} `)))&&(Q="literal",oe=ee[0],se="string"==typeof ee[1]?W.double:"string"==typeof ee[2]?W.decimal:W.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(ee=this._sparqlKeyword.exec(O))?Q=ee[0].toUpperCase():me=!0;break;case"f":case"t":(ee=this._boolean.exec(O))?(Q="literal",oe=ee[0],se=W.boolean):me=!0;break;case"a":(ee=this._shortPredicates.exec(O))?(Q="abbreviation",oe="a"):me=!0;break;case"=":this._n3Mode&&O.length>1&&(Q="abbreviation",">"!==O[1]?(Se=1,oe="="):(Se=2,oe=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(Se=1,Q=G);break;default:me=!0}if(me&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(ee=this._prefix.exec(O))?((ee=this._prefixed.exec(O))||j&&(ee=this._prefixed.exec(`${O} `)))&&(Q="prefixed",se=ee[1]||"",oe=this._unescape(ee[2])):(Q="prefix",oe=ee[1]||"")),"^^"===this._previousMarker)switch(Q){case"prefixed":Q="type";break;case"IRI":Q="typeIRI";break;default:Q=""}if(!Q)return j||!/^'''|^"""/.test(O)&&/\n|\r/.test(O)?D(this):this._input=O;const te=Se||ee[0].length,_e=ce(Q,oe,se,w,te);this.previousToken=_e,this._previousMarker=Q,O=O.substr(te,O.length)}function ce(I,X,w,G,Q){const oe=O?q-O.length:q,ee={type:I,value:X,prefix:w,line:G,start:oe,end:oe+Q};return T(null,ee),ee}function D(I){T(I._syntaxError(/^\S*/.exec(O)[0]))}}_unescape(T){let j=!1;const O=T.replace(b,(q,ce,D,I)=>{if("string"==typeof ce)return String.fromCharCode(Number.parseInt(ce,16));if("string"==typeof D){let X=Number.parseInt(D,16);return X<=65535?String.fromCharCode(Number.parseInt(D,16)):String.fromCharCode(55296+((X-=65536)>>10),56320+(1023&X))}return I in x?x[I]:(j=!0,"")});return j?null:O}_parseLiteral(T){if(T.length>=3){const j=T.match(/^(?:"""|"|'''|'|)/)[0],O=j.length;let q=Math.max(this._literalClosingPos,O);for(;(q=T.indexOf(j,q))>0;){let ce=0;for(;"\\"===T[q-ce-1];)ce++;if(ce%2==0){const D=T.substring(O,q),I=D.split(/\r\n|\r|\n/).length-1,X=q+O;if(1===O&&0!==I||3===O&&this._lineMode)break;return this._line+=I,{value:this._unescape(D),matchLength:X}}q++}this._literalClosingPos=T.length-O+1}return{value:"",matchLength:0}}_syntaxError(T){this._input=null;const j=new Error(`Unexpected "${T}" on line ${this._line}.`);return j.context={token:void 0,line:this._line,previousToken:this.previousToken},j}_readStartingBom(T){return T.startsWith("\ufeff")?T.substr(1):T}tokenize(T,j){if(this._line=1,"string"==typeof T){if(this._input=this._readStartingBom(T),"function"!=typeof j){const O=[];let q;if(this._tokenizeToEnd((ce,D)=>ce?q=ce:O.push(D),!0),q)throw q;return O}(0,k.default)(()=>this._tokenizeToEnd(j,!0))}else this._pendingBuffer=null,"function"==typeof T.setEncoding&&T.setEncoding("utf8"),T.on("data",O=>{null!==this._input&&0!==O.length&&(this._pendingBuffer&&(O=Y.concat([this._pendingBuffer,O]),this._pendingBuffer=null),128&O[O.length-1]?this._pendingBuffer=O:(void 0===this._input?this._input=this._readStartingBom("string"==typeof O?O:O.toString()):this._input+=O,this._tokenizeToEnd(j,!1)))}),T.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(j,!0)}),T.on("error",j)}}}).call(this)}).call(this,K("buffer").Buffer)},{"./IRIs":34,buffer:6,"queue-microtask":45}],37:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var Y=ie(K("./N3Lexer")),U=ie(K("./N3DataFactory")),k=ie(K("./IRIs"));function ie(M){return M&&M.__esModule?M:{default:M}}let W=0;class b{constructor(v){this._contextStack=[],this._graph=null,this._setBase((v=v||{}).baseIRI),v.factory&&N(this,v.factory);const y="string"==typeof v.format?v.format.match(/\w*$/)[0].toLowerCase():"",S=/turtle/.test(y),T=/trig/.test(y),j=/triple/.test(y),O=/quad/.test(y),q=this._n3Mode=/n3/.test(y),ce=j||O;(this._supportsNamedGraphs=!(S||q))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(S||T||j||q),this._supportsRDFStar=""===y||/star|\*$/.test(y),ce&&(this._resolveRelativeIRI=D=>null),this._blankNodePrefix="string"!=typeof v.blankNodePrefix?"":v.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=v.lexer||new Y.default({lineMode:ce,n3:q}),this._explicitQuantifiers=!!v.explicitQuantifiers}static _resetBlankNodePrefix(){W=0}_setBase(v){if(v){const y=v.indexOf("#");y>=0&&(v=v.substr(0,y)),this._base=v,this._basePath=v.indexOf("/")<0?v:v.replace(/[^\/?]*(?:\?.*)?$/,""),v=v.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=v[0],this._baseScheme=v[1]}else this._base="",this._basePath=""}_saveContext(v,y,S,T,j){const O=this._n3Mode;this._contextStack.push({subject:S,predicate:T,object:j,graph:y,type:v,inverse:!!O&&this._inversePredicate,blankPrefix:O?this._prefixes._:"",quantified:O?this._quantified:null}),O&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const v=this._contextStack.pop(),y=this._n3Mode;this._subject=v.subject,this._predicate=v.predicate,this._object=v.object,this._graph=v.graph,y&&(this._inversePredicate=v.inverse,this._prefixes._=v.blankPrefix,this._quantified=v.quantified)}_readInTopContext(v){switch(v.type){case"eof":return null!==this._graph?this._error("Unclosed graph",v):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(v)}}_readEntity(v,y){let S;switch(v.type){case"IRI":case"typeIRI":const T=this._resolveIRI(v.value);if(null===T)return this._error("Invalid IRI",v);S=this._namedNode(T);break;case"type":case"prefixed":const j=this._prefixes[v.prefix];if(void 0===j)return this._error(`Undefined prefix "${v.prefix}:"`,v);S=this._namedNode(j+v.value);break;case"blank":S=this._blankNode(this._prefixes[v.prefix]+v.value);break;case"var":S=this._variable(v.value.substr(1));break;default:return this._error(`Expected entity but got ${v.type}`,v)}return!y&&this._n3Mode&&S.id in this._quantified&&(S=this._quantified[S.id]),S}_readSubject(v){switch(this._predicate=null,v.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",v);case"}":return this._readPunctuation(v);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',v);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',v);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",v);if(0===v.prefix.length)return this._literalValue=v.value,this._completeSubjectLiteral;this._subject=this._literal(v.value,this._namedNode(v.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._subject=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(v){const y=v.type;switch(y){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[v.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${y}`,v):(this._subject=null,"]"===y?this._readBlankNodeTail(v):this._readPunctuation(v));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",v);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",v);default:if(void 0===(this._predicate=this._readEntity(v)))return}return this._readObject}_readObject(v){switch(v.type){case"literal":if(0===v.prefix.length)return this._literalValue=v.value,this._readDataTypeOrLang;this._object=this._literal(v.value,this._namedNode(v.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",v);default:if(void 0===(this._object=this._readEntity(v)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(v){return"{"===v.type?this._readGraph(v):this._readPredicate(v)}_readGraph(v){return"{"!==v.type?this._error(`Expected graph but got ${v.type}`,v):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(v){return"]"===v.type?(this._subject=null,this._readBlankNodeTail(v)):(this._predicate=null,this._readPredicate(v))}_readBlankNodeTail(v){if("]"!==v.type)return this._readBlankNodePunctuation(v);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const y=null===this._predicate;return this._restoreContext(),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:y?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(v){switch(v.type){case".":case"}":return this._subject=null,this._readPunctuation(v);default:return this._readPredicate(v)}}_readListItem(v){let y=null,S=null,T=this._readListItem;const j=this._subject,O=this._contextStack,q=O[O.length-1];switch(v.type){case"[":this._saveContext("blank",this._graph,S=this._blankNode(),this.RDF_FIRST,this._subject=y=this._blankNode()),T=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,S=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==O.length&&"list"===O[O.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(T=this._readPredicate,this._subject===this.RDF_NIL)return T}else if(T=this._getContextEndReader(),this._object===this.RDF_NIL)return T;S=this.RDF_NIL;break;case"literal":0===v.prefix.length?(this._literalValue=v.value,T=this._readListItemDataTypeOrLang):(y=this._literal(v.value,this._namedNode(v.prefix)),T=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",v);default:if(void 0===(y=this._readEntity(v)))return}if(null===S&&(this._subject=S=this._blankNode()),null===j?null===q.predicate?q.subject=S:q.object=S:this._emit(j,this.RDF_REST,S,this._graph),null!==y){if(this._n3Mode&&("IRI"===v.type||"prefixed"===v.type))return this._saveContext("item",this._graph,S,this.RDF_FIRST,y),this._subject=y,this._predicate=null,this._getPathReader(this._readListItem);this._emit(S,this.RDF_FIRST,y,this._graph)}return T}_readDataTypeOrLang(v){return this._completeObjectLiteral(v,!1)}_readListItemDataTypeOrLang(v){return this._completeObjectLiteral(v,!0)}_completeLiteral(v){let y=this._literal(this._literalValue);switch(v.type){case"type":case"typeIRI":const S=this._readEntity(v);if(void 0===S)return;y=this._literal(this._literalValue,S),v=null;break;case"langcode":y=this._literal(this._literalValue,v.value),v=null}return{token:v,literal:y}}_completeSubjectLiteral(v){return this._subject=this._completeLiteral(v).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(v,y){const S=this._completeLiteral(v);if(S)return this._object=S.literal,y&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===S.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(S.token))}_readFormulaTail(v){return"}"!==v.type?this._readPunctuation(v):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(v){let y,S=this._graph;const T=this._subject,j=this._inversePredicate;switch(v.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",v);if(this._n3Mode)return this._readFormulaTail(v);this._graph=null;case".":this._subject=null,y=this._contextStack.length?this._readSubject:this._readInTopContext,j&&(this._inversePredicate=!1);break;case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(S=this._readEntity(v))){y=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}if(null!==T){const O=this._predicate,q=this._object;j?this._emit(q,O,T,S):this._emit(T,O,q,S)}return y}_readBlankNodePunctuation(v){let y;switch(v.type){case";":y=this._readPredicate;break;case",":y=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,v)}return this._emit(this._subject,this._predicate,this._object,this._graph),y}_readQuadPunctuation(v){return"."!==v.type?this._error("Expected dot to follow quad",v):this._readInTopContext}_readPrefix(v){return"prefix"!==v.type?this._error("Expected prefix to follow @prefix",v):(this._prefix=v.value,this._readPrefixIRI)}_readPrefixIRI(v){if("IRI"!==v.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,v);const y=this._readEntity(v);return this._prefixes[this._prefix]=y.value,this._prefixCallback(this._prefix,y),this._readDeclarationPunctuation}_readBaseIRI(v){const y="IRI"===v.type&&this._resolveIRI(v.value);return y?(this._setBase(y),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",v)}_readNamedGraphLabel(v){switch(v.type){case"IRI":case"blank":case"prefixed":return this._readSubject(v),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",v)}}_readNamedGraphBlankLabel(v){return"]"!==v.type?this._error("Invalid graph label",v):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(v){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(v)):"."!==v.type?this._error("Expected declaration to end with a dot",v):this._readInTopContext}_readQuantifierList(v){let y;switch(v.type){case"IRI":case"prefixed":if(void 0!==(y=this._readEntity(v,!0)))break;default:return this._error(`Unexpected ${v.type}`,v)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,y,this.QUANTIFIERS_GRAPH)):this._quantified[y.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(v){return","===v.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(v))}_getPathReader(v){return this._afterPath=v,this._readPath}_readPath(v){switch(v.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const y=this._contextStack,S=y.length&&y[y.length-1];if(S&&"item"===S.type){const T=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,T,this._graph)}return this._afterPath(v)}}_readForwardPath(v){let y,S;const T=this._blankNode();if(void 0!==(S=this._readEntity(v)))return null===this._predicate?(y=this._subject,this._subject=T):(y=this._object,this._object=T),this._emit(y,S,T,this._graph),this._readPath}_readBackwardPath(v){const y=this._blankNode();let S,T;if(void 0!==(S=this._readEntity(v)))return null===this._predicate?(T=this._subject,this._subject=y):(T=this._object,this._object=y),this._emit(y,S,T,this._graph),this._readPath}_readRDFStarTailOrGraph(v){return">>"!==v.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(v))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,v):this._readRDFStarTail(v)}_readRDFStarTail(v){if(">>"!==v.type)return this._error(`Expected >> but got ${v.type}`,v);const y=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=y,this._readPredicate):(this._object=y,this._getContextEndReader())}_getContextEndReader(){const v=this._contextStack;if(!v.length)return this._readPunctuation;switch(v[v.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(v,y,S,T){this._callback(null,this._quad(v,y,S,T||this.DEFAULTGRAPH))}_error(v,y){const S=new Error(`${v} on line ${y.line}.`);S.context={token:y,line:y.line,previousToken:this._lexer.previousToken},this._callback(S),this._callback=x}_resolveIRI(v){return/^[a-z][a-z0-9+.-]*:/i.test(v)?v:this._resolveRelativeIRI(v)}_resolveRelativeIRI(v){if(!v.length)return this._base;switch(v[0]){case"#":return this._base+v;case"?":return this._base.replace(/(?:\?.*)?$/,v);case"/":return("/"===v[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(v);default:return/^[^/:]*:/.test(v)?null:this._removeDotSegments(this._basePath+v)}}_removeDotSegments(v){if(!/(^|\/)\.\.?($|[/#?])/.test(v))return v;const y=v.length;let S="",T=-1,j=-1,O=0,q="/";for(;T<y;){switch(q){case":":if(j<0&&"/"===v[++T]&&"/"===v[++T])for(;(j=T+1)<y&&"/"!==v[j];)T=j;break;case"?":case"#":T=y;break;case"/":if("."===v[T+1])switch(q=v[1+ ++T],q){case"/":S+=v.substring(O,T-1),O=T+1;break;case void 0:case"?":case"#":return S+v.substring(O,T)+v.substr(T+1);case".":if(q=v[1+ ++T],void 0===q||"/"===q||"?"===q||"#"===q){if(S+=v.substring(O,T-2),(O=S.lastIndexOf("/"))>=j&&(S=S.substr(0,O)),"/"!==q)return`${S}/${v.substr(T+1)}`;O=T+1}}}q=v[++T]}return S+v.substring(O)}parse(v,y,S){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${W++}_`,this._prefixCallback=S||x,this._inversePredicate=!1,this._quantified=Object.create(null),!y){const T=[];let j;if(this._callback=(O,q)=>{O?j=O:q&&T.push(q)},this._lexer.tokenize(v).every(O=>this._readCallback=this._readCallback(O)),j)throw j;return T}this._callback=y,this._lexer.tokenize(v,(T,j)=>{null!==T?(this._callback(T),this._callback=x):this._readCallback&&(this._readCallback=this._readCallback(j))})}}function x(){}function N(M,v){const y=v.namedNode;M._namedNode=y,M._blankNode=v.blankNode,M._literal=v.literal,M._variable=v.variable,M._quad=v.quad,M.DEFAULTGRAPH=v.defaultGraph(),M.RDF_FIRST=y(k.default.rdf.first),M.RDF_REST=y(k.default.rdf.rest),M.RDF_NIL=y(k.default.rdf.nil),M.N3_FORALL=y(k.default.r.forAll),M.N3_FORSOME=y(k.default.r.forSome),M.ABBREVIATIONS={a:y(k.default.rdf.type),"=":y(k.default.owl.sameAs),">":y(k.default.log.implies)},M.QUANTIFIERS_GRAPH=y("urn:n3:quantifiers")}pe.default=b,N(b.prototype,U.default)},{"./IRIs":34,"./N3DataFactory":35,"./N3Lexer":36}],38:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var v,Y=function(v,y){if(!y&&v&&v.__esModule)return v;if(null===v||"object"!=typeof v&&"function"!=typeof v)return{default:v};var S=W(y);if(S&&S.has(v))return S.get(v);var T={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in v)if("default"!==O&&Object.prototype.hasOwnProperty.call(v,O)){var q=j?Object.getOwnPropertyDescriptor(v,O):null;q&&(q.get||q.set)?Object.defineProperty(T,O,q):T[O]=v[O]}return T.default=v,S&&S.set(v,T),T}(K("./N3DataFactory")),U=K("readable-stream"),k=(v=K("./IRIs"))&&v.__esModule?v:{default:v};function W(v){if("function"!=typeof WeakMap)return null;var y=new WeakMap,S=new WeakMap;return(W=function(T){return T?S:y})(v)}class x{constructor(y,S){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,!S&&y&&!y[0]&&(S=y,y=null),this._factory=(S=S||{}).factory||Y.default,y&&this.addQuads(y)}get size(){let y=this._size;if(null!==y)return y;y=0;const S=this._graphs;let T,j;for(const O in S)for(const q in T=S[O].subjects)for(const ce in j=T[q])y+=Object.keys(j[ce]).length;return this._size=y}_addToIndex(y,S,T,j){const O=y[S]||(y[S]={}),q=O[T]||(O[T]={}),ce=j in q;return ce||(q[j]=null),!ce}_removeFromIndex(y,S,T,j){const O=y[S],q=O[T];delete q[j];for(const ce in q)return;delete O[T];for(const ce in O)return;delete y[S]}*_findInIndex(y,S,T,j,O,q,ce,D){let I,X,w;const Q=!S+!T+!j>1?Object.keys(this._ids):this._entities,oe=(0,Y.termFromId)(D,this._factory);S&&((I=y,y={})[S]=I[S]);for(const se in y){const ee=Q[se];if(X=y[se]){T&&((I=X,X={})[T]=I[T]);for(const Se in X){const me=Q[Se];if(w=X[Se]){const te=j?j in w?[j]:[]:Object.keys(w);for(let _e=0;_e<te.length;_e++){const Oe={subject:null,predicate:null,object:null};Oe[O]=(0,Y.termFromId)(ee,this._factory),Oe[q]=(0,Y.termFromId)(me,this._factory),Oe[ce]=(0,Y.termFromId)(Q[te[_e]],this._factory),yield this._factory.quad(Oe.subject,Oe.predicate,Oe.object,oe)}}}}}}_loop(y,S){for(const T in y)S(T)}_loopByKey0(y,S,T){let j,O;if(j=y[S])for(O in j)T(O)}_loopByKey1(y,S,T){let j,O;for(j in y)O=y[j],O[S]&&T(j)}_loopBy2Keys(y,S,T,j){let O,q,ce;if((O=y[S])&&(q=O[T]))for(ce in q)j(ce)}_countInIndex(y,S,T,j){let q,ce,D,O=0;S&&((q=y,y={})[S]=q[S]);for(const I in y)if(ce=y[I]){T&&((q=ce,ce={})[T]=q[T]);for(const X in ce)(D=ce[X])&&(j?j in D&&O++:O+=Object.keys(D).length)}return O}_getGraphs(y){if(!N(y))return this._graphs;const S={};return S[y]=this._graphs[y],S}_uniqueEntities(y){const S=Object.create(null);return T=>{T in S||(S[T]=!0,y((0,Y.termFromId)(this._entities[T],this._factory)))}}add(y){return this.addQuad(y),this}addQuad(y,S,T,j){S||(j=y.graph,T=y.object,S=y.predicate,y=y.subject),y=(0,Y.termToId)(y),S=(0,Y.termToId)(S),T=(0,Y.termToId)(T),j=(0,Y.termToId)(j);let O=this._graphs[j];O||(O=this._graphs[j]={subjects:{},predicates:{},objects:{}},Object.freeze(O));const q=this._ids,ce=this._entities;y=q[y]||(q[ce[++this._id]=y]=this._id),S=q[S]||(q[ce[++this._id]=S]=this._id),T=q[T]||(q[ce[++this._id]=T]=this._id);const D=this._addToIndex(O.subjects,y,S,T);return this._addToIndex(O.predicates,S,T,y),this._addToIndex(O.objects,T,y,S),this._size=null,D}addQuads(y){for(let S=0;S<y.length;S++)this.addQuad(y[S])}delete(y){return this.removeQuad(y),this}has(y,S,T,j){return y&&y.subject&&({subject:y,predicate:S,object:T,graph:j}=y),!this.readQuads(y,S,T,j).next().done}import(y){return y.on("data",S=>{this.addQuad(S)}),y}removeQuad(y,S,T,j){S||(j=y.graph,T=y.object,S=y.predicate,y=y.subject),y=(0,Y.termToId)(y),S=(0,Y.termToId)(S),T=(0,Y.termToId)(T),j=(0,Y.termToId)(j);const O=this._ids,q=this._graphs;let ce,D,I;if(!((y=O[y])&&(S=O[S])&&(T=O[T])&&(ce=q[j])&&(D=ce.subjects[y])&&(I=D[S])&&T in I))return!1;for(y in this._removeFromIndex(ce.subjects,y,S,T),this._removeFromIndex(ce.predicates,S,T,y),this._removeFromIndex(ce.objects,T,y,S),null!==this._size&&this._size--,ce.subjects)return!0;return delete q[j],!0}removeQuads(y){for(let S=0;S<y.length;S++)this.removeQuad(y[S])}remove(y){return y.on("data",S=>{this.removeQuad(S)}),y}removeMatches(y,S,T,j){const O=new U.Readable({objectMode:!0});return O._read=()=>{for(const q of this.readQuads(y,S,T,j))O.push(q);O.push(null)},this.remove(O)}deleteGraph(y){return this.removeMatches(null,null,null,y)}getQuads(y,S,T,j){return[...this.readQuads(y,S,T,j)]}*readQuads(y,S,T,j){y=y&&(0,Y.termToId)(y),S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const O=this._getGraphs(j),q=this._ids;let ce,D,I,X;if(!(N(y)&&!(D=q[y])||N(S)&&!(I=q[S])||N(T)&&!(X=q[T])))for(const w in O)(ce=O[w])&&(D?X?yield*this._findInIndex(ce.objects,X,D,I,"object","subject","predicate",w,null,!0):yield*this._findInIndex(ce.subjects,D,I,null,"subject","predicate","object",w,null,!0):I?yield*this._findInIndex(ce.predicates,I,X,null,"predicate","object","subject",w,null,!0):X?yield*this._findInIndex(ce.objects,X,null,null,"object","subject","predicate",w,null,!0):yield*this._findInIndex(ce.subjects,null,null,null,"subject","predicate","object",w,null,!0))}match(y,S,T,j){return new M(this,y,S,T,j)}countQuads(y,S,T,j){y=y&&(0,Y.termToId)(y),S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const O=this._getGraphs(j),q=this._ids;let D,I,X,w,ce=0;if(N(y)&&!(I=q[y])||N(S)&&!(X=q[S])||N(T)&&!(w=q[T]))return 0;for(const G in O)(D=O[G])&&(ce+=y?T?this._countInIndex(D.objects,w,I,X):this._countInIndex(D.subjects,I,X,w):S?this._countInIndex(D.predicates,X,w,I):this._countInIndex(D.objects,w,I,X));return ce}forEach(y,S,T,j,O){this.some(q=>(y(q),!1),S,T,j,O)}every(y,S,T,j,O){let q=!1;const ce=!this.some(D=>(q=!0,!y(D)),S,T,j,O);return q&&ce}some(y,S,T,j,O){for(const q of this.readQuads(S,T,j,O))if(y(q))return!0;return!1}getSubjects(y,S,T){const j=[];return this.forSubjects(O=>{j.push(O)},y,S,T),j}forSubjects(y,S,T,j){S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const O=this._ids,q=this._getGraphs(j);let ce,D,I;if(y=this._uniqueEntities(y),!(N(S)&&!(D=O[S])||N(T)&&!(I=O[T])))for(j in q)(ce=q[j])&&(D?I?this._loopBy2Keys(ce.predicates,D,I,y):this._loopByKey1(ce.subjects,D,y):I?this._loopByKey0(ce.objects,I,y):this._loop(ce.subjects,y))}getPredicates(y,S,T){const j=[];return this.forPredicates(O=>{j.push(O)},y,S,T),j}forPredicates(y,S,T,j){S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const O=this._ids,q=this._getGraphs(j);let ce,D,I;if(y=this._uniqueEntities(y),!(N(S)&&!(D=O[S])||N(T)&&!(I=O[T])))for(j in q)(ce=q[j])&&(D?I?this._loopBy2Keys(ce.objects,I,D,y):this._loopByKey0(ce.subjects,D,y):I?this._loopByKey1(ce.predicates,I,y):this._loop(ce.predicates,y))}getObjects(y,S,T){const j=[];return this.forObjects(O=>{j.push(O)},y,S,T),j}forObjects(y,S,T,j){S=S&&(0,Y.termToId)(S),T=T&&(0,Y.termToId)(T),j=j&&(0,Y.termToId)(j);const O=this._ids,q=this._getGraphs(j);let ce,D,I;if(y=this._uniqueEntities(y),!(N(S)&&!(D=O[S])||N(T)&&!(I=O[T])))for(j in q)(ce=q[j])&&(D?I?this._loopBy2Keys(ce.subjects,D,I,y):this._loopByKey1(ce.objects,D,y):I?this._loopByKey0(ce.predicates,I,y):this._loop(ce.objects,y))}getGraphs(y,S,T){const j=[];return this.forGraphs(O=>{j.push(O)},y,S,T),j}forGraphs(y,S,T,j){for(const O in this._graphs)this.some(q=>(y(q.graph),!0),S,T,j,O)}createBlankNode(y){let S,T;if(y)for(S=y=`_:${y}`,T=1;this._ids[S];)S=y+T++;else do{S="_:b"+this._blankNodeIndex++}while(this._ids[S]);return this._ids[S]=++this._id,this._entities[this._id]=S,this._factory.blankNode(S.substr(2))}extractLists({remove:y=!1,ignoreErrors:S=!1}={}){const T={},j=S?()=>!0:(ce,D)=>{throw new Error(`${ce.value} ${D}`)},O=this.getQuads(null,k.default.rdf.rest,k.default.rdf.nil,null),q=y?[...O]:[];return O.forEach(ce=>{const D=[];let X,w,I=!1;const G=ce.graph;let Q=ce.subject;for(;Q&&!I;){const oe=this.getQuads(null,null,Q,null),se=this.getQuads(Q,null,null,null);let ee,Se=null,me=null,te=null;for(let _e=0;_e<se.length&&!I;_e++)ee=se[_e],ee.graph.equals(G)?X?I=j(Q,"has non-list arcs out"):ee.predicate.value===k.default.rdf.first?Se?I=j(Q,"has multiple rdf:first arcs"):q.push(Se=ee):ee.predicate.value===k.default.rdf.rest?me?I=j(Q,"has multiple rdf:rest arcs"):q.push(me=ee):oe.length?I=j(Q,"can't be subject and object"):(X=ee,w="subject"):I=j(Q,"not confined to single graph");for(let _e=0;_e<oe.length&&!I;++_e)ee=oe[_e],X?I=j(Q,"can't have coreferences"):ee.predicate.value===k.default.rdf.rest?te?I=j(Q,"has incoming rdf:rest arcs"):te=ee:(X=ee,w="object");Se?D.unshift(Se.object):I=j(Q,"has no list head"),Q=te&&te.subject}I?y=!1:X&&(T[X[w].value]=D)}),y&&this.removeQuads(q),T}*[Symbol.iterator](){yield*this.readQuads()}}function N(v){return"string"==typeof v||v instanceof String}pe.default=x;class M extends U.Readable{constructor(y,S,T,j,O){super({objectMode:!0}),Object.assign(this,{n3Store:y,subject:S,predicate:T,object:j,graph:O})}get filtered(){if(!this._filtered){const{n3Store:y,graph:S,object:T,predicate:j,subject:O}=this,q=y.getQuads(O,j,T,S);this._filtered=new x(q,{factory:y._factory})}return this._filtered}get size(){return this.filtered.size}_read(){for(const y of this)this.push(y);this.push(null)}add(y){return this.filtered.add(y)}delete(y){return this.filtered.delete(y)}has(y){return this.filtered.has(y)}match(y,S,T,j){return new M(this.filtered,y,S,T,j)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}},{"./IRIs":34,"./N3DataFactory":35,"readable-stream":81}],39:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var W,Y=(W=K("./N3Parser"))&&W.__esModule?W:{default:W},U=K("readable-stream");pe.default=class extends U.Transform{constructor(b){let N,M;super({decodeStrings:!0}),this._readableState.objectMode=!0,new Y.default(b).parse({on:(v,y)=>{switch(v){case"data":N=y;break;case"end":M=y}}},(v,y)=>{v&&this.emit("error",v)||y&&this.push(y)},(v,y)=>{this.emit("prefix",v,y)}),this._transform=(v,y,S)=>{N(v),S()},this._flush=v=>{M(),v()}}import(b){return b.on("data",x=>{this.write(x)}),b.on("end",()=>{this.end()}),b.on("error",x=>{this.emit("error",x)}),this}}},{"./N3Parser":37,"readable-stream":81}],40:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var W,Y=K("readable-stream"),U=(W=K("./N3Writer"))&&W.__esModule?W:{default:W};pe.default=class extends Y.Transform{constructor(b){super({encoding:"utf8",writableObjectMode:!0});const x=this._writer=new U.default({write:(N,M,v)=>{this.push(N),v&&v()},end:N=>{this.push(null),N&&N()}},b);this._transform=(N,M,v)=>{x.addQuad(N,v)},this._flush=N=>{x.end(N)}}import(b){return b.on("data",x=>{this.write(x)}),b.on("end",()=>{this.end()}),b.on("error",x=>{this.emit("error",x)}),b.on("prefix",(x,N)=>{this._writer.addPrefix(x,N)}),this}}},{"./N3Writer":42,"readable-stream":81}],41:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.inDefaultGraph=function(y){return x(y.graph)},pe.isBlankNode=function(y){return!!y&&"BlankNode"===y.termType},pe.isDefaultGraph=x,pe.isLiteral=function(y){return!!y&&"Literal"===y.termType},pe.isNamedNode=function(y){return!!y&&"NamedNode"===y.termType},pe.isVariable=function(y){return!!y&&"Variable"===y.termType},pe.prefix=function(y,S){return v({"":y.value||y},S)("")},pe.prefixes=v;var y,Y=(y=K("./N3DataFactory"))&&y.__esModule?y:{default:y};function x(y){return!!y&&"DefaultGraph"===y.termType}function v(y,S){const T=Object.create(null);for(const O in y)j(O,y[O]);function j(O,q){if("string"==typeof q){const ce=Object.create(null);T[O]=D=>ce[D]||(ce[D]=S.namedNode(q+D))}else if(!(O in T))throw new Error(`Unknown prefix: ${O}`);return T[O]}return S=S||Y.default,j}},{"./N3DataFactory":35}],42:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0;var ce,Y=(ce=K("./IRIs"))&&ce.__esModule?ce:{default:ce},U=function(ce,D){if(!D&&ce&&ce.__esModule)return ce;if(null===ce||"object"!=typeof ce&&"function"!=typeof ce)return{default:ce};var I=ie(D);if(I&&I.has(ce))return I.get(ce);var X={},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in ce)if("default"!==G&&Object.prototype.hasOwnProperty.call(ce,G)){var Q=w?Object.getOwnPropertyDescriptor(ce,G):null;Q&&(Q.get||Q.set)?Object.defineProperty(X,G,Q):X[G]=ce[G]}return X.default=ce,I&&I.set(ce,X),X}(K("./N3DataFactory")),k=K("./N3Util");function ie(ce){if("function"!=typeof WeakMap)return null;var D=new WeakMap,I=new WeakMap;return(ie=function(X){return X?I:D})(ce)}const x=U.default.defaultGraph(),{rdf:N,xsd:M}=Y.default,v=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,y=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,S={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class T extends U.Term{equals(){return!1}}function O(ce){let D=S[ce];return void 0===D&&(1===ce.length?(D=ce.charCodeAt(0).toString(16),D="\\u0000".substr(0,6-D.length)+D):(D=(1024*(ce.charCodeAt(0)-55296)+ce.charCodeAt(1)+9216).toString(16),D="\\U00000000".substr(0,10-D.length)+D)),D}function q(ce){return ce.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}pe.default=class{constructor(D,I){if(this._prefixRegex=/$0^/,D&&"function"!=typeof D.write&&(I=D,D=null),this._lists=(I=I||{}).lists,D)this._outputStream=D,this._endStream=void 0===I.end||!!I.end;else{let X="";this._outputStream={write(w,G,Q){X+=w,Q&&Q()},end:w=>{w&&w(null,X)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(I.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=x,this._prefixIRIs=Object.create(null),I.prefixes&&this.addPrefixes(I.prefixes),I.baseIRI&&(this._baseMatcher=new RegExp(`^${q(I.baseIRI)}${I.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=I.baseIRI.length))}get _inDefaultGraph(){return x.equals(this._graph)}_write(D,I){this._outputStream.write(D,"utf8",I)}_writeQuad(D,I,X,w,G){try{w.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(x.equals(w)?"":`${this._encodeIriOrBlank(w)} {\n`)),this._graph=w,this._subject=null),D.equals(this._subject)?I.equals(this._predicate)?this._write(`, ${this._encodeObject(X)}`,G):this._write(`;\n    ${this._encodePredicate(this._predicate=I)} ${this._encodeObject(X)}`,G):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=D)} ${this._encodePredicate(this._predicate=I)} ${this._encodeObject(X)}`,G)}catch(Q){G&&G(Q)}}_writeQuadLine(D,I,X,w,G){delete this._prefixMatch,this._write(this.quadToString(D,I,X,w),G)}quadToString(D,I,X,w){return`${this._encodeSubject(D)} ${this._encodeIriOrBlank(I)} ${this._encodeObject(X)}${w&&w.value?` ${this._encodeIriOrBlank(w)} .\n`:" .\n"}`}quadsToString(D){return D.map(I=>this.quadToString(I.subject,I.predicate,I.object,I.graph)).join("")}_encodeSubject(D){return"Quad"===D.termType?this._encodeQuad(D):this._encodeIriOrBlank(D)}_encodeIriOrBlank(D){if("NamedNode"!==D.termType)return this._lists&&D.value in this._lists&&(D=this.list(this._lists[D.value])),"id"in D?D.id:`_:${D.value}`;let I=D.value;this._baseMatcher&&this._baseMatcher.test(I)&&(I=I.substr(this._baseLength)),v.test(I)&&(I=I.replace(y,O));const X=this._prefixRegex.exec(I);return X?X[1]?this._prefixIRIs[X[1]]+X[2]:I:`<${I}>`}_encodeLiteral(D){let I=D.value;if(v.test(I)&&(I=I.replace(y,O)),D.language)return`"${I}"@${D.language}`;if(this._lineMode){if(D.datatype.value===M.string)return`"${I}"`}else switch(D.datatype.value){case M.string:return`"${I}"`;case M.boolean:if("true"===I||"false"===I)return I;break;case M.integer:if(/^[+-]?\d+$/.test(I))return I;break;case M.decimal:if(/^[+-]?\d*\.\d+$/.test(I))return I;break;case M.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(I))return I}return`"${I}"^^${this._encodeIriOrBlank(D.datatype)}`}_encodePredicate(D){return D.value===N.type?"a":this._encodeIriOrBlank(D)}_encodeObject(D){switch(D.termType){case"Quad":return this._encodeQuad(D);case"Literal":return this._encodeLiteral(D);default:return this._encodeIriOrBlank(D)}}_encodeQuad({subject:D,predicate:I,object:X,graph:w}){return`<<${this._encodeSubject(D)} ${this._encodePredicate(I)} ${this._encodeObject(X)}${(0,k.isDefaultGraph)(w)?"":` ${this._encodeIriOrBlank(w)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(D,I,X,w,G){void 0===X?this._writeQuad(D.subject,D.predicate,D.object,D.graph,I):"function"==typeof w?this._writeQuad(D,I,X,x,w):this._writeQuad(D,I,X,w||x,G)}addQuads(D){for(let I=0;I<D.length;I++)this.addQuad(D[I])}addPrefix(D,I,X){const w={};w[D]=I,this.addPrefixes(w,X)}addPrefixes(D,I){if(!this._prefixIRIs)return I&&I();let X=!1;for(let w in D){let G=D[w];"string"!=typeof G&&(G=G.value),X=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[G]=w+=":",this._write(`@prefix ${w} <${G}>.\n`)}if(X){let w="",G="";for(const Q in this._prefixIRIs)w+=w?`|${Q}`:Q,G+=(G?"|":"")+this._prefixIRIs[Q];w=q(w),this._prefixRegex=new RegExp(`^(?:${G})[^/]*$|^(${w})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(X?"\n":"",I)}blank(D,I){let w,G,X=D;switch(void 0===D?X=[]:D.termType?X=[{predicate:D,object:I}]:"length"in D||(X=[D]),G=X.length){case 0:return new T("[]");case 1:if(w=X[0],!(w.object instanceof T))return new T(`[ ${this._encodePredicate(w.predicate)} ${this._encodeObject(w.object)} ]`);default:let Q="[";for(let oe=0;oe<G;oe++)w=X[oe],w.predicate.equals(D)?Q+=`, ${this._encodeObject(w.object)}`:(Q+=`${(oe?";\n  ":"\n  ")+this._encodePredicate(w.predicate)} ${this._encodeObject(w.object)}`,D=w.predicate);return new T(`${Q}\n]`)}}list(D){const I=D&&D.length||0,X=new Array(I);for(let w=0;w<I;w++)X[w]=this._encodeObject(D[w]);return new T(`(${X.join(" ")})`)}end(D){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let I=D&&((X,w)=>{I=null,D(X,w)});if(this._endStream)try{return this._outputStream.end(I)}catch(X){}I&&I()}}},{"./IRIs":34,"./N3DataFactory":35,"./N3Util":41}],43:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),Object.defineProperty(pe,"BlankNode",{enumerable:!0,get:function(){return N.BlankNode}}),Object.defineProperty(pe,"DataFactory",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(pe,"DefaultGraph",{enumerable:!0,get:function(){return N.DefaultGraph}}),Object.defineProperty(pe,"Lexer",{enumerable:!0,get:function(){return Y.default}}),Object.defineProperty(pe,"Literal",{enumerable:!0,get:function(){return N.Literal}}),Object.defineProperty(pe,"NamedNode",{enumerable:!0,get:function(){return N.NamedNode}}),Object.defineProperty(pe,"Parser",{enumerable:!0,get:function(){return U.default}}),Object.defineProperty(pe,"Quad",{enumerable:!0,get:function(){return N.Quad}}),Object.defineProperty(pe,"Store",{enumerable:!0,get:function(){return ie.default}}),Object.defineProperty(pe,"StreamParser",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(pe,"StreamWriter",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(pe,"Term",{enumerable:!0,get:function(){return N.Term}}),Object.defineProperty(pe,"Triple",{enumerable:!0,get:function(){return N.Triple}}),pe.Util=void 0,Object.defineProperty(pe,"Variable",{enumerable:!0,get:function(){return N.Variable}}),Object.defineProperty(pe,"Writer",{enumerable:!0,get:function(){return k.default}}),pe.default=void 0,Object.defineProperty(pe,"termFromId",{enumerable:!0,get:function(){return N.termFromId}}),Object.defineProperty(pe,"termToId",{enumerable:!0,get:function(){return N.termToId}});var Y=y(K("./N3Lexer")),U=y(K("./N3Parser")),k=y(K("./N3Writer")),ie=y(K("./N3Store")),W=y(K("./N3StreamParser")),b=y(K("./N3StreamWriter")),x=v(K("./N3Util"));pe.Util=x;var N=v(K("./N3DataFactory"));function M(T){if("function"!=typeof WeakMap)return null;var j=new WeakMap,O=new WeakMap;return(M=function(q){return q?O:j})(T)}function v(T,j){if(!j&&T&&T.__esModule)return T;if(null===T||"object"!=typeof T&&"function"!=typeof T)return{default:T};var O=M(j);if(O&&O.has(T))return O.get(T);var q={},ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in T)if("default"!==D&&Object.prototype.hasOwnProperty.call(T,D)){var I=ce?Object.getOwnPropertyDescriptor(T,D):null;I&&(I.get||I.set)?Object.defineProperty(q,D,I):q[D]=T[D]}return q.default=T,O&&O.set(T,q),q}function y(T){return T&&T.__esModule?T:{default:T}}pe.default={Lexer:Y.default,Parser:U.default,Writer:k.default,Store:ie.default,StreamParser:W.default,StreamWriter:b.default,Util:x,DataFactory:N.default,Term:N.Term,NamedNode:N.NamedNode,Literal:N.Literal,BlankNode:N.BlankNode,Variable:N.Variable,DefaultGraph:N.DefaultGraph,Quad:N.Quad,Triple:N.Triple,termFromId:N.termFromId,termToId:N.termToId}},{"./N3DataFactory":35,"./N3Lexer":36,"./N3Parser":37,"./N3Store":38,"./N3StreamParser":39,"./N3StreamWriter":40,"./N3Util":41,"./N3Writer":42}],44:[function(K,Ae,pe){var U,k,Y=Ae.exports={};function ie(){throw new Error("setTimeout has not been defined")}function W(){throw new Error("clearTimeout has not been defined")}function b(q){if(U===setTimeout)return setTimeout(q,0);if((U===ie||!U)&&setTimeout)return U=setTimeout,setTimeout(q,0);try{return U(q,0)}catch(ce){try{return U.call(null,q,0)}catch(D){return U.call(this,q,0)}}}!function(){try{U="function"==typeof setTimeout?setTimeout:ie}catch(q){U=ie}try{k="function"==typeof clearTimeout?clearTimeout:W}catch(q){k=W}}();var v,N=[],M=!1,y=-1;function S(){!M||!v||(M=!1,v.length?N=v.concat(N):y=-1,N.length&&T())}function T(){if(!M){var q=b(S);M=!0;for(var ce=N.length;ce;){for(v=N,N=[];++y<ce;)v&&v[y].run();y=-1,ce=N.length}v=null,M=!1,function(q){if(k===clearTimeout)return clearTimeout(q);if((k===W||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(q);try{k(q)}catch(ce){try{return k.call(null,q)}catch(D){return k.call(this,q)}}}(q)}}function j(q,ce){this.fun=q,this.array=ce}function O(){}Y.nextTick=function(q){var ce=new Array(arguments.length-1);if(arguments.length>1)for(var D=1;D<arguments.length;D++)ce[D-1]=arguments[D];N.push(new j(q,ce)),1===N.length&&!M&&b(T)},j.prototype.run=function(){this.fun.apply(null,this.array)},Y.title="browser",Y.browser=!0,Y.env={},Y.argv=[],Y.version="",Y.versions={},Y.on=O,Y.addListener=O,Y.once=O,Y.off=O,Y.removeListener=O,Y.removeAllListeners=O,Y.emit=O,Y.prependListener=O,Y.prependOnceListener=O,Y.listeners=function(q){return[]},Y.binding=function(q){throw new Error("process.binding is not supported")},Y.cwd=function(){return"/"},Y.chdir=function(q){throw new Error("process.chdir is not supported")},Y.umask=function(){return 0}},{}],45:[function(K,Ae,pe){(function(Y){(function(){let U;Ae.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:Y):k=>(U||(U=Promise.resolve())).then(k).catch(ie=>setTimeout(()=>{throw ie},0))}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(K,Ae,pe){Ae.exports=K("./lib")},{"./lib":55}],47:[function(K,Ae,pe){"use strict";Ae.exports=class $W{constructor(U,k=new Map,ie=0){this.prefix=U,this._existing=k,this.counter=ie}clone(){const{prefix:U,_existing:k,counter:ie}=this;return new $W(U,new Map(k),ie)}getId(U){const k=U&&this._existing.get(U);if(k)return k;const ie=this.prefix+this.counter;return this.counter++,U&&this._existing.set(U,ie),ie}hasId(U){return this._existing.has(U)}getOldIds(){return[...this._existing.keys()]}}},{}],48:[function(K,Ae,pe){"use strict";K("setimmediate");const Y=self.crypto||self.msCrypto;Ae.exports=class{constructor(k){if(!Y||!Y.subtle)throw new Error("crypto.subtle not found.");if("sha256"===k)this.algorithm={name:"SHA-256"};else{if("sha1"!==k)throw new Error(`Unsupport algorithm "${k}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(k){this._content+=k}digest(){var k=this;return mt(function*(){const ie=(new TextEncoder).encode(k._content),W=new Uint8Array(yield Y.subtle.digest(k.algorithm,ie));let b="";for(let x=0;x<W.length;++x)b+=W[x].toString(16).padStart(2,"0");return b})()}}},{setimmediate:86}],49:[function(K,Ae,pe){"use strict";const k="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",ie="http://www.w3.org/2001/XMLSchema#string",W="NamedNode",b="BlankNode",x="Literal",N="DefaultGraph",M={};function v(O,q){return O.subject.termType===q.subject.termType&&O.object.termType===q.object.termType&&O.subject.value===q.subject.value&&O.predicate.value===q.predicate.value&&O.object.value===q.object.value&&(O.object.termType!==x||O.object.datatype.termType===q.object.datatype.termType&&O.object.language===q.object.language&&O.object.datatype.value===q.object.datatype.value)}M.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,M.empty=new RegExp("^[ \\t]*$"),M.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),Ae.exports=class PN{static parse(q){const ce=[],D={},I=q.split(M.eoln);let X=0;for(const w of I){if(X++,M.empty.test(w))continue;const G=w.match(M.quad);if(null===G)throw new Error("N-Quads parse error on line "+X+".");const Q={subject:null,predicate:null,object:null,graph:null};if(Q.subject=void 0!==G[1]?{termType:W,value:G[1]}:{termType:b,value:G[2]},Q.predicate={termType:W,value:G[3]},void 0!==G[4]?Q.object={termType:W,value:G[4]}:void 0!==G[5]?Q.object={termType:b,value:G[5]}:(Q.object={termType:x,value:void 0,datatype:{termType:W}},void 0!==G[7]?Q.object.datatype.value=G[7]:void 0!==G[8]?(Q.object.datatype.value=k,Q.object.language=G[8]):Q.object.datatype.value=ie,Q.object.value=G[6].replace(T,function(q,ce,D,I){if(ce)switch(ce){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(D)return String.fromCharCode(parseInt(D,16));if(I)throw new Error("Unsupported U escape")})),Q.graph=void 0!==G[9]?{termType:W,value:G[9]}:void 0!==G[10]?{termType:b,value:G[10]}:{termType:N,value:""},Q.graph.value in D){let oe=!0;const se=D[Q.graph.value];for(const ee of se)if(v(ee,Q)){oe=!1;break}oe&&(se.push(Q),ce.push(Q))}else D[Q.graph.value]=[Q],ce.push(Q)}return ce}static serialize(q){Array.isArray(q)||(q=PN.legacyDatasetToQuads(q));const ce=[];for(const D of q)ce.push(PN.serializeQuad(D));return ce.sort().join("")}static serializeQuad(q){const ce=q.subject,I=q.object,X=q.graph;let w="";return w+=ce.termType===W?`<${ce.value}>`:`${ce.value}`,w+=` <${q.predicate.value}> `,I.termType===W?w+=`<${I.value}>`:I.termType===b?w+=I.value:(w+=`"${O=I.value,O.replace(y,function(q){switch(q){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,I.datatype.value===k?I.language&&(w+=`@${I.language}`):I.datatype.value!==ie&&(w+=`^^<${I.datatype.value}>`)),X.termType===W?w+=` <${X.value}>`:X.termType===b&&(w+=` ${X.value}`),w+=" .\n",w;var O}static legacyDatasetToQuads(q){const ce=[],D={"blank node":b,IRI:W,literal:x};for(const I in q)q[I].forEach(w=>{const G={};for(const Q in w){const oe=w[Q],se={termType:D[oe.type],value:oe.value};se.termType===x&&(se.datatype={termType:W},"datatype"in oe&&(se.datatype.value=oe.datatype),"language"in oe?("datatype"in oe||(se.datatype.value=k),se.language=oe.language):"datatype"in oe||(se.datatype.value=ie)),G[Q]=se}G.graph="@default"===I?{termType:N,value:""}:{termType:I.startsWith("_:")?b:W,value:I},ce.push(G)});return ce}};const y=/["\\\n\r]/g;const T=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],50:[function(K,Ae,pe){"use strict";Ae.exports=class{constructor(U){this.current=U.sort(),this.done=!1,this.dir=new Map;for(let k=0;k<U.length;++k)this.dir.set(U[k],!0)}hasNext(){return!this.done}next(){const{current:U,dir:k}=this,ie=U.slice();let W=null,b=0;const x=U.length;for(let N=0;N<x;++N){const M=U[N],v=k.get(M);(null===W||M>W)&&(v&&N>0&&M>U[N-1]||!v&&N<x-1&&M>U[N+1])&&(W=M,b=N)}if(null===W)this.done=!0;else{const N=k.get(W)?b-1:b+1;U[b]=U[N],U[N]=W;for(const M of U)M>W&&k.set(M,!k.get(M))}return ie}}},{}],51:[function(K,Ae,pe){(function(Y){(function(){"use strict";const U=K("./IdentifierIssuer"),k=K("./MessageDigest"),ie=K("./Permuter"),W=K("./NQuads");function b(x,N){return x.hash<N.hash?-1:x.hash>N.hash?1:0}Ae.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new U("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(N){var M=this;return mt(function*(){M.quads=N;for(const q of N)M._addBlankNodeQuadInfo({quad:q,component:q.subject}),M._addBlankNodeQuadInfo({quad:q,component:q.object}),M._addBlankNodeQuadInfo({quad:q,component:q.graph});const v=new Map,y=[...M.blankNodeInfo.keys()];let S=0;for(const q of y)++S%100==0&&(yield M._yield()),yield M._hashAndTrackBlankNode({id:q,hashToBlankNodes:v});const T=[...v.keys()].sort(),j=[];for(const q of T){const ce=v.get(q);ce.length>1?j.push(ce):M.canonicalIssuer.getId(ce[0])}for(const q of j){const ce=[];for(const D of q){if(M.canonicalIssuer.hasId(D))continue;const I=new U("_:b");I.getId(D);const X=yield M.hashNDegreeQuads(D,I);ce.push(X)}ce.sort(b);for(const D of ce){const I=D.issuer.getOldIds();for(const X of I)M.canonicalIssuer.getId(X)}}const O=[];for(const q of M.quads){const ce=ht({},q);ce.subject=M._useCanonicalId({component:ce.subject}),ce.object=M._useCanonicalId({component:ce.object}),ce.graph=M._useCanonicalId({component:ce.graph}),O.push(W.serializeQuad(ce))}return O.sort(),O.join("")})()}hashFirstDegreeQuads(N){var M=this;return mt(function*(){const v=[],y=M.blankNodeInfo.get(N),S=y.quads;for(const j of S){const O={subject:null,predicate:j.predicate,object:null,graph:null};O.subject=M.modifyFirstDegreeComponent(N,j.subject,"subject"),O.object=M.modifyFirstDegreeComponent(N,j.object,"object"),O.graph=M.modifyFirstDegreeComponent(N,j.graph,"graph"),v.push(W.serializeQuad(O))}v.sort();const T=new k(M.hashAlgorithm);for(const j of v)T.update(j);return y.hash=yield T.digest(),y.hash})()}hashRelatedBlankNode(N,M,v,y){var S=this;return mt(function*(){let T;T=S.canonicalIssuer.hasId(N)?S.canonicalIssuer.getId(N):v.hasId(N)?v.getId(N):S.blankNodeInfo.get(N).hash;const j=new k(S.hashAlgorithm);return j.update(y),"g"!==y&&j.update(S.getRelatedPredicate(M)),j.update(T),j.digest()})()}hashNDegreeQuads(N,M){var v=this;return mt(function*(){const y=new k(v.hashAlgorithm),S=yield v.createHashToRelated(N,M),T=[...S.keys()].sort();for(const j of T){y.update(j);let q,O="";const ce=new ie(S.get(j));let D=0;for(;ce.hasNext();){const I=ce.next();++D%3==0&&(yield v._yield());let X=M.clone(),w="";const G=[];let Q=!1;for(const oe of I)if(v.canonicalIssuer.hasId(oe)?w+=v.canonicalIssuer.getId(oe):(X.hasId(oe)||G.push(oe),w+=X.getId(oe)),0!==O.length&&w>O){Q=!0;break}if(!Q){for(const oe of G){const se=yield v.hashNDegreeQuads(oe,X);if(w+=X.getId(oe),w+=`<${se.hash}>`,X=se.issuer,0!==O.length&&w>O){Q=!0;break}}Q||(0===O.length||w<O)&&(O=w,q=X)}}y.update(O),M=q}return{hash:yield y.digest(),issuer:M}})()}modifyFirstDegreeComponent(N,M){return"BlankNode"!==M.termType?M:{termType:"BlankNode",value:M.value===N?"_:a":"_:z"}}getRelatedPredicate(N){return`<${N.predicate.value}>`}createHashToRelated(N,M){var v=this;return mt(function*(){const y=new Map,S=v.blankNodeInfo.get(N).quads;let T=0;for(const j of S)++T%100==0&&(yield v._yield()),yield Promise.all([v._addRelatedBlankNodeHash({quad:j,component:j.subject,position:"s",id:N,issuer:M,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:j,component:j.object,position:"o",id:N,issuer:M,hashToRelated:y}),v._addRelatedBlankNodeHash({quad:j,component:j.graph,position:"g",id:N,issuer:M,hashToRelated:y})]);return y})()}_hashAndTrackBlankNode({id:N,hashToBlankNodes:M}){var v=this;return mt(function*(){const y=yield v.hashFirstDegreeQuads(N),S=M.get(y);S?S.push(N):M.set(y,[N])})()}_addBlankNodeQuadInfo({quad:N,component:M}){if("BlankNode"!==M.termType)return;const v=M.value,y=this.blankNodeInfo.get(v);y?y.quads.add(N):this.blankNodeInfo.set(v,{quads:new Set([N]),hash:null})}_addRelatedBlankNodeHash({quad:N,component:M,position:v,id:y,issuer:S,hashToRelated:T}){var j=this;return mt(function*(){if("BlankNode"!==M.termType||M.value===y)return;const O=M.value,q=yield j.hashRelatedBlankNode(O,N,S,v),ce=T.get(q);ce?ce.push(O):T.set(q,[O])})()}_useCanonicalId({component:N}){return"BlankNode"!==N.termType||N.value.startsWith(this.canonicalIssuer.prefix)?N:{termType:"BlankNode",value:this.canonicalIssuer.getId(N.value)}}_yield(){return mt(function*(){return new Promise(N=>Y(N))})()}}}).call(this)}).call(this,K("timers").setImmediate)},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50,timers:89}],52:[function(K,Ae,pe){"use strict";const Y=K("./IdentifierIssuer"),U=K("./MessageDigest"),k=K("./Permuter"),ie=K("./NQuads");function W(b,x){return b.hash<x.hash?-1:b.hash>x.hash?1:0}Ae.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new Y("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(x){this.quads=x;for(const T of x)this._addBlankNodeQuadInfo({quad:T,component:T.subject}),this._addBlankNodeQuadInfo({quad:T,component:T.object}),this._addBlankNodeQuadInfo({quad:T,component:T.graph});const N=new Map,M=[...this.blankNodeInfo.keys()];for(const T of M)this._hashAndTrackBlankNode({id:T,hashToBlankNodes:N});const v=[...N.keys()].sort(),y=[];for(const T of v){const j=N.get(T);j.length>1?y.push(j):this.canonicalIssuer.getId(j[0])}for(const T of y){const j=[];for(const O of T){if(this.canonicalIssuer.hasId(O))continue;const q=new Y("_:b");q.getId(O);const ce=this.hashNDegreeQuads(O,q);j.push(ce)}j.sort(W);for(const O of j){const q=O.issuer.getOldIds();for(const ce of q)this.canonicalIssuer.getId(ce)}}const S=[];for(const T of this.quads){const j=ht({},T);j.subject=this._useCanonicalId({component:j.subject}),j.object=this._useCanonicalId({component:j.object}),j.graph=this._useCanonicalId({component:j.graph}),S.push(ie.serializeQuad(j))}return S.sort(),S.join("")}hashFirstDegreeQuads(x){const N=[],M=this.blankNodeInfo.get(x),v=M.quads;for(const S of v){const T={subject:null,predicate:S.predicate,object:null,graph:null};T.subject=this.modifyFirstDegreeComponent(x,S.subject,"subject"),T.object=this.modifyFirstDegreeComponent(x,S.object,"object"),T.graph=this.modifyFirstDegreeComponent(x,S.graph,"graph"),N.push(ie.serializeQuad(T))}N.sort();const y=new U(this.hashAlgorithm);for(const S of N)y.update(S);return M.hash=y.digest(),M.hash}hashRelatedBlankNode(x,N,M,v){let y;y=this.canonicalIssuer.hasId(x)?this.canonicalIssuer.getId(x):M.hasId(x)?M.getId(x):this.blankNodeInfo.get(x).hash;const S=new U(this.hashAlgorithm);return S.update(v),"g"!==v&&S.update(this.getRelatedPredicate(N)),S.update(y),S.digest()}hashNDegreeQuads(x,N){const M=new U(this.hashAlgorithm),v=this.createHashToRelated(x,N),y=[...v.keys()].sort();for(const S of y){M.update(S);let j,T="";const O=new k(v.get(S));for(;O.hasNext();){const q=O.next();let ce=N.clone(),D="";const I=[];let X=!1;for(const w of q)if(this.canonicalIssuer.hasId(w)?D+=this.canonicalIssuer.getId(w):(ce.hasId(w)||I.push(w),D+=ce.getId(w)),0!==T.length&&D>T){X=!0;break}if(!X){for(const w of I){const G=this.hashNDegreeQuads(w,ce);if(D+=ce.getId(w),D+=`<${G.hash}>`,ce=G.issuer,0!==T.length&&D>T){X=!0;break}}X||(0===T.length||D<T)&&(T=D,j=ce)}}M.update(T),N=j}return{hash:M.digest(),issuer:N}}modifyFirstDegreeComponent(x,N){return"BlankNode"!==N.termType?N:{termType:"BlankNode",value:N.value===x?"_:a":"_:z"}}getRelatedPredicate(x){return`<${x.predicate.value}>`}createHashToRelated(x,N){const M=new Map,v=this.blankNodeInfo.get(x).quads;for(const y of v)this._addRelatedBlankNodeHash({quad:y,component:y.subject,position:"s",id:x,issuer:N,hashToRelated:M}),this._addRelatedBlankNodeHash({quad:y,component:y.object,position:"o",id:x,issuer:N,hashToRelated:M}),this._addRelatedBlankNodeHash({quad:y,component:y.graph,position:"g",id:x,issuer:N,hashToRelated:M});return M}_hashAndTrackBlankNode({id:x,hashToBlankNodes:N}){const M=this.hashFirstDegreeQuads(x),v=N.get(M);v?v.push(x):N.set(M,[x])}_addBlankNodeQuadInfo({quad:x,component:N}){if("BlankNode"!==N.termType)return;const M=N.value,v=this.blankNodeInfo.get(M);v?v.quads.add(x):this.blankNodeInfo.set(M,{quads:new Set([x]),hash:null})}_addRelatedBlankNodeHash({quad:x,component:N,position:M,id:v,issuer:y,hashToRelated:S}){if("BlankNode"!==N.termType||N.value===v)return;const T=N.value,j=this.hashRelatedBlankNode(T,x,y,M),O=S.get(j);O?O.push(T):S.set(j,[T])}_useCanonicalId({component:x}){return"BlankNode"!==x.termType||x.value.startsWith(this.canonicalIssuer.prefix)?x:{termType:"BlankNode",value:this.canonicalIssuer.getId(x.value)}}}},{"./IdentifierIssuer":47,"./MessageDigest":48,"./NQuads":49,"./Permuter":50}],53:[function(K,Ae,pe){"use strict";const Y=K("./URDNA2015");Ae.exports=class extends Y{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(k,ie,W){return"BlankNode"!==ie.termType?ie:"graph"===W?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:ie.value===k?"_:a":"_:z"}}getRelatedPredicate(k){return k.predicate.value}createHashToRelated(k,ie){var W=this;return mt(function*(){const b=new Map,x=W.blankNodeInfo.get(k).quads;let N=0;for(const M of x){let v,y;if("BlankNode"===M.subject.termType&&M.subject.value!==k)y=M.subject.value,v="p";else{if("BlankNode"!==M.object.termType||M.object.value===k)continue;y=M.object.value,v="r"}++N%100==0&&(yield W._yield());const S=yield W.hashRelatedBlankNode(y,M,ie,v),T=b.get(S);T?T.push(y):b.set(S,[y])}return b})()}}},{"./URDNA2015":51}],54:[function(K,Ae,pe){"use strict";const Y=K("./URDNA2015Sync");Ae.exports=class extends Y{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(k,ie,W){return"BlankNode"!==ie.termType?ie:"graph"===W?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:ie.value===k?"_:a":"_:z"}}getRelatedPredicate(k){return k.predicate.value}createHashToRelated(k,ie){const W=new Map,b=this.blankNodeInfo.get(k).quads;for(const x of b){let N,M;if("BlankNode"===x.subject.termType&&x.subject.value!==k)M=x.subject.value,N="p";else{if("BlankNode"!==x.object.termType||x.object.value===k)continue;M=x.object.value,N="r"}const v=this.hashRelatedBlankNode(M,x,ie,N),y=W.get(v);y?y.push(M):W.set(v,[M])}return W}}},{"./URDNA2015Sync":52}],55:[function(K,Ae,pe){"use strict";const Y=K("./URDNA2015"),U=K("./URGNA2012"),k=K("./URDNA2015Sync"),ie=K("./URGNA2012Sync");let W;try{W=K("rdf-canonize-native")}catch(x){}const b={};Ae.exports=b,b.NQuads=K("./NQuads"),b.IdentifierIssuer=K("./IdentifierIssuer"),b._rdfCanonizeNative=function(x){return x&&(W=x),W},b.canonize=function(){var x=mt(function*(N,M){if(Array.isArray(N)||(N=b.NQuads.legacyDatasetToQuads(N)),M.useNative){if(!W)throw new Error("rdf-canonize-native not available");return new Promise((v,y)=>W.canonize(N,M,(S,T)=>S?y(S):v(T)))}if("URDNA2015"===M.algorithm)return new Y(M).main(N);if("URGNA2012"===M.algorithm)return new U(M).main(N);throw"algorithm"in M?new Error("Invalid RDF Dataset Canonicalization algorithm: "+M.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")});return function(N,M){return x.apply(this,arguments)}}(),b._canonizeSync=function(x,N){if(Array.isArray(x)||(x=b.NQuads.legacyDatasetToQuads(x)),N.useNative){if(W)return W.canonizeSync(x,N);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===N.algorithm)return new k(N).main(x);if("URGNA2012"===N.algorithm)return new ie(N).main(x);throw"algorithm"in N?new Error("Invalid RDF Dataset Canonicalization algorithm: "+N.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}},{"./IdentifierIssuer":47,"./NQuads":49,"./URDNA2015":51,"./URDNA2015Sync":52,"./URGNA2012":53,"./URGNA2012Sync":54,"rdf-canonize-native":3}],56:[function(K,Ae,pe){"use strict";var Y=this&&this.__createBinding||(Object.create?function(k,ie,W,b){void 0===b&&(b=W),Object.defineProperty(k,b,{enumerable:!0,get:function(){return ie[W]}})}:function(k,ie,W,b){void 0===b&&(b=W),k[b]=ie[W]}),U=this&&this.__exportStar||function(k,ie){for(var W in k)"default"!==W&&!Object.prototype.hasOwnProperty.call(ie,W)&&Y(ie,k,W)};Object.defineProperty(pe,"__esModule",{value:!0}),U(K("./lib/BlankNode"),pe),U(K("./lib/DataFactory"),pe),U(K("./lib/DefaultGraph"),pe),U(K("./lib/Literal"),pe),U(K("./lib/NamedNode"),pe),U(K("./lib/Quad"),pe),U(K("./lib/Variable"),pe)},{"./lib/BlankNode":57,"./lib/DataFactory":58,"./lib/DefaultGraph":59,"./lib/Literal":60,"./lib/NamedNode":61,"./lib/Quad":62,"./lib/Variable":63}],57:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.BlankNode=void 0;pe.BlankNode=class{constructor(k){this.termType="BlankNode",this.value=k}equals(k){return!!k&&"BlankNode"===k.termType&&k.value===this.value}}},{}],58:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.DataFactory=void 0;const Y=K("./BlankNode"),U=K("./DefaultGraph"),k=K("./Literal"),ie=K("./NamedNode"),W=K("./Quad"),b=K("./Variable");let x=0;pe.DataFactory=class{constructor(v){this.blankNodeCounter=0,this.blankNodePrefix=(v=v||{}).blankNodePrefix||`df_${x++}_`}namedNode(v){return new ie.NamedNode(v)}blankNode(v){return new Y.BlankNode(v||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(v,y){return new k.Literal(v,y)}variable(v){return new b.Variable(v)}defaultGraph(){return U.DefaultGraph.INSTANCE}quad(v,y,S,T){return new W.Quad(v,y,S,T||this.defaultGraph())}fromTerm(v){switch(v.termType){case"NamedNode":return this.namedNode(v.value);case"BlankNode":return this.blankNode(v.value);case"Literal":return v.language?this.literal(v.value,v.language):v.datatype.equals(k.Literal.XSD_STRING)?this.literal(v.value):this.literal(v.value,this.fromTerm(v.datatype));case"Variable":return this.variable(v.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(v.subject),this.fromTerm(v.predicate),this.fromTerm(v.object),this.fromTerm(v.graph))}}fromQuad(v){return this.fromTerm(v)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},{"./BlankNode":57,"./DefaultGraph":59,"./Literal":60,"./NamedNode":61,"./Quad":62,"./Variable":63}],59:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.DefaultGraph=void 0;class Y{constructor(){this.termType="DefaultGraph",this.value=""}equals(k){return!!k&&"DefaultGraph"===k.termType}}pe.DefaultGraph=Y,Y.INSTANCE=new Y},{}],60:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.Literal=void 0;const Y=K("./NamedNode");class U{constructor(ie,W){this.termType="Literal",this.value=ie,"string"==typeof W?(this.language=W,this.datatype=U.RDF_LANGUAGE_STRING):W?(this.language="",this.datatype=W):(this.language="",this.datatype=U.XSD_STRING)}equals(ie){return!!ie&&"Literal"===ie.termType&&ie.value===this.value&&ie.language===this.language&&ie.datatype.equals(this.datatype)}}pe.Literal=U,U.RDF_LANGUAGE_STRING=new Y.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),U.XSD_STRING=new Y.NamedNode("http://www.w3.org/2001/XMLSchema#string")},{"./NamedNode":61}],61:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.NamedNode=void 0;pe.NamedNode=class{constructor(k){this.termType="NamedNode",this.value=k}equals(k){return!!k&&"NamedNode"===k.termType&&k.value===this.value}}},{}],62:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.Quad=void 0;pe.Quad=class{constructor(k,ie,W,b){this.termType="Quad",this.value="",this.subject=k,this.predicate=ie,this.object=W,this.graph=b}equals(k){return!!k&&("Quad"===k.termType||!k.termType)&&this.subject.equals(k.subject)&&this.predicate.equals(k.predicate)&&this.object.equals(k.object)&&this.graph.equals(k.graph)}}},{}],63:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.Variable=void 0;pe.Variable=class{constructor(k){this.termType="Variable",this.value=k}equals(k){return!!k&&"Variable"===k.termType&&k.value===this.value}}},{}],64:[function(K,Ae,pe){"use strict";var Y=this&&this.__createBinding||(Object.create?function(k,ie,W,b){void 0===b&&(b=W),Object.defineProperty(k,b,{enumerable:!0,get:function(){return ie[W]}})}:function(k,ie,W,b){void 0===b&&(b=W),k[b]=ie[W]}),U=this&&this.__exportStar||function(k,ie){for(var W in k)"default"!==W&&!Object.prototype.hasOwnProperty.call(ie,W)&&Y(ie,k,W)};Object.defineProperty(pe,"__esModule",{value:!0}),U(K("./lib/RdfXmlParser"),pe)},{"./lib/RdfXmlParser":66}],65:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.ParseError=void 0;class Y extends Error{constructor(k,ie){const W=k.saxStream._parser;super(k.trackPosition?`Line ${W.line+1} column ${W.column+1}: ${ie}`:ie)}}pe.ParseError=Y},{}],66:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),pe.ParseType=pe.RdfXmlParser=void 0;const Y=K("relative-to-absolute-iri"),U=K("sax"),k=K("stream"),ie=K("./ParseError"),W=K("rdf-data-factory");class b extends k.Transform{constructor(M){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},M&&(Object.assign(this,M),this.options=M),this.dataFactory||(this.dataFactory=new W.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.saxStream=U.createStream(this.strict,{xmlns:!1,position:this.trackPosition}),this.strict||(this.saxStream._parser.looseCase="toString"),this.attachSaxListeners()}static parseNamespace(M,v){const y={};let S=!1;for(const j in M.attributes)j.startsWith("xmlns")&&(5===j.length?(S=!0,y[""]=M.attributes[j]):":"===j.charAt(5)&&(S=!0,y[j.substr(6)]=M.attributes[j]));const T=v&&v.ns?v.ns:[b.DEFAULT_NS];return S?T.concat([y]):T}static expandPrefixedTerm(M,v,y){const S=M.indexOf(":");let T,j;S>=0?(T=M.substr(0,S),j=M.substr(S+1)):(T="",j=M);let O=null,q=null;for(let ce=v.length-1;ce>=0;ce--){const D=v[ce][T];if(D){O=D;break}q||(q=v[ce][""])}if(!O){if(T&&"xmlns"!==T)throw new ie.ParseError(y,`The prefix '${T}' in term '${M}' was not bound.`);O=q||""}return{prefix:T,local:j,uri:O}}static isValidIri(M){return b.IRI_REGEX.test(M)}import(M){const v=new k.PassThrough({readableObjectMode:!0});M.on("error",S=>y.emit("error",S)),M.on("data",S=>v.push(S)),M.on("end",()=>v.push(null));const y=v.pipe(new b(this.options));return y}_transform(M,v,y){try{this.saxStream.write(M,v)}catch(S){return y(S)}y()}newParseError(M){return new ie.ParseError(this,M)}valueToUri(M,v){return this.uriToNamedNode(Y.resolve(M,v.baseIRI))}uriToNamedNode(M){if(!b.isValidIri(M))throw this.newParseError(`Invalid URI: ${M}`);return this.dataFactory.namedNode(M)}validateNcname(M){if(!b.NCNAME_MATCHER.test(M))throw this.newParseError(`Not a valid NCName: ${M}`)}attachSaxListeners(){this.saxStream.on("error",M=>this.emit("error",M)),this.saxStream.on("opentag",this.onTag.bind(this)),this.saxStream.on("text",this.onText.bind(this)),this.saxStream.on("closetag",this.onCloseTag.bind(this)),this.saxStream.on("doctype",this.onDoctype.bind(this))}onTag(M){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let y=x.RESOURCE;if(v&&(v.hadChildren=!0,y=v.childrenParseType),v&&v.childrenStringTags){const T=M.name;let j="";for(const D in M.attributes)j+=` ${D}="${M.attributes[D]}"`;v.childrenStringTags.push(`<${T}${j}>`);const ce={childrenStringTags:v.childrenStringTags};return ce.childrenStringEmitClosingTag=`</${T}>`,void this.activeTagStack.push(ce)}const S={};v?(S.language=v.language,S.baseIRI=v.baseIRI):S.baseIRI=this.baseIRI,this.activeTagStack.push(S),S.ns=b.parseNamespace(M,v),y===x.RESOURCE?this.onTagResource(M,S,v,!v):this.onTagProperty(M,S,v)}onTagResource(M,v,y,S){const T=b.expandPrefixedTerm(M.name,v.ns,this);v.childrenParseType=x.PROPERTY;let j=!0;if(T.uri===b.RDF){if(!S&&b.FORBIDDEN_NODE_ELEMENTS.indexOf(T.local)>=0)throw this.newParseError(`Illegal node element name: ${T.local}`);switch(T.local){case"RDF":v.childrenParseType=x.RESOURCE;case"Description":j=!1}}const O=[],q=[];let ce=null,D=!1,I=!1,X=null;for(const w in M.attributes){const G=M.attributes[w],Q=b.expandPrefixedTerm(w,v.ns,this);if(y&&Q.uri===b.RDF)switch(Q.local){case"about":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${G} and ${ce} where found.`);ce=G;continue;case"ID":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${G} and ${ce} where found.`);this.validateNcname(G),ce="#"+G,D=!0;continue;case"nodeID":if(ce)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${G} and ${ce} where found.`);this.validateNcname(G),ce=G,I=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":X=G;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(Q.uri===b.XML){if("lang"===Q.local){v.language=""===G?null:G.toLowerCase();continue}if("base"===Q.local){v.baseIRI=Y.resolve(G,v.baseIRI);continue}}"xml"!==Q.prefix&&Q.uri&&(O.push(this.uriToNamedNode(Q.uri+Q.local)),q.push(G))}if(null!==ce&&(v.subject=I?this.dataFactory.blankNode(ce):this.valueToUri(ce,v),D&&this.claimNodeId(v.subject)),v.subject||(v.subject=this.dataFactory.blankNode()),j){const w=this.uriToNamedNode(T.uri+T.local);this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),w,y?y.reifiedStatementId:null)}if(y){if(y.predicate)if(y.childrenCollectionSubject){const w=this.dataFactory.blankNode();this.emitTriple(y.childrenCollectionSubject,y.childrenCollectionPredicate,w,y.reifiedStatementId),this.emitTriple(w,this.dataFactory.namedNode(b.RDF+"first"),v.subject,v.reifiedStatementId),y.childrenCollectionSubject=w,y.childrenCollectionPredicate=this.dataFactory.namedNode(b.RDF+"rest")}else{this.emitTriple(y.subject,y.predicate,v.subject,y.reifiedStatementId);for(let w=0;w<y.predicateSubPredicates.length;w++)this.emitTriple(v.subject,y.predicateSubPredicates[w],y.predicateSubObjects[w],null);y.predicateSubPredicates=[],y.predicateSubObjects=[],y.predicateEmitted=!0}for(let w=0;w<O.length;w++){const G=this.dataFactory.literal(q[w],v.datatype||v.language);this.emitTriple(v.subject,O[w],G,y.reifiedStatementId)}X&&this.emitTriple(v.subject,this.dataFactory.namedNode(b.RDF+"type"),this.uriToNamedNode(X),null)}}onTagProperty(M,v,y){const S=b.expandPrefixedTerm(M.name,v.ns,this);if(v.childrenParseType=x.RESOURCE,v.subject=y.subject,S.uri===b.RDF&&"li"===S.local?(y.listItemCounter||(y.listItemCounter=1),v.predicate=this.uriToNamedNode(S.uri+"_"+y.listItemCounter++)):v.predicate=this.uriToNamedNode(S.uri+S.local),S.uri===b.RDF&&b.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(S.local)>=0)throw this.newParseError(`Illegal property element name: ${S.local}`);v.predicateSubPredicates=[],v.predicateSubObjects=[];let T=!1,j=!1,O=null,q=!0;const ce=[],D=[];for(const I in M.attributes){const X=M.attributes[I],w=b.expandPrefixedTerm(I,v.ns,this);if(w.uri===b.RDF)switch(w.local){case"resource":if(O)throw this.newParseError(`Found both rdf:resource (${X}) and rdf:nodeID (${O}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${X})`);v.hadChildren=!0,O=X,q=!1;continue;case"datatype":if(j)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${X}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${X})`);v.datatype=this.valueToUri(X,v);continue;case"nodeID":if(j)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${X}).`);if(v.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${X}).`);if(T)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${X})`);this.validateNcname(X),v.hadChildren=!0,O=X,q=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(j)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(v.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${v.datatype.value})`);if(O)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${O})`);if("Resource"===X){T=!0,v.childrenParseType=x.PROPERTY;const G=this.dataFactory.blankNode();this.emitTriple(v.subject,v.predicate,G,v.reifiedStatementId),v.subject=G,v.predicate=null}else"Collection"===X?(T=!0,v.hadChildren=!0,v.childrenCollectionSubject=v.subject,v.childrenCollectionPredicate=v.predicate,q=!1):"Literal"===X&&(T=!0,v.childrenTagsToString=!0,v.childrenStringTags=[]);continue;case"ID":this.validateNcname(X),v.reifiedStatementId=this.valueToUri("#"+X,v),this.claimNodeId(v.reifiedStatementId);continue}else if(w.uri===b.XML&&"lang"===w.local){v.language=""===X?null:X.toLowerCase();continue}if("xml"!==w.prefix&&"xmlns"!==w.prefix&&w.uri){if(T||v.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${X}`);v.hadChildren=!0,j=!0,ce.push(this.uriToNamedNode(w.uri+w.local)),D.push(this.dataFactory.literal(X,v.datatype||v.language))}}if(null!==O){const I=v.subject;v.subject=q?this.dataFactory.blankNode(O):this.valueToUri(O,v),this.emitTriple(I,v.predicate,v.subject,v.reifiedStatementId);for(let X=0;X<ce.length;X++)this.emitTriple(v.subject,ce[X],D[X],null);v.predicateEmitted=!0}else q&&(v.predicateSubPredicates=ce,v.predicateSubObjects=D,v.predicateEmitted=!1)}emitTriple(M,v,y,S){this.push(this.dataFactory.quad(M,v,y,this.defaultGraph)),S&&(this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(b.RDF+"type"),this.dataFactory.namedNode(b.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(b.RDF+"subject"),M,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(b.RDF+"predicate"),v,this.defaultGraph)),this.push(this.dataFactory.quad(S,this.dataFactory.namedNode(b.RDF+"object"),y,this.defaultGraph)))}claimNodeId(M){if(!this.allowDuplicateRdfIds){if(this.nodeIds[M.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${M.value}'.`);this.nodeIds[M.value]=!0}}onText(M){const v=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;v&&(v.childrenStringTags?v.childrenStringTags.push(M):v.predicate&&(v.text=M))}onCloseTag(){const M=this.activeTagStack.pop();if(M.childrenStringEmitClosingTag&&M.childrenStringTags.push(M.childrenStringEmitClosingTag),M.childrenTagsToString&&(M.datatype=this.dataFactory.namedNode(b.RDF+"XMLLiteral"),M.text=M.childrenStringTags.join(""),M.hadChildren=!1),M.childrenCollectionSubject)this.emitTriple(M.childrenCollectionSubject,M.childrenCollectionPredicate,this.dataFactory.namedNode(b.RDF+"nil"),M.reifiedStatementId);else if(M.predicate)if(M.hadChildren||M.childrenParseType===x.PROPERTY){if(!M.predicateEmitted){const v=this.dataFactory.blankNode();this.emitTriple(M.subject,M.predicate,v,M.reifiedStatementId);for(let y=0;y<M.predicateSubPredicates.length;y++)this.emitTriple(v,M.predicateSubPredicates[y],M.predicateSubObjects[y],null)}}else this.emitTriple(M.subject,M.predicate,this.dataFactory.literal(M.text||"",M.datatype||M.language),M.reifiedStatementId)}onDoctype(M){M.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(v,y,S)=>(this.saxStream._parser.ENTITIES[y]=S,""))}}var x,N;pe.RdfXmlParser=b,b.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*):[^ "<>{}|\\\[\]`]*$/,b.MIME_TYPE="application/rdf+xml",b.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",b.XML="http://www.w3.org/XML/1998/namespace",b.XMLNS="http://www.w3.org/2000/xmlns/",b.DEFAULT_NS={xml:b.XML},b.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],b.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],b.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(N=x=pe.ParseType||(pe.ParseType={}))[N.RESOURCE=0]="RESOURCE",N[N.PROPERTY=1]="PROPERTY"},{"./ParseError":65,"rdf-data-factory":56,"relative-to-absolute-iri":82,sax:85,stream:87}],67:[function(K,Ae,pe){"use strict";var U={};function k(N,M,v){v||(v=Error);var S=function(T){function j(O,q,ce){return T.call(this,function(T,j,O){return"string"==typeof M?M:M(T,j,O)}(O,q,ce))||this}return function(N,M){N.prototype=Object.create(M.prototype),N.prototype.constructor=N,N.__proto__=M}(j,T),j}(v);S.prototype.name=v.name,S.prototype.code=N,U[N]=S}function ie(N,M){if(Array.isArray(N)){var v=N.length;return N=N.map(function(y){return String(y)}),v>2?"one of ".concat(M," ").concat(N.slice(0,v-1).join(", "),", or ")+N[v-1]:2===v?"one of ".concat(M," ").concat(N[0]," or ").concat(N[1]):"of ".concat(M," ").concat(N[0])}return"of ".concat(M," ").concat(String(N))}k("ERR_INVALID_OPT_VALUE",function(N,M){return'The value "'+M+'" is invalid for option "'+N+'"'},TypeError),k("ERR_INVALID_ARG_TYPE",function(N,M,v){var y,S;if("string"==typeof M&&function(N,M,v){return N.substr(!v||v<0?0:+v,M.length)===M}(M,"not ")?(y="must not be",M=M.replace(/^not /,"")):y="must be",function(N,M,v){return(void 0===v||v>N.length)&&(v=N.length),N.substring(v-M.length,v)===M}(N," argument"))S="The ".concat(N," ").concat(y," ").concat(ie(M,"type"));else{var T=function(N,M,v){return"number"!=typeof v&&(v=0),!(v+M.length>N.length)&&-1!==N.indexOf(M,v)}(N,".")?"property":"argument";S='The "'.concat(N,'" ').concat(T," ").concat(y," ").concat(ie(M,"type"))}return S+". Received type ".concat(typeof v)},TypeError),k("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),k("ERR_METHOD_NOT_IMPLEMENTED",function(N){return"The "+N+" method is not implemented"}),k("ERR_STREAM_PREMATURE_CLOSE","Premature close"),k("ERR_STREAM_DESTROYED",function(N){return"Cannot call "+N+" after a stream was destroyed"}),k("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),k("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),k("ERR_STREAM_WRITE_AFTER_END","write after end"),k("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),k("ERR_UNKNOWN_ENCODING",function(N){return"Unknown encoding: "+N},TypeError),k("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Ae.exports.codes=U},{}],68:[function(K,Ae,pe){(function(Y){(function(){"use strict";var U=Object.keys||function(y){var S=[];for(var T in y)S.push(T);return S};Ae.exports=N;var k=K("./_stream_readable"),ie=K("./_stream_writable");K("inherits")(N,k);for(var W=U(ie.prototype),b=0;b<W.length;b++){var x=W[b];N.prototype[x]||(N.prototype[x]=ie.prototype[x])}function N(y){if(!(this instanceof N))return new N(y);k.call(this,y),ie.call(this,y),this.allowHalfOpen=!0,y&&(!1===y.readable&&(this.readable=!1),!1===y.writable&&(this.writable=!1),!1===y.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",M)))}function M(){this._writableState.ended||Y.nextTick(v,this)}function v(y){y.end()}Object.defineProperty(N.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(N.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(N.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(S){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=S,this._writableState.destroyed=S)}})}).call(this)}).call(this,K("_process"))},{"./_stream_readable":70,"./_stream_writable":72,_process:44,inherits:10}],69:[function(K,Ae,pe){"use strict";Ae.exports=U;var Y=K("./_stream_transform");function U(k){if(!(this instanceof U))return new U(k);Y.call(this,k)}K("inherits")(U,Y),U.prototype._transform=function(k,ie,W){W(null,k)}},{"./_stream_transform":71,inherits:10}],70:[function(K,Ae,pe){(function(Y,U){(function(){"use strict";var k;Ae.exports=te,te.ReadableState=me,K("events");var W=function(B,P){return B.listeners(P).length},b=K("./internal/streams/stream"),x=K("buffer").Buffer,N=U.Uint8Array||function(){};var S,y=K("util");S=y&&y.debuglog?y.debuglog("stream"):function(){};var G,Q,oe,T=K("./internal/streams/buffer_list"),j=K("./internal/streams/destroy"),q=K("./internal/streams/state").getHighWaterMark,ce=K("../errors").codes,D=ce.ERR_INVALID_ARG_TYPE,I=ce.ERR_STREAM_PUSH_AFTER_EOF,X=ce.ERR_METHOD_NOT_IMPLEMENTED,w=ce.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;K("inherits")(te,b);var se=j.errorOrDestroy,ee=["error","close","destroy","pause","resume"];function me(be,B,P){k=k||K("./_stream_duplex"),"boolean"!=typeof P&&(P=B instanceof k),this.objectMode=!!(be=be||{}).objectMode,P&&(this.objectMode=this.objectMode||!!be.readableObjectMode),this.highWaterMark=q(this,be,"readableHighWaterMark",P),this.buffer=new T,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==be.emitClose,this.autoDestroy=!!be.autoDestroy,this.destroyed=!1,this.defaultEncoding=be.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,be.encoding&&(G||(G=K("string_decoder/").StringDecoder),this.decoder=new G(be.encoding),this.encoding=be.encoding)}function te(be){if(k=k||K("./_stream_duplex"),!(this instanceof te))return new te(be);this._readableState=new me(be,this,this instanceof k),this.readable=!0,be&&("function"==typeof be.read&&(this._read=be.read),"function"==typeof be.destroy&&(this._destroy=be.destroy)),b.call(this)}function _e(be,B,P,V,Re){S("readableAddChunk",B);var vt,Qe=be._readableState;if(null===B)Qe.reading=!1,function(be,B){if(S("onEofChunk"),!B.ended){if(B.decoder){var P=B.decoder.end();P&&P.length&&(B.buffer.push(P),B.length+=B.objectMode?1:P.length)}B.ended=!0,B.sync?Ue(be):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,Le(be)))}}(be,Qe);else if(Re||(vt=function(be,B){var P;return!function(be){return x.isBuffer(be)||be instanceof N}(B)&&"string"!=typeof B&&void 0!==B&&!be.objectMode&&(P=new D("chunk",["string","Buffer","Uint8Array"],B)),P}(Qe,B)),vt)se(be,vt);else if(Qe.objectMode||B&&B.length>0)if("string"!=typeof B&&!Qe.objectMode&&Object.getPrototypeOf(B)!==x.prototype&&(B=function(be){return x.from(be)}(B)),V)Qe.endEmitted?se(be,new w):Oe(be,Qe,B,!0);else if(Qe.ended)se(be,new I);else{if(Qe.destroyed)return!1;Qe.reading=!1,Qe.decoder&&!P?(B=Qe.decoder.write(B),Qe.objectMode||0!==B.length?Oe(be,Qe,B,!1):Ke(be,Qe)):Oe(be,Qe,B,!1)}else V||(Qe.reading=!1,Ke(be,Qe));return!Qe.ended&&(Qe.length<Qe.highWaterMark||0===Qe.length)}function Oe(be,B,P,V){B.flowing&&0===B.length&&!B.sync?(B.awaitDrain=0,be.emit("data",P)):(B.length+=B.objectMode?1:P.length,V?B.buffer.unshift(P):B.buffer.push(P),B.needReadable&&Ue(be)),Ke(be,B)}Object.defineProperty(te.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(B){!this._readableState||(this._readableState.destroyed=B)}}),te.prototype.destroy=j.destroy,te.prototype._undestroy=j.undestroy,te.prototype._destroy=function(be,B){B(be)},te.prototype.push=function(be,B){var V,P=this._readableState;return P.objectMode?V=!0:"string"==typeof be&&((B=B||P.defaultEncoding)!==P.encoding&&(be=x.from(be,B),B=""),V=!0),_e(this,be,B,!1,V)},te.prototype.unshift=function(be){return _e(this,be,null,!0,!1)},te.prototype.isPaused=function(){return!1===this._readableState.flowing},te.prototype.setEncoding=function(be){G||(G=K("string_decoder/").StringDecoder);var B=new G(be);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var P=this._readableState.buffer.head,V="";null!==P;)V+=B.write(P.data),P=P.next;return this._readableState.buffer.clear(),""!==V&&this._readableState.buffer.push(V),this._readableState.length=V.length,this};var rt=1073741824;function Je(be,B){return be<=0||0===B.length&&B.ended?0:B.objectMode?1:be!=be?B.flowing&&B.length?B.buffer.head.data.length:B.length:(be>B.highWaterMark&&(B.highWaterMark=function(be){return be>=rt?be=rt:(be--,be|=be>>>1,be|=be>>>2,be|=be>>>4,be|=be>>>8,be|=be>>>16,be++),be}(be)),be<=B.length?be:B.ended?B.length:(B.needReadable=!0,0))}function Ue(be){var B=be._readableState;S("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(S("emitReadable",B.flowing),B.emittedReadable=!0,Y.nextTick(Le,be))}function Le(be){var B=be._readableState;S("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(be.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,fe(be)}function Ke(be,B){B.readingMore||(B.readingMore=!0,Y.nextTick(xe,be,B))}function xe(be,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&0===B.length);){var P=B.length;if(S("maybeReadMore read 0"),be.read(0),P===B.length)break}B.readingMore=!1}function We(be){var B=be._readableState;B.readableListening=be.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:be.listenerCount("data")>0&&be.resume()}function Pe(be){S("readable nexttick read 0"),be.read(0)}function H(be,B){S("resume",B.reading),B.reading||be.read(0),B.resumeScheduled=!1,be.emit("resume"),fe(be),B.flowing&&!B.reading&&be.read(0)}function fe(be){var B=be._readableState;for(S("flow",B.flowing);B.flowing&&null!==be.read(););}function ue(be,B){return 0===B.length?null:(B.objectMode?P=B.buffer.shift():!be||be>=B.length?(P=B.decoder?B.buffer.join(""):1===B.buffer.length?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):P=B.buffer.consume(be,B.decoder),P);var P}function Ve(be){var B=be._readableState;S("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,Y.nextTick(gt,B,be))}function gt(be,B){if(S("endReadableNT",be.endEmitted,be.length),!be.endEmitted&&0===be.length&&(be.endEmitted=!0,B.readable=!1,B.emit("end"),be.autoDestroy)){var P=B._writableState;(!P||P.autoDestroy&&P.finished)&&B.destroy()}}function ft(be,B){for(var P=0,V=be.length;P<V;P++)if(be[P]===B)return P;return-1}te.prototype.read=function(be){S("read",be),be=parseInt(be,10);var B=this._readableState,P=be;if(0!==be&&(B.emittedReadable=!1),0===be&&B.needReadable&&((0!==B.highWaterMark?B.length>=B.highWaterMark:B.length>0)||B.ended))return S("read: emitReadable",B.length,B.ended),0===B.length&&B.ended?Ve(this):Ue(this),null;if(0===(be=Je(be,B))&&B.ended)return 0===B.length&&Ve(this),null;var Re,V=B.needReadable;return S("need readable",V),(0===B.length||B.length-be<B.highWaterMark)&&S("length less than watermark",V=!0),B.ended||B.reading?S("reading or ended",V=!1):V&&(S("do read"),B.reading=!0,B.sync=!0,0===B.length&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(be=Je(P,B))),null===(Re=be>0?ue(be,B):null)?(B.needReadable=B.length<=B.highWaterMark,be=0):(B.length-=be,B.awaitDrain=0),0===B.length&&(B.ended||(B.needReadable=!0),P!==be&&B.ended&&Ve(this)),null!==Re&&this.emit("data",Re),Re},te.prototype._read=function(be){se(this,new X("_read()"))},te.prototype.pipe=function(be,B){var P=this,V=this._readableState;switch(V.pipesCount){case 0:V.pipes=be;break;case 1:V.pipes=[V.pipes,be];break;default:V.pipes.push(be)}V.pipesCount+=1,S("pipe count=%d opts=%j",V.pipesCount,B);var Qe=B&&!1===B.end||be===Y.stdout||be===Y.stderr?ds:It;function vt(Fs,$r){S("onunpipe"),Fs===P&&$r&&!1===$r.hasUnpiped&&($r.hasUnpiped=!0,S("cleanup"),be.removeListener("close",Gr),be.removeListener("finish",Ns),be.removeListener("drain",Mn),be.removeListener("error",fi),be.removeListener("unpipe",vt),P.removeListener("end",It),P.removeListener("end",ds),P.removeListener("data",bi),Rn=!0,V.awaitDrain&&(!be._writableState||be._writableState.needDrain)&&Mn())}function It(){S("onend"),be.end()}V.endEmitted?Y.nextTick(Qe):P.once("end",Qe),be.on("unpipe",vt);var Mn=function(be){return function(){var P=be._readableState;S("pipeOnDrain",P.awaitDrain),P.awaitDrain&&P.awaitDrain--,0===P.awaitDrain&&W(be,"data")&&(P.flowing=!0,fe(be))}}(P);be.on("drain",Mn);var Rn=!1;function bi(Fs){S("ondata");var $r=be.write(Fs);S("dest.write",$r),!1===$r&&((1===V.pipesCount&&V.pipes===be||V.pipesCount>1&&-1!==ft(V.pipes,be))&&!Rn&&(S("false write response, pause",V.awaitDrain),V.awaitDrain++),P.pause())}function fi(Fs){S("onerror",Fs),ds(),be.removeListener("error",fi),0===W(be,"error")&&se(be,Fs)}function Gr(){be.removeListener("finish",Ns),ds()}function Ns(){S("onfinish"),be.removeListener("close",Gr),ds()}function ds(){S("unpipe"),P.unpipe(be)}return P.on("data",bi),function(be,B,P){if("function"==typeof be.prependListener)return be.prependListener(B,P);be._events&&be._events[B]?Array.isArray(be._events[B])?be._events[B].unshift(P):be._events[B]=[P,be._events[B]]:be.on(B,P)}(be,"error",fi),be.once("close",Gr),be.once("finish",Ns),be.emit("pipe",P),V.flowing||(S("pipe resume"),P.resume()),be},te.prototype.unpipe=function(be){var B=this._readableState,P={hasUnpiped:!1};if(0===B.pipesCount)return this;if(1===B.pipesCount)return be&&be!==B.pipes||(be||(be=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,be&&be.emit("unpipe",this,P)),this;if(!be){var V=B.pipes,Re=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var Qe=0;Qe<Re;Qe++)V[Qe].emit("unpipe",this,{hasUnpiped:!1});return this}var vt=ft(B.pipes,be);return-1===vt||(B.pipes.splice(vt,1),B.pipesCount-=1,1===B.pipesCount&&(B.pipes=B.pipes[0]),be.emit("unpipe",this,P)),this},te.prototype.addListener=te.prototype.on=function(be,B){var P=b.prototype.on.call(this,be,B),V=this._readableState;return"data"===be?(V.readableListening=this.listenerCount("readable")>0,!1!==V.flowing&&this.resume()):"readable"===be&&!V.endEmitted&&!V.readableListening&&(V.readableListening=V.needReadable=!0,V.flowing=!1,V.emittedReadable=!1,S("on readable",V.length,V.reading),V.length?Ue(this):V.reading||Y.nextTick(Pe,this)),P},te.prototype.removeListener=function(be,B){var P=b.prototype.removeListener.call(this,be,B);return"readable"===be&&Y.nextTick(We,this),P},te.prototype.removeAllListeners=function(be){var B=b.prototype.removeAllListeners.apply(this,arguments);return("readable"===be||void 0===be)&&Y.nextTick(We,this),B},te.prototype.resume=function(){var be=this._readableState;return be.flowing||(S("resume"),be.flowing=!be.readableListening,function(be,B){B.resumeScheduled||(B.resumeScheduled=!0,Y.nextTick(H,be,B))}(this,be)),be.paused=!1,this},te.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},te.prototype.wrap=function(be){var B=this,P=this._readableState,V=!1;for(var Re in be.on("end",function(){if(S("wrapped end"),P.decoder&&!P.ended){var vt=P.decoder.end();vt&&vt.length&&B.push(vt)}B.push(null)}),be.on("data",function(vt){S("wrapped data"),P.decoder&&(vt=P.decoder.write(vt)),P.objectMode&&null==vt||!(P.objectMode||vt&&vt.length)||B.push(vt)||(V=!0,be.pause())}),be)void 0===this[Re]&&"function"==typeof be[Re]&&(this[Re]=function(It){return function(){return be[It].apply(be,arguments)}}(Re));for(var Qe=0;Qe<ee.length;Qe++)be.on(ee[Qe],this.emit.bind(this,ee[Qe]));return this._read=function(vt){S("wrapped _read",vt),V&&(V=!1,be.resume())},this},"function"==typeof Symbol&&(te.prototype[Symbol.asyncIterator]=function(){return void 0===Q&&(Q=K("./internal/streams/async_iterator")),Q(this)}),Object.defineProperty(te.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(te.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(te.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),te._fromList=ue,Object.defineProperty(te.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(te.from=function(be,B){return void 0===oe&&(oe=K("./internal/streams/from")),oe(te,be,B)})}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/async_iterator":73,"./internal/streams/buffer_list":74,"./internal/streams/destroy":75,"./internal/streams/from":77,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,events:8,inherits:10,"string_decoder/":88,util:3}],71:[function(K,Ae,pe){"use strict";Ae.exports=N;var Y=K("../errors").codes,U=Y.ERR_METHOD_NOT_IMPLEMENTED,k=Y.ERR_MULTIPLE_CALLBACK,ie=Y.ERR_TRANSFORM_ALREADY_TRANSFORMING,W=Y.ERR_TRANSFORM_WITH_LENGTH_0,b=K("./_stream_duplex");function x(y,S){var T=this._transformState;T.transforming=!1;var j=T.writecb;if(null===j)return this.emit("error",new k);T.writechunk=null,T.writecb=null,null!=S&&this.push(S),j(y);var O=this._readableState;O.reading=!1,(O.needReadable||O.length<O.highWaterMark)&&this._read(O.highWaterMark)}function N(y){if(!(this instanceof N))return new N(y);b.call(this,y),this._transformState={afterTransform:x.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&("function"==typeof y.transform&&(this._transform=y.transform),"function"==typeof y.flush&&(this._flush=y.flush)),this.on("prefinish",M)}function M(){var y=this;"function"!=typeof this._flush||this._readableState.destroyed?v(this,null,null):this._flush(function(S,T){v(y,S,T)})}function v(y,S,T){if(S)return y.emit("error",S);if(null!=T&&y.push(T),y._writableState.length)throw new W;if(y._transformState.transforming)throw new ie;return y.push(null)}K("inherits")(N,b),N.prototype.push=function(y,S){return this._transformState.needTransform=!1,b.prototype.push.call(this,y,S)},N.prototype._transform=function(y,S,T){T(new U("_transform()"))},N.prototype._write=function(y,S,T){var j=this._transformState;if(j.writecb=T,j.writechunk=y,j.writeencoding=S,!j.transforming){var O=this._readableState;(j.needTransform||O.needReadable||O.length<O.highWaterMark)&&this._read(O.highWaterMark)}},N.prototype._read=function(y){var S=this._transformState;null===S.writechunk||S.transforming?S.needTransform=!0:(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform))},N.prototype._destroy=function(y,S){b.prototype._destroy.call(this,y,function(T){S(T)})}},{"../errors":67,"./_stream_duplex":68,inherits:10}],72:[function(K,Ae,pe){(function(Y,U){(function(){"use strict";function ie(fe){var ue=this;this.next=null,this.entry=null,this.finish=function(){!function(fe,ue,Ve){var gt=fe.entry;for(fe.entry=null;gt;){var ft=gt.callback;ue.pendingcb--,ft(Ve),gt=gt.next}ue.corkedRequestsFree.next=fe}(ue,fe)}}var W;Ae.exports=me,me.WritableState=ee;var b={deprecate:K("util-deprecate")},x=K("./internal/streams/stream"),N=K("buffer").Buffer,M=U.Uint8Array||function(){};var Se,S=K("./internal/streams/destroy"),j=K("./internal/streams/state").getHighWaterMark,O=K("../errors").codes,q=O.ERR_INVALID_ARG_TYPE,ce=O.ERR_METHOD_NOT_IMPLEMENTED,D=O.ERR_MULTIPLE_CALLBACK,I=O.ERR_STREAM_CANNOT_PIPE,X=O.ERR_STREAM_DESTROYED,w=O.ERR_STREAM_NULL_VALUES,G=O.ERR_STREAM_WRITE_AFTER_END,Q=O.ERR_UNKNOWN_ENCODING,oe=S.errorOrDestroy;function se(){}function ee(fe,ue,Ve){W=W||K("./_stream_duplex"),"boolean"!=typeof Ve&&(Ve=ue instanceof W),this.objectMode=!!(fe=fe||{}).objectMode,Ve&&(this.objectMode=this.objectMode||!!fe.writableObjectMode),this.highWaterMark=j(this,fe,"writableHighWaterMark",Ve),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===fe.decodeStrings),this.defaultEncoding=fe.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ft){!function(fe,ue){var Ve=fe._writableState,gt=Ve.sync,ft=Ve.writecb;if("function"!=typeof ft)throw new D;if(function(fe){fe.writing=!1,fe.writecb=null,fe.length-=fe.writelen,fe.writelen=0}(Ve),ue)!function(fe,ue,Ve,gt,ft){--ue.pendingcb,Ve?(Y.nextTick(ft,gt),Y.nextTick(Pe,fe,ue),fe._writableState.errorEmitted=!0,oe(fe,gt)):(ft(gt),fe._writableState.errorEmitted=!0,oe(fe,gt),Pe(fe,ue))}(fe,Ve,gt,ue,ft);else{var be=xe(Ve)||fe.destroyed;!be&&!Ve.corked&&!Ve.bufferProcessing&&Ve.bufferedRequest&&Ke(fe,Ve),gt?Y.nextTick(Ue,fe,Ve,be,ft):Ue(fe,Ve,be,ft)}}(ue,ft)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==fe.emitClose,this.autoDestroy=!!fe.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new ie(this)}function me(fe){var ue=this instanceof(W=W||K("./_stream_duplex"));if(!ue&&!Se.call(me,this))return new me(fe);this._writableState=new ee(fe,this,ue),this.writable=!0,fe&&("function"==typeof fe.write&&(this._write=fe.write),"function"==typeof fe.writev&&(this._writev=fe.writev),"function"==typeof fe.destroy&&(this._destroy=fe.destroy),"function"==typeof fe.final&&(this._final=fe.final)),x.call(this)}function Ge(fe,ue,Ve,gt,ft,be){if(!Ve){var B=function(fe,ue,Ve){return!fe.objectMode&&!1!==fe.decodeStrings&&"string"==typeof ue&&(ue=N.from(ue,Ve)),ue}(ue,gt,ft);gt!==B&&(Ve=!0,ft="buffer",gt=B)}var P=ue.objectMode?1:gt.length;ue.length+=P;var V=ue.length<ue.highWaterMark;if(V||(ue.needDrain=!0),ue.writing||ue.corked){var Re=ue.lastBufferedRequest;ue.lastBufferedRequest={chunk:gt,encoding:ft,isBuf:Ve,callback:be,next:null},Re?Re.next=ue.lastBufferedRequest:ue.bufferedRequest=ue.lastBufferedRequest,ue.bufferedRequestCount+=1}else rt(fe,ue,!1,P,gt,ft,be);return V}function rt(fe,ue,Ve,gt,ft,be,B){ue.writelen=gt,ue.writecb=B,ue.writing=!0,ue.sync=!0,ue.destroyed?ue.onwrite(new X("write")):Ve?fe._writev(ft,ue.onwrite):fe._write(ft,be,ue.onwrite),ue.sync=!1}function Ue(fe,ue,Ve,gt){Ve||function(fe,ue){0===ue.length&&ue.needDrain&&(ue.needDrain=!1,fe.emit("drain"))}(fe,ue),ue.pendingcb--,gt(),Pe(fe,ue)}function Ke(fe,ue){ue.bufferProcessing=!0;var Ve=ue.bufferedRequest;if(fe._writev&&Ve&&Ve.next){var ft=new Array(ue.bufferedRequestCount),be=ue.corkedRequestsFree;be.entry=Ve;for(var B=0,P=!0;Ve;)ft[B]=Ve,Ve.isBuf||(P=!1),Ve=Ve.next,B+=1;ft.allBuffers=P,rt(fe,ue,!0,ue.length,ft,"",be.finish),ue.pendingcb++,ue.lastBufferedRequest=null,be.next?(ue.corkedRequestsFree=be.next,be.next=null):ue.corkedRequestsFree=new ie(ue),ue.bufferedRequestCount=0}else{for(;Ve;){var V=Ve.chunk;if(rt(fe,ue,!1,ue.objectMode?1:V.length,V,Ve.encoding,Ve.callback),Ve=Ve.next,ue.bufferedRequestCount--,ue.writing)break}null===Ve&&(ue.lastBufferedRequest=null)}ue.bufferedRequest=Ve,ue.bufferProcessing=!1}function xe(fe){return fe.ending&&0===fe.length&&null===fe.bufferedRequest&&!fe.finished&&!fe.writing}function je(fe,ue){fe._final(function(Ve){ue.pendingcb--,Ve&&oe(fe,Ve),ue.prefinished=!0,fe.emit("prefinish"),Pe(fe,ue)})}function Pe(fe,ue){var Ve=xe(ue);if(Ve&&(function(fe,ue){!ue.prefinished&&!ue.finalCalled&&("function"!=typeof fe._final||ue.destroyed?(ue.prefinished=!0,fe.emit("prefinish")):(ue.pendingcb++,ue.finalCalled=!0,Y.nextTick(je,fe,ue)))}(fe,ue),0===ue.pendingcb&&(ue.finished=!0,fe.emit("finish"),ue.autoDestroy))){var gt=fe._readableState;(!gt||gt.autoDestroy&&gt.endEmitted)&&fe.destroy()}return Ve}K("inherits")(me,x),ee.prototype.getBuffer=function(){for(var ue=this.bufferedRequest,Ve=[];ue;)Ve.push(ue),ue=ue.next;return Ve},function(){try{Object.defineProperty(ee.prototype,"buffer",{get:b.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(fe){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(Se=Function.prototype[Symbol.hasInstance],Object.defineProperty(me,Symbol.hasInstance,{value:function(ue){return!!Se.call(this,ue)||this===me&&ue&&ue._writableState instanceof ee}})):Se=function(ue){return ue instanceof this},me.prototype.pipe=function(){oe(this,new I)},me.prototype.write=function(fe,ue,Ve){var gt=this._writableState,ft=!1,be=!gt.objectMode&&function(fe){return N.isBuffer(fe)||fe instanceof M}(fe);return be&&!N.isBuffer(fe)&&(fe=function(fe){return N.from(fe)}(fe)),"function"==typeof ue&&(Ve=ue,ue=null),be?ue="buffer":ue||(ue=gt.defaultEncoding),"function"!=typeof Ve&&(Ve=se),gt.ending?function(fe,ue){var Ve=new G;oe(fe,Ve),Y.nextTick(ue,Ve)}(this,Ve):(be||function(fe,ue,Ve,gt){var ft;return null===Ve?ft=new w:"string"!=typeof Ve&&!ue.objectMode&&(ft=new q("chunk",["string","Buffer"],Ve)),!ft||(oe(fe,ft),Y.nextTick(gt,ft),!1)}(this,gt,fe,Ve))&&(gt.pendingcb++,ft=Ge(this,gt,be,fe,ue,Ve)),ft},me.prototype.cork=function(){this._writableState.corked++},me.prototype.uncork=function(){var fe=this._writableState;fe.corked&&(fe.corked--,!fe.writing&&!fe.corked&&!fe.bufferProcessing&&fe.bufferedRequest&&Ke(this,fe))},me.prototype.setDefaultEncoding=function(ue){if("string"==typeof ue&&(ue=ue.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ue+"").toLowerCase())>-1))throw new Q(ue);return this._writableState.defaultEncoding=ue,this},Object.defineProperty(me.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(me.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),me.prototype._write=function(fe,ue,Ve){Ve(new ce("_write()"))},me.prototype._writev=null,me.prototype.end=function(fe,ue,Ve){var gt=this._writableState;return"function"==typeof fe?(Ve=fe,fe=null,ue=null):"function"==typeof ue&&(Ve=ue,ue=null),null!=fe&&this.write(fe,ue),gt.corked&&(gt.corked=1,this.uncork()),gt.ending||function(fe,ue,Ve){ue.ending=!0,Pe(fe,ue),Ve&&(ue.finished?Y.nextTick(Ve):fe.once("finish",Ve)),ue.ended=!0,fe.writable=!1}(this,gt,Ve),this},Object.defineProperty(me.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(me.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(ue){!this._writableState||(this._writableState.destroyed=ue)}}),me.prototype.destroy=S.destroy,me.prototype._undestroy=S.undestroy,me.prototype._destroy=function(fe,ue){ue(fe)}}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":67,"./_stream_duplex":68,"./internal/streams/destroy":75,"./internal/streams/state":79,"./internal/streams/stream":80,_process:44,buffer:6,inherits:10,"util-deprecate":90}],73:[function(K,Ae,pe){(function(Y){(function(){"use strict";var U;function k(I,X,w){return X in I?Object.defineProperty(I,X,{value:w,enumerable:!0,configurable:!0,writable:!0}):I[X]=w,I}var ie=K("./end-of-stream"),W=Symbol("lastResolve"),b=Symbol("lastReject"),x=Symbol("error"),N=Symbol("ended"),M=Symbol("lastPromise"),v=Symbol("handlePromise"),y=Symbol("stream");function S(I,X){return{value:I,done:X}}function T(I){var X=I[W];if(null!==X){var w=I[y].read();null!==w&&(I[M]=null,I[W]=null,I[b]=null,X(S(w,!1)))}}function j(I){Y.nextTick(T,I)}var q=Object.getPrototypeOf(function(){}),ce=Object.setPrototypeOf((k(U={get stream(){return this[y]},next:function(){var X=this,w=this[x];if(null!==w)return Promise.reject(w);if(this[N])return Promise.resolve(S(void 0,!0));if(this[y].destroyed)return new Promise(function(se,ee){Y.nextTick(function(){X[x]?ee(X[x]):se(S(void 0,!0))})});var Q,G=this[M];if(G)Q=new Promise(function(I,X){return function(w,G){I.then(function(){X[N]?w(S(void 0,!0)):X[v](w,G)},G)}}(G,this));else{var oe=this[y].read();if(null!==oe)return Promise.resolve(S(oe,!1));Q=new Promise(this[v])}return this[M]=Q,Q}},Symbol.asyncIterator,function(){return this}),k(U,"return",function(){var X=this;return new Promise(function(w,G){X[y].destroy(null,function(Q){Q?G(Q):w(S(void 0,!0))})})}),U),q);Ae.exports=function(X){var w,G=Object.create(ce,(k(w={},y,{value:X,writable:!0}),k(w,W,{value:null,writable:!0}),k(w,b,{value:null,writable:!0}),k(w,x,{value:null,writable:!0}),k(w,N,{value:X._readableState.endEmitted,writable:!0}),k(w,v,{value:function(oe,se){var ee=G[y].read();ee?(G[M]=null,G[W]=null,G[b]=null,oe(S(ee,!1))):(G[W]=oe,G[b]=se)},writable:!0}),w));return G[M]=null,ie(X,function(Q){if(Q&&"ERR_STREAM_PREMATURE_CLOSE"!==Q.code){var oe=G[b];return null!==oe&&(G[M]=null,G[W]=null,G[b]=null,oe(Q)),void(G[x]=Q)}var se=G[W];null!==se&&(G[M]=null,G[W]=null,G[b]=null,se(S(void 0,!0))),G[N]=!0}),X.on("readable",j.bind(null,G)),G}}).call(this)}).call(this,K("_process"))},{"./end-of-stream":76,_process:44}],74:[function(K,Ae,pe){"use strict";function Y(T,j){var O=Object.keys(T);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(T);j&&(q=q.filter(function(ce){return Object.getOwnPropertyDescriptor(T,ce).enumerable})),O.push.apply(O,q)}return O}function k(T,j,O){return j in T?Object.defineProperty(T,j,{value:O,enumerable:!0,configurable:!0,writable:!0}):T[j]=O,T}function W(T,j){for(var O=0;O<j.length;O++){var q=j[O];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(T,q.key,q)}}var N=K("buffer").Buffer,v=K("util").inspect,y=v&&v.custom||"inspect";function S(T,j,O){N.prototype.copy.call(T,j,O)}Ae.exports=function(){function T(){(function(T,j){if(!(T instanceof j))throw new TypeError("Cannot call a class as a function")})(this,T),this.head=null,this.tail=null,this.length=0}return function(T,j,O){j&&W(T.prototype,j),O&&W(T,O)}(T,[{key:"push",value:function(O){var q={data:O,next:null};this.length>0?this.tail.next=q:this.head=q,this.tail=q,++this.length}},{key:"unshift",value:function(O){var q={data:O,next:this.head};0===this.length&&(this.tail=q),this.head=q,++this.length}},{key:"shift",value:function(){if(0!==this.length){var O=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,O}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(O){if(0===this.length)return"";for(var q=this.head,ce=""+q.data;q=q.next;)ce+=O+q.data;return ce}},{key:"concat",value:function(O){if(0===this.length)return N.alloc(0);for(var q=N.allocUnsafe(O>>>0),ce=this.head,D=0;ce;)S(ce.data,q,D),D+=ce.data.length,ce=ce.next;return q}},{key:"consume",value:function(O,q){var ce;return O<this.head.data.length?(ce=this.head.data.slice(0,O),this.head.data=this.head.data.slice(O)):ce=O===this.head.data.length?this.shift():q?this._getString(O):this._getBuffer(O),ce}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(O){var q=this.head,ce=1,D=q.data;for(O-=D.length;q=q.next;){var I=q.data,X=O>I.length?I.length:O;if(D+=X===I.length?I:I.slice(0,O),0==(O-=X)){X===I.length?(++ce,this.head=q.next?q.next:this.tail=null):(this.head=q,q.data=I.slice(X));break}++ce}return this.length-=ce,D}},{key:"_getBuffer",value:function(O){var q=N.allocUnsafe(O),ce=this.head,D=1;for(ce.data.copy(q),O-=ce.data.length;ce=ce.next;){var I=ce.data,X=O>I.length?I.length:O;if(I.copy(q,q.length-O,0,X),0==(O-=X)){X===I.length?(++D,this.head=ce.next?ce.next:this.tail=null):(this.head=ce,ce.data=I.slice(X));break}++D}return this.length-=D,q}},{key:y,value:function(O,q){return v(this,function(T){for(var j=1;j<arguments.length;j++){var O=null!=arguments[j]?arguments[j]:{};j%2?Y(Object(O),!0).forEach(function(q){k(T,q,O[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(O)):Y(Object(O)).forEach(function(q){Object.defineProperty(T,q,Object.getOwnPropertyDescriptor(O,q))})}return T}({},q,{depth:0,customInspect:!1}))}}]),T}()},{buffer:6,util:3}],75:[function(K,Ae,pe){(function(Y){(function(){"use strict";function k(N,M){b(N,M),ie(N)}function ie(N){N._writableState&&!N._writableState.emitClose||N._readableState&&!N._readableState.emitClose||N.emit("close")}function b(N,M){N.emit("error",M)}Ae.exports={destroy:function(N,M){var v=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(M?M(N):N&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Y.nextTick(b,this,N)):Y.nextTick(b,this,N)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(N||null,function(T){!M&&T?v._writableState?v._writableState.errorEmitted?Y.nextTick(ie,v):(v._writableState.errorEmitted=!0,Y.nextTick(k,v,T)):Y.nextTick(k,v,T):M?(Y.nextTick(ie,v),M(T)):Y.nextTick(ie,v)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(N,M){var v=N._readableState,y=N._writableState;v&&v.autoDestroy||y&&y.autoDestroy?N.destroy(M):N.emit("error",M)}}}).call(this)}).call(this,K("_process"))},{_process:44}],76:[function(K,Ae,pe){"use strict";var Y=K("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function k(){}Ae.exports=function W(b,x,N){if("function"==typeof x)return W(b,null,x);x||(x={}),N=function(b){var x=!1;return function(){if(!x){x=!0;for(var N=arguments.length,M=new Array(N),v=0;v<N;v++)M[v]=arguments[v];b.apply(this,M)}}}(N||k);var M=x.readable||!1!==x.readable&&b.readable,v=x.writable||!1!==x.writable&&b.writable,y=function(){b.writable||T()},S=b._writableState&&b._writableState.finished,T=function(){v=!1,S=!0,M||N.call(b)},j=b._readableState&&b._readableState.endEmitted,O=function(){M=!1,j=!0,v||N.call(b)},q=function(X){N.call(b,X)},ce=function(){var X;return M&&!j?((!b._readableState||!b._readableState.ended)&&(X=new Y),N.call(b,X)):v&&!S?((!b._writableState||!b._writableState.ended)&&(X=new Y),N.call(b,X)):void 0},D=function(){b.req.on("finish",T)};return function(b){return b.setHeader&&"function"==typeof b.abort}(b)?(b.on("complete",T),b.on("abort",ce),b.req?D():b.on("request",D)):v&&!b._writableState&&(b.on("end",y),b.on("close",y)),b.on("end",O),b.on("finish",T),!1!==x.error&&b.on("error",q),b.on("close",ce),function(){b.removeListener("complete",T),b.removeListener("abort",ce),b.removeListener("request",D),b.req&&b.req.removeListener("finish",T),b.removeListener("end",y),b.removeListener("close",y),b.removeListener("finish",T),b.removeListener("end",O),b.removeListener("error",q),b.removeListener("close",ce)}}},{"../../../errors":67}],77:[function(K,Ae,pe){Ae.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],78:[function(K,Ae,pe){"use strict";var Y;var k=K("../../../errors").codes,ie=k.ERR_MISSING_ARGS,W=k.ERR_STREAM_DESTROYED;function b(T){if(T)throw T}function N(T,j,O,q){q=function(T){var j=!1;return function(){j||(j=!0,T.apply(void 0,arguments))}}(q);var ce=!1;T.on("close",function(){ce=!0}),void 0===Y&&(Y=K("./end-of-stream")),Y(T,{readable:j,writable:O},function(I){if(I)return q(I);ce=!0,q()});var D=!1;return function(I){if(!ce&&!D){if(D=!0,function(T){return T.setHeader&&"function"==typeof T.abort}(T))return T.abort();if("function"==typeof T.destroy)return T.destroy();q(I||new W("pipe"))}}}function M(T){T()}function v(T,j){return T.pipe(j)}function y(T){return T.length&&"function"==typeof T[T.length-1]?T.pop():b}Ae.exports=function(){for(var T=arguments.length,j=new Array(T),O=0;O<T;O++)j[O]=arguments[O];var q=y(j);if(Array.isArray(j[0])&&(j=j[0]),j.length<2)throw new ie("streams");var ce,D=j.map(function(I,X){var w=X<j.length-1;return N(I,w,X>0,function(Q){ce||(ce=Q),Q&&D.forEach(M),!w&&(D.forEach(M),q(ce))})});return j.reduce(v)}},{"../../../errors":67,"./end-of-stream":76}],79:[function(K,Ae,pe){"use strict";var Y=K("../../../errors").codes.ERR_INVALID_OPT_VALUE;Ae.exports={getHighWaterMark:function(ie,W,b,x){var N=function(ie,W,b){return null!=ie.highWaterMark?ie.highWaterMark:W?ie[b]:null}(W,x,b);if(null!=N){if(!isFinite(N)||Math.floor(N)!==N||N<0)throw new Y(x?b:"highWaterMark",N);return Math.floor(N)}return ie.objectMode?16:16384}}},{"../../../errors":67}],80:[function(K,Ae,pe){Ae.exports=K("events").EventEmitter},{events:8}],81:[function(K,Ae,pe){(pe=Ae.exports=K("./lib/_stream_readable.js")).Stream=pe,pe.Readable=pe,pe.Writable=K("./lib/_stream_writable.js"),pe.Duplex=K("./lib/_stream_duplex.js"),pe.Transform=K("./lib/_stream_transform.js"),pe.PassThrough=K("./lib/_stream_passthrough.js"),pe.finished=K("./lib/internal/streams/end-of-stream.js"),pe.pipeline=K("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":68,"./lib/_stream_passthrough.js":69,"./lib/_stream_readable.js":70,"./lib/_stream_transform.js":71,"./lib/_stream_writable.js":72,"./lib/internal/streams/end-of-stream.js":76,"./lib/internal/streams/pipeline.js":78}],82:[function(K,Ae,pe){"use strict";Object.defineProperty(pe,"__esModule",{value:!0}),function(U){for(var k in U)pe.hasOwnProperty(k)||(pe[k]=U[k])}(K("./lib/Resolve"))},{"./lib/Resolve":83}],83:[function(K,Ae,pe){"use strict";function U(W){const b=[];let x=0;for(;x<W.length;)switch(W[x]){case"/":if("."===W[x+1])if("."===W[x+2]){if(!ie(W[x+3])){b.push([]),x++;break}b.pop(),W[x+3]||b.push([]),x+=3}else{if(!ie(W[x+2])){b.push([]),x++;break}W[x+2]||b.push([]),x+=2}else b.push([]),x++;break;case"#":case"?":b.length||b.push([]),b[b.length-1].push(W.substr(x)),x=W.length;break;default:b.length||b.push([]),b[b.length-1].push(W[x]),x++}return"/"+b.map(N=>N.join("")).join("/")}function k(W,b){let x=b+1;b>=0?"/"===W[b+1]&&"/"===W[b+2]&&(x=b+3):"/"===W[0]&&"/"===W[1]&&(x=2);const N=W.indexOf("/",x);return N<0?W:W.substr(0,N)+U(W.substr(N))}function ie(W){return!W||"#"===W||"?"===W||"/"===W}Object.defineProperty(pe,"__esModule",{value:!0}),pe.resolve=function(W,b){const x=(b=b||"").indexOf("#");if(x>0&&(b=b.substr(0,x)),!W.length){if(b.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${b}' for value '${W}'`);return b}if(W.startsWith("?")){const j=b.indexOf("?");return j>0&&(b=b.substr(0,j)),b+W}if(W.startsWith("#"))return b+W;if(!b.length){const j=W.indexOf(":");if(j<0)throw new Error(`Found invalid relative IRI '${W}' for a missing baseIRI`);return k(W,j)}const N=W.indexOf(":");if(N>=0)return k(W,N);const M=b.indexOf(":");if(M<0)throw new Error(`Found invalid baseIRI '${b}' for value '${W}'`);const v=b.substr(0,M+1);if(0===W.indexOf("//"))return v+k(W,N);let y;if(b.indexOf("//",M)===M+1){if(y=b.indexOf("/",M+3),y<0)return b.length>M+3?b+"/"+k(W,N):v+k(W,N)}else if(y=b.indexOf("/",M+1),y<0)return v+k(W,N);if(0===W.indexOf("/"))return b.substr(0,y)+U(W);let S=b.substr(y);const T=S.lastIndexOf("/");return T>=0&&T<S.length-1&&(S=S.substr(0,T+1),"."===W[0]&&"."!==W[1]&&"/"!==W[1]&&W[2]&&(W=W.substr(1))),W=U(W=S+W),b.substr(0,y)+W},pe.removeDotSegments=U,pe.removeDotSegmentsOfPath=k},{}],84:[function(K,Ae,pe){var Y=K("buffer"),U=Y.Buffer;function k(W,b){for(var x in W)b[x]=W[x]}function ie(W,b,x){return U(W,b,x)}U.from&&U.alloc&&U.allocUnsafe&&U.allocUnsafeSlow?Ae.exports=Y:(k(Y,pe),pe.Buffer=ie),ie.prototype=Object.create(U.prototype),k(U,ie),ie.from=function(W,b,x){if("number"==typeof W)throw new TypeError("Argument must not be a number");return U(W,b,x)},ie.alloc=function(W,b,x){if("number"!=typeof W)throw new TypeError("Argument must be a number");var N=U(W);return void 0!==b?"string"==typeof x?N.fill(b,x):N.fill(b):N.fill(0),N},ie.allocUnsafe=function(W){if("number"!=typeof W)throw new TypeError("Argument must be a number");return U(W)},ie.allocUnsafeSlow=function(W){if("number"!=typeof W)throw new TypeError("Argument must be a number");return Y.SlowBuffer(W)}},{buffer:6}],85:[function(K,Ae,pe){(function(Y){(function(){!function(U){U.parser=function($,H){return new ie($,H)},U.SAXParser=ie,U.SAXStream=y,U.createStream=function($,H){return new y($,H)},U.MAX_BUFFER_LENGTH=65536;var N,k=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function ie($,H){if(!(this instanceof ie))return new ie($,H);var fe=this;(function($){for(var H=0,fe=k.length;H<fe;H++)$[k[H]]=""})(fe),fe.q=fe.c="",fe.bufferCheckPosition=U.MAX_BUFFER_LENGTH,fe.opt=H||{},fe.opt.lowercase=fe.opt.lowercase||fe.opt.lowercasetags,fe.looseCase=fe.opt.lowercase?"toLowerCase":"toUpperCase",fe.tags=[],fe.closed=fe.closedRoot=fe.sawRoot=!1,fe.tag=fe.error=null,fe.strict=!!$,fe.noscript=!(!$&&!fe.opt.noscript),fe.state=ee.BEGIN,fe.strictEntities=fe.opt.strictEntities,fe.ENTITIES=Object.create(fe.strictEntities?U.XML_ENTITIES:U.ENTITIES),fe.attribList=[],fe.opt.xmlns&&(fe.ns=Object.create(q)),fe.trackPosition=!1!==fe.opt.position,fe.trackPosition&&(fe.position=fe.line=fe.column=0),me(fe,"onready")}U.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function($){function H(){}return H.prototype=$,new H}),Object.keys||(Object.keys=function($){var H=[];for(var fe in $)$.hasOwnProperty(fe)&&H.push(fe);return H}),ie.prototype={end:function(){rt(this)},write:function($){var H=this;if(this.error)throw this.error;if(H.closed)return Ge(H,"Cannot write after close. Assign an onready handler.");if(null===$)return rt(H);"object"==typeof $&&($=$.toString());for(var fe=0,ue="";ue=We($,fe++),H.c=ue,ue;)switch(H.trackPosition&&(H.position++,"\n"===ue?(H.line++,H.column=0):H.column++),H.state){case ee.BEGIN:if(H.state=ee.BEGIN_WHITESPACE,"\ufeff"===ue)continue;je(H,ue);continue;case ee.BEGIN_WHITESPACE:je(H,ue);continue;case ee.TEXT:if(H.sawRoot&&!H.closedRoot){for(var Ve=fe-1;ue&&"<"!==ue&&"&"!==ue;)(ue=We($,fe++))&&H.trackPosition&&(H.position++,"\n"===ue?(H.line++,H.column=0):H.column++);H.textNode+=$.substring(Ve,fe-1)}"<"!==ue||H.sawRoot&&H.closedRoot&&!H.strict?(!w(ue)&&(!H.sawRoot||H.closedRoot)&&Xe(H,"Text data outside of root node."),"&"===ue?H.state=ee.TEXT_ENTITY:H.textNode+=ue):(H.state=ee.OPEN_WAKA,H.startTagPosition=H.position);continue;case ee.SCRIPT:"<"===ue?H.state=ee.SCRIPT_ENDING:H.script+=ue;continue;case ee.SCRIPT_ENDING:"/"===ue?H.state=ee.CLOSE_TAG:(H.script+="<"+ue,H.state=ee.SCRIPT);continue;case ee.OPEN_WAKA:"!"===ue?(H.state=ee.SGML_DECL,H.sgmlDecl=""):w(ue)||(oe(ce,ue)?(H.state=ee.OPEN_TAG,H.tagName=ue):"/"===ue?(H.state=ee.CLOSE_TAG,H.tagName=""):"?"===ue?(H.state=ee.PROC_INST,H.procInstName=H.procInstBody=""):(Xe(H,"Unencoded <"),H.startTagPosition+1<H.position&&(ue=new Array(H.position-H.startTagPosition).join(" ")+ue),H.textNode+="<"+ue,H.state=ee.TEXT));continue;case ee.SGML_DECL:"[CDATA["===(H.sgmlDecl+ue).toUpperCase()?(te(H,"onopencdata"),H.state=ee.CDATA,H.sgmlDecl="",H.cdata=""):H.sgmlDecl+ue==="--"?(H.state=ee.COMMENT,H.comment="",H.sgmlDecl=""):"DOCTYPE"===(H.sgmlDecl+ue).toUpperCase()?(H.state=ee.DOCTYPE,(H.doctype||H.sawRoot)&&Xe(H,"Inappropriately located doctype declaration"),H.doctype="",H.sgmlDecl=""):">"===ue?(te(H,"onsgmldeclaration",H.sgmlDecl),H.sgmlDecl="",H.state=ee.TEXT):(G(ue)&&(H.state=ee.SGML_DECL_QUOTED),H.sgmlDecl+=ue);continue;case ee.SGML_DECL_QUOTED:ue===H.q&&(H.state=ee.SGML_DECL,H.q=""),H.sgmlDecl+=ue;continue;case ee.DOCTYPE:">"===ue?(H.state=ee.TEXT,te(H,"ondoctype",H.doctype),H.doctype=!0):(H.doctype+=ue,"["===ue?H.state=ee.DOCTYPE_DTD:G(ue)&&(H.state=ee.DOCTYPE_QUOTED,H.q=ue));continue;case ee.DOCTYPE_QUOTED:H.doctype+=ue,ue===H.q&&(H.q="",H.state=ee.DOCTYPE);continue;case ee.DOCTYPE_DTD:H.doctype+=ue,"]"===ue?H.state=ee.DOCTYPE:G(ue)&&(H.state=ee.DOCTYPE_DTD_QUOTED,H.q=ue);continue;case ee.DOCTYPE_DTD_QUOTED:H.doctype+=ue,ue===H.q&&(H.state=ee.DOCTYPE_DTD,H.q="");continue;case ee.COMMENT:"-"===ue?H.state=ee.COMMENT_ENDING:H.comment+=ue;continue;case ee.COMMENT_ENDING:"-"===ue?(H.state=ee.COMMENT_ENDED,H.comment=Oe(H.opt,H.comment),H.comment&&te(H,"oncomment",H.comment),H.comment=""):(H.comment+="-"+ue,H.state=ee.COMMENT);continue;case ee.COMMENT_ENDED:">"!==ue?(Xe(H,"Malformed comment"),H.comment+="--"+ue,H.state=ee.COMMENT):H.state=ee.TEXT;continue;case ee.CDATA:"]"===ue?H.state=ee.CDATA_ENDING:H.cdata+=ue;continue;case ee.CDATA_ENDING:"]"===ue?H.state=ee.CDATA_ENDING_2:(H.cdata+="]"+ue,H.state=ee.CDATA);continue;case ee.CDATA_ENDING_2:">"===ue?(H.cdata&&te(H,"oncdata",H.cdata),te(H,"onclosecdata"),H.cdata="",H.state=ee.TEXT):"]"===ue?H.cdata+="]":(H.cdata+="]]"+ue,H.state=ee.CDATA);continue;case ee.PROC_INST:"?"===ue?H.state=ee.PROC_INST_ENDING:w(ue)?H.state=ee.PROC_INST_BODY:H.procInstName+=ue;continue;case ee.PROC_INST_BODY:if(!H.procInstBody&&w(ue))continue;"?"===ue?H.state=ee.PROC_INST_ENDING:H.procInstBody+=ue;continue;case ee.PROC_INST_ENDING:">"===ue?(te(H,"onprocessinginstruction",{name:H.procInstName,body:H.procInstBody}),H.procInstName=H.procInstBody="",H.state=ee.TEXT):(H.procInstBody+="?"+ue,H.state=ee.PROC_INST_BODY);continue;case ee.OPEN_TAG:oe(D,ue)?H.tagName+=ue:(Je(H),">"===ue?Le(H):"/"===ue?H.state=ee.OPEN_TAG_SLASH:(w(ue)||Xe(H,"Invalid character in tag name"),H.state=ee.ATTRIB));continue;case ee.OPEN_TAG_SLASH:">"===ue?(Le(H,!0),Ke(H)):(Xe(H,"Forward-slash in opening tag not followed by >"),H.state=ee.ATTRIB);continue;case ee.ATTRIB:if(w(ue))continue;">"===ue?Le(H):"/"===ue?H.state=ee.OPEN_TAG_SLASH:oe(ce,ue)?(H.attribName=ue,H.attribValue="",H.state=ee.ATTRIB_NAME):Xe(H,"Invalid attribute name");continue;case ee.ATTRIB_NAME:"="===ue?H.state=ee.ATTRIB_VALUE:">"===ue?(Xe(H,"Attribute without value"),H.attribValue=H.attribName,Ue(H),Le(H)):w(ue)?H.state=ee.ATTRIB_NAME_SAW_WHITE:oe(D,ue)?H.attribName+=ue:Xe(H,"Invalid attribute name");continue;case ee.ATTRIB_NAME_SAW_WHITE:if("="===ue)H.state=ee.ATTRIB_VALUE;else{if(w(ue))continue;Xe(H,"Attribute without value"),H.tag.attributes[H.attribName]="",H.attribValue="",te(H,"onattribute",{name:H.attribName,value:""}),H.attribName="",">"===ue?Le(H):oe(ce,ue)?(H.attribName=ue,H.state=ee.ATTRIB_NAME):(Xe(H,"Invalid attribute name"),H.state=ee.ATTRIB)}continue;case ee.ATTRIB_VALUE:if(w(ue))continue;G(ue)?(H.q=ue,H.state=ee.ATTRIB_VALUE_QUOTED):(Xe(H,"Unquoted attribute value"),H.state=ee.ATTRIB_VALUE_UNQUOTED,H.attribValue=ue);continue;case ee.ATTRIB_VALUE_QUOTED:if(ue!==H.q){"&"===ue?H.state=ee.ATTRIB_VALUE_ENTITY_Q:H.attribValue+=ue;continue}Ue(H),H.q="",H.state=ee.ATTRIB_VALUE_CLOSED;continue;case ee.ATTRIB_VALUE_CLOSED:w(ue)?H.state=ee.ATTRIB:">"===ue?Le(H):"/"===ue?H.state=ee.OPEN_TAG_SLASH:oe(ce,ue)?(Xe(H,"No whitespace between attributes"),H.attribName=ue,H.attribValue="",H.state=ee.ATTRIB_NAME):Xe(H,"Invalid attribute name");continue;case ee.ATTRIB_VALUE_UNQUOTED:if(!Q(ue)){"&"===ue?H.state=ee.ATTRIB_VALUE_ENTITY_U:H.attribValue+=ue;continue}Ue(H),">"===ue?Le(H):H.state=ee.ATTRIB;continue;case ee.CLOSE_TAG:if(H.tagName)">"===ue?Ke(H):oe(D,ue)?H.tagName+=ue:H.script?(H.script+="</"+H.tagName,H.tagName="",H.state=ee.SCRIPT):(w(ue)||Xe(H,"Invalid tagname in closing tag"),H.state=ee.CLOSE_TAG_SAW_WHITE);else{if(w(ue))continue;se(ce,ue)?H.script?(H.script+="</"+ue,H.state=ee.SCRIPT):Xe(H,"Invalid tagname in closing tag."):H.tagName=ue}continue;case ee.CLOSE_TAG_SAW_WHITE:if(w(ue))continue;">"===ue?Ke(H):Xe(H,"Invalid characters in closing tag");continue;case ee.TEXT_ENTITY:case ee.ATTRIB_VALUE_ENTITY_Q:case ee.ATTRIB_VALUE_ENTITY_U:var ft,be;switch(H.state){case ee.TEXT_ENTITY:ft=ee.TEXT,be="textNode";break;case ee.ATTRIB_VALUE_ENTITY_Q:ft=ee.ATTRIB_VALUE_QUOTED,be="attribValue";break;case ee.ATTRIB_VALUE_ENTITY_U:ft=ee.ATTRIB_VALUE_UNQUOTED,be="attribValue"}";"===ue?(H[be]+=xe(H),H.entity="",H.state=ft):oe(H.entity.length?X:I,ue)?H.entity+=ue:(Xe(H,"Invalid character in entity name"),H[be]+="&"+H.entity+ue,H.entity="",H.state=ft);continue;default:throw new Error(H,"Unknown state: "+H.state)}return H.position>=H.bufferCheckPosition&&function($){for(var H=Math.max(U.MAX_BUFFER_LENGTH,10),fe=0,ue=0,Ve=k.length;ue<Ve;ue++){var gt=$[k[ue]].length;if(gt>H)switch(k[ue]){case"textNode":_e($);break;case"cdata":te($,"oncdata",$.cdata),$.cdata="";break;case"script":te($,"onscript",$.script),$.script="";break;default:Ge($,"Max buffer length exceeded: "+k[ue])}fe=Math.max(fe,gt)}$.bufferCheckPosition=U.MAX_BUFFER_LENGTH-fe+$.position}(H),H},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function($){_e($),""!==$.cdata&&(te($,"oncdata",$.cdata),$.cdata=""),""!==$.script&&(te($,"onscript",$.script),$.script="")}(this)}};try{N=K("stream").Stream}catch($){N=function(){}}var M=U.EVENTS.filter(function($){return"error"!==$&&"end"!==$});function y($,H){if(!(this instanceof y))return new y($,H);N.apply(this),this._parser=new ie($,H),this.writable=!0,this.readable=!0;var fe=this;this._parser.onend=function(){fe.emit("end")},this._parser.onerror=function(ue){fe.emit("error",ue),fe._parser.error=null},this._decoder=null,M.forEach(function(ue){Object.defineProperty(fe,"on"+ue,{get:function(){return fe._parser["on"+ue]},set:function(Ve){if(!Ve)return fe.removeAllListeners(ue),fe._parser["on"+ue]=Ve,Ve;fe.on(ue,Ve)},enumerable:!0,configurable:!1})})}(y.prototype=Object.create(N.prototype,{constructor:{value:y}})).write=function($){if("function"==typeof Y&&"function"==typeof Y.isBuffer&&Y.isBuffer($)){if(!this._decoder){var H=K("string_decoder").StringDecoder;this._decoder=new H("utf8")}$=this._decoder.write($)}return this._parser.write($.toString()),this.emit("data",$),!0},y.prototype.end=function($){return $&&$.length&&this.write($),this._parser.end(),!0},y.prototype.on=function($,H){var fe=this;return!fe._parser["on"+$]&&-1!==M.indexOf($)&&(fe._parser["on"+$]=function(){var ue=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);ue.splice(0,0,$),fe.emit.apply(fe,ue)}),N.prototype.on.call(fe,$,H)};var j="http://www.w3.org/XML/1998/namespace",O="http://www.w3.org/2000/xmlns/",q={xml:j,xmlns:O},ce=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,D=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,I=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,X=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function w($){return" "===$||"\n"===$||"\r"===$||"\t"===$}function G($){return'"'===$||"'"===$}function Q($){return">"===$||w($)}function oe($,H){return $.test(H)}function se($,H){return!oe($,H)}var $,H,fe,ee=0;for(var Se in U.STATE={BEGIN:ee++,BEGIN_WHITESPACE:ee++,TEXT:ee++,TEXT_ENTITY:ee++,OPEN_WAKA:ee++,SGML_DECL:ee++,SGML_DECL_QUOTED:ee++,DOCTYPE:ee++,DOCTYPE_QUOTED:ee++,DOCTYPE_DTD:ee++,DOCTYPE_DTD_QUOTED:ee++,COMMENT_STARTING:ee++,COMMENT:ee++,COMMENT_ENDING:ee++,COMMENT_ENDED:ee++,CDATA:ee++,CDATA_ENDING:ee++,CDATA_ENDING_2:ee++,PROC_INST:ee++,PROC_INST_BODY:ee++,PROC_INST_ENDING:ee++,OPEN_TAG:ee++,OPEN_TAG_SLASH:ee++,ATTRIB:ee++,ATTRIB_NAME:ee++,ATTRIB_NAME_SAW_WHITE:ee++,ATTRIB_VALUE:ee++,ATTRIB_VALUE_QUOTED:ee++,ATTRIB_VALUE_CLOSED:ee++,ATTRIB_VALUE_UNQUOTED:ee++,ATTRIB_VALUE_ENTITY_Q:ee++,ATTRIB_VALUE_ENTITY_U:ee++,CLOSE_TAG:ee++,CLOSE_TAG_SAW_WHITE:ee++,SCRIPT:ee++,SCRIPT_ENDING:ee++},U.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},U.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(U.ENTITIES).forEach(function($){var H=U.ENTITIES[$],fe="number"==typeof H?String.fromCharCode(H):H;U.ENTITIES[$]=fe}),U.STATE)U.STATE[U.STATE[Se]]=Se;function me($,H,fe){$[H]&&$[H](fe)}function te($,H,fe){$.textNode&&_e($),me($,H,fe)}function _e($){$.textNode=Oe($.opt,$.textNode),$.textNode&&me($,"ontext",$.textNode),$.textNode=""}function Oe($,H){return $.trim&&(H=H.trim()),$.normalize&&(H=H.replace(/\s+/g," ")),H}function Ge($,H){return _e($),$.trackPosition&&(H+="\nLine: "+$.line+"\nColumn: "+$.column+"\nChar: "+$.c),H=new Error(H),$.error=H,me($,"onerror",H),$}function rt($){return $.sawRoot&&!$.closedRoot&&Xe($,"Unclosed root tag"),$.state!==ee.BEGIN&&$.state!==ee.BEGIN_WHITESPACE&&$.state!==ee.TEXT&&Ge($,"Unexpected end"),_e($),$.c="",$.closed=!0,me($,"onend"),ie.call($,$.strict,$.opt),$}function Xe($,H){if("object"!=typeof $||!($ instanceof ie))throw new Error("bad call to strictFail");$.strict&&Ge($,H)}function Je($){$.strict||($.tagName=$.tagName[$.looseCase]());var H=$.tags[$.tags.length-1]||$,fe=$.tag={name:$.tagName,attributes:{}};$.opt.xmlns&&(fe.ns=H.ns),$.attribList.length=0,te($,"onopentagstart",fe)}function Ye($,H){var ue=$.indexOf(":")<0?["",$]:$.split(":"),Ve=ue[0],gt=ue[1];return H&&"xmlns"===$&&(Ve="xmlns",gt=""),{prefix:Ve,local:gt}}function Ue($){if($.strict||($.attribName=$.attribName[$.looseCase]()),-1!==$.attribList.indexOf($.attribName)||$.tag.attributes.hasOwnProperty($.attribName))$.attribName=$.attribValue="";else{if($.opt.xmlns){var H=Ye($.attribName,!0),ue=H.local;if("xmlns"===H.prefix)if("xml"===ue&&$.attribValue!==j)Xe($,"xml: prefix must be bound to "+j+"\nActual: "+$.attribValue);else if("xmlns"===ue&&$.attribValue!==O)Xe($,"xmlns: prefix must be bound to "+O+"\nActual: "+$.attribValue);else{var Ve=$.tag,gt=$.tags[$.tags.length-1]||$;Ve.ns===gt.ns&&(Ve.ns=Object.create(gt.ns)),Ve.ns[ue]=$.attribValue}$.attribList.push([$.attribName,$.attribValue])}else $.tag.attributes[$.attribName]=$.attribValue,te($,"onattribute",{name:$.attribName,value:$.attribValue});$.attribName=$.attribValue=""}}function Le($,H){if($.opt.xmlns){var fe=$.tag,ue=Ye($.tagName);fe.prefix=ue.prefix,fe.local=ue.local,fe.uri=fe.ns[ue.prefix]||"",fe.prefix&&!fe.uri&&(Xe($,"Unbound namespace prefix: "+JSON.stringify($.tagName)),fe.uri=ue.prefix),fe.ns&&($.tags[$.tags.length-1]||$).ns!==fe.ns&&Object.keys(fe.ns).forEach(function(Mn){te($,"onopennamespace",{prefix:Mn,uri:fe.ns[Mn]})});for(var gt=0,ft=$.attribList.length;gt<ft;gt++){var be=$.attribList[gt],B=be[0],P=be[1],V=Ye(B,!0),Re=V.prefix,vt=""===Re?"":fe.ns[Re]||"",It={name:B,value:P,prefix:Re,local:V.local,uri:vt};Re&&"xmlns"!==Re&&!vt&&(Xe($,"Unbound namespace prefix: "+JSON.stringify(Re)),It.uri=Re),$.tag.attributes[B]=It,te($,"onattribute",It)}$.attribList.length=0}$.tag.isSelfClosing=!!H,$.sawRoot=!0,$.tags.push($.tag),te($,"onopentag",$.tag),H||($.state=$.noscript||"script"!==$.tagName.toLowerCase()?ee.TEXT:ee.SCRIPT,$.tag=null,$.tagName=""),$.attribName=$.attribValue="",$.attribList.length=0}function Ke($){if(!$.tagName)return Xe($,"Weird empty close tag."),$.textNode+="</>",void($.state=ee.TEXT);if($.script){if("script"!==$.tagName)return $.script+="</"+$.tagName+">",$.tagName="",void($.state=ee.SCRIPT);te($,"onscript",$.script),$.script=""}var H=$.tags.length,fe=$.tagName;$.strict||(fe=fe[$.looseCase]());for(var ue=fe;H--&&$.tags[H].name!==ue;)Xe($,"Unexpected close tag");if(H<0)return Xe($,"Unmatched closing tag: "+$.tagName),$.textNode+="</"+$.tagName+">",void($.state=ee.TEXT);$.tagName=fe;for(var gt=$.tags.length;gt-- >H;){var ft=$.tag=$.tags.pop();$.tagName=$.tag.name,te($,"onclosetag",$.tagName);var be={};for(var B in ft.ns)be[B]=ft.ns[B];$.opt.xmlns&&ft.ns!==($.tags[$.tags.length-1]||$).ns&&Object.keys(ft.ns).forEach(function(V){te($,"onclosenamespace",{prefix:V,uri:ft.ns[V]})})}0===H&&($.closedRoot=!0),$.tagName=$.attribValue=$.attribName="",$.attribList.length=0,$.state=ee.TEXT}function xe($){var ue,H=$.entity,fe=H.toLowerCase(),Ve="";return $.ENTITIES[H]?$.ENTITIES[H]:$.ENTITIES[fe]?$.ENTITIES[fe]:("#"===(H=fe).charAt(0)&&("x"===H.charAt(1)?(H=H.slice(2),Ve=(ue=parseInt(H,16)).toString(16)):(H=H.slice(1),Ve=(ue=parseInt(H,10)).toString(10))),H=H.replace(/^0+/,""),isNaN(ue)||Ve.toLowerCase()!==H?(Xe($,"Invalid character entity"),"&"+$.entity+";"):String.fromCodePoint(ue))}function je($,H){"<"===H?($.state=ee.OPEN_WAKA,$.startTagPosition=$.position):w(H)||(Xe($,"Non-whitespace before first tag."),$.textNode=H,$.state=ee.TEXT)}function We($,H){var fe="";return H<$.length&&(fe=$.charAt(H)),fe}ee=U.STATE,String.fromCodePoint||($=String.fromCharCode,H=Math.floor,fe=function(){var ue=16384,Ve=[],be=-1,B=arguments.length;if(!B)return"";for(var P="";++be<B;){var V=Number(arguments[be]);if(!isFinite(V)||V<0||V>1114111||H(V)!==V)throw RangeError("Invalid code point: "+V);V<=65535?Ve.push(V):Ve.push(55296+((V-=65536)>>10),V%1024+56320),(be+1===B||Ve.length>ue)&&(P+=$.apply(null,Ve),Ve.length=0)}return P},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:fe,configurable:!0,writable:!0}):String.fromCodePoint=fe)}(void 0===pe?this.sax={}:pe)}).call(this)}).call(this,K("buffer").Buffer)},{buffer:6,stream:87,string_decoder:5}],86:[function(K,Ae,pe){(function(Y,U){(function(){!function(k,ie){"use strict";if(!k.setImmediate){var M,W=1,b={},x=!1,N=k.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(k);X=X&&X.setTimeout?X:k,"[object process]"==={}.toString.call(k.process)?M=function(w){Y.nextTick(function(){T(w)})}:function(){if(k.postMessage&&!k.importScripts){var w=!0,G=k.onmessage;return k.onmessage=function(){w=!1},k.postMessage("","*"),k.onmessage=G,w}}()?(w="setImmediate$"+Math.random()+"$",G=function(Q){Q.source===k&&"string"==typeof Q.data&&0===Q.data.indexOf(w)&&T(+Q.data.slice(w.length))},k.addEventListener?k.addEventListener("message",G,!1):k.attachEvent("onmessage",G),M=function(Q){k.postMessage(w+Q,"*")}):k.MessageChannel?function(){var w=new MessageChannel;w.port1.onmessage=function(G){T(G.data)},M=function(G){w.port2.postMessage(G)}}():N&&"onreadystatechange"in N.createElement("script")?function(){var w=N.documentElement;M=function(G){var Q=N.createElement("script");Q.onreadystatechange=function(){T(G),Q.onreadystatechange=null,w.removeChild(Q),Q=null},w.appendChild(Q)}}():M=function(w){setTimeout(T,0,w)},X.setImmediate=function(w){"function"!=typeof w&&(w=new Function(""+w));for(var G=new Array(arguments.length-1),Q=0;Q<G.length;Q++)G[Q]=arguments[Q+1];return b[W]={callback:w,args:G},M(W),W++},X.clearImmediate=y}var w,G;function y(w){delete b[w]}function T(w){if(x)setTimeout(T,0,w);else{var G=b[w];if(G){x=!0;try{!function(w){var G=w.callback,Q=w.args;switch(Q.length){case 0:G();break;case 1:G(Q[0]);break;case 2:G(Q[0],Q[1]);break;case 3:G(Q[0],Q[1],Q[2]);break;default:G.apply(void 0,Q)}}(G)}finally{y(w),x=!1}}}}}("undefined"==typeof self?void 0===U?this:U:self)}).call(this)}).call(this,K("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:44}],87:[function(K,Ae,pe){Ae.exports=k;var Y=K("events").EventEmitter;function k(){Y.call(this)}K("inherits")(k,Y),k.Readable=K("readable-stream/lib/_stream_readable.js"),k.Writable=K("readable-stream/lib/_stream_writable.js"),k.Duplex=K("readable-stream/lib/_stream_duplex.js"),k.Transform=K("readable-stream/lib/_stream_transform.js"),k.PassThrough=K("readable-stream/lib/_stream_passthrough.js"),k.finished=K("readable-stream/lib/internal/streams/end-of-stream.js"),k.pipeline=K("readable-stream/lib/internal/streams/pipeline.js"),k.Stream=k,k.prototype.pipe=function(ie,W){var b=this;function x(j){ie.writable&&!1===ie.write(j)&&b.pause&&b.pause()}function N(){b.readable&&b.resume&&b.resume()}b.on("data",x),ie.on("drain",N),!ie._isStdio&&(!W||!1!==W.end)&&(b.on("end",v),b.on("close",y));var M=!1;function v(){M||(M=!0,ie.end())}function y(){M||(M=!0,"function"==typeof ie.destroy&&ie.destroy())}function S(j){if(T(),0===Y.listenerCount(this,"error"))throw j}function T(){b.removeListener("data",x),ie.removeListener("drain",N),b.removeListener("end",v),b.removeListener("close",y),b.removeListener("error",S),ie.removeListener("error",S),b.removeListener("end",T),b.removeListener("close",T),ie.removeListener("close",T)}return b.on("error",S),ie.on("error",S),b.on("end",T),b.on("close",T),ie.on("close",T),ie.emit("pipe",b),ie}},{events:8,inherits:10,"readable-stream/lib/_stream_duplex.js":68,"readable-stream/lib/_stream_passthrough.js":69,"readable-stream/lib/_stream_readable.js":70,"readable-stream/lib/_stream_transform.js":71,"readable-stream/lib/_stream_writable.js":72,"readable-stream/lib/internal/streams/end-of-stream.js":76,"readable-stream/lib/internal/streams/pipeline.js":78}],88:[function(K,Ae,pe){arguments[4][5][0].apply(pe,arguments)},{dup:5,"safe-buffer":84}],89:[function(K,Ae,pe){(function(Y,U){(function(){var k=K("process/browser.js").nextTick,ie=Function.prototype.apply,W=Array.prototype.slice,b={},x=0;function N(M,v){this._id=M,this._clearFn=v}pe.setTimeout=function(){return new N(ie.call(setTimeout,window,arguments),clearTimeout)},pe.setInterval=function(){return new N(ie.call(setInterval,window,arguments),clearInterval)},pe.clearTimeout=pe.clearInterval=function(M){M.close()},N.prototype.unref=N.prototype.ref=function(){},N.prototype.close=function(){this._clearFn.call(window,this._id)},pe.enroll=function(M,v){clearTimeout(M._idleTimeoutId),M._idleTimeout=v},pe.unenroll=function(M){clearTimeout(M._idleTimeoutId),M._idleTimeout=-1},pe._unrefActive=pe.active=function(M){clearTimeout(M._idleTimeoutId);var v=M._idleTimeout;v>=0&&(M._idleTimeoutId=setTimeout(function(){M._onTimeout&&M._onTimeout()},v))},pe.setImmediate="function"==typeof Y?Y:function(M){var v=x++,y=!(arguments.length<2)&&W.call(arguments,1);return b[v]=!0,k(function(){b[v]&&(y?M.apply(null,y):M.call(null),pe.clearImmediate(v))}),v},pe.clearImmediate="function"==typeof U?U:function(M){delete b[M]}}).call(this)}).call(this,K("timers").setImmediate,K("timers").clearImmediate)},{"process/browser.js":44,timers:89}],90:[function(K,Ae,pe){(function(Y){(function(){function k(ie){try{if(!Y.localStorage)return!1}catch(b){return!1}var W=Y.localStorage[ie];return null!=W&&"true"===String(W).toLowerCase()}Ae.exports=function(ie,W){if(k("noDeprecation"))return ie;var b=!1;return function(){if(!b){if(k("throwDeprecation"))throw new Error(W);k("traceDeprecation")?console.trace(W):console.warn(W),b=!0}return ie.apply(this,arguments)}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],91:[function(K,Ae,pe){"use strict";Ae.exports=function(Y){Y.prototype[Symbol.iterator]=function*(){for(let U=this.head;U;U=U.next)yield U.value}}},{}],92:[function(K,Ae,pe){"use strict";function Y(b){var x=this;if(x instanceof Y||(x=new Y),x.tail=null,x.head=null,x.length=0,b&&"function"==typeof b.forEach)b.forEach(function(v){x.push(v)});else if(arguments.length>0)for(var N=0,M=arguments.length;N<M;N++)x.push(arguments[N]);return x}function U(b,x,N){var M=x===b.head?new W(N,null,x,b):new W(N,x,x.next,b);return null===M.next&&(b.tail=M),null===M.prev&&(b.head=M),b.length++,M}function k(b,x){b.tail=new W(x,b.tail,null,b),b.head||(b.head=b.tail),b.length++}function ie(b,x){b.head=new W(x,null,b.head,b),b.tail||(b.tail=b.head),b.length++}function W(b,x,N,M){if(!(this instanceof W))return new W(b,x,N,M);this.list=M,this.value=b,x?(x.next=this,this.prev=x):this.prev=null,N?(N.prev=this,this.next=N):this.next=null}Ae.exports=Y,Y.Node=W,Y.create=Y,Y.prototype.removeNode=function(b){if(b.list!==this)throw new Error("removing node which does not belong to this list");var x=b.next,N=b.prev;return x&&(x.prev=N),N&&(N.next=x),b===this.head&&(this.head=x),b===this.tail&&(this.tail=N),b.list.length--,b.next=null,b.prev=null,b.list=null,x},Y.prototype.unshiftNode=function(b){if(b!==this.head){b.list&&b.list.removeNode(b);var x=this.head;b.list=this,b.next=x,x&&(x.prev=b),this.head=b,this.tail||(this.tail=b),this.length++}},Y.prototype.pushNode=function(b){if(b!==this.tail){b.list&&b.list.removeNode(b);var x=this.tail;b.list=this,b.prev=x,x&&(x.next=b),this.tail=b,this.head||(this.head=b),this.length++}},Y.prototype.push=function(){for(var b=0,x=arguments.length;b<x;b++)k(this,arguments[b]);return this.length},Y.prototype.unshift=function(){for(var b=0,x=arguments.length;b<x;b++)ie(this,arguments[b]);return this.length},Y.prototype.pop=function(){if(this.tail){var b=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,b}},Y.prototype.shift=function(){if(this.head){var b=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,b}},Y.prototype.forEach=function(b,x){x=x||this;for(var N=this.head,M=0;null!==N;M++)b.call(x,N.value,M,this),N=N.next},Y.prototype.forEachReverse=function(b,x){x=x||this;for(var N=this.tail,M=this.length-1;null!==N;M--)b.call(x,N.value,M,this),N=N.prev},Y.prototype.get=function(b){for(var x=0,N=this.head;null!==N&&x<b;x++)N=N.next;if(x===b&&null!==N)return N.value},Y.prototype.getReverse=function(b){for(var x=0,N=this.tail;null!==N&&x<b;x++)N=N.prev;if(x===b&&null!==N)return N.value},Y.prototype.map=function(b,x){x=x||this;for(var N=new Y,M=this.head;null!==M;)N.push(b.call(x,M.value,this)),M=M.next;return N},Y.prototype.mapReverse=function(b,x){x=x||this;for(var N=new Y,M=this.tail;null!==M;)N.push(b.call(x,M.value,this)),M=M.prev;return N},Y.prototype.reduce=function(b,x){var N,M=this.head;if(arguments.length>1)N=x;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");M=this.head.next,N=this.head.value}for(var v=0;null!==M;v++)N=b(N,M.value,v),M=M.next;return N},Y.prototype.reduceReverse=function(b,x){var N,M=this.tail;if(arguments.length>1)N=x;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");M=this.tail.prev,N=this.tail.value}for(var v=this.length-1;null!==M;v--)N=b(N,M.value,v),M=M.prev;return N},Y.prototype.toArray=function(){for(var b=new Array(this.length),x=0,N=this.head;null!==N;x++)b[x]=N.value,N=N.next;return b},Y.prototype.toArrayReverse=function(){for(var b=new Array(this.length),x=0,N=this.tail;null!==N;x++)b[x]=N.value,N=N.prev;return b},Y.prototype.slice=function(b,x){(x=x||this.length)<0&&(x+=this.length),(b=b||0)<0&&(b+=this.length);var N=new Y;if(x<b||x<0)return N;b<0&&(b=0),x>this.length&&(x=this.length);for(var M=0,v=this.head;null!==v&&M<b;M++)v=v.next;for(;null!==v&&M<x;M++,v=v.next)N.push(v.value);return N},Y.prototype.sliceReverse=function(b,x){(x=x||this.length)<0&&(x+=this.length),(b=b||0)<0&&(b+=this.length);var N=new Y;if(x<b||x<0)return N;b<0&&(b=0),x>this.length&&(x=this.length);for(var M=this.length,v=this.tail;null!==v&&M>x;M--)v=v.prev;for(;null!==v&&M>b;M--,v=v.prev)N.push(v.value);return N},Y.prototype.splice=function(b,x,...N){b>this.length&&(b=this.length-1),b<0&&(b=this.length+b);for(var M=0,v=this.head;null!==v&&M<b;M++)v=v.next;var y=[];for(M=0;v&&M<x;M++)y.push(v.value),v=this.removeNode(v);for(null===v&&(v=this.tail),v!==this.head&&v!==this.tail&&(v=v.prev),M=0;M<N.length;M++)v=U(this,v,N[M]);return y},Y.prototype.reverse=function(){for(var b=this.head,x=this.tail,N=b;null!==N;N=N.prev){var M=N.prev;N.prev=N.next,N.next=M}return this.head=x,this.tail=b,this};try{K("./iterator.js")(Y)}catch(b){}},{"./iterator.js":91}]},{},[1])(1)},322:Vt=>{Vt.exports=function(tt,mt){var J=mt.length;if(0!==J){var xt=tt.length;tt.length+=J;for(var dt=0;dt<J;dt++)tt[xt+dt]=mt[dt]}}},517:(Vt,nt)=>{"use strict";var mt=(()=>{return(xt=mt||(mt={})).typeOfFunction="function",xt.boolTrue=!0,mt;var xt})();function J(xt,dt,K){if(!K||typeof K.value!==mt.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+dt+"> is not a method!");return{configurable:mt.boolTrue,get:function(){var Ae=K.value.bind(this);return Object.defineProperty(this,dt,{value:Ae,configurable:mt.boolTrue,writable:mt.boolTrue}),Ae}}}nt.ak=J,nt.ZP=J},266:(Vt,nt,tt)=>{Vt.exports={ResizeSensor:tt(835),ElementQueries:tt(845)}},845:function(Vt,nt,tt){"use strict";var mt,J,xt;"undefined"!=typeof window&&window,J=[tt(835)],void 0!==(xt="function"==typeof(mt=function(dt){var K=function(){var pe,Y={},U=[];function k(D){D||(D=document.documentElement);var I=window.getComputedStyle(D,null).fontSize;return parseFloat(I)||16}function W(D,I){var X=I.split(/\d/),w=X[X.length-1];switch(I=parseFloat(I),w){case"px":return I;case"em":return I*k(D);case"rem":return I*k();case"vw":return I*document.documentElement.clientWidth/100;case"vh":return I*document.documentElement.clientHeight/100;case"vmin":case"vmax":var G=document.documentElement.clientWidth/100,Q=document.documentElement.clientHeight/100;return I*(0,Math["vmin"===w?"min":"max"])(G,Q);default:return I}}function b(D,I){this.element=D;var X,w,G,Q,oe,se,ee,Se,me=["min-width","min-height","max-width","max-height"];this.call=function(){for(X in G=function(D){if(!D.getBoundingClientRect)return{width:D.offsetWidth,height:D.offsetHeight};var I=D.getBoundingClientRect();return{width:Math.round(I.width),height:Math.round(I.height)}}(this.element),se={},Y[I])!Y[I].hasOwnProperty(X)||(Q=W(this.element,(w=Y[I][X]).value),oe="width"===w.property?G.width:G.height,ee="","min"===w.mode&&oe>=Q&&(ee+=w.value),"max"===w.mode&&oe<=Q&&(ee+=w.value),se[Se=w.mode+"-"+w.property]||(se[Se]=""),ee&&-1===(" "+se[Se]+" ").indexOf(" "+ee+" ")&&(se[Se]+=" "+ee));for(var te in me)!me.hasOwnProperty(te)||(se[me[te]]?this.element.setAttribute(me[te],se[me[te]].substr(1)):this.element.removeAttribute(me[te]))}}function x(D,I){D.elementQueriesSetupInformation||(D.elementQueriesSetupInformation=new b(D,I)),D.elementQueriesSensor||(D.elementQueriesSensor=new dt(D,function(){D.elementQueriesSetupInformation.call()}))}function N(D,I,X,w){if(void 0===Y[D]){Y[D]=[];var G=U.length;pe.innerHTML+="\n"+D+" {animation: 0.1s element-queries;}",pe.innerHTML+="\n"+D+" > .resize-sensor {min-width: "+G+"px;}",U.push(D)}Y[D].push({mode:I,property:X,value:w})}function M(D){var I;if(document.querySelectorAll&&(I=D?D.querySelectorAll.bind(D):document.querySelectorAll.bind(document)),!I&&"undefined"!=typeof $$&&(I=$$),!I&&"undefined"!=typeof jQuery&&(I=jQuery),!I)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return I}function y(D){var I=[],X=[],w=[],G=0,Q=-1,oe=[];for(var se in D.children)if(D.children.hasOwnProperty(se)&&D.children[se].tagName&&"img"===D.children[se].tagName.toLowerCase()){I.push(D.children[se]);var ee=D.children[se].getAttribute("min-width")||D.children[se].getAttribute("data-min-width"),Se=D.children[se].getAttribute("data-src")||D.children[se].getAttribute("url");w.push(Se),X.push({minWidth:ee}),ee?D.children[se].style.display="none":(G=I.length-1,D.children[se].style.display="block")}function te(){var Oe,_e=!1;for(Oe in I)!I.hasOwnProperty(Oe)||X[Oe].minWidth&&D.offsetWidth>X[Oe].minWidth&&(_e=Oe);if(_e||(_e=G),Q!==_e)if(oe[_e])I[Q].style.display="none",I[_e].style.display="block",Q=_e;else{var Ge=new Image;Ge.onload=function(){I[_e].src=w[_e],I[Q].style.display="none",I[_e].style.display="block",oe[_e]=!0,Q=_e},Ge.src=w[_e]}else I[_e].src=w[_e]}Q=G,D.resizeSensorInstance=new dt(D,te),te()}var T=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,j=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function O(D){var I,X,w,G;for(D=D.replace(/'/g,'"');null!==(I=T.exec(D));)for(X=I[1]+I[3],w=I[2];null!==(G=j.exec(w));)N(X,G[1],G[2],G[3])}function q(D){var I="";if(D)if("string"==typeof D)(-1!==(D=D.toLowerCase()).indexOf("min-width")||-1!==D.indexOf("max-width"))&&O(D);else for(var X=0,w=D.length;X<w;X++)1===D[X].type?(-1!==(I=D[X].selectorText||D[X].cssText).indexOf("min-height")||-1!==I.indexOf("max-height")||-1!==I.indexOf("min-width")||-1!==I.indexOf("max-width"))&&O(I):4===D[X].type?q(D[X].cssRules||D[X].rules):3===D[X].type&&D[X].styleSheet.hasOwnProperty("cssRules")&&q(D[X].styleSheet.cssRules)}var ce=!1;this.init=function(){var D="animationstart";void 0!==document.documentElement.style.webkitAnimationName?D="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?D="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(D="oanimationstart"),document.body.addEventListener(D,function(w){var G=w.target,Q=G&&window.getComputedStyle(G,null),oe=Q&&Q.getPropertyValue("animation-name");if(oe&&-1!==oe.indexOf("element-queries")){G.elementQueriesSensor=new dt(G,function(){G.elementQueriesSetupInformation&&G.elementQueriesSetupInformation.call()});var Se=window.getComputedStyle(G.resizeSensor,null).getPropertyValue("min-width");Se=parseInt(Se.replace("px","")),x(w.target,U[Se])}}),ce||((pe=document.createElement("style")).type="text/css",pe.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",pe.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(pe),ce=!0);for(var I=0,X=document.styleSheets.length;I<X;I++)try{document.styleSheets[I].href&&0===document.styleSheets[I].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[I].href),q(document.styleSheets[I].cssRules||document.styleSheets[I].rules||document.styleSheets[I].cssText)}catch(w){}!function(){for(var I=M()("[data-responsive-image],[responsive-image]"),X=0,w=I.length;X<w;X++)y(I[X])}()},this.findElementQueriesElements=function(D){!function(D){var I=M(D);for(var X in Y)if(Y.hasOwnProperty(X))for(var w=I(X,D),G=0,Q=w.length;G<Q;G++)x(w[G],X)}(D)},this.update=function(){this.init()}};K.update=function(){K.instance.update()},K.detach=function(pe){pe.elementQueriesSetupInformation?(pe.elementQueriesSensor.detach(),delete pe.elementQueriesSetupInformation,delete pe.elementQueriesSensor):pe.resizeSensorInstance&&(pe.resizeSensorInstance.detach(),delete pe.resizeSensorInstance)},K.init=function(){K.instance||(K.instance=new K),K.instance.init()};return K.findElementQueriesElements=function(pe){K.instance.findElementQueriesElements(pe)},K.listen=function(){!function(pe){if(document.addEventListener)document.addEventListener("DOMContentLoaded",pe,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var Y=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(pe(),clearInterval(Y))},10);else window.onload=pe}(K.init)},K})?mt.apply(nt,J):mt)&&(Vt.exports=xt)},835:function(Vt,nt,tt){"use strict";var mt,J;"undefined"!=typeof window&&window,void 0!==(J="function"==typeof(mt=function(){if("undefined"==typeof window)return null;var xt="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),dt=xt.requestAnimationFrame||xt.mozRequestAnimationFrame||xt.webkitRequestAnimationFrame||function(ie){return xt.setTimeout(ie,20)},K=xt.cancelAnimationFrame||xt.mozCancelAnimationFrame||xt.webkitCancelAnimationFrame||function(ie){xt.clearTimeout(ie)};function Ae(ie,W){var b=Object.prototype.toString.call(ie),x="[object Array]"===b||"[object NodeList]"===b||"[object HTMLCollection]"===b||"[object Object]"===b||"undefined"!=typeof jQuery&&ie instanceof jQuery||"undefined"!=typeof Elements&&ie instanceof Elements,N=0,M=ie.length;if(x)for(;N<M;N++)W(ie[N]);else W(ie)}function pe(ie){if(!ie.getBoundingClientRect)return{width:ie.offsetWidth,height:ie.offsetHeight};var W=ie.getBoundingClientRect();return{width:Math.round(W.width),height:Math.round(W.height)}}function Y(ie,W){Object.keys(W).forEach(function(b){ie.style[b]=W[b]})}var U=function(ie,W){var b=0;function x(){var v,y,M=[];this.add=function(S){M.push(S)},this.call=function(S){for(v=0,y=M.length;v<y;v++)M[v].call(this,S)},this.remove=function(S){var T=[];for(v=0,y=M.length;v<y;v++)M[v]!==S&&T.push(M[v]);M=T},this.length=function(){return M.length}}function N(M,v){if(M){if(M.resizedAttached)return void M.resizedAttached.add(v);M.resizedAttached=new x,M.resizedAttached.add(v),M.resizeSensor=document.createElement("div"),M.resizeSensor.dir="ltr",M.resizeSensor.className="resize-sensor";var y={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},S={position:"absolute",left:"0px",top:"0px",transition:"0s"};Y(M.resizeSensor,y);var T=document.createElement("div");T.className="resize-sensor-expand",Y(T,y);var j=document.createElement("div");Y(j,S),T.appendChild(j);var O=document.createElement("div");O.className="resize-sensor-shrink",Y(O,y);var q=document.createElement("div");Y(q,S),Y(q,{width:"200%",height:"200%"}),O.appendChild(q),M.resizeSensor.appendChild(T),M.resizeSensor.appendChild(O),M.appendChild(M.resizeSensor);var ce=window.getComputedStyle(M),D=ce?ce.getPropertyValue("position"):null;"absolute"!==D&&"relative"!==D&&"fixed"!==D&&"sticky"!==D&&(M.style.position="relative");var I=!1,X=0,w=pe(M),G=0,Q=0,oe=!0;b=0;var ee=function(){if(oe){if(0===M.offsetWidth&&0===M.offsetHeight)return void(b||(b=dt(function(){b=0,ee()})));oe=!1}var _e,Oe;Oe=M.offsetHeight,j.style.width=(_e=M.offsetWidth)+10+"px",j.style.height=Oe+10+"px",T.scrollLeft=_e+10,T.scrollTop=Oe+10,O.scrollLeft=_e+10,O.scrollTop=Oe+10};M.resizeSensor.resetSensor=ee;var Se=function(){X=0,I&&(G=w.width,Q=w.height,M.resizedAttached&&M.resizedAttached.call(w))},me=function(){w=pe(M),(I=w.width!==G||w.height!==Q)&&!X&&(X=dt(Se)),ee()},te=function(_e,Oe,Ge){_e.attachEvent?_e.attachEvent("on"+Oe,Ge):_e.addEventListener(Oe,Ge)};te(T,"scroll",me),te(O,"scroll",me),b=dt(function(){b=0,ee()})}}Ae(ie,function(M){N(M,W)}),this.detach=function(M){b||(K(b),b=0),U.detach(ie,M)},this.reset=function(){ie.resizeSensor.resetSensor()}};if(U.reset=function(ie){Ae(ie,function(W){W.resizeSensor.resetSensor()})},U.detach=function(ie,W){Ae(ie,function(b){!b||b.resizedAttached&&"function"==typeof W&&(b.resizedAttached.remove(W),b.resizedAttached.length())||b.resizeSensor&&(b.contains(b.resizeSensor)&&b.removeChild(b.resizeSensor),delete b.resizeSensor,delete b.resizedAttached)})},"undefined"!=typeof MutationObserver){var k=new MutationObserver(function(ie){for(var W in ie)if(ie.hasOwnProperty(W))for(var b=ie[W].addedNodes,x=0;x<b.length;x++)b[x].resizeSensor&&U.reset(b[x])});document.addEventListener("DOMContentLoaded",function(ie){k.observe(document.body,{childList:!0,subtree:!0})})}return U})?mt.call(nt,tt,nt,Vt):mt)&&(Vt.exports=J)},445:(Vt,nt,tt)=>{var mt=tt(910),J=tt(369),xt=tt(322);function dt(ie,W,b){if(!mt(ie))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!ie.hasNode(W))throw new Error('graphology-shortest-path: the "'+W+'" source node does not exist in the given graph.');if(!ie.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" target node does not exist in the given graph.');if((W=""+W)==(b=""+b))return[W];var x=ie.inboundNeighbors.bind(ie),N=ie.outboundNeighbors.bind(ie),M={},v={};M[W]=null,v[b]=null;var T,j,O,q,ce,D,I,X,y=[W],S=[b],w=!1;e:for(;y.length&&S.length;)if(y.length<=S.length){for(T=y,y=[],ce=0,I=T.length;ce<I;ce++)for(D=0,X=(O=N(j=T[ce])).length;D<X;D++)if((q=O[D])in M||(y.push(q),M[q]=j),q in v){w=!0;break e}}else for(T=S,S=[],ce=0,I=T.length;ce<I;ce++)for(j=T[ce],O=x(j),D=0,X=O.length;D<X;D++)if(q=O[D],q in v||(S.push(q),v[q]=j),q in M){w=!0;break e}if(!w)return null;for(var G=[];q;)G.unshift(q),q=M[q];for(q=v[G[G.length-1]];q;)G.push(q),q=v[q];return G.length?G:null}function K(ie,W){if(!mt(ie))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!ie.hasNode(W))throw new Error('graphology-shortest-path: the "'+W+'" source node does not exist in the given graph.');var N,M,v,y,S,T,b={},x={};for(b[W=""+W]=!0,x[W]=[W];Object.keys(b).length;)for(v in N=b,b={},N)for(S=0,T=(M=ie.outboundNeighbors(v)).length;S<T;S++)x[y=M[S]]||(x[y]=x[v].concat(y),b[y]=!0);return x}function Ae(ie,W,b){if(!mt(W))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!W.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" source node does not exist in the given graph.');b=""+b;var x=new Set,N={},M=0;N[b]=0;for(var y,S,T,v=[b];0!==v.length;){var j=[];for(y=0,S=v.length;y<S;y++)!x.has(T=v[y])&&(x.add(T),xt(j,W[ie](T)),N[T]=M);M++,v=j}return N}var pe=Ae.bind(null,"outboundNeighbors"),Y=Ae.bind(null,"neighbors");function U(ie,W,b){return arguments.length<3?K(ie,W):dt(ie,W,b)}U.bidirectional=dt,U.singleSource=K,U.singleSourceLength=pe,U.undirectedSingleSourceLength=Y,U.brandes=function(ie,W){W=""+W;var v,y,S,T,j,O,q,ce,D,b=[],x={},N={},M=ie.nodes();for(O=0,ce=M.length;O<ce;O++)x[T=M[O]]=[],N[T]=0;var I={};N[W]=1,I[W]=0;for(var X=J.of(W);X.size;)for(T=X.dequeue(),b.push(T),v=I[T],y=N[T],q=0,D=(S=ie.outboundNeighbors(T)).length;q<D;q++)(j=S[q])in I||(X.enqueue(j),I[j]=v+1),I[j]===v+1&&(N[j]+=y,x[j].push(T));return[b,x,N]},Vt.exports=U},910:Vt=>{Vt.exports=function(tt){return null!==tt&&"object"==typeof tt&&"function"==typeof tt.addUndirectedEdgeWithKey&&"function"==typeof tt.dropNode&&"boolean"==typeof tt.multi}},698:function(Vt){Vt.exports=function(){"use strict";function nt(ne){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(he){return typeof he}:function(he){return he&&"function"==typeof Symbol&&he.constructor===Symbol&&he!==Symbol.prototype?"symbol":typeof he})(ne)}function tt(ne,he){ne.prototype=Object.create(he.prototype),ne.prototype.constructor=ne,J(ne,he)}function mt(ne){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(he){return he.__proto__||Object.getPrototypeOf(he)})(ne)}function J(ne,he){return(J=Object.setPrototypeOf||function(re,A){return re.__proto__=A,re})(ne,he)}function xt(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ne){return!1}}function dt(ne,he,re){return(dt=xt()?Reflect.construct:function(A,L,Z){var we=[null];we.push.apply(we,L);var Fe=new(Function.bind.apply(A,we));return Z&&J(Fe,Z.prototype),Fe}).apply(null,arguments)}function K(ne){var he="function"==typeof Map?new Map:void 0;return(K=function(re){if(null===re||-1===Function.toString.call(re).indexOf("[native code]"))return re;if("function"!=typeof re)throw new TypeError("Super expression must either be null or a function");if(void 0!==he){if(he.has(re))return he.get(re);he.set(re,L)}function L(){return dt(re,arguments,mt(this).constructor)}return L.prototype=Object.create(re.prototype,{constructor:{value:L,enumerable:!1,writable:!0,configurable:!0}}),J(L,re)})(ne)}function Ae(ne){if(void 0===ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne}var pe=function(){for(var ne=arguments[0],he=1,re=arguments.length;he<re;he++)if(arguments[he])for(var A in arguments[he])ne[A]=arguments[he][A];return ne};function Y(ne,he,re,A){var L=ne._nodes.get(he),Z=null;return L?Z="mixed"===A?L.out&&L.out[re]||L.undirected&&L.undirected[re]:"directed"===A?L.out&&L.out[re]:L.undirected&&L.undirected[re]:Z}function U(ne){return null!==ne&&"object"===nt(ne)&&"function"==typeof ne.addUndirectedEdgeWithKey&&"function"==typeof ne.dropNode}function k(ne){return"object"===nt(ne)&&null!==ne&&ne.constructor===Object}function ie(ne){var he;for(he in ne)return!1;return!0}function W(ne,he,re){Object.defineProperty(ne,he,{enumerable:!1,configurable:!1,writable:!0,value:re})}function b(ne,he,re){var A={enumerable:!0,configurable:!0};"function"==typeof re?A.get=re:(A.value=re,A.writable=!1),Object.defineProperty(ne,he,A)}function x(ne){return!(!k(ne)||ne.attributes&&!Array.isArray(ne.attributes))}"function"==typeof Object.assign&&(pe=Object.assign);var N,M={exports:{}},v="object"==typeof Reflect?Reflect:null,y=v&&"function"==typeof v.apply?v.apply:function(ne,he,re){return Function.prototype.apply.call(ne,he,re)};N=v&&"function"==typeof v.ownKeys?v.ownKeys:Object.getOwnPropertySymbols?function(ne){return Object.getOwnPropertyNames(ne).concat(Object.getOwnPropertySymbols(ne))}:function(ne){return Object.getOwnPropertyNames(ne)};var S=Number.isNaN||function(ne){return ne!=ne};function T(){T.init.call(this)}M.exports=T,M.exports.once=function(ne,he){return new Promise(function(re,A){function L(we){ne.removeListener(he,Z),A(we)}function Z(){"function"==typeof ne.removeListener&&ne.removeListener("error",L),re([].slice.call(arguments))}var we;Q(ne,he,Z,{once:!0}),"error"!==he&&("function"==typeof(we=ne).on&&Q(we,"error",L,{once:!0}))})},T.EventEmitter=T,T.prototype._events=void 0,T.prototype._eventsCount=0,T.prototype._maxListeners=void 0;var j=10;function O(ne){if("function"!=typeof ne)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ne)}function q(ne){return void 0===ne._maxListeners?T.defaultMaxListeners:ne._maxListeners}function ce(ne,he,re,A){var L,Z,we;if(O(re),void 0===(Z=ne._events)?(Z=ne._events=Object.create(null),ne._eventsCount=0):(void 0!==Z.newListener&&(ne.emit("newListener",he,re.listener?re.listener:re),Z=ne._events),we=Z[he]),void 0===we)we=Z[he]=re,++ne._eventsCount;else if("function"==typeof we?we=Z[he]=A?[re,we]:[we,re]:A?we.unshift(re):we.push(re),(L=q(ne))>0&&we.length>L&&!we.warned){we.warned=!0;var et=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+String(he)+" listeners added. Use emitter.setMaxListeners() to increase limit");et.name="MaxListenersExceededWarning",et.emitter=ne,et.type=he,et.count=we.length,console&&console.warn&&console.warn(et)}return ne}function D(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function I(ne,he,re){var A={fired:!1,wrapFn:void 0,target:ne,type:he,listener:re},L=D.bind(A);return L.listener=re,A.wrapFn=L,L}function X(ne,he,re){var A=ne._events;if(void 0===A)return[];var L=A[he];return void 0===L?[]:"function"==typeof L?re?[L.listener||L]:[L]:re?function(Z){for(var we=new Array(Z.length),Fe=0;Fe<we.length;++Fe)we[Fe]=Z[Fe].listener||Z[Fe];return we}(L):G(L,L.length)}function w(ne){var he=this._events;if(void 0!==he){var re=he[ne];if("function"==typeof re)return 1;if(void 0!==re)return re.length}return 0}function G(ne,he){for(var re=new Array(he),A=0;A<he;++A)re[A]=ne[A];return re}function Q(ne,he,re,A){if("function"==typeof ne.on)A.once?ne.once(he,re):ne.on(he,re);else{if("function"!=typeof ne.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ne);ne.addEventListener(he,function L(Z){A.once&&ne.removeEventListener(he,L),re(Z)})}}function oe(ne){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:ne}),this.done=!1}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return j},set:function(ne){if("number"!=typeof ne||ne<0||S(ne))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ne+".");j=ne}}),T.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(ne){if("number"!=typeof ne||ne<0||S(ne))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ne+".");return this._maxListeners=ne,this},T.prototype.getMaxListeners=function(){return q(this)},T.prototype.emit=function(ne){for(var he=[],re=1;re<arguments.length;re++)he.push(arguments[re]);var A="error"===ne,L=this._events;if(void 0!==L)A=A&&void 0===L.error;else if(!A)return!1;if(A){var Z;if(he.length>0&&(Z=he[0]),Z instanceof Error)throw Z;var we=new Error("Unhandled error."+(Z?" ("+Z.message+")":""));throw we.context=Z,we}var Fe=L[ne];if(void 0===Fe)return!1;if("function"==typeof Fe)y(Fe,this,he);else{var et=Fe.length,Mt=G(Fe,et);for(re=0;re<et;++re)y(Mt[re],this,he)}return!0},T.prototype.on=T.prototype.addListener=function(ne,he){return ce(this,ne,he,!1)},T.prototype.prependListener=function(ne,he){return ce(this,ne,he,!0)},T.prototype.once=function(ne,he){return O(he),this.on(ne,I(this,ne,he)),this},T.prototype.prependOnceListener=function(ne,he){return O(he),this.prependListener(ne,I(this,ne,he)),this},T.prototype.off=T.prototype.removeListener=function(ne,he){var re,A,L,Z,we;if(O(he),void 0===(A=this._events))return this;if(void 0===(re=A[ne]))return this;if(re===he||re.listener===he)0==--this._eventsCount?this._events=Object.create(null):(delete A[ne],A.removeListener&&this.emit("removeListener",ne,re.listener||he));else if("function"!=typeof re){for(L=-1,Z=re.length-1;Z>=0;Z--)if(re[Z]===he||re[Z].listener===he){we=re[Z].listener,L=Z;break}if(L<0)return this;0===L?re.shift():function(Fe,et){for(;et+1<Fe.length;et++)Fe[et]=Fe[et+1];Fe.pop()}(re,L),1===re.length&&(A[ne]=re[0]),void 0!==A.removeListener&&this.emit("removeListener",ne,we||he)}return this},T.prototype.removeAllListeners=function(ne){var he,re,A;if(void 0===(re=this._events))return this;if(void 0===re.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==re[ne]&&(0==--this._eventsCount?this._events=Object.create(null):delete re[ne]),this;if(0===arguments.length){var L,Z=Object.keys(re);for(A=0;A<Z.length;++A)"removeListener"!==(L=Z[A])&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(he=re[ne]))this.removeListener(ne,he);else if(void 0!==he)for(A=he.length-1;A>=0;A--)this.removeListener(ne,he[A]);return this},T.prototype.listeners=function(ne){return X(this,ne,!0)},T.prototype.rawListeners=function(ne){return X(this,ne,!1)},T.listenerCount=function(ne,he){return"function"==typeof ne.listenerCount?ne.listenerCount(he):w.call(ne,he)},T.prototype.listenerCount=w,T.prototype.eventNames=function(){return this._eventsCount>0?N(this._events):[]},oe.prototype.next=function(){if(this.done)return{done:!0};var ne=this._next();return ne.done&&(this.done=!0),ne},"undefined"!=typeof Symbol&&(oe.prototype[Symbol.iterator]=function(){return this}),oe.of=function(){var ne=arguments,he=ne.length,re=0;return new oe(function(){return re>=he?{done:!0}:{done:!1,value:ne[re++]}})},oe.empty=function(){var ne=new oe(null);return ne.done=!0,ne},oe.is=function(ne){return ne instanceof oe||"object"==typeof ne&&null!==ne&&"function"==typeof ne.next};var se=oe,ee=function(ne,he){for(var re,A=arguments.length>1?he:1/0,L=A!==1/0?new Array(A):[],Z=0;;){if(Z===A)return L;if((re=ne.next()).done)return Z!==he?L.slice(0,Z):L;L[Z++]=re.value}},Se=function(ne){function he(re,A){var L;return(L=ne.call(this)||this).name="GraphError",L.message=re||"",L.data=A||{},L}return tt(he,ne),he}(K(Error)),me=function(ne){function he(re,A){var L;return(L=ne.call(this,re,A)||this).name="InvalidArgumentsGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(L),he.prototype.constructor),L}return tt(he,ne),he}(Se),te=function(ne){function he(re,A){var L;return(L=ne.call(this,re,A)||this).name="NotFoundGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(L),he.prototype.constructor),L}return tt(he,ne),he}(Se),_e=function(ne){function he(re,A){var L;return(L=ne.call(this,re,A)||this).name="UsageGraphError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(Ae(L),he.prototype.constructor),L}return tt(he,ne),he}(Se);function Oe(ne,he){this.key=ne,this.attributes=he,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function Ge(ne,he){this.key=ne,this.attributes=he,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}function rt(ne,he){this.key=ne,this.attributes=he,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}function Xe(ne,he,re,A,L,Z){this.key=he,this.attributes=Z,this.undirected=ne,this.source=A,this.target=L,this.generatedKey=re}function Je(ne,he,re,A,L,Z,we){var Fe,et,Mt="out",$e="in";if(he&&(Mt=$e="undirected"),ne.multi){if(void 0===(et=(Fe=Z[Mt])[L])&&(et=new Set,Fe[L]=et),et.add(re),A===L&&he)return;void 0===(Fe=we[$e])[A]&&(Fe[A]=et)}else{if(Z[Mt][L]=re,A===L&&he)return;we[$e][A]=re}}function Ye(ne,he,re){var A=ne.multi,L=re.source,Z=re.target,we=L.key,Fe=Z.key,et=L[he?"undirected":"out"],Mt=he?"undirected":"in";if(Fe in et)if(A){var $e=et[Fe];1===$e.size?(delete et[Fe],delete Z[Mt][we]):$e.delete(re)}else delete et[Fe];A||delete Z[Mt][we]}Ge.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}},rt.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};var Ue=[{name:function(ne){return"get".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes[L]}}},{name:function(ne){return"get".concat(ne,"Attributes")},attacher:function(ne,he,re){ne.prototype[he]=function(A){var L;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>1){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Z=""+A,we=""+arguments[1];if(!(L=Y(this,Z,we,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(Z,'" - "').concat(we,'").'))}else if(!(L=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&L.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return L.attributes}}},{name:function(ne){return"has".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes.hasOwnProperty(L)}}},{name:function(ne){return"set".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L,Z){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+A,et=""+L;if(L=arguments[2],Z=arguments[3],!(we=Y(this,Fe,et,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(et,'").'))}else if(!(we=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return we.attributes[L]=Z,this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:L}),this}}},{name:function(ne){return"update".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L,Z){var we;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>3){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var Fe=""+A,et=""+L;if(L=arguments[2],Z=arguments[3],!(we=Y(this,Fe,et,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(Fe,'" - "').concat(et,'").'))}else if(!(we=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("function"!=typeof Z)throw new me("Graph.".concat(he,": updater should be a function."));if("mixed"!==re&&we.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return we.attributes[L]=Z(we.attributes[L]),this.emit("edgeAttributesUpdated",{key:we.key,type:"set",attributes:we.attributes,name:L}),this}}},{name:function(ne){return"remove".concat(ne,"Attribute")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return delete Z.attributes[L],this.emit("edgeAttributesUpdated",{key:Z.key,type:"remove",attributes:Z.attributes,name:L}),this}}},{name:function(ne){return"replace".concat(ne,"Attributes")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if(!k(L))throw new me("Graph.".concat(he,": provided attributes are not a plain object."));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return Z.attributes=L,this.emit("edgeAttributesUpdated",{key:Z.key,type:"replace",attributes:Z.attributes}),this}}},{name:function(ne){return"merge".concat(ne,"Attributes")},attacher:function(ne,he,re){ne.prototype[he]=function(A,L){var Z;if("mixed"!==this.type&&"mixed"!==re&&re!==this.type)throw new _e("Graph.".concat(he,": cannot find this type of edges in your ").concat(this.type," graph."));if(arguments.length>2){if(this.multi)throw new _e("Graph.".concat(he,": cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about."));var we=""+A,Fe=""+L;if(L=arguments[2],!(Z=Y(this,we,Fe,re)))throw new te("Graph.".concat(he,': could not find an edge for the given path ("').concat(we,'" - "').concat(Fe,'").'))}else if(!(Z=this._edges.get(A=""+A)))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" edge in the graph.'));if(!k(L))throw new me("Graph.".concat(he,": provided attributes are not a plain object."));if("mixed"!==re&&Z.undirected!==("undirected"===re))throw new te("Graph.".concat(he,': could not find the "').concat(A,'" ').concat(re," edge in the graph."));return pe(Z.attributes,L),this.emit("edgeAttributesUpdated",{key:Z.key,type:"merge",attributes:Z.attributes,data:L}),this}}}],Le=se,Ke=function(){var ne,he=arguments,re=-1;return new Le(function A(){if(!ne){if(++re>=he.length)return{done:!0};ne=he[re]}var L=ne.next();return L.done?(ne=null,A()):L})},xe=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function je(ne,he){for(var re in he)ne.push(he[re].key)}function We(ne,he){for(var re in he)he[re].forEach(function(A){return ne.push(A.key)})}function Pe(ne,he,re){for(var A in ne)if(A!==re){var L=ne[A];he(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)}}function $(ne,he,re){for(var A in ne)A!==re&&ne[A].forEach(function(L){return he(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)})}function H(ne,he,re){for(var A in ne)if(A!==re){var L=ne[A];if(he(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey))return!0}return!1}function fe(ne,he,re){var A,L,Z,we,Fe;for(var et in ne)if(et!==re)for(A=ne[et].values();!0!==(L=A.next()).done;)if(we=(Z=L.value).source,he(Z.key,Z.attributes,we.key,(Fe=Z.target).key,we.attributes,Fe.attributes,Z.undirected,Z.generatedKey))return!0;return!1}function ue(ne,he){var re=Object.keys(ne),A=re.length,L=null,Z=0;return new se(function we(){var Fe;if(L){var et=L.next();if(et.done)return L=null,Z++,we();Fe=et.value}else{if(Z>=A)return{done:!0};var Mt=re[Z];if(Mt===he)return Z++,we();if((Fe=ne[Mt])instanceof Set)return L=Fe.values(),we();Z++}return{done:!1,value:[Fe.key,Fe.attributes,Fe.source.key,Fe.target.key,Fe.source.attributes,Fe.target.attributes]}})}function Ve(ne,he,re){var A=he[re];A&&ne.push(A.key)}function gt(ne,he,re){var A=he[re];A&&A.forEach(function(L){return ne.push(L.key)})}function ft(ne,he,re){var A=ne[he];if(A){var L=A.source,Z=A.target;re(A.key,A.attributes,L.key,Z.key,L.attributes,Z.attributes,A.undirected,A.generatedKey)}}function be(ne,he,re){var A=ne[he];A&&A.forEach(function(L){return re(L.key,L.attributes,L.source.key,L.target.key,L.source.attributes,L.target.attributes,L.undirected,L.generatedKey)})}function B(ne,he,re){var A=ne[he];if(A){var L=A.source,Z=A.target;return re(A.key,A.attributes,L.key,Z.key,L.attributes,Z.attributes,A.undirected,A.generatedKey)}}function P(ne,he,re){var A=ne[he];if(A){for(var L,Z,we=A.values();!0!==(L=we.next()).done;)if(re((Z=L.value).key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes,Z.undirected,Z.generatedKey))return!0;return!1}}function V(ne,he){var re=ne[he];if(re instanceof Set){var A=re.values();return new se(function(){var L=A.next();if(L.done)return L;var Z=L.value;return{done:!1,value:[Z.key,Z.attributes,Z.source.key,Z.target.key,Z.source.attributes,Z.target.attributes]}})}return se.of([re.key,re.attributes,re.source.key,re.target.key,re.source.attributes,re.target.attributes])}function Re(ne,he){if(0===ne.size)return[];if("mixed"===he||he===ne.type)return"function"==typeof Array.from?Array.from(ne._edges.keys()):ee(ne._edges.keys(),ne._edges.size);for(var re,A,Z=new Array("undirected"===he?ne.undirectedSize:ne.directedSize),we="undirected"===he,Fe=ne._edges.values(),et=0;!0!==(re=Fe.next()).done;)(A=re.value).undirected===we&&(Z[et++]=A.key);return Z}function Qe(ne,he,re){if(0!==ne.size)for(var A,L,Z="mixed"!==he&&he!==ne.type,we="undirected"===he,Fe=ne._edges.values();!0!==(A=Fe.next()).done;)if(L=A.value,!Z||L.undirected===we){var Gt=L.source,bt=L.target;re(L.key,L.attributes,Gt.key,bt.key,Gt.attributes,bt.attributes,L.undirected,L.generatedKey)}}function vt(ne,he,re){if(0!==ne.size)for(var A,L,Z="mixed"!==he&&he!==ne.type,we="undirected"===he,Fe=ne._edges.values();!0!==(A=Fe.next()).done;)if(L=A.value,!Z||L.undirected===we){var Gt=L.source,bt=L.target;if(re(L.key,L.attributes,Gt.key,bt.key,Gt.attributes,bt.attributes,L.undirected,L.generatedKey))break}}function It(ne,he){if(0===ne.size)return se.empty();var re="mixed"!==he&&he!==ne.type,A="undirected"===he,L=ne._edges.values();return new se(function(){for(var Z,we;;){if((Z=L.next()).done)return Z;if(we=Z.value,!re||we.undirected===A)break}return{value:[we.key,we.attributes,we.source.key,we.target.key,we.source.attributes,we.target.attributes],done:!1}})}function Mn(ne,he,re,A){var L=[],Z=ne?We:je;return"undirected"!==he&&("out"!==re&&Z(L,A.in),"in"!==re&&Z(L,A.out),!re&&A.directedSelfLoops>0&&L.splice(L.lastIndexOf(A.key),1)),"directed"!==he&&Z(L,A.undirected),L}function Rn(ne,he,re,A,L){var Z=ne?$:Pe;"undirected"!==he&&("out"!==re&&Z(A.in,L),"in"!==re&&Z(A.out,L,re?null:A.key)),"directed"!==he&&Z(A.undirected,L)}function Hn(ne,he,re,A,L){var Z=ne?fe:H;"undirected"!==he&&("out"!==re&&Z(A.in,L)||"in"!==re&&Z(A.out,L,re?null:A.key))||"directed"===he||Z(A.undirected,L)}function bi(ne,he,re){var A=se.empty();return"undirected"!==ne&&("out"!==he&&void 0!==re.in&&(A=Ke(A,ue(re.in))),"in"!==he&&void 0!==re.out&&(A=Ke(A,ue(re.out,he?null:re.key)))),"directed"!==ne&&void 0!==re.undirected&&(A=Ke(A,ue(re.undirected))),A}function fi(ne,he,re,A,L){var Z=he?gt:Ve,we=[];return"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&Z(we,A.in,L),void 0!==A.out&&"in"!==re&&Z(we,A.out,L),!re&&A.directedSelfLoops>0&&we.splice(we.lastIndexOf(A.key),1)),"directed"!==ne&&void 0!==A.undirected&&Z(we,A.undirected,L),we}function Gr(ne,he,re,A,L,Z){var we=he?be:ft;"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&we(A.in,L,Z),A.key!==L&&void 0!==A.out&&"in"!==re&&we(A.out,L,Z)),"directed"!==ne&&void 0!==A.undirected&&we(A.undirected,L,Z)}function Ns(ne,he,re,A,L,Z){var we=he?P:B;"undirected"!==ne&&(void 0!==A.in&&"out"!==re&&we(A.in,L,Z)||A.key!==L&&void 0!==A.out&&"in"!==re&&we(A.out,L,Z,re?null:A.key))||"directed"===ne||void 0===A.undirected||we(A.undirected,L,Z)}function ds(ne,he,re,A){var L=se.empty();return"undirected"!==ne&&(void 0!==re.in&&"out"!==he&&A in re.in&&(L=Ke(L,V(re.in,A))),void 0!==re.out&&"in"!==he&&A in re.out&&(L=Ke(L,V(re.out,A)))),"directed"!==ne&&void 0!==re.undirected&&A in re.undirected&&(L=Ke(L,V(re.undirected,A))),L}var Fs=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function $r(ne,he){if(void 0!==he)for(var re in he)ne.add(re)}function fa(ne,he,re){if("mixed"!==ne){if("undirected"===ne)return Object.keys(re.undirected);if("string"==typeof he)return Object.keys(re[he])}var A=new Set;return"undirected"!==ne&&("out"!==he&&$r(A,re.in),"in"!==he&&$r(A,re.out)),"directed"!==ne&&$r(A,re.undirected),ee(A.values(),A.size)}function xl(ne,he,re){for(var A in he){var L=he[A];L instanceof Set&&(L=L.values().next().value);var Z=L.source,Fe=Z===ne?L.target:Z;re(Fe.key,Fe.attributes)}}function pa(ne,he,re,A){for(var L in re){var Z=re[L];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===he?Z.target:we;ne.has(et.key)||(ne.add(et.key),A(et.key,et.attributes))}}function ys(ne,he,re){for(var A in he){var L=he[A];L instanceof Set&&(L=L.values().next().value);var Z=L.source,Fe=Z===ne?L.target:Z;if(re(Fe.key,Fe.attributes))return!0}return!1}function Jt(ne,he,re,A){for(var L in re){var Z=re[L];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===he?Z.target:we;if(!ne.has(et.key)&&(ne.add(et.key),A(et.key,et.attributes)))return!0}return!1}function Wa(ne,he){var re=Object.keys(he),A=re.length,L=0;return new se(function(){if(L>=A)return{done:!0};var Z=he[re[L++]];Z instanceof Set&&(Z=Z.values().next().value);var we=Z.source,et=we===ne?Z.target:we;return{done:!1,value:[et.key,et.attributes]}})}function it(ne,he,re){var A=Object.keys(re),L=A.length,Z=0;return new se(function we(){if(Z>=L)return{done:!0};var Fe=re[A[Z++]];Fe instanceof Set&&(Fe=Fe.values().next().value);var et=Fe.source,$e=et===he?Fe.target:et;return ne.has($e.key)?we():(ne.add($e.key),{done:!1,value:[$e.key,$e.attributes]})})}function ot(ne,he,re,A,L){var Z=ne._nodes.get(A);if("undirected"!==he){if("out"!==re&&void 0!==Z.in)for(var we in Z.in)if(we===L)return!0;if("in"!==re&&void 0!==Z.out)for(var Fe in Z.out)if(Fe===L)return!0}if("directed"!==he&&void 0!==Z.undirected)for(var et in Z.undirected)if(et===L)return!0;return!1}function ke(ne,he,re){for(var A,L,Z,we,Fe,et,Mt,$e=he._nodes.values(),Gt=he.type;!0!==(A=$e.next()).done;){if(L=A.value,"undirected"!==Gt)for(Z in we=L.out)if(et=(Fe=we[Z]).target,Mt=re(L.key,et.key,L.attributes,et.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ne&&Mt)return;if("directed"!==Gt)for(Z in we=L.undirected)if((et=(Fe=we[Z]).target).key!==Z&&(et=Fe.source),Mt=re(L.key,et.key,L.attributes,et.attributes,Fe.key,Fe.attributes,Fe.undirected,Fe.generatedKey),ne&&Mt)return}}function lt(ne,he,re){for(var A,L,Z,we,Fe,et,Mt,$e,Gt,bt=he._nodes.values(),_n=he.type;!0!==(A=bt.next()).done;){if(L=A.value,"undirected"!==_n)for(Z in et=L.out)for(we=et[Z].values();!0!==(Fe=we.next()).done;)if($e=(Mt=Fe.value).target,Gt=re(L.key,$e.key,L.attributes,$e.attributes,Mt.key,Mt.attributes,Mt.undirected,Mt.generatedKey),ne&&Gt)return;if("directed"!==_n)for(Z in et=L.undirected)for(we=et[Z].values();!0!==(Fe=we.next()).done;)if(($e=(Mt=Fe.value).target).key!==Z&&($e=Mt.source),Gt=re(L.key,$e.key,L.attributes,$e.attributes,Mt.key,Mt.attributes,Mt.undirected,Mt.generatedKey),ne&&Gt)return}}function Ze(ne,he){var re={key:ne};return ie(he.attributes)||(re.attributes=pe({},he.attributes)),re}function wt(ne,he){var re={source:he.source.key,target:he.target.key};return he.generatedKey||(re.key=ne),ie(he.attributes)||(re.attributes=pe({},he.attributes)),he.undirected&&(re.undirected=!0),re}function St(ne){return k(ne)?"key"in ne?!("attributes"in ne)||k(ne.attributes)&&null!==ne.attributes?null:"invalid-attributes":"no-key":"not-object"}function Tt(ne){return k(ne)?"source"in ne?"target"in ne?!("attributes"in ne)||k(ne.attributes)&&null!==ne.attributes?"undirected"in ne&&"boolean"!=typeof ne.undirected?"invalid-undirected":null:"invalid-attributes":"no-target":"no-source":"not-object"}var Yt=new Set(["directed","undirected","mixed"]),Vn=new Set(["domain","_events","_eventsCount","_maxListeners"]),ii={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function On(ne,he,re){var A=new ne.NodeDataClass(he,re);return ne._nodes.set(he,A),ne.emit("nodeAdded",{key:he,attributes:re}),A}function mn(ne,he,re,A,L,Z,we,Fe){if(!A&&"undirected"===ne.type)throw new _e("Graph.".concat(he,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(A&&"directed"===ne.type)throw new _e("Graph.".concat(he,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe&&!k(Fe))throw new me("Graph.".concat(he,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));if(Z=""+Z,we=""+we,Fe=Fe||{},!ne.allowSelfLoops&&Z===we)throw new _e("Graph.".concat(he,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var et=ne._nodes.get(Z),Mt=ne._nodes.get(we);if(!et)throw new te("Graph.".concat(he,': source node "').concat(Z,'" not found.'));if(!Mt)throw new te("Graph.".concat(he,': target node "').concat(we,'" not found.'));var $e={key:null,undirected:A,source:Z,target:we,attributes:Fe};if(re&&(L=ne._edgeKeyGenerator($e)),ne._edges.has(L=""+L))throw new _e("Graph.".concat(he,': the "').concat(L,'" edge already exists in the graph.'));if(!ne.multi&&(A?void 0!==et.undirected[we]:void 0!==et.out[we]))throw new _e("Graph.".concat(he,': an edge linking "').concat(Z,'" to "').concat(we,"\" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option."));var Gt=new Xe(A,L,re,et,Mt,Fe);return ne._edges.set(L,Gt),Z===we?A?(et.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(et.directedSelfLoops++,ne._directedSelfLoopCount++):A?(et.undirectedDegree++,Mt.undirectedDegree++):(et.outDegree++,Mt.inDegree++),Je(ne,A,Gt,Z,we,et,Mt),A?ne._undirectedSize++:ne._directedSize++,$e.key=L,ne.emit("edgeAdded",$e),L}function Gn(ne,he,re,A,L,Z,we,Fe,et){if(!A&&"undirected"===ne.type)throw new _e("Graph.".concat(he,": you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead."));if(A&&"directed"===ne.type)throw new _e("Graph.".concat(he,": you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead."));if(Fe)if(et){if("function"!=typeof Fe)throw new me("Graph.".concat(he,': invalid updater function. Expecting a function but got "').concat(Fe,'"'))}else if(!k(Fe))throw new me("Graph.".concat(he,': invalid attributes. Expecting an object but got "').concat(Fe,'"'));var Mt;if(Z=""+Z,we=""+we,et&&(Mt=Fe,Fe=void 0),!ne.allowSelfLoops&&Z===we)throw new _e("Graph.".concat(he,': source & target are the same ("').concat(Z,"\"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false."));var $e,Gt,bt=ne._nodes.get(Z),_n=ne._nodes.get(we);if(!re&&($e=ne._edges.get(L))){if($e.source.key!==Z||$e.target.key!==we||A&&($e.source.key!==we||$e.target.key!==Z))throw new _e("Graph.".concat(he,': inconsistency detected when attempting to merge the "').concat(L,'" edge with "').concat(Z,'" source & "').concat(we,'" target vs. ("').concat($e.source.key,'", "').concat($e.target.key,'").'));Gt=$e}if(Gt||ne.multi||!bt||(Gt=A?bt.undirected[we]:bt.out[we]),Gt)return(et?Mt:Fe)?(et?(Gt.attributes=Mt(Gt.attributes),ne.emit("edgeAttributesUpdated",{type:"replace",key:Gt.key,attributes:Gt.attributes})):(pe(Gt.attributes,Fe),ne.emit("edgeAttributesUpdated",{type:"merge",key:Gt.key,attributes:Gt.attributes,data:Fe})),Gt.key):Gt.key;Fe=Fe||{},et&&Mt&&(Fe=Mt(Fe));var qr={key:null,undirected:A,source:Z,target:we,attributes:Fe};if(re&&(L=ne._edgeKeyGenerator(qr)),ne._edges.has(L=""+L))throw new _e("Graph.".concat(he,': the "').concat(L,'" edge already exists in the graph.'));return bt||(bt=On(ne,Z,{}),Z===we&&(_n=bt)),_n||(_n=On(ne,we,{})),$e=new Xe(A,L,re,bt,_n,Fe),ne._edges.set(L,$e),Z===we?A?(bt.undirectedSelfLoops++,ne._undirectedSelfLoopCount++):(bt.directedSelfLoops++,ne._directedSelfLoopCount++):A?(bt.undirectedDegree++,_n.undirectedDegree++):(bt.outDegree++,_n.inDegree++),Je(ne,A,$e,Z,we,bt,_n),A?ne._undirectedSize++:ne._directedSize++,qr.key=L,ne.emit("edgeAdded",qr),L}var ne,Sn=function(ne){function he(A){var L;if(L=ne.call(this)||this,(A=pe({},ii,A)).edgeKeyGenerator&&"function"!=typeof A.edgeKeyGenerator)throw new me("Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got \"".concat(A.edgeKeyGenerator,'".'));if("boolean"!=typeof A.multi)throw new me("Graph.constructor: invalid 'multi' option. Expecting a boolean but got \"".concat(A.multi,'".'));if(!Yt.has(A.type))throw new me('Graph.constructor: invalid \'type\' option. Should be one of "mixed", "directed" or "undirected" but got "'.concat(A.type,'".'));if("boolean"!=typeof A.allowSelfLoops)throw new me("Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got \"".concat(A.allowSelfLoops,'".'));var Z,we="mixed"===A.type?Oe:"directed"===A.type?Ge:rt;return W(Ae(L),"NodeDataClass",we),W(Ae(L),"_attributes",{}),W(Ae(L),"_nodes",new Map),W(Ae(L),"_edges",new Map),W(Ae(L),"_directedSize",0),W(Ae(L),"_undirectedSize",0),W(Ae(L),"_directedSelfLoopCount",0),W(Ae(L),"_undirectedSelfLoopCount",0),W(Ae(L),"_edgeKeyGenerator",A.edgeKeyGenerator||(Z=0,function(){return Z++})),W(Ae(L),"_options",A),Vn.forEach(function(Fe){return W(Ae(L),Fe,L[Fe])}),b(Ae(L),"order",function(){return L._nodes.size}),b(Ae(L),"size",function(){return L._edges.size}),b(Ae(L),"directedSize",function(){return L._directedSize}),b(Ae(L),"undirectedSize",function(){return L._undirectedSize}),b(Ae(L),"selfLoopCount",function(){return L._directedSelfLoopCount+L._undirectedSelfLoopCount}),b(Ae(L),"directedSelfLoopCount",function(){return L._directedSelfLoopCount}),b(Ae(L),"undirectedSelfLoopCount",function(){return L._undirectedSelfLoopCount}),b(Ae(L),"multi",L._options.multi),b(Ae(L),"type",L._options.type),b(Ae(L),"allowSelfLoops",L._options.allowSelfLoops),b(Ae(L),"implementation",function(){return"graphology"}),L}tt(he,ne);var re=he.prototype;return re.hasNode=function(A){return this._nodes.has(""+A)},re.hasDirectedEdge=function(A,L){if("undirected"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+A);return!!we&&!we.undirected}if(2===arguments.length){L=""+L;var Fe=this._nodes.get(A=""+A);if(!Fe)return!1;var et=Fe.out[L];return!(!et||this.multi&&!et.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasUndirectedEdge=function(A,L){if("directed"===this.type)return!1;if(1===arguments.length){var we=this._edges.get(""+A);return!!we&&we.undirected}if(2===arguments.length){L=""+L;var Fe=this._nodes.get(A=""+A);if(!Fe)return!1;var et=Fe.undirected[L];return!(!et||this.multi&&!et.size)}throw new me("Graph.hasDirectedEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.hasEdge=function(A,L){if(1===arguments.length)return this._edges.has(""+A);if(2===arguments.length){L=""+L;var we=this._nodes.get(A=""+A);if(!we)return!1;var Fe=void 0!==we.out&&we.out[L];return Fe||(Fe=void 0!==we.undirected&&we.undirected[L]),!(!Fe||this.multi&&!Fe.size)}throw new me("Graph.hasEdge: invalid arity (".concat(arguments.length,", instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target."))},re.directedEdge=function(A,L){if("undirected"!==this.type){if(A=""+A,L=""+L,this.multi)throw new _e("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");var Z=this._nodes.get(A);if(!Z)throw new te('Graph.directedEdge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(L))throw new te('Graph.directedEdge: could not find the "'.concat(L,'" target node in the graph.'));var we=Z.out&&Z.out[L]||void 0;return we?we.key:void 0}},re.undirectedEdge=function(A,L){if("directed"!==this.type){if(A=""+A,L=""+L,this.multi)throw new _e("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");var Z=this._nodes.get(A);if(!Z)throw new te('Graph.undirectedEdge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(L))throw new te('Graph.undirectedEdge: could not find the "'.concat(L,'" target node in the graph.'));var we=Z.undirected&&Z.undirected[L]||void 0;return we?we.key:void 0}},re.edge=function(A,L){if(this.multi)throw new _e("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");L=""+L;var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.edge: could not find the "'.concat(A,'" source node in the graph.'));if(!this._nodes.has(L))throw new te('Graph.edge: could not find the "'.concat(L,'" target node in the graph.'));var we=Z.out&&Z.out[L]||Z.undirected&&Z.undirected[L]||void 0;if(we)return we.key},re.inDegree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.inDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.inDegree: could not find the "'.concat(A,'" node in the graph.'));return"undirected"===this.type?0:Z.inDegree+(L?Z.directedSelfLoops:0)},re.outDegree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.outDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.outDegree: could not find the "'.concat(A,'" node in the graph.'));return"undirected"===this.type?0:Z.outDegree+(L?Z.directedSelfLoops:0)},re.directedDegree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.directedDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.directedDegree: could not find the "'.concat(A,'" node in the graph.'));if("undirected"===this.type)return 0;var we=L?Z.directedSelfLoops:0;return Z.inDegree+we+(Z.outDegree+we)},re.undirectedDegree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.undirectedDegree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.undirectedDegree: could not find the "'.concat(A,'" node in the graph.'));return"directed"===this.type?0:Z.undirectedDegree+2*(L?Z.undirectedSelfLoops:0)},re.degree=function(A){var L=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("boolean"!=typeof L)throw new me('Graph.degree: Expecting a boolean but got "'.concat(L,'" for the second parameter (allowing self-loops to be counted).'));var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.degree: could not find the "'.concat(A,'" node in the graph.'));var we=0,Fe=0;return"directed"!==this.type&&(L&&(Fe=Z.undirectedSelfLoops),we+=Z.undirectedDegree+2*Fe),"undirected"!==this.type&&(L&&(Fe=Z.directedSelfLoops),we+=Z.inDegree+Z.outDegree+2*Fe),we},re.source=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.source: could not find the "'.concat(A,'" edge in the graph.'));return L.source.key},re.target=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.target: could not find the "'.concat(A,'" edge in the graph.'));return L.target.key},re.extremities=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.extremities: could not find the "'.concat(A,'" edge in the graph.'));return[L.source.key,L.target.key]},re.opposite=function(A,L){A=""+A;var Z=this._edges.get(L=""+L);if(!Z)throw new te('Graph.opposite: could not find the "'.concat(L,'" edge in the graph.'));var we=Z.source.key,Fe=Z.target.key;if(A!==we&&A!==Fe)throw new te('Graph.opposite: the "'.concat(A,'" node is not attached to the "').concat(L,'" edge (').concat(we,", ").concat(Fe,")."));return A===we?Fe:we},re.hasExtremity=function(A,L){L=""+L;var Z=this._edges.get(A=""+A);if(!Z)throw new te('Graph.hasExtremity: could not find the "'.concat(A,'" edge in the graph.'));return Z.source.key===L||Z.target.key===L},re.isUndirected=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.isUndirected: could not find the "'.concat(A,'" edge in the graph.'));return L.undirected},re.isDirected=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.isDirected: could not find the "'.concat(A,'" edge in the graph.'));return!L.undirected},re.isSelfLoop=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.isSelfLoop: could not find the "'.concat(A,'" edge in the graph.'));return L.source===L.target},re.hasGeneratedKey=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.hasGeneratedKey: could not find the "'.concat(A,'" edge in the graph.'));return L.generatedKey},re.addNode=function(A,L){return function(Z,we,Fe){if(Fe&&!k(Fe))throw new me('Graph.addNode: invalid attributes. Expecting an object but got "'.concat(Fe,'"'));if(Fe=Fe||{},Z._nodes.has(we=""+we))throw new _e('Graph.addNode: the "'.concat(we,'" node already exist in the graph.'));var et=new Z.NodeDataClass(we,Fe);return Z._nodes.set(we,et),Z.emit("nodeAdded",{key:we,attributes:Fe}),et}(this,A,L).key},re.mergeNode=function(A,L){if(L&&!k(L))throw new me('Graph.mergeNode: invalid attributes. Expecting an object but got "'.concat(L,'"'));L=L||{};var Z=this._nodes.get(A=""+A);return Z?(L&&(pe(Z.attributes,L),this.emit("nodeAttributesUpdated",{type:"merge",key:A,attributes:Z.attributes,data:L})),A):(Z=new this.NodeDataClass(A,L),this._nodes.set(A,Z),this.emit("nodeAdded",{key:A,attributes:L}),A)},re.updateNode=function(A,L){if(L&&"function"!=typeof L)throw new me('Graph.updateNode: invalid updater function. Expecting a function but got "'.concat(L,'"'));var Z=this._nodes.get(A=""+A);if(Z)return L&&(Z.attributes=L(Z.attributes),this.emit("nodeAttributesUpdated",{type:"replace",key:A,attributes:Z.attributes})),A;var Fe=L?L({}):{};return Z=new this.NodeDataClass(A,Fe),this._nodes.set(A,Z),this.emit("nodeAdded",{key:A,attributes:Fe}),A},re.dropNode=function(A){var L=this,Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.dropNode: could not find the "'.concat(A,'" node in the graph.'));this.forEachEdge(A,function(we){L.dropEdge(we)}),this._nodes.delete(A),this.emit("nodeDropped",{key:A,attributes:Z.attributes})},re.dropEdge=function(A){var L;if(arguments.length>1){var Z=""+arguments[0],we=""+arguments[1];if(!(L=Y(this,Z,we,this.type)))throw new te('Graph.dropEdge: could not find the "'.concat(Z,'" -> "').concat(we,'" edge in the graph.'))}else if(!(L=this._edges.get(A=""+A)))throw new te('Graph.dropEdge: could not find the "'.concat(A,'" edge in the graph.'));this._edges.delete(L.key);var et=L.source,Mt=L.target,$e=L.attributes,Gt=L.undirected;return et===Mt?Gt?(et.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(et.directedSelfLoops--,this._directedSelfLoopCount--):Gt?(et.undirectedDegree--,Mt.undirectedDegree--):(et.outDegree--,Mt.inDegree--),Ye(this,Gt,L),Gt?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:A,attributes:$e,source:et.key,target:Mt.key,undirected:Gt}),this},re.clear=function(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")},re.clearEdges=function(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")},re.getAttribute=function(A){return this._attributes[A]},re.getAttributes=function(){return this._attributes},re.hasAttribute=function(A){return this._attributes.hasOwnProperty(A)},re.setAttribute=function(A,L){return this._attributes[A]=L,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:A}),this},re.updateAttribute=function(A,L){if("function"!=typeof L)throw new me("Graph.updateAttribute: updater should be a function.");return this._attributes[A]=L(this._attributes[A]),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:A}),this},re.removeAttribute=function(A){return delete this._attributes[A],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:A}),this},re.replaceAttributes=function(A){if(!k(A))throw new me("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=A,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this},re.mergeAttributes=function(A){if(!k(A))throw new me("Graph.mergeAttributes: provided attributes are not a plain object.");return pe(this._attributes,A),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:A}),this},re.getNodeAttribute=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.getNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return Z.attributes[L]},re.getNodeAttributes=function(A){var L=this._nodes.get(A=""+A);if(!L)throw new te('Graph.getNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));return L.attributes},re.hasNodeAttribute=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return Z.attributes.hasOwnProperty(L)},re.setNodeAttribute=function(A,L,Z){var we=this._nodes.get(A=""+A);if(!we)throw new te('Graph.setNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return we.attributes[L]=Z,this.emit("nodeAttributesUpdated",{key:A,type:"set",attributes:we.attributes,name:L}),this},re.updateNodeAttribute=function(A,L,Z){var we=this._nodes.get(A=""+A);if(!we)throw new te('Graph.updateNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));if(arguments.length<3)throw new me("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if("function"!=typeof Z)throw new me("Graph.updateAttribute: updater should be a function.");var Fe=we.attributes,et=Z(Fe[L]);return Fe[L]=et,this.emit("nodeAttributesUpdated",{key:A,type:"set",attributes:we.attributes,name:L}),this},re.removeNodeAttribute=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.hasNodeAttribute: could not find the "'.concat(A,'" node in the graph.'));return delete Z.attributes[L],this.emit("nodeAttributesUpdated",{key:A,type:"remove",attributes:Z.attributes,name:L}),this},re.replaceNodeAttributes=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.replaceNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));if(!k(L))throw new me("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return Z.attributes=L,this.emit("nodeAttributesUpdated",{key:A,type:"replace",attributes:Z.attributes}),this},re.mergeNodeAttributes=function(A,L){var Z=this._nodes.get(A=""+A);if(!Z)throw new te('Graph.mergeNodeAttributes: could not find the "'.concat(A,'" node in the graph.'));if(!k(L))throw new me("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return pe(Z.attributes,L),this.emit("nodeAttributesUpdated",{key:A,type:"merge",attributes:Z.attributes,data:L}),this},re.updateEachNodeAttributes=function(A,L){if("function"!=typeof A)throw new me("Graph.updateEachNodeAttributes: expecting an updater function.");if(L&&!x(L))throw new me("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Fe=this._nodes.values();!0!==(Z=Fe.next()).done;)(we=Z.value).attributes=A(we.key,we.attributes);this.emit("eachNodeAttributesUpdated",{hints:L||null})},re.updateEachEdgeAttributes=function(A,L){if("function"!=typeof A)throw new me("Graph.updateEachEdgeAttributes: expecting an updater function.");if(L&&!x(L))throw new me("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");for(var Z,we,Fe=this._edges.values();!0!==(Z=Fe.next()).done;)(we=Z.value).attributes=A(we.key,we.attributes);this.emit("eachEdgeAttributesUpdated",{hints:L||null})},re.forEach=function(A){if("function"!=typeof A)throw new me("Graph.forEach: expecting a callback.");this.multi?lt(!1,this,A):ke(!1,this,A)},re.forEachUntil=function(A){if("function"!=typeof A)throw new me("Graph.forEach: expecting a callback.");this.multi?lt(!0,this,A):ke(!0,this,A)},re.adjacency=function(){return this.multi?(et=(A=this)._nodes.values(),Mt=A.type,$e="outer",Gt=null,new se(function bt(){var _n;if("outer"===$e)return!0===(_n=et.next()).done?_n:(L=_n.value,$e="directed",bt());if("directed"===$e)return"undirected"===Mt?($e="undirected",bt()):(we=L.out,Z=Object.keys(L.out),Fe=0,$e="inner-directed",bt());if("undirected"===$e){if("directed"===Mt)return $e="outer",bt();we=L.undirected,Z=Object.keys(L.undirected),Fe=0,$e="inner-undirected"}if(!Gt&&Fe>=Z.length)return $e="inner-undirected"===$e?"outer":"undirected",bt();if(!Gt){var vs=Z[Fe++];return Gt=we[vs].values(),bt()}if((_n=Gt.next()).done)return Gt=null,bt();var qr=_n.value,Ks=qr.target;return"inner-undirected"===$e&&Ks.key===L.key&&(Ks=qr.source),{done:!1,value:[L.key,Ks.key,L.attributes,Ks.attributes,qr.key,qr.attributes]}})):(Tl=(bt=this)._nodes.values(),lo=bt.type,Fr="outer",new se(function Ls(){var mc;if("outer"===Fr)return!0===(mc=Tl.next()).done?mc:(_n=mc.value,Fr="directed",Ls());if("directed"===Fr)return"undirected"===lo?(Fr="undirected",Ls()):(qr=_n.out,vs=Object.keys(_n.out),Ks=0,Fr="inner-directed",Ls());if("undirected"===Fr){if("directed"===lo)return Fr="outer",Ls();qr=_n.undirected,vs=Object.keys(_n.undirected),Ks=0,Fr="inner-undirected"}if(Ks>=vs.length)return Fr="inner-undirected"===Fr?"outer":"undirected",Ls();var wn=vs[Ks++],co=qr[wn],Al=co.target;return"inner-undirected"===Fr&&Al.key===_n.key&&(Al=co.source),{done:!1,value:[_n.key,Al.key,_n.attributes,Al.attributes,co.key,co.attributes]}}));var bt,_n,vs,qr,Ks,Tl,lo,Fr,A,L,Z,we,Fe,et,Mt,$e,Gt},re.nodes=function(){return"function"==typeof Array.from?Array.from(this._nodes.keys()):ee(this._nodes.keys(),this._nodes.size)},re.forEachNode=function(A){if("function"!=typeof A)throw new me("Graph.forEachNode: expecting a callback.");this._nodes.forEach(function(L,Z){A(Z,L.attributes)})},re.forEachNodeUntil=function(A){if("function"!=typeof A)throw new me("Graph.forEachNode: expecting a callback.");for(var L,Z,we=this._nodes.values();!0!==(L=we.next())&&!A((Z=L.value).key,Z.attributes););},re.nodeEntries=function(){var A=this._nodes.values();return new se(function(){var L=A.next();if(L.done)return L;var Z=L.value;return{value:[Z.key,Z.attributes],done:!1}})},re.exportNode=function(A){var L=this._nodes.get(A=""+A);if(!L)throw new te('Graph.exportNode: could not find the "'.concat(A,'" node in the graph.'));return Ze(A,L)},re.exportEdge=function(A){var L=this._edges.get(A=""+A);if(!L)throw new te('Graph.exportEdge: could not find the "'.concat(A,'" edge in the graph.'));return wt(A,L)},re.export=function(){var A=new Array(this._nodes.size),L=0;this._nodes.forEach(function(we,Fe){A[L++]=Ze(Fe,we)});var Z=new Array(this._edges.size);return L=0,this._edges.forEach(function(we,Fe){Z[L++]=wt(Fe,we)}),{attributes:this.getAttributes(),nodes:A,edges:Z,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}},re.importNode=function(A){var L=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=St(A);if(Z){if("not-object"===Z)throw new me('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if("no-key"===Z)throw new me("Graph.importNode: no key provided.");if("invalid-attributes"===Z)throw new me("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}var we=A.key,Fe=A.attributes,et=void 0===Fe?{}:Fe;return L?this.mergeNode(we,et):this.addNode(we,et),this},re.importEdge=function(A){var L=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=Tt(A);if(Z){if("not-object"===Z)throw new me('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if("no-source"===Z)throw new me("Graph.importEdge: missing souce.");if("no-target"===Z)throw new me("Graph.importEdge: missing target.");if("invalid-attributes"===Z)throw new me("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if("invalid-undirected"===Z)throw new me("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}var we=A.source,Fe=A.target,et=A.attributes,Mt=void 0===et?{}:et,$e=A.undirected,Gt=void 0!==$e&&$e;return"key"in A?(L?Gt?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:Gt?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey).call(this,A.key,we,Fe,Mt):(L?Gt?this.mergeUndirectedEdge:this.mergeDirectedEdge:Gt?this.addUndirectedEdge:this.addDirectedEdge).call(this,we,Fe,Mt),this},re.import=function(A){var L,Z,we,Fe=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(U(A))return this.import(A.export(),Fe),this;if(!k(A))throw new me("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(A.attributes){if(!k(A.attributes))throw new me("Graph.import: invalid attributes. Expecting a plain object.");Fe?this.mergeAttributes(A.attributes):this.replaceAttributes(A.attributes)}if(A.nodes){if(we=A.nodes,!Array.isArray(we))throw new me("Graph.import: invalid nodes. Expecting an array.");for(L=0,Z=we.length;L<Z;L++)this.importNode(we[L],Fe)}if(A.edges){if(we=A.edges,!Array.isArray(we))throw new me("Graph.import: invalid edges. Expecting an array.");for(L=0,Z=we.length;L<Z;L++)this.importEdge(we[L],Fe)}return this},re.nullCopy=function(A){return new he(pe({},this._options,A))},re.emptyCopy=function(A){var L=this.nullCopy(A);return this._nodes.forEach(function(Z,we){var Fe=pe({},Z.attributes);Z=new L.NodeDataClass(we,Fe),L._nodes.set(we,Z)}),L},re.copy=function(){var A=new he(this._options);return A.import(this),A},re.upgradeToMixed=function(){return"mixed"===this.type||(this._nodes.forEach(function(A){return A.upgradeToMixed()}),this._options.type="mixed",b(this,"type",this._options.type),W(this,"NodeDataClass",Oe)),this},re.upgradeToMulti=function(){return this.multi||(this._options.multi=!0,b(this,"multi",!0),(A=this)._nodes.forEach(function(L,Z){if(L.out)for(var we in L.out){var Fe=new Set;Fe.add(L.out[we]),L.out[we]=Fe,A._nodes.get(we).in[Z]=Fe}if(L.undirected)for(var et in L.undirected)if(!(et>Z)){var Mt=new Set;Mt.add(L.undirected[et]),L.undirected[et]=Mt,A._nodes.get(et).undirected[Z]=Mt}})),this;var A},re.clearIndex=function(){return this._nodes.forEach(function(A){void 0!==A.in&&(A.in={},A.out={}),void 0!==A.undirected&&(A.undirected={})}),this},re.toJSON=function(){return this.export()},re.toString=function(){return"[object Graph]"},re.inspect=function(){var A=this,L={};this._nodes.forEach(function(Mt,$e){L[$e]=Mt.attributes});var Z={},we={};this._edges.forEach(function(Mt,$e){var Gt=Mt.undirected?"--":"->",bt="",_n="(".concat(Mt.source.key,")").concat(Gt,"(").concat(Mt.target.key,")");Mt.generatedKey?A.multi&&(void 0===we[_n]?we[_n]=0:we[_n]++,bt+="".concat(we[_n],". ")):bt+="[".concat($e,"]: "),Z[bt+=_n]=Mt.attributes});var Fe={};for(var et in this)this.hasOwnProperty(et)&&!Vn.has(et)&&"function"!=typeof this[et]&&(Fe[et]=this[et]);return Fe.attributes=this._attributes,Fe.nodes=L,Fe.edges=Z,W(Fe,"constructor",this.constructor),Fe},he}(M.exports.EventEmitter);"undefined"!=typeof Symbol&&(Sn.prototype[Symbol.for("nodejs.util.inspect.custom")]=Sn.prototype.inspect),[{name:function(ne){return"".concat(ne,"Edge")},generateKey:!0},{name:function(ne){return"".concat(ne,"DirectedEdge")},generateKey:!0,type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdge")},generateKey:!0,type:"undirected"},{name:function(ne){return"".concat(ne,"EdgeWithKey")}},{name:function(ne){return"".concat(ne,"DirectedEdgeWithKey")},type:"directed"},{name:function(ne){return"".concat(ne,"UndirectedEdgeWithKey")},type:"undirected"}].forEach(function(ne){["add","merge","update"].forEach(function(he){var re=ne.name(he),A="add"===he?mn:Gn;Sn.prototype[re]=ne.generateKey?function(L,Z,we){return A(this,re,!0,"undirected"===(ne.type||this.type),null,L,Z,we,"update"===he)}:function(L,Z,we,Fe){return A(this,re,!1,"undirected"===(ne.type||this.type),L,Z,we,Fe,"update"===he)}})}),"undefined"!=typeof Symbol&&(Sn.prototype[Symbol.iterator]=Sn.prototype.adjacency),ne=Sn,Ue.forEach(function(he){var re=he.name,A=he.attacher;A(ne,re("Edge"),"mixed"),A(ne,re("DirectedEdge"),"directed"),A(ne,re("UndirectedEdge"),"undirected")}),function(ne){xe.forEach(function(he){var A,L,Z,we;Z=(A=he).type,we=A.direction,ne.prototype[L=A.name]=function(Fe,et){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(!arguments.length)return Re(this,Z);if(1===arguments.length){var Mt=this._nodes.get(Fe=""+Fe);if(void 0===Mt)throw new te("Graph.".concat(L,': could not find the "').concat(Fe,'" node in the graph.'));return Mn(this.multi,"mixed"===Z?this.type:Z,we,Mt)}if(2===arguments.length){et=""+et;var $e=this._nodes.get(Fe=""+Fe);if(!$e)throw new te("Graph.".concat(L,':  could not find the "').concat(Fe,'" source node in the graph.'));if(!this._nodes.has(et))throw new te("Graph.".concat(L,':  could not find the "').concat(et,'" target node in the graph.'));return fi(Z,this.multi,we,$e,et)}throw new me("Graph.".concat(L,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))},function(re,A){var L=A.name,Z=A.type,we=A.direction,Fe="forEach"+L[0].toUpperCase()+L.slice(1,-1);re.prototype[Fe]=function(et,Mt,$e){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return Qe(this,Z,$e=et);if(2===arguments.length){$e=Mt;var Gt=this._nodes.get(et=""+et);if(void 0===Gt)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return Rn(this.multi,"mixed"===Z?this.type:Z,we,Gt,$e)}if(3===arguments.length){Mt=""+Mt;var bt=this._nodes.get(et=""+et);if(!bt)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Mt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Mt,'" target node in the graph.'));return Gr(Z,this.multi,we,bt,Mt,$e)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,he),function(re,A){var L=A.name,Z=A.type,we=A.direction,Fe="forEach"+L[0].toUpperCase()+L.slice(1,-1)+"Until";re.prototype[Fe]=function(et,Mt,$e){if("mixed"===Z||"mixed"===this.type||Z===this.type){if(1===arguments.length)return vt(this,Z,$e=et);if(2===arguments.length){$e=Mt;var Gt=this._nodes.get(et=""+et);if(void 0===Gt)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return Hn(this.multi,"mixed"===Z?this.type:Z,we,Gt,$e)}if(3===arguments.length){Mt=""+Mt;var bt=this._nodes.get(et=""+et);if(!bt)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Mt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Mt,'" target node in the graph.'));return Ns(Z,this.multi,we,bt,Mt,$e)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 1, 2 or 3 and got ").concat(arguments.length,")."))}}}(ne,he),function(re,A){var Z=A.type,we=A.direction,Fe=A.name.slice(0,-1)+"Entries";re.prototype[Fe]=function(et,Mt){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return se.empty();if(!arguments.length)return It(this,Z);if(1===arguments.length){var $e=this._nodes.get(et=""+et);if(!$e)throw new te("Graph.".concat(Fe,': could not find the "').concat(et,'" node in the graph.'));return bi(Z,we,$e)}if(2===arguments.length){Mt=""+Mt;var Gt=this._nodes.get(et=""+et);if(!Gt)throw new te("Graph.".concat(Fe,':  could not find the "').concat(et,'" source node in the graph.'));if(!this._nodes.has(Mt))throw new te("Graph.".concat(Fe,':  could not find the "').concat(Mt,'" target node in the graph.'));return ds(Z,we,Gt,Mt)}throw new me("Graph.".concat(Fe,": too many arguments (expecting 0, 1 or 2 and got ").concat(arguments.length,")."))}}(ne,he)})}(Sn),function(ne){Fs.forEach(function(he){var A,L,Z,we;Z=(A=he).type,we=A.direction,ne.prototype[L=A.name]=function(Fe){if("mixed"!==Z&&"mixed"!==this.type&&Z!==this.type)return[];if(2===arguments.length){var et=""+arguments[0],Mt=""+arguments[1];if(!this._nodes.has(et))throw new te("Graph.".concat(L,': could not find the "').concat(et,'" node in the graph.'));if(!this._nodes.has(Mt))throw new te("Graph.".concat(L,': could not find the "').concat(Mt,'" node in the graph.'));return ot(this,Z,we,et,Mt)}if(1===arguments.length){var $e=this._nodes.get(Fe=""+Fe);if(void 0===$e)throw new te("Graph.".concat(L,': could not find the "').concat(Fe,'" node in the graph.'));return fa("mixed"===Z?this.type:Z,we,$e)}throw new me("Graph.".concat(L,": invalid number of arguments (expecting 1 or 2 and got ").concat(arguments.length,")."))},function(ne,he){var re=he.name,A=he.type,L=he.direction,Z="forEach"+re[0].toUpperCase()+re.slice(1,-1);ne.prototype[Z]=function(we,Fe){if("mixed"===A||"mixed"===this.type||A===this.type){var et=this._nodes.get(we=""+we);if(void 0===et)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Mt,$e,Gt,bt){if("mixed"!==Mt){if("undirected"===Mt)return xl(Gt,Gt.undirected,bt);if("string"==typeof $e)return xl(Gt,Gt[$e],bt)}var _n=new Set;"undirected"!==Mt&&("out"!==$e&&pa(_n,Gt,Gt.in,bt),"in"!==$e&&pa(_n,Gt,Gt.out,bt)),"directed"!==Mt&&pa(_n,Gt,Gt.undirected,bt)}("mixed"===A?this.type:A,L,et,Fe)}}}(ne,he),function(ne,he){var re=he.name,A=he.type,L=he.direction,Z="forEach"+re[0].toUpperCase()+re.slice(1,-1)+"Until";ne.prototype[Z]=function(we,Fe){if("mixed"===A||"mixed"===this.type||A===this.type){var et=this._nodes.get(we=""+we);if(void 0===et)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));!function(Mt,$e,Gt,bt){if("mixed"!==Mt){if("undirected"===Mt)return ys(Gt,Gt.undirected,bt);if("string"==typeof $e)return ys(Gt,Gt[$e],bt)}var _n=new Set;"undirected"!==Mt&&("out"!==$e&&Jt(_n,Gt,Gt.in,bt)||"in"!==$e&&Jt(_n,Gt,Gt.out,bt))||"directed"===Mt||Jt(_n,Gt,Gt.undirected,bt)}("mixed"===A?this.type:A,L,et,Fe)}}}(ne,he),function(ne,he){var A=he.type,L=he.direction,Z=he.name.slice(0,-1)+"Entries";ne.prototype[Z]=function(we){if("mixed"!==A&&"mixed"!==this.type&&A!==this.type)return se.empty();var Fe=this._nodes.get(we=""+we);if(void 0===Fe)throw new te("Graph.".concat(Z,': could not find the "').concat(we,'" node in the graph.'));return function(et,Mt,$e){if("mixed"!==et){if("undirected"===et)return Wa($e,$e.undirected);if("string"==typeof Mt)return Wa($e,$e[Mt])}var Gt=se.empty(),bt=new Set;return"undirected"!==et&&("out"!==Mt&&(Gt=Ke(Gt,it(bt,$e,$e.in))),"in"!==Mt&&(Gt=Ke(Gt,it(bt,$e,$e.out)))),"directed"!==et&&(Gt=Ke(Gt,it(bt,$e,$e.undirected))),Gt}("mixed"===A?this.type:A,L,Fe)}}(ne,he)})}(Sn);var er=function(ne){function he(re){var A=pe({type:"directed"},re);if("multi"in A&&!1!==A.multi)throw new me("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("directed"!==A.type)throw new me('DirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return tt(he,ne),he}(Sn),tr=function(ne){function he(re){var A=pe({type:"undirected"},re);if("multi"in A&&!1!==A.multi)throw new me("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if("undirected"!==A.type)throw new me('UndirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return tt(he,ne),he}(Sn),qn=function(ne){function he(re){var A=pe({multi:!0},re);if("multi"in A&&!0!==A.multi)throw new me("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");return ne.call(this,A)||this}return tt(he,ne),he}(Sn),Vi=function(ne){function he(re){var A=pe({type:"directed",multi:!0},re);if("multi"in A&&!0!==A.multi)throw new me("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("directed"!==A.type)throw new me('MultiDirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return tt(he,ne),he}(Sn),ga=function(ne){function he(re){var A=pe({type:"undirected",multi:!0},re);if("multi"in A&&!0!==A.multi)throw new me("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if("undirected"!==A.type)throw new me('MultiUndirectedGraph.from: inconsistent "'+A.type+'" type in given options!');return ne.call(this,A)||this}return tt(he,ne),he}(Sn);function Wr(ne){ne.from=function(he,re){var A=pe({},he.options,re),L=new ne(A);return L.import(he),L}}return Wr(Sn),Wr(er),Wr(tr),Wr(qn),Wr(Vi),Wr(ga),Sn.Graph=Sn,Sn.DirectedGraph=er,Sn.UndirectedGraph=tr,Sn.MultiGraph=qn,Sn.MultiDirectedGraph=Vi,Sn.MultiUndirectedGraph=ga,Sn.InvalidArgumentsGraphError=me,Sn.NotFoundGraphError=te,Sn.UsageGraphError=_e,Sn}()},524:(Vt,nt,tt)=>{var mt;!function(J,xt,dt,K){"use strict";var M,Ae=["","webkit","Moz","MS","ms","o"],pe=xt.createElement("div"),U=Math.round,k=Math.abs,ie=Date.now;function W(ye,Te,He){return setTimeout(T(ye,He),Te)}function b(ye,Te,He){return!!Array.isArray(ye)&&(x(ye,He[Te],He),!0)}function x(ye,Te,He){var _t;if(ye)if(ye.forEach)ye.forEach(Te,He);else if(ye.length!==K)for(_t=0;_t<ye.length;)Te.call(He,ye[_t],_t,ye),_t++;else for(_t in ye)ye.hasOwnProperty(_t)&&Te.call(He,ye[_t],_t,ye)}function N(ye,Te,He){var _t="DEPRECATED METHOD: "+Te+"\n"+He+" AT \n";return function(){var Ut=new Error("get-stack-trace"),$t=Ut&&Ut.stack?Ut.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ri=J.console&&(J.console.warn||J.console.log);return ri&&ri.call(J.console,_t,$t),ye.apply(this,arguments)}}M="function"!=typeof Object.assign?function(Te){if(Te===K||null===Te)throw new TypeError("Cannot convert undefined or null to object");for(var He=Object(Te),_t=1;_t<arguments.length;_t++){var Ut=arguments[_t];if(Ut!==K&&null!==Ut)for(var $t in Ut)Ut.hasOwnProperty($t)&&(He[$t]=Ut[$t])}return He}:Object.assign;var v=N(function(Te,He,_t){for(var Ut=Object.keys(He),$t=0;$t<Ut.length;)(!_t||_t&&Te[Ut[$t]]===K)&&(Te[Ut[$t]]=He[Ut[$t]]),$t++;return Te},"extend","Use `assign`."),y=N(function(Te,He){return v(Te,He,!0)},"merge","Use `assign`.");function S(ye,Te,He){var Ut,_t=Te.prototype;(Ut=ye.prototype=Object.create(_t)).constructor=ye,Ut._super=_t,He&&M(Ut,He)}function T(ye,Te){return function(){return ye.apply(Te,arguments)}}function j(ye,Te){return"function"==typeof ye?ye.apply(Te&&Te[0]||K,Te):ye}function O(ye,Te){return ye===K?Te:ye}function q(ye,Te,He){x(X(Te),function(_t){ye.addEventListener(_t,He,!1)})}function ce(ye,Te,He){x(X(Te),function(_t){ye.removeEventListener(_t,He,!1)})}function D(ye,Te){for(;ye;){if(ye==Te)return!0;ye=ye.parentNode}return!1}function I(ye,Te){return ye.indexOf(Te)>-1}function X(ye){return ye.trim().split(/\s+/g)}function w(ye,Te,He){if(ye.indexOf&&!He)return ye.indexOf(Te);for(var _t=0;_t<ye.length;){if(He&&ye[_t][He]==Te||!He&&ye[_t]===Te)return _t;_t++}return-1}function G(ye){return Array.prototype.slice.call(ye,0)}function Q(ye,Te,He){for(var _t=[],Ut=[],$t=0;$t<ye.length;){var ri=Te?ye[$t][Te]:ye[$t];w(Ut,ri)<0&&_t.push(ye[$t]),Ut[$t]=ri,$t++}return He&&(_t=Te?_t.sort(function(Yr,bs){return Yr[Te]>bs[Te]}):_t.sort()),_t}function oe(ye,Te){for(var He,_t,Ut=Te[0].toUpperCase()+Te.slice(1),$t=0;$t<Ae.length;){if((_t=(He=Ae[$t])?He+Ut:Te)in ye)return _t;$t++}return K}var se=1;function Se(ye){var Te=ye.ownerDocument||ye;return Te.defaultView||Te.parentWindow||J}var te="ontouchstart"in J,_e=oe(J,"PointerEvent")!==K,Oe=te&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ge="touch",Xe="mouse",gt=["x","y"],ft=["clientX","clientY"];function be(ye,Te){var He=this;this.manager=ye,this.callback=Te,this.element=ye.element,this.target=ye.options.inputTarget,this.domHandler=function(_t){j(ye.options.enable,[ye])&&He.handler(_t)},this.init()}function P(ye,Te,He){var _t=He.pointers.length,Ut=He.changedPointers.length,$t=1&Te&&_t-Ut==0,ri=12&Te&&_t-Ut==0;He.isFirst=!!$t,He.isFinal=!!ri,$t&&(ye.session={}),He.eventType=Te,function(ye,Te){var He=ye.session,_t=Te.pointers,Ut=_t.length;He.firstInput||(He.firstInput=vt(Te)),Ut>1&&!He.firstMultiple?He.firstMultiple=vt(Te):1===Ut&&(He.firstMultiple=!1);var $t=He.firstInput,ri=He.firstMultiple,Lr=ri?ri.center:$t.center,Yr=Te.center=It(_t);Te.timeStamp=ie(),Te.deltaTime=Te.timeStamp-$t.timeStamp,Te.angle=bi(Lr,Yr),Te.distance=Hn(Lr,Yr),function(ye,Te){var He=Te.center,_t=ye.offsetDelta||{},Ut=ye.prevDelta||{},$t=ye.prevInput||{};(1===Te.eventType||4===$t.eventType)&&(Ut=ye.prevDelta={x:$t.deltaX||0,y:$t.deltaY||0},_t=ye.offsetDelta={x:He.x,y:He.y}),Te.deltaX=Ut.x+(He.x-_t.x),Te.deltaY=Ut.y+(He.y-_t.y)}(He,Te),Te.offsetDirection=Rn(Te.deltaX,Te.deltaY);var bs=Mn(Te.deltaTime,Te.deltaX,Te.deltaY);Te.overallVelocityX=bs.x,Te.overallVelocityY=bs.y,Te.overallVelocity=k(bs.x)>k(bs.y)?bs.x:bs.y,Te.scale=ri?function(ye,Te){return Hn(Te[0],Te[1],ft)/Hn(ye[0],ye[1],ft)}(ri.pointers,_t):1,Te.rotation=ri?function(ye,Te){return bi(Te[1],Te[0],ft)+bi(ye[1],ye[0],ft)}(ri.pointers,_t):0,Te.maxPointers=He.prevInput?Te.pointers.length>He.prevInput.maxPointers?Te.pointers.length:He.prevInput.maxPointers:Te.pointers.length,function(ye,Te){var Ut,$t,ri,Lr,He=ye.lastInterval||Te,_t=Te.timeStamp-He.timeStamp;if(8!=Te.eventType&&(_t>25||He.velocity===K)){var Yr=Te.deltaX-He.deltaX,bs=Te.deltaY-He.deltaY,ti=Mn(_t,Yr,bs);$t=ti.x,ri=ti.y,Ut=k(ti.x)>k(ti.y)?ti.x:ti.y,Lr=Rn(Yr,bs),ye.lastInterval=Te}else Ut=He.velocity,$t=He.velocityX,ri=He.velocityY,Lr=He.direction;Te.velocity=Ut,Te.velocityX=$t,Te.velocityY=ri,Te.direction=Lr}(He,Te);var ti=ye.element;D(Te.srcEvent.target,ti)&&(ti=Te.srcEvent.target),Te.target=ti}(ye,He),ye.emit("hammer.input",He),ye.recognize(He),ye.session.prevInput=He}function vt(ye){for(var Te=[],He=0;He<ye.pointers.length;)Te[He]={clientX:U(ye.pointers[He].clientX),clientY:U(ye.pointers[He].clientY)},He++;return{timeStamp:ie(),pointers:Te,center:It(Te),deltaX:ye.deltaX,deltaY:ye.deltaY}}function It(ye){var Te=ye.length;if(1===Te)return{x:U(ye[0].clientX),y:U(ye[0].clientY)};for(var He=0,_t=0,Ut=0;Ut<Te;)He+=ye[Ut].clientX,_t+=ye[Ut].clientY,Ut++;return{x:U(He/Te),y:U(_t/Te)}}function Mn(ye,Te,He){return{x:Te/ye||0,y:He/ye||0}}function Rn(ye,Te){return ye===Te?1:k(ye)>=k(Te)?ye<0?2:4:Te<0?8:16}function Hn(ye,Te,He){He||(He=gt);var _t=Te[He[0]]-ye[He[0]],Ut=Te[He[1]]-ye[He[1]];return Math.sqrt(_t*_t+Ut*Ut)}function bi(ye,Te,He){return He||(He=gt),180*Math.atan2(Te[He[1]]-ye[He[1]],Te[He[0]]-ye[He[0]])/Math.PI}be.prototype={handler:function(){},init:function(){this.evEl&&q(this.element,this.evEl,this.domHandler),this.evTarget&&q(this.target,this.evTarget,this.domHandler),this.evWin&&q(Se(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ce(this.element,this.evEl,this.domHandler),this.evTarget&&ce(this.target,this.evTarget,this.domHandler),this.evWin&&ce(Se(this.element),this.evWin,this.domHandler)}};var Ns={mousedown:1,mousemove:2,mouseup:4},ds="mousedown",Fs="mousemove mouseup";function $r(){this.evEl=ds,this.evWin=Fs,this.pressed=!1,be.apply(this,arguments)}S($r,be,{handler:function(Te){var He=Ns[Te.type];1&He&&0===Te.button&&(this.pressed=!0),2&He&&1!==Te.which&&(He=4),this.pressed&&(4&He&&(this.pressed=!1),this.callback(this.manager,He,{pointers:[Te],changedPointers:[Te],pointerType:Xe,srcEvent:Te}))}});var fa={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},xl={2:Ge,3:"pen",4:Xe,5:"kinect"},pa="pointerdown",ys="pointermove pointerup pointercancel";function Jt(){this.evEl=pa,this.evWin=ys,be.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}J.MSPointerEvent&&!J.PointerEvent&&(pa="MSPointerDown",ys="MSPointerMove MSPointerUp MSPointerCancel"),S(Jt,be,{handler:function(Te){var He=this.store,_t=!1,Ut=Te.type.toLowerCase().replace("ms",""),$t=fa[Ut],ri=xl[Te.pointerType]||Te.pointerType,Lr=ri==Ge,Yr=w(He,Te.pointerId,"pointerId");1&$t&&(0===Te.button||Lr)?Yr<0&&(He.push(Te),Yr=He.length-1):12&$t&&(_t=!0),!(Yr<0)&&(He[Yr]=Te,this.callback(this.manager,$t,{pointers:He,changedPointers:[Te],pointerType:ri,srcEvent:Te}),_t&&He.splice(Yr,1))}});var Wa={touchstart:1,touchmove:2,touchend:4,touchcancel:8},it="touchstart",ot="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=it,this.evWin=ot,this.started=!1,be.apply(this,arguments)}function ge(ye,Te){var He=G(ye.touches),_t=G(ye.changedTouches);return 12&Te&&(He=Q(He.concat(_t),"identifier",!0)),[He,_t]}S(ut,be,{handler:function(Te){var He=Wa[Te.type];if(1===He&&(this.started=!0),this.started){var _t=ge.call(this,Te,He);12&He&&_t[0].length-_t[1].length==0&&(this.started=!1),this.callback(this.manager,He,{pointers:_t[0],changedPointers:_t[1],pointerType:Ge,srcEvent:Te})}}});var ve={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ke="touchstart touchmove touchend touchcancel";function lt(){this.evTarget=ke,this.targetIds={},be.apply(this,arguments)}function Ze(ye,Te){var He=G(ye.touches),_t=this.targetIds;if(3&Te&&1===He.length)return _t[He[0].identifier]=!0,[He,He];var Ut,$t,ri=G(ye.changedTouches),Lr=[],Yr=this.target;if($t=He.filter(function(bs){return D(bs.target,Yr)}),1===Te)for(Ut=0;Ut<$t.length;)_t[$t[Ut].identifier]=!0,Ut++;for(Ut=0;Ut<ri.length;)_t[ri[Ut].identifier]&&Lr.push(ri[Ut]),12&Te&&delete _t[ri[Ut].identifier],Ut++;return Lr.length?[Q($t.concat(Lr),"identifier",!0),Lr]:void 0}function Tt(){be.apply(this,arguments);var ye=T(this.handler,this);this.touch=new lt(this.manager,ye),this.mouse=new $r(this.manager,ye),this.primaryTouch=null,this.lastTouches=[]}function Yt(ye,Te){1&ye?(this.primaryTouch=Te.changedPointers[0].identifier,Vn.call(this,Te)):12&ye&&Vn.call(this,Te)}function Vn(ye){var Te=ye.changedPointers[0];if(Te.identifier===this.primaryTouch){var He={x:Te.clientX,y:Te.clientY};this.lastTouches.push(He);var _t=this.lastTouches;setTimeout(function(){var $t=_t.indexOf(He);$t>-1&&_t.splice($t,1)},2500)}}function ii(ye){for(var Te=ye.srcEvent.clientX,He=ye.srcEvent.clientY,_t=0;_t<this.lastTouches.length;_t++){var Ut=this.lastTouches[_t],$t=Math.abs(Te-Ut.x),ri=Math.abs(He-Ut.y);if($t<=25&&ri<=25)return!0}return!1}S(lt,be,{handler:function(Te){var He=ve[Te.type],_t=Ze.call(this,Te,He);!_t||this.callback(this.manager,He,{pointers:_t[0],changedPointers:_t[1],pointerType:Ge,srcEvent:Te})}}),S(Tt,be,{handler:function(Te,He,_t){var $t=_t.pointerType==Xe;if(!($t&&_t.sourceCapabilities&&_t.sourceCapabilities.firesTouchEvents)){if(_t.pointerType==Ge)Yt.call(this,He,_t);else if($t&&ii.call(this,_t))return;this.callback(Te,He,_t)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var On=oe(pe.style,"touchAction"),mn=On!==K,Gn="compute",er="manipulation",tr="none",qn="pan-x",Vi="pan-y",ga=function(){if(!mn)return!1;var ye={},Te=J.CSS&&J.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(He){ye[He]=!Te||J.CSS.supports("touch-action",He)}),ye}();function Wr(ye,Te){this.manager=ye,this.set(Te)}function Mt(ye){this.options=M({},this.defaults,ye||{}),this.id=se++,this.manager=null,this.options.enable=O(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function $e(ye){return 16&ye?"cancel":8&ye?"end":4&ye?"move":2&ye?"start":""}function Gt(ye){return 16==ye?"down":8==ye?"up":2==ye?"left":4==ye?"right":""}function bt(ye,Te){var He=Te.manager;return He?He.get(ye):ye}function _n(){Mt.apply(this,arguments)}function vs(){_n.apply(this,arguments),this.pX=null,this.pY=null}function qr(){_n.apply(this,arguments)}function Ks(){Mt.apply(this,arguments),this._timer=null,this._input=null}function Tl(){_n.apply(this,arguments)}function lo(){_n.apply(this,arguments)}function Fr(){Mt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ls(ye,Te){return(Te=Te||{}).recognizers=O(Te.recognizers,Ls.defaults.preset),new co(ye,Te)}function co(ye,Te){this.options=M({},Ls.defaults,Te||{}),this.options.inputTarget=this.options.inputTarget||ye,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ye,this.input=function(ye){return new(ye.options.inputClass||(_e?Jt:Oe?lt:te?Tt:$r))(ye,P)}(this),this.touchAction=new Wr(this,this.options.touchAction),Al(this,!0),x(this.options.recognizers,function(He){var _t=this.add(new He[0](He[1]));He[2]&&_t.recognizeWith(He[2]),He[3]&&_t.requireFailure(He[3])},this)}function Al(ye,Te){var _t,He=ye.element;He.style&&(x(ye.options.cssProps,function(Ut,$t){_t=oe(He.style,$t),Te?(ye.oldCssProps[_t]=He.style[_t],He.style[_t]=Ut):He.style[_t]=ye.oldCssProps[_t]||""}),Te||(ye.oldCssProps={}))}Wr.prototype={set:function(ye){ye==Gn&&(ye=this.compute()),mn&&this.manager.element.style&&ga[ye]&&(this.manager.element.style[On]=ye),this.actions=ye.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ye=[];return x(this.manager.recognizers,function(Te){j(Te.options.enable,[Te])&&(ye=ye.concat(Te.getTouchAction()))}),function(ye){if(I(ye,tr))return tr;var Te=I(ye,qn),He=I(ye,Vi);return Te&&He?tr:Te||He?Te?qn:Vi:I(ye,er)?er:"auto"}(ye.join(" "))},preventDefaults:function(ye){var Te=ye.srcEvent,He=ye.offsetDirection;if(!this.manager.session.prevented){var _t=this.actions,Ut=I(_t,tr)&&!ga[tr],$t=I(_t,Vi)&&!ga[Vi],ri=I(_t,qn)&&!ga[qn];if(Ut&&1===ye.pointers.length&&ye.distance<2&&ye.deltaTime<250)return;return ri&&$t||!(Ut||$t&&6&He||ri&&24&He)?void 0:this.preventSrc(Te)}Te.preventDefault()},preventSrc:function(ye){this.manager.session.prevented=!0,ye.preventDefault()}},Mt.prototype={defaults:{},set:function(ye){return M(this.options,ye),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ye){if(b(ye,"recognizeWith",this))return this;var Te=this.simultaneous;return Te[(ye=bt(ye,this)).id]||(Te[ye.id]=ye,ye.recognizeWith(this)),this},dropRecognizeWith:function(ye){return b(ye,"dropRecognizeWith",this)||(ye=bt(ye,this),delete this.simultaneous[ye.id]),this},requireFailure:function(ye){if(b(ye,"requireFailure",this))return this;var Te=this.requireFail;return-1===w(Te,ye=bt(ye,this))&&(Te.push(ye),ye.requireFailure(this)),this},dropRequireFailure:function(ye){if(b(ye,"dropRequireFailure",this))return this;ye=bt(ye,this);var Te=w(this.requireFail,ye);return Te>-1&&this.requireFail.splice(Te,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ye){return!!this.simultaneous[ye.id]},emit:function(ye){var Te=this,He=this.state;function _t(Ut){Te.manager.emit(Ut,ye)}He<8&&_t(Te.options.event+$e(He)),_t(Te.options.event),ye.additionalEvent&&_t(ye.additionalEvent),He>=8&&_t(Te.options.event+$e(He))},tryEmit:function(ye){if(this.canEmit())return this.emit(ye);this.state=32},canEmit:function(){for(var ye=0;ye<this.requireFail.length;){if(!(33&this.requireFail[ye].state))return!1;ye++}return!0},recognize:function(ye){var Te=M({},ye);if(!j(this.options.enable,[this,Te]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Te),30&this.state&&this.tryEmit(Te)},process:function(ye){},getTouchAction:function(){},reset:function(){}},S(_n,Mt,{defaults:{pointers:1},attrTest:function(ye){var Te=this.options.pointers;return 0===Te||ye.pointers.length===Te},process:function(ye){var Te=this.state,He=ye.eventType,_t=6&Te,Ut=this.attrTest(ye);return _t&&(8&He||!Ut)?16|Te:_t||Ut?4&He?8|Te:2&Te?4|Te:2:32}}),S(vs,_n,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var ye=this.options.direction,Te=[];return 6&ye&&Te.push(Vi),24&ye&&Te.push(qn),Te},directionTest:function(ye){var Te=this.options,He=!0,_t=ye.distance,Ut=ye.direction,$t=ye.deltaX,ri=ye.deltaY;return Ut&Te.direction||(6&Te.direction?(Ut=0===$t?1:$t<0?2:4,He=$t!=this.pX,_t=Math.abs(ye.deltaX)):(Ut=0===ri?1:ri<0?8:16,He=ri!=this.pY,_t=Math.abs(ye.deltaY))),ye.direction=Ut,He&&_t>Te.threshold&&Ut&Te.direction},attrTest:function(ye){return _n.prototype.attrTest.call(this,ye)&&(2&this.state||!(2&this.state)&&this.directionTest(ye))},emit:function(ye){this.pX=ye.deltaX,this.pY=ye.deltaY;var Te=Gt(ye.direction);Te&&(ye.additionalEvent=this.options.event+Te),this._super.emit.call(this,ye)}}),S(qr,_n,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tr]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.scale-1)>this.options.threshold||2&this.state)},emit:function(ye){1!==ye.scale&&(ye.additionalEvent=this.options.event+(ye.scale<1?"in":"out")),this._super.emit.call(this,ye)}}),S(Ks,Mt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(ye){var Te=this.options,He=ye.pointers.length===Te.pointers,_t=ye.distance<Te.threshold,Ut=ye.deltaTime>Te.time;if(this._input=ye,!_t||!He||12&ye.eventType&&!Ut)this.reset();else if(1&ye.eventType)this.reset(),this._timer=W(function(){this.state=8,this.tryEmit()},Te.time,this);else if(4&ye.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(ye){8===this.state&&(ye&&4&ye.eventType?this.manager.emit(this.options.event+"up",ye):(this._input.timeStamp=ie(),this.manager.emit(this.options.event,this._input)))}}),S(Tl,_n,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tr]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.rotation)>this.options.threshold||2&this.state)}}),S(lo,_n,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return vs.prototype.getTouchAction.call(this)},attrTest:function(ye){var He,Te=this.options.direction;return 30&Te?He=ye.overallVelocity:6&Te?He=ye.overallVelocityX:24&Te&&(He=ye.overallVelocityY),this._super.attrTest.call(this,ye)&&Te&ye.offsetDirection&&ye.distance>this.options.threshold&&ye.maxPointers==this.options.pointers&&k(He)>this.options.velocity&&4&ye.eventType},emit:function(ye){var Te=Gt(ye.offsetDirection);Te&&this.manager.emit(this.options.event+Te,ye),this.manager.emit(this.options.event,ye)}}),S(Fr,Mt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[er]},process:function(ye){var Te=this.options,He=ye.pointers.length===Te.pointers,_t=ye.distance<Te.threshold,Ut=ye.deltaTime<Te.time;if(this.reset(),1&ye.eventType&&0===this.count)return this.failTimeout();if(_t&&Ut&&He){if(4!=ye.eventType)return this.failTimeout();var $t=!this.pTime||ye.timeStamp-this.pTime<Te.interval,ri=!this.pCenter||Hn(this.pCenter,ye.center)<Te.posThreshold;if(this.pTime=ye.timeStamp,this.pCenter=ye.center,ri&&$t?this.count+=1:this.count=1,this._input=ye,0==this.count%Te.taps)return this.hasRequireFailures()?(this._timer=W(function(){this.state=8,this.tryEmit()},Te.interval,this),2):8}return 32},failTimeout:function(){return this._timer=W(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ls.VERSION="2.0.7",Ls.defaults={domEvents:!1,touchAction:Gn,enable:!0,inputTarget:null,inputClass:null,preset:[[Tl,{enable:!1}],[qr,{enable:!1},["rotate"]],[lo,{direction:6}],[vs,{direction:6},["swipe"]],[Fr],[Fr,{event:"doubletap",taps:2},["tap"]],[Ks]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},co.prototype={set:function(ye){return M(this.options,ye),ye.touchAction&&this.touchAction.update(),ye.inputTarget&&(this.input.destroy(),this.input.target=ye.inputTarget,this.input.init()),this},stop:function(ye){this.session.stopped=ye?2:1},recognize:function(ye){var Te=this.session;if(!Te.stopped){this.touchAction.preventDefaults(ye);var He,_t=this.recognizers,Ut=Te.curRecognizer;(!Ut||Ut&&8&Ut.state)&&(Ut=Te.curRecognizer=null);for(var $t=0;$t<_t.length;)He=_t[$t],2===Te.stopped||Ut&&He!=Ut&&!He.canRecognizeWith(Ut)?He.reset():He.recognize(ye),!Ut&&14&He.state&&(Ut=Te.curRecognizer=He),$t++}},get:function(ye){if(ye instanceof Mt)return ye;for(var Te=this.recognizers,He=0;He<Te.length;He++)if(Te[He].options.event==ye)return Te[He];return null},add:function(ye){if(b(ye,"add",this))return this;var Te=this.get(ye.options.event);return Te&&this.remove(Te),this.recognizers.push(ye),ye.manager=this,this.touchAction.update(),ye},remove:function(ye){if(b(ye,"remove",this))return this;if(ye=this.get(ye)){var Te=this.recognizers,He=w(Te,ye);-1!==He&&(Te.splice(He,1),this.touchAction.update())}return this},on:function(ye,Te){if(ye!==K&&Te!==K){var He=this.handlers;return x(X(ye),function(_t){He[_t]=He[_t]||[],He[_t].push(Te)}),this}},off:function(ye,Te){if(ye!==K){var He=this.handlers;return x(X(ye),function(_t){Te?He[_t]&&He[_t].splice(w(He[_t],Te),1):delete He[_t]}),this}},emit:function(ye,Te){this.options.domEvents&&function(ye,Te){var He=xt.createEvent("Event");He.initEvent(ye,!0,!0),He.gesture=Te,Te.target.dispatchEvent(He)}(ye,Te);var He=this.handlers[ye]&&this.handlers[ye].slice();if(He&&He.length){Te.type=ye,Te.preventDefault=function(){Te.srcEvent.preventDefault()};for(var _t=0;_t<He.length;)He[_t](Te),_t++}},destroy:function(){this.element&&Al(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},M(Ls,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:co,Input:be,TouchAction:Wr,TouchInput:lt,MouseInput:$r,PointerEventInput:Jt,TouchMouseInput:Tt,SingleTouchInput:ut,Recognizer:Mt,AttrRecognizer:_n,Tap:Fr,Pan:vs,Swipe:lo,Pinch:qr,Rotate:Tl,Press:Ks,on:q,off:ce,each:x,merge:y,extend:v,assign:M,inherit:S,bindFn:T,prefixed:oe}),(void 0!==J?J:"undefined"!=typeof self?self:{}).Hammer=Ls,(mt=function(){return Ls}.call(nt,tt,nt,Vt))!==K&&(Vt.exports=mt)}(window,document)},815:function(Vt,nt,tt){var mt;Vt=tt.nmd(Vt),function(){var J,Ae="Expected a function",Y="__lodash_hash_undefined__",k="__lodash_placeholder__",j=32,q=128,ee=1/0,Se=9007199254740991,_e=4294967295,rt=[["ary",q],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",j],["partialRight",64],["rearg",256]],Xe="[object Arguments]",Je="[object Array]",Ue="[object Boolean]",Le="[object Date]",xe="[object Error]",je="[object Function]",We="[object GeneratorFunction]",Pe="[object Map]",$="[object Number]",fe="[object Object]",ue="[object Promise]",gt="[object RegExp]",ft="[object Set]",be="[object String]",B="[object Symbol]",V="[object WeakMap]",Qe="[object ArrayBuffer]",vt="[object DataView]",It="[object Float32Array]",Mn="[object Float64Array]",Rn="[object Int8Array]",Hn="[object Int16Array]",bi="[object Int32Array]",fi="[object Uint8Array]",Gr="[object Uint8ClampedArray]",Ns="[object Uint16Array]",ds="[object Uint32Array]",Fs=/\b__p \+= '';/g,$r=/\b(__p \+=) '' \+/g,fa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xl=/&(?:amp|lt|gt|quot|#39);/g,pa=/[&<>"']/g,ys=RegExp(xl.source),Jt=RegExp(pa.source),Wa=/<%-([\s\S]+?)%>/g,it=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,ut=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ge=/^\w*$/,ve=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ke=/[\\^$.*+?()[\]{}|]/g,lt=RegExp(ke.source),Ze=/^\s+/,wt=/\s/,St=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Tt=/\{\n\/\* \[wrapped with (.+)\] \*/,Yt=/,? & /,Vn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ii=/[()=,{}\[\]\/\s]/,On=/\\(\\)?/g,mn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Gn=/\w*$/,Sn=/^[-+]0x[0-9a-f]+$/i,er=/^0b[01]+$/i,tr=/^\[object .+?Constructor\]$/,qn=/^0o[0-7]+$/i,Vi=/^(?:0|[1-9]\d*)$/,ga=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wr=/($^)/,ne=/['\n\r\u2028\u2029\\]/g,he="\\ud800-\\udfff",Z="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",we="\\u2700-\\u27bf",Fe="a-z\\xdf-\\xf6\\xf8-\\xff",bt="A-Z\\xc0-\\xd6\\xd8-\\xde",_n="\\ufe0e\\ufe0f",vs="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ks="["+he+"]",Tl="["+vs+"]",lo="["+Z+"]",Fr="\\d+",Ls="["+we+"]",mc="["+Fe+"]",wn="[^"+he+vs+Fr+we+Fe+bt+"]",co="\\ud83c[\\udffb-\\udfff]",ma="[^"+he+"]",ud="(?:\\ud83c[\\udde6-\\uddff]){2}",ye="[\\ud800-\\udbff][\\udc00-\\udfff]",Te="["+bt+"]",_t="(?:"+mc+"|"+wn+")",Ut="(?:"+Te+"|"+wn+")",$t="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ri="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Lr="(?:"+lo+"|"+co+")?",Yr="["+_n+"]?",Dx=Yr+Lr+"(?:\\u200d(?:"+[ma,ud,ye].join("|")+")"+Yr+Lr+")*",dd="(?:"+[Ls,ud,ye].join("|")+")"+Dx,Xi="(?:"+[ma+lo+"?",lo,ud,ye,Ks].join("|")+")",Yf=RegExp("['\u2019]","g"),Mm=RegExp(lo,"g"),mh=RegExp(co+"(?="+co+")|"+Xi+Dx,"g"),_b=RegExp([Te+"?"+mc+"+"+$t+"(?="+[Tl,Te,"$"].join("|")+")",Ut+"+"+ri+"(?="+[Tl,Te+_t,"$"].join("|")+")",Te+"?"+_t+"+"+$t,Te+"+"+ri,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fr,dd].join("|"),"g"),Ix=RegExp("[\\u200d"+he+Z+_n+"]"),Ml=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_h=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ox=-1,yn={};yn[It]=yn[Mn]=yn[Rn]=yn[Hn]=yn[bi]=yn[fi]=yn[Gr]=yn[Ns]=yn[ds]=!0,yn[Xe]=yn[Je]=yn[Qe]=yn[Ue]=yn[vt]=yn[Le]=yn[xe]=yn[je]=yn[Pe]=yn[$]=yn[fe]=yn[gt]=yn[ft]=yn[be]=yn[V]=!1;var nr={};nr[Xe]=nr[Je]=nr[Qe]=nr[vt]=nr[Ue]=nr[Le]=nr[It]=nr[Mn]=nr[Rn]=nr[Hn]=nr[bi]=nr[Pe]=nr[$]=nr[fe]=nr[gt]=nr[ft]=nr[be]=nr[B]=nr[fi]=nr[Gr]=nr[Ns]=nr[ds]=!0,nr[xe]=nr[je]=nr[V]=!1;var ln={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Rx=parseFloat,wb=parseInt,kt="object"==typeof global&&global&&global.Object===Object&&global,ks="object"==typeof self&&self&&self.Object===Object&&self,Ni=kt||ks||Function("return this")(),Dl=nt&&!nt.nodeType&&nt,_a=Dl&&Vt&&!Vt.nodeType&&Vt,xo=_a&&_a.exports===Dl,Dm=xo&&kt.process,_r=function(){try{return _a&&_a.require&&_a.require("util").types||Dm&&Dm.binding&&Dm.binding("util")}catch(At){}}(),rn=_r&&_r.isArrayBuffer,oi=_r&&_r.isDate,or=_r&&_r.isMap,uo=_r&&_r.isRegExp,_c=_r&&_r.isSet,ts=_r&&_r.isTypedArray;function ns(st,At,yt){switch(yt.length){case 0:return st.call(At);case 1:return st.call(At,yt[0]);case 2:return st.call(At,yt[0],yt[1]);case 3:return st.call(At,yt[0],yt[1],yt[2])}return st.apply(At,yt)}function kr(st,At,yt,un){for(var Tn=-1,Oi=null==st?0:st.length;++Tn<Oi;){var Kr=st[Tn];At(un,Kr,yt(Kr),st)}return un}function Bs(st,At){for(var yt=-1,un=null==st?0:st.length;++yt<un&&!1!==At(st[yt],yt,st););return st}function hd(st,At){for(var yt=null==st?0:st.length;yt--&&!1!==At(st[yt],yt,st););return st}function Jn(st,At){for(var yt=-1,un=null==st?0:st.length;++yt<un;)if(!At(st[yt],yt,st))return!1;return!0}function ya(st,At){for(var yt=-1,un=null==st?0:st.length,Tn=0,Oi=[];++yt<un;){var Kr=st[yt];At(Kr,yt,st)&&(Oi[Tn++]=Kr)}return Oi}function Il(st,At){return!(null==st||!st.length)&&qa(st,At,0)>-1}function yh(st,At,yt){for(var un=-1,Tn=null==st?0:st.length;++un<Tn;)if(yt(At,st[un]))return!0;return!1}function ji(st,At){for(var yt=-1,un=null==st?0:st.length,Tn=Array(un);++yt<un;)Tn[yt]=At(st[yt],yt,st);return Tn}function Br(st,At){for(var yt=-1,un=At.length,Tn=st.length;++yt<un;)st[Tn+yt]=At[yt];return st}function du(st,At,yt,un){var Tn=-1,Oi=null==st?0:st.length;for(un&&Oi&&(yt=st[++Tn]);++Tn<Oi;)yt=At(yt,st[Tn],Tn,st);return yt}function fd(st,At,yt,un){var Tn=null==st?0:st.length;for(un&&Tn&&(yt=st[--Tn]);Tn--;)yt=At(yt,st[Tn],Tn,st);return yt}function To(st,At){for(var yt=-1,un=null==st?0:st.length;++yt<un;)if(At(st[yt],yt,st))return!0;return!1}var ir=Im("length");function vh(st,At,yt){var un;return yt(st,function(Tn,Oi,Kr){if(At(Tn,Oi,Kr))return un=Oi,!1}),un}function pd(st,At,yt,un){for(var Tn=st.length,Oi=yt+(un?1:-1);un?Oi--:++Oi<Tn;)if(At(st[Oi],Oi,st))return Oi;return-1}function qa(st,At,yt){return At==At?function(st,At,yt){for(var un=yt-1,Tn=st.length;++un<Tn;)if(st[un]===At)return un;return-1}(st,At,yt):pd(st,yc,yt)}function Kf(st,At,yt,un){for(var Tn=yt-1,Oi=st.length;++Tn<Oi;)if(un(st[Tn],At))return Tn;return-1}function yc(st){return st!=st}function ws(st,At){var yt=null==st?0:st.length;return yt?gd(st,At)/yt:NaN}function Im(st){return function(At){return null==At?J:At[st]}}function zo(st){return function(At){return null==st?J:st[At]}}function Ho(st,At,yt,un,Tn){return Tn(st,function(Oi,Kr,zi){yt=un?(un=!1,Oi):At(yt,Oi,Kr,zi)}),yt}function gd(st,At){for(var yt,un=-1,Tn=st.length;++un<Tn;){var Oi=At(st[un]);Oi!==J&&(yt=yt===J?Oi:yt+Oi)}return yt}function md(st,At){for(var yt=-1,un=Array(st);++yt<st;)un[yt]=At(yt);return un}function Eb(st){return st&&st.slice(0,vc(st)+1).replace(Ze,"")}function Go(st){return function(At){return st(At)}}function Rm(st,At){return ji(At,function(yt){return st[yt]})}function bh(st,At){return st.has(At)}function Fx(st,At){for(var yt=-1,un=st.length;++yt<un&&qa(At,st[yt],0)>-1;);return yt}function Lx(st,At){for(var yt=st.length;yt--&&qa(At,st[yt],0)>-1;);return yt}function FN(st,At){for(var yt=st.length,un=0;yt--;)st[yt]===At&&++un;return un}var LN=zo({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),kN=zo({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function BN(st){return"\\"+ln[st]}function wh(st){return Ix.test(st)}function Sb(st){var At=-1,yt=Array(st.size);return st.forEach(function(un,Tn){yt[++At]=[Tn,un]}),yt}function kx(st,At){return function(yt){return st(At(yt))}}function hu(st,At){for(var yt=-1,un=st.length,Tn=0,Oi=[];++yt<un;){var Kr=st[yt];(Kr===At||Kr===k)&&(st[yt]=k,Oi[Tn++]=yt)}return Oi}function Pm(st){var At=-1,yt=Array(st.size);return st.forEach(function(un){yt[++At]=un}),yt}function Eh(st){return wh(st)?function(st){for(var At=mh.lastIndex=0;mh.test(st);)++At;return At}(st):ir(st)}function Ya(st){return wh(st)?function(st){return st.match(mh)||[]}(st):function(st){return st.split("")}(st)}function vc(st){for(var At=st.length;At--&&wt.test(st.charAt(At)););return At}var Fm=zo({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Sh=function st(At){var d,yt=(At=null==At?Ni:Sh.defaults(Ni.Object(),At,Sh.pick(Ni,_h))).Array,un=At.Date,Tn=At.Error,Oi=At.Function,Kr=At.Math,zi=At.Object,Lm=At.RegExp,km=At.String,ba=At.TypeError,ar=yt.prototype,fu=zi.prototype,Xf=At["__core-js_shared__"],yr=Oi.prototype.toString,Hi=fu.hasOwnProperty,GN=0,Ch=(d=/[^.]+$/.exec(Xf&&Xf.keys&&Xf.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",Xs=fu.toString,jx=yr.call(zi),Bm=Ni._,_d=Lm("^"+yr.call(Hi).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vs=xo?At.Buffer:J,Ol=At.Symbol,yd=At.Uint8Array,Tb=Vs?Vs.allocUnsafe:J,wa=kx(zi.getPrototypeOf,zi),Vm=zi.create,Qf=fu.propertyIsEnumerable,Fn=ar.splice,Ux=Ol?Ol.isConcatSpreadable:J,xh=Ol?Ol.iterator:J,pu=Ol?Ol.toStringTag:J,Zf=function(){try{var d=Dc(zi,"defineProperty");return d({},"",{}),d}catch(f){}}(),Ab=At.clearTimeout!==Ni.clearTimeout&&At.clearTimeout,zx=un&&un.now!==Ni.Date.now&&un.now,Hx=At.setTimeout!==Ni.setTimeout&&At.setTimeout,Bt=Kr.ceil,pi=Kr.floor,Mr=zi.getOwnPropertySymbols,is=Vs?Vs.isBuffer:J,jm=At.isFinite,Th=ar.join,Ka=kx(zi.keys,zi),Vr=Kr.max,hs=Kr.min,$N=un.now,Gx=At.parseInt,Ah=Kr.random,Jf=ar.reverse,Es=Dc(At,"DataView"),ho=Dc(At,"Map"),ep=Dc(At,"Promise"),Ea=Dc(At,"Set"),Ao=Dc(At,"WeakMap"),Mh=Dc(zi,"create"),Dh=Ao&&new Ao,vd={},$x=Tu(Es),Um=Tu(ho),zm=Tu(ep),Mb=Tu(Ea),Hm=Tu(Ao),tp=Ol?Ol.prototype:J,bd=tp?tp.valueOf:J,Ih=tp?tp.toString:J;function Ee(d){if(wr(d)&&!Dn(d)&&!(d instanceof ai)){if(d instanceof Mo)return d;if(Hi.call(d,"__wrapped__"))return xp(d)}return new Mo(d)}var gu=function(){function d(){}return function(f){if(!br(f))return{};if(Vm)return Vm(f);d.prototype=f;var _=new d;return d.prototype=J,_}}();function Oh(){}function Mo(d,f){this.__wrapped__=d,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=J}function ai(d){this.__wrapped__=d,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function fo(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function Rl(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function Xa(d){var f=-1,_=null==d?0:d.length;for(this.clear();++f<_;){var F=d[f];this.set(F[0],F[1])}}function Sa(d){var f=-1,_=null==d?0:d.length;for(this.__data__=new Xa;++f<_;)this.add(d[f])}function Ca(d){var f=this.__data__=new Rl(d);this.size=f.size}function Ph(d,f){var _=Dn(d),F=!_&&sl(d),ae=!_&&!F&&ol(d),Ce=!_&&!F&&!ae&&Yh(d),ze=_||F||ae||Ce,qe=ze?md(d.length,km):[],at=qe.length;for(var Rt in d)(f||Hi.call(d,Rt))&&(!ze||!("length"==Rt||ae&&("offset"==Rt||"parent"==Rt)||Ce&&("buffer"==Rt||"byteLength"==Rt||"byteOffset"==Rt)||Oo(Rt,at)))&&qe.push(Rt);return qe}function qm(d){var f=d.length;return f?d[Pl(0,f-1)]:J}function Ib(d,f){return Fd(Zs(d),mu(f,0,d.length))}function wd(d){return Fd(Zs(d))}function Ym(d,f,_){(_!==J&&!An(d[f],_)||_===J&&!(f in d))&&Za(d,f,_)}function Qa(d,f,_){var F=d[f];(!Hi.call(d,f)||!An(F,_)||_===J&&!(f in d))&&Za(d,f,_)}function Ed(d,f){for(var _=d.length;_--;)if(An(d[_][0],f))return _;return-1}function op(d,f,_,F){return Ec(d,function(ae,Ce,ze){f(F,ae,_(ae),ze)}),F}function r1(d,f){return d&&Ta(f,As(f),d)}function Za(d,f,_){"__proto__"==f&&Zf?Zf(d,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):d[f]=_}function Km(d,f){for(var _=-1,F=f.length,ae=yt(F),Ce=null==d;++_<F;)ae[_]=Ce?J:Qh(d,f[_]);return ae}function mu(d,f,_){return d==d&&(_!==J&&(d=d<=_?d:_),f!==J&&(d=d>=f?d:f)),d}function js(d,f,_,F,ae,Ce){var ze,qe=1&f,at=2&f,Rt=4&f;if(_&&(ze=ae?_(d,F,ae,Ce):_(d)),ze!==J)return ze;if(!br(d))return d;var Pt=Dn(d);if(Pt){if(ze=function(d){var f=d.length,_=new d.constructor(f);return f&&"string"==typeof d[0]&&Hi.call(d,"index")&&(_.index=d.index,_.input=d.input),_}(d),!qe)return Zs(d,ze)}else{var jt=zs(d),tn=jt==je||jt==We;if(ol(d))return pp(d,qe);if(jt==fe||jt==Xe||tn&&!ae){if(ze=at||tn?{}:Jb(d),!qe)return at?function(d,f){return Ta(d,Xb(d),f)}(d,function(d,f){return d&&Ta(f,eo(f),d)}(ze,d)):function(d,f){return Ta(d,d_(d),f)}(d,r1(ze,d))}else{if(!nr[jt])return ae?d:{};ze=function(d,f,_){var F=d.constructor;switch(f){case Qe:return Eu(d);case Ue:case Le:return new F(+d);case vt:return function(d,f){var _=f?Eu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.byteLength)}(d,_);case It:case Mn:case Rn:case Hn:case bi:case fi:case Gr:case Ns:case ds:return o_(d,_);case Pe:return new F;case $:case be:return new F(d);case gt:return function(d){var f=new d.constructor(d.source,Gn.exec(d));return f.lastIndex=d.lastIndex,f}(d);case ft:return new F;case B:return function(d){return bd?zi(bd.call(d)):{}}(d)}}(d,jt,qe)}}Ce||(Ce=new Ca);var bn=Ce.get(d);if(bn)return bn;Ce.set(d,ze),CT(d)?d.forEach(function(Ln){ze.add(js(Ln,f,_,Ln,d,Ce))}):bT(d)&&d.forEach(function(Ln,ui){ze.set(ui,js(Ln,f,_,ui,d,Ce))});var ci=Pt?J:(Rt?at?c_:kl:at?eo:As)(d);return Bs(ci||d,function(Ln,ui){ci&&(Ln=d[ui=Ln]),Qa(ze,ui,js(Ln,f,_,ui,d,Ce))}),ze}function ap(d,f,_){var F=_.length;if(null==d)return!F;for(d=zi(d);F--;){var ae=_[F],ze=d[ae];if(ze===J&&!(ae in d)||!(0,f[ae])(ze))return!1}return!0}function Nh(d,f,_){if("function"!=typeof d)throw new ba(Ae);return Uh(function(){d.apply(J,_)},f)}function wc(d,f,_,F){var ae=-1,Ce=Il,ze=!0,qe=d.length,at=[],Rt=f.length;if(!qe)return at;_&&(f=ji(f,Go(_))),F?(Ce=yh,ze=!1):f.length>=200&&(Ce=bh,ze=!1,f=new Sa(f));e:for(;++ae<qe;){var Pt=d[ae],jt=null==_?Pt:_(Pt);if(Pt=F||0!==Pt?Pt:0,ze&&jt==jt){for(var tn=Rt;tn--;)if(f[tn]===jt)continue e;at.push(Pt)}else Ce(f,jt,F)||at.push(Pt)}return at}Ee.templateSettings={escape:Wa,evaluate:it,interpolate:ot,variable:"",imports:{_:Ee}},(Ee.prototype=Oh.prototype).constructor=Ee,(Mo.prototype=gu(Oh.prototype)).constructor=Mo,(ai.prototype=gu(Oh.prototype)).constructor=ai,fo.prototype.clear=function(){this.__data__=Mh?Mh(null):{},this.size=0},fo.prototype.delete=function(d){var f=this.has(d)&&delete this.__data__[d];return this.size-=f?1:0,f},fo.prototype.get=function(d){var f=this.__data__;if(Mh){var _=f[d];return _===Y?J:_}return Hi.call(f,d)?f[d]:J},fo.prototype.has=function(d){var f=this.__data__;return Mh?f[d]!==J:Hi.call(f,d)},fo.prototype.set=function(d,f){var _=this.__data__;return this.size+=this.has(d)?0:1,_[d]=Mh&&f===J?Y:f,this},Rl.prototype.clear=function(){this.__data__=[],this.size=0},Rl.prototype.delete=function(d){var f=this.__data__,_=Ed(f,d);return!(_<0||(_==f.length-1?f.pop():Fn.call(f,_,1),--this.size,0))},Rl.prototype.get=function(d){var f=this.__data__,_=Ed(f,d);return _<0?J:f[_][1]},Rl.prototype.has=function(d){return Ed(this.__data__,d)>-1},Rl.prototype.set=function(d,f){var _=this.__data__,F=Ed(_,d);return F<0?(++this.size,_.push([d,f])):_[F][1]=f,this},Xa.prototype.clear=function(){this.size=0,this.__data__={hash:new fo,map:new(ho||Rl),string:new fo}},Xa.prototype.delete=function(d){var f=Us(this,d).delete(d);return this.size-=f?1:0,f},Xa.prototype.get=function(d){return Us(this,d).get(d)},Xa.prototype.has=function(d){return Us(this,d).has(d)},Xa.prototype.set=function(d,f){var _=Us(this,d),F=_.size;return _.set(d,f),this.size+=_.size==F?0:1,this},Sa.prototype.add=Sa.prototype.push=function(d){return this.__data__.set(d,Y),this},Sa.prototype.has=function(d){return this.__data__.has(d)},Ca.prototype.clear=function(){this.__data__=new Rl,this.size=0},Ca.prototype.delete=function(d){var f=this.__data__,_=f.delete(d);return this.size=f.size,_},Ca.prototype.get=function(d){return this.__data__.get(d)},Ca.prototype.has=function(d){return this.__data__.has(d)},Ca.prototype.set=function(d,f){var _=this.__data__;if(_ instanceof Rl){var F=_.__data__;if(!ho||F.length<199)return F.push([d,f]),this.size=++_.size,this;_=this.__data__=new Xa(F)}return _.set(d,f),this.size=_.size,this};var Ec=tl(Ja),Qm=tl(lp,!0);function Rb(d,f){var _=!0;return Ec(d,function(F,ae,Ce){return _=!!f(F,ae,Ce)}),_}function Fh(d,f,_){for(var F=-1,ae=d.length;++F<ae;){var Ce=d[F],ze=f(Ce);if(null!=ze&&(qe===J?ze==ze&&!ta(ze):_(ze,qe)))var qe=ze,at=Ce}return at}function Nb(d,f){var _=[];return Ec(d,function(F,ae,Ce){f(F,ae,Ce)&&_.push(F)}),_}function Ss(d,f,_,F,ae){var Ce=-1,ze=d.length;for(_||(_=E1),ae||(ae=[]);++Ce<ze;){var qe=d[Ce];f>0&&_(qe)?f>1?Ss(qe,f-1,_,F,ae):Br(ae,qe):F||(ae[ae.length]=qe)}return ae}var Sd=Ub(),Cd=Ub(!0);function Ja(d,f){return d&&Sd(d,f,As)}function lp(d,f){return d&&Cd(d,f,As)}function Lh(d,f){return ya(f,function(_){return ea(d[_])})}function $o(d,f){for(var _=0,F=(f=Tc(f,d)).length;null!=d&&_<F;)d=d[ei(f[_++])];return _&&_==F?d:J}function Gi(d,f,_){var F=f(d);return Dn(d)?F:Br(F,_(d))}function Cs(d){return null==d?d===J?"[object Undefined]":"[object Null]":pu&&pu in zi(d)?function(d){var f=Hi.call(d,pu),_=d[pu];try{d[pu]=J;var F=!0}catch(Ce){}var ae=Xs.call(d);return F&&(f?d[pu]=_:delete d[pu]),ae}(d):function(d){return Xs.call(d)}(d)}function Wo(d,f){return d>f}function xd(d,f){return null!=d&&Hi.call(d,f)}function Td(d,f){return null!=d&&f in zi(d)}function _u(d,f,_){for(var F=_?yh:Il,ae=d[0].length,Ce=d.length,ze=Ce,qe=yt(Ce),at=1/0,Rt=[];ze--;){var Pt=d[ze];ze&&f&&(Pt=ji(Pt,Go(f))),at=hs(Pt.length,at),qe[ze]=!_&&(f||ae>=120&&Pt.length>=120)?new Sa(ze&&Pt):J}Pt=d[0];var jt=-1,tn=qe[0];e:for(;++jt<ae&&Rt.length<at;){var bn=Pt[jt],Nn=f?f(bn):bn;if(bn=_||0!==bn?bn:0,!(tn?bh(tn,Nn):F(Rt,Nn,_))){for(ze=Ce;--ze;){var ci=qe[ze];if(!(ci?bh(ci,Nn):F(d[ze],Nn,_)))continue e}tn&&tn.push(Nn),Rt.push(bn)}}return Rt}function xa(d,f,_){var F=null==(d=g_(d,f=Tc(f,d)))?d:d[ei(Qo(f))];return null==F?J:ns(F,d,_)}function s1(d){return wr(d)&&Cs(d)==Xe}function cp(d,f,_,F,ae){return d===f||(null==d||null==f||!wr(d)&&!wr(f)?d!=d&&f!=f:function(d,f,_,F,ae,Ce){var ze=Dn(d),qe=Dn(f),at=ze?Je:zs(d),Rt=qe?Je:zs(f),Pt=(at=at==Xe?fe:at)==fe,jt=(Rt=Rt==Xe?fe:Rt)==fe,tn=at==Rt;if(tn&&ol(d)){if(!ol(f))return!1;ze=!0,Pt=!1}if(tn&&!Pt)return Ce||(Ce=new Ca),ze||Yh(d)?bp(d,f,_,F,ae,Ce):function(d,f,_,F,ae,Ce,ze){switch(_){case vt:if(d.byteLength!=f.byteLength||d.byteOffset!=f.byteOffset)return!1;d=d.buffer,f=f.buffer;case Qe:return!(d.byteLength!=f.byteLength||!Ce(new yd(d),new yd(f)));case Ue:case Le:case $:return An(+d,+f);case xe:return d.name==f.name&&d.message==f.message;case gt:case be:return d==f+"";case Pe:var qe=Sb;case ft:if(qe||(qe=Pm),d.size!=f.size&&!(1&F))return!1;var Rt=ze.get(d);if(Rt)return Rt==f;F|=2,ze.set(d,f);var Pt=bp(qe(d),qe(f),F,ae,Ce,ze);return ze.delete(d),Pt;case B:if(bd)return bd.call(d)==bd.call(f)}return!1}(d,f,at,_,F,ae,Ce);if(!(1&_)){var bn=Pt&&Hi.call(d,"__wrapped__"),Nn=jt&&Hi.call(f,"__wrapped__");if(bn||Nn){var ci=bn?d.value():d,Ln=Nn?f.value():f;return Ce||(Ce=new Ca),ae(ci,Ln,_,F,Ce)}}return!!tn&&(Ce||(Ce=new Ca),function(d,f,_,F,ae,Ce){var ze=1&_,qe=kl(d),at=qe.length;if(at!=kl(f).length&&!ze)return!1;for(var jt=at;jt--;){var tn=qe[jt];if(!(ze?tn in f:Hi.call(f,tn)))return!1}var bn=Ce.get(d),Nn=Ce.get(f);if(bn&&Nn)return bn==f&&Nn==d;var ci=!0;Ce.set(d,f),Ce.set(f,d);for(var Ln=ze;++jt<at;){var ui=d[tn=qe[jt]],wi=f[tn];if(F)var mo=ze?F(wi,ui,tn,f,d,Ce):F(ui,wi,tn,d,f,Ce);if(!(mo===J?ui===wi||ae(ui,wi,_,F,Ce):mo)){ci=!1;break}Ln||(Ln="constructor"==tn)}if(ci&&!Ln){var Gs=d.constructor,na=f.constructor;Gs!=na&&"constructor"in d&&"constructor"in f&&!("function"==typeof Gs&&Gs instanceof Gs&&"function"==typeof na&&na instanceof na)&&(ci=!1)}return Ce.delete(d),Ce.delete(f),ci}(d,f,_,F,ae,Ce))}(d,f,_,F,cp,ae))}function Jm(d,f,_,F){var ae=_.length,Ce=ae,ze=!F;if(null==d)return!Ce;for(d=zi(d);ae--;){var qe=_[ae];if(ze&&qe[2]?qe[1]!==d[qe[0]]:!(qe[0]in d))return!1}for(;++ae<Ce;){var at=(qe=_[ae])[0],Rt=d[at],Pt=qe[1];if(ze&&qe[2]){if(Rt===J&&!(at in d))return!1}else{var jt=new Ca;if(F)var tn=F(Rt,Pt,at,d,f,jt);if(!(tn===J?cp(Pt,Rt,3,F,jt):tn))return!1}}return!0}function e_(d){return!(!br(d)||function(d){return!!Ch&&Ch in d}(d))&&(ea(d)?_d:tr).test(Tu(d))}function l1(d){return"function"==typeof d?d:null==d?to:"object"==typeof d?Dn(d)?Md(d[0],d[1]):u1(d):Du(d)}function Fb(d){if(!Sp(d))return Ka(d);var f=[];for(var _ in zi(d))Hi.call(d,_)&&"constructor"!=_&&f.push(_);return f}function Lb(d,f){return d<f}function c1(d,f){var _=-1,F=po(d)?yt(d.length):[];return Ec(d,function(ae,Ce,ze){F[++_]=f(ae,Ce,ze)}),F}function u1(d){var f=Ko(d);return 1==f.length&&f[0][2]?C1(f[0][0],f[0][1]):function(_){return _===d||Jm(_,d,f)}}function Md(d,f){return Xo(d)&&S1(f)?C1(ei(d),f):function(_){var F=Qh(_,d);return F===J&&F===f?Lp(_,d):cp(f,F,3)}}function t_(d,f,_,F,ae){d!==f&&Sd(f,function(Ce,ze){if(ae||(ae=new Ca),br(Ce))!function(d,f,_,F,ae,Ce,ze){var qe=m_(d,_),at=m_(f,_),Rt=ze.get(at);if(Rt)Ym(d,_,Rt);else{var Pt=Ce?Ce(qe,at,_+"",d,f,ze):J,jt=Pt===J;if(jt){var tn=Dn(at),bn=!tn&&ol(at),Nn=!tn&&!bn&&Yh(at);Pt=at,tn||bn||Nn?Dn(qe)?Pt=qe:vr(qe)?Pt=Zs(qe):bn?(jt=!1,Pt=pp(at,!0)):Nn?(jt=!1,Pt=o_(at,!0)):Pt=[]:Fp(at)||sl(at)?(Pt=qe,sl(qe)?Pt=W0(qe):(!br(qe)||ea(qe))&&(Pt=Jb(at))):jt=!1}jt&&(ze.set(at,Pt),ae(Pt,at,F,Ce,ze),ze.delete(at)),Ym(d,_,Pt)}}(d,f,ze,_,t_,F,ae);else{var qe=F?F(m_(d,ze),Ce,ze+"",d,f,ae):J;qe===J&&(qe=Ce),Ym(d,ze,qe)}},eo)}function yu(d,f){var _=d.length;if(_)return Oo(f+=f<0?_:0,_)?d[f]:J}function kh(d,f,_){f=f.length?ji(f,function(Ce){return Dn(Ce)?function(ze){return $o(ze,1===Ce.length?Ce[0]:Ce)}:Ce}):[to];var F=-1;return f=ji(f,Go(Pn())),function(st,At){var yt=st.length;for(st.sort(function(Ce,ze){return function(d,f,_){for(var F=-1,ae=d.criteria,Ce=f.criteria,ze=ae.length,qe=_.length;++F<ze;){var at=Ac(ae[F],Ce[F]);if(at)return F>=qe?at:at*("desc"==_[F]?-1:1)}return d.index-f.index}(Ce,ze,_)});yt--;)st[yt]=st[yt].value;return st}(c1(d,function(Ce,ze,qe){return{criteria:ji(f,function(Rt){return Rt(Ce)}),index:++F,value:Ce}}))}function kb(d,f,_){for(var F=-1,ae=f.length,Ce={};++F<ae;){var ze=f[F],qe=$o(d,ze);_(qe,ze)&&dp(Ce,Tc(ze,d),qe)}return Ce}function Yo(d,f,_,F){var ae=F?Kf:qa,Ce=-1,ze=f.length,qe=d;for(d===f&&(f=Zs(f)),_&&(qe=ji(d,Go(_)));++Ce<ze;)for(var at=0,Rt=f[Ce],Pt=_?_(Rt):Rt;(at=ae(qe,Pt,at,F))>-1;)qe!==d&&Fn.call(qe,at,1),Fn.call(d,at,1);return d}function Bh(d,f){for(var _=d?f.length:0,F=_-1;_--;){var ae=f[_];if(_==F||ae!==Ce){var Ce=ae;Oo(ae)?Fn.call(d,ae,1):vu(d,ae)}}return d}function Pl(d,f){return d+pi(Ah()*(f-d+1))}function up(d,f){var _="";if(!d||f<1||f>Se)return _;do{f%2&&(_+=d),(f=pi(f/2))&&(d+=d)}while(f);return _}function li(d,f){return Cp(x1(d,f,to),d+"")}function d1(d){return qm(Gd(d))}function eF(d,f){var _=Gd(d);return Fd(_,mu(f,0,_.length))}function dp(d,f,_,F){if(!br(d))return d;for(var ae=-1,Ce=(f=Tc(f,d)).length,ze=Ce-1,qe=d;null!=qe&&++ae<Ce;){var at=ei(f[ae]),Rt=_;if("__proto__"===at||"constructor"===at||"prototype"===at)return d;if(ae!=ze){var Pt=qe[at];(Rt=F?F(Pt,at,qe):J)===J&&(Rt=br(Pt)?Pt:Oo(f[ae+1])?[]:{})}Qa(qe,at,Rt),qe=qe[at]}return d}var n_=Dh?function(d,f){return Dh.set(d,f),d}:to,Do=Zf?function(d,f){return Zf(d,"toString",{configurable:!0,enumerable:!1,value:iy(f),writable:!0})}:to;function i_(d){return Fd(Gd(d))}function xs(d,f,_){var F=-1,ae=d.length;f<0&&(f=-f>ae?0:ae+f),(_=_>ae?ae:_)<0&&(_+=ae),ae=f>_?0:_-f>>>0,f>>>=0;for(var Ce=yt(ae);++F<ae;)Ce[F]=d[F+f];return Ce}function tF(d,f){var _;return Ec(d,function(F,ae,Ce){return!(_=f(F,ae,Ce))}),!!_}function Vh(d,f,_){var F=0,ae=null==d?F:d.length;if("number"==typeof f&&f==f&&ae<=2147483647){for(;F<ae;){var Ce=F+ae>>>1,ze=d[Ce];null!==ze&&!ta(ze)&&(_?ze<=f:ze<f)?F=Ce+1:ae=Ce}return ae}return r_(d,f,to,_)}function r_(d,f,_,F){var ae=0,Ce=null==d?0:d.length;if(0===Ce)return 0;for(var ze=(f=_(f))!=f,qe=null===f,at=ta(f),Rt=f===J;ae<Ce;){var Pt=pi((ae+Ce)/2),jt=_(d[Pt]),tn=jt!==J,bn=null===jt,Nn=jt==jt,ci=ta(jt);if(ze)var Ln=F||Nn;else Ln=Rt?Nn&&(F||tn):qe?Nn&&tn&&(F||!bn):at?Nn&&tn&&!bn&&(F||!ci):!bn&&!ci&&(F?jt<=f:jt<f);Ln?ae=Pt+1:Ce=Pt}return hs(Ce,4294967294)}function Bb(d,f){for(var _=-1,F=d.length,ae=0,Ce=[];++_<F;){var ze=d[_],qe=f?f(ze):ze;if(!_||!An(qe,at)){var at=qe;Ce[ae++]=0===ze?0:ze}}return Ce}function Vb(d){return"number"==typeof d?d:ta(d)?NaN:+d}function Io(d){if("string"==typeof d)return d;if(Dn(d))return ji(d,Io)+"";if(ta(d))return Ih?Ih.call(d):"";var f=d+"";return"0"==f&&1/d==-ee?"-0":f}function Cc(d,f,_){var F=-1,ae=Il,Ce=d.length,ze=!0,qe=[],at=qe;if(_)ze=!1,ae=yh;else if(Ce>=200){var Rt=f?null:l_(d);if(Rt)return Pm(Rt);ze=!1,ae=bh,at=new Sa}else at=f?[]:qe;e:for(;++F<Ce;){var Pt=d[F],jt=f?f(Pt):Pt;if(Pt=_||0!==Pt?Pt:0,ze&&jt==jt){for(var tn=at.length;tn--;)if(at[tn]===jt)continue e;f&&at.push(jt),qe.push(Pt)}else ae(at,jt,_)||(at!==qe&&at.push(jt),qe.push(Pt))}return qe}function vu(d,f){return null==(d=g_(d,f=Tc(f,d)))||delete d[ei(Qo(f))]}function hp(d,f,_,F){return dp(d,f,_($o(d,f)),F)}function bu(d,f,_,F){for(var ae=d.length,Ce=F?ae:-1;(F?Ce--:++Ce<ae)&&f(d[Ce],Ce,d););return _?xs(d,F?0:Ce,F?Ce+1:ae):xs(d,F?Ce+1:0,F?ae:Ce)}function h1(d,f){var _=d;return _ instanceof ai&&(_=_.value()),du(f,function(F,ae){return ae.func.apply(ae.thisArg,Br([F],ae.args))},_)}function wu(d,f,_){var F=d.length;if(F<2)return F?Cc(d[0]):[];for(var ae=-1,Ce=yt(F);++ae<F;)for(var ze=d[ae],qe=-1;++qe<F;)qe!=ae&&(Ce[ae]=wc(Ce[ae]||ze,d[qe],f,_));return Cc(Ss(Ce,1),f,_)}function fp(d,f,_){for(var F=-1,ae=d.length,Ce=f.length,ze={};++F<ae;)_(ze,d[F],F<Ce?f[F]:J);return ze}function xc(d){return vr(d)?d:[]}function s_(d){return"function"==typeof d?d:to}function Tc(d,f){return Dn(d)?d:Xo(d,f)?[d]:r0(Fi(d))}var f1=li;function el(d,f,_){var F=d.length;return _=_===J?F:_,!f&&_>=F?d:xs(d,f,_)}var p1=Ab||function(d){return Ni.clearTimeout(d)};function pp(d,f){if(f)return d.slice();var _=d.length,F=Tb?Tb(_):new d.constructor(_);return d.copy(F),F}function Eu(d){var f=new d.constructor(d.byteLength);return new yd(f).set(new yd(d)),f}function o_(d,f){var _=f?Eu(d.buffer):d.buffer;return new d.constructor(_,d.byteOffset,d.length)}function Ac(d,f){if(d!==f){var _=d!==J,F=null===d,ae=d==d,Ce=ta(d),ze=f!==J,qe=null===f,at=f==f,Rt=ta(f);if(!qe&&!Rt&&!Ce&&d>f||Ce&&ze&&at&&!qe&&!Rt||F&&ze&&at||!_&&at||!ae)return 1;if(!F&&!Ce&&!Rt&&d<f||Rt&&_&&ae&&!F&&!Ce||qe&&_&&ae||!ze&&ae||!at)return-1}return 0}function Id(d,f,_,F){for(var ae=-1,Ce=d.length,ze=_.length,qe=-1,at=f.length,Rt=Vr(Ce-ze,0),Pt=yt(at+Rt),jt=!F;++qe<at;)Pt[qe]=f[qe];for(;++ae<ze;)(jt||ae<Ce)&&(Pt[_[ae]]=d[ae]);for(;Rt--;)Pt[qe++]=d[ae++];return Pt}function jb(d,f,_,F){for(var ae=-1,Ce=d.length,ze=-1,qe=_.length,at=-1,Rt=f.length,Pt=Vr(Ce-qe,0),jt=yt(Pt+Rt),tn=!F;++ae<Pt;)jt[ae]=d[ae];for(var bn=ae;++at<Rt;)jt[bn+at]=f[at];for(;++ze<qe;)(tn||ae<Ce)&&(jt[bn+_[ze]]=d[ae++]);return jt}function Zs(d,f){var _=-1,F=d.length;for(f||(f=yt(F));++_<F;)f[_]=d[_];return f}function Ta(d,f,_,F){var ae=!_;_||(_={});for(var Ce=-1,ze=f.length;++Ce<ze;){var qe=f[Ce],at=F?F(_[qe],d[qe],qe,_,d):J;at===J&&(at=d[qe]),ae?Za(_,qe,at):Qa(_,qe,at)}return _}function Xr(d,f){return function(_,F){var ae=Dn(_)?kr:op,Ce=f?f():{};return ae(_,d,Pn(F,2),Ce)}}function Nl(d){return li(function(f,_){var F=-1,ae=_.length,Ce=ae>1?_[ae-1]:J,ze=ae>2?_[2]:J;for(Ce=d.length>3&&"function"==typeof Ce?(ae--,Ce):J,ze&&Hs(_[0],_[1],ze)&&(Ce=ae<3?J:Ce,ae=1),f=zi(f);++F<ae;){var qe=_[F];qe&&d(f,qe,F,Ce)}return f})}function tl(d,f){return function(_,F){if(null==_)return _;if(!po(_))return d(_,F);for(var ae=_.length,Ce=f?ae:-1,ze=zi(_);(f?Ce--:++Ce<ae)&&!1!==F(ze[Ce],Ce,ze););return _}}function Ub(d){return function(f,_,F){for(var ae=-1,Ce=zi(f),ze=F(f),qe=ze.length;qe--;){var at=ze[d?qe:++ae];if(!1===_(Ce[at],at,Ce))break}return f}}function gp(d){return function(f){var _=wh(f=Fi(f))?Ya(f):J,F=_?_[0]:f.charAt(0),ae=_?el(_,1).join(""):f.slice(1);return F[d]()+ae}}function Fl(d){return function(f){return du(ty(Y_(f).replace(Yf,"")),d,"")}}function Rd(d){return function(){var f=arguments;switch(f.length){case 0:return new d;case 1:return new d(f[0]);case 2:return new d(f[0],f[1]);case 3:return new d(f[0],f[1],f[2]);case 4:return new d(f[0],f[1],f[2],f[3]);case 5:return new d(f[0],f[1],f[2],f[3],f[4]);case 6:return new d(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new d(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=gu(d.prototype),F=d.apply(_,f);return br(F)?F:_}}function Hb(d){return function(f,_,F){var ae=zi(f);if(!po(f)){var Ce=Pn(_,3);f=As(f),_=function(qe){return Ce(ae[qe],qe,ae)}}var ze=d(f,_,F);return ze>-1?ae[Ce?f[ze]:ze]:J}}function Cu(d){return nl(function(f){var _=f.length,F=_,ae=Mo.prototype.thru;for(d&&f.reverse();F--;){var Ce=f[F];if("function"!=typeof Ce)throw new ba(Ae);if(ae&&!ze&&"wrapper"==wp(Ce))var ze=new Mo([],!0)}for(F=ze?F:_;++F<_;){var qe=wp(Ce=f[F]),at="wrapper"==qe?u_(Ce):J;ze=at&&Ep(at[0])&&424==at[1]&&!at[4].length&&1==at[9]?ze[wp(at[0])].apply(ze,at[3]):1==Ce.length&&Ep(Ce)?ze[qe]():ze.thru(Ce)}return function(){var Rt=arguments,Pt=Rt[0];if(ze&&1==Rt.length&&Dn(Pt))return ze.plant(Pt).value();for(var jt=0,tn=_?f[jt].apply(this,Rt):Pt;++jt<_;)tn=f[jt].call(this,tn);return tn}})}function Mc(d,f,_,F,ae,Ce,ze,qe,at,Rt){var Pt=f&q,jt=1&f,tn=2&f,bn=24&f,Nn=512&f,ci=tn?J:Rd(d);return function Ln(){for(var ui=arguments.length,wi=yt(ui),mo=ui;mo--;)wi[mo]=arguments[mo];if(bn)var Gs=Nd(Ln),na=FN(wi,Gs);if(F&&(wi=Id(wi,F,ae,bn)),Ce&&(wi=jb(wi,Ce,ze,bn)),ui-=na,bn&&ui<Rt){var Li=hu(wi,Gs);return Wb(d,f,Mc,Ln.placeholder,_,wi,Li,qe,at,Rt-ui)}var cl=jt?_:this,Pc=tn?cl[d]:d;return ui=wi.length,qe?wi=T1(wi,qe):Nn&&ui>1&&wi.reverse(),Pt&&at<ui&&(wi.length=at),this&&this!==Ni&&this instanceof Ln&&(Pc=ci||Rd(Pc)),Pc.apply(cl,wi)}}function Gb(d,f){return function(_,F){return function(d,f,_,F){return Ja(d,function(ae,Ce,ze){f(F,_(ae),Ce,ze)}),F}(_,d,f(F),{})}}function a_(d,f){return function(_,F){var ae;if(_===J&&F===J)return f;if(_!==J&&(ae=_),F!==J){if(ae===J)return F;"string"==typeof _||"string"==typeof F?(_=Io(_),F=Io(F)):(_=Vb(_),F=Vb(F)),ae=d(_,F)}return ae}}function mp(d){return nl(function(f){return f=ji(f,Go(Pn())),li(function(_){var F=this;return d(f,function(ae){return ns(ae,F,_)})})})}function _p(d,f){var _=(f=f===J?" ":Io(f)).length;if(_<2)return _?up(f,d):f;var F=up(f,Bt(d/Eh(f)));return wh(f)?el(Ya(F),0,d).join(""):F.slice(0,d)}function $b(d){return function(f,_,F){return F&&"number"!=typeof F&&Hs(f,_,F)&&(_=F=J),f=al(f),_===J?(_=f,f=0):_=al(_),function(d,f,_,F){for(var ae=-1,Ce=Vr(Bt((f-d)/(_||1)),0),ze=yt(Ce);Ce--;)ze[F?Ce:++ae]=d,d+=_;return ze}(f,_,F=F===J?f<_?1:-1:al(F),d)}}function yp(d){return function(f,_){return"string"==typeof f&&"string"==typeof _||(f=go(f),_=go(_)),d(f,_)}}function Wb(d,f,_,F,ae,Ce,ze,qe,at,Rt){var Pt=8&f;f|=Pt?j:64,4&(f&=~(Pt?64:j))||(f&=-4);var ci=[d,f,ae,Pt?Ce:J,Pt?ze:J,Pt?J:Ce,Pt?J:ze,qe,at,Rt],Ln=_.apply(J,ci);return Ep(d)&&n0(Ln,ci),Ln.placeholder=F,zh(Ln,d,f)}function Pd(d){var f=Kr[d];return function(_,F){if(_=go(_),(F=null==F?0:hs(Xn(F),292))&&jm(_)){var ae=(Fi(_)+"e").split("e");return+((ae=(Fi(f(ae[0]+"e"+(+ae[1]+F)))+"e").split("e"))[0]+"e"+(+ae[1]-F))}return f(_)}}var l_=Ea&&1/Pm(new Ea([,-0]))[1]==ee?function(d){return new Ea(d)}:oy;function xu(d){return function(f){var _=zs(f);return _==Pe?Sb(f):_==ft?function(st){var At=-1,yt=Array(st.size);return st.forEach(function(un){yt[++At]=[un,un]}),yt}(f):function(st,At){return ji(At,function(yt){return[yt,st[yt]]})}(f,d(f))}}function Ll(d,f,_,F,ae,Ce,ze,qe){var at=2&f;if(!at&&"function"!=typeof d)throw new ba(Ae);var Rt=F?F.length:0;if(Rt||(f&=-97,F=ae=J),ze=ze===J?ze:Vr(Xn(ze),0),qe=qe===J?qe:Xn(qe),Rt-=ae?ae.length:0,64&f){var Pt=F,jt=ae;F=ae=J}var tn=at?J:u_(d),bn=[d,f,_,F,ae,Pt,jt,Ce,ze,qe];if(tn&&function(d,f){var _=d[1],F=f[1],ae=_|F;if(!(ae<131||(F==q&&8==_||F==q&&256==_&&d[7].length<=f[8]||384==F&&f[7].length<=f[8]&&8==_)))return d;1&F&&(d[2]=f[2],ae|=1&_?0:4);var qe=f[3];if(qe){var at=d[3];d[3]=at?Id(at,qe,f[4]):qe,d[4]=at?hu(d[3],k):f[4]}(qe=f[5])&&(d[5]=(at=d[5])?jb(at,qe,f[6]):qe,d[6]=at?hu(d[5],k):f[6]),(qe=f[7])&&(d[7]=qe),F&q&&(d[8]=null==d[8]?f[8]:hs(d[8],f[8])),null==d[9]&&(d[9]=f[9]),d[0]=f[0],d[1]=ae}(bn,tn),d=bn[0],f=bn[1],_=bn[2],F=bn[3],ae=bn[4],!(qe=bn[9]=bn[9]===J?at?0:d.length:Vr(bn[9]-Rt,0))&&24&f&&(f&=-25),f&&1!=f)Nn=8==f||16==f?function(d,f,_){var F=Rd(d);return function ae(){for(var Ce=arguments.length,ze=yt(Ce),qe=Ce,at=Nd(ae);qe--;)ze[qe]=arguments[qe];var Rt=Ce<3&&ze[0]!==at&&ze[Ce-1]!==at?[]:hu(ze,at);return(Ce-=Rt.length)<_?Wb(d,f,Mc,ae.placeholder,J,ze,Rt,J,J,_-Ce):ns(this&&this!==Ni&&this instanceof ae?F:d,this,ze)}}(d,f,qe):f!=j&&33!=f||ae.length?Mc.apply(J,bn):function(d,f,_,F){var ae=1&f,Ce=Rd(d);return function ze(){for(var qe=-1,at=arguments.length,Rt=-1,Pt=F.length,jt=yt(Pt+at),tn=this&&this!==Ni&&this instanceof ze?Ce:d;++Rt<Pt;)jt[Rt]=F[Rt];for(;at--;)jt[Rt++]=arguments[++qe];return ns(tn,ae?_:this,jt)}}(d,f,_,F);else var Nn=function(d,f,_){var F=1&f,ae=Rd(d);return function Ce(){return(this&&this!==Ni&&this instanceof Ce?ae:d).apply(F?_:this,arguments)}}(d,f,_);return zh((tn?n_:n0)(Nn,bn),d,f)}function qb(d,f,_,F){return d===J||An(d,fu[_])&&!Hi.call(F,_)?f:d}function _1(d,f,_,F,ae,Ce){return br(d)&&br(f)&&(Ce.set(f,d),t_(d,f,J,_1,Ce),Ce.delete(f)),d}function vp(d){return Fp(d)?J:d}function bp(d,f,_,F,ae,Ce){var ze=1&_,qe=d.length,at=f.length;if(qe!=at&&!(ze&&at>qe))return!1;var Rt=Ce.get(d),Pt=Ce.get(f);if(Rt&&Pt)return Rt==f&&Pt==d;var jt=-1,tn=!0,bn=2&_?new Sa:J;for(Ce.set(d,f),Ce.set(f,d);++jt<qe;){var Nn=d[jt],ci=f[jt];if(F)var Ln=ze?F(ci,Nn,jt,f,d,Ce):F(Nn,ci,jt,d,f,Ce);if(Ln!==J){if(Ln)continue;tn=!1;break}if(bn){if(!To(f,function(ui,wi){if(!bh(bn,wi)&&(Nn===ui||ae(Nn,ui,_,F,Ce)))return bn.push(wi)})){tn=!1;break}}else if(Nn!==ci&&!ae(Nn,ci,_,F,Ce)){tn=!1;break}}return Ce.delete(d),Ce.delete(f),tn}function nl(d){return Cp(x1(d,J,Ts),d+"")}function kl(d){return Gi(d,As,d_)}function c_(d){return Gi(d,eo,Xb)}var u_=Dh?function(d){return Dh.get(d)}:oy;function wp(d){for(var f=d.name+"",_=vd[f],F=Hi.call(vd,f)?_.length:0;F--;){var ae=_[F],Ce=ae.func;if(null==Ce||Ce==d)return ae.name}return f}function Nd(d){return(Hi.call(Ee,"placeholder")?Ee:d).placeholder}function Pn(){var d=Ee.iteratee||Mu;return d=d===Mu?l1:d,arguments.length?d(arguments[0],arguments[1]):d}function Us(d,f){var _=d.__data__;return function(d){var f=typeof d;return"string"==f||"number"==f||"symbol"==f||"boolean"==f?"__proto__"!==d:null===d}(f)?_["string"==typeof f?"string":"hash"]:_.map}function Ko(d){for(var f=As(d),_=f.length;_--;){var F=f[_],ae=d[F];f[_]=[F,ae,S1(ae)]}return f}function Dc(d,f){var _=function(st,At){return null==st?J:st[At]}(d,f);return e_(_)?_:J}var d_=Mr?function(d){return null==d?[]:(d=zi(d),ya(Mr(d),function(f){return Qf.call(d,f)}))}:Rc,Xb=Mr?function(d){for(var f=[];d;)Br(f,d_(d)),d=wa(d);return f}:Rc,zs=Cs;function Zb(d,f,_){for(var F=-1,ae=(f=Tc(f,d)).length,Ce=!1;++F<ae;){var ze=ei(f[F]);if(!(Ce=null!=d&&_(d,ze)))break;d=d[ze]}return Ce||++F!=ae?Ce:!!(ae=null==d?0:d.length)&&V_(ae)&&Oo(ze,ae)&&(Dn(d)||sl(d))}function Jb(d){return"function"!=typeof d.constructor||Sp(d)?{}:gu(wa(d))}function E1(d){return Dn(d)||sl(d)||!!(Ux&&d&&d[Ux])}function Oo(d,f){var _=typeof d;return!!(f=null==f?Se:f)&&("number"==_||"symbol"!=_&&Vi.test(d))&&d>-1&&d%1==0&&d<f}function Hs(d,f,_){if(!br(_))return!1;var F=typeof f;return!!("number"==F?po(_)&&Oo(f,_.length):"string"==F&&f in _)&&An(_[f],d)}function Xo(d,f){if(Dn(d))return!1;var _=typeof d;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=d&&!ta(d))||ge.test(d)||!ut.test(d)||null!=f&&d in zi(f)}function Ep(d){var f=wp(d),_=Ee[f];if("function"!=typeof _||!(f in ai.prototype))return!1;if(d===_)return!0;var F=u_(_);return!!F&&d===F[0]}(Es&&zs(new Es(new ArrayBuffer(1)))!=vt||ho&&zs(new ho)!=Pe||ep&&zs(ep.resolve())!=ue||Ea&&zs(new Ea)!=ft||Ao&&zs(new Ao)!=V)&&(zs=function(d){var f=Cs(d),_=f==fe?d.constructor:J,F=_?Tu(_):"";if(F)switch(F){case $x:return vt;case Um:return Pe;case zm:return ue;case Mb:return ft;case Hm:return V}return f});var t0=Xf?ea:ly;function Sp(d){var f=d&&d.constructor;return d===("function"==typeof f&&f.prototype||fu)}function S1(d){return d==d&&!br(d)}function C1(d,f){return function(_){return null!=_&&_[d]===f&&(f!==J||d in zi(_))}}function x1(d,f,_){return f=Vr(f===J?d.length-1:f,0),function(){for(var F=arguments,ae=-1,Ce=Vr(F.length-f,0),ze=yt(Ce);++ae<Ce;)ze[ae]=F[f+ae];ae=-1;for(var qe=yt(f+1);++ae<f;)qe[ae]=F[ae];return qe[f]=_(ze),ns(d,this,qe)}}function g_(d,f){return f.length<2?d:$o(d,xs(f,0,-1))}function T1(d,f){for(var _=d.length,F=hs(f.length,_),ae=Zs(d);F--;){var Ce=f[F];d[F]=Oo(Ce,_)?ae[Ce]:J}return d}function m_(d,f){if(("constructor"!==f||"function"!=typeof d[f])&&"__proto__"!=f)return d[f]}var n0=__(n_),Uh=Hx||function(d,f){return Ni.setTimeout(d,f)},Cp=__(Do);function zh(d,f,_){var F=f+"";return Cp(d,function(d,f){var _=f.length;if(!_)return d;var F=_-1;return f[F]=(_>1?"& ":"")+f[F],f=f.join(_>2?", ":" "),d.replace(St,"{\n/* [wrapped with "+f+"] */\n")}(F,function(d,f){return Bs(rt,function(_){var F="_."+_[0];f&_[1]&&!Il(d,F)&&d.push(F)}),d.sort()}(function(d){var f=d.match(Tt);return f?f[1].split(Yt):[]}(F),_)))}function __(d){var f=0,_=0;return function(){var F=$N(),ae=16-(F-_);if(_=F,ae>0){if(++f>=800)return arguments[0]}else f=0;return d.apply(J,arguments)}}function Fd(d,f){var _=-1,F=d.length,ae=F-1;for(f=f===J?F:f;++_<f;){var Ce=Pl(_,ae),ze=d[Ce];d[Ce]=d[_],d[_]=ze}return d.length=f,d}var f,_,r0=(f=qh(function(d){var f=[];return 46===d.charCodeAt(0)&&f.push(""),d.replace(ve,function(_,F,ae,Ce){f.push(ae?Ce.replace(On,"$1"):F||_)}),f},function(F){return 500===_.size&&_.clear(),F}),_=f.cache,f);function ei(d){if("string"==typeof d||ta(d))return d;var f=d+"";return"0"==f&&1/d==-ee?"-0":f}function Tu(d){if(null!=d){try{return yr.call(d)}catch(f){}try{return d+""}catch(f){}}return""}function xp(d){if(d instanceof ai)return d.clone();var f=new Mo(d.__wrapped__,d.__chain__);return f.__actions__=Zs(d.__actions__),f.__index__=d.__index__,f.__values__=d.__values__,f}var I1=li(function(d,f){return vr(d)?wc(d,Ss(f,1,vr,!0)):[]}),O1=li(function(d,f){var _=Qo(f);return vr(_)&&(_=J),vr(d)?wc(d,Ss(f,1,vr,!0),Pn(_,2)):[]}),R1=li(function(d,f){var _=Qo(f);return vr(_)&&(_=J),vr(d)?wc(d,Ss(f,1,vr,!0),J,_):[]});function v_(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=null==_?0:Xn(_);return ae<0&&(ae=Vr(F+ae,0)),pd(d,Pn(f,3),ae)}function b_(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=F-1;return _!==J&&(ae=Xn(_),ae=_<0?Vr(F+ae,0):hs(ae,F-1)),pd(d,Pn(f,3),ae,!0)}function Ts(d){return null!=d&&d.length?Ss(d,1):[]}function o0(d){return d&&d.length?d[0]:J}var l0=li(function(d){var f=ji(d,xc);return f.length&&f[0]===d[0]?_u(f):[]}),F1=li(function(d){var f=Qo(d),_=ji(d,xc);return f===Qo(_)?f=J:_.pop(),_.length&&_[0]===d[0]?_u(_,Pn(f,2)):[]}),c0=li(function(d){var f=Qo(d),_=ji(d,xc);return(f="function"==typeof f?f:J)&&_.pop(),_.length&&_[0]===d[0]?_u(_,J,f):[]});function Qo(d){var f=null==d?0:d.length;return f?d[f-1]:J}var E_=li(S_);function S_(d,f){return d&&d.length&&f&&f.length?Yo(d,f):d}var d0=nl(function(d,f){var _=null==d?0:d.length,F=Km(d,f);return Bh(d,ji(f,function(ae){return Oo(ae,_)?+ae:ae}).sort(Ac)),F});function C_(d){return null==d?d:Jf.call(d)}var p0=li(function(d){return Cc(Ss(d,1,vr,!0))}),q1=li(function(d){var f=Qo(d);return vr(f)&&(f=J),Cc(Ss(d,1,vr,!0),Pn(f,2))}),Y1=li(function(d){var f=Qo(d);return f="function"==typeof f?f:J,Cc(Ss(d,1,vr,!0),J,f)});function g0(d){if(!d||!d.length)return[];var f=0;return d=ya(d,function(_){if(vr(_))return f=Vr(_.length,f),!0}),md(f,function(_){return ji(d,Im(_))})}function X1(d,f){if(!d||!d.length)return[];var _=g0(d);return null==f?_:ji(_,function(F){return ns(f,J,F)})}var m0=li(function(d,f){return vr(d)?wc(d,f):[]}),uF=li(function(d){return wu(ya(d,vr))}),Ro=li(function(d){var f=Qo(d);return vr(f)&&(f=J),wu(ya(d,vr),Pn(f,2))}),x_=li(function(d){var f=Qo(d);return f="function"==typeof f?f:J,wu(ya(d,vr),J,f)}),T_=li(g0),$h=li(function(d){var f=d.length,_=f>1?d[f-1]:J;return _="function"==typeof _?(d.pop(),_):J,X1(d,_)});function A_(d){var f=Ee(d);return f.__chain__=!0,f}function kd(d,f){return f(d)}var M_=nl(function(d){var f=d.length,_=f?d[0]:0,F=this.__wrapped__,ae=function(Ce){return Km(Ce,d)};return!(f>1||this.__actions__.length)&&F instanceof ai&&Oo(_)?((F=F.slice(_,+_+(f?1:0))).__actions__.push({func:kd,args:[ae],thisArg:J}),new Mo(F,this.__chain__).thru(function(Ce){return f&&!Ce.length&&Ce.push(J),Ce})):this.thru(ae)}),J1=Xr(function(d,f,_){Hi.call(d,_)?++d[_]:Za(d,_,1)}),nT=Hb(v_),iT=Hb(b_);function R_(d,f){return(Dn(d)?Bs:Ec)(d,Pn(f,3))}function Mp(d,f){return(Dn(d)?hd:Qm)(d,Pn(f,3))}var sT=Xr(function(d,f,_){Hi.call(d,_)?d[_].push(f):Za(d,_,[f])}),E0=li(function(d,f,_){var F=-1,ae="function"==typeof f,Ce=po(d)?yt(d.length):[];return Ec(d,function(ze){Ce[++F]=ae?ns(f,ze,_):xa(ze,f,_)}),Ce}),S0=Xr(function(d,f,_){Za(d,_,f)});function rl(d,f){return(Dn(d)?ji:c1)(d,Pn(f,3))}var x0=Xr(function(d,f,_){d[_?0:1].push(f)},function(){return[[],[]]}),Ip=li(function(d,f){if(null==d)return[];var _=f.length;return _>1&&Hs(d,f[0],f[1])?f=[]:_>2&&Hs(f[0],f[1],f[2])&&(f=[f[0]]),kh(d,Ss(f,1),[])}),Au=zx||function(){return Ni.Date.now()};function Op(d,f,_){return f=_?J:f,Ll(d,q,J,J,J,J,f=d&&null==f?d.length:f)}function N_(d,f){var _;if("function"!=typeof f)throw new ba(Ae);return d=Xn(d),function(){return--d>0&&(_=f.apply(this,arguments)),d<=1&&(f=J),_}}var Wh=li(function(d,f,_){var F=1;if(_.length){var ae=hu(_,Nd(Wh));F|=j}return Ll(d,F,f,_,ae)}),Vd=li(function(d,f,_){var F=3;if(_.length){var ae=hu(_,Nd(Vd));F|=j}return Ll(f,F,d,_,ae)});function R0(d,f,_){var F,ae,Ce,ze,qe,at,Rt=0,Pt=!1,jt=!1,tn=!0;if("function"!=typeof d)throw new ba(Ae);function bn(Li){var cl=F,Pc=ae;return F=ae=J,Rt=Li,ze=d.apply(Pc,cl)}function Nn(Li){return Rt=Li,qe=Uh(ui,f),Pt?bn(Li):ze}function Ln(Li){var cl=Li-at;return at===J||cl>=f||cl<0||jt&&Li-Rt>=Ce}function ui(){var Li=Au();if(Ln(Li))return wi(Li);qe=Uh(ui,function(Li){var pA=f-(Li-at);return jt?hs(pA,Ce-(Li-Rt)):pA}(Li))}function wi(Li){return qe=J,tn&&F?bn(Li):(F=ae=J,ze)}function na(){var Li=Au(),cl=Ln(Li);if(F=arguments,ae=this,at=Li,cl){if(qe===J)return Nn(at);if(jt)return p1(qe),qe=Uh(ui,f),bn(at)}return qe===J&&(qe=Uh(ui,f)),ze}return f=go(f)||0,br(_)&&(Pt=!!_.leading,Ce=(jt="maxWait"in _)?Vr(go(_.maxWait)||0,f):Ce,tn="trailing"in _?!!_.trailing:tn),na.cancel=function(){qe!==J&&p1(qe),Rt=0,F=at=ae=qe=J},na.flush=function(){return qe===J?ze:wi(Au())},na}var cT=li(function(d,f){return Nh(d,1,f)}),P0=li(function(d,f,_){return Nh(d,go(f)||0,_)});function qh(d,f){if("function"!=typeof d||null!=f&&"function"!=typeof f)throw new ba(Ae);var _=function(){var F=arguments,ae=f?f.apply(this,F):F[0],Ce=_.cache;if(Ce.has(ae))return Ce.get(ae);var ze=d.apply(this,F);return _.cache=Ce.set(ae,ze)||Ce,ze};return _.cache=new(qh.Cache||Xa),_}function k_(d){if("function"!=typeof d)throw new ba(Ae);return function(){var f=arguments;switch(f.length){case 0:return!d.call(this);case 1:return!d.call(this,f[0]);case 2:return!d.call(this,f[0],f[1]);case 3:return!d.call(this,f[0],f[1],f[2])}return!d.apply(this,f)}}qh.Cache=Xa;var uT=f1(function(d,f){var _=(f=1==f.length&&Dn(f[0])?ji(f[0],Go(Pn())):ji(Ss(f,1),Go(Pn()))).length;return li(function(F){for(var ae=-1,Ce=hs(F.length,_);++ae<Ce;)F[ae]=f[ae].call(this,F[ae]);return ns(d,this,F)})}),Rp=li(function(d,f){var _=hu(f,Nd(Rp));return Ll(d,j,J,f,_)}),F0=li(function(d,f){var _=hu(f,Nd(F0));return Ll(d,64,J,f,_)}),dT=nl(function(d,f){return Ll(d,256,J,J,J,f)});function An(d,f){return d===f||d!=d&&f!=f}var Kt=yp(Wo),B0=yp(function(d,f){return d>=f}),sl=s1(function(){return arguments}())?s1:function(d){return wr(d)&&Hi.call(d,"callee")&&!Qf.call(d,"callee")},Dn=yt.isArray,V0=rn?Go(rn):function(d){return wr(d)&&Cs(d)==Qe};function po(d){return null!=d&&V_(d.length)&&!ea(d)}function vr(d){return wr(d)&&po(d)}var ol=is||ly,j0=oi?Go(oi):function(d){return wr(d)&&Cs(d)==Le};function Ma(d){if(!wr(d))return!1;var f=Cs(d);return f==xe||"[object DOMException]"==f||"string"==typeof d.message&&"string"==typeof d.name&&!Fp(d)}function ea(d){if(!br(d))return!1;var f=Cs(d);return f==je||f==We||"[object AsyncFunction]"==f||"[object Proxy]"==f}function Np(d){return"number"==typeof d&&d==Xn(d)}function V_(d){return"number"==typeof d&&d>-1&&d%1==0&&d<=Se}function br(d){var f=typeof d;return null!=d&&("object"==f||"function"==f)}function wr(d){return null!=d&&"object"==typeof d}var bT=or?Go(or):function(d){return wr(d)&&zs(d)==Pe};function ST(d){return"number"==typeof d||wr(d)&&Cs(d)==$}function Fp(d){if(!wr(d)||Cs(d)!=fe)return!1;var f=wa(d);if(null===f)return!0;var _=Hi.call(f,"constructor")&&f.constructor;return"function"==typeof _&&_ instanceof _&&yr.call(_)==jx}var G0=uo?Go(uo):function(d){return wr(d)&&Cs(d)==gt},CT=_c?Go(_c):function(d){return wr(d)&&zs(d)==ft};function U_(d){return"string"==typeof d||!Dn(d)&&wr(d)&&Cs(d)==be}function ta(d){return"symbol"==typeof d||wr(d)&&Cs(d)==B}var Yh=ts?Go(ts):function(d){return wr(d)&&V_(d.length)&&!!yn[Cs(d)]},Ic=yp(Lb),z_=yp(function(d,f){return d<=f});function $0(d){if(!d)return[];if(po(d))return U_(d)?Ya(d):Zs(d);if(xh&&d[xh])return function(st){for(var At,yt=[];!(At=st.next()).done;)yt.push(At.value);return yt}(d[xh]());var f=zs(d);return(f==Pe?Sb:f==ft?Pm:Gd)(d)}function al(d){return d?(d=go(d))===ee||d===-ee?17976931348623157e292*(d<0?-1:1):d==d?d:0:0===d?d:0}function Xn(d){var f=al(d),_=f%1;return f==f?_?f-_:f:0}function H_(d){return d?mu(Xn(d),0,_e):0}function go(d){if("number"==typeof d)return d;if(ta(d))return NaN;if(br(d)){var f="function"==typeof d.valueOf?d.valueOf():d;d=br(f)?f+"":f}if("string"!=typeof d)return 0===d?d:+d;d=Eb(d);var _=er.test(d);return _||qn.test(d)?wb(d.slice(2),_?2:8):Sn.test(d)?NaN:+d}function W0(d){return Ta(d,eo(d))}function Fi(d){return null==d?"":Io(d)}var xT=Nl(function(d,f){if(Sp(f)||po(f))Ta(f,As(f),d);else for(var _ in f)Hi.call(f,_)&&Qa(d,_,f[_])}),TT=Nl(function(d,f){Ta(f,eo(f),d)}),jd=Nl(function(d,f,_,F){Ta(f,eo(f),d,F)}),AT=Nl(function(d,f,_,F){Ta(f,As(f),d,F)}),q0=nl(Km),DT=li(function(d,f){d=zi(d);var _=-1,F=f.length,ae=F>2?f[2]:J;for(ae&&Hs(f[0],f[1],ae)&&(F=1);++_<F;)for(var Ce=f[_],ze=eo(Ce),qe=-1,at=ze.length;++qe<at;){var Rt=ze[qe],Pt=d[Rt];(Pt===J||An(Pt,fu[Rt])&&!Hi.call(d,Rt))&&(d[Rt]=Ce[Rt])}return d}),Kh=li(function(d){return d.push(J,_1),ns(J0,J,d)});function Qh(d,f,_){var F=null==d?J:$o(d,f);return F===J?_:F}function Lp(d,f){return null!=d&&Zb(d,f,Td)}var kp=Gb(function(d,f,_){null!=f&&"function"!=typeof f.toString&&(f=Xs.call(f)),d[f]=_},iy(to)),OT=Gb(function(d,f,_){null!=f&&"function"!=typeof f.toString&&(f=Xs.call(f)),Hi.call(d,f)?d[f].push(_):d[f]=[_]},Pn),X0=li(xa);function As(d){return po(d)?Ph(d):Fb(d)}function eo(d){return po(d)?Ph(d,!0):function(d){if(!br(d))return function(d){var f=[];if(null!=d)for(var _ in zi(d))f.push(_);return f}(d);var f=Sp(d),_=[];for(var F in d)"constructor"==F&&(f||!Hi.call(d,F))||_.push(F);return _}(d)}var Z0=Nl(function(d,f,_){t_(d,f,_)}),J0=Nl(function(d,f,_,F){t_(d,f,_,F)}),PT=nl(function(d,f){var _={};if(null==d)return _;var F=!1;f=ji(f,function(Ce){return Ce=Tc(Ce,d),F||(F=Ce.length>1),Ce}),Ta(d,c_(d),_),F&&(_=js(_,7,vp));for(var ae=f.length;ae--;)vu(_,f[ae]);return _}),NT=nl(function(d,f){return null==d?{}:function(d,f){return kb(d,f,function(_,F){return Lp(d,F)})}(d,f)});function ew(d,f){if(null==d)return{};var _=ji(c_(d),function(F){return[F]});return f=Pn(f),kb(d,_,function(F,ae){return f(F,ae[0])})}var FT=xu(As),nw=xu(eo);function Gd(d){return null==d?[]:Rm(d,As(d))}var jT=Fl(function(d,f,_){return f=f.toLowerCase(),d+(_?q_(f):f)});function q_(d){return Vp(Fi(d).toLowerCase())}function Y_(d){return(d=Fi(d))&&d.replace(ga,LN).replace(Mm,"")}var zT=Fl(function(d,f,_){return d+(_?"-":"")+f.toLowerCase()}),HT=Fl(function(d,f,_){return d+(_?" ":"")+f.toLowerCase()}),wF=gp("toLowerCase"),KT=Fl(function(d,f,_){return d+(_?"_":"")+f.toLowerCase()}),Q_=Fl(function(d,f,_){return d+(_?" ":"")+Vp(f)}),lw=Fl(function(d,f,_){return d+(_?" ":"")+f.toUpperCase()}),Vp=gp("toUpperCase");function ty(d,f,_){return d=Fi(d),(f=_?J:f)===J?function(st){return Ml.test(st)}(d)?function(st){return st.match(_b)||[]}(d):function(st){return st.match(Vn)||[]}(d):d.match(f)||[]}var ny=li(function(d,f){try{return ns(d,J,f)}catch(_){return Ma(_)?_:new Tn(_)}}),cw=nl(function(d,f){return Bs(f,function(_){_=ei(_),Za(d,_,Wh(d[_],d))}),d});function iy(d){return function(){return d}}var SF=Cu(),$d=Cu(!0);function to(d){return d}function Mu(d){return l1("function"==typeof d?d:js(d,1))}var ry=li(function(d,f){return function(_){return xa(_,d,f)}}),uw=li(function(d,f){return function(_){return xa(d,_,f)}});function sy(d,f,_){var F=As(f),ae=Lh(f,F);null==_&&(!br(f)||!ae.length&&F.length)&&(_=f,f=d,d=this,ae=Lh(f,As(f)));var Ce=!(br(_)&&"chain"in _&&!_.chain),ze=ea(d);return Bs(ae,function(qe){var at=f[qe];d[qe]=at,ze&&(d.prototype[qe]=function(){var Rt=this.__chain__;if(Ce||Rt){var Pt=d(this.__wrapped__),jt=Pt.__actions__=Zs(this.__actions__);return jt.push({func:at,args:arguments,thisArg:d}),Pt.__chain__=Rt,Pt}return at.apply(d,Br([this.value()],arguments))})}),d}function oy(){}var nA=mp(ji),iA=mp(Jn),hw=mp(To);function Du(d){return Xo(d)?Im(ei(d)):function(d){return function(f){return $o(f,d)}}(d)}var rA=$b(),sA=$b(!0);function Rc(){return[]}function ly(){return!1}var jn=a_(function(d,f){return d+f},0),cy=Pd("ceil"),xF=a_(function(d,f){return d/f},1),jl=Pd("floor"),mw=a_(function(d,f){return d*f},1),_w=Pd("round"),yw=a_(function(d,f){return d-f},0);return Ee.after=function(d,f){if("function"!=typeof f)throw new ba(Ae);return d=Xn(d),function(){if(--d<1)return f.apply(this,arguments)}},Ee.ary=Op,Ee.assign=xT,Ee.assignIn=TT,Ee.assignInWith=jd,Ee.assignWith=AT,Ee.at=q0,Ee.before=N_,Ee.bind=Wh,Ee.bindAll=cw,Ee.bindKey=Vd,Ee.castArray=function(){if(!arguments.length)return[];var d=arguments[0];return Dn(d)?d:[d]},Ee.chain=A_,Ee.chunk=function(d,f,_){f=(_?Hs(d,f,_):f===J)?1:Vr(Xn(f),0);var F=null==d?0:d.length;if(!F||f<1)return[];for(var ae=0,Ce=0,ze=yt(Bt(F/f));ae<F;)ze[Ce++]=xs(d,ae,ae+=f);return ze},Ee.compact=function(d){for(var f=-1,_=null==d?0:d.length,F=0,ae=[];++f<_;){var Ce=d[f];Ce&&(ae[F++]=Ce)}return ae},Ee.concat=function(){var d=arguments.length;if(!d)return[];for(var f=yt(d-1),_=arguments[0],F=d;F--;)f[F-1]=arguments[F];return Br(Dn(_)?Zs(_):[_],Ss(f,1))},Ee.cond=function(d){var f=null==d?0:d.length,_=Pn();return d=f?ji(d,function(F){if("function"!=typeof F[1])throw new ba(Ae);return[_(F[0]),F[1]]}):[],li(function(F){for(var ae=-1;++ae<f;){var Ce=d[ae];if(ns(Ce[0],this,F))return ns(Ce[1],this,F)}})},Ee.conforms=function(d){return function(d){var f=As(d);return function(_){return ap(_,d,f)}}(js(d,1))},Ee.constant=iy,Ee.countBy=J1,Ee.create=function(d,f){var _=gu(d);return null==f?_:r1(_,f)},Ee.curry=function O0(d,f,_){var F=Ll(d,8,J,J,J,J,J,f=_?J:f);return F.placeholder=O0.placeholder,F},Ee.curryRight=function F_(d,f,_){var F=Ll(d,16,J,J,J,J,J,f=_?J:f);return F.placeholder=F_.placeholder,F},Ee.debounce=R0,Ee.defaults=DT,Ee.defaultsDeep=Kh,Ee.defer=cT,Ee.delay=P0,Ee.difference=I1,Ee.differenceBy=O1,Ee.differenceWith=R1,Ee.drop=function(d,f,_){var F=null==d?0:d.length;return F?xs(d,(f=_||f===J?1:Xn(f))<0?0:f,F):[]},Ee.dropRight=function(d,f,_){var F=null==d?0:d.length;return F?xs(d,0,(f=F-(f=_||f===J?1:Xn(f)))<0?0:f):[]},Ee.dropRightWhile=function(d,f){return d&&d.length?bu(d,Pn(f,3),!0,!0):[]},Ee.dropWhile=function(d,f){return d&&d.length?bu(d,Pn(f,3),!0):[]},Ee.fill=function(d,f,_,F){var ae=null==d?0:d.length;return ae?(_&&"number"!=typeof _&&Hs(d,f,_)&&(_=0,F=ae),function(d,f,_,F){var ae=d.length;for((_=Xn(_))<0&&(_=-_>ae?0:ae+_),(F=F===J||F>ae?ae:Xn(F))<0&&(F+=ae),F=_>F?0:H_(F);_<F;)d[_++]=f;return d}(d,f,_,F)):[]},Ee.filter=function(d,f){return(Dn(d)?ya:Nb)(d,Pn(f,3))},Ee.flatMap=function(d,f){return Ss(rl(d,f),1)},Ee.flatMapDeep=function(d,f){return Ss(rl(d,f),ee)},Ee.flatMapDepth=function(d,f,_){return _=_===J?1:Xn(_),Ss(rl(d,f),_)},Ee.flatten=Ts,Ee.flattenDeep=function(d){return null!=d&&d.length?Ss(d,ee):[]},Ee.flattenDepth=function(d,f){return null!=d&&d.length?Ss(d,f=f===J?1:Xn(f)):[]},Ee.flip=function(d){return Ll(d,512)},Ee.flow=SF,Ee.flowRight=$d,Ee.fromPairs=function(d){for(var f=-1,_=null==d?0:d.length,F={};++f<_;){var ae=d[f];F[ae[0]]=ae[1]}return F},Ee.functions=function(d){return null==d?[]:Lh(d,As(d))},Ee.functionsIn=function(d){return null==d?[]:Lh(d,eo(d))},Ee.groupBy=sT,Ee.initial=function(d){return null!=d&&d.length?xs(d,0,-1):[]},Ee.intersection=l0,Ee.intersectionBy=F1,Ee.intersectionWith=c0,Ee.invert=kp,Ee.invertBy=OT,Ee.invokeMap=E0,Ee.iteratee=Mu,Ee.keyBy=S0,Ee.keys=As,Ee.keysIn=eo,Ee.map=rl,Ee.mapKeys=function(d,f){var _={};return f=Pn(f,3),Ja(d,function(F,ae,Ce){Za(_,f(F,ae,Ce),F)}),_},Ee.mapValues=function(d,f){var _={};return f=Pn(f,3),Ja(d,function(F,ae,Ce){Za(_,ae,f(F,ae,Ce))}),_},Ee.matches=function(d){return u1(js(d,1))},Ee.matchesProperty=function(d,f){return Md(d,js(f,1))},Ee.memoize=qh,Ee.merge=Z0,Ee.mergeWith=J0,Ee.method=ry,Ee.methodOf=uw,Ee.mixin=sy,Ee.negate=k_,Ee.nthArg=function(d){return d=Xn(d),li(function(f){return yu(f,d)})},Ee.omit=PT,Ee.omitBy=function(d,f){return ew(d,k_(Pn(f)))},Ee.once=function(d){return N_(2,d)},Ee.orderBy=function(d,f,_,F){return null==d?[]:(Dn(f)||(f=null==f?[]:[f]),Dn(_=F?J:_)||(_=null==_?[]:[_]),kh(d,f,_))},Ee.over=nA,Ee.overArgs=uT,Ee.overEvery=iA,Ee.overSome=hw,Ee.partial=Rp,Ee.partialRight=F0,Ee.partition=x0,Ee.pick=NT,Ee.pickBy=ew,Ee.property=Du,Ee.propertyOf=function(d){return function(f){return null==d?J:$o(d,f)}},Ee.pull=E_,Ee.pullAll=S_,Ee.pullAllBy=function(d,f,_){return d&&d.length&&f&&f.length?Yo(d,f,Pn(_,2)):d},Ee.pullAllWith=function(d,f,_){return d&&d.length&&f&&f.length?Yo(d,f,J,_):d},Ee.pullAt=d0,Ee.range=rA,Ee.rangeRight=sA,Ee.rearg=dT,Ee.reject=function(d,f){return(Dn(d)?ya:Nb)(d,k_(Pn(f,3)))},Ee.remove=function(d,f){var _=[];if(!d||!d.length)return _;var F=-1,ae=[],Ce=d.length;for(f=Pn(f,3);++F<Ce;){var ze=d[F];f(ze,F,d)&&(_.push(ze),ae.push(F))}return Bh(d,ae),_},Ee.rest=function(d,f){if("function"!=typeof d)throw new ba(Ae);return li(d,f=f===J?f:Xn(f))},Ee.reverse=C_,Ee.sampleSize=function(d,f,_){return f=(_?Hs(d,f,_):f===J)?1:Xn(f),(Dn(d)?Ib:eF)(d,f)},Ee.set=function(d,f,_){return null==d?d:dp(d,f,_)},Ee.setWith=function(d,f,_,F){return F="function"==typeof F?F:J,null==d?d:dp(d,f,_,F)},Ee.shuffle=function(d){return(Dn(d)?wd:i_)(d)},Ee.slice=function(d,f,_){var F=null==d?0:d.length;return F?(_&&"number"!=typeof _&&Hs(d,f,_)?(f=0,_=F):(f=null==f?0:Xn(f),_=_===J?F:Xn(_)),xs(d,f,_)):[]},Ee.sortBy=Ip,Ee.sortedUniq=function(d){return d&&d.length?Bb(d):[]},Ee.sortedUniqBy=function(d,f){return d&&d.length?Bb(d,Pn(f,2)):[]},Ee.split=function(d,f,_){return _&&"number"!=typeof _&&Hs(d,f,_)&&(f=_=J),(_=_===J?_e:_>>>0)?(d=Fi(d))&&("string"==typeof f||null!=f&&!G0(f))&&!(f=Io(f))&&wh(d)?el(Ya(d),0,_):d.split(f,_):[]},Ee.spread=function(d,f){if("function"!=typeof d)throw new ba(Ae);return f=null==f?0:Vr(Xn(f),0),li(function(_){var F=_[f],ae=el(_,0,f);return F&&Br(ae,F),ns(d,this,ae)})},Ee.tail=function(d){var f=null==d?0:d.length;return f?xs(d,1,f):[]},Ee.take=function(d,f,_){return d&&d.length?xs(d,0,(f=_||f===J?1:Xn(f))<0?0:f):[]},Ee.takeRight=function(d,f,_){var F=null==d?0:d.length;return F?xs(d,(f=F-(f=_||f===J?1:Xn(f)))<0?0:f,F):[]},Ee.takeRightWhile=function(d,f){return d&&d.length?bu(d,Pn(f,3),!1,!0):[]},Ee.takeWhile=function(d,f){return d&&d.length?bu(d,Pn(f,3)):[]},Ee.tap=function(d,f){return f(d),d},Ee.throttle=function(d,f,_){var F=!0,ae=!0;if("function"!=typeof d)throw new ba(Ae);return br(_)&&(F="leading"in _?!!_.leading:F,ae="trailing"in _?!!_.trailing:ae),R0(d,f,{leading:F,maxWait:f,trailing:ae})},Ee.thru=kd,Ee.toArray=$0,Ee.toPairs=FT,Ee.toPairsIn=nw,Ee.toPath=function(d){return Dn(d)?ji(d,ei):ta(d)?[d]:Zs(r0(Fi(d)))},Ee.toPlainObject=W0,Ee.transform=function(d,f,_){var F=Dn(d),ae=F||ol(d)||Yh(d);if(f=Pn(f,4),null==_){var Ce=d&&d.constructor;_=ae?F?new Ce:[]:br(d)&&ea(Ce)?gu(wa(d)):{}}return(ae?Bs:Ja)(d,function(ze,qe,at){return f(_,ze,qe,at)}),_},Ee.unary=function(d){return Op(d,1)},Ee.union=p0,Ee.unionBy=q1,Ee.unionWith=Y1,Ee.uniq=function(d){return d&&d.length?Cc(d):[]},Ee.uniqBy=function(d,f){return d&&d.length?Cc(d,Pn(f,2)):[]},Ee.uniqWith=function(d,f){return f="function"==typeof f?f:J,d&&d.length?Cc(d,J,f):[]},Ee.unset=function(d,f){return null==d||vu(d,f)},Ee.unzip=g0,Ee.unzipWith=X1,Ee.update=function(d,f,_){return null==d?d:hp(d,f,s_(_))},Ee.updateWith=function(d,f,_,F){return F="function"==typeof F?F:J,null==d?d:hp(d,f,s_(_),F)},Ee.values=Gd,Ee.valuesIn=function(d){return null==d?[]:Rm(d,eo(d))},Ee.without=m0,Ee.words=ty,Ee.wrap=function(d,f){return Rp(s_(f),d)},Ee.xor=uF,Ee.xorBy=Ro,Ee.xorWith=x_,Ee.zip=T_,Ee.zipObject=function(d,f){return fp(d||[],f||[],Qa)},Ee.zipObjectDeep=function(d,f){return fp(d||[],f||[],dp)},Ee.zipWith=$h,Ee.entries=FT,Ee.entriesIn=nw,Ee.extend=TT,Ee.extendWith=jd,sy(Ee,Ee),Ee.add=jn,Ee.attempt=ny,Ee.camelCase=jT,Ee.capitalize=q_,Ee.ceil=cy,Ee.clamp=function(d,f,_){return _===J&&(_=f,f=J),_!==J&&(_=(_=go(_))==_?_:0),f!==J&&(f=(f=go(f))==f?f:0),mu(go(d),f,_)},Ee.clone=function(d){return js(d,4)},Ee.cloneDeep=function(d){return js(d,5)},Ee.cloneDeepWith=function(d,f){return js(d,5,f="function"==typeof f?f:J)},Ee.cloneWith=function(d,f){return js(d,4,f="function"==typeof f?f:J)},Ee.conformsTo=function(d,f){return null==f||ap(d,f,As(f))},Ee.deburr=Y_,Ee.defaultTo=function(d,f){return null==d||d!=d?f:d},Ee.divide=xF,Ee.endsWith=function(d,f,_){d=Fi(d),f=Io(f);var F=d.length,ae=_=_===J?F:mu(Xn(_),0,F);return(_-=f.length)>=0&&d.slice(_,ae)==f},Ee.eq=An,Ee.escape=function(d){return(d=Fi(d))&&Jt.test(d)?d.replace(pa,kN):d},Ee.escapeRegExp=function(d){return(d=Fi(d))&&lt.test(d)?d.replace(ke,"\\$&"):d},Ee.every=function(d,f,_){var F=Dn(d)?Jn:Rb;return _&&Hs(d,f,_)&&(f=J),F(d,Pn(f,3))},Ee.find=nT,Ee.findIndex=v_,Ee.findKey=function(d,f){return vh(d,Pn(f,3),Ja)},Ee.findLast=iT,Ee.findLastIndex=b_,Ee.findLastKey=function(d,f){return vh(d,Pn(f,3),lp)},Ee.floor=jl,Ee.forEach=R_,Ee.forEachRight=Mp,Ee.forIn=function(d,f){return null==d?d:Sd(d,Pn(f,3),eo)},Ee.forInRight=function(d,f){return null==d?d:Cd(d,Pn(f,3),eo)},Ee.forOwn=function(d,f){return d&&Ja(d,Pn(f,3))},Ee.forOwnRight=function(d,f){return d&&lp(d,Pn(f,3))},Ee.get=Qh,Ee.gt=Kt,Ee.gte=B0,Ee.has=function(d,f){return null!=d&&Zb(d,f,xd)},Ee.hasIn=Lp,Ee.head=o0,Ee.identity=to,Ee.includes=function(d,f,_,F){d=po(d)?d:Gd(d),_=_&&!F?Xn(_):0;var ae=d.length;return _<0&&(_=Vr(ae+_,0)),U_(d)?_<=ae&&d.indexOf(f,_)>-1:!!ae&&qa(d,f,_)>-1},Ee.indexOf=function(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=null==_?0:Xn(_);return ae<0&&(ae=Vr(F+ae,0)),qa(d,f,ae)},Ee.inRange=function(d,f,_){return f=al(f),_===J?(_=f,f=0):_=al(_),function(d,f,_){return d>=hs(f,_)&&d<Vr(f,_)}(d=go(d),f,_)},Ee.invoke=X0,Ee.isArguments=sl,Ee.isArray=Dn,Ee.isArrayBuffer=V0,Ee.isArrayLike=po,Ee.isArrayLikeObject=vr,Ee.isBoolean=function(d){return!0===d||!1===d||wr(d)&&Cs(d)==Ue},Ee.isBuffer=ol,Ee.isDate=j0,Ee.isElement=function(d){return wr(d)&&1===d.nodeType&&!Fp(d)},Ee.isEmpty=function(d){if(null==d)return!0;if(po(d)&&(Dn(d)||"string"==typeof d||"function"==typeof d.splice||ol(d)||Yh(d)||sl(d)))return!d.length;var f=zs(d);if(f==Pe||f==ft)return!d.size;if(Sp(d))return!Fb(d).length;for(var _ in d)if(Hi.call(d,_))return!1;return!0},Ee.isEqual=function(d,f){return cp(d,f)},Ee.isEqualWith=function(d,f,_){var F=(_="function"==typeof _?_:J)?_(d,f):J;return F===J?cp(d,f,J,_):!!F},Ee.isError=Ma,Ee.isFinite=function(d){return"number"==typeof d&&jm(d)},Ee.isFunction=ea,Ee.isInteger=Np,Ee.isLength=V_,Ee.isMap=bT,Ee.isMatch=function(d,f){return d===f||Jm(d,f,Ko(f))},Ee.isMatchWith=function(d,f,_){return _="function"==typeof _?_:J,Jm(d,f,Ko(f),_)},Ee.isNaN=function(d){return ST(d)&&d!=+d},Ee.isNative=function(d){if(t0(d))throw new Tn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return e_(d)},Ee.isNil=function(d){return null==d},Ee.isNull=function(d){return null===d},Ee.isNumber=ST,Ee.isObject=br,Ee.isObjectLike=wr,Ee.isPlainObject=Fp,Ee.isRegExp=G0,Ee.isSafeInteger=function(d){return Np(d)&&d>=-Se&&d<=Se},Ee.isSet=CT,Ee.isString=U_,Ee.isSymbol=ta,Ee.isTypedArray=Yh,Ee.isUndefined=function(d){return d===J},Ee.isWeakMap=function(d){return wr(d)&&zs(d)==V},Ee.isWeakSet=function(d){return wr(d)&&"[object WeakSet]"==Cs(d)},Ee.join=function(d,f){return null==d?"":Th.call(d,f)},Ee.kebabCase=zT,Ee.last=Qo,Ee.lastIndexOf=function(d,f,_){var F=null==d?0:d.length;if(!F)return-1;var ae=F;return _!==J&&(ae=(ae=Xn(_))<0?Vr(F+ae,0):hs(ae,F-1)),f==f?function(st,At,yt){for(var un=yt+1;un--;)if(st[un]===At)return un;return un}(d,f,ae):pd(d,yc,ae,!0)},Ee.lowerCase=HT,Ee.lowerFirst=wF,Ee.lt=Ic,Ee.lte=z_,Ee.max=function(d){return d&&d.length?Fh(d,to,Wo):J},Ee.maxBy=function(d,f){return d&&d.length?Fh(d,Pn(f,2),Wo):J},Ee.mean=function(d){return ws(d,to)},Ee.meanBy=function(d,f){return ws(d,Pn(f,2))},Ee.min=function(d){return d&&d.length?Fh(d,to,Lb):J},Ee.minBy=function(d,f){return d&&d.length?Fh(d,Pn(f,2),Lb):J},Ee.stubArray=Rc,Ee.stubFalse=ly,Ee.stubObject=function(){return{}},Ee.stubString=function(){return""},Ee.stubTrue=function(){return!0},Ee.multiply=mw,Ee.nth=function(d,f){return d&&d.length?yu(d,Xn(f)):J},Ee.noConflict=function(){return Ni._===this&&(Ni._=Bm),this},Ee.noop=oy,Ee.now=Au,Ee.pad=function(d,f,_){d=Fi(d);var F=(f=Xn(f))?Eh(d):0;if(!f||F>=f)return d;var ae=(f-F)/2;return _p(pi(ae),_)+d+_p(Bt(ae),_)},Ee.padEnd=function(d,f,_){d=Fi(d);var F=(f=Xn(f))?Eh(d):0;return f&&F<f?d+_p(f-F,_):d},Ee.padStart=function(d,f,_){d=Fi(d);var F=(f=Xn(f))?Eh(d):0;return f&&F<f?_p(f-F,_)+d:d},Ee.parseInt=function(d,f,_){return _||null==f?f=0:f&&(f=+f),Gx(Fi(d).replace(Ze,""),f||0)},Ee.random=function(d,f,_){if(_&&"boolean"!=typeof _&&Hs(d,f,_)&&(f=_=J),_===J&&("boolean"==typeof f?(_=f,f=J):"boolean"==typeof d&&(_=d,d=J)),d===J&&f===J?(d=0,f=1):(d=al(d),f===J?(f=d,d=0):f=al(f)),d>f){var F=d;d=f,f=F}if(_||d%1||f%1){var ae=Ah();return hs(d+ae*(f-d+Rx("1e-"+((ae+"").length-1))),f)}return Pl(d,f)},Ee.reduce=function(d,f,_){var F=Dn(d)?du:Ho,ae=arguments.length<3;return F(d,Pn(f,4),_,ae,Ec)},Ee.reduceRight=function(d,f,_){var F=Dn(d)?fd:Ho,ae=arguments.length<3;return F(d,Pn(f,4),_,ae,Qm)},Ee.repeat=function(d,f,_){return f=(_?Hs(d,f,_):f===J)?1:Xn(f),up(Fi(d),f)},Ee.replace=function(){var d=arguments,f=Fi(d[0]);return d.length<3?f:f.replace(d[1],d[2])},Ee.result=function(d,f,_){var F=-1,ae=(f=Tc(f,d)).length;for(ae||(ae=1,d=J);++F<ae;){var Ce=null==d?J:d[ei(f[F])];Ce===J&&(F=ae,Ce=_),d=ea(Ce)?Ce.call(d):Ce}return d},Ee.round=_w,Ee.runInContext=st,Ee.sample=function(d){return(Dn(d)?qm:d1)(d)},Ee.size=function(d){if(null==d)return 0;if(po(d))return U_(d)?Eh(d):d.length;var f=zs(d);return f==Pe||f==ft?d.size:Fb(d).length},Ee.snakeCase=KT,Ee.some=function(d,f,_){var F=Dn(d)?To:tF;return _&&Hs(d,f,_)&&(f=J),F(d,Pn(f,3))},Ee.sortedIndex=function(d,f){return Vh(d,f)},Ee.sortedIndexBy=function(d,f,_){return r_(d,f,Pn(_,2))},Ee.sortedIndexOf=function(d,f){var _=null==d?0:d.length;if(_){var F=Vh(d,f);if(F<_&&An(d[F],f))return F}return-1},Ee.sortedLastIndex=function(d,f){return Vh(d,f,!0)},Ee.sortedLastIndexBy=function(d,f,_){return r_(d,f,Pn(_,2),!0)},Ee.sortedLastIndexOf=function(d,f){if(null!=d&&d.length){var F=Vh(d,f,!0)-1;if(An(d[F],f))return F}return-1},Ee.startCase=Q_,Ee.startsWith=function(d,f,_){return d=Fi(d),_=null==_?0:mu(Xn(_),0,d.length),f=Io(f),d.slice(_,_+f.length)==f},Ee.subtract=yw,Ee.sum=function(d){return d&&d.length?gd(d,to):0},Ee.sumBy=function(d,f){return d&&d.length?gd(d,Pn(f,2)):0},Ee.template=function(d,f,_){var F=Ee.templateSettings;_&&Hs(d,f,_)&&(f=J),d=Fi(d),f=jd({},f,F,qb);var qe,at,ae=jd({},f.imports,F.imports,qb),Ce=As(ae),ze=Rm(ae,Ce),Rt=0,Pt=f.interpolate||Wr,jt="__p += '",tn=Lm((f.escape||Wr).source+"|"+Pt.source+"|"+(Pt===ot?mn:Wr).source+"|"+(f.evaluate||Wr).source+"|$","g"),bn="//# sourceURL="+(Hi.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ox+"]")+"\n";d.replace(tn,function(Ln,ui,wi,mo,Gs,na){return wi||(wi=mo),jt+=d.slice(Rt,na).replace(ne,BN),ui&&(qe=!0,jt+="' +\n__e("+ui+") +\n'"),Gs&&(at=!0,jt+="';\n"+Gs+";\n__p += '"),wi&&(jt+="' +\n((__t = ("+wi+")) == null ? '' : __t) +\n'"),Rt=na+Ln.length,Ln}),jt+="';\n";var Nn=Hi.call(f,"variable")&&f.variable;if(Nn){if(ii.test(Nn))throw new Tn("Invalid `variable` option passed into `_.template`")}else jt="with (obj) {\n"+jt+"\n}\n";jt=(at?jt.replace(Fs,""):jt).replace($r,"$1").replace(fa,"$1;"),jt="function("+(Nn||"obj")+") {\n"+(Nn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(qe?", __e = _.escape":"")+(at?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+jt+"return __p\n}";var ci=ny(function(){return Oi(Ce,bn+"return "+jt).apply(J,ze)});if(ci.source=jt,Ma(ci))throw ci;return ci},Ee.times=function(d,f){if((d=Xn(d))<1||d>Se)return[];var _=_e,F=hs(d,_e);f=Pn(f),d-=_e;for(var ae=md(F,f);++_<d;)f(_);return ae},Ee.toFinite=al,Ee.toInteger=Xn,Ee.toLength=H_,Ee.toLower=function(d){return Fi(d).toLowerCase()},Ee.toNumber=go,Ee.toSafeInteger=function(d){return d?mu(Xn(d),-Se,Se):0===d?d:0},Ee.toString=Fi,Ee.toUpper=function(d){return Fi(d).toUpperCase()},Ee.trim=function(d,f,_){if((d=Fi(d))&&(_||f===J))return Eb(d);if(!d||!(f=Io(f)))return d;var F=Ya(d),ae=Ya(f);return el(F,Fx(F,ae),Lx(F,ae)+1).join("")},Ee.trimEnd=function(d,f,_){if((d=Fi(d))&&(_||f===J))return d.slice(0,vc(d)+1);if(!d||!(f=Io(f)))return d;var F=Ya(d);return el(F,0,Lx(F,Ya(f))+1).join("")},Ee.trimStart=function(d,f,_){if((d=Fi(d))&&(_||f===J))return d.replace(Ze,"");if(!d||!(f=Io(f)))return d;var F=Ya(d);return el(F,Fx(F,Ya(f))).join("")},Ee.truncate=function(d,f){var _=30,F="...";if(br(f)){var ae="separator"in f?f.separator:ae;_="length"in f?Xn(f.length):_,F="omission"in f?Io(f.omission):F}var Ce=(d=Fi(d)).length;if(wh(d)){var ze=Ya(d);Ce=ze.length}if(_>=Ce)return d;var qe=_-Eh(F);if(qe<1)return F;var at=ze?el(ze,0,qe).join(""):d.slice(0,qe);if(ae===J)return at+F;if(ze&&(qe+=at.length-qe),G0(ae)){if(d.slice(qe).search(ae)){var Rt,Pt=at;for(ae.global||(ae=Lm(ae.source,Fi(Gn.exec(ae))+"g")),ae.lastIndex=0;Rt=ae.exec(Pt);)var jt=Rt.index;at=at.slice(0,jt===J?qe:jt)}}else if(d.indexOf(Io(ae),qe)!=qe){var tn=at.lastIndexOf(ae);tn>-1&&(at=at.slice(0,tn))}return at+F},Ee.unescape=function(d){return(d=Fi(d))&&ys.test(d)?d.replace(xl,Fm):d},Ee.uniqueId=function(d){var f=++GN;return Fi(d)+f},Ee.upperCase=lw,Ee.upperFirst=Vp,Ee.each=R_,Ee.eachRight=Mp,Ee.first=o0,sy(Ee,function(){var d={};return Ja(Ee,function(f,_){Hi.call(Ee.prototype,_)||(d[_]=f)}),d}(),{chain:!1}),Ee.VERSION="4.17.21",Bs(["bind","bindKey","curry","curryRight","partial","partialRight"],function(d){Ee[d].placeholder=Ee}),Bs(["drop","take"],function(d,f){ai.prototype[d]=function(_){_=_===J?1:Vr(Xn(_),0);var F=this.__filtered__&&!f?new ai(this):this.clone();return F.__filtered__?F.__takeCount__=hs(_,F.__takeCount__):F.__views__.push({size:hs(_,_e),type:d+(F.__dir__<0?"Right":"")}),F},ai.prototype[d+"Right"]=function(_){return this.reverse()[d](_).reverse()}}),Bs(["filter","map","takeWhile"],function(d,f){var _=f+1,F=1==_||3==_;ai.prototype[d]=function(ae){var Ce=this.clone();return Ce.__iteratees__.push({iteratee:Pn(ae,3),type:_}),Ce.__filtered__=Ce.__filtered__||F,Ce}}),Bs(["head","last"],function(d,f){var _="take"+(f?"Right":"");ai.prototype[d]=function(){return this[_](1).value()[0]}}),Bs(["initial","tail"],function(d,f){var _="drop"+(f?"":"Right");ai.prototype[d]=function(){return this.__filtered__?new ai(this):this[_](1)}}),ai.prototype.compact=function(){return this.filter(to)},ai.prototype.find=function(d){return this.filter(d).head()},ai.prototype.findLast=function(d){return this.reverse().find(d)},ai.prototype.invokeMap=li(function(d,f){return"function"==typeof d?new ai(this):this.map(function(_){return xa(_,d,f)})}),ai.prototype.reject=function(d){return this.filter(k_(Pn(d)))},ai.prototype.slice=function(d,f){d=Xn(d);var _=this;return _.__filtered__&&(d>0||f<0)?new ai(_):(d<0?_=_.takeRight(-d):d&&(_=_.drop(d)),f!==J&&(_=(f=Xn(f))<0?_.dropRight(-f):_.take(f-d)),_)},ai.prototype.takeRightWhile=function(d){return this.reverse().takeWhile(d).reverse()},ai.prototype.toArray=function(){return this.take(_e)},Ja(ai.prototype,function(d,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),F=/^(?:head|last)$/.test(f),ae=Ee[F?"take"+("last"==f?"Right":""):f],Ce=F||/^find/.test(f);!ae||(Ee.prototype[f]=function(){var ze=this.__wrapped__,qe=F?[1]:arguments,at=ze instanceof ai,Rt=qe[0],Pt=at||Dn(ze),jt=function(ui){var wi=ae.apply(Ee,Br([ui],qe));return F&&tn?wi[0]:wi};Pt&&_&&"function"==typeof Rt&&1!=Rt.length&&(at=Pt=!1);var tn=this.__chain__,bn=!!this.__actions__.length,Nn=Ce&&!tn,ci=at&&!bn;if(!Ce&&Pt){ze=ci?ze:new ai(this);var Ln=d.apply(ze,qe);return Ln.__actions__.push({func:kd,args:[jt],thisArg:J}),new Mo(Ln,tn)}return Nn&&ci?d.apply(this,qe):(Ln=this.thru(jt),Nn?F?Ln.value()[0]:Ln.value():Ln)})}),Bs(["pop","push","shift","sort","splice","unshift"],function(d){var f=ar[d],_=/^(?:push|sort|unshift)$/.test(d)?"tap":"thru",F=/^(?:pop|shift)$/.test(d);Ee.prototype[d]=function(){var ae=arguments;if(F&&!this.__chain__){var Ce=this.value();return f.apply(Dn(Ce)?Ce:[],ae)}return this[_](function(ze){return f.apply(Dn(ze)?ze:[],ae)})}}),Ja(ai.prototype,function(d,f){var _=Ee[f];if(_){var F=_.name+"";Hi.call(vd,F)||(vd[F]=[]),vd[F].push({name:f,func:_})}}),vd[Mc(J,2).name]=[{name:"wrapper",func:J}],ai.prototype.clone=function(){var d=new ai(this.__wrapped__);return d.__actions__=Zs(this.__actions__),d.__dir__=this.__dir__,d.__filtered__=this.__filtered__,d.__iteratees__=Zs(this.__iteratees__),d.__takeCount__=this.__takeCount__,d.__views__=Zs(this.__views__),d},ai.prototype.reverse=function(){if(this.__filtered__){var d=new ai(this);d.__dir__=-1,d.__filtered__=!0}else(d=this.clone()).__dir__*=-1;return d},ai.prototype.value=function(){var d=this.__wrapped__.value(),f=this.__dir__,_=Dn(d),F=f<0,ae=_?d.length:0,Ce=function(d,f,_){for(var F=-1,ae=_.length;++F<ae;){var Ce=_[F],ze=Ce.size;switch(Ce.type){case"drop":d+=ze;break;case"dropRight":f-=ze;break;case"take":f=hs(f,d+ze);break;case"takeRight":d=Vr(d,f-ze)}}return{start:d,end:f}}(0,ae,this.__views__),ze=Ce.start,qe=Ce.end,at=qe-ze,Rt=F?qe:ze-1,Pt=this.__iteratees__,jt=Pt.length,tn=0,bn=hs(at,this.__takeCount__);if(!_||!F&&ae==at&&bn==at)return h1(d,this.__actions__);var Nn=[];e:for(;at--&&tn<bn;){for(var ci=-1,Ln=d[Rt+=f];++ci<jt;){var ui=Pt[ci],mo=ui.type,Gs=(0,ui.iteratee)(Ln);if(2==mo)Ln=Gs;else if(!Gs){if(1==mo)continue e;break e}}Nn[tn++]=Ln}return Nn},Ee.prototype.at=M_,Ee.prototype.chain=function(){return A_(this)},Ee.prototype.commit=function(){return new Mo(this.value(),this.__chain__)},Ee.prototype.next=function(){this.__values__===J&&(this.__values__=$0(this.value()));var d=this.__index__>=this.__values__.length;return{done:d,value:d?J:this.__values__[this.__index__++]}},Ee.prototype.plant=function(d){for(var f,_=this;_ instanceof Oh;){var F=xp(_);F.__index__=0,F.__values__=J,f?ae.__wrapped__=F:f=F;var ae=F;_=_.__wrapped__}return ae.__wrapped__=d,f},Ee.prototype.reverse=function(){var d=this.__wrapped__;if(d instanceof ai){var f=d;return this.__actions__.length&&(f=new ai(this)),(f=f.reverse()).__actions__.push({func:kd,args:[C_],thisArg:J}),new Mo(f,this.__chain__)}return this.thru(C_)},Ee.prototype.toJSON=Ee.prototype.valueOf=Ee.prototype.value=function(){return h1(this.__wrapped__,this.__actions__)},Ee.prototype.first=Ee.prototype.head,xh&&(Ee.prototype[xh]=function(){return this}),Ee}();Ni._=Sh,(mt=function(){return Sh}.call(nt,tt,nt,Vt))!==J&&(Vt.exports=mt)}.call(this)},478:function(Vt){Vt.exports=function(){"use strict";function nt(it,ot){for(var ut=0;ut<ot.length;ut++){var ge=ot[ut];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(it,ge.key,ge)}}function J(it,ot){(null==ot||ot>it.length)&&(ot=it.length);for(var ut=0,ge=new Array(ot);ut<ot;ut++)ge[ut]=it[ut];return ge}function xt(it,ot){var ut="undefined"!=typeof Symbol&&it[Symbol.iterator]||it["@@iterator"];if(ut)return(ut=ut.call(it)).next.bind(ut);if(Array.isArray(it)||(ut=function(it,ot){if(it){if("string"==typeof it)return J(it,ot);var ut=Object.prototype.toString.call(it).slice(8,-1);if("Object"===ut&&it.constructor&&(ut=it.constructor.name),"Map"===ut||"Set"===ut)return Array.from(it);if("Arguments"===ut||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ut))return J(it,ot)}}(it))||ot&&it&&"number"==typeof it.length){ut&&(it=ut);var ge=0;return function(){return ge>=it.length?{done:!0}:{done:!1,value:it[ge++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var dt={exports:{}};function K(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}dt.exports={defaults:{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},getDefaults:K,changeDefaults:function(it){dt.exports.defaults=it}};var pe=/[&<>"']/,Y=/[&<>"']/g,U=/[<>"']|&(?!#?\w+;)/,k=/[<>"']|&(?!#?\w+;)/g,ie={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},W=function(ot){return ie[ot]};var x=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function N(it){return it.replace(x,function(ot,ut){return"colon"===(ut=ut.toLowerCase())?":":"#"===ut.charAt(0)?"x"===ut.charAt(1)?String.fromCharCode(parseInt(ut.substring(2),16)):String.fromCharCode(+ut.substring(1)):""})}var M=/(^|[^\[])\^/g;var y=/[^\w:]/g,S=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;var j={},O=/^[^:]+:\/*[^/]*$/,q=/^([^:]+:)[\s\S]*$/,ce=/^([^:]+:\/*[^/]*)[\s\S]*$/;function D(it,ot){j[" "+it]||(j[" "+it]=O.test(it)?it+"/":G(it,"/",!0));var ut=-1===(it=j[" "+it]).indexOf(":");return"//"===ot.substring(0,2)?ut?ot:it.replace(q,"$1")+ot:"/"===ot.charAt(0)?ut?ot:it.replace(ce,"$1")+ot:it+ot}function G(it,ot,ut){var ge=it.length;if(0===ge)return"";for(var ve=0;ve<ge;){var ke=it.charAt(ge-ve-1);if(ke!==ot||ut){if(ke===ot||!ut)break;ve++}else ve++}return it.substr(0,ge-ve)}var ee_escape=function(it,ot){if(ot){if(pe.test(it))return it.replace(Y,W)}else if(U.test(it))return it.replace(k,W);return it},ee_unescape=N,ee_edit=function(it,ot){it=it.source||it,ot=ot||"";var ut={replace:function(ve,ke){return ke=(ke=ke.source||ke).replace(M,"$1"),it=it.replace(ve,ke),ut},getRegex:function(){return new RegExp(it,ot)}};return ut},ee_cleanUrl=function(it,ot,ut){if(it){var ge;try{ge=decodeURIComponent(N(ut)).replace(y,"").toLowerCase()}catch(ve){return null}if(0===ge.indexOf("javascript:")||0===ge.indexOf("vbscript:")||0===ge.indexOf("data:"))return null}ot&&!S.test(ut)&&(ut=D(ot,ut));try{ut=encodeURI(ut).replace(/%25/g,"%")}catch(ve){return null}return ut},ee_noopTest={exec:function(){}},ee_merge=function(it){for(var ut,ge,ot=1;ot<arguments.length;ot++)for(ge in ut=arguments[ot])Object.prototype.hasOwnProperty.call(ut,ge)&&(it[ge]=ut[ge]);return it},ee_checkSanitizeDeprecation=function(it){it&&it.sanitize&&!it.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")},ee_repeatString=function(it,ot){if(ot<1)return"";for(var ut="";ot>1;)1&ot&&(ut+=it),ot>>=1,it+=it;return ut+it},Se=dt.exports.defaults,me=G,te=function(it,ot){var ge=it.replace(/\|/g,function(ke,lt,Ze){for(var wt=!1,St=lt;--St>=0&&"\\"===Ze[St];)wt=!wt;return wt?"|":" |"}).split(/ \|/),ve=0;if(ge.length>ot)ge.splice(ot);else for(;ge.length<ot;)ge.push("");for(;ve<ge.length;ve++)ge[ve]=ge[ve].trim().replace(/\\\|/g,"|");return ge},_e=ee_escape,Oe=function(it,ot){if(-1===it.indexOf(ot[1]))return-1;for(var ut=it.length,ge=0,ve=0;ve<ut;ve++)if("\\"===it[ve])ve++;else if(it[ve]===ot[0])ge++;else if(it[ve]===ot[1]&&--ge<0)return ve;return-1};function Ge(it,ot,ut){var ge=ot.href,ve=ot.title?_e(ot.title):null,ke=it[1].replace(/\\([\[\]])/g,"$1");return"!"!==it[0].charAt(0)?{type:"link",raw:ut,href:ge,title:ve,text:ke}:{type:"image",raw:ut,href:ge,title:ve,text:_e(ke)}}var Xe=function(){function it(ut){this.options=ut||Se}var ot=it.prototype;return ot.space=function(ge){var ve=this.rules.block.newline.exec(ge);if(ve)return ve[0].length>1?{type:"space",raw:ve[0]}:{raw:"\n"}},ot.code=function(ge){var ve=this.rules.block.code.exec(ge);if(ve){var ke=ve[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:ve[0],codeBlockStyle:"indented",text:this.options.pedantic?ke:me(ke,"\n")}}},ot.fences=function(ge){var ve=this.rules.block.fences.exec(ge);if(ve){var ke=ve[0],lt=function(it,ot){var ut=it.match(/^(\s+)(?:```)/);if(null===ut)return ot;var ge=ut[1];return ot.split("\n").map(function(ve){var ke=ve.match(/^\s+/);return null===ke?ve:ke[0].length>=ge.length?ve.slice(ge.length):ve}).join("\n")}(ke,ve[3]||"");return{type:"code",raw:ke,lang:ve[2]?ve[2].trim():ve[2],text:lt}}},ot.heading=function(ge){var ve=this.rules.block.heading.exec(ge);if(ve){var ke=ve[2].trim();if(/#$/.test(ke)){var lt=me(ke,"#");(this.options.pedantic||!lt||/ $/.test(lt))&&(ke=lt.trim())}return{type:"heading",raw:ve[0],depth:ve[1].length,text:ke}}},ot.nptable=function(ge){var ve=this.rules.block.nptable.exec(ge);if(ve){var ke={type:"table",header:te(ve[1].replace(/^ *| *\| *$/g,"")),align:ve[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ve[3]?ve[3].replace(/\n$/,"").split("\n"):[],raw:ve[0]};if(ke.header.length===ke.align.length){var Ze,lt=ke.align.length;for(Ze=0;Ze<lt;Ze++)ke.align[Ze]=/^ *-+: *$/.test(ke.align[Ze])?"right":/^ *:-+: *$/.test(ke.align[Ze])?"center":/^ *:-+ *$/.test(ke.align[Ze])?"left":null;for(lt=ke.cells.length,Ze=0;Ze<lt;Ze++)ke.cells[Ze]=te(ke.cells[Ze],ke.header.length);return ke}}},ot.hr=function(ge){var ve=this.rules.block.hr.exec(ge);if(ve)return{type:"hr",raw:ve[0]}},ot.blockquote=function(ge){var ve=this.rules.block.blockquote.exec(ge);if(ve){var ke=ve[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:ve[0],text:ke}}},ot.list=function(ge){var ve=this.rules.block.list.exec(ge);if(ve){var Yt,Vn,ii,On,mn,Gn,Sn,er,tr,ke=ve[0],lt=ve[2],Ze=lt.length>1,wt={type:"list",raw:ke,ordered:Ze,start:Ze?+lt.slice(0,-1):"",loose:!1,items:[]},St=ve[0].match(this.rules.block.item),Tt=!1,qn=St.length;ii=this.rules.block.listItemStart.exec(St[0]);for(var Vi=0;Vi<qn;Vi++){if(ke=Yt=St[Vi],this.options.pedantic||(tr=Yt.match(new RegExp("\\n\\s*\\n {0,"+(ii[0].length-1)+"}\\S")))&&(mn=Yt.length-tr.index+St.slice(Vi+1).join("\n").length,wt.raw=wt.raw.substring(0,wt.raw.length-mn),ke=Yt=Yt.substring(0,tr.index),qn=Vi+1),Vi!==qn-1){if(On=this.rules.block.listItemStart.exec(St[Vi+1]),this.options.pedantic?On[1].length>ii[1].length:On[1].length>=ii[0].length||On[1].length>3){St.splice(Vi,2,St[Vi]+(!this.options.pedantic&&On[1].length<ii[0].length&&!St[Vi].match(/\n$/)?"":"\n")+St[Vi+1]),Vi--,qn--;continue}(!this.options.pedantic||this.options.smartLists?On[2][On[2].length-1]!==lt[lt.length-1]:Ze===(1===On[2].length))&&(mn=St.slice(Vi+1).join("\n").length,wt.raw=wt.raw.substring(0,wt.raw.length-mn),Vi=qn-1),ii=On}Vn=Yt.length,~(Yt=Yt.replace(/^ *([*+-]|\d+[.)]) ?/,"")).indexOf("\n ")&&(Vn-=Yt.length,Yt=Yt.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+Vn+"}","gm"),"")),Yt=me(Yt,"\n"),Vi!==qn-1&&(ke+="\n"),Gn=Tt||/\n\n(?!\s*$)/.test(ke),Vi!==qn-1&&(Tt="\n\n"===ke.slice(-2),Gn||(Gn=Tt)),Gn&&(wt.loose=!0),this.options.gfm&&(er=void 0,(Sn=/^\[[ xX]\] /.test(Yt))&&(er=" "!==Yt[1],Yt=Yt.replace(/^\[[ xX]\] +/,""))),wt.items.push({type:"list_item",raw:ke,task:Sn,checked:er,loose:Gn,text:Yt})}return wt}},ot.html=function(ge){var ve=this.rules.block.html.exec(ge);if(ve)return{type:this.options.sanitize?"paragraph":"html",raw:ve[0],pre:!this.options.sanitizer&&("pre"===ve[1]||"script"===ve[1]||"style"===ve[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(ve[0]):_e(ve[0]):ve[0]}},ot.def=function(ge){var ve=this.rules.block.def.exec(ge);if(ve)return ve[3]&&(ve[3]=ve[3].substring(1,ve[3].length-1)),{type:"def",tag:ve[1].toLowerCase().replace(/\s+/g," "),raw:ve[0],href:ve[2],title:ve[3]}},ot.table=function(ge){var ve=this.rules.block.table.exec(ge);if(ve){var ke={type:"table",header:te(ve[1].replace(/^ *| *\| *$/g,"")),align:ve[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:ve[3]?ve[3].replace(/\n$/,"").split("\n"):[]};if(ke.header.length===ke.align.length){ke.raw=ve[0];var Ze,lt=ke.align.length;for(Ze=0;Ze<lt;Ze++)ke.align[Ze]=/^ *-+: *$/.test(ke.align[Ze])?"right":/^ *:-+: *$/.test(ke.align[Ze])?"center":/^ *:-+ *$/.test(ke.align[Ze])?"left":null;for(lt=ke.cells.length,Ze=0;Ze<lt;Ze++)ke.cells[Ze]=te(ke.cells[Ze].replace(/^ *\| *| *\| *$/g,""),ke.header.length);return ke}}},ot.lheading=function(ge){var ve=this.rules.block.lheading.exec(ge);if(ve)return{type:"heading",raw:ve[0],depth:"="===ve[2].charAt(0)?1:2,text:ve[1]}},ot.paragraph=function(ge){var ve=this.rules.block.paragraph.exec(ge);if(ve)return{type:"paragraph",raw:ve[0],text:"\n"===ve[1].charAt(ve[1].length-1)?ve[1].slice(0,-1):ve[1]}},ot.text=function(ge){var ve=this.rules.block.text.exec(ge);if(ve)return{type:"text",raw:ve[0],text:ve[0]}},ot.escape=function(ge){var ve=this.rules.inline.escape.exec(ge);if(ve)return{type:"escape",raw:ve[0],text:_e(ve[1])}},ot.tag=function(ge,ve,ke){var lt=this.rules.inline.tag.exec(ge);if(lt)return!ve&&/^<a /i.test(lt[0])?ve=!0:ve&&/^<\/a>/i.test(lt[0])&&(ve=!1),!ke&&/^<(pre|code|kbd|script)(\s|>)/i.test(lt[0])?ke=!0:ke&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(lt[0])&&(ke=!1),{type:this.options.sanitize?"text":"html",raw:lt[0],inLink:ve,inRawBlock:ke,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(lt[0]):_e(lt[0]):lt[0]}},ot.link=function(ge){var ve=this.rules.inline.link.exec(ge);if(ve){var ke=ve[2].trim();if(!this.options.pedantic&&/^</.test(ke)){if(!/>$/.test(ke))return;var lt=me(ke.slice(0,-1),"\\");if((ke.length-lt.length)%2==0)return}else{var Ze=Oe(ve[2],"()");if(Ze>-1){var St=(0===ve[0].indexOf("!")?5:4)+ve[1].length+Ze;ve[2]=ve[2].substring(0,Ze),ve[0]=ve[0].substring(0,St).trim(),ve[3]=""}}var Tt=ve[2],Yt="";if(this.options.pedantic){var Vn=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(Tt);Vn&&(Tt=Vn[1],Yt=Vn[3])}else Yt=ve[3]?ve[3].slice(1,-1):"";return Tt=Tt.trim(),/^</.test(Tt)&&(Tt=this.options.pedantic&&!/>$/.test(ke)?Tt.slice(1):Tt.slice(1,-1)),Ge(ve,{href:Tt&&Tt.replace(this.rules.inline._escapes,"$1"),title:Yt&&Yt.replace(this.rules.inline._escapes,"$1")},ve[0])}},ot.reflink=function(ge,ve){var ke;if((ke=this.rules.inline.reflink.exec(ge))||(ke=this.rules.inline.nolink.exec(ge))){var lt=(ke[2]||ke[1]).replace(/\s+/g," ");if(!(lt=ve[lt.toLowerCase()])||!lt.href){var Ze=ke[0].charAt(0);return{type:"text",raw:Ze,text:Ze}}return Ge(ke,lt,ke[0])}},ot.emStrong=function(ge,ve,ke){void 0===ke&&(ke="");var lt=this.rules.inline.emStrong.lDelim.exec(ge);if(lt&&(!lt[3]||!ke.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var Ze=lt[1]||lt[2]||"";if(!Ze||Ze&&(""===ke||this.rules.inline.punctuation.exec(ke))){var St,Tt,wt=lt[0].length-1,Yt=wt,Vn=0,ii="*"===lt[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(ii.lastIndex=0,ve=ve.slice(-1*ge.length+wt);null!=(lt=ii.exec(ve));)if(St=lt[1]||lt[2]||lt[3]||lt[4]||lt[5]||lt[6]){if(Tt=St.length,lt[3]||lt[4]){Yt+=Tt;continue}if((lt[5]||lt[6])&&wt%3&&!((wt+Tt)%3)){Vn+=Tt;continue}if(!((Yt-=Tt)>0))return Tt=Math.min(Tt,Tt+Yt+Vn),Math.min(wt,Tt)%2?{type:"em",raw:ge.slice(0,wt+lt.index+Tt+1),text:ge.slice(1,wt+lt.index+Tt)}:{type:"strong",raw:ge.slice(0,wt+lt.index+Tt+1),text:ge.slice(2,wt+lt.index+Tt-1)}}}}},ot.codespan=function(ge){var ve=this.rules.inline.code.exec(ge);if(ve){var ke=ve[2].replace(/\n/g," "),lt=/[^ ]/.test(ke),Ze=/^ /.test(ke)&&/ $/.test(ke);return lt&&Ze&&(ke=ke.substring(1,ke.length-1)),ke=_e(ke,!0),{type:"codespan",raw:ve[0],text:ke}}},ot.br=function(ge){var ve=this.rules.inline.br.exec(ge);if(ve)return{type:"br",raw:ve[0]}},ot.del=function(ge){var ve=this.rules.inline.del.exec(ge);if(ve)return{type:"del",raw:ve[0],text:ve[2]}},ot.autolink=function(ge,ve){var lt,Ze,ke=this.rules.inline.autolink.exec(ge);if(ke)return Ze="@"===ke[2]?"mailto:"+(lt=_e(this.options.mangle?ve(ke[1]):ke[1])):lt=_e(ke[1]),{type:"link",raw:ke[0],text:lt,href:Ze,tokens:[{type:"text",raw:lt,text:lt}]}},ot.url=function(ge,ve){var ke;if(ke=this.rules.inline.url.exec(ge)){var lt,Ze;if("@"===ke[2])Ze="mailto:"+(lt=_e(this.options.mangle?ve(ke[0]):ke[0]));else{var wt;do{wt=ke[0],ke[0]=this.rules.inline._backpedal.exec(ke[0])[0]}while(wt!==ke[0]);lt=_e(ke[0]),Ze="www."===ke[1]?"http://"+lt:lt}return{type:"link",raw:ke[0],text:lt,href:Ze,tokens:[{type:"text",raw:lt,text:lt}]}}},ot.inlineText=function(ge,ve,ke){var Ze,lt=this.rules.inline.text.exec(ge);if(lt)return Ze=ve?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(lt[0]):_e(lt[0]):lt[0]:_e(this.options.smartypants?ke(lt[0]):lt[0]),{type:"text",raw:lt[0],text:Ze}},it}(),Je=ee_noopTest,Ye=ee_edit,Ue=ee_merge,Le={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?! {0,3}bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:Je,table:Je,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Le.def=Ye(Le.def).replace("label",Le._label).replace("title",Le._title).getRegex(),Le.bullet=/(?:[*+-]|\d{1,9}[.)])/,Le.item=/^( *)(bull) ?[^\n]*(?:\n(?! *bull ?)[^\n]*)*/,Le.item=Ye(Le.item,"gm").replace(/bull/g,Le.bullet).getRegex(),Le.listItemStart=Ye(/^( *)(bull) */).replace("bull",Le.bullet).getRegex(),Le.list=Ye(Le.list).replace(/bull/g,Le.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Le.def.source+")").getRegex(),Le._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Le._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Le.html=Ye(Le.html,"i").replace("comment",Le._comment).replace("tag",Le._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Le.paragraph=Ye(Le._paragraph).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.blockquote=Ye(Le.blockquote).replace("paragraph",Le.paragraph).getRegex(),Le.normal=Ue({},Le),Le.gfm=Ue({},Le.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Le.gfm.nptable=Ye(Le.gfm.nptable).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.gfm.table=Ye(Le.gfm.table).replace("hr",Le.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Le._tag).getRegex(),Le.pedantic=Ue({},Le.normal,{html:Ye("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Le._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Je,paragraph:Ye(Le.normal._paragraph).replace("hr",Le.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Le.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var Ke={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Je,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Je,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};Ke.punctuation=Ye(Ke.punctuation).replace(/punctuation/g,Ke._punctuation).getRegex(),Ke.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Ke.escapedEmSt=/\\\*|\\_/g,Ke._comment=Ye(Le._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Ke.emStrong.lDelim=Ye(Ke.emStrong.lDelim).replace(/punct/g,Ke._punctuation).getRegex(),Ke.emStrong.rDelimAst=Ye(Ke.emStrong.rDelimAst,"g").replace(/punct/g,Ke._punctuation).getRegex(),Ke.emStrong.rDelimUnd=Ye(Ke.emStrong.rDelimUnd,"g").replace(/punct/g,Ke._punctuation).getRegex(),Ke._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Ke._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Ke._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Ke.autolink=Ye(Ke.autolink).replace("scheme",Ke._scheme).replace("email",Ke._email).getRegex(),Ke._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Ke.tag=Ye(Ke.tag).replace("comment",Ke._comment).replace("attribute",Ke._attribute).getRegex(),Ke._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ke._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Ke._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Ke.link=Ye(Ke.link).replace("label",Ke._label).replace("href",Ke._href).replace("title",Ke._title).getRegex(),Ke.reflink=Ye(Ke.reflink).replace("label",Ke._label).getRegex(),Ke.reflinkSearch=Ye(Ke.reflinkSearch,"g").replace("reflink",Ke.reflink).replace("nolink",Ke.nolink).getRegex(),Ke.normal=Ue({},Ke),Ke.pedantic=Ue({},Ke.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ye(/^!?\[(label)\]\((.*?)\)/).replace("label",Ke._label).getRegex(),reflink:Ye(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ke._label).getRegex()}),Ke.gfm=Ue({},Ke.normal,{escape:Ye(Ke.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Ke.gfm.url=Ye(Ke.gfm.url,"i").replace("email",Ke.gfm._extended_email).getRegex(),Ke.breaks=Ue({},Ke.gfm,{br:Ye(Ke.br).replace("{2,}","*").getRegex(),text:Ye(Ke.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var xe={block:Le,inline:Ke},je=Xe,We=dt.exports.defaults,Pe=xe.block,$=xe.inline,H=ee_repeatString;function fe(it){return it.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function ue(it){var ut,ge,ot="",ve=it.length;for(ut=0;ut<ve;ut++)ge=it.charCodeAt(ut),Math.random()>.5&&(ge="x"+ge.toString(16)),ot+="&#"+ge+";";return ot}var Ve=function(){function it(ut){this.tokens=[],this.tokens.links=Object.create(null),this.options=ut||We,this.options.tokenizer=this.options.tokenizer||new je,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var ge={block:Pe.normal,inline:$.normal};this.options.pedantic?(ge.block=Pe.pedantic,ge.inline=$.pedantic):this.options.gfm&&(ge.block=Pe.gfm,ge.inline=this.options.breaks?$.breaks:$.gfm),this.tokenizer.rules=ge}it.lex=function(ge,ve){return new it(ve).lex(ge)},it.lexInline=function(ge,ve){return new it(ve).inlineTokens(ge)};var ot=it.prototype;return ot.lex=function(ge){return ge=ge.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(ge,this.tokens,!0),this.inline(this.tokens),this.tokens},ot.blockTokens=function(ge,ve,ke){var Ze,wt,St,Tt,Yt,Vn,lt=this;for(void 0===ve&&(ve=[]),void 0===ke&&(ke=!0),this.options.pedantic&&(ge=ge.replace(/^ +$/gm,""));ge;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(On){return!!(Ze=On.call(lt,ge,ve))&&(ge=ge.substring(Ze.raw.length),ve.push(Ze),!0)}))){if(Ze=this.tokenizer.space(ge)){ge=ge.substring(Ze.raw.length),Ze.type&&ve.push(Ze);continue}if(Ze=this.tokenizer.code(ge)){ge=ge.substring(Ze.raw.length),(Tt=ve[ve.length-1])&&"paragraph"===Tt.type?(Tt.raw+="\n"+Ze.raw,Tt.text+="\n"+Ze.text):ve.push(Ze);continue}if(Ze=this.tokenizer.fences(ge)){ge=ge.substring(Ze.raw.length),ve.push(Ze);continue}if(Ze=this.tokenizer.heading(ge)){ge=ge.substring(Ze.raw.length),ve.push(Ze);continue}if(Ze=this.tokenizer.nptable(ge)){ge=ge.substring(Ze.raw.length),ve.push(Ze);continue}if(Ze=this.tokenizer.hr(ge)){ge=ge.substring(Ze.raw.length),ve.push(Ze);continue}if(Ze=this.tokenizer.blockquote(ge)){ge=ge.substring(Ze.raw.length),Ze.tokens=this.blockTokens(Ze.text,[],ke),ve.push(Ze);continue}if(Ze=this.tokenizer.list(ge)){for(ge=ge.substring(Ze.raw.length),St=Ze.items.length,wt=0;wt<St;wt++)Ze.items[wt].tokens=this.blockTokens(Ze.items[wt].text,[],!1);ve.push(Ze);continue}if(Ze=this.tokenizer.html(ge)){ge=ge.substring(Ze.raw.length),ve.push(Ze);continue}if(ke&&(Ze=this.tokenizer.def(ge))){ge=ge.substring(Ze.raw.length),this.tokens.links[Ze.tag]||(this.tokens.links[Ze.tag]={href:Ze.href,title:Ze.title});continue}if(Ze=this.tokenizer.table(ge)){ge=ge.substring(Ze.raw.length),ve.push(Ze);continue}if(Ze=this.tokenizer.lheading(ge)){ge=ge.substring(Ze.raw.length),ve.push(Ze);continue}if(Yt=ge,this.options.extensions&&this.options.extensions.startBlock&&function(){var On=1/0,mn=ge.slice(1),Gn=void 0;lt.options.extensions.startBlock.forEach(function(Sn){"number"==typeof(Gn=Sn.call(this,mn))&&Gn>=0&&(On=Math.min(On,Gn))}),On<1/0&&On>=0&&(Yt=ge.substring(0,On+1))}(),ke&&(Ze=this.tokenizer.paragraph(Yt))){Tt=ve[ve.length-1],Vn&&"paragraph"===Tt.type?(Tt.raw+="\n"+Ze.raw,Tt.text+="\n"+Ze.text):ve.push(Ze),Vn=Yt.length!==ge.length,ge=ge.substring(Ze.raw.length);continue}if(Ze=this.tokenizer.text(ge)){ge=ge.substring(Ze.raw.length),(Tt=ve[ve.length-1])&&"text"===Tt.type?(Tt.raw+="\n"+Ze.raw,Tt.text+="\n"+Ze.text):ve.push(Ze);continue}if(ge){var ii="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(ii);break}throw new Error(ii)}}return ve},ot.inline=function(ge){var ve,ke,lt,Ze,wt,St,Tt=ge.length;for(ve=0;ve<Tt;ve++)switch(St=ge[ve],St.type){case"paragraph":case"text":case"heading":St.tokens=[],this.inlineTokens(St.text,St.tokens);break;case"table":for(St.tokens={header:[],cells:[]},Ze=St.header.length,ke=0;ke<Ze;ke++)St.tokens.header[ke]=[],this.inlineTokens(St.header[ke],St.tokens.header[ke]);for(Ze=St.cells.length,ke=0;ke<Ze;ke++)for(wt=St.cells[ke],St.tokens.cells[ke]=[],lt=0;lt<wt.length;lt++)St.tokens.cells[ke][lt]=[],this.inlineTokens(wt[lt],St.tokens.cells[ke][lt]);break;case"blockquote":this.inline(St.tokens);break;case"list":for(Ze=St.items.length,ke=0;ke<Ze;ke++)this.inline(St.items[ke].tokens)}return ge},ot.inlineTokens=function(ge,ve,ke,lt){var Ze=this;void 0===ve&&(ve=[]),void 0===ke&&(ke=!1),void 0===lt&&(lt=!1);var wt,St,Tt,Vn,ii,On,Yt=ge;if(this.tokens.links){var mn=Object.keys(this.tokens.links);if(mn.length>0)for(;null!=(Vn=this.tokenizer.rules.inline.reflinkSearch.exec(Yt));)mn.includes(Vn[0].slice(Vn[0].lastIndexOf("[")+1,-1))&&(Yt=Yt.slice(0,Vn.index)+"["+H("a",Vn[0].length-2)+"]"+Yt.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(Vn=this.tokenizer.rules.inline.blockSkip.exec(Yt));)Yt=Yt.slice(0,Vn.index)+"["+H("a",Vn[0].length-2)+"]"+Yt.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(Vn=this.tokenizer.rules.inline.escapedEmSt.exec(Yt));)Yt=Yt.slice(0,Vn.index)+"++"+Yt.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;ge;)if(ii||(On=""),ii=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(Sn){return!!(wt=Sn.call(Ze,ge,ve))&&(ge=ge.substring(wt.raw.length),ve.push(wt),!0)}))){if(wt=this.tokenizer.escape(ge)){ge=ge.substring(wt.raw.length),ve.push(wt);continue}if(wt=this.tokenizer.tag(ge,ke,lt)){ge=ge.substring(wt.raw.length),ke=wt.inLink,lt=wt.inRawBlock,(St=ve[ve.length-1])&&"text"===wt.type&&"text"===St.type?(St.raw+=wt.raw,St.text+=wt.text):ve.push(wt);continue}if(wt=this.tokenizer.link(ge)){ge=ge.substring(wt.raw.length),"link"===wt.type&&(wt.tokens=this.inlineTokens(wt.text,[],!0,lt)),ve.push(wt);continue}if(wt=this.tokenizer.reflink(ge,this.tokens.links)){ge=ge.substring(wt.raw.length),St=ve[ve.length-1],"link"===wt.type?(wt.tokens=this.inlineTokens(wt.text,[],!0,lt),ve.push(wt)):St&&"text"===wt.type&&"text"===St.type?(St.raw+=wt.raw,St.text+=wt.text):ve.push(wt);continue}if(wt=this.tokenizer.emStrong(ge,Yt,On)){ge=ge.substring(wt.raw.length),wt.tokens=this.inlineTokens(wt.text,[],ke,lt),ve.push(wt);continue}if(wt=this.tokenizer.codespan(ge)){ge=ge.substring(wt.raw.length),ve.push(wt);continue}if(wt=this.tokenizer.br(ge)){ge=ge.substring(wt.raw.length),ve.push(wt);continue}if(wt=this.tokenizer.del(ge)){ge=ge.substring(wt.raw.length),wt.tokens=this.inlineTokens(wt.text,[],ke,lt),ve.push(wt);continue}if(wt=this.tokenizer.autolink(ge,ue)){ge=ge.substring(wt.raw.length),ve.push(wt);continue}if(!ke&&(wt=this.tokenizer.url(ge,ue))){ge=ge.substring(wt.raw.length),ve.push(wt);continue}if(Tt=ge,this.options.extensions&&this.options.extensions.startInline&&function(){var Sn=1/0,er=ge.slice(1),tr=void 0;Ze.options.extensions.startInline.forEach(function(qn){"number"==typeof(tr=qn.call(this,er))&&tr>=0&&(Sn=Math.min(Sn,tr))}),Sn<1/0&&Sn>=0&&(Tt=ge.substring(0,Sn+1))}(),wt=this.tokenizer.inlineText(Tt,lt,fe)){ge=ge.substring(wt.raw.length),"_"!==wt.raw.slice(-1)&&(On=wt.raw.slice(-1)),ii=!0,(St=ve[ve.length-1])&&"text"===St.type?(St.raw+=wt.raw,St.text+=wt.text):ve.push(wt);continue}if(ge){var Gn="Infinite loop on byte: "+ge.charCodeAt(0);if(this.options.silent){console.error(Gn);break}throw new Error(Gn)}}return ve},function(it,ot,ut){ot&&nt(it.prototype,ot),ut&&nt(it,ut)}(it,null,[{key:"rules",get:function(){return{block:Pe,inline:$}}}]),it}(),gt=dt.exports.defaults,ft=ee_cleanUrl,be=ee_escape,B=function(){function it(ut){this.options=ut||gt}var ot=it.prototype;return ot.code=function(ge,ve,ke){var lt=(ve||"").match(/\S*/)[0];if(this.options.highlight){var Ze=this.options.highlight(ge,lt);null!=Ze&&Ze!==ge&&(ke=!0,ge=Ze)}return ge=ge.replace(/\n$/,"")+"\n",lt?'<pre><code class="'+this.options.langPrefix+be(lt,!0)+'">'+(ke?ge:be(ge,!0))+"</code></pre>\n":"<pre><code>"+(ke?ge:be(ge,!0))+"</code></pre>\n"},ot.blockquote=function(ge){return"<blockquote>\n"+ge+"</blockquote>\n"},ot.html=function(ge){return ge},ot.heading=function(ge,ve,ke,lt){return this.options.headerIds?"<h"+ve+' id="'+this.options.headerPrefix+lt.slug(ke)+'">'+ge+"</h"+ve+">\n":"<h"+ve+">"+ge+"</h"+ve+">\n"},ot.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},ot.list=function(ge,ve,ke){var lt=ve?"ol":"ul";return"<"+lt+(ve&&1!==ke?' start="'+ke+'"':"")+">\n"+ge+"</"+lt+">\n"},ot.listitem=function(ge){return"<li>"+ge+"</li>\n"},ot.checkbox=function(ge){return"<input "+(ge?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},ot.paragraph=function(ge){return"<p>"+ge+"</p>\n"},ot.table=function(ge,ve){return ve&&(ve="<tbody>"+ve+"</tbody>"),"<table>\n<thead>\n"+ge+"</thead>\n"+ve+"</table>\n"},ot.tablerow=function(ge){return"<tr>\n"+ge+"</tr>\n"},ot.tablecell=function(ge,ve){var ke=ve.header?"th":"td";return(ve.align?"<"+ke+' align="'+ve.align+'">':"<"+ke+">")+ge+"</"+ke+">\n"},ot.strong=function(ge){return"<strong>"+ge+"</strong>"},ot.em=function(ge){return"<em>"+ge+"</em>"},ot.codespan=function(ge){return"<code>"+ge+"</code>"},ot.br=function(){return this.options.xhtml?"<br/>":"<br>"},ot.del=function(ge){return"<del>"+ge+"</del>"},ot.link=function(ge,ve,ke){if(null===(ge=ft(this.options.sanitize,this.options.baseUrl,ge)))return ke;var lt='<a href="'+be(ge)+'"';return ve&&(lt+=' title="'+ve+'"'),lt+">"+ke+"</a>"},ot.image=function(ge,ve,ke){if(null===(ge=ft(this.options.sanitize,this.options.baseUrl,ge)))return ke;var lt='<img src="'+ge+'" alt="'+ke+'"';return ve&&(lt+=' title="'+ve+'"'),lt+(this.options.xhtml?"/>":">")},ot.text=function(ge){return ge},it}(),P=function(){function it(){}var ot=it.prototype;return ot.strong=function(ge){return ge},ot.em=function(ge){return ge},ot.codespan=function(ge){return ge},ot.del=function(ge){return ge},ot.html=function(ge){return ge},ot.text=function(ge){return ge},ot.link=function(ge,ve,ke){return""+ke},ot.image=function(ge,ve,ke){return""+ke},ot.br=function(){return""},it}(),V=function(){function it(){this.seen={}}var ot=it.prototype;return ot.serialize=function(ge){return ge.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},ot.getNextSafeSlug=function(ge,ve){var ke=ge,lt=0;if(this.seen.hasOwnProperty(ke)){lt=this.seen[ge];do{ke=ge+"-"+ ++lt}while(this.seen.hasOwnProperty(ke))}return ve||(this.seen[ge]=lt,this.seen[ke]=0),ke},ot.slug=function(ge,ve){void 0===ve&&(ve={});var ke=this.serialize(ge);return this.getNextSafeSlug(ke,ve.dryrun)},it}(),Re=B,Qe=P,vt=V,It=dt.exports.defaults,Mn=ee_unescape,Hn=Ve,bi=function(){function it(ut){this.options=ut||It,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Qe,this.slugger=new vt}it.parse=function(ge,ve){return new it(ve).parse(ge)},it.parseInline=function(ge,ve){return new it(ve).parseInline(ge)};var ot=it.prototype;return ot.parse=function(ge,ve){void 0===ve&&(ve=!0);var lt,Ze,wt,St,Tt,Yt,Vn,ii,On,mn,Gn,Sn,er,tr,qn,Vi,ga,Wr,ne,ke="",he=ge.length;for(lt=0;lt<he;lt++)if(mn=ge[lt],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[mn.type]&&(!1!==(ne=this.options.extensions.renderers[mn.type].call(this,mn))||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(mn.type)))ke+=ne||"";else switch(mn.type){case"space":continue;case"hr":ke+=this.renderer.hr();continue;case"heading":ke+=this.renderer.heading(this.parseInline(mn.tokens),mn.depth,Mn(this.parseInline(mn.tokens,this.textRenderer)),this.slugger);continue;case"code":ke+=this.renderer.code(mn.text,mn.lang,mn.escaped);continue;case"table":for(ii="",Vn="",St=mn.header.length,Ze=0;Ze<St;Ze++)Vn+=this.renderer.tablecell(this.parseInline(mn.tokens.header[Ze]),{header:!0,align:mn.align[Ze]});for(ii+=this.renderer.tablerow(Vn),On="",St=mn.cells.length,Ze=0;Ze<St;Ze++){for(Vn="",Tt=(Yt=mn.tokens.cells[Ze]).length,wt=0;wt<Tt;wt++)Vn+=this.renderer.tablecell(this.parseInline(Yt[wt]),{header:!1,align:mn.align[wt]});On+=this.renderer.tablerow(Vn)}ke+=this.renderer.table(ii,On);continue;case"blockquote":On=this.parse(mn.tokens),ke+=this.renderer.blockquote(On);continue;case"list":for(Gn=mn.ordered,Sn=mn.start,er=mn.loose,St=mn.items.length,On="",Ze=0;Ze<St;Ze++)Vi=(qn=mn.items[Ze]).checked,ga=qn.task,tr="",qn.task&&(Wr=this.renderer.checkbox(Vi),er?qn.tokens.length>0&&"text"===qn.tokens[0].type?(qn.tokens[0].text=Wr+" "+qn.tokens[0].text,qn.tokens[0].tokens&&qn.tokens[0].tokens.length>0&&"text"===qn.tokens[0].tokens[0].type&&(qn.tokens[0].tokens[0].text=Wr+" "+qn.tokens[0].tokens[0].text)):qn.tokens.unshift({type:"text",text:Wr}):tr+=Wr),tr+=this.parse(qn.tokens,er),On+=this.renderer.listitem(tr,ga,Vi);ke+=this.renderer.list(On,Gn,Sn);continue;case"html":ke+=this.renderer.html(mn.text);continue;case"paragraph":ke+=this.renderer.paragraph(this.parseInline(mn.tokens));continue;case"text":for(On=mn.tokens?this.parseInline(mn.tokens):mn.text;lt+1<he&&"text"===ge[lt+1].type;)On+="\n"+((mn=ge[++lt]).tokens?this.parseInline(mn.tokens):mn.text);ke+=ve?this.renderer.paragraph(On):On;continue;default:var re='Token with "'+mn.type+'" type was not found.';if(this.options.silent)return void console.error(re);throw new Error(re)}return ke},ot.parseInline=function(ge,ve){ve=ve||this.renderer;var lt,Ze,wt,ke="",St=ge.length;for(lt=0;lt<St;lt++)if(Ze=ge[lt],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[Ze.type]&&(!1!==(wt=this.options.extensions.renderers[Ze.type].call(this,Ze))||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(Ze.type)))ke+=wt||"";else switch(Ze.type){case"escape":ke+=ve.text(Ze.text);break;case"html":ke+=ve.html(Ze.text);break;case"link":ke+=ve.link(Ze.href,Ze.title,this.parseInline(Ze.tokens,ve));break;case"image":ke+=ve.image(Ze.href,Ze.title,Ze.text);break;case"strong":ke+=ve.strong(this.parseInline(Ze.tokens,ve));break;case"em":ke+=ve.em(this.parseInline(Ze.tokens,ve));break;case"codespan":ke+=ve.codespan(Ze.text);break;case"br":ke+=ve.br();break;case"del":ke+=ve.del(this.parseInline(Ze.tokens,ve));break;case"text":ke+=ve.text(Ze.text);break;default:var Tt='Token with "'+Ze.type+'" type was not found.';if(this.options.silent)return void console.error(Tt);throw new Error(Tt)}return ke},it}(),fi=Xe,Gr=B,Ns=P,ds=V,Fs=ee_merge,$r=ee_checkSanitizeDeprecation,fa=ee_escape,xl=dt.exports.getDefaults,pa=dt.exports.changeDefaults,ys=dt.exports.defaults;function Jt(it,ot,ut){if(null==it)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof it)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(it)+", string expected");if("function"==typeof ot&&(ut=ot,ot=null),ot=Fs({},Jt.defaults,ot||{}),$r(ot),ut){var ve,ge=ot.highlight;try{ve=Hn.lex(it,ot)}catch(wt){return ut(wt)}var ke=function(St){var Tt;if(!St)try{ot.walkTokens&&Jt.walkTokens(ve,ot.walkTokens),Tt=bi.parse(ve,ot)}catch(Yt){St=Yt}return ot.highlight=ge,St?ut(St):ut(null,Tt)};if(!ge||ge.length<3||(delete ot.highlight,!ve.length))return ke();var lt=0;return Jt.walkTokens(ve,function(wt){"code"===wt.type&&(lt++,setTimeout(function(){ge(wt.text,wt.lang,function(St,Tt){if(St)return ke(St);null!=Tt&&Tt!==wt.text&&(wt.text=Tt,wt.escaped=!0),0==--lt&&ke()})},0))}),void(0===lt&&ke())}try{var Ze=Hn.lex(it,ot);return ot.walkTokens&&Jt.walkTokens(Ze,ot.walkTokens),bi.parse(Ze,ot)}catch(wt){if(wt.message+="\nPlease report this to https://github.com/markedjs/marked.",ot.silent)return"<p>An error occurred:</p><pre>"+fa(wt.message+"",!0)+"</pre>";throw wt}}return Jt.options=Jt.setOptions=function(it){return Fs(Jt.defaults,it),pa(Jt.defaults),Jt},Jt.getDefaults=xl,Jt.defaults=ys,Jt.use=function(){for(var it=this,ot=arguments.length,ut=new Array(ot),ge=0;ge<ot;ge++)ut[ge]=arguments[ge];var lt,ve=Fs.apply(void 0,[{}].concat(ut)),ke=Jt.defaults.extensions||{renderers:{},childTokens:{}};ut.forEach(function(Ze){if(Ze.extensions&&(lt=!0,Ze.extensions.forEach(function(St){if(!St.name)throw new Error("extension name required");if(St.renderer){var Tt=ke.renderers?ke.renderers[St.name]:null;ke.renderers[St.name]=Tt?function(){for(var Yt=arguments.length,Vn=new Array(Yt),ii=0;ii<Yt;ii++)Vn[ii]=arguments[ii];var On=St.renderer.apply(this,Vn);return!1===On&&(On=Tt.apply(this,Vn)),On}:St.renderer}if(St.tokenizer){if(!St.level||"block"!==St.level&&"inline"!==St.level)throw new Error("extension level must be 'block' or 'inline'");ke[St.level]?ke[St.level].unshift(St.tokenizer):ke[St.level]=[St.tokenizer],St.start&&("block"===St.level?ke.startBlock?ke.startBlock.push(St.start):ke.startBlock=[St.start]:"inline"===St.level&&(ke.startInline?ke.startInline.push(St.start):ke.startInline=[St.start]))}St.childTokens&&(ke.childTokens[St.name]=St.childTokens)})),Ze.renderer&&function(){var St=Jt.defaults.renderer||new Gr,Tt=function(ii){var On=St[ii];St[ii]=function(){for(var mn=arguments.length,Gn=new Array(mn),Sn=0;Sn<mn;Sn++)Gn[Sn]=arguments[Sn];var er=Ze.renderer[ii].apply(St,Gn);return!1===er&&(er=On.apply(St,Gn)),er}};for(var Yt in Ze.renderer)Tt(Yt);ve.renderer=St}(),Ze.tokenizer&&function(){var St=Jt.defaults.tokenizer||new fi,Tt=function(ii){var On=St[ii];St[ii]=function(){for(var mn=arguments.length,Gn=new Array(mn),Sn=0;Sn<mn;Sn++)Gn[Sn]=arguments[Sn];var er=Ze.tokenizer[ii].apply(St,Gn);return!1===er&&(er=On.apply(St,Gn)),er}};for(var Yt in Ze.tokenizer)Tt(Yt);ve.tokenizer=St}(),Ze.walkTokens){var wt=Jt.defaults.walkTokens;ve.walkTokens=function(St){Ze.walkTokens.call(it,St),wt&&wt(St)}}lt&&(ve.extensions=ke),Jt.setOptions(ve)})},Jt.walkTokens=function(it,ot){for(var ve,ut=function(){var lt=ve.value;switch(ot(lt),lt.type){case"table":for(var wt,Ze=xt(lt.tokens.header);!(wt=Ze()).done;)Jt.walkTokens(wt.value,ot);for(var Yt,Tt=xt(lt.tokens.cells);!(Yt=Tt()).done;)for(var On,ii=xt(Yt.value);!(On=ii()).done;)Jt.walkTokens(On.value,ot);break;case"list":Jt.walkTokens(lt.items,ot);break;default:Jt.defaults.extensions&&Jt.defaults.extensions.childTokens&&Jt.defaults.extensions.childTokens[lt.type]?Jt.defaults.extensions.childTokens[lt.type].forEach(function(Gn){Jt.walkTokens(lt[Gn],ot)}):lt.tokens&&Jt.walkTokens(lt.tokens,ot)}},ge=xt(it);!(ve=ge()).done;)ut()},Jt.parseInline=function(it,ot){if(null==it)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof it)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(it)+", string expected");ot=Fs({},Jt.defaults,ot||{}),$r(ot);try{var ut=Hn.lexInline(it,ot);return ot.walkTokens&&Jt.walkTokens(ut,ot.walkTokens),bi.parseInline(ut,ot)}catch(ge){if(ge.message+="\nPlease report this to https://github.com/markedjs/marked.",ot.silent)return"<p>An error occurred:</p><pre>"+fa(ge.message+"",!0)+"</pre>";throw ge}},Jt.Parser=bi,Jt.parser=bi.parse,Jt.Renderer=Gr,Jt.TextRenderer=Ns,Jt.Lexer=Hn,Jt.lexer=Hn.lex,Jt.Tokenizer=fi,Jt.Slugger=ds,Jt.parse=Jt,Jt}()},369:(Vt,nt,tt)=>{var mt=tt(284),J=tt(830);function xt(){this.clear()}xt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},xt.prototype.enqueue=function(dt){return this.items.push(dt),++this.size},xt.prototype.dequeue=function(){if(this.size){var dt=this.items[this.offset];return 2*++this.offset>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,dt}},xt.prototype.peek=function(){if(this.size)return this.items[this.offset]},xt.prototype.forEach=function(dt,K){K=arguments.length>1?K:this;for(var Ae=this.offset,pe=0,Y=this.items.length;Ae<Y;Ae++,pe++)dt.call(K,this.items[Ae],pe,this)},xt.prototype.toArray=function(){return this.items.slice(this.offset)},xt.prototype.values=function(){var dt=this.items,K=this.offset;return new mt(function(){if(K>=dt.length)return{done:!0};var Ae=dt[K];return K++,{value:Ae,done:!1}})},xt.prototype.entries=function(){var dt=this.items,K=this.offset,Ae=0;return new mt(function(){if(K>=dt.length)return{done:!0};var pe=dt[K];return K++,{value:[Ae++,pe],done:!1}})},"undefined"!=typeof Symbol&&(xt.prototype[Symbol.iterator]=xt.prototype.values),xt.prototype.toString=function(){return this.toArray().join(",")},xt.prototype.toJSON=function(){return this.toArray()},xt.prototype.inspect=function(){var dt=this.toArray();return Object.defineProperty(dt,"constructor",{value:xt,enumerable:!1}),dt},"undefined"!=typeof Symbol&&(xt.prototype[Symbol.for("nodejs.util.inspect.custom")]=xt.prototype.inspect),xt.from=function(dt){var K=new xt;return J(dt,function(Ae){K.enqueue(Ae)}),K},xt.of=function(){return xt.from(arguments)},Vt.exports=xt},830:Vt=>{var nt="undefined"!=typeof ArrayBuffer,tt="undefined"!=typeof Symbol;function mt(J,xt){var dt,K,Ae,pe,Y;if(!J)throw new Error("obliterator/forEach: invalid iterable.");if("function"!=typeof xt)throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(J)||nt&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Ae=0,pe=J.length;Ae<pe;Ae++)xt(J[Ae],Ae);else if("function"!=typeof J.forEach)if(tt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(K in J)J.hasOwnProperty(K)&&xt(J[K],K);else for(dt=J,Ae=0;!0!==(Y=dt.next()).done;)xt(Y.value,Ae),Ae++;else J.forEach(xt)}mt.forEachWithNullKeys=function(J,xt){var dt,K,Ae,pe,Y;if(!J)throw new Error("obliterator/forEachWithNullKeys: invalid iterable.");if("function"!=typeof xt)throw new Error("obliterator/forEachWithNullKeys: expecting a callback.");if(Array.isArray(J)||nt&&ArrayBuffer.isView(J)||"string"==typeof J||"[object Arguments]"===J.toString())for(Ae=0,pe=J.length;Ae<pe;Ae++)xt(J[Ae],null);else if(J instanceof Set)J.forEach(function(U){xt(U,null)});else if("function"!=typeof J.forEach)if(tt&&Symbol.iterator in J&&"function"!=typeof J.next&&(J=J[Symbol.iterator]()),"function"!=typeof J.next)for(K in J)J.hasOwnProperty(K)&&xt(J[K],K);else for(dt=J,Ae=0;!0!==(Y=dt.next()).done;)xt(Y.value,null),Ae++;else J.forEach(xt)},Vt.exports=mt},284:Vt=>{function nt(tt){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:tt}),this.done=!1}nt.prototype.next=function(){if(this.done)return{done:!0};var tt=this._next();return tt.done&&(this.done=!0),tt},"undefined"!=typeof Symbol&&(nt.prototype[Symbol.iterator]=function(){return this}),nt.of=function(){var tt=arguments,mt=tt.length,J=0;return new nt(function(){return J>=mt?{done:!0}:{done:!1,value:tt[J++]}})},nt.empty=function(){var tt=new nt(null);return tt.done=!0,tt},nt.is=function(tt){return tt instanceof nt||"object"==typeof tt&&null!==tt&&"function"==typeof tt.next},Vt.exports=nt},310:(Vt,nt,tt)=>{"use strict";var mt=tt(948);Object.defineProperty(nt,"__esModule",{value:!0}),nt.isMobile=function(){return void 0!==J.window.orientation},nt.default=function(pe){if(!pe&&!(0,xt.default)())return"Node";if((0,dt.default)(pe))return"Electron";var Y="undefined"!=typeof navigator?navigator:{},U=pe||Y.userAgent||"";if(U.indexOf("Edge")>-1)return"Edge";var k=-1!==U.indexOf("MSIE "),ie=-1!==U.indexOf("Trident/");return k||ie?"IE":J.window.chrome?"Chrome":J.window.safari?"Safari":J.window.mozInnerScreenX?"Firefox":"Unknown"};var J=tt(151),xt=mt(tt(602)),dt=mt(tt(344))},151:(Vt,nt,tt)=>{"use strict";var mt=tt(948);Object.defineProperty(nt,"__esModule",{value:!0}),nt.console=nt.process=nt.document=nt.global=nt.window=nt.self=void 0;var J=mt(tt(321)),xt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&process};nt.self=xt.self||xt.window||xt.global,nt.window=xt.window||xt.self||xt.global,nt.global=xt.global||xt.self||xt.window,nt.document=xt.document||{},nt.process=xt.process||{};var U=console;nt.console=U},761:(Vt,nt,tt)=>{"use strict";var J=tt(948),xt=tt(321);Object.defineProperty(nt,"CO",{enumerable:!0,get:function(){return dt.global}}),Object.defineProperty(nt,"jU",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(nt,"qs",{enumerable:!0,get:function(){return Ae.default}});var dt=tt(151),K=U(tt(602)),Ae=U(tt(310));J(tt(344));function Y(k){if("function"!=typeof WeakMap)return null;var ie=new WeakMap,W=new WeakMap;return(Y=function(x){return x?W:ie})(k)}function U(k,ie){if(!ie&&k&&k.__esModule)return k;if(null===k||"object"!==xt(k)&&"function"!=typeof k)return{default:k};var W=Y(ie);if(W&&W.has(k))return W.get(k);var b={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in k)if("default"!==N&&Object.prototype.hasOwnProperty.call(k,N)){var M=x?Object.getOwnPropertyDescriptor(k,N):null;M&&(M.get||M.set)?Object.defineProperty(b,N,M):b[N]=k[N]}return b.default=k,W&&W.set(k,b),b}},602:(Vt,nt,tt)=>{"use strict";var mt=tt(948);Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=dt,nt.isBrowserMainThread=function(){return dt()&&"undefined"!=typeof document};var J=mt(tt(321)),xt=mt(tt(344));function dt(){return!("object"===("undefined"==typeof process?"undefined":(0,J.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,xt.default)()}},344:(Vt,nt,tt)=>{"use strict";var mt=tt(948);Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=function(dt){if("undefined"!=typeof window&&"object"===(0,J.default)(window.process)&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"===(0,J.default)(process.versions)&&Boolean(process.versions.electron))return!0;var K="object"===("undefined"==typeof navigator?"undefined":(0,J.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,Ae=dt||K;return!!(Ae&&Ae.indexOf("Electron")>=0)};var J=mt(tt(321))},991:function(Vt,nt,tt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(xt,dt,K,Ae){void 0===Ae&&(Ae=K),Object.defineProperty(xt,Ae,{enumerable:!0,get:function(){return dt[K]}})}:function(xt,dt,K,Ae){void 0===Ae&&(Ae=K),xt[Ae]=dt[K]}),J=this&&this.__exportStar||function(xt,dt){for(var K in xt)"default"!==K&&!Object.prototype.hasOwnProperty.call(dt,K)&&mt(dt,xt,K)};Object.defineProperty(nt,"__esModule",{value:!0}),J(tt(180),nt),J(tt(103),nt),J(tt(965),nt),J(tt(595),nt),J(tt(417),nt),J(tt(451),nt),J(tt(735),nt)},180:(Vt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.BlankNode=void 0,nt.BlankNode=class{constructor(J){this.termType="BlankNode",this.value=J}equals(J){return!!J&&"BlankNode"===J.termType&&J.value===this.value}}},103:(Vt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.DataFactory=void 0;const mt=tt(180),J=tt(965),xt=tt(595),dt=tt(417),K=tt(451),Ae=tt(735);let pe=0;nt.DataFactory=class{constructor(k){this.blankNodeCounter=0,this.blankNodePrefix=(k=k||{}).blankNodePrefix||`df_${pe++}_`}namedNode(k){return new dt.NamedNode(k)}blankNode(k){return new mt.BlankNode(k||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(k,ie){return new xt.Literal(k,ie)}variable(k){return new Ae.Variable(k)}defaultGraph(){return J.DefaultGraph.INSTANCE}quad(k,ie,W,b){return new K.Quad(k,ie,W,b||this.defaultGraph())}fromTerm(k){switch(k.termType){case"NamedNode":return this.namedNode(k.value);case"BlankNode":return this.blankNode(k.value);case"Literal":return k.language?this.literal(k.value,k.language):k.datatype.equals(xt.Literal.XSD_STRING)?this.literal(k.value):this.literal(k.value,this.fromTerm(k.datatype));case"Variable":return this.variable(k.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(k.subject),this.fromTerm(k.predicate),this.fromTerm(k.object),this.fromTerm(k.graph))}}fromQuad(k){return this.fromTerm(k)}resetBlankNodeCounter(){this.blankNodeCounter=0}}},965:(Vt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.DefaultGraph=void 0;class tt{constructor(){this.termType="DefaultGraph",this.value=""}equals(J){return!!J&&"DefaultGraph"===J.termType}}nt.DefaultGraph=tt,tt.INSTANCE=new tt},595:(Vt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.Literal=void 0;const mt=tt(417);class J{constructor(dt,K){this.termType="Literal",this.value=dt,"string"==typeof K?(this.language=K,this.datatype=J.RDF_LANGUAGE_STRING):K?(this.language="",this.datatype=K):(this.language="",this.datatype=J.XSD_STRING)}equals(dt){return!!dt&&"Literal"===dt.termType&&dt.value===this.value&&dt.language===this.language&&dt.datatype.equals(this.datatype)}}nt.Literal=J,J.RDF_LANGUAGE_STRING=new mt.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),J.XSD_STRING=new mt.NamedNode("http://www.w3.org/2001/XMLSchema#string")},417:(Vt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.NamedNode=void 0,nt.NamedNode=class{constructor(J){this.termType="NamedNode",this.value=J}equals(J){return!!J&&"NamedNode"===J.termType&&J.value===this.value}}},451:(Vt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.Quad=void 0,nt.Quad=class{constructor(J,xt,dt,K){this.termType="Quad",this.value="",this.subject=J,this.predicate=xt,this.object=dt,this.graph=K}equals(J){return!!J&&("Quad"===J.termType||!J.termType)&&this.subject.equals(J.subject)&&this.predicate.equals(J.predicate)&&this.object.equals(J.object)&&this.graph.equals(J.graph)}}},735:(Vt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.Variable=void 0,nt.Variable=class{constructor(J){this.termType="Variable",this.value=J}equals(J){return!!J&&"Variable"===J.termType&&J.value===this.value}}},609:function(Vt,nt,tt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(b,x,N,M){void 0===M&&(M=N),Object.defineProperty(b,M,{enumerable:!0,get:function(){return x[N]}})}:function(b,x,N,M){void 0===M&&(M=N),b[M]=x[N]}),J=this&&this.__exportStar||function(b,x){for(var N in b)"default"!==N&&!Object.prototype.hasOwnProperty.call(x,N)&&mt(x,b,N)};Object.defineProperty(nt,"__esModule",{value:!0}),nt.getSupportedJavaScriptPrimitives=nt.getSupportedRdfDatatypes=nt.getTermRaw=nt.toRdf=nt.fromRdf=void 0;const xt=tt(991),dt=tt(938),K=tt(60);J(tt(938),nt),J(tt(871),nt),J(tt(60),nt);const Ae=new xt.DataFactory,pe=new K.Translator;function Y(b,x){return pe.fromRdf(b,x)}pe.registerHandler(new dt.TypeHandlerString,dt.TypeHandlerString.TYPES.map(b=>Ae.namedNode(b)),["string"]),pe.registerHandler(new dt.TypeHandlerBoolean,[dt.TypeHandlerBoolean.TYPE].map(b=>Ae.namedNode(b)),["boolean"]),pe.registerHandler(new dt.TypeHandlerNumberDouble,dt.TypeHandlerNumberDouble.TYPES.map(b=>Ae.namedNode(b)),["number"]),pe.registerHandler(new dt.TypeHandlerNumberInteger,dt.TypeHandlerNumberInteger.TYPES.map(b=>Ae.namedNode(b)),["number"]),pe.registerHandler(new dt.TypeHandlerDate,dt.TypeHandlerDate.TYPES.map(b=>Ae.namedNode(b)),["object"]),nt.fromRdf=Y,nt.toRdf=function(b,x){return x&&"namedNode"in x&&(x={dataFactory:x}),(x=x||{})&&!x.dataFactory&&(x.dataFactory=Ae),pe.toRdf(b,x)},nt.getTermRaw=function(b,x){return"Literal"===b.termType?Y(b,x):b.value},nt.getSupportedRdfDatatypes=function(){return pe.getSupportedRdfDatatypes()},nt.getSupportedJavaScriptPrimitives=function(){return pe.getSupportedJavaScriptPrimitives()}},871:(Vt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0})},60:(Vt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.Translator=void 0,nt.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(J){throw new Error(`Invalid RDF ${J.datatype.value} value: '${J.value}'`)}registerHandler(J,xt,dt){for(const K of xt)this.supportedRdfDatatypes.push(K),this.fromRdfHandlers[K.value]=J;for(const K of dt){let Ae=this.toRdfHandlers[K];Ae||(this.toRdfHandlers[K]=Ae=[]),Ae.push(J)}}fromRdf(J,xt){const dt=this.fromRdfHandlers[J.datatype.value];return dt?dt.fromRdf(J,xt):J.value}toRdf(J,xt){const dt=this.toRdfHandlers[typeof J];if(dt)for(const K of dt){const Ae=K.toRdf(J,xt);if(Ae)return Ae}throw new Error(`Invalid JavaScript value: '${J}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}},727:(Vt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerBoolean=void 0;const mt=tt(60);class J{fromRdf(dt,K){switch(dt.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return K&&mt.Translator.incorrectRdfDataType(dt),!1}toRdf(dt,{datatype:K,dataFactory:Ae}){return Ae.literal(dt?"true":"false",K||Ae.namedNode(J.TYPE))}}nt.TypeHandlerBoolean=J,J.TYPE="http://www.w3.org/2001/XMLSchema#boolean"},525:(Vt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerDate=void 0;const mt=tt(60);class J{fromRdf(dt,K){switch(K&&!dt.value.match(J.VALIDATORS[dt.datatype.value.substr(33,dt.datatype.value.length)])&&mt.Translator.incorrectRdfDataType(dt),dt.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(dt.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const Ae=dt.value.split("-");return new Date(0,parseInt(Ae[0],10)-1,parseInt(Ae[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(dt.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(dt.value+"-01");default:return new Date(dt.value)}}toRdf(dt,{datatype:K,dataFactory:Ae}){if(K=K||Ae.namedNode(J.TYPES[0]),!(dt instanceof Date))return null;const pe=dt;let Y;switch(K.value){case"http://www.w3.org/2001/XMLSchema#gDay":Y=String(pe.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":Y=pe.getUTCMonth()+1+"-"+pe.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":Y=String(pe.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":Y=pe.getUTCFullYear()+"-"+(pe.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":Y=pe.toISOString().replace(/T.*$/,"");break;default:Y=pe.toISOString()}return Ae.literal(Y,K)}}nt.TypeHandlerDate=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],J.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/}},554:(Vt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerNumberDouble=void 0;const mt=tt(60);class J{fromRdf(dt,K){const Ae=parseFloat(dt.value);return K&&isNaN(Ae)&&mt.Translator.incorrectRdfDataType(dt),Ae}toRdf(dt,{datatype:K,dataFactory:Ae}){return K=K||Ae.namedNode(J.TYPES[0]),isNaN(dt)?Ae.literal("NaN",K):isFinite(dt)?dt%1==0?null:Ae.literal(dt.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),K):Ae.literal(dt>0?"INF":"-INF",K)}}nt.TypeHandlerNumberDouble=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"]},750:(Vt,nt,tt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerNumberInteger=void 0;const mt=tt(60);class J{fromRdf(dt,K){const Ae=parseInt(dt.value,10);return K&&(isNaN(Ae)||dt.value.indexOf(".")>=0)&&mt.Translator.incorrectRdfDataType(dt),Ae}toRdf(dt,{datatype:K,dataFactory:Ae}){return Ae.literal(String(dt),K||Ae.namedNode(dt<=J.MAX_INT&&dt>=J.MIN_INT?J.TYPES[0]:J.TYPES[1]))}}nt.TypeHandlerNumberInteger=J,J.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],J.MAX_INT=2147483647,J.MIN_INT=-2147483648},608:(Vt,nt)=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0}),nt.TypeHandlerString=void 0;class tt{fromRdf(J){return J.value}toRdf(J,{datatype:xt,dataFactory:dt}){return dt.literal(J,xt)}}nt.TypeHandlerString=tt,tt.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"]},938:function(Vt,nt,tt){"use strict";var mt=this&&this.__createBinding||(Object.create?function(xt,dt,K,Ae){void 0===Ae&&(Ae=K),Object.defineProperty(xt,Ae,{enumerable:!0,get:function(){return dt[K]}})}:function(xt,dt,K,Ae){void 0===Ae&&(Ae=K),xt[Ae]=dt[K]}),J=this&&this.__exportStar||function(xt,dt){for(var K in xt)"default"!==K&&!Object.prototype.hasOwnProperty.call(dt,K)&&mt(dt,xt,K)};Object.defineProperty(nt,"__esModule",{value:!0}),J(tt(727),nt),J(tt(525),nt),J(tt(554),nt),J(tt(750),nt),J(tt(608),nt)},572:(Vt,nt,tt)=>{"use strict";var mt={};tt.r(mt),tt.d(mt,{decode:()=>xfe,encode:()=>Tfe});var J={};tt.r(J),tt.d(J,{decode:()=>Ofe,encode:()=>Rfe});var xt={};tt.r(xt),tt.d(xt,{decode:()=>Pfe,encode:()=>Nfe});var dt={};function K(n){return"function"==typeof n}tt.r(dt),tt.d(dt,{decode:()=>Ffe,encode:()=>Lfe});let Ae=!1;const pe={Promise:void 0,set useDeprecatedSynchronousErrorHandling(n){if(n){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else Ae&&console.log("RxJS: Back to a better error behavior. Thank you. <3");Ae=n},get useDeprecatedSynchronousErrorHandling(){return Ae}};function Y(n){setTimeout(()=>{throw n},0)}const U={closed:!0,next(n){},error(n){if(pe.useDeprecatedSynchronousErrorHandling)throw n;Y(n)},complete(){}},k=Array.isArray||(n=>n&&"number"==typeof n.length);function ie(n){return null!==n&&"object"==typeof n}const b=(()=>{function n(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((t,i)=>`${i+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return n.prototype=Object.create(Error.prototype),n})();class x{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:t,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof x)t.remove(this);else if(null!==t)for(let o=0;o<t.length;++o)t[o].remove(this);if(K(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(o){e=o instanceof b?N(o.errors):[o]}}if(k(s)){let o=-1,a=s.length;for(;++o<a;){const l=s[o];if(ie(l))try{l.unsubscribe()}catch(c){e=e||[],c instanceof b?e=e.concat(N(c.errors)):e.push(c)}}}if(e)throw new b(e)}add(e){let t=e;if(!e)return x.EMPTY;switch(typeof e){case"function":t=new x(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof x)){const s=t;t=new x,t._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=t;if(null===i)t._parentOrParents=this;else if(i instanceof x){if(i===this)return t;t._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return t;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[t]:r.push(t),t}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var n;function N(n){return n.reduce((e,t)=>e.concat(t instanceof b?t.errors:t),[])}x.EMPTY=((n=new x).closed=!0,n);const M="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class y extends x{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=U;break;case 1:if(!e){this.destination=U;break}if("object"==typeof e){e instanceof y?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new S(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new S(this,e,t,i)}}[M](){return this}static create(e,t,i){const r=new y(e,t,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class S extends y{constructor(e,t,i,r){super(),this._parentSubscriber=e;let s,o=this;K(t)?s=t:t&&(s=t.next,i=t.error,r=t.complete,t!==U&&(o=Object.create(t),K(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;pe.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=pe;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):Y(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;Y(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);pe.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),pe.useDeprecatedSynchronousErrorHandling)throw i;Y(i)}}__tryOrSetError(e,t,i){if(!pe.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(r){return pe.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(Y(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const O="function"==typeof Symbol&&Symbol.observable||"@@observable";function q(n){return n}let I=(()=>{class n{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const{operator:s}=this,o=function(n,e,t){if(n){if(n instanceof y)return n;if(n[M])return n[M]()}return n||e||t?new y(n,e,t):new y(U)}(t,i,r);if(o.add(s?s.call(o,this.source):this.source||pe.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),pe.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){pe.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=i),function(n){for(;n;){const{closed:e,destination:t,isStopped:i}=n;if(e||i)return!1;n=t&&t instanceof y?t:null}return!0}(t)?t.error(i):console.warn(i)}}forEach(t,i){return new(i=X(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),o&&o.unsubscribe()}},s,r)})}_subscribe(t){const{source:i}=this;return i&&i.subscribe(t)}[O](){return this}pipe(...t){return 0===t.length?this:function(n){return 0===n.length?q:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=X(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function X(n){if(n||(n=pe.Promise||Promise),!n)throw new Error("no Promise impl found");return n}const G=(()=>{function n(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return n.prototype=Object.create(Error.prototype),n})();class Q extends x{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class oe extends y{constructor(e){super(e),this.destination=e}}let se=(()=>{class n extends I{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[M](){return new oe(this)}lift(t){const i=new ee(this,this);return i.operator=t,i}next(t){if(this.closed)throw new G;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].next(t)}}error(t){if(this.closed)throw new G;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let o=0;o<r;o++)s[o].error(t);this.observers.length=0}complete(){if(this.closed)throw new G;this.isStopped=!0;const{observers:t}=this,i=t.length,r=t.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new G;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new G;return this.hasError?(t.error(this.thrownError),x.EMPTY):this.isStopped?(t.complete(),x.EMPTY):(this.observers.push(t),new Q(this,t))}asObservable(){const t=new I;return t.source=this,t}}return n.create=(e,t)=>new ee(e,t),n})();class ee extends se{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):x.EMPTY}}function Se(n){return n&&"function"==typeof n.schedule}function me(n,e){return function(i){if("function"!=typeof n)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new te(n,e))}}class te{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new _e(e,this.project,this.thisArg))}}class _e extends y{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Oe=n=>e=>{for(let t=0,i=n.length;t<i&&!e.closed;t++)e.next(n[t]);e.complete()},Xe="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Le=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ke(n){return!!n&&"function"!=typeof n.subscribe&&"function"==typeof n.then}const xe=n=>{if(n&&"function"==typeof n[O])return(n=>e=>{const t=n[O]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)})(n);if(Le(n))return Oe(n);if(Ke(n))return(n=>e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Y),e))(n);if(n&&"function"==typeof n[Xe])return(n=>e=>{const t=n[Xe]();for(;;){let i;try{i=t.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof t.return&&e.add(()=>{t.return&&t.return()}),e})(n);{const t=`You provided ${ie(n)?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(t)}};function Pe(n,e){return new I(t=>{const i=new x;let r=0;return i.add(e.schedule(function(){r!==n.length?(t.next(n[r++]),t.closed||i.add(this.schedule())):t.complete()})),i})}function Ve(n,e){return e?function(n,e){if(null!=n){if(function(n){return n&&"function"==typeof n[O]}(n))return function(n,e){return new I(t=>{const i=new x;return i.add(e.schedule(()=>{const r=n[O]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>t.next(s)))},error(s){i.add(e.schedule(()=>t.error(s)))},complete(){i.add(e.schedule(()=>t.complete()))}}))})),i})}(n,e);if(Ke(n))return function(n,e){return new I(t=>{const i=new x;return i.add(e.schedule(()=>n.then(r=>{i.add(e.schedule(()=>{t.next(r),i.add(e.schedule(()=>t.complete()))}))},r=>{i.add(e.schedule(()=>t.error(r)))}))),i})}(n,e);if(Le(n))return Pe(n,e);if(function(n){return n&&"function"==typeof n[Xe]}(n)||"string"==typeof n)return function(n,e){if(!n)throw new Error("Iterable cannot be null");return new I(t=>{const i=new x;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=n[Xe](),i.add(e.schedule(function(){if(t.closed)return;let s,o;try{const a=r.next();s=a.value,o=a.done}catch(a){return void t.error(a)}o?t.complete():(t.next(s),this.schedule())}))})),i})}(n,e)}throw new TypeError((null!==n&&typeof n||n)+" is not observable")}(n,e):n instanceof I?n:new I(xe(n))}class gt extends y{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class be extends y{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function P(n,e){if(e.closed)return;if(n instanceof I)return n.subscribe(e);let t;try{t=xe(n)(e)}catch(i){e.error(i)}return t}function V(n,e,t=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(V((r,s)=>Ve(n(r,s)).pipe(me((o,a)=>e(r,o,s,a))),t)):("number"==typeof e&&(t=e),i=>i.lift(new Re(n,t)))}class Re{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new Qe(e,this.project,this.concurrent))}}class Qe extends be{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t)}_innerSub(e){const t=new gt(this),i=this.destination;i.add(t);const r=P(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function It(n=Number.POSITIVE_INFINITY){return V(q,n)}function Mn(n,e){return e?Pe(n,e):new I(Oe(n))}function Rn(...n){let e=Number.POSITIVE_INFINITY,t=null,i=n[n.length-1];return Se(i)?(t=n.pop(),n.length>1&&"number"==typeof n[n.length-1]&&(e=n.pop())):"number"==typeof i&&(e=n.pop()),null===t&&1===n.length&&n[0]instanceof I?n[0]:It(e)(Mn(n,t))}function Hn(){return function(e){return e.lift(new bi(e))}}class bi{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const r=new fi(e,i),s=t.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class fi extends y{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Gr extends I{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new x,e.add(this.source.subscribe(new ds(this.getSubject(),this))),e.closed&&(this._connection=null,e=x.EMPTY)),e}refCount(){return Hn()(this)}}const Ns=(()=>{const n=Gr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:n._subscribe},_isComplete:{value:n._isComplete,writable:!0},getSubject:{value:n.getSubject},connect:{value:n.connect},refCount:{value:n.refCount}}})();class ds extends oe{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function fa(n,e){return function(i){let r;if(r="function"==typeof n?n:function(){return n},"function"==typeof e)return i.lift(new xl(r,e));const s=Object.create(i,Ns);return s.source=i,s.subjectFactory=r,s}}class xl{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:i}=this,r=this.subjectFactory(),s=i(r).subscribe(e);return s.add(t.subscribe(r)),s}}function pa(){return new se}function ys(){return n=>Hn()(fa(pa)(n))}function Jt(n){for(let e in n)if(n[e]===Jt)return e;throw Error("Could not find renamed property on target object.")}function Wa(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function it(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(it).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function ot(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ut=Jt({__forward_ref__:Jt});function ge(n){return n.__forward_ref__=ge,n.toString=function(){return it(this())},n}function ve(n){return ke(n)?n():n}function ke(n){return"function"==typeof n&&n.hasOwnProperty(ut)&&n.__forward_ref__===ge}class Ze extends Error{constructor(e,t){super(function(n,e){return`${n?`NG0${n}: `:""}${e}`}(e,t)),this.code=e}}function Tt(n){return"string"==typeof n?n:null==n?"":String(n)}function Yt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Tt(n)}function mn(n,e){const t=e?` in ${e}`:"";throw new Ze("201",`No provider for ${Yt(n)} found${t}`)}function Z(n,e){null==n&&function(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function $e(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function bt(n){return{providers:n.providers||[],imports:n.imports||[]}}function _n(n){return vs(n,lo)||vs(n,Ls)}function vs(n,e){return n.hasOwnProperty(e)?n[e]:null}function Tl(n){return n&&(n.hasOwnProperty(Fr)||n.hasOwnProperty(mc))?n[Fr]:null}const lo=Jt({\u0275prov:Jt}),Fr=Jt({\u0275inj:Jt}),Ls=Jt({ngInjectableDef:Jt}),mc=Jt({ngInjectorDef:Jt});var wn=(()=>((wn=wn||{})[wn.Default=0]="Default",wn[wn.Host=1]="Host",wn[wn.Self=2]="Self",wn[wn.SkipSelf=4]="SkipSelf",wn[wn.Optional=8]="Optional",wn))();let co;function ma(n){const e=co;return co=n,e}function ud(n,e,t){const i=_n(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&wn.Optional?null:void 0!==e?e:void mn(it(n),"Injector")}function Te(n){return{toString:n}.toString()}var He=(()=>((He=He||{})[He.OnPush=0]="OnPush",He[He.Default=1]="Default",He))(),$t=(()=>(($t=$t||{})[$t.Emulated=0]="Emulated",$t[$t.None=2]="None",$t[$t.ShadowDom=3]="ShadowDom",$t))();const ri="undefined"!=typeof globalThis&&globalThis,Lr="undefined"!=typeof window&&window,Yr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,bs="undefined"!=typeof global&&global,ti=ri||bs||Lr||Yr,dd={},Xi=[],Yf=Jt({\u0275cmp:Jt}),Mm=Jt({\u0275dir:Jt}),mh=Jt({\u0275pipe:Jt}),_b=Jt({\u0275mod:Jt}),Ix=Jt({\u0275loc:Jt}),Ml=Jt({\u0275fac:Jt}),_h=Jt({__NG_ELEMENT_ID__:Jt});let Ox=0;function yn(n){return Te(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===He.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Xi,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||$t.Emulated,id:"c",styles:n.styles||Xi,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=Ox++,i.inputs=wb(n.inputs,t),i.outputs=wb(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(yb):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(vb):null,i})}function yb(n){return Ni(n)||function(n){return n[Mm]||null}(n)}function vb(n){return function(n){return n[mh]||null}(n)}const bb={};function ln(n){return Te(()=>{const e={type:n.type,bootstrap:n.bootstrap||Xi,declarations:n.declarations||Xi,imports:n.imports||Xi,exports:n.exports||Xi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(bb[n.id]=n.type),e})}function wb(n,e){if(null==n)return dd;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const kt=yn;function ks(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function Ni(n){return n[Yf]||null}function xo(n,e){const t=n[_b]||null;if(!t&&!0===e)throw new Error(`Type ${it(n)} does not have '\u0275mod' property.`);return t}function zo(n){return Array.isArray(n)&&"object"==typeof n[1]}function Ho(n){return Array.isArray(n)&&!0===n[1]}function Om(n){return 0!=(8&n.flags)}function gd(n){return 2==(2&n.flags)}function md(n){return 1==(1&n.flags)}function va(n){return null!==n.template}function Eb(n){return 0!=(512&n[2])}function vc(n,e){return n.hasOwnProperty(Ml)?n[Ml]:null}class Fm{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ui(){return xb}function xb(n){return n.type.prototype.ngOnChanges&&(n.setInput=Vx),Bx}function Bx(){const n=st(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===dd)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function Vx(n,e,t,i){const r=st(n)||function(n,e){return n[Sh]=e}(n,{previous:dd,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new Fm(l&&l.currentValue,e,o===dd),n[i]=e}Ui.ngInherit=!0;const Sh="__ngSimpleChanges__";function st(n){return n[Sh]||null}let zi;function ar(n){return!!n.listen}const fu={createRenderer:(n,e)=>void 0!==zi?zi:"undefined"!=typeof document?document:void 0};function yr(n){for(;Array.isArray(n);)n=n[0];return n}function Ch(n,e){return yr(e[n])}function Xs(n,e){return yr(e[n.index])}function Bm(n,e){return n.data[e]}function _d(n,e){return n[e]}function Vs(n,e){const t=e[n];return zo(t)?t:t[0]}function Ol(n){return 4==(4&n[2])}function yd(n){return 128==(128&n[2])}function wa(n,e){return null==e?null:n[e]}function Vm(n){n[18]=0}function Qf(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Fn={lFrame:gu(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ab(){return Fn.bindingsEnabled}function Bt(){return Fn.lFrame.lView}function pi(){return Fn.lFrame.tView}function Mr(n){return Fn.lFrame.contextLView=n,n[8]}function is(){let n=jm();for(;null!==n&&64===n.type;)n=n.parent;return n}function jm(){return Fn.lFrame.currentTNode}function Ka(n,e){const t=Fn.lFrame;t.currentTNode=n,t.isParent=e}function Vr(){return Fn.lFrame.isParent}function hs(){Fn.lFrame.isParent=!1}function Ah(){return Fn.isInCheckNoChangesMode}function Jf(n){Fn.isInCheckNoChangesMode=n}function Es(){const n=Fn.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Ea(){return Fn.lFrame.bindingIndex++}function Ao(n){const e=Fn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function vd(n,e){const t=Fn.lFrame;t.bindingIndex=t.bindingRootIndex=n,Um(e)}function Um(n){Fn.lFrame.currentDirectiveIndex=n}function Mb(){return Fn.lFrame.currentQueryIndex}function Hm(n){Fn.lFrame.currentQueryIndex=n}function tp(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function bd(n,e,t){if(t&wn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&wn.Host||(r=tp(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Fn.lFrame=Ee();return i.currentTNode=e,i.lView=n,!0}function Ih(n){const e=Ee(),t=n[1];Fn.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Ee(){const n=Fn.lFrame,e=null===n?null:n.child;return null===e?gu(n):e}function gu(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Oh(){const n=Fn.lFrame;return Fn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Mo=Oh;function ai(){const n=Oh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Qs(){return Fn.lFrame.selectedIndex}function fo(n){Fn.lFrame.selectedIndex=n}function Dr(){const n=Fn.lFrame;return Bm(n.tView,n.selectedIndex)}function np(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function ip(n,e,t){Xa(n,e,3,t)}function rp(n,e,t,i){(3&n[2])===t&&Xa(n,e,t,i)}function Gm(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Xa(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(Jx(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function Jx(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Rh{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function sp(n,e,t){const i=ar(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];Wm(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Db(n){return 3===n||4===n||6===n}function Wm(n){return 64===n.charCodeAt(0)}function Ph(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||qm(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function qm(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function Ib(n){return-1!==n}function wd(n){return 32767&n}function Qa(n,e){let t=function(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let Ed=!0;function op(n){const e=Ed;return Ed=n,e}let Km=0;function js(n,e){const t=ap(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,Xm(i.data,n),Xm(e,null),Xm(i.blueprint,null));const r=Nh(n,e),s=n.injectorIndex;if(Ib(r)){const o=wd(r),a=Qa(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Xm(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ap(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Nh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function wc(n,e,t){!function(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(_h)&&(i=t[_h]),null==i&&(i=t[_h]=Km++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function Qm(n,e,t){if(t&wn.Optional)return n;mn(e,"NodeInjector")}function Rb(n,e,t,i){if(t&wn.Optional&&void 0===i&&(i=null),0==(t&(wn.Self|wn.Host))){const r=n[9],s=ma(void 0);try{return r?r.get(e,i,t&wn.Optional):ud(e,i,t&wn.Optional)}finally{ma(s)}}return Qm(i,e,t)}function Fh(n,e,t,i=wn.Default,r){if(null!==n){const s=function(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(_h)?n[_h]:void 0;return"number"==typeof e?e>=0?255&e:Nb:e}(t);if("function"==typeof s){if(!bd(e,n,i))return i&wn.Host?Qm(r,t,i):Rb(e,t,i,r);try{const o=s(i);if(null!=o||i&wn.Optional)return o;mn(t)}finally{Mo()}}else if("number"==typeof s){let o=null,a=ap(n,e),l=-1,c=i&wn.Host?e[16][6]:null;for((-1===a||i&wn.SkipSelf)&&(l=-1===a?Nh(n,e):e[a+8],-1!==l&&Lh(i,!1)?(o=e[1],a=wd(l),e=Qa(l,e)):a=-1);-1!==a;){const u=e[1];if(lp(s,a,u.data)){const h=Ss(a,e,t,o,i,c);if(h!==Pb)return h}l=e[a+8],-1!==l&&Lh(i,e[1].data[a+8]===c)&&lp(s,a,e)?(o=u,a=wd(l),e=Qa(l,e)):a=-1}}}return Rb(e,t,i,r)}const Pb={};function Nb(){return new $o(is(),Bt())}function Ss(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=Sd(a,o,t,null==i?gd(a)&&Ed:i!=o&&0!=(3&a.type),r&wn.Host&&s===a);return null!==u?Cd(e,o,u,a):Pb}function Sd(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,p=r?a+u:n.directiveEnd;for(let g=i?a:a+u;g<p;g++){const m=o[g];if(g<l&&t===m||g>=l&&m.type===t)return g}if(r){const g=o[l];if(g&&va(g)&&g.type===t)return l}return null}function Cd(n,e,t,i){let r=n[t];const s=e.data;if(function(n){return n instanceof Rh}(r)){const o=r;o.resolving&&function(n,e){throw new Ze("200",`Circular dependency in DI detected for ${n}`)}(Yt(s[t]));const a=op(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ma(o.injectImpl):null;bd(n,i,wn.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=xb(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&ma(l),op(a),o.resolving=!1,Mo()}}return r}function lp(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Lh(n,e){return!(n&wn.Self||n&wn.Host&&e)}class $o{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Fh(this._tNode,this._lView,e,void 0,t)}}function Gi(n){return Te(()=>{const e=n.prototype.constructor,t=e[Ml]||Cs(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Ml]||Cs(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Cs(n){return ke(n)?()=>{const e=Cs(ve(n));return e&&e()}:vc(n)}const Td="__parameters__";function xa(n,e,t){return Te(()=>{const i=function(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(Td)?l[Td]:Object.defineProperty(l,Td,{value:[]})[Td];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class zt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=$e({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function qo(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),qo(i,e)):e!==n&&e.push(i)}return e}function Yo(n,e){n.forEach(t=>Array.isArray(t)?Yo(t,e):e(t))}function Bh(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Pl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Sc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Do(n,e,t){let i=xs(n,e);return i>=0?n[1|i]=t:(i=~i,function(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function i_(n,e){const t=xs(n,e);if(t>=0)return n[1|t]}function xs(n,e){return function(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const wu={},fp="__NG_DI_FLAG__",xc="ngTempTokenPath",Tc=/\n/gm,el="__source",pp=Jt({provide:String,useValue:Jt});let Eu;function Dd(n){const e=Eu;return Eu=n,e}function g1(n,e=wn.Default){if(void 0===Eu)throw new Error("inject() must be called from an injection context");return null===Eu?ud(n,void 0,e):Eu.get(n,e&wn.Optional?null:void 0,e)}function De(n,e=wn.Default){return(co||g1)(ve(n),e)}const Ac=De;function Su(n){const e=[];for(let t=0;t<n.length;t++){const i=ve(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=wn.Default;for(let o=0;o<i.length;o++){const a=i[o],l=jb(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(De(r,s))}else e.push(De(i))}return e}function Id(n,e){return n[fp]=e,n.prototype[fp]=e,n}function jb(n){return n[fp]}function Zs(n,e,t,i){const r=n[xc];throw e[el]&&r.unshift(e[el]),n.message=function(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=it(e);if(Array.isArray(e))r=e.map(it).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):it(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Tc,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[xc]=null,n}const Od=Id(xa("Inject",n=>({token:n})),-1),Xr=Id(xa("Optional"),8),tl=Id(xa("SkipSelf"),4);function Us(n){return n instanceof class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}const b_="__ngContext__";function Ts(n,e){n[b_]=e}function w_(n){const e=function(n){return n[b_]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function Tp(n){return n.ngOriginalError}function V1(n,...e){n.error(...e)}class Zo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),r=function(n){return n&&n.ngErrorLogger||V1}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(n){return n.ngDebugContext}(e)||this._findContext(Tp(e)):null}_findOriginalError(e){let t=e&&Tp(e);for(;t&&Tp(t);)t=Tp(t);return t||null}}const p0=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ti))();function il(n){return n instanceof Function?n():n}var Ro=(()=>((Ro=Ro||{})[Ro.Important=1]="Important",Ro[Ro.DashCase=2]="DashCase",Ro))();function T_(n,e){return undefined(n,e)}function $h(n){const e=n[3];return Ho(e)?e[3]:e}function kd(n){return v0(n[13])}function M_(n){return v0(n[4])}function v0(n){for(;null!==n&&!Ho(n);)n=n[4];return n}function Bd(n,e,t,i,r){if(null!=i){let s,o=!1;Ho(i)?s=i:zo(i)&&(o=!0,i=i[0]);const a=yr(i);0===n&&null!==t?null==r?C0(e,t,a):rl(e,t,a,r||null,!0):1===n&&null!==t?rl(e,t,a,r||null,!0):2===n?function(n,e,t){const i=Dp(n,e);i&&function(n,e,t,i){ar(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function(n,e,t,i,r){const s=t[7];s!==yr(t)&&Bd(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Vd(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function I_(n,e,t){return ar(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function w0(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Qf(r,-1)),t.splice(i,1)}function O_(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&w0(r,i),e>0&&(n[t-1][4]=i[4]);const s=Pl(n,10+e);!function(n,e){Vd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function R_(n,e){if(!(256&e[2])){const t=e[11];ar(t)&&t.destroyNode&&Vd(n,e,t,3,null,null),function(n){let e=n[13];if(!e)return Mp(n[1],n);for(;e;){let t=null;if(zo(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)zo(e)&&Mp(e[1],e),e=e[3];null===e&&(e=n),zo(e)&&Mp(e[1],e),t=e&&e[4]}e=t}}(e)}}function Mp(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Rh)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):yr(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&ar(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Ho(e[3])){t!==e[3]&&w0(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function E0(n,e,t){return function(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===$t.None||r===$t.Emulated)return null}return Xs(i,t)}(n,e.parent,t)}function rl(n,e,t,i,r){ar(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function C0(n,e,t){ar(n)?n.appendChild(e,t):e.appendChild(t)}function x0(n,e,t,i,r){null!==i?rl(n,e,t,i,r):C0(n,e,t)}function Dp(n,e){return ar(n)?n.parentNode(e):e.parentNode}function T0(n,e,t){return M0(n,e,t)}let M0=function(n,e,t){return 40&n.type?Xs(n,t):null};function Ip(n,e,t,i){const r=E0(n,i,e),s=e[11],a=T0(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)x0(s,r,t[l],a,!1);else x0(s,r,t,a,!1)}function Au(n,e){if(null!==e){const t=e.type;if(3&t)return Xs(e,n);if(4&t)return Op(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Au(n,i);{const r=n[e.index];return Ho(r)?Op(-1,r):yr(r)}}if(32&t)return T_(e,n)()||yr(n[e.index]);{const i=I0(n,e);return null!==i?Array.isArray(i)?i[0]:Au($h(n[16]),i):Au(n,e.next)}}return null}function I0(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Op(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Au(i,r)}return e[7]}function Wh(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Ts(yr(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)Wh(n,e,t.child,i,r,s,!1),Bd(e,n,r,a,s);else if(32&l){const c=T_(t,i);let u;for(;u=c();)Bd(e,n,r,u,s);Bd(e,n,r,a,s)}else 16&l?F_(n,e,i,t,r,s):Bd(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Vd(n,e,t,i,r,s){Wh(t,i,n.firstChild,e,r,s,!1)}function F_(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Bd(e,n,r,l[c],s);else Wh(n,e,l,o[3],r,s,!0)}function P0(n,e,t){ar(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function L_(n,e,t){ar(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function qh(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const N0="ng-template";function uT(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==qh(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Rp(n){return 4===n.type&&n.value!==N0}function F0(n,e,t){return e===(4!==n.type||t?n.value:N0)}function dT(n,e,t){let i=4;const r=n.attrs||[],s=function(n){for(let e=0;e<n.length;e++)if(Db(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!F0(n,l,t)||""===l&&1===e.length){if(Aa(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!uT(n.attrs,c,t)){if(Aa(i))return!1;o=!0}continue}const h=hT(8&i?"class":l,r,Rp(n),t);if(-1===h){if(Aa(i))return!1;o=!0;continue}if(""!==c){let p;p=h>s?"":r[h+1].toLowerCase();const g=8&i?p:null;if(g&&-1!==qh(g,c,0)||2&i&&c!==p){if(Aa(i))return!1;o=!0}}}}else{if(!o&&!Aa(i)&&!Aa(l))return!1;if(o&&Aa(l))continue;o=!1,i=l|1&i}}return Aa(i)||o}function Aa(n){return 0==(1&n)}function hT(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function L0(n,e,t=!1){for(let i=0;i<e.length;i++)if(dT(n,e[i],t))return!0;return!1}function mT(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function k0(n,e){return n?":not("+e.trim()+")":e}function _T(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Aa(o)&&(e+=k0(s,r),r=""),i=o,s=s||!Aa(i);t++}return""!==r&&(e+=k0(s,r)),e}const An={};function Kt(n){B0(pi(),Bt(),Qs()+n,Ah())}function B0(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&ip(e,s,t)}else{const s=n.preOrderHooks;null!==s&&rp(e,s,0,t)}fo(t)}function sl(n,e){return n<<17|e<<2}function Dn(n){return n>>17&32767}function vr(n){return 2|n}function Bl(n){return(131068&n)>>2}function ol(n,e){return-131069&n|e<<2}function B_(n){return 1|n}function q0(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];Hm(r),o.contentQueries(2,e[s],s)}}}function Kh(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,Vm(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function Ud(n,e,t,i,r){let s=n.data[e];if(null===s)s=function(n,e,t,i,r){const s=jm(),o=Vr(),l=n.data[e]=function(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),Fn.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function(){const n=Fn.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Ka(s,!0),s}function zd(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Xh(n,e,t){Ih(e);try{const i=n.viewQuery;null!==i&&ey(1,i,t);const r=n.template;null!==r&&Y0(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&q0(n,e),n.staticViewQueries&&ey(2,n.viewQuery,t);const s=n.components;null!==s&&function(n,e){for(let t=0;t<e.length;t++)qT(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,ai()}}function Hd(n,e,t,i){const r=e[2];if(256==(256&r))return;Ih(e);const s=Ah();try{Vm(e),function(n){Fn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Y0(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&ip(e,c,null)}else{const c=n.preOrderHooks;null!==c&&rp(e,c,0,null),Gm(e,0)}if(function(n){for(let e=kd(n);null!==e;e=M_(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&Qf(s,1),r[2]|=1024}}}(e),function(n){for(let e=kd(n);null!==e;e=M_(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];yd(i)&&Hd(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&q0(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&ip(e,c)}else{const c=n.contentHooks;null!==c&&rp(e,c,1),Gm(e,1)}!function(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)fo(~r);else{const s=r,o=t[++i],a=t[++i];vd(o,s),a(2,e[s])}}}finally{fo(-1)}}(n,e);const a=n.components;null!==a&&function(n,e){for(let t=0;t<e.length;t++)WT(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&ey(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&ip(e,c)}else{const c=n.viewHooks;null!==c&&rp(e,c,2),Gm(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Qf(e[3],-1))}finally{ai()}}function IT(n,e,t,i){const r=e[10],s=!Ah(),o=Ol(e);try{s&&!o&&r.begin&&r.begin(),o&&Xh(n,e,i),Hd(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function Y0(n,e,t,i,r){const s=Qs(),o=2&i;try{fo(-1),o&&e.length>20&&B0(n,e,20,Ah()),t(i,r)}finally{fo(s)}}function Qh(n,e,t){!Ab()||(function(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||js(t,e),Ts(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=va(l);c&&UT(e,t,l);const u=Cd(e,n,a,t);Ts(u,e),null!==o&&zT(0,a-r,u,l,0,o),c&&(Vs(t.index,e)[8]=u)}}(n,e,t,Xs(t,e)),128==(128&t.flags)&&function(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=Fn.lFrame.currentDirectiveIndex;try{fo(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];Um(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&rw(c,u)}}finally{fo(-1),Um(a)}}(n,e,t))}function $_(n,e,t=Xs){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Lp(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=kp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function kp(n,e,t,i,r,s,o,a,l,c){const u=20+i,h=u+r,p=function(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:An);return t}(u,h),g="function"==typeof c?c():c;return p[1]={type:n,blueprint:p,template:t,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:g,incompleteFirstPass:!1}}function Q0(n,e,t,i){const r=lw(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Vp(n).push(i,r.length-1))}function Z0(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function Po(n,e,t,i,r,s,o,a){const l=Xs(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(cw(n,t,u,i,r),gd(e)&&function(n,e){const t=Vs(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,ar(s)?s.setProperty(l,i,r):Wm(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function W_(n,e,t,i){let r=!1;if(Ab()){const s=function(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];L0(t,o.selectors,!1)&&(r||(r=[]),wc(js(t,e),n,o.type),va(o)?(sw(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,q_(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=zd(n,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=Ph(t.mergedAttrs,h.hostAttrs),Y_(n,t,e,c,h),jT(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const p=h.type.prototype;!a&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],h=u.inputs,p=null===s||Rp(e)?null:HT(h,s);o.push(p),a=Z0(h,c,a),l=Z0(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Ze("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Ph(t.mergedAttrs,t.attrs),r}function iw(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function rw(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function sw(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function jT(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;va(e)&&(t[""]=n)}}function q_(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Y_(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=vc(r.type)),o=new Rh(s,va(r),null);n.blueprint[i]=o,t[i]=o,iw(n,e,0,i,zd(n,t,r.hostVars,An),r)}function UT(n,e,t){const i=Xs(e,n),r=Lp(t),s=n[10],o=Bp(n,Kh(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function ll(n,e,t,i,r,s){const o=Xs(n,e);!function(n,e,t,i,r,s,o){if(null==s)ar(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Tt(s):o(s,i||"",r);ar(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function zT(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?i.setInput(t,h,c,u):t[u]=h}}}function HT(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function ow(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function WT(n,e){const t=Vs(e,n);if(yd(t)){const i=t[1];80&t[2]?Hd(i,t,i.template,t[8]):t[5]>0&&X_(t)}}function X_(n){for(let i=kd(n);null!==i;i=M_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Hd(o,s,o.template,s[8])}else s[5]>0&&X_(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Vs(t[i],n);yd(r)&&r[5]>0&&X_(r)}}function qT(n,e){const t=Vs(e,n),i=t[1];(function(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),Xh(i,t,t[8])}function Bp(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function Q_(n){for(;n;){n[2]|=64;const e=$h(n);if(Eb(n)&&!e)return n;n=e}return null}function J_(n,e,t){const i=e[10];i.begin&&i.begin();try{Hd(n,e,n.template,t)}catch(r){throw ny(e,r),r}finally{i.end&&i.end()}}function aw(n){!function(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=w_(t),r=i[1];IT(r,i,r.template,t)}}(n[8])}function ey(n,e,t){Hm(0),e(n,t)}const JT=(()=>Promise.resolve(null))();function lw(n){return n[7]||(n[7]=[])}function Vp(n){return n.cleanup||(n.cleanup=[])}function ny(n,e){const t=n[9],i=t?t.get(Zo,null):null;i&&i.handleError(e)}function cw(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Vl(n,e,t){const i=Ch(e,n);!function(n,e,t){ar(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function jp(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=ot(r,a):2==s&&(i=ot(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const $d=new zt("INJECTOR",-1);class to{get(e,t=wu){if(t===wu){const i=new Error(`NullInjectorError: No provider for ${it(e)}!`);throw i.name="NullInjectorError",i}return t}}const Mu=new zt("Set Injector scope."),Zh={},tA={};let ry;function uw(){return void 0===ry&&(ry=new to),ry}function dw(n,e=null,t=null,i){return new oy(n,t,e||uw(),i)}class oy{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Yo(t,a=>this.processProvider(a,e,t)),Yo([e],a=>this.processInjectorType(a,[],s)),this.records.set($d,Du(void 0,this));const o=this.records.get(Mu);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:it(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=wu,i=wn.Default){this.assertNotDestroyed();const r=Dd(this),s=ma(void 0);try{if(!(i&wn.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function(n){return"function"==typeof n||"object"==typeof n&&n instanceof zt}(e)&&_n(e);a=l&&this.injectableDefInScope(l)?Du(ay(e),Zh):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&wn.Self?uw():this.parent).get(e,t=i&wn.Optional&&t===wu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[xc]=o[xc]||[]).unshift(it(e)),r)throw o;return Zs(o,e,"R3InjectorError",this.source)}throw o}finally{ma(s),Dd(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(it(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=ve(e)))return!1;let r=Tl(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Tl(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{Yo(r.imports,h=>{this.processInjectorType(h,t,i)&&(void 0===u&&(u=[]),u.push(h))})}finally{}if(void 0!==u)for(let h=0;h<u.length;h++){const{ngModule:p,providers:g}=u[h];Yo(g,m=>this.processProvider(m,p,g||Xi))}}this.injectorDefTypes.add(o);const l=vc(o)||(()=>new o);this.records.set(o,Du(l,Zh));const c=r.providers;if(null!=c&&!a){const u=e;Yo(c,h=>this.processProvider(h,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=Rc(e=ve(e))?e:ve(e&&e.provide);const s=function(n,e,t){return fw(n)?Du(void 0,n.useValue):Du(hw(n),Zh)}(e);if(Rc(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Du(void 0,Zh,!0),o.factory=()=>Su(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===Zh&&(t.value=tA,t.value=t.factory()),"object"==typeof t.value&&t.value&&function(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ve(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function ay(n){const e=_n(n),t=null!==e?e.factory:vc(n);if(null!==t)return t;if(n instanceof zt)throw new Error(`Token ${it(n)} is missing a \u0275prov definition.`);if(n instanceof Function)return function(n){const e=n.length;if(e>0){const i=Sc(e,"?");throw new Error(`Can't resolve all parameters for ${it(n)}: (${i.join(", ")}).`)}const t=function(n){const e=n&&(n[lo]||n[Ls]);if(e){const t=function(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Error("unreachable")}function hw(n,e,t){let i;if(Rc(n)){const r=ve(n);return vc(r)||ay(r)}if(fw(n))i=()=>ve(n.useValue);else if(function(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Su(n.deps||[]));else if(function(n){return!(!n||!n.useExisting)}(n))i=()=>De(ve(n.useExisting));else{const r=ve(n&&(n.useClass||n.provide));if(!function(n){return!!n.deps}(n))return vc(r)||ay(r);i=()=>new r(...Su(n.deps))}return i}function Du(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function fw(n){return null!==n&&"object"==typeof n&&pp in n}function Rc(n){return"function"==typeof n}const pw=function(n,e,t){return function(n,e=null,t=null,i){const r=dw(n,e,t,i);return r._resolveInjectorDefTypes(),r}({name:t},e,n,t)};class jn{static create(e,t){return Array.isArray(e)?pw(e,t,""):pw(e.providers,e.parent,e.name||"")}}function WW(n,e){np(w_(n)[1],is())}function In(n){let e=function(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(va(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=gA(n.inputs),o.declaredInputs=gA(n.declaredInputs),o.outputs=gA(n.outputs);const a=r.hostBindings;a&&XW(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&YW(n,l),c&&KW(n,c),Wa(n.inputs,r.inputs),Wa(n.declaredInputs,r.declaredInputs),Wa(n.outputs,r.outputs),va(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===In&&(t=!1)}}e=Object.getPrototypeOf(e)}!function(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Ph(r.hostAttrs,t=Ph(t,r.hostAttrs))}}(i)}function gA(n){return n===dd?{}:n===Xi?[]:n}function YW(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function KW(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function XW(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}jn.THROW_IF_NOT_FOUND=wu,jn.NULL=new to,jn.\u0275prov=$e({token:jn,providedIn:"any",factory:()=>De($d)}),jn.__NG_ELEMENT_ID__=-1;let vw=null;function Up(){if(!vw){const n=ti.Symbol;if(n&&n.iterator)vw=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(vw=i)}}}return vw}class Ul{constructor(e){this.wrapped=e}static wrap(e){return new Ul(e)}static unwrap(e){return Ul.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof Ul}}function hy(n){return!!mA(n)&&(Array.isArray(n)||!(n instanceof Map)&&Up()in n)}function mA(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Nc(n,e,t){return n[e]=t}function _o(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function $i(n,e,t,i){const r=Bt();return _o(r,Ea(),e)&&(pi(),ll(Dr(),r,n,e,t,i)),$i}function Ei(n,e,t,i,r,s,o,a){const l=Bt(),c=pi(),u=n+20,h=c.firstCreatePass?function(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Ud(e,n,4,o||null,wa(c,a));W_(e,t,u,wa(c,l)),np(e,u);const h=u.tViews=kp(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Ka(h,!1);const p=l[11].createComment("");Ip(c,l,p,h),Ts(p,l),Bp(l,l[u]=ow(p,l,p,h)),md(h)&&Qh(c,l,h),null!=o&&$_(l,h,a)}function Qp(n){return _d(Fn.lFrame.contextLView,20+n)}function Me(n,e=wn.Default){const t=Bt();return null===t?De(n,e):Fh(is(),t,ve(n),e)}function on(n,e,t){const i=Bt();return _o(i,Ea(),e)&&Po(pi(),Dr(),i,n,e,i[11],t,!1),on}function wA(n,e,t,i,r){const o=r?"class":"style";cw(n,t,e.inputs[o],o,i)}function Nt(n,e,t,i){const r=Bt(),s=pi(),o=20+n,a=r[11],l=r[o]=I_(a,e,Fn.lFrame.currentNamespace),c=s.firstCreatePass?function(n,e,t,i,r,s,o){const a=e.consts,c=Ud(e,n,2,r,wa(a,s));return W_(e,t,c,wa(a,o)),null!==c.attrs&&jp(c,c.attrs,!1),null!==c.mergedAttrs&&jp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Ka(c,!0);const u=c.mergedAttrs;null!==u&&sp(a,l,u);const h=c.classes;null!==h&&L_(a,l,h);const p=c.styles;null!==p&&P0(a,l,p),64!=(64&c.flags)&&Ip(s,r,l,c),0===Fn.lFrame.elementDepthCount&&Ts(l,r),Fn.lFrame.elementDepthCount++,md(c)&&(Qh(s,r,c),function(n,e,t){if(Om(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}(s,c,r)),null!==i&&$_(r,c)}function Ft(){let n=is();Vr()?hs():(n=n.parent,Ka(n,!1));const e=n;Fn.lFrame.elementDepthCount--;const t=pi();t.firstCreatePass&&(np(t,n),Om(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function(n){return 0!=(16&n.flags)}(e)&&wA(t,e,Bt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(n){return 0!=(32&n.flags)}(e)&&wA(t,e,Bt(),e.stylesWithoutHost,!1)}function xi(n,e,t,i){Nt(n,e,t,i),Ft()}function zl(){return Bt()}function py(n){return!!n&&"function"==typeof n.then}function JF(n){return!!n&&"function"==typeof n.subscribe}const Ew=JF;function Bn(n,e,t,i){const r=Bt(),s=pi(),o=is();return function(n,e,t,i,r,s,o,a){const l=md(i),u=n.firstCreatePass&&Vp(n),h=e[8],p=lw(e);let g=!0;if(3&i.type||a){const C=Xs(i,e),R=a?a(C):C,z=p.length,de=a?Ie=>a(yr(Ie[i.index])):i.index;if(ar(t)){let Ie=null;if(!a&&l&&(Ie=function(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==Ie)(Ie.__ngLastListenerFn__||Ie).__ngNextListenerFn__=s,Ie.__ngLastListenerFn__=s,g=!1;else{s=EA(i,e,h,s,!1);const Be=t.listen(R,r,s);p.push(s,Be),u&&u.push(r,de,z,z+1)}}else s=EA(i,e,h,s,!0),R.addEventListener(r,s,o),p.push(s),u&&u.push(r,de,z,o)}else s=EA(i,e,h,s,!1);const m=i.outputs;let E;if(g&&null!==m&&(E=m[r])){const C=E.length;if(C)for(let R=0;R<C;R+=2){const Ne=e[E[R]][E[R+1]].subscribe(s),ct=p.length;p.push(s,Ne),u&&u.push(r,i.index,ct,-(ct+1))}}}(s,r,r[11],o,n,e,!!t,i),Bn}function t2(n,e,t,i){try{return!1!==t(i)}catch(r){return ny(n,r),!1}}function EA(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Vs(n.index,e):e;0==(32&e[2])&&Q_(a);let l=t2(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=t2(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Si(n=1){return function(n){return(Fn.lFrame.contextLView=function(n,e){for(;n>0;)e=e[15],n--;return e}(n,Fn.lFrame.contextLView))[8]}(n)}function I7(n,e){let t=null;const i=function(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?L0(n,s,!0):mT(i,s))return r}else t=r}return t}function d2(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Dn(s):Bl(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];P7(n[a],e)&&(l=!0,n[a+1]=i?B_(u):vr(u)),a=i?Dn(u):Bl(u)}l&&(n[t+1]=i?vr(s):B_(s))}function P7(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&xs(n,e)>=0}const Ms={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function h2(n){return n.substring(Ms.key,Ms.keyEnd)}function f2(n,e){const t=Ms.textEnd;return t===e?-1:(e=Ms.keyEnd=function(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,Ms.key=e,t),tg(n,e,t))}function tg(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Ti(n,e){return function(n,e,t,i){const r=Bt(),s=pi(),o=Ao(2);s.firstUpdatePass&&v2(s,n,o,i),e!==An&&_o(r,o,e)&&w2(s,s.data[Qs()],r,r[11],n,r[o+1]=function(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=it(Us(n)))),n}(e,t),i,o)}(n,e,null,!0),Ti}function Fc(n){!function(n,e,t,i){const r=pi(),s=Ao(2);r.firstUpdatePass&&v2(r,null,s,i);const o=Bt();if(t!==An&&_o(o,s,t)){const a=r.data[Qs()];if(S2(a,i)&&!y2(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=ot(l,t||"")),wA(r,a,o,t,i)}else!function(n,e,t,i,r,s,o,a){r===An&&(r=Xi);let l=0,c=0,u=0<r.length?r[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const p=l<r.length?r[l+1]:void 0,g=c<s.length?s[c+1]:void 0;let E,m=null;u===h?(l+=2,c+=2,p!==g&&(m=h,E=g)):null===h||null!==u&&u<h?(l+=2,m=u):(c+=2,m=h,E=g),null!==m&&w2(n,e,t,i,m,E,o,a),u=l<r.length?r[l]:null,h=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function(n,e,t){if(null==t||""===t)return Xi;const i=[],r=Us(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(Do,Lc,n,!0)}function Lc(n,e){for(let t=function(n){return function(n){Ms.key=0,Ms.keyEnd=0,Ms.value=0,Ms.valueEnd=0,Ms.textEnd=n.length}(n),f2(n,tg(n,0,Ms.textEnd))}(e);t>=0;t=f2(e,t))Do(n,h2(e),!0)}function y2(n,e){return e>=n.expandoStartIndex}function v2(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Qs()],o=y2(n,t);S2(s,i)&&null===e&&!o&&(e=!1),e=function(n,e,t,i){const r=function(n){const e=Fn.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=my(t=CA(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=CA(r,n,e,t,i),null===s){let l=function(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Bl(i))return n[Dn(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=CA(null,n,e,l[1],i),l=my(l,e.attrs,i),function(n,e,t,i){n[Dn(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=my(i,n[s].hostAttrs,t);return my(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Dn(o),l=Bl(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||xs(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const p=Dn(n[a+1]);n[i+1]=sl(p,a),0!==p&&(n[p+1]=ol(n[p+1],i)),n[a+1]=function(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=sl(a,0),0!==a&&(n[a+1]=ol(n[a+1],i)),a=i;else n[i+1]=sl(l,0),0===a?a=i:n[l+1]=ol(n[l+1],i),l=i;c&&(n[i+1]=vr(n[i+1])),d2(n,u,i,!0),d2(n,u,i,!1),function(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&xs(s,e)>=0&&(t[i+1]=B_(t[i+1]))}(e,u,n,i,s),o=sl(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function CA(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=my(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function my(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Do(n,o,!!t||e[++s]))}return void 0===n?null:n}function w2(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];xw(function(n){return 1==(1&n)}(c)?E2(l,e,t,r,Bl(c),o):void 0)||(xw(s)||function(n){return 2==(2&n)}(c)&&(s=E2(l,null,t,r,a,o)),function(n,e,t,i,r){const s=ar(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Ro.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Ro.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,Ch(Qs(),t),r,s))}function E2(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let p=t[r+1];p===An&&(p=h?Xi:void 0);let g=h?i_(p,i):u===i?p:void 0;if(c&&!xw(g)&&(g=i_(l,i)),xw(g)&&(a=g,o))return a;const m=n[r+1];r=o?Dn(m):Bl(m)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=i_(l,i))}return a}function xw(n){return void 0!==n}function S2(n,e){return 0!=(n.flags&(e?16:32))}function Ai(n,e=""){const t=Bt(),i=pi(),r=n+20,s=i.firstCreatePass?Ud(i,r,1,e,null):i.data[r],o=t[r]=function(n,e){return ar(n)?n.createText(e):n.createTextNode(e)}(t[11],e);Ip(i,t,o,s),Ka(s,!1)}function Ds(n){return kc("",n,""),Ds}function kc(n,e,t){const i=Bt(),r=function(n,e,t,i){return _o(n,Ea(),t)?e+Tt(t)+i:An}(i,n,e,t);return r!==An&&Vl(i,Qs(),r),kc}function Iu(n,e,t){const i=Bt();return _o(i,Ea(),e)&&Po(pi(),Dr(),i,n,e,i[11],t,!0),Iu}const ef=void 0;var f9=["en",[["a","p"],["AM","PM"],ef],[["AM","PM"],ef,ef],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ef,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ef,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ef,"{1} 'at' {0}",ef],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(n){const e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===t?1:5}];let ng={};function U2(n){return n in ng||(ng[n]=ti.ng&&ti.ng.common&&ti.ng.common.locales&&ti.ng.common.locales[n]),ng[n]}var cn=(()=>((cn=cn||{})[cn.LocaleId=0]="LocaleId",cn[cn.DayPeriodsFormat=1]="DayPeriodsFormat",cn[cn.DayPeriodsStandalone=2]="DayPeriodsStandalone",cn[cn.DaysFormat=3]="DaysFormat",cn[cn.DaysStandalone=4]="DaysStandalone",cn[cn.MonthsFormat=5]="MonthsFormat",cn[cn.MonthsStandalone=6]="MonthsStandalone",cn[cn.Eras=7]="Eras",cn[cn.FirstDayOfWeek=8]="FirstDayOfWeek",cn[cn.WeekendRange=9]="WeekendRange",cn[cn.DateFormat=10]="DateFormat",cn[cn.TimeFormat=11]="TimeFormat",cn[cn.DateTimeFormat=12]="DateTimeFormat",cn[cn.NumberSymbols=13]="NumberSymbols",cn[cn.NumberFormats=14]="NumberFormats",cn[cn.CurrencyCode=15]="CurrencyCode",cn[cn.CurrencySymbol=16]="CurrencySymbol",cn[cn.CurrencyName=17]="CurrencyName",cn[cn.Currencies=18]="Currencies",cn[cn.Directionality=19]="Directionality",cn[cn.PluralCase=20]="PluralCase",cn[cn.ExtraData=21]="ExtraData",cn))();const Aw="en-US";let z2=Aw;function TA(n){Z(n,"Expected localeId to be defined"),"string"==typeof n&&(z2=n.toLowerCase().replace(/_/g,"-"))}function DA(n,e,t,i,r){if(n=ve(n),Array.isArray(n))for(let s=0;s<n.length;s++)DA(n[s],e,t,i,r);else{const s=pi(),o=Bt();let a=Rc(n)?n:ve(n.provide),l=hw(n);const c=is(),u=1048575&c.providerIndexes,h=c.directiveStart,p=c.providerIndexes>>20;if(Rc(n)||!n.multi){const g=new Rh(l,r,Me),m=OA(a,e,r?u:u+p,h);-1===m?(wc(js(c,o),s,a),IA(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(g),o.push(g)):(t[m]=g,o[m]=g)}else{const g=OA(a,e,u+p,h),m=OA(a,e,u,u+p),E=g>=0&&t[g],C=m>=0&&t[m];if(r&&!C||!r&&!E){wc(js(c,o),s,a);const R=function(n,e,t,i,r){const s=new Rh(n,t,Me);return s.multi=[],s.index=e,s.componentProviders=0,hL(s,r,i&&!t),s}(r?uq:cq,t.length,r,i,l);!r&&C&&(t[m].providerFactory=R),IA(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(R),o.push(R)}else IA(s,n,g>-1?g:m,hL(t[r?m:g],l,!r&&i));!r&&i&&C&&t[m].componentProviders++}}}function IA(n,e,t,i){const r=Rc(e);if(r||function(n){return!!n.useClass}(e)){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const a=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const l=a.indexOf(t);-1===l?a.push(t,[i,o]):a[l+1].push(i,o)}else a.push(t,o)}}}function hL(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function OA(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function cq(n,e,t,i){return RA(this.multi,[])}function uq(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Cd(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),RA(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],RA(r,s);return s}function RA(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Yn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function(n,e,t){const i=pi();if(i.firstCreatePass){const r=va(n);DA(t,i.data,i.blueprint,r,!0),DA(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class fL{}const gL="ngComponent";class fq{resolveComponentFactory(e){throw function(n){const e=Error(`No component factory found for ${it(n)}. Did you add it to @NgModule.entryComponents?`);return e[gL]=n,e}(e)}}class dl{}function Rw(...n){}function rg(n,e){return new En(Xs(n,e))}dl.NULL=new fq;const mq=function(){return rg(is(),Bt())};let En=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=mq,n})();function mL(n){return n instanceof En?n.nativeElement:n}class tf{}let NA=(()=>{class n{}return n.\u0275prov=$e({token:n,providedIn:"root",factory:()=>null}),n})();class Ru{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const _L=new Ru("12.2.5");class yL{constructor(){}supports(e){return hy(e)}create(e){return new Eq(e)}}const wq=(n,e)=>e;class Eq{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||wq}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<bL(i,r,s)?t:i,a=bL(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let p=0;p<c;p++){const g=p<s.length?s[p]:s[p]=0,m=g+p;u<=m&&m<c&&(s[p]=g+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!hy(e))throw new Error(`Error trying to diff '${it(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Up()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new Sq(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new vL),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new vL),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Sq{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Cq{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class vL{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Cq,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function bL(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class wL{constructor(){}supports(e){return e instanceof Map||mA(e)}create(){return new xq}}class xq{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||mA(e)))throw new Error(`Error trying to diff '${it(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new Tq(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class Tq{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function EL(){return new sg([new yL])}let sg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||EL()),deps:[[n,new tl,new Xr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'`)}}return n.\u0275prov=$e({token:n,providedIn:"root",factory:EL}),n})();function SL(){return new og([new wL])}let og=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||SL()),deps:[[n,new tl,new Xr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return n.\u0275prov=$e({token:n,providedIn:"root",factory:SL}),n})();function Pw(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(yr(s)),Ho(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Pw(l[1],l,c,i)}const o=t.type;if(8&o)Pw(n,e,t.child,i);else if(32&o){const a=T_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=I0(e,t);if(Array.isArray(a))i.push(...a);else{const l=$h(e[16]);Pw(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class wy{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Pw(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Ho(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(O_(e,i),Pl(t,i))}this._attachedToViewContainer=!1}R_(this._lView[1],this._lView)}onDestroy(e){Q0(this._lView[1],this._lView,null,e)}markForCheck(){Q_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){J_(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(n,e,t){Jf(!0);try{J_(n,e,t)}finally{Jf(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(n,e){Vd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class Mq extends wy{constructor(e){super(e),this._view=e}detectChanges(){aw(this._view)}checkNoChanges(){!function(n){Jf(!0);try{aw(n)}finally{Jf(!1)}}(this._view)}get context(){return null}}const Iq=function(n){return function(n,e,t){if(gd(n)&&!t){const i=Vs(n.index,e);return new wy(i,i)}return 47&n.type?new wy(e[16],e):null}(is(),Bt(),16==(16&n))};let ss=(()=>{class n{}return n.__NG_ELEMENT_ID__=Iq,n})();const Pq=[new wL],Fq=new sg([new yL]),Lq=new og(Pq),Bq=function(){return Nw(is(),Bt())};let Fo=(()=>{class n{}return n.__NG_ELEMENT_ID__=Bq,n})();const Vq=Fo,jq=class extends Vq{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Kh(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),Xh(t,i,e),new wy(i)}};function Nw(n,e){return 4&n.type?new jq(e,n,rg(n,e)):null}class Bc{}const Hq=function(){return AL(is(),Bt())};let Is=(()=>{class n{}return n.__NG_ELEMENT_ID__=Hq,n})();const $q=Is,xL=class extends $q{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return rg(this._hostTNode,this._hostLView)}get injector(){return new $o(this._hostTNode,this._hostLView)}get parentInjector(){const e=Nh(this._hostTNode,this._hostLView);if(Ib(e)){const t=Qa(e,this._hostLView),i=wd(e);return new $o(t[1].data[i+8],t)}return new $o(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=TL(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=i||this.parentInjector;if(!s&&null==e.ngModule&&o){const l=o.get(Bc,null);l&&(s=l)}const a=e.create(o,r,void 0,s);return this.insert(a.hostView,t),a}insert(e,t){const i=e._lView,r=i[1];if(function(n){return Ho(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=i[3],p=new xL(h,h[6],h[3]);p.detach(p.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Bh(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Op(s,o),l=i[11],c=Dp(l,o[7]);return null!==c&&function(n,e,t,i,r,s){i[0]=r,i[6]=e,Vd(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Bh(FA(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=TL(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=O_(this._lContainer,t);i&&(Pl(FA(this._lContainer),t),R_(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=O_(this._lContainer,t);return i&&null!=Pl(FA(this._lContainer),t)?new wy(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function TL(n){return n[8]}function FA(n){return n[8]||(n[8]=[])}function AL(n,e){let t;const i=e[n.index];if(Ho(i))t=i;else{let r;if(8&n.type)r=yr(i);else{const s=e[11];r=s.createComment("");const o=Xs(n,e);rl(s,Dp(s,o),r,function(n,e){return ar(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=ow(i,e,r,n),Bp(e,t)}return new xL(t,n,e)}const ug={};class qL extends dl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ni(e);return new KL(t,this.ngModule)}}function YL(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const UY=new zt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>p0});class KL extends fL{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function(n){return n.map(_T).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return YL(this.componentDef.inputs)}get outputs(){return YL(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function(n,e){return{get:(t,i,r)=>{const s=n.get(t,ug,r);return s!==ug||i===ug?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(tf,fu),a=s.get(NA,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function(n,e,t){if(ar(n))return n.selectRootElement(e,t===$t.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):I_(o.createRenderer(null,this.componentDef),c,function(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),h=this.componentDef.onPush?576:528,p=function(n,e){return{components:[],scheduler:n||p0,clean:JT,playerHandler:e||null,flags:0}}(),g=kp(0,null,null,1,0,null,null,null,null,null),m=Kh(null,g,p,h,null,null,o,l,a,s);let E,C;Ih(m);try{const R=function(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=Ud(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(jp(l,c,!0),null!==n&&(sp(r,n,c),null!==l.classes&&L_(r,n,l.classes),null!==l.styles&&P0(r,n,l.styles)));const u=i.createRenderer(n,e),h=Kh(t,Lp(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(wc(js(l,t),o,e.type),sw(o,l),q_(l,t.length,1)),Bp(t,h),t[20]=h}(u,this.componentDef,m,o,l);if(u)if(i)sp(l,u,["ng-version",_L.full]);else{const{attrs:z,classes:de}=function(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Aa(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);z&&sp(l,u,z),de&&de.length>0&&L_(l,u,de.join(" "))}if(C=Bm(g,20),void 0!==t){const z=C.projection=[];for(let de=0;de<this.ngContentSelectors.length;de++){const Ie=t[de];z.push(null!=Ie?Array.from(Ie):null)}}E=function(n,e,t,i,r){const s=t[1],o=function(n,e,t){const i=is();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),Y_(n,i,e,zd(n,e,1,null),t));const r=Cd(e,n,i.directiveStart,i);Ts(r,e);const s=Xs(i,e);return s&&Ts(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=is();e.contentQueries(1,o,l.directiveStart)}const a=is();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(fo(a.index),iw(t[1],a,0,a.directiveStart,a.directiveEnd,e),rw(e,o)),o}(R,this.componentDef,m,p,[WW]),Xh(g,m,null)}finally{ai()}return new GY(this.componentType,E,rg(C,m),m,C)}}class GY extends class{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new Mq(r),this.componentType=e}get injector(){return new $o(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const dg=new Map;class qY extends Bc{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new qL(this);const i=xo(e),r=function(n){return n[Ix]||null}(e);r&&TA(r),this._bootstrapComponents=il(i.bootstrap),this._r3Injector=dw(e,t,[{provide:Bc,useValue:this},{provide:dl,useValue:this.componentFactoryResolver}],it(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=jn.THROW_IF_NOT_FOUND,i=wn.Default){return e===jn||e===Bc||e===$d?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class YA extends class{}{constructor(e){super(),this.moduleType=e,null!==xo(e)&&function(n){const e=new Set;!function t(i){const r=xo(i,!0),s=r.id;null!==s&&(function(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${it(e)} vs ${it(e.name)}`)}(s,dg.get(s),i),dg.set(s,i));const o=il(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new qY(this.moduleType,e)}}function Vw(n,e,t){const i=Es()+n,r=Bt();return r[i]===An?Nc(r,i,t?e.call(t):e()):function(n,e){return n[e]}(r,i)}function JL(n,e,t,i,r,s){const o=e+t;return _o(n,o,r)?Nc(n,o+1,s?i.call(s,r):i(r)):function(n,e){const t=n[e];return t===An?void 0:t}(n,o+1)}function pl(n,e){const t=pi();let i;const r=n+20;t.firstCreatePass?(i=function(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}throw new Ze("302",`The pipe '${n}' could not be found!`)}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=vc(i.type)),o=ma(Me);try{const a=op(!1),l=s();return op(a),function(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,Bt(),r,l),l}finally{ma(o)}}function gl(n,e,t){const i=n+20,r=Bt(),s=_d(r,i);return function(n,e){Ul.isWrapped(e)&&(e=Ul.unwrap(e),n[Fn.lFrame.bindingIndex]=An);return e}(r,function(n,e){return n[1].data[e].pure}(r,i)?JL(r,Es(),e,s.transform,t,s):s.transform(t))}function KA(n){return e=>{setTimeout(n,void 0,e)}}const hn=class extends se{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const h=e;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),l=null===(s=h.error)||void 0===s?void 0:s.bind(h),c=null===(o=h.complete)||void 0===o?void 0:o.bind(h)}this.__isAsync&&(l=KA(l),a&&(a=KA(a)),c&&(c=KA(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof x&&e.add(u),u}};function lK(){return this._results[Up()]()}class sf{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Up(),i=sf.prototype;i[t]||(i[t]=lK)}get changes(){return this._changes||(this._changes=new hn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=qo(e);(this._changesDetected=!function(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class XA{constructor(e){this.queryList=e,this.matches=null}clone(){return new XA(this.queryList)}setDirty(){this.queryList.setDirty()}}class QA{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new QA(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==lk(e,t).matches&&this.queries[t].setDirty()}}class rk{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class ZA{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new ZA(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class JA{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new JA(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,dK(t,s)),this.matchTNodeWithReadOption(e,t,Sd(t,e,s,!1,!1))}else i===Fo?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Sd(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===En||r===Is||r===Fo&&4&t.type)this.addMatch(t.index,-2);else{const s=Sd(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function dK(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function fK(n,e,t,i){return-1===t?function(n,e){return 11&n.type?rg(n,e):4&n.type?Nw(n,e):null}(e,n):-2===t?function(n,e,t){return t===En?rg(e,n):t===Fo?Nw(e,n):t===Is?AL(e,n):void 0}(n,e,i):Cd(n,n[1],t,e)}function sk(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:fK(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function eM(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=sk(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const p=u[h];p[17]===p[3]&&eM(p[1],p,c,i)}if(null!==u[9]){const h=u[9];for(let p=0;p<h.length;p++){const g=h[p];eM(g[1],g,c,i)}}}}}return i}function gi(n){const e=Bt(),t=pi(),i=Mb();Hm(i+1);const r=lk(t,i);if(n.dirty&&Ol(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?eM(t,e,i,[]):sk(t,e,r,i);n.reset(s,mL),n.notifyOnChanges()}return!0}return!1}function Ir(n,e,t){const i=pi();i.firstCreatePass&&(function(n,e,t){null===n.queries&&(n.queries=new ZA),n.queries.track(new JA(e,t))}(i,new rk(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function(n,e,t){const i=new sf(4==(4&t));Q0(n,e,i,i.destroy),null===e[19]&&(e[19]=new QA),e[19].queries.push(new XA(i))}(i,Bt(),e)}function mi(){return function(n,e){return n[19].queries[e].queryList}(Bt(),Mb())}function lk(n,e){return n.queries.getByIndex(e)}const of=new zt("Application Initializer");let fg=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Rw,this.reject=Rw,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(py(s))t.push(s);else if(Ew(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(De(of,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const Py=new zt("AppId"),GK={provide:Py,useFactory:function(){return`${oM()}${oM()}${oM()}`},deps:[]};function oM(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Tk=new zt("Platform Initializer"),Vc=new zt("Platform ID"),zw=new zt("appBootstrapListener");let Hw=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const Pu=new zt("LocaleId"),Ak=new zt("DefaultCurrencyCode");class WK{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const aM=function(n){return new YA(n)},qK=aM,YK=function(n){return Promise.resolve(aM(n))},Mk=function(n){const e=aM(n),i=il(xo(n).declarations).reduce((r,s)=>{const o=Ni(s);return o&&r.push(new KL(o)),r},[]);return new WK(e,i)},KK=Mk,XK=function(n){return Promise.resolve(Mk(n))};let af=(()=>{class n{constructor(){this.compileModuleSync=qK,this.compileModuleAsync=YK,this.compileModuleAndAllComponentsSync=KK,this.compileModuleAndAllComponentsAsync=XK}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const Dk=new zt("compilerOptions"),ZK=(()=>Promise.resolve(0))();function lM(n){"undefined"==typeof Zone?ZK.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class vn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new hn(!1),this.onMicrotaskEmpty=new hn(!1),this.onStable=new hn(!1),this.onError=new hn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let n=ti.requestAnimationFrame,e=ti.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(n){const e=()=>{!function(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ti,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,uM(n),n.isCheckStableRunning=!0,cM(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),uM(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return Ik(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),Ok(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return Ik(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),Ok(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,uM(n),cM(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(vn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,eX,Rw,Rw);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const eX={};function cM(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function uM(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Ik(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Ok(n){n._nesting--,cM(n)}class iX{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new hn,this.onMicrotaskEmpty=new hn,this.onStable=new hn,this.onError=new hn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let dM=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vn.assertNotInAngularZone(),lM(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())lM(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(De(vn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),Rk=(()=>{class n{constructor(){this._applications=new Map,hM.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return hM.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class rX{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let hM=new rX,Pk=!0,Nk=!1;function ra(){return Nk=!0,Pk}let Yl;const Fk=new zt("AllowMultipleToken");function Lk(n,e,t=[]){const i=`Platform: ${e}`,r=new zt(i);return(s=[])=>{let o=pM();if(!o||o.injector.get(Fk,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:Mu,useValue:"platform"});!function(n){if(Yl&&!Yl.destroyed&&!Yl.injector.get(Fk,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Yl=n.get(kk);const e=n.get(Tk,null);e&&e.forEach(t=>t())}(jn.create({providers:a,name:i}))}return function(n){const e=pM();if(!e)throw new Error("No platform exists!");if(!e.injector.get(n,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function pM(){return Yl&&!Yl.destroyed?Yl:null}let kk=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function(n,e){let t;return t="noop"===n?new iX:("zone.js"===n?void 0:n)||new vn({enableLongStackTrace:ra(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:vn,useValue:a}];return a.run(()=>{const c=jn.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),h=u.injector.get(Zo,null);if(!h)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(()=>{const p=a.onError.subscribe({next:g=>{h.handleError(g)}});u.onDestroy(()=>{gM(this._modules,u),p.unsubscribe()})}),function(n,e,t){try{const i=t();return py(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(h,a,()=>{const p=u.injector.get(fg);return p.runInitializers(),p.donePromise.then(()=>(TA(u.injector.get(Pu,Aw)||Aw),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=Bk({},i);return function(n,e,t){const i=new YA(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(qd);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${it(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(De(jn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();function Bk(n,e){return Array.isArray(e)?e.reduce(Bk,n):Object.assign(Object.assign({},n),e)}let qd=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new I(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new I(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{vn.assertNotInAngularZone(),lM(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{vn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=Rn(a,l.pipe(ys()))}bootstrap(t,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=t instanceof fL?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Bc),a=r.create(jn.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(dM,null),u=c&&a.injector.get(Rk);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),gM(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;gM(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(zw,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(De(vn),De(jn),De(Zo),De(dl),De(fg))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();function gM(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const OX=Lk(null,"core",[{provide:Vc,useValue:"unknown"},{provide:kk,deps:[jn]},{provide:Rk,deps:[]},{provide:Hw,deps:[]}]),LX=[{provide:qd,useClass:qd,deps:[vn,jn,Zo,dl,fg]},{provide:UY,deps:[vn],useFactory:function(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:fg,useClass:fg,deps:[[new Xr,of]]},{provide:af,useClass:af,deps:[]},GK,{provide:sg,useFactory:function(){return Fq},deps:[]},{provide:og,useFactory:function(){return Lq},deps:[]},{provide:Pu,useFactory:function(n){return TA(n=n||"undefined"!=typeof $localize&&$localize.locale||Aw),n},deps:[[new Od(Pu),new Xr,new tl]]},{provide:Ak,useValue:"USD"}];let BX=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(De(qd))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:LX}),n})(),tE=null;function jc(){return tE}const dn=new zt("DocumentToken");var fs=(()=>((fs=fs||{})[fs.Zero=0]="Zero",fs[fs.One=1]="One",fs[fs.Two=2]="Two",fs[fs.Few=3]="Few",fs[fs.Many=4]="Many",fs[fs.Other=5]="Other",fs))();const XQ=function(n){return function(n){const e=function(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=U2(e);if(t)return t;const i=e.split("-")[0];if(t=U2(i),t)return t;if("en"===i)return f9;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[cn.PluralCase]};class dE{}let xZ=(()=>{class n extends dE{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(XQ(i||this.locale)(t)){case fs.Zero:return"zero";case fs.One:return"one";case fs.Two:return"two";case fs.Few:return"few";case fs.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(De(Pu))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();function T3(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class AZ{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Kd=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(i){throw new Error(`Cannot find a differ supporting object '${t}' of type '${function(n){return n.name||typeof n}(t)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=[];t.forEachOperation((r,s,o)=>{if(null==r.previousIndex){const a=this._viewContainer.createEmbeddedView(this._template,new AZ(null,this._ngForOf,-1,-1),null===o?void 0:o),l=new A3(r,a);i.push(l)}else if(null==o)this._viewContainer.remove(null===s?void 0:s);else if(null!==s){const a=this._viewContainer.get(s);this._viewContainer.move(a,o);const l=new A3(r,a);i.push(l)}});for(let r=0;r<i.length;r++)this._perViewChange(i[r].view,i[r].record);for(let r=0,s=this._viewContainer.length;r<s;r++){const o=this._viewContainer.get(r);o.context.index=r,o.context.count=s,o.context.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{this._viewContainer.get(r.currentIndex).context.$implicit=r.item})}_perViewChange(t,i){t.context.$implicit=i.item}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(Me(Is),Me(Fo),Me(sg))},n.\u0275dir=kt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();class A3{constructor(e,t){this.record=e,this.view=t}}let ku=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new DZ,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){M3("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){M3("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(Me(Is),Me(Fo))},n.\u0275dir=kt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class DZ{constructor(){this.$implicit=null,this.ngIf=null}}function M3(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${it(e)}'.`)}class PZ{createSubscription(e,t){return e.subscribe({next:t,error:i=>{throw i}})}dispose(e){e.unsubscribe()}onDestroy(e){e.unsubscribe()}}class NZ{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}onDestroy(e){}}const FZ=new NZ,LZ=new PZ;let fE=(()=>{class n{constructor(t){this._ref=t,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(t){return this._obj?t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue:(t&&this._subscribe(t),this._latestValue)}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(py(t))return FZ;if(JF(t))return LZ;throw function(n,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${it(n)}'`)}(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this._ref.markForCheck())}}return n.\u0275fac=function(t){return new(t||n)(Me(ss,16))},n.\u0275pipe=ks({name:"async",type:n,pure:!1}),n})(),Zr=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:[{provide:dE,useClass:xZ}]}),n})();const N3="browser";function df(n){return n===N3}class k3{}class GM extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(n){tE||(tE=n)}(new GM)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(jy=jy||document.querySelector("base"),jy?jy.getAttribute("href"):null);return null==t?null:function(n){pE=pE||document.createElement("a"),pE.setAttribute("href",n);const e=pE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){jy=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return T3(document.cookie,e)}}let pE,jy=null;const B3=new zt("TRANSITION_ID"),aJ=[{provide:of,useFactory:function(n,e,t){return()=>{t.get(fg).donePromise.then(()=>{const i=jc(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[B3,dn,jn],multi:!0}];class $M{static init(){!function(n){hM=n}(new $M)}addToWindow(e){ti.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},ti.getAllAngularTestabilities=()=>e.getAllTestabilities(),ti.getAllAngularRootElements=()=>e.getAllRootElements(),ti.frameworkStabilizers||(ti.frameworkStabilizers=[]),ti.frameworkStabilizers.push(i=>{const r=ti.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?jc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let lJ=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const Uy=new zt("EventManagerPlugins");let mE=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(De(Uy),De(vn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class WM{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=jc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let j3=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),zy=(()=>{class n extends j3{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(U3),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(U3))}}return n.\u0275fac=function(t){return new(t||n)(De(dn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();function U3(n){jc().remove(n)}const qM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},YM=/%COMP%/g;function _E(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?_E(n,r,t):(r=r.replace(YM,n),t.push(r))}return t}function G3(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let yE=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new KM(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case $t.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new SJ(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case $t.ShadowDom:return new CJ(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=_E(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(De(mE),De(zy),De(Py))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class KM{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(qM[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=qM[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=qM[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Ro.DashCase|Ro.Important)?e.style.setProperty(t,i,r&Ro.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Ro.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,G3(i)):this.eventManager.addEventListener(e,t,G3(i))}}class SJ extends KM{constructor(e,t,i,r){super(e),this.component=i;const s=_E(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function(n){return"_ngcontent-%COMP%".replace(YM,n)}(r+"-"+i.id),this.hostAttr=function(n){return"_nghost-%COMP%".replace(YM,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class CJ extends KM{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=_E(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let xJ=(()=>{class n extends WM{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(De(dn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const q3=["alt","control","meta","shift"],RJ={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Y3={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},PJ={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let NJ=(()=>{class n extends WM{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>jc().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(q3.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&Y3.hasOwnProperty(e)&&(e=Y3[e]))}return RJ[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),q3.forEach(s=>{s!=r&&PJ[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return n.\u0275fac=function(t){return new(t||n)(De(dn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const zJ=Lk(OX,"browser",[{provide:Vc,useValue:N3},{provide:Tk,useValue:function(){GM.makeCurrent(),$M.init()},multi:!0},{provide:dn,useFactory:function(){return function(n){zi=n}(document),document},deps:[]}]),HJ=[[],{provide:Mu,useValue:"root"},{provide:Zo,useFactory:function(){return new Zo},deps:[]},{provide:Uy,useClass:xJ,multi:!0,deps:[dn,vn,Vc]},{provide:Uy,useClass:NJ,multi:!0,deps:[dn]},[],{provide:yE,useClass:yE,deps:[mE,zy,Py]},{provide:tf,useExisting:yE},{provide:j3,useExisting:zy},{provide:zy,useClass:zy,deps:[dn]},{provide:dM,useClass:dM,deps:[vn]},{provide:mE,useClass:mE,deps:[Uy,vn]},{provide:k3,useClass:lJ,deps:[]},[]];let ZM=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:Py,useValue:t.appId},{provide:B3,useExisting:Py},aJ]}}}return n.\u0275fac=function(t){return new(t||n)(De(n,12))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:HJ,imports:[Zr,BX]}),n})();"undefined"!=typeof window&&window;class QJ extends x{constructor(e,t){super()}schedule(e,t=0){return this}}class vE extends QJ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let X3=(()=>{class n{constructor(t,i=n.now){this.SchedulerAction=t,this.now=i}schedule(t,i=0,r){return new this.SchedulerAction(this,t).schedule(r,i)}}return n.now=()=>Date.now(),n})();class Jl extends X3{constructor(e,t=X3.now){super(e,()=>Jl.delegate&&Jl.delegate!==this?Jl.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return Jl.delegate&&Jl.delegate!==this?Jl.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const eee=new class extends Jl{}(class extends vE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!==i&&i>0||null===i&&this.delay>0?super.requestAsyncId(e,t,i):e.flush(this)}}),Uc=new I(n=>n.complete());function Hy(n){return n?function(n){return new I(e=>n.schedule(()=>e.complete()))}(n):Uc}function nn(...n){let e=n[n.length-1];return Se(e)?(n.pop(),Pe(n,e)):Mn(n)}function yg(n,e){return new I(e?t=>e.schedule(nee,0,{error:n,subscriber:t}):t=>t.error(n))}function nee({error:n,subscriber:e}){e.error(n)}class oa{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return nn(this.value);case"E":return yg(this.error);case"C":return Hy()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new oa("N",e):oa.undefinedValueNotification}static createError(e){return new oa("E",void 0,e)}static createComplete(){return oa.completeNotification}}oa.completeNotification=new oa("C"),oa.undefinedValueNotification=new oa("N",void 0);class bE extends y{constructor(e,t,i=0){super(e),this.scheduler=t,this.delay=i}static dispatch(e){const{notification:t,destination:i}=e;t.observe(i),this.unsubscribe()}scheduleMessage(e){this.destination.add(this.scheduler.schedule(bE.dispatch,this.delay,new ree(e,this.destination)))}_next(e){this.scheduleMessage(oa.createNext(e))}_error(e){this.scheduleMessage(oa.createError(e)),this.unsubscribe()}_complete(){this.scheduleMessage(oa.createComplete()),this.unsubscribe()}}class ree{constructor(e,t){this.notification=e,this.destination=t}}class ff extends se{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new see(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=i.length;let o;if(this.closed)throw new G;if(this.isStopped||this.hasError?o=x.EMPTY:(this.observers.push(e),o=new Q(this,e)),r&&e.add(e=new bE(e,r)),t)for(let a=0;a<s&&!e.closed;a++)e.next(i[a]);else for(let a=0;a<s&&!e.closed;a++)e.next(i[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||eee).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,r=this._events,s=r.length;let o=0;for(;o<s&&!(e-r[o].time<i);)o++;return s>t&&(o=Math.max(o,s-t)),o>0&&r.splice(0,o),r}}class see{constructor(e,t){this.time=e,this.value=t}}function Jr(n,e){return"function"==typeof e?t=>t.pipe(Jr((i,r)=>Ve(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new oee(n))}class oee{constructor(e){this.project=e}call(e,t){return t.subscribe(new aee(e,this.project))}}class aee extends be{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new gt(this),r=this.destination;r.add(i),this.innerSubscription=P(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const wE={schedule(n,e){const t=setTimeout(n,e);return()=>clearTimeout(t)},scheduleBeforeRender(n){if("undefined"==typeof window)return wE.schedule(n,0);if(void 0===window.requestAnimationFrame)return wE.schedule(n,16);const e=window.requestAnimationFrame(n);return()=>window.cancelAnimationFrame(e)}};let eD;function _ee(n,e,t){let i=t;return function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}(n)&&e.some((r,s)=>!("*"===r||!function(n,e){if(!eD){const t=Element.prototype;eD=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE&&eD.call(n,e)}(n,r)||(i=s,0))),i}class vee{constructor(e,t){this.componentFactory=t.get(dl).resolveComponentFactory(e)}create(e){return new bee(this.componentFactory,e)}}class bee{constructor(e,t){this.componentFactory=e,this.injector=t,this.eventEmitters=new ff(1),this.events=this.eventEmitters.pipe(Jr(i=>Rn(...i))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:i})=>i)),this.ngZone=this.injector.get(vn),this.elementZone="undefined"==typeof Zone?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=wE.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(e){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){this.runInZone(()=>{null!==this.componentRef?function(n,e){return n===e||n!=n&&e!=e}(t,this.getInputValue(e))&&(void 0!==t||!this.unchangedInputs.has(e))||(this.recordInputChange(e,t),this.unchangedInputs.delete(e),this.hasInputChanges=!0,this.componentRef.instance[e]=t,this.scheduleDetectChanges()):this.initialInputValues.set(e,t)})}initializeComponent(e){const t=jn.create({providers:[],parent:this.injector}),i=function(n,e){const t=n.childNodes,i=e.map(()=>[]);let r=-1;e.some((s,o)=>"*"===s&&(r=o,!0));for(let s=0,o=t.length;s<o;++s){const a=t[s],l=_ee(a,e,r);-1!==l&&i[l].push(a)}return i}(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,i,e),this.viewChangeDetectorRef=this.componentRef.injector.get(ss),this.implementsOnChanges=function(n){return"function"==typeof n}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(qd).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:e})=>{this.initialInputValues.has(e)&&this.setInputValue(e,this.initialInputValues.get(e))}),this.initialInputValues.clear()}initializeOutputs(e){const t=this.componentFactory.outputs.map(({propName:i,templateName:r})=>e.instance[i].pipe(me(o=>({name:r,value:o}))));this.eventEmitters.next(t)}callNgOnChanges(e){if(!this.implementsOnChanges||null===this.inputChanges)return;const t=this.inputChanges;this.inputChanges=null,e.instance.ngOnChanges(t)}markViewForCheck(e){this.hasInputChanges&&(this.hasInputChanges=!1,e.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=wE.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(e,t){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const i=this.inputChanges[e];if(i)return void(i.currentValue=t);const r=this.unchangedInputs.has(e),s=r?void 0:this.getInputValue(e);this.inputChanges[e]=new Fm(s,t,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}}class wee extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}const See={initialConfig:{},parse:{},rename:{}};class Cee{constructor(e,t){this.configState=e,this.storedChanges={},this.options=Object.assign(Object.assign({},See),t)}addChanges(e){this.storedChanges=Object.assign(Object.assign({},this.storedChanges),e)}applyChanges(e,t={}){void 0===e&&(e=this.storedChanges,this.storedChanges={});const{configState:i,options:{initialConfig:r}}=this,s=i.snapshot,o=Object.assign(Object.assign(Object.assign({},r),s),t);for(const[a,l]of Object.entries(e))this.processChange(a,l,o);i.setConfig(o)}processChange(e,t,i){var r,s;const{options:{parse:o,rename:a}}=this,l=null!==(r=a[e])&&void 0!==r?r:e,c=t.currentValue,u=null!==(s=o[e])&&void 0!==s?s:o[l];if(null==c)delete i[l];else if(u)try{i[l]=u(c)}catch(h){console.warn(`Failed to parse ${e} = ${c}`,h.message)}else i[l]=c}}let xee=(()=>{class n{constructor(t,i,r={}){this.configState=t,this.cdr=i,this.options=r,this.initialized=!1,this.configManager=new Cee(this.configState,this.options)}ngOnInit(){var t;this._init=setTimeout(()=>this.initialize(),null!==(t=this.options.initialDelay)&&void 0!==t?t:0)}ngOnDestroy(){this._init&&clearTimeout(this._init)}ngOnChanges(t){this.configManager.addChanges(t),this.initialized&&this.configManager.applyChanges()}initialize(){this._init=void 0,!this.initialized&&(this.configManager.applyChanges(),this.initialized=!0,this.cdr.markForCheck())}}return n.\u0275fac=function(t){!function(){throw new Error("invalid")}()},n.\u0275dir=kt({type:n,features:[Ui]}),n})();const tD={boolean:n=>"false"!=`${n}`,json:n=>"string"==typeof n?JSON.parse(n):n,function:n=>{if("function"!=typeof n)throw new Error("Expected a javascript function");return n}};var nD;const pf={production:!0,disableDbWorker:!0,acceptableViewerDomains:["https://portal.hubmapconsortium.org","https://portal.test.hubmapconsortium.org"],dbOptions:{ccfOwlUrl:"https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/ccf.owl.n3store.json",ccfContextUrl:"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld",dataSources:["https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/kpmp/data/rui_locations.jsonld","https://cdn.jsdelivr.net/gh/hubmapconsortium/ccf-ui@staging/assets/sparc/data/rui_locations.jsonld"],hubmapDataService:"",hubmapPortalUrl:"",hubmapDataUrl:"",hubmapAssetsUrl:"",hubmapToken:null!==(nD=localStorage.getItem("HUBMAP_TOKEN"))&&void 0!==nD?nD:"",useRemoteApi:!1,remoteApiEndpoint:"https://ccf-api--staging.herokuapp.com/v1"},googleAnalyticsToken:"G-ERNVZ1Q4KE"};function Or(n,e,t,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function Z3(n,e){return function(t,i){e(t,i,n)}}function ec(n,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(n,e)}function Ri(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(h){o(h)}}function l(u){try{c(i.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}function tB(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function rD(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||tB()}const nB="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",SE=rD();class Dee{constructor(e,t,i="sessionStorage"){this.storage=function(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function sD(n,e,t,i=600){const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const iB={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function rB(n){return"string"==typeof n?iB[n.toUpperCase()]||iB.WHITE:n}function CE(n,e){if(!n)throw new Error(e||"Assertion failed")}const tc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},Gy=tc.window||tc.self||tc.global,sB=tc.process||{};function vg(){let n;if(SE&&Gy.performance)n=Gy.performance.now();else if(sB.hrtime){const e=sB.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}console;const bg={debug:SE&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Lee={enabled:!0,level:0};function yl(){}const oB={},aB={once:!0};function kee(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}let oD=(()=>{class n{constructor({id:t}={id:""}){this.id=t,this.VERSION=nB,this._startTs=vg(),this._deltaTs=vg(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Dee("__probe-".concat(this.id,"__"),Lee),this.userData={},this.timeStamp("".concat(this.id," started")),function(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((vg()-this._startTs).toPrecision(10))}getDelta(){return Number((vg()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,i){CE(t,i)}warn(t){return this._getLogFunction(0,t,bg.warn,arguments,aB)}error(t){return this._getLogFunction(0,t,bg.error,arguments)}deprecated(t,i){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(i,"` instead"))}removed(t,i){return this.error("`".concat(t,"` has been removed. Use `").concat(i,"` instead"))}probe(t,i){return this._getLogFunction(t,i,bg.log,arguments,{time:!0,once:!0})}log(t,i){return this._getLogFunction(t,i,bg.debug,arguments)}info(t,i){return this._getLogFunction(t,i,console.info,arguments)}once(t,i){return this._getLogFunction(t,i,bg.debug||bg.info,arguments,aB)}table(t,i,r){return i?this._getLogFunction(t,i,console.table||yl,r&&[r],{tag:kee(i)}):yl}image({logLevel:t,priority:i,image:r,message:s="",scale:o=1}){return this._shouldLog(t||i)?SE?function({image:n,message:e="",scale:t=1}){if("string"==typeof n){const r=new Image;return r.onload=()=>{const s=sD(r,e,t);console.log(...s)},r.src=n,yl}const i=n.nodeName||"";if("img"===i.toLowerCase())return console.log(...sD(n,e,t)),yl;if("canvas"===i.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...sD(r,e,t)),r.src=n.toDataURL(),yl}return yl}({image:r,message:s,scale:o}):function({image:n,message:e="",scale:t=1}){let i=null;try{i=tt(307)}catch(r){}return i?()=>i(n,{fit:"box",width:"".concat(Math.round(80*t),"%")}).then(r=>console.log(r)):yl}({image:r,message:s,scale:o}):yl}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,i){this._storage.updateConfiguration({[t]:i})}time(t,i){return this._getLogFunction(t,i,console.time?console.time:console.info)}timeEnd(t,i){return this._getLogFunction(t,i,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,i){return this._getLogFunction(t,i,console.timeStamp||yl)}group(t,i,r={collapsed:!1}){r=cB({logLevel:t,message:i,opts:r});const{collapsed:s}=r;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,i,r={}){return this.group(t,i,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||yl)}withGroup(t,i,r){this.group(t,i)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=lB(t)}_getLogFunction(t,i,r,s=[],o){if(this._shouldLog(t)){o=cB({logLevel:t,message:i,args:s,opts:o}),CE(r=r||o.method),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=vg();const a=o.tag||o.message;if(o.once){if(oB[a])return yl;oB[a]=vg()}return i=function(n,e,t){if("string"==typeof e){const i=t.time?function(n,e=8){const t=Math.max(e-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=function(n,e,t){return!SE&&"string"==typeof n&&(e&&(e=rB(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=rB(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),t.color,t.background)}return e}(this.id,o.message,o),r.bind(console,i,...o.args)}return yl}}return n.VERSION=nB,n})();function lB(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return CE(Number.isFinite(e)&&e>=0),e}function cB(n){const{logLevel:e,message:t}=n;n.logLevel=lB(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(n.args=i,typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return CE("string"===r||"object"===r),Object.assign(n,n.opts)}const ki=new oD({id:"deck"}),Pi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Pi,"IDENTITY",{get:()=>ki.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const zc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},uB={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},fn=new oD({id:"luma.gl"});function Bo(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function xE(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function _i(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function TE(n){return Bo(xE(n),"Invalid WebGLRenderingContext"),n}function Vo(n){return Bo(_i(n),"Requires WebGL2"),n}var Er=tt(761);const $y={};const Wy=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(Wy.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const gf=function(e){const t=this;this.gl=e,function(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&($y[i]=!0)}while(0!==i);for(i in $y)if($y[i])return delete $y[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const h=t.currentVertexArrayObject;h.maxAttrib=Math.max(h.maxAttrib,s);const p=h.attribs[s];return p.buffer=t.currentArrayBuffer,p.size=o,p.type=a,p.normalized=l,p.stride=c,p.offset=u,p.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{Er.CO.console&&Er.CO.console.log&&Er.CO.console.log("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};gf.prototype.VERTEX_ARRAY_BINDING_OES=34229,gf.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new Wy(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},gf.prototype.createVertexArrayOES=function(){const e=new Wy(this);return this.vertexArrayObjects.push(e),e},gf.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},gf.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Wy&&e.hasBeenBound&&e.ext===this)},gf.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function(n,e){$y[n]=!0,void 0!==e&&function(n){Er.CO.console&&Er.CO.console.error&&Er.CO.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=r?r.attribs[l]:null;if((!r||c.enabled!==u.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let h=!1;(!r||c.buffer!==u.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),h=!0),(h||c.cached!==u.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const dB="OES_element_index",hB="WEBGL_draw_buffers",fB="WEBGL_debug_renderer_info",hr=n=>_i(n)?void 0:0,rte={3074:n=>_i(n)?void 0:36064,35723:n=>_i(n)?void 0:4352,35977:hr,32937:hr,36795:(n,e)=>{const t=_i(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(fB);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(fB);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:hr,35071:hr,37447:hr,36063:(n,e)=>{if(!_i(n)){const t=n.getExtension(hB);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:hr,35374:hr,35377:hr,34852:n=>{if(!_i(n)){const e=n.getExtension(hB);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(dB)?2147483647:65535,33001:n=>n.getExtension(dB)?16777216:65535,33e3:n=>16777216,37157:hr,35373:hr,35657:hr,36183:hr,37137:hr,34045:hr,35978:hr,35979:hr,35968:hr,35376:hr,35375:hr,35659:hr,37154:hr,35371:hr,35658:hr,35076:hr,35077:hr,35380:hr},pB="ANGLE_instanced_arrays",gB={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{Bo(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[pB]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){Bo(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Bo(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{Bo(!1)},deleteQuery:()=>{Bo(!1)},beginQuery:()=>{Bo(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},aD={readBuffer:(n,e,t)=>{_i(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function(n,e){return{webgl2:_i(n),ext:n.getExtension("ANGLE_instanced_arrays")}}(n);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!_i(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>{if(!_i(n))switch(r){case 32937:return new Int32Array([0])}return n.getInternalformatParameter(t,i,r)},getTexParameter(n,e,t,i){switch(i){case 34046:const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function(n,e,t){const i=rte[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function _te(n,{extension:e,target:t,target2:i}){const r=gB[e];Bo(r);const{meta:s={}}=r,{suffix:o=""}=s,a=n.getExtension(e);for(const l of Object.keys(r)){const c=`${l}${o}`;let u=null;"meta"===l||"function"==typeof n[l]||(a&&"function"==typeof a[c]?u=(...h)=>a[c](...h):"function"==typeof r[l]&&(u=r[l].bind(t))),u&&(t[l]=u,i[l]=u)}}("undefined"!=typeof global?global:window).polyfillContext=function(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new gf(this)),this.__OESVertexArrayObject))}}(n),function(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&_te(n,{extension:t,target:n.luma,target2:n})}(n,gB),function(n,{target:e,target2:t}){Object.keys(aD).forEach(i=>{if("function"==typeof aD[i]){const r=n[i]?n[i].bind(n):()=>{},s=aD[i].bind(null,n,r);e[i]=s,t[i]=s}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const lD={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Qd=(n,e,t)=>e?n.enable(t):n.disable(t),mB=(n,e,t)=>n.hint(t,e),Da=(n,e,t)=>n.pixelStorei(t,e);function qy(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const bte={3042:Qd,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:Qd,2885:(n,e)=>n.cullFace(e),2929:Qd,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:Qd,35723:mB,36006:(n,e)=>{const t=_i(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:mB,2849:(n,e)=>n.lineWidth(e),32823:Qd,32824:"polygonOffset",10752:"polygonOffset",35977:Qd,32938:"sampleCoverage",32939:"sampleCoverage",3089:Qd,3088:(n,e)=>n.scissor(...e),2960:Qd,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:Da,3317:Da,37440:Da,37441:Da,37443:Da,3330:Da,3332:Da,3331:Da,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:Da,32878:Da,3316:Da,3315:Da,32877:Da,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=qy(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=qy(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=qy(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=qy(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=qy(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function es(n,e,t){return void 0!==e[n]?e[n]:t[n]}const wte={blendEquation:(n,e,t)=>n.blendEquationSeparate(es(32777,e,t),es(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(es(32969,e,t),es(32968,e,t),es(32971,e,t),es(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(es(32824,e,t),es(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(es(32938,e,t),es(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,es(2962,e,t),es(2967,e,t),es(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,es(34816,e,t),es(36003,e,t),es(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,es(2964,e,t),es(2965,e,t),es(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,es(34817,e,t),es(34818,e,t),es(34819,e,t))},_B={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},Hc=(n,e)=>n.isEnabled(e),yB={3042:Hc,2884:Hc,2929:Hc,3024:Hc,32823:Hc,32926:Hc,32928:Hc,3089:Hc,2960:Hc,35977:Hc};function vB(n){for(const e in n)return!1;return!0}function Ete(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function bB(n,e){const t=n[e].bind(n);n[e]=function(...r){const s=r[0];return s in n.state.cache||(n.state.cache[s]=t(...r)),n.state.enable?n.state.cache[s]:t(...r)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function Ste(n,e,t){const i=n[e].bind(n);n[e]=function(...s){const{valueChanged:o,oldValue:a}=t(n.state._updateCache,...s);return o&&i(...s),a},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}class xte{constructor(e,{copyState:t=!1,log:i=(()=>{})}={}){this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?function(n,e){if("number"==typeof(e=e||lD)){const r=e,s=yB[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=yB[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}(e):Object.assign({},lD),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){Bo(this.stateStack.length>0),Bu(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Bo(void 0!==s);const o=e[s],a=this.cache[s];Ete(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function wB(n,e={}){const{enable:t=!0,copyState:i}=e;if(Bo(void 0!==i),!n.state){const r="undefined"!=typeof global?global:window,{polyfillContext:s}=r;s&&s(n),n.state=new xte(n,{copyState:i}),function(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}(n);for(const o in _B)Ste(n,o,_B[o]);bB(n,"getParameter"),bB(n,"isEnabled")}return n.state.enable=t,n}function EB(n){Bo(n.state),n.state.pop()}function Bu(n,e){if(Bo(xE(n),"setParameters requires a WebGL context"),vB(e))return;const t={};for(const r in e){const s=Number(r),o=bte[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)wte[r](n,e,i)}function nc(n,e,t){if(vB(e))return t(n);const{nocatch:i=!0}=e;let r;if(function(n){n.state||wB(n,{copyState:!1}),n.state.push()}(n),Bu(n,e),i)r=t(n),EB(n);else try{r=t(n)}finally{EB(n)}return r}function wg(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function cD(n,e,t=!0){return function(n,e,t,i,r){const s=SB(n[0],e,t);let o=CB(n[1],e,i,r),a=SB(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=CB(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}(e,wg(n),n.drawingBufferWidth,n.drawingBufferHeight,t)}function SB(n,e,t){return Math.min(Math.round(n*e),t-1)}function CB(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const uD=(0,Er.jU)(),Ote=uD&&"undefined"!=typeof document,xB={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function TB(n={}){Bo(uD,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},xB,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=function({canvas:n,width:e=800,height:t=600,onError:i}){let r;return"string"==typeof n?(Ote&&"complete"===document.readyState||i(`createGLContext called on canvas '${n}' before page was loaded`),r=document.getElementById(n)):n?r=n:(r=document.createElement("canvas"),r.id="lumagl-canvas",r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",document.body.insertBefore(r,document.body.firstChild)),r}({canvas:s,width:e,height:t,onError:i});return r=function(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t(`Failed to create ${o&&!s?"WebGL2":"WebGL"} context: ${i||"Unknown error"}`)}(o,n),r?(r=dD(r,n),function(n){const e=_i(n)?"WebGL2":"WebGL1",t=function(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n);fn.info(1,`${e}${n.debug?" debug":""} context ${t?`(${t.vendor},${t.renderer})`:""}`)()}(r),r):null}function dD(n,e={}){if(!n||n._instrumented)return n;n._version=n._version||function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},xB,e);const{manageState:t,debug:i}=e;return t&&wB(n,{copyState:!1,log:(...r)=>fn.log(1,...r)()}),uD&&i&&(Er.CO.makeDebugContext?(n=Er.CO.makeDebugContext(n,e),fn.level=Math.max(fn.level,1)):fn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function AB(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class MB{constructor(e,t){this.name=e,this.type=t,this.sampleSize=1,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=AB(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(AB()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class hD{constructor({id:e,stats:t}){this.id=e,this.stats={},this._initializeStats(t),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof MB?e:new MB(t,i)),this.stats[t]}}const Yy="8.5.7",mf=new class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new hD({id:e})),this.stats.get(e)}};if(Er.CO.luma&&Er.CO.luma.VERSION!==Yy)throw new Error(`luma.gl - multiple VERSIONs detected: ${Er.CO.luma.VERSION} vs 8.5.7`);function sn(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function fD(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return sn(void 0!==i,`Accessing undefined constant GL.${e}`),i}function Zd(n,e){e=Number(e);for(const t in n)if(n[t]===e)return`GL.${t}`;return String(e)}Er.CO.luma||((0,Er.jU)()&&fn.log(1,"luma.gl 8.5.7 - set luma.log.level=1 (or higher) to trace rendering")(),Er.CO.luma=Er.CO.luma||{VERSION:Yy,version:Yy,log:fn,stats:mf,globals:{modules:{},nodeIO:{}}});const pD={};function Gc(n="id"){return pD[n]=pD[n]||1,`${n}-${pD[n]++}`}function DB(n){return sn("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function Eg(n){let e=!0;for(const t in n){e=!1;break}return e}function IB(n,e,t,i){const r=`See luma.gl ${t} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw fn.removed(`Calling removed method ${e}.${o}: `,r)(),new Error(o)})})}const Sg="Resource subclass must define virtual methods";class Vu{constructor(e,t={}){TE(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||Gc(this.constructor.name),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:e=!1}={}){const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(e=this.handle){if("function"!=typeof e)return this._bindHandle(e),this;let t;return this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t}unbind(){this.bind(null)}getParameter(e,t={}){sn(e=fD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=_i(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(e={}){const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=_i(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const h=i?Zd(this.gl,l):l;o[h]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[h]=Zd(this.gl,o[h]))}}return o}setParameter(e,t){sn(e=fD(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=_i(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=fD(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return IB(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Sg)}_deleteHandle(){throw new Error(Sg)}_bindHandle(e){throw new Error(Sg)}_getOptsFromHandle(){throw new Error(Sg)}_getParameter(e,t){throw new Error(Sg)}_setParameter(e,t){throw new Error(Sg)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this.constructor.name,t=mf.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get(`${e}s Created`).incrementCount(),t.get(`${e}s Active`).incrementCount()}_removeStats(){const e=this.constructor.name;mf.get("Resource Counts").get(`${e}s Active`).decrementCount()}_trackAllocatedMemory(e,t=this.constructor.name){const i=mf.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.byteLength=e}_trackDeallocatedMemory(e=this.constructor.name){const t=mf.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get(`${e} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function gD(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Ky(n,{clamped:e=!0}={}){switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Hte({data:n,width:e,height:t}){const i=Math.round(e/2),r=Math.round(t/2),s=new Uint8Array(i*r*4);for(let o=0;o<r;o++)for(let a=0;a<i;a++)for(let l=0;l<4;l++)s[4*(o*i+a)+l]=n[4*(2*o*e+2*a)+l];return{data:s,width:i,height:r}}function mD(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)a in e&&fn.removed(`${n}.${a}`,i[a]?`${n}.${i[a]}`:"N/A")();for(const a in r)a in e&&fn.deprecated(`${n}.${a}`,`${n}.${r[a]}`)();let o=null;for(const a in s)if(a in e){const l=s[a];fn.deprecated(`${n}.${a}`,`${n}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const Gte={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},$te={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class aa{static getBytesPerElement(e){return Ky(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return sn(e.size),Ky(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new aa(...[Gte,...e])}constructor(...e){e.forEach(t=>this._assign(t)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return aa.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return aa.getBytesPerVertex(this)}_assign(e={}){return void 0!==(e=mD("Accessor",e,$te)).type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const RB={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Wte={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:RB},qte={removedProps:RB};class rr extends Vu{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(e=this.accessor){return Math.round(this.byteLength/aa.getBytesPerElement(e))}getVertexCount(e=this.accessor){return Math.round(this.byteLength/aa.getBytesPerVertex(e))}initialize(e={}){return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=mD("Buffer",e,Wte),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=mD("Buffer",e,qte))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new aa(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;sn(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(Vo(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData({sourceBuffer:e,readOffset:t=0,writeOffset:i=0,size:r}){const{gl:s}=this;return Vo(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,t,i,r),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}={}){Vo(this.gl);const s=Ky(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const u=Math.min(o,l);return sn((r=r||u)<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind({target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}={}){return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(sn(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind({target:e=this.target,index:t=this.accessor&&this.accessor.index}={}){return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e,t=0,i=e.byteLength+t){sn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=gD(e);return sn(s),this.setAccessor(new aa(this.accessor,{type:s})),this}_setByteLength(e,t=this.usage){sn(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/Ky(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new aa(this.accessor,{type:gD(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return fn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return fn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return fn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return fn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new aa(this.accessor,e),this}}const _D={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},PB={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},NB={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},Xte=[9729,9728],FB=Er.CO.WebGLBuffer||function(){};class Cg extends Vu{static isSupported(e,t={}){const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function(n,e){const t=_D[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=_i(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function(n,e){const t=_D[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=Gc("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(e={}){let t=e.data;if(t instanceof Promise)return t.then(z=>this.initialize(Object.assign({},e,{pixels:z,data:z}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u}=e;t||(t=r);let{width:h,height:p,dataFormat:g,type:m,compressed:E=!1,mipmaps:C=!0}=e;const{depth:R=0}=e;return({width:h,height:p,compressed:E,dataFormat:g,type:m}=this._deduceParameters({format:s,type:m,dataFormat:g,compressed:E,data:t,width:h,height:p})),this.width=h,this.height=p,this.depth=R,this.format=s,this.type=m,this.dataFormat=g,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),C&&this._isNPOT()&&(fn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),C=!1,this._updateForNPOT(l)),this.mipmaps=C,this.setImageData({data:t,width:h,height:p,depth:R,format:s,type:m,dataFormat:g,border:o,mipmaps:C,parameters:c,compressed:E}),C&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize({height:e,width:t,mipmaps:i=!1}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(e={}){return this._isNPOT()?(fn.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),nc(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:h=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=e;c||(c=i),({type:u,dataFormat:g,compressed:m,width:h,height:p}=this._deduceParameters({format:s,type:u,dataFormat:g,compressed:m,data:c,width:h,height:p}));const{gl:E}=this;E.bindTexture(this.target,this.handle);let R,C=null;return({data:c,dataType:C}=this._getDataType({data:c,compressed:m})),nc(this.gl,l,()=>{switch(C){case"null":E.texImage2D(t,r,s,h,p,o,g,u,c);break;case"typed-array":E.texImage2D(t,r,s,h,p,o,g,u,c,a);break;case"buffer":R=Vo(E),R.bindBuffer(35052,c.handle||c),R.texImage2D(t,r,s,h,p,o,g,u,a),R.bindBuffer(35052,null);break;case"browser-object":_i(E)?E.texImage2D(t,r,s,h,p,o,g,u,c):E.texImage2D(t,r,s,g,u,c);break;case"compressed":for(const[z,de]of c.entries())E.compressedTexImage2D(t,z,de.format,de.width,de.height,o,de.data);break;default:sn(!1,"Unknown image data type")}}),this._trackAllocatedMemory(c&&c.byteLength?c.byteLength:this.width*this.height*(PB[this.dataFormat]||4)*(NB[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData({target:e=this.target,pixels:t=null,data:i=null,x:r=0,y:s=0,width:o=this.width,height:a=this.height,level:l=0,format:c=this.format,type:u=this.type,dataFormat:h=this.dataFormat,compressed:p=!1,offset:g=0,border:m=this.border,parameters:E={}}){if(({type:u,dataFormat:h,compressed:p,width:o,height:a}=this._deduceParameters({format:c,type:u,dataFormat:h,compressed:p,data:i,width:o,height:a})),sn(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=t),i&&i.data){const C=i;i=C.data,o=C.shape[0],a=C.shape[1]}i instanceof rr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),nc(this.gl,E,()=>{if(p)this.gl.compressedTexSubImage2D(e,l,r,s,o,a,c,i);else if(null===i)this.gl.texSubImage2D(e,l,r,s,o,a,h,u,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,s,o,a,h,u,i,g);else if(i instanceof FB){const C=Vo(this.gl);C.bindBuffer(35052,i),C.texSubImage2D(e,l,r,s,o,a,h,u,g),C.bindBuffer(35052,null)}else _i(this.gl)?Vo(this.gl).texSubImage2D(e,l,r,s,o,a,h,u,i):this.gl.texSubImage2D(e,l,r,s,h,u,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(e={}){return fn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(e=this.textureUnit){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType({data:e,compressed:t=!1}){return t?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof rr?{data:e.handle,dataType:"buffer"}:e instanceof FB?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=_D[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},sn(r,"Could not deduced texture size"),sn(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),sn(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:sn(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(_i(this.gl)||!this.width||!this.height||DB(this.width)&&DB(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===Xte.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function Qte(n,e){return sn("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error(`Could not load image ${n}.`)),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class Ia extends Cg{static isSupported(e,t){return Cg.isSupported(e,t)}constructor(e,t={}){TE(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:Qte(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const _f="EXT_color_buffer_float",LB={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:_f,bpp:2},33327:{gl2:_f,bpp:4},34842:{gl2:_f,bpp:8},33326:{gl2:_f,bpp:4},33328:{gl2:_f,bpp:8},34836:{gl2:_f,bpp:16},35898:{gl2:_f,bpp:4}};class xg extends Vu{static isSupported(e,{format:t}={format:null}){return!t||function(n,e,t){const i=t[e];if(!i)return!1;const r=_i(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,LB)}static getSamplesForFormat(e,{format:t}){return e.getInternalformatParameter(36161,t,32937)}constructor(e,t={}){super(e,t),this.initialize(t),Object.seal(this)}initialize({format:e,width:t=1,height:i=1,samples:r=0}){return sn(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&_i(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,t,i):this.gl.renderbufferStorage(36161,e,t,i),this.format=e,this.width=t,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*LB[this.format].bpp),this}resize({width:e,height:t}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const UB="clear: bad arguments";function vD(n,{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}={}){const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),sn(0!==o,UB),nc(n,s,()=>{n.clear(o)})}function zB(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function ni(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){zB(s,i,r,o,a,"next",l)}function a(l){zB(s,i,r,o,a,"throw",l)}o(void 0)})}}const bD=[34069,34070,34071,34072,34073,34074];let rne=(()=>{class n extends Cg{constructor(t,i={}){TE(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(t={}){const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage({face:t,data:i,x:r=0,y:s=0,mipmapLevel:o=0}){return this._subImage({target:t,data:i,x:r,y:s,mipmapLevel:o})}setCubeMapImageData({width:t,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:l=5121}){var c=this;return ni(function*(){const{gl:u}=c,h=r||s,p=yield Promise.all(bD.map(g=>{const m=h[g];return Promise.all(Array.isArray(m)?m:[m])}));c.bind(),bD.forEach((g,m)=>{p[m].length>1&&!1!==c.opts.mipmaps&&fn.warn(`${c.id} has mipmap and multiple LODs.`)(),p[m].forEach((E,C)=>{t&&i?u.texImage2D(g,C,a,t,i,o,a,l,E):u.texImage2D(g,C,a,a,l,E)})}),c.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:u=5121}=t,{gl:h}=this,p=o||a;return this.bind(),p instanceof Promise?p.then(g=>this.setImageDataForFace(Object.assign({},t,{face:i,data:g,pixels:g}))):this.width||this.height?h.texImage2D(i,0,c,r,s,l,c,u,p):h.texImage2D(i,0,c,c,u,p),this}}return n.FACES=bD,n})();class sne extends Cg{static isSupported(e){return _i(e)}constructor(e,t={}){Vo(e),super(e,t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1})),this.initialize(t),Object.seal(this)}setImageData({level:e=0,dataFormat:t=6408,width:i,height:r,depth:s=1,border:o=0,format:a,type:l=5121,offset:c=0,data:u,parameters:h={}}){return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),nc(this.gl,h,()=>{ArrayBuffer.isView(u)&&this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,u),u instanceof rr&&(this.gl.bindBuffer(35052,u.handle),this.gl.texImage3D(this.target,e,t,i,r,s,o,a,l,c))}),this._trackAllocatedMemory(u&&u.byteLength?u.byteLength:this.width*this.height*this.depth*(PB[this.dataFormat]||4)*(NB[this.type]||1),"Texture"),this.loaded=!0,this}}function ane(n,e){const{gl:t,width:i,height:r,id:s}=n;return new Rs(t,Object.assign({},e,{id:`framebuffer-for-${s}`,width:i,height:r,attachments:{36064:n}}))}function AE(n,e={}){const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:h}=function(n){return n instanceof Rs?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:ane(n),deleteFramebuffer:!0}}(n);sn(u);const{gl:p,handle:g,attachments:m}=u;a=a||u.width,l=l||u.height,36064===s&&null===g&&(s=1028),sn(m[s]),c=c||m[s].type,o=function(n,e,t,i,r){if(n)return n;return new(Ky(e=e||5121,{clamped:!1}))(i*r*function(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return sn(!1),0}}(t))}(o,c,r,a,l),c=c||gD(o);const E=p.bindFramebuffer(36160,g);return p.readPixels(t,i,a,l,r,c,o),p.bindFramebuffer(36160,E||null),h&&u.delete(),o}function wD(n,{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}={}){let i=AE(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=Hte({data:i,width:r,height:s}));!function({data:n,width:e,height:t,bytesPerPixel:i=4,temp:r}){const s=e*i;r=r||new Uint8Array(s);for(let o=0;o<t/2;++o){const a=o*s,l=(t-o-1)*s;r.set(n.subarray(a,a+s)),n.copyWithin(a,l,l+s),n.set(r,l)}}({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}const HB="Multiple render targets not supported";class Rs extends Vu{static isSupported(e,t={}){const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Rs(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Vo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Vo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e,t={}){super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:e=1,height:t=1,attachments:i=null,color:r=!0,depth:s=!0,stencil:o=!1,check:a=!0,readBuffer:l,drawBuffers:c}){if(sn(e>=0&&t>=0,"Width and height need to be integers"),this.width=e,this.height=t,i)for(const u in i){const h=i[u];(Array.isArray(h)?h[0]:h).resize({width:e,height:t})}else i=this._createDefaultAttachments(r,s,o,e,t);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:c}),i&&a&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update({attachments:e={},readBuffer:t,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:s=!0}){this.attach(e,{clearAttachments:r,resizeAttachments:s});const{gl:o}=this,a=o.bindFramebuffer(36160,this.handle);return t&&this._setReadBuffer(t),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,a||null),this}resize(e={}){let{width:t,height:i}=e;if(null===this.handle)return sn(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&fn.log(2,`Resizing framebuffer ${this.id} to ${t}x${i}`)();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e,{clearAttachments:t=!1,resizeAttachments:i=!0}={}){const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){sn(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof xg)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,h=0,p=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:h,level:p})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function(n){return(Rs.STATUS||{})[n]||`Framebuffer error ${n}`}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(e={}){const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&vD(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function(n,{framebuffer:e=null,buffer:t=6144,drawBuffer:i=0,value:r=[0,0,0,0]}={}){Vo(n),nc(n,{framebuffer:e},()=>{switch(t){case 6144:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case 34041:const[s,o]=r;n.clearBufferfi(34041,0,s,o);break;default:sn(!1,UB)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(e={}){return fn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(e={}){return fn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(e={}){return fn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(e={}){return fn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(e={}){return fn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(e={}){return fn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:e=[],x:t=0,y:i=0,width:r,height:s}){const o=Vo(this.gl),a=o.bindFramebuffer(36008,this.handle);return 0===t&&0===i&&void 0===r&&void 0===s?o.invalidateFramebuffer(36008,e):o.invalidateFramebuffer(36008,e,t,i,r,s),o.bindFramebuffer(36008,a),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=Zd(this.gl,r)),r}getAttachmentParameters(e=36064,t,i=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const s of i)r[t?Zd(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(e=!0){const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?Zd(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(wD(this),"luma-debug-texture"),this}log(e=0,t=""){if(e>fn.level||"undefined"==typeof window)return this;t=t||`Framebuffer ${this.id}`;const i=wD(this,{targetMaxHeight:100});return fn.image({logLevel:e,message:t,image:i},t)(),this}bind({target:e=36160}={}){return this.gl.bindFramebuffer(e,this.handle),this}unbind({target:e=36160}={}){return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new Ia(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new xg(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new xg(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&sn(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof xg?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer({attachment:e=36064,renderbuffer:t}){const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,t.handle),this.attachments[e]=t}_attachTexture({attachment:e=36064,texture:t,layer:i,level:r}){const{gl:s}=this;switch(s.bindTexture(t.target,t.handle),t.target){case 35866:case 32879:Vo(s).framebufferTextureLayer(36160,e,t.target,r,i);break;case 34067:const a=function(n){return n<34069?n+34069:n}(i);s.framebufferTexture2D(36160,e,a,t.handle,r);break;case 3553:s.framebufferTexture2D(36160,e,3553,t.handle,r);break;default:sn(!1,"Illegal texture type")}s.bindTexture(t.target,null),this.attachments[e]=t}_setReadBuffer(e){const t=function(n){return _i(n)?n:null}(this.gl);t?t.readBuffer(e):sn(36064===e||1029===e,HB),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=Vo(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):sn(1===e.length&&(36064===e[0]||1029===e[0]),HB)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in GB)void 0===n.luma.caps[e]&&(n.luma.caps[e]=WB(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}Rs.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const GB={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(n){const e=new Ia(n,{format:6408,type:5126,dataFormat:6408}),t=new Rs(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function ED(n,e){return $B(n,e)}function $B(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>WB(n,t))}function WB(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function(n,e){const t=GB[e];let i;sn(t,e);const r=_i(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:sn(!1);return i}(n,e)),n.luma.caps[e]||fn.log(2,`Feature: ${e} not supported`)(),n.luma.caps[e]}class SD{constructor(e,t){this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return ht(ht({},this.source.getAccessor()),this.opts)}}const Qy=new class{constructor(e){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(e)}setProps(e){Object.assign(this.props,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h;l&&(h=l*i+s);const p=this._allocate(c,u,a,h);return e&&o?p.set(e):a||p.fill(0,0,4),this._release(e),p}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.props.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.props.poolSize)&&t.splice(s,0,i),t.length>this.props.poolSize&&t.shift()}},yne=1/Math.PI*180,vne=1/180*Math.PI,Sr={};function wne(n,{precision:e=Sr.precision||4}={}){return n=function(n){return Math.round(n/Sr.EPSILON)*Sr.EPSILON}(n),`${parseFloat(n.toPrecision(e))}`}function Jd(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function ju(n,e,t){if(Jd(n)){t=t||function(n){return n.clone?n.clone():new Array(n.length)}(n);for(let i=0;i<t.length&&i<n.length;++i)t[i]=e(n[i],i,t);return t}return e(n)}function qB(n){return function(n,e){return ju(n,t=>t*vne,void 0)}(n)}function Sne(n){return function(n,e){return ju(n,t=>t*yne,void 0)}(n)}function Oa(n,e,t){return ju(n,i=>Math.max(e,Math.min(t,i)))}function ME(n,e,t){return Jd(n)?n.map((i,r)=>ME(i,e[r],t)):t*e+(1-t)*n}function Zy(n,e,t){const i=Sr.EPSILON;t&&(Sr.EPSILON=t);try{if(n===e)return!0;if(Jd(n)&&Jd(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!Zy(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):!(!Number.isFinite(n)||!Number.isFinite(e))&&Math.abs(n-e)<=Sr.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{Sr.EPSILON=i}}function Uu(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}Sr.EPSILON=1e-12,Sr.debug=!1,Sr.precision=4,Sr.printTypes=!1,Sr.printDegrees=!1,Sr.printRowMajor=!0;class DE extends(function(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){get ELEMENTS(){return Uu(!1),0}clone(){return(new this.constructor).copy(this)}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}to(e){return e===this?this:Jd(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Sr)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+wne(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Zy(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){void 0===i&&(i=t,t=e,e=this);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(Array.isArray(e))return this.multiply(e);for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.scale(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}multiplyByScalar(e){return this.scale(e)}get elements(){return this}check(){if(Sr.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}}function Zi(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${n}`);return n}function IE(n,e,t=""){if(Sr.debug&&!function(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}const YB={};function CD(n,e){YB[n]||(YB[n]=!0,console.warn(`${n} has been removed in version ${e}, see upgrade guide for more information`))}class Dne extends DE{get ELEMENTS(){return Uu(!1),0}copy(e){return Uu(!1),this}get x(){return this[0]}set x(e){this[0]=Zi(e)}get y(){return this[1]}set y(e){this[1]=Zi(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return Zi(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return Zi(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Uu(e>=0&&e<this.ELEMENTS,"index is out of range"),Zi(this[e])}setComponent(e,t){return Uu(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var $c=1e-6,la="undefined"!=typeof Float32Array?Float32Array:Array;function KB(){var n=new la(3);return la!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function XB(n,e,t){var i=new la(3);return i[0]=n,i[1]=e,i[2]=t,i}function QB(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function OE(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function ZB(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});function JB(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}KB();const xD=[0,0,0],eV={};class wo extends Dne{static get ZERO(){return eV.ZERO=eV.ZERO||Object.freeze(new wo(0,0,0,0))}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&Jd(e)?this.copy(e):(Sr.debug&&(Zi(e),Zi(t),Zi(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Sr.debug&&(Zi(e.x),Zi(e.y),Zi(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Zi(e)}angle(e){return function(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),h=u&&QB(n,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}(this,e)}cross(e){return OE(this,this,e),this.check()}rotateX({radians:e,origin:t=xD}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=xD}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=xD}){return function(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ZB(this,this,e),this.check()}transformAsVector(e){return JB(this,this,e),this.check()}transformByMatrix3(e){return function(n,e,t){var i=e[0],r=e[1],s=e[2];n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8]}(this,this,e),this.check()}transformByMatrix2(e){return function(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],u=r*c-s*l,h=s*a-i*c,p=i*l-r*a,g=r*p-s*h,m=s*u-i*p,E=i*h-r*u,C=2*t[3];h*=C,p*=C,m*=2,E*=2,n[0]=a+(u*=C)+(g*=2),n[1]=l+h+m,n[2]=c+p+E}(this,this,e),this.check()}}const tV=new wo;function Tg(n,e,t,i){tV.set(n,e,t);const r=tV.len();return{distance:i/r,normal:new wo(-n/r,-e/r,-t/r)}}function Yne(n){return n-Math.fround(n)}let ev;function TD(n,{size:e=1,startIndex:t=0,endIndex:i}){Number.isFinite(i)||(i=n.length);const r=(i-t)/e;ev=Qy.allocate(ev,r,{type:Float32Array,size:2*e});let s=t,o=0;for(;s<i;){for(let a=0;a<e;a++){const l=n[s++];ev[o+a]=l,ev[o+a+e]=Yne(l)}o+=2*e}return ev.subarray(0,r*e*2)}function RE(n){return n.stride||n.size*n.bytesPerElement}function nV(n,e){e.offset&&ki.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=RE(n),s=("vertexOffset"in e?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return zn(ht({},e),{offset:s,stride:t})}function ic(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}const iV=[],rV=[];function sV(n,e=0,t=1/0){let i=iV;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(rV.length=n.length,i=rV):i=iV,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function oV(n){return n&&n[Symbol.asyncIterator]}function AD(n,e=(()=>!0)){return Array.isArray(n)?aV(n,e,[]):e(n)?[n]:[]}function aV(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?aV(r,e,t):e(r)&&t.push(r)}return t}function Zne({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}const Jne=[],PE=[[0,1/0]];function MD({source:n,target:e,start:t=0,end:i,size:r,getData:s}){const o=n.length,a=(i=i||e.length)-t;if(o>a)return void e.set(n.subarray(0,a),t);if(e.set(n,t),!s)return;let l=o;for(;l<a;){const c=s(l,n);for(let u=0;u<r;u++)e[t+l]=c[u]||0,l++}}const nie={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function lV(n,e){return n?(Number.isFinite(n)&&(n={duration:n}),n.type=n.type||"interpolation",ht(ht(ht({},nie[n.type]),e),n)):null}function cV(n,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function uV(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function dV(n){n.push(n.shift())}function DD(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function hV({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,u=r&&c,h=DD(t,e),p=t.state.constant;if(!u&&i>=h)return;const g=p?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!p){const R=s;s=(z,de)=>t._normalizeConstant(R(z,de))}const m=p?(R,z)=>s(g,z):(R,z)=>s(g.subarray(R,R+a),z),E=n.getData({length:i}),C=new Float32Array(h);(function({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return MD({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((u,h)=>i(u+a,h)),c=Math.min(r.length,s.length);for(let u=1;u<c;u++){const h=r[u]*t,p=s[u]*t;MD({source:n.subarray(o,h),target:e,start:a,end:p,size:t,getData:l}),o=h,a=p}a<e.length&&MD({source:[],target:e,start:a,size:t,getData:l})})({source:E,target:C,sourceStartIndices:r,targetStartIndices:c,size:a,getData:m}),n.byteLength<C.byteLength+l&&n.reallocate(C.byteLength+l),n.subData({data:C,offset:l})}class ID extends class{constructor(e,t){this.gl=e,this.id=t.id,this.size=t.size;const i=t.logicalType||t.type,r=5130===i;let{defaultValue:s}=t;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),t.defaultValue=s;let o=i;r?o=5126:!o&&t.isIndexed?o=e&&ED(e,"ELEMENT_INDEX_UINT32")?5125:5123:o||(o=5126),t.logicalType=i,t.type=o;let a=function(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===t.fp64&&(a=Float32Array),t.bytesPerElement=a.BYTES_PER_ELEMENT,this.defaultType=a,this.value=null,this.settings=t,this.state={externalBuffer:null,bufferAccessor:t,allocatedValue:null,constant:!1},this._buffer=null,this.setData(t)}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new rr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*RE(e):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Qy.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function(n,e){const t=nV(n,e);return{high:t,low:zn(ht({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new SD(this,s.high),i["".concat(e,"64Low")]=r?new SD(this,s.low):new Float32Array(this.size),i}if(t){const i=nV(this.getAccessor(),t);return{[e]:new SD(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(e){const{state:t}=this;ArrayBuffer.isView(e)?e={value:e}:e instanceof rr&&(e={buffer:e});const i=ht(ht({},this.settings),e);if(t.bufferAccessor=i,e.constant){let r=e.value;if(r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r)),t.constant&&this._areValuesEqual(r,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=r}else if(e.buffer){const r=e.buffer;t.externalBuffer=r,t.constant=!1,this.value=e.value;const s=e.value instanceof Float64Array;i.type=e.type||r.accessor.type,i.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(s?2:1),i.stride=RE(i)}else if(e.value){this._checkExternalBuffer(e);let r=e.value;t.externalBuffer=null,t.constant=!1,this.value=r,i.bytesPerElement=r.BYTES_PER_ELEMENT,i.stride=RE(i);const{buffer:s,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=TD(r,i));const a=r.byteLength+o+2*i.stride;s.byteLength<a&&s.reallocate(a),s.setAccessor(null),s.subData({data:r,offset:o}),i.type=e.type||s.accessor.type}return!0}updateSubBuffer(e={}){const{value:t}=this,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?TD(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:e,copy:t=!1}){const{state:i}=this,r=i.allocatedValue,s=Qy.allocate(r,e+1,{size:this.size,type:this.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?TD(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!e.constant&&t){const i=this.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&ki.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t={}){super(e,t);const{transition:i=!1,noAlloc:r=!1,update:s=null,accessor:o=null,transform:a=null,startIndices:l=null}=t;Object.assign(this.settings,{transition:i,noAlloc:r,update:s||o&&this._autoUpdater,accessor:o,transform:a}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:PE,startIndices:l}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return lV(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function(n,e){if(n===PE||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=PE}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Jne}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}update(e){this.setData(e)}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate({numInstances:e,copy:t.updateRanges!==PE}),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(r,this,{data:t,startRow:c,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[c,u]of s){const h=Number.isFinite(c)?this.getVertexOffset(c):0,p=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:p})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;return e?!r.noAlloc&&(i.binaryValue===e?(this.clearNeedsUpdate(),!0):(i.binaryValue=e,this.setNeedsRedraw(),ArrayBuffer.isView(e)&&(e={value:e}),r.transform||t!==this.startIndices?(ic(ArrayBuffer.isView(e.value),"invalid ".concat(r.accessor)),i.binaryAccessor=function(n,{size:e,stride:t,offset:i,startIndices:r,nested:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:e,l=i?i/o:0,c=Math.floor((n.length-l)/a);return(u,{index:h,target:p})=>{if(!r){const C=h*a+l;for(let R=0;R<e;R++)p[R]=n[C+R];return p}const g=r[h],m=r[h+1]||c;let E;if(s){E=new Array(m-g);for(let C=g;C<m;C++){const R=C*a+l;p=new Array(e);for(let z=0;z<e;z++)p[z]=n[R+z];E[C-g]=p}}else if(a===e)E=n.subarray(g*e+l,m*e+l);else{E=new n.constructor((m-g)*e);let C=0;for(let R=g;R<m;R++){const z=R*a+l;for(let de=0;de<e;de++)E[C++]=n[z+de]}}return E}}(e.value,{size:e.size||this.size,stride:e.stride,offset:e.offset,startIndices:t,nested:e.size&&e.size!==this.size}),!1):(this.clearNeedsUpdate(),this.setData(e),!0))):(i.binaryValue=null,i.binaryAccessor=null,!1)}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:p,transform:g}=a,m=l.binaryAccessor||("function"==typeof p?p:s[p]);ic("function"==typeof m,'accessor "'.concat(p,'" is not a function'));let E=e.getVertexOffset(i);const{iterable:C,objectInfo:R}=sV(t,i,r);for(const z of C){R.index++;let de=m(z,R);if(g&&(de=g.call(this,de)),h){const Ie=(R.index<h.length-1?h[R.index+1]:o)-h[R.index];if(de&&Array.isArray(de[0])){let Be=E;for(const Ne of de)e._normalizeValue(Ne,c,Be),Be+=u}else de&&de.length>u?c.set(de,E):(e._normalizeValue(de,R.target,0),Zne({target:c,source:R.target,start:E,count:Ie}));E+=Ie*u}else e._normalizeValue(de,c,E),E+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}let OD={};function Eo(n){ki.level>0&&OD[n]&&OD[n].call(...arguments)}function Ra(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const fV="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",sie=`#version 300 es\n${fV}`;function pV(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function gV(n={}){const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?sie:e>300?`#version ${e}\n${fV}`:"void main() {gl_FragColor = vec4(0);}";const s=function(n,e){switch(e){case"float":return`vec4(${n}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${n}, 0.0, 1.0)`;case"vec3":return`vec4(${n}, 1.0)`;case"vec4":return n;default:return Ra(!1),null}}(t,i);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${i} ${t};\nout vec4 ${r};\nvoid main() {\n  ${r} = ${s};\n}`:`varying ${i} ${t};\nvoid main() {\n  gl_FragColor = ${s};\n}`}class mV extends Vu{static isSupported(e){return _i(e)}constructor(e,t={}){Vo(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(e={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Eg(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(e={}){return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,fn.warn(()=>`${this.id} unused varying buffer ${e}`)(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(e=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof rr?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t,i=0,r){const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,i,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class cie{constructor(e,t={}){this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(e={}){const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(e={}){const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof rr?i:i.buffer:null}getData(e={}){const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(e={}){this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&sn(_i(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(e={}){const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,{model:t}){const{program:i}=t;e.transformFeedback=new mV(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],sn(i[s]instanceof rr)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new rr(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function _V(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const tv="vs",hie={[tv]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},NE="__LUMA_INJECT_DECLARATIONS__",yV=/void\s+main\s*\([^)]*\)\s*\{\n?/,vV=/}\n?[^{}]*$/,PD=[];function bV(n,e,t,i=!1){const r=e===tv;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),PD.length=o.length;for(let l=0,c=o.length;l<c;++l)PD[l]=o[l].injection;const a=`${PD.join("\n")}\n`;switch(s){case"vs:#decl":r&&(n=n.replace(NE,a));break;case"vs:#main-start":r&&(n=n.replace(yV,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(vV,l=>a+l));break;case"fs:#decl":r||(n=n.replace(NE,a));break;case"fs:#main-start":r||(n=n.replace(yV,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(vV,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(NE,""),i&&(n=n.replace(/\}\s*$/,s=>s+hie[e])),n}function ND(n){const e={};return Ra(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?`${e[i]}\n${t[i]}`:t[i]}),e}const fie={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},FE="transform_uSize_",wV="transform_position";const wie={10241:9728,10240:9728,10242:33071,10243:33071};class Sie{constructor(e,t={}){this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(e={}){const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(e={}){const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const h in this.samplerTextureMap)a[h]=i[this.samplerTextureMap[h]];this._setSourceTextureParameters();const u=function({sourceTextureMap:n,targetTextureVarying:e,targetTexture:t}){const i={};let r,s;e&&(({width:r,height:s}=t),i[`${FE}${e}`]=[r,s]);for(const o in n)({width:r,height:s}=n[o]),i[`${FE}${o}`]=[r,s];return i}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(e={}){this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData({packed:e=!1}={}){const{framebuffer:t}=this.bindings[this.currentIndex],i=AE(t);if(!e)return i;const r=i.constructor,s=function(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ra(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(e={}){const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof Ia)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(e={}){const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new rr(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new Rs(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(wie)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function(n,e){sn(n instanceof Ia||n instanceof rne||n instanceof sne);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(e);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(e={}){const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function({vs:n,sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}){let s=Object.keys(e).length,o=null;const a={};let l=n,c={};if(s>0||t){const u=l.split("\n"),h=u.slice();if(u.forEach((p,g,m)=>{if(s>0){const E=function(n,e){const t={},i=function(n){return pV(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o=`// ${n} => Replaced by Transform with a sampler`,{samplerName:a,sizeName:l,uniformDeclerations:c}=function(n){const e=`transform_uSampler_${n}`,t=`${FE}${n}`;return{samplerName:e,sizeName:t,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${t};`}}(s),h=`  ${r} ${s} = transform_getInput(${a}, ${l}).${function(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ra(!1),null}}(r)};\n`;return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":h},samplerTextureMap:t}}return null}(p,e);if(E){const{updatedLine:C,inject:R}=E;h[g]=C,c=ND([c,R]),Object.assign(a,E.samplerTextureMap),s--}}t&&!o&&(o=function(n,e){const t=pV(n,["varying","out"]);return t&&t.name===e?t.type:null}(p,t))}),t){sn(i);const p=`${FE}${t}`;c=ND([c,{"vs:#decl":`uniform vec2 ${p};\n`,"vs:#main-start":`     vec2 ${wV} = transform_getPos(${p});\n     gl_Position = vec4(${wV}, 0, 1.);\n`}])}l=h.join("\n")}return{vs:l,targetTextureType:o,inject:c,samplerTextureMap:a}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=ND([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||gV({version:_V(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[fie].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}const FD={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function xie(n){let e=EV(n);return"object"===e?n?"type"in n?Object.assign({},n,FD[n.type]):"value"in n?(e=EV(n.value),Object.assign({type:e},n,FD[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},FD[e])}function EV(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class LD{constructor({name:e,vs:t,fs:i,dependencies:r=[],uniforms:s,getUniforms:o,deprecations:a=[],defines:l={},inject:c={},vertexShader:u,fragmentShader:h}){Ra("string"==typeof e),this.name=e,this.vs=t||u,this.fs=i||h,this.getModuleUniforms=o,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(c),s&&(this.uniforms=function(n){const e={};for(const t in n){const r=xie(n[t]);e[t]=r}return e}(s))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Ra(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${t}// END MODULE_${this.name}\n\n`}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}}),e}_defaultGetUniforms(e={}){const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Ra(s.validate(e[r],s),`${this.name}: invalid ${r}`),t[r]=e[r]):t[r]=s.value}return t}}function Die(n){return function(n){const e={},t={};return kD({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(CV(n))}function kD({modules:n,level:e,moduleMap:t,moduleDepth:i}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const r of n)t[r.name]=r,(void 0===i[r.name]||i[r.name]<e)&&(i[r.name]=e);for(const r of n)r.dependencies&&kD({modules:r.dependencies,level:e+1,moduleMap:t,moduleDepth:i})}function CV(n,e){return n.map(t=>(t instanceof LD||(Ra("string"!=typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),Ra(t.name,"shader module has no name"),(t=new LD(t)).dependencies=CV(t.dependencies)),t))}const BD={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},yf={};function kie(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/Apple/i)||e.match(/Apple/i)?"APPLE":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN"}Object.keys(BD).forEach(n=>{yf[n]=n});const VD={};function xV(n,e,t={}){const i=BD[e];if(Ra(i,e),!function(n={}){const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}(t))return!0;if(e in VD)return VD[e];const o=`#extension GL_${i[0]} : ${t.behavior||"enable"}\nvoid main(void) {}`,a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),VD[e]=l,l}function LE(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function(n,e){const t=BD[e];Ra(t,e);const i=function(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return Ra(!1===r||!0===r),r}(n,t))}function Ag(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const TV=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Uie=[...TV,[Ag("attribute"),"in $1"],[Ag("varying"),"out $1"]],zie=[...TV,[Ag("varying"),"in $1"]],AV=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Hie=[...AV,[Ag("in"),"attribute $1"],[Ag("out"),"varying $1"]],Gie=[...AV,[Ag("in"),"varying $1"]],jD="gl_FragColor",UD=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,$ie=/void\s+main\s*\([^)]*\)\s*\{\n?/;function kE(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const Kie=`\n\n${NE}\n\n`,MV={[tv]:"vertex",fs:"fragment"};function DV(n,{id:e,source:t,type:i,modules:r,defines:s={},hookFunctions:o=[],inject:a={},transpileToGLSL100:l=!1,prologue:c=!0,log:u}){Ra("string"==typeof t,"shader source must be a string");const h=i===tv,p=t.split("\n");let g=100,m="",E=t;0===p[0].indexOf("#version ")?(g=300,m=p[0],E=p.slice(1).join("\n")):m=`#version ${g}`;const C={};r.forEach(Ne=>{Object.assign(C,Ne.getDefines())}),Object.assign(C,s);let R=c?`${m}\n${function({id:n,source:e,type:t}){return n&&"string"==typeof n&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${n}_${MV[t]}\n\n`:""}({id:e,source:t,type:i})}\n${function({type:n}){return`\n#define SHADER_TYPE_${MV[n].toUpperCase()}\n`}({type:i})}\n${function(n){switch(function(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:kie(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n"}}(n)}\n${function(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return LE(n,yf.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),LE(n,yf.GLSL_DERIVATIVES)&&xV(n,yf.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),LE(n,yf.GLSL_FRAG_DATA)&&xV(n,yf.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),LE(n,yf.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n)}\n${function(n={}){let e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+=`#define ${i.toUpperCase()} ${n[i]}\n`)}return 0===e&&(t+="\n"),t}(C)}\n${h?"":"precision highp float;\n\n"}\n`:`${m}\n`;const z=function(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(o),de={},Ie={},Be={};for(const Ne in a){const ct="string"==typeof a[Ne]?{injection:a[Ne],order:0}:a[Ne],Dt=Ne.match(/^(v|f)s:(#)?([\w-]+)$/);if(Dt){const Lt=Dt[3];Dt[2]?"decl"===Lt?Ie[Ne]=[ct]:Be[Ne]=[ct]:de[Ne]=[ct]}else Be[Ne]=[ct]}for(const Ne of r){u&&Ne.checkDeprecations(E,u),R+=Ne.getModuleSource(i,g);const Dt=Ne.injections[i];for(const Ot in Dt){const Lt=Ot.match(/^(v|f)s:#([\w-]+)$/);if(Lt){const en="decl"===Lt[2]?Ie:Be;en[Ot]=en[Ot]||[],en[Ot].push(Dt[Ot])}else de[Ot]=de[Ot]||[],de[Ot].push(Dt[Ot])}}return R+=Kie,R=bV(R,i,Ie),R+=function(n,e){let t="";for(const i in n){const r=n[i];if(t+=`void ${r.signature} {\n`,r.header&&(t+=`  ${r.header}`),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+=`  ${o.injection}\n`}r.footer&&(t+=`  ${r.footer}`),t+="}\n"}return t}(z[i],de),R+=E,R=bV(R,i,Be),R=function(n,e,t){switch(e){case 300:return t?kE(n,Uie):function(n){const e=(n=kE(n,zie)).match(UD);if(e){const t=e[1];n=n.replace(new RegExp(`\\b${jD}\\b`,"g"),t)}else{const t="fragmentColor";n=n.replace($ie,i=>`out vec4 ${t};\n${i}`).replace(new RegExp(`\\b${jD}\\b`,"g"),t)}return n}(n);case 100:return t?kE(n,Hie):function(n){const e=(n=kE(n,Gie)).match(UD);if(e){const t=e[1];n=n.replace(UD,"").replace(new RegExp(`\\b${t}\\b`,"g"),jD)}return n}(n);default:throw new Error(`unknown GLSL version ${e}`)}}(R,l?100:g,h),R}function Zie(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const rre={5126:Cr.bind(null,"uniform1fv",Pa,1,So),35664:Cr.bind(null,"uniform2fv",Pa,2,So),35665:Cr.bind(null,"uniform3fv",Pa,3,So),35666:Cr.bind(null,"uniform4fv",Pa,4,So),5124:Cr.bind(null,"uniform1iv",eh,1,So),35667:Cr.bind(null,"uniform2iv",eh,2,So),35668:Cr.bind(null,"uniform3iv",eh,3,So),35669:Cr.bind(null,"uniform4iv",eh,4,So),35670:Cr.bind(null,"uniform1iv",eh,1,So),35671:Cr.bind(null,"uniform2iv",eh,2,So),35672:Cr.bind(null,"uniform3iv",eh,3,So),35673:Cr.bind(null,"uniform4iv",eh,4,So),35674:Cr.bind(null,"uniformMatrix2fv",Pa,4,zu),35675:Cr.bind(null,"uniformMatrix3fv",Pa,9,zu),35676:Cr.bind(null,"uniformMatrix4fv",Pa,16,zu),35678:no,35680:no,5125:Cr.bind(null,"uniform1uiv",BE,1,So),36294:Cr.bind(null,"uniform2uiv",BE,2,So),36295:Cr.bind(null,"uniform3uiv",BE,3,So),36296:Cr.bind(null,"uniform4uiv",BE,4,So),35685:Cr.bind(null,"uniformMatrix2x3fv",Pa,6,zu),35686:Cr.bind(null,"uniformMatrix2x4fv",Pa,8,zu),35687:Cr.bind(null,"uniformMatrix3x2fv",Pa,6,zu),35688:Cr.bind(null,"uniformMatrix3x4fv",Pa,12,zu),35689:Cr.bind(null,"uniformMatrix4x2fv",Pa,8,zu),35690:Cr.bind(null,"uniformMatrix4x3fv",Pa,12,zu),35678:no,35680:no,35679:no,35682:no,36289:no,36292:no,36293:no,36298:no,36299:no,36300:no,36303:no,36306:no,36307:no,36308:no,36311:no},sre={},ore={},are={},IV=[0];function zD(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(IV[0]=n,n=IV);const r=n.length;if(r%e&&fn.warn(`Uniform size should be multiples of ${e}`,n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Pa(n,e){return zD(n,e,Float32Array,sre)}function eh(n,e){return zD(n,e,Int32Array,ore)}function BE(n,e){return zD(n,e,Uint32Array,are)}function OV(n,e,t){const i=rre[t.type];if(!i)throw new Error(`Unknown GLSL uniform type ${t.type}`);return i().bind(null,n,e)}function lre(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function ure(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof Cg||n instanceof xg)||n instanceof Rs&&Boolean(n.texture)}function dre(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function no(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Cr(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),u=c.length;let h=!1;if(null===r)r=new Float32Array(u),s=u,h=!0;else{sn(s===u,"Uniform length cannot change.");for(let p=0;p<u;++p)if(c[p]!==r[p]){h=!0;break}}return h&&(i(o,n,a,c),r.set(c)),h}}function So(n,e,t,i){n[e](t,i)}function zu(n,e,t,i){n[e](t,!1,i)}function VE(n,e="unnamed"){const i=n.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e}function PV(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+=`${r}\n`,n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0;t+=NV(`^^^ ${a}: ${s.substring(o.join(":").length+1).trim()}\n\n`,l)}}return t}function NV(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return`${t}${n}`}class nv extends Vu{static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return sn(!1),"unknown"}}constructor(e,t){TE(e),sn("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:VE(t.source,null)||t.id||Gc(`unnamed ${nv.getTypeName(t.shaderType)}`)}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize({source:e}){const t=VE(e,null);t&&(this.id=Gc(t)),this._compile(e)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return`${nv.getTypeName(this.shaderType)}:${this.id}`}getName(){return VE(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(e=this.source){if(e.startsWith("#version ")||(e=`#version 100\n${e}`),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||VE(e)||"(unnamed)",l=`${function(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)} shader ${a}`;for(let u=0;u<r.length;u++){const h=r[u];if(h.length<=1)continue;const p=h.split(":"),g=p[0],m=parseInt(p[2],10);if(isNaN(m))throw new Error(`GLSL compilation error in ${l}: ${n}`);"WARNING"!==g?s[m]=h:o[m]=h}const c=function(n,e=1,t=": "){const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return NV(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:PV(s,c),warnings:PV(o,c)}}(i,this.source,this.shaderType,this.id);throw fn.error(`GLSL compilation errors in ${r}\n${s}`)(),fn.warn(`GLSL compilation warnings in ${r}\n${o}`)(),new Error(`GLSL compilation errors in ${r}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class HD extends nv{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class GD extends nv{constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Ps=5126,iv=5124,rv=5125,$D={[Ps]:[Ps,1,"float"],35664:[Ps,2,"vec2"],35665:[Ps,3,"vec3"],35666:[Ps,4,"vec4"],[iv]:[iv,1,"int"],35667:[iv,2,"ivec2"],35668:[iv,3,"ivec3"],35669:[iv,4,"ivec4"],[rv]:[rv,1,"uint"],36294:[rv,2,"uvec2"],36295:[rv,3,"uvec3"],36296:[rv,4,"uvec4"],35670:[Ps,1,"bool"],35671:[Ps,2,"bvec2"],35672:[Ps,3,"bvec3"],35673:[Ps,4,"bvec4"],35674:[Ps,8,"mat2"],35685:[Ps,8,"mat2x3"],35686:[Ps,8,"mat2x4"],35675:[Ps,12,"mat3"],35687:[Ps,12,"mat3x2"],35688:[Ps,12,"mat3x4"],35676:[Ps,16,"mat4"],35689:[Ps,16,"mat4x2"],35690:[Ps,16,"mat4x3"]};function jV(n){const e=$D[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function UV(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=Ps}for(const t in $D){const[i,r,s]=$D[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class $re{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!_i(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=jV(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new aa(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=jV(i),l={location:e,name:t,accessor:new aa({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const Wre=35981,qre=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class HV extends Vu{constructor(e,t={}){super(e,t),this.stubRemovedMethods("Program","v6.0",qre),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(e={}){const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=Wre}=e;return this.hash=t||"",this.vs="string"==typeof i?new HD(this.gl,{id:`${e.id}-vs`,source:i}):i,this.fs="string"==typeof r?new GD(this.gl,{id:`${e.id}-fs`,source:r}):r,sn(this.vs instanceof HD),sn(this.fs instanceof GD),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Vo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new $re(this),this.setProps(e)}delete(e={}){return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw({logPriority:e,drawMode:t=4,vertexCount:i,offset:r=0,start:s,end:o,isIndexed:a=!1,indexType:l=5123,instanceCount:c=0,isInstanced:u=c>0,vertexArray:h=null,transformFeedback:p,framebuffer:g,parameters:m={},uniforms:E,samplers:C}){if((E||C)&&(fn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(E||{})),fn.priority>=e){const R=g?g.id:"default",z=`mode=${Zd(this.gl,t)} verts=${i} instances=${c} indexType=${Zd(this.gl,l)} isInstanced=${u} isIndexed=${a} Framebuffer=${R}`;fn.log(e,z)()}return sn(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||u&&0===c||(h.bindForDraw(i,c,()=>{if(void 0!==g&&(m=Object.assign({},m,{framebuffer:g})),p){const R=function(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return sn(!1),0}}(t);p.begin(R)}this._bindTextures(),nc(this.gl,m,()=>{a&&u?this.gl2.drawElementsInstanced(t,i,l,r,c):a&&_i(this.gl)&&!isNaN(s)&&!isNaN(o)?this.gl2.drawRangeElements(t,s,o,i,l,r):a?this.gl.drawElements(t,i,l,r):u?this.gl2.drawArraysInstanced(t,r,i,c):this.gl.drawArrays(t,r,i)}),p&&p.end()}),0))}setUniforms(e={}){fn.priority>=2&&function(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!ure(r))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${i}`,r),new Error(`${e} Bad uniform ${i}`)}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof Rs&&(s=s.texture),s instanceof Cg)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&dre(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new HD({handle:r});break;case 35632:i.fs=new GD({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=Gc(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?`${e}-program`:"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),fn.time(4,`linkProgram for ${this._getName()}`)(),e.linkProgram(this.handle),fn.timeEnd(4,`linkProgram for ${this._getName()}`)(),e.debug||fn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${e.getProgramInfoLog(this.handle)}`);if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${e.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=lre(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=OV(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,`${r}[${o}]`),this._uniformSetters[`${r}[${o}]`]=OV(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class sv{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new sv(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(e={}){const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(t),h=this._getHash(i),p=c.map(de=>this._getHash(de.name)).sort(),g=o.map(de=>this._getHash(de)),m=Object.keys(r).sort(),E=Object.keys(s).sort(),C=[],R=[];for(const de of m)C.push(this._getHash(de)),C.push(this._getHash(r[de]));for(const de of E)R.push(this._getHash(de)),R.push(this._getHash(s[de]));const z=`${u}/${h}D${C.join("/")}M${p.join("/")}I${R.join("/")}V${g.join("/")}H${this.stateHash}B${a}${l?"T":""}`;if(!this._programCache[z]){const de=function(n,e){const{vs:t,fs:i}=e,r=Die(e.modules||[]);return{gl:n,vs:DV(n,Object.assign({},e,{source:t,type:tv,modules:r})),fs:DV(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:Zie(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[z]=new HV(this.gl,{hash:z,vs:de.vs,fs:de.fs,varyings:o,bufferMode:a}),this._getUniforms[z]=de.getUniforms||(Ie=>{}),this._useCounts[z]=0}return this._useCounts[z]++,this._programCache[z]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}let UE=null;class Na extends Vu{static isSupported(e,t={}){return!t.constantAttributeZero||_i(e)||"Chrome"===function(n){if(!rD())return"Node";if(tB(n))return"Electron";const t=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":Gy.chrome?"Chrome":Gy.safari?"Safari":Gy.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Na(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Na.MAX_ATTRIBUTES=Na.MAX_ATTRIBUTES||e.getParameter(34921),Na.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:Na._setConstantFloatArray(e,t,i);break;case Int32Array:Na._setConstantIntArray(e,t,i);break;case Uint32Array:Na._setConstantUintArray(e,t,i);break;default:sn(!1)}}constructor(e,t={}){super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Na.getMaxAttributes(this.gl)}initialize(e={}){return this.setProps(e)}setProps(e){return this}setElementBuffer(e=null,t={}){return sn(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=i,{gl:h,gl2:p}=this;return e=Number(e),this.bind(()=>{h.bindBuffer(34962,t.handle),c?(sn(_i(h)),p.vertexAttribIPointer(e,r,s,o,a)):h.vertexAttribPointer(e,r,s,l,o,a),h.enableVertexAttribArray(e),p.vertexAttribDivisor(e,u||0)}),this}enable(e,t=!0){return!t&&0===e&&!Na.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new rr(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function(n,e){return new n(function(n){return(!UE||UE.byteLength<n)&&(UE=new ArrayBuffer(n)),UE}(n.BYTES_PER_ELEMENT*e),0,e)}(t.constructor,s);(function({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:sn(!1)}}static _setConstantIntArray(e,t,i){switch(sn(_i(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:sn(!1)}}static _setConstantUintArray(e,t,i){switch(sn(_i(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:sn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,{location:t}){return sn(Number.isFinite(t)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(t,e);default:return this.gl.getVertexAttrib(t,e)}})}}const ese=/^(.+)__LOCATION_([0-9]+)$/,tse=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class nse{constructor(e,t={}){this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Na(e),IB(this,"VertexArray","v6.0",tse),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(e={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(e=null,t={}){return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t,i={}){if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t,i={}){const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new rr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof rr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof rr&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,fn.once(3,()=>`unused value ${e} in ${this.id}`)(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=aa.resolve(l.accessor,this.accessors[o]||{},i,r),{size:h,type:p}=u;return sn(Number.isFinite(h)&&Number.isFinite(p)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=ese.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof rr)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof rr)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof rr))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(Na.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){Na.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof rr){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(e=null,t={}){return fn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function ov(n,e={}){const{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return function(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=","+(o%i==0?" ":"")),r+=ov(n[o],e);return`${r}${n.length>t?"...":"]"}`}(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<1e-16)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function GV(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,u,h,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof rr){const p=e,{data:g,changed:m}=p.getDebugData();let E;return u=m?"*":"",h=g,l=p.byteLength,a=l/g.BYTES_PER_ELEMENT/o,t?E=`${t.divisor>0?"I ":"P "} ${a} (x${o}=${l} bytes ${Zd(r,s)})`:(c=!0,E=`${l} bytes`),{[i]:`${u}${ov(h,{size:o,isInteger:c})}`,"Format ":E}}return h=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:`${ov(h,{size:o,isInteger:c})} (constant)`,"Format ":`${o}x${s} (constant)`}}function sse(n,e){const{type:t,size:i}=e,r=UV(t,i);return r?`${n} (${r.name})`:n}function $V({header:n="Uniforms",program:e,uniforms:t,undefinedOnly:i=!1}){sn(e);const s=".*Matrix",a={},l=Object.keys(e._uniformSetters).sort();let c=0;for(const p of l)!p.match(".*_.*")&&!p.match(s)&&WD({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)p.match(s)&&WD({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;for(const p of l)a[p]||WD({table:a,header:n,uniforms:t,uniformName:p,undefinedOnly:i})&&c++;let u=0;const h={};if(!i)for(const p in t){const g=t[p];a[p]||(u++,h[p]={Type:`NOT USED: ${g}`,[n]:ov(g)})}return{table:a,count:c,unusedTable:h,unusedCount:u}}function WD({table:n,header:e,uniforms:t,uniformName:i,undefinedOnly:r}){const s=t[i],o=function(n){return null!=n}(s);return!(r&&o||(n[i]={[e]:o?ov(s):"N/A","Uniform Type":o?s:"NOT PROVIDED"},0))}function WV(n){const{type:e,size:t}=n.accessor,i=UV(e,t);return i?`${i.name} ${n.name}`:n.name}const lse={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function use(n,e){const{attributeMap:t=lse}=e||{};return t&&t[n]||n}function dse(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}sn(Number.isFinite(e.size),`attribute ${n} needs size`)}const qV=()=>{},pse={};class zE{constructor(e,t={}){const{id:i=Gc("model")}=t;sn(xE(e)),this.id=i,this.gl=e,this.id=t.id||Gc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||sv.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},sn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return sn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return sn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=use(s,undefined);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=ht({},o);delete c.value,i[a]=[new rr(n,l),c],dse(s,c)}}if(r){const s=r.value||r;sn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new rr(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(e={}){if(Eg(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(e={}){return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return vD(this.program.gl,e),this}draw(e={}){this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),fn.priority>=2&&(c=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:h=u.isIndexed,indexType:p=u.indexType,indexOffset:g=u.indexOffset,vertexArrayInstanced:m=u.isInstanced}=this.props;m&&!this.isInstanced&&fn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:E,instanceCount:C}=this,{onBeforeRender:R=qV,onAfterRender:z=qV}=this.props;R(),this.program.setUniforms(this.uniforms);const de=this.program.draw(Object.assign(pse,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:h,indexType:p,isInstanced:E,instanceCount:C,offset:h?g:0}));return z(),fn.priority>=2&&this._logDrawCallEnd(c,l,i),de}transform(e={}){const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(e={}){return fn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}sn(t instanceof HV,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new nse(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof rr&&t.delete()}}_setAnimationProps(e){this.animated&&sn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(e={}){if(Eg(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new mV(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),fn.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:fn.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function({vertexArray:n,header:e="Attributes"}){if(!n.configuration)return{};const t={};n.elements&&(t.ELEMENT_ARRAY_BUFFER=GV(n,n.elements,null,e));const i=n.values;for(const r in i){const s=n._getAttributeInfo(r);if(s){let o=`${r}: ${s.name}`;const a=n.accessors[s.location];a&&(o=`${r}: ${sse(s.name,a)}`),t[o]=GV(n,i[r],a,e)}}return t}({vertexArray:t,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=$V({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:u}=$V({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&fn.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&fn.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(n){const e={},t=`Accessors for ${n.id}`;for(const i of n.attributeInfos)i&&(e[`in ${WV(i)}`]={[t]:JSON.stringify(i.accessor)});for(const i of n.varyingInfos)i&&(e[`out ${WV(i)}`]={[t]:JSON.stringify(i.accessor)});return e}(this.vertexArray.configuration);fn.table(e,s)(),fn.table(e,o)(),fn.table(e+1,h)(),r&&r.log({logLevel:2,message:`Rendered to ${r.id}`}),fn.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class qD{static isSupported(e){return _i(e)}constructor(e,t={}){this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(e={}){const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();sn(e,"Nothing to swap")}getBuffer(e=null){return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(e={}){const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(e={}){"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(e={}){const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new zE(t,Object.assign({},e,{fs:e.fs||gV({version:_V(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function(n){return!(Eg(n.feedbackBuffers)&&Eg(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new cie(e,t)),function(n){return!(Eg(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new Sie(e,t)),sn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}function HE(){}const _se={onStart:HE,onUpdate:HE,onInterrupt:HE,onEnd:HE};class av{constructor(e){this._inProgress=!1,this._handle=null,this.timeline=e,this.settings={}}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=ht(ht({},_se),e),this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const xse={interpolation:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="interpolation",this.transition=new av(i),this.attribute=t,this.attributeInTransition=new ID(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function(n,e){const t=uV(e.size);return new qD(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new rr(e,r),new rr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();const{buffers:r,attribute:s}=this;dV(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)hV(ht({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=DD(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:cV(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{time:t,settings:{duration:i,easing:r}}=this.transition,s=r(t/i);this.transform.run({uniforms:{time:s}})}return e}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:e,attribute:t,timeline:i}){this.gl=e,this.type="spring",this.transition=new av(i),this.attribute=t,this.attributeInTransition=new ID(e,zn(ht({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function(n){return new Ia(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function(n,e){return new Rs(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function(n,e,t){const i=uV(e.size);return new qD(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new rr(e,r),new rr(e,r),new rr(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)hV(ht({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=DD(s,t),this.attributeInTransition.update({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:cV(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;return!!r.update()&&(t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),dV(e),this.attributeInTransition.update({buffer:e[1],value:this.attribute.value}),AE(i)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Tse{constructor(e,{id:t,timeline:i}){this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=qD.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void ki.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=xse[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(ki.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const YV="attributeManager.invalidate";class Rse{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Tse(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(e=!0){return this.needsRedraw=!0,this}add(e,t){this._add(e,t)}addInstanced(e,t){this._add(e,t,{instanced:1})}remove(e){for(let t=0;t<e.length;t++){const i=e[t];void 0!==this.attributes[i]&&(this.attributes[i].delete(),delete this.attributes[i])}}invalidate(e,t){const i=this._invalidateTrigger(e,t);Eo(YV,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Eo(YV,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}={}){let l=!1;Eo("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],h=u.settings.accessor;u.startIndices=i,s[c]&&ki.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue(o[h],e.startIndices)||!o[h]&&u.setConstantValue(s[h])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw|=u.needsRedraw()}l&&Eo("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=ht({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}getAccessors(){return this.updateTriggers}_add(e,t,i={}){t&&ki.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in e)this.attributes[r]=this._createAttribute(r,e[r],i);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=zn(ht({},t),{id:e,isIndexed:t.isIndexed||t.elements||!1,constant:t.constant||!1,size:(t.elements?1:t.size)||1,value:t.value||null,divisor:t.instanced||i.instanced?1:t.divisor||0});return new ID(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;Eo("attribute.updateStart",t),t.allocate(i)&&Eo("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,Eo("attribute.updateEnd",t,i))}}function XV(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function QV(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const Lse={interpolation:class extends av{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=ME(t,i,o)}},spring:class extends av{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=XV(n[o],e[o],t[o],i,r);return s}return XV(n,e,t,i,r)}(s,o,t,i,r);const l=QV(a,t),c=QV(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class kse{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=lV(r)))return;const o=Lse[r.type];if(!o)return void ki.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(zn(ht({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}const GE={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")},{COMPONENT:Bse}=GE;function Use(n,e){if(!n.transitions)return null;const t={},i=KD(n);for(const r in n.transitions){const s=i[r],o=s&&s.type;("number"===o||"color"===o||"array"===o)&&YD(n[r],e[r],s)&&(t[r]=!0)}return t}function ZV({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}={}){if(e===n)return null;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=YD(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=YD(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return null}function YD(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function Gse(n,e){if(null===e)return"oldProps is null, initial diff";const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function JV(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,ZV({oldProps:r,newProps:i,triggerName:t})}function KD(n){const e=n[Bse],t=e&&e.constructor;return t?t._propTypes:{}}function Xse(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function $E(n){let t,e={};return i=>{for(const r in i)if(!Xse(i[r],e[r])){t=n(i),e=i;break}return t}}function Qse(n,e){if(!e)return n;const t=ht(ht({},n),e);if("defines"in e&&(t.defines=ht(ht({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=ht({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function XD(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],g=e[11],m=e[12],E=e[13],C=e[14],R=e[15],z=t*a-i*o,de=t*l-r*o,Ie=t*c-s*o,Be=i*l-r*a,Ne=i*c-s*a,ct=r*c-s*l,Dt=u*E-h*m,Ot=u*C-p*m,Lt=u*R-g*m,Zt=h*C-p*E,en=h*R-g*E,Et=p*R-g*C,Ct=z*Et-de*en+Ie*Zt+Be*Lt-Ne*Ot+ct*Dt;return Ct?(n[0]=(a*Et-l*en+c*Zt)*(Ct=1/Ct),n[1]=(r*en-i*Et-s*Zt)*Ct,n[2]=(E*ct-C*Ne+R*Be)*Ct,n[3]=(p*Ne-h*ct-g*Be)*Ct,n[4]=(l*Lt-o*Et-c*Ot)*Ct,n[5]=(t*Et-r*Lt+s*Ot)*Ct,n[6]=(C*Ie-m*ct-R*de)*Ct,n[7]=(u*ct-p*Ie+g*de)*Ct,n[8]=(o*en-a*Lt+c*Dt)*Ct,n[9]=(i*Lt-t*en-s*Dt)*Ct,n[10]=(m*Ne-E*Ie+R*z)*Ct,n[11]=(h*Ie-u*Ne-g*z)*Ct,n[12]=(a*Ot-o*Zt-l*Dt)*Ct,n[13]=(t*Zt-i*Ot+r*Dt)*Ct,n[14]=(E*de-m*Be-C*z)*Ct,n[15]=(u*Be-h*de+p*z)*Ct,n):null}function vf(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],g=e[10],m=e[11],E=e[12],C=e[13],R=e[14],z=e[15],de=t[0],Ie=t[1],Be=t[2],Ne=t[3];return n[0]=de*i+Ie*a+Be*h+Ne*E,n[1]=de*r+Ie*l+Be*p+Ne*C,n[2]=de*s+Ie*c+Be*g+Ne*R,n[3]=de*o+Ie*u+Be*m+Ne*z,n[4]=(de=t[4])*i+(Ie=t[5])*a+(Be=t[6])*h+(Ne=t[7])*E,n[5]=de*r+Ie*l+Be*p+Ne*C,n[6]=de*s+Ie*c+Be*g+Ne*R,n[7]=de*o+Ie*u+Be*m+Ne*z,n[8]=(de=t[8])*i+(Ie=t[9])*a+(Be=t[10])*h+(Ne=t[11])*E,n[9]=de*r+Ie*l+Be*p+Ne*C,n[10]=de*s+Ie*c+Be*g+Ne*R,n[11]=de*o+Ie*u+Be*m+Ne*z,n[12]=(de=t[12])*i+(Ie=t[13])*a+(Be=t[14])*h+(Ne=t[15])*E,n[13]=de*r+Ie*l+Be*p+Ne*C,n[14]=de*s+Ie*c+Be*g+Ne*R,n[15]=de*o+Ie*u+Be*m+Ne*z,n}function WE(n,e,t){var o,a,l,c,u,h,p,g,m,E,C,R,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],p=e[6],g=e[7],m=e[8],E=e[9],C=e[10],R=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=p,n[7]=g,n[8]=m,n[9]=E,n[10]=C,n[11]=R,n[12]=o*i+u*r+m*s+e[12],n[13]=a*i+h*r+E*s+e[13],n[14]=l*i+p*r+C*s+e[14],n[15]=c*i+g*r+R*s+e[15]),n}function qE(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function ej(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],p=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+u*i,n[6]=a*r+h*i,n[7]=l*r+p*i,n[8]=c*r-s*i,n[9]=u*r-o*i,n[10]=h*r-a*i,n[11]=p*r-l*i,n}function tj(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],p=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+u*i,n[2]=a*r+h*i,n[3]=l*r+p*i,n[4]=c*r-s*i,n[5]=u*r-o*i,n[6]=h*r-a*i,n[7]=p*r-l*i,n}function nj(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function YE(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}!function(){var n=new la(4);la!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();const ij=[0,0,0,0],Coe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],xoe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Toe=[0,0,0],Aoe=[0,0,0],Moe=$E(function({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=ij,l=ij,c=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:p}=rj(n,e,t);return p&&(l=n.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=YE([],l,o),s=i||s,o=vf([],r,s),o=vf([],o,Coe)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}(n,t,i),u=n.getDistanceScales(),h=[n.width*e,n.height*e],p=n.projectionMatrix.transform([0,0,-n.focalDistance,1])[3]||1,g={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:p,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Toe,project_uScale:n.scale,project_uViewProjectionMatrix:s,project_uCameraPosition:a};if(c){const m=n.getDistanceScales(c);switch(t){case Pi.METER_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerMeter,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerMeter2;break;case Pi.LNGLAT:case Pi.LNGLAT_OFFSETS:g.project_uCommonUnitsPerWorldUnit=m.unitsPerDegree,g.project_uCommonUnitsPerWorldUnit2=m.unitsPerDegree2;break;case Pi.CARTESIAN:g.project_uCommonUnitsPerWorldUnit=[1,1,m.unitsPerMeter[2]],g.project_uCommonUnitsPerWorldUnit2=[0,0,m.unitsPerMeter2[2]]}}return g});function rj(n,e,t=Aoe){let r,i=t,s=!0;switch(r=e===Pi.LNGLAT_OFFSETS||e===Pi.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case zc.WEB_MERCATOR:(e===Pi.LNGLAT||e===Pi.CARTESIAN)&&(s=!1);break;case zc.WEB_MERCATOR_AUTO_OFFSET:e===Pi.LNGLAT?i=r:e===Pi.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case zc.IDENTITY:i=n.position.map(Math.fround);break;case zc.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}class Roe extends DE{get ELEMENTS(){return Uu(!1),0}get RANK(){return Uu(!1),0}toString(){let e="[";if(Sr.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=Zi(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function KE(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function sj(n,e){return n[0]=-e[0],n[1]=-e[1],n}function oj(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}!function(){var n=new la(2);la!=Float32Array&&(n[0]=0,n[1]=0)}();const aj=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Foe=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Loe=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Rg={};class $n extends Roe{static get IDENTITY(){return Rg.IDENTITY=Rg.IDENTITY||Object.freeze(new $n(aj)),Rg.IDENTITY}static get ZERO(){return Rg.ZERO=Rg.ZERO||Object.freeze(new $n(Foe)),Rg.ZERO}get INDICES(){return Loe}get ELEMENTS(){return 16}get RANK(){return 4}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,u,h,p,g,m,E,C){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=h,this[11]=p,this[12]=g,this[13]=m,this[14]=E,this[15]=C,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,u,h,p,g,m,E,C){return this[0]=e,this[1]=s,this[2]=c,this[3]=g,this[4]=t,this[5]=o,this[6]=u,this[7]=m,this[8]=i,this[9]=a,this[10]=h,this[11]=E,this[12]=r,this[13]=l,this[14]=p,this[15]=C,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(aj)}fromQuaternion(e){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,h=i*a,p=r*o,g=r*a,m=r*l,E=s*o,C=s*a,R=s*l;n[0]=1-h-m,n[1]=u+R,n[2]=p-C,n[3]=0,n[4]=u-R,n[5]=1-c-m,n[6]=g+E,n[7]=0,n[8]=p+C,n[9]=g-E,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum({left:e,right:t,bottom:i,top:r,near:s,far:o}){return o===1/0?$n._computeInfinitePerspectiveOffCenter(this,e,t,i,r,s):function(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,e,t,i,r,s,o),this.check()}static _computeInfinitePerspectiveOffCenter(e,t,i,r,s,o){const l=2*o/(s-r),c=(i+t)/(i-t),u=(s+r)/(s-r),g=-2*o;return e[0]=2*o/(i-t),e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=c,e[9]=u,e[10]=-1,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}lookAt(e,t,i){return 1===arguments.length&&({eye:e,center:t,up:i}=e),function(n,e,t,i){var r,s,o,a,l,c,u,h,p,g,m=e[0],E=e[1],C=e[2],R=i[0],z=i[1],de=i[2],Ie=t[0],Be=t[1],Ne=t[2];Math.abs(m-Ie)<$c&&Math.abs(E-Be)<$c&&Math.abs(C-Ne)<$c?function(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=m-Ie,h=E-Be,p=C-Ne,r=z*(p*=g=1/Math.hypot(u,h,p))-de*(h*=g),s=de*(u*=g)-R*p,o=R*h-z*u,(g=Math.hypot(r,s,o))?(r*=g=1/g,s*=g,o*=g):(r=0,s=0,o=0),a=h*o-p*s,l=p*r-u*o,c=u*s-h*r,(g=Math.hypot(a,l,c))?(a*=g=1/g,l*=g,c*=g):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=l,n[6]=h,n[7]=0,n[8]=o,n[9]=c,n[10]=p,n[11]=0,n[12]=-(r*m+s*E+o*C),n[13]=-(a*m+l*E+c*C),n[14]=-(u*m+h*E+p*C),n[15]=1)}(this,e,t=t||[0,0,0],i=i||[0,1,0]),this.check()}ortho({left:e,right:t,bottom:i,top:r,near:s=.1,far:o=500}){return function(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,e,t,i,r,s,o),this.check()}orthographic({fovy:e=45*Math.PI/180,aspect:t=1,focalDistance:i=1,near:r=.1,far:s=500}){if(e>2*Math.PI)throw Error("radians");const a=i*Math.tan(e/2),l=a*t;return(new $n).ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:s})}perspective({fovy:e,fov:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}={}){if((e=e||t)>2*Math.PI)throw Error("radians");return function(n,e,t,i,r){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i)}(this,e,i,r,s),this.check()}determinant(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],u=n[9],h=n[10],p=n[11],g=n[12],m=n[13],E=n[14],C=n[15];return(e*o-t*s)*(h*C-p*E)-(e*a-i*s)*(u*C-p*m)+(e*l-r*s)*(u*E-h*m)+(t*a-i*o)*(c*C-p*g)-(t*l-r*o)*(c*E-h*g)+(i*l-r*a)*(c*m-u*g)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e=[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=null){const i=this.getScale(t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return XD(this,this),this.check()}multiplyLeft(e){return vf(this,e,this),this.check()}multiplyRight(e){return vf(this,this,e),this.check()}rotateX(e){return ej(this,this,e),this.check()}rotateY(e){return function(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],p=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-u*i,n[2]=a*r-h*i,n[3]=l*r-p*i,n[8]=s*i+c*r,n[9]=o*i+u*r,n[10]=a*i+h*r,n[11]=l*i+p*r}(this,this,e),this.check()}rotateZ(e){return tj(this,this,e),this.check()}rotateXYZ([e,t,i]){return this.rotateX(e).rotateY(t).rotateZ(i)}rotateAxis(e,t){return function(n,e,t,i){var l,c,u,h,p,g,m,E,C,R,z,de,Ie,Be,Ne,ct,Dt,Ot,Lt,Zt,en,Et,Ct,Ht,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<$c||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),p=e[1],g=e[2],m=e[3],C=e[5],R=e[6],z=e[7],Ie=e[9],Be=e[10],Ne=e[11],Lt=r*s*(u=1-c)-o*l,Zt=s*s*u+c,en=o*s*u+r*l,Et=r*o*u+s*l,Ct=s*o*u-r*l,Ht=o*o*u+c,n[0]=(h=e[0])*(ct=r*r*u+c)+(E=e[4])*(Dt=s*r*u+o*l)+(de=e[8])*(Ot=o*r*u-s*l),n[1]=p*ct+C*Dt+Ie*Ot,n[2]=g*ct+R*Dt+Be*Ot,n[3]=m*ct+z*Dt+Ne*Ot,n[4]=h*Lt+E*Zt+de*en,n[5]=p*Lt+C*Zt+Ie*en,n[6]=g*Lt+R*Zt+Be*en,n[7]=m*Lt+z*Zt+Ne*en,n[8]=h*Et+E*Ct+de*Ht,n[9]=p*Et+C*Ct+Ie*Ht,n[10]=g*Et+R*Ct+Be*Ht,n[11]=m*Et+z*Ct+Ne*Ht,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return Array.isArray(e)?qE(this,this,e):qE(this,this,[e,e,e]),this.check()}translate(e){return WE(this,this,e),this.check()}transform(e,t){return 4===e.length?(IE(t=YE(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;switch(i){case 2:t=function(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}(t||[-0,-0],e,this);break;case 3:t=ZB(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return IE(t,e.length),t}transformAsVector(e,t){switch(e.length){case 2:t=function(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}(t||[-0,-0],e,this);break;case 3:t=JB(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return IE(t,e.length),t}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}transformPoint(e,t){return CD("Matrix4.transformPoint","3.0"),this.transformAsPoint(e,t)}transformVector(e,t){return CD("Matrix4.transformVector","3.0"),this.transformAsPoint(e,t)}transformDirection(e,t){return CD("Matrix4.transformDirection","3.0"),this.transformAsVector(e,t)}}function Pg(n,e){const t=YE([],e,n);return nj(t,t,1/t[3]),t}function lj(n,e){const t=n%e;return t<0?e+t:t}function cj(n,e,t){return n<e?e:n>t?t:n}const QD=Math.log2||function(n){return Math.log(n)*Math.LOG2E};function Hu(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const rc=Math.PI,uj=rc/4,sc=rc/180,ZD=180/rc,JD=4003e4,XE=85.051129;function QE([n,e]){return Hu(Number.isFinite(n)),Hu(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[512*(n*sc+rc)/(2*rc),512*(rc+Math.log(Math.tan(uj+e*sc*.5)))/(2*rc)]}function Ng([n,e]){const t=n/512*(2*rc)-rc,i=2*(Math.atan(Math.exp(e/512*(2*rc)-rc))-uj);return[t*ZD,i*ZD]}function eI({latitude:n,longitude:e,highPrecision:t=!1}){Hu(Number.isFinite(n)&&Number.isFinite(e));const i={},s=Math.cos(n*sc),o=512/360,a=o/s,l=512/JD/s;if(i.unitsPerMeter=[l,l,l],i.metersPerUnit=[1/l,1/l,1/l],i.unitsPerDegree=[o,a,l],i.degreesPerUnit=[1/o,1/a,1/l],t){const c=sc*Math.tan(n*sc)/s,h=512/JD*c,p=h/a*l;i.unitsPerDegree2=[0,o*c/2,h],i.unitsPerMeter2=[p,0,p]}return i}function dj(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=eI({longitude:t,latitude:i,highPrecision:!0}),u=QE(n);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=Ng(u),p=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],p]:h}function fj(n){return 2*Math.atan(.5/n)*ZD}function pj(n,e){const[t,i,r=0]=n;return Hu(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Pg(e,[t,i,r,1])}function cv(n,e,t=0){const[i,r,s]=n;if(Hu(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Pg(e,[i,r,s,1]);const o=Pg(e,[i,r,0,1]),a=Pg(e,[i,r,1,1]),l=o[2],c=a[2];return oj([],o,a,l===c?0:((t||0)-l)/(c-l))}const gj=Math.PI/180;function mj(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Pg(i,[e,0,1,1]),s=Pg(i,[e,n.height,1,1]),c=Ng(oj([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c[2]=t,c}const Yoe=Math.PI/180,Koe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],nI=[0,0,0],Qoe={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};let Fg=(()=>{class n{constructor(t={}){const{id:i=null,x:r=0,y:s=0,width:o=1,height:a=1}=t;this.id=i||this.constructor.displayName||"viewport",this.x=r,this.y=s,this.width=o||1,this.height=a||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?zc.WEB_MERCATOR:zc.WEB_MERCATOR_AUTO_OFFSET:zc.IDENTITY}equals(t){return t instanceof n&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Zy(t.projectionMatrix,this.projectionMatrix)&&Zy(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:i=!0}={}){const s=pj(this.projectPosition(t),this.pixelProjectionMatrix),[o,a]=s,l=i?a:this.height-a;return 2===t.length?[o,l]:[o,l,s[2]]}unproject(t,{topLeft:i=!0,targetZ:r}={}){const[s,o,a]=t,u=cv([s,i?o:this.height-o,a],this.pixelUnprojectionMatrix,r&&r*this.distanceScales.unitsPerMeter[2]),[h,p,g]=this.unprojectPosition(u);return Number.isFinite(a)?[h,p,g]:Number.isFinite(r)?[h,p,r]:[h,p]}projectPosition(t){const[i,r]=this.projectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[i,r]=this.unprojectFlat(t);return[i,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?QE(t):t}unprojectFlat(t){return this.isGeospatial?Ng(t):t}getBounds(t={}){const i={targetZ:t.z||0},r=this.unproject([0,0],i),s=this.unproject([this.width,0],i),o=this.unproject([0,this.height],i),a=this.unproject([this.width,this.height],i);return[Math.min(r[0],s[0],o[0],a[0]),Math.min(r[1],s[1],o[1],a[1]),Math.max(r[0],s[0],o[0],a[0]),Math.max(r[1],s[1],o[1],a[1])]}getDistanceScales(t=null){return t?eI({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:i,width:r=1,height:s=1}){return t<this.x+this.width&&this.x<t+r&&i<this.y+this.height&&this.y<i+s}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(n){const e={};return e.left=Tg(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),e.right=Tg(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),e.bottom=Tg(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),e.top=Tg(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),e.near=Tg(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),e.far=Tg(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,i){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:i,aspect:r,focalDistance:s,near:o,far:a}){return t?(new $n).orthographic({fovy:i,aspect:r,focalDistance:s,near:o,far:a}):(new $n).perspective({fovy:i,aspect:r,near:o,far:a})}_initViewMatrix(t){const{viewMatrix:i=Koe,longitude:r=null,latitude:s=null,zoom:o=null,position:a=null,modelMatrix:l=null,focalDistance:c=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(s)&&Number.isFinite(r),this.zoom=o,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function({latitude:n}){Hu(Number.isFinite(n));const e=Math.cos(n*sc);return function(n){return QD(n)}(JD*e)-9}({latitude:s})+Math.log2(c):0);const h=Math.pow(2,this.zoom);this.scale=h,this.distanceScales=this.isGeospatial?eI({latitude:s,longitude:r}):u||Qoe,this.focalDistance=c,this.distanceScales.metersPerUnit=new wo(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new wo(this.distanceScales.unitsPerMeter),this.position=nI,this.meterOffset=nI,a&&(this.position=a,this.modelMatrix=l,this.meterOffset=l?l.transformVector(a):a),this.isGeospatial?(this.longitude=r,this.latitude=s,this.center=this._getCenterInWorld({longitude:r,latitude:s})):this.center=a?this.projectPosition(a):[0,0,0],this.viewMatrixUncentered=i,this.viewMatrix=(new $n).multiplyRight(this.viewMatrixUncentered).translate(new wo(this.center||nI).negate())}_getCenterInWorld({longitude:t,latitude:i}){const{meterOffset:r,distanceScales:s}=this,o=new wo(this.projectPosition([t,i,0]));if(r){const a=new wo(r).scale(s.unitsPerMeter);o.add(a)}return o}_initProjectionMatrix(t){const{projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,focalDistance:c=1}=t;this.projectionMatrix=i||this._createProjectionMatrix({orthographic:r,fovyRadians:s||o*Yoe,aspect:this.width/this.height,focalDistance:c,near:a,far:l})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];vf(t,t,this.projectionMatrix),vf(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=XD([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];qE(i,i,[this.width/2,-this.height/2,1]),WE(i,i,[1,-1,0]),vf(r,i,this.viewProjectionMatrix),this.pixelProjectionMatrix=r,this.viewportMatrix=i,this.pixelUnprojectionMatrix=XD([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ki.warn("Pixel project matrix not invertible")()}}return n.displayName="Viewport",n})(),wj=(()=>{class n extends Fg{constructor(t={}){const{latitude:i=0,longitude:r=0,zoom:s=11,pitch:o=0,bearing:a=0,nearZMultiplier:l=.1,farZMultiplier:c=1.01,orthographic:u=!1,repeat:h=!1,worldOffset:p=0}=t;let{width:g,height:m,altitude:E=1.5}=t;const C=Math.pow(2,s);g=g||1,m=m||1,E=Math.max(.75,E);const{fov:R,aspect:z,focalDistance:de,near:Ie,far:Be}=function({width:n,height:e,fovy:t=fj(1.5),altitude:i,pitch:r=0,nearZMultiplier:s=1,farZMultiplier:o=1}){void 0!==i&&(t=fj(i));const a=.5*t*sc,l=function(n){return.5/Math.tan(.5*n*sc)}(t),c=r*sc,u=Math.sin(a)*l/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:n/e,focalDistance:l,near:s,far:(Math.sin(c)*u+l)*o}}({width:g,height:m,pitch:o,altitude:E,nearZMultiplier:l,farZMultiplier:c});let Ne=function({height:n,pitch:e,bearing:t,altitude:i,scale:r,center:s=null}){const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return WE(o,o,[0,0,-i]),ej(o,o,-e*sc),tj(o,o,t*sc),qE(o,o,[r/=n,r,r]),s&&WE(o,o,function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],s)),o}({height:m,pitch:o,bearing:a,scale:C,altitude:E});p&&(Ne=(new $n).translate([512*p,0,0]).multiplyLeft(Ne)),super(zn(ht({},t),{width:g,height:m,viewMatrix:Ne,longitude:r,latitude:i,zoom:s,orthographic:u,fovyRadians:R,aspect:z,focalDistance:de,near:Ie,far:Be})),this.latitude=i,this.longitude=r,this.zoom=s,this.pitch=o,this.bearing=a,this.altitude=E,this.orthographic=u,this._subViewports=h?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),i=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let s=i;s<=r;s++){const o=s?new n(zn(ht({},this),{worldOffset:s})):this;this._subViewports.push(o)}}return this._subViewports}addMetersToLngLat(t,i){return dj(t,i)}panByPosition(t,i){const r=cv(i,this.pixelUnprojectionMatrix),o=KE([],this.projectFlat(t),sj([],r)),a=KE([],this.center,o),[l,c]=this.unprojectFlat(a);return{longitude:l,latitude:c}}getBounds(t={}){const i=function(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*gj:Math.atan(.5/n.altitude))>(90-n.pitch)*gj-.01?(l=mj(n,0,e),c=mj(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}(this,t.z||0);return[Math.min(i[0][0],i[1][0],i[2][0],i[3][0]),Math.min(i[0][1],i[1][1],i[2][1],i[3][1]),Math.max(i[0][0],i[1][0],i[2][0],i[3][0]),Math.max(i[0][1],i[1][1],i[2][1],i[3][1])]}fitBounds(t,i={}){const{width:r,height:s}=this,{longitude:o,latitude:a,zoom:l}=function({width:n,height:e,bounds:t,minExtent:i=0,maxZoom:r=24,padding:s=0,offset:o=[0,0]}){const[[a,l],[c,u]]=t;Number.isFinite(s)?s={top:s,bottom:s,left:s,right:s}:Hu(Number.isFinite(s.top)&&Number.isFinite(s.bottom)&&Number.isFinite(s.left)&&Number.isFinite(s.right));const h=QE([a,cj(u,-XE,XE)]),p=QE([c,cj(l,-XE,XE)]),g=[Math.max(Math.abs(p[0]-h[0]),i),Math.max(Math.abs(p[1]-h[1]),i)],m=[n-s.left-s.right-2*Math.abs(o[0]),e-s.top-s.bottom-2*Math.abs(o[1])];Hu(m[0]>0&&m[1]>0);const E=m[0]/g[0],C=m[1]/g[1],Ie=Ng([(p[0]+h[0])/2+(s.right-s.left)/2/E,(p[1]+h[1])/2+(s.bottom-s.top)/2/C]),Be=Math.min(r,QD(Math.abs(Math.min(E,C))));return Hu(Number.isFinite(Be)),{longitude:Ie[0],latitude:Ie[1],zoom:Be}}(ht({width:r,height:s,bounds:t},i));return new n({width:r,height:s,longitude:o,latitude:a,zoom:l})}}return n.displayName="WebMercatorViewport",n})();function iI(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof wj){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function Ej(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=YE([],[o,a,l,1],t)),i){case Pi.LNGLAT:return iI([o,a,l],e,s);case Pi.LNGLAT_OFFSETS:return iI([o+r[0],a+r[1],l+(r[2]||0)],e,s);case Pi.METER_OFFSETS:return iI(dj(r,[o,a,l]),e,s);case Pi.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const eae={10241:9987,10240:9729,10242:33071,10243:33071},rI={},iae={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||dv(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>sI(n,e)},accessor:{validate(n,e){const t=ZE(n);return"function"===t||t===ZE(e.value)},equal:(n,e,t)=>"function"==typeof e||sI(n,e)},array:{validate:(n,e)=>e.optional&&!n||dv(n),equal:(n,e,t)=>t.compare?sI(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t?t.props:{};return i&&n?i(n):n}},image:{transform:(n,e,t)=>function(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof Ia)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new Ia(t,zn(ht({},e),{parameters:ht(ht(ht({},eae),i),n.props.textureParameters)}));return rI[r.id]=!0,r}(t,n),release:n=>{!function(n){!n||!(n instanceof Ia)||rI[n.id]&&(n.delete(),delete rI[n.id])}(n)}}};function sI(n,e){if(n===e)return!0;if(!dv(n)||!dv(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function sae(n,e){switch(ZE(e)){case"object":return uv(n,e);case"array":return uv(n,{type:"array",value:e,compare:!1});case"boolean":return uv(n,{type:"boolean",value:e});case"number":return uv(n,{type:"number",value:e});case"function":return uv(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function uv(n,e){return"type"in e?ht(ht({name:n},iae[e.type]),e):"value"in e?ht({name:n,type:ZE(e.value)},e):{name:n,type:"object",value:e}}function dv(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function ZE(n){return dv(n)?"array":null===n?"null":typeof n}const{COMPONENT:oI,ASYNC_ORIGINAL:JE,ASYNC_RESOLVED:hv,ASYNC_DEFAULTS:eS}=GE;function oae(){const n=this,e=Sj(n.constructor),t=Object.create(e);t[oI]=n,t[JE]={},t[hv]={};for(let i=0;i<arguments.length;++i){const r=arguments[i];for(const s in r)t[s]=r[s]}return Object.freeze(t),t}function Sj(n){return tS(n,"_mergedDefaultProps")||(function(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=Sj(t),s=function(n){const e={},t={},i={};for(const[r,s]of Object.entries(n))if(s&&s.deprecatedFor)i[r]=Array.isArray(s.deprecatedFor)?s.deprecatedFor:[s.deprecatedFor];else{const o=sae(r,s);e[r]=o,t[r]=o.value}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(tS(n,"defaultProps")||{}),o=function(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function(n){const e=tS(n,"layerName")||tS(n,"componentName");return e||ki.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=ht(ht({},t._propTypes),s.propTypes);!function(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=dae(o))}n[eS]=t,n[JE]={},Object.defineProperties(n,i)}(o,a);const l=ht(ht({},t._deprecatedProps),s.deprecatedProps);(function(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])Cj(this,s)||(this[s]=i);ki.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function dae(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||oV(e)?this[JE][n]=e:this[hv][n]=e},get(){if(this[hv]){if(n in this[hv])return this[hv][n]||this[eS][n];if(n in this[JE]){const e=this[oI]&&this[oI].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[eS][n]}}return this[eS][n]}}}function Cj(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function tS(n,e){return Cj(n,e)&&n[e]}function aI(n){var e;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(e=n[Symbol.asyncIterator]),null==e&&Symbol.iterator&&(e=n[Symbol.iterator])),null==e&&(e=n["@@asyncIterator"]),null==e&&(e=n["@@iterator"]),null==e)throw new TypeError("Object is not async iterable");return e.call(n)}const{ASYNC_ORIGINAL:fae,ASYNC_RESOLVED:pae,ASYNC_DEFAULTS:gae}=GE,mae=Object.freeze({});class xj{constructor(e=null){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=mae,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[pae]||{},i=e[fae]||e,r=e[gae]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t){var i;const r=null===(i=this.layer)||void 0===i?void 0:i.props.fetch;r&&(t=r(t,{propName:e,layer:this.layer}))}if(t instanceof Promise)return void this._watchPromise(e,t);if(oV(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){const i=this.asyncProps[e];t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this.freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{var o;s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r);const a=null===(o=this.layer)||void 0===o?void 0:o.props.onDataLoad;"data"===e&&a&&a(s,{propName:e,layer:this.layer})}).catch(s=>{var o;null===(o=this.layer)||void 0===o||o.raiseError(s,"loading ".concat(e," of ").concat(this.layer))})}_resolveAsyncIterable(e,t){var i=this;return ni(function*(){var r;"data"!==e&&i._setPropValue(e,t);const s=i.asyncProps[e];s.pendingLoadCount++;const o=s.pendingLoadCount;let a=[],l=0;var h,c=!0,u=!1;try{for(var g,m,p=aI(t);c=(g=yield p.next()).done,m=yield g.value,!c;c=!0){const C=m,{dataTransform:R}=i.component?i.component.props:{};a=R?R(C,a):a.concat(C),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,i._setAsyncPropValue(e,a,o)}}catch(C){u=!0,h=C}finally{try{!c&&null!=p.return&&(yield p.return())}finally{if(u)throw h}}const E=null===(r=i.layer)||void 0===r?void 0:r.props.onDataLoad;E&&E(a,{propName:e,layer:i.layer})})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:Tj,ASYNC_RESOLVED:Aj,ASYNC_DEFAULTS:_ae}=GE,yae={};let vae=0,bae=(()=>{class n{constructor(){this.props=oae.apply(this,arguments),this.id=this.props.id,this.count=vae++,this.lifecycle="Awaiting state",this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:i}=this,r={};for(const s in i[_ae])s in i[Aj]?r[s]=i[Aj][s]:s in i[Tj]&&(r[s]=i[Tj][s]);return new this.constructor(ht(ht(ht({},i),r),t))}get stats(){return this.internalState.stats}_initState(){this.internalState=new xj({})}}return n.componentName="Component",n.defaultProps=yae,n})();class wae extends xj{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}}const oc=n=>"function"==typeof n,th=n=>null!==n&&"object"==typeof n,Dj=n=>th(n)&&n.constructor==={}.constructor,Eae=n=>n&&"function"==typeof n[Symbol.iterator],Sae=n=>n&&"function"==typeof n[Symbol.asyncIterator],fv=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Lg=n=>"undefined"!=typeof Blob&&n instanceof Blob,Ij=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||th(n)&&oc(n.tee)&&oc(n.cancel)&&oc(n.getReader))(n)||(n=>th(n)&&oc(n.read)&&oc(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function bf(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function lI(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function cI(n){var e,t;let i;return bf(n,"null loader"),bf(lI(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=zn(ht({},n=n[0]),{options:ht(ht({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const Wc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},uI=Wc.global||Wc.self||Wc.window||{},Dae="object"!=typeof process||"[object process]"!==String(process)||process.browser,Oj="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Oj&&parseFloat(Oj[1]);const hI={};function Iae(n){for(const e in hI)n.startsWith(e)&&(n=n.replace(e,hI[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${n}`),n}const Oae=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Rae=/^([-\w.]+\/[-\w.+]+)/;function Pae(n){const e=Rae.exec(n);return e?e[1]:n}function Rj(n){const e=Oae.exec(n);return e?e[1]:""}const Nae=/\?.*/;function nS(n){if(fv(n)){const e=fI(n.url||"");return{url:e,type:Pae(n.headers.get("content-type")||"")||Rj(e)}}return Lg(n)?{url:fI(n.name||""),type:n.type||""}:"string"==typeof n?{url:fI(n),type:Rj(n)}:{url:"",type:""}}function Fae(n){return fv(n)?n.headers["content-length"]||-1:Lg(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function fI(n){return n.replace(Nae,"")}function Pj(n){return pI.apply(this,arguments)}function pI(){return(pI=ni(function*(n){if(fv(n))return n;const e={},t=Fae(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=nS(n);r&&(e["content-type"]=r);const s=yield Bae(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o})).apply(this,arguments)}function Lae(n){return gI.apply(this,arguments)}function gI(){return(gI=ni(function*(n){if(!n.ok){const e=yield kae(n);throw new Error(e)}})).apply(this,arguments)}function kae(n){return mI.apply(this,arguments)}function mI(){return(mI=ni(function*(n){let e=`Failed to fetch resource ${n.url} (${n.status}): `;try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=` ${yield n.text()}`),e+=i,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e})).apply(this,arguments)}function Bae(n){return _I.apply(this,arguments)}function _I(){return(_I=ni(function*(n){if("string"==typeof n)return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}return n instanceof ArrayBuffer?`data:base64,${Vae(n.slice(0,5))}`:null})).apply(this,arguments)}function Vae(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function Nj(n,e){return yI.apply(this,arguments)}function yI(){return(yI=ni(function*(n,e){if("string"==typeof n){n=Iae(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield Pj(n)})).apply(this,arguments)}function Wn(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const Fj=new oD({id:"loaders.gl"});class jae{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const Lj={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){Wn(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},zae={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function vI(){uI.loaders=uI.loaders||{};const{loaders:n}=uI;return n._state=n._state||{},n._state}const bI=()=>{const n=vI();return n.globalOptions=n.globalOptions||ht({},Lj),n.globalOptions};function Hae(n,e,t,i){return t=t||[],function(n,e){Bj(n,null,Lj,zae,e);for(const t of e)Bj(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function(n,e,t){const r=ht({},n.options||{});return function(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new jae),jj(r,bI()),jj(r,e),r}(e,n,i)}function kj(n,e){const t=bI(),i=n||t;return"function"==typeof i.fetch?i.fetch:th(i.fetch)?r=>Nj(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:Nj}function Bj(n,e,t,i,r){const s=e||"Top level",o=e?`${e}.`:"";for(const a in n){const l=!e&&th(n[a]),c="baseUri"===a&&!e,u="workerUrl"===a&&e;if(!(a in t)&&!c&&!u)if(a in i)Fj.warn(`${s} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!l){const h=$ae(a,r);Fj.warn(`${s} loader option '${o}${a}' not recognized. ${h}`)()}}}function $ae(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return`Did you mean '${r.id}.${s}'?`;const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||`Did you mean '${r.id}.${s}'?`)}return i}function jj(n,e){for(const t in e)t in e&&(n[t]=Dj(e[t])&&Dj(n[t])?ht(ht({},n[t]),e[t]):e[t])}function qc(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function Yae(n,e="3.0.12"){return qc(n,"no worker provided"),!(!e||!n.version)}const Yc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},Kae=Yc.global||Yc.self||Yc.window||{},wI="object"!=typeof process||"[object process]"!==String(process)||process.browser,EI="function"==typeof importScripts,Xae="undefined"!=typeof window&&void 0!==window.orientation,Uj="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),SI=(Uj&&parseFloat(Uj[1]),new Map);function zj(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function Hj(n,e=!0,t){const i=t||new Set;if(n)if(Gj(n))i.add(n);else if(Gj(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)Hj(n[r],e,i);return void 0===t?Array.from(i):[]}function Gj(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const CI=()=>{};class $j{static isSupported(){return"undefined"!=typeof Worker}constructor(e){Wn(this,"name",void 0),Wn(this,"source",void 0),Wn(this,"url",void 0),Wn(this,"terminated",!1),Wn(this,"worker",void 0),Wn(this,"onMessage",void 0),Wn(this,"onError",void 0),Wn(this,"_loadableURL","");const{name:t,source:i,url:r}=e;qc(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=CI,this.onError=s=>console.log(s),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=CI,this.onError=CI,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||Hj(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(n){qc(n.source&&!n.url||!n.source&&n.url);let e=SI.get(n.source||n.url);return e||(n.url&&(e=function(n){return n.startsWith("http")?zj(function(n){return`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`}(n)):n}(n.url),SI.set(n.url,e)),n.source&&(e=zj(n.source),SI.set(n.source,e))),qc(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}}class ele{constructor(e,t){Wn(this,"name",void 0),Wn(this,"workerThread",void 0),Wn(this,"isRunning",void 0),Wn(this,"result",void 0),Wn(this,"_resolve",void 0),Wn(this,"_reject",void 0),this.name=e,this.workerThread=t,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){qc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){qc(this.isRunning),this.isRunning=!1,this._reject(e)}}class tle{constructor(e){Wn(this,"name","unnamed"),Wn(this,"source",void 0),Wn(this,"url",void 0),Wn(this,"maxConcurrency",1),Wn(this,"maxMobileConcurrency",1),Wn(this,"onDebug",()=>{}),Wn(this,"reuseWorkers",!0),Wn(this,"props",{}),Wn(this,"jobQueue",[]),Wn(this,"idleQueue",[]),Wn(this,"count",0),Wn(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=ht(ht({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return ni(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return ni(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new ele(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new $j({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Xae?this.maxMobileConcurrency:this.maxConcurrency}}const nle={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Gu{static isSupported(){return $j.isSupported()}static getWorkerFarm(e={}){return Gu._workerFarm=Gu._workerFarm||new Gu({}),Gu._workerFarm.setProps(e),Gu._workerFarm}constructor(e){Wn(this,"props",void 0),Wn(this,"workerPools",new Map),this.props=ht({},nle),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy()}setProps(e){this.props=ht(ht({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new tle({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function rle(n,e={}){const i=`${n.id}-worker.js`;let r=(e[n.id]||{}).workerUrl;if("test"===e._workerType&&(r=`modules/${n.module}/dist/${i}`),!r){let s=n.version;"latest"===s&&(s="latest"),r=`https://unpkg.com/@loaders.gl/${n.module}${s?`@${s}`:""}/dist/${i}`}return qc(r),r}function sle(n,e){return!!Gu.isSupported()&&n.worker&&(null==e?void 0:e.worker)}function ole(n,e,t,i,r){return xI.apply(this,arguments)}function xI(){return(xI=ni(function*(n,e,t,i,r){const s=n.id,o=rle(n,t),l=Gu.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t));const c=yield l.startJob("process-on-worker",ale.bind(null,r));return c.postMessage("process",{input:e,options:t}),yield(yield c.result).result})).apply(this,arguments)}function ale(n,e,t,i){return TI.apply(this,arguments)}function TI(){return(TI=ni(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(i.error);break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}})).apply(this,arguments)}Wn(Gu,"_workerFarm",void 0);var qj=tt(521);function Yj(n){if(function(n){return n&&"object"==typeof n&&n.isBuffer}(n)&&(n=function(n){return qj.toArrayBuffer?qj.toArrayBuffer(n):n}(n)),n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function dle(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function Kj(n,e,t){const i=void 0!==t?new Uint8Array(n).subarray(e,e+t):new Uint8Array(n).subarray(e);return new Uint8Array(i).buffer}function hle(n){return MI.apply(this,arguments)}function MI(){return(MI=ni(function*(n){const e=[];var r,t=!0,i=!1;try{for(var o,a,s=aI(n);t=(o=yield s.next()).done,a=yield o.value,!t;t=!0)e.push(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return dle(...e)})).apply(this,arguments)}const gle=262144;function Xj(n){this.wrapped=n}function pv(n){return new Xj(n)}function gv(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,u=c instanceof Xj;Promise.resolve(u?c.wrapped:c).then(function(h){u?r("return"===o?"return":"next",h):s(l.done?"return":"normal",h)},function(h){r("throw",h)})}catch(h){s("throw",h)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function(o,a){return new Promise(function(l,c){var u={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=u:(e=t=u,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function II(n){return function(){return new gv(n.apply(this,arguments))}}function OI(){return(OI=II(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield pv(n.slice(i,r).arrayBuffer());i=r,yield s}})).apply(this,arguments)}function Qj(n,e){return Dae?function(n,e){return RI.apply(this,arguments)}(n,e):function(n,e){return PI.apply(this,arguments)}(n,e)}function RI(){return(RI=II(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield pv(r);if(s)return;yield Yj(o)}}catch(r){t.releaseLock()}})).apply(this,arguments)}function PI(){return(PI=II(function*(n,e){var r,t=!0,i=!1;try{for(var o,a,s=aI(n);t=(o=yield pv(s.next())).done,a=yield pv(o.value),!t;t=!0)yield Yj(a)}catch(l){i=!0,r=l}finally{try{!t&&null!=s.return&&(yield pv(s.return()))}finally{if(i)throw r}}})).apply(this,arguments)}function wle(n,e){if("string"==typeof n)return function*(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*(n,e={}){const{chunkSize:t=gle}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(Lg(n))return function(n,e){return OI.apply(this,arguments)}(n,e);if(Ij(n))return Qj(n,e);if(fv(n))return Qj(n.body,e);throw new Error("makeIterator")}gv.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},gv.prototype.next=function(n){return this._invoke("next",n)},gv.prototype.throw=function(n){return this._invoke("throw",n)},gv.prototype.return=function(n){return this._invoke("return",n)};const NI="Cannot convert supplied data type";function Ele(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(NI)}function Sle(n,e,t){return FI.apply(this,arguments)}function FI(){return(FI=ni(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return Ele(n,e);if(Lg(n)&&(n=yield Pj(n)),fv(n)){const r=n;return yield Lae(r),e.binary?yield r.arrayBuffer():yield r.text()}if(Ij(n)&&(n=wle(n,t)),Eae(n)||Sae(n))return hle(n);throw new Error(NI)})).apply(this,arguments)}function xle(n,e,t=null){if(t)return t;const i=ht({fetch:kj(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function Tle(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const Zj=()=>{const n=vI();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function Jj(n){const e=Zj();n=Array.isArray(n)?n:[n];for(const t of n){const i=cI(t);e.find(r=>i===r)||e.unshift(i)}}const Mle=/\.([^.]+)$/;function Dle(n){return BI.apply(this,arguments)}function BI(){return(BI=ni(function*(n,e=[],t,i){if(!tU(n))return null;let r=eU(n,e,zn(ht({},t),{nothrow:!0}),i);if(r)return r;if(Lg(n)&&(r=eU(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error(nU(n));return r})).apply(this,arguments)}function eU(n,e=[],t,i){if(!tU(n))return null;if(e&&!Array.isArray(e))return cI(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...Zj()),function(n){for(const e of n)cI(e)}(r);const s=function(n,e,t,i){const{url:r,type:s}=nS(n),o=r||(null==i?void 0:i.url);let a=null;return null!=t&&t.mimeType&&(a=VI(e,null==t?void 0:t.mimeType)),a=a||function(n,e){const t=e&&Mle.exec(e),i=t&&t[1];return i?function(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),a=a||VI(e,s),a=a||function(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(Fle(e,t))return t}else if(ArrayBuffer.isView(e)){if(iU(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&iU(e,0,t))return t;return null}(e,n),a=a||VI(e,null==t?void 0:t.fallbackMimeType),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error(nU(n));return s}function tU(n){return!(n instanceof Response&&204===n.status)}function nU(n){const{url:e,type:t}=nS(n);let i="No valid loader found";return n&&(i+=` data: "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?jI(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?jI(n,0,e):""}(n)}", contentType: "${t}"`),e&&(i+=` url: ${e}`),i}function VI(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e===`application/x.${t.id}`)return t;return null}function Fle(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function iU(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function(n,e,t,i){if(i instanceof ArrayBuffer)return function(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===jI(n,e,i.length);default:return!1}}(n,e,t,r))}function jI(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function iS(n,e,t,i){return UI.apply(this,arguments)}function UI(){return(UI=ni(function*(n,e,t,i){qc(!i||"object"==typeof i),e&&!Array.isArray(e)&&!lI(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=nS(n),o=Tle(e,i),a=yield Dle(n,o,t);return a?(i=xle({url:r,parse:iS,loaders:o},t=Hae(t,a,o,r),i),yield Ble(a,n,t,i)):null})).apply(this,arguments)}function Ble(n,e,t,i){return zI.apply(this,arguments)}function zI(){return(zI=ni(function*(n,e,t,i){if(Yae(n),e=yield Sle(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(sle(n,t))return yield ole(n,e,t,i,iS);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw qc(!n.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)})).apply(this,arguments)}function rS(n,e,t,i){return HI.apply(this,arguments)}function HI(){return(HI=ni(function*(n,e,t,i){!Array.isArray(e)&&!lI(e)&&(t=e,e=void 0);const r=kj(t);let s=n;return"string"==typeof n&&(s=yield r(n)),Lg(n)&&(s=yield r(n)),yield iS(s,e,t)})).apply(this,arguments)}const rU=mr(2,24)-1,Gle=Object.freeze([]),$le=$E(({oldViewport:n,viewport:e})=>n.equals(e));let Kc=new Uint8ClampedArray(0);const Wle={data:{type:"data",value:Gle,async:!0},dataComparator:null,_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=zn(ht({},r),{fetch:zn(ht({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:rS(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>t.internalState.reloadAsyncProp(e,c),consumerId:t.id,requestId:e}):rS(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:Pi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};let GI=(()=>{class n extends bae{toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}raiseError(t,i){var r,s,o,a;i&&(t.message="".concat(i,": ").concat(t.message)),(null===(r=(s=this.props).onError)||void 0===r?void 0:r.call(s,t))||null===(o=this.context)||void 0===o||null===(a=o.onError)||void 0===a||a.call(o,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:i}=this.context,r=Ej(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,a]=pj(r,i.pixelProjectionMatrix);return 2===t.length?[s,o]:[s,o,a]}unproject(t){const{viewport:i}=this.context;return i.unproject(t)}projectPosition(t){return function(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function(n){const e=ht({},n);let{coordinateSystem:t}=n;const{viewport:i,coordinateOrigin:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return t===Pi.DEFAULT&&(t=i.isGeospatial?Pi.LNGLAT:Pi.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=t),void 0===o&&(e.fromCoordinateOrigin=r),e.coordinateSystem=t,e}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=rj(t,i,r),h=Ej(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});u&&function(n,e,t){n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2]}(h,h,t.projectPosition(l||c));return h}(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Pi.DEFAULT||t===Pi.LNGLAT||t===Pi.CARTESIAN}onHover(t,i){return!!this.props.onHover&&this.props.onHover(t,i)}onClick(t,i){return!!this.props.onClick&&this.props.onClick(t,i)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,i=[]){return i[0]=t+1&255,i[1]=t+1>>8&255,i[2]=t+1>>8>>8&255,i}decodePickingColor(t){ic(t instanceof Uint8Array);const[i,r,s]=t;return i+256*r+65536*s-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const i of this.props.extensions)t=Qse(t,i.getShaders.call(this,i));return t}shouldUpdateState({changeFlags:s}){return s.propsOrDataChanged}updateState({oldProps:t,props:i,changeFlags:s}){const o=this.getAttributeManager();if(s.dataChanged&&o){const{dataChanged:c}=s;if(Array.isArray(c))for(const u of c)o.invalidateAll(u);else o.invalidateAll()}const l=i.highlightedObjectIndex>=0||i.pickable;if((t.highlightedObjectIndex>=0||t.pickable)!==l&&o){const{pickingColors:c,instancePickingColors:u}=o.attributes,h=c||u;h&&(l&&h.constant&&(h.constant=!1,o.invalidate(h.id)),!h.value&&!l&&(h.constant=!0,h.value=[0,0,0]))}}finalizeState(){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const i of this.getModels())i.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const i=this.internalState.viewport;this.internalState.viewport=t,(!i||!$le({oldViewport:i,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",i=""){const r=this.getAttributeManager();!r||("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const i of this.getModels())this._setModelAttributes(i,t)}_updateAttributes(t){const i=this.getAttributeManager();if(!i)return;const r=this.getNumInstances(t),s=this.getStartIndices(t);i.update({data:t.data,numInstances:r,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const o=i.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const i=t.update(),r=Object.create(this.props);for(const s in i)Object.defineProperty(r,s,{value:i[s]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:i}){if(t.constant)return;const r=Math.floor(Kc.length/3);if(this.internalState.usesPickingColorCache=!0,r<i){i>rU&&ki.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Kc=Qy.allocate(Kc,i,{size:3,copy:!0,maxCount:Math.max(i,rU)});const s=Math.floor(Kc.length/3),o=[];for(let a=r;a<s;a++)this.encodePickingColor(a,o),Kc[3*a+0]=o[0],Kc[3*a+1]=o[1],Kc[3*a+2]=o[2]}t.value=Kc.subarray(0,3*i)}_setModelAttributes(t,i){const o=this.getAttributeManager().getShaderAttributes(i,t.userData.excludeAttributes||{});t.setAttributes(o)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,s=i||r,o=s.getVertexOffset(t),a=s.getVertexOffset(t+1);s.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;this.internalState.usesPickingColorCache&&r.value.buffer!==Kc.buffer&&(r.value=Kc.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(n){if(!function(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){Eo("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();Eo("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,i=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||i,this.props=r;try{const s=this._getUpdateParams(),o=this.getModels();if(this.context.gl)this.updateState(s);else try{this.updateState(s)}catch(l){}for(const l of this.props.extensions)l.updateState.call(this,s,l);const a=this.getModels()[0]!==o[0];this._updateModules(s,a),this.isComposite?this._renderLayers(s):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=i,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){Eo("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:i={},parameters:r={}}){this._updateAttributeTransition();const s=this.props;this.props=this.internalState.propsInTransition||s;const{opacity:o}=this.props;i.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:a}=this.props,l=a&&a(i)||[0,0];Bu(this.context.gl,{polygonOffset:l}),nc(this.context.gl,r,()=>{const c={moduleParameters:t,uniforms:i,parameters:r,context:this.context};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=s}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:i}=this.internalState;for(const s in t)if(t[s]){let o=!1;switch(s){case"dataChanged":Array.isArray(i[s])&&(i[s]=Array.isArray(t[s])?i[s].concat(t[s]):t[s],o=!0);default:i[s]||(i[s]=t[s],o=!0)}o&&Eo("layer.changeFlag",this,s,t)}const r=i.dataChanged||i.updateTriggersChanged||i.propsChanged||i.extensionsChanged;i.propsOrDataChanged=r,i.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,i){const r=function(n,e){const t=ZV({newProps:n,oldProps:e,propTypes:KD(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(n,e){if(null===e)return"oldProps is null, initial diff";let t=null;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function(n,e){if(null===e)return"oldProps is null, initial diff";if("all"in n.updateTriggers&&JV(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&JV(n,e,r)&&(t[r]=!0,i=t);return i}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:Gse(n,e),transitionsChanged:Use(n,e)}}(t,i);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,i[s],t[s],t.transitions[s]);return this.setChangeFlags(r)}validateProps(){!function(n){const e=KD(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}setModuleParameters(t){for(const i of this.getModels())i.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const i={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"==typeof r&&(i.pickingHighlightColor=r(t)),this.setModuleParameters(i),this.setNeedsRedraw()}_updateModules({props:t,oldProps:i},r){const{autoHighlight:s,highlightedObjectIndex:o,highlightColor:a}=t;if(r||i.autoHighlight!==s||i.highlightedObjectIndex!==o||i.highlightColor!==a){const l={};s||(l.pickingSelectedColor=null),Array.isArray(a)&&(l.pickingHighlightColor=a),Number.isInteger(o)&&(l.pickingSelectedColor=o>=0?this.encodePickingColor(o):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let i=!1;i=i||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),s=r&&r.getNeedsRedraw(t);return i=i||s,i}_getAttributeManager(){return new Rse(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){ic(!this.internalState&&!this.state),ic(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new wae({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ki.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new kse(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){Eo("layer.matched",this,this===t);const{state:i,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=i,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}return n.layerName="Layer",n.defaultProps=Wle,n})(),Yle=(()=>{class n extends GI{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:i}=t;return i&&i.__source&&i.__source.parent&&i.__source.parent.id===this.id&&(t.object=i.__source.object,t.index=i.__source.index),t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,i){return i&&i.length}getSubLayerClass(t,i){const{_subLayerProps:r}=this.props;return r&&r[t]&&r[t].type||i}getSubLayerRow(t,i,r){return t.__source={parent:this,object:i,index:r},t}getSubLayerAccessor(t){if("function"==typeof t){const i={data:this.props.data,target:[]};return(r,s)=>r&&r.__source?(i.index=r.__source.index,t(r.__source.object,i)):t(r,s)}return t}getSubLayerProps(t={}){const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:m,modelMatrix:E,extensions:C,fetch:R,_subLayerProps:z}=this.props,de={opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:m,modelMatrix:E,extensions:C,fetch:R},Ie=z&&z[t.id],Be=Ie&&Ie.updateTriggers,Ne=t.id||"sublayer";if(Ie){const ct=this.constructor._propTypes,Dt=t.type?t.type._propTypes:{};for(const Ot in Ie){const Lt=Dt[Ot]||ct[Ot];Lt&&"accessor"===Lt.type&&(Ie[Ot]=this.getSubLayerAccessor(Ie[Ot]))}}Object.assign(de,t,Ie),de.id="".concat(this.props.id,"-").concat(Ne),de.updateTriggers=ht(ht({all:this.props.updateTriggers.all},t.updateTriggers),Be);for(const ct of C){const Dt=ct.getSubLayerProps.call(this,ct);Dt&&Object.assign(de,Dt,{updateTriggers:Object.assign(de.updateTriggers,Dt.updateTriggers)})}return de}_updateAutoHighlight(t){for(const i of this.getSubLayers())i.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const i=!t||this.needsUpdate();i&&(t=this.renderLayers(),t=AD(t,Boolean),this.internalState.subLayers=t),Eo("compositeLayer.renderLayers",this,i,t);for(const r of t)r.parent=this}}return n.layerName="CompositeLayer",n})();const Kle=/([0-9]+\.?[0-9]*)(%|px)/;function sS(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=n.match(Kle);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function oS(n,e){return n.relative?Math.round(n.position*e):n.position}function mv(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&mv(i,r)))return!1}return!0}class $I{constructor(e={}){const{id:t=null,x:i=0,y:r=0,width:s="100%",height:o="100%",projectionMatrix:a=null,fovy:l=50,near:c=.1,far:u=1e3,modelMatrix:h=null,viewportInstance:p=null,type:g=Fg}=e;ic(!p||p instanceof Fg),this.viewportInstance=p,this.id=t||this.constructor.displayName||"view",this.type=g,this.props=zn(ht({},e),{id:this.id,projectionMatrix:a,fovy:l,near:c,far:u,modelMatrix:h}),this._parseDimensions({x:i,y:r,width:s,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):mv(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return this._getViewport(i,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=ht({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){return{x:oS(this._x,e),y:oS(this._y,t),width:oS(this._width,e),height:oS(this._height,t)}}_getControllerProps(e){let t=this.props.controller;return t?!0===t?e:("function"==typeof t&&(t={type:t}),ht(ht({},e),t)):null}_getViewport(e,t){const{type:i}=this;return new i(ht(ht(ht({},e),this.props),t))}_parseDimensions({x:e,y:t,width:i,height:r}){this._x=sS(e),this._y=sS(t),this._width=sS(i),this._height=sS(r)}}const _v=()=>{},sU={transitionEasing:n=>n,transitionInterruption:1,onTransitionStart:_v,onTransitionInterrupt:_v,onTransitionEnd:_v};class Xle{constructor(e,t={}){this.ControllerState=e,this.props=ht(ht({},sU),t),this.propsInTransition=null,this.transition=new av(t.timeline),this.onViewStateChange=t.onViewStateChange||_v,this.onStateChange=t.onStateChange||_v,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(e=ht(ht({},sU),e),this.props=e,this._shouldIgnoreViewportChange(i,e))return t;if(this._isTransitionEnabled(e)){const{interruption:r,endProps:s}=this.transition.settings,o=ht(ht({},i),2===r?s:this.propsInTransition||i);this._triggerTransition(o,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=new this.ControllerState(e),r=new this.ControllerState(t).shortestPathFrom(i),{transitionInterpolator:s}=t,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=t.transitionInterpolator.initializeProps(e,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e(t)}}_onTransitionUpdate(e){const{time:t,settings:{interpolator:i,startProps:r,endProps:s,duration:o,easing:a}}=e,l=a(t/o),c=i.interpolateProps(r,s,l);this.propsInTransition=new this.ControllerState(ht(ht({},this.props),c)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const oU=["longitude","latitude","zoom","bearing","pitch"],Zle=["longitude","latitude","zoom"];class aU extends class{constructor(e={}){Array.isArray(e)&&(e={compare:e,extract:e,required:e});const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare||Object.keys(t))if(!(i in e)||!(i in t)||!Zy(e[i],t[i]))return!1;return!0}initializeProps(e,t){let i;if(this._propsToExtract){const r={},s={};for(const o of this._propsToExtract)r[o]=e[o],s[o]=t[o];i={start:r,end:s}}else i={start:e,end:t};return this._checkRequiredProps(i.start),this._checkRequiredProps(i.end),i}interpolateProps(e,t,i){return t}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];ic(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){super((Array.isArray(e)?e:e.transitionProps)||{compare:oU,extract:oU,required:Zle}),this.opts=e}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=ME(e[s]||0,t[s]||0,i);if(t.aroundPosition){const s=this.opts.makeViewport(ht(ht({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,ME(e.around,t.around,i)))}return r}}const nh={transitionDuration:0},Jle={transitionDuration:300,transitionEasing:n=>n,transitionInterruption:1},lS=n=>1-(1-n)*(1-n),kg_WHEEL=["wheel"],kg_PAN=["panstart","panmove","panend"],kg_PINCH=["pinchstart","pinchmove","pinchend"],kg_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],kg_DOUBLE_TAP=["doubletap"],kg_KEYBOARD=["keydown"];class WI{constructor(e,t={}){this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new Xle(e,zn(ht({},t),{onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}));const i=this.linearTransitionProps;this._transition=i&&zn(ht({},Jle),{transitionInterpolator:new aU({transitionProps:i})}),this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(t)}get linearTransitionProps(){return null}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.setProps(this.controllerStateProps)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){const{ControllerState:t}=this;this.controllerState=new t(ht(ht({makeViewport:this.makeViewport},this.controllerStateProps),this._state));const i=this._eventStartBlocked;switch(e.type){case"panstart":return!i&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!i&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!i&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}getCenter(e){const{x:t,y:i}=this.controllerStateProps,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.controllerStateProps;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){"onViewStateChange"in e&&(this.onViewStateChange=e.onViewStateChange),"onStateChange"in e&&(this.onStateChange=e.onStateChange),"makeViewport"in e&&(this.makeViewport=e.makeViewport),"dragMode"in e&&(this.dragMode=e.dragMode),this.controllerStateProps=e,"eventManager"in e&&this.eventManager!==e.eventManager&&(this.eventManager=e.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);let{inertia:t}=e;!0===t&&(t=300),this.inertia=t;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(kg_WHEEL,u&&i),this.toggleEvents(kg_PAN,u&&(r||s)),this.toggleEvents(kg_PINCH,u&&(a||l)),this.toggleEvents(kg_TRIPLE_PAN,u&&l),this.toggleEvents(kg_DOUBLE_TAP,u&&o),this.toggleEvents(kg_KEYBOARD,u&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t={},i={}){const r=ht(ht({},e.getViewportProps()),t),s=this.controllerState!==e;if(this._state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange&&(e.interactionState=this._interactionState,this.onViewStateChange(e))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,nh,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,nh,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,zn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:lS}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,nh,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,zn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:lS}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,zn(ht({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,nh,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,nh,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,zn(ht({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:lS}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(i,nh,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,nh,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t,_lastPinchEvent:i}=this;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,zn(ht({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:lS}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{_transition:t}=this;return t?e?zn(ht({},t),{transitionInterpolator:new aU(zn(ht({},e),{transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport}))}):t:nh}}class lU{constructor(e){this._viewportProps=this._applyConstraints(e)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(e){return this._viewportProps}_applyConstraints(e){return e}}const ih_target=[0,0,0];class cS extends lU{constructor({makeViewport:e,width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=ih_target,zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-(1/0),maxZoom:h=Infinity,startPanPosition:p,startRotatePos:g,startRotationX:m,startRotationOrbit:E,startZoomPosition:C,startZoom:R}){super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:h}),this._state={startPanPosition:p,startRotatePos:g,startRotationX:m,startRotationOrbit:E,startZoomPosition:C,startZoom:R},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this._state.startPanPosition||t;if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this._state,{width:a,height:l}=this._viewportProps;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let c;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*u}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=ht({},this._viewportProps),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){const{zoom:r}=this._viewportProps;let{startZoom:s,startZoomPosition:o}=this._state;Number.isFinite(s)||(s=r,o=this._unproject(t)||this._unproject(e));const a=this._calculateNewZoom({scale:i,startZoom:s}),l=this.makeViewport(zn(ht({},this._viewportProps),{zoom:a}));return this._getUpdatedState(ht({zoom:a},l.panByPosition(o,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+e})}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Number.isFinite(t)||(t=this._viewportProps.zoom),Oa(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new cS(ht(ht(ht({},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Oa(r,i,t),e.rotationX=Oa(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function(n,e){const t=n%360;return t<0?360+t:t}(a+180)-180),e}}class tce extends WI{constructor(e){super(cS,e)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}class nce extends WI{constructor(e){e.dragMode=e.dragMode||"pan",super(cS,e)}_onPanRotate(e){return!1}get linearTransitionProps(){return["target","zoom"]}}const ice=(new $n).lookAt({eye:[0,0,1]});function rce({width:n,height:e,near:t,far:i}){return n=n||1,e=e||1,(new $n).ortho({left:-n/2,right:n/2,bottom:-e/2,top:e/2,near:t,far:i})}class sce extends Fg{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],flipY:l=!0}=e,c=Math.pow(2,o);super(zn(ht({},e),{longitude:null,position:a,viewMatrix:ice.clone().scale([c,c*(l?-1:1),c]),projectionMatrix:rce({width:t,height:i,near:r,far:s}),zoom:o}))}panByPosition(e,t){const r=KE([],e,sj([],cv(t,this.pixelUnprojectionMatrix)));return{target:KE([],this.center,r)}}}let oce=(()=>{class n extends $I{constructor(t){super(zn(ht({},t),{type:sce}))}get controller(){return this._getControllerProps({type:nce})}}return n.displayName="OrthographicView",n})();const uS=Math.PI/180;function ace({height:n,fovy:e,orbitAxis:t,rotationX:i,rotationOrbit:r,zoom:s}){const o=.5/Math.tan(e*uS/2),a="Z"===t?[0,0,1]:[0,1,0],l="Z"===t?[0,-o,0]:[0,0,o],c=(new $n).lookAt({eye:l,up:a});c.rotateX(i*uS),"Z"===t?c.rotateZ(r*uS):c.rotateY(r*uS);const u=Math.pow(2,s)/(n||1);return c.scale(u),c}class lce extends Fg{constructor(e){const{height:t,fovy:i,orbitAxis:r,target:s=[0,0,0],rotationX:o=0,rotationOrbit:a=0,zoom:l=0}=e;super(zn(ht({},e),{longitude:null,viewMatrix:ace({height:t,fovy:i,orbitAxis:r,rotationX:o,rotationOrbit:a,zoom:l}),fovy:i,position:s,zoom:l})),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:t=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=t?r:this.height-r,[a,l,c]=cv([i,o,s],this.pixelUnprojectionMatrix);return[a,l,c]}panByPosition(e,t){const i=this.project(e);return{target:this.unproject([this.width/2+i[0]-t[0],this.height/2+i[1]-t[1],this.projectedCenter[2]])}}}let cce=(()=>{class n extends $I{constructor(t={}){const{orbitAxis:i="Z"}=t;super(zn(ht({},t),{orbitAxis:i,type:lce}))}get controller(){return this._getControllerProps({type:tce})}}return n.displayName="OrbitView",n})();const uce=[255,255,255],dce=1;let hce=0;class cU{constructor(e={}){const{color:t=uce}=e,{intensity:i=dce}=e;this.id=e.id||"ambient-".concat(hce++),this.color=t,this.intensity=i,this.type="ambient"}}const fce=[255,255,255],pce=1,gce=[0,0,-1];let mce=0;class uU{constructor(e={}){const{color:t=fce}=e,{intensity:i=pce}=e,{direction:r=gce}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(mce++),this.color=t,this.intensity=i,this.type="directional",this.direction=new wo(r).normalize().toArray(),this.shadow=s}getProjectedLight(){return this}}class dU{constructor(e={}){const{id:t="effect"}=e;this.id=t,this.props=ht({},e)}preRender(){}getModuleParameters(){}cleanup(){}}class qI extends class{constructor(e,t={}){const{id:i="pass"}=t;this.id=i,this.gl=e,this.props=ht({},t)}setProps(e){Object.assign(this.props,e)}render(){}cleanup(){}}{render(e){return Bu(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{viewports:t,views:i,onViewportActive:r,clearCanvas:s=!0}=e;e.pass=e.pass||"unknown";const o=this.gl;s&&function(n){Bu(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(o);const a=[];for(const l of t){const c=l.viewport||l,u=i&&i[c.id];r(c);const h=this._getDrawLayerParams(c,e);e.view=u;const p=c.subViewports||[c];for(const g of p){e.viewport=g;const m=this._drawLayersInViewport(o,e,h);a.push(m)}}return a}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,effects:s,moduleParameters:o}){const a=[],l=hU(),c={viewport:e,isPicking:i.startsWith("picking"),renderPass:i};for(let u=0;u<t.length;u++){const h=t[u],p=this._shouldDrawLayer(h,c,r),m={shouldDrawLayer:p,layerRenderIndex:l(h,p)};p&&(m.moduleParameters=this._getModuleParameters(h,s,i,o),m.layerParameters=this.getLayerParameters(h,u)),a[u]=m}return a}_drawLayersInViewport(e,{layers:t,pass:i,viewport:r,view:s},o){const a=function(n,{viewport:e}){const t=n.canvas?n.canvas.clientHeight||n.canvas.height:100,i=e,r=wg(n);return[i.x*r,(t-i.y-i.height)*r,i.width*r,i.height*r]}(e,{viewport:r});if(s&&s.props.clear){const c=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;nc(e,{scissorTest:!0,scissor:a},()=>vD(e,c))}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};Bu(e,{viewport:a});for(let c=0;c<t.length;c++){const u=t[c],{shouldDrawLayer:h,layerRenderIndex:p,moduleParameters:g,layerParameters:m}=o[c];if(h&&u.props.pickable&&l.pickableCount++,u.isComposite)l.compositeCount++;else if(h){l.visibleCount++,g.viewport=r;try{u.drawLayer({moduleParameters:g,uniforms:{layerIndex:p},parameters:m})}catch(E){u.raiseError(E,"drawing ".concat(u," to ").concat(i))}}}return l}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t){return e.props.parameters}_shouldDrawLayer(e,t,i){if(!this.shouldDrawLayer(e)||!e.props.visible||(t.layer=e,i&&!i(t)))return!1;let s=e.parent;for(;s;){if(!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){const s=Object.assign(Object.create(e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:wg(this.gl)});if(t)for(const o of t)Object.assign(s,o.getModuleParameters(e));return Object.assign(s,this.getModuleParameters(e,t),r)}}function hU(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const u=t[l]=t[l]||hU(e[l],e);c=u(r,s),t[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class bce extends qI{constructor(e,t){super(e,t),this.shadowMap=new Ia(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new xg(e,{format:33189,width:1,height:1}),this.fbo=new Rs(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;nc(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=wg(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(zn(ht({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Ece=Object.keys(Pi).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(Pi[n],";")).join(""),Sce=Object.keys(zc).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(zc[n],";")).join(""),Cce="".concat(Ece,"\n").concat(Sce,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),xce={},YI={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}],vs:Cce,getUniforms:function(n=xce){return n.viewport?function({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Pi.DEFAULT,coordinateOrigin:r,autoWrapLongitude:s=!1}={}){i===Pi.DEFAULT&&(i=n.isGeospatial?Pi.LNGLAT:Pi.CARTESIAN);const o=Moe({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||xoe,o}(n):{}}},Dce=$E(function({viewport:n,center:e}){return new $n(n.viewProjectionMatrix).invert().transform(e)}),Ice=$E(function({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function(n,e){const[t,i,r]=n,s=cv([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new wo(n.center).negate()),l=s.map(u=>a.transform(u)),c=(new $n).ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});t.push(c.multiplyRight(o))}return t}),Oce=[0,0,0,1],Rce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],KI={name:"shadow",dependencies:[YI],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>{if(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0){const{shadowEnabled:t=!0}=n;return t&&n.shadowMatrices&&n.shadowMatrices.length>0?function(n={},e={}){const t={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||Oce,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},i=Dce({viewport:n.viewport,center:e.project_uCenter}),r=[],s=Ice({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let o=0;o<n.shadowMatrices.length;o++){const a=s[o],l=a.clone().translate(new wo(n.viewport.center).negate());e.project_uCoordinateSystem===Pi.LNGLAT&&e.project_uProjectionMode===zc.WEB_MERCATOR?(s[o]=l,r[o]=i):(s[o]=a.clone().multiplyRight(Rce),r[o]=l.transform(i))}for(let o=0;o<s.length;o++)t["shadow_uViewProjectionMatrices[".concat(o,"]")]=s[o],t["shadow_uProjectCenters[".concat(o,"]")]=r[o],t["shadow_uShadowMap".concat(o)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[o]:n.dummyShadowMap;return t}(n,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}},kce={color:[255,255,255],intensity:1},fU=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Bce=[0,0,0,200/255];class XI extends dU{constructor(e){super(e),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=Bce,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=sv.getDefaultProgramManager(e),KI&&this.programManager.addDefaultModule(KI)),this.dummyShadowMap||(this.dummyShadowMap=new Ia(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(KI),this.programManager=null)}_createLightMatrix(){const e=[];for(const t of this.directionalLights){const i=(new $n).lookAt({eye:new wo(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new bce(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new cU(kce),this.directionalLights.push(new uU(fU[0]),new uU(fU[1])))}}let Vce=1,jce=1;class pU{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=Vce++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=jce++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}class Uce{constructor(e,t,i){this.id=e,this.context=i,this._loadCount=0,this._subscribers=new Set,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=rS(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=null,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=null,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class zce{constructor({gl:e,protocol:t}){this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new Uce(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{};a.resource&&(a.resource.unsubscribe(a),a.resource=null,this.prune()),i&&(o[t]=a,a.onChange=r,a.resource=i,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const Hce=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},YI],Gce=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function $ce(n){const e=sv.getDefaultProgramManager(n);for(const t of Hce)e.addDefaultModule(t);for(const t of Gce)e.addShaderHook(t);return e}const Yce=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class Kce{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new zce({gl:e,protocol:"deck://"}),this.context=zn(ht({},Yce),{layerManager:this,gl:e,deck:t,programManager:e&&$ce(e),stats:i||new hD({id:"deck.gl"}),viewport:r||new Fg({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new pU,resourceManager:this.resourceManager}),this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e=null}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Eo("layerManager.setLayers",this,t,e),this.lastRenderedLayers=e,e=AD(e,Boolean);for(const i of e)i.context=this.context;return this._updateLayers(this.layers,e),this}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this.lastRenderedLayers,e)),this._nextLayers=null}activateViewport(e){return Eo("layerManager.activateViewport",this,e),e&&(this.context.viewport=e),this}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?ki.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s=!0;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&ki.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite&&r.getSubLayers()}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}class Xce{constructor(e={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers)this.controllers[e]&&this.controllers[e].finalize();this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return"string"==typeof e?this.views.find(t=>t.id===e):e}getViewState(e){const t=this.getView(e),i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){"views"in e&&this._setViews(e.views),"viewState"in e&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=AD(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!mv(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):ki.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){t.viewId=e,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(t)}_createController(e,t){return new(0,t.type)(ht({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e._getViewport(s,{width:s.width,height:s.height})},t))}_updateController(e,t,i,r){let s=e.controller;return s?(s=zn(ht(ht(ht({},t),e.props),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height}),r?r.setProps(s):r=this._createController(e,s),r):null}_rebuildViewports(){const{width:e,height:t,views:i}=this,r=this.controllers;this._viewports=[],this.controllers={};let s=!1;for(let o=i.length;o--;){const a=i[o],l=this.getViewState(a),c=a.makeViewport({width:e,height:t,viewState:l});let u=r[a.id];a.controller&&!u&&(s=!0),(s||!a.controller)&&u&&(u.finalize(),u=null),this.controllers[a.id]=this._updateController(a,l,c,u),this._viewports.unshift(c)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}class Zce extends lU{constructor({makeViewport:e,width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,maxZoom:u=20,minZoom:h=0,maxPitch:p=60,minPitch:g=0,startPanLngLat:m,startZoomLngLat:E,startRotatePos:C,startBearing:R,startPitch:z,startZoom:de,normalize:Ie}={}){ic(Number.isFinite(s)),ic(Number.isFinite(r)),ic(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:u,minZoom:h,maxPitch:p,minPitch:g,normalize:Ie}),this._state={startPanLngLat:m,startZoomLngLat:E,startRotatePos:C,startBearing:R,startPitch:z,startZoom:de},this.makeViewport=e}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this._state.startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this._viewportProps).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this._state;if(!r||!Number.isFinite(s)||!Number.isFinite(o))return this;let a;return a=e?this._calculateNewPitchAndBearing(zn(ht({},this._getRotationParams(e,r)),{startBearing:s,startPitch:o})):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,s=this._unproject(t)||this._unproject(e));const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(zn(ht({},this._viewportProps),{zoom:o}));return this._getUpdatedState(ht({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=ht({},this._viewportProps),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_zoomFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this._viewportProps;return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(ht(ht(ht({makeViewport:this.makeViewport},this._viewportProps),this._state),e))}_applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=Oa(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Oa(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function({width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s=0,bearing:o=0}){(t<-180||t>180)&&(t=lj(t+180,360)-180),(o<-180||o>180)&&(o=lj(o+180,360)-180);const a=QD(e/512);if(r<=a)r=a,i=0;else{const l=e/2/Math.pow(2,r),c=Ng([0,l])[1];if(i<c)i=c;else{const u=Ng([0,512-l])[1];i>u&&(i=u)}}return{width:n,height:e,longitude:t,latitude:i,zoom:r,pitch:s,bearing:o}}(e)),e}_unproject(e){const t=this.makeViewport(this._viewportProps);return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this._viewportProps;return Oa(t+Math.log2(e),r,i)}_calculateNewPitchAndBearing({deltaScaleX:e,deltaScaleY:t,startBearing:i,startPitch:r}){t=Oa(t,-1,1);const{minPitch:s,maxPitch:o}=this._viewportProps;let l=r;return t>0?l=r+t*(o-r):t<0&&(l=r-t*(s-r)),{pitch:l,bearing:i+180*e}}_getRotationParams(e,t){const i=e[0]-t[0],r=e[1]-t[1],s=e[1],o=t[1],{width:a,height:l}=this._viewportProps,c=i/a;let u=0;return r>0?Math.abs(l-o)>5&&(u=r/(o-l)*1.2):r<0&&o>5&&(u=1-s/o),u=Math.min(1,Math.max(-1,u)),{deltaScaleX:c,deltaScaleY:u}}}class Jce extends WI{constructor(e){e.dragMode=e.dragMode||"pan",super(Zce,e)}setProps(e){const t=this.controllerStateProps;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(ht(ht({makeViewport:this.makeViewport},this.controllerStateProps),this._state)))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}let eue=(()=>{class n extends $I{constructor(t){super(zn(ht({},t),{type:wj}))}get controller(){return this._getControllerProps({type:Jce})}}return n.displayName="MapView",n})();const tue=new XI;class nue{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!mv(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._createInternalEffects()}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some(e=>e instanceof XI)||this._internalEffects.push(tue)}}class iue extends qI{}const mU={blendFunc:[1,0,32771,0],blendEquation:32774};class _U extends qI{render(e){e.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(e)):(this.useAlpha=!1,super.render(e))}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},pass:h="picking",redrawReason:p,pickZ:g}){const m=this.gl;return this.pickZ=g,nc(m,zn(ht({scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},mU),{blend:!g}),()=>{super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pass:h,redrawReason:p})})}shouldDrawLayer(e){return e.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t){const i=this.pickZ?{blend:!1}:zn(ht({},mU),{blend:!0,blendColor:[0,0,0,this.useAlpha?(t+1)/255:1]});return ht(ht({},e.props.parameters),i)}}class sue{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new iue(e),this.pickLayersPass=new _U(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=this.layerFilter,e.effects=e.effects||[],e.target=e.target||Rs.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(zn(ht({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,Eo("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new Rs(this.gl),new Rs(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const oue={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function aue({pickedColors:n,layers:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){if(n){const{x:o,y:a,width:l,height:c}=s;let u=r*r,h=-1,p=0;for(let g=0;g<c;g++){const m=g+a-i,E=m*m;if(E>u)p+=4*l;else for(let C=0;C<l;C++){if(n[p+3]-1>=0){const z=C+o-t,de=z*z+E;de<=u&&(u=de,h=p)}p+=4}}if(h>=0){const g=n[h+3]-1,m=n.slice(h,h+4),E=e[g];if(E){const C=E.decodePickingColor(m),R=Math.floor(h/4/l);return{pickedColor:m,pickedLayer:E,pickedObjectIndex:C,pickedX:o+(h/4-R*l),pickedY:a+R}}ki.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return oue}function yU({pickInfo:n,mode:e,viewports:t,layerFilter:i,pixelRatio:r,x:s,y:o,z:a}){const l=n&&n.pickedLayer,u=function(n,e,t){for(let i=n.length-1;i>=0;i--){const r=n[i];if(r.containsPixel(e)&&(!t||t(r)))return r}return n[0]}(t,{x:s,y:o},i&&l&&(p=>i({layer:l,viewport:p,isPicking:!0,renderPass:"picking:".concat(e)}))),h=u&&u.unproject([s-u.x,o-u.y],{targetZ:a});return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:s,y:o,pixel:[s,o],coordinate:h,devicePixel:n&&[n.pickedX,n.pickedY],pixelRatio:r}}function cue(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const h=t.index,p=t.layerId,g=o&&o.props.id;if(g!==p||a!==h){if(g!==p){const m=r.find(E=>E.props.id===p);m&&l.unshift(m)}t.layerId=g,t.index=a,t.info=null}}const c=yU(n),u=new Map;return u.set(null,c),l.forEach(h=>{let p=ht({},c);h===o&&(p.color=s,p.index=a,p.picked=!0),p=vU({layer:h,info:p,mode:i}),h===o&&"hover"===i&&(t.info=p),u.set(p.layer.id,p),"hover"===i&&p.layer.updateAutoHighlight(p)}),u}function vU({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class due{constructor(e){this.gl=e,this.pickingFBO=null,this.pickLayersPass=new _U(e),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(p=>p.id===o):null,c=a&&r.find(p=>p.id===a)||r[0],u=c&&c.unproject([e-c.x,t-c.y]),h={x:e,y:t,viewport:c,coordinate:u,layer:l};return l?ht(ht({},s),h):Object.assign(h,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:e}=this;return this.pickingFBO||(this.pickingFBO=new Rs(e),Rs.isSupported(e,{colorBufferFloat:!0})&&(this.depthFBO=new Rs(e),this.depthFBO.attach({36064:new Ia(e,{format:_i(e)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:e.canvas.width,height:e.canvas.height}),this.pickingFBO}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length>255?(ki.warn("Too many pickable layers, only picking the first 255")(),t.slice(0,255)):t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u}){if(!(e=this._getPickable(e)))return{result:[],emptyInfo:yU({viewports:i,x:r,y:s})};this._resizeBuffer();const h=wg(this.gl),p=cD(this.gl,[r,s],!0),g=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],m=Math.round(o*h),{width:E,height:C}=this.pickingFBO,R=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceWidth:E,deviceHeight:C});let z;const de=[],Ie={};for(let Be=0;Be<a;Be++){const ct=aue({pickedColors:R&&this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:R,pass:"picking:".concat(l),redrawReason:l}),layers:e,deviceX:g[0],deviceY:g[1],deviceRadius:m,deviceRect:R});let Dt;if(ct.pickedLayer&&c&&this.depthFBO&&(Dt=this._drawAndSample({layers:[ct.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:ct.pickedX,y:ct.pickedY,width:1,height:1},pass:"picking:".concat(l),redrawReason:"pick-z",pickZ:!0})[0]*i[0].distanceScales.metersPerUnit[2]+i[0].position[2]),ct.pickedColor&&Be+1<a){const Ot=ct.pickedColor[3]-1;Ie[Ot]=!0,e[Ot].disablePickingIndex(ct.pickedObjectIndex)}z=cue({pickInfo:ct,lastPickedInfo:this.lastPickedInfo,mode:l,layers:e,layerFilter:this.layerFilter,viewports:i,x:r,y:s,z:Dt,pixelRatio:h});for(const Ot of z.values())Ot.layer&&de.push(Ot);if(!ct.pickedColor)break}for(const Be in Ie)e[Be].restorePickingColors();return{result:de,emptyInfo:z&&z.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u}){if(!(e=this._getPickable(e)))return[];this._resizeBuffer();const h=wg(this.gl),p=cD(this.gl,[r,s],!0),g=p.x,m=p.y+p.height,E=cD(this.gl,[r+o,s+a],!0),R=E.y,Ie=function({pickedColors:n,layers:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4){const r=n[i+3]-1;if(r>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e[r];a?t.set(o,{pickedColor:s,pickedLayer:a,pickedObjectIndex:a.decodePickingColor(s)}):ki.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}({pickedColors:this._drawAndSample({layers:e,views:t,viewports:i,onViewportActive:u,deviceRect:{x:g,y:R,width:E.x+E.width-g,height:m-R},pass:"picking:".concat(l),redrawReason:l}),layers:e}),Be=new Map,Ne=Number.isFinite(c);for(let ct=0;ct<Ie.length&&!(Ne&&Be.size>=c);ct++){const Dt=Ie[ct];let Ot={color:Dt.pickedColor,layer:null,index:Dt.pickedObjectIndex,picked:!0,x:r,y:s,width:o,height:a,pixelRatio:h};Ot=vU({layer:Dt.pickedLayer,info:Ot,mode:l}),Be.has(Ot.object)||Be.set(Ot.object,Ot)}return Array.from(Be.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,pass:o,redrawReason:a,pickZ:l}){if(e.length<1)return null;const c=l?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:c,deviceRect:s,pass:o,redrawReason:a,pickZ:l});const{x:u,y:h,width:p,height:g}=s,m=new(l?Float32Array:Uint8Array)(p*g*4);return AE(c,{sourceX:u,sourceY:h,sourceWidth:p,sourceHeight:g,target:m}),m}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const hue={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class fue{constructor(e){const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,hue),t.appendChild(this.el)),this.isVisible=!1}setTooltip(e,t,i){const r=this.el;if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");"text"in e&&(r.innerText=e.text),"html"in e&&(r.innerHTML=e.html),"className"in e&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}remove(){this.el&&this.el.remove()}}function bU(n,e){if(!n)throw new Error(e)}const Xc={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},wU=Xc.global||Xc.self||Xc.window,gue="object"!=typeof process||"[object process]"!==String(process)||process.browser,EU="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:mue}=(EU&&parseFloat(EU[1]),wU),QI="undefined"!=typeof Image,ZI="undefined"!=typeof ImageBitmap,_ue=Boolean(mue),JI=!!gue||_ue;function SU(n){const e=function(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function CU(n){switch(SU(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const bue=/^data:image\/svg\+xml/,wue=/\.svg((\?|#).*)?$/;function eO(n){return n&&(bue.test(n)||wue.test(n))}function Eue(n,e){if(eO(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return TU(n,e)}function TU(n,e){if(eO(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function AU(n,e,t){return tO.apply(this,arguments)}function tO(){return(tO=ni(function*(n,e,t){const i=Eue(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield Sue(s||i,e)}finally{s&&r.revokeObjectURL(s)}})).apply(this,arguments)}function Sue(n,e){return nO.apply(this,arguments)}function nO(){return(nO=ni(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error(`Could not load image ${n}: ${s}`))}catch(s){r(s)}})})).apply(this,arguments)}const Cue={};let MU=!0;function xue(n,e,t){return iO.apply(this,arguments)}function iO(){return(iO=ni(function*(n,e,t){let i;i=eO(t)?yield AU(n,e,t):TU(n,t);const r=e&&e.imagebitmap;return yield Tue(i,r)})).apply(this,arguments)}function Tue(n){return rO.apply(this,arguments)}function rO(){return(rO=ni(function*(n,e=null){if((Aue(e)||!MU)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),MU=!1}return yield createImageBitmap(n)})).apply(this,arguments)}function Aue(n){for(const e in n||Cue)return!1;return!0}const Qc=!1,yv=!0;function sO(n){const e=vv(n);return function(n){const e=vv(n);return e.byteLength>=24&&2303741511===e.getUint32(0,Qc)?{mimeType:"image/png",width:e.getUint32(16,Qc),height:e.getUint32(20,Qc)}:null}(e)||function(n){const e=vv(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,Qc)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Qc);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Qc),width:e.getUint16(s+7,Qc)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,Qc)}return null}(e)||function(n){const e=vv(n);return e.byteLength>=10&&1195984440===e.getUint32(0,Qc)?{mimeType:"image/gif",width:e.getUint16(6,yv),height:e.getUint16(8,yv)}:null}(e)||function(n){const e=vv(n);return e.byteLength>=14&&16973===e.getUint16(0,Qc)&&e.getUint32(2,yv)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,yv),height:e.getUint32(22,yv)}:null}(e)}function vv(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function Pue(n,e){const{mimeType:t}=sO(n)||{},{_parseImageNode:i}=wU;return bU(i),i(n,t,e)}function oO(){return(oO=ni(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(Fue(r)){case"imagebitmap":a=yield xue(n,e,s);break;case"image":a=yield AU(n,e,s);break;case"data":a=yield Pue(n,e);break;default:bU(!1)}return"data"===r&&(a=CU(a)),a})).apply(this,arguments)}function Fue(n){switch(n){case"auto":case"data":return function(){if(ZI)return"imagebitmap";if(QI)return"image";if(JI)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(n){switch(n){case"auto":return ZI||QI||JI;case"imagebitmap":return ZI;case"image":return QI;case"data":return JI;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}(n),n}}const DU={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(n,e,t){return oO.apply(this,arguments)},tests:[n=>Boolean(sO(new DataView(n)))],options:{image:{type:"auto",decode:!0}}},kue={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},bv="8.5.8",dS=Er.CO.deck&&Er.CO.deck.VERSION;if(dS&&dS!==bv)throw new Error("deck.gl - multiple versions detected: ".concat(dS," vs ").concat(bv));dS||(ki.log(1,"deck.gl ".concat(bv))(),Er.CO.deck=Object.assign(Er.CO.deck||{},{VERSION:bv,version:bv,log:ki,_registerLoggers:function(n){OD=n}}),Jj([kue,[DU,{imagebitmap:{premultiplyAlpha:"none"}}]]));const Bue=Er.CO.deck;class hS extends Vu{static isSupported(e,t=[]){const i=_i(e),r=$B(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:sn(!1)}return s}constructor(e,t={}){super(e,t),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:e=!1}={}){return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return hS.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const IU=(0,Er.jU)()&&"undefined"!=typeof document;let Yue=0;class Kue{constructor(e={}){const{onCreateContext:t=(C=>TB(C)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:h=!1,autoResizeViewport:p=!0,autoResizeDrawingBuffer:g=!0,stats:m=mf.get("animation-loop-"+Yue++)}=e;let{useDevicePixels:E=!0}=e;"useDevicePixelRatio"in e&&(fn.deprecated("useDevicePixelRatio","useDevicePixels")(),E=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:h},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=m,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:p,autoResizeDrawingBuffer:g,useDevicePixels:E}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return sn("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(e={}){if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=hS.isSupported(this.gl,["timers"])?new hS(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return ni(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...e){return this.props.onCreateContext(...e)}onInitialize(...e){return this.props.onInitialize(...e)}onRender(...e){return this.props.onRender(...e)}onFinalize(...e){return this.props.onFinalize(...e)}getHTMLControlValue(e,t=1){const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return fn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=IU?new Promise((e,t)=>{IU&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(...e){this.display?this.display._renderFrame(...e):this.onRender(...e)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?dD(this.props.gl,e):this.onCreateContext(e),!xE(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function(n){Bu(n,lD)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(n,e={}){if(n.canvas)return void function(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(fn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(fn.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(n,function(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Rs(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var Xue=tt(524),fS=tt.n(Xue);const Que={mousedown:1,mousemove:2,mouseup:4};(function(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function(n,e){for(let t=0;t<n.length;t++)if(n[t].pointerId===i.pointerId)return!0;return!1}(r)||r.push(i)),e.call(this,i)}})(fS().PointerEventInput),function(n){n.prototype.handler=function(t){let i=Que[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(fS().MouseInput);const tde=fS().Manager,Zc=fS(),nde=Zc?[[Zc.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Zc.Rotate,{enable:!1}],[Zc.Pinch,{enable:!1}],[Zc.Swipe,{enable:!1}],[Zc.Pan,{threshold:0,enable:!1}],[Zc.Press,{enable:!1}],[Zc.Tap,{event:"doubletap",taps:2,enable:!1}],[Zc.Tap,{event:"anytap",enable:!1}],[Zc.Tap,{enable:!1}]]:null,PU={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},ide={doubletap:["tap"]},rde={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},lO={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},sde={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},NU={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},ode="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Bg="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let FU=!1;try{const n={get passive(){return FU=!0,!0}};Bg.addEventListener("test",n,n),Bg.removeEventListener("test",n,n)}catch(n){}const ade=-1!==ode.indexOf("firefox"),{WHEEL_EVENTS:lde}=lO,kU=4.000244140625;class dde{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.events=lde.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!FU&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}handleEvent(e){if(!this.options.enable)return;let t=e.deltaY;Bg.WheelEvent&&(ade&&e.deltaMode===Bg.WheelEvent.DOM_DELTA_PIXEL&&(t/=Bg.devicePixelRatio),e.deltaMode===Bg.WheelEvent.DOM_DELTA_LINE&&(t*=40));const i={x:e.clientX,y:e.clientY};0!==t&&t%kU==0&&(t=Math.floor(t/kU)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,i)}_onWheel(e,t,i){this.callback({type:"wheel",center:i,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}const{MOUSE_EVENTS:hde}=lO,BU="pointermove",VU="pointerover",jU="pointerout",UU="pointerleave";class fde{constructor(e,t,i={}){this.element=e,this.callback=t,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=hde.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===BU&&(this.enableMoveEvent=t),e===VU&&(this.enableOverEvent=t),e===jU&&(this.enableOutEvent=t),e===UU&&(this.enableLeaveEvent=t)}handleEvent(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:VU,srcEvent:e,pointerType:"mouse",target:e.target})}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:jU,srcEvent:e,pointerType:"mouse",target:e.target})}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:UU,srcEvent:e,pointerType:"mouse",target:e.target})}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:BU,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:pde}=lO,zU="keydown";class gde{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=pde.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===zU&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}handleEvent(e){const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:zU,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}const GU="contextmenu";class mde{constructor(e,t,i={}){this.element=e,this.callback=t,this.options=Object.assign({enable:!0},i),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===GU&&(this.options.enable=t)}handleEvent(e){!this.options.enable||this.callback({type:GU,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const _de={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},$U={srcElement:"root",priority:0};class Dde{constructor(e){this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;i&&("object"!=typeof i||i.addEventListener)&&(i={srcElement:i}),i=i?Object.assign({},$U,i):$U;let l=a.get(i.srcElement);l||(l=[],a.set(i.srcElement,l));const c={type:e,handler:t,srcElement:i.srcElement,priority:i.priority};r&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let u=l.length-1;for(;u>=0&&!(l[u].priority>=c.priority);)u--;l.splice(u+1,0,c)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}handleEvent(e){if(this.isEmpty())return;const t=this._normalizeEvent(e);let i=e.srcEvent.target;for(;i&&i!==t.rootElement;){if(this._emit(t,i),t.handled)return;i=i.parentNode}this._emit(t,"root")}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:u,once:h}=i[l];if(u(Object.assign({},e,{type:c,stopPropagation:s,stopImmediatePropagation:o})),h&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const t=this.eventManager.element;return Object.assign({},e,function(n){const e=_de[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e),function(n,e){const{srcEvent:t}=n;if(!n.center&&!Number.isFinite(t.clientX))return null;const i=n.center||{x:t.clientX,y:t.clientY},r=e.getBoundingClientRect();return{center:i,offsetCenter:{x:(i.x-r.left-e.clientLeft)/(r.width/e.offsetWidth||1),y:(i.y-r.top-e.clientTop)/(r.height/e.offsetHeight||1)}}}(e,t),{handled:!1,rootElement:t})}}const Ide={events:null,recognizers:null,recognizerOptions:{},Manager:tde,touchAction:"none",tabIndex:0};class Ode{constructor(e=null,t={}){this.options=Object.assign({},Ide,t),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);const{events:i}=t;i&&this.on(i)}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||nde}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(PU).forEach(r=>{const s=this.manager.get(r);s&&PU[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new dde(e,this._onOtherEvent,{enable:!1}),this.moveInput=new fde(e,this._onOtherEvent,{enable:!1}),this.keyInput=new gde(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new mde(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=ide[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,l=NU[e]||e;let c=a.get(l);c||(c=new Dde(this),a.set(l,c),c.recognizerName=sde[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(NU[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}_onBasicInput(e){const{srcEvent:t}=e,i=rde[t.type];i&&this.manager.emit(i,e)}_onOtherEvent(e){this.manager.emit(e.type,e)}}function Ef(){}const WU={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:Ef,onResize:Ef,onViewStateChange:Ef,onInteractionStateChange:Ef,onBeforeRender:Ef,onAfterRender:Ef,onLoad:Ef,onError:(n,e)=>ki.error(n)(),_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",debug:!1,drawPickingColors:!1};class gS{constructor(e){e=ht(ht({},WU),e),this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),e.viewState&&e.initialViewState&&ki.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,Er.qs)()&&ki.warn("IE 11 support will be deprecated in v8.0")(),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new hD({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Qy.setProps(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),!this.props.canvas&&!this.props.gl&&this.canvas&&(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ki.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ki.removed("onLayerClick","onClick")(),e.initialViewState&&!mv(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;const t=e||this.needsRedraw({clearRedrawFlags:!0});!t||(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}getViews(){return this.viewManager.views}getViewports(e){return this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](ht({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),ic(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;let{width:t,height:i}=e;(t||0===t)&&(t=Number.isFinite(t)?"".concat(t,"px"):t,this.canvas.style.width=t),(i||0===i)&&(i=Number.isFinite(i)?"".concat(i,"px"):i,this.canvas.style.position="absolute",this.canvas.style.height=i)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:e,height:t}=this;this.viewManager.setProps({width:e,height:t}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:e}=this;if(!e)return!1;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;return(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,!0)}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u,autoResizeDrawingBuffer:h}=e;return new Kue({width:t,height:i,useDevicePixels:u,autoResizeDrawingBuffer:h,autoResizeViewport:!1,gl:r,onCreateContext:p=>TB(zn(ht(ht({},s),p),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:p=>this._setGLContext(p.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new eue({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_onPointerMove(e){const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const i=e.offsetCenter;if(!i)return;t.x=i.x,t.y=i.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e,t.mode="hover"}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.interactiveState.isHovering=t.length>0;let r=i,s=!1;for(const o of t)r=o,s=o.layer.onHover(o,e.event);if(!s&&this.props.onHover&&this.props.onHover(r,e.event),this.props.getTooltip){const o=this.props.getTooltip(r);this.tooltip.setTooltip(o,r.x,r.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,dD(e,{enable:!0,copyState:!0})),this.tooltip=new fue(this.canvas),Bu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new pU;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Ode(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in uB)this.eventManager.on(r,this._onEvent);this.viewManager=new Xce({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new Kce(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new nue,this.deckRenderer=new sue(e),this.deckPicker=new due(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;Bu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(ht({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),ki.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=zn(ht({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.interactiveState.isDragging=e.isDragging,this.props.onInteractionStateChange(e)}_onEvent(e){const t=uB[e.type],i=e.offsetCenter;if(!t||!i)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:r,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=s,a=o&&(o[t.handler]||o.props[t.handler]),l=this.props[t.handler];let c=!1;a&&(c=a.call(o,s,e)),!c&&l&&l(s,e)}_onPointerDown(e){const t=e.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:t.x,y:t.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=mf.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}gS.getPropTypes=function(n){return{id:n.string,width:n.oneOfType([n.number,n.string]),height:n.oneOfType([n.number,n.string]),layers:n.oneOfType([n.object,n.array]),layerFilter:n.func,views:n.oneOfType([n.object,n.array]),viewState:n.object,effects:n.arrayOf(n.instanceOf(dU)),controller:n.oneOfType([n.func,n.bool,n.object]),gl:n.object,glOptions:n.object,parameters:n.object,pickingRadius:n.number,useDevicePixels:n.oneOfType([n.bool,n.number]),touchAction:n.string,eventRecognizerOptions:n.object,onWebGLInitialized:n.func,onResize:n.func,onViewStateChange:n.func,onInteractionStateChange:n.func,onBeforeRender:n.func,onAfterRender:n.func,onLoad:n.func,onError:n.func,debug:n.bool,drawPickingColors:n.bool,_framebuffer:n.object,_animate:n.bool,_pickable:n.bool,_typedArrayManagerProps:n.object}},gS.defaultProps=WU,gS.VERSION=Bue.VERSION;const qU={name:"project32",dependencies:[YI],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},YU="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",Nde={lightSources:{}};function dO({color:n=[0,0,0],intensity:e=1}={}){return n.map(t=>t*e/255)}const hO={name:"lights",vs:YU,fs:YU,getUniforms:function KU(n=Nde){if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},function({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};return i["lighting_uAmbientLight.color"]=n?dO(n):[0,0,0],e.forEach((r,s)=>{i[`lighting_uPointLight[${s}].color`]=dO(r),i[`lighting_uPointLight[${s}].position`]=r.position,i[`lighting_uPointLight[${s}].attenuation`]=r.attenuation||[1,0,0]}),i.lighting_uPointLightCount=e.length,t.forEach((r,s)=>{i[`lighting_uDirectionalLight[${s}].color`]=dO(r),i[`lighting_uDirectionalLight[${s}].direction`]=r.direction}),i.lighting_uDirectionalLightCount=t.length,i}({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return KU({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Lde={};const Bde={name:"phong-lighting",dependencies:[hO],fs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_FRAGMENT:1},getUniforms:function(n=Lde){if(!("material"in n))return{};const{material:e}=n;return e?function(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}(e):{lighting_uEnabled:!1}}},jde={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},ZU=ht({inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(n=jde){const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),JU={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class mS{static get DRAW_MODE(){return JU}constructor(e={}){const{id:t=Gc("geometry"),drawMode:i=JU.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?ht({indices:this.indices},this.attributes):this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,sn(ArrayBuffer.isView(r.value),`${this._print(i)}: must be typed array or object with value as typed array`),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(sn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return sn(Number.isFinite(i)),i}}const fO=Math.PI/180,_S=new Float32Array(16),ez=new Float32Array(12);function tz(n,e,t){const i=e[0]*fO,r=e[1]*fO,s=e[2]*fO,o=Math.sin(s),a=Math.sin(i),l=Math.sin(r),c=Math.cos(s),u=Math.cos(i),h=Math.cos(r),p=t[0],g=t[1],m=t[2];n[0]=p*h*u,n[1]=p*l*u,n[2]=p*-a,n[3]=g*(-l*c+h*a*o),n[4]=g*(h*c+l*a*o),n[5]=g*u*o,n[6]=m*(l*o+h*a*c),n[7]=m*(-h*o+l*a*c),n[8]=m*u*c}function nz(n){return n[0]=n[0],n[1]=n[1],n[2]=n[2],n[3]=n[4],n[4]=n[5],n[5]=n[6],n[6]=n[8],n[7]=n[9],n[8]=n[10],n[9]=n[12],n[10]=n[13],n[11]=n[14],n.subarray(0,12)}const iz={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(n,{startRow:e,endRow:t}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),c=l&&16===a.length,u=Array.isArray(s),h=Array.isArray(r),p=Array.isArray(o),g=c||!l&&Boolean(a(i[0]));n.constant=g?c:h&&u&&p;const m=n.value;if(n.constant){let E;g?(_S.set(a),E=nz(_S)):(E=ez,tz(E,r,s),E.set(o,9)),n.value=new Float32Array(E)}else{let E=e*n.size;const{iterable:C,objectInfo:R}=sV(i,e,t);for(const z of C){let de;R.index++,g?(_S.set(c?a:a(z,R)),de=nz(_S)):(de=ez,tz(de,h?r:r(z,R),u?s:s(z,R)),de.set(p?o:o(z,R),9)),m[E++]=de[0],m[E++]=de[1],m[E++]=de[2],m[E++]=de[3],m[E++]=de[4],m[E++]=de[5],m[E++]=de[6],m[E++]=de[7],m[E++]=de[8],m[E++]=de[9],m[E++]=de[10],m[E++]=de[11]}}}};function rz(n,e){return e===Pi.CARTESIAN||e===Pi.METER_OFFSETS||e===Pi.DEFAULT&&!n.isGeospatial}function sz(n,e){(n.COLOR_0||n.colors)&&e||(n.colors={constant:!0,value:new Float32Array([1,1,1])}),ki.assert(n.positions||n.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Gde(n,e){if(n.attributes)return sz(n.attributes,e),n instanceof mS?n:new mS(n);if(n.positions||n.POSITION)return sz(n,e),new mS({attributes:n});throw Error("Invalid mesh")}const $de={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};let Wde=(()=>{class n extends GI{getShaders(){const t=!_i(this.context.gl),i={};return ED(this.context.gl,"GLSL_DERIVATIVES")&&(i.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[qU,Bde,ZU],transpileToGLSL100:t,defines:i})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:iz}),this.setState({emptyTexture:new Ia(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:i,changeFlags:r}){if(super.updateState({props:t,oldProps:i,changeFlags:r}),t.mesh!==i.mesh||r.extensionsChanged){var s;if(null===(s=this.state.model)||void 0===s||s.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const o=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==i.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:i}=this.context,{sizeScale:r,coordinateSystem:s,_instanced:o}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:r,composeModelMatrix:!o||rz(i,s),flatShading:!this.state.hasNormals}).draw()}getModel(t){const i=new zE(this.context.gl,zn(ht({},this.getShaders()),{id:this.props.id,geometry:Gde(t,this.props._useMeshColors),isInstanced:!0})),{texture:r}=this.props,{emptyTexture:s}=this.state;return i.setUniforms({sampler:r||s,hasTexture:Boolean(r)}),i}setTexture(t){const{emptyTexture:i,model:r}=this.state;null==r||r.setUniforms({sampler:t||i,hasTexture:Boolean(t)})}}return n.layerName="SimpleMeshLayer",n.defaultProps=$de,n})();const oz={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[hO]};class Vg{constructor(e={}){const{id:t}=e;this.id=t||Gc(this.constructor.name),this.display=!0,this.position=new wo,this.rotation=new wo,this.scale=new wo(1,1,1),this.matrix=new $n,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return sn(3===e.length,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return sn(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return sn(3===e.length,"setScale requires vector argument"),this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents({position:e,rotation:t,scale:i,update:r=!0}){return e&&this.setPosition(e),t&&this.setRotation(t),i&&this.setScale(i),r&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(i),this}update(e={}){const{position:t,rotation:i,scale:r}=e;return t&&this.setPosition(t),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,t){sn(e),t=t||this.matrix;const i=new $n(e).multiplyRight(t),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class wv extends Vg{constructor(e={}){e=Array.isArray(e)?{children:e}:e;const{children:t=[]}=e;fn.assert(t.every(i=>i instanceof Vg),"every child must an instance of ScenegraphNode"),super(e),this.children=t}add(...e){for(const t of e)Array.isArray(t)?this.add(...t):this.children.push(t);return this}remove(e){const t=this.children,i=t.indexOf(e);return i>-1&&t.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e,{worldMatrix:t=new $n}={}){const i=new $n(t).multiplyRight(this.matrix);for(const r of this.children)r instanceof wv?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}function az(){var n=new la(4);return la!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function lz(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function cz(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return n[0]=i*u+o*a+r*c-s*l,n[1]=r*u+o*l+s*a-i*c,n[2]=s*u+o*c+i*l-r*a,n[3]=o*u-i*a-r*l-s*c,n}var dz=nj,ahe=function(){var n=KB(),e=XB(1,0,0),t=XB(0,1,0);return function(i,r,s){var o=QB(r,s);return o<-.999999?(OE(n,e,r),function(n){return Math.hypot(n[0],n[1],n[2])}(n)<1e-6&&OE(n,t,r),function(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),lz(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(OE(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();az(),az(),function(){var n=new la(9);la!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const lhe=[0,0,0,1];class pO extends DE{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromMatrix3(e){return function(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}}(this,e),this.check()}identity(){return function(n){n[0]=0,n[1]=0,n[2]=0,n[3]=1}(this),this.check()}fromAxisRotation(e,t){return lz(this,e,t),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Zi(e)}get y(){return this[1]}set y(e){this[1]=Zi(e)}get z(){return this[2]}set z(e){this[2]=Zi(e)}get w(){return this[3]}set w(e){this[3]=Zi(e)}len(){return function(n){return Math.hypot(n[0],n[1],n[2],n[3])}(this)}lengthSquared(){return function(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r}(this)}dot(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}(this,e)}rotationTo(e,t){return ahe(this,e,t),this.check()}add(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return function(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3]}(this,this,e),this.check()}calculateW(){return function(n,e){var t=e[0],i=e[1],r=e[2];n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r))}(this,this),this.check()}conjugate(){return function(n,e){n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3]}(this,this),this.check()}invert(){return function(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a}(this,this),this.check()}lerp(e,t,i){return function(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a)}(this,e,t,i),this.check()}multiplyRight(e,t){return Uu(!t),cz(this,this,e),this.check()}multiplyLeft(e,t){return Uu(!t),cz(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a}(this,this,e),this.check()}rotateY(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a}(this,this,e),this.check()}rotateZ(e){return function(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a}(this,this,e),this.check()}scale(e){return dz(this,this,e),this.check()}slerp(e,t,i){switch(arguments.length){case 1:({start:e=lhe,target:t,ratio:i}=arguments[0]);break;case 2:[t,i]=arguments,e=this}return function(n,e,t,i){var p,g,m,E,C,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],u=t[2],h=t[3];(g=r*l+s*c+o*u+a*h)<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>$c?(p=Math.acos(g),m=Math.sin(p),E=Math.sin((1-i)*p)/m,C=Math.sin(i*p)/m):(E=1-i,C=i),n[0]=E*r+C*l,n[1]=E*s+C*c,n[2]=E*o+C*u,n[3]=E*a+C*h}(this,e,t,i),this.check()}transformVector4(e,t=e){return function(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],u=c*i+a*s-l*r,h=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;n[0]=u*c+g*-o+h*-l-p*-a,n[1]=h*c+g*-a+p*-o-u*-l,n[2]=p*c+g*-l+u*-a-h*-o,n[3]=e[3]}(t,e,this),IE(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e,t){return this.multiplyLeft(e,t)}multiply(e,t){return this.multiplyRight(e,t)}}const che={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},uhe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function pz(n){if(!n._animation){const e=uhe[n.componentType],t=che[n.type],i=t*n.count,{buffer:r,byteOffset:s}=n.bufferView.data,o=new e(r,s+(n.byteOffset||0),i);if(1===t)n._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=t)a.push(Array.from(o.slice(l,l+t)));n._animation=a}}return n._animation}const dhe=new $n,gO=new pO;class _he{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(({sampler:r,target:s,path:o})=>{(function(n,{input:e,interpolation:t,output:i},r,s){const a=n%e[e.length-1],l=e.findIndex(p=>p>=a),c=Math.max(0,l-1);if(!Array.isArray(r[s]))switch(s){case"translation":r[s]=[0,0,0];break;case"rotation":r[s]=[0,0,0,1];break;case"scale":r[s]=[1,1,1];break;default:fn.warn(`Bad animation path ${s}`)()}sn(r[s].length===i[c].length);const u=e[c],h=e[l];switch(t){case"STEP":!function(n,e,t){for(let i=0;i<t.length;i++)n[e][i]=t[i]}(r,s,i[c]);break;case"LINEAR":h>u&&function(n,e,t,i,r){if("rotation"===e){gO.slerp({start:t,target:i,ratio:r});for(let s=0;s<gO.length;s++)n[e][s]=gO[s]}else for(let s=0;s<t.length;s++)n[e][s]=r*i[s]+(1-r)*t[s]}(r,s,i[c],i[l],(a-u)/(h-u));break;case"CUBICSPLINE":h>u&&function(n,e,{p0:t,outTangent0:i,inTangent1:r,p1:s,tDiff:o,ratio:a}){for(let l=0;l<n[e].length;l++){const c=i[l]*o,u=r[l]*o;n[e][l]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*t[l]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*s[l]+(Math.pow(a,3)-Math.pow(a,2))*u}}(r,s,{p0:i[3*c+1],outTangent0:i[3*c+2],inTangent1:i[3*l+0],p1:i[3*l+1],tDiff:h-u,ratio:(a-u)/(h-u)});break;default:fn.warn(`Interpolation ${t} not supported`)()}})(i,r,s,o),function(n,e){if(e.matrix.identity(),n.translation&&e.matrix.translate(n.translation),n.rotation){const t=dhe.fromQuaternion(n.rotation);e.matrix.multiplyRight(t)}n.scale&&e.matrix.scale(n.scale)}(s,s._node)})}}class yhe{constructor(e){this.animations=e.animations.map((t,i)=>{const r=t.name||`Animation-${i}`,s=t.samplers.map(({input:a,interpolation:l="LINEAR",output:c})=>({input:pz(e.accessors[a]),interpolation:l,output:pz(e.accessors[c])})),o=t.channels.map(({sampler:a,target:l})=>({sampler:s[a],target:e.nodes[l.node],path:l.path}));return new _he({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(t=>t.animate(e))}getAnimations(){return this.animations}}class vhe extends Vg{constructor(e,t={}){super(t),this.onBeforeRender=null,this.AfterRender=null,e instanceof zE?(this.model=e,this._setModelNodeProps(t)):this.model=new zE(e,t),this.managedResources=t.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(...e){return this.model.draw(...e)}setUniforms(...e){return this.model.setUniforms(...e),this}setAttributes(...e){return this.model.setAttributes(...e),this}updateModuleSettings(...e){return this.model.updateModuleSettings(...e),this}_setModelNodeProps(e){this.model.setProps(e)}}class bhe{constructor(e,{attributes:t,material:i,pbrDebug:r,imageBasedLightingEnvironment:s,lights:o,useTangents:a}){this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},ED(e,"GLSL_TEXTURE_LOD")&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),r&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(t.NORMAL,"HAS_NORMALS"),this.defineIfPresent(t.TANGENT&&a,"HAS_TANGENTS"),this.defineIfPresent(t.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(o,"USE_LIGHTS"),this.defineIfPresent(r,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,t){e&&(this.defines[t]=1)}parseTexture(e,t,i=null){const s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new Ia(this.gl,ht({id:e.name||e.id,parameters:ht(ht({},e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{}),a),pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1}},o));this.uniforms[t]=l,this.defineIfPresent(i,i),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:t=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[t,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:t=1}=e.normalTexture;this.uniforms.u_NormalScale=t}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:t=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=t}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){const{alphaCutoff:t=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=t}else"BLEND"===e.alphaMode&&(fn.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}function gz(n,e){return _i(n)?`#version 300 es\n${e}`:e}const Che={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},xhe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class The{constructor(e,t={}){this.gl=e,this.options=Object.assign({},xhe,t)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new yhe(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new wv({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new wv({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=(new $n).fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new wv({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){fn.warn("getVertexCount() not found")()}createPrimitive(e,t,i){return function(n,e){const{id:t,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new bhe(n,e);fn.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(u=>u.buffer));const c=new vhe(n,Object.assign({id:t,drawMode:i,vertexCount:r,modules:[oz],defines:a.defines,parameters:a.parameters,vs:gz(n,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:gz(n,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},o));return c.setProps({attributes:s}),c.setUniforms(a.uniforms),c}(this.gl,Object.assign({id:e.name||`${i.name||i.id}-primitive-${t}`,drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,t){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),t&&(i.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),fn.info(4,"glTF Attributes",{attributes:e,indices:t,generated:i})(),i}createBuffer(e,t){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[t]||(i.lumaBuffers[t]=new rr(this.gl,{id:`from-${i.id}`,data:i.data||e.value,target:t})),i.lumaBuffers[t]}createAccessor(e,t){return new aa({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Che[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function mz(n,e,t){if(n.byteLength<=e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Fa(n,e){if(!n)throw new Error(e||"assert failed: gltf")}function _z(n,e){if(n.startsWith("data:")||n.startsWith("http:")||n.startsWith("https:"))return n;const i=e.baseUri||e.uri;if(!i)throw new Error(`'baseUri' must be provided to resolve relative url ${n}`);return i.substr(0,i.lastIndexOf("/")+1)+n}function yz(n,e,t){const i=n.bufferViews[t];Fa(i);const s=e[i.buffer];return Fa(s),new Uint8Array(s.arrayBuffer,(i.byteOffset||0)+s.byteOffset,i.byteLength)}const vz={name:"Draco",id:"draco",module:"draco",version:"3.0.12",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};class jg{constructor(e,t){Wn(this,"fields",void 0),Wn(this,"metadata",void 0),function(n,e){if(!n)throw new Error("loader assertion failed.")}(Array.isArray(e)),function(n){const e={};for(const t of n)e[t.name]&&console.warn("Schema: duplicated field name",t.name,t),e[t.name]=!0}(e),this.fields=e,this.metadata=t||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let t=0;t<this.fields.length;++t)if(!this.fields[t].compareTo(e.fields[t]))return!1;return!0}select(...e){const t=Object.create(null);for(const r of e)t[r]=!0;const i=this.fields.filter(r=>t[r.name]);return new jg(i,this.metadata)}selectAt(...e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new jg(t,this.metadata)}assign(e){let t,i=this.metadata;if(e instanceof jg){const o=e;t=o.fields,i=bz(bz(new Map,this.metadata),o.metadata)}else t=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of t)r[o.name]=o;const s=Object.values(r);return new jg(s,i)}}function bz(n,e){return new Map([...n||new Map,...e||new Map])}let Rr,wz,Ez,Sz,Cz,xz,Tz,Az;!function(n){n[n.NONE=0]="NONE",n[n.Null=1]="Null",n[n.Int=2]="Int",n[n.Float=3]="Float",n[n.Binary=4]="Binary",n[n.Utf8=5]="Utf8",n[n.Bool=6]="Bool",n[n.Decimal=7]="Decimal",n[n.Date=8]="Date",n[n.Time=9]="Time",n[n.Timestamp=10]="Timestamp",n[n.Interval=11]="Interval",n[n.List=12]="List",n[n.Struct=13]="Struct",n[n.Union=14]="Union",n[n.FixedSizeBinary=15]="FixedSizeBinary",n[n.FixedSizeList=16]="FixedSizeList",n[n.Map=17]="Map",n[n.Dictionary=-1]="Dictionary",n[n.Int8=-2]="Int8",n[n.Int16=-3]="Int16",n[n.Int32=-4]="Int32",n[n.Int64=-5]="Int64",n[n.Uint8=-6]="Uint8",n[n.Uint16=-7]="Uint16",n[n.Uint32=-8]="Uint32",n[n.Uint64=-9]="Uint64",n[n.Float16=-10]="Float16",n[n.Float32=-11]="Float32",n[n.Float64=-12]="Float64",n[n.DateDay=-13]="DateDay",n[n.DateMillisecond=-14]="DateMillisecond",n[n.TimestampSecond=-15]="TimestampSecond",n[n.TimestampMillisecond=-16]="TimestampMillisecond",n[n.TimestampMicrosecond=-17]="TimestampMicrosecond",n[n.TimestampNanosecond=-18]="TimestampNanosecond",n[n.TimeSecond=-19]="TimeSecond",n[n.TimeMillisecond=-20]="TimeMillisecond",n[n.TimeMicrosecond=-21]="TimeMicrosecond",n[n.TimeNanosecond=-22]="TimeNanosecond",n[n.DenseUnion=-23]="DenseUnion",n[n.SparseUnion=-24]="SparseUnion",n[n.IntervalDayTime=-25]="IntervalDayTime",n[n.IntervalYearMonth=-26]="IntervalYearMonth"}(Rr||(Rr={}));class mO{static isNull(e){return e&&e.typeId===Rr.Null}static isInt(e){return e&&e.typeId===Rr.Int}static isFloat(e){return e&&e.typeId===Rr.Float}static isBinary(e){return e&&e.typeId===Rr.Binary}static isUtf8(e){return e&&e.typeId===Rr.Utf8}static isBool(e){return e&&e.typeId===Rr.Bool}static isDecimal(e){return e&&e.typeId===Rr.Decimal}static isDate(e){return e&&e.typeId===Rr.Date}static isTime(e){return e&&e.typeId===Rr.Time}static isTimestamp(e){return e&&e.typeId===Rr.Timestamp}static isInterval(e){return e&&e.typeId===Rr.Interval}static isList(e){return e&&e.typeId===Rr.List}static isStruct(e){return e&&e.typeId===Rr.Struct}static isUnion(e){return e&&e.typeId===Rr.Union}static isFixedSizeBinary(e){return e&&e.typeId===Rr.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Rr.FixedSizeList}static isMap(e){return e&&e.typeId===Rr.Map}static isDictionary(e){return e&&e.typeId===Rr.Dictionary}get typeId(){return Rr.NONE}compareTo(e){return this===e}}Symbol,Symbol,wz=Symbol.toStringTag;class Ug extends mO{constructor(e,t){super(),Wn(this,"isSigned",void 0),Wn(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=t}get typeId(){return Rr.Int}get[wz](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class Lhe extends Ug{constructor(){super(!0,8)}}class khe extends Ug{constructor(){super(!0,16)}}class Bhe extends Ug{constructor(){super(!0,32)}}class Vhe extends Ug{constructor(){super(!1,8)}}class jhe extends Ug{constructor(){super(!1,16)}}class Uhe extends Ug{constructor(){super(!1,32)}}Ez=Symbol.toStringTag;class Mz extends mO{constructor(e){super(),Wn(this,"precision",void 0),this.precision=e}get typeId(){return Rr.Float}get[Ez](){return"Float"}toString(){return`Float${this.precision}`}}class zhe extends Mz{constructor(){super(32)}}class Hhe extends Mz{constructor(){super(64)}}Symbol,Symbol,Sz=Symbol.toStringTag,Cz=Symbol.toStringTag,xz=Symbol.toStringTag,Tz=Symbol.toStringTag,Az=Symbol.toStringTag;class Ghe extends mO{constructor(e,t){super(),Wn(this,"listSize",void 0),Wn(this,"children",void 0),this.listSize=e,this.children=[t]}get typeId(){return Rr.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[Az](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class vS{constructor(e,t,i=!1,r=new Map){Wn(this,"name",void 0),Wn(this,"type",void 0),Wn(this,"nullable",void 0),Wn(this,"metadata",void 0),this.name=e,this.type=t,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new vS(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function Dz(n,e,t){const i=t?Iz(t.metadata):void 0,r=function(n){switch(n.constructor){case Int8Array:return new Lhe;case Uint8Array:return new Vhe;case Int16Array:return new khe;case Uint16Array:return new jhe;case Int32Array:return new Bhe;case Uint32Array:return new Uhe;case Float32Array:return new zhe;case Float64Array:return new Hhe;default:throw new Error("array type not supported")}}(e.value);return new vS(n,new Ghe(e.size,new vS("value",r)),!1,i)}function Iz(n){const e=new Map;for(const t in n)e.set(`${t}.string`,JSON.stringify(n[t]));return e}const Oz={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Yhe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class Xhe{constructor(e){Wn(this,"draco",void 0),Wn(this,"decoder",void 0),Wn(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const p=`DRACO decompression failed: ${o.error_msg()}`;throw new Error(p)}const a=this._getDracoLoaderData(s,r,t),l=this._getMeshData(s,a,t),c=function(n){let e=1/0,t=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=n.POSITION?n.POSITION.value:[],l=a&&a.length;for(let c=0;c<l;c+=3){const u=a[c],h=a[c+1],p=a[c+2];e=u<e?u:e,t=h<t?h:t,i=p<i?p:i,r=u>r?u:r,s=h>s?h:s,o=p>o?p:o}return[[e,t,i],[r,s,o]]}(l.attributes),u=function(n,e,t){const i=Iz(e.metadata),r=[],s=function(n){const e={};for(const t in n){const i=n[t];e[i.name||"undefined"]=i}return e}(e.attributes);for(const o in n){const l=Dz(o,n[o],s[o]);r.push(l)}if(t){const o=Dz("indices",t);r.push(o)}return new jg(r,i)}(l.attributes,a,l.indices);return zn(ht({loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:c}},l),{schema:u})}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,t){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,t);a&&(i[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,t);l&&(i[s.unique_id()].octahedron_transform=l)}return i}_getMeshData(e,t,i){const r=this._getMeshAttributes(t,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,t,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:l}=this._getAttributeValues(t,s);r[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=3*e.num_faces(),r=4*i,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const i=Yhe[t.data_type],r=t.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,l=function(n,e){switch(e){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32;default:return n.DT_INVALID}}(this.draco,i);let c;const u=this.draco._malloc(a);try{const h=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,h,l,a,u),c=new i(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:c,size:r}}_deduceAttributeName(e,t){const i=e.unique_id;for(const[o,a]of Object.entries(t.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in Oz)if(this.draco[o]===r)return Oz[o];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${i}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const i=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,i);const r=function(n){const e=n.size(),t=new Int32Array(e);for(let i=0;i<e;i++)t[i]=n.GetValue(i);return t}(i);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:i=[]}=e,r=[...t,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:i=[]}=t,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}var bS=tt(125);const bO={};function wO(n){return EO.apply(this,arguments)}function EO(){return(EO=ni(function*(n,e=null,t={}){return e&&(n=tfe(n,e,t)),bO[n]=bO[n]||nfe(n),yield bO[n]})).apply(this,arguments)}function tfe(n,e,t){if(n.startsWith("http"))return n;const i=t.modules||{};return i[n]?i[n]:wI?t.CDN?(qc(t.CDN.startsWith("http")),`${t.CDN}/${e}@3.0.12/dist/libs/${n}`):EI?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}function nfe(n){return SO.apply(this,arguments)}function SO(){return(SO=ni(function*(n){return n.endsWith("wasm")?yield(yield fetch(n)).arrayBuffer():wI?EI?importScripts(n):ife(yield(yield fetch(n)).text(),n):bS.requireFromFile&&(yield bS.requireFromFile(n))})).apply(this,arguments)}function ife(n,e){if(!wI)return bS.requireFromString&&bS.requireFromString(n,e);if(EI)return eval.call(Kae,n),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(n))}catch(i){t.text=n}return document.body.appendChild(t),null}const rfe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js",sfe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js",ofe="https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm";let Ev;function lfe(n){return CO.apply(this,arguments)}function CO(){return(CO=ni(function*(n){const e=n.modules||{};return Ev=e.draco3d?Ev||e.draco3d.createDecoderModule({}).then(t=>({draco:t})):Ev||cfe(n),yield Ev})).apply(this,arguments)}function cfe(n){return TO.apply(this,arguments)}function TO(){return(TO=ni(function*(n){let e,t;switch(n.draco&&n.draco.decoderType){case"js":e=yield wO(rfe,"draco",n);break;case"wasm":default:[e,t]=yield Promise.all([yield wO(sfe,"draco",n),yield wO(ofe,"draco",n)])}return e=e||globalThis.DracoDecoderModule,yield ufe(e,t)})).apply(this,arguments)}function ufe(n,e){const t={};return e&&(t.wasmBinary=e),new Promise(i=>{n(zn(ht({},t),{onModuleLoaded:r=>i({draco:r})}))})}const MO=zn(ht({},vz),{parse:function(n,e){return DO.apply(this,arguments)}});function DO(){return(DO=ni(function*(n,e){const{draco:t}=yield lfe(e),i=new Xhe(t);try{return i.parseSync(n,null==e?void 0:e.draco)}finally{i.destroy()}})).apply(this,arguments)}function Cv(n,e){return bf(n>=0),bf(e>0),n+(e-1)&~(e-1)}function ffe(n,e,t){let i;return i=n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer||n.arrayBuffer,n.byteOffset,n.byteLength),e.set(i,t),t+Cv(i.byteLength,4)}const Rz=["SCALAR","VEC2","VEC3","VEC4"],pfe=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],gfe=new Map(pfe),mfe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_fe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},yfe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Pz(n){return Rz[n-1]||Rz[0]}function Nz(n){const e=gfe.get(n.constructor);if(!e)throw new Error("Illegal typed array");return e}function Fz(n,e){const t=yfe[n.componentType],i=mfe[n.type],s=n.count*i,o=n.count*i*_fe[n.componentType];return Fa(o>=0&&o<=e.byteLength),{ArrayType:t,length:s,byteLength:o}}const vfe={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class sh{constructor(e){Wn(this,"gltf",void 0),Wn(this,"sourceBuffers",void 0),Wn(this,"byteLength",void 0),this.gltf=e||{json:ht({},vfe),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){return this.getUsedExtensions().find(r=>r===e)?(this.json.extensions||{})[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];if(!i)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const i=this.gltf.buffers[e.buffer];return Fa(i),new Uint8Array(i.arrayBuffer,(e.byteOffset||0)+i.byteOffset,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,{ArrayType:s,length:o}=Fz(e,t);return new s(r,t.byteOffset+e.byteOffset,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data;return new Uint8Array(r,t.byteOffset||0,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,i){return e.extensions=e.extensions||{},e.extensions[t]=i,this.registerUsedExtension(t),this}setObjectExtension(e,t,i){(e.extensions||{})[t]=i}removeObjectExtension(e,t){const i=e.extensions||{},r=i[t];return delete i[t],r}addExtension(e,t={}){return Fa(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Fa(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:t};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(i){const l=this._addIndices(i);a.primitives[0].indices=l}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,t){const i=sO(e),r=t||(null==i?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const t=e.byteLength;Fa(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Cv(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,t){const i={bufferView:e,type:Pz(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const i=this.addBufferView(e);let r={min:t.min,max:t.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:Nz(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,i={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=ffe(a,s,o);null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,t){let i=!0;for(;i;){const r=e.indexOf(t);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const t={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const i={min:null,max:null};if(e.length<t)return i;i.min=[],i.max=[];const r=e.subarray(0,t);for(const s of r)i.min.push(s),i.max.push(s);for(let s=t;s<e.length;s+=t)for(let o=0;o<t;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const Lz="KHR_binary_glTF",xv="KHR_draco_mesh_compression",zg="KHR_lights_punctual",ES="KHR_materials_unlit",SS="KHR_techniques_webgl";function Efe(n){const e={};for(const t in n){const i=n[t];if("indices"!==t){const r=kz(i);e[t]=r}}return e}function kz(n){const{buffer:e,size:t,count:i}=function(n){let e=n,t=1,i=0;return n&&n.value&&(e=n.value,t=n.size||1),e&&(ArrayBuffer.isView(e)||(e=function(n,e,t=!1){return n?Array.isArray(n)?new e(n):!t||n instanceof e?n:new e(n):null}(e,Float32Array)),i=e.length/t),{buffer:e,size:t,count:i}}(n);return{value:e,size:t,byteOffset:0,count:i,type:Pz(t),componentType:Nz(e)}}function xfe(n,e,t){return IO.apply(this,arguments)}function IO(){return(IO=ni(function*(n,e,t){var i;if(null==e||null===(i=e.gltf)||void 0===i||!i.decompressMeshes)return;const r=new sh(n),s=[];for(const o of Ife(r))r.getObjectExtension(o,xv)&&s.push(Afe(r,o,e,t));yield Promise.all(s),r.removeExtension(xv)})).apply(this,arguments)}function Tfe(n,e={}){const t=new sh(n);for(const i of t.json.meshes||[])Mfe(i),t.addRequiredExtension(xv)}function Afe(n,e,t,i){return OO.apply(this,arguments)}function OO(){return(OO=ni(function*(n,e,t,i){const r=n.getObjectExtension(e,xv);if(!r)return;const s=n.getTypedArrayForBufferView(r.bufferView),o=Kj(s.buffer,s.byteOffset),{parse:a}=i,l=ht({},t);delete l["3d-tiles"];const c=yield a(o,MO,l,i),u=Efe(c.attributes);for(const[h,p]of Object.entries(u))if(h in e.attributes){const m=n.getAccessor(e.attributes[h]);null!=m&&m.min&&null!=m&&m.max&&(p.min=m.min,p.max=m.max)}e.attributes=u,c.indices&&(e.indices=kz(c.indices)),Dfe(e)})).apply(this,arguments)}function Mfe(n,e,t=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:n}),a=null==r||null===(s=r.parseSync)||void 0===s?void 0:s.call(r,{attributes:n}),l=i._addFauxAttributes(a.attributes),c=i.addBufferView(o);return{primitives:[{attributes:l,mode:t,extensions:{[xv]:{bufferView:c,attributes:l}}}]}}function Dfe(n){if(!n.attributes&&Object.keys(n.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Ife(n){for(const e of n.json.meshes||[])for(const t of e.primitives)yield t}function Ofe(n){return RO.apply(this,arguments)}function RO(){return(RO=ni(function*(n){const e=new sh(n),{json:t}=e;e.removeExtension(ES);for(const i of t.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,ES)})).apply(this,arguments)}function Rfe(n){const e=new sh(n),{json:t}=e;if(e.materials)for(const i of t.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,ES,{}),e.addExtension(ES))}function Pfe(n){return PO.apply(this,arguments)}function PO(){return(PO=ni(function*(n){const e=new sh(n),{json:t}=e,i=e.getExtension(zg);i&&(e.json.lights=i.lights,e.removeExtension(zg));for(const r of t.nodes||[]){const s=e.getObjectExtension(r,zg);s&&(r.light=s.light),e.removeObjectExtension(r,zg)}})).apply(this,arguments)}function Nfe(n){return NO.apply(this,arguments)}function NO(){return(NO=ni(function*(n){const e=new sh(n),{json:t}=e;if(t.lights){const i=e.addExtension(zg);Fa(!i.lights),i.lights=t.lights,delete t.lights}if(e.json.lights){for(const i of e.json.lights)e.addObjectExtension(i.node,zg,i);delete e.json.lights}})).apply(this,arguments)}function Ffe(n){return FO.apply(this,arguments)}function FO(){return(FO=ni(function*(n){const e=new sh(n),{json:t}=e,i=e.getExtension(SS);if(i){const r=kfe(i,e);for(const s of t.materials||[]){const o=e.getObjectExtension(s,SS);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=Bfe(s.technique,e)),e.removeObjectExtension(s,SS)}e.removeExtension(SS)}})).apply(this,arguments)}function Lfe(n,e){return LO.apply(this,arguments)}function LO(){return(LO=ni(function*(n,e){})).apply(this,arguments)}function kfe(n,e){const{programs:t=[],shaders:i=[],techniques:r=[]}=n,s=new TextDecoder;return i.forEach(o=>{if(!Number.isFinite(o.bufferView))throw new Error("KHR_techniques_webgl: no shader code");o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView))}),t.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=t[o.program]}),r}function Bfe(n,e){const t=Object.assign({},n.values);return Object.keys(n.uniforms||{}).forEach(i=>{n.uniforms[i].value&&!(i in t)&&(t[i]=n.uniforms[i].value)}),Object.keys(t).forEach(i=>{"object"==typeof t[i]&&void 0!==t[i].index&&(t[i].texture=e.getTexture(t[i].index))}),t}const Bz={KHR_draco_mesh_compression:mt,KHR_materials_unlit:J,KHR_lights_punctual:xt,KHR_techniques_webgl:dt};function Vfe(n){return kO.apply(this,arguments)}function kO(){return(kO=ni(function*(n,e={},t){for(const r in Bz){var i;const s=(null==e||null===(i=e.gltf)||void 0===i?void 0:i.excludeExtensions)||{};r in s&&!s[r]||(yield Bz[r].decode(n,e,t))}})).apply(this,arguments)}const Vz={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Ufe={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class zfe{constructor(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(e,t){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${i.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),function(n){const e=new sh(n),{json:t}=e;for(const i of t.images||[]){const r=e.removeObjectExtension(i,Lz);r&&Object.assign(i,r)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(Lz)}(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in Vz)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const i=e[t];if(i&&!Array.isArray(i)){e[t]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in Vz)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:i,indices:r,material:s}=t;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const i of e[t])for(const r in i){const o=this._convertIdToIndex(i[r],r);i[r]=o}}_convertIdToIndex(e,t){const i=Ufe[t];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return r}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const i=t.values&&t.values.tex,r=e.textures.findIndex(s=>s.id===i);-1!==r&&(t.pbrMetallicRoughness.baseColorTexture={index:r})}}}function Hfe(n,e={}){return(new zfe).normalize(n,e)}const Gfe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$fe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},vl={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Wfe={magFilter:vl.TEXTURE_MAG_FILTER,minFilter:vl.TEXTURE_MIN_FILTER,wrapS:vl.TEXTURE_WRAP_S,wrapT:vl.TEXTURE_WRAP_T},qfe={[vl.TEXTURE_MAG_FILTER]:vl.LINEAR,[vl.TEXTURE_MIN_FILTER]:vl.NEAREST_MIPMAP_LINEAR,[vl.TEXTURE_WRAP_S]:vl.REPEAT,[vl.TEXTURE_WRAP_]:vl.REPEAT};class Xfe{postProcess(e,t={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return Fa(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,t),this.json}_resolveTree(e,t={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,t){if("object"==typeof t)return t;const i=this.json[e]&&this.json[e][t];return i||console.warn(`glTF file error: Could not find ${e}[${t}]`),i}_resolveScene(e,t){return e.id=e.id||`scene-${t}`,e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,t){return e.id=e.id||`node-${t}`,e.children&&(e.children=e.children.map(i=>this.getNode(i))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,t){return e.id=e.id||`skin-${t}`,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,t){return e.id=e.id||`mesh-${t}`,e.primitives&&(e.primitives=e.primitives.map(i=>{const r=(i=ht({},i)).attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return void 0!==i.indices&&(i.indices=this.getAccessor(i.indices)),void 0!==i.material&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,t){if(e.id=e.id||`material-${t}`,e.normalTexture&&(e.normalTexture=ht({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ht({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ht({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ht({},e.pbrMetallicRoughness);const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture=ht({},i.baseColorTexture),i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture=ht({},i.metallicRoughnessTexture),i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,t){if(e.id=e.id||`accessor-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=function(n){return $fe[n]}(e.componentType),e.components=function(n){return Gfe[n]}(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=Fz(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,a=i.arrayBuffer.slice(o,o+s);e.value=new r(a)}return e}_resolveTexture(e,t){return e.id=e.id||`texture-${t}`,e.sampler="sampler"in e?this.getSampler(e.sampler):qfe,e.source=this.getImage(e.source),e}_resolveSampler(e,t){e.id=e.id||`sampler-${t}`,e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);void 0!==r&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return Wfe[e]}_resolveImage(e,t){e.id=e.id||`image-${t}`,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[t];return i&&(e.image=i),e}_resolveBufferView(e,t){e.id=e.id||`bufferView-${t}`;const i=e.buffer;e.buffer=this.buffers[i];let s=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(s+=e.byteOffset),e.data=new Uint8Array(this.buffers[i].arrayBuffer,s,e.byteLength),e}_resolveCamera(e,t){return e.id=e.id||`camera-${t}`,e}}function Qfe(n,e){return(new Xfe).postProcess(n,e)}const jz=1735152710,Hg=!0;function VO(n,e,t,i){const r=new Uint8Array(e.buffer,t,i),o=new TextDecoder("utf8").decode(r);return n.json=JSON.parse(o),Cv(i,4)}function jO(n,e,t,i){return n.header.hasBinChunk=!0,n.binChunks.push({byteOffset:t,byteLength:i,arrayBuffer:e.buffer}),Cv(i,4)}function cpe(n,e){return UO.apply(this,arguments)}function UO(){return(UO=ni(function*(n,e,t=0,i,r){var s,o,a,l;upe(n,e,t,i),Hfe(n,{normalize:null==i||null===(s=i.gltf)||void 0===s?void 0:s.normalize});const c=[];if(null!=i&&null!==(o=i.gltf)&&void 0!==o&&o.loadBuffers&&n.json.buffers&&(yield dpe(n,i,r)),null!=i&&null!==(a=i.gltf)&&void 0!==a&&a.loadImages){const h=hpe(n,i,r);c.push(h)}const u=Vfe(n,i,r);return c.push(u),yield Promise.all(c),null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?Qfe(n,i):n})).apply(this,arguments)}function upe(n,e,t,i){if(i.uri&&(n.baseUri=i.uri),e instanceof ArrayBuffer&&!function(n,e=0,t={}){const i=new DataView(n),{magic:r=jz}=t,s=i.getUint32(e,!1);return s===r||s===jz}(e,t,i)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)n.json=function(n){try{return JSON.parse(n)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?mz(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?mz(n,0,e):""}(n)}"`)}}(e);else if(e instanceof ArrayBuffer){const o={};t=function(n,e,t=0,i={}){const r=new DataView(e),s=function(n,e=0){return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(r,t+0),o=r.getUint32(t+4,Hg),a=r.getUint32(t+8,Hg);switch(Object.assign(n,{header:{byteOffset:t,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),t+=12,n.version){case 1:return function(n,e,t){bf(n.header.byteLength>20);const i=e.getUint32(t+0,Hg),r=e.getUint32(t+4,Hg);return t+=8,bf(0===r),VO(n,e,t,i),(t+=i)+jO(n,e,t,n.header.byteLength)}(n,r,t);case 2:return function(n,e,t,i){return bf(n.header.byteLength>20),function(n,e,t,i){for(;t+8<=n.header.byteLength;){const r=e.getUint32(t+0,Hg),s=e.getUint32(t+4,Hg);switch(t+=8,s){case 1313821514:VO(n,e,t,r);break;case 5130562:jO(n,e,t,r);break;case 0:i.strict||VO(n,e,t,r);break;case 1:i.strict||jO(n,e,t,r)}t+=Cv(r,4)}}(n,e,t,{}),t+n.header.byteLength}(n,r,t);default:throw new Error(`Invalid GLB version ${n.version}. Only supports v1 and v2.`)}}(o,e,t,i.glb),Fa("glTF"===o.type,`Invalid GLB magic string ${o.type}`),n._glb=o,n.json=o.json}else Fa(!1,"GLTF: must be ArrayBuffer or string");if(n.buffers=new Array((n.json.buffers||[]).length).fill(null),n._glb&&n._glb.header.hasBinChunk){const{binChunks:o}=n._glb;n.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}n.images=new Array((n.json.images||[]).length).fill({})}function dpe(n,e,t){return zO.apply(this,arguments)}function zO(){return(zO=ni(function*(n,e,t){for(let s=0;s<n.json.buffers.length;++s){const o=n.json.buffers[s];if(o.uri){var i,r;const{fetch:a}=t;Fa(a);const l=_z(o.uri,e),c=yield null==t||null===(i=t.fetch)||void 0===i?void 0:i.call(t,l),u=yield null==c||null===(r=c.arrayBuffer)||void 0===r?void 0:r.call(c);n.buffers[s]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete o.uri}}})).apply(this,arguments)}function hpe(n,e,t){return HO.apply(this,arguments)}function HO(){return(HO=ni(function*(n,e,t){const i=n.json.images||[],r=[];for(let s=0;s<i.length;++s)r.push(fpe(n,i[s],s,e,t));return yield Promise.all(r)})).apply(this,arguments)}function fpe(n,e,t,i,r){return GO.apply(this,arguments)}function GO(){return(GO=ni(function*(n,e,t,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const c=_z(e.uri,i);a=yield(yield s(c)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const c=yz(n.json,n.buffers,e.bufferView);a=Kj(c.buffer,c.byteOffset,c.byteLength)}Fa(a,"glTF image has no data");const l=yield o(a,DU,{},r);n.images[t]=l})).apply(this,arguments)}const Gg={name:"glTF",id:"gltf",module:"gltf",version:"3.0.12",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(n){return $O.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function $O(){return($O=ni(function*(n,e={},t){(e=ht(ht({},Gg.options),e)).gltf=ht(ht({},Gg.options.gltf),e.gltf);const{byteOffset:i=0}=e;return yield cpe({},n,i,e,t)})).apply(this,arguments)}function WO(){return(WO=ni(function*(n){const e=[];return n.scenes.forEach(t=>{t.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{!1===r.loaded&&e.push(r)})})}),yield mpe(()=>e.some(t=>!t.loaded))})).apply(this,arguments)}function mpe(n){return qO.apply(this,arguments)}function qO(){return(qO=ni(function*(n){for(;n();)yield new Promise(e=>requestAnimationFrame(e))})).apply(this,arguments)}const Uz=[255,255,255,255],vpe={scenegraph:{type:"object",value:null,async:!0},getScene:n=>n&&n.scenes?"object"==typeof n.scene?n.scene:n.scenes[n.scene||0]:n,getAnimator:n=>n&&n.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:Uz},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Gg]};let bpe=(()=>{class n extends GI{getShaders(){const t=[qU,ZU];return"pbr"===this.props._lighting&&t.push(oz),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Uz,transition:!0},instanceModelMatrix:iz})}updateState(t){super.updateState(t);const{props:i,oldProps:r}=t;i.scenegraph!==r.scenegraph?this._updateScenegraph(i):i._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,i._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:i}=this.context;let r=null;if(t.scenegraph instanceof Vg)r={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const l=t.scenegraph,c=function(n,e,t){const i=new The(n,t);return{scenes:i.instantiate(e),animator:i.createAnimator()}}(i,l,this._getModelOptions());r=ht({gltf:l},c),function(n){return WO.apply(this,arguments)}(c).then(()=>this.setNeedsRedraw())}else t.scenegraph&&(ki.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=t.scenegraph);const s={layer:this,gl:i},o=t.getScene(r,s),a=t.getAnimator(r,s);o instanceof Vg?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,t._animations),this.setState({scenegraph:o,animator:a})):null!==o&&ki.warn("invalid scenegraph:",o)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const i=this.getAttributeManager().getAttributes();t.traverse(r=>{this._setModelAttributes(r.model,i)})}}_applyAnimationsProp(t,i,r){if(!t||!i||!r)return;const s=i.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if("*"===o)s.forEach(l=>{Object.assign(l,a)});else if(Number.isFinite(Number(o))){const l=Number(o);l>=0&&l<s.length?Object.assign(s[l],a):ki.warn("animation ".concat(o," not found"))()}else{const l=s.find(({name:c})=>c===o);l?Object.assign(l,a):ki.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof Vg&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let i=null;return t&&(i="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:ht({isInstanced:!0,transpileToGLSL100:!_i(this.context.gl)},this.getShaders()),useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(i=>{this._setModelAttributes(i.model,t)})}draw({moduleParameters:t=null,parameters:i={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:s}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:l,opacity:c,coordinateSystem:u}=this.props,h=this.getNumInstances();this.state.scenegraph.traverse((p,{worldMatrix:g})=>{p.model.setInstanceCount(h),p.updateModuleSettings(t),p.draw({parameters:i,uniforms:{sizeScale:o,opacity:c,sizeMinPixels:a,sizeMaxPixels:l,composeModelMatrix:rz(s,u),sceneModelMatrix:g,u_Camera:p.model.getUniforms().project_uCameraPosition}})})}}return n.layerName="ScenegraphLayer",n.defaultProps=vpe,n})();const wpe=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Epe=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),Spe=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),Cpe=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),xpe={POSITION:{size:3,value:new Float32Array(Epe)},NORMAL:{size:3,value:new Float32Array(Spe)},TEXCOORD_0:{size:2,value:new Float32Array(Cpe)}};class Tpe extends mS{constructor(e={}){const{id:t=Gc("cube-geometry")}=e;super(zn(ht({},e),{id:t,indices:{size:1,value:new Uint16Array(wpe)},attributes:ht(ht({},xpe),e.attributes)}))}}class Jc{constructor(e=[0,0,0,0,0,0,0,0,0]){this.elements=void 0,this.elements=e}identity(){const e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}setZero(){const e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}setTrace(e){const t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}getTrace(e=new le){const t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}vmult(e,t=new le){const i=this.elements,r=e.x,s=e.y,o=e.z;return t.x=i[0]*r+i[1]*s+i[2]*o,t.y=i[3]*r+i[4]*s+i[5]*o,t.z=i[6]*r+i[7]*s+i[8]*o,t}smult(e){for(let t=0;t<this.elements.length;t++)this.elements[t]*=e}mmult(e,t=new Jc){const i=this.elements,r=e.elements,s=t.elements,o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],h=i[5],p=i[6],g=i[7],m=i[8],E=r[0],C=r[1],R=r[2],z=r[3],de=r[4],Ie=r[5],Be=r[6],Ne=r[7],ct=r[8];return s[0]=o*E+a*z+l*Be,s[1]=o*C+a*de+l*Ne,s[2]=o*R+a*Ie+l*ct,s[3]=c*E+u*z+h*Be,s[4]=c*C+u*de+h*Ne,s[5]=c*R+u*Ie+h*ct,s[6]=p*E+g*z+m*Be,s[7]=p*C+g*de+m*Ne,s[8]=p*R+g*Ie+m*ct,t}scale(e,t=new Jc){const i=this.elements,r=t.elements;for(let s=0;3!==s;s++)r[3*s+0]=e.x*i[3*s+0],r[3*s+1]=e.y*i[3*s+1],r[3*s+2]=e.z*i[3*s+2];return t}solve(e,t=new le){const s=[];let o,a;for(o=0;o<12;o++)s.push(0);for(o=0;o<3;o++)for(a=0;a<3;a++)s[o+4*a]=this.elements[o+3*a];s[3]=e.x,s[7]=e.y,s[11]=e.z;let l=3;const c=l;let u,p;do{if(o=c-l,0===s[o+4*o])for(a=o+1;a<c;a++)if(0!==s[o+4*a]){u=4;do{p=4-u,s[p+4*o]+=s[p+4*a]}while(--u);break}if(0!==s[o+4*o])for(a=o+1;a<c;a++){const g=s[o+4*a]/s[o+4*o];u=4;do{p=4-u,s[p+4*a]=p<=o?0:s[p+4*a]-s[p+4*o]*g}while(--u)}}while(--l);if(t.z=s[11]/s[10],t.y=(s[7]-s[6]*t.z)/s[5],t.x=(s[3]-s[2]*t.z-s[1]*t.y)/s[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t}e(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i}copy(e){for(let t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}toString(){let e="";for(let i=0;i<9;i++)e+=this.elements[i]+",";return e}reverse(e=new Jc){const r=Ape;let s,o;for(s=0;s<3;s++)for(o=0;o<3;o++)r[s+6*o]=this.elements[s+3*o];r[3]=1,r[9]=0,r[15]=0,r[4]=0,r[10]=1,r[16]=0,r[5]=0,r[11]=0,r[17]=1;let a=3;const l=a;let c,h;do{if(s=l-a,0===r[s+6*s])for(o=s+1;o<l;o++)if(0!==r[s+6*o]){c=6;do{h=6-c,r[h+6*s]+=r[h+6*o]}while(--c);break}if(0!==r[s+6*s])for(o=s+1;o<l;o++){const p=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=h<=s?0:r[h+6*o]-r[h+6*s]*p}while(--c)}}while(--a);s=2;do{o=s-1;do{const p=r[s+6*o]/r[s+6*s];c=6;do{h=6-c,r[h+6*o]=r[h+6*o]-r[h+6*s]*p}while(--c)}while(o--)}while(--s);s=2;do{const p=1/r[s+6*s];c=6;do{h=6-c,r[h+6*s]=r[h+6*s]*p}while(--c)}while(s--);s=2;do{o=2;do{if(h=r[3+o+6*s],isNaN(h)||h===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(s,o,h)}while(o--)}while(s--);return e}setRotationFromQuaternion(e){const t=e.x,i=e.y,r=e.z,s=e.w,o=t+t,a=i+i,l=r+r,c=t*o,u=t*a,h=t*l,p=i*a,g=i*l,m=r*l,E=s*o,C=s*a,R=s*l,z=this.elements;return z[0]=1-(p+m),z[1]=u-R,z[2]=h+C,z[3]=u+R,z[4]=1-(c+m),z[5]=g-E,z[6]=h-C,z[7]=g+E,z[8]=1-(c+p),this}transpose(e=new Jc){const t=this.elements,i=e.elements;let r;return i[0]=t[0],i[4]=t[4],i[8]=t[8],r=t[1],i[1]=t[3],i[3]=r,r=t[2],i[2]=t[6],i[6]=r,r=t[5],i[5]=t[7],i[7]=r,e}}const Ape=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];class le{constructor(e=0,t=0,i=0){this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=t,this.z=i}cross(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z;return t.x=a*s-l*r,t.y=l*i-o*s,t.z=o*r-a*i,t}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}setZero(){this.x=this.y=this.z=0}vadd(e,t){if(!t)return new le(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z}vsub(e,t){if(!t)return new le(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z}crossmat(){return new Jc([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const e=this.x,t=this.y,i=this.z,r=Math.sqrt(e*e+t*t+i*i);if(r>0){const s=1/r;this.x*=s,this.y*=s,this.z*=s}else this.x=0,this.y=0,this.z=0;return r}unit(e=new le){const t=this.x,i=this.y,r=this.z;let s=Math.sqrt(t*t+i*i+r*r);return s>0?(s=1/s,e.x=t*s,e.y=i*s,e.z=r*s):(e.x=1,e.y=0,e.z=0),e}length(){const e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)}lengthSquared(){return this.dot(this)}distanceTo(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return Math.sqrt((s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r))}distanceSquared(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z;return(s-t)*(s-t)+(o-i)*(o-i)+(a-r)*(a-r)}scale(e,t=new le){const r=this.y,s=this.z;return t.x=e*this.x,t.y=e*r,t.z=e*s,t}vmul(e,t=new le){return t.x=e.x*this.x,t.y=e.y*this.y,t.z=e.z*this.z,t}addScaledVector(e,t,i=new le){return i.x=this.x+e*t.x,i.y=this.y+e*t.y,i.z=this.z+e*t.z,i}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(e=new le){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}tangents(e,t){const i=this.length();if(i>0){const r=Mpe,s=1/i;r.set(this.x*s,this.y*s,this.z*s);const o=Dpe;Math.abs(r.x)<.9?(o.set(1,0,0),r.cross(o,e)):(o.set(0,1,0),r.cross(o,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}lerp(e,t,i){const r=this.x,s=this.y,o=this.z;i.x=r+(e.x-r)*t,i.y=s+(e.y-s)*t,i.z=o+(e.z-o)*t}almostEquals(e,t=1e-6){return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}almostZero(e=1e-6){return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}isAntiparallelTo(e,t){return this.negate(zz),zz.almostEquals(e,t)}clone(){return new le(this.x,this.y,this.z)}}le.ZERO=void 0,le.UNIT_X=void 0,le.UNIT_Y=void 0,le.UNIT_Z=void 0,le.ZERO=new le(0,0,0),le.UNIT_X=new le(1,0,0),le.UNIT_Y=new le(0,1,0),le.UNIT_Z=new le(0,0,1);const Mpe=new le,Dpe=new le,zz=new le;class cr{constructor(e={}){this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new le,this.upperBound=new le,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}setFromPoints(e,t,i,r){const s=this.lowerBound,o=this.upperBound,a=i;s.copy(e[0]),a&&a.vmult(s,s),o.copy(s);for(let l=1;l<e.length;l++){let c=e[l];a&&(a.vmult(c,Hz),c=Hz),c.x>o.x&&(o.x=c.x),c.x<s.x&&(s.x=c.x),c.y>o.y&&(o.y=c.y),c.y<s.y&&(s.y=c.y),c.z>o.z&&(o.z=c.z),c.z<s.z&&(s.z=c.z)}return t&&(t.vadd(s,s),t.vadd(o,o)),r&&(s.x-=r,s.y-=r,s.z-=r,o.x+=r,o.y+=r,o.z+=r),this}copy(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}clone(){return(new cr).copy(this)}extend(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}overlaps(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return(r.x<=i.x&&i.x<=s.x||t.x<=s.x&&s.x<=i.x)&&(r.y<=i.y&&i.y<=s.y||t.y<=s.y&&s.y<=i.y)&&(r.z<=i.z&&i.z<=s.z||t.z<=s.z&&s.z<=i.z)}volume(){const e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}contains(e){const t=this.lowerBound,i=this.upperBound,r=e.lowerBound,s=e.upperBound;return t.x<=r.x&&i.x>=s.x&&t.y<=r.y&&i.y>=s.y&&t.z<=r.z&&i.z>=s.z}getCorners(e,t,i,r,s,o,a,l){const c=this.lowerBound,u=this.upperBound;e.copy(c),t.set(u.x,c.y,c.z),i.set(u.x,u.y,c.z),r.set(c.x,u.y,u.z),s.set(u.x,c.y,u.z),o.set(c.x,u.y,c.z),a.set(c.x,c.y,u.z),l.copy(u)}toLocalFrame(e,t){const i=Gz;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToLocal(g,g)}return t.setFromPoints(i)}toWorldFrame(e,t){const i=Gz;this.getCorners(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);for(let p=0;8!==p;p++){const g=i[p];e.pointToWorld(g,g)}return t.setFromPoints(i)}overlapsRay(e){const{direction:t,from:i}=e,r=1/t.x,s=1/t.y,o=1/t.z,a=(this.lowerBound.x-i.x)*r,l=(this.upperBound.x-i.x)*r,c=(this.lowerBound.y-i.y)*s,u=(this.upperBound.y-i.y)*s,h=(this.lowerBound.z-i.z)*o,p=(this.upperBound.z-i.z)*o,g=Math.max(Math.max(Math.min(a,l),Math.min(c,u)),Math.min(h,p)),m=Math.min(Math.min(Math.max(a,l),Math.max(c,u)),Math.max(h,p));return!(m<0||g>m)}}const Hz=new le,Gz=[new le,new le,new le,new le,new le,new le,new le,new le];class as{constructor(e=0,t=0,i=0,r=1){this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=t,this.z=i,this.w=r}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(e,t){const i=Math.sin(.5*t);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t),this}toAxisAngle(e=new le){this.normalize();const t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]}setFromVectors(e,t){if(e.isAntiparallelTo(t)){const i=Ope;e.tangents(i,Rpe),this.setFromAxisAngle(i,Math.PI)}else{const i=e.cross(t);this.x=i.x,this.y=i.y,this.z=i.z,this.w=Math.sqrt(mr(e.length(),2)*mr(t.length(),2))+e.dot(t),this.normalize()}return this}mult(e,t=new as){const i=this.x,r=this.y,s=this.z,o=this.w,a=e.x,l=e.y,c=e.z,u=e.w;return t.x=i*u+o*a+r*c-s*l,t.y=r*u+o*l+s*a-i*c,t.z=s*u+o*c+i*l-r*a,t.w=o*u-i*a-r*l-s*c,t}inverse(e=new as){const t=this.x,i=this.y,r=this.z,s=this.w;this.conjugate(e);const o=1/(t*t+i*i+r*r+s*s);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}conjugate(e=new as){return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}normalize(){let e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}normalizeFast(){const e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}vmult(e,t=new le){const i=e.x,r=e.y,s=e.z,o=this.x,a=this.y,l=this.z,c=this.w,u=c*i+a*s-l*r,h=c*r+l*i-o*s,p=c*s+o*r-a*i,g=-o*i-a*r-l*s;return t.x=u*c+g*-o+h*-l-p*-a,t.y=h*c+g*-a+p*-o-u*-l,t.z=p*c+g*-l+u*-a-h*-o,t}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}toEuler(e,t="YZX"){let i,r,s;const o=this.x,a=this.y,l=this.z,c=this.w;switch(t){case"YZX":const u=o*a+l*c;if(u>.499&&(i=2*Math.atan2(o,c),r=Math.PI/2,s=0),u<-.499&&(i=-2*Math.atan2(o,c),r=-Math.PI/2,s=0),void 0===i){const h=o*o,g=l*l;i=Math.atan2(2*a*c-2*o*l,1-a*a*2-2*g),r=Math.asin(2*u),s=Math.atan2(2*o*c-2*a*l,1-2*h-2*g)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=r,e.x=s}setFromEuler(e,t,i,r="XYZ"){const s=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),l=Math.sin(e/2),c=Math.sin(t/2),u=Math.sin(i/2);return"XYZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"YXZ"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"ZXY"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a-l*c*u):"ZYX"===r?(this.x=l*o*a-s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a+l*c*u):"YZX"===r?(this.x=l*o*a+s*c*u,this.y=s*c*a+l*o*u,this.z=s*o*u-l*c*a,this.w=s*o*a-l*c*u):"XZY"===r&&(this.x=l*o*a-s*c*u,this.y=s*c*a-l*o*u,this.z=s*o*u+l*c*a,this.w=s*o*a+l*c*u),this}clone(){return new as(this.x,this.y,this.z,this.w)}slerp(e,t,i=new as){const r=this.x,s=this.y,o=this.z,a=this.w;let p,g,m,E,C,l=e.x,c=e.y,u=e.z,h=e.w;return g=r*l+s*c+o*u+a*h,g<0&&(g=-g,l=-l,c=-c,u=-u,h=-h),1-g>1e-6?(p=Math.acos(g),m=Math.sin(p),E=Math.sin((1-t)*p)/m,C=Math.sin(t*p)/m):(E=1-t,C=t),i.x=E*r+C*l,i.y=E*s+C*c,i.z=E*o+C*u,i.w=E*a+C*h,i}integrate(e,t,i,r=new as){const s=e.x*i.x,o=e.y*i.y,a=e.z*i.z,l=this.x,c=this.y,u=this.z,h=this.w,p=.5*t;return r.x+=p*(s*h+o*u-a*c),r.y+=p*(o*h+a*l-s*u),r.z+=p*(a*h+s*c-o*l),r.w+=p*(-s*l-o*c-a*u),r}}const Ope=new le,Rpe=new le,Ppe={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};let pn=(()=>{class n{constructor(t={}){this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=n.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(t,i){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(t,i,r,s){throw"calculateWorldAABB() not implemented for shape type "+this.type}}return n.idCounter=0,n.types=Ppe,n})();class Bi{constructor(e={}){this.position=void 0,this.quaternion=void 0,this.position=new le,this.quaternion=new as,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}pointToLocal(e,t){return Bi.pointToLocalFrame(this.position,this.quaternion,e,t)}pointToWorld(e,t){return Bi.pointToWorldFrame(this.position,this.quaternion,e,t)}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}static pointToLocalFrame(e,t,i,r=new le){return i.vsub(e,r),t.conjugate(Wz),Wz.vmult(r,r),r}static pointToWorldFrame(e,t,i,r=new le){return t.vmult(i,r),r.vadd(e,r),r}static vectorToWorldFrame(e,t,i=new le){return e.vmult(t,i),i}static vectorToLocalFrame(e,t,i,r=new le){return t.w*=-1,t.vmult(i,r),t.w*=-1,r}}const Wz=new as;class Sf extends pn{constructor(e={}){const{vertices:t=[],faces:i=[],normals:r=[],axes:s,boundingSphereRadius:o}=e;super({type:pn.types.CONVEXPOLYHEDRON}),this.vertices=void 0,this.faces=void 0,this.faceNormals=void 0,this.worldVertices=void 0,this.worldVerticesNeedsUpdate=void 0,this.worldFaceNormals=void 0,this.worldFaceNormalsNeedsUpdate=void 0,this.uniqueAxes=void 0,this.uniqueEdges=void 0,this.vertices=t,this.faces=i,this.faceNormals=r,0===this.faceNormals.length&&this.computeNormals(),o?this.boundingSphereRadius=o:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=s?s.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const e=this.faces,t=this.vertices,i=this.uniqueEdges;i.length=0;const r=new le;for(let s=0;s!==e.length;s++){const o=e[s],a=o.length;for(let l=0;l!==a;l++){t[o[l]].vsub(t[o[(l+1)%a]],r),r.normalize();let u=!1;for(let h=0;h!==i.length;h++)if(i[h].almostEquals(r)||i[h].almostEquals(r)){u=!0;break}u||i.push(r.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let e=0;e<this.faces.length;e++){for(let r=0;r<this.faces[e].length;r++)if(!this.vertices[this.faces[e][r]])throw new Error("Vertex "+this.faces[e][r]+" not found!");const t=this.faceNormals[e]||new le;if(this.getFaceNormal(e,t),t.negate(t),this.faceNormals[e]=t,t.dot(this.vertices[this.faces[e][0]])<0){console.error(".faceNormals["+e+"] = Vec3("+t.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let r=0;r<this.faces[e].length;r++)console.warn(".vertices["+this.faces[e][r]+"] = Vec3("+this.vertices[this.faces[e][r]].toString()+")")}}}getFaceNormal(e,t){const i=this.faces[e];Sf.computeNormal(this.vertices[i[0]],this.vertices[i[1]],this.vertices[i[2]],t)}static computeNormal(e,t,i,r){const s=new le,o=new le;t.vsub(e,o),i.vsub(t,s),s.cross(o,r),r.isZero()||r.normalize()}clipAgainstHull(e,t,i,r,s,o,a,l,c){const u=new le;let h=-1,p=-Number.MAX_VALUE;for(let m=0;m<i.faces.length;m++){u.copy(i.faceNormals[m]),s.vmult(u,u);const E=u.dot(o);E>p&&(p=E,h=m)}const g=[];for(let m=0;m<i.faces[h].length;m++){const E=i.vertices[i.faces[h][m]],C=new le;C.copy(E),s.vmult(C,C),r.vadd(C,C),g.push(C)}h>=0&&this.clipFaceAgainstHull(o,e,t,g,a,l,c)}findSeparatingAxis(e,t,i,r,s,o,a,l){const c=new le,u=new le,h=new le,p=new le,g=new le,m=new le;let E=Number.MAX_VALUE;const C=this;if(C.uniqueAxes)for(let R=0;R!==C.uniqueAxes.length;R++){i.vmult(C.uniqueAxes[R],c);const z=C.testSepAxis(c,e,t,i,r,s);if(!1===z)return!1;z<E&&(E=z,o.copy(c))}else{const R=a?a.length:C.faces.length;for(let z=0;z<R;z++){c.copy(C.faceNormals[a?a[z]:z]),i.vmult(c,c);const Ie=C.testSepAxis(c,e,t,i,r,s);if(!1===Ie)return!1;Ie<E&&(E=Ie,o.copy(c))}}if(e.uniqueAxes)for(let R=0;R!==e.uniqueAxes.length;R++){s.vmult(e.uniqueAxes[R],u);const z=C.testSepAxis(u,e,t,i,r,s);if(!1===z)return!1;z<E&&(E=z,o.copy(u))}else{const R=l?l.length:e.faces.length;for(let z=0;z<R;z++){u.copy(e.faceNormals[l?l[z]:z]),s.vmult(u,u);const Ie=C.testSepAxis(u,e,t,i,r,s);if(!1===Ie)return!1;Ie<E&&(E=Ie,o.copy(u))}}for(let R=0;R!==C.uniqueEdges.length;R++){i.vmult(C.uniqueEdges[R],p);for(let z=0;z!==e.uniqueEdges.length;z++)if(s.vmult(e.uniqueEdges[z],g),p.cross(g,m),!m.almostZero()){m.normalize();const de=C.testSepAxis(m,e,t,i,r,s);if(!1===de)return!1;de<E&&(E=de,o.copy(m))}}return r.vsub(t,h),h.dot(o)>0&&o.negate(o),!0}testSepAxis(e,t,i,r,s,o){Sf.project(this,e,i,r,YO),Sf.project(t,e,s,o,KO);const l=YO[0],c=YO[1],u=KO[0],h=KO[1];if(l<h||u<c)return!1;const p=l-h,g=u-c;return p<g?p:g}calculateLocalInertia(e,t){const i=new le,r=new le;this.computeLocalAABB(r,i);const s=i.x-r.x,o=i.y-r.y,a=i.z-r.z;t.x=1/12*e*(2*o*2*o+2*a*2*a),t.y=1/12*e*(2*s*2*s+2*a*2*a),t.z=1/12*e*(2*o*2*o+2*s*2*s)}getPlaneConstantOfFace(e){return-this.faceNormals[e].dot(this.vertices[this.faces[e][0]])}clipFaceAgainstHull(e,t,i,r,s,o,a){const l=new le,c=new le,u=new le,h=new le,p=new le,g=new le,m=new le,E=new le,C=this,z=r,de=[];let Ie=-1,Be=Number.MAX_VALUE;for(let Lt=0;Lt<C.faces.length;Lt++){l.copy(C.faceNormals[Lt]),i.vmult(l,l);const Zt=l.dot(e);Zt<Be&&(Be=Zt,Ie=Lt)}if(Ie<0)return;const Ne=C.faces[Ie];Ne.connectedFaces=[];for(let Lt=0;Lt<C.faces.length;Lt++)for(let Zt=0;Zt<C.faces[Lt].length;Zt++)-1!==Ne.indexOf(C.faces[Lt][Zt])&&Lt!==Ie&&-1===Ne.connectedFaces.indexOf(Lt)&&Ne.connectedFaces.push(Lt);const ct=Ne.length;for(let Lt=0;Lt<ct;Lt++){const Zt=C.vertices[Ne[Lt]];Zt.vsub(C.vertices[Ne[(Lt+1)%ct]],c),u.copy(c),i.vmult(u,u),t.vadd(u,u),h.copy(this.faceNormals[Ie]),i.vmult(h,h),t.vadd(h,h),u.cross(h,p),p.negate(p),g.copy(Zt),i.vmult(g,g),t.vadd(g,g);const Et=Ne.connectedFaces[Lt];m.copy(this.faceNormals[Et]);const Ct=this.getPlaneConstantOfFace(Et);E.copy(m),i.vmult(E,E);const Ht=Ct-E.dot(t);for(this.clipFaceAgainstPlane(z,de,E,Ht);z.length;)z.shift();for(;de.length;)z.push(de.shift())}m.copy(this.faceNormals[Ie]);const Dt=this.getPlaneConstantOfFace(Ie);E.copy(m),i.vmult(E,E);const Ot=Dt-E.dot(t);for(let Lt=0;Lt<z.length;Lt++){let Zt=E.dot(z[Lt])+Ot;if(Zt<=s&&(console.log("clamped: depth="+Zt+" to minDist="+s),Zt=s),Zt<=o){const en=z[Lt];Zt<=1e-6&&a.push({point:en,normal:E,depth:Zt})}}}clipFaceAgainstPlane(e,t,i,r){let s,o;const a=e.length;if(a<2)return t;let l=e[e.length-1],c=e[0];s=i.dot(l)+r;for(let u=0;u<a;u++){if(c=e[u],o=i.dot(c)+r,s<0)if(o<0){const h=new le;h.copy(c),t.push(h)}else{const h=new le;l.lerp(c,s/(s-o),h),t.push(h)}else if(o<0){const h=new le;l.lerp(c,s/(s-o),h),t.push(h),t.push(c)}l=c,s=o}return t}computeWorldVertices(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new le);const i=this.vertices,r=this.worldVertices;for(let s=0;s!==this.vertices.length;s++)t.vmult(i[s],r[s]),e.vadd(r[s],r[s]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(e,t){const i=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<this.vertices.length;r++){const s=i[r];s.x<e.x?e.x=s.x:s.x>t.x&&(t.x=s.x),s.y<e.y?e.y=s.y:s.y>t.y&&(t.y=s.y),s.z<e.z?e.z=s.z:s.z>t.z&&(t.z=s.z)}}computeWorldFaceNormals(e){const t=this.faceNormals.length;for(;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new le);const i=this.faceNormals,r=this.worldFaceNormals;for(let s=0;s!==t;s++)e.vmult(i[s],r[s]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let e=0;const t=this.vertices;for(let i=0;i!==t.length;i++){const r=t[i].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}calculateWorldAABB(e,t,i,r){const s=this.vertices;let o,a,l,c,u,h,p=new le;for(let g=0;g<s.length;g++){p.copy(s[g]),t.vmult(p,p),e.vadd(p,p);const m=p;(void 0===o||m.x<o)&&(o=m.x),(void 0===c||m.x>c)&&(c=m.x),(void 0===a||m.y<a)&&(a=m.y),(void 0===u||m.y>u)&&(u=m.y),(void 0===l||m.z<l)&&(l=m.z),(void 0===h||m.z>h)&&(h=m.z)}i.set(o,a,l),r.set(c,u,h)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(e=new le){const t=this.vertices;for(let i=0;i<t.length;i++)e.vadd(t[i],e);return e.scale(1/t.length,e),e}transformAllPoints(e,t){const i=this.vertices.length,r=this.vertices;if(t){for(let s=0;s<i;s++){const o=r[s];t.vmult(o,o)}for(let s=0;s<this.faceNormals.length;s++){const o=this.faceNormals[s];t.vmult(o,o)}}if(e)for(let s=0;s<i;s++){const o=r[s];o.vadd(e,o)}}pointIsInside(e){const t=this.vertices,i=this.faces,r=this.faceNormals,s=new le;this.getAveragePointLocal(s);for(let o=0;o<this.faces.length;o++){let a=r[o];const l=t[i[o][0]],c=new le;e.vsub(l,c);const u=a.dot(c),h=new le;s.vsub(l,h);const p=a.dot(h);if(u<0&&p>0||u>0&&p<0)return!1}return-1}static project(e,t,i,r,s){const o=e.vertices.length,a=Npe;let l=0,c=0;const u=Fpe,h=e.vertices;u.setZero(),Bi.vectorToLocalFrame(i,r,t,a),Bi.pointToLocalFrame(i,r,u,u);const p=u.dot(a);c=l=h[0].dot(a);for(let g=1;g<o;g++){const m=h[g].dot(a);m>l&&(l=m),m<c&&(c=m)}if(c-=p,l-=p,c>l){const g=c;c=l,l=g}s[0]=l,s[1]=c}}const YO=[],KO=[],Npe=new le,Fpe=new le;class xS extends pn{constructor(e){super({type:pn.types.BOX}),this.halfExtents=void 0,this.convexPolyhedronRepresentation=void 0,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,r=le,s=[new r(-e,-t,-i),new r(e,-t,-i),new r(e,t,-i),new r(-e,t,-i),new r(-e,-t,i),new r(e,-t,i),new r(e,t,i),new r(-e,t,i)],a=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],l=new Sf({vertices:s,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=l,l.material=this.material}calculateLocalInertia(e,t=new le){return xS.calculateInertia(this.halfExtents,e,t),t}static calculateInertia(e,t,i){const r=e;i.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),i.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),i.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}getSideNormals(e,t){const i=e,r=this.halfExtents;if(i[0].set(r.x,0,0),i[1].set(0,r.y,0),i[2].set(0,0,r.z),i[3].set(-r.x,0,0),i[4].set(0,-r.y,0),i[5].set(0,0,-r.z),void 0!==t)for(let s=0;s!==i.length;s++)t.vmult(i[s],i[s]);return i}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(e,t,i){const r=this.halfExtents,s=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]];for(let o=0;o<s.length;o++)oh.set(s[o][0],s[o][1],s[o][2]),t.vmult(oh,oh),e.vadd(oh,oh),i(oh.x,oh.y,oh.z)}calculateWorldAABB(e,t,i,r){const s=this.halfExtents;eu[0].set(s.x,s.y,s.z),eu[1].set(-s.x,s.y,s.z),eu[2].set(-s.x,-s.y,s.z),eu[3].set(-s.x,-s.y,-s.z),eu[4].set(s.x,-s.y,-s.z),eu[5].set(s.x,s.y,-s.z),eu[6].set(-s.x,s.y,-s.z),eu[7].set(s.x,-s.y,s.z);const o=eu[0];t.vmult(o,o),e.vadd(o,o),r.copy(o),i.copy(o);for(let a=1;a<8;a++){const l=eu[a];t.vmult(l,l),e.vadd(l,l);const c=l.x,u=l.y,h=l.z;c>r.x&&(r.x=c),u>r.y&&(r.y=u),h>r.z&&(r.z=h),c<i.x&&(i.x=c),u<i.y&&(i.y=u),h<i.z&&(i.z=h)}}}const oh=new le,eu=[new le,new le,new le,new le,new le,new le,new le,new le];class gn extends class{constructor(){this._listeners=void 0}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;return void 0===i[e]&&(i[e]=[]),i[e].includes(t)||i[e].push(t),this}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return!(void 0===i[e]||!i[e].includes(t))}hasAnyEventListener(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}removeEventListener(e,t){if(void 0===this._listeners)return this;const i=this._listeners;if(void 0===i[e])return this;const r=i[e].indexOf(t);return-1!==r&&i[e].splice(r,1),this}dispatchEvent(e){if(void 0===this._listeners)return this;const i=this._listeners[e.type];if(void 0!==i){e.target=this;for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}return this}}{constructor(e={}){super(),this.id=void 0,this.index=void 0,this.world=void 0,this.preStep=void 0,this.postStep=void 0,this.vlambda=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.collisionResponse=void 0,this.position=void 0,this.previousPosition=void 0,this.interpolatedPosition=void 0,this.initPosition=void 0,this.velocity=void 0,this.initVelocity=void 0,this.force=void 0,this.mass=void 0,this.invMass=void 0,this.material=void 0,this.linearDamping=void 0,this.type=void 0,this.allowSleep=void 0,this.sleepState=void 0,this.sleepSpeedLimit=void 0,this.sleepTimeLimit=void 0,this.timeLastSleepy=void 0,this.wakeUpAfterNarrowphase=void 0,this.torque=void 0,this.quaternion=void 0,this.initQuaternion=void 0,this.previousQuaternion=void 0,this.interpolatedQuaternion=void 0,this.angularVelocity=void 0,this.initAngularVelocity=void 0,this.shapes=void 0,this.shapeOffsets=void 0,this.shapeOrientations=void 0,this.inertia=void 0,this.invInertia=void 0,this.invInertiaWorld=void 0,this.invMassSolve=void 0,this.invInertiaSolve=void 0,this.invInertiaWorldSolve=void 0,this.fixedRotation=void 0,this.angularDamping=void 0,this.linearFactor=void 0,this.angularFactor=void 0,this.aabb=void 0,this.aabbNeedsUpdate=void 0,this.boundingRadius=void 0,this.wlambda=void 0,this.isTrigger=void 0,this.id=gn.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new le,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof e.collisionResponse||e.collisionResponse,this.position=new le,this.previousPosition=new le,this.interpolatedPosition=new le,this.initPosition=new le,e.position&&(this.position.copy(e.position),this.previousPosition.copy(e.position),this.interpolatedPosition.copy(e.position),this.initPosition.copy(e.position)),this.velocity=new le,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new le,this.force=new le;const t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?gn.STATIC:gn.DYNAMIC,typeof e.type==typeof gn.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=gn.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new le,this.quaternion=new as,this.initQuaternion=new as,this.previousQuaternion=new as,this.interpolatedQuaternion=new as,e.quaternion&&(this.quaternion.copy(e.quaternion),this.initQuaternion.copy(e.quaternion),this.previousQuaternion.copy(e.quaternion),this.interpolatedQuaternion.copy(e.quaternion)),this.angularVelocity=new le,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new le,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new le,this.invInertia=new le,this.invInertiaWorld=new Jc,this.invMassSolve=0,this.invInertiaSolve=new le,this.invInertiaWorldSolve=new Jc,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.linearFactor=new le(1,1,1),e.linearFactor&&this.linearFactor.copy(e.linearFactor),this.angularFactor=new le(1,1,1),e.angularFactor&&this.angularFactor.copy(e.angularFactor),this.aabb=new cr,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new le,this.isTrigger=Boolean(e.isTrigger),e.shape&&this.addShape(e.shape),this.updateMassProperties()}wakeUp(){const e=this.sleepState;this.sleepState=gn.AWAKE,this.wakeUpAfterNarrowphase=!1,e===gn.SLEEPING&&this.dispatchEvent(gn.wakeupEvent)}sleep(){this.sleepState=gn.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(e){if(this.allowSleep){const t=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=mr(this.sleepSpeedLimit,2);t===gn.AWAKE&&i<r?(this.sleepState=gn.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(gn.sleepyEvent)):t===gn.SLEEPY&&i>r?this.wakeUp():t===gn.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(gn.sleepEvent))}}updateSolveMassProperties(){this.sleepState===gn.SLEEPING||this.type===gn.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(e,t=new le){return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}vectorToLocalFrame(e,t=new le){return this.quaternion.conjugate().vmult(e,t),t}pointToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}vectorToWorldFrame(e,t=new le){return this.quaternion.vmult(e,t),t}addShape(e,t,i){const r=new le,s=new as;return t&&r.copy(t),i&&s.copy(i),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(s),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}removeShape(e){const t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}updateBoundingRadius(){const e=this.shapes,t=this.shapeOffsets,i=e.length;let r=0;for(let s=0;s!==i;s++){const o=e[s];o.updateBoundingSphereRadius();const a=t[s].length(),l=o.boundingSphereRadius;a+l>r&&(r=a+l)}this.boundingRadius=r}updateAABB(){const e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,r=e.length,s=Lpe,o=kpe,a=this.quaternion,l=this.aabb,c=Bpe;for(let u=0;u!==r;u++){const h=e[u];a.vmult(t[u],s),s.vadd(this.position,s),a.mult(i[u],o),h.calculateWorldAABB(s,o,c.lowerBound,c.upperBound),0===u?l.copy(c):l.extend(c)}this.aabbNeedsUpdate=!1}updateInertiaWorld(e){const t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){const i=Vpe,r=jpe;i.setRotationFromQuaternion(this.quaternion),i.transpose(r),i.scale(t,i),i.mmult(r,this.invInertiaWorld)}}applyForce(e,t=new le){if(this.type!==gn.DYNAMIC)return;this.sleepState===gn.SLEEPING&&this.wakeUp();const i=Upe;t.cross(e,i),this.force.vadd(e,this.force),this.torque.vadd(i,this.torque)}applyLocalForce(e,t=new le){if(this.type!==gn.DYNAMIC)return;const i=zpe,r=Hpe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyForce(i,r)}applyTorque(e){this.type===gn.DYNAMIC&&(this.sleepState===gn.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}applyImpulse(e,t=new le){if(this.type!==gn.DYNAMIC)return;this.sleepState===gn.SLEEPING&&this.wakeUp();const i=t,r=Gpe;r.copy(e),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);const s=$pe;i.cross(e,s),this.invInertiaWorld.vmult(s,s),this.angularVelocity.vadd(s,this.angularVelocity)}applyLocalImpulse(e,t=new le){if(this.type!==gn.DYNAMIC)return;const i=Wpe,r=qpe;this.vectorToWorldFrame(e,i),this.vectorToWorldFrame(t,r),this.applyImpulse(i,r)}updateMassProperties(){const e=Ype;this.invMass=this.mass>0?1/this.mass:0;const t=this.inertia,i=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),xS.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(e,t){const i=new le;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}integrate(e,t,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==gn.DYNAMIC&&this.type!==gn.KINEMATIC||this.sleepState===gn.SLEEPING)return;const r=this.velocity,s=this.angularVelocity,o=this.position,a=this.force,l=this.torque,c=this.quaternion,h=this.invInertiaWorld,p=this.linearFactor,g=this.invMass*e;r.x+=a.x*g*p.x,r.y+=a.y*g*p.y,r.z+=a.z*g*p.z;const m=h.elements,E=this.angularFactor,C=l.x*E.x,R=l.y*E.y,z=l.z*E.z;s.x+=e*(m[0]*C+m[1]*R+m[2]*z),s.y+=e*(m[3]*C+m[4]*R+m[5]*z),s.z+=e*(m[6]*C+m[7]*R+m[8]*z),o.x+=r.x*e,o.y+=r.y*e,o.z+=r.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(i?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}gn.idCounter=0,gn.COLLIDE_EVENT_NAME="collide",gn.DYNAMIC=1,gn.STATIC=2,gn.KINEMATIC=4,gn.AWAKE=0,gn.SLEEPY=1,gn.SLEEPING=2,gn.wakeupEvent={type:"wakeup"},gn.sleepyEvent={type:"sleepy"},gn.sleepEvent={type:"sleep"};const Lpe=new le,kpe=new as,Bpe=new cr,Vpe=new Jc,jpe=new Jc,Upe=new le,zpe=new le,Hpe=new le,Gpe=new le,$pe=new le,Wpe=new le,qpe=new le,Ype=new le;new le,new le;class TS{constructor(){this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new le,this.rayToWorld=new le,this.hitNormalWorld=new le,this.hitPointWorld=new le,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(e,t,i,r,s,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(r),this.shape=s,this.body=o,this.distance=a}}let qz,Yz,Kz,Xz,Qz,Zz,Jz;qz=pn.types.SPHERE,Yz=pn.types.PLANE,Kz=pn.types.BOX,Xz=pn.types.CYLINDER,Qz=pn.types.CONVEXPOLYHEDRON,Zz=pn.types.HEIGHTFIELD,Jz=pn.types.TRIMESH;class gs{get[qz](){return this._intersectSphere}get[Yz](){return this._intersectPlane}get[Kz](){return this._intersectBox}get[Xz](){return this._intersectConvex}get[Qz](){return this._intersectConvex}get[Zz](){return this._intersectHeightfield}get[Jz](){return this._intersectTrimesh}constructor(e=new le,t=new le){this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=e.clone(),this.to=t.clone(),this.direction=new le,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=gs.ANY,this.result=new TS,this.hasHit=!1,this.callback=i=>{}}intersectWorld(e,t){return this.mode=t.mode||gs.ANY,this.result=t.result||new TS,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===t.checkCollisionResponse||t.checkCollisionResponse,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(eH),JO.length=0,e.broadphase.aabbQuery(e,eH,JO),this.intersectBodies(JO),this.hasHit}intersectBody(e,t){t&&(this.result=t,this.updateDirection());const i=this.checkCollisionResponse;if(i&&!e.collisionResponse||0==(this.collisionFilterGroup&e.collisionFilterMask)||0==(e.collisionFilterGroup&this.collisionFilterMask))return;const r=tge,s=nge;for(let o=0,a=e.shapes.length;o<a;o++){const l=e.shapes[o];if((!i||l.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],s),e.quaternion.vmult(e.shapeOffsets[o],r),r.vadd(e.position,r),this.intersectShape(l,s,r,e),this.result.shouldStop))break}}intersectBodies(e,t){t&&(this.result=t,this.updateDirection());for(let i=0,r=e.length;!this.result.shouldStop&&i<r;i++)this.intersectBody(e[i])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(e,t,i,r){if(function(n,e,t){t.vsub(n,Cf);const i=Cf.dot(e);return e.scale(i,MS),MS.vadd(n,MS),t.distanceTo(MS)}(this.from,this.direction,i)>e.boundingSphereRadius)return;const a=this[e.type];a&&a.call(this,e,t,i,r,e)}_intersectBox(e,t,i,r,s){return this._intersectConvex(e.convexPolyhedronRepresentation,t,i,r,s)}_intersectPlane(e,t,i,r,s){const o=this.from,a=this.to,l=this.direction,c=new le(0,0,1);t.vmult(c,c);const u=new le;o.vsub(i,u);const h=u.dot(c);if(a.vsub(i,u),h*u.dot(c)>0||o.distanceTo(a)<h)return;const g=c.dot(l);if(Math.abs(g)<this.precision)return;const m=new le,E=new le,C=new le;o.vsub(i,m);const R=-c.dot(m)/g;l.scale(R,E),o.vadd(E,C),this.reportIntersection(c,C,s,r,-1)}getAABB(e){const{lowerBound:t,upperBound:i}=e,r=this.to,s=this.from;t.x=Math.min(r.x,s.x),t.y=Math.min(r.y,s.y),t.z=Math.min(r.z,s.z),i.x=Math.max(r.x,s.x),i.y=Math.max(r.y,s.y),i.z=Math.max(r.z,s.z)}_intersectHeightfield(e,t,i,r,s){const o=ige;o.from.copy(this.from),o.to.copy(this.to),Bi.pointToLocalFrame(i,t,o.from,o.from),Bi.pointToLocalFrame(i,t,o.to,o.to),o.updateDirection();const a=rge;let l,c,u,h;l=c=0,u=h=e.data.length-1;const p=new cr;o.getAABB(p),e.getIndexOfPosition(p.lowerBound.x,p.lowerBound.y,a,!0),l=Math.max(l,a[0]),c=Math.max(c,a[1]),e.getIndexOfPosition(p.upperBound.x,p.upperBound.y,a,!0),u=Math.min(u,a[0]+1),h=Math.min(h,a[1]+1);for(let g=l;g<u;g++)for(let m=c;m<h;m++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(g,m,p),p.overlapsRay(o)){if(e.getConvexTrianglePillar(g,m,!1),Bi.pointToWorldFrame(i,t,e.pillarOffset,AS),this._intersectConvex(e.pillarConvex,t,AS,r,s,tH),this.result.shouldStop)return;e.getConvexTrianglePillar(g,m,!0),Bi.pointToWorldFrame(i,t,e.pillarOffset,AS),this._intersectConvex(e.pillarConvex,t,AS,r,s,tH)}}}_intersectSphere(e,t,i,r,s){const o=this.from,a=this.to,l=e.radius,c=mr(a.x-o.x,2)+mr(a.y-o.y,2)+mr(a.z-o.z,2),u=2*((a.x-o.x)*(o.x-i.x)+(a.y-o.y)*(o.y-i.y)+(a.z-o.z)*(o.z-i.z)),h=mr(o.x-i.x,2)+mr(o.y-i.y,2)+mr(o.z-i.z,2)-mr(l,2),p=mr(u,2)-4*c*h,g=sge,m=oge;if(!(p<0))if(0===p)o.lerp(a,p,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1);else{const E=(-u-Math.sqrt(p))/(2*c),C=(-u+Math.sqrt(p))/(2*c);if(E>=0&&E<=1&&(o.lerp(a,E,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1)),this.result.shouldStop)return;C>=0&&C<=1&&(o.lerp(a,C,g),g.vsub(i,m),m.normalize(),this.reportIntersection(m,g,s,r,-1))}}_intersectConvex(e,t,i,r,s,o){const a=age,l=nH,c=o&&o.faceList||null,u=e.faces,h=e.vertices,p=e.faceNormals,g=this.direction,m=this.from,C=m.distanceTo(this.to),R=c?c.length:u.length,z=this.result;for(let de=0;!z.shouldStop&&de<R;de++){const Ie=c?c[de]:de,Be=u[Ie],Ne=p[Ie],ct=t,Dt=i;l.copy(h[Be[0]]),ct.vmult(l,l),l.vadd(Dt,l),l.vsub(m,l),ct.vmult(Ne,a);const Ot=g.dot(a);if(Math.abs(Ot)<this.precision)continue;const Lt=a.dot(l)/Ot;if(!(Lt<0)){g.scale(Lt,ca),ca.vadd(m,ca),ac.copy(h[Be[0]]),ct.vmult(ac,ac),Dt.vadd(ac,ac);for(let Zt=1;!z.shouldStop&&Zt<Be.length-1;Zt++){tu.copy(h[Be[Zt]]),nu.copy(h[Be[Zt+1]]),ct.vmult(tu,tu),ct.vmult(nu,nu),Dt.vadd(tu,tu),Dt.vadd(nu,nu);const en=ca.distanceTo(m);!gs.pointInTriangle(ca,ac,tu,nu)&&!gs.pointInTriangle(ca,tu,ac,nu)||en>C||this.reportIntersection(a,ca,s,r,Ie)}}}}_intersectTrimesh(e,t,i,r,s,o){const a=lge,l=pge,c=gge,u=nH,h=cge,p=uge,g=dge,m=fge,E=hge,C=e.indices,R=this.from,z=this.to,de=this.direction;c.position.copy(i),c.quaternion.copy(t),Bi.vectorToLocalFrame(i,t,de,h),Bi.pointToLocalFrame(i,t,R,p),Bi.pointToLocalFrame(i,t,z,g),g.x*=e.scale.x,g.y*=e.scale.y,g.z*=e.scale.z,p.x*=e.scale.x,p.y*=e.scale.y,p.z*=e.scale.z,g.vsub(p,h),h.normalize();const Ie=p.distanceSquared(g);e.tree.rayQuery(this,c,l);for(let Be=0,Ne=l.length;!this.result.shouldStop&&Be!==Ne;Be++){const ct=l[Be];e.getNormal(ct,a),e.getVertex(C[3*ct],ac),ac.vsub(p,u);const Dt=h.dot(a),Ot=a.dot(u)/Dt;if(Ot<0)continue;h.scale(Ot,ca),ca.vadd(p,ca),e.getVertex(C[3*ct+1],tu),e.getVertex(C[3*ct+2],nu);const Lt=ca.distanceSquared(p);!gs.pointInTriangle(ca,tu,ac,nu)&&!gs.pointInTriangle(ca,ac,tu,nu)||Lt>Ie||(Bi.vectorToWorldFrame(t,a,E),Bi.pointToWorldFrame(i,t,ca,m),this.reportIntersection(E,m,s,r,ct))}l.length=0}reportIntersection(e,t,i,r,s){const o=this.from,a=this.to,l=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this.direction)>0))switch(c.hitFaceIndex=void 0!==s?s:-1,this.mode){case gs.ALL:this.hasHit=!0,c.set(o,a,e,t,i,r,l),c.hasHit=!0,this.callback(c);break;case gs.CLOSEST:(l<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l));break;case gs.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,r,l),c.shouldStop=!0}}static pointInTriangle(e,t,i,r){r.vsub(t,Cf),i.vsub(t,Tv),e.vsub(t,eR);const s=Cf.dot(Cf),o=Cf.dot(Tv),a=Cf.dot(eR),l=Tv.dot(Tv),c=Tv.dot(eR);let u,h;return(u=l*a-o*c)>=0&&(h=s*c-o*a)>=0&&u+h<s*l-o*o}}gs.CLOSEST=1,gs.ANY=2,gs.ALL=4;const eH=new cr,JO=[],Tv=new le,eR=new le,tge=new le,nge=new as,ca=new le,ac=new le,tu=new le,nu=new le,tH={faceList:[0]},AS=new le,ige=new gs,rge=[],sge=new le,oge=new le,age=new le,nH=new le,lge=new le,cge=new le,uge=new le,dge=new le,hge=new le,fge=new le;new cr;const pge=[],gge=new Bi,Cf=new le,MS=new le;let _H,yH,vH,bH,wH,EH,SH,CH,xH,TH,AH,MH,DH,IH,OH,RH,PH,NH,FH,LH,kH,BH,VH,jH,UH;new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new gs,new le,new le,new le(1,0,0),new le(0,1,0),new le(0,0,1),new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new cr,new le,new cr,new le,new le,new le,new le,new le,new le,new le,new cr,new le,new Bi,new cr;const xr={sphereSphere:pn.types.SPHERE,spherePlane:pn.types.SPHERE|pn.types.PLANE,boxBox:pn.types.BOX|pn.types.BOX,sphereBox:pn.types.SPHERE|pn.types.BOX,planeBox:pn.types.PLANE|pn.types.BOX,convexConvex:pn.types.CONVEXPOLYHEDRON,sphereConvex:pn.types.SPHERE|pn.types.CONVEXPOLYHEDRON,planeConvex:pn.types.PLANE|pn.types.CONVEXPOLYHEDRON,boxConvex:pn.types.BOX|pn.types.CONVEXPOLYHEDRON,sphereHeightfield:pn.types.SPHERE|pn.types.HEIGHTFIELD,boxHeightfield:pn.types.BOX|pn.types.HEIGHTFIELD,convexHeightfield:pn.types.CONVEXPOLYHEDRON|pn.types.HEIGHTFIELD,sphereParticle:pn.types.PARTICLE|pn.types.SPHERE,planeParticle:pn.types.PLANE|pn.types.PARTICLE,boxParticle:pn.types.BOX|pn.types.PARTICLE,convexParticle:pn.types.PARTICLE|pn.types.CONVEXPOLYHEDRON,cylinderCylinder:pn.types.CYLINDER,sphereCylinder:pn.types.SPHERE|pn.types.CYLINDER,planeCylinder:pn.types.PLANE|pn.types.CYLINDER,boxCylinder:pn.types.BOX|pn.types.CYLINDER,convexCylinder:pn.types.CONVEXPOLYHEDRON|pn.types.CYLINDER,heightfieldCylinder:pn.types.HEIGHTFIELD|pn.types.CYLINDER,particleCylinder:pn.types.PARTICLE|pn.types.CYLINDER,sphereTrimesh:pn.types.SPHERE|pn.types.TRIMESH,planeTrimesh:pn.types.PLANE|pn.types.TRIMESH};_H=xr.sphereSphere,yH=xr.spherePlane,vH=xr.boxBox,bH=xr.sphereBox,wH=xr.planeBox,EH=xr.convexConvex,SH=xr.sphereConvex,CH=xr.planeConvex,xH=xr.boxConvex,TH=xr.sphereHeightfield,AH=xr.boxHeightfield,MH=xr.convexHeightfield,DH=xr.sphereParticle,IH=xr.planeParticle,OH=xr.boxParticle,RH=xr.convexParticle,PH=xr.cylinderCylinder,NH=xr.sphereCylinder,FH=xr.planeCylinder,LH=xr.boxCylinder,kH=xr.convexCylinder,BH=xr.heightfieldCylinder,VH=xr.particleCylinder,jH=xr.sphereTrimesh,UH=xr.planeTrimesh,new le,new le,new le,new le,new le,new as,new as,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new cr,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new as,new le,new le,new le,new le,new le,new le,new le,new le,new cr,new gs;const qs=globalThis.performance||{};if(!qs.now){let n=Date.now();qs.timing&&qs.timing.navigationStart&&(n=qs.timing.navigationStart),qs.now=()=>Date.now()-n}var Mf=tt(517);class Pr extends se{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new G;return this._value}next(e){super.next(this._value=e)}}function Yg(n,e,t){e||(e=new $n($n.IDENTITY));const i=new $n($n.IDENTITY);if(!n)return!0;if(n.matrix)i.copy(n.matrix);else{if(i.identity(),n.translation&&i.translate(n.translation),n.rotation){const s=new $n($n.IDENTITY).fromQuaternion(n.rotation);i.multiplyRight(s)}n.scale&&i.scale(n.scale)}const r=new $n(e).multiplyRight(i);if(!1===t(n,r,e))return!1;for(const s of n.nodes||n.children||[])if(!1===Yg(s,r,t))return!1;return!0}function qH(){Jj([vz,Gg])}function YH(n,e){const t=e.nodes.find(i=>i.name===n);if(t){let i=!1;for(const r of e.scenes)i||Yg(r,new $n($n.IDENTITY),(s,o)=>s!==t||(s.matrix=o,s.translation=void 0,s.rotation=void 0,s.scale=void 0,i=!0,!1));return e.scene={id:n,name:n,nodes:[t]},e.scenes=[e.scene],{scene:e.scene,scenes:e.scenes}}return e}function iR(n,e){return Ri(this,void 0,void 0,function*(){const t=n.scenegraph;let i;i=e?e[t]||(e[t]=fetch(t).then(s=>s.blob())):fetch(t);const r=yield iS(i,Gg,{DracoLoader:MO,gltf:{decompressMeshes:!0,postProcess:!0}});return YH(n.scenegraphNode,r)})}function mye(n,e){return Ri(this,void 0,void 0,function*(){return YH(n,yield e)})}function rR(n,e,t){if(e&&0!==e.length)return new Wde(Object.assign({id:n,pickable:!0,autoHighlight:!1,highlightColor:[30,136,229,255],coordinateSystem:Pi.CARTESIAN,data:e,mesh:new Tpe,wireframe:!1,getTransformMatrix:i=>i.transformMatrix,getColor:i=>i.color||[255,255,255,229.5]},t))}let yye=(()=>{class n extends Yle{initializeState(){const{data:t}=this.props;this.setState({data:null!=t?t:[],zoomOpacity:.8,doCollisions:!1}),qH()}renderLayers(){const t=this.state,i=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&l.unpickable),r=t.data.filter(l=>!l.scenegraph&&!l.wireframe&&!l.unpickable),s=t.data.filter(l=>!l.scenegraph&&l.wireframe),o=t.data.filter(l=>!!l.scenegraph);t.doCollisions&&function(n){Ri(this,void 0,void 0,function*(){console.log("Starting Collisioning");const e=n.filter(o=>!o.scenegraph&&!o.wireframe).map(o=>{const a=new $n(o.transformMatrix),l=a.transformAsPoint([-1,-1,-1],[]),c=a.transformAsPoint([1,1,1],[]);return{"@id":o["@id"],name:o.tooltip,entityId:o.entityId,bbox:new cr({lowerBound:new le(...l.map((u,h)=>Math.min(u,c[h]))),upperBound:new le(...c.map((u,h)=>Math.max(u,l[h])))})}}),t=[];for(const o of n.filter(a=>!!a.scenegraph)){const a=yield rS(o.scenegraph,Gg,{DracoLoader:MO,decompress:!0,postProcess:!0});for(const l of a.scenes)Yg(l,new $n(o.transformMatrix),(c,u)=>{if(c.mesh&&c.mesh.primitives&&c.mesh.primitives.length>0)for(const h of c.mesh.primitives)if(h.attributes.POSITION&&h.attributes.POSITION.min){const p=u.transformAsPoint(h.attributes.POSITION.min,[]),g=u.transformAsPoint(h.attributes.POSITION.max,[]);t.push({"@id":o["@id"],name:c.name,entityId:o.entityId,bbox:new cr({lowerBound:new le(...p.map((m,E)=>Math.min(m,g[E]))),upperBound:new le(...g.map((m,E)=>Math.max(m,p[E])))}),gltf:a})}return!0})}const i=[],r=[];for(const o of e){const a=[];for(const l of t)o.bbox.overlaps(l.bbox)&&a.push({"@id":l["@id"],name:l.name});a.length>0?i.push({"@id":o.entityId,name:o.name,hits:a}):r.push(o)}console.log({sourceBoxes:e,targetBoxes:t,report:i,sad:r,maxHits:Math.max(...i.map(o=>o.hits.length))});const s=[];for(const o of i){s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":"","Hit Name":""});for(const a of o.hits)s.push({"Tissue ID":o["@id"],"Tissue Name":o.name,"Hit ID":a["@id"],"Hit Name":a.name})}return console.log(s),i})}(t.data);const a={};for(const l of o)l.scenegraph&&l.scenegraphNode&&!Object.prototype.hasOwnProperty.call(a,l.scenegraph)&&(a[l.scenegraph]=iR({scenegraph:l.scenegraph},n.gltfCache));return[rR("cubes",i,{wireframe:!1,pickable:!1}),rR("pickableCubes",r,{wireframe:!1,pickable:!0}),rR("wireframes",s,{wireframe:!0,pickable:!1}),...o.map(l=>{var c;return new bpe({id:"models-"+l["@id"],opacity:l.zoomBasedOpacity?t.zoomOpacity:void 0!==l.opacity?l.opacity:1,pickable:!l.unpickable,coordinateSystem:Pi.CARTESIAN,data:[l],scenegraph:l.scenegraphNode?mye(l.scenegraphNode,a[l.scenegraph]):l.scenegraph,_lighting:l._lighting,getTransformMatrix:l.transformMatrix,getColor:null!==(c=l.color)&&void 0!==c?c:[0,255,0,127.5],parameters:{depthMask:!l.zoomBasedOpacity&&(void 0===l.opacity||1===l.opacity)}})})].filter(l=>!!l)}getPickingInfo(t){return t.info}}return n.layerName="BodyUILayer",n.gltfCache={},n})();function KH(n,e=[]){for(const t of n.nodes||n.children||[])e.push(t.name),KH(t,e);return e}let bye=(()=>{class n{constructor(t){var i,r,s,o,a;this.deckProps=t,this.bodyUILayer=new yye({}),this.nodeClickSubject=new se,this.nodeHoverStartSubject=new se,this.nodeHoverStopSubject=new se,this.sceneRotationSubject=new Pr([0,0]),this.nodeDragStartSubject=new se,this.nodeDragSubject=new se,this.nodeDragEndSubject=new se,this.nodeClick$=this.nodeClickSubject.pipe(ys()),this.nodeHoverStart$=this.nodeHoverStartSubject.pipe(ys()),this.nodeHoverStop$=this.nodeHoverStopSubject.pipe(ys()),this.sceneRotation$=this.sceneRotationSubject.pipe(ys()),this.nodeDragStart$=this.nodeDragStartSubject.pipe(ys()),this.nodeDrag$=this.nodeDragSubject.pipe(ys()),this.nodeDragEnd$=this.nodeDragEndSubject.pipe(ys());const l=Object.assign(Object.assign({},t),{views:["orthographic"===t.camera?new oce({flipY:!1,near:-1e3}):new cce({orbitAxis:"Y"})],controller:void 0===t.interactive||t.interactive,layers:[this.bodyUILayer],onHover:this._onHover,onClick:this._onClick,onViewStateChange:this._onViewStateChange,onDragStart:this._onDragStart,onDrag:this._onDrag,onDragEnd:this._onDragEnd,getCursor:c=>{var u;return null!==(u=this.cursor)&&void 0!==u?u:c.isDragging?"grabbing":"grab"}});t.legacyLighting&&(l.effects=[new XI({ambientLight:new cU({color:[255,255,255],intensity:10})})]),this.deck=new gS(l),this.deck.setProps({viewState:{orbitAxis:"Y",minRotationX:null!==(i=t.minRotationX)&&void 0!==i?i:-15,maxRotationX:null!==(r=t.maxRotationX)&&void 0!==r?r:15,target:null!==(s=t.target)&&void 0!==s?s:[.5,.5,0],rotationX:0,rotationOrbit:null!==(o=t.rotation)&&void 0!==o?o:0,zoom:null!==(a=t.zoom)&&void 0!==a?a:9.5,camera:t.camera}}),t.rotation&&this.sceneRotationSubject.next([t.rotation,0])}initialize(){return Ri(this,void 0,void 0,function*(){for(;!this.bodyUILayer.state;)yield new Promise(t=>{setTimeout(t,200)})})}finalize(){this.deck.finalize()}setScene(t){if((null==t?void 0:t.length)>0){let i=this.bodyUILayer.state.zoomOpacity,r=!1;for(const s of t)s.zoomToOnLoad&&(this.zoomTo(s),r=!0);i=r?.05:i,this.deckProps.debugSceneNodeProcessing?this.debugSceneNodeProcessing(t,i):this.bodyUILayer.setState({data:t,zoomOpacity:i})}}debugSceneNodeProcessing(t,i){const r="https://hubmapconsortium.github.io/ccf-3d-reference-object-library/VH_Female/United/VHF_United_Color.glb",s=new $n([.076,0,0,0,0,.076,16875389974302382e-33,0,0,-16875389974302382e-33,.076,0,.49,.034,.11,1]);(function(n,e,t){return Ri(this,void 0,void 0,function*(){qH();const i=yield iR({scenegraph:n,scenegraphNode:"VHF_Kidney_L_Low1"}),r={},s=[];for(const o of i.scenes)Yg(o,e=new $n(e||$n.IDENTITY),(a,l)=>{const c={"@id":a.name||a.id,"@type":"ProcessedNode",transformMatrix:new $n(l),wireframe:!0,node:a};if(s.push({"@id":`GLTF:${c["@id"]}`,"@type":"GLTFNode",scenegraph:n,scenegraphNode:c["@id"],transformMatrix:new $n(e||$n.IDENTITY),tooltip:a.name||a.id,color:[255,255,255,255],_lighting:"pbr",zoomBasedOpacity:!0,node:a}),a.mesh&&a.mesh.primitives&&a.mesh.primitives.length>0)for(const u of a.mesh.primitives)if(u.attributes.POSITION&&u.attributes.POSITION.min){const h=l.transformAsPoint(u.attributes.POSITION.min,[]),p=l.transformAsPoint(u.attributes.POSITION.max,[]);c.bbox=new cr({lowerBound:new le(...h.map((g,m)=>Math.min(g,p[m]))),upperBound:new le(...p.map((g,m)=>Math.max(g,h[m])))})}return r[c["@id"]]=c,!0});for(const o of Object.values(r).filter(a=>!a.bbox)){for(const a of KH(o.node).map(l=>r[l]).filter(l=>l.bbox))o.bbox?o.bbox.extend(a.bbox):o.bbox=a.bbox.clone();o.bbox||delete r[o["@id"]]}for(const o of Object.values(r)){const a=o.bbox.lowerBound,u=(o.size=o.bbox.upperBound.clone().vsub(a)).clone().vmul(new le(.5,.5,.5)),h=o.center=a.clone().vadd(u);o.transformMatrix=new $n($n.IDENTITY).translate(h.toArray()).scale(u.toArray())}for(const o of s)r[o["@id"]]=o;return r})})(r,s).then(o=>{console.log("results",o),console.log("data",t),(t=t.concat(Object.values(o))).push({"@id":"TEST","@type":"TEST",scenegraph:r,scenegraphNode:"VHF_Kidney_R_Low",transformMatrix:s,color:[255,255,255,200],_lighting:"pbr",zoomBasedOpacity:!1}),this.bodyUILayer.setState({data:t,zoomOpacity:i})})}zoomTo(t){const i=new $n(t.transformMatrix);this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:i.getTranslation(),rotationX:0,rotationOrbit:0,zoom:11.5})})}setRotation(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationOrbit:t})})}setRotationX(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{rotationX:t})})}setZoom(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{zoom:t})})}setTarget(t){this.deck.setProps({viewState:Object.assign(Object.assign({},this.deck.props.viewState),{target:t})})}setInteractive(t){this.deck.setProps({controller:t})}_onHover(t){const{lastHovered:i}=this;this.cursor=t.picked?"pointer":void 0,t.picked&&t.object&&t.object["@id"]?i!==t.object&&(i&&this.nodeHoverStopSubject.next(i),this.lastHovered=t.object,this.nodeHoverStartSubject.next(t.object)):i&&(this.nodeHoverStopSubject.next(i),this.lastHovered=void 0)}_onClick(t,i){var r,s;t.picked&&t.object&&t.object["@id"]&&this.nodeClickSubject.next({node:t.object,ctrlClick:null!==(s=null===(r=null==i?void 0:i.srcEvent)||void 0===r?void 0:r.ctrlKey)&&void 0!==s?s:void 0})}_onViewStateChange(t){var i;if(null===(i=t.interactionState)||void 0===i?void 0:i.isZooming){const r=this.bodyUILayer.state,s=Math.min(Math.max(1-(t.viewState.zoom-8.9)/2,.05),1);r.zoomOpacity!==s&&this.bodyUILayer.setState({data:r.data,zoomOpacity:s})}this.deck.setProps({viewState:Object.assign({},t.viewState)}),this.sceneRotationSubject.next([t.viewState.rotationOrbit,t.viewState.rotationX])}_onDragStart(t,i){this._dragEvent(t,i,this.nodeDragStartSubject)}_onDrag(t,i){this._dragEvent(t,i,this.nodeDragSubject)}_onDragEnd(t,i){this._dragEvent(t,i,this.nodeDragEndSubject)}_dragEvent(t,i,r){var s;(null===(s=null==t?void 0:t.object)||void 0===s?void 0:s["@id"])&&r.next({node:t.object,info:t,e:i})}}return Or([Mf.ZP],n.prototype,"_onHover",null),Or([Mf.ZP],n.prototype,"_onClick",null),Or([Mf.ZP],n.prototype,"_onViewStateChange",null),Or([Mf.ZP],n.prototype,"_onDragStart",null),Or([Mf.ZP],n.prototype,"_onDrag",null),Or([Mf.ZP],n.prototype,"_onDragEnd",null),n})();class XH extends y{notifyNext(e,t,i,r,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class wye extends y{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function QH(n,e,t,i,r=new wye(n,t,i)){if(!r.closed)return e instanceof I?e.subscribe(r):xe(e)(r)}const ZH={};class JH{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new Eye(e,this.resultSelector))}}class Eye extends XH{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(ZH),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(QH(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const r=this.values,o=this.toRespond?r[i]===ZH?--this.toRespond:this.toRespond:0;r[i]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}function Cye(n,e){return n===e}function xye(n,e,t){if(null===e||null===t||e.length!==t.length)return!1;const i=e.length;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function e4(n,e=Cye){let t=null,i=null;function r(){return xye(e,t,arguments)||(i=n.apply(null,arguments)),t=arguments,i}return r.reset=function(){t=null,i=null},r}const Aye=e4(function(){const n=pM();if(!n)return!1;const e=n.injector.get(Dk,null);return!!e&&e.some(i=>(i&&i.providers||[]).some(s=>s&&s.provide&&"MockNgModuleResolver"===s.provide.name||!1))});let sR=(()=>{class n{constructor(){this.bootstrap$=new ff(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const oR=new zt("INITIAL_STATE_TOKEN");let Mye=(()=>{class n{static set(t){this.value=t}static pop(){const t=this.value;return this.value={},t}}return n.value={},n})();const t4=new zt("Internals.StateContextFactory"),n4=new zt("Internals.StateFactory");function Rv(...n){if(1===n.length){const e=n[0];if(k(e))return FS(e,null);if(ie(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return FS(t.map(i=>e[i]),t)}}if("function"==typeof n[n.length-1]){const e=n.pop();return FS(n=1===n.length&&k(n[0])?n[0]:n,null).pipe(me(t=>e(...t)))}return FS(n,null)}function FS(n,e){return new I(t=>{const i=n.length;if(0===i)return void t.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=Ve(n[a]);let c=!1;t.add(l.subscribe({next:u=>{c||(c=!0,o++),r[a]=u},error:u=>t.error(u),complete:()=>{s++,(s===i||!c)&&(o===i&&t.next(e?e.reduce((u,h,p)=>(u[h]=r[p],u),{}):r),t.complete())}}))}})}function Wi(n,e){return function(i){return i.lift(new Dye(n,e))}}class Dye{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new Iye(e,this.predicate,this.thisArg))}}class Iye extends y{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function La(n,e,t){let i;return i=n&&"object"==typeof n?n:{bufferSize:n,windowTime:e,refCount:!1,scheduler:t},r=>r.lift(function({bufferSize:n=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:t,scheduler:i}){let r,o,s=0,a=!1,l=!1;return function(u){let h;s++,!r||a?(a=!1,r=new ff(n,e,i),h=r.subscribe(this),o=u.subscribe({next(p){r.next(p)},error(p){a=!0,r.error(p)},complete(){l=!0,o=void 0,r.complete()}}),l&&(o=void 0)):h=r.subscribe(this),this.add(()=>{s--,h.unsubscribe(),h=void 0,o&&!l&&t&&0===s&&(o.unsubscribe(),o=void 0,r=void 0)})}}(i))}const i4=(()=>{function n(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return n.prototype=Object.create(Error.prototype),n})();function zr(n){return e=>0===n?Hy():e.lift(new Rye(n))}class Rye{constructor(e){if(this.total=e,this.total<0)throw new i4}call(e,t){return t.subscribe(new Pye(e,this.total))}}class Pye extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function r4(n,e){return e?t=>t.pipe(r4((i,r)=>Ve(n(i,r)).pipe(me((s,o)=>e(i,s,r,o))))):t=>t.lift(new Nye(n))}class Nye{constructor(e){this.project=e}call(e,t){return t.subscribe(new Fye(e,this.project))}}class Fye extends be{constructor(e,t){super(e),this.project=t,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(t)}_innerSub(e){const t=new gt(this),i=this.destination;i.add(t);const r=P(e,t);r!==t&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}function LS(n=null){return e=>e.lift(new Lye(n))}class Lye{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new kye(e,this.defaultValue))}}class kye extends y{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function cc(n){return function(t){const i=new Bye(n),r=t.lift(i);return i.caught=r}}class Bye{constructor(e){this.selector=e}call(e,t){return t.subscribe(new Vye(e,this.selector,this.caught))}}class Vye extends be{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let t;try{t=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new gt(this);this.add(i);const r=P(t,i);r!==i&&this.add(r)}}}function ls(n){return e=>e.lift(new jye(n))}class jye{constructor(e){this.notifier=e}call(e,t){const i=new Uye(e),r=P(this.notifier,new gt(i));return r&&!i.seenValue?(i.add(r),t.subscribe(i)):i}}class Uye extends be{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function ah(){}function ur(n,e,t){return function(r){return r.lift(new zye(n,e,t))}}class zye{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new Hye(e,this.nextOrObserver,this.error,this.complete))}}class Hye extends y{constructor(e,t,i,r){super(e),this._tapNext=ah,this._tapError=ah,this._tapComplete=ah,this._tapError=i||ah,this._tapComplete=r||ah,K(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||ah,this._tapError=t.error||ah,this._tapComplete=t.complete||ah)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}function Qu(n,e){return t=>t.lift(new Gye(n,e))}class Gye{constructor(e,t){this.compare=e,this.keySelector=t}call(e,t){return t.subscribe(new $ye(e,this.compare,this.keySelector))}}class $ye extends y{constructor(e,t,i){super(e),this.keySelector=i,this.hasKey=!1,"function"==typeof t&&(this.compare=t)}compare(e,t){return e===t}_next(e){let t;try{const{keySelector:r}=this;t=r?r(e):e}catch(r){return this.destination.error(r)}let i=!1;if(this.hasKey)try{const{compare:r}=this;i=r(this.key,t)}catch(r){return this.destination.error(r)}else this.hasKey=!0;i||(this.key=t,this.destination.next(e))}}const ka={STATE_NAME:n=>`${n} is not a valid state name. It needs to be a valid object property name.`,STATE_NAME_PROPERTY:()=>"States must register a 'name' property",STATE_UNIQUE:(n,e,t)=>`State name '${n}' from ${e} already exists in ${t}`,STATE_DECORATOR:()=>"States must be decorated with @State() decorator",INCORRECT_PRODUCTION:()=>"Angular is running in production mode but NGXS is still running in the development mode!\nPlease set developmentMode to false on the NgxsModule options when in production mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",INCORRECT_DEVELOPMENT:()=>"RECOMMENDATION: Set developmentMode to true on the NgxsModule when Angular is running in development mode.\nNgxsModule.forRoot(states, { developmentMode: !environment.production })",SELECT_FACTORY_NOT_CONNECTED:()=>"You have forgotten to import the NGXS module!",ACTION_DECORATOR:()=>"@Action() decorator cannot be used with static methods",SELECTOR_DECORATOR:()=>"Selectors only work on methods",ZONE_WARNING:()=>"Your application was bootstrapped with nooped zone and your execution strategy requires an actual NgZone!\nPlease set the value of the executionStrategy property to NoopNgxsExecutionStrategy.\nNgxsModule.forRoot(states, { executionStrategy: NoopNgxsExecutionStrategy })",PATCHING_ARRAY:()=>"Patching arrays is not supported.",PATCHING_PRIMITIVE:()=>"Patching primitives is not supported.",UNDECORATED_STATE_IN_IVY:n=>`'${n}' class should be decorated with @Injectable() right after the @State() decorator`};let s4=(()=>{class n{constructor(t,i){this._ngZone=t,this._platformId=i,this.verifyZoneIsNotNooped(this._ngZone)}enter(t){return function(n){return"server"===n}(this._platformId)?this.runInsideAngular(t):this.runOutsideAngular(t)}leave(t){return this.runInsideAngular(t)}runInsideAngular(t){return vn.isInAngularZone()?t():this._ngZone.run(t)}runOutsideAngular(t){return vn.isInAngularZone()?this._ngZone.runOutsideAngular(t):t()}verifyZoneIsNotNooped(t){t instanceof vn||console.warn(ka.ZONE_WARNING())}}return n.\u0275fac=function(t){return new(t||n)(De(vn),De(Vc))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const o4=new zt("ROOT_STATE_TOKEN"),a4=new zt("FEATURE_STATE_TOKEN"),l4=new zt("NGXS_PLUGINS"),c4=new zt("NG_TEST_MODE"),u4=new zt("NG_DEV_MODE"),Zu="NGXS_META",d4="NGXS_OPTIONS_META";let Df=(()=>{class n{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=s4}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class Wye{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}}const h4=new zt("NGXS_EXECUTION_STRATEGY");function If(n){return n.constructor&&n.constructor.type?n.constructor.type:n.type}const f4=(n,e,t)=>{n=Object.assign({},n);const i=e.split("."),r=i.length-1;return i.reduce((s,o,a)=>(s[o]=a===r?t:Array.isArray(s[o])?s[o].slice():Object.assign({},s[o]),s&&s[o]),n),n},kS=(n,e)=>e.split(".").reduce((t,i)=>t&&t[i],n),lR=n=>n&&"object"==typeof n&&!Array.isArray(n),cR=(n,...e)=>{if(!e.length)return n;const t=e.shift();if(lR(n)&&lR(t))for(const i in t)lR(t[i])?(n[i]||Object.assign(n,{[i]:{}}),cR(n[i],t[i])):Object.assign(n,{[i]:t[i]});return cR(n,...e)};function Pv(n){return n[Zu]}function g4(n,e){const t=kS(e.currentAppState,n.path),i=kS(e.newAppState,n.path);return new Wye(t,i,!n.isInitialised)}function eve(...n){return function(n,e,t=ive){const i=function(n){return n.reduce((e,t)=>(e[If(t)]=!0,e),{})}(n),r=e&&function(n){return n.reduce((e,t)=>(e[t]=!0,e),{})}(e);return function(s){return s.pipe(function(n,e){return Wi(t=>{const i=If(t.action);return n[i]&&(!e||e[t.status])})}(i,r),t())}}(n,["DISPATCHED"])}function ive(){return me(n=>n.action)}function BS(n){return e=>new I(t=>e.subscribe({next(i){n.leave(()=>t.next(i))},error(i){n.leave(()=>t.error(i))},complete(){n.leave(()=>t.complete())}}))}let VS=(()=>{class n{constructor(t){this._executionStrategy=t}enter(t){return this._executionStrategy.enter(t)}leave(t){return this._executionStrategy.leave(t)}}return n.\u0275fac=function(t){return new(t||n)(De(h4))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class ove extends se{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(e){if(this._busyPushingNext)this._itemQueue.unshift(e);else{for(this._busyPushingNext=!0,super.next(e);this._itemQueue.length>0;){const t=this._itemQueue.pop();super.next(t)}this._busyPushingNext=!1}}}let jS=(()=>{class n extends ove{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Gi(n)))(i||n)}}(),n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),ave=(()=>{class n extends I{constructor(t,i){super(r=>{const s=t.pipe(BS(i)).subscribe({next:o=>r.next(o),error:o=>r.error(o),complete:()=>r.complete()});r.add(s)})}}return n.\u0275fac=function(t){return new(t||n)(De(jS),De(VS))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const m4=n=>(...e)=>n.shift()(...e,(...i)=>m4(n)(...i));let US=(()=>{class n extends Pr{constructor(){super({})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),fR=(()=>{class n{constructor(t,i){this._parentManager=t,this._pluginHandlers=i,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const t=this.getPluginHandlers();this.rootPlugins.push(...t)}getPluginHandlers(){return(this._pluginHandlers||[]).map(i=>i.handle?i.handle.bind(i):i)}}return n.\u0275fac=function(t){return new(t||n)(De(n,12),De(l4,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),pR=(()=>{class n extends se{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Gi(n)))(i||n)}}(),n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),_4=(()=>{class n{constructor(t,i,r,s,o,a){this._injector=t,this._actions=i,this._actionResults=r,this._pluginManager=s,this._stateStream=o,this._ngxsExecutionStrategy=a}dispatch(t){const i=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(t));return i.subscribe({error:r=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(Zo),this._errorHandler.handleError(r)}catch(s){}})}),i.pipe(BS(this._ngxsExecutionStrategy))}dispatchByEvents(t){return Array.isArray(t)?0===t.length?nn(this._stateStream.getValue()):Rv(t.map(i=>this.dispatchSingle(i))):this.dispatchSingle(t)}dispatchSingle(t){if(!If(t))return yg(new Error(`This action doesn't have a type property: ${t.constructor.name}`));const r=this._stateStream.getValue();return m4([...this._pluginManager.plugins,(o,a)=>{o!==r&&this._stateStream.next(o);const l=this.getActionResultStream(a);return l.subscribe(c=>this._actions.next(c)),this._actions.next({action:a,status:"DISPATCHED"}),this.createDispatchObservable(l)}])(r,t).pipe(La())}getActionResultStream(t){return this._actionResults.pipe(Wi(i=>i.action===t&&"DISPATCHED"!==i.status),zr(1),La())}createDispatchObservable(t){return t.pipe(r4(i=>{switch(i.status){case"SUCCESSFUL":return nn(this._stateStream.getValue());case"ERRORED":return yg(i.error);default:return Uc}})).pipe(La())}}return n.\u0275fac=function(t){return new(t||n)(De(jn),De(jS),De(pR),De(fR),De(US),De(VS))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const y4=n=>{Object.freeze(n);const e="function"==typeof n,t=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(function(i){t.call(n,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)&&null!==n[i]&&("object"==typeof n[i]||"function"==typeof n[i])&&!Object.isFrozen(n[i])&&y4(n[i])}),n};let v4=(()=>{class n{constructor(t,i){this.isDevMode=t,this.isTestMode=i}}return n.\u0275fac=function(t){return new(t||n)(De(u4),De(c4))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),b4=(()=>{class n{constructor(t,i){this._host=t,this._config=i}get isIncorrectProduction(){return!this._host.isDevMode()&&this._config.developmentMode}get isIncorrectDevelopment(){return this._host.isDevMode()&&!this._config.developmentMode}verifyDevMode(){this._host.isTestMode()||(this.isIncorrectProduction?console.warn(ka.INCORRECT_PRODUCTION()):this.isIncorrectDevelopment&&console.warn(ka.INCORRECT_DEVELOPMENT()))}}return n.\u0275fac=function(t){return new(t||n)(De(v4),De(Df))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),Xg=(()=>{class n{constructor(t,i,r,s){this._stateStream=t,this._dispatcher=i,this._config=r,s.verifyDevMode()}getRootStateOperations(){const t={getState:()=>this._stateStream.getValue(),setState:i=>this._stateStream.next(i),dispatch:i=>this._dispatcher.dispatch(i)};return this._config.developmentMode?this.ensureStateAndActionsAreImmutable(t):t}ensureStateAndActionsAreImmutable(t){return{getState:()=>t.getState(),setState:i=>{const r=y4(i);return t.setState(r)},dispatch:i=>t.dispatch(i)}}setStateToTheCurrentWithNew(t){const i=this.getRootStateOperations(),r=i.getState();i.setState(Object.assign({},r,t.defaults))}}return n.\u0275fac=function(t){return new(t||n)(De(US),De(_4),De(Df),De(b4))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),zS=(()=>{class n{constructor(t){this._internalStateOperations=t}createStateContext(t){const i=this._internalStateOperations.getRootStateOperations();function r(l){return kS(l,t.path)}function s(l,c){const u=f4(l,t.path,c),h=t.instance;if(h.ngxsOnChanges){const p=g4(t,{currentAppState:l,newAppState:u});h.ngxsOnChanges(p)}return i.setState(u),u}function o(l,c){return s(l,c(r(l)))}return{getState:()=>r(i.getState()),patchState:l=>o(i.getState(),function(n){return e=>{if(Array.isArray(n))throw new Error(ka.PATCHING_ARRAY());if("object"!=typeof n)throw new Error(ka.PATCHING_PRIMITIVE());const t=Object.assign({},e);for(const i in n)t[i]=n[i];return t}}(l)),setState(l){const c=i.getState();return function(l){return"function"==typeof l}(l)?o(c,l):s(c,l)},dispatch:l=>i.dispatch(l)}}}return n.\u0275fac=function(t){return new(t||n)(De(Xg))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class HS{static stateNameErrorMessage(e){return ka.STATE_NAME(e)}static checkCorrectStateName(e){if(!e)throw new Error(ka.STATE_NAME_PROPERTY());if(!this.stateNameRegex.test(e))throw new Error(this.stateNameErrorMessage(e))}static checkStateNameIsUnique(e,t){const r=this.getValidStateMeta(e).name,s=t[r];if(s&&s!==e)throw new Error(ka.STATE_UNIQUE(r,e.name,s.name));return r}static getValidStateMeta(e){const t=Pv(e);if(!t)throw new Error(ka.STATE_DECORATOR());return t}}HS.stateNameRegex=new RegExp("^[a-zA-Z0-9_]+$");let Qg=(()=>{class n{constructor(t,i,r,s,o,a,l){this._injector=t,this._config=i,this._parentFactory=r,this._actions=s,this._actionResults=o,this._stateContextFactory=a,this._initialState=l,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=e4(()=>{const c=this;function u(p){const g=c.statePaths[p];return g?function(n,e){return e&&e.compatibility&&e.compatibility.strictContentSecurityPolicy?function(n){const e=n.slice();return t=>e.reduce((i,r)=>i&&i[r],t)}(n):function(n){const e=n;let t="store."+e[0],i=0;const r=e.length;let s=t;for(;++i<r;)s=s+" && "+(t=t+"."+e[i]);return new Function("store","return "+s+";")}(n)}(g.split("."),c._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(p){let g=u(p);return g||((...m)=>(g||(g=u(p)),g?g(...m):void 0))},getSelectorOptions:p=>Object.assign({},c._config.selectorOptions,p||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(t){let i={};return i=Array.isArray(t)?t.slice():function(n){return"object"==typeof n&&null!==n||"function"==typeof n}(t)?Object.assign({},t):void 0===t?{}:t,i}static checkStatesAreValid(t){t.forEach(HS.getValidStateMeta)}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(t){n.checkStatesAreValid(t);const{newStates:i}=this.addToStatesMap(t);if(!i.length)return[];const r=function(n){const e=t=>{const i=n.find(r=>r===t);if(!i)throw new Error(`Child state not found: ${t}. \r\nYou may have forgotten to add states to module`);return i[Zu].name};return n.reduce((t,i)=>{const{name:r,children:s}=i[Zu];return t[r]=(s||[]).map(e),t},{})}(i),s=function(n){const e=[],t={},i=(r,s=[])=>{Array.isArray(s)||(s=[]),s.push(r),t[r]=!0,n[r].forEach(o=>{if(s.indexOf(o)>=0)throw new Error(`Circular dependency '${o}' is required by '${r}': ${s.join(" -> ")}`);t[o]||i(o,s.slice(0))}),e.indexOf(r)<0&&e.push(r)};return Object.keys(n).forEach(r=>i(r)),e.reverse()}(r),o=function(n,e={}){const t=(i,r)=>{for(const s in i)if(i.hasOwnProperty(s)&&i[s].indexOf(r)>=0){const o=t(i,s);return null!==o?`${o}.${s}`:s}return null};for(const i in n)if(n.hasOwnProperty(i)){const r=t(n,i);e[i]=r?`${r}.${i}`:i}return e}(r),a=function(n){return n.reduce((e,t)=>(e[t[Zu].name]=t,e),{})}(i),l=[];for(const c of s){const u=a[c],h=o[c],p=u[Zu];this.addRuntimeInfoToMeta(p,h);const g={name:c,path:h,isInitialised:!1,actions:p.actions,instance:this._injector.get(u),defaults:n.cloneDefaults(p.defaults)};this.hasBeenMountedAndBootstrapped(c,h)||l.push(g),this.states.push(g)}return l}addAndReturnDefaults(t){const r=this.add(t||[]);return{defaults:r.reduce((o,a)=>f4(o,a.path,a.defaults),{}),states:r}}connectActionHandlers(){null===this._actionsSubscription&&(this._actionsSubscription=this._actions.pipe(Wi(t=>"DISPATCHED"===t.status),V(({action:t})=>this.invokeActions(this._actions,t).pipe(me(()=>({action:t,status:"SUCCESSFUL"})),LS({action:t,status:"CANCELED"}),cc(i=>nn({action:t,status:"ERRORED",error:i}))))).subscribe(t=>this._actionResults.next(t)))}invokeActions(t,i){const r=If(i),s=[];for(const o of this.states){const a=o.actions[r];if(a)for(const l of a){const c=this._stateContextFactory.createStateContext(o);try{let u=o.instance[l.fn](c,i);u instanceof Promise&&(u=Ve(u)),u instanceof I?(u=u.pipe(LS({})),l.options.cancelUncompleted&&(u=u.pipe(ls(t.pipe(eve(i)))))):u=nn({}).pipe(La()),s.push(u)}catch(u){s.push(yg(u))}}}return s.length||s.push(nn({})),Rv(s)}addToStatesMap(t){const i=[],r=this.statesByName;for(const s of t){const o=HS.checkStateNameIsUnique(s,r);!r[o]&&(i.push(s),r[o]=s)}return{newStates:i}}addRuntimeInfoToMeta(t,i){this.statePaths[t.name]=i,t.path=i}hasBeenMountedAndBootstrapped(t,i){const r=void 0!==kS(this._initialState,i);return this.statesByName[t]&&r}}return n.\u0275fac=function(t){return new(t||n)(De(jn),De(Df),De(n,12),De(jS),De(pR),De(zS),De(oR,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),gR=(()=>{class n{constructor(t,i,r){this.internalStateOperations=t,this.stateContextFactory=i,this.bootstrapper=r}ngxsBootstrap(t,i){this.internalStateOperations.getRootStateOperations().dispatch(t).pipe(Wi(()=>!!i),ur(()=>this.invokeInit(i.states)),V(()=>this.bootstrapper.appBootstrapped$),Wi(r=>!!r)).subscribe(()=>this.invokeBootstrap(i.states))}invokeInit(t){for(const i of t){const r=i.instance;if(r.ngxsOnChanges){const a=g4(i,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});r.ngxsOnChanges(a)}r.ngxsOnInit&&r.ngxsOnInit(this.getStateContext(i)),i.isInitialised=!0}}invokeBootstrap(t){for(const i of t){const r=i.instance;r.ngxsAfterBootstrap&&r.ngxsAfterBootstrap(this.getStateContext(i))}}getStateContext(t){return this.stateContextFactory.createStateContext(t)}}return n.\u0275fac=function(t){return new(t||n)(De(Xg),De(zS),De(sR))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();let lh=(()=>{class n{constructor(t,i,r,s,o,a){this._stateStream=t,this._internalStateOperations=i,this._config=r,this._internalExecutionStrategy=s,this._stateFactory=o,this.initStateStream(a)}dispatch(t){return this._internalStateOperations.getRootStateOperations().dispatch(t)}select(t){const i=this.getStoreBoundSelectorFn(t);return this._stateStream.pipe(me(i),cc(r=>{const{suppressErrors:s}=this._config.selectorOptions;return r instanceof TypeError&&s?nn(void 0):yg(r)}),Qu(),BS(this._internalExecutionStrategy))}selectOnce(t){return this.select(t).pipe(zr(1))}selectSnapshot(t){return this.getStoreBoundSelectorFn(t)(this._stateStream.getValue())}subscribe(t){return this._stateStream.pipe(BS(this._internalExecutionStrategy)).subscribe(t)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(t){return this._internalStateOperations.getRootStateOperations().setState(t)}getStoreBoundSelectorFn(t){return function(n){const e=function(n){return n.NGXS_SELECTOR_META}(n)||Pv(n);return e&&e.makeRootSelector||(()=>n)}(t)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(t){const i=this._stateStream.value;if(!i||0===Object.keys(i).length){const o=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,t):t;this._stateStream.next(o)}}}return n.\u0275fac=function(t){return new(t||n)(De(US),De(Xg),De(Df),De(VS),De(Qg),De(oR,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),Nv=(()=>{class n{constructor(t,i){n.store=t,n.config=i}ngOnDestroy(){n.store=null,n.config=null}}return n.\u0275fac=function(t){return new(t||n)(De(lh),De(Df))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n.store=null,n.config=null,n})();class pve{static get type(){return"@@INIT"}}class gve{constructor(e){this.addedStates=e}static get type(){return"@@UPDATE_STATE"}}const $S=new ff(1);let _ve=(()=>{class n{constructor(t,i,r,s,o=[],a){!function(){try{const n=window.ng,t=!(n.probe&&n.coreTokens)&&ra();$S.next(t)}catch(n){$S.next(!1)}finally{$S.complete()}}();const l=t.addAndReturnDefaults(o);i.setStateToTheCurrentWithNew(l),t.connectActionHandlers(),a.ngxsBootstrap(new pve,l)}}return n.\u0275fac=function(t){return new(t||n)(De(Qg),De(Xg),De(lh),De(Nv),De(o4,8),De(gR))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({}),n})(),yve=(()=>{class n{constructor(t,i,r,s=[],o){const a=n.flattenStates(s),l=r.addAndReturnDefaults(a);l.states.length&&(i.setStateToTheCurrentWithNew(l),o.ngxsBootstrap(new gve(l.defaults),l))}static flattenStates(t=[]){return t.reduce((i,r)=>i.concat(r),[])}}return n.\u0275fac=function(t){return new(t||n)(De(lh),De(Xg),De(Qg),De(a4,8),De(gR))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({}),n})();class ua{static forRoot(e=[],t={}){return{ngModule:_ve,providers:[Qg,zS,ave,jS,sR,b4,v4,gR,_4,pR,Xg,VS,lh,US,Nv,fR,...e,...ua.ngxsTokenProviders(e,t)]}}static forFeature(e=[]){return{ngModule:yve,providers:[Qg,fR,...e,{provide:a4,multi:!0,useValue:e}]}}static ngxsTokenProviders(e,t){return[{provide:c4,useValue:Aye},{provide:u4,useValue:ra},{provide:h4,useClass:t.executionStrategy||s4},{provide:o4,useValue:e},{provide:ua.ROOT_OPTIONS,useValue:t},{provide:Df,useFactory:ua.ngxsConfigFactory,deps:[ua.ROOT_OPTIONS]},{provide:zw,useFactory:ua.appBootstrapListenerFactory,multi:!0,deps:[sR]},{provide:oR,useFactory:ua.getInitialState},{provide:t4,useExisting:zS},{provide:n4,useExisting:Qg}]}static ngxsConfigFactory(e){return cR(new Df,e)}static appBootstrapListenerFactory(e){return()=>e.bootstrap()}static getInitialState(){return Mye.pop()}}function bve(n){return i=>{!function(n){$S.subscribe(e=>{e&&(n.\u0275prov||console.warn(ka.UNDECORATED_STATE_IN_IVY(n.name)))})}(i);const r=i,s=function(n){if(!n.hasOwnProperty(Zu)){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,Zu,{value:e})}return Pv(n)}(r),o=Object.getPrototypeOf(r),a=function(i){return Object.assign({},i[d4]||{},n)}(o);(function(i){const{meta:r,inheritedStateClass:s,optionsWithInheritance:o}=i,{children:a,defaults:l,name:c}=o,u="string"==typeof c?c:c&&c.getName()||null;HS.checkCorrectStateName(u),s.hasOwnProperty(Zu)&&(r.actions=Object.assign({},r.actions,(s[Zu]||{}).actions)),r.children=a,r.defaults=l,r.name=u})({meta:s,inheritedStateClass:o,optionsWithInheritance:a}),r[d4]=a}}ua.\u0275fac=function(e){return new(e||ua)},ua.\u0275mod=ln({type:ua}),ua.\u0275inj=bt({}),ua.ROOT_OPTIONS=new zt("ROOT_OPTIONS");const Ba=new zt("NgValueAccessor"),iC=new Jl(vE);class Mbe{constructor(e,t){this.dueTime=e,this.scheduler=t}call(e,t){return t.subscribe(new Dbe(e,this.dueTime,this.scheduler))}}class Dbe extends y{constructor(e,t,i){super(e),this.dueTime=t,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Ibe,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function Ibe(n){n.debouncedNext()}class Obe{constructor(e){this.total=e}call(e,t){return t.subscribe(new Rbe(e,this.total))}}class Rbe extends y{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){++this.count>this.total&&this.destination.next(e)}}function qi(n){return null!=n&&"false"!=`${n}`}function Va(n,e=0){return function(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function ed(n){return n instanceof En?n.nativeElement:n}let UR;try{UR="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){UR=!1}let Hv,zR,Yi=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?df(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!UR)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(De(Vc))},n.\u0275prov=$e({factory:function(){return new n(De(Vc))},token:n,providedIn:"root"}),n})(),zv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({}),n})();function em(n){return function(){if(null==Hv&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Hv=!0}))}finally{Hv=Hv||!1}return Hv}()?n:!!n.capture}function Pf(n){return n.composedPath?n.composedPath()[0]:n.target}let HR=(()=>{class n{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({factory:function(){return new n},token:n,providedIn:"root"}),n})(),R8=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=ed(t);return new I(r=>{const o=this._observeElement(i).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new se,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(De(HR))},n.\u0275prov=$e({factory:function(){return new n(De(HR))},token:n,providedIn:"root"}),n})(),P8=(()=>{class n{constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new hn,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=qi(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=Va(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(function(n,e=iC){return t=>t.lift(new Mbe(n,e))}(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){var t;null===(t=this._currentSubscription)||void 0===t||t.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(Me(R8),Me(En),Me(vn))},n.\u0275dir=kt({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),GR=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:[HR]}),n})();function G8(n){return 0===n.offsetX&&0===n.offsetY}function $8(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}"undefined"!=typeof Element&&Element;const W8=new zt("cdk-input-modality-detector-options"),r0e={ignoreKeys:[18,17,224,91,16]},tm=em({passive:!0,capture:!0});let Y8=(()=>{class n{constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Pr(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=Pf(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(G8(o)?"keyboard":"mouse"),this._mostRecentTarget=Pf(o))},this._onTouchstart=o=>{$8(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Pf(o))},this._options=Object.assign(Object.assign({},r0e),s),this.modalityDetected=this._modality.pipe(function(n){return e=>e.lift(new Obe(n))}(1)),this.modalityChanged=this.modalityDetected.pipe(Qu()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,tm),r.addEventListener("mousedown",this._onMousedown,tm),r.addEventListener("touchstart",this._onTouchstart,tm)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){!this._platform.isBrowser||(document.removeEventListener("keydown",this._onKeydown,tm),document.removeEventListener("mousedown",this._onMousedown,tm),document.removeEventListener("touchstart",this._onTouchstart,tm))}}return n.\u0275fac=function(t){return new(t||n)(De(Yi),De(vn),De(dn),De(W8,8))},n.\u0275prov=$e({factory:function(){return new n(De(Yi),De(vn),De(dn),De(W8,8))},token:n,providedIn:"root"}),n})();const Q8=new zt("cdk-focus-monitor-default-options"),cC=em({passive:!0,capture:!0});let td=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new se,this._rootNodeFocusAndBlurListener=a=>{const l=Pf(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,i=!1){const r=ed(t);if(!this._platform.isBrowser||1!==r.nodeType)return nn(null);const s=function(n){if(function(){if(null==zR){const n="undefined"!=typeof document?document.head:null;zR=!(!n||!n.createShadowRoot&&!n.attachShadow)}return zR}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new se,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=ed(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=ed(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,i,r){r?t.classList.add(i):t.classList.remove(i)}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,i){this._toggleClass(t,"cdk-focused",!!i),this._toggleClass(t,"cdk-touch-focused","touch"===i),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===i),this._toggleClass(t,"cdk-mouse-focused","mouse"===i),this._toggleClass(t,"cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Pf(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r.subject,null))}_emitOrigin(t,i){this._ngZone.run(()=>t.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,cC),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,cC)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ls(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,cC),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,cC),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r.subject,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}}return n.\u0275fac=function(t){return new(t||n)(De(vn),De(Yi),De(Y8),De(dn,8),De(Q8,8))},n.\u0275prov=$e({factory:function(){return new n(De(vn),De(Yi),De(Y8),De(dn,8),De(Q8,8))},token:n,providedIn:"root"}),n})();const Z8="cdk-high-contrast-black-on-white",J8="cdk-high-contrast-white-on-black",WR="cdk-high-contrast-active";let e5=(()=>{class n{constructor(t,i){this._platform=t,this._document=i}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(WR),t.remove(Z8),t.remove(J8),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?(t.add(WR),t.add(Z8)):2===i&&(t.add(WR),t.add(J8))}}}return n.\u0275fac=function(t){return new(t||n)(De(Yi),De(dn))},n.\u0275prov=$e({factory:function(){return new n(De(Yi),De(dn))},token:n,providedIn:"root"}),n})(),$v=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({}),n})();const n5=new Ru("12.2.5");function s5(n){Promise.resolve(null).then(n)}class im{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){s5(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function a5(){return"undefined"!=typeof window&&void 0!==window.document}function YR(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}let ZR=(n,e)=>!1,JR=(n,e)=>!1,u5=(n,e,t)=>[];const d5=YR();(d5||"undefined"!=typeof Element)&&(ZR=a5()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),JR=(()=>{if(d5||Element.prototype.matches)return(n,e)=>n.matches(e);{const n=Element.prototype,e=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector;return e?(t,i)=>e.apply(t,[i]):JR}})(),u5=(n,e,t)=>{let i=[];if(t){const r=n.querySelectorAll(e);for(let s=0;s<r.length;s++)i.push(r[s])}else{const r=n.querySelector(e);r&&i.push(r)}return i});let Nf=null,h5=!1;function eP(n){Nf||(Nf=("undefined"!=typeof document?document.body:null)||{},h5=!!Nf.style&&"WebkitAppearance"in Nf.style);let e=!0;return Nf.style&&!function(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Nf.style,!e&&h5&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Nf.style)),e}const tP=JR,nP=ZR,iP=u5;let p5=(()=>{class n{validateStyleProperty(t){return eP(t)}matchesElement(t,i){return tP(t,i)}containsElement(t,i){return nP(t,i)}query(t,i,r){return iP(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new im(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class uC{}uC.NOOP=new p5;function y5(n,e,t){return t?e+":"+t+";":""}function v5(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=y5(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=y5(0,y0e(t),n.style[t]));n.setAttribute("style",e)}function su(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=lP(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),YR()&&v5(n))}function Lf(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=lP(t);n.style[i]=""}),YR()&&v5(n))}const _0e=/-+([a-z0-9])/g;function lP(n){return n.replace(_0e,(...e)=>e[1].toUpperCase())}function y0e(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class om{constructor(e,t,i){this._element=e,this._startStyles=t,this._endStyles=i,this._state=0;let r=om.initialStylesByElement.get(e);r||om.initialStylesByElement.set(e,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&su(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(su(this._element,this._initialStyles),this._endStyles&&(su(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(om.initialStylesByElement.delete(this._element),this._startStyles&&(Lf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Lf(this._element,this._endStyles),this._endStyles=null),su(this._element,this._initialStyles),this._state=3)}}om.initialStylesByElement=new WeakMap;const dc=new zt("AnimationModuleType"),i6=new Ru("12.2.5"),Vwe=new zt("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let Bf,gr=(()=>{class n{constructor(t,i,r){this._hasDoneGlobalChecks=!1,this._document=r,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=i,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getWindow(){const t=this._document.defaultView||window;return"object"==typeof t&&t?t:null}_checkIsEnabled(t){return!(!ra()||this._isTestEnv())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const i=getComputedStyle(t);i&&"none"!==i.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&i6.full!==n5.full&&console.warn("The Angular Material version ("+i6.full+") does not match the Angular CDK version ("+n5.full+").\nPlease ensure the versions of these two packages exactly match.")}}return n.\u0275fac=function(t){return new(t||n)(De(e5),De(Vwe,8),De(dn))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[$v],$v]}),n})();function DC(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=qi(e)}}}function Yv(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function SP(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=qi(e)}}}function CP(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?Va(t):this.defaultTabIndex}}}try{Bf="undefined"!=typeof Intl}catch(n){Bf=!1}class Zwe{constructor(e,t,i){this._renderer=e,this.element=t,this.config=i,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const o6={enterDuration:225,exitDuration:150},xP=em({passive:!0}),a6=["mousedown","touchstart"],l6=["mouseup","mouseleave","touchend","touchcancel"];class eEe{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=ed(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},o6),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u),function(n){window.getComputedStyle(n).getPropertyValue("opacity")}(u),u.style.transform="scale(1)";const h=new Zwe(this,u,i);return h.state=0,this._activeRipples.add(h),i.persistent||(this._mostRecentTransientRipple=h),this._runTimeoutOutsideZone(()=>{const p=h===this._mostRecentTransientRipple;h.state=1,!i.persistent&&(!p||!this._isPointerDown)&&h.fadeOut()},c),h}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const i=e.element,r=Object.assign(Object.assign({},o6),e.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,i.parentNode.removeChild(i)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=ed(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(a6))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(l6),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=G8(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!$8(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,xP)})})}_removeTriggerEvents(){this._triggerElement&&(a6.forEach(e=>{this._triggerElement.removeEventListener(e,this,xP)}),this._pointerUpEventsRegistered&&l6.forEach(e=>{this._triggerElement.removeEventListener(e,this,xP)}))}}const iEe=new zt("mat-ripple-global-options");let am=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new eEe(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return n.\u0275fac=function(t){return new(t||n)(Me(En),Me(vn),Me(Yi),Me(iEe,8),Me(dc,8))},n.\u0275dir=kt({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&Ti("mat-ripple-unbounded",i.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),n})(),OC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[gr,zv],gr]}),n})();function sd(n,e,t,i){return K(t)&&(i=t,t=void 0),i?sd(n,e,t).pipe(me(r=>k(r)?i(...r):i(r))):new I(r=>{f6(n,e,function(o){r.next(arguments.length>1?Array.prototype.slice.call(arguments):o)},r,t)})}function f6(n,e,t,i,r){let s;if(function(n){return n&&"function"==typeof n.addEventListener&&"function"==typeof n.removeEventListener}(n)){const o=n;n.addEventListener(e,t,r),s=()=>o.removeEventListener(e,t,r)}else if(function(n){return n&&"function"==typeof n.on&&"function"==typeof n.off}(n)){const o=n;n.on(e,t),s=()=>o.off(e,t)}else if(function(n){return n&&"function"==typeof n.addListener&&"function"==typeof n.removeListener}(n)){const o=n;n.addListener(e,t),s=()=>o.removeListener(e,t)}else{if(!n||!n.length)throw new TypeError("Invalid event target");for(let o=0,a=n.length;o<a;o++)f6(n[o],e,t,i,r)}i.add(s)}new class extends Jl{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends vE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(()=>e.flush(null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(cancelAnimationFrame(t),e.scheduled=void 0)}});let yEe=1;const vEe=Promise.resolve(),PC={};function p6(n){return n in PC&&(delete PC[n],!0)}const g6={setImmediate(n){const e=yEe++;return PC[e]=!0,vEe.then(()=>p6(e)&&n()),e},clearImmediate(n){p6(n)}};new class extends Jl{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,r=-1,s=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this.active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class extends vE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=g6.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(g6.clearImmediate(t),e.scheduled=void 0)}});function Xv(n){return!!n&&(n instanceof I||"function"==typeof n.lift&&"function"==typeof n.subscribe)}function FC(...n){return It(1)(nn(...n))}"undefined"!=typeof window&&window;class USe{constructor(e,t){this.delay=e,this.scheduler=t}call(e,t){return t.subscribe(new PP(e,this.delay,this.scheduler))}}class PP extends y{constructor(e,t,i){super(e),this.delay=t,this.scheduler=i,this.queue=[],this.active=!1,this.errored=!1}static dispatch(e){const t=e.source,i=t.queue,r=e.scheduler,s=e.destination;for(;i.length>0&&i[0].time-r.now()<=0;)i.shift().notification.observe(s);if(i.length>0){const o=Math.max(0,i[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1}_schedule(e){this.active=!0,this.destination.add(e.schedule(PP.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}scheduleNotification(e){if(!0===this.errored)return;const t=this.scheduler,i=new zSe(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}_next(e){this.scheduleNotification(oa.createNext(e))}_error(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}_complete(){this.scheduleNotification(oa.createComplete()),this.unsubscribe()}}class zSe{constructor(e,t){this.time=e,this.notification=t}}function K6(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return t=>me(function(n,e){return i=>{let r=i;for(let s=0;s<e;s++){const o=null!=r?r[n[s]]:void 0;if(void 0===o)return;r=o}return r}}(n,e))(t)}tt(266);class DCe{constructor(e){this.callback=e}call(e,t){return t.subscribe(new ICe(e,this.callback))}}class ICe extends y{constructor(e,t){super(e),this.add(new x(t))}}class nG{}class iG{}class ou{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof ou?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new ou;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof ou?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class OCe{encodeKey(e){return rG(e)}encodeValue(e){return rG(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const PCe=/%(\d[a-f0-9])/gi,NCe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function rG(n){return encodeURIComponent(n).replace(PCe,(e,t)=>{var i;return null!==(i=NCe[t])&&void 0!==i?i:e})}function sG(n){return`${n}`}class Nr{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new OCe,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Nr({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(sG(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(sG(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Ys{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}keys(){return this.map.keys()}}function oG(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function aG(n){return"undefined"!=typeof Blob&&n instanceof Blob}function lG(n){return"undefined"!=typeof FormData&&n instanceof FormData}class Zv{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new ou),this.context||(this.context=new Ys),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Nr,this.urlWithParams=t}serializeBody(){return null===this.body?null:oG(this.body)||aG(this.body)||lG(this.body)||function(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Nr?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||lG(this.body)?null:aG(this.body)?this.body.type||null:oG(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Nr?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const h=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((p,g)=>p.set(g,e.setHeaders[g]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((p,g)=>p.set(g,e.setParams[g]),u)),new Zv(i,r,o,{params:u,headers:c,context:h,reportProgress:l,responseType:s,withCredentials:a})}}var _s=(()=>((_s=_s||{})[_s.Sent=0]="Sent",_s[_s.UploadProgress=1]="UploadProgress",_s[_s.ResponseHeader=2]="ResponseHeader",_s[_s.DownloadProgress=3]="DownloadProgress",_s[_s.Response=4]="Response",_s[_s.User=5]="User",_s))();class FP{constructor(e,t=200,i="OK"){this.headers=e.headers||new ou,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class LP extends FP{constructor(e={}){super(e),this.type=_s.ResponseHeader}clone(e={}){return new LP({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class zC extends FP{constructor(e={}){super(e),this.type=_s.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new zC({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class cG extends FP{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function kP(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let od=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Zv)s=t;else{let l,c;l=r.headers instanceof ou?r.headers:new ou(r.headers),r.params&&(c=r.params instanceof Nr?r.params:new Nr({fromObject:r.params})),s=new Zv(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=nn(s).pipe(function(n,e){return V(n,e,1)}(l=>this.handler.handle(l)));if(t instanceof Zv||"events"===r.observe)return o;const a=o.pipe(Wi(l=>l instanceof zC));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(me(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(me(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(me(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Nr).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,kP(r,i))}post(t,i,r={}){return this.request("POST",t,kP(r,i))}put(t,i,r={}){return this.request("PUT",t,kP(r,i))}}return n.\u0275fac=function(t){return new(t||n)(De(nG))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class uG{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const dG=new zt("HTTP_INTERCEPTORS");let kCe=(()=>{class n{intercept(t,i){return i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const BCe=/^\)\]\}',?\n/;let hG=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new I(i=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((g,m)=>r.setRequestHeader(g,m.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const g=t.detectContentTypeHeader();null!==g&&r.setRequestHeader("Content-Type",g)}if(t.responseType){const g=t.responseType.toLowerCase();r.responseType="json"!==g?g:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const g=1223===r.status?204:r.status,m=r.statusText||"OK",E=new ou(r.getAllResponseHeaders()),C=function(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new LP({headers:E,status:g,statusText:m,url:C}),o},l=()=>{let{headers:g,status:m,statusText:E,url:C}=a(),R=null;204!==m&&(R=void 0===r.response?r.responseText:r.response),0===m&&(m=R?200:0);let z=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof R){const de=R;R=R.replace(BCe,"");try{R=""!==R?JSON.parse(R):null}catch(Ie){R=de,z&&(z=!1,R={error:Ie,text:R})}}z?(i.next(new zC({body:R,headers:g,status:m,statusText:E,url:C||void 0})),i.complete()):i.error(new cG({error:R,headers:g,status:m,statusText:E,url:C||void 0}))},c=g=>{const{url:m}=a(),E=new cG({error:g,status:r.status||0,statusText:r.statusText||"Unknown Error",url:m||void 0});i.error(E)};let u=!1;const h=g=>{u||(i.next(a()),u=!0);let m={type:_s.DownloadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),"text"===t.responseType&&!!r.responseText&&(m.partialText=r.responseText),i.next(m)},p=g=>{let m={type:_s.UploadProgress,loaded:g.loaded};g.lengthComputable&&(m.total=g.total),i.next(m)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",h),null!==s&&r.upload&&r.upload.addEventListener("progress",p)),r.send(s),i.next({type:_s.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",h),null!==s&&r.upload&&r.upload.removeEventListener("progress",p)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(De(k3))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const BP=new zt("XSRF_COOKIE_NAME"),VP=new zt("XSRF_HEADER_NAME");class fG{}let jCe=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=T3(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(De(dn),De(Vc),De(BP))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),jP=(()=>{class n{constructor(t,i){this.tokenService=t,this.headerName=i}intercept(t,i){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(De(fG),De(VP))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),UCe=(()=>{class n{constructor(t,i){this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=this.injector.get(dG,[]);this.chain=i.reduceRight((r,s)=>new uG(r,s),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(De(iG),De(jn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),zCe=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:jP,useClass:kCe}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:BP,useValue:t.cookieName}:[],t.headerName?{provide:VP,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:[jP,{provide:dG,useExisting:jP,multi:!0},{provide:fG,useClass:jCe},{provide:BP,useValue:"XSRF-TOKEN"},{provide:VP,useValue:"X-XSRF-TOKEN"}]}),n})(),pG=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:[od,{provide:nG,useClass:UCe},hG,{provide:iG,useExisting:hG}],imports:[[zCe.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),n})();function tb(n){return!0===n}function za(n){return null==n}function Ha(n){return!za(n)}function XP(n){return Boolean(n)}function UG(n){return za(n)?n:JSON.parse(JSON.stringify(n))}tt(478),Object.create(Error.prototype),new zt("SECURITY_CONTEXT");const ZC=n=>{const t=n instanceof Date;if("object"!=typeof n||null===n||t)return n;Object.freeze(n);const r="function"==typeof n,s=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(n).forEach(o=>{s.call(n,o)&&(!r||"caller"!==o&&"callee"!==o&&"arguments"!==o)&&null!==n[o]&&("object"==typeof n[o]||"function"==typeof n[o])&&!Object.isFrozen(n[o])&&ZC(n[o])}),n};function zG(n){return Ha(n)&&"object"==typeof n&&function(n){return"[object Object]"===Object.prototype.toString.call(n)}(n)}const $G="NGXS_DATA_META",ZP="NGXS_META",WG="NGXS_ARGUMENT_REGISTRY_META";let qG=(()=>{class n{constructor(t){this.sequence$=new Pr(0),this.subscription=null,t&&(this.subscription=t.subscribe(()=>this.updateSequence()))}get sequenceValue(){return this.sequence$.getValue()}ngOnDestroy(){var t;this.sequence$.next(0),null===(t=this.subscription)||void 0===t||t.unsubscribe()}updateSequence(){this.sequence$.next(this.sequenceValue+1)}}return n.\u0275fac=function(t){return new(t||n)(De(lh,8))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();function nb(n){return n[$G]}let Ga=(()=>{class n{constructor(t,i,r){n.store=t.get(lh),n.ngZone=t.get(vn),n.factory=i,n.context=r,n.computed=t.get(qG)}}return n.store=null,n.computed=null,n.context=null,n.factory=null,n.ngZone=null,n.\u0275fac=function(t){return new(t||n)(De(jn),De(n4),De(t4))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();class us{constructor(){us.statesCachedMeta.clear()}static createStateContext(e){return Ga.context.createStateContext(e)}static ensureMappedState(e){if(za(Ga.factory)||za(e))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return(Ha(e.name)?us.statesCachedMeta.get(e.name):null)||us.ensureMeta(e)}static getRepositoryByInstance(e){var t;const r=null!==(t=nb(us.getStateClassByInstance(e)))&&void 0!==t?t:null;if(za(r))throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return r}static getStateClassByInstance(e){return(null!=e?e:{}).constructor}static clearMetaByInstance(e){const t=us.getRepositoryByInstance(e);t.stateMeta.actions={},t.operations={}}static createPayload(e,t){const i={},r=Array.from(e);for(let s=0;s<r.length;s++){const o=null==t?void 0:t.getPayloadTypeByIndex(s);Ha(o)&&(i[o]=r[s])}return Object.keys(i).length>0?i:null}static createAction(e,t,i){const r=us.createPayload(t,i);return new(function(n){return class{constructor(t){t&&Object.keys(t).forEach(i=>{this[i]=t[i]})}static get type(){return n}}}(e.type))(r)}static ensureMeta(e){var t;const i=Ha(e.name)?null===(t=Ga.factory.states)||void 0===t?void 0:t.find(r=>r.name===e.name):null;return Ha(i)&&Ha(e.name)&&us.statesCachedMeta.set(e.name,i),i}}us.statesCachedMeta=new Map,us.\u0275fac=function(e){return new(e||us)},us.\u0275prov=$e({token:us,factory:us.\u0275fac}),new ff(1);class B1e extends Error{constructor(e){super(`Child states can only be added to an object. Cannot convert ${Ha(null==e?void 0:e.constructor)?e.constructor.name:e} to PlainObject`)}}function YG(n){var e;return null!==(e=n.NGXS_OPTIONS_META)&&void 0!==e?e:{name:""}}function KG(n){var e;const t=YG(n),i=null!==(e=t.children)&&void 0!==e?e:[],s=UG(void 0===t.defaults?{}:t.defaults);if(i.length){if(zG(s))return function(n,e){return e.reduce((t,i)=>{const r=YG(i);if(function(n){const e="string"==typeof n?n.trim():n;return[void 0,null,NaN,"",1/0].includes(e)}(r.name))throw new Error("State name not provided in class");return t[r.name.toString()]=KG(i),t},null!=n?n:{})}(s,i);throw new B1e(s)}return s}function QG(n){var e;return null!==(e=n.__NGXS_COMPUTED_OPTION__)&&void 0!==e?e:null}function ZG(){var n,e;return null!==(e=null===(n=null==Ga?void 0:Ga.computed)||void 0===n?void 0:n.sequenceValue)&&void 0!==e?e:0}function z1e(n){let e=!1;return Xv(n)&&(e=!0),e}function JP(n){return n[WG]}class H1e extends Error{constructor(e,t){super(`An argument with the name '${e}' already exists in the method '${t}'`)}}class G1e{constructor(){this.payloadMap=new Map,this.argumentMap=new Map}getPayloadTypeByIndex(e){var t;return null!==(t=this.payloadMap.get(e))&&void 0!==t?t:null}getArgumentNameByIndex(e){var t;return null!==(t=this.argumentMap.get(e))&&void 0!==t?t:null}createPayloadType(e,t,i){this.checkDuplicateName(e,t),this.payloadMap.set(i,e),this.payloadMap.set(e,e)}createArgumentName(e,t,i){this.checkDuplicateName(e,t),this.argumentMap.set(i,e),this.argumentMap.set(e,e)}checkDuplicateName(e,t){if(XP(this.argumentMap.has(e))||XP(this.payloadMap.has(e)))throw new H1e(e,t)}}function X1e(n){return{enumerable:!0,configurable:!0,get(){const e=nb(n),t=us.ensureMappedState(e.stateMeta);return us.createStateContext(t)}}}function JG(){return(n,e,t)=>{!function(n,e){if(!function(n,e){var t;let i=n,r=!1;if(zG(i))for(;null!==i;){if(tb(null==i?void 0:i.hasOwnProperty(e))){r=!!(null===(t=Object.getOwnPropertyDescriptor(i,e))||void 0===t?void 0:t.get);break}i=Object.getPrototypeOf(i)}return r}(n,null==e?void 0:e.toString()))throw new Error(`The method must be a getter for the computed decorator to work properly.\nExample: \n@Computed() get ${e.toString()}() { \n\t .. \n}`)}(n,e);const i=t.get;return t.get=function(...r){const s=function(n){return za(QG(n))&&Object.defineProperties(n,{__NGXS_COMPUTED_OPTION__:{enumerable:!0,configurable:!0,value:new WeakMap}}),QG(n)}(this),o=null==s?void 0:s.get(i);if(tb(null==o?void 0:o.isObservable))return null==o?void 0:o.value;if(za(o)||o.sequenceId!==ZG()){s.delete(i);const l=i.apply(this,r);return s.set(i,{value:l,sequenceId:ZG(),isObservable:z1e(l)}),l}return o.value},t}}const nTe={cancelUncompleted:!0,insideZone:!1};function eN(n=nTe){return(e,t,i)=>{!function(n,e){if(n.hasOwnProperty("prototype"))throw new Error("Cannot support static methods with @DataAction()");if(void 0===e)throw new Error("@DataAction() can only decorate a method implementation")}(e,i);const r=i.value,s=t.toString();return i.value=function(...o){const a=this;let l=null;const c=us.getRepositoryByInstance(a),u=c.operations;let h=u[s];const p=c.stateMeta,g=JP(r);if(za(h)){const z=function(n){var e,t,i;return null!==(i=null===(t=null===(e=(n+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1))||void 0===e?void 0:e[0])||void 0===t?void 0:t.replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean))&&void 0!==i?i:[]}(r),de=function(n){const{statePath:e,argumentsNames:t,methodName:i,argumentRegistry:r}=n;let s="";for(let o=0;o<t.length;o++)Ha(null==r?void 0:r.getArgumentNameByIndex(o))?s+=null==r?void 0:r.getArgumentNameByIndex(o):Ha(null==r?void 0:r.getPayloadTypeByIndex(o))?s+=null==r?void 0:r.getPayloadTypeByIndex(o):s+=`$arg${o}`,o!==t.length-1&&(s+=", ");return`@${e.replace(/\./g,"/")}.${i}(${s})`}({statePath:p.path,methodName:s,argumentsNames:z,argumentRegistry:g});h=u[s]={type:de,options:{cancelUncompleted:n.cancelUncompleted}},p.actions[h.type]=[{type:h.type,options:h.options,fn:h.type}]}us.ensureMappedState(p).instance[h.type]=()=>{var z;return tb(n.insideZone)?null===(z=Ga.ngZone)||void 0===z||z.run(()=>{l=r.apply(a,o)}):l=r.apply(a,o),Xv(l)?nn(null).pipe(me(()=>l)):l};const C=us.createAction(h,o,g),R=Ga.store.dispatch(C);return Xv(l)?function(n,e){return Rv([n,e]).pipe(me(t=>t.pop()))}(R,l):l},i}}function e$(n){return(e,t,i)=>{const r=n.trim();if(!r)throw new Error("Payload name should be initialized");(function(n,e){const t=n[e];return za(JP(t))&&Object.defineProperties(t,{[WG]:{enumerable:!0,configurable:!0,value:new G1e}}),JP(t)})(e,t).createPayloadType(r,t,i)}}function rTe(){return n=>{const e=function(n){if(function(n){return!XP(n)}(n.hasOwnProperty(ZP))){const e={name:null,actions:{},defaults:{},path:null,makeRootSelector:t=>t.getStateGetter(e.name),children:[]};Object.defineProperty(n,ZP,{value:e})}return function(n){var e;return null===(e=n)||void 0===e?void 0:e[ZP]}(n)}(n);if(za(e.name))throw new Error("@StateRepository should be add before decorator @State");!function(n,e){(function(n){var e;const t=null!==(e=nb(n))&&void 0!==e?e:null;return(za(t)||(null==t?void 0:t.stateClass)!==n)&&function(n){Object.defineProperty(n,$G,{writable:!0,configurable:!0,enumerable:!0,value:{stateMeta:null,operations:{},stateClass:n}})}(n),nb(n)}(n)).stateMeta=e}(n,e),function(n,e,t){Object.defineProperties(n.prototype,{name:{enumerable:!0,configurable:!0,value:e.name},initialState:{enumerable:!0,configurable:!0,get:()=>UG(t)},context:X1e(n)})}(n,e,KG(n)),function(n){var e,t;const i=nb(n),r=null!==(t=null===(e=null==i?void 0:i.stateMeta)||void 0===e?void 0:e.name)&&void 0!==t?t:null;if(Ha(r)){const s=`__${r}__selector`;Object.defineProperties(n.prototype,{[s]:{writable:!0,enumerable:!1,configurable:!0},state$:{enumerable:!0,configurable:!0,get(){if(Ha(this[s]))return this[s];if(za(Ga.store))throw new Error("Metadata not created \n Maybe you forgot to import the NgxsDataPluginModule\n Also, you cannot use this.ctx.* until the application is fully rendered \n (use by default ngxsOnInit(ctx: StateContext), or ngxsAfterBootstrap(ctx: StateContext) !!!");return this[s]=Ga.store.select(n).pipe(me(o=>ra()?ZC(o):o),La({refCount:!0,bufferSize:1})),this[s]}}})}}(n)}}let oTe=(()=>{class n{constructor(){this.browserStorageEvents$=new se,this.isInitialised=!1,this.isBootstrapped=!1,this._dirty=!0}get dirty(){return this._dirty}set dirty(t){this._dirty=t}ngxsOnChanges(t){var r;this.dirty&&this.isBootstrapped&&(this.dirty=!1,null===(r=this.ngxsDataDoCheck)||void 0===r||r.call(this))}ngxsOnInit(){this.isInitialised=!0}ngxsAfterBootstrap(){var i;this.isBootstrapped=!0,this.dirty&&(this.dirty=!1,null===(i=this.ngxsDataDoCheck)||void 0===i||i.call(this))}markAsDirtyAfterReset(){var i;this.dirty=!0,null===(i=this.ngxsDataAfterReset)||void 0===i||i.call(this)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),aTe=(()=>{class n extends oTe{get snapshot(){return function(n){return ra()?ZC(n):n}(this.getState())}get ctx(){return function(n){if(!n)throw new Error("You forgot add decorator @StateRepository or initialize state!\nExample: NgxsModule.forRoot([ .. ]), or NgxsModule.forFeature([ .. ])");return Object.assign(Object.assign({},n),{getState:()=>ra()?ZC(n.getState()):n.getState(),setState(e){n.setState(e)},patchState(e){n.patchState(e)}})}(this.context)}getState(){return this.ctx.getState()}dispatch(t){return this.ctx.dispatch(t)}patchState(t){this.ctx.patchState(t)}setState(t){this.ctx.setState(t)}reset(){this.ctx.setState(this.initialState),this.markAsDirtyAfterReset()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Gi(n)))(i||n)}}(),n.\u0275prov=$e({token:n,factory:n.\u0275fac}),Or([JG(),ec("design:type",Object),ec("design:paramtypes",[])],n.prototype,"snapshot",null),Or([eN(),Z3(0,e$("patchValue")),ec("design:type",Function),ec("design:paramtypes",[Object]),ec("design:returntype",void 0)],n.prototype,"patchState",null),Or([eN(),Z3(0,e$("stateValue")),ec("design:type",Function),ec("design:paramtypes",[Object]),ec("design:returntype",void 0)],n.prototype,"setState",null),Or([eN(),ec("design:type",Function),ec("design:paramtypes",[]),ec("design:returntype",void 0)],n.prototype,"reset",null),n})(),lW=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=kt({type:n,selectors:[["","gaEvent","","gaCategory",""],["","gaCategory",""]],inputs:{gaCategory:"gaCategory"},exportAs:["gaCategory"]}),n})();const ym=new zt("ngx-google-analytics-settings",{factory:()=>({trackingCode:"",enableTracing:!1})}),CN=new zt("ngx-window",{providedIn:"root",factory:()=>function(n){return df(n)?window:null}(Ac(Vc))}),MMe=new zt("ngx-data-layer",{providedIn:"root",factory:()=>function(n){return n?n.dataLayer=n.dataLayer||[]:null}(Ac(CN))}),xN=new zt("ngx-gtag-fn",{providedIn:"root",factory:()=>function(n,e){return n?n.gtag=n.gtag||function(){e.push(arguments)}:null}(Ac(CN),Ac(MMe))});let mx=(()=>{class n{constructor(t,i,r){this.settings=t,this._document=i,this._gtag=r}get document(){return this._document}throw(t){(this.settings.enableTracing||ra())&&console&&console.error&&console.error(t)}toKeyValue(t){return t.size>0?Array.from(t).reduce((i,[r,s])=>Object.defineProperty(i,r,{value:s,enumerable:!0}),{}):void 0}gtag(...t){try{this._gtag(...t.filter(i=>void 0!==i))}catch(i){this.throw(i)}}event(t,i,r,s,o){try{const a=new Map;i&&a.set("event_category",i),r&&a.set("event_label",r),s&&a.set("value",s),void 0!==o&&a.set("interaction",o);const l=this.toKeyValue(a);l?this.gtag("event",t,l):this.gtag("event",t)}catch(a){this.throw(a)}}pageView(t,i,r,s){try{const o=new Map([["page_path",t]]);i&&o.set("page_title",i),(r||this.document)&&o.set("page_location",r||this.document.location.href),s&&Object.entries(s).map(([a,l])=>o.set(a,l)),this.gtag("config",this.settings.trackingCode,this.toKeyValue(o))}catch(o){this.throw(o)}}appView(t,i,r,s,o){try{const a=new Map([["screen_name",t],["app_name",i]]);r&&a.set("app_id",r),s&&a.set("app_version",s),o&&a.set("app_installer_id",o),this.gtag("event","screen_view",this.toKeyValue(a))}catch(a){this.throw(a)}}set(...t){try{this._gtag("set",...t)}catch(i){this.throw(i)}}exception(t,i){try{const r=new Map;t&&r.set("description",t),i&&r.set("fatal",i),this.toKeyValue(r)?this.gtag("event","exception",this.toKeyValue(r)):this.gtag("event","exception")}catch(r){this.throw(r)}}}return n.\u0275fac=function(t){return new(t||n)(De(ym),De(dn),De(xN))},n.\u0275prov=$e({factory:function(){return new n(De(ym),De(dn),De(xN))},token:n,providedIn:"root"}),n})(),cW=(()=>{class n{constructor(t,i,r,s){this.gaCategoryDirective=t,this.gaService=i,this.settings=r,this.el=s,this.gaBind="click"}set gaBind(t){this.bindSubscription&&this.bindSubscription.unsubscribe(),this._gaBind=t,this.bindSubscription=sd(this.el.nativeElement,t).subscribe(()=>this.trigger())}get gaBind(){return this._gaBind}ngOnDestroy(){this.bindSubscription&&this.bindSubscription.unsubscribe()}trigger(){try{if(!this.gaAction&&!this.gaEvent)throw new Error("You must provide a gaAction attribute to identify this event.");this.gaService.event(this.gaAction||this.gaEvent,this.gaCategoryDirective?this.gaCategoryDirective.gaCategory:void 0,this.gaLabel||this.label,this.gaValue,this.gaInteraction)}catch(t){this.throw(t)}}throw(t){(ra()||this.settings.enableTracing)&&console&&console.warn&&console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)(Me(lW,8),Me(mx),Me(ym),Me(En))},n.\u0275dir=kt({type:n,selectors:[["","gaEvent",""]],inputs:{gaBind:"gaBind",gaAction:"gaAction",gaLabel:"gaLabel",label:"label",gaValue:"gaValue",gaInteraction:"gaInteraction",gaEvent:"gaEvent"},exportAs:["gaEvent"]}),n})();const IMe={provide:of,multi:!0,useFactory:function(n,e,t){return()=>Ri(this,void 0,void 0,function*(){var i;if(!n.trackingCode)return void(ra()||console.error("Empty tracking code for Google Analytics. Make sure to provide one when initializing NgxGoogleAnalyticsModule."));if(!e)return void(ra()||console.error("Was not possible create or read gtag() fn. Make sure this module is running on a Browser w/ access to Window interface."));t||ra()||console.error("Was not possible to access Document interface. Make sure this module is running on a Browser w/ access do Document interface."),n.uri=n.uri||`https://www.googletagmanager.com/gtag/js?id=${n.trackingCode}`,n.initCommands=null!==(i=null==n?void 0:n.initCommands)&&void 0!==i?i:[],n.initCommands.find(o=>"config"===o.command)||n.initCommands.unshift({command:"config",values:[n.trackingCode]}),n.initCommands.find(o=>"js"===o.command)||n.initCommands.unshift({command:"js",values:[new Date]});for(const o of n.initCommands)e(o.command,...o.values);const r=t.createElement("script");r.async=!0,r.src=n.uri,n.nonce&&r.setAttribute("nonce",n.nonce),t.getElementsByTagName("head")[0].appendChild(r)})},deps:[ym,xN,dn]};new zt("ngx-google-analytics-routing-settings",{factory:()=>({})});let _x=(()=>{class n{static forRoot(t,i=[],r,s,o){return{ngModule:n,providers:[{provide:ym,useValue:{trackingCode:t,initCommands:i,uri:r,enableTracing:s,nonce:o}},IMe]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[]]}),n})(),yx=(()=>{class n{constructor(){this.consent="not-set",this.consentChange=new ff(1),this.consentChange.next(this.consent)}ngOnDestroy(){this.consentChange.complete()}setConsent(t){this.consent!==t&&(this.consent=t,this.consentChange.next(t))}unsetConsent(){this.setConsent("not-set")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),NMe=(()=>{class n{constructor(t,i,{trackingCode:r}){this.window=i,this.subscriptions=new x,this.token=r,this.subscriptions.add(t.consentChange.subscribe(s=>this.toggleGoogleAnalytics("rescinded"===s)))}ngOnDestroy(){this.subscriptions.unsubscribe()}toggleGoogleAnalytics(t){this.window&&(this.window[`ga-disable-${this.token}`]=t)}}return n.\u0275fac=function(t){return new(t||n)(De(yx),De(CN),De(ym))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const FMe=new zt("Key under which consent is stored",{providedIn:"root",factory:()=>"ALLOW_TELEMETRY"}),hW=[yx,NMe,(()=>{class n{constructor(t,i){this.key=i,this.subscriptions=new x;try{this.storage=localStorage}catch(r){}t.setConsent(this.loadConsent()),this.subscriptions.add(t.consentChange.subscribe(r=>this.saveConsent(r)))}ngOnDestroy(){this.subscriptions.unsubscribe()}loadConsent(){var t,i;const r=null===(i=null===(t=this.storage)||void 0===t?void 0:t.getItem)||void 0===i?void 0:i.call(t,this.key);if(null==r)return"not-set";const s=r.trim().toLowerCase();switch(s){case"given":case"rescinded":return s;default:return"not-set"}}saveConsent(t){var i,r;null===(r=null===(i=this.storage)||void 0===i?void 0:i.setItem)||void 0===r||r.call(i,this.key,t)}}return n.\u0275fac=function(t){return new(t||n)(De(yx),De(FMe))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})()];function kMe(n){return Object.entries(n).reduce((e,[t,i])=>(null!=i&&(e[t]=`${i}`),e),{})}let VMe=(()=>{class n{static forRoot(t){const{providers:i=[]}=_x.forRoot(t.gaToken,function(n){const{appName:e,projectName:t,developmentMode:i}=n;return[{command:"set",values:[kMe({appName:e,projectName:t,developmentMode:i})]}]}(t));return{ngModule:n,providers:i}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:[...hW,{provide:of,multi:!0,useFactory:()=>()=>{},deps:hW}],imports:[[_x]]}),n})();const HMe=(n,e)=>JSON.stringify(n)===JSON.stringify(e),GMe=n=>n.map(e=>void 0!==e?JSON.parse(JSON.stringify(e)):e),fc={storageStrategy:class extends class{}{constructor(){super(...arguments),this.cachePairs=[]}add(e,t,i){this.cachePairs.push(e)}addMany(e){this.cachePairs=e}updateAtIndex(e,t){Object.assign(this.cachePairs[e],t)}update(e,t){Object.assign(this.cachePairs[e],t)}getAll(){return this.cachePairs}removeAtIndex(e){this.cachePairs.splice(e,1)}remove(e){this.cachePairs.splice(e,1)}removeAll(){this.cachePairs.length=0}},globalCacheKey:"CACHE_STORAGE",promiseImplementation:Promise},$Me=new se;function pc(n={}){return function(e,t,i){const r=n.cacheKey||e.constructor.name+"#"+t,s=i.value;if(i&&i.value){let o=n.storageStrategy?new n.storageStrategy:new fc.storageStrategy;const a=[];n.cacheModifier&&n.cacheModifier.subscribe(u=>o.addMany(u(o.getAll(r,this)),r,this)),Rn($Me.asObservable(),n.cacheBusterObserver?n.cacheBusterObserver:Hy()).subscribe(u=>{o.removeAll(r,this),a.length=0}),n.cacheResolver=n.cacheResolver||fc.cacheResolver||HMe,n.cacheHasher=n.cacheHasher||fc.cacheHasher||GMe,i.value=function(...u){const h=o.getAll(r,this);let p=n.cacheHasher(u),g=h.find(E=>n.cacheResolver(E.parameters,p));const m=a.find(E=>n.cacheResolver(E.parameters,p));if((n.maxAge||fc.maxAge)&&g&&g.created&&((new Date).getTime()-new Date(g.created).getTime()>(n.maxAge||fc.maxAge)?(o.remove?o.remove(h.indexOf(g),g,r,this):o.removeAtIndex(h.indexOf(g),r,this),g=null):(n.slidingExpiration||fc.slidingExpiration)&&(g.created=new Date,o.update?o.update(h.indexOf(g),g,r,this):o.updateAtIndex(h.indexOf(g),g,r,this))),g){const E=nn(g.response);return n.async?E.pipe(function(n,e=iC){const i=function(n){return n instanceof Date&&!isNaN(+n)}(n)?+n-e.now():Math.abs(n);return r=>r.lift(new USe(i,e))}(0)):E}if(m)return m.response;{const E=s.call(this,...u).pipe(function(n){return e=>e.lift(new DCe(n))}(()=>{const C=a.find(R=>n.cacheResolver(R.parameters,p));a.splice(a.indexOf(C),1)}),ur(C=>{(!n.shouldCacheDecider||n.shouldCacheDecider(C))&&((!(n.maxCacheCount||fc.maxCacheCount)||1===(n.maxCacheCount||fc.maxCacheCount)||(n.maxCacheCount||fc.maxCacheCount)&&(n.maxCacheCount||fc.maxCacheCount)<h.length+1)&&(o.remove?o.remove(0,h[0],r,this):o.removeAtIndex(0,r,this)),o.add({parameters:p,response:C,created:n.maxAge||fc.maxAge?new Date:null},r,this))}),function(n,e,t,i){const s=new ff(1,void 0,i);return o=>fa(()=>s,undefined)(o)}(),Hn());return a.push({parameters:p,response:E,created:new Date}),E}}}return i}}class WMe{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const fW=new zt("basePath");class hb{constructor(e={}){this.apiKeys=e.apiKeys,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.withCredentials=e.withCredentials,this.encoder=e.encoder,this.credentials=e.credentials?e.credentials:{}}selectHeaderContentType(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}selectHeaderAccept(e){if(0===e.length)return;const t=e.find(i=>this.isJsonMime(i));return void 0===t?e[0]:t}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==e&&(t.test(e)||"application/json-patch+json"===e.toLowerCase())}lookupCredential(e){const t=this.credentials[e];return"function"==typeof t?t():t}}let pW=(()=>{class n{constructor(t,i,r){this.httpClient=t,this.basePath="/v1",this.defaultHeaders=new ou,this.configuration=new hb,r&&(this.configuration=r),"string"!=typeof this.configuration.basePath&&("string"!=typeof i&&(i=this.basePath),this.configuration.basePath=i),this.encoder=this.configuration.encoder||new WMe}addToHttpParams(t,i,r){return this.addToHttpParamsRecursive(t,i,r)}addToHttpParamsRecursive(t,i,r){if(null==i)return t;if("object"==typeof i)if(Array.isArray(i))i.forEach(s=>t=this.addToHttpParamsRecursive(t,s,r));else if(i instanceof Date){if(null==r)throw Error("key may not be null if value is Date");t=t.append(r,i.toISOString().substr(0,10))}else Object.keys(i).forEach(s=>t=this.addToHttpParamsRecursive(t,i[s],null!=r?`${r}.${s}`:s));else{if(null==r)throw Error("key may not be null if value is not object or array");t=t.append(r,i)}return t}aggregateResults(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,E=t.technologies,C=t.token;let R=new Nr({encoder:this.encoder});null!=o&&(R=this.addToHttpParams(R,o,"age")),null!=a&&(R=this.addToHttpParams(R,a,"age-range")),null!=l&&(R=this.addToHttpParams(R,l,"bmi")),null!=c&&(R=this.addToHttpParams(R,c,"bmi-range")),null!=u&&(R=this.addToHttpParams(R,u,"cache")),h&&h.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"ontology-terms")}),p&&p.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"cell-type-terms")}),g&&g.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"providers")}),null!=m&&(R=this.addToHttpParams(R,m,"sex")),E&&E.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"technologies")}),null!=C&&(R=this.addToHttpParams(R,C,"token"));let z=this.defaultHeaders,de=s&&s.httpHeaderAccept;void 0===de&&(de=this.configuration.selectHeaderAccept(["application/json"])),void 0!==de&&(z=z.set("Accept",de));let Ie=s&&s.context;void 0===Ie&&(Ie=new Ys);let Be="json";return de&&(Be=de.startsWith("text")?"text":this.configuration.isJsonMime(de)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/aggregate-results`,{context:Ie,params:R,responseType:Be,withCredentials:this.configuration.withCredentials,headers:z,observe:i,reportProgress:r})}cellTypeTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,E=t.technologies,C=t.token;let R=new Nr({encoder:this.encoder});null!=o&&(R=this.addToHttpParams(R,o,"age")),null!=a&&(R=this.addToHttpParams(R,a,"age-range")),null!=l&&(R=this.addToHttpParams(R,l,"bmi")),null!=c&&(R=this.addToHttpParams(R,c,"bmi-range")),null!=u&&(R=this.addToHttpParams(R,u,"cache")),h&&h.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"ontology-terms")}),p&&p.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"cell-type-terms")}),g&&g.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"providers")}),null!=m&&(R=this.addToHttpParams(R,m,"sex")),E&&E.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"technologies")}),null!=C&&(R=this.addToHttpParams(R,C,"token"));let z=this.defaultHeaders,de=s&&s.httpHeaderAccept;void 0===de&&(de=this.configuration.selectHeaderAccept(["application/json"])),void 0!==de&&(z=z.set("Accept",de));let Ie=s&&s.context;void 0===Ie&&(Ie=new Ys);let Be="json";return de&&(Be=de.startsWith("text")?"text":this.configuration.isJsonMime(de)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/cell-type-term-occurences`,{context:Ie,params:R,responseType:Be,withCredentials:this.configuration.withCredentials,headers:z,observe:i,reportProgress:r})}cellTypeTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Nr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/cell-type-tree-model`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}dbStatus(t,i="body",r=!1,s){const o=t.token;let a=new Nr({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"token"));let l=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(l=l.set("Accept",c));let u=s&&s.context;void 0===u&&(u=new Ys);let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/db-status`,{context:u,params:a,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}getSpatialPlacement(t,i="body",r=!1,s){const o=t.getSpatialPlacementRequest;if(null==o)throw new Error("Required parameter getSpatialPlacementRequest was null or undefined when calling getSpatialPlacement.");let a=this.defaultHeaders,l=s&&s.httpHeaderAccept;void 0===l&&(l=this.configuration.selectHeaderAccept(["application/json"])),void 0!==l&&(a=a.set("Accept",l));let c=s&&s.context;void 0===c&&(c=new Ys);const h=this.configuration.selectHeaderContentType(["application/json"]);void 0!==h&&(a=a.set("Content-Type",h));let p="json";return l&&(p=l.startsWith("text")?"text":this.configuration.isJsonMime(l)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/get-spatial-placement`,o,{context:c,responseType:p,withCredentials:this.configuration.withCredentials,headers:a,observe:i,reportProgress:r})}gtexRuiLocations(t,i="body",r=!1,s){const o=t.cache;let a=new Nr({encoder:this.encoder});null!=o&&(a=this.addToHttpParams(a,o,"cache"));let l=this.defaultHeaders,c=s&&s.httpHeaderAccept;void 0===c&&(c=this.configuration.selectHeaderAccept(["application/json"])),void 0!==c&&(l=l.set("Accept",c));let u=s&&s.context;void 0===u&&(u=new Ys);let h="json";return c&&(h=c.startsWith("text")?"text":this.configuration.isJsonMime(c)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/gtex/rui_locations.jsonld`,{context:u,params:a,responseType:h,withCredentials:this.configuration.withCredentials,headers:l,observe:i,reportProgress:r})}hubmapRuiLocations(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Nr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/hubmap/rui_locations.jsonld`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}ontologyTermOccurences(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,E=t.technologies,C=t.token;let R=new Nr({encoder:this.encoder});null!=o&&(R=this.addToHttpParams(R,o,"age")),null!=a&&(R=this.addToHttpParams(R,a,"age-range")),null!=l&&(R=this.addToHttpParams(R,l,"bmi")),null!=c&&(R=this.addToHttpParams(R,c,"bmi-range")),null!=u&&(R=this.addToHttpParams(R,u,"cache")),h&&h.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"ontology-terms")}),p&&p.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"cell-type-terms")}),g&&g.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"providers")}),null!=m&&(R=this.addToHttpParams(R,m,"sex")),E&&E.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"technologies")}),null!=C&&(R=this.addToHttpParams(R,C,"token"));let z=this.defaultHeaders,de=s&&s.httpHeaderAccept;void 0===de&&(de=this.configuration.selectHeaderAccept(["application/json"])),void 0!==de&&(z=z.set("Accept",de));let Ie=s&&s.context;void 0===Ie&&(Ie=new Ys);let Be="json";return de&&(Be=de.startsWith("text")?"text":this.configuration.isJsonMime(de)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/ontology-term-occurences`,{context:Ie,params:R,responseType:Be,withCredentials:this.configuration.withCredentials,headers:z,observe:i,reportProgress:r})}ontologyTreeModel(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Nr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/ontology-tree-model`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}providerNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Nr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/provider-names`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}referenceOrganScene(t,i="body",r=!1,s){const o=t.organIri;if(null==o)throw new Error("Required parameter organIri was null or undefined when calling referenceOrganScene.");const a=t.age,l=t.ageRange,c=t.bmi,u=t.bmiRange,h=t.cache,p=t.ontologyTerms,g=t.cellTypeTerms,m=t.providers,E=t.sex,C=t.technologies,R=t.token;let z=new Nr({encoder:this.encoder});null!=a&&(z=this.addToHttpParams(z,a,"age")),null!=l&&(z=this.addToHttpParams(z,l,"age-range")),null!=c&&(z=this.addToHttpParams(z,c,"bmi")),null!=u&&(z=this.addToHttpParams(z,u,"bmi-range")),null!=h&&(z=this.addToHttpParams(z,h,"cache")),p&&p.forEach(ct=>{z=this.addToHttpParams(z,ct,"ontology-terms")}),g&&g.forEach(ct=>{z=this.addToHttpParams(z,ct,"cell-type-terms")}),null!=o&&(z=this.addToHttpParams(z,o,"organ-iri")),m&&m.forEach(ct=>{z=this.addToHttpParams(z,ct,"providers")}),null!=E&&(z=this.addToHttpParams(z,E,"sex")),C&&C.forEach(ct=>{z=this.addToHttpParams(z,ct,"technologies")}),null!=R&&(z=this.addToHttpParams(z,R,"token"));let de=this.defaultHeaders,Ie=s&&s.httpHeaderAccept;void 0===Ie&&(Ie=this.configuration.selectHeaderAccept(["application/json"])),void 0!==Ie&&(de=de.set("Accept",Ie));let Be=s&&s.context;void 0===Be&&(Be=new Ys);let Ne="json";return Ie&&(Ne=Ie.startsWith("text")?"text":this.configuration.isJsonMime(Ie)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/reference-organ-scene`,{context:Be,params:z,responseType:Ne,withCredentials:this.configuration.withCredentials,headers:de,observe:i,reportProgress:r})}referenceOrgans(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Nr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/reference-organs`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}scene(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,E=t.technologies,C=t.token;let R=new Nr({encoder:this.encoder});null!=o&&(R=this.addToHttpParams(R,o,"age")),null!=a&&(R=this.addToHttpParams(R,a,"age-range")),null!=l&&(R=this.addToHttpParams(R,l,"bmi")),null!=c&&(R=this.addToHttpParams(R,c,"bmi-range")),null!=u&&(R=this.addToHttpParams(R,u,"cache")),h&&h.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"ontology-terms")}),p&&p.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"cell-type-terms")}),g&&g.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"providers")}),null!=m&&(R=this.addToHttpParams(R,m,"sex")),E&&E.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"technologies")}),null!=C&&(R=this.addToHttpParams(R,C,"token"));let z=this.defaultHeaders,de=s&&s.httpHeaderAccept;void 0===de&&(de=this.configuration.selectHeaderAccept(["application/json"])),void 0!==de&&(z=z.set("Accept",de));let Ie=s&&s.context;void 0===Ie&&(Ie=new Ys);let Be="json";return de&&(Be=de.startsWith("text")?"text":this.configuration.isJsonMime(de)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/scene`,{context:Ie,params:R,responseType:Be,withCredentials:this.configuration.withCredentials,headers:z,observe:i,reportProgress:r})}sparql(t,i="body",r=!1,s){const o=t.query;if(null==o)throw new Error("Required parameter query was null or undefined when calling sparql.");const a=t.token,l=t.format;let c=new Nr({encoder:this.encoder});null!=o&&(c=this.addToHttpParams(c,o,"query")),null!=a&&(c=this.addToHttpParams(c,a,"token")),null!=l&&(c=this.addToHttpParams(c,l,"format"));let u=this.defaultHeaders,h=s&&s.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let p=s&&s.context;void 0===p&&(p=new Ys);let g="json";return h&&(g=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/sparql`,{context:p,params:c,responseType:g,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}sparqlPost(t,i="body",r=!1,s){const o=t.sparqlQueryRequest;if(null==o)throw new Error("Required parameter sparqlQueryRequest was null or undefined when calling sparqlPost.");const a=t.token,l=t.format;let c=new Nr({encoder:this.encoder});null!=a&&(c=this.addToHttpParams(c,a,"token")),null!=l&&(c=this.addToHttpParams(c,l,"format"));let u=this.defaultHeaders,h=s&&s.httpHeaderAccept;void 0===h&&(h=this.configuration.selectHeaderAccept(["application/json"])),void 0!==h&&(u=u.set("Accept",h));let p=s&&s.context;void 0===p&&(p=new Ys);const m=this.configuration.selectHeaderContentType(["application/json","application/x-www-form-urlencoded"]);void 0!==m&&(u=u.set("Content-Type",m));let E="json";return h&&(E=h.startsWith("text")?"text":this.configuration.isJsonMime(h)?"json":"blob"),this.httpClient.post(`${this.configuration.basePath}/sparql`,o,{context:p,params:c,responseType:E,withCredentials:this.configuration.withCredentials,headers:u,observe:i,reportProgress:r})}technologyNames(t,i="body",r=!1,s){const o=t.cache,a=t.token;let l=new Nr({encoder:this.encoder});null!=o&&(l=this.addToHttpParams(l,o,"cache")),null!=a&&(l=this.addToHttpParams(l,a,"token"));let c=this.defaultHeaders,u=s&&s.httpHeaderAccept;void 0===u&&(u=this.configuration.selectHeaderAccept(["application/json"])),void 0!==u&&(c=c.set("Accept",u));let h=s&&s.context;void 0===h&&(h=new Ys);let p="json";return u&&(p=u.startsWith("text")?"text":this.configuration.isJsonMime(u)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/technology-names`,{context:h,params:l,responseType:p,withCredentials:this.configuration.withCredentials,headers:c,observe:i,reportProgress:r})}tissueBlocks(t,i="body",r=!1,s){const o=t.age,a=t.ageRange,l=t.bmi,c=t.bmiRange,u=t.cache,h=t.ontologyTerms,p=t.cellTypeTerms,g=t.providers,m=t.sex,E=t.technologies,C=t.token;let R=new Nr({encoder:this.encoder});null!=o&&(R=this.addToHttpParams(R,o,"age")),null!=a&&(R=this.addToHttpParams(R,a,"age-range")),null!=l&&(R=this.addToHttpParams(R,l,"bmi")),null!=c&&(R=this.addToHttpParams(R,c,"bmi-range")),null!=u&&(R=this.addToHttpParams(R,u,"cache")),h&&h.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"ontology-terms")}),p&&p.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"cell-type-terms")}),g&&g.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"providers")}),null!=m&&(R=this.addToHttpParams(R,m,"sex")),E&&E.forEach(Ne=>{R=this.addToHttpParams(R,Ne,"technologies")}),null!=C&&(R=this.addToHttpParams(R,C,"token"));let z=this.defaultHeaders,de=s&&s.httpHeaderAccept;void 0===de&&(de=this.configuration.selectHeaderAccept(["application/json"])),void 0!==de&&(z=z.set("Accept",de));let Ie=s&&s.context;void 0===Ie&&(Ie=new Ys);let Be="json";return de&&(Be=de.startsWith("text")?"text":this.configuration.isJsonMime(de)?"json":"blob"),this.httpClient.get(`${this.configuration.basePath}/tissue-blocks`,{context:Ie,params:R,responseType:Be,withCredentials:this.configuration.withCredentials,headers:z,observe:i,reportProgress:r})}}return n.\u0275fac=function(t){return new(t||n)(De(od),De(fW,8),De(hb,8))},n.\u0275prov=$e({factory:function(){return new n(De(od),De(fW,8),De(hb,8))},token:n,providedIn:"root"}),n})(),qMe=(()=>{class n{constructor(t,i){if(t)throw new Error("CcfApiModule is already loaded. Import in your base AppModule only.");if(!i)throw new Error("You need to import the HttpClientModule in your AppModule! \nSee also https://github.com/angular/angular/issues/20575")}static forRoot(t){return{ngModule:n,providers:[{provide:hb,useFactory:t}]}}}return n.\u0275fac=function(t){return new(t||n)(De(n,12),De(od,8))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:[],imports:[[]]}),n})();function cu(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}let TN;function gc(){return TN||(TN=function(n,e){const t=function(){if(navigator.userAgentData||!/Safari\//.test(navigator.userAgent)||/Chrom(e|ium)\//.test(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let e;return new Promise(t=>{const i=()=>indexedDB.databases().finally(t);e=setInterval(i,100),i()}).finally(()=>clearInterval(e))}().then(()=>{const i=indexedDB.open("keyval-store");return i.onupgradeneeded=()=>i.result.createObjectStore(e),cu(i)});return(i,r)=>t.then(s=>r(s.transaction(e,i).objectStore(e)))}(0,"keyval")),TN}function gW(n,e=gc()){return e("readonly",t=>cu(t.get(n)))}var Zn=tt(440);const vx="Unknown Euler angle order",vm=.99999;class Ji extends DE{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return Ji.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(e){return Ji.RotationOrders[e]}get ELEMENTS(){return 4}constructor(e=0,t=0,i=0,r=Ji.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(e,t,i,r)}fromQuaternion(e){const[t,i,r,s]=e,o=i*i,a=-2*(o+r*r)+1,l=2*(t*i+s*r);let c=-2*(t*r-s*i);c=c>1?1:c,c=c<-1?-1:c;const p=Math.atan2(2*(i*r+s*t),-2*(t*t+o)+1),g=Math.asin(c),m=Math.atan2(l,a);return new Ji(p,g,m,Ji.RollPitchYaw)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=Number.isFinite(e[3])||this.order,this.check()}set(e=0,t=0,i=0,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return function(n){return n>=0&&n<6}(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}toArray(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e}toArray4(e=[],t=0){return e[t]=this[0],e[t+1]=this[1],e[t+2]=this[2],e[t+3]=this[3],e}toVector3(e=[-0,-0,-0]){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e}get x(){return this[0]}set x(e){this[0]=Zi(e)}get y(){return this[1]}set y(e){this[1]=Zi(e)}get z(){return this[2]}set z(e){this[2]=Zi(e)}get alpha(){return this[0]}set alpha(e){this[0]=Zi(e)}get beta(){return this[1]}set beta(e){this[1]=Zi(e)}get gamma(){return this[2]}set gamma(e){this[2]=Zi(e)}get phi(){return this[0]}set phi(e){this[0]=Zi(e)}get theta(){return this[1]}set theta(e){this[1]=Zi(e)}get psi(){return this[2]}set psi(e){this[2]=Zi(e)}get roll(){return this[0]}set roll(e){this[0]=Zi(e)}get pitch(){return this[1]}set pitch(e){this[1]=Zi(e)}get yaw(){return this[2]}set yaw(e){this[2]=Zi(e)}get order(){return this[3]}set order(e){this[3]=function(n){if(n<0&&n>=6)throw new Error(vx);return n}(e)}fromVector3(e,t){return this.set(e[0],e[1],e[2],Number.isFinite(t)?t:this[3])}fromArray(e,t=0){return this[0]=e[0+t],this[1]=e[1+t],this[2]=e[2+t],void 0!==e[3]&&(this[3]=e[3]),this.check()}fromRollPitchYaw(e,t,i){return this.set(e,t,i,Ji.ZYX)}fromRotationMatrix(e,t=Ji.DefaultOrder){return this._fromRotationMatrix(e,t),this.check()}getRotationMatrix(e){return this._getRotationMatrix(e)}getQuaternion(){const e=new pO;switch(this[4]){case Ji.XYZ:return e.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case Ji.YXZ:return e.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case Ji.ZXY:return e.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case Ji.ZYX:return e.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case Ji.YZX:return e.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case Ji.XZY:return e.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(vx)}}_fromRotationMatrix(e,t=Ji.DefaultOrder){const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],p=i[10];switch(t=t||this[3]){case Ji.XYZ:this[1]=Math.asin(Oa(o,-1,1)),Math.abs(o)<vm?(this[0]=Math.atan2(-c,p),this[2]=Math.atan2(-s,r)):(this[0]=Math.atan2(h,l),this[2]=0);break;case Ji.YXZ:this[0]=Math.asin(-Oa(c,-1,1)),Math.abs(c)<vm?(this[1]=Math.atan2(o,p),this[2]=Math.atan2(a,l)):(this[1]=Math.atan2(-u,r),this[2]=0);break;case Ji.ZXY:this[0]=Math.asin(Oa(h,-1,1)),Math.abs(h)<vm?(this[1]=Math.atan2(-u,p),this[2]=Math.atan2(-s,l)):(this[1]=0,this[2]=Math.atan2(a,r));break;case Ji.ZYX:this[1]=Math.asin(-Oa(u,-1,1)),Math.abs(u)<vm?(this[0]=Math.atan2(h,p),this[2]=Math.atan2(a,r)):(this[0]=0,this[2]=Math.atan2(-s,l));break;case Ji.YZX:this[2]=Math.asin(Oa(a,-1,1)),Math.abs(a)<vm?(this[0]=Math.atan2(-c,l),this[1]=Math.atan2(-u,r)):(this[0]=0,this[1]=Math.atan2(o,p));break;case Ji.XZY:this[2]=Math.asin(-Oa(s,-1,1)),Math.abs(s)<vm?(this[0]=Math.atan2(h,l),this[1]=Math.atan2(o,r)):(this[0]=Math.atan2(-c,p),this[1]=0);break;default:throw new Error(vx)}return this[3]=t,this}_getRotationMatrix(e){const t=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],i=this.x,r=this.y,s=this.z,o=Math.cos(i),a=Math.cos(r),l=Math.cos(s),c=Math.sin(i),u=Math.sin(r),h=Math.sin(s);switch(this[3]){case Ji.XYZ:{const p=o*l,g=o*h,m=c*l,E=c*h;t[0]=a*l,t[4]=-a*h,t[8]=u,t[1]=g+m*u,t[5]=p-E*u,t[9]=-c*a,t[2]=E-p*u,t[6]=m+g*u,t[10]=o*a;break}case Ji.YXZ:{const p=a*l,g=a*h,m=u*l,E=u*h;t[0]=p+E*c,t[4]=m*c-g,t[8]=o*u,t[1]=o*h,t[5]=o*l,t[9]=-c,t[2]=g*c-m,t[6]=E+p*c,t[10]=o*a;break}case Ji.ZXY:{const p=a*l,g=a*h,m=u*l,E=u*h;t[0]=p-E*c,t[4]=-o*h,t[8]=m+g*c,t[1]=g+m*c,t[5]=o*l,t[9]=E-p*c,t[2]=-o*u,t[6]=c,t[10]=o*a;break}case Ji.ZYX:{const p=o*l,g=o*h,m=c*l,E=c*h;t[0]=a*l,t[4]=m*u-g,t[8]=p*u+E,t[1]=a*h,t[5]=E*u+p,t[9]=g*u-m,t[2]=-u,t[6]=c*a,t[10]=o*a;break}case Ji.YZX:{const p=o*a,g=o*u,m=c*a,E=c*u;t[0]=a*l,t[4]=E-p*h,t[8]=m*h+g,t[1]=h,t[5]=o*l,t[9]=-c*l,t[2]=-u*l,t[6]=g*h+m,t[10]=p-E*h;break}case Ji.XZY:{const p=o*a,g=o*u,m=c*a,E=c*u;t[0]=a*l,t[4]=-h,t[8]=u*l,t[1]=p*h+E,t[5]=o*l,t[9]=g*h-m,t[2]=m*h-g,t[6]=c*l,t[10]=E*h+p;break}default:throw new Error(vx)}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}toQuaternion(){const e=Math.cos(.5*this.yaw),t=Math.sin(.5*this.yaw),i=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),s=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch);return new pO(e*r*s-t*i*o,e*i*o+t*r*s,t*i*s-e*r*o,e*i*s+t*r*o)}}var bx,tDe=tt(698),nDe=tt(445),iDe=tt.n(nDe),Tr=tt(815),rDe=new Uint8Array(16);function sDe(){if(!bx&&!(bx="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return bx(rDe)}const oDe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,lDe=function(n){return"string"==typeof n&&oDe.test(n)};for(var oo=[],MN=0;MN<256;++MN)oo.push((MN+256).toString(16).substr(1));const hDe=function(n,e,t){var i=(n=n||{}).random||(n.rng||sDe)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){t=t||0;for(var r=0;r<16;++r)e[t+r]=i[r];return e}return function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(oo[n[e+0]]+oo[n[e+1]]+oo[n[e+2]]+oo[n[e+3]]+"-"+oo[n[e+4]]+oo[n[e+5]]+"-"+oo[n[e+6]]+oo[n[e+7]]+"-"+oo[n[e+8]]+oo[n[e+9]]+"-"+oo[n[e+10]]+oo[n[e+11]]+oo[n[e+12]]+oo[n[e+13]]+oo[n[e+14]]+oo[n[e+15]]).toLowerCase();if(!lDe(t))throw TypeError("Stringified UUID is invalid");return t}(i)};var wx=tt(609);function*DN(n,e,t){for(const[i,r]of Object.entries(t))for(const s of(0,Zn.readQuads)(n,e,i,null,null)){const o="Literal"===s.object.termType?(0,wx.fromRdf)(s.object):s.object.id;yield[r,o]}}function bm(n,e,t,i){const r={"@id":e,"@type":t};for(const[s,o]of Object.entries(i))for(const a of(0,Zn.readQuads)(n,r["@id"],s,null,null)){const l="Literal"===a.object.termType?(0,wx.fromRdf)(a.object):a.object.id;r[o]=l}return r}const Di=Zn.Util.prefixes({ccf:"http://purl.org/ccf/latest/ccf.owl#",entity:"http://purl.org/ccf/latest/ccf-entity.owl#",fma:"http://purl.obolibrary.org/obo/FMA_",obo:"http://purl.obolibrary.org/obo/",uberon:"http://purl.obolibrary.org/obo/UBERON_",cl:"http://purl.obolibrary.org/obo/CL_",lmha:"http://purl.obolibrary.org/obo/LMHA_",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",dc:"http://purl.org/dc/elements/1.1/"},Zn.DataFactory),mW={x:Di("rdf"),type:Di("rdf")("type")},wm={x:Di("rdfs"),label:Di("rdfs")("label"),comment:Di("rdfs")("comment"),isDefinedBy:Di("rdfs")("isDefinedBy"),seeAlso:Di("rdfs")("seeAlso")},hi={x:Di("entity"),id:Di("entity")("id"),label:wm.label,description:wm.comment,link:wm.seeAlso,sex:Di("entity")("sex"),age:Di("entity")("age"),bmi:Di("entity")("bmi"),Male:Zn.DataFactory.literal("Male"),Female:Zn.DataFactory.literal("Female"),consortiumName:Di("entity")("consortium_name"),providerName:Di("entity")("provider_name"),providerUUID:Di("entity")("provider_uuid"),donor:Di("entity")("has_donor"),sections:Di("entity")("has_tissue_section"),datasets:Di("entity")("has_dataset"),sampleType:Di("entity")("sample_type"),TissueBlock:Zn.DataFactory.literal("Tissue Block"),TissueSection:Zn.DataFactory.literal("Tissue Section"),NonStandard:Zn.DataFactory.literal("Non-standard"),sectionCount:Di("entity")("section_count"),sectionSize:Di("entity")("section_size"),sectionUnits:Di("entity")("section_units"),sectionNumber:Di("entity")("section_number"),spatialEntity:Di("entity")("has_spatial_entity"),ontologyTerms:Di("entity")("has_ontology_term"),cellTypeTerms:Di("entity")("has_cell_type_term"),technology:Di("entity")("technology"),thumbnail:Di("entity")("has_thumbnail")},Cn=Di("ccf"),sr={x:Cn,ontologyNode:{label:Cn("ccf_preferred_label"),parent:Cn("ccf_part_of"),children:Cn("ccf_part_of"),rui_rank:Cn("ccf_rui_rank"),synonymLabels:Zn.DataFactory.namedNode("http://www.geneontology.org/formats/oboInOwl#hasExactSynonym")},asctb:{part_of:Cn("ccf_part_of"),ct_is_a:Cn("ct_is_a"),located_in:Cn("located_in"),characterizes:Cn("characterizes")},spatial:{Female:Cn("VHFemale"),Male:Cn("VHMale"),BothSexes:Cn("VHBothSexes"),FemaleOrgans:Cn("VHFemaleOrgans"),MaleOrgans:Cn("VHMaleOrgans")},SpatialObjectReference:Cn("SpatialObjectReference"),SpatialEntity:Cn("SpatialEntity"),SpatialPlacement:Cn("SpatialPlacement"),spatialObjectReference:{file:Cn("has_object_file"),file_format:Cn("has_object_file_format"),file_subpath:Cn("has_object_file_subpath")},extractionSet:{label:wm.label,rui_rank:Cn("ccf_rui_rank")},spatialEntity:{label:wm.label,comment:wm.comment,creator:Di("dc")("creator"),creator_first_name:Cn("creator_first_name"),creator_last_name:Cn("creator_last_name"),creator_orcid:Cn("creator_orcid"),creation_date:Cn("creation_date"),updated_date:Cn("updated_date"),ccf_annotations:Cn("ccf_annotation"),representation_of:Cn("ccf_representation_of"),reference_organ:Cn("anatomical_structure_of"),extraction_set_for:Cn("extraction_set_for"),extraction_set:Cn("extraction_site_for"),sex:Cn("has_sex"),side:Cn("has_side"),rui_rank:Cn("ccf_rui_rank"),slice_thickness:Cn("ccf_slice_thickness"),slice_count:Cn("ccf_slice_count"),x_dimension:Cn("has_x_dimension"),y_dimension:Cn("has_y_dimension"),z_dimension:Cn("has_z_dimension"),dimension_units:Cn("has_dimension_units"),object:Cn("has_object_reference")},spatialPlacement:{source:Cn("has_placement_source"),target:Cn("has_placement_target"),placement_date:Cn("has_placement_date"),x_scaling:Cn("has_x_scaling"),y_scaling:Cn("has_y_scaling"),z_scaling:Cn("has_z_scaling"),scaling_units:Cn("has_scaling_units"),x_rotation:Cn("has_x_rotation"),y_rotation:Cn("has_y_rotation"),z_rotation:Cn("has_z_rotation"),w_rotation:Cn("has_theta_rotation"),rotation_order:Cn("has_rotation_order"),rotation_units:Cn("has_rotation_units"),x_translation:Cn("has_x_translation"),y_translation:Cn("has_y_translation"),z_translation:Cn("has_z_translation"),translation_units:Cn("has_translation_units")}},si={x:Di("uberon"),body:Di("uberon")("0013702")},pDe={x:Di("cl"),cell:Di("cl")("0000000")},fb={x:Di("fma")},uu=(Di("lmha"),{body:si.body,cell:pDe.cell,respiratory_system:si.x("0001004"),colon:si.x("0001155"),left_lung:si.x("0002168"),right_lung:si.x("0002167"),left_bronchus:si.x("0002178"),right_bronchus:si.x("0002177"),kidney:si.x("0002113"),ureter:si.x("0000056"),eye:si.x("0000970"),fallopian_tube:si.x("0003889"),knee:si.x("0001465"),ovary:si.x("0000992"),trachea:si.x("0003126"),aorta:si.x("0000947"),blood:si.x("0000178"),bone_marrow:si.x("0002371"),male_reproductive_system:si.x("0000079"),lymph_node:si.x("0000029"),blood_vasculature:si.x("0004537"),brain:si.x("0000955"),eye_left:si.x("0004548"),eye_right:fb.x("54449"),fallopian_tube_left:si.x("0001303"),fallopian_tube_right:si.x("0001302"),heart:si.x("0000948"),kidney_left:si.x("0004538"),kidney_right:si.x("0004539"),knee_left:fb.x("24978"),knee_right:fb.x("24977"),large_intestine:si.x("0000059"),liver:si.x("0002107"),lungs:si.x("0002048"),mesenteric_lymph_node:si.x("0002509"),ovary_left:fb.x("7214"),ovary_right:fb.x("7213"),pancreas:si.x("0001264"),pelvis:si.x("0001270"),prostate_gland:si.x("0002367"),skin:si.x("0002097"),small_intestine:si.x("0002108"),spleen:si.x("0002106"),thymus:si.x("0002370"),ureter_left:si.x("0001223"),ureter_right:si.x("0001222"),urinary_bladder:si.x("0001255"),uterus:si.x("0000995")});function IN(n){const e={};return Object.entries(n).forEach(([t,i])=>{e[i.id]=t}),e}const Ex={spatialObjectReference:IN(sr.spatialObjectReference),spatialEntity:IN(sr.spatialEntity),spatialPlacement:IN(sr.spatialPlacement)};function _W(n,e){const t=bm(n,e,"ExtractionSet",Ex.spatialEntity);return t.extractionSites=(0,Tr.sortBy)(n.getSubjects(sr.spatialEntity.extraction_set,e,null).map(i=>qf(n,i.id)),["rui_rank"]),t}function qf(n,e){const t=bm(n,e,"SpatialEntity",Ex.spatialEntity);return t.object&&(t.object=function(n,e){return bm(n,e,"SpatialObjectReference",Ex.spatialObjectReference)}(n,t.object)),t.ccf_annotations&&(t.ccf_annotations=n.getObjects(e,sr.spatialEntity.ccf_annotations,null).map(i=>i.id)),n.forSubjects(i=>t.entityId=i.id,hi.spatialEntity,e,null),t}function vDe(n,e){const t=bm(n,e,"SpatialPlacement",Ex.spatialPlacement);return t.source&&(t.source=qf(n,t.source)),t.target&&(t.target=qf(n,t.target)),t}function yW(n,e){const t=e;let i;switch(t.translation_units){case"centimeter":i=.01;break;case"millimeter":i=.001;break;case"meter":default:i=1}const r=[t.x_translation,t.y_translation,t.z_translation].map(a=>a*i),s=[t.x_rotation,t.y_rotation,t.z_rotation].map(qB),o=[t.x_scaling,t.y_scaling,t.z_scaling];return n.translate(r).rotateXYZ(s).scale(o)}class vW{constructor(e){this.db=e,this.createGraph()}createGraph(){this.graph=new tDe.DirectedGraph;const e=this.db.store;e.forSubjects(i=>{this.addNode(i.id,"SpatialObjectReference")},mW.type,sr.SpatialObjectReference,null),e.forSubjects(i=>{this.addNode(i.id,"SpatialEntity")},mW.type,sr.SpatialEntity,null);const t={};for(const i of(0,Zn.readQuads)(e,null,sr.spatialPlacement.source,null,null))t[i.subject.id]=i.object.id;for(const i of(0,Zn.readQuads)(e,null,sr.spatialPlacement.target,null,null)){const r=t[i.subject.id];r&&this.addEdge(i.subject.id,r,i.object.id,"SpatialPlacement")}}addNode(e,t){this.graph.mergeNode(e,{type:t})}addEdge(e,t,i,r){this.graph.mergeDirectedEdge(t,i,{type:r,id:e})}getTransformationMatrix(e,t){if(e===t)return new $n($n.IDENTITY);if(!this.graph.hasNode(e)||!this.graph.hasNode(t))return;const i=this.db.store,r=new $n($n.IDENTITY),s=iDe()(this.graph,e,t);if(s&&s.length>0){s.reverse();let o="";for(const a of s)o&&yW(r,vDe(i,this.graph.getEdgeAttribute(a,o,"id"))),o=a;return r}}getSpatialPlacement(e,t){const i=this.graph.hasNode(e["@id"])?e["@id"]:void 0,r=(0,Tr.get)(e,"placement[0]",(0,Tr.get)(e,"placement",void 0));let s;if(r&&this.graph.hasNode(r.target)?(s=this.getTransformationMatrix(r.target,t),s&&(s=yW(s,r))):i&&(s=this.getTransformationMatrix(i,t)),s){const o=(new Ji).fromRotationMatrix(s,Ji.XYZ),a=s.getTranslation().map(u=>1e3*u),l=o.toVector3().map(Sne),c=s.getScale().map(u=>u<1&&u>.999999?1:u);return{"@context":"https://hubmapconsortium.github.io/hubmap-ontology/ccf-context.jsonld","@id":`http://purl.org/ccf/1.5/${hDe()}_placement`,"@type":"SpatialPlacement",source:e["@id"],target:t,placement_date:(new Date).toISOString().split("T")[0],x_scaling:c[0],y_scaling:c[1],z_scaling:c[2],scaling_units:"ratio",x_rotation:l[0],y_rotation:l[1],z_rotation:l[2],rotation_order:"XYZ",rotation_units:"degree",x_translation:a[0],y_translation:a[1],z_translation:a[2],translation_units:"millimeter"}}}}class bW{constructor(e){this.db=e}getSpatialEntity(e){return qf(this.db.store,e)}getExtractionSets(e){return function(n,e){return(0,Tr.sortBy)(n.getSubjects(sr.spatialEntity.extraction_set_for,e,null).map(t=>_W(n,t.id)),["rui_rank"])}(this.db.store,e)}getExtractionSet(e){return _W(this.db.store,e)}getAnatomicalStructures(e){return function(n,e){return(0,Tr.sortBy)(n.getSubjects(sr.spatialEntity.reference_organ,e,null).map(t=>qf(n,t.id)).filter(t=>t["@id"]!==e),["rui_rank"])}(this.db.store,e)}getReferenceOrgans(){return function(n){const e=[];return n.forEach(t=>{t.subject.id===t.object.id&&e.push(qf(n,t.subject.id))},null,sr.spatialEntity.reference_organ,null,null),(0,Tr.sortBy)(e,["rui_rank"])}(this.db.store)}getReferenceBody(e){let t;switch(null==e?void 0:e.sex){case"Male":t=sr.spatial.Male.id;break;case"Female":t=sr.spatial.Female.id;break;case"Both":default:t=sr.spatial.BothSexes.id}return this.getSpatialEntity(t)}getReferenceOrganSets(e){let t=this.getReferenceOrgans();switch(null==e?void 0:e.sex){case"Male":t=t.filter(i=>"Male"===i.sex);break;case"Female":t=t.filter(i=>"Female"===i.sex)}return(null==e?void 0:e.debug)&&(t=t.map(i=>[[i],this.getAnatomicalStructures(i["@id"])]).reduce((i,[r,s])=>i.concat(s.length>0?s:r),[])),t}getReferenceSceneNodes(e){const t=this.getReferenceBody(e),i=[];let r=[...this.getReferenceOrganSets(e).map(s=>{const o="http://purl.obolibrary.org/obo/UBERON_0002097"===s.representation_of,a=this.getSceneNode(s,t,{color:[255,255,255,255],opacity:o?.5:.2,unpickable:!0,_lighting:"pbr",zoomBasedOpacity:!o});return o&&a?void i.push(a):a})];return i.length>0&&(r=[...i,...r]),(null==e?void 0:e.debug)&&(r=r.concat([this.getSceneNode(this.getSpatialEntity(sr.x("VHRightKidney").id),t,{color:[0,0,255,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(sr.x("VHLeftKidney").id),t,{color:[255,0,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(sr.x("VHSpleenCC1").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(sr.x("VHSpleenCC2").id),t,{color:[0,255,0,127.5],wireframe:!0}),this.getSceneNode(this.getSpatialEntity(sr.x("VHSpleenCC3").id),t,{color:[0,255,0,127.5],wireframe:!0})])),r.filter(s=>void 0!==s)}getReferenceOrganScene(e,t){var i,r;const s=null!==(i=void 0!==(null==t?void 0:t.sex))&&void 0!==i&&i,o=this.getReferenceOrgans().filter(a=>a.representation_of===e&&(!s||a.sex===(null==t?void 0:t.sex)));if(o.length>0){const a=o[0],c=this.getSceneNode(a,a,{color:[255,255,255,255],opacity:"http://purl.obolibrary.org/obo/UBERON_0002097"===a.representation_of?.5:.2,unpickable:!0,_lighting:"pbr"}),u=(null!==(r=this.db.getSpatialEntities(t))&&void 0!==r?r:[]).map(h=>this.getSceneNode(h,a,{color:[255,255,255,229.5]}));return[c].concat(u).filter(h=>void 0!==h)}return[]}getEntitySceneNodes(e){const t=this.getReferenceBody(e);return this.db.getSpatialEntities(e).map(i=>this.getSceneNode(i,t,{color:[255,255,255,229.5]})).filter(i=>void 0!==i)}getSceneNode(e,t,i={}){var r,s,o,a;const l=null===(s=null===(r=null==e?void 0:e.object)||void 0===r?void 0:r.file_format)||void 0===s?void 0:s.startsWith("model/gltf");let u=this.db.graph.getTransformationMatrix(l&&e.object?e.object["@id"]:e["@id"],t["@id"]);if(u){if(l)u=new $n($n.IDENTITY).rotateX(qB(90)).multiplyLeft(u);else{let h;switch(e.dimension_units){case"centimeter":h=.01;break;case"millimeter":h=.001;break;case"meter":default:h=1}const p=[e.x_dimension,e.y_dimension,e.z_dimension].map(g=>g*h/2);u.scale(p)}return Object.assign({"@id":e["@id"],"@type":"SpatialSceneNode",entityId:e.entityId,ccf_annotations:e.ccf_annotations,representation_of:e.representation_of,reference_organ:e.reference_organ,scenegraph:l?null===(o=e.object)||void 0===o?void 0:o.file:void 0,scenegraphNode:l?null===(a=e.object)||void 0===a?void 0:a.file_subpath:void 0,transformMatrix:u,tooltip:e.label},i)}}getScene(e){return[...this.getReferenceSceneNodes(e),...this.getEntitySceneNodes(e)]}}const Sx="https://entity.api.hubmapconsortium.org/entities/",wW=new Set(["VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0009-LK-102-7-AF_preIMS_registered_thumbnail.jpg","VAN0009-LK-102-7-IMS_NegMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-IMS_PosMode_multilayer_thumbnail.jpg","VAN0009-LK-102-7-PAS_registered_thumbnail.jpg","VAN0010-LK-155-40-AF_preIMS_registered_thumbnail.jpg","VAN0010-LK-155-40-IMS_NegMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-IMS_PosMode_multilayer_thumbnail.jpg","VAN0010-LK-155-40-PAS_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg","VAN0013-LK-202-96-AF_preIMS_registered_thumbnail.jpg","VAN0013-LK-202-96-IMS_NegMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-IMS_PosMode_multilayer_thumbnail.jpg","VAN0013-LK-202-96-PAS_registered_thumbnail.jpg","VAN0013-LK-202-97-AF_preMxIF_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc1_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc2_registered_thumbnail.jpg","VAN0013-LK-202-97-MxIF_cyc3_registered_thumbnail.jpg","VAN0014-LK-203-108-AF_preIMS_registered_thumbnail.jpg","VAN0014-LK-203-108-IMS_NegMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-IMS_PosMode_multilayer_thumbnail.jpg","VAN0014-LK-203-108-PAS_registered_thumbnail.jpg","VAN0016-LK-202-89-AF_preIMS_registered_thumbnail.jpg","VAN0016-LK-202-89-IMS_NegMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-IMS_PosMode_multilayer_thumbnail.jpg","VAN0016-LK-202-89-PAS_registered_thumbnail.jpg","VAN0003-LK-32-21-AF_preIMS_registered_thumbnail.jpg","VAN0003-LK-32-21-IMS_NegMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-IMS_PosMode_multilayer_thumbnail.jpg","VAN0003-LK-32-21-PAS_registered_thumbnail.jpg","VAN0003-LK-32-22-AF_preMxIF_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc1_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc2_registered_thumbnail.jpg","VAN0003-LK-32-22-MxIF_cyc3_registered_thumbnail.jpg","VAN0005-RK-1-1-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-1-1-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-1-1-PAS_registered_thumbnail.jpg","VAN0005-RK-4-172-AF_preIMS_registered_thumbnail.jpg","VAN0005-RK-4-172-IMS_NegMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-IMS_PosMode_multilayer_thumbnail.jpg","VAN0005-RK-4-172-PAS_registered_thumbnail.jpg","VAN0006-LK-2-85-AF_preIMS_registered_thumbnail.jpg","VAN0006-LK-2-85-IMS_NegMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-IMS_PosMode_multilayer_thumbnail.jpg","VAN0006-LK-2-85-PAS_registered_thumbnail.jpg","VAN0006-LK-2-86-AF_preMxIF_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc1_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc2_registered_thumbnail.jpg","VAN0006-LK-2-86-MxIF_cyc3_registered_thumbnail.jpg","VAN0007-LK-203-103-AF_preIMS_registered_thumbnail.jpg","VAN0007-LK-203-103-IMS_NegMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-IMS_PosMode_multilayer_thumbnail.jpg","VAN0007-LK-203-103-PAS_registered_thumbnail.jpg","VAN0008-RK-403-100-AF_preIMS_registered_thumbnail.jpg","VAN0008-RK-403-100-IMS_NegMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-IMS_PosMode_multilayer_thumbnail.jpg","VAN0008-RK-403-100-PAS_registered_thumbnail.jpg","VAN0008-RK-403-101-AF_preMxIF_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc1_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc2_registered_thumbnail.jpg","VAN0008-RK-403-101-MxIF_cyc3_registered_thumbnail.jpg","VAN0011-RK-3-10-AF_preIMS_registered_thumbnail.jpg","VAN0011-RK-3-10-IMS_NegMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-IMS_PosMode_multilayer_thumbnail.jpg","VAN0011-RK-3-10-PAS_registered_thumbnail.jpg","VAN0011-RK-3-11-AF_preMxIF_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc1_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc2_registered_thumbnail.jpg","VAN0011-RK-3-11-MxIF_cyc3_registered_thumbnail.jpg","VAN0012-RK-103-75-AF_preIMS_registered_thumbnail.jpg","VAN0012-RK-103-75-IMS_NegMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-IMS_PosMode_multilayer_thumbnail.jpg","VAN0012-RK-103-75-PAS_registered_thumbnail.jpg","VAN0012-RK-103-76-AF_preMxIF_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc1_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc2_registered_thumbnail.jpg","VAN0012-RK-103-76-MxIF_cyc3_registered_thumbnail.jpg"]),wDe={"HBM558.SRZG.629":"HBM558.SRZG.629_UFL0002-SP-3-4-1.jpg","HBM562.NTMH.548":"HBM562.NTMH.548_UFL0006-SP-1-2-1.jpg","HBM685.KHRQ.684":"HBM685.KHRQ.684_UFL0008-LY07-1-1.jpg","HBM278.SFQW.627":"HBM278.SFQW.627_UFL0008-LY09-1-1.jpg","HBM427.SMGB.866":"HBM427.SMGB.866_UFL0004-SP-1-4-1.jpg","HBM432.LLCF.677":"HBM432.LLCF.677_UFL0001-SP-2-5-1.jpg","HBM586.ZSVS.996":"HBM586.ZSVS.996_UFL0008-SP-1-1-1.jpg","HBM285.XMBT.542":"HBM285.XMBT.542_UFL0006-TH-1-3-1.jpg","HBM289.BWJW.663":"HBM289.BWJW.663_UFL0006-TH-1-2-1.jpg","HBM255.SRPR.985":"HBM255.SRPR.985_UFL0005-TH-2-2-1.jpg","HBM799.WXHD.535":"HBM799.WXHD.535_UFL0009-LY02-1-1.jpg","HBM294.RZFN.624":"HBM294.RZFN.624_UFL0005-TH-1-1-1.jpg","HBM383.TRQG.424":"HBM383.TRQG.424_UFL0006-SP-1-3-1.jpg","HBM647.MFQB.496":"HBM647.MFQB.496_UFL0001-SP-1-2-1.jpg","HBM237.GGPR.739":"HBM237.GGPR.739_UFL0006-LY01-1-1.jpg","HBM288.TPBD.654":"HBM288.TPBD.654_UFL0003-SP-2-2-1.jpg","HBM974.NDXT.675":"HBM974.NDXT.675_UFL0008-TH-2-2-1.jpg","HBM589.SLVV.423":"HBM589.SLVV.423_UFL0008-LY10-1-1.jpg","HBM794.RLFN.358":"HBM794.RLFN.358_UFL0006-LY03-1-1.jpg","HBM372.BQSR.778":"HBM372.BQSR.778_UFL0007-SP-1-1-1.jpg","HBM499.TKDW.458":"HBM499.TKDW.458_UFL0009-LY03-1-1.jpg","HBM342.PRQB.739":"HBM342.PRQB.739_UFL0003-LY06-1-1.jpg","HBM633.CLVN.674":"HBM633.CLVN.674_UFL0003-SP-3-6-1.jpg","HBM343.JQKM.578":"HBM343.JQKM.578_UFL0009-LY01-1-1.jpg","HBM987.XGTH.368":"HBM987.XGTH.368_UFL0002-SP-2-4-1.jpg","HBM964.CWCP.788":"HBM964.CWCP.788_UFL0006-LY02-2-1.jpg","HBM244.TJLK.223":"HBM244.TJLK.223_UFL0003-SP-1-4-1.jpg","HBM646.FSBQ.966":"HBM646.FSBQ.966_UFL0007-SP-2-2-1.jpg","HBM572.GXSB.234":"HBM572.GXSB.234_UFL0003-SP-3-2-1.jpg","HBM772.TKGJ.794":"HBM772.TKGJ.794_UFL0008-SP-2-1-1.jpg","HBM239.CBWR.263":"HBM239.CBWR.263_UFL0008-SP-1-2-1.jpg","HBM992.NRTT.383":"HBM992.NRTT.383_UFL0006-SP-1-1-1.jpg","HBM283.DQXD.546":"HBM283.DQXD.546_UFL0003-SP-1-2-1.jpg","HBM795.JHND.856":"HBM795.JHND.856_UFL0007-SP-1-2-1.jpg","HBM267.BZKT.867":"HBM267.BZKT.867_UFL0003-SP-2-6-1.jpg","HBM838.DLMJ.782":"HBM838.DLMJ.782_UFL0008-TH-1-1-1.jpg","HBM337.FSXL.564":"HBM337.FSXL.564_UFL0001-SP-3-8-2.jpg","HBM355.JDLK.244":"HBM355.JDLK.244_UFL0004-SP-2-4-1.jpg","HBM599.PSZG.737":"HBM599.PSZG.737_UFL0006-LY02-1-1.jpg"},Em={"03b3d854-ed44-11e8-8bce-0e368f3075e8":"TMC-UCSD","07a29e4c-ed43-11e8-b56a-0e8017bdda58":"TMC-Florida","308f5ffc-ed43-11e8-b56a-0e8017bdda58":"TMC-CalTech","5bd084c8-edc2-11e8-802f-0e368f3075e8":"HBM-TestingGroup","73bb26e4-ed43-11e8-8f19-0a7c1eab007a":"TMC-Vanderbilt","def5fd76-ed43-11e8-b56a-0e8017bdda58":"TMC-Stanford","5c106f29-ea2d-11e9-85e8-0efb3ba9a670":"RTI-General Electric","301615f9-c870-11eb-a8dc-35ce3d8786fe":"TMC-UConn"},Wt=function(){const n={};return Object.entries(uu).forEach(([e,t])=>n[e]=t.id),n}(),SDe={AO:[Wt.body,Wt.heart,Wt.aorta],BL:[Wt.body,Wt.urinary_bladder],BD:[Wt.body,Wt.pelvis,Wt.blood],BM:[Wt.body,Wt.pelvis,Wt.bone_marrow],BR:[Wt.body,Wt.brain],LB:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.left_bronchus],RB:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.right_bronchus],LE:[Wt.body,Wt.eye,Wt.eye_left],RE:[Wt.body,Wt.eye,Wt.eye_right],LF:[Wt.body,Wt.fallopian_tube,Wt.fallopian_tube_left],RF:[Wt.body,Wt.fallopian_tube,Wt.fallopian_tube_right],HT:[Wt.body,Wt.heart],LK:[Wt.body,Wt.kidney,Wt.kidney_left],RK:[Wt.body,Wt.kidney,Wt.kidney_right],LI:[Wt.body,Wt.large_intestine,Wt.colon],LV:[Wt.body,Wt.liver],LL:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.left_lung],LN:[Wt.body,Wt.knee,Wt.knee_left],RL:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.right_lung],RN:[Wt.body,Wt.knee,Wt.knee_right],LY:[Wt.body,Wt.lymph_node,Wt.mesenteric_lymph_node],LO:[Wt.body,Wt.ovary,Wt.ovary_left],RO:[Wt.body,Wt.ovary,Wt.ovary_right],PA:[Wt.body,Wt.pancreas],PL:[Wt.body],SI:[Wt.body,Wt.small_intestine],SK:[Wt.body,Wt.skin],SP:[Wt.body,Wt.spleen],ST:[Wt.body],TH:[Wt.body,Wt.thymus],TR:[Wt.body,Wt.respiratory_system,Wt.lungs,Wt.trachea],UR:[Wt.body,Wt.ureter],UT:[Wt.body,Wt.uterus],OT:[Wt.body]},EW={"@base":"http://purl.org/ccf/latest/ccf-entity.owl#","@vocab":"http://purl.org/ccf/latest/ccf-entity.owl#",ccf:"http://purl.org/ccf/latest/ccf.owl#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",label:"rdfs:label",description:"rdfs:comment",link:{"@id":"rdfs:seeAlso","@type":"@id"},samples:{"@reverse":"has_donor"},sections:{"@id":"has_tissue_section","@type":"@id"},datasets:{"@id":"has_dataset","@type":"@id"},rui_location:{"@id":"has_spatial_entity","@type":"@id"},ontologyTerms:{"@id":"has_ontology_term","@type":"@id"},cellTypeTerms:{"@id":"has_cell_type_term","@type":"@id"},thumbnail:{"@id":"has_thumbnail"}};class TDe{constructor(e,t="",i="",r){var s,o;if(this.data=e,this.bad=!1,this["@type"]="Sample",this.sample_type="Tissue Block","Sample"!==this.data.entity_type)return void(this.bad=!0);const c=this.data.descendants||[],u=(this.data.ancestors||[]).find(Ne=>"Donor"===Ne.entity_type);this.donor=this.getDonor(u,i);const h=this.getRuiLocation(e,this.donor);h?this.rui_location=h:this.bad=!0,Em[e.group_uuid]||(Em[e.group_uuid]=e.group_name);const p=new Date(e.last_modified_timestamp).toLocaleDateString(),g=Em[e.group_uuid]||e.group_name,m=e.created_by_user_displayname;this["@id"]=Sx+e.uuid,this.label=`Registered ${p}, ${m}, ${g}`,this.link=`${i}browse/sample/${e.uuid}`;const E={},C=[];this.sections=C;const R=[];this.datasets=R;for(const Ne of c.filter(ct=>"Sample"===ct.entity_type)){const ct=this.getSection(Ne,e,i);E[Ne.submission_id]=ct,C.push(ct),ct.section_number=null!==(s=ct.section_number)&&void 0!==s?s:C.length}for(const Ne of c)if("Dataset"===Ne.entity_type){const ct=this.getDataset(Ne,t,i,r),Dt=(0,Tr.get)(Ne,["ingest_metadata","metadata","tissue_id"]);E[Dt]?null===(o=E[Dt].datasets)||void 0===o||o.push(ct):R.push(ct)}const z=null!=h?h:{},de=`${z.x_dimension} x ${z.y_dimension} x ${z.z_dimension} ${z.dimension_units}`;this.section_count=z.slice_count||C.length;const Ie=parseFloat((z.slice_thickness||(z.z_dimension||0)/Math.max(this.section_count,1)).toFixed(1));this.section_size=Ie;const Be=z.dimension_units||"millimeter";this.section_units=Be,this.description=`${de}, ${Ie} ${Be}, ${e.specimen_type}, ${this.section_count} Sections`,C.forEach((Ne,ct)=>{Ne.description=`${z.x_dimension} x ${z.y_dimension} x ${Ie} ${Be}, ${Ie} ${Be}, ${Ne.description}`,Ne.section_number=ct+1})}getSection(e,t,i){const r=new Date(e.last_modified_timestamp).toLocaleDateString();return{"@id":Sx+e.uuid,"@type":"Sample",label:`Registered ${r}, ${e.created_by_user_displayname}, ${Em[e.group_uuid]||e.group_name}`,description:`${t.specimen_type}`,link:`${i}browse/sample/${e.uuid}`,sample_type:"Tissue Section",section_number:1,samples:[],datasets:[]}}getDataset(e,t="",i="",r){var s;const o=new Date(e.last_modified_timestamp).toLocaleDateString(),a=Em[e.group_uuid]||e.group_name,l=e.created_by_user_displayname,c=[...e.data_types,(0,Tr.get)(e,["ingest_metadata","metadata","assay_type"],"")],u=c.join("|").toLowerCase();let h,p="assets/icons/ico-unknown.svg";return-1!==u.indexOf("10x")?(h="10x",p="assets/icons/ico-bulk-10x.svg"):-1!==u.indexOf("af")?(h="AF",p="assets/icons/ico-spatial-af.svg"):-1!==u.indexOf("codex")?(h="CODEX",p="assets/icons/ico-spatial-codex.svg"):-1!==u.indexOf("imc")?(h="IMC",p="assets/icons/ico-spatial-imc.svg"):-1!==u.indexOf("lc")&&-1===u.indexOf("af")?(h="LC",p="assets/icons/ico-bulk-lc.svg"):h=-1!==u.indexOf("maldi")?"MALDI":-1!==u.indexOf("pas")?"PAS":"OTHER",p=null!==(s=this.getDatasetThumbnail(e,t,r))&&void 0!==s?s:p,{"@id":Sx+e.uuid,"@type":"Dataset",label:`Registered ${o}, ${l}, ${a}`,description:`Data/Assay Types: ${c.join(", ")}`,link:`${i}browse/dataset/${e.uuid}`,technology:h,thumbnail:p}}getDatasetThumbnail(e,t,i){if(e.thumbnail_file){const r=e.thumbnail_file;return`${t}/${r.file_uuid}/${r.filename}`+(i?`?token=${i}`:"")}if("73bb26e4-ed43-11e8-8f19-0a7c1eab007a"===e.group_uuid){const r=(0,Tr.get)(e,"metadata.files",[]).filter(s=>/\.(ome\.tif|ome\.tiff)$/.test(s.rel_path)).filter(s=>!/(multilayer\.ome\.tif|_ac\.ome\.tif)/.test(s.rel_path)).filter(s=>wW.has(s.rel_path.split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg"))).map(s=>`${t}/${e.uuid}/${s.rel_path}`+(i?`?token=${i}`:""));if(r.length>0){const s=r[0].split("/").slice(-1)[0].split("?")[0].replace(".ome.tif","_thumbnail.jpg");if(wW.has(s))return`assets/thumbnails/TMC-Vanderbilt/DR1/${s}`}}else if("07a29e4c-ed43-11e8-b56a-0e8017bdda58"===e.group_uuid){const r=wDe[e.hubmap_id];if(r)return`assets/thumbnails/TMC-Florida/${r}`}}getDonor(e,t){const i=(e.description||"").toLowerCase();let r;i.includes("female")?r="Female":i.includes("male")&&(r="Male");const s=i.match(/age ([0-9]+)/);let o,a;s&&(o=(0,Tr.toNumber)(s[1]));for(const p of(0,Tr.get)(e,"metadata.organ_donor_data",[]))"Feminine gender"===p.preferred_term||"Female"===p.preferred_term?r="Female":"Masculine gender"===p.preferred_term||"Male"===p.preferred_term?r="Male":"Current chronological age"===p.preferred_term||"Age"===p.preferred_term?o=(0,Tr.toNumber)(p.data_value):"Body mass index"===p.preferred_term&&(a=(0,Tr.toNumber)(p.data_value));let l="";r&&o&&(l+=`${r}, Age ${o}`,a&&(l+=`, BMI ${a.toFixed(1)}`));const c=new Date(e.last_modified_timestamp).toLocaleDateString(),u=Em[e.group_uuid]||e.group_name;return{"@id":Sx+e.uuid,"@type":"Donor",label:l,description:`Entered ${c}, ${e.created_by_user_displayname}, ${u}`,link:`${t}browse/donor/${e.uuid}`,age:o,sex:r,bmi:a,consortium_name:"HuBMAP",provider_name:u,provider_uuid:e.group_uuid,samples:[]}}getRuiLocation(e,t){var i;const s=(e.ancestors||[]).find(c=>"Sample"===c.entity_type&&"organ"===c.specimen_type),o=SDe[null==s?void 0:s.organ]||[Wt.body];let a,l=e.rui_location;if(l&&("string"==typeof l&&(l=JSON.parse(l)),l.alignment_id?console.log("Detected a deprecated rui_location",e.uuid):l["@id"]&&(a=l)),a){a.ccf_annotations=o.concat(a.ccf_annotations||[]);const c=null!==(i=(0,Tr.get)(a,["placement","target"]))&&void 0!==i?i:"";c.startsWith("http://purl.org/ccf/latest/ccf.owl#VHSpleenCC")&&(0,Tr.set)(a,["placement","target"],c.replace("#VHSpleenCC","Male"===t.sex?"#VHMSpleenCC":"#VHFSpleenCC")),("http://purl.org/ccf/latest/ccf.owl#VHLeftKidney"===c||"http://purl.org/ccf/latest/ccf.owl#VHRightKidney"===c)&&(0,Tr.set)(a,["placement","target"],"Male"===t.sex?c.replace("#VH","#VHM")+"_Patch":c.replace("#VH","#VHF")+"_Patch")}return a}getTissueBlock(){return(0,Tr.omit)(Object.assign({},this),["data","bad","donor"])}toJsonLd(){return Object.assign(Object.assign({},this.donor),{samples:[this.getTissueBlock()]})}}const MDe=["uuid","entity_type","group_uuid","group_name","last_modified_timestamp","created_by_user_displayname","ancestors","descendants","rui_location","specimen_type"],DDe={exists:{field:"rui_location"}};function SW(n,e,t){return JSON.stringify({version:!0,from:n,size:e,stored_fields:["*"],script_fields:{},docvalue_fields:[],query:null!=t?t:DDe,_source:{includes:MDe}})}function ON(n,e){return Ri(this,void 0,void 0,function*(){try{const t=yield fetch(n,e);return t.ok?yield t.json():void 0}catch(t){return}})}function CW(n,e,t,i,r="",s=""){return Ri(this,void 0,void 0,function*(){let o;if("static"===e?o=yield ON(n):"search-api"===e&&(o=yield function(n,e,t){return Ri(this,void 0,void 0,function*(){const r=function(n){const e=new Headers;return e.append("Content-type","application/json"),n&&e.append("Authorization",`Bearer ${n}`),e}(e),s=SW(0,50,t),o=yield ON(n,{method:"POST",headers:r,body:s});if(!o)return;const a=o.hits.total.value;if(a<=50)return o;const l=[];for(let h=50;h<a;h+=50)l.push(ON(n,{method:"POST",headers:r,body:SW(h,50,t)}));const c=yield Promise.all(l);if(c.some(h=>!h))return;const u=c.map(h=>h.hits.hits);return Object.assign(Object.assign({},o),{hits:Object.assign(Object.assign({},o.hits),{hits:o.hits.hits.concat(...u)})})})}(n,i,t)),o)return function(n,e="",t="",i,r=!1){const o={},a=(0,Tr.get)(n,"hits.hits",[]).map(c=>(0,Tr.get)(c,"_source",{})).map(c=>new TDe(c,e,t,i).toJsonLd());for(const c of a){const u=c["@id"];o[u]?o[u].samples.push(c.samples[0]):o[u]=c}const l=Object.values(o);return r&&(function(n){let e=[],t=0;for(const i of n.filter(r=>r.samples.length>1)){const r=i.samples;for(let s=0;s<r.length;s++){const o=r[s]["@id"];e=e.concat(r[s].datasets);for(const a of r[s].sections)e=e.concat(a.datasets);for(let a=s+1;a<r.length;a++)r[a].sections.find(c=>c["@id"]===o)&&(r[s].deleteMe=!0,t++)}i.samples=r.filter(s=>!0!==s.deleteMe)}t>0&&console.log(`\u26a0 ${t} sections identified as blocks`)}(l),console.log(l.map(c=>Object.assign({"@context":EW},c)))),{"@context":EW,"@graph":l}}(o,r,s,i);console.warn(`Unable to load ${n} as HuBMAP Data`)})}function pb(n,e,t){const i=new Set;for(const r of e)for(const s of(0,Zn.readQuads)(n,r,t,null,null))i.add(s.object.id);return i}function Cx(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,Zn.readQuads)(n,c,hi.donor,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function xW(n,e,t){var i,r;const s=new Map,o=new Set;for(const c of e)for(const u of(0,Zn.readQuads)(n,c,hi.spatialEntity,null,null))o.add(u.object.id),s.has(u.object.id)?null===(i=s.get(u.object.id))||void 0===i||i.push(c):s.set(u.object.id,[c]);const a=t(o),l=new Set;for(const c of a)for(const u of null!==(r=s.get(c))&&void 0!==r?r:[])l.add(u);return l}function gb(n,e){return function(t){n.has(t.id)&&e.add(t.id)}}function TW(n,e,t){const i=new Set;for(const r of t){const s=Zn.DataFactory.namedNode(r);n.forSubjects(gb(e,i),sr.spatialEntity.ccf_annotations,s,null)}return i}function AW(n,e){const t=function(n,e){const t=new Map;for(const i of n)for(const r of(0,Zn.readQuads)(e,i,hi.spatialEntity,null,null))t.has(r.object.id)?t.get(r.object.id).add(i):t.set(r.object.id,new Set([i]));return t}(n,e),i=new Map;for(const r of t.keys()){const s=t.get(r);for(const o of(0,Zn.readQuads)(e,r,sr.spatialEntity.ccf_annotations,null,null))if(i.has(o.object.id)){const a=i.get(o.object.id);s.forEach(l=>a.add(l))}else i.set(o.object.id,new Set(s))}return i}function YDe(n,e,t){const i={"@id":e,"@type":"OntologyTreeNode",id:e,parent:"",children:[],synonymLabels:[],label:""},r={[sr.ontologyNode.label.id]:"label",[t]:"parent",[sr.ontologyNode.synonymLabels.id]:"synonymLabels"};for(const[s,o]of DN(n,e,r))"synonymLabels"===s?i.synonymLabels.push(o):i[s]=o;return i.children=n.getSubjects(t,e,null).map(s=>s.id),i}function MW(n,e,t,i){const r={root:e,nodes:{}},s=new Set;for(const a of(0,Zn.readQuads)(n,null,i,null,null))s.add(a.subject.id),s.add(a.object.id);for(const a of s)r.nodes[a]=YDe(n,a,i);r.nodes[e]||(r.nodes[e]={"@id":e,"@type":"OntologyTreeNode",id:e,label:t,children:[],synonymLabels:[]});const o=n.getSubjects(i,e,null).map(a=>a.id).sort((a,l)=>r.nodes[a].label.localeCompare(r.nodes[l].label));return r.nodes[e].children=o,r}const xx={[hi.label.id]:"label",[hi.description.id]:"description",[hi.link.id]:"link"},QDe=Object.assign(Object.assign({},xx),{[hi.providerName.id]:"providerName"}),ZDe=Object.assign(Object.assign({},xx),{[hi.technology.id]:"technology",[hi.thumbnail.id]:"thumbnail"}),JDe=Object.assign(Object.assign({},xx),{[hi.sampleType.id]:"sampleType",[hi.sectionNumber.id]:"sectionNumber",[hi.datasets.id]:"datasets"}),eIe=Object.assign(Object.assign({},xx),{[hi.sampleType.id]:"sampleType",[hi.sectionCount.id]:"sectionCount",[hi.sectionSize.id]:"sectionSize",[hi.sectionUnits.id]:"sectionUnits",[hi.donor.id]:"donor",[hi.spatialEntity.id]:"spatialEntityId",[hi.sections.id]:"sections",[hi.datasets.id]:"datasets"});function tIe(n,e){return bm(n,e,"Donor",QDe)}function DW(n,e){return bm(n,e,"Dataset",ZDe)}function nIe(n,e){const t={"@id":e,"@type":"Sample",datasets:[]};for(const[i,r]of DN(n,e,JDe))if("datasets"===i){const s=DW(n,r);t[i].push(s)}else t[i]=r;return t}class rIe{constructor(e){this.database=e,this.connect()}toJson(){return{status:this.status,message:this.message,checkback:"Ready"===this.status||"Error"===this.status?36e5:2e3,loadTime:this.loadTime}}connect(){this.status="Loading",this.message="Loading database";const e=Date.now();return this.database.connect().then(t=>Ri(this,void 0,void 0,function*(){t?(this.message="Building scene",yield this.database.getScene(),this.message="Building tissue block results",yield this.database.getTissueBlockResults(),this.message="Aggregating results",yield this.database.getAggregateResults(),this.status="Ready",this.message="Database successfully loaded"):(this.status="Error",this.message="Unknown error while loading database")})).catch(t=>{var i;this.status="Error",this.message=null!==(i=null==t?void 0:t.message)&&void 0!==i?i:"Unknown error while loading database"}).finally(()=>{this.loadTime=Date.now()-e})}}const sIe={ccfOwlUrl:"https://purl.org/ccf/latest/ccf.owl",ccfContextUrl:"https://purl.org/ccf/latest/ccf-context.jsonld",dataSources:[],hubmapDataService:"static",hubmapPortalUrl:"https://portal.hubmapconsortium.org/",hubmapDataUrl:"",hubmapAssetsUrl:"https://assets.hubmapconsortium.org"};class oIe{constructor(e=sIe){this.options=e,this.store=new Zn.Store(void 0,{factory:Zn.DataFactory}),this.graph=new vW(this),this.scene=new bW(this)}connect(e,t=!1){return Ri(this,void 0,void 0,function*(){return e&&(this.options=e),this.initializing||(this.initializing=t?this.cachedConnect():this.doConnect()),yield this.initializing,this.store.size>0})}cachedConnect(){return Ri(this,void 0,void 0,function*(){const e=(new Date).getTime(),t="ccf-database.last_modified",i="ccf-database",r=yield gW(t).catch(()=>{});let s;r&&e-new Date(+r).getTime()>36e5?yield function(n,e=gc()){return e("readwrite",t=>(n.forEach(i=>t.delete(i)),cu(t.transaction)))}([i,t]).catch(()=>{}):s=yield gW(i).catch(()=>{}),s?yield this.deserialize(s):(yield this.doConnect(),function(n,e=gc()){return e("readwrite",t=>(n.forEach(i=>t.put(i[1],i[0])),cu(t.transaction)))}([[i,this.serialize()],[t,""+e]]).catch(()=>{}))})}doConnect(){var e,t;return Ri(this,void 0,void 0,function*(){const i=[],r=null!==(t=null===(e=this.options.dataSources)||void 0===e?void 0:e.concat())&&void 0!==t?t:[],s=this.options.ccfOwlUrl;if(s.startsWith("{"))this.store=(0,Zn.deserializeN3Store)(s,Zn.DataFactory);else if(s.endsWith(".n3store.json")){const o=yield fetch(s).then(a=>a.text()).catch(()=>console.log("Couldn't locate serialized store."));o&&(this.store=(0,Zn.deserializeN3Store)(o,Zn.DataFactory))}else(null==s?void 0:s.length)>0&&r.push(s);this.options.hubmapDataUrl&&(this.options.hubmapDataUrl.endsWith("jsonld")?r.push(this.options.hubmapDataUrl):i.push(CW(this.options.hubmapDataUrl,this.options.hubmapDataService,this.options.hubmapQuery,this.options.hubmapToken,this.options.hubmapAssetsUrl,this.options.hubmapPortalUrl).then(o=>{if(o)return this.addDataSources([o])}))),i.push(this.addDataSources(r)),yield Promise.all(i),yield this.synchronize()})}addDataSources(e,t){return Ri(this,void 0,void 0,function*(){const i=null!=t?t:this.store;return yield Promise.all(e.map(r=>Ri(this,void 0,void 0,function*(){"string"==typeof r?r.endsWith("jsonld")?yield(0,Zn.addJsonLdToStore)(r,i):r.endsWith("n3")?yield(0,Zn.addN3ToStore)(r,i):r.endsWith("rdf")||r.endsWith("owl")||r.endsWith("xml")?yield(0,Zn.addRdfXmlToStore)(r,i):yield(0,Zn.addJsonLdToStore)(r,i):yield(0,Zn.addJsonLdToStore)(r,i)}))),this})}synchronize(){return Ri(this,void 0,void 0,function*(){return yield new Promise(e=>{setTimeout(e,500)}),this.graph.createGraph(),this})}serialize(){return(0,Zn.serializeN3Store)(this.store)}deserialize(e){return Ri(this,void 0,void 0,function*(){this.store=(0,Zn.deserializeN3Store)(e,Zn.DataFactory),this.graph=new vW(this),this.scene=new bW(this),yield new Promise(t=>{setTimeout(t,10)})})}getIds(e={}){return function(n,e){var t,i,r,s,o,a;let l=function(n){const e=new Set;return n.forSubjects(t=>e.add(t.id),hi.spatialEntity,null,null),e}(n);if(l.size>0&&(l=function(n,e,t=!0){const i=new Set;if(n.forSubjects(gb(e,i),hi.spatialEntity,null,null),!t){const r=new Set;return e.forEach(s=>i.has(s)?void 0:r.add(s)),r}return i}(n,l)),l.size>0&&("Male"===e.sex||"Female"===e.sex)){const c=e.sex;l=Cx(n,l,u=>function(n,e,t){const i=new Set;return n.forSubjects(gb(e,i),hi.sex,hi[t],null),i}(n,u,c))}if(l.size>0&&(null===(t=e.tmc)||void 0===t?void 0:t.length)>0&&(l=Cx(n,l,c=>function(n,e,t){const i=new Set;for(const r of t){const s=Zn.DataFactory.literal(r);n.forSubjects(gb(e,i),hi.providerName,s,null)}return i}(n,c,e.tmc))),l.size>0&&(null===(i=e.technologies)||void 0===i?void 0:i.length)>0&&(l=function(n,e,t){var i,r;const s=new Map,o=new Set,a=new Set(e);for(const u of e)for(const h of(0,Zn.readQuads)(n,u,hi.sections,null,null))a.add(h.object.id);for(const u of a)for(const h of(0,Zn.readQuads)(n,u,hi.datasets,null,null))o.add(h.object.id),s.has(h.object.id)?null===(i=s.get(h.object.id))||void 0===i||i.push(u):s.set(h.object.id,[u]);const l=t(o),c=new Set;for(const u of l)for(const h of null!==(r=s.get(u))&&void 0!==r?r:[])c.add(h);return c}(n,l,c=>function(n,e,t){const i=new Set;for(const r of t){const s=Zn.DataFactory.literal(r);n.forSubjects(gb(e,i),hi.technology,s,null)}return i}(n,c,e.technologies))),l.size>0&&(null===(r=e.ontologyTerms)||void 0===r?void 0:r.length)>0){const c=e.ontologyTerms;-1===c.indexOf(uu.body.id)&&(l=xW(n,l,u=>TW(n,u,c)))}if(l.size>0&&(null===(s=e.cellTypeTerms)||void 0===s?void 0:s.length)>0){const c=e.cellTypeTerms;-1===c.indexOf(uu.cell.id)&&(l=xW(n,l,u=>function(n,e,t){const i=new Set;for(const r of t)n.forObjects(s=>{i.add(s.id)},r,sr.asctb.located_in,null),r===uu.cell.id&&i.add(uu.body.id);return TW(n,e,[...i])}(n,u,c)))}if(l.size>0&&2===(null===(o=e.ageRange)||void 0===o?void 0:o.length)&&(0,Tr.isFinite)(e.ageRange[0])&&(0,Tr.isFinite)(e.ageRange[1])){const c=Math.max(...e.ageRange),u=Math.min(...e.ageRange);1===u&&110===c||(l=Cx(n,l,h=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Zn.readQuads)(n,s,hi.age,null,null)){const a=(0,wx.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,h,u,c)))}if(l.size>0&&2===(null===(a=e.bmiRange)||void 0===a?void 0:a.length)&&(0,Tr.isFinite)(e.bmiRange[0])&&(0,Tr.isFinite)(e.bmiRange[1])){const c=Math.max(...e.bmiRange),u=Math.min(...e.bmiRange);13===u&&83===c||(l=Cx(n,l,h=>function(n,e,t,i){const r=new Set;for(const s of e)for(const o of(0,Zn.readQuads)(n,s,hi.bmi,null,null)){const a=(0,wx.fromRdf)(o.object);a>=t&&a<=i&&r.add(s)}return r}(n,h,u,c)))}return l}(this.store,e)}get(e){return this.store.getQuads(Zn.DataFactory.namedNode(e),null,null,null)}search(e={}){return[...this.getIds(e)].map(t=>this.get(t))}getSpatialEntities(e){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t=n.getObjects(Zn.DataFactory.namedNode(e),hi.spatialEntity,null);if(t.length>0)return qf(n,t[0].id)}(this.store,t))}getDatabaseStatus(){return Ri(this,void 0,void 0,function*(){return this.status||(this.status=new rIe(this)),this.status.toJson()})}getDatasetTechnologyNames(){return Ri(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Zn.readQuads)(n,null,hi.technology,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getProviderNames(){return Ri(this,void 0,void 0,function*(){return function(n){const e=new Set;for(const t of(0,Zn.readQuads)(n,null,hi.providerName,null,null))e.add(t.object.value);return Array.from(e).sort()}(this.store)})}getTissueBlockResults(e){return Ri(this,void 0,void 0,function*(){return e=Object.assign(Object.assign({},e),{hasSpatialEntity:!0}),[...this.getIds(e)].map(t=>function(n,e){const t={"@id":e,"@type":"Sample",sections:[],datasets:[]};for(const[i,r]of DN(n,e,eIe))if("sections"===i){const s=nIe(n,r);t[i].push(s)}else if("datasets"===i){const s=DW(n,r);t[i].push(s)}else t[i]="donor"===i?tIe(n,r):r;return t}(this.store,t))})}getAggregateResults(e){return Ri(this,void 0,void 0,function*(){return function(n,e){const t=pb(e,n,hi.donor.id),i=pb(e,t,hi.providerUUID.id),r=new Set;for(const l of n)for(const c of(0,Zn.readQuads)(e,l,hi.spatialEntity,null,null))r.add(c.subject.id);const s=pb(e,r,hi.sections.id),o=new Set([...pb(e,r,hi.datasets.id),...pb(e,s,hi.datasets.id)]);return Object.entries({"Tissue Data Providers":i.size,Donors:t.size,"Tissue Blocks":r.size,"Tissue Sections":s.size,"Tissue Datasets":o.size}).map(([l,c])=>({label:l,count:c}))}(this.getIds(e),this.store)})}getOntologyTermOccurences(e){return Ri(this,void 0,void 0,function*(){return function(n,e){const t={};return AW(n,e).forEach((r,s)=>{t[s]=r.size}),t}(this.getIds(e),this.store)})}getCellTypeTermOccurences(e){return Ri(this,void 0,void 0,function*(){return function(n,e){var t,i;const r=AW(n,e),s=new Map;for(const a of r.keys()){const l=r.get(a);for(const c of(0,Zn.readQuads)(e,null,sr.asctb.located_in,a,null)){const u=c.subject.id;if(s.has(u)){const h=s.get(u);l.forEach(p=>h.add(p))}else s.set(u,new Set(l))}}const o={};return s.forEach((a,l)=>{o[l]=a.size}),o[uu.cell.id]=null!==(i=null===(t=r.get(uu.body.id))||void 0===t?void 0:t.size)&&void 0!==i?i:0,o}(this.getIds(e),this.store)})}getOntologyTreeModel(){return Ri(this,void 0,void 0,function*(){return function(n){const e=MW(n,uu.body.id,"body",sr.asctb.part_of.id);return e.nodes[uu.body.id].children=["http://purl.obolibrary.org/obo/UBERON_0000955","http://purl.obolibrary.org/obo/UBERON_0000029","http://purl.obolibrary.org/obo/UBERON_0000970","http://purl.obolibrary.org/obo/UBERON_0003889","http://purl.obolibrary.org/obo/UBERON_0000948","http://purl.obolibrary.org/obo/UBERON_0002113","http://purl.obolibrary.org/obo/UBERON_0001465","http://purl.obolibrary.org/obo/UBERON_0002107","http://purl.obolibrary.org/obo/UBERON_0002048","http://purl.obolibrary.org/obo/UBERON_0000992","http://purl.obolibrary.org/obo/UBERON_0001264","http://purl.obolibrary.org/obo/UBERON_0001270","http://purl.obolibrary.org/obo/UBERON_0002367","http://purl.obolibrary.org/obo/UBERON_0002097","http://purl.obolibrary.org/obo/UBERON_0002108","http://purl.obolibrary.org/obo/UBERON_0000059","http://purl.obolibrary.org/obo/UBERON_0002106","http://purl.obolibrary.org/obo/UBERON_0002370","http://purl.obolibrary.org/obo/UBERON_0000056","http://purl.obolibrary.org/obo/UBERON_0001255","http://purl.obolibrary.org/obo/UBERON_0000995","http://purl.obolibrary.org/obo/UBERON_0004537"].filter(t=>t in e.nodes),e}(this.store)})}getCellTypeTreeModel(){return Ri(this,void 0,void 0,function*(){return function(n){return MW(n,uu.cell.id,"cell",sr.asctb.ct_is_a.id)}(this.store)})}getReferenceOrgans(){return Ri(this,void 0,void 0,function*(){return this.scene.getReferenceOrgans()})}getScene(e){return Ri(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getScene(e)})}getReferenceOrganScene(e,t){return Ri(this,void 0,void 0,function*(){return this.graph.createGraph(),this.scene.getReferenceOrganScene(e,t)})}getSpatialPlacement(e,t){return Ri(this,void 0,void 0,function*(){return this.graph.getSpatialPlacement(e,t)})}}const aIe=["bodyCanvas"];let lIe=(()=>{class n{constructor(){this.clsName="ccf-body-ui",this.rotationChange=new hn,this.nodeDrag=new hn,this.nodeClick=new hn,this.nodeHoverStart=new hn,this.nodeHoverStop=new hn,this.initialized=new hn,this._interactive=!0,this._rotation=0,this._rotationX=0,this._zoom=9.5,this._target=[0,0,0],this._scene=[],this.subscriptions=[]}get scene(){return this._scene}set scene(t){var i;this._scene=t,null===(i=this.bodyUI)||void 0===i||i.setScene(t)}get rotation(){return this._rotation}set rotation(t){var i;this._rotation=t,null===(i=this.bodyUI)||void 0===i||i.setRotation(t)}get rotationX(){return this._rotationX}set rotationX(t){var i;this._rotationX=t,null===(i=this.bodyUI)||void 0===i||i.setRotationX(t)}get zoom(){return this._zoom}set zoom(t){var i;this._zoom=t,null===(i=this.bodyUI)||void 0===i||i.setZoom(t)}get target(){return this._target}set target(t){var i;this._target=t,null===(i=this.bodyUI)||void 0===i||i.setTarget(t)}get bounds(){return this._bounds}set bounds(t){this._bounds=t,this.zoomToBounds(t)}get camera(){return this._camera}set camera(t){this._camera=t}get interactive(){return this._interactive}set interactive(t){this._interactive=t,this.bodyUI&&this.recreateBodyUI()}ngAfterViewInit(){this.setupBodyUI()}zoomToBounds(t,i={x:48,y:48}){if(this.bodyCanvas){const{width:r,height:s}=this.bodyCanvas.nativeElement,o=window.devicePixelRatio,a=Math.min(Math.log2((r-i.x)/o/t.x),Math.log2((s-i.y)/o/t.y));this.zoom=a}}setupBodyUI(){var t;return Ri(this,void 0,void 0,function*(){const i=this.bodyCanvas.nativeElement,r=new bye({id:"body-ui",canvas:i,zoom:this.zoom,target:[0,0,0],rotation:0,minRotationX:-75,maxRotationX:75,interactive:this.interactive,camera:this.camera});i.addEventListener("contextmenu",s=>s.preventDefault()),yield r.initialize(),this.bodyUI=r,window.bodyUI=r,(null===(t=this.scene)||void 0===t?void 0:t.length)>0&&this.bodyUI.setScene(this.scene),this.bounds&&this.zoomToBounds(this.bounds),this.subscriptions=[this.bodyUI.sceneRotation$.subscribe(s=>this.rotationChange.next(s)),this.bodyUI.nodeDrag$.subscribe(s=>this.nodeDrag.emit(s)),this.bodyUI.nodeClick$.subscribe(s=>this.nodeClick.emit(s)),this.bodyUI.nodeHoverStart$.subscribe(s=>this.nodeHoverStart.emit(s)),this.bodyUI.nodeHoverStop$.subscribe(s=>this.nodeHoverStop.emit(s))],this.initialized.emit()})}recreateBodyUI(){this.clearSubscriptions(),this.bodyUI.finalize(),this.setupBodyUI()}clearSubscriptions(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}ngOnDestroy(){this.clearSubscriptions()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-body-ui"]],viewQuery:function(t,i){if(1&t&&Ir(aIe,5,En),2&t){let r;gi(r=mi())&&(i.bodyCanvas=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&Fc(i.clsName)},inputs:{scene:"scene",rotation:"rotation",rotationX:"rotationX",zoom:"zoom",target:"target",bounds:"bounds",camera:"camera",interactive:"interactive"},outputs:{rotationChange:"rotationChange",nodeDrag:"nodeDrag",nodeClick:"nodeClick",nodeHoverStart:"nodeHoverStart",nodeHoverStop:"nodeHoverStop",initialized:"initialized"},decls:2,vars:0,consts:[[1,"body-ui"],["bodyCanvas",""]],template:function(t,i){1&t&&xi(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{height:100%;display:block}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{position:relative!important;background-color:#000;border-radius:.5rem}"]}),n})(),cIe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[Zr]]}),n})();new zt("Maximum number of autocomplete options displayed",{providedIn:"root",factory:()=>10});const OW=[{src:"app:skin",organ:"Skin",name:"Skin",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002097"},{src:"app:brain",organ:"Brain",name:"Brain",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000955"},{disabled:!0,src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000029"},{src:"app:lymph-nodes",organ:"Lymph Node",name:"Lymph Node",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002509"},{disabled:!0,src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000970"},{src:"app:eye",organ:"Eye",name:"Eye, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004548"},{src:"app:eye",organ:"Eye",name:"Eye, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_54449"},{disabled:!0,src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0003889"},{src:"app:fallopian-tube-left",organ:"Fallopian Tube",name:"Fallopian Tube, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001303"},{src:"app:fallopian-tube-right",organ:"Fallopian Tube",name:"Fallopian Tube, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0001302"},{src:"app:heart",organ:"Heart",name:"Heart",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000948"},{disabled:!0,src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002113"},{src:"app:kidney-left",organ:"Kidney",name:"Kidney, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004538"},{src:"app:kidney-right",organ:"Kidney",name:"Kidney, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004539"},{disabled:!0,src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001465"},{src:"app:knee",organ:"Knee",name:"Knee, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24978"},{src:"app:knee",organ:"Knee",name:"Knee, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/FMA_24977"},{src:"app:liver",organ:"Liver",name:"Liver",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002107"},{disabled:!0,src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002048"},{src:"app:lung",organ:"Lung",name:"Lungs",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001004"},{disabled:!0,src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000992"},{src:"app:ovary-left",organ:"Ovary",name:"Ovary, L",side:"left",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7214"},{src:"app:ovary-right",organ:"Ovary",name:"Ovary, R",side:"right",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/FMA_7213"},{src:"app:pancreas",organ:"Pancreas",name:"Pancreas",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001264"},{src:"app:pelvis-f",organ:"Pelvis",name:"Pelvis",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001270"},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0002367",disabled:!0},{src:"app:prostate",organ:"Prostate",name:"Prostate",hasSex:!1,sex:"male",id:"http://purl.obolibrary.org/obo/UBERON_0000079"},{src:"app:small-intestine",organ:"Small Intestine",name:"Small Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002108"},{src:"app:large-intestine",organ:"Large Intestine",name:"Large Intestine",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000059"},{src:"app:spleen",organ:"Spleen",name:"Spleen",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002106"},{src:"app:thymus",organ:"Thymus",name:"Thymus",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002370"},{disabled:!0,src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0000056"},{src:"app:ureter-left",organ:"Ureter",name:"Ureter, L",side:"left",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001223"},{src:"app:ureter-right",organ:"Ureter",name:"Ureter, R",side:"right",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001222"},{src:"app:bladder",organ:"Urinary Bladder",name:"Urinary Bladder",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0001255"},{src:"app:uterus",organ:"Uterus",name:"Uterus",hasSex:!1,sex:"female",id:"http://purl.obolibrary.org/obo/UBERON_0000995"},{src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0004537"},{disabled:!0,src:"app:vasculature-thick",organ:"Blood Vasculature",name:"Blood Vasculature",hasSex:!0,id:"http://purl.obolibrary.org/obo/UBERON_0002049"}].sort((n,e)=>n.name.localeCompare(e.name));OW.filter(n=>!0!==n.disabled);let Sm=(()=>{let n=class extends aTe{constructor(){super(...arguments),this.optionCache=new Map}get config$(){return this.state$.pipe(Wi(n=>null!=n),La(1))}setConfig(t){this.setState(t)}patchConfig(t){this.patchState(t)}getProperty(t){return this.config$.pipe(K6(...t),Qu(),La(1))}getOption(...t){const i=this.getPathKey(t);if(this.optionCache.has(i))return this.optionCache.get(i);const r=this.config$.pipe(K6(...t),Qu(),La(1));return this.optionCache.set(i,r),r}getPathKey(t){return`${t.length}:${t.join(".")}`}};return n.\u0275fac=function(){let e;return function(i){return(e||(e=Gi(n)))(i||n)}}(),n.\u0275prov=$e({token:n,factory:n.\u0275fac}),Or([JG()],n.prototype,"config$",null),n=Or([rTe(),bve({name:"globalConfig",defaults:null})],n),n})();!function(){const n=localStorage.getItem("ALLOW_TELEMETRY");null===n||n.toLowerCase()}();class RW extends class{getDatabaseStatus(){return this.forwardCall("getDatabaseStatus")}getProviderNames(){return this.forwardCall("getProviderNames")}getDatasetTechnologyNames(){return this.forwardCall("getDatasetTechnologyNames")}getOntologyTreeModel(){return this.forwardCall("getOntologyTreeModel")}getCellTypeTreeModel(){return this.forwardCall("getCellTypeTreeModel")}getReferenceOrgans(){return this.forwardCall("getReferenceOrgans")}getTissueBlockResults(e){return this.forwardCall("getTissueBlockResults",e)}getAggregateResults(e){return this.forwardCall("getAggregateResults",e)}getOntologyTermOccurences(e){return this.forwardCall("getOntologyTermOccurences",e)}getCellTypeTermOccurences(e){return this.forwardCall("getCellTypeTermOccurences",e)}getScene(e){return this.forwardCall("getScene",e)}getReferenceOrganScene(e,t){return this.forwardCall("getReferenceOrganScene",e,t)}}{forwardCall(e,...t){return this.impl$.pipe(Jr(i=>i[e](...t)))}}let PW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const RN=new se,mb={cacheBusterObserver:RN},Cm={cacheBusterObserver:RN,maxCacheCount:4};function NW(n,e,t){return n?{min:n[0]>e?n[0]:void 0,max:n[1]<t?n[1]:void 0}:void 0}function FW(n){return n.map(e=>{var t;return Object.assign(Object.assign({},e),{transformMatrix:new $n(null!==(t=e.transformMatrix)&&void 0!==t?t:[])})})}let UIe=(()=>{class n{constructor(t,i){this.api=t,this.globalConfig=i,i.getOption("hubmapToken").subscribe(RN)}getDatabaseStatus(){return this.doRequest(t=>this.api.dbStatus(t))}getProviderNames(){return this.doRequest(t=>this.api.providerNames(t))}getDatasetTechnologyNames(){return this.doRequest(t=>this.api.technologyNames(t))}getOntologyTreeModel(){return this.doRequest(t=>this.api.ontologyTreeModel(t),void 0,{},n=>n)}getCellTypeTreeModel(){return this.doRequest(t=>this.api.cellTypeTreeModel(t),void 0,{},n=>n)}getReferenceOrgans(){return this.doRequest(t=>this.api.referenceOrgans(t),void 0,{},n=>n)}getTissueBlockResults(t){return this.doRequest(i=>this.api.tissueBlocks(i),t,{},n=>n)}getAggregateResults(t){return this.doRequest(i=>this.api.aggregateResults(i),t)}getOntologyTermOccurences(t){return this.doRequest(i=>this.api.ontologyTermOccurences(i),t)}getCellTypeTermOccurences(t){return this.doRequest(i=>this.api.cellTypeTermOccurences(i),t)}getScene(t){return this.doRequest(i=>this.api.scene(i),t,{},FW)}getReferenceOrganScene(t,i){return this.doRequest(r=>this.api.referenceOrganScene(r),i,{organIri:t},FW)}doRequest(t,i,r,s){const{api:o,globalConfig:a}=this,l=Object.assign(Object.assign({},function(n){var e,t;return{age:NW(null==n?void 0:n.ageRange,1,110),bmi:NW(null==n?void 0:n.bmiRange,13,83),sex:null===(t=null===(e=null==n?void 0:n.sex)||void 0===e?void 0:e.toLowerCase)||void 0===t?void 0:t.call(e),ontologyTerms:null==n?void 0:n.ontologyTerms,cellTypeTerms:null==n?void 0:n.cellTypeTerms,providers:null==n?void 0:n.tmc,technologies:null==n?void 0:n.technologies}}(i)),r);return function(...n){let e,t;return Se(n[n.length-1])&&(t=n.pop()),"function"==typeof n[n.length-1]&&(e=n.pop()),1===n.length&&k(n[0])&&(n=n[0]),Mn(n,t).lift(new JH(e))}([a.getOption("remoteApiEndpoint"),a.getOption("hubmapToken")]).pipe(zr(1),ur(([c,u])=>{o.configuration.basePath=c,u&&(l.token=u)}),Jr(()=>t(l)),me(c=>s?s(c):c))}}return n.\u0275fac=function(t){return new(t||n)(De(pW),De(Sm))},n.\u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"}),Or([pc(mb)],n.prototype,"getProviderNames",null),Or([pc(mb)],n.prototype,"getDatasetTechnologyNames",null),Or([pc(mb)],n.prototype,"getOntologyTreeModel",null),Or([pc(mb)],n.prototype,"getCellTypeTreeModel",null),Or([pc(mb)],n.prototype,"getReferenceOrgans",null),Or([pc(Cm)],n.prototype,"getTissueBlockResults",null),Or([pc(Cm)],n.prototype,"getAggregateResults",null),Or([pc(Cm)],n.prototype,"getOntologyTermOccurences",null),Or([pc(Cm)],n.prototype,"getCellTypeTermOccurences",null),Or([pc(Cm)],n.prototype,"getScene",null),Or([pc(Cm)],n.prototype,"getReferenceOrganScene",null),n})(),zIe=(()=>{class n extends RW{constructor(t){super(),this.impl$=this.database$=t.config$.pipe(i=>i,Wi(i=>Object.keys(i).length>0),Jr(i=>function(n,e){return new I(t=>{let i,r;try{i=n()}catch(a){return void t.error(a)}try{r=e(i)}catch(a){return void t.error(a)}const o=(r?Ve(r):Uc).subscribe(t);return()=>{o.unsubscribe(),i&&i.unsubscribe()}})}(()=>this.createDatabase(i),r=>this.connectDatabase(r,i))),me(i=>i.database),La(1))}connectDatabase(t,i){return Ri(this,void 0,void 0,function*(){const r=!ra();return yield t.database.connect(i,r),t})}}return n.\u0275fac=function(t){return new(t||n)(De(Sm))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),HIe=(()=>{class n extends zIe{createDatabase(t){return{database:new oIe(t),unsubscribe:()=>{}}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Gi(n)))(i||n)}}(),n.\u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),GIe=(()=>{class n extends RW{constructor(t,i){super(),this.impl$=t.config$.pipe(r=>r,me(r=>this.selectToken(r)),Qu(),me(r=>i.get(r)),La(1))}}return n.\u0275fac=function(t){return new(t||n)(De(Sm),De(jn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})(),$Ie=(()=>{class n{constructor(t){this.source=t,this.organs=OW}getOrganInfo(t,i,r="Female"){let s=this.organs.find(a=>a.id===t);if(!s)return nn(void 0);const o=s.organ;return s.disabled&&(s=this.organs.find(a=>!a.disabled&&a.organ===o)),(null==s?void 0:s.side)&&i&&s.side!==i&&(s=this.organs.find(a=>!a.disabled&&a.organ===o&&a.side===i)),nn(s)}getOrgan(t,i="Both"){return this.source.getReferenceOrgans().pipe(me(r=>r.find(s=>s.representation_of===t.id&&("Both"===i||s.sex===i))))}getOrganScene(t,i="Female"){return t.id?this.source.getReferenceOrganScene(t.id,{ontologyTerms:[t.id],sex:i}):nn([])}getOrganStats(t,i="Female"){return t.id?this.source.getAggregateResults({ontologyTerms:[t.id],sex:i}):nn([])}getBlocks(t,i="Female"){return t.id?this.source.getTissueBlockResults({ontologyTerms:[t.id],sex:i}):nn([])}}return n.\u0275fac=function(t){return new(t||n)(De(PW))},n.\u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const WIe=["thumbContainer"],qIe=["toggleBar"],YIe=["input"],KIe=function(n){return{enterDuration:n}},XIe=["*"],QIe=new zt("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let ZIe=0;const JIe={provide:Ba,useExisting:ge(()=>LW),multi:!0};class eOe{constructor(e,t){this.source=e,this.checked=t}}const tOe=CP(Yv(SP(DC(class{constructor(n){this._elementRef=n}}))));let LW=(()=>{class n extends tOe{constructor(t,i,r,s,o,a){super(t),this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=l=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++ZIe,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new hn,this.toggleChange=new hn,this.tabIndex=parseInt(s)||0,this.color=this.defaultColor=o.color||"accent",this._noopAnimations="NoopAnimations"===a}get required(){return this._required}set required(t){this._required=qi(t)}get checked(){return this._checked}set checked(t){this._checked=qi(t),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?this._inputElement.nativeElement.focus():t||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new eOe(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(t){return new(t||n)(Me(En),Me(td),Me(ss),function(n){return function(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(Db(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(is(),n)}("tabindex"),Me(QIe),Me(dc,8))},n.\u0275cmp=yn({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(t,i){if(1&t&&(Ir(WIe,5),Ir(qIe,5),Ir(YIe,5)),2&t){let r;gi(r=mi())&&(i._thumbEl=r.first),gi(r=mi())&&(i._thumbBarEl=r.first),gi(r=mi())&&(i._inputElement=r.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(t,i){2&t&&(Iu("id",i.id),$i("tabindex",i.disabled?null:-1)("aria-label",null)("aria-labelledby",null),Ti("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked",ariaDescribedby:["aria-describedby","ariaDescribedby"]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Yn([JIe]),In],ngContentSelectors:XIe,decls:16,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,i){if(1&t&&(function(n){const e=Bt()[16][6];if(!e.projection){const i=e.projection=Sc(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?I7(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}(),Nt(0,"label",0,1),Nt(2,"div",2,3),Nt(4,"input",4,5),Bn("change",function(s){return i._onChangeEvent(s)})("click",function(s){return i._onInputClick(s)}),Ft(),Nt(6,"div",6,7),xi(8,"div",8),Nt(9,"div",9),xi(10,"div",10),Ft(),Ft(),Ft(),Nt(11,"span",11,12),Bn("cdkObserveContent",function(){return i._onLabelTextChange()}),Nt(13,"span",13),Ai(14,"\xa0"),Ft(),function(n,e=0,t){const i=Bt(),r=pi(),s=Ud(r,20+n,16,null,t||null);null===s.projection&&(s.projection=e),hs(),64!=(64&s.flags)&&function(n,e,t){F_(e[11],0,e,t,E0(n,t,e),T0(t.parent||e[6],t,e))}(r,i,s)}(15),Ft(),Ft()),2&t){const r=Qp(1),s=Qp(12);$i("for",i.inputId),Kt(2),Ti("mat-slide-toggle-bar-no-side-margin",!s.textContent||!s.textContent.trim()),Kt(2),on("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),$i("name",i.name)("aria-checked",i.checked.toString())("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),Kt(5),on("matRippleTrigger",r)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",function(n,e,t,i){return JL(Bt(),Es(),n,e,t,i)}(18,KIe,i._noopAnimations?0:150))}},directives:[am,P8],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),n})(),kW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({}),n})(),rOe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[kW,OC,gr,GR],kW,gr]}),n})(),sOe=(()=>{class n{constructor(){this.clsName="ccf-slide-toggle",this.labels=["Left","Right"],this.value="Left",this.disabled=!1,this.valueChange=new hn}get left(){const{value:t,labels:i}=this;return t!==i[1]}updateToggle(t){this.value=t?this.labels[0]:this.labels[1],this.valueChange.emit(this.value)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-slide-toggle"]],hostVars:2,hostBindings:function(t,i){2&t&&Fc(i.clsName)},inputs:{labels:"labels",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange"},decls:6,vars:12,consts:[[1,"slide-label",3,"click"],[1,"slider",3,"disabled","checked","change"],["toggle",""]],template:function(t,i){if(1&t){const r=zl();Nt(0,"span",0),Bn("click",function(){Mr(r);const o=Qp(3);return i.left||o.toggle(),i.updateToggle(!0)}),Ai(1),Ft(),Nt(2,"mat-slide-toggle",1,2),Bn("change",function(o){return i.updateToggle(!o.checked)}),Ft(),Nt(4,"span",0),Bn("click",function(){Mr(r);const o=Qp(3);return i.left&&o.toggle(),i.updateToggle(!1)}),Ai(5),Ft()}2&t&&(Ti("disabled",i.disabled)("highlighted",i.left),Kt(1),Ds(i.labels[0].charAt(0).toUpperCase()+i.labels[0].slice(1)),Kt(1),on("disabled",i.disabled)("checked",!i.left),Kt(2),Ti("disabled",i.disabled)("highlighted",!i.left),Kt(1),Ds(i.labels[1].charAt(0).toUpperCase()+i.labels[1].slice(1)))},directives:[LW],styles:["[_nghost-%COMP%]   .slide-label[_ngcontent-%COMP%]{margin:0 1rem;transition:color .6s;cursor:pointer;opacity:50%}[_nghost-%COMP%]   .slide-label.highlighted[_ngcontent-%COMP%]{opacity:100%}[_nghost-%COMP%]   .disabled[_ngcontent-%COMP%]{opacity:30%!important;cursor:not-allowed}[_nghost-%COMP%]     .slider .mat-slide-toggle-bar{background-color:#43476580}[_nghost-%COMP%]     .slider .mat-slide-toggle-thumb{background-color:#434765}"],changeDetection:0}),n})();const oOe=["bodyUI"],aOe=function(){return["Male","Female"]},lOe=function(){return["Left","Right"]};let cOe=(()=>{class n{constructor(t){this.ga=t,this.sexChange=new hn,this.sideChange=new hn}ngAfterViewChecked(){this.updateHighlighting()}updateHighlighting(){var t,i,r,s;const o=new Set(null!==(i=null===(t=this.filter)||void 0===t?void 0:t.tmc)&&void 0!==i?i:[]);this.filteredBlocks=null!==(s=null===(r=this.blocks)||void 0===r?void 0:r.filter(a=>o.has(a.donor.providerName)).map(a=>a["@id"]))&&void 0!==s?s:[],this.bodyUI.scene=this.bodyUI.scene.map(a=>{var l;return Object.assign(Object.assign({},a),{color:a.entityId&&this.highlightedNodeId===a["@id"]?[30,136,229,255]:this.filteredBlocks.includes(null!==(l=a.entityId)&&void 0!==l?l:"")?[173,255,47,229.5]:[255,255,255,229.5]})})}ngOnChanges(t){this.bodyUI&&"organ"in t&&this.zoomToFitOrgan()}updateSex(t){this.sex=t,this.sexChange.emit(this.sex)}updateSide(t){this.side=t,this.sideChange.emit(this.side)}zoomToFitOrgan(){const{bodyUI:t,organ:i}=this;if(i){const{x_dimension:r,y_dimension:s,z_dimension:o}=i;t.rotation=t.rotationX=0,t.bounds={x:1.25*r/1e3,y:1.25*s/1e3,z:1.25*o/1e3},t.target=[r/1e3/2,s/1e3/2,o/1e3/2]}}nodeClicked(t){this.ga.event("node_click","organ",t.node["@id"]),this.highlightedNodeId=this.highlightedNodeId&&this.highlightedNodeId===t.node["@id"]?"":t.node["@id"]}}return n.\u0275fac=function(t){return new(t||n)(Me(mx))},n.\u0275cmp=yn({type:n,selectors:[["ccf-organ"]],viewQuery:function(t,i){if(1&t&&Ir(oOe,7),2&t){let r;gi(r=mi())&&(i.bodyUI=r.first)}},inputs:{organ:"organ",scene:"scene",organIri:"organIri",sex:"sex",side:"side",blocks:"blocks",filter:"filter"},outputs:{sexChange:"sexChange",sideChange:"sideChange"},features:[Ui],decls:5,vars:10,consts:[["camera","perspective",1,"body-ui",3,"scene","interactive","nodeClick","initialized"],["bodyUI",""],[1,"stage-options"],[1,"view-slider",3,"labels","value","hidden","valueChange"]],template:function(t,i){1&t&&(Nt(0,"ccf-body-ui",0,1),Bn("nodeClick",function(s){return i.nodeClicked(s)})("initialized",function(){return i.zoomToFitOrgan()}),Ft(),Nt(2,"div",2),Nt(3,"ccf-slide-toggle",3),Bn("valueChange",function(s){return i.updateSex(s)}),Ft(),Nt(4,"ccf-slide-toggle",3),Bn("valueChange",function(s){return i.updateSide(s)}),Ft(),Ft()),2&t&&(on("scene",i.scene)("interactive",!0),Kt(3),on("labels",Vw(8,aOe))("value",i.sex)("hidden",!i.sex),Kt(1),on("labels",Vw(9,lOe))("value",i.side)("hidden",!i.side))},directives:[lIe,sOe],styles:["[_nghost-%COMP%]{display:block;background-color:#000;border-radius:.5rem;color:#fff;height:100%}[_nghost-%COMP%]   .body-ui[_ngcontent-%COMP%]{height:90%}[_nghost-%COMP%]   .stage-options[_ngcontent-%COMP%]{padding:1rem;min-width:352px}"],changeDetection:0}),n})();function uOe(n,e){if(1&n&&(Nt(0,"div",3),Nt(1,"div",4),Ai(2),Ft(),Nt(3,"div",5),Ai(4),Ft(),Ft()),2&n){const t=e.$implicit;Kt(2),Ds(t.count),Kt(2),Ds(t.label)}}let dOe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-stats-list"]],inputs:{statsLabel:"statsLabel",stats:"stats"},decls:4,vars:2,consts:[[1,"stats-container"],[1,"header"],["class","stats-row",4,"ngFor","ngForOf"],[1,"stats-row"],[1,"stat"],[1,"label"]],template:function(t,i){1&t&&(Nt(0,"div",0),Nt(1,"div",1),Ai(2),Ft(),Ei(3,uOe,5,2,"div",2),Ft()),2&t&&(Kt(2),kc(" ",i.statsLabel," "),Kt(1),on("ngForOf",i.stats))},directives:[Kd],styles:[".stats-container[_ngcontent-%COMP%]{margin-bottom:2rem;min-height:9rem}.stats-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:1rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:1.325rem}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{width:2rem;margin-right:1rem;text-align:right}.stats-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{flex-grow:1;text-align:left}"],changeDetection:0}),n})();function hOe(n,e){if(1&n){const t=zl();Nt(0,"div",6),Nt(1,"div",7),Nt(2,"div",8),Ai(3),Ft(),Nt(4,"div",9),Bn("click",function(){const s=Mr(t).$implicit;return Si().goToURL(s.buttonUrl)}),Ai(5),Ft(),Ft(),Ft()}if(2&n){const t=e.$implicit;Kt(3),Ds(t.body),Kt(1),on("gaLabel",t.buttonUrl),Kt(1),kc(" ",t.buttonTitle,"")}}function fOe(n,e){if(1&n){const t=zl();Nt(0,"div",10),Bn("click",function(){const s=Mr(t).$implicit;return Si().goToURL(s.buttonUrl)}),Ai(1),Ft()}if(2&n){const t=e.$implicit;on("gaLabel",t.buttonUrl),Kt(1),Ds(t.buttonTitle)}}let pOe=(()=>{class n{constructor(){this.linkCards=[{body:"Add tissue blocks using the CCF Registration User Interface (RUI).",buttonTitle:"Register Tissue",buttonUrl:"https://hubmapconsortium.github.io/ccf-ui/rui/"},{body:"Explore tissue sections in tissue blocks with the CCF Exploration User Interface (EUI).",buttonTitle:"Explore Tissue",buttonUrl:"https://portal.hubmapconsortium.org/ccf-eui"},{body:"View linkages between anatomical structures, cell types, and common biomarkers (ASCT+B).",buttonTitle:"ASCT+B Reporter",buttonUrl:"https://hubmapconsortium.github.io/ccf-asct-reporter/"}],this.deepDives=[{body:"",buttonTitle:"CCF Portal",buttonUrl:"https://hubmapconsortium.github.io/ccf/"},{body:"",buttonTitle:"Online Course",buttonUrl:"https://expand.iu.edu/browse/sice/cns/courses/hubmap-visible-human-mooc"},{body:"",buttonTitle:"Paper",buttonUrl:"https://www.biorxiv.org/content/10.1101/2021.05.31.446440v2"}]}goToURL(t){window.open(t,"_blank")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=yn({type:n,selectors:[["ccf-link-cards"]],decls:7,vars:2,consts:[["gaCategory","link-cards",1,"link-cards-container"],["class","link-card",4,"ngFor","ngForOf"],["gaCategory","deep-dive",1,"deep-dive-section"],[1,"title"],[1,"button-container"],["class","btn-outline btn","gaEvent","visit-link",3,"gaLabel","click",4,"ngFor","ngForOf"],[1,"link-card"],[1,"link-card-content"],[1,"body"],["gaEvent","visit-link",1,"link-button","btn",3,"gaLabel","click"],["gaEvent","visit-link",1,"btn-outline","btn",3,"gaLabel","click"]],template:function(t,i){1&t&&(Nt(0,"div",0),Ei(1,hOe,6,3,"div",1),Ft(),Nt(2,"div",2),Nt(3,"div",3),Ai(4,"Common Coordinate Framework (CCF) Deep Dive"),Ft(),Nt(5,"div",4),Ei(6,fOe,2,2,"div",5),Ft(),Ft()),2&t&&(Kt(1),on("ngForOf",i.linkCards),Kt(5),on("ngForOf",i.deepDives))},directives:[lW,Kd,cW],styles:[".link-cards-container[_ngcontent-%COMP%]{max-width:30rem}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:1px;padding-bottom:1px}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]:last-of-type{border-bottom:1px solid #e0e0e0}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]{align-items:center;padding:1rem 0 1rem 1rem;display:flex;flex-direction:row;justify-content:space-between;border-left:6px solid #444A65}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]{margin-left:2rem;background-color:#444a65;color:#fff}.link-cards-container[_ngcontent-%COMP%]   .link-card[_ngcontent-%COMP%]   .link-card-content[_ngcontent-%COMP%]   .link-button[_ngcontent-%COMP%]:hover{background-color:#2f3346}.deep-dive-section[_ngcontent-%COMP%]{margin-top:2rem}.deep-dive-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]{color:#444a65;border:1px solid #444A65;background-color:#fff}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:not(:last-of-type){margin-right:1rem}.deep-dive-section[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .btn-outline[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn[_ngcontent-%COMP%]{min-width:9rem!important;max-height:2.28125rem;text-align:center;white-space:nowrap;cursor:pointer;font-size:.875rem;font-weight:500;border-radius:2px;line-height:2.75;transition:background-color .25s cubic-bezier(.4,0,.2,1) 0ms,box-shadow .25s cubic-bezier(.4,0,.2,1) 0ms,border .25s cubic-bezier(.4,0,.2,1) 0ms;font-family:Inter Variable,Helvetica,Arial,sans-serif}"],changeDetection:0}),n})();const gOe=["left"],mOe=["right"],_Oe=function(){return[]},yOe=[{color:[0,0,0,0],opacity:.001}];let vOe=(()=>{class n{constructor(t,i,r){this.ga=i,this.configState=r,this.sex$=this.configState.getOption("sex"),this.side$=this.configState.getOption("side"),this.filter$=this.configState.getOption("highlightProviders").pipe(me(s=>({tmc:s}))),this.latestConfig={},this.organInfo$=r.config$.pipe(ur(s=>this.latestConfig=s),Jr(s=>{var o,a,l;return t.getOrganInfo(null!==(o=s.organIri)&&void 0!==o?o:"",null===(l=null===(a=s.side)||void 0===a?void 0:a.toLowerCase)||void 0===l?void 0:l.call(a),s.sex)}),ur(s=>this.logOrganLookup(s)),ur(s=>this.latestOrganInfo=s),La(1)),this.organ$=this.organInfo$.pipe(Jr(s=>s?t.getOrgan(s,s.hasSex?this.latestConfig.sex:void 0):nn(void 0)),ur(s=>{var o;if(s&&this.latestOrganInfo){const a=(null===(o=this.latestOrganInfo)||void 0===o?void 0:o.hasSex)?s.sex:void 0;a!==this.latestConfig.sex&&this.updateInput("sex",a),s.side!==this.latestConfig.side&&this.updateInput("side",s.side)}}),La(1)),this.scene$=this.organ$.pipe(Jr(s=>s&&this.latestOrganInfo?t.getOrganScene(this.latestOrganInfo,s.sex):nn(yOe))),this.stats$=this.organ$.pipe(Jr(s=>s&&this.latestOrganInfo?t.getOrganStats(this.latestOrganInfo,s.sex):nn([]))),this.statsLabel$=this.organ$.pipe(me(s=>this.makeStatsLabel(this.latestOrganInfo,null==s?void 0:s.sex)),function(...n){const e=n[n.length-1];return Se(e)?(n.pop(),t=>FC(n,t,e)):t=>FC(n,t)}("Loading...")),this.blocks$=this.organ$.pipe(Jr(s=>s&&this.latestOrganInfo?t.getBlocks(this.latestOrganInfo,s.sex):nn([])))}ngAfterViewInit(){const{left:t,right:i}=this;t.nativeElement.style.height=`${i.nativeElement.offsetHeight}px`}updateInput(t,i){this.configState.patchConfig({[t]:i})}makeStatsLabel(t,i){let r=[`Unknown IRI: ${this.latestConfig.organIri}`];if(t){const s=t.side?t.side.charAt(0).toUpperCase()+t.side.slice(1):void 0;r=[i,t.organ,s]}return r.filter(s=>!!s).join(", ")}logOrganLookup(t){this.ga.event(t?"organ_lookup_success":"organ_lookup_failure","organ",`Iri: ${this.latestConfig.organIri} - Sex: ${this.latestConfig.sex} - Side: ${this.latestConfig.side}`)}}return n.\u0275fac=function(t){return new(t||n)(Me($Ie),Me(mx),Me(Sm))},n.\u0275cmp=yn({type:n,selectors:[["ccf-root"]],viewQuery:function(t,i){if(1&t&&(Ir(gOe,7,En),Ir(mOe,7,En)),2&t){let r;gi(r=mi())&&(i.left=r.first),gi(r=mi())&&(i.right=r.first)}},decls:16,vars:25,consts:[[1,"container"],[1,"left"],["left",""],[3,"blocks","filter","sex","side","organ","scene","sexChange","sideChange"],[1,"right"],["right",""],[3,"statsLabel","stats"]],template:function(t,i){if(1&t&&(Nt(0,"div",0),Nt(1,"div",1,2),Nt(3,"ccf-organ",3),Bn("sexChange",function(s){return i.updateInput("sex",s)})("sideChange",function(s){return i.updateInput("side",s)}),pl(4,"async"),pl(5,"async"),pl(6,"async"),pl(7,"async"),pl(8,"async"),pl(9,"async"),Ft(),Ft(),Nt(10,"div",4,5),xi(12,"ccf-stats-list",6),pl(13,"async"),pl(14,"async"),xi(15,"ccf-link-cards"),Ft(),Ft()),2&t){let r;Kt(3),on("blocks",gl(4,8,i.blocks$))("filter",gl(5,10,i.filter$))("sex",gl(6,12,i.sex$))("side",gl(7,14,i.side$))("organ",gl(8,16,i.organ$))("scene",null!==(r=gl(9,18,i.scene$))&&void 0!==r?r:Vw(24,_Oe)),Kt(9),on("statsLabel",gl(13,20,i.statsLabel$))("stats",gl(14,22,i.stats$))}},directives:[cOe,dOe,pOe],pipes:[fE],styles:[".container[_ngcontent-%COMP%]{height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;display:flex;flex-direction:row;padding:1rem;font-family:Inter;font-size:.95rem;line-height:1.5;text-align:left;position:relative;background-color:#fff;color:#000}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{width:auto;flex-grow:1}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:2rem;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;width:29rem}"],changeDetection:0}),n})();function bOe(n,e){1&n&&xi(0,"ccf-root")}function wOe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){const i=tD.json(n);if(t(i))return i}else if(t(n))return n;throw new Error("Invalid data sources")}function EOe(n){const e=i=>"string"==typeof i,t=i=>Array.isArray(i)&&i.every(e);if("string"==typeof n){if(!(null==n?void 0:n.startsWith("[")))return[n];{const i=tD.json(n);if(t(i))return i}}else if(t(n))return n;throw new Error("Invalid data sources")}let SOe=(()=>{class n extends xee{constructor(t,i){super(t,i,{initialDelay:10,initialConfig:Object.assign(Object.assign({},pf.dbOptions),globalThis.dbOptions),parse:{dataSources:wOe,highlightProviders:EOe,useRemoteApi:tD.boolean}}),this.sex="Female",this.side="Left"}}return n.\u0275fac=function(t){return new(t||n)(Me(Sm),Me(ss))},n.\u0275cmp=yn({type:n,selectors:[["ccf-root-wc"]],inputs:{organIri:"organIri",sex:"sex",side:"side",dataSources:"dataSources",highlightProviders:"highlightProviders",hubmapDataService:"hubmapDataService",hubmapDataUrl:"hubmapDataUrl",hubmapAssetUrl:"hubmapAssetUrl",hubmapToken:"hubmapToken",hubmapPortalUrl:"hubmapPortalUrl",useRemoteApi:"useRemoteApi",remoteApiEndpoint:"remoteApiEndpoint"},features:[In],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,i){1&t&&Ei(0,bOe,1,0,"ccf-root",0),2&t&&on("ngIf",i.initialized)},directives:[ku,vOe],encapsulation:2,changeDetection:0}),n})(),COe=(()=>{class n extends GIe{selectToken(t){return t.useRemoteApi&&t.remoteApiEndpoint?UIe:HIe}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Gi(n)))(i||n)}}(),n.\u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),xOe=(()=>{class n{constructor(t,i){this.accessor=t,this.injector=i}static forRoot(t=[]){return{ngModule:n,providers:[us,Ga,qG,...t]}}}return n.\u0275fac=function(t){return new(t||n)(De(us,2),De(Ga,2))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({}),n})();const Ax=(n,e)=>((n,e)=>new Array(e+1).join("0"))(0,e-n.toString().length)+n;class MOe{constructor(e,t,i){this.action=e,this.store=t,this.logWriter=i}dispatched(e){const t=If(this.action),i=function(n){return Ax(n.getHours(),2)+":"+Ax(n.getMinutes(),2)+":"+Ax(n.getSeconds(),2)+"."+Ax(n.getMilliseconds(),3)}(new Date);this.logWriter.startGroup(`action ${t} @ ${i}`),this._hasPayload(this.action)&&this.logWriter.logGrey("payload",Object.assign({},this.action)),this.logWriter.logGrey("prev state",e)}completed(e){this.logWriter.logGreen("next state",e),this.logWriter.endGroup()}errored(e){this.logWriter.logRedish("next state after error",this.store.snapshot()),this.logWriter.logRedish("error",e),this.logWriter.endGroup()}_hasPayload(e){return this._getNonEmptyProperties(e).length>0}_getNonEmptyProperties(e){return Object.keys(e).map(r=>e[r]).filter(r=>void 0!==r)}}class DOe{constructor(e){this.options=e,this.options=this.options||{},this.logger=e.logger||console}startGroup(e){const t=this.options.collapsed?this.logger.groupCollapsed:this.logger.group;try{t.call(this.logger,e)}catch(i){console.log(e)}}endGroup(){try{this.logger.groupEnd()}catch(e){this.logger.log("\u2014\u2014 log end \u2014\u2014")}}logGrey(e,t){this.log(e,"color: #9E9E9E; font-weight: bold",t)}logGreen(e,t){this.log(e,"color: #4CAF50; font-weight: bold",t)}logRedish(e,t){this.log(e,"color: #FD8182; font-weight: bold",t)}log(e,t,i){this.isIE()?this.logger.log(e,i):this.logger.log("%c "+e,t,i)}isIE(){const e="undefined"!=typeof window&&window.navigator.userAgent?window.navigator.userAgent:"";let t=!1;const i=e.indexOf("MSIE "),r=e.indexOf("Trident/");return(i>-1||r>-1)&&(t=!0),t}}const BW=new zt("NGXS_LOGGER_PLUGIN_OPTIONS");let IOe=(()=>{class n{constructor(t,i){this._options=t,this._injector=i}handle(t,i,r){if(this._options.disabled||!this._options.filter(i,t))return r(t,i);this._logWriter=this._logWriter||new DOe(this._options),this._store=this._store||this._injector.get(lh);const s=new MOe(i,this._store,this._logWriter);return s.dispatched(t),r(t,i).pipe(ur(o=>{s.completed(o)}),cc(o=>{throw s.errored(o),o}))}}return n.\u0275fac=function(t){return new(t||n)(De(BW),De(jn))},n.\u0275prov=$e({token:n,factory:n.\u0275fac}),n})();const VW=new zt("LOGGER_USER_OPTIONS");function OOe(n){return Object.assign({},{logger:console,collapsed:!1,disabled:!1,filter:()=>!0},n)}let ROe=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[{provide:l4,useClass:IOe,multi:!0},{provide:VW,useValue:t},{provide:BW,useFactory:OOe,deps:[VW]}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({}),n})();const POe=[Sm];let NOe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[xOe.forRoot(),ua.forRoot(POe,{developmentMode:!pf.production}),ROe.forRoot({disabled:pf.production})]]}),n})(),FOe=(()=>{class n{constructor(t){if(t)throw new Error("The core module should only be imported once in the root module")}}return n.\u0275fac=function(t){return new(t||n)(De(n,12))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:[{provide:PW,useExisting:COe}],imports:[[pG,VMe.forRoot({gaToken:pf.googleAnalyticsToken,appName:"organ-info",projectName:"ccf",developmentMode:!pf.production}),qMe.forRoot(()=>new hb({basePath:pf.dbOptions.remoteApiEndpoint})),NOe]]}),n})(),LOe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[Zr,rOe]]}),n})(),kOe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[Zr,cIe,LOe]]}),n})(),BOe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[Zr,_x]]}),n})(),VOe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({imports:[[Zr]]}),n})(),jOe=(()=>{class n{constructor(t){this.injector=t}ngDoBootstrap(){const t=function(n,e){const t=function(n,e){return e.get(dl).resolveComponentFactory(n).inputs}(n,e.injector),i=e.strategyFactory||new vee(n,e.injector),r=function(n){const e={};return n.forEach(({propName:t,templateName:i})=>{e[function(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}(i)]=t}),e}(t);class s extends wee{constructor(a){super(),this.injector=a}get ngElementStrategy(){if(!this._ngElementStrategy){const a=this._ngElementStrategy=i.create(this.injector||e.injector);t.forEach(({propName:l})=>{if(!this.hasOwnProperty(l))return;const c=this[l];delete this[l],a.setInputValue(l,c)})}return this._ngElementStrategy}attributeChangedCallback(a,l,c,u){this.ngElementStrategy.setInputValue(r[a],c)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{const l=function(n,e,t){if("function"!=typeof CustomEvent){const s=n.createEvent("CustomEvent");return s.initCustomEvent(e,!1,!1,t),s}return new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t})}(this.ownerDocument,a.name,a.value);this.dispatchEvent(l)})}}return s.observedAttributes=Object.keys(r),t.forEach(({propName:o})=>{Object.defineProperty(s.prototype,o,{get(){return this.ngElementStrategy.getInputValue(o)},set(a){this.ngElementStrategy.setInputValue(o,a)},configurable:!0,enumerable:!0})}),s}(SOe,{injector:this.injector});customElements.define("ccf-organ-info",t)}}return n.\u0275fac=function(t){return new(t||n)(De(jn))},n.\u0275mod=ln({type:n}),n.\u0275inj=bt({providers:[],imports:[[ZM,FOe,BOe,VOe,kOe]]}),n})();pf.production&&function(){if(Nk)throw new Error("Cannot enable prod mode after platform setup.");Pk=!1}(),zJ().bootstrapModule(jOe).catch(n=>console.error(n))},52:Vt=>{function nt(mt,J,xt,dt,K,Ae,pe){try{var Y=mt[Ae](pe),U=Y.value}catch(k){return void xt(k)}Y.done?J(U):Promise.resolve(U).then(dt,K)}Vt.exports=function(mt){return function(){var J=this,xt=arguments;return new Promise(function(dt,K){var Ae=mt.apply(J,xt);function pe(U){nt(Ae,dt,K,pe,Y,"next",U)}function Y(U){nt(Ae,dt,K,pe,Y,"throw",U)}pe(void 0)})}},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},948:Vt=>{Vt.exports=function(tt){return tt&&tt.__esModule?tt:{default:tt}},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},321:Vt=>{function nt(tt){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(Vt.exports=nt=function(J){return typeof J},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0):(Vt.exports=nt=function(J){return J&&"function"==typeof Symbol&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0),nt(tt)}Vt.exports=nt,Vt.exports.default=Vt.exports,Vt.exports.__esModule=!0},82:Vt=>{function nt(tt){return Promise.resolve().then(()=>{var mt=new Error("Cannot find module '"+tt+"'");throw mt.code="MODULE_NOT_FOUND",mt})}nt.keys=()=>[],nt.resolve=nt,nt.id=82,Vt.exports=nt},521:()=>{},125:()=>{},307:()=>{}},Vt=>{Vt(Vt.s=572)}]);